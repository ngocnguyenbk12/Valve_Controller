LX51 LINKER/LOCATER V4.66.41.0                                                          11/02/2021  02:45:12  PAGE 1





ASSEMBLER CODE PACKING OF MODULE:  .\BUILD\SWITCHONOFF_SLAVE_ENHANCED_232_OTA_ZW050X_TI_RELS\SWITCHONOFF_SLAVE_ENHANCED_
>> 232_OTA_ZW050X_US_TI.AOF (APP_RFSETUP)


001803 026EAE            LJMP     06EAEH
001813 026ED2            LJMP     06ED2H
001823 026B92            LJMP     06B92H
00182B 024951            LJMP     04951H
00184B 0259C9            LJMP     059C9H
----- FUNCTION _ZW_Version (BEGIN) -----
;---- Variable 'dst' assigned to Register 'R6/R7' ----
;---- Variable 'offset' assigned to Register 'R5' ----
0032A1 E4                CLR      A
0032A2 FD                MOV      R5,A
;---- Variable 'length' assigned to Register 'R4' ----
0032A3 7C0C              MOV      R4,#0CH
0032A5         ?C0003?ZW_VERSION:
0032A5 AB05              MOV      R3,AR5
0032A7 0D                INC      R5
0032A8 EB                MOV      A,R3
0032A9 901816            MOV      DPTR,#ZW_basis_version
0032AC 93                MOVC     A,@A+DPTR
0032AD 8F82              MOV      DPL,R7
0032AF 8E83              MOV      DPH,R6
0032B1 F0                MOVX     @DPTR,A
0032B2 0F                INC      R7
0032B3 BF0001            CJNE     R7,#00H,?C0006?ZW_VERSION
0032B6 0E                INC      R6
0032B7         ?C0006?ZW_VERSION:
0032B7 DCEC              DJNZ     R4,?C0003?ZW_VERSION
;----                  JMP      ZW_Type_Library
----- FUNCTION _ZW_Version (END) -------


----- FUNCTION ZW_Type_Library (BEGIN) -----
0032B9 7F03              MOV      R7,#03H
0032BB 22                RET      
----- FUNCTION ZW_Type_Library (END) -------


----- FUNCTION _ZW_GetProtocolVersion (BEGIN) -----
;---- Variable 'dst' assigned to Register 'R6/R7' ----
0032BC 8F82              MOV      DPL,R7
0032BE 8E83              MOV      DPH,R6
0032C0 E4                CLR      A
0032C1 F0                MOVX     @DPTR,A
0032C2 A3                INC      DPTR
0032C3 7406              MOV      A,#06H
0032C5 51DE              ACALL    ?L?COM03B1
0032C7 740A              MOV      A,#0AH
0032C9 51DE              ACALL    ?L?COM03B1
0032CB A3                INC      DPTR
0032CC E4                CLR      A
0032CD F0                MOVX     @DPTR,A
0032CE EF                MOV      A,R7
0032CF 2404              ADD      A,#04H
0032D1 F582              MOV      DPL,A
0032D3 E4                CLR      A
0032D4 3E                ADDC     A,R6
0032D5 F583              MOV      DPH,A
0032D7 E4                CLR      A
0032D8 F0                MOVX     @DPTR,A
0032D9 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 2


0032DA 746D              MOV      A,#06DH
0032DC F0                MOVX     @DPTR,A
0032DD 22                RET      
----- FUNCTION _ZW_GetProtocolVersion (END) -------


----- FUNCTION ?L?COM03B1 (BEGIN) -----
0032DE F0                MOVX     @DPTR,A
0032DF         ?L?COM03B2:
0032DF 8F82              MOV      DPL,R7
0032E1 8E83              MOV      DPH,R6
0032E3 A3                INC      DPTR
0032E4 A3                INC      DPTR
0032E5 22                RET      
----- FUNCTION ?L?COM03B1 (END) -------


----- FUNCTION _main_SetSystemType (BEGIN) -----
;---- Variable 'bAppType' assigned to Register 'R5' ----
0032E6 AD07              MOV      R5,AR7
0032E8 901217            MOV      DPTR,#eSystemTypeState
0032EB E0                MOVX     A,@DPTR
0032EC 54FC              ANL      A,#0FCH
0032EE F0                MOVX     @DPTR,A
0032EF E0                MOVX     A,@DPTR
0032F0 FF                MOV      R7,A
0032F1 ED                MOV      A,R5
0032F2 5430              ANL      A,#030H
0032F4 7E00              MOV      R6,#00H
0032F6 6002              JZ       ?C0002?ZW_MAIN
0032F8 7E02              MOV      R6,#02H
0032FA         ?C0002?ZW_MAIN:
0032FA         ?C0003?ZW_MAIN:
0032FA EF                MOV      A,R7
0032FB 4E                ORL      A,R6
0032FC 901217            MOV      DPTR,#eSystemTypeState
0032FF F0                MOVX     @DPTR,A
003300 E0                MOVX     A,@DPTR
003301 FF                MOV      R7,A
003302 ED                MOV      A,R5
003303 7E00              MOV      R6,#00H
003305 30E002            JNB      ACC.0,?C0004?ZW_MAIN
003308 7E01              MOV      R6,#01H
00330A         ?C0004?ZW_MAIN:
00330A         ?C0005?ZW_MAIN:
00330A EF                MOV      A,R7
00330B 4E                ORL      A,R6
00330C 901217            MOV      DPTR,#eSystemTypeState
00330F F0                MOVX     @DPTR,A
003310 22                RET      
----- FUNCTION _main_SetSystemType (END) -------


----- FUNCTION CallApplicationInitSW (BEGIN) -----
003311 9003C9            MOV      DPTR,#bStartupState
003314 7402              MOV      A,#02H
003316 F0                MOVX     @DPTR,A
003317 9003C0            MOV      DPTR,#mNvmLayout
00331A E0                MOVX     A,@DPTR
00331B FF                MOV      R7,A
00331C 121DE0            LCALL    ?INTERBANK_TABLE?_ApplicationInitSW
00331F 51E6              ACALL    _main_SetSystemType
003321 9003C9            MOV      DPTR,#bStartupState
003324 7405              MOV      A,#05H
003326 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 3


003327 22                RET      
----- FUNCTION CallApplicationInitSW (END) -------


----- FUNCTION main (BEGIN) -----
003328 75FF02            MOV      SFRPAGE,#02H
00332B 75E404            MOV      WDTCON,#04H
00332E E4                CLR      A
00332F F5E4              MOV      WDTCON,A
003331 F1D8              ACALL    ?L?COM063B
003333 C3                CLR      C
003334 30E001            JNB      ACC.0,?C0084?ZW_MAIN
003337 D3                SETB     C
003338         ?C0084?ZW_MAIN:
003338         ?C0085?ZW_MAIN:
003338 4017              JC       ?C0083?ZW_MAIN
00333A E5E6              MOV      A,RSETVEC
00333C 30E012            JNB      ACC.0,?C0083?ZW_MAIN
00333F 901217            MOV      DPTR,#eSystemTypeState
003342 E0                MOVX     A,@DPTR
003343 540C              ANL      A,#0CH
003345 600A              JZ       ?C0083?ZW_MAIN
003347 121BF1            LCALL    ?INTERBANK_TABLE?Power_Management_Check
00334A 901217            MOV      DPTR,#eSystemTypeState
00334D E0                MOVX     A,@DPTR
00334E 54F7              ANL      A,#0F7H
003350 F0                MOVX     @DPTR,A
003351         ?C0083?ZW_MAIN:
003351 C213              CLR      RF_WakeupReceived
003353 F1D8              ACALL    ?L?COM063B
003355 30E039            JNB      ACC.0,?C0086?ZW_MAIN
003358 E5E6              MOV      A,RSETVEC
00335A 5403              ANL      A,#03H
00335C 6401              XRL      A,#01H
00335E 7031              JNZ      ?C0086?ZW_MAIN
003360 121A20            LCALL    ?INTERBANK_TABLE?RFDriverInitHWFLiRS
003363 12571A            LCALL    RF_WaitForBeam
003366 401F              JC       ?C0087?ZW_MAIN
003368 90123F            MOV      DPTR,#bBeamCountWakeup
00336B E0                MOVX     A,@DPTR
00336C 600B              JZ       ?C0088?ZW_MAIN
00336E E0                MOVX     A,@DPTR
00336F 14                DEC      A
003370 F0                MOVX     @DPTR,A
003371 7006              JNZ      ?C0088?ZW_MAIN
003373 122F75            LCALL    ZW_ram_clear
003376 D170              ACALL    ?L?COM046D
003378 F0                MOVX     @DPTR,A
003379         ?C0088?ZW_MAIN:
003379 901215            MOV      DPTR,#bFLiRSStatus
00337C E0                MOVX     A,@DPTR
00337D 20E002            JB       ACC.0,$ + 5H
003380 8123              AJMP     ?C0092?ZW_MAIN
003382 12487C            LCALL    GoToSleep
003385 8123              AJMP     ?C0092?ZW_MAIN
003387         ?C0087?ZW_MAIN:
003387 122F75            LCALL    ZW_ram_clear
00338A D213              SETB     RF_WakeupReceived
00338C D170              ACALL    ?L?COM046D
00338E F0                MOVX     @DPTR,A
00338F 8123              AJMP     ?C0092?ZW_MAIN
003391         ?C0086?ZW_MAIN:
003391 122F75            LCALL    ZW_ram_clear
003394 126235            LCALL    Reset_GetReset
003397 9003C2            MOV      DPTR,#bMainWakeUpReason
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 4


00339A EF                MOV      A,R7
00339B F0                MOVX     @DPTR,A
00339C 901200            MOV      DPTR,#criticalMemMagic1
00339F E0                MOVX     A,@DPTR
0033A0 B47A14            CJNE     A,#07AH,?C0094?ZW_MAIN
0033A3 901214            MOV      DPTR,#criticalMemMagic2
0033A6 E0                MOVX     A,@DPTR
0033A7 B49C0D            CJNE     A,#09CH,?C0094?ZW_MAIN
0033AA 9003C2            MOV      DPTR,#bMainWakeUpReason
0033AD E0                MOVX     A,@DPTR
0033AE FF                MOV      R7,A
0033AF 6405              XRL      A,#05H
0033B1 6004              JZ       ?C0094?ZW_MAIN
0033B3 EF                MOV      A,R7
0033B4 B40330            CJNE     A,#03H,?C0093?ZW_MAIN
0033B7         ?C0094?ZW_MAIN:
0033B7 E4                CLR      A
0033B8 9003C8            MOV      DPTR,#tmpMain
0033BB F0                MOVX     @DPTR,A
0033BC         ?C0095?ZW_MAIN:
0033BC 9003C8            MOV      DPTR,#tmpMain
0033BF E0                MOVX     A,@DPTR
0033C0 FF                MOV      R7,A
0033C1 C3                CLR      C
0033C2 9480              SUBB     A,#080H
0033C4 5013              JNC      ?C0096?ZW_MAIN
0033C6 E4                CLR      A
0033C7 2F                ADD      A,R7
0033C8 F582              MOV      DPL,A
0033CA E4                CLR      A
0033CB 3412              ADDC     A,#012H
0033CD F583              MOV      DPH,A
0033CF E4                CLR      A
0033D0 F0                MOVX     @DPTR,A
0033D1 9003C8            MOV      DPTR,#tmpMain
0033D4 E0                MOVX     A,@DPTR
0033D5 04                INC      A
0033D6 F0                MOVX     @DPTR,A
0033D7 80E3              SJMP     ?C0095?ZW_MAIN
0033D9         ?C0096?ZW_MAIN:
0033D9 901200            MOV      DPTR,#criticalMemMagic1
0033DC 747A              MOV      A,#07AH
0033DE F0                MOVX     @DPTR,A
0033DF 901214            MOV      DPTR,#criticalMemMagic2
0033E2 749C              MOV      A,#09CH
0033E4 F0                MOVX     @DPTR,A
0033E5 D20F              SETB     criticalCleared
0033E7         ?C0093?ZW_MAIN:
0033E7 121C19            LCALL    ?INTERBANK_TABLE?ZW_IsNVRValid
0033EA 4003              JC       ?C0098?ZW_MAIN
0033EC 121C14            LCALL    ?INTERBANK_TABLE?ZW_NVRCheck
0033EF         ?C0098?ZW_MAIN:
0033EF 7B01              MOV      R3,#01H
0033F1 7A12              MOV      R2,#HIGH phyRfData+0FH
0033F3 7910              MOV      R1,#LOW phyRfData+0FH
0033F5 7D01              MOV      R5,#01H
0033F7 7F01              MOV      R7,#01H
0033F9 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
0033FC 7B01              MOV      R3,#01H
0033FE 7A12              MOV      R2,#HIGH phyRfData+010H
003400 7911              MOV      R1,#LOW phyRfData+010H
003402 7D01              MOV      R5,#01H
003404 7F21              MOV      R7,#021H
003406 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003409 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 5


00340B 7A12              MOV      R2,#HIGH phyRfData+011H
00340D 7912              MOV      R1,#LOW phyRfData+011H
00340F 7D01              MOV      R5,#01H
003411 7F22              MOV      R7,#022H
003413 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003416 7B01              MOV      R3,#01H
003418 7A12              MOV      R2,#HIGH bNVRUartPinSwap
00341A 7929              MOV      R1,#LOW bNVRUartPinSwap
00341C 7D01              MOV      R5,#01H
00341E 7F02              MOV      R7,#02H
003420 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003423         ?C0092?ZW_MAIN:
003423 901229            MOV      DPTR,#bNVRUartPinSwap
003426 E0                MOVX     A,@DPTR
003427 B40105            CJNE     A,#01H,?C0099?ZW_MAIN
00342A 7F01              MOV      R7,#01H
00342C 126B7D            LCALL    _ZW_UART0_zm4102_mode_enable
00342F         ?C0099?ZW_MAIN:
00342F 121A25            LCALL    ?INTERBANK_TABLE?RFDriverInitHW
003432 126235            LCALL    Reset_GetReset
003435 121A1B            LCALL    ?INTERBANK_TABLE?_ZW_setSwWakeupReason
003438 9003C2            MOV      DPTR,#bMainWakeUpReason
00343B EF                MOV      A,R7
00343C F0                MOVX     @DPTR,A
00343D 121999            LCALL    ?INTERBANK_TABLE?transportVarInit
003440 121A16            LCALL    ?INTERBANK_TABLE?Init_ZW_HW
003443 9003C2            MOV      DPTR,#bMainWakeUpReason
003446 E0                MOVX     A,@DPTR
003447 FF                MOV      R7,A
003448 B40602            CJNE     A,#06H,?C0100?ZW_MAIN
00344B 800C              SJMP     ?C0175?ZW_MAIN
00344D         ?C0100?ZW_MAIN:
00344D 301304            JNB      RF_WakeupReceived,?C0102?ZW_MAIN
003450 7F02              MOV      R7,#02H
003452 8005              SJMP     ?C0103?ZW_MAIN
003454         ?C0102?ZW_MAIN:
003454 9003C2            MOV      DPTR,#bMainWakeUpReason
003457 E0                MOVX     A,@DPTR
003458 FF                MOV      R7,A
003459         ?C0103?ZW_MAIN:
003459         
003459 121DDB            LCALL    ?INTERBANK_TABLE?_ApplicationInitHW
00345C EF                MOV      A,R7
00345D 24FF              ADD      A,#0FFH
00345F B3                CPL      C
003460 9237              MOV      productionTest,C
003462 75FF02            MOV      SFRPAGE,#02H
003465 53E6BF            ANL      RSETVEC,#0BFH
003468         ?C0101?ZW_MAIN:
003468 123F24            LCALL    ?L?COM0573
00346B 6003              JZ       ?C0104?ZW_MAIN
00346D D170              ACALL    ?L?COM046D
00346F F0                MOVX     @DPTR,A
003470         ?C0104?ZW_MAIN:
003470 12492E            LCALL    SysTimerInit
003473 121A2F            LCALL    ?INTERBANK_TABLE?RFDriverInitSW
003476 12382D            LCALL    Init_ZW_SW
003479 300F0A            JNB      criticalCleared,?C0105?ZW_MAIN
00347C 7B01              MOV      R3,#01H
00347E 7A12              MOV      R2,#HIGH retentionRandom
003480 792B              MOV      R1,#LOW retentionRandom
003482 7D10              MOV      R5,#010H
003484 F180              ACALL    _ZW_GetRandomArray
003486         ?C0105?ZW_MAIN:
003486 121A6B            LCALL    ?INTERBANK_TABLE?security_init
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 6


003489 901215            MOV      DPTR,#bFLiRSStatus
00348C E0                MOVX     A,@DPTR
00348D C3                CLR      C
00348E 30E001            JNB      ACC.0,?C0107?ZW_MAIN
003491 D3                SETB     C
003492         ?C0107?ZW_MAIN:
003492         ?C0108?ZW_MAIN:
003492 400E              JC       ?C0106?ZW_MAIN
003494 20370B            JB       productionTest,?C0106?ZW_MAIN
003497 7111              ACALL    CallApplicationInitSW
003499 7B01              MOV      R3,#01H
00349B 7A2B              MOV      R2,#HIGH slaveFrameBuffer
00349D 79BB              MOV      R1,#LOW slaveFrameBuffer
00349F 1219DA            LCALL    ?INTERBANK_TABLE?_UpdateNodeInformation
0034A2         ?C0106?ZW_MAIN:
0034A2 90122A            MOV      DPTR,#bldeviceOptionsMask
0034A5 E0                MOVX     A,@DPTR
0034A6 30E002            JNB      ACC.0,?C0109?ZW_MAIN
0034A9 8003              SJMP     ?C0176?ZW_MAIN
0034AB         ?C0109?ZW_MAIN:
0034AB 301304            JNB      RF_WakeupReceived,?C0110?ZW_MAIN
0034AE         
0034AE 7F01              MOV      R7,#01H
0034B0 D1A5              ACALL    _ZW_SetRFReceiveMode
0034B2         ?C0110?ZW_MAIN:
0034B2 D2AF              SETB     EA
0034B4 203702            JB       productionTest,$ + 5H
0034B7 A13C              AJMP     ?C0133?ZW_MAIN
0034B9         ?C0113?ZW_MAIN:
0034B9 121C32            LCALL    ?INTERBANK_TABLE?TransportTimerPoll
0034BC 12449B            LCALL    TimerAction
0034BF 121DE5            LCALL    ?INTERBANK_TABLE?ApplicationTestPoll
0034C2 121C0A            LCALL    ?INTERBANK_TABLE?SendProdTestCarrier
0034C5 40F2              JC       ?C0113?ZW_MAIN
0034C7 9003C1            MOV      DPTR,#sleepMode
0034CA E0                MOVX     A,@DPTR
0034CB 6042              JZ       ?C0116?ZW_MAIN
0034CD 121A4D            LCALL    ?INTERBANK_TABLE?TxQueueIsEmpty
0034D0 EF                MOV      A,R7
0034D1 7007              JNZ      ?C0119?ZW_MAIN
0034D3 125221            LCALL    ?L?COM03D2
0034D6 9400              SUBB     A,#00H
0034D8 4035              JC       ?C0116?ZW_MAIN
0034DA         ?C0119?ZW_MAIN:
0034DA E514              MOV      A,RF_state
0034DC 70FC              JNZ      ?C0119?ZW_MAIN
0034DE         ?C0120?ZW_MAIN:
0034DE E515              MOV      A,RF_status
0034E0 20E502            JB       ACC.5,?C0122?ZW_MAIN
0034E3 F112              ACALL    RFPowerDown
0034E5         ?C0122?ZW_MAIN:
0034E5 121B6A            LCALL    ?INTERBANK_TABLE?ExtMemoryWriteBusy
0034E8 EF                MOV      A,R7
0034E9 70FA              JNZ      ?C0122?ZW_MAIN
0034EB         ?C0123?ZW_MAIN:
0034EB D17F              ACALL    ZW_BootloaderPresent
0034ED 5004              JNC      ?C0125?ZW_MAIN
0034EF D191              ACALL    ?L?COM04BE
0034F1 5005              JNC      ?C0124?ZW_MAIN
0034F3         ?C0125?ZW_MAIN:
0034F3 7F01              MOV      R7,#01H
0034F5 123CC0            LCALL    _NVM_ext_deeppowerdown
0034F8         ?C0124?ZW_MAIN:
0034F8 9003C1            MOV      DPTR,#sleepMode
0034FB E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 7


0034FC B40204            CJNE     A,#02H,?C0126?ZW_MAIN
0034FF E4                CLR      A
003500 FF                MOV      R7,A
003501 8009              SJMP     ?C0177?ZW_MAIN
003503         ?C0126?ZW_MAIN:
003503 9003C1            MOV      DPTR,#sleepMode
003506 E0                MOVX     A,@DPTR
003507 B40305            CJNE     A,#03H,?C0116?ZW_MAIN
00350A 7F01              MOV      R7,#01H
00350C         
00350C 124881            LCALL    _ZW_power_down_mode
00350F         ?C0116?ZW_MAIN:
00350F 121A43            LCALL    ?INTERBANK_TABLE?TxQueueServiceTransmit
003512 E515              MOV      A,RF_status
003514 30E1A2            JNB      ACC.1,?C0113?ZW_MAIN
003517 1271A5            LCALL    ?L?COM034B
00351A 4002              JC       ?C0130?ZW_MAIN
00351C E4                CLR      A
00351D F0                MOVX     @DPTR,A
00351E         ?C0130?ZW_MAIN:
00351E E515              MOV      A,RF_status
003520 20E505            JB       ACC.5,?C0131?ZW_MAIN
003523 D152              ACALL    ?L?COM0118
003525 1258FB            LCALL    ?L?COM051D
003528         ?C0131?ZW_MAIN:
003528 1271CA            LCALL    ?L?COM0373
00352B C0E0              PUSH     ACC
00352D D160              ACALL    ?L?COM0119
00352F 9003C4            MOV      DPTR,#receivedLength
003532 E0                MOVX     A,@DPTR
003533 FD                MOV      R5,A
003534 D0E0              POP      ACC
003536 FF                MOV      R7,A
003537 12198F            LCALL    ?INTERBANK_TABLE?_ReceiveHandler
00353A 81B9              AJMP     ?C0113?ZW_MAIN
00353C         ?C0133?ZW_MAIN:
00353C 1248CD            LCALL    ProtocolMonitor
00353F 1248A5            LCALL    NewIDNeeded
003542 5002              JNC      ?C0135?ZW_MAIN
003544 D1C1              ACALL    NewIDCreate
003546         ?C0135?ZW_MAIN:
003546 D177              ACALL    main_ProtocolStateIsShutdownPending
003548 EF                MOV      A,R7
003549 7006              JNZ      ?C0137?ZW_MAIN
00354B 9003C1            MOV      DPTR,#sleepMode
00354E E0                MOVX     A,@DPTR
00354F 6053              JZ       ?C0136?ZW_MAIN
003551         ?C0137?ZW_MAIN:
003551 902B24            MOV      DPTR,#assignState
003554 E0                MOVX     A,@DPTR
003555 704D              JNZ      ?C0136?ZW_MAIN
003557 121A4D            LCALL    ?INTERBANK_TABLE?TxQueueIsEmpty
00355A EF                MOV      A,R7
00355B 7007              JNZ      ?C0140?ZW_MAIN
00355D 125221            LCALL    ?L?COM03D2
003560 9400              SUBB     A,#00H
003562 4040              JC       ?C0136?ZW_MAIN
003564         ?C0140?ZW_MAIN:
003564 E514              MOV      A,RF_state
003566 70FC              JNZ      ?C0140?ZW_MAIN
003568         ?C0141?ZW_MAIN:
003568 E515              MOV      A,RF_status
00356A 20E502            JB       ACC.5,?C0142?ZW_MAIN
00356D F112              ACALL    RFPowerDown
00356F         ?C0142?ZW_MAIN:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 8


00356F 121CA0            LCALL    ?INTERBANK_TABLE?s2_save_spans_and_mpans
003572         ?C0143?ZW_MAIN:
003572 121B6A            LCALL    ?INTERBANK_TABLE?ExtMemoryWriteBusy
003575 EF                MOV      A,R7
003576 70FA              JNZ      ?C0143?ZW_MAIN
003578         ?C0144?ZW_MAIN:
003578 D17F              ACALL    ZW_BootloaderPresent
00357A 5004              JNC      ?C0146?ZW_MAIN
00357C D191              ACALL    ?L?COM04BE
00357E 5005              JNC      ?C0145?ZW_MAIN
003580         ?C0146?ZW_MAIN:
003580 7F01              MOV      R7,#01H
003582 123CC0            LCALL    _NVM_ext_deeppowerdown
003585         ?C0145?ZW_MAIN:
003585 9003C1            MOV      DPTR,#sleepMode
003588 E0                MOVX     A,@DPTR
003589 7011              JNZ      ?C0147?ZW_MAIN
00358B D177              ACALL    main_ProtocolStateIsShutdownPending
00358D EF                MOV      A,R7
00358E 600C              JZ       ?C0147?ZW_MAIN
003590 12381E            LCALL    main_ProtocolStateSetShutdownReady
003593 901217            MOV      DPTR,#eSystemTypeState
003596 E0                MOVX     A,@DPTR
003597 4408              ORL      A,#08H
003599 F0                MOVX     @DPTR,A
00359A 8008              SJMP     ?C0136?ZW_MAIN
00359C         ?C0147?ZW_MAIN:
00359C 9003C1            MOV      DPTR,#sleepMode
00359F E0                MOVX     A,@DPTR
0035A0 FF                MOV      R7,A
0035A1 121BEC            LCALL    ?INTERBANK_TABLE?_Power_Management_PowerDown
0035A4         ?C0136?ZW_MAIN:
0035A4 121C32            LCALL    ?INTERBANK_TABLE?TransportTimerPoll
0035A7 12449B            LCALL    TimerAction
0035AA 121BFB            LCALL    ?INTERBANK_TABLE?SampleNoiseLevel
0035AD F1F8              ACALL    main_ApplicationStateUpdate
0035AF 123806            LCALL    main_ApplicationStateIsActive
0035B2 EF                MOV      A,R7
0035B3 7022              JNZ      ?C0149?ZW_MAIN
0035B5 F1E0              ACALL    main_ProtocolStateIsReadyForShutdown
0035B7 EF                MOV      A,R7
0035B8 6005              JZ       ?C0150?ZW_MAIN
0035BA 121BF1            LCALL    ?INTERBANK_TABLE?Power_Management_Check
0035BD 8036              SJMP     ?C0155?ZW_MAIN
0035BF         ?C0150?ZW_MAIN:
0035BF D177              ACALL    main_ProtocolStateIsShutdownPending
0035C1 EF                MOV      A,R7
0035C2 7031              JNZ      ?C0155?ZW_MAIN
0035C4 1261DA            LCALL    NetworkManagementLearnActive
0035C7 EF                MOV      A,R7
0035C8 702B              JNZ      ?C0155?ZW_MAIN
0035CA 12477F            LCALL    main_PowerDown_ReadyCheck
0035CD EF                MOV      A,R7
0035CE 6401              XRL      A,#01H
0035D0 7023              JNZ      ?C0155?ZW_MAIN
0035D2 123817            LCALL    main_ProtocolStateSetShutdownPending
0035D5 801E              SJMP     ?C0155?ZW_MAIN
0035D7         ?C0149?ZW_MAIN:
0035D7 901217            MOV      DPTR,#eSystemTypeState
0035DA E0                MOVX     A,@DPTR
0035DB 20E217            JB       ACC.2,?C0155?ZW_MAIN
0035DE F1E0              ACALL    main_ProtocolStateIsReadyForShutdown
0035E0 EF                MOV      A,R7
0035E1 600D              JZ       ?C0157?ZW_MAIN
0035E3 D17F              ACALL    ZW_BootloaderPresent
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 9


0035E5 5004              JNC      ?C0159?ZW_MAIN
0035E7 D191              ACALL    ?L?COM04BE
0035E9 5005              JNC      ?C0157?ZW_MAIN
0035EB         ?C0159?ZW_MAIN:
0035EB E4                CLR      A
0035EC FF                MOV      R7,A
0035ED 123CC0            LCALL    _NVM_ext_deeppowerdown
0035F0         ?C0157?ZW_MAIN:
0035F0 E4                CLR      A
0035F1 9003C7            MOV      DPTR,#eProtocolState
0035F4 F0                MOVX     @DPTR,A
0035F5         ?C0155?ZW_MAIN:
0035F5 201005            JB       bPauseEnabled,?C0160?ZW_MAIN
0035F8 121A43            LCALL    ?INTERBANK_TABLE?TxQueueServiceTransmit
0035FB 8022              SJMP     ?C0161?ZW_MAIN
0035FD         ?C0160?ZW_MAIN:
0035FD 1251E9            LCALL    getTickTime
;---- Variable 'bCurrentTickTime' assigned to Register 'R7' ----
003600 9003BA            MOV      DPTR,#bPauseTransmitCountdown
003603 E0                MOVX     A,@DPTR
003604 FE                MOV      R6,A
003605 EF                MOV      A,R7
003606 C3                CLR      C
003607 9E                SUBB     A,R6
003608 4005              JC       ?C0163?ZW_MAIN
00360A EF                MOV      A,R7
00360B 9E                SUBB     A,R6
00360C FF                MOV      R7,A
00360D 8008              SJMP     ?C0164?ZW_MAIN
00360F         ?C0163?ZW_MAIN:
00360F 9003BA            MOV      DPTR,#bPauseTransmitCountdown
003612 E0                MOVX     A,@DPTR
003613 F4                CPL      A
003614 04                INC      A
003615 2F                ADD      A,R7
003616 FF                MOV      R7,A
003617         ?C0164?ZW_MAIN:
003617 7406              MOV      A,#06H
003619 D3                SETB     C
00361A 9F                SUBB     A,R7
00361B 5002              JNC      ?C0161?ZW_MAIN
00361D C210              CLR      bPauseEnabled
00361F         ?C0161?ZW_MAIN:
00361F E515              MOV      A,RF_status
003621 30E123            JNB      ACC.1,?C0165?ZW_MAIN
003624 1271A5            LCALL    ?L?COM034B
003627 4002              JC       ?C0166?ZW_MAIN
003629 E4                CLR      A
00362A F0                MOVX     @DPTR,A
00362B         ?C0166?ZW_MAIN:
00362B E515              MOV      A,RF_status
00362D 20E505            JB       ACC.5,?C0167?ZW_MAIN
003630 D152              ACALL    ?L?COM0118
003632 1258FB            LCALL    ?L?COM051D
003635         ?C0167?ZW_MAIN:
003635 1271CA            LCALL    ?L?COM0373
003638 C0E0              PUSH     ACC
00363A D160              ACALL    ?L?COM0119
00363C 9003C4            MOV      DPTR,#receivedLength
00363F E0                MOVX     A,@DPTR
003640 FD                MOV      R5,A
003641 D0E0              POP      ACC
003643 FF                MOV      R7,A
003644 12198F            LCALL    ?INTERBANK_TABLE?_ReceiveHandler
003647         ?C0165?ZW_MAIN:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 10


003647 121BBA            LCALL    ?INTERBANK_TABLE?ExploreMachine
00364A 121A57            LCALL    ?INTERBANK_TABLE?runCycle
00364D 124919            LCALL    TaskPoll
003650 A13C              AJMP     ?C0133?ZW_MAIN
----- FUNCTION main (END) -------


----- FUNCTION ?L?COM0118 (BEGIN) -----
003652 9003C3            MOV      DPTR,#currentRxBuffer
003655 E0                MOVX     A,@DPTR
003656 FD                MOV      R5,A
003657 75F0AA            MOV      B,#0AAH
00365A 9003CD            MOV      DPTR,#frameBuffer
00365D 12257D            LCALL    ?C?OFFXADD
003660         ?L?COM0119:
003660 ED                MOV      A,R5
003661 75F002            MOV      B,#02H
003664 A4                MUL      AB
003665 24BC              ADD      A,#LOW rssiBuffer
003667 F9                MOV      R1,A
003668 7403              MOV      A,#HIGH rssiBuffer
00366A 35F0              ADDC     A,B
00366C FA                MOV      R2,A
00366D 7B01              MOV      R3,#01H
00366F 22                RET      
----- FUNCTION ?L?COM0118 (END) -------


----- FUNCTION ?L?COM046D (BEGIN) -----
003670 901215            MOV      DPTR,#bFLiRSStatus
003673 E0                MOVX     A,@DPTR
003674 54FE              ANL      A,#0FEH
003676 22                RET      
----- FUNCTION ?L?COM046D (END) -------


----- FUNCTION main_ProtocolStateIsShutdownPending (BEGIN) -----
003677 F1E8              ACALL    ?L?COM0574
003679 B40102            CJNE     A,#01H,?C0017?ZW_MAIN
00367C 7F01              MOV      R7,#01H
00367E         ?C0017?ZW_MAIN:
00367E 22                RET      
----- FUNCTION main_ProtocolStateIsShutdownPending (END) -------


----- FUNCTION ZW_BootloaderPresent (BEGIN) -----
00367F 900001            MOV      DPTR,#01H
003682 7401              MOV      A,#01H
003684 93                MOVC     A,@A+DPTR
003685 B40007            CJNE     A,#00H,?C0002?ZW_BOOTLOADER_CAPABILITIES
003688 E4                CLR      A
003689 93                MOVC     A,@A+DPTR
00368A B41802            CJNE     A,#018H,?C0002?ZW_BOOTLOADER_CAPABILITIES
00368D C3                CLR      C
00368E 22                RET      
00368F         ?C0002?ZW_BOOTLOADER_CAPABILITIES:
00368F D3                SETB     C
003690 22                RET      
----- FUNCTION ZW_BootloaderPresent (END) -------


----- FUNCTION ?L?COM04BE (BEGIN) -----
003691 7F01              MOV      R7,#01H
003693 7E00              MOV      R6,#00H
----- FUNCTION _ZW_BootIsSupported (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 11


;---- Variable 'wSupportedCapability' assigned to Register 'R6/R7' ----
003695 9017FC            MOV      DPTR,#sBootCapabilities+02H
003698 E4                CLR      A
003699 93                MOVC     A,@A+DPTR
00369A 5E                ANL      A,R6
00369B FE                MOV      R6,A
00369C 7401              MOV      A,#01H
00369E 93                MOVC     A,@A+DPTR
00369F 5F                ANL      A,R7
0036A0 4E                ORL      A,R6
0036A1 24FF              ADD      A,#0FFH
0036A3 B3                CPL      C
0036A4 22                RET      
----- FUNCTION _ZW_BootIsSupported (END) -------


----- FUNCTION _ZW_SetRFReceiveMode (BEGIN) -----
;---- Variable 'mode' assigned to Register 'R7' ----
0036A5 EF                MOV      A,R7
0036A6 600D              JZ       ?C0078?ZW_MAIN
0036A8 D152              ACALL    ?L?COM0118
0036AA AF82              MOV      R7,DPL
0036AC AE83              MOV      R6,DPH
0036AE E4                CLR      A
0036AF FD                MOV      R5,A
0036B0 125901            LCALL    _RFReceiveRestart
0036B3 8009              SJMP     ?C0079?ZW_MAIN
0036B5         ?C0078?ZW_MAIN:
0036B5 121A52            LCALL    ?INTERBANK_TABLE?TxQueueWaitForIdle
0036B8 F112              ACALL    RFPowerDown
0036BA E4                CLR      A
0036BB 33                RLC      A
0036BC FF                MOV      R7,A
0036BD 22                RET      
0036BE         ?C0079?ZW_MAIN:
0036BE 7F01              MOV      R7,#01H
0036C0 22                RET      
----- FUNCTION _ZW_SetRFReceiveMode (END) -------


----- FUNCTION NewIDCreate (BEGIN) -----
0036C1 E4                CLR      A
0036C2 FF                MOV      R7,A
0036C3 D1A5              ACALL    _ZW_SetRFReceiveMode
0036C5 EF                MOV      A,R7
0036C6 6049              JZ       ?C0071?ZW_MAIN
0036C8         ?C0064?ZW_MAIN:
0036C8 7B01              MOV      R3,#01H
0036CA 7A12              MOV      R2,#HIGH homeID
0036CC 7923              MOV      R1,#LOW homeID
0036CE 124D07            LCALL    _RF_get_random_word
0036D1 5009              JNC      ?C0068?ZW_MAIN
0036D3         ?C0065?ZW_MAIN:
0036D3         ?C0062?ZW_MAIN:
0036D3 901223            MOV      DPTR,#homeID
0036D6 E0                MOVX     A,@DPTR
0036D7 C3                CLR      C
0036D8 94C0              SUBB     A,#0C0H
0036DA 40EC              JC       ?C0064?ZW_MAIN
0036DC         ?C0068?ZW_MAIN:
0036DC 7B01              MOV      R3,#01H
0036DE 7A12              MOV      R2,#HIGH homeID+02H
0036E0 7925              MOV      R1,#LOW homeID+02H
0036E2 124D07            LCALL    _RF_get_random_word
0036E5 500F              JNC      ?C0067?ZW_MAIN
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 12


0036E7         ?C0069?ZW_MAIN:
0036E7         ?C0066?ZW_MAIN:
0036E7 123FE1            LCALL    ?L?COM04BF
0036EA 5F                ANL      A,R7
0036EB FF                MOV      R7,A
0036EC A3                INC      DPTR
0036ED E0                MOVX     A,@DPTR
0036EE 5F                ANL      A,R7
0036EF FF                MOV      R7,A
0036F0 A3                INC      DPTR
0036F1 E0                MOVX     A,@DPTR
0036F2 5F                ANL      A,R7
0036F3 F4                CPL      A
0036F4 60E6              JZ       ?C0068?ZW_MAIN
0036F6         ?C0067?ZW_MAIN:
0036F6 90122A            MOV      DPTR,#bldeviceOptionsMask
0036F9 E0                MOVX     A,@DPTR
0036FA 30E004            JNB      ACC.0,?C0070?ZW_MAIN
0036FD 7F01              MOV      R7,#01H
0036FF D1A5              ACALL    _ZW_SetRFReceiveMode
003701         ?C0070?ZW_MAIN:
003701 E4                CLR      A
003702 901221            MOV      DPTR,#nodeID
003705 F0                MOVX     @DPTR,A
003706 7B01              MOV      R3,#01H
003708 7A12              MOV      R2,#HIGH homeID
00370A 7923              MOV      R1,#LOW homeID
00370C E0                MOVX     A,@DPTR
00370D FD                MOV      R5,A
00370E 121B74            LCALL    ?INTERBANK_TABLE?_MemoryPutID
003711         ?C0071?ZW_MAIN:
003711 22                RET      
----- FUNCTION NewIDCreate (END) -------


----- FUNCTION RFPowerDown (BEGIN) -----
003712 E514              MOV      A,RF_state
003714 7022              JNZ      ?C0083?ZW_RF_DRIVER
003716 1255F6            LCALL    ?L?COM04BD
003719 5004              JNC      ?C0084?ZW_RF_DRIVER
00371B C233              CLR      ?RF_demodulator_enable?BIT
00371D F13A              ACALL    RF_demodulator_enable
00371F         ?C0084?ZW_RF_DRIVER:
00371F F1D0              ACALL    ?L?COM05C5
003721 125F53            LCALL    ?L?COM02F2
003724         ?C0085?ZW_RF_DRIVER:
003724 E5D1              MOV      A,FHCON1
003726 20E0FB            JB       ACC.0,?C0085?ZW_RF_DRIVER
003729         ?C0086?ZW_RF_DRIVER:
003729 431520            ORL      RF_status,#020H
00372C 5315FE            ANL      RF_status,#0FEH
00372F E4                CLR      A
003730 F510              MOV      demodState,A
003732 A212              MOV      C,fEUSB
003734 92ED              MOV      EUSB,C
003736 D3                SETB     C
003737 22                RET      
003738         ?C0083?ZW_RF_DRIVER:
003738 C3                CLR      C
003739 22                RET      
----- FUNCTION RFPowerDown (END) -------


----- FUNCTION RF_demodulator_enable (BEGIN) -----
00373A 904377            MOV      DPTR,#setting
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 13


00373D E5F4              MOV      A,DMCTRL
00373F F0                MOVX     @DPTR,A
003740 E0                MOVX     A,@DPTR
003741 547F              ANL      A,#07FH
003743 F5F4              MOV      DMCTRL,A
003745 7F82              MOV      R7,#082H
003747 7E00              MOV      R6,#00H
003749 125E8A            LCALL    ?L?COM035E
00374C         ?C0193?ZW_PHY_RF_050X:
00374C 125D12            LCALL    phy_timer_runs
00374F 5005              JNC      ?C0194?ZW_PHY_RF_050X
003751 E5FC              MOV      A,SEQCON
003753 20E6F6            JB       ACC.6,?C0193?ZW_PHY_RF_050X
003756         ?C0194?ZW_PHY_RF_050X:
003756 303308            JNB      enable,?C0197?ZW_PHY_RF_050X
003759 904377            MOV      DPTR,#setting
00375C E0                MOVX     A,@DPTR
00375D 4480              ORL      A,#080H
00375F F5F4              MOV      DMCTRL,A
003761         ?C0197?ZW_PHY_RF_050X:
003761 125E86            LCALL    ?L?COM035D
003764         ?C0198?ZW_PHY_RF_050X:
003764 125D12            LCALL    phy_timer_runs
003767 5005              JNC      ?C0199?ZW_PHY_RF_050X
003769 E5FC              MOV      A,SEQCON
00376B 20E6F6            JB       ACC.6,?C0198?ZW_PHY_RF_050X
00376E         ?C0199?ZW_PHY_RF_050X:
00376E 75FF01            MOV      SFRPAGE,#01H
003771 E5D5              MOV      A,RFCON
003773 20E702            JB       ACC.7,?C0202?ZW_PHY_RF_050X
003776 C3                CLR      C
003777 22                RET      
003778         ?C0202?ZW_PHY_RF_050X:
003778 E5F4              MOV      A,DMCTRL
00377A D3                SETB     C
00377B 30E601            JNB      ACC.6,?C0204?ZW_PHY_RF_050X
00377E C3                CLR      C
00377F         ?C0204?ZW_PHY_RF_050X:
00377F 22                RET      
----- FUNCTION RF_demodulator_enable (END) -------


----- FUNCTION _ZW_GetRandomArray (BEGIN) -----
003780 900AAC            MOV      DPTR,#pRandomArray
003783 1225A9            LCALL    ?C?PSTXDATA
003786 900AAF            MOV      DPTR,#bArrayByteCount
003789 ED                MOV      A,R5
00378A F0                MOVX     @DPTR,A
00378B E4                CLR      A
00378C A3                INC      DPTR
00378D F0                MOVX     @DPTR,A
00378E ED                MOV      A,R5
00378F 54FE              ANL      A,#0FEH
003791 900AAF            MOV      DPTR,#bArrayByteCount
003794 F0                MOVX     @DPTR,A
003795 602F              JZ       ?C0220?ZW_RF_DRIVER
003797 E4                CLR      A
003798 FF                MOV      R7,A
003799 D1A5              ACALL    _ZW_SetRFReceiveMode
00379B BF0128            CJNE     R7,#01H,?C0220?ZW_RF_DRIVER
00379E         ?C0223?ZW_RF_DRIVER:
00379E 900AAC            MOV      DPTR,#pRandomArray
0037A1 122589            LCALL    ?C?PLDXDATA
0037A4 124D07            LCALL    _RF_get_random_word
0037A7 501D              JNC      ?C0220?ZW_RF_DRIVER
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 14


0037A9 900AAD            MOV      DPTR,#pRandomArray+01H
0037AC E4                CLR      A
0037AD 75F002            MOV      B,#02H
0037B0 122143            LCALL    ?C?IILDX
0037B3 900AB0            MOV      DPTR,#bByteGenerated
0037B6 E0                MOVX     A,@DPTR
0037B7 2402              ADD      A,#02H
0037B9 F0                MOVX     @DPTR,A
0037BA         ?C0221?ZW_RF_DRIVER:
0037BA 900AB0            MOV      DPTR,#bByteGenerated
0037BD E0                MOVX     A,@DPTR
0037BE FF                MOV      R7,A
0037BF 900AAF            MOV      DPTR,#bArrayByteCount
0037C2 E0                MOVX     A,@DPTR
0037C3 6F                XRL      A,R7
0037C4 70D8              JNZ      ?C0223?ZW_RF_DRIVER
0037C6         ?C0220?ZW_RF_DRIVER:
0037C6 7F01              MOV      R7,#01H
0037C8 D1A5              ACALL    _ZW_SetRFReceiveMode
0037CA 900AB0            MOV      DPTR,#bByteGenerated
0037CD E0                MOVX     A,@DPTR
0037CE FF                MOV      R7,A
0037CF 22                RET      
----- FUNCTION _ZW_GetRandomArray (END) -------


----- FUNCTION ?L?COM05C5 (BEGIN) -----
0037D0 124F67            LCALL    RF_shutdown
0037D3 7F08              MOV      R7,#08H
0037D5 021DD6            LJMP     ?INTERBANK_TABLE?_ApplicationRfNotify
----- FUNCTION ?L?COM05C5 (END) -------


----- FUNCTION ?L?COM063B (BEGIN) -----
0037D8 75FF02            MOV      SFRPAGE,#02H
0037DB 901215            MOV      DPTR,#bFLiRSStatus
0037DE E0                MOVX     A,@DPTR
0037DF 22                RET      
----- FUNCTION ?L?COM063B (END) -------


----- FUNCTION main_ProtocolStateIsReadyForShutdown (BEGIN) -----
0037E0 F1E8              ACALL    ?L?COM0574
0037E2 B40202            CJNE     A,#02H,?C0020?ZW_MAIN
0037E5 7F01              MOV      R7,#01H
0037E7         ?C0020?ZW_MAIN:
0037E7 22                RET      
----- FUNCTION main_ProtocolStateIsReadyForShutdown (END) -------


----- FUNCTION ?L?COM0574 (BEGIN) -----
0037E8 9003C7            MOV      DPTR,#eProtocolState
0037EB E0                MOVX     A,@DPTR
0037EC 7F00              MOV      R7,#00H
0037EE 22                RET      
----- FUNCTION ?L?COM0574 (END) -------


----- FUNCTION _RFClearStatus (BEGIN) -----
;---- Variable 'bitMask' assigned to Register 'R7' ----
0037EF C2AF              CLR      EA
0037F1 EF                MOV      A,R7
0037F2 F4                CPL      A
0037F3 5215              ANL      RF_status,A
0037F5 D2AF              SETB     EA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 15


0037F7 22                RET      
----- FUNCTION _RFClearStatus (END) -------


----- FUNCTION main_ApplicationStateUpdate (BEGIN) -----
0037F8 9003C7            MOV      DPTR,#eProtocolState
0037FB E0                MOVX     A,@DPTR
0037FC FF                MOV      R7,A
0037FD 121DEA            LCALL    ?INTERBANK_TABLE?_ApplicationPoll
003800 9003CC            MOV      DPTR,#eApplicationState
003803 EF                MOV      A,R7
003804 F0                MOVX     @DPTR,A
003805 22                RET      
----- FUNCTION main_ApplicationStateUpdate (END) -------


----- FUNCTION main_ApplicationStateIsActive (BEGIN) -----
003806 9003CC            MOV      DPTR,#eApplicationState
003809 E0                MOVX     A,@DPTR
00380A 7F00              MOV      R7,#00H
00380C 7002              JNZ      ?C0008?ZW_MAIN
00380E 7F01              MOV      R7,#01H
003810         ?C0008?ZW_MAIN:
003810 22                RET      
----- FUNCTION main_ApplicationStateIsActive (END) -------


----- FUNCTION main_ProtocolStateSetActive (BEGIN) -----
003811 E4                CLR      A
003812 9003C7            MOV      DPTR,#eProtocolState
003815 F0                MOVX     @DPTR,A
003816 22                RET      
----- FUNCTION main_ProtocolStateSetActive (END) -------


----- FUNCTION main_ProtocolStateSetShutdownPending (BEGIN) -----
003817 9003C7            MOV      DPTR,#eProtocolState
00381A 7401              MOV      A,#01H
00381C F0                MOVX     @DPTR,A
00381D 22                RET      
----- FUNCTION main_ProtocolStateSetShutdownPending (END) -------


----- FUNCTION main_ProtocolStateSetShutdownReady (BEGIN) -----
00381E 9003C7            MOV      DPTR,#eProtocolState
003821 7402              MOV      A,#02H
003823 F0                MOVX     @DPTR,A
003824 22                RET      
----- FUNCTION main_ProtocolStateSetShutdownReady (END) -------


----- FUNCTION main_ProtocolStateIsActive (BEGIN) -----
003825 1237E8            LCALL    ?L?COM0574
003828 7002              JNZ      ?C0014?ZW_MAIN
00382A 7F01              MOV      R7,#01H
00382C         ?C0014?ZW_MAIN:
00382C 22                RET      
----- FUNCTION main_ProtocolStateIsActive (END) -------


----- FUNCTION Init_ZW_SW (BEGIN) -----
00382D B11E              ACALL    NVM_ext_init
00382F 121A3E            LCALL    ?INTERBANK_TABLE?TxQueueInit
003832 121B0B            LCALL    ?INTERBANK_TABLE?ctimer_init
003835 121994            LCALL    ?INTERBANK_TABLE?TransportInit
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 16


003838 121C37            LCALL    ?INTERBANK_TABLE?TransportTimerInit
00383B F124              ACALL    ?L?COM0573
00383D 7002              JNZ      $ + 4H
00383F 210E              AJMP     ?C0024?ZW_MAIN
003841 7FFF              MOV      R7,#0FFH
003843 121AC5            LCALL    ?INTERBANK_TABLE?_FindCorrespondingOldNvmModuleDescriptor
003846 900A73            MOV      DPTR,#nvmModuleDescriptorOldPtr
003849 1225A9            LCALL    ?C?PSTXDATA
00384C 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_VALID_far
00384E 7F09              MOV      R7,#LOW NVM_CONFIGURATION_VALID_far
003850 3164              ACALL    _NVM_ext_read_byte
003852 BF540D            CJNE     R7,#054H,?C0025?ZW_MAIN
003855 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_REALLYVALID_far
003857 7F0A              MOV      R7,#LOW NVM_CONFIGURATION_REALLYVALID_far
003859 3164              ACALL    _NVM_ext_read_byte
00385B BFA504            CJNE     R7,#0A5H,?C0025?ZW_MAIN
00385E 7F01              MOV      R7,#01H
003860 8002              SJMP     ?C0026?ZW_MAIN
003862         ?C0025?ZW_MAIN:
003862 7F00              MOV      R7,#00H
003864         ?C0026?ZW_MAIN:
003864 9003C0            MOV      DPTR,#mNvmLayout
003867 EF                MOV      A,R7
003868 F0                MOVX     @DPTR,A
003869 900A73            MOV      DPTR,#nvmModuleDescriptorOldPtr
00386C 122589            LCALL    ?C?PLDXDATA
00386F E9                MOV      A,R1
003870 4A                ORL      A,R2
003871 4B                ORL      A,R3
003872 701D              JNZ      ?C0030?ZW_MAIN
003874 7F04              MOV      R7,#04H
003876 FE                MOV      R6,A
003877 3164              ACALL    _NVM_ext_read_byte
003879 EF                MOV      A,R7
00387A 2401              ADD      A,#01H
00387C FF                MOV      R7,A
00387D E4                CLR      A
00387E 33                RLC      A
00387F FE                MOV      R6,A
003880 C3                CLR      C
003881 7401              MOV      A,#01H
003883 12556A            LCALL    ?L?COM016F
003886 7F00              MOV      R7,#00H
003888 5002              JNC      ?C0028?ZW_MAIN
00388A 7F01              MOV      R7,#01H
00388C         ?C0028?ZW_MAIN:
00388C         ?C0029?ZW_MAIN:
00388C 9003C0            MOV      DPTR,#mNvmLayout
00388F EF                MOV      A,R7
003890 F0                MOVX     @DPTR,A
003891         ?C0030?ZW_MAIN:
003891 9003C0            MOV      DPTR,#mNvmLayout
003894 E0                MOVX     A,@DPTR
003895 6401              XRL      A,#01H
003897 704C              JNZ      ?C0031?ZW_MAIN
003899 900A73            MOV      DPTR,#nvmModuleDescriptorOldPtr
00389C 122589            LCALL    ?C?PLDXDATA
00389F F186              ACALL    ?L?COM043F
0038A1 7A0A              MOV      R2,#HIGH tmp
0038A3 7979              MOV      R1,#LOW tmp
0038A5 F15B              ACALL    ?L?COM00CA
0038A7 900A79            MOV      DPTR,#tmp
0038AA E0                MOVX     A,@DPTR
0038AB FE                MOV      R6,A
0038AC A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 17


0038AD E0                MOVX     A,@DPTR
0038AE 900A73            MOV      DPTR,#nvmModuleDescriptorOldPtr
0038B1 12722B            LCALL    ?L?COM03FD
0038B4 F9                MOV      R1,A
0038B5 E4                CLR      A
0038B6 3A                ADDC     A,R2
0038B7 FA                MOV      R2,A
0038B8 900A76            MOV      DPTR,#nvmDescriptorOldPtr
0038BB 1225A9            LCALL    ?C?PSTXDATA
0038BE E9                MOV      A,R1
0038BF 2408              ADD      A,#08H
0038C1 F9                MOV      R1,A
0038C2 E4                CLR      A
0038C3 3A                ADDC     A,R2
0038C4 FE                MOV      R6,A
0038C5 AF01              MOV      R7,AR1
0038C7 7B01              MOV      R3,#01H
0038C9 7A0A              MOV      R2,#HIGH tmp
0038CB 7979              MOV      R1,#LOW tmp
0038CD F15B              ACALL    ?L?COM00CA
0038CF 900A79            MOV      DPTR,#tmp
0038D2 E0                MOVX     A,@DPTR
0038D3 6404              XRL      A,#HIGH _APP_VERSION_
0038D5 7004              JNZ      ?C0174?ZW_MAIN
0038D7 A3                INC      DPTR
0038D8 E0                MOVX     A,@DPTR
0038D9 6405              XRL      A,#LOW _APP_VERSION_
0038DB         ?C0174?ZW_MAIN:
0038DB 6008              JZ       ?C0031?ZW_MAIN
0038DD 121ACA            LCALL    ?INTERBANK_TABLE?RearrangeNVMmodules
0038E0 9003C0            MOV      DPTR,#mNvmLayout
0038E3 EF                MOV      A,R7
0038E4 F0                MOVX     @DPTR,A
0038E5         ?C0031?ZW_MAIN:
0038E5 9003C0            MOV      DPTR,#mNvmLayout
0038E8 E0                MOVX     A,@DPTR
0038E9 701B              JNZ      ?C0033?ZW_MAIN
0038EB 7E00              MOV      R6,#HIGH NVM_HOMEID_far
0038ED 7F04              MOV      R7,#LOW NVM_HOMEID_far
0038EF C006              PUSH     AR6
0038F1 C3                CLR      C
0038F2 7413              MOV      A,#LOW _HDATA_E_
0038F4 9404              SUBB     A,#LOW NVM_HOMEID_far
0038F6 FE                MOV      R6,A
0038F7 7414              MOV      A,#HIGH _HDATA_E_
0038F9 127067            LCALL    ?L?COM00DF
0038FC D006              POP      AR6
0038FE F1E9              ACALL    ?L?COM0622
003900 E4                CLR      A
003901 FF                MOV      R7,A
003902 FE                MOV      R6,A
003903 121ACF            LCALL    ?INTERBANK_TABLE?_CinitNVMvariables
003906         ?C0033?ZW_MAIN:
003906 9003C0            MOV      DPTR,#mNvmLayout
003909 E0                MOVX     A,@DPTR
00390A FF                MOV      R7,A
00390B 121AF2            LCALL    ?INTERBANK_TABLE?_ZW_KeystoreInit
00390E         ?C0024?ZW_MAIN:
00390E F124              ACALL    ?L?COM0573
003910 7F00              MOV      R7,#00H
003912 6002              JZ       ?C0034?ZW_MAIN
003914 7F01              MOV      R7,#01H
003916         ?C0034?ZW_MAIN:
003916         ?C0035?ZW_MAIN:
003916 1219FD            LCALL    ?INTERBANK_TABLE?_SlaveInit
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 18


003919 121A07            LCALL    ?INTERBANK_TABLE?SlaveInitDone
00391C 121962            LCALL    ?INTERBANK_TABLE?ReturnRouteResetPriority
00391F 127142            LCALL    ?L?COM02C1
003922 7923              MOV      R1,#LOW homeID
003924 121B6F            LCALL    ?INTERBANK_TABLE?_MemoryGetID
003927 F1E1              ACALL    ?L?COM04BF
003929 FE                MOV      R6,A
00392A 4F                ORL      A,R7
00392B FD                MOV      R5,A
00392C A3                INC      DPTR
00392D E0                MOVX     A,@DPTR
00392E FC                MOV      R4,A
00392F 4D                ORL      A,R5
003930 FD                MOV      R5,A
003931 A3                INC      DPTR
003932 E0                MOVX     A,@DPTR
003933 FB                MOV      R3,A
003934 4D                ORL      A,R5
003935 600B              JZ       ?C0037?ZW_MAIN
003937 EE                MOV      A,R6
003938 5F                ANL      A,R7
003939 FF                MOV      R7,A
00393A EC                MOV      A,R4
00393B 5F                ANL      A,R7
00393C FF                MOV      R7,A
00393D EB                MOV      A,R3
00393E 5F                ANL      A,R7
00393F F4                CPL      A
003940 7003              JNZ      ?C0036?ZW_MAIN
003942         ?C0037?ZW_MAIN:
003942 1236C1            LCALL    NewIDCreate
003945         ?C0036?ZW_MAIN:
003945 901221            MOV      DPTR,#nodeID
003948 E0                MOVX     A,@DPTR
003949 FF                MOV      R7,A
00394A 901225            MOV      DPTR,#homeID+02H
00394D E0                MOVX     A,@DPTR
00394E 6F                XRL      A,R7
00394F 9003BB            MOV      DPTR,#randomSeed
003952 F0                MOVX     @DPTR,A
003953 021C05            LJMP     ?INTERBANK_TABLE?NoiseDetectPowerOnInit
----- FUNCTION Init_ZW_SW (END) -------


----- FUNCTION ?L?COM01D7 (BEGIN) -----
003956 75F011            MOV      B,#011H
003959 A4                MUL      AB
00395A 240B              ADD      A,#LOW NVM_RETURN_ROUTE_START_far
00395C F9                MOV      R1,A
00395D 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far
00395F         ?L?COM01D8:
00395F 35F0              ADDC     A,B
003961 FE                MOV      R6,A
003962 AF01              MOV      R7,AR1
----- FUNCTION _NVM_ext_read_byte (BEGIN) -----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
003964 E4                CLR      A
003965 FC                MOV      R4,A
003966 FD                MOV      R5,A
;----                  JMP      _NVM_ext_read_long_byte
----- FUNCTION _NVM_ext_read_byte (END) -------


----- FUNCTION _NVM_ext_read_long_byte (BEGIN) -----
003967 90416D            MOV      DPTR,#offset
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 19


00396A 1224F1            LCALL    ?C?LSTXDATA
00396D D1DA              ACALL    ZW_WatchDogKick
00396F         ?C0112?ZW_PHY_GENERIC_SPI_IF:
00396F 5149              ACALL    NVM_ext_busy
003971 EF                MOV      A,R7
003972 6004              JZ       ?C0113?ZW_PHY_GENERIC_SPI_IF
003974 D1E9              ACALL    ZW_Poll
003976 80F7              SJMP     ?C0112?ZW_PHY_GENERIC_SPI_IF
003978         ?C0113?ZW_PHY_GENERIC_SPI_IF:
003978 D1CB              ACALL    ?L?COM02D8
00397A 6402              XRL      A,#02H
00397C 600A              JZ       ?C0114?ZW_PHY_GENERIC_SPI_IF
00397E 90416D            MOV      DPTR,#offset
003981 122499            LCALL    ?C?LLDXDATA
003984 7810              MOV      R0,#010H
003986 31A6              ACALL    ?L?COM01B8
003988         ?C0114?ZW_PHY_GENERIC_SPI_IF:
003988 90416D            MOV      DPTR,#offset
00398B 31A1              ACALL    ?L?COM01B7
00398D 90416D            MOV      DPTR,#offset
003990 F112              ACALL    ?L?COM04BA
003992 513D              ACALL    ?L?COM011E
003994 904171            MOV      DPTR,#bData
003997 EF                MOV      A,R7
003998 F0                MOVX     @DPTR,A
003999 71DC              ACALL    ?L?COM02BB
00399B 904171            MOV      DPTR,#bData
00399E E0                MOVX     A,@DPTR
00399F FF                MOV      R7,A
0039A0 22                RET      
----- FUNCTION _NVM_ext_read_long_byte (END) -------


----- FUNCTION ?L?COM01B7 (BEGIN) -----
0039A1 122499            LCALL    ?C?LLDXDATA
0039A4 7808              MOV      R0,#08H
0039A6         ?L?COM01B8:
0039A6 1223E5            LCALL    ?C?ULSHR
0039A9 E4                CLR      A
----- FUNCTION _ZW_SPI1_tx_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
0039AA         ?C0015?ZW_PHY_SPI1_050X:
0039AA E5C8              MOV      A,SPISTAT
0039AC 20E2FB            JB       ACC.2,?C0015?ZW_PHY_SPI1_050X
0039AF         ?C0016?ZW_PHY_SPI1_050X:
0039AF 8FEB              MOV      SPI1DATA,R7
0039B1 22                RET      
----- FUNCTION _ZW_SPI1_tx_set (END) -------


----- FUNCTION NVM_read_id (BEGIN) -----
0039B2 7F01              MOV      R7,#01H
0039B4 71E0              ACALL    _ZW_SPI1_enable
0039B6 904379            MOV      DPTR,#spiNVMbusy
0039B9 7401              MOV      A,#01H
0039BB F0                MOVX     @DPTR,A
0039BC         ?C0045?ZW_PHY_GENERIC_SPI_IF:
0039BC 904379            MOV      DPTR,#spiNVMbusy
0039BF E0                MOVX     A,@DPTR
0039C0 602E              JZ       ?C0046?ZW_PHY_GENERIC_SPI_IF
0039C2 F118              ACALL    ?L?COM05BD
0039C4 513D              ACALL    ?L?COM011E
0039C6 904379            MOV      DPTR,#spiNVMbusy
0039C9 EF                MOV      A,R7
0039CA F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 20


0039CB 715F              ACALL    NVM_CS_disable
0039CD 512C              ACALL    ?L?COM011C
0039CF 903BF3            MOV      DPTR,#spiNVMstatus2
0039D2 EF                MOV      A,R7
0039D3 F0                MOVX     @DPTR,A
0039D4 715F              ACALL    NVM_CS_disable
0039D6 904379            MOV      DPTR,#spiNVMbusy
0039D9 E0                MOVX     A,@DPTR
0039DA 5401              ANL      A,#01H
0039DC F1A4              ACALL    ?L?COM0634
0039DE 60DC              JZ       ?C0045?ZW_PHY_GENERIC_SPI_IF
0039E0 A3                INC      DPTR
0039E1 E0                MOVX     A,@DPTR
0039E2 F4                CPL      A
0039E3 60D7              JZ       ?C0045?ZW_PHY_GENERIC_SPI_IF
0039E5 EF                MOV      A,R7
0039E6 30E7D3            JNB      ACC.7,?C0045?ZW_PHY_GENERIC_SPI_IF
0039E9 E4                CLR      A
0039EA 904379            MOV      DPTR,#spiNVMbusy
0039ED F0                MOVX     @DPTR,A
0039EE 80CC              SJMP     ?C0045?ZW_PHY_GENERIC_SPI_IF
0039F0         ?C0046?ZW_PHY_GENERIC_SPI_IF:
0039F0 518C              ACALL    NVM_CS_enable
0039F2 7F9F              MOV      R7,#09FH
0039F4 31AA              ACALL    _ZW_SPI1_tx_set
0039F6 513D              ACALL    ?L?COM011E
0039F8 903BF4            MOV      DPTR,#manufacturerID
0039FB 513B              ACALL    ?L?COM011D
0039FD 903BF9            MOV      DPTR,#memoryType
003A00 513B              ACALL    ?L?COM011D
003A02 903BFA            MOV      DPTR,#memoryCapacity
003A05 EF                MOV      A,R7
003A06 F0                MOVX     @DPTR,A
003A07 71DC              ACALL    ?L?COM02BB
003A09 903BF2            MOV      DPTR,#spiNVMstatus1
003A0C E0                MOVX     A,@DPTR
003A0D F4                CPL      A
003A0E 601B              JZ       ?C0049?ZW_PHY_GENERIC_SPI_IF
003A10 A3                INC      DPTR
003A11 E0                MOVX     A,@DPTR
003A12 F4                CPL      A
003A13 6016              JZ       ?C0049?ZW_PHY_GENERIC_SPI_IF
003A15 903BF9            MOV      DPTR,#memoryType
003A18 E0                MOVX     A,@DPTR
003A19 FD                MOV      R5,A
003A1A 541F              ANL      A,#01FH
003A1C 240F              ADD      A,#0FH
003A1E A3                INC      DPTR
003A1F F0                MOVX     @DPTR,A
003A20 ED                MOV      A,R5
003A21 C4                SWAP     A
003A22 13                RRC      A
003A23 5407              ANL      A,#07H
003A25 4480              ORL      A,#080H
003A27 903BF9            MOV      DPTR,#memoryType
003A2A F0                MOVX     @DPTR,A
003A2B         ?C0049?ZW_PHY_GENERIC_SPI_IF:
003A2B 22                RET      
----- FUNCTION NVM_read_id (END) -------


----- FUNCTION ?L?COM011C (BEGIN) -----
003A2C 518C              ACALL    NVM_CS_enable
003A2E 7FD7              MOV      R7,#0D7H
003A30 31AA              ACALL    _ZW_SPI1_tx_set
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 21


003A32 7FFF              MOV      R7,#0FFH
003A34 31AA              ACALL    _ZW_SPI1_tx_set
003A36 5141              ACALL    ZW_SPI1_rx_get
003A38 903BF2            MOV      DPTR,#spiNVMstatus1
003A3B         ?L?COM011D:
003A3B EF                MOV      A,R7
003A3C F0                MOVX     @DPTR,A
003A3D         ?L?COM011E:
003A3D 7FFF              MOV      R7,#0FFH
003A3F 31AA              ACALL    _ZW_SPI1_tx_set
----- FUNCTION ZW_SPI1_rx_get (BEGIN) -----
003A41         ?C0012?ZW_PHY_SPI1_050X:
003A41 E5C8              MOV      A,SPISTAT
003A43 20E2FB            JB       ACC.2,?C0012?ZW_PHY_SPI1_050X
003A46         ?C0013?ZW_PHY_SPI1_050X:
;---- Variable 'tmp' assigned to Register 'R7' ----
003A46 AFEB              MOV      R7,SPI1DATA
003A48 22                RET      
----- FUNCTION ZW_SPI1_rx_get (END) -------


----- FUNCTION NVM_ext_busy (BEGIN) -----
003A49 7F01              MOV      R7,#01H
003A4B 71E0              ACALL    _ZW_SPI1_enable
003A4D 303514            JNB      writeActive,?C0107?ZW_PHY_GENERIC_SPI_IF
003A50 F118              ACALL    ?L?COM05BD
003A52 513D              ACALL    ?L?COM011E
003A54 90437A            MOV      DPTR,#status
003A57 EF                MOV      A,R7
003A58 F0                MOVX     @DPTR,A
003A59 715F              ACALL    NVM_CS_disable
003A5B 90437A            MOV      DPTR,#status
003A5E E0                MOVX     A,@DPTR
003A5F 20E002            JB       ACC.0,?C0107?ZW_PHY_GENERIC_SPI_IF
003A62 C235              CLR      writeActive
003A64         ?C0107?ZW_PHY_GENERIC_SPI_IF:
003A64 303517            JNB      writeActive,?C0109?ZW_PHY_GENERIC_SPI_IF
003A67 512C              ACALL    ?L?COM011C
003A69 903BF3            MOV      DPTR,#spiNVMstatus2
003A6C EF                MOV      A,R7
003A6D F1A4              ACALL    ?L?COM0634
003A6F 600B              JZ       ?C0110?ZW_PHY_GENERIC_SPI_IF
003A71 A3                INC      DPTR
003A72 E0                MOVX     A,@DPTR
003A73 F4                CPL      A
003A74 6006              JZ       ?C0110?ZW_PHY_GENERIC_SPI_IF
003A76 EF                MOV      A,R7
003A77 30E702            JNB      ACC.7,?C0110?ZW_PHY_GENERIC_SPI_IF
003A7A C235              CLR      writeActive
003A7C         ?C0110?ZW_PHY_GENERIC_SPI_IF:
003A7C 715F              ACALL    NVM_CS_disable
003A7E         ?C0109?ZW_PHY_GENERIC_SPI_IF:
003A7E E4                CLR      A
003A7F FF                MOV      R7,A
003A80 71E0              ACALL    _ZW_SPI1_enable
003A82 A235              MOV      C,writeActive
003A84 E4                CLR      A
003A85 33                RLC      A
003A86 FF                MOV      R7,A
003A87 22                RET      
----- FUNCTION NVM_ext_busy (END) -------


----- FUNCTION ?L?COM0581 (BEGIN) -----
003A88 7F01              MOV      R7,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 22


003A8A 71E0              ACALL    _ZW_SPI1_enable
----- FUNCTION NVM_CS_enable (BEGIN) -----
003A8C 903BF7            MOV      DPTR,#NVRbNVMChipSelect
003A8F E0                MOVX     A,@DPTR
003A90 1226B6            LCALL    ?C?CCASE
003A93 3AAF              DW       ?C0002?ZW_PHY_GENERIC_SPI_IF
003A95 04                DB       04H
003A96 3AB7              DW       ?C0003?ZW_PHY_GENERIC_SPI_IF
003A98 14                DB       014H
003A99 3ABC              DW       ?C0004?ZW_PHY_GENERIC_SPI_IF
003A9B 15                DB       015H
003A9C 3AC1              DW       ?C0005?ZW_PHY_GENERIC_SPI_IF
003A9E 17                DB       017H
003A9F 3AD1              DW       ?C0008?ZW_PHY_GENERIC_SPI_IF
003AA1 30                DB       030H
003AA2 3AD6              DW       ?C0009?ZW_PHY_GENERIC_SPI_IF
003AA4 34                DB       034H
003AA5 3ADB              DW       ?C0010?ZW_PHY_GENERIC_SPI_IF
003AA7 36                DB       036H
003AA8 3AE0              DW       ?C0011?ZW_PHY_GENERIC_SPI_IF
003AAA 37                DB       037H
003AAB 0000              DW       00H
003AAD 3AC9              DW       ?C0007?ZW_PHY_GENERIC_SPI_IF
003AAF         ?C0002?ZW_PHY_GENERIC_SPI_IF:
003AAF 536CEF            ANL      P0Shadow,#0EFH
003AB2 856C80            MOV      P0,P0Shadow
003AB5 802F              SJMP     ?C0001?ZW_PHY_GENERIC_SPI_IF
003AB7         ?C0003?ZW_PHY_GENERIC_SPI_IF:
003AB7 536DEF            ANL      P1Shadow,#0EFH
003ABA 8008              SJMP     ?C0190?ZW_PHY_GENERIC_SPI_IF
003ABC         ?C0004?ZW_PHY_GENERIC_SPI_IF:
003ABC 536DDF            ANL      P1Shadow,#0DFH
003ABF         
003ABF 8003              SJMP     ?C0190?ZW_PHY_GENERIC_SPI_IF
003AC1         ?C0005?ZW_PHY_GENERIC_SPI_IF:
003AC1 536D7F            ANL      P1Shadow,#07FH
003AC4         
003AC4 856D90            MOV      P1,P1Shadow
003AC7 801D              SJMP     ?C0001?ZW_PHY_GENERIC_SPI_IF
003AC9         ?C0007?ZW_PHY_GENERIC_SPI_IF:
003AC9 536EDF            ANL      P2Shadow,#0DFH
003ACC 856EA0            MOV      P2,P2Shadow
003ACF 8015              SJMP     ?C0001?ZW_PHY_GENERIC_SPI_IF
003AD1         ?C0008?ZW_PHY_GENERIC_SPI_IF:
003AD1 536FFE            ANL      P3Shadow,#0FEH
003AD4 800D              SJMP     ?C0193?ZW_PHY_GENERIC_SPI_IF
003AD6         ?C0009?ZW_PHY_GENERIC_SPI_IF:
003AD6 536FEF            ANL      P3Shadow,#0EFH
003AD9         
003AD9 8008              SJMP     ?C0193?ZW_PHY_GENERIC_SPI_IF
003ADB         ?C0010?ZW_PHY_GENERIC_SPI_IF:
003ADB 536FBF            ANL      P3Shadow,#0BFH
003ADE         
003ADE 8003              SJMP     ?C0193?ZW_PHY_GENERIC_SPI_IF
003AE0         ?C0011?ZW_PHY_GENERIC_SPI_IF:
003AE0 536F7F            ANL      P3Shadow,#07FH
003AE3         
003AE3 856FB0            MOV      P3,P3Shadow
003AE6         ?C0001?ZW_PHY_GENERIC_SPI_IF:
;---- Variable 'x' assigned to Register 'R7' ----
003AE6 7F0C              MOV      R7,#0CH
003AE8         ?C0012?ZW_PHY_GENERIC_SPI_IF:
003AE8 DFFE              DJNZ     R7,?C0012?ZW_PHY_GENERIC_SPI_IF
003AEA 22                RET      
----- FUNCTION NVM_CS_enable (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 23




----- FUNCTION _NVMPutArray_long (BEGIN) -----
003AEB 903E60            MOV      DPTR,#offset
003AEE 1224F1            LCALL    ?C?LSTXDATA
003AF1 903E64            MOV      DPTR,#buf
003AF4 1225A9            LCALL    ?C?PSTXDATA
003AF7 D1DA              ACALL    ZW_WatchDogKick
003AF9         ?C0037?ZW_PHY_GENERIC_SPI_IF:
003AF9 5149              ACALL    NVM_ext_busy
003AFB EF                MOV      A,R7
003AFC 6004              JZ       ?C0038?ZW_PHY_GENERIC_SPI_IF
003AFE D1E9              ACALL    ZW_Poll
003B00 80F7              SJMP     ?C0037?ZW_PHY_GENERIC_SPI_IF
003B02         ?C0038?ZW_PHY_GENERIC_SPI_IF:
003B02 7153              ACALL    ?L?COM01C6
003B04 F13B              ACALL    ?L?COM058A
003B06 D1D3              ACALL    ?L?COM02D9
003B08 6402              XRL      A,#02H
003B0A 600A              JZ       ?C0039?ZW_PHY_GENERIC_SPI_IF
003B0C 903E60            MOV      DPTR,#offset
003B0F 122499            LCALL    ?C?LLDXDATA
003B12 7810              MOV      R0,#010H
003B14 31A6              ACALL    ?L?COM01B8
003B16         ?C0039?ZW_PHY_GENERIC_SPI_IF:
003B16 903E60            MOV      DPTR,#offset
003B19 31A1              ACALL    ?L?COM01B7
003B1B 903E60            MOV      DPTR,#offset
003B1E 122499            LCALL    ?C?LLDXDATA
003B21 E4                CLR      A
003B22 8022              SJMP     ?C0199?ZW_PHY_GENERIC_SPI_IF
003B24         ?C0040?ZW_PHY_GENERIC_SPI_IF:
003B24 903E67            MOV      DPTR,#length
003B27 F18D              ACALL    ?L?COM04AF
003B29 45F0              ORL      A,B
003B2B 601D              JZ       ?C0041?ZW_PHY_GENERIC_SPI_IF
003B2D 903E64            MOV      DPTR,#buf
003B30 122589            LCALL    ?C?PLDXDATA
003B33 E9                MOV      A,R1
003B34 4A                ORL      A,R2
003B35 600D              JZ       ?C0042?ZW_PHY_GENERIC_SPI_IF
003B37 121FB3            LCALL    ?C?CLDPTR
003B3A FF                MOV      R7,A
003B3B 31AA              ACALL    _ZW_SPI1_tx_set
003B3D 903E65            MOV      DPTR,#buf+01H
003B40 F17F              ACALL    ?L?COM0081
003B42 80E0              SJMP     ?C0040?ZW_PHY_GENERIC_SPI_IF
003B44         ?C0042?ZW_PHY_GENERIC_SPI_IF:
003B44 E4                CLR      A
003B45 FF                MOV      R7,A
003B46         
003B46 31AA              ACALL    _ZW_SPI1_tx_set
003B48 80DA              SJMP     ?C0040?ZW_PHY_GENERIC_SPI_IF
003B4A         ?C0041?ZW_PHY_GENERIC_SPI_IF:
003B4A 71DC              ACALL    ?L?COM02BB
003B4C 903BF6            MOV      DPTR,#bNVMstatusReadDisturbed
003B4F 7401              MOV      A,#01H
003B51 F0                MOVX     @DPTR,A
003B52 22                RET      
----- FUNCTION _NVMPutArray_long (END) -------


----- FUNCTION ?L?COM01C6 (BEGIN) -----
003B53 7F01              MOV      R7,#01H
003B55 71E0              ACALL    _ZW_SPI1_enable
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 24


003B57 D235              SETB     writeActive
003B59 518C              ACALL    NVM_CS_enable
003B5B 7F06              MOV      R7,#06H
003B5D 31AA              ACALL    _ZW_SPI1_tx_set
----- FUNCTION NVM_CS_disable (BEGIN) -----
003B5F         ?C0016?ZW_PHY_GENERIC_SPI_IF:
003B5F F1D4              ACALL    ZW_SPI1_active_get
003B61 EF                MOV      A,R7
003B62 70FB              JNZ      ?C0016?ZW_PHY_GENERIC_SPI_IF
003B64         ?C0017?ZW_PHY_GENERIC_SPI_IF:
003B64 903BF9            MOV      DPTR,#memoryType
003B67 E0                MOVX     A,@DPTR
003B68 F4                CPL      A
003B69 600A              JZ       ?C0018?ZW_PHY_GENERIC_SPI_IF
003B6B 904378            MOV      DPTR,#x
003B6E 7406              MOV      A,#06H
003B70 F0                MOVX     @DPTR,A
003B71         ?C0019?ZW_PHY_GENERIC_SPI_IF:
003B71 F133              ACALL    ?L?COM0636
003B73 70FC              JNZ      ?C0019?ZW_PHY_GENERIC_SPI_IF
003B75         ?C0018?ZW_PHY_GENERIC_SPI_IF:
003B75 903BF7            MOV      DPTR,#NVRbNVMChipSelect
003B78 E0                MOVX     A,@DPTR
003B79 1226B6            LCALL    ?C?CCASE
003B7C 3B98              DW       ?C0023?ZW_PHY_GENERIC_SPI_IF
003B7E 04                DB       04H
003B7F 3BA0              DW       ?C0024?ZW_PHY_GENERIC_SPI_IF
003B81 14                DB       014H
003B82 3BA5              DW       ?C0025?ZW_PHY_GENERIC_SPI_IF
003B84 15                DB       015H
003B85 3BAA              DW       ?C0026?ZW_PHY_GENERIC_SPI_IF
003B87 17                DB       017H
003B88 3BBA              DW       ?C0029?ZW_PHY_GENERIC_SPI_IF
003B8A 30                DB       030H
003B8B 3BBF              DW       ?C0030?ZW_PHY_GENERIC_SPI_IF
003B8D 34                DB       034H
003B8E 3BC4              DW       ?C0031?ZW_PHY_GENERIC_SPI_IF
003B90 36                DB       036H
003B91 3BC9              DW       ?C0032?ZW_PHY_GENERIC_SPI_IF
003B93 37                DB       037H
003B94 0000              DW       00H
003B96 3BB2              DW       ?C0028?ZW_PHY_GENERIC_SPI_IF
003B98         ?C0023?ZW_PHY_GENERIC_SPI_IF:
003B98 436C10            ORL      P0Shadow,#010H
003B9B 856C80            MOV      P0,P0Shadow
003B9E 802F              SJMP     ?C0022?ZW_PHY_GENERIC_SPI_IF
003BA0         ?C0024?ZW_PHY_GENERIC_SPI_IF:
003BA0 436D10            ORL      P1Shadow,#010H
003BA3 8008              SJMP     ?C0195?ZW_PHY_GENERIC_SPI_IF
003BA5         ?C0025?ZW_PHY_GENERIC_SPI_IF:
003BA5 436D20            ORL      P1Shadow,#020H
003BA8         
003BA8 8003              SJMP     ?C0195?ZW_PHY_GENERIC_SPI_IF
003BAA         ?C0026?ZW_PHY_GENERIC_SPI_IF:
003BAA 436D80            ORL      P1Shadow,#080H
003BAD         
003BAD 856D90            MOV      P1,P1Shadow
003BB0 801D              SJMP     ?C0022?ZW_PHY_GENERIC_SPI_IF
003BB2         ?C0028?ZW_PHY_GENERIC_SPI_IF:
003BB2 436E20            ORL      P2Shadow,#020H
003BB5 856EA0            MOV      P2,P2Shadow
003BB8 8015              SJMP     ?C0022?ZW_PHY_GENERIC_SPI_IF
003BBA         ?C0029?ZW_PHY_GENERIC_SPI_IF:
003BBA 436F01            ORL      P3Shadow,#01H
003BBD 800D              SJMP     ?C0198?ZW_PHY_GENERIC_SPI_IF
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 25


003BBF         ?C0030?ZW_PHY_GENERIC_SPI_IF:
003BBF 436F10            ORL      P3Shadow,#010H
003BC2         
003BC2 8008              SJMP     ?C0198?ZW_PHY_GENERIC_SPI_IF
003BC4         ?C0031?ZW_PHY_GENERIC_SPI_IF:
003BC4 436F40            ORL      P3Shadow,#040H
003BC7         
003BC7 8003              SJMP     ?C0198?ZW_PHY_GENERIC_SPI_IF
003BC9         ?C0032?ZW_PHY_GENERIC_SPI_IF:
003BC9 436F80            ORL      P3Shadow,#080H
003BCC         
003BCC 856FB0            MOV      P3,P3Shadow
003BCF         ?C0022?ZW_PHY_GENERIC_SPI_IF:
003BCF 904378            MOV      DPTR,#x
003BD2 740C              MOV      A,#0CH
003BD4 F0                MOVX     @DPTR,A
003BD5         ?C0033?ZW_PHY_GENERIC_SPI_IF:
003BD5 F133              ACALL    ?L?COM0636
003BD7 70FC              JNZ      ?C0033?ZW_PHY_GENERIC_SPI_IF
003BD9 22                RET      
----- FUNCTION NVM_CS_disable (END) -------


----- FUNCTION ?L?COM02BA (BEGIN) -----
003BDA 31AA              ACALL    _ZW_SPI1_tx_set
003BDC         ?L?COM02BB:
003BDC 715F              ACALL    NVM_CS_disable
003BDE E4                CLR      A
003BDF FF                MOV      R7,A
----- FUNCTION _ZW_SPI1_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
003BE0 EF                MOV      A,R7
003BE1 B40104            CJNE     A,#01H,?C0008?ZW_PHY_SPI1_050X
003BE4 43FE20            ORL      SPI1CON,#020H
003BE7 22                RET      
003BE8         ?C0008?ZW_PHY_SPI1_050X:
003BE8 53FEDF            ANL      SPI1CON,#0DFH
003BEB 22                RET      
----- FUNCTION _ZW_SPI1_enable (END) -------


----- FUNCTION _NVM_ext_write_long_byte (BEGIN) -----
003BEC 904172            MOV      DPTR,#offset
003BEF 1224F1            LCALL    ?C?LSTXDATA
003BF2 904172            MOV      DPTR,#offset
003BF5 122499            LCALL    ?C?LLDXDATA
003BF8 3167              ACALL    _NVM_ext_read_long_byte
003BFA 904176            MOV      DPTR,#bData
003BFD E0                MOVX     A,@DPTR
003BFE 6F                XRL      A,R7
003BFF 6038              JZ       ?C0117?ZW_PHY_GENERIC_SPI_IF
003C01 D1DA              ACALL    ZW_WatchDogKick
003C03         ?C0118?ZW_PHY_GENERIC_SPI_IF:
003C03 5149              ACALL    NVM_ext_busy
003C05 EF                MOV      A,R7
003C06 6004              JZ       ?C0119?ZW_PHY_GENERIC_SPI_IF
003C08 D1E9              ACALL    ZW_Poll
003C0A 80F7              SJMP     ?C0118?ZW_PHY_GENERIC_SPI_IF
003C0C         ?C0119?ZW_PHY_GENERIC_SPI_IF:
003C0C 7153              ACALL    ?L?COM01C6
003C0E F13B              ACALL    ?L?COM058A
003C10 D1D3              ACALL    ?L?COM02D9
003C12 6402              XRL      A,#02H
003C14 600A              JZ       ?C0120?ZW_PHY_GENERIC_SPI_IF
003C16 904172            MOV      DPTR,#offset
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 26


003C19 122499            LCALL    ?C?LLDXDATA
003C1C 7810              MOV      R0,#010H
003C1E 31A6              ACALL    ?L?COM01B8
003C20         ?C0120?ZW_PHY_GENERIC_SPI_IF:
003C20 904172            MOV      DPTR,#offset
003C23 31A1              ACALL    ?L?COM01B7
003C25 904172            MOV      DPTR,#offset
003C28 F112              ACALL    ?L?COM04BA
003C2A 904176            MOV      DPTR,#bData
003C2D E0                MOVX     A,@DPTR
003C2E FF                MOV      R7,A
003C2F 71DA              ACALL    ?L?COM02BA
003C31 903BF6            MOV      DPTR,#bNVMstatusReadDisturbed
003C34 7401              MOV      A,#01H
003C36 F0                MOVX     @DPTR,A
003C37 D3                SETB     C
003C38 22                RET      
003C39         ?C0117?ZW_PHY_GENERIC_SPI_IF:
003C39 C3                CLR      C
003C3A 22                RET      
----- FUNCTION _NVM_ext_write_long_byte (END) -------


----- FUNCTION NVM_clearStatusReg (BEGIN) -----
003C3B D1DA              ACALL    ZW_WatchDogKick
003C3D         ?C0050?ZW_PHY_GENERIC_SPI_IF:
003C3D 5149              ACALL    NVM_ext_busy
003C3F EF                MOV      A,R7
003C40 6004              JZ       ?C0051?ZW_PHY_GENERIC_SPI_IF
003C42 D1E9              ACALL    ZW_Poll
003C44 80F7              SJMP     ?C0050?ZW_PHY_GENERIC_SPI_IF
003C46         ?C0051?ZW_PHY_GENERIC_SPI_IF:
003C46 7153              ACALL    ?L?COM01C6
003C48 518C              ACALL    NVM_CS_enable
003C4A 7F01              MOV      R7,#01H
003C4C 31AA              ACALL    _ZW_SPI1_tx_set
003C4E 7F03              MOV      R7,#03H
003C50 31AA              ACALL    _ZW_SPI1_tx_set
003C52 715F              ACALL    NVM_CS_disable
003C54 E4                CLR      A
003C55 FF                MOV      R7,A
003C56 8088              SJMP     _ZW_SPI1_enable
----- FUNCTION NVM_clearStatusReg (END) -------


----- FUNCTION _NVM_ext_read_long_buffer (BEGIN) -----
003C58 903E69            MOV      DPTR,#offset
003C5B 1224F1            LCALL    ?C?LSTXDATA
003C5E 903E6D            MOV      DPTR,#buf
003C61 1225A9            LCALL    ?C?PSTXDATA
003C64 D1DA              ACALL    ZW_WatchDogKick
003C66         ?C0123?ZW_PHY_GENERIC_SPI_IF:
003C66 5149              ACALL    NVM_ext_busy
003C68 EF                MOV      A,R7
003C69 6004              JZ       ?C0124?ZW_PHY_GENERIC_SPI_IF
003C6B D1E9              ACALL    ZW_Poll
003C6D 80F7              SJMP     ?C0123?ZW_PHY_GENERIC_SPI_IF
003C6F         ?C0124?ZW_PHY_GENERIC_SPI_IF:
003C6F D1CB              ACALL    ?L?COM02D8
003C71 6402              XRL      A,#02H
003C73 600A              JZ       ?C0125?ZW_PHY_GENERIC_SPI_IF
003C75 903E69            MOV      DPTR,#offset
003C78 122499            LCALL    ?C?LLDXDATA
003C7B 7810              MOV      R0,#010H
003C7D 31A6              ACALL    ?L?COM01B8
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 27


003C7F         ?C0125?ZW_PHY_GENERIC_SPI_IF:
003C7F 903E69            MOV      DPTR,#offset
003C82 31A1              ACALL    ?L?COM01B7
003C84 903E69            MOV      DPTR,#offset
003C87 F112              ACALL    ?L?COM04BA
003C89         ?C0126?ZW_PHY_GENERIC_SPI_IF:
003C89 903E70            MOV      DPTR,#length
003C8C F18D              ACALL    ?L?COM04AF
003C8E 45F0              ORL      A,B
003C90 600E              JZ       ?C0127?ZW_PHY_GENERIC_SPI_IF
003C92 513D              ACALL    ?L?COM011E
003C94 903E6D            MOV      DPTR,#buf
003C97 F195              ACALL    ?L?COM00C0
003C99 903E6E            MOV      DPTR,#buf+01H
003C9C F17F              ACALL    ?L?COM0081
003C9E 80E9              SJMP     ?C0126?ZW_PHY_GENERIC_SPI_IF
003CA0         ?C0127?ZW_PHY_GENERIC_SPI_IF:
003CA0 715F              ACALL    NVM_CS_disable
003CA2 E4                CLR      A
003CA3 FF                MOV      R7,A
003CA4 61E0              AJMP     _ZW_SPI1_enable
----- FUNCTION _NVM_ext_read_long_buffer (END) -------


----- FUNCTION NVM_setPageSize256 (BEGIN) -----
003CA6 903BF2            MOV      DPTR,#spiNVMstatus1
003CA9 E0                MOVX     A,@DPTR
003CAA 20E012            JB       ACC.0,?C0054?ZW_PHY_GENERIC_SPI_IF
003CAD 5188              ACALL    ?L?COM0581
003CAF 7F3D              MOV      R7,#03DH
003CB1 31AA              ACALL    _ZW_SPI1_tx_set
003CB3 7F2A              MOV      R7,#02AH
003CB5 31AA              ACALL    _ZW_SPI1_tx_set
003CB7 7F80              MOV      R7,#080H
003CB9 31AA              ACALL    _ZW_SPI1_tx_set
003CBB 7FA6              MOV      R7,#0A6H
003CBD 71DA              ACALL    ?L?COM02BA
003CBF         ?C0054?ZW_PHY_GENERIC_SPI_IF:
003CBF 22                RET      
----- FUNCTION NVM_setPageSize256 (END) -------


----- FUNCTION _NVM_ext_deeppowerdown (BEGIN) -----
003CC0 90433A            MOV      DPTR,#bDeepPowerdown
003CC3 EF                MOV      A,R7
003CC4 F0                MOVX     @DPTR,A
003CC5 E4                CLR      A
003CC6 A3                INC      DPTR
003CC7 F0                MOVX     @DPTR,A
003CC8 903C00            MOV      DPTR,#NVRbNVMType
003CCB E0                MOVX     A,@DPTR
003CCC FF                MOV      R7,A
003CCD B40209            CJNE     A,#02H,?C0056?ZW_PHY_GENERIC_SPI_IF
003CD0 740F              MOV      A,#0FH
003CD2 F12B              ACALL    ?L?COM0635
003CD4 74B9              MOV      A,#0B9H
003CD6 F0                MOVX     @DPTR,A
003CD7 800C              SJMP     ?C0057?ZW_PHY_GENERIC_SPI_IF
003CD9         ?C0056?ZW_PHY_GENERIC_SPI_IF:
003CD9 EF                MOV      A,R7
003CDA 6404              XRL      A,#04H
003CDC 703F              JNZ      ?C0060?ZW_PHY_GENERIC_SPI_IF
003CDE 743D              MOV      A,#03DH
003CE0 F12B              ACALL    ?L?COM0635
003CE2 7479              MOV      A,#079H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 28


003CE4 F0                MOVX     @DPTR,A
003CE5         ?C0057?ZW_PHY_GENERIC_SPI_IF:
003CE5 5188              ACALL    ?L?COM0581
003CE7 90433A            MOV      DPTR,#bDeepPowerdown
003CEA E0                MOVX     A,@DPTR
003CEB 6007              JZ       ?C0061?ZW_PHY_GENERIC_SPI_IF
003CED 903BFF            MOV      DPTR,#deepPowerdown
003CF0 E0                MOVX     A,@DPTR
003CF1 FF                MOV      R7,A
003CF2 8002              SJMP     ?C0062?ZW_PHY_GENERIC_SPI_IF
003CF4         ?C0061?ZW_PHY_GENERIC_SPI_IF:
003CF4 7FAB              MOV      R7,#0ABH
003CF6         ?C0062?ZW_PHY_GENERIC_SPI_IF:
003CF6 31AA              ACALL    _ZW_SPI1_tx_set
003CF8 715F              ACALL    NVM_CS_disable
003CFA 90433A            MOV      DPTR,#bDeepPowerdown
003CFD E0                MOVX     A,@DPTR
003CFE 903BFF            MOV      DPTR,#deepPowerdown
003D01 F0                MOVX     @DPTR,A
003D02 7015              JNZ      ?C0063?ZW_PHY_GENERIC_SPI_IF
003D04         ?C0064?ZW_PHY_GENERIC_SPI_IF:
003D04 90433B            MOV      DPTR,#x
003D07 E0                MOVX     A,@DPTR
003D08 D3                SETB     C
003D09 9400              SUBB     A,#00H
003D0B 400C              JC       ?C0063?ZW_PHY_GENERIC_SPI_IF
003D0D 7FFF              MOV      R7,#0FFH
003D0F 31AA              ACALL    _ZW_SPI1_tx_set
003D11 90433B            MOV      DPTR,#x
003D14 E0                MOVX     A,@DPTR
003D15 14                DEC      A
003D16 F0                MOVX     @DPTR,A
003D17 80EB              SJMP     ?C0064?ZW_PHY_GENERIC_SPI_IF
003D19         ?C0063?ZW_PHY_GENERIC_SPI_IF:
003D19 E4                CLR      A
003D1A FF                MOV      R7,A
003D1B 71E0              ACALL    _ZW_SPI1_enable
003D1D         ?C0060?ZW_PHY_GENERIC_SPI_IF:
003D1D 22                RET      
----- FUNCTION _NVM_ext_deeppowerdown (END) -------


----- FUNCTION NVM_ext_init (BEGIN) -----
003D1E 7B01              MOV      R3,#01H
003D20 7A3B              MOV      R2,#HIGH NVRbNVMChipSelect
003D22 79F7              MOV      R1,#LOW NVRbNVMChipSelect
003D24 7F03              MOV      R7,#03H
003D26 F19C              ACALL    ?L?COM04BB
003D28 7A3C              MOV      R2,#HIGH NVRbNVMType
003D2A 7900              MOV      R1,#LOW NVRbNVMType
003D2C 7F08              MOV      R7,#08H
003D2E F19C              ACALL    ?L?COM04BB
003D30 7A3B              MOV      R2,#HIGH NVRbNVMSize
003D32 79FD              MOV      R1,#LOW NVRbNVMSize
003D34 7D02              MOV      R5,#02H
003D36 7F09              MOV      R7,#09H
003D38 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003D3B 7B01              MOV      R3,#01H
003D3D 7A3B              MOV      R2,#HIGH NVRbNVMPageSize
003D3F 79FB              MOV      R1,#LOW NVRbNVMPageSize
003D41 7D02              MOV      R5,#02H
003D43 7F0B              MOV      R7,#0BH
003D45 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003D48 903BFB            MOV      DPTR,#NVRbNVMPageSize
003D4B E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 29


003D4C FE                MOV      R6,A
003D4D A3                INC      DPTR
003D4E E0                MOVX     A,@DPTR
003D4F FF                MOV      R7,A
003D50 4E                ORL      A,R6
003D51 6006              JZ       ?C0068?ZW_PHY_GENERIC_SPI_IF
003D53 BEFF16            CJNE     R6,#0FFH,?C0067?ZW_PHY_GENERIC_SPI_IF
003D56 BFFF13            CJNE     R7,#0FFH,?C0067?ZW_PHY_GENERIC_SPI_IF
003D59         ?C0068?ZW_PHY_GENERIC_SPI_IF:
003D59 F1AC              ACALL    ?L?COM05BF
003D5B 5002              JNC      ?C0072?ZW_PHY_GENERIC_SPI_IF
003D5D 8004              SJMP     ?C0073?ZW_PHY_GENERIC_SPI_IF
003D5F         ?C0072?ZW_PHY_GENERIC_SPI_IF:
003D5F F1B5              ACALL    ?L?COM056D
003D61 8009              SJMP     ?C0067?ZW_PHY_GENERIC_SPI_IF
003D63         ?C0073?ZW_PHY_GENERIC_SPI_IF:
003D63 903BFB            MOV      DPTR,#NVRbNVMPageSize
003D66 E4                CLR      A
003D67 F0                MOVX     @DPTR,A
003D68 A3                INC      DPTR
003D69 7440              MOV      A,#040H
003D6B F0                MOVX     @DPTR,A
003D6C         ?C0067?ZW_PHY_GENERIC_SPI_IF:
003D6C F1AC              ACALL    ?L?COM05BF
003D6E 5002              JNC      ?C0077?ZW_PHY_GENERIC_SPI_IF
003D70 8008              SJMP     ?C0078?ZW_PHY_GENERIC_SPI_IF
003D72         ?C0077?ZW_PHY_GENERIC_SPI_IF:
003D72 903BF8            MOV      DPTR,#bNVMAddressSize
003D75 7403              MOV      A,#03H
003D77 F0                MOVX     @DPTR,A
003D78 8006              SJMP     ?C0074?ZW_PHY_GENERIC_SPI_IF
003D7A         ?C0078?ZW_PHY_GENERIC_SPI_IF:
003D7A 903BF8            MOV      DPTR,#bNVMAddressSize
003D7D 7402              MOV      A,#02H
003D7F F0                MOVX     @DPTR,A
003D80         ?C0074?ZW_PHY_GENERIC_SPI_IF:
003D80 903BF7            MOV      DPTR,#NVRbNVMChipSelect
003D83 E0                MOVX     A,@DPTR
003D84 1226B6            LCALL    ?C?CCASE
003D87 3DA3              DW       ?C0080?ZW_PHY_GENERIC_SPI_IF
003D89 04                DB       04H
003D8A 3DAE              DW       ?C0081?ZW_PHY_GENERIC_SPI_IF
003D8C 14                DB       014H
003D8D 3DB6              DW       ?C0082?ZW_PHY_GENERIC_SPI_IF
003D8F 15                DB       015H
003D90 3DBE              DW       ?C0083?ZW_PHY_GENERIC_SPI_IF
003D92 17                DB       017H
003D93 3DD4              DW       ?C0086?ZW_PHY_GENERIC_SPI_IF
003D95 30                DB       030H
003D96 3DDC              DW       ?C0087?ZW_PHY_GENERIC_SPI_IF
003D98 34                DB       034H
003D99 3DE4              DW       ?C0088?ZW_PHY_GENERIC_SPI_IF
003D9B 36                DB       036H
003D9C 3DEC              DW       ?C0089?ZW_PHY_GENERIC_SPI_IF
003D9E 37                DB       037H
003D9F 0000              DW       00H
003DA1 3DC9              DW       ?C0085?ZW_PHY_GENERIC_SPI_IF
003DA3         ?C0080?ZW_PHY_GENERIC_SPI_IF:
003DA3 75FF01            MOV      SFRPAGE,#01H
003DA6 5368EF            ANL      P0ShadowDIR,#0EFH
003DA9 8568FD            MOV      P0DIR,P0ShadowDIR
003DAC 8047              SJMP     ?C0079?ZW_PHY_GENERIC_SPI_IF
003DAE         ?C0081?ZW_PHY_GENERIC_SPI_IF:
003DAE 75FF01            MOV      SFRPAGE,#01H
003DB1 5369EF            ANL      P1ShadowDIR,#0EFH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 30


003DB4 800E              SJMP     ?C0201?ZW_PHY_GENERIC_SPI_IF
003DB6         ?C0082?ZW_PHY_GENERIC_SPI_IF:
003DB6 75FF01            MOV      SFRPAGE,#01H
003DB9 5369DF            ANL      P1ShadowDIR,#0DFH
003DBC         
003DBC 8006              SJMP     ?C0201?ZW_PHY_GENERIC_SPI_IF
003DBE         ?C0083?ZW_PHY_GENERIC_SPI_IF:
003DBE 75FF01            MOV      SFRPAGE,#01H
003DC1 53697F            ANL      P1ShadowDIR,#07FH
003DC4         
003DC4 8569C9            MOV      P1DIR,P1ShadowDIR
003DC7 802C              SJMP     ?C0079?ZW_PHY_GENERIC_SPI_IF
003DC9         ?C0085?ZW_PHY_GENERIC_SPI_IF:
003DC9 75FF01            MOV      SFRPAGE,#01H
003DCC 536ADF            ANL      P2ShadowDIR,#0DFH
003DCF 856ACA            MOV      P2DIR,P2ShadowDIR
003DD2 8021              SJMP     ?C0079?ZW_PHY_GENERIC_SPI_IF
003DD4         ?C0086?ZW_PHY_GENERIC_SPI_IF:
003DD4 75FF01            MOV      SFRPAGE,#01H
003DD7 536BFE            ANL      P3ShadowDIR,#0FEH
003DDA 8016              SJMP     ?C0204?ZW_PHY_GENERIC_SPI_IF
003DDC         ?C0087?ZW_PHY_GENERIC_SPI_IF:
003DDC 75FF01            MOV      SFRPAGE,#01H
003DDF 536BEF            ANL      P3ShadowDIR,#0EFH
003DE2         
003DE2 800E              SJMP     ?C0204?ZW_PHY_GENERIC_SPI_IF
003DE4         ?C0088?ZW_PHY_GENERIC_SPI_IF:
003DE4 75FF01            MOV      SFRPAGE,#01H
003DE7 536BBF            ANL      P3ShadowDIR,#0BFH
003DEA         
003DEA 8006              SJMP     ?C0204?ZW_PHY_GENERIC_SPI_IF
003DEC         ?C0089?ZW_PHY_GENERIC_SPI_IF:
003DEC 75FF01            MOV      SFRPAGE,#01H
003DEF 536B7F            ANL      P3ShadowDIR,#07FH
003DF2         
003DF2 856BCB            MOV      P3DIR,P3ShadowDIR
003DF5         ?C0079?ZW_PHY_GENERIC_SPI_IF:
003DF5 715F              ACALL    NVM_CS_disable
003DF7 7F11              MOV      R7,#011H
003DF9 F11E              ACALL    _ZW_SPI1_init
003DFB E4                CLR      A
003DFC FF                MOV      R7,A
003DFD 91C0              ACALL    _NVM_ext_deeppowerdown
003DFF 31B2              ACALL    NVM_read_id
003E01 903BF5            MOV      DPTR,#bNVMWriteCommand
003E04 7402              MOV      A,#02H
003E06 F0                MOVX     @DPTR,A
003E07 903BF9            MOV      DPTR,#memoryType
003E0A E0                MOVX     A,@DPTR
003E0B 247F              ADD      A,#07FH
003E0D 6009              JZ       ?C0092?ZW_PHY_GENERIC_SPI_IF
003E0F 04                INC      A
003E10 7015              JNZ      ?C0090?ZW_PHY_GENERIC_SPI_IF
003E12         ?C0091?ZW_PHY_GENERIC_SPI_IF:
003E12 F143              ACALL    ?L?COM05BE
003E14 740A              MOV      A,#0AH
003E16 8006              SJMP     ?C0205?ZW_PHY_GENERIC_SPI_IF
003E18         ?C0092?ZW_PHY_GENERIC_SPI_IF:
003E18 91A6              ACALL    NVM_setPageSize256
003E1A F143              ACALL    ?L?COM05BE
003E1C 7458              MOV      A,#058H
003E1E         
003E1E F0                MOVX     @DPTR,A
003E1F 903BF8            MOV      DPTR,#bNVMAddressSize
003E22 7403              MOV      A,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 31


003E24 F0                MOVX     @DPTR,A
003E25 F1B5              ACALL    ?L?COM056D
003E27         ?C0090?ZW_PHY_GENERIC_SPI_IF:
003E27 903BFA            MOV      DPTR,#memoryCapacity
003E2A E0                MOVX     A,@DPTR
003E2B F4                CPL      A
003E2C 6002              JZ       $ + 4H
003E2E C1C9              AJMP     ?C0094?ZW_PHY_GENERIC_SPI_IF
003E30 903BFD            MOV      DPTR,#NVRbNVMSize
003E33 E0                MOVX     A,@DPTR
003E34 FE                MOV      R6,A
003E35 A3                INC      DPTR
003E36 E0                MOVX     A,@DPTR
003E37 FF                MOV      R7,A
003E38 6410              XRL      A,#010H
003E3A 4E                ORL      A,R6
003E3B 7006              JNZ      ?C0095?ZW_PHY_GENERIC_SPI_IF
003E3D 903BFA            MOV      DPTR,#memoryCapacity
003E40 740E              MOV      A,#0EH
003E42 F0                MOVX     @DPTR,A
003E43         ?C0095?ZW_PHY_GENERIC_SPI_IF:
003E43 EF                MOV      A,R7
003E44 6420              XRL      A,#020H
003E46 4E                ORL      A,R6
003E47 7006              JNZ      ?C0096?ZW_PHY_GENERIC_SPI_IF
003E49 903BFA            MOV      DPTR,#memoryCapacity
003E4C 740F              MOV      A,#0FH
003E4E F0                MOVX     @DPTR,A
003E4F         ?C0096?ZW_PHY_GENERIC_SPI_IF:
003E4F EF                MOV      A,R7
003E50 6440              XRL      A,#040H
003E52 4E                ORL      A,R6
003E53 7006              JNZ      ?C0097?ZW_PHY_GENERIC_SPI_IF
003E55 903BFA            MOV      DPTR,#memoryCapacity
003E58 7410              MOV      A,#010H
003E5A F0                MOVX     @DPTR,A
003E5B         ?C0097?ZW_PHY_GENERIC_SPI_IF:
003E5B EF                MOV      A,R7
003E5C 6480              XRL      A,#080H
003E5E 4E                ORL      A,R6
003E5F 7006              JNZ      ?C0098?ZW_PHY_GENERIC_SPI_IF
003E61 903BFA            MOV      DPTR,#memoryCapacity
003E64 7411              MOV      A,#011H
003E66 F0                MOVX     @DPTR,A
003E67         ?C0098?ZW_PHY_GENERIC_SPI_IF:
003E67 E4                CLR      A
003E68 B5070A            CJNE     A,AR7,?C0099?ZW_PHY_GENERIC_SPI_IF
003E6B EE                MOV      A,R6
003E6C B40106            CJNE     A,#01H,?C0099?ZW_PHY_GENERIC_SPI_IF
003E6F 903BFA            MOV      DPTR,#memoryCapacity
003E72 7412              MOV      A,#012H
003E74 F0                MOVX     @DPTR,A
003E75         ?C0099?ZW_PHY_GENERIC_SPI_IF:
003E75 E4                CLR      A
003E76 B5070A            CJNE     A,AR7,?C0100?ZW_PHY_GENERIC_SPI_IF
003E79 EE                MOV      A,R6
003E7A B40206            CJNE     A,#02H,?C0100?ZW_PHY_GENERIC_SPI_IF
003E7D 903BFA            MOV      DPTR,#memoryCapacity
003E80 7413              MOV      A,#013H
003E82 F0                MOVX     @DPTR,A
003E83         ?C0100?ZW_PHY_GENERIC_SPI_IF:
003E83 E4                CLR      A
003E84 B5070A            CJNE     A,AR7,?C0101?ZW_PHY_GENERIC_SPI_IF
003E87 EE                MOV      A,R6
003E88 B40406            CJNE     A,#04H,?C0101?ZW_PHY_GENERIC_SPI_IF
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 32


003E8B 903BFA            MOV      DPTR,#memoryCapacity
003E8E 7414              MOV      A,#014H
003E90 F0                MOVX     @DPTR,A
003E91         ?C0101?ZW_PHY_GENERIC_SPI_IF:
003E91 E4                CLR      A
003E92 B5070A            CJNE     A,AR7,?C0102?ZW_PHY_GENERIC_SPI_IF
003E95 EE                MOV      A,R6
003E96 B40806            CJNE     A,#08H,?C0102?ZW_PHY_GENERIC_SPI_IF
003E99 903BFA            MOV      DPTR,#memoryCapacity
003E9C 7415              MOV      A,#015H
003E9E F0                MOVX     @DPTR,A
003E9F         ?C0102?ZW_PHY_GENERIC_SPI_IF:
003E9F E4                CLR      A
003EA0 B5070A            CJNE     A,AR7,?C0103?ZW_PHY_GENERIC_SPI_IF
003EA3 EE                MOV      A,R6
003EA4 B41006            CJNE     A,#010H,?C0103?ZW_PHY_GENERIC_SPI_IF
003EA7 903BFA            MOV      DPTR,#memoryCapacity
003EAA 7416              MOV      A,#016H
003EAC F0                MOVX     @DPTR,A
003EAD         ?C0103?ZW_PHY_GENERIC_SPI_IF:
003EAD E4                CLR      A
003EAE B5070A            CJNE     A,AR7,?C0104?ZW_PHY_GENERIC_SPI_IF
003EB1 EE                MOV      A,R6
003EB2 B42006            CJNE     A,#020H,?C0104?ZW_PHY_GENERIC_SPI_IF
003EB5 903BFA            MOV      DPTR,#memoryCapacity
003EB8 7417              MOV      A,#017H
003EBA F0                MOVX     @DPTR,A
003EBB         ?C0104?ZW_PHY_GENERIC_SPI_IF:
003EBB E4                CLR      A
003EBC B5070A            CJNE     A,AR7,?C0094?ZW_PHY_GENERIC_SPI_IF
003EBF EE                MOV      A,R6
003EC0 B44006            CJNE     A,#040H,?C0094?ZW_PHY_GENERIC_SPI_IF
003EC3 903BFA            MOV      DPTR,#memoryCapacity
003EC6 7418              MOV      A,#018H
003EC8 F0                MOVX     @DPTR,A
003EC9         ?C0094?ZW_PHY_GENERIC_SPI_IF:
003EC9 813B              AJMP     NVM_clearStatusReg
----- FUNCTION NVM_ext_init (END) -------


----- FUNCTION ?L?COM02D8 (BEGIN) -----
003ECB 7F01              MOV      R7,#01H
003ECD 71E0              ACALL    _ZW_SPI1_enable
003ECF 518C              ACALL    NVM_CS_enable
003ED1 7F03              MOV      R7,#03H
003ED3         ?L?COM02D9:
003ED3 31AA              ACALL    _ZW_SPI1_tx_set
003ED5 903BF8            MOV      DPTR,#bNVMAddressSize
003ED8 E0                MOVX     A,@DPTR
003ED9 22                RET      
----- FUNCTION ?L?COM02D8 (END) -------


----- FUNCTION ZW_WatchDogKick (BEGIN) -----
003EDA 75FF02            MOV      SFRPAGE,#02H
003EDD E5E4              MOV      A,WDTCON
003EDF 30E106            JNB      ACC.1,?C0042?ZW_MAIN
003EE2 75E406            MOV      WDTCON,#06H
003EE5 75E403            MOV      WDTCON,#03H
003EE8         ?C0042?ZW_MAIN:
003EE8 22                RET      
----- FUNCTION ZW_WatchDogKick (END) -------


----- FUNCTION ZW_Poll (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 33


003EE9 E515              MOV      A,RF_status
003EEB 30E20F            JNB      ACC.2,?C0077?ZW_MAIN
003EEE E515              MOV      A,RF_status
003EF0 20E50A            JB       ACC.5,?C0077?ZW_MAIN
003EF3 E515              MOV      A,RF_status
003EF5 30E005            JNB      ACC.0,?C0077?ZW_MAIN
003EF8 7F01              MOV      R7,#01H
003EFA 1236A5            LCALL    _ZW_SetRFReceiveMode
003EFD         ?C0077?ZW_MAIN:
003EFD 22                RET      
----- FUNCTION ZW_Poll (END) -------


----- FUNCTION ?L?COM02F1 (BEGIN) -----
003EFE 7E12              MOV      R6,#HIGH NVM_SYSTEM_STATE
003F00 7F0B              MOV      R7,#LOW NVM_SYSTEM_STATE
003F02 E4                CLR      A
003F03 FD                MOV      R5,A
003F04 F1C4              ACALL    _NVM_ext_write_byte
----- FUNCTION NVM_ext_flush (BEGIN) -----
003F06 D1DA              ACALL    ZW_WatchDogKick
003F08         ?C0176?ZW_PHY_GENERIC_SPI_IF:
003F08 5149              ACALL    NVM_ext_busy
003F0A EF                MOV      A,R7
003F0B 6004              JZ       ?C0178?ZW_PHY_GENERIC_SPI_IF
003F0D D1E9              ACALL    ZW_Poll
003F0F 80F7              SJMP     ?C0176?ZW_PHY_GENERIC_SPI_IF
003F11         ?C0178?ZW_PHY_GENERIC_SPI_IF:
003F11 22                RET      
----- FUNCTION NVM_ext_flush (END) -------


----- FUNCTION ?L?COM04BA (BEGIN) -----
003F12 122499            LCALL    ?C?LLDXDATA
003F15 E4                CLR      A
003F16 21AA              AJMP     _ZW_SPI1_tx_set
----- FUNCTION ?L?COM04BA (END) -------


----- FUNCTION ?L?COM05BD (BEGIN) -----
003F18 518C              ACALL    NVM_CS_enable
003F1A 7F05              MOV      R7,#05H
003F1C 21AA              AJMP     _ZW_SPI1_tx_set
----- FUNCTION ?L?COM05BD (END) -------


----- FUNCTION _ZW_SPI1_init (BEGIN) -----
;---- Variable 'bSpiInit' assigned to Register 'R7' ----
003F1E EF                MOV      A,R7
003F1F 4420              ORL      A,#020H
003F21 F5FE              MOV      SPI1CON,A
003F23 22                RET      
----- FUNCTION _ZW_SPI1_init (END) -------


----- FUNCTION ?L?COM0573 (BEGIN) -----
003F24 9003C2            MOV      DPTR,#bMainWakeUpReason
003F27 E0                MOVX     A,@DPTR
003F28 6401              XRL      A,#01H
003F2A 22                RET      
----- FUNCTION ?L?COM0573 (END) -------


----- FUNCTION ?L?COM0635 (BEGIN) -----
003F2B 90433B            MOV      DPTR,#x
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 34


003F2E F0                MOVX     @DPTR,A
003F2F 903BFF            MOV      DPTR,#deepPowerdown
003F32 22                RET      
----- FUNCTION ?L?COM0635 (END) -------


----- FUNCTION ?L?COM0636 (BEGIN) -----
003F33 904378            MOV      DPTR,#x
003F36 E0                MOVX     A,@DPTR
003F37 14                DEC      A
003F38 F0                MOVX     @DPTR,A
003F39 E0                MOVX     A,@DPTR
003F3A 22                RET      
----- FUNCTION ?L?COM0636 (END) -------


----- FUNCTION ?L?COM058A (BEGIN) -----
003F3B 518C              ACALL    NVM_CS_enable
003F3D 903BF5            MOV      DPTR,#bNVMWriteCommand
003F40 E0                MOVX     A,@DPTR
003F41 FF                MOV      R7,A
003F42 22                RET      
----- FUNCTION ?L?COM058A (END) -------


----- FUNCTION ?L?COM05BE (BEGIN) -----
003F43 7F10              MOV      R7,#010H
003F45 F11E              ACALL    _ZW_SPI1_init
003F47 903BF5            MOV      DPTR,#bNVMWriteCommand
003F4A 22                RET      
----- FUNCTION ?L?COM05BE (END) -------


----- FUNCTION ?L?COM00C9 (BEGIN) -----
003F4B 9039B1            MOV      DPTR,#nvmModuleDescriptorOldPtr
003F4E 122589            LCALL    ?C?PLDXDATA
003F51 AE02              MOV      R6,AR2
003F53 AF01              MOV      R7,AR1
003F55 7B01              MOV      R3,#01H
003F57 7A39              MOV      R2,#HIGH dataLengthOld
003F59 79C0              MOV      R1,#LOW dataLengthOld
003F5B         ?L?COM00CA:
003F5B 9040B9            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
003F5E 7402              MOV      A,#02H
003F60 F0                MOVX     @DPTR,A
----- FUNCTION _NVM_ext_read_buffer (BEGIN) -----
003F61 9040B6            MOV      DPTR,#buf
003F64 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'offset' assigned to Register 'R6/R7' ----
003F67 E4                CLR      A
003F68 FC                MOV      R4,A
003F69 FD                MOV      R5,A
003F6A C007              PUSH     AR7
003F6C 9040B6            MOV      DPTR,#buf
003F6F 122589            LCALL    ?C?PLDXDATA
003F72 9040B9            MOV      DPTR,#length
003F75 E0                MOVX     A,@DPTR
003F76 903E70            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
003F79 F1DA              ACALL    ?L?COM0212
003F7B D007              POP      AR7
003F7D 8158              AJMP     _NVM_ext_read_long_buffer
----- FUNCTION _NVM_ext_read_buffer (END) -------


----- FUNCTION ?L?COM0081 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 35


003F7F E4                CLR      A
003F80         ?L?COM0082:
003F80 75F001            MOV      B,#01H
003F83 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM0081 (END) -------


----- FUNCTION ?L?COM043F (BEGIN) -----
003F86 AE02              MOV      R6,AR2
003F88 AF01              MOV      R7,AR1
003F8A 7B01              MOV      R3,#01H
003F8C 22                RET      
----- FUNCTION ?L?COM043F (END) -------


----- FUNCTION ?L?COM04AF (BEGIN) -----
003F8D 74FF              MOV      A,#0FFH
003F8F F5F0              MOV      B,A
003F91 022159            LJMP     ?C?ILDIX
----- FUNCTION ?L?COM04AF (END) -------


----- FUNCTION ?L?COM00BF (BEGIN) -----
003F94 FF                MOV      R7,A
003F95         ?L?COM00C0:
003F95 122589            LCALL    ?C?PLDXDATA
003F98 EF                MOV      A,R7
003F99 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM00BF (END) -------


----- FUNCTION ?L?COM04BB (BEGIN) -----
003F9C 7D01              MOV      R5,#01H
003F9E 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003FA1 7B01              MOV      R3,#01H
003FA3 22                RET      
----- FUNCTION ?L?COM04BB (END) -------


----- FUNCTION ?L?COM0634 (BEGIN) -----
003FA4 F0                MOVX     @DPTR,A
003FA5 903BF2            MOV      DPTR,#spiNVMstatus1
003FA8 E0                MOVX     A,@DPTR
003FA9 FF                MOV      R7,A
003FAA F4                CPL      A
003FAB 22                RET      
----- FUNCTION ?L?COM0634 (END) -------


----- FUNCTION ?L?COM05BF (BEGIN) -----
003FAC 903C00            MOV      DPTR,#NVRbNVMType
003FAF E0                MOVX     A,@DPTR
003FB0 24FE              ADD      A,#0FEH
003FB2 24FD              ADD      A,#0FDH
003FB4 22                RET      
----- FUNCTION ?L?COM05BF (END) -------


----- FUNCTION ?L?COM056D (BEGIN) -----
003FB5 903BFB            MOV      DPTR,#NVRbNVMPageSize
003FB8 7401              MOV      A,#01H
003FBA F0                MOVX     @DPTR,A
003FBB A3                INC      DPTR
003FBC E4                CLR      A
003FBD F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 36


003FBE 22                RET      
----- FUNCTION ?L?COM056D (END) -------


----- FUNCTION ?L?COM030D (BEGIN) -----
003FBF FE                MOV      R6,A
003FC0 AF01              MOV      R7,AR1
003FC2 E4                CLR      A
003FC3 FD                MOV      R5,A
----- FUNCTION _NVM_ext_write_byte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R3' ----
003FC4 AB05              MOV      R3,AR5
;---- Variable 'offset' assigned to Register 'R6/R7' ----
003FC6 E4                CLR      A
003FC7 FC                MOV      R4,A
003FC8 FD                MOV      R5,A
003FC9 904176            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
003FCC EB                MOV      A,R3
003FCD F0                MOVX     @DPTR,A
003FCE 61EC              AJMP     _NVM_ext_write_long_byte
----- FUNCTION _NVM_ext_write_byte (END) -------


----- FUNCTION NVM_ext_off (BEGIN) -----
003FD0 E4                CLR      A
003FD1 FF                MOV      R7,A
003FD2 61E0              AJMP     _ZW_SPI1_enable
----- FUNCTION NVM_ext_off (END) -------


----- FUNCTION ZW_SPI1_active_get (BEGIN) -----
003FD4 E5C8              MOV      A,SPISTAT
003FD6 5404              ANL      A,#04H
003FD8 FF                MOV      R7,A
003FD9 22                RET      
----- FUNCTION ZW_SPI1_active_get (END) -------


----- FUNCTION ?L?COM0212 (BEGIN) -----
003FDA FF                MOV      R7,A
003FDB E4                CLR      A
003FDC F0                MOVX     @DPTR,A
003FDD A3                INC      DPTR
003FDE EF                MOV      A,R7
003FDF F0                MOVX     @DPTR,A
003FE0 22                RET      
----- FUNCTION ?L?COM0212 (END) -------


----- FUNCTION ?L?COM04BF (BEGIN) -----
003FE1 901223            MOV      DPTR,#homeID
003FE4 E0                MOVX     A,@DPTR
003FE5 FF                MOV      R7,A
003FE6 A3                INC      DPTR
003FE7 E0                MOVX     A,@DPTR
003FE8 22                RET      
----- FUNCTION ?L?COM04BF (END) -------


----- FUNCTION ?L?COM0622 (BEGIN) -----
003FE9 126C78            LCALL    _NVM_ext_write_buffer
003FEC 74FF              MOV      A,#0FFH
003FEE FD                MOV      R5,A
003FEF FC                MOV      R4,A
003FF0 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 37


----- FUNCTION ?L?COM0622 (END) -------


----- FUNCTION NS_IncTxFrames (BEGIN) -----
003FF1 127290            LCALL    ?L?COM0439
003FF4 5002              JNC      ?C0104?ZW_RF_DRIVER
003FF6 F17F              ACALL    ?L?COM0081
003FF8         ?C0104?ZW_RF_DRIVER:
003FF8 22                RET      
----- FUNCTION NS_IncTxFrames (END) -------


----- FUNCTION ZW_WatchDogEnable (BEGIN) -----
003FF9 75FF02            MOV      SFRPAGE,#02H
003FFC 75E404            MOV      WDTCON,#04H
003FFF 75E401            MOV      WDTCON,#01H
004002 75E402            MOV      WDTCON,#02H
004005 22                RET      
----- FUNCTION ZW_WatchDogEnable (END) -------


----- FUNCTION ZW_WatchDogDisable (BEGIN) -----
004006 75FF02            MOV      SFRPAGE,#02H
004009 75E404            MOV      WDTCON,#04H
00400C E4                CLR      A
00400D F5E4              MOV      WDTCON,A
00400F 22                RET      
----- FUNCTION ZW_WatchDogDisable (END) -------


----- FUNCTION main_PowerDown_Setup (BEGIN) -----
004010 1251E9            LCALL    getTickTime
004013 9003CA            MOV      DPTR,#bSleepWaitTimeout
004016 EE                MOV      A,R6
004017 F0                MOVX     @DPTR,A
004018 A3                INC      DPTR
004019 EF                MOV      A,R7
00401A F0                MOVX     @DPTR,A
00401B 22                RET      
----- FUNCTION main_PowerDown_Setup (END) -------


----- FUNCTION _ZCB_NetworkManagementExploreRequestComplete (BEGIN) -----
00401C 1261BD            LCALL    NetworkManagementSmartStartIsInclude
00401F EF                MOV      A,R7
004020 7008              JNZ      ?C0031?ZW_NETWORK_MANAGEMENT
004022 7FA0              MOV      R7,#0A0H
004024 7E0F              MOV      R6,#0FH
004026 FD                MOV      R5,A
004027 FC                MOV      R4,A
004028 01BC              AJMP     ?C0104?ZW_NETWORK_MANAGEMENT
00402A         ?C0031?ZW_NETWORK_MANAGEMENT:
00402A F1E4              ACALL    NetworkManagementSmartStartCurrentRequestNo
00402C 903D2D            MOV      DPTR,#bRequestNo
00402F EF                MOV      A,R7
004030 F0                MOVX     @DPTR,A
004031 7406              MOV      A,#06H
004033 D3                SETB     C
004034 9F                SUBB     A,R7
004035 4067              JC       ?C0033?ZW_NETWORK_MANAGEMENT
004037 E0                MOVX     A,@DPTR
004038 605A              JZ       ?C0034?ZW_NETWORK_MANAGEMENT
00403A 3136              ACALL    ?L?COM05C4
00403C 7E00              MOV      R6,#00H
00403E 903D2D            MOV      DPTR,#bRequestNo
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 38


004041 E0                MOVX     A,@DPTR
004042 14                DEC      A
004043 FD                MOV      R5,A
004044 E5F0              MOV      A,B
004046 A805              MOV      R0,AR5
004048 08                INC      R0
004049 8005              SJMP     ?C0098?ZW_NETWORK_MANAGEMENT
00404B         ?C0097?ZW_NETWORK_MANAGEMENT:
00404B C3                CLR      C
00404C 33                RLC      A
00404D CE                XCH      A,R6
00404E 33                RLC      A
00404F CE                XCH      A,R6
004050         ?C0098?ZW_NETWORK_MANAGEMENT:
004050 D8F9              DJNZ     R0,?C0097?ZW_NETWORK_MANAGEMENT
004052 FF                MOV      R7,A
004053 312F              ACALL    ?L?COM063A
004055 311B              ACALL    ?L?COM020D
004057 903D2E            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
00405A 1224B5            LCALL    ?C?LLDXDATA0
00405D C000              PUSH     AR0
00405F C001              PUSH     AR1
004061 C002              PUSH     AR2
004063 C003              PUSH     AR3
004065 903D2D            MOV      DPTR,#bRequestNo
004068 E0                MOVX     A,@DPTR
004069 14                DEC      A
00406A FF                MOV      R7,A
00406B 7410              MOV      A,#010H
00406D 7E00              MOV      R6,#00H
00406F A807              MOV      R0,AR7
004071 08                INC      R0
004072 8005              SJMP     ?C0100?ZW_NETWORK_MANAGEMENT
004074         ?C0099?ZW_NETWORK_MANAGEMENT:
004074 C3                CLR      C
004075 33                RLC      A
004076 CE                XCH      A,R6
004077 33                RLC      A
004078 CE                XCH      A,R6
004079         ?C0100?ZW_NETWORK_MANAGEMENT:
004079 D8F9              DJNZ     R0,?C0099?ZW_NETWORK_MANAGEMENT
00407B FF                MOV      R7,A
00407C EE                MOV      A,R6
00407D 33                RLC      A
00407E 95E0              SUBB     A,ACC
004080 FD                MOV      R5,A
004081 FC                MOV      R4,A
004082 3127              ACALL    ?L?COM034A
004084 122286            LCALL    ?C?LMUL
004087 D003              POP      AR3
004089 D002              POP      AR2
00408B D001              POP      AR1
00408D D000              POP      AR0
00408F 12226B            LCALL    ?C?LADD
004092         
004092 8028              SJMP     ?C0104?ZW_NETWORK_MANAGEMENT
004094         ?C0034?ZW_NETWORK_MANAGEMENT:
004094 3136              ACALL    ?L?COM05C4
004096 AFF0              MOV      R7,B
004098 7E00              MOV      R6,#00H
00409A 312F              ACALL    ?L?COM063A
00409C 801E              SJMP     ?C0105?ZW_NETWORK_MANAGEMENT
00409E         ?C0033?ZW_NETWORK_MANAGEMENT:
00409E 903D35            MOV      DPTR,#bInclusionRequestIntervals
0040A1 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 39


0040A2 FF                MOV      R7,A
0040A3 600F              JZ       ?C0037?ZW_NETWORK_MANAGEMENT
0040A5 E4                CLR      A
0040A6 FC                MOV      R4,A
0040A7 FD                MOV      R5,A
0040A8 FE                MOV      R6,A
0040A9 FB                MOV      R3,A
0040AA 7AF4              MOV      R2,#0F4H
0040AC 7901              MOV      R1,#01H
0040AE F8                MOV      R0,A
0040AF 122286            LCALL    ?C?LMUL
0040B2 8008              SJMP     ?C0102?ZW_NETWORK_MANAGEMENT
0040B4         ?C0037?ZW_NETWORK_MANAGEMENT:
0040B4 7F00              MOV      R7,#00H
0040B6 7ED0              MOV      R6,#0D0H
0040B8 7D07              MOV      R5,#07H
0040BA 7C00              MOV      R4,#00H
0040BC         
0040BC         
0040BC         
0040BC 311B              ACALL    ?L?COM020D
0040BE         ?C0032?ZW_NETWORK_MANAGEMENT:
0040BE 3149              ACALL    NetworkManagementSmartStartNextState
0040C0 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
0040C2 7F75              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
0040C4 C006              PUSH     AR6
0040C6 C007              PUSH     AR7
0040C8 3113              ACALL    ?L?COM0440
0040CA D180              ACALL    ?L?COM0239
0040CC D007              POP      AR7
0040CE D006              POP      AR6
0040D0 7162              ACALL    ?L?COM0397
0040D2 1261CE            LCALL    NetworkManagementSmartStartIsListeningNode
0040D5 EF                MOV      A,R7
0040D6 703A              JNZ      ?C0043?ZW_NETWORK_MANAGEMENT
0040D8 3121              ACALL    ?L?COM0349
0040DA D3                SETB     C
0040DB 1223D4            LCALL    ?C?ULCMP
0040DE 4007              JC       ?C0040?ZW_NETWORK_MANAGEMENT
0040E0 E4                CLR      A
0040E1 7F01              MOV      R7,#01H
0040E3 FE                MOV      R6,A
0040E4 FD                MOV      R5,A
0040E5 8022              SJMP     ?C0106?ZW_NETWORK_MANAGEMENT
0040E7         ?C0040?ZW_NETWORK_MANAGEMENT:
0040E7 3121              ACALL    ?L?COM0349
0040E9 122311            LCALL    ?C?ULDIV
0040EC 311B              ACALL    ?L?COM020D
0040EE 3113              ACALL    ?L?COM0440
0040F0 E4                CLR      A
0040F1 7B01              MOV      R3,#01H
0040F3 D1C2              ACALL    ?L?COM04AD
0040F5 5014              JNC      ?C0041?ZW_NETWORK_MANAGEMENT
0040F7 3113              ACALL    ?L?COM0440
0040F9 C3                CLR      C
0040FA EF                MOV      A,R7
0040FB 9401              SUBB     A,#01H
0040FD FF                MOV      R7,A
0040FE EE                MOV      A,R6
0040FF 9400              SUBB     A,#00H
004101 FE                MOV      R6,A
004102 ED                MOV      A,R5
004103 9400              SUBB     A,#00H
004105 FD                MOV      R5,A
004106 EC                MOV      A,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 40


004107 9400              SUBB     A,#00H
004109         
004109 311A              ACALL    ?L?COM020C
00410B         ?C0041?ZW_NETWORK_MANAGEMENT:
00410B 3113              ACALL    ?L?COM0440
00410D 121BF6            LCALL    ?INTERBANK_TABLE?_Power_Management_SetTimeout
004110 1110              ACALL    main_PowerDown_Setup
004112         ?C0043?ZW_NETWORK_MANAGEMENT:
004112 22                RET      
----- FUNCTION _ZCB_NetworkManagementExploreRequestComplete (END) -------


----- FUNCTION ?L?COM0440 (BEGIN) -----
004113 903D2E            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
004116 022499            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM0440 (END) -------


----- FUNCTION ?L?COM020B (BEGIN) -----
004119 FD                MOV      R5,A
00411A         ?L?COM020C:
00411A FC                MOV      R4,A
00411B         ?L?COM020D:
00411B 903D2E            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
00411E 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM020B (END) -------


----- FUNCTION ?L?COM0349 (BEGIN) -----
004121 903D2E            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
004124 122499            LCALL    ?C?LLDXDATA
004127         ?L?COM034A:
004127 E4                CLR      A
004128 7BE8              MOV      R3,#0E8H
00412A 7A03              MOV      R2,#03H
00412C F9                MOV      R1,A
00412D F8                MOV      R0,A
00412E 22                RET      
----- FUNCTION ?L?COM0349 (END) -------


----- FUNCTION ?L?COM063A (BEGIN) -----
00412F 7C00              MOV      R4,#00H
004131 7D64              MOV      R5,#064H
004133 022740            LJMP     ?C?LIMUL
----- FUNCTION ?L?COM063A (END) -------


----- FUNCTION ?L?COM05C4 (BEGIN) -----
004136 313E              ACALL    ZW_Random
004138 EF                MOV      A,R7
004139 75F0A0            MOV      B,#0A0H
00413C 84                DIV      AB
00413D 22                RET      
----- FUNCTION ?L?COM05C4 (END) -------


----- FUNCTION ZW_Random (BEGIN) -----
00413E 9003BB            MOV      DPTR,#randomSeed
004141 E0                MOVX     A,@DPTR
004142 64AA              XRL      A,#0AAH
004144 2411              ADD      A,#011H
004146 FF                MOV      R7,A
004147 F0                MOVX     @DPTR,A
004148 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 41


----- FUNCTION ZW_Random (END) -------


----- FUNCTION NetworkManagementSmartStartNextState (BEGIN) -----
004149 D1D0              ACALL    NetworkManagementWUTPowerDownInterrupted
00414B EF                MOV      A,R7
00414C 600F              JZ       ?C0013?ZW_NETWORK_MANAGEMENT
00414E E4                CLR      A
00414F 7FA0              MOV      R7,#0A0H
004151 7E0F              MOV      R6,#0FH
004153 3119              ACALL    ?L?COM020B
004155 901217            MOV      DPTR,#eSystemTypeState
004158 E0                MOVX     A,@DPTR
004159 54E7              ANL      A,#0E7H
00415B F0                MOVX     @DPTR,A
00415C 22                RET      
00415D         ?C0013?ZW_NETWORK_MANAGEMENT:
00415D 901217            MOV      DPTR,#eSystemTypeState
004160 E0                MOVX     A,@DPTR
004161 FF                MOV      R7,A
004162 74E0              MOV      A,#0E0H
004164 D3                SETB     C
004165 9F                SUBB     A,R7
004166 4005              JC       ?C0015?ZW_NETWORK_MANAGEMENT
004168 E0                MOVX     A,@DPTR
004169 2410              ADD      A,#010H
00416B F0                MOVX     @DPTR,A
00416C 22                RET      
00416D         ?C0015?ZW_NETWORK_MANAGEMENT:
00416D EF                MOV      A,R7
00416E 6410              XRL      A,#010H
004170 901217            MOV      DPTR,#eSystemTypeState
004173 F0                MOVX     @DPTR,A
004174 22                RET      
----- FUNCTION NetworkManagementSmartStartNextState (END) -------


----- FUNCTION ZCB_NetworkManagementLearnNodeStateTimeout (BEGIN) -----
004175 9158              ACALL    ?L?COM030E
004177 903D32            MOV      DPTR,#learnState
00417A E0                MOVX     A,@DPTR
00417B B4020A            CJNE     A,#02H,?C0044?ZW_NETWORK_MANAGEMENT
00417E D1C9              ACALL    ?L?COM0639
004180 903D32            MOV      DPTR,#learnState
004183 7403              MOV      A,#03H
004185 F0                MOVX     @DPTR,A
004186 4113              AJMP     NetworkManagementLearnStateProcess
004188         ?C0044?ZW_NETWORK_MANAGEMENT:
004188 903D32            MOV      DPTR,#learnState
00418B E0                MOVX     A,@DPTR
00418C 6403              XRL      A,#03H
00418E 7069              JNZ      ?C0046?ZW_NETWORK_MANAGEMENT
004190 903D34            MOV      DPTR,#bIncReqCount
004193 E0                MOVX     A,@DPTR
004194 6056              JZ       ?C0047?ZW_NETWORK_MANAGEMENT
004196 903D36            MOV      DPTR,#NW_Action
004199 E0                MOVX     A,@DPTR
00419A B40105            CJNE     A,#01H,?C0048?ZW_NETWORK_MANAGEMENT
00419D 121BDD            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestInclusion
0041A0 800A              SJMP     ?C0049?ZW_NETWORK_MANAGEMENT
0041A2         ?C0048?ZW_NETWORK_MANAGEMENT:
0041A2 903D36            MOV      DPTR,#NW_Action
0041A5 E0                MOVX     A,@DPTR
0041A6 B40203            CJNE     A,#02H,?C0049?ZW_NETWORK_MANAGEMENT
0041A9 121BE2            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestExclusion
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 42


0041AC         ?C0049?ZW_NETWORK_MANAGEMENT:
0041AC 903D34            MOV      DPTR,#bIncReqCount
0041AF E0                MOVX     A,@DPTR
0041B0 14                DEC      A
0041B1 F0                MOVX     @DPTR,A
0041B2 E0                MOVX     A,@DPTR
0041B3 601F              JZ       ?C0051?ZW_NETWORK_MANAGEMENT
0041B5 313E              ACALL    ZW_Random
0041B7 EF                MOV      A,R7
0041B8 75F046            MOV      B,#046H
0041BB 84                DIV      AB
0041BC E5F0              MOV      A,B
0041BE 75F064            MOV      B,#064H
0041C1 A4                MUL      AB
0041C2 FF                MOV      R7,A
0041C3 EF                MOV      A,R7
0041C4 24A0              ADD      A,#0A0H
0041C6 FF                MOV      R7,A
0041C7 E5F0              MOV      A,B
0041C9 340F              ADDC     A,#0FH
0041CB FE                MOV      R6,A
0041CC E4                CLR      A
0041CD 33                RLC      A
0041CE FD                MOV      R5,A
0041CF E4                CLR      A
0041D0 33                RLC      A
0041D1 FC                MOV      R4,A
0041D2 8007              SJMP     ?C0052?ZW_NETWORK_MANAGEMENT
0041D4         ?C0051?ZW_NETWORK_MANAGEMENT:
0041D4 E4                CLR      A
0041D5 7FA0              MOV      R7,#0A0H
0041D7 7E0F              MOV      R6,#0FH
0041D9 FD                MOV      R5,A
0041DA FC                MOV      R4,A
0041DB         ?C0052?ZW_NETWORK_MANAGEMENT:
0041DB 903F1E            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+02H
0041DE 1224F1            LCALL    ?C?LSTXDATA
0041E1 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
0041E3 7F75              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
0041E5 E4                CLR      A
0041E6 903F22            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+06H
0041E9 F0                MOVX     @DPTR,A
0041EA 6162              AJMP     ?L?COM0397
0041EC         ?C0047?ZW_NETWORK_MANAGEMENT:
0041EC 903D32            MOV      DPTR,#learnState
0041EF 7401              MOV      A,#01H
0041F1 F0                MOVX     @DPTR,A
0041F2 5113              ACALL    NetworkManagementLearnStateProcess
0041F4 7FFD              MOV      R7,#0FDH
0041F6 021DF4            LJMP     ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
0041F9         ?C0046?ZW_NETWORK_MANAGEMENT:
0041F9 903D32            MOV      DPTR,#learnState
0041FC E0                MOVX     A,@DPTR
0041FD B4040F            CJNE     A,#04H,?C0058?ZW_NETWORK_MANAGEMENT
004200 D1D0              ACALL    NetworkManagementWUTPowerDownInterrupted
004202 EF                MOV      A,R7
004203 6007              JZ       ?C0056?ZW_NETWORK_MANAGEMENT
004205 127070            LCALL    ?L?COM00E1
004208 E4                CLR      A
004209 FF                MOV      R7,A
00420A 011C              AJMP     _ZCB_NetworkManagementExploreRequestComplete
00420C         ?C0056?ZW_NETWORK_MANAGEMENT:
00420C 121BDD            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestInclusion
00420F         ?C0058?ZW_NETWORK_MANAGEMENT:
00420F 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 43


----- FUNCTION ZCB_NetworkManagementLearnNodeStateTimeout (END) -------


----- FUNCTION ?L?COM0572 (BEGIN) -----
004210 7401              MOV      A,#01H
004212 F0                MOVX     @DPTR,A
----- FUNCTION NetworkManagementLearnStateProcess (BEGIN) -----
004213 903D32            MOV      DPTR,#learnState
004216 E0                MOVX     A,@DPTR
004217 6402              XRL      A,#02H
004219 7022              JNZ      ?C0059?ZW_NETWORK_MANAGEMENT
00421B 7C43              MOV      R4,#HIGH _ZCB_NetworkManagementLearnModeCompleted
00421D 7DCF              MOV      R5,#LOW _ZCB_NetworkManagementLearnModeCompleted
00421F 7F01              MOV      R7,#01H
004221 1219F8            LCALL    ?INTERBANK_TABLE?_InternSetLearnMode
004224 E4                CLR      A
004225 FB                MOV      R3,A
004226 FA                MOV      R2,A
004227 FD                MOV      R5,A
004228 7FFF              MOV      R7,#0FFH
00422A 1219E4            LCALL    ?INTERBANK_TABLE?_ZW_SendNodeInformation
00422D 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
00422F 7F75              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
004231 C006              PUSH     AR6
004233 C007              PUSH     AR7
004235 D179              ACALL    ?L?COM0238
004237 D007              POP      AR7
004239 D006              POP      AR6
00423B 6162              AJMP     ?L?COM0397
00423D         ?C0059?ZW_NETWORK_MANAGEMENT:
00423D 903D32            MOV      DPTR,#learnState
004240 E0                MOVX     A,@DPTR
004241 6403              XRL      A,#03H
004243 7017              JNZ      ?C0061?ZW_NETWORK_MANAGEMENT
004245 FF                MOV      R7,A
004246 FE                MOV      R6,A
004247 3119              ACALL    ?L?COM020B
004249 903D36            MOV      DPTR,#NW_Action
00424C E0                MOVX     A,@DPTR
00424D 7C43              MOV      R4,#HIGH _ZCB_NetworkManagementLearnModeCompleted
00424F 7DCF              MOV      R5,#LOW _ZCB_NetworkManagementLearnModeCompleted
004251 B40204            CJNE     A,#02H,?C0062?ZW_NETWORK_MANAGEMENT
004254 7F03              MOV      R7,#03H
004256 8011              SJMP     ?C0108?ZW_NETWORK_MANAGEMENT
004258         ?C0062?ZW_NETWORK_MANAGEMENT:
004258 7F02              MOV      R7,#02H
00425A         
00425A 800D              SJMP     ?C0108?ZW_NETWORK_MANAGEMENT
00425C         ?C0061?ZW_NETWORK_MANAGEMENT:
00425C 903D32            MOV      DPTR,#learnState
00425F E0                MOVX     A,@DPTR
004260 B4040B            CJNE     A,#04H,?C0065?ZW_NETWORK_MANAGEMENT
004263 7C43              MOV      R4,#HIGH _ZCB_NetworkManagementLearnModeCompleted
004265 7DCF              MOV      R5,#LOW _ZCB_NetworkManagementLearnModeCompleted
004267 7F04              MOV      R7,#04H
004269         
004269 1219F8            LCALL    ?INTERBANK_TABLE?_InternSetLearnMode
00426C 2175              AJMP     ZCB_NetworkManagementLearnNodeStateTimeout
00426E         ?C0065?ZW_NETWORK_MANAGEMENT:
00426E 903D32            MOV      DPTR,#learnState
004271 E0                MOVX     A,@DPTR
004272 B4010B            CJNE     A,#01H,?C0068?ZW_NETWORK_MANAGEMENT
004275 D1C9              ACALL    ?L?COM0639
004277 9158              ACALL    ?L?COM030E
004279 715A              ACALL    NetworkManagementSmartStartClear
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 44


00427B E4                CLR      A
00427C 903D32            MOV      DPTR,#learnState
00427F F0                MOVX     @DPTR,A
004280         ?C0068?ZW_NETWORK_MANAGEMENT:
004280 22                RET      
----- FUNCTION NetworkManagementLearnStateProcess (END) -------


----- FUNCTION _ZW_NetworkLearnModeStart (BEGIN) -----
004281 904376            MOV      DPTR,#bMode
004284 EF                MOV      A,R7
004285 F0                MOVX     @DPTR,A
004286 C22B              CLR      bSmartStartLearn
004288 901221            MOV      DPTR,#nodeID
00428B E0                MOVX     A,@DPTR
00428C 6020              JZ       ?C0076?ZW_NETWORK_MANAGEMENT
00428E 7E12              MOV      R6,#HIGH NVM_SYSTEM_STATE
004290 7F0B              MOV      R7,#LOW NVM_SYSTEM_STATE
004292 123964            LCALL    _NVM_ext_read_byte
004295 BF0108            CJNE     R7,#01H,?C0077?ZW_NETWORK_MANAGEMENT
004298 7FFF              MOV      R7,#0FFH
00429A 121DF4            LCALL    ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
00429D 7F00              MOV      R7,#00H
00429F 22                RET      
0042A0         ?C0077?ZW_NETWORK_MANAGEMENT:
0042A0 903D32            MOV      DPTR,#learnState
0042A3 E0                MOVX     A,@DPTR
0042A4 6008              JZ       ?C0076?ZW_NETWORK_MANAGEMENT
0042A6 901221            MOV      DPTR,#nodeID
0042A9 E0                MOVX     A,@DPTR
0042AA FF                MOV      R7,A
0042AB 121DF4            LCALL    ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
0042AE         ?C0076?ZW_NETWORK_MANAGEMENT:
0042AE 123EFE            LCALL    ?L?COM02F1
0042B1 904376            MOV      DPTR,#bMode
0042B4 E0                MOVX     A,@DPTR
0042B5 7002              JNZ      $ + 4H
0042B7 613A              AJMP     ?C0080?ZW_NETWORK_MANAGEMENT
0042B9 E4                CLR      A
0042BA 903D36            MOV      DPTR,#NW_Action
0042BD F0                MOVX     @DPTR,A
0042BE 903D32            MOV      DPTR,#learnState
0042C1 E0                MOVX     A,@DPTR
0042C2 6002              JZ       ?C0081?ZW_NETWORK_MANAGEMENT
0042C4 5110              ACALL    ?L?COM0572
0042C6         ?C0081?ZW_NETWORK_MANAGEMENT:
0042C6 904376            MOV      DPTR,#bMode
0042C9 E0                MOVX     A,@DPTR
0042CA FF                MOV      R7,A
0042CB B40107            CJNE     A,#01H,?C0082?ZW_NETWORK_MANAGEMENT
0042CE 903D36            MOV      DPTR,#NW_Action
0042D1 7401              MOV      A,#01H
0042D3 8009              SJMP     ?C0109?ZW_NETWORK_MANAGEMENT
0042D5         ?C0082?ZW_NETWORK_MANAGEMENT:
0042D5 EF                MOV      A,R7
0042D6 B40310            CJNE     A,#03H,?C0084?ZW_NETWORK_MANAGEMENT
0042D9 903D36            MOV      DPTR,#NW_Action
0042DC 7402              MOV      A,#02H
0042DE         
0042DE F0                MOVX     @DPTR,A
0042DF 715A              ACALL    NetworkManagementSmartStartClear
0042E1 903D34            MOV      DPTR,#bIncReqCount
0042E4 7404              MOV      A,#04H
0042E6 F0                MOVX     @DPTR,A
0042E7 8049              SJMP     ?C0110?ZW_NETWORK_MANAGEMENT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 45


0042E9         ?C0084?ZW_NETWORK_MANAGEMENT:
0042E9 EF                MOV      A,R7
0042EA 6404              XRL      A,#04H
0042EC 7036              JNZ      ?C0086?ZW_NETWORK_MANAGEMENT
0042EE 901221            MOV      DPTR,#nodeID
0042F1 E0                MOVX     A,@DPTR
0042F2 701F              JNZ      ?C0087?ZW_NETWORK_MANAGEMENT
0042F4 D22B              SETB     bSmartStartLearn
0042F6 D15E              ACALL    NetworkManagementSmartStartIsEnabled
0042F8 EF                MOV      A,R7
0042F9 7010              JNZ      ?C0088?ZW_NETWORK_MANAGEMENT
0042FB 715A              ACALL    NetworkManagementSmartStartClear
0042FD F1CB              ACALL    NetworkManagementSmartStartEnable
0042FF 7E12              MOV      R6,#HIGH NVM_SYSTEM_STATE
004301 7F0B              MOV      R7,#LOW NVM_SYSTEM_STATE
004303 7D01              MOV      R5,#01H
004305 123FC4            LCALL    _NVM_ext_write_byte
004308 123F06            LCALL    NVM_ext_flush
00430B         ?C0088?ZW_NETWORK_MANAGEMENT:
00430B 903D32            MOV      DPTR,#learnState
00430E 7404              MOV      A,#04H
004310 F0                MOVX     @DPTR,A
004311 803A              SJMP     ?C0093?ZW_NETWORK_MANAGEMENT
004313         ?C0087?ZW_NETWORK_MANAGEMENT:
004313 9003C2            MOV      DPTR,#bMainWakeUpReason
004316 E0                MOVX     A,@DPTR
004317 B40505            CJNE     A,#05H,?C0090?ZW_NETWORK_MANAGEMENT
00431A E4                CLR      A
00431B F0                MOVX     @DPTR,A
00431C 121BD8            LCALL    ?INTERBANK_TABLE?ExploreINIF
00431F         ?C0090?ZW_NETWORK_MANAGEMENT:
00431F 715A              ACALL    NetworkManagementSmartStartClear
004321 7F00              MOV      R7,#00H
004323 22                RET      
004324         ?C0086?ZW_NETWORK_MANAGEMENT:
004324 904376            MOV      DPTR,#bMode
004327 E0                MOVX     A,@DPTR
004328 6402              XRL      A,#02H
00432A 7021              JNZ      ?C0093?ZW_NETWORK_MANAGEMENT
00432C 903D34            MOV      DPTR,#bIncReqCount
00432F F0                MOVX     @DPTR,A
004330 715A              ACALL    NetworkManagementSmartStartClear
004332         
004332 903D32            MOV      DPTR,#learnState
004335 7402              MOV      A,#02H
004337 F0                MOVX     @DPTR,A
004338 8013              SJMP     ?C0093?ZW_NETWORK_MANAGEMENT
00433A         ?C0080?ZW_NETWORK_MANAGEMENT:
00433A E4                CLR      A
00433B 903D36            MOV      DPTR,#NW_Action
00433E F0                MOVX     @DPTR,A
00433F D15E              ACALL    NetworkManagementSmartStartIsEnabled
004341 EF                MOV      A,R7
004342 6003              JZ       ?C0094?ZW_NETWORK_MANAGEMENT
004344 123EFE            LCALL    ?L?COM02F1
004347         ?C0094?ZW_NETWORK_MANAGEMENT:
004347 903D32            MOV      DPTR,#learnState
00434A 7401              MOV      A,#01H
00434C F0                MOVX     @DPTR,A
00434D         ?C0093?ZW_NETWORK_MANAGEMENT:
00434D 5113              ACALL    NetworkManagementLearnStateProcess
00434F 903D32            MOV      DPTR,#learnState
004352 E0                MOVX     A,@DPTR
004353 7F00              MOV      R7,#00H
004355 6002              JZ       ?C0095?ZW_NETWORK_MANAGEMENT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 46


004357 7F01              MOV      R7,#01H
004359         ?C0095?ZW_NETWORK_MANAGEMENT:
004359 22                RET      
----- FUNCTION _ZW_NetworkLearnModeStart (END) -------


----- FUNCTION NetworkManagementSmartStartClear (BEGIN) -----
00435A 901217            MOV      DPTR,#eSystemTypeState
00435D E0                MOVX     A,@DPTR
00435E 5403              ANL      A,#03H
004360 F0                MOVX     @DPTR,A
004361 22                RET      
----- FUNCTION NetworkManagementSmartStartClear (END) -------


----- FUNCTION ?L?COM0397 (BEGIN) -----
004362 716A              ACALL    _ZW_TimerLongStart
004364 903D37            MOV      DPTR,#learnStateHandle
004367 EF                MOV      A,R7
004368 F0                MOVX     @DPTR,A
004369 22                RET      
----- FUNCTION ?L?COM0397 (END) -------


----- FUNCTION _ZW_TimerLongStart (BEGIN) -----
00436A 903F1C            MOV      DPTR,#func
00436D EE                MOV      A,R6
00436E F0                MOVX     @DPTR,A
00436F A3                INC      DPTR
004370 EF                MOV      A,R7
004371 F0                MOVX     @DPTR,A
;---- Variable 'bHandle' assigned to Register 'R7' ----
004372 7FFF              MOV      R7,#0FFH
004374 A3                INC      DPTR
004375 1224B5            LCALL    ?C?LLDXDATA0
004378 E8                MOV      A,R0
004379 49                ORL      A,R1
00437A 4A                ORL      A,R2
00437B 4B                ORL      A,R3
00437C 6050              JZ       ?C0033?ZW_TIMER
00437E 903F23            MOV      DPTR,#bTimerHandle
004381 7403              MOV      A,#03H
004383 F0                MOVX     @DPTR,A
004384         ?C0034?ZW_TIMER:
004384 903F23            MOV      DPTR,#bTimerHandle
004387 E0                MOVX     A,@DPTR
004388 FE                MOV      R6,A
004389 C3                CLR      C
00438A 940E              SUBB     A,#0EH
00438C 5040              JNC      ?C0033?ZW_TIMER
00438E EE                MOV      A,R6
00438F 918D              ACALL    ?L?COM014C
004391 E0                MOVX     A,@DPTR
004392 7032              JNZ      ?C0036?ZW_TIMER
004394 903F23            MOV      DPTR,#bTimerHandle
004397 918B              ACALL    ?L?COM014B
004399 7405              MOV      A,#05H
00439B F0                MOVX     @DPTR,A
00439C C007              PUSH     AR7
00439E 903F1E            MOV      DPTR,#dwtimerTicks
0043A1 122499            LCALL    ?C?LLDXDATA
0043A4 903F17            MOV      DPTR,#?_TimerSave?BYTE+03H
0043A7 1224F1            LCALL    ?C?LSTXDATA
0043AA 903F22            MOV      DPTR,#brepeats
0043AD E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 47


0043AE 903F1B            MOV      DPTR,#?_TimerSave?BYTE+07H
0043B1 F0                MOVX     @DPTR,A
0043B2 903F1C            MOV      DPTR,#func
0043B5 E0                MOVX     A,@DPTR
0043B6 FC                MOV      R4,A
0043B7 A3                INC      DPTR
0043B8 E0                MOVX     A,@DPTR
0043B9 FD                MOV      R5,A
0043BA D007              POP      AR7
0043BC B174              ACALL    _TimerSave
0043BE 903F23            MOV      DPTR,#bTimerHandle
0043C1 E0                MOVX     A,@DPTR
0043C2 04                INC      A
0043C3 FF                MOV      R7,A
0043C4 8008              SJMP     ?C0033?ZW_TIMER
0043C6         ?C0036?ZW_TIMER:
0043C6 903F23            MOV      DPTR,#bTimerHandle
0043C9 E0                MOVX     A,@DPTR
0043CA 04                INC      A
0043CB F0                MOVX     @DPTR,A
0043CC 80B6              SJMP     ?C0034?ZW_TIMER
0043CE         ?C0033?ZW_TIMER:
0043CE 22                RET      
----- FUNCTION _ZW_TimerLongStart (END) -------


----- FUNCTION _ZCB_NetworkManagementLearnModeCompleted (BEGIN) -----
0043CF 904338            MOV      DPTR,#bStatus
0043D2 EF                MOV      A,R7
0043D3 F0                MOVX     @DPTR,A
0043D4 A3                INC      DPTR
0043D5 ED                MOV      A,R5
0043D6 F0                MOVX     @DPTR,A
0043D7 9158              ACALL    ?L?COM030E
0043D9 904338            MOV      DPTR,#bStatus
0043DC E0                MOVX     A,@DPTR
0043DD B40112            CJNE     A,#01H,?C0019?ZW_NETWORK_MANAGEMENT
0043E0 A3                INC      DPTR
0043E1 E0                MOVX     A,@DPTR
0043E2 903D33            MOV      DPTR,#bCachedNodeID
0043E5 F0                MOVX     @DPTR,A
0043E6 715A              ACALL    NetworkManagementSmartStartClear
0043E8 903D32            MOV      DPTR,#learnState
0043EB 7405              MOV      A,#05H
0043ED F0                MOVX     @DPTR,A
0043EE 7FFE              MOV      R7,#0FEH
0043F0 805F              SJMP     ?C0101?ZW_NETWORK_MANAGEMENT
0043F2         ?C0019?ZW_NETWORK_MANAGEMENT:
0043F2 904338            MOV      DPTR,#bStatus
0043F5 E0                MOVX     A,@DPTR
0043F6 6402              XRL      A,#02H
0043F8 7022              JNZ      ?C0021?ZW_NETWORK_MANAGEMENT
0043FA 903D36            MOV      DPTR,#NW_Action
0043FD E0                MOVX     A,@DPTR
0043FE 6402              XRL      A,#02H
004400 7055              JNZ      ?C0030?ZW_NETWORK_MANAGEMENT
004402 903D2D            MOV      DPTR,#bRequestNo
004405 F0                MOVX     @DPTR,A
004406 903D32            MOV      DPTR,#learnState
004409 7403              MOV      A,#03H
00440B F0                MOVX     @DPTR,A
00440C 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
00440E 7F75              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
004410 C006              PUSH     AR6
004412 C007              PUSH     AR7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 48


004414 D179              ACALL    ?L?COM0238
004416 D007              POP      AR7
004418 D006              POP      AR6
00441A 6162              AJMP     ?L?COM0397
00441C         ?C0021?ZW_NETWORK_MANAGEMENT:
00441C 904338            MOV      DPTR,#bStatus
00441F E0                MOVX     A,@DPTR
004420 7035              JNZ      ?C0030?ZW_NETWORK_MANAGEMENT
004422 121A5C            LCALL    ?INTERBANK_TABLE?secure_learn_get_errno
004425 EF                MOV      A,R7
004426 6401              XRL      A,#01H
004428 602A              JZ       ?C0025?ZW_NETWORK_MANAGEMENT
00442A 302B14            JNB      bSmartStartLearn,?C0026?ZW_NETWORK_MANAGEMENT
00442D 121E17            LCALL    ?INTERBANK_TABLE?ApplicationSecureKeysRequested
004430 EF                MOV      A,R7
004431 600C              JZ       ?C0027?ZW_NETWORK_MANAGEMENT
004433 121A5C            LCALL    ?INTERBANK_TABLE?secure_learn_get_errno
004436 EF                MOV      A,R7
004437 6006              JZ       ?C0027?ZW_NETWORK_MANAGEMENT
004439 904339            MOV      DPTR,#nodeID
00443C 74FF              MOV      A,#0FFH
00443E F0                MOVX     @DPTR,A
00443F         ?C0027?ZW_NETWORK_MANAGEMENT:
00443F C22B              CLR      bSmartStartLearn
004441         ?C0026?ZW_NETWORK_MANAGEMENT:
004441 123EFE            LCALL    ?L?COM02F1
004444 903D32            MOV      DPTR,#learnState
004447 E0                MOVX     A,@DPTR
004448 6002              JZ       ?C0028?ZW_NETWORK_MANAGEMENT
00444A 5110              ACALL    ?L?COM0572
00444C         ?C0028?ZW_NETWORK_MANAGEMENT:
00444C 904339            MOV      DPTR,#nodeID
00444F E0                MOVX     A,@DPTR
004450 FF                MOV      R7,A
004451         
004451 021DF4            LJMP     ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
004454         ?C0025?ZW_NETWORK_MANAGEMENT:
004454 121A66            LCALL    ?INTERBANK_TABLE?secure_learn_set_errno_reset
004457         ?C0030?ZW_NETWORK_MANAGEMENT:
004457 22                RET      
----- FUNCTION _ZCB_NetworkManagementLearnModeCompleted (END) -------


----- FUNCTION ?L?COM030E (BEGIN) -----
004458 903D37            MOV      DPTR,#learnStateHandle
00445B E0                MOVX     A,@DPTR
00445C FF                MOV      R7,A
00445D 9165              ACALL    _TimerCancel
00445F E4                CLR      A
004460 903D37            MOV      DPTR,#learnStateHandle
004463 F0                MOVX     @DPTR,A
004464 22                RET      
----- FUNCTION ?L?COM030E (END) -------


----- FUNCTION _TimerCancel (BEGIN) -----
;---- Variable 'btimerHandle' assigned to Register 'R3' ----
004465 AB07              MOV      R3,AR7
;---- Variable 'retCode' assigned to Register 'R7' ----
004467 E4                CLR      A
004468 FF                MOV      R7,A
004469 1B                DEC      R3
00446A EB                MOV      A,R3
00446B C3                CLR      C
00446C 940E              SUBB     A,#0EH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 49


00446E 501A              JNC      ?C0029?ZW_TIMER
004470 D16A              ACALL    ?L?COM0223
004472 1224FD            LCALL    ?C?LSTKXDATA
004475 00                DB       00H
004476 00                DB       00H
004477 00                DB       00H
004478 00                DB       00H
004479 EB                MOV      A,R3
00447A B156              ACALL    ?L?COM00D0
00447C 1224FD            LCALL    ?C?LSTKXDATA
00447F 00                DB       00H
004480 00                DB       00H
004481 00                DB       00H
004482 00                DB       00H
004483 EB                MOV      A,R3
004484 918D              ACALL    ?L?COM014C
004486 E4                CLR      A
004487 F0                MOVX     @DPTR,A
004488 7F01              MOV      R7,#01H
00448A         ?C0029?ZW_TIMER:
00448A 22                RET      
----- FUNCTION _TimerCancel (END) -------


----- FUNCTION ?L?COM014B (BEGIN) -----
00448B E0                MOVX     A,@DPTR
00448C FF                MOV      R7,A
00448D         ?L?COM014C:
00448D 75F00C            MOV      B,#0CH
004490 A4                MUL      AB
004491 24C0              ADD      A,#LOW timerArray+0BH
004493 F582              MOV      DPL,A
004495 E4                CLR      A
004496 342C              ADDC     A,#HIGH timerArray+0BH
004498 F583              MOV      DPH,A
00449A 22                RET      
----- FUNCTION ?L?COM014B (END) -------


----- FUNCTION TimerAction (BEGIN) -----
00449B D3                SETB     C
00449C 900001            MOV      DPTR,#timerCount+01H
00449F E0                MOVX     A,@DPTR
0044A0 9400              SUBB     A,#00H
0044A2 900000            MOV      DPTR,#timerCount
0044A5 E0                MOVX     A,@DPTR
0044A6 9400              SUBB     A,#00H
0044A8 5002              JNC      $ + 4H
0044AA A153              AJMP     ?C0023?ZW_TIMER
0044AC C2AD              CLR      EMULTI
0044AE E0                MOVX     A,@DPTR
0044AF FF                MOV      R7,A
0044B0 A3                INC      DPTR
0044B1 E0                MOVX     A,@DPTR
0044B2 904336            MOV      DPTR,#bTicks
0044B5 F1BD              ACALL    ?L?COM055C
0044B7 900000            MOV      DPTR,#timerCount
0044BA F0                MOVX     @DPTR,A
0044BB A3                INC      DPTR
0044BC F0                MOVX     @DPTR,A
0044BD D2AD              SETB     EMULTI
0044BF F575              MOV      timerHandle,A
0044C1         ?C0012?ZW_TIMER:
0044C1 E575              MOV      A,timerHandle
0044C3 918D              ACALL    ?L?COM014C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 50


0044C5 E0                MOVX     A,@DPTR
0044C6 6075              JZ       ?C0014?ZW_TIMER
0044C8 904336            MOV      DPTR,#bTicks
0044CB D1BB              ACALL    ?L?COM0451
0044CD FC                MOV      R4,A
0044CE FD                MOV      R5,A
0044CF B154              ACALL    ?L?COM00CF
0044D1 1224B5            LCALL    ?C?LLDXDATA0
0044D4 D3                SETB     C
0044D5 1223D4            LCALL    ?C?ULCMP
0044D8 5042              JNC      ?C0016?ZW_TIMER
0044DA B164              ACALL    ?L?COM020E
0044DC E0                MOVX     A,@DPTR
0044DD FF                MOV      R7,A
0044DE 6008              JZ       ?C0017?ZW_TIMER
0044E0 F4                CPL      A
0044E1 6005              JZ       ?C0017?ZW_TIMER
0044E3 B164              ACALL    ?L?COM020E
0044E5 E0                MOVX     A,@DPTR
0044E6 14                DEC      A
0044E7 F0                MOVX     @DPTR,A
0044E8         ?C0017?ZW_TIMER:
0044E8 B164              ACALL    ?L?COM020E
0044EA E0                MOVX     A,@DPTR
0044EB 600E              JZ       ?C0019?ZW_TIMER
0044ED E575              MOV      A,timerHandle
0044EF D16B              ACALL    ?L?COM0224
0044F1 122499            LCALL    ?C?LLDXDATA
0044F4 B154              ACALL    ?L?COM00CF
0044F6 1224F1            LCALL    ?C?LSTXDATA
0044F9 800F              SJMP     ?C0020?ZW_TIMER
0044FB         ?C0019?ZW_TIMER:
0044FB E575              MOV      A,timerHandle
0044FD 918D              ACALL    ?L?COM014C
0044FF E4                CLR      A
004500 F0                MOVX     @DPTR,A
004501 B154              ACALL    ?L?COM00CF
004503 1224FD            LCALL    ?C?LSTKXDATA
004506 00                DB       00H
004507 00                DB       00H
004508 00                DB       00H
004509 00                DB       00H
00450A         ?C0020?ZW_TIMER:
00450A D18C              ACALL    ?L?COM0225
00450C 4E                ORL      A,R6
00450D 6008              JZ       ?C0021?ZW_TIMER
00450F D18C              ACALL    ?L?COM0225
004511 AA06              MOV      R2,AR6
004513 F9                MOV      R1,A
004514 122716            LCALL    ?C?ICALL
004517         ?C0021?ZW_TIMER:
004517 123EE9            LCALL    ZW_Poll
00451A 8021              SJMP     ?C0014?ZW_TIMER
00451C         ?C0016?ZW_TIMER:
00451C B154              ACALL    ?L?COM00CF
00451E C083              PUSH     DPH
004520 C082              PUSH     DPL
004522 122499            LCALL    ?C?LLDXDATA
004525 C006              PUSH     AR6
004527 C007              PUSH     AR7
004529 904336            MOV      DPTR,#bTicks
00452C D1DB              ACALL    ?L?COM02E4
00452E F8                MOV      R0,A
00452F D007              POP      AR7
004531 D006              POP      AR6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 51


004533 122278            LCALL    ?C?LSUB
004536 D082              POP      DPL
004538 D083              POP      DPH
00453A 1224F1            LCALL    ?C?LSTXDATA
00453D         ?C0014?ZW_TIMER:
00453D 0575              INC      timerHandle
00453F E575              MOV      A,timerHandle
004541 C3                CLR      C
004542 940E              SUBB     A,#0EH
004544 5002              JNC      $ + 4H
004546 81C1              AJMP     ?C0012?ZW_TIMER
004548         ?C0013?ZW_TIMER:
004548 904336            MOV      DPTR,#bTicks
00454B E0                MOVX     A,@DPTR
00454C FE                MOV      R6,A
00454D A3                INC      DPTR
00454E E0                MOVX     A,@DPTR
00454F FF                MOV      R7,A
004550 121B06            LCALL    ?INTERBANK_TABLE?_ctimer_poll
004553         ?C0023?ZW_TIMER:
004553 22                RET      
----- FUNCTION TimerAction (END) -------


----- FUNCTION ?L?COM00CF (BEGIN) -----
004554 E575              MOV      A,timerHandle
004556         ?L?COM00D0:
004556 75F00C            MOV      B,#0CH
004559 A4                MUL      AB
00455A 24B5              ADD      A,#LOW timerArray
00455C F582              MOV      DPL,A
00455E E4                CLR      A
00455F 342C              ADDC     A,#HIGH timerArray
004561 F583              MOV      DPH,A
004563 22                RET      
----- FUNCTION ?L?COM00CF (END) -------


----- FUNCTION ?L?COM020E (BEGIN) -----
004564 E575              MOV      A,timerHandle
004566         ?L?COM020F:
004566 75F00C            MOV      B,#0CH
004569 A4                MUL      AB
00456A 24BF              ADD      A,#LOW timerArray+0AH
00456C F582              MOV      DPL,A
00456E E4                CLR      A
00456F 342C              ADDC     A,#HIGH timerArray+0AH
004571 F583              MOV      DPH,A
004573 22                RET      
----- FUNCTION ?L?COM020E (END) -------


----- FUNCTION _TimerSave (BEGIN) -----
004574 903F15            MOV      DPTR,#func
004577 EC                MOV      A,R4
004578 F0                MOVX     @DPTR,A
004579 A3                INC      DPTR
00457A ED                MOV      A,R5
00457B F0                MOVX     @DPTR,A
00457C 903F14            MOV      DPTR,#btimerHandle
00457F EF                MOV      A,R7
004580 F0                MOVX     @DPTR,A
004581 FB                MOV      R3,A
004582 903F17            MOV      DPTR,#dwTimerTicks
004585 122499            LCALL    ?C?LLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 52


004588 D16A              ACALL    ?L?COM0223
00458A 1224F1            LCALL    ?C?LSTXDATA
00458D EB                MOV      A,R3
00458E B156              ACALL    ?L?COM00D0
004590 1224F1            LCALL    ?C?LSTXDATA
004593 EB                MOV      A,R3
004594 B156              ACALL    ?L?COM00D0
004596 C083              PUSH     DPH
004598 C082              PUSH     DPL
00459A 1224B5            LCALL    ?C?LLDXDATA0
00459D 900000            MOV      DPTR,#timerCount
0045A0 D1BB              ACALL    ?L?COM0451
0045A2 FC                MOV      R4,A
0045A3 FD                MOV      R5,A
0045A4 12226B            LCALL    ?C?LADD
0045A7 D082              POP      DPL
0045A9 D083              POP      DPH
0045AB 1224F1            LCALL    ?C?LSTXDATA
0045AE 903F1B            MOV      DPTR,#brepeats
0045B1 E0                MOVX     A,@DPTR
0045B2 FF                MOV      R7,A
0045B3 903F14            MOV      DPTR,#btimerHandle
0045B6 E0                MOVX     A,@DPTR
0045B7 FE                MOV      R6,A
0045B8 B166              ACALL    ?L?COM020F
0045BA EF                MOV      A,R7
0045BB F0                MOVX     @DPTR,A
0045BC 903F15            MOV      DPTR,#func
0045BF E0                MOVX     A,@DPTR
0045C0 FC                MOV      R4,A
0045C1 A3                INC      DPTR
0045C2 E0                MOVX     A,@DPTR
0045C3 FD                MOV      R5,A
0045C4 EE                MOV      A,R6
0045C5 75F00C            MOV      B,#0CH
0045C8 A4                MUL      AB
0045C9 24BD              ADD      A,#LOW timerArray+08H
0045CB F582              MOV      DPL,A
0045CD E4                CLR      A
0045CE 342C              ADDC     A,#HIGH timerArray+08H
;----                  JMP      ?L?COM05CA
----- FUNCTION _TimerSave (END) -------


----- FUNCTION ?L?COM05CA (BEGIN) -----
0045D0 F583              MOV      DPH,A
0045D2 EC                MOV      A,R4
0045D3 F0                MOVX     @DPTR,A
0045D4 A3                INC      DPTR
0045D5 ED                MOV      A,R5
0045D6 F0                MOVX     @DPTR,A
0045D7 22                RET      
----- FUNCTION ?L?COM05CA (END) -------


----- FUNCTION _TimerStart_ (BEGIN) -----
0045D8 90400C            MOV      DPTR,#func
0045DB EE                MOV      A,R6
0045DC F0                MOVX     @DPTR,A
0045DD A3                INC      DPTR
0045DE F165              ACALL    ?L?COM0102
0045E0 EB                MOV      A,R3
0045E1 F0                MOVX     @DPTR,A
0045E2 904011            MOV      DPTR,#retCode
0045E5 74FF              MOV      A,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 53


0045E7 F0                MOVX     @DPTR,A
0045E8 904010            MOV      DPTR,#bstartTimer
0045EB E0                MOVX     A,@DPTR
0045EC 904012            MOV      DPTR,#timerHandle
0045EF F0                MOVX     @DPTR,A
0045F0         ?C0002?ZW_TIMER:
0045F0 904012            MOV      DPTR,#timerHandle
0045F3 E0                MOVX     A,@DPTR
0045F4 FF                MOV      R7,A
0045F5 C3                CLR      C
0045F6 940E              SUBB     A,#0EH
0045F8 505E              JNC      ?C0003?ZW_TIMER
0045FA EF                MOV      A,R7
0045FB B156              ACALL    ?L?COM00D0
0045FD 122499            LCALL    ?C?LLDXDATA
004600 E4                CLR      A
004601 FB                MOV      R3,A
004602 D1C2              ACALL    ?L?COM04AD
004604 704A              JNZ      ?C0004?ZW_TIMER
004606 904010            MOV      DPTR,#bstartTimer
004609 E0                MOVX     A,@DPTR
00460A 7E01              MOV      R6,#01H
00460C 7002              JNZ      ?C0006?ZW_TIMER
00460E 7E02              MOV      R6,#02H
004610         ?C0006?ZW_TIMER:
004610         ?C0007?ZW_TIMER:
004610 904012            MOV      DPTR,#timerHandle
004613 918B              ACALL    ?L?COM014B
004615 EE                MOV      A,R6
004616 F0                MOVX     @DPTR,A
004617 C007              PUSH     AR7
004619 90400E            MOV      DPTR,#btimerTicks
00461C E0                MOVX     A,@DPTR
00461D FF                MOV      R7,A
00461E 7E00              MOV      R6,#00H
004620 6004              JZ       ?C0008?ZW_TIMER
004622 F1C4              ACALL    ?L?COM060F
004624 8002              SJMP     ?C0009?ZW_TIMER
004626         ?C0008?ZW_TIMER:
004626 7F0A              MOV      R7,#0AH
004628         ?C0009?ZW_TIMER:
004628 E4                CLR      A
004629 FC                MOV      R4,A
00462A FD                MOV      R5,A
00462B 903F17            MOV      DPTR,#?_TimerSave?BYTE+03H
00462E 1224F1            LCALL    ?C?LSTXDATA
004631 90400F            MOV      DPTR,#brepeats
004634 E0                MOVX     A,@DPTR
004635 903F1B            MOV      DPTR,#?_TimerSave?BYTE+07H
004638 F0                MOVX     @DPTR,A
004639 90400C            MOV      DPTR,#func
00463C E0                MOVX     A,@DPTR
00463D FC                MOV      R4,A
00463E A3                INC      DPTR
00463F E0                MOVX     A,@DPTR
004640 FD                MOV      R5,A
004641 D007              POP      AR7
004643 B174              ACALL    _TimerSave
004645 904012            MOV      DPTR,#timerHandle
004648 E0                MOVX     A,@DPTR
004649 04                INC      A
00464A FF                MOV      R7,A
00464B 904011            MOV      DPTR,#retCode
00464E F0                MOVX     @DPTR,A
00464F 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 54


004650         ?C0004?ZW_TIMER:
004650 904012            MOV      DPTR,#timerHandle
004653 E0                MOVX     A,@DPTR
004654 04                INC      A
004655 F0                MOVX     @DPTR,A
004656 8098              SJMP     ?C0002?ZW_TIMER
004658         ?C0003?ZW_TIMER:
004658 904011            MOV      DPTR,#retCode
00465B E0                MOVX     A,@DPTR
00465C FF                MOV      R7,A
00465D 22                RET      
----- FUNCTION _TimerStart_ (END) -------


----- FUNCTION NetworkManagementSmartStartIsEnabled (BEGIN) -----
00465E 901217            MOV      DPTR,#eSystemTypeState
004661 E0                MOVX     A,@DPTR
004662 7F00              MOV      R7,#00H
004664 30E202            JNB      ACC.2,?C0004?ZW_NETWORK_MANAGEMENT
004667 7F01              MOV      R7,#01H
004669         ?C0004?ZW_NETWORK_MANAGEMENT:
004669 22                RET      
----- FUNCTION NetworkManagementSmartStartIsEnabled (END) -------


----- FUNCTION ?L?COM0223 (BEGIN) -----
00466A EB                MOV      A,R3
00466B         ?L?COM0224:
00466B 75F00C            MOV      B,#0CH
00466E A4                MUL      AB
00466F 24B9              ADD      A,#LOW timerArray+04H
004671 F582              MOV      DPL,A
004673 E4                CLR      A
004674 342C              ADDC     A,#HIGH timerArray+04H
004676 F583              MOV      DPH,A
004678 22                RET      
----- FUNCTION ?L?COM0223 (END) -------


----- FUNCTION ?L?COM0238 (BEGIN) -----
004679 E4                CLR      A
00467A 7FD0              MOV      R7,#0D0H
00467C 7E07              MOV      R6,#07H
00467E FD                MOV      R5,A
00467F FC                MOV      R4,A
004680         ?L?COM0239:
004680 903F1E            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+02H
004683 1224F1            LCALL    ?C?LSTXDATA
004686 E4                CLR      A
004687 903F22            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+06H
00468A F0                MOVX     @DPTR,A
00468B 22                RET      
----- FUNCTION ?L?COM0238 (END) -------


----- FUNCTION ?L?COM0225 (BEGIN) -----
00468C E575              MOV      A,timerHandle
00468E 75F00C            MOV      B,#0CH
004691 A4                MUL      AB
004692 24BD              ADD      A,#LOW timerArray+08H
004694 F582              MOV      DPL,A
004696 E4                CLR      A
004697 342C              ADDC     A,#HIGH timerArray+08H
004699         ?L?COM0226:
004699 F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 55


00469B E0                MOVX     A,@DPTR
00469C FE                MOV      R6,A
00469D A3                INC      DPTR
00469E E0                MOVX     A,@DPTR
00469F 22                RET      
----- FUNCTION ?L?COM0225 (END) -------


----- FUNCTION _TimerRestart (BEGIN) -----
;---- Variable 'btimerHandle' assigned to Register 'R3' ----
0046A0 AB07              MOV      R3,AR7
;---- Variable 'retCode' assigned to Register 'R2' ----
0046A2 E4                CLR      A
0046A3 FA                MOV      R2,A
0046A4 1B                DEC      R3
0046A5 EB                MOV      A,R3
0046A6 C3                CLR      C
0046A7 940E              SUBB     A,#0EH
0046A9 500D              JNC      ?C0026?ZW_TIMER
0046AB D16A              ACALL    ?L?COM0223
0046AD F1D3              ACALL    ?L?COM061F
0046AF 6007              JZ       ?C0026?ZW_TIMER
0046B1 EB                MOV      A,R3
0046B2 B156              ACALL    ?L?COM00D0
0046B4 1224F1            LCALL    ?C?LSTXDATA
0046B7 0A                INC      R2
0046B8         ?C0026?ZW_TIMER:
0046B8 AF02              MOV      R7,AR2
0046BA 22                RET      
----- FUNCTION _TimerRestart (END) -------


----- FUNCTION ?L?COM0451 (BEGIN) -----
0046BB E0                MOVX     A,@DPTR
0046BC FE                MOV      R6,A
0046BD A3                INC      DPTR
0046BE E0                MOVX     A,@DPTR
0046BF FF                MOV      R7,A
0046C0 E4                CLR      A
0046C1 22                RET      
----- FUNCTION ?L?COM0451 (END) -------


----- FUNCTION ?L?COM04AD (BEGIN) -----
0046C2 FA                MOV      R2,A
0046C3 F9                MOV      R1,A
0046C4 F8                MOV      R0,A
0046C5 C3                CLR      C
0046C6 0223D4            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM04AD (END) -------


----- FUNCTION ?L?COM0639 (BEGIN) -----
0046C9 E4                CLR      A
0046CA FD                MOV      R5,A
0046CB FC                MOV      R4,A
0046CC FF                MOV      R7,A
0046CD 0219F8            LJMP     ?INTERBANK_TABLE?_InternSetLearnMode
----- FUNCTION ?L?COM0639 (END) -------


----- FUNCTION NetworkManagementWUTPowerDownInterrupted (BEGIN) -----
0046D0 901217            MOV      DPTR,#eSystemTypeState
0046D3 E0                MOVX     A,@DPTR
0046D4 5408              ANL      A,#08H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 56


0046D6 FF                MOV      R7,A
0046D7 22                RET      
----- FUNCTION NetworkManagementWUTPowerDownInterrupted (END) -------


----- FUNCTION ?L?COM02E3 (BEGIN) -----
0046D8 904207            MOV      DPTR,#bBaudRate
0046DB         ?L?COM02E4:
0046DB E0                MOVX     A,@DPTR
0046DC FE                MOV      R6,A
0046DD A3                INC      DPTR
0046DE E0                MOVX     A,@DPTR
0046DF FB                MOV      R3,A
0046E0 AA06              MOV      R2,AR6
0046E2 E4                CLR      A
0046E3 F9                MOV      R1,A
0046E4 22                RET      
----- FUNCTION ?L?COM02E3 (END) -------


----- FUNCTION _ZW_UART0_init (BEGIN) -----
0046E5 904207            MOV      DPTR,#bBaudRate
0046E8 EE                MOV      A,R6
0046E9 F0                MOVX     @DPTR,A
0046EA A3                INC      DPTR
0046EB F165              ACALL    ?L?COM0102
0046ED EB                MOV      A,R3
0046EE F0                MOVX     @DPTR,A
0046EF D1D8              ACALL    ?L?COM02E3
0046F1 F15A              ACALL    ?L?COM048C
0046F3 F1DB              ACALL    ?L?COM058C
0046F5 C006              PUSH     AR6
0046F7 C007              PUSH     AR7
0046F9 904207            MOV      DPTR,#bBaudRate
0046FC 1272C0            LCALL    ?L?COM0466
0046FF F8                MOV      R0,A
004700 D007              POP      AR7
004702 D006              POP      AR6
004704 D3                SETB     C
004705 1223BE            LCALL    ?C?SLCMP
004708 7E00              MOV      R6,#00H
00470A 5004              JNC      ?C0001?ZW_PHY_UART0_050X
00470C 7F01              MOV      R7,#01H
00470E 8002              SJMP     ?C0030?ZW_PHY_UART0_050X
004710         ?C0001?ZW_PHY_UART0_050X:
004710 7F00              MOV      R7,#00H
004712         
004712 C006              PUSH     AR6
004714 C007              PUSH     AR7
004716         ?C0002?ZW_PHY_UART0_050X:
004716 D1D8              ACALL    ?L?COM02E3
004718 F15A              ACALL    ?L?COM048C
00471A D0E0              POP      ACC
00471C 2F                ADD      A,R7
00471D FF                MOV      R7,A
00471E D0E0              POP      ACC
004720 3E                ADDC     A,R6
004721 904207            MOV      DPTR,#bBaudRate
004724 F0                MOVX     @DPTR,A
004725 A3                INC      DPTR
004726 EF                MOV      A,R7
004727 F0                MOVX     @DPTR,A
004728 53ECFC            ANL      UARTCON,#0FCH
00472B 904207            MOV      DPTR,#bBaudRate
00472E F1B6              ACALL    ?L?COM031C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 57


004730 5403              ANL      A,#03H
004732 42EC              ORL      UARTCON,A
004734 75FF02            MOV      SFRPAGE,#02H
004737 ED                MOV      A,R5
004738 F5AF              MOV      UART0BRL,A
00473A 75ED02            MOV      UARTSTAT,#02H
00473D 75ED04            MOV      UARTSTAT,#04H
004740 A3                INC      DPTR
004741 E0                MOVX     A,@DPTR
004742 6005              JZ       ?C0003?ZW_PHY_UART0_050X
004744 43EC08            ORL      UARTCON,#08H
004747 8003              SJMP     ?C0004?ZW_PHY_UART0_050X
004749         ?C0003?ZW_PHY_UART0_050X:
004749 53ECF7            ANL      UARTCON,#0F7H
00474C         ?C0004?ZW_PHY_UART0_050X:
00474C 90420A            MOV      DPTR,#bEnableRx
00474F E0                MOVX     A,@DPTR
004750 6004              JZ       ?C0005?ZW_PHY_UART0_050X
004752 43EC04            ORL      UARTCON,#04H
004755 22                RET      
004756         ?C0005?ZW_PHY_UART0_050X:
004756 53ECFB            ANL      UARTCON,#0FBH
004759 22                RET      
----- FUNCTION _ZW_UART0_init (END) -------


----- FUNCTION ?L?COM048C (BEGIN) -----
00475A F8                MOV      R0,A
00475B 7F80              MOV      R7,#080H
00475D 7E38              MOV      R6,#038H
00475F 7D01              MOV      R5,#01H
004761 FC                MOV      R4,A
004762 022F31            LJMP     ?C?SLDIV
----- FUNCTION ?L?COM048C (END) -------


----- FUNCTION ?L?COM0102 (BEGIN) -----
004765 EF                MOV      A,R7
004766 F0                MOVX     @DPTR,A
004767 A3                INC      DPTR
004768 ED                MOV      A,R5
004769 F0                MOVX     @DPTR,A
00476A A3                INC      DPTR
00476B 22                RET      
----- FUNCTION ?L?COM0102 (END) -------


----- FUNCTION ?L?COM0303 (BEGIN) -----
00476C F0                MOVX     @DPTR,A
00476D A3                INC      DPTR
00476E EF                MOV      A,R7
00476F F0                MOVX     @DPTR,A
004770 7E1C              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_delayed_send_callback
004772 7FAF              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_delayed_send_callback
004774         ?L?COM0304:
004774 E4                CLR      A
004775 FB                MOV      R3,A
004776 7D01              MOV      R5,#01H
----- FUNCTION _TimerSysStart (BEGIN) -----
;---- Variable 'func' assigned to Register 'R6/R7' ----
;---- Variable 'brepeats' assigned to Register 'R3' ----
;---- Variable 'btimerTicks' assigned to Register 'R5' ----
004778 E4                CLR      A
004779 904010            MOV      DPTR,#?_TimerStart_?BYTE+04H
00477C F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 58


00477D A1D8              AJMP     _TimerStart_
----- FUNCTION _TimerSysStart (END) -------


----- FUNCTION main_PowerDown_ReadyCheck (BEGIN) -----
00477F 20022A            JB       findInProgress,?C0044?ZW_MAIN
004782 901217            MOV      DPTR,#eSystemTypeState
004785 E0                MOVX     A,@DPTR
004786 30E10A            JNB      ACC.1,?C0046?ZW_MAIN
004789 F1B3              ACALL    RFIsReceivingBeam
00478B 5006              JNC      ?C0046?ZW_MAIN
00478D 7E00              MOV      R6,#00H
00478F 7F01              MOV      R7,#01H
004791 8004              SJMP     ?C0047?ZW_MAIN
004793         ?C0046?ZW_MAIN:
004793 7E00              MOV      R6,#00H
004795 7F00              MOV      R7,#00H
004797         ?C0047?ZW_MAIN:
004797 EF                MOV      A,R7
004798 4E                ORL      A,R6
004799 7011              JNZ      ?C0044?ZW_MAIN
00479B 121C6E            LCALL    ?INTERBANK_TABLE?sec0_state
00479E EF                MOV      A,R7
00479F 700B              JNZ      ?C0044?ZW_MAIN
0047A1 121CA5            LCALL    ?INTERBANK_TABLE?s2_busy
0047A4 EF                MOV      A,R7
0047A5 7005              JNZ      ?C0044?ZW_MAIN
0047A7 1110              ACALL    main_PowerDown_Setup
0047A9 7F01              MOV      R7,#01H
0047AB 22                RET      
0047AC         ?C0044?ZW_MAIN:
0047AC 7F00              MOV      R7,#00H
0047AE 22                RET      
----- FUNCTION main_PowerDown_ReadyCheck (END) -------


----- FUNCTION _ZW_TimerLongRestart (BEGIN) -----
;---- Variable 'bTimerHandle' assigned to Register 'R7' ----
0047AF C1A0              AJMP     _TimerRestart
----- FUNCTION _ZW_TimerLongRestart (END) -------


----- FUNCTION _ZW_TimerLongCancel (BEGIN) -----
;---- Variable 'bTimerHandle' assigned to Register 'R7' ----
0047B1 8165              AJMP     _TimerCancel
----- FUNCTION _ZW_TimerLongCancel (END) -------


----- FUNCTION RFIsReceivingBeam (BEGIN) -----
0047B3 A213              MOV      C,RF_WakeupReceived
0047B5 22                RET      
----- FUNCTION RFIsReceivingBeam (END) -------


----- FUNCTION ?L?COM031C (BEGIN) -----
0047B6 E0                MOVX     A,@DPTR
0047B7 FC                MOV      R4,A
0047B8 A3                INC      DPTR
0047B9 E0                MOVX     A,@DPTR
0047BA FD                MOV      R5,A
0047BB EC                MOV      A,R4
0047BC 22                RET      
----- FUNCTION ?L?COM031C (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 59


----- FUNCTION ?L?COM055C (BEGIN) -----
0047BD CF                XCH      A,R7
0047BE F0                MOVX     @DPTR,A
0047BF A3                INC      DPTR
0047C0 EF                MOV      A,R7
0047C1 F0                MOVX     @DPTR,A
0047C2 E4                CLR      A
0047C3 22                RET      
----- FUNCTION ?L?COM055C (END) -------


----- FUNCTION ?L?COM060F (BEGIN) -----
0047C4 7C00              MOV      R4,#00H
0047C6 7D0A              MOV      R5,#0AH
0047C8 0220A6            LJMP     ?C?IMUL
----- FUNCTION ?L?COM060F (END) -------


----- FUNCTION NetworkManagementSmartStartEnable (BEGIN) -----
0047CB 901217            MOV      DPTR,#eSystemTypeState
0047CE E0                MOVX     A,@DPTR
0047CF 4404              ORL      A,#04H
0047D1 F0                MOVX     @DPTR,A
0047D2 22                RET      
----- FUNCTION NetworkManagementSmartStartEnable (END) -------


----- FUNCTION ?L?COM061F (BEGIN) -----
0047D3 122499            LCALL    ?C?LLDXDATA
0047D6 EC                MOV      A,R4
0047D7 4D                ORL      A,R5
0047D8 4E                ORL      A,R6
0047D9 4F                ORL      A,R7
0047DA 22                RET      
----- FUNCTION ?L?COM061F (END) -------


----- FUNCTION ?L?COM058C (BEGIN) -----
0047DB AC00              MOV      R4,AR0
0047DD AD01              MOV      R5,AR1
0047DF AE02              MOV      R6,AR2
0047E1 AF03              MOV      R7,AR3
0047E3 22                RET      
----- FUNCTION ?L?COM058C (END) -------


----- FUNCTION NetworkManagementSmartStartCurrentRequestNo (BEGIN) -----
0047E4 901217            MOV      DPTR,#eSystemTypeState
0047E7 E0                MOVX     A,@DPTR
0047E8 C4                SWAP     A
0047E9 13                RRC      A
0047EA 5407              ANL      A,#07H
0047EC FF                MOV      R7,A
0047ED 22                RET      
----- FUNCTION NetworkManagementSmartStartCurrentRequestNo (END) -------


----- FUNCTION _ZW_SetSleepMode (BEGIN) -----
0047EE 90072A            MOV      DPTR,#Mode
0047F1 EF                MOV      A,R7
0047F2 F0                MOVX     @DPTR,A
0047F3 90072C            MOV      DPTR,#bBeamCount
0047F6 EB                MOV      A,R3
0047F7 F0                MOVX     @DPTR,A
0047F8 90072B            MOV      DPTR,#IntEnable
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 60


0047FB ED                MOV      A,R5
0047FC F0                MOVX     @DPTR,A
0047FD 5402              ANL      A,#02H
0047FF 901240            MOV      DPTR,#extInt1Enabled
004802 F0                MOVX     @DPTR,A
004803 12477F            LCALL    main_PowerDown_ReadyCheck
004806 EF                MOV      A,R7
004807 7002              JNZ      ?C0050?ZW_MAIN
004809 C3                CLR      C
00480A 22                RET      
00480B         ?C0050?ZW_MAIN:
00480B 90072A            MOV      DPTR,#Mode
00480E E0                MOVX     A,@DPTR
00480F B40411            CJNE     A,#04H,?C0052?ZW_MAIN
004812 A3                INC      DPTR
004813 E0                MOVX     A,@DPTR
004814 FB                MOV      R3,A
004815 7D01              MOV      R5,#01H
004817 7F01              MOV      R7,#01H
004819 1148              ACALL    _ZW_power_down_mode_init
00481B 90072A            MOV      DPTR,#Mode
00481E 7403              MOV      A,#03H
004820 F0                MOVX     @DPTR,A
004821 8013              SJMP     ?C0053?ZW_MAIN
004823         ?C0052?ZW_MAIN:
004823 90072A            MOV      DPTR,#Mode
004826 E0                MOVX     A,@DPTR
004827 B40505            CJNE     A,#05H,?C0054?ZW_MAIN
00482A 121BE7            LCALL    ?INTERBANK_TABLE?Power_Management_FLiRSSetup
00482D 8007              SJMP     ?C0053?ZW_MAIN
00482F         ?C0054?ZW_MAIN:
00482F 90072B            MOV      DPTR,#IntEnable
004832 1175              ACALL    ?L?COM054F
004834 1148              ACALL    _ZW_power_down_mode_init
004836         ?C0053?ZW_MAIN:
004836 90072A            MOV      DPTR,#Mode
004839 E0                MOVX     A,@DPTR
00483A 9003C1            MOV      DPTR,#sleepMode
00483D F0                MOVX     @DPTR,A
00483E 90072C            MOV      DPTR,#bBeamCount
004841 E0                MOVX     A,@DPTR
004842 90123F            MOV      DPTR,#bBeamCountWakeup
004845 F0                MOVX     @DPTR,A
004846 D3                SETB     C
004847 22                RET      
----- FUNCTION _ZW_SetSleepMode (END) -------


----- FUNCTION _ZW_power_down_mode_init (BEGIN) -----
;---- Variable 'bHighResolutionWUT' assigned to Register 'R7' ----
;---- Variable 'bEnableExtInt' assigned to Register 'R3' ----
;---- Variable 'bKeepCriticalMemory' assigned to Register 'R5' ----
004848 EB                MOV      A,R3
004849 6008              JZ       ?C0001?ZW_PHY_POWER_050X
00484B 75FF01            MOV      SFRPAGE,#01H
00484E 53CDFD            ANL      PMGTINT2,#0FDH
004851 8006              SJMP     ?C0002?ZW_PHY_POWER_050X
004853         ?C0001?ZW_PHY_POWER_050X:
004853 75FF01            MOV      SFRPAGE,#01H
004856 43CD02            ORL      PMGTINT2,#02H
004859         ?C0002?ZW_PHY_POWER_050X:
004859 ED                MOV      A,R5
00485A 6005              JZ       ?C0003?ZW_PHY_POWER_050X
00485C 53FBDF            ANL      PMGTCON,#0DFH
00485F 8003              SJMP     ?C0004?ZW_PHY_POWER_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 61


004861         ?C0003?ZW_PHY_POWER_050X:
004861 43FB20            ORL      PMGTCON,#020H
004864         ?C0004?ZW_PHY_POWER_050X:
004864 EF                MOV      A,R7
004865 6007              JZ       ?C0005?ZW_PHY_POWER_050X
004867 75FF02            MOV      SFRPAGE,#02H
00486A 43E140            ORL      WUTREG1,#040H
00486D 22                RET      
00486E         ?C0005?ZW_PHY_POWER_050X:
00486E 75FF02            MOV      SFRPAGE,#02H
004871 53E1BF            ANL      WUTREG1,#0BFH
004874 22                RET      
----- FUNCTION _ZW_power_down_mode_init (END) -------


----- FUNCTION ?L?COM054F (BEGIN) -----
004875 E0                MOVX     A,@DPTR
004876 FB                MOV      R3,A
004877 7D01              MOV      R5,#01H
004879 E4                CLR      A
00487A FF                MOV      R7,A
00487B 22                RET      
----- FUNCTION ?L?COM054F (END) -------


----- FUNCTION GoToSleep (BEGIN) -----
00487C 121BE7            LCALL    ?INTERBANK_TABLE?Power_Management_FLiRSSetup
00487F 7F01              MOV      R7,#01H
;----                  JMP      _ZW_power_down_mode
----- FUNCTION GoToSleep (END) -------


----- FUNCTION _ZW_power_down_mode (BEGIN) -----
;---- Variable 'bEnableWUT' assigned to Register 'R7' ----
004881 43FB10            ORL      PMGTCON,#010H
004884 75FF02            MOV      SFRPAGE,#02H
004887 43E640            ORL      RSETVEC,#040H
00488A EF                MOV      A,R7
00488B 600D              JZ       ?C0008?ZW_PHY_POWER_050X
00488D 75FF02            MOV      SFRPAGE,#02H
004890         ?C0009?ZW_PHY_POWER_050X:
004890 E5E1              MOV      A,WUTREG1
004892 20E7FB            JB       ACC.7,?C0009?ZW_PHY_POWER_050X
004895         ?C0010?ZW_PHY_POWER_050X:
004895 43FB0D            ORL      PMGTCON,#0DH
004898 8003              SJMP     ?C0012?ZW_PHY_POWER_050X
00489A         ?C0008?ZW_PHY_POWER_050X:
00489A 43FB0E            ORL      PMGTCON,#0EH
00489D         ?C0012?ZW_PHY_POWER_050X:
00489D 80FE              SJMP     ?C0012?ZW_PHY_POWER_050X
----- FUNCTION _ZW_power_down_mode (END) -------


----- FUNCTION _ZW_SetWutTimeout (BEGIN) -----
;---- Variable 'wutTimeout' assigned to Register 'R7' ----
;----                  JMP      _ZW_power_down_wut_timeout
----- FUNCTION _ZW_SetWutTimeout (END) -------


----- FUNCTION _ZW_power_down_wut_timeout (BEGIN) -----
;---- Variable 'bTimeout' assigned to Register 'R7' ----
00489F 75FF02            MOV      SFRPAGE,#02H
0048A2 8FE3              MOV      WUTTIME,R7
0048A4 22                RET      
----- FUNCTION _ZW_power_down_wut_timeout (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 62




----- FUNCTION NewIDNeeded (BEGIN) -----
0048A5 901221            MOV      DPTR,#nodeID
0048A8 E0                MOVX     A,@DPTR
0048A9 7011              JNZ      ?C0058?ZW_MAIN
0048AB 123FE1            LCALL    ?L?COM04BF
0048AE 4F                ORL      A,R7
0048AF FF                MOV      R7,A
0048B0 A3                INC      DPTR
0048B1 E0                MOVX     A,@DPTR
0048B2 4F                ORL      A,R7
0048B3 FF                MOV      R7,A
0048B4 A3                INC      DPTR
0048B5 E0                MOVX     A,@DPTR
0048B6 4F                ORL      A,R7
0048B7 7003              JNZ      ?C0058?ZW_MAIN
0048B9 D3                SETB     C
0048BA 8001              SJMP     ?C0059?ZW_MAIN
0048BC         ?C0058?ZW_MAIN:
0048BC C3                CLR      C
0048BD         ?C0059?ZW_MAIN:
0048BD 22                RET      
----- FUNCTION NewIDNeeded (END) -------


----- FUNCTION _GetRandom (BEGIN) -----
;---- Variable 'bMax' assigned to Register 'R6' ----
0048BE AE07              MOV      R6,AR7
0048C0 12413E            LCALL    ZW_Random
0048C3 EE                MOV      A,R6
0048C4 04                INC      A
0048C5 FE                MOV      R6,A
0048C6 EF                MOV      A,R7
0048C7 8EF0              MOV      B,R6
0048C9 84                DIV      AB
0048CA AFF0              MOV      R7,B
0048CC 22                RET      
----- FUNCTION _GetRandom (END) -------


----- FUNCTION ProtocolMonitor (BEGIN) -----
0048CD 30110C            JNB      protocolLockedCachedRoute,?C0081?ZW_MAIN
0048D0 902B24            MOV      DPTR,#assignState
0048D3 E0                MOVX     A,@DPTR
0048D4 7006              JNZ      ?C0081?ZW_MAIN
0048D6 FF                MOV      R7,A
0048D7 1219B7            LCALL    ?INTERBANK_TABLE?_ZW_LockRoute
0048DA C211              CLR      protocolLockedCachedRoute
0048DC         ?C0081?ZW_MAIN:
;----                  JMP      RFUpdateIsWakeupReceivedStatus
----- FUNCTION ProtocolMonitor (END) -------


----- FUNCTION RFUpdateIsWakeupReceivedStatus (BEGIN) -----
0048DC 301323            JNB      RF_WakeupReceived,?C0008?ZW_RF_DRIVER
0048DF AF71              MOV      R7,tickTime+01H
;---- Variable 'tmp' assigned to Register 'R7' ----
0048E1 9006CF            MOV      DPTR,#rfWakeupReceivedTickSample
0048E4 E0                MOVX     A,@DPTR
0048E5 FE                MOV      R6,A
0048E6 EF                MOV      A,R7
0048E7 C3                CLR      C
0048E8 9E                SUBB     A,R6
0048E9 400A              JC       ?C0004?ZW_RF_DRIVER
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 63


0048EB EF                MOV      A,R7
0048EC 9E                SUBB     A,R6
0048ED D3                SETB     C
0048EE 9402              SUBB     A,#02H
0048F0 4010              JC       ?C0008?ZW_RF_DRIVER
0048F2 C213              CLR      RF_WakeupReceived
0048F4 22                RET      
0048F5         ?C0004?ZW_RF_DRIVER:
0048F5 9006CF            MOV      DPTR,#rfWakeupReceivedTickSample
0048F8 E0                MOVX     A,@DPTR
0048F9 F4                CPL      A
0048FA 2F                ADD      A,R7
0048FB D3                SETB     C
0048FC 9401              SUBB     A,#01H
0048FE 4002              JC       ?C0008?ZW_RF_DRIVER
004900 C213              CLR      RF_WakeupReceived
004902         ?C0008?ZW_RF_DRIVER:
004902 22                RET      
----- FUNCTION RFUpdateIsWakeupReceivedStatus (END) -------


----- FUNCTION _ZW_AddPollTask (BEGIN) -----
;---- Variable 'CBPolltask' assigned to Register 'R6/R7' ----
004903 9003C5            MOV      DPTR,#pPolltask
004906 E0                MOVX     A,@DPTR
004907 FC                MOV      R4,A
004908 A3                INC      DPTR
004909 E0                MOVX     A,@DPTR
00490A 4C                ORL      A,R4
00490B 700A              JNZ      ?C0169?ZW_MAIN
00490D 9003C5            MOV      DPTR,#pPolltask
004910 EE                MOV      A,R6
004911 F0                MOVX     @DPTR,A
004912 A3                INC      DPTR
004913 EF                MOV      A,R7
004914 F0                MOVX     @DPTR,A
004915 D3                SETB     C
004916 22                RET      
004917         ?C0169?ZW_MAIN:
004917 C3                CLR      C
004918 22                RET      
----- FUNCTION _ZW_AddPollTask (END) -------


----- FUNCTION TaskPoll (BEGIN) -----
004919 9003C5            MOV      DPTR,#pPolltask
00491C E0                MOVX     A,@DPTR
00491D FE                MOV      R6,A
00491E A3                INC      DPTR
00491F E0                MOVX     A,@DPTR
004920 FF                MOV      R7,A
004921 4E                ORL      A,R6
004922 6009              JZ       ?C0172?ZW_MAIN
004924 CA                XCH      A,R2
004925 EE                MOV      A,R6
004926 CA                XCH      A,R2
004927 C9                XCH      A,R1
004928 EF                MOV      A,R7
004929 C9                XCH      A,R1
00492A 122716            LCALL    ?C?ICALL
00492D         ?C0172?ZW_MAIN:
00492D 22                RET      
----- FUNCTION TaskPoll (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 64


----- FUNCTION SysTimerInit (BEGIN) -----
00492E D2AD              SETB     EMULTI
004930 D2BD              SETB     PMULTI
004932 75FF02            MOV      SFRPAGE,#02H
004935 758E71            MOV      SYSTCON,#071H
004938 757409            MOV      timerRes,#09H
00493B 75FF02            MOV      SFRPAGE,#02H
00493E E58E              MOV      A,SYSTCON
004940 546F              ANL      A,#06FH
004942 4480              ORL      A,#080H
004944 F58E              MOV      SYSTCON,A
004946 9041EF            MOV      DPTR,#systemTime
004949 1224FD            LCALL    ?C?LSTKXDATA
00494C 00                DB       00H
00494D 00                DB       00H
00494E 00                DB       00H
00494F 00                DB       00H
004950 22                RET      
----- FUNCTION SysTimerInit (END) -------


----- FUNCTION MultiInterrupt (BEGIN) -----
004951 C0E0              PUSH     ACC
004953 C0F0              PUSH     B
004955 C083              PUSH     DPH
004957 C082              PUSH     DPL
004959 C0D0              PUSH     PSW
00495B 75D008            MOV      PSW,#08H
00495E C0FF              PUSH     SFRPAGE
004960 75FF02            MOV      SFRPAGE,#02H
004963 E58E              MOV      A,SYSTCON
004965 30E43A            JNB      ACC.4,?C0002?ZW_MULTI_INT_050X
004968 75FF02            MOV      SFRPAGE,#02H
00496B E58E              MOV      A,SYSTCON
00496D 54EF              ANL      A,#0EFH
00496F 4410              ORL      A,#010H
004971 F58E              MOV      SYSTCON,A
004973 9041EF            MOV      DPTR,#systemTime
004976 122499            LCALL    ?C?LLDXDATA
004979 31DB              ACALL    ?L?COM0074
00497B FC                MOV      R4,A
00497C 9041EF            MOV      DPTR,#systemTime
00497F 1224F1            LCALL    ?C?LSTXDATA
004982 900000            MOV      DPTR,#timerCount
004985 123F7F            LCALL    ?L?COM0081
004988 E574              MOV      A,timerRes
00498A 30E002            JNB      ACC.0,?C0003?ZW_MULTI_INT_050X
00498D 0551              INC      bCurrentExploreTimerTicks
00498F         ?C0003?ZW_MULTI_INT_050X:
00498F E574              MOV      A,timerRes
004991 700D              JNZ      ?C0004?ZW_MULTI_INT_050X
004993 757409            MOV      timerRes,#09H
004996 0571              INC      tickTime+01H
004998 E571              MOV      A,tickTime+01H
00499A 7002              JNZ      ?C0008?ZW_MULTI_INT_050X
00499C 0570              INC      tickTime
00499E         ?C0008?ZW_MULTI_INT_050X:
00499E 8002              SJMP     ?C0002?ZW_MULTI_INT_050X
0049A0         ?C0004?ZW_MULTI_INT_050X:
0049A0 1574              DEC      timerRes
0049A2         ?C0002?ZW_MULTI_INT_050X:
0049A2 75FF02            MOV      SFRPAGE,#02H
0049A5 E585              MOV      A,SLTCON1
0049A7 30E408            JNB      ACC.4,?C0006?ZW_MULTI_INT_050X
0049AA 75FF02            MOV      SFRPAGE,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 65


0049AD 438510            ORL      SLTCON1,#010H
0049B0 0576              INC      slow_timer_count
0049B2         ?C0006?ZW_MULTI_INT_050X:
0049B2 D0FF              POP      SFRPAGE
0049B4 D0D0              POP      PSW
0049B6 D082              POP      DPL
0049B8 D083              POP      DPH
0049BA D0F0              POP      B
0049BC D0E0              POP      ACC
0049BE 32                RETI     
----- FUNCTION MultiInterrupt (END) -------


----- FUNCTION ?L?COM0071 (BEGIN) -----
0049BF FF                MOV      R7,A
0049C0 7E04              MOV      R6,#04H
0049C2 FD                MOV      R5,A
0049C3 FC                MOV      R4,A
0049C4         ?L?COM0072:
0049C4 E0                MOVX     A,@DPTR
0049C5 F8                MOV      R0,A
0049C6 A3                INC      DPTR
0049C7 E0                MOVX     A,@DPTR
0049C8 F9                MOV      R1,A
0049C9 A3                INC      DPTR
0049CA E0                MOVX     A,@DPTR
0049CB FA                MOV      R2,A
0049CC A3                INC      DPTR
0049CD E0                MOVX     A,@DPTR
0049CE FB                MOV      R3,A
0049CF         ?L?COM0073:
0049CF 122286            LCALL    ?C?LMUL
0049D2 E4                CLR      A
0049D3 7B7D              MOV      R3,#07DH
0049D5 FA                MOV      R2,A
0049D6 F9                MOV      R1,A
0049D7 F8                MOV      R0,A
0049D8 122311            LCALL    ?C?ULDIV
0049DB         ?L?COM0074:
0049DB EF                MOV      A,R7
0049DC 2401              ADD      A,#01H
0049DE         ?L?COM0075:
0049DE FF                MOV      R7,A
0049DF E4                CLR      A
0049E0 3E                ADDC     A,R6
0049E1         ?L?COM0076:
0049E1 FE                MOV      R6,A
0049E2 E4                CLR      A
0049E3 3D                ADDC     A,R5
0049E4 FD                MOV      R5,A
0049E5 E4                CLR      A
0049E6 3C                ADDC     A,R4
0049E7 22                RET      
----- FUNCTION ?L?COM0071 (END) -------


----- FUNCTION _RF_onetime_init_and_rx (BEGIN) -----
0049E8 9037B1            MOV      DPTR,#freq_ch0
0049EB 1224F1            LCALL    ?C?LSTXDATA
0049EE 9037C1            MOV      DPTR,#success
0049F1 7401              MOV      A,#01H
0049F3 F0                MOVX     @DPTR,A
0049F4 E4                CLR      A
0049F5 A3                INC      DPTR
0049F6 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 66


0049F7 F12D              ACALL    ?L?COM0483
0049F9 75FF02            MOV      SFRPAGE,#02H
0049FC E5E6              MOV      A,RSETVEC
0049FE 30E00E            JNB      ACC.0,?C0092?ZW_PHY_RF_050X
004A01 9037C2            MOV      DPTR,#rf_already_calculated
004A04 7401              MOV      A,#01H
004A06 F0                MOVX     @DPTR,A
004A07 FB                MOV      R3,A
004A08 7A37              MOV      R2,#HIGH rf_already_calculated
004A0A 79C2              MOV      R1,#LOW rf_already_calculated
004A0C 1262FC            LCALL    __RF_check_checksum
004A0F         ?C0092?ZW_PHY_RF_050X:
004A0F 9037CC            MOV      DPTR,#freq_min
004A12 1224FD            LCALL    ?C?LSTKXDATA
004A15 00                DB       00H
004A16 2D                DB       02DH
004A17 C6                DB       0C6H
004A18 C0                DB       0C0H
004A19 E4                CLR      A
004A1A F5FF              MOV      SFRPAGE,A
004A1C F5A4              MOV      DMHSFLT4,A
004A1E 90120F            MOV      DPTR,#phyRfData+0EH
004A21 F0                MOVX     @DPTR,A
004A22 9037C3            MOV      DPTR,#ch
004A25 7402              MOV      A,#02H
004A27 F0                MOVX     @DPTR,A
004A28         ?C0095?ZW_PHY_RF_050X:
004A28 75FF03            MOV      SFRPAGE,#03H
004A2B 9037C3            MOV      DPTR,#ch
004A2E E0                MOVX     A,@DPTR
004A2F FF                MOV      R7,A
004A30 F595              MOV      DMCHAN,A
004A32 EF                MOV      A,R7
004A33 14                DEC      A
004A34 6017              JZ       ?C0098?ZW_PHY_RF_050X
004A36 14                DEC      A
004A37 6024              JZ       ?C0099?ZW_PHY_RF_050X
004A39 2402              ADD      A,#02H
004A3B 7033              JNZ      ?C0096?ZW_PHY_RF_050X
004A3D         ?C0097?ZW_PHY_RF_050X:
004A3D 9037B1            MOV      DPTR,#freq_ch0
004A40 71AC              ACALL    ?L?COM003B
004A42 9037C8            MOV      DPTR,#freq
004A45 1224F1            LCALL    ?C?LSTXDATA
004A48 9037BD            MOV      DPTR,#rxmode_ch0
004A4B 801E              SJMP     ?C0306?ZW_PHY_RF_050X
004A4D         ?C0098?ZW_PHY_RF_050X:
004A4D 9037B5            MOV      DPTR,#freq_ch1
004A50 71AC              ACALL    ?L?COM003B
004A52 9037C8            MOV      DPTR,#freq
004A55 1224F1            LCALL    ?C?LSTXDATA
004A58 9037BE            MOV      DPTR,#rxmode_ch1
004A5B         
004A5B 800E              SJMP     ?C0306?ZW_PHY_RF_050X
004A5D         ?C0099?ZW_PHY_RF_050X:
004A5D 9037B9            MOV      DPTR,#freq_ch2
004A60 71AC              ACALL    ?L?COM003B
004A62 9037C8            MOV      DPTR,#freq
004A65 1224F1            LCALL    ?C?LSTXDATA
004A68 9037BF            MOV      DPTR,#rxmode_ch2
004A6B         
004A6B E0                MOVX     A,@DPTR
004A6C 9037D0            MOV      DPTR,#rxmode
004A6F F0                MOVX     @DPTR,A
004A70         ?C0096?ZW_PHY_RF_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 67


004A70 126967            LCALL    _RF_general_setup_per_ch
004A73 9037D0            MOV      DPTR,#rxmode
004A76 E0                MOVX     A,@DPTR
004A77 7005              JNZ      ?C0100?ZW_PHY_RF_050X
004A79 127282            LCALL    ?L?COM0436
004A7C 8064              SJMP     ?C0093?ZW_PHY_RF_050X
004A7E         ?C0100?ZW_PHY_RF_050X:
004A7E 90120E            MOV      DPTR,#phyRfData+0DH
004A81 E0                MOVX     A,@DPTR
004A82 04                INC      A
004A83 F0                MOVX     @DPTR,A
004A84 9037C3            MOV      DPTR,#ch
004A87 F1EE              ACALL    ?L?COM0481
004A89 9037C2            MOV      DPTR,#rf_already_calculated
004A8C E0                MOVX     A,@DPTR
004A8D 701A              JNZ      ?C0102?ZW_PHY_RF_050X
004A8F 9037CC            MOV      DPTR,#freq_min
004A92 71AC              ACALL    ?L?COM003B
004A94 9037C8            MOV      DPTR,#freq
004A97 F1CC              ACALL    ?L?COM02C4
004A99 FB                MOV      R3,A
004A9A C3                CLR      C
004A9B 1223D4            LCALL    ?C?ULCMP
004A9E 5009              JNC      ?C0102?ZW_PHY_RF_050X
004AA0 9037C8            MOV      DPTR,#freq
004AA3 71AC              ACALL    ?L?COM003B
004AA5 A3                INC      DPTR
004AA6 1224F1            LCALL    ?C?LSTXDATA
004AA9         ?C0102?ZW_PHY_RF_050X:
004AA9 9037D0            MOV      DPTR,#rxmode
004AAC E0                MOVX     A,@DPTR
004AAD FF                MOV      R7,A
004AAE 1267E8            LCALL    __RF_setup_rx_and_filter
004AB1 9037C0            MOV      DPTR,#highside
004AB4 E0                MOVX     A,@DPTR
004AB5 FF                MOV      R7,A
004AB6 9037C3            MOV      DPTR,#ch
004AB9 E0                MOVX     A,@DPTR
004ABA FD                MOV      R5,A
004ABB A231              MOV      C,rf_enable
004ABD 922E              MOV      ?__RF_set_IF_setting?BIT,C
004ABF 126915            LCALL    __RF_set_IF_setting
004AC2 9037C2            MOV      DPTR,#rf_already_calculated
004AC5 E0                MOVX     A,@DPTR
004AC6 7012              JNZ      ?C0104?ZW_PHY_RF_050X
004AC8 9037C8            MOV      DPTR,#freq
004ACB 71AC              ACALL    ?L?COM003B
004ACD 904169            MOV      DPTR,#?_calculate_fcw?BYTE+01H
004AD0 1224F1            LCALL    ?C?LSTXDATA
004AD3 9037C3            MOV      DPTR,#ch
004AD6 E0                MOVX     A,@DPTR
004AD7 FF                MOV      R7,A
004AD8 D14A              ACALL    _calculate_fcw
004ADA         ?C0104?ZW_PHY_RF_050X:
004ADA 9037C3            MOV      DPTR,#ch
004ADD E0                MOVX     A,@DPTR
004ADE 719F              ACALL    ?L?COM003A
004AE0 F183              ACALL    __set_fcw
004AE2         ?C0093?ZW_PHY_RF_050X:
004AE2 1273BE            LCALL    ?L?COM05C2
004AE5 6002              JZ       $ + 4H
004AE7 4128              AJMP     ?C0095?ZW_PHY_RF_050X
004AE9 9037C2            MOV      DPTR,#rf_already_calculated
004AEC E0                MOVX     A,@DPTR
004AED 7043              JNZ      ?C0105?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 68


004AEF A3                INC      DPTR
004AF0 7402              MOV      A,#02H
004AF2 F0                MOVX     @DPTR,A
004AF3         ?C0108?ZW_PHY_RF_050X:
004AF3 75FF03            MOV      SFRPAGE,#03H
004AF6 9037C3            MOV      DPTR,#ch
004AF9 F1DF              ACALL    ?L?COM0637
004AFB 7012              JNZ      ?C0106?ZW_PHY_RF_050X
004AFD 9037CC            MOV      DPTR,#freq_min
004B00 31BF              ACALL    ?L?COM0071
004B02 FC                MOV      R4,A
004B03 7801              MOV      R0,#01H
004B05 1223E5            LCALL    ?C?ULSHR
004B08 9037C3            MOV      DPTR,#ch
004B0B 718C              ACALL    ?L?COM0038
004B0D F183              ACALL    __set_fcw
004B0F         ?C0106?ZW_PHY_RF_050X:
004B0F 1273BE            LCALL    ?L?COM05C2
004B12 70DF              JNZ      ?C0108?ZW_PHY_RF_050X
004B14 9037CC            MOV      DPTR,#freq_min
004B17 127206            LCALL    ?L?COM03A1
004B1A 2420              ADD      A,#020H
004B1C FF                MOV      R7,A
004B1D EE                MOV      A,R6
004B1E 344E              ADDC     A,#04EH
004B20 31E1              ACALL    ?L?COM0076
004B22 F1D7              ACALL    ?L?COM05E2
004B24 31CF              ACALL    ?L?COM0073
004B26 FC                MOV      R4,A
004B27 7801              MOV      R0,#01H
004B29 1223E5            LCALL    ?C?ULSHR
004B2C 9037C4            MOV      DPTR,#fcw
004B2F 1224F1            LCALL    ?C?LSTXDATA
004B32         ?C0105?ZW_PHY_RF_050X:
004B32 1263DF            LCALL    ?L?COM0346
004B35 4003              JC       ?C0110?ZW_PHY_RF_050X
004B37 43F420            ORL      DMCTRL,#020H
004B3A         ?C0110?ZW_PHY_RF_050X:
004B3A A231              MOV      C,rf_enable
004B3C 922F              MOV      ?_RF_general_setup?BIT,C
004B3E 126847            LCALL    _RF_general_setup
004B41 9037C2            MOV      DPTR,#rf_already_calculated
004B44 E0                MOVX     A,@DPTR
004B45 24FF              ADD      A,#0FFH
004B47 922D              MOV      ?__PLL_set_bank5?BIT,C
004B49 9037C4            MOV      DPTR,#fcw
004B4C 71AC              ACALL    ?L?COM003B
004B4E 127248            LCALL    ?L?COM0402
004B51 E4                CLR      A
004B52 F5FF              MOV      SFRPAGE,A
004B54 75E508            MOV      SDSTAT3,#08H
004B57 1264FA            LCALL    ?L?COM0480
004B5A         ?C0111?ZW_PHY_RF_050X:
004B5A E59B              MOV      A,SEQCON5
004B5C 30E7FB            JNB      ACC.7,?C0111?ZW_PHY_RF_050X
004B5F         ?C0112?ZW_PHY_RF_050X:
004B5F D1E2              ACALL    ?L?COM0122
004B61 F1C6              ACALL    ?L?COM04FF
004B63 43D504            ORL      RFCON,#04H
004B66 7FC8              MOV      R7,#0C8H
004B68 D1F5              ACALL    ?L?COM0124
004B6A 91E1              ACALL    _RF_generate_checksum
004B6C F124              ACALL    wait_phy_timer_timeout
004B6E 7B01              MOV      R3,#01H
004B70 7A37              MOV      R2,#HIGH success
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 69


004B72 79C1              MOV      R1,#LOW success
004B74 1263ED            LCALL    __PLL_wait_lock_and_sequencer_done
004B77 90120E            MOV      DPTR,#phyRfData+0DH
004B7A E0                MOVX     A,@DPTR
004B7B B40102            CJNE     A,#01H,?C0113?ZW_PHY_RF_050X
004B7E F1E7              ACALL    ?L?COM0570
004B80         ?C0113?ZW_PHY_RF_050X:
004B80 9037C1            MOV      DPTR,#success
004B83 E0                MOVX     A,@DPTR
004B84 B40103            CJNE     A,#01H,?C0114?ZW_PHY_RF_050X
004B87 D3                SETB     C
004B88 8001              SJMP     ?C0115?ZW_PHY_RF_050X
004B8A         ?C0114?ZW_PHY_RF_050X:
004B8A C3                CLR      C
004B8B         ?C0115?ZW_PHY_RF_050X:
004B8B 22                RET      
----- FUNCTION _RF_onetime_init_and_rx (END) -------


----- FUNCTION ?L?COM0038 (BEGIN) -----
004B8C E0                MOVX     A,@DPTR
004B8D FB                MOV      R3,A
004B8E 25E0              ADD      A,ACC
004B90 25E0              ADD      A,ACC
004B92 2401              ADD      A,#LOW phyRfData
004B94 F582              MOV      DPL,A
004B96 E4                CLR      A
004B97 3412              ADDC     A,#HIGH phyRfData
004B99 F583              MOV      DPH,A
004B9B 1224F1            LCALL    ?C?LSTXDATA
004B9E         ?L?COM0039:
004B9E EB                MOV      A,R3
004B9F         ?L?COM003A:
004B9F 25E0              ADD      A,ACC
004BA1 25E0              ADD      A,ACC
004BA3 2401              ADD      A,#LOW phyRfData
004BA5 F582              MOV      DPL,A
004BA7 E4                CLR      A
004BA8 3412              ADDC     A,#HIGH phyRfData
004BAA F583              MOV      DPH,A
004BAC         ?L?COM003B:
004BAC E0                MOVX     A,@DPTR
004BAD FC                MOV      R4,A
004BAE A3                INC      DPTR
004BAF E0                MOVX     A,@DPTR
004BB0 FD                MOV      R5,A
004BB1         ?L?COM003C:
004BB1 A3                INC      DPTR
004BB2 E0                MOVX     A,@DPTR
004BB3 FE                MOV      R6,A
004BB4 A3                INC      DPTR
004BB5 E0                MOVX     A,@DPTR
004BB6 FF                MOV      R7,A
004BB7 22                RET      
----- FUNCTION ?L?COM0038 (END) -------


----- FUNCTION _RF_onetime_init (BEGIN) -----
004BB8 903930            MOV      DPTR,#freq_ch0
004BBB 1224F1            LCALL    ?C?LSTXDATA
004BBE F12D              ACALL    ?L?COM0483
004BC0 903945            MOV      DPTR,#freq_min
004BC3 1224FD            LCALL    ?C?LSTKXDATA
004BC6 00                DB       00H
004BC7 2D                DB       02DH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 70


004BC8 C6                DB       0C6H
004BC9 C0                DB       0C0H
004BCA E4                CLR      A
004BCB F5FF              MOV      SFRPAGE,A
004BCD F5A4              MOV      DMHSFLT4,A
004BCF 90120E            MOV      DPTR,#phyRfData+0DH
004BD2 F0                MOVX     @DPTR,A
004BD3 A3                INC      DPTR
004BD4 F0                MOVX     @DPTR,A
004BD5 903940            MOV      DPTR,#ch
004BD8 7402              MOV      A,#02H
004BDA F0                MOVX     @DPTR,A
004BDB         ?C0078?ZW_PHY_RF_050X:
004BDB 75FF03            MOV      SFRPAGE,#03H
004BDE 903940            MOV      DPTR,#ch
004BE1 E0                MOVX     A,@DPTR
004BE2 FF                MOV      R7,A
004BE3 F595              MOV      DMCHAN,A
004BE5 EF                MOV      A,R7
004BE6 14                DEC      A
004BE7 6017              JZ       ?C0081?ZW_PHY_RF_050X
004BE9 14                DEC      A
004BEA 6024              JZ       ?C0082?ZW_PHY_RF_050X
004BEC 2402              ADD      A,#02H
004BEE 7033              JNZ      ?C0079?ZW_PHY_RF_050X
004BF0         ?C0080?ZW_PHY_RF_050X:
004BF0 903930            MOV      DPTR,#freq_ch0
004BF3 71AC              ACALL    ?L?COM003B
004BF5 903941            MOV      DPTR,#freq
004BF8 1224F1            LCALL    ?C?LSTXDATA
004BFB 90393C            MOV      DPTR,#rxmode_ch0
004BFE 801E              SJMP     ?C0304?ZW_PHY_RF_050X
004C00         ?C0081?ZW_PHY_RF_050X:
004C00 903934            MOV      DPTR,#freq_ch1
004C03 71AC              ACALL    ?L?COM003B
004C05 903941            MOV      DPTR,#freq
004C08 1224F1            LCALL    ?C?LSTXDATA
004C0B 90393D            MOV      DPTR,#rxmode_ch1
004C0E         
004C0E 800E              SJMP     ?C0304?ZW_PHY_RF_050X
004C10         ?C0082?ZW_PHY_RF_050X:
004C10 903938            MOV      DPTR,#freq_ch2
004C13 71AC              ACALL    ?L?COM003B
004C15 903941            MOV      DPTR,#freq
004C18 1224F1            LCALL    ?C?LSTXDATA
004C1B 90393E            MOV      DPTR,#rxmode_ch2
004C1E         
004C1E E0                MOVX     A,@DPTR
004C1F 903949            MOV      DPTR,#rxmode
004C22 F0                MOVX     @DPTR,A
004C23         ?C0079?ZW_PHY_RF_050X:
004C23 126967            LCALL    _RF_general_setup_per_ch
004C26 903949            MOV      DPTR,#rxmode
004C29 E0                MOVX     A,@DPTR
004C2A 7005              JNZ      ?C0083?ZW_PHY_RF_050X
004C2C 127282            LCALL    ?L?COM0436
004C2F 8054              SJMP     ?C0076?ZW_PHY_RF_050X
004C31         ?C0083?ZW_PHY_RF_050X:
004C31 90120E            MOV      DPTR,#phyRfData+0DH
004C34 E0                MOVX     A,@DPTR
004C35 04                INC      A
004C36 F0                MOVX     @DPTR,A
004C37 903940            MOV      DPTR,#ch
004C3A F1EE              ACALL    ?L?COM0481
004C3C 903945            MOV      DPTR,#freq_min
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 71


004C3F 71AC              ACALL    ?L?COM003B
004C41 903941            MOV      DPTR,#freq
004C44 F1CC              ACALL    ?L?COM02C4
004C46 FB                MOV      R3,A
004C47 C3                CLR      C
004C48 1223D4            LCALL    ?C?ULCMP
004C4B 5009              JNC      ?C0085?ZW_PHY_RF_050X
004C4D 903941            MOV      DPTR,#freq
004C50 71AC              ACALL    ?L?COM003B
004C52 A3                INC      DPTR
004C53 1224F1            LCALL    ?C?LSTXDATA
004C56         ?C0085?ZW_PHY_RF_050X:
004C56 903949            MOV      DPTR,#rxmode
004C59 E0                MOVX     A,@DPTR
004C5A FF                MOV      R7,A
004C5B 1267E8            LCALL    __RF_setup_rx_and_filter
004C5E 90393F            MOV      DPTR,#highside
004C61 E0                MOVX     A,@DPTR
004C62 FF                MOV      R7,A
004C63 A3                INC      DPTR
004C64 E0                MOVX     A,@DPTR
004C65 FD                MOV      R5,A
004C66 A230              MOV      C,rf_enable
004C68 922E              MOV      ?__RF_set_IF_setting?BIT,C
004C6A 126915            LCALL    __RF_set_IF_setting
004C6D A3                INC      DPTR
004C6E 71AC              ACALL    ?L?COM003B
004C70 904169            MOV      DPTR,#?_calculate_fcw?BYTE+01H
004C73 1224F1            LCALL    ?C?LSTXDATA
004C76 903940            MOV      DPTR,#ch
004C79 E0                MOVX     A,@DPTR
004C7A FF                MOV      R7,A
004C7B D14A              ACALL    _calculate_fcw
004C7D 903940            MOV      DPTR,#ch
004C80 E0                MOVX     A,@DPTR
004C81 719F              ACALL    ?L?COM003A
004C83 F183              ACALL    __set_fcw
004C85         ?C0076?ZW_PHY_RF_050X:
004C85 1273C7            LCALL    ?L?COM05C3
004C88 6002              JZ       $ + 4H
004C8A 61DB              AJMP     ?C0078?ZW_PHY_RF_050X
004C8C 7402              MOV      A,#02H
004C8E F0                MOVX     @DPTR,A
004C8F         ?C0088?ZW_PHY_RF_050X:
004C8F 75FF03            MOV      SFRPAGE,#03H
004C92 903940            MOV      DPTR,#ch
004C95 F1DF              ACALL    ?L?COM0637
004C97 7017              JNZ      ?C0086?ZW_PHY_RF_050X
004C99 FF                MOV      R7,A
004C9A 7E04              MOV      R6,#04H
004C9C FD                MOV      R5,A
004C9D FC                MOV      R4,A
004C9E 903945            MOV      DPTR,#freq_min
004CA1 31C4              ACALL    ?L?COM0072
004CA3 FC                MOV      R4,A
004CA4 7801              MOV      R0,#01H
004CA6 1223E5            LCALL    ?C?ULSHR
004CA9 903940            MOV      DPTR,#ch
004CAC 718C              ACALL    ?L?COM0038
004CAE F183              ACALL    __set_fcw
004CB0         ?C0086?ZW_PHY_RF_050X:
004CB0 1273C7            LCALL    ?L?COM05C3
004CB3 70DA              JNZ      ?C0088?ZW_PHY_RF_050X
004CB5 1263DF            LCALL    ?L?COM0346
004CB8 4003              JC       ?C0090?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 72


004CBA 43F420            ORL      DMCTRL,#020H
004CBD         ?C0090?ZW_PHY_RF_050X:
004CBD A230              MOV      C,rf_enable
004CBF 922F              MOV      ?_RF_general_setup?BIT,C
004CC1 126847            LCALL    _RF_general_setup
004CC4 903945            MOV      DPTR,#freq_min
004CC7 127206            LCALL    ?L?COM03A1
004CCA 2420              ADD      A,#020H
004CCC FF                MOV      R7,A
004CCD EE                MOV      A,R6
004CCE 344E              ADDC     A,#04EH
004CD0 31E1              ACALL    ?L?COM0076
004CD2 F1D7              ACALL    ?L?COM05E2
004CD4 31CF              ACALL    ?L?COM0073
004CD6 FC                MOV      R4,A
004CD7 7801              MOV      R0,#01H
004CD9 1223E5            LCALL    ?C?ULSHR
;---- Variable 'fcw' assigned to Register 'R4/R5/R6/R7' ----
004CDC C22D              CLR      ?__PLL_set_bank5?BIT
004CDE 127248            LCALL    ?L?COM0402
;----                  JMP      _RF_generate_checksum
----- FUNCTION _RF_onetime_init (END) -------


----- FUNCTION _RF_generate_checksum (BEGIN) -----
004CE1 901213            MOV      DPTR,#phyRfData+012H
004CE4 7401              MOV      A,#01H
004CE6 F0                MOVX     @DPTR,A
004CE7 7E12              MOV      R6,#HIGH phyRfData
004CE9 7F01              MOV      R7,#LOW phyRfData
;---- Variable 'adr' assigned to Register 'R6/R7' ----
;---- Variable 'i' assigned to Register 'R5' ----
004CEB E4                CLR      A
004CEC FD                MOV      R5,A
004CED         ?C0021?ZW_PHY_RF_050X:
004CED 8F82              MOV      DPL,R7
004CEF 8E83              MOV      DPH,R6
004CF1 EF                MOV      A,R7
004CF2 2D                ADD      A,R5
004CF3 F582              MOV      DPL,A
004CF5 E4                CLR      A
004CF6 3E                ADDC     A,R6
004CF7 F583              MOV      DPH,A
004CF9 E0                MOVX     A,@DPTR
004CFA FC                MOV      R4,A
004CFB 901213            MOV      DPTR,#phyRfData+012H
004CFE E0                MOVX     A,@DPTR
004CFF 2C                ADD      A,R4
004D00 F0                MOVX     @DPTR,A
004D01 0D                INC      R5
004D02 ED                MOV      A,R5
004D03 B412E7            CJNE     A,#012H,?C0021?ZW_PHY_RF_050X
004D06 22                RET      
----- FUNCTION _RF_generate_checksum (END) -------


----- FUNCTION _RF_get_random_word (BEGIN) -----
004D07 903DB0            MOV      DPTR,#randomWord
004D0A 12632A            LCALL    ?L?COM015E
004D0D 903DB6            MOV      DPTR,#rf_random
004D10 1224FD            LCALL    ?C?LSTKXDATA
004D13 00                DB       00H
004D14 00                DB       00H
004D15 00                DB       00H
004D16 01                DB       01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 73


004D17 903DBA            MOV      DPTR,#success
004D1A 7401              MOV      A,#01H
004D1C F0                MOVX     @DPTR,A
004D1D F5FF              MOV      SFRPAGE,A
004D1F E5D5              MOV      A,RFCON
004D21 54C0              ANL      A,#0C0H
004D23 7005              JNZ      ?C0269?ZW_PHY_RF_050X
004D25 1255FE            LCALL    RF_demodulator_enable_get
004D28 5002              JNC      ?C0268?ZW_PHY_RF_050X
004D2A         ?C0269?ZW_PHY_RF_050X:
004D2A C3                CLR      C
004D2B 22                RET      
004D2C         ?C0268?ZW_PHY_RF_050X:
004D2C E4                CLR      A
004D2D F5FF              MOV      SFRPAGE,A
004D2F 53967F            ANL      DMSETUP5,#07FH
004D32 75FF01            MOV      SFRPAGE,#01H
004D35 75D504            MOV      RFCON,#04H
004D38 F11D              ACALL    ?L?COM0325
004D3A 75FF01            MOV      SFRPAGE,#01H
004D3D 43D508            ORL      RFCON,#08H
004D40 E4                CLR      A
004D41 F5FF              MOV      SFRPAGE,A
004D43 5394FB            ANL      DMSETUP1,#0FBH
004D46 F5FF              MOV      SFRPAGE,A
004D48 53847F            ANL      TRACKCON,#07FH
004D4B F5FF              MOV      SFRPAGE,A
004D4D 7598FF            MOV      DMLSPLO,#0FFH
004D50 903DB4            MOV      DPTR,#dmctrlOld
004D53 E5F4              MOV      A,DMCTRL
004D55 F0                MOVX     @DPTR,A
004D56 75F49C            MOV      DMCTRL,#09CH
004D59 75FF01            MOV      SFRPAGE,#01H
004D5C A3                INC      DPTR
004D5D E5E4              MOV      A,SDCON1
004D5F F0                MOVX     @DPTR,A
004D60 75E425            MOV      SDCON1,#025H
004D63 7B01              MOV      R3,#01H
004D65 7A3D              MOV      R2,#HIGH success
004D67 79BA              MOV      R1,#LOW success
004D69 1262FC            LCALL    __RF_check_checksum
004D6C 903DBA            MOV      DPTR,#success
004D6F E0                MOVX     A,@DPTR
004D70 6401              XRL      A,#01H
004D72 6002              JZ       $ + 4H
004D74 C128              AJMP     ?C0271?ZW_PHY_RF_050X
004D76 F5FF              MOV      SFRPAGE,A
004D78 903DB3            MOV      DPTR,#bNumOfBits
004D7B 7414              MOV      A,#014H
004D7D F0                MOVX     @DPTR,A
004D7E         ?C0274?ZW_PHY_RF_050X:
004D7E 903DB6            MOV      DPTR,#rf_random
004D81 71AC              ACALL    ?L?COM003B
004D83 7801              MOV      R0,#01H
004D85 1223F8            LCALL    ?C?LSHL
004D88 903DB6            MOV      DPTR,#rf_random
004D8B 1224F1            LCALL    ?C?LSTXDATA
004D8E         ?C0275?ZW_PHY_RF_050X:
004D8E E5A7              MOV      A,DMSTAT2
004D90 30E1FB            JNB      ACC.1,?C0275?ZW_PHY_RF_050X
004D93         ?C0276?ZW_PHY_RF_050X:
004D93 43A702            ORL      DMSTAT2,#02H
004D96 903DB6            MOV      DPTR,#rf_random
004D99 71AC              ACALL    ?L?COM003B
004D9B E5A7              MOV      A,DMSTAT2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 74


004D9D 30E005            JNB      ACC.0,?C0277?ZW_PHY_RF_050X
004DA0 E4                CLR      A
004DA1 7B01              MOV      R3,#01H
004DA3 8002              SJMP     ?C0309?ZW_PHY_RF_050X
004DA5         ?C0277?ZW_PHY_RF_050X:
004DA5 E4                CLR      A
004DA6 FB                MOV      R3,A
004DA7         
004DA7 FA                MOV      R2,A
004DA8 F9                MOV      R1,A
004DA9 F8                MOV      R0,A
004DAA         ?C0278?ZW_PHY_RF_050X:
004DAA EF                MOV      A,R7
004DAB 4B                ORL      A,R3
004DAC FF                MOV      R7,A
004DAD EE                MOV      A,R6
004DAE 4A                ORL      A,R2
004DAF FE                MOV      R6,A
004DB0 ED                MOV      A,R5
004DB1 49                ORL      A,R1
004DB2 FD                MOV      R5,A
004DB3 EC                MOV      A,R4
004DB4 48                ORL      A,R0
004DB5 FC                MOV      R4,A
004DB6 903DB6            MOV      DPTR,#rf_random
004DB9 1224F1            LCALL    ?C?LSTXDATA
004DBC 903DB3            MOV      DPTR,#bNumOfBits
004DBF E0                MOVX     A,@DPTR
004DC0 14                DEC      A
004DC1 F0                MOVX     @DPTR,A
004DC2 70BA              JNZ      ?C0274?ZW_PHY_RF_050X
004DC4 903DB6            MOV      DPTR,#rf_random
004DC7 71AC              ACALL    ?L?COM003B
004DC9 7810              MOV      R0,#010H
004DCB 1223E5            LCALL    ?C?ULSHR
004DCE 7B6D              MOV      R3,#06DH
004DD0 7A4E              MOV      R2,#04EH
004DD2 79C6              MOV      R1,#0C6H
004DD4 7841              MOV      R0,#041H
004DD6 122286            LCALL    ?C?LMUL
004DD9 EF                MOV      A,R7
004DDA 2439              ADD      A,#039H
004DDC FF                MOV      R7,A
004DDD EE                MOV      A,R6
004DDE 3430              ADDC     A,#030H
004DE0 31E1              ACALL    ?L?COM0076
004DE2 FC                MOV      R4,A
;---- Variable 'seed' assigned to Register 'R4/R5/R6/R7' ----
004DE3 E4                CLR      A
004DE4 FB                MOV      R3,A
004DE5 FA                MOV      R2,A
004DE6 7901              MOV      R1,#01H
004DE8 F8                MOV      R0,A
004DE9 122311            LCALL    ?C?ULDIV
004DEC EE                MOV      A,R6
004DED 547F              ANL      A,#07FH
004DEF FE                MOV      R6,A
004DF0 E4                CLR      A
004DF1 FD                MOV      R5,A
004DF2 FC                MOV      R4,A
004DF3 126B0A            LCALL    ?L?COM047F
004DF6 903DB6            MOV      DPTR,#rf_random
004DF9 71AC              ACALL    ?L?COM003B
004DFB EB                MOV      A,R3
004DFC 6F                XRL      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 75


004DFD FF                MOV      R7,A
004DFE EA                MOV      A,R2
004DFF 6E                XRL      A,R6
004E00 FE                MOV      R6,A
004E01 E8                MOV      A,R0
;---- Variable 'result' assigned to Register 'R4/R5' ----
004E02 CD                XCH      A,R5
004E03 EF                MOV      A,R7
004E04 CD                XCH      A,R5
004E05 CC                XCH      A,R4
004E06 EE                MOV      A,R6
004E07 CC                XCH      A,R4
004E08 EC                MOV      A,R4
004E09 FF                MOV      R7,A
004E0A 12633A            LCALL    ?L?COM02B2
004E0D EF                MOV      A,R7
004E0E 122072            LCALL    ?C?CSTPTR
004E11 12633A            LCALL    ?L?COM02B2
004E14 900001            MOV      DPTR,#01H
004E17 ED                MOV      A,R5
004E18 122084            LCALL    ?C?CSTOPTR
004E1B 90120F            MOV      DPTR,#phyRfData+0EH
004E1E E0                MOVX     A,@DPTR
004E1F 30E606            JNB      ACC.6,?C0271?ZW_PHY_RF_050X
004E22 E4                CLR      A
004E23 F5FF              MOV      SFRPAGE,A
004E25 759680            MOV      DMSETUP5,#080H
004E28         ?C0271?ZW_PHY_RF_050X:
004E28 75FF01            MOV      SFRPAGE,#01H
004E2B E4                CLR      A
004E2C F5D5              MOV      RFCON,A
004E2E 903DB4            MOV      DPTR,#dmctrlOld
004E31 E0                MOVX     A,@DPTR
004E32 F5F4              MOV      DMCTRL,A
004E34 75FF01            MOV      SFRPAGE,#01H
004E37 A3                INC      DPTR
004E38 E0                MOVX     A,@DPTR
004E39 F5E4              MOV      SDCON1,A
004E3B 126836            LCALL    _RF_init_demodulator
004E3E 903DBA            MOV      DPTR,#success
004E41 E0                MOVX     A,@DPTR
004E42 B40103            CJNE     A,#01H,?C0280?ZW_PHY_RF_050X
004E45 D3                SETB     C
004E46 8001              SJMP     ?C0281?ZW_PHY_RF_050X
004E48         ?C0280?ZW_PHY_RF_050X:
004E48 C3                CLR      C
004E49         ?C0281?ZW_PHY_RF_050X:
004E49 22                RET      
----- FUNCTION _RF_get_random_word (END) -------


----- FUNCTION _calculate_fcw (BEGIN) -----
004E4A 904168            MOV      DPTR,#ch
004E4D EF                MOV      A,R7
004E4E F0                MOVX     @DPTR,A
004E4F E4                CLR      A
004E50 A3                INC      DPTR
004E51 31BF              ACALL    ?L?COM0071
004E53 FC                MOV      R4,A
004E54 7801              MOV      R0,#01H
004E56 1223E5            LCALL    ?C?ULSHR
004E59 904168            MOV      DPTR,#ch
004E5C E0                MOVX     A,@DPTR
004E5D FB                MOV      R3,A
004E5E F15B              ACALL    ?L?COM028E
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 76


004E60 F583              MOV      DPH,A
004E62 1224F1            LCALL    ?C?LSTXDATA
004E65 901210            MOV      DPTR,#phyRfData+0FH
004E68 E0                MOVX     A,@DPTR
004E69 6480              XRL      A,#080H
004E6B 6074              JZ       ?C0075?ZW_PHY_RF_050X
004E6D E0                MOVX     A,@DPTR
004E6E C3                CLR      C
004E6F 947F              SUBB     A,#07FH
004E71 5039              JNC      ?C0073?ZW_PHY_RF_050X
004E73 EB                MOV      A,R3
004E74 F15B              ACALL    ?L?COM028E
004E76 F583              MOV      DPH,A
004E78 C083              PUSH     DPH
004E7A C082              PUSH     DPL
004E7C 71AC              ACALL    ?L?COM003B
004E7E EE                MOV      A,R6
004E7F C0E0              PUSH     ACC
004E81 EF                MOV      A,R7
004E82 C0E0              PUSH     ACC
004E84 901210            MOV      DPTR,#phyRfData+0FH
004E87 E0                MOVX     A,@DPTR
004E88 75F004            MOV      B,#04H
004E8B A4                MUL      AB
004E8C AEF0              MOV      R6,B
004E8E FB                MOV      R3,A
004E8F CA                XCH      A,R2
004E90 EE                MOV      A,R6
004E91 CA                XCH      A,R2
004E92 EA                MOV      A,R2
004E93 33                RLC      A
004E94 95E0              SUBB     A,ACC
004E96 F9                MOV      R1,A
004E97 F8                MOV      R0,A
004E98 D0E0              POP      ACC
004E9A FF                MOV      R7,A
004E9B D0E0              POP      ACC
004E9D FE                MOV      R6,A
004E9E C3                CLR      C
004E9F EF                MOV      A,R7
004EA0 9B                SUBB     A,R3
004EA1 FF                MOV      R7,A
004EA2 EE                MOV      A,R6
004EA3 9A                SUBB     A,R2
004EA4 FE                MOV      R6,A
004EA5 ED                MOV      A,R5
004EA6 99                SUBB     A,R1
004EA7 FD                MOV      R5,A
004EA8 EC                MOV      A,R4
004EA9 98                SUBB     A,R0
004EAA 802D              SJMP     ?C0302?ZW_PHY_RF_050X
004EAC         ?C0073?ZW_PHY_RF_050X:
004EAC 904168            MOV      DPTR,#ch
004EAF E0                MOVX     A,@DPTR
004EB0 F15B              ACALL    ?L?COM028E
004EB2 F583              MOV      DPH,A
004EB4 C083              PUSH     DPH
004EB6 C082              PUSH     DPL
004EB8 F1CC              ACALL    ?L?COM02C4
004EBA FB                MOV      R3,A
004EBB 901210            MOV      DPTR,#phyRfData+0FH
004EBE E0                MOVX     A,@DPTR
004EBF F4                CPL      A
004EC0 04                INC      A
004EC1 75F004            MOV      B,#04H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 77


004EC4 A4                MUL      AB
004EC5 FF                MOV      R7,A
004EC6 AEF0              MOV      R6,B
004EC8 EE                MOV      A,R6
004EC9 33                RLC      A
004ECA 95E0              SUBB     A,ACC
004ECC FD                MOV      R5,A
004ECD FC                MOV      R4,A
004ECE EB                MOV      A,R3
004ECF 2F                ADD      A,R7
004ED0 FF                MOV      R7,A
004ED1 EA                MOV      A,R2
004ED2 3E                ADDC     A,R6
004ED3 FE                MOV      R6,A
004ED4 E9                MOV      A,R1
004ED5 3D                ADDC     A,R5
004ED6 FD                MOV      R5,A
004ED7 E8                MOV      A,R0
004ED8 3C                ADDC     A,R4
004ED9         
004ED9 FC                MOV      R4,A
004EDA D082              POP      DPL
004EDC D083              POP      DPH
004EDE 1224F1            LCALL    ?C?LSTXDATA
004EE1         ?C0075?ZW_PHY_RF_050X:
004EE1 22                RET      
----- FUNCTION _calculate_fcw (END) -------


----- FUNCTION ?L?COM0122 (BEGIN) -----
004EE2 E4                CLR      A
004EE3 F5FF              MOV      SFRPAGE,A
004EE5 758EC8            MOV      DPLLSMCON,#0C8H
004EE8 125F8D            LCALL    _PLL_boost_bias
004EEB 75FF01            MOV      SFRPAGE,#01H
004EEE 53D5FB            ANL      RFCON,#0FBH
004EF1 F1BF              ACALL    stop_phy_timer
004EF3         ?L?COM0123:
004EF3 7F14              MOV      R7,#014H
004EF5         ?L?COM0124:
004EF5 7E00              MOV      R6,#00H
004EF7 F100              ACALL    _set_phy_timer_timeout
----- FUNCTION start_phy_timer (BEGIN) -----
004EF9 75FF03            MOV      SFRPAGE,#03H
004EFC 439180            ORL      PHYTCON1,#080H
004EFF 22                RET      
----- FUNCTION start_phy_timer (END) -------


----- FUNCTION _set_phy_timer_timeout (BEGIN) -----
;---- Variable 'timeout' assigned to Register 'R6/R7' ----
004F00 75FF03            MOV      SFRPAGE,#03H
004F03 D3                SETB     C
004F04 EF                MOV      A,R7
004F05 9402              SUBB     A,#02H
004F07 EE                MOV      A,R6
004F08 9400              SUBB     A,#00H
004F0A 4008              JC       ?C0003?ZW_PHY_RF_050X
004F0C 74FE              MOV      A,#0FEH
004F0E 2F                ADD      A,R7
004F0F FF                MOV      R7,A
004F10 74FF              MOV      A,#0FFH
004F12 3E                ADDC     A,R6
004F13 FE                MOV      R6,A
004F14         ?C0003?ZW_PHY_RF_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 78


004F14 EF                MOV      A,R7
004F15 F592              MOV      PHYTCON2,A
004F17 EE                MOV      A,R6
004F18 540F              ANL      A,#0FH
004F1A F591              MOV      PHYTCON1,A
004F1C 22                RET      
----- FUNCTION _set_phy_timer_timeout (END) -------


----- FUNCTION ?L?COM0325 (BEGIN) -----
004F1D 7F3F              MOV      R7,#03FH
004F1F FE                MOV      R6,A
004F20         ?L?COM0326:
004F20 F100              ACALL    _set_phy_timer_timeout
004F22 D1F9              ACALL    start_phy_timer
----- FUNCTION wait_phy_timer_timeout (BEGIN) -----
004F24 75FF03            MOV      SFRPAGE,#03H
004F27         ?C0008?ZW_PHY_RF_050X:
004F27 E591              MOV      A,PHYTCON1
004F29 20E7FB            JB       ACC.7,?C0008?ZW_PHY_RF_050X
004F2C 22                RET      
----- FUNCTION wait_phy_timer_timeout (END) -------


----- FUNCTION ?L?COM0483 (BEGIN) -----
004F2D 75FF02            MOV      SFRPAGE,#02H
004F30 43E180            ORL      WUTREG1,#080H
004F33 F167              ACALL    RF_shutdown
----- FUNCTION _RF_LDO_precharge (BEGIN) -----
004F35 75FF01            MOV      SFRPAGE,#01H
004F38 438E10            ORL      ADCCON5,#010H
004F3B 75FF01            MOV      SFRPAGE,#01H
004F3E 53DB7F            ANL      RFTEST,#07FH
004F41 75FF01            MOV      SFRPAGE,#01H
004F44 75D502            MOV      RFCON,#02H
004F47 D1F3              ACALL    ?L?COM0123
004F49 F1C6              ACALL    ?L?COM04FF
004F4B 438E10            ORL      ADCCON5,#010H
004F4E 75FF01            MOV      SFRPAGE,#01H
004F51 43DB80            ORL      RFTEST,#080H
004F54 75FF01            MOV      SFRPAGE,#01H
004F57 E4                CLR      A
004F58 F5D5              MOV      RFCON,A
004F5A 22                RET      
----- FUNCTION _RF_LDO_precharge (END) -------


----- FUNCTION ?L?COM028E (BEGIN) -----
004F5B 25E0              ADD      A,ACC
004F5D 25E0              ADD      A,ACC
004F5F 2401              ADD      A,#LOW phyRfData
004F61 F582              MOV      DPL,A
004F63 E4                CLR      A
004F64 3412              ADDC     A,#HIGH phyRfData
004F66 22                RET      
----- FUNCTION ?L?COM028E (END) -------


----- FUNCTION RF_shutdown (BEGIN) -----
004F67         ?C0177?ZW_PHY_RF_050X:
004F67 E5FA              MOV      A,MODCTRL
004F69 30E1FB            JNB      ACC.1,?C0177?ZW_PHY_RF_050X
004F6C         ?C0178?ZW_PHY_RF_050X:
004F6C 75FC80            MOV      SEQCON,#080H
004F6F 75FF01            MOV      SFRPAGE,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 79


004F72 53D5EF            ANL      RFCON,#0EFH
004F75 E4                CLR      A
004F76 F5FC              MOV      SEQCON,A
004F78 75FC40            MOV      SEQCON,#040H
004F7B F1BF              ACALL    stop_phy_timer
004F7D         ?C0179?ZW_PHY_RF_050X:
004F7D E5FC              MOV      A,SEQCON
004F7F 20E6FB            JB       ACC.6,?C0179?ZW_PHY_RF_050X
004F82 22                RET      
----- FUNCTION RF_shutdown (END) -------


----- FUNCTION __set_fcw (BEGIN) -----
004F83 9041F7            MOV      DPTR,#fcw
004F86 1224F1            LCALL    ?C?LSTXDATA
004F89 75FF01            MOV      SFRPAGE,#01H
004F8C 9041F7            MOV      DPTR,#fcw
004F8F A3                INC      DPTR
004F90 E0                MOVX     A,@DPTR
004F91 FD                MOV      R5,A
004F92 A3                INC      DPTR
004F93 A3                INC      DPTR
004F94 E4                CLR      A
004F95 FF                MOV      R7,A
004F96 FE                MOV      R6,A
004F97 E4                CLR      A
004F98 FC                MOV      R4,A
004F99 7810              MOV      R0,#010H
004F9B 1223E5            LCALL    ?C?ULSHR
004F9E 8FE1              MOV      RFFREQ1,R7
004FA0 9041F7            MOV      DPTR,#fcw
004FA3 A3                INC      DPTR
004FA4 A3                INC      DPTR
004FA5 E0                MOVX     A,@DPTR
004FA6 FE                MOV      R6,A
004FA7 A3                INC      DPTR
004FA8 E4                CLR      A
004FA9 FF                MOV      R7,A
004FAA E4                CLR      A
004FAB FD                MOV      R5,A
004FAC FC                MOV      R4,A
004FAD 7808              MOV      R0,#08H
004FAF 1223E5            LCALL    ?C?ULSHR
004FB2 8FE2              MOV      RFFREQ2,R7
004FB4 9041F7            MOV      DPTR,#fcw
004FB7 A3                INC      DPTR
004FB8 A3                INC      DPTR
004FB9 A3                INC      DPTR
004FBA E0                MOVX     A,@DPTR
004FBB FF                MOV      R7,A
004FBC 8FE3              MOV      RFFREQ3,R7
004FBE 22                RET      
----- FUNCTION __set_fcw (END) -------


----- FUNCTION stop_phy_timer (BEGIN) -----
004FBF 75FF03            MOV      SFRPAGE,#03H
004FC2 E4                CLR      A
004FC3 F591              MOV      PHYTCON1,A
004FC5 22                RET      
----- FUNCTION stop_phy_timer (END) -------


----- FUNCTION ?L?COM04FF (BEGIN) -----
004FC6 F124              ACALL    wait_phy_timer_timeout
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 80


004FC8 75FF01            MOV      SFRPAGE,#01H
004FCB 22                RET      
----- FUNCTION ?L?COM04FF (END) -------


----- FUNCTION ?L?COM02C4 (BEGIN) -----
004FCC E0                MOVX     A,@DPTR
004FCD F8                MOV      R0,A
004FCE A3                INC      DPTR
004FCF         ?L?COM02C5:
004FCF E0                MOVX     A,@DPTR
004FD0 F9                MOV      R1,A
004FD1 A3                INC      DPTR
004FD2 E0                MOVX     A,@DPTR
004FD3 FA                MOV      R2,A
004FD4 A3                INC      DPTR
004FD5 E0                MOVX     A,@DPTR
004FD6 22                RET      
----- FUNCTION ?L?COM02C4 (END) -------


----- FUNCTION ?L?COM05E2 (BEGIN) -----
004FD7 FC                MOV      R4,A
004FD8 E4                CLR      A
004FD9 FB                MOV      R3,A
004FDA 7A04              MOV      R2,#04H
004FDC F9                MOV      R1,A
004FDD F8                MOV      R0,A
004FDE 22                RET      
----- FUNCTION ?L?COM05E2 (END) -------


----- FUNCTION ?L?COM0637 (BEGIN) -----
004FDF E0                MOVX     A,@DPTR
004FE0 F595              MOV      DMCHAN,A
004FE2 E5F4              MOV      A,DMCTRL
004FE4 5407              ANL      A,#07H
004FE6 22                RET      
----- FUNCTION ?L?COM0637 (END) -------


----- FUNCTION ?L?COM0570 (BEGIN) -----
004FE7 75FF01            MOV      SFRPAGE,#01H
004FEA 43D810            ORL      DFCON2,#010H
004FED 22                RET      
----- FUNCTION ?L?COM0570 (END) -------


----- FUNCTION ?L?COM0481 (BEGIN) -----
004FEE E0                MOVX     A,@DPTR
004FEF         ?L?COM0482:
004FEF 33                RLC      A
004FF0 33                RLC      A
004FF1 33                RLC      A
004FF2 54F8              ANL      A,#0F8H
004FF4 F5F4              MOV      DMCTRL,A
004FF6 22                RET      
----- FUNCTION ?L?COM0481 (END) -------


----- FUNCTION ?L?COM0495 (BEGIN) -----
004FF7 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_UpdateStatusSuccess
004FF9 7F71              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_UpdateStatusSuccess
004FFB 7B01              MOV      R3,#01H
004FFD 7D0A              MOV      R5,#0AH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 81


----- FUNCTION _TimerStart (BEGIN) -----
;---- Variable 'func' assigned to Register 'R6/R7' ----
;---- Variable 'brepeats' assigned to Register 'R3' ----
;---- Variable 'btimerTicks' assigned to Register 'R5' ----
004FFF 904010            MOV      DPTR,#?_TimerStart_?BYTE+04H
005002 7403              MOV      A,#03H
005004 F0                MOVX     @DPTR,A
005005 0245D8            LJMP     _TimerStart_
----- FUNCTION _TimerStart (END) -------


----- FUNCTION _InterruptDriverInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\INTERRUPT_DRIVER.C'
  249: InterruptDriverInit(ZW_EXT_INT_NAME_T id, VOID_CALLBACKFUNC(pEdgeCallbackLocal)(BYTE))
  250: {
005008 904334            MOV      DPTR,#pEdgeCallbackLocal
00500B EC                MOV      A,R4
00500C F0                MOVX     @DPTR,A
00500D A3                INC      DPTR
00500E ED                MOV      A,R5
00500F F0                MOVX     @DPTR,A
005010 904333            MOV      DPTR,#id
005013 EF                MOV      A,R7
005014 F0                MOVX     @DPTR,A
  251:   static BOOL fInitialized = FALSE;
  252:   gpio_SetPinIn(ext_interrupts[id].pin, TRUE);
005015 314C              ACALL    ?L?COM03E2
005017 FF                MOV      R7,A
005018 D240              SETB     ?_gpio_SetPinIn?BIT
00501A 121E3F            LCALL    ?INTERBANK_TABLE?_gpio_SetPinIn
  253:   ZW_SetExtIntLevel(id, FALSE);
00501D 904333            MOV      DPTR,#id
005020 E0                MOVX     A,@DPTR
005021 FF                MOV      R7,A
005022 E4                CLR      A
005023 FD                MOV      R5,A
005024 1154              ACALL    _ZW_SetExtIntLevel
  254:   enable_interrupt(id);
005026 904333            MOV      DPTR,#id
005029 E0                MOVX     A,@DPTR
00502A FF                MOV      R7,A
00502B 313F              ACALL    _enable_interrupt
  255: 
  256:   ext_interrupts[id].pEdgeCallback = pEdgeCallbackLocal;
00502D 124BB1            LCALL    ?L?COM003C
005030 904333            MOV      DPTR,#id
005033 E0                MOVX     A,@DPTR
005034 11BF              ACALL    ?L?COM036A
005036 F583              MOV      DPH,A
005038 EE                MOV      A,R6
005039 F0                MOVX     @DPTR,A
00503A A3                INC      DPTR
00503B EF                MOV      A,R7
00503C F0                MOVX     @DPTR,A
  257: 
  258:   /*
  259:    * We don't want any functions to be called inside the ISR. Hence we start
  260:    * a timer which runs forever.
  261:    */
  262:   if (FALSE == fInitialized)
00503D 205412            JB       fInitialized,?C0023?INTERRUPT_DRIVER
  263:   {
  264:     fInitialized = TRUE;
005040 D254              SETB     fInitialized
  265:     if (-1 == TimerStart(ZCB_InterruptCallback, (INTERRUPT_CALLBACK_PERIOD/10), (-1)))
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 82


005042 7E50              MOV      R6,#HIGH ZCB_InterruptCallback
005044 7FCB              MOV      R7,#LOW ZCB_InterruptCallback
005046 7BFF              MOV      R3,#0FFH
005048 7D01              MOV      R5,#01H
00504A 124FFF            LCALL    _TimerStart
00504D BFFF02            CJNE     R7,#0FFH,?C0023?INTERRUPT_DRIVER
  266:     {
  267:       return FALSE;
005050 C3                CLR      C
005051 22                RET      
  268:     }
  269:   }
005052         ?C0023?INTERRUPT_DRIVER:
  270: 
  271:   return TRUE;
005052 D3                SETB     C
  272: }
005053 22                RET      
----- FUNCTION _InterruptDriverInit (END) -------


----- FUNCTION _ZW_SetExtIntLevel (BEGIN) -----
;---- Variable 'triggerLevel' assigned to Register 'R5' ----
;---- Variable 'intSrc' assigned to Register 'R7' ----
005054 216E              AJMP     _ZW_INT_ext_level_set
----- FUNCTION _ZW_SetExtIntLevel (END) -------


----- FUNCTION _DetectEdge (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\INTERRUPT_DRIVER.C'
  139: DetectEdge(ZW_EXT_INT_NAME_T id, BYTE * pDetectedEdge)
  140: {
005056 9041EB            MOV      DPTR,#pDetectedEdge
005059 1225A9            LCALL    ?C?PSTXDATA
00505C 9041EA            MOV      DPTR,#id
00505F EF                MOV      A,R7
005060 F0                MOVX     @DPTR,A
  141:   BYTE fPinState;
  142:   BOOL fStatus = FALSE;
005061 C253              CLR      fStatus
  143: 
  144:   if (TRUE != gpio_GetPinBool(ext_interrupts[id].pin, &fPinState))
005063 314C              ACALL    ?L?COM03E2
005065 FF                MOV      R7,A
005066 7B01              MOV      R3,#01H
005068 7A41              MOV      R2,#HIGH fPinState
00506A 79EE              MOV      R1,#LOW fPinState
00506C 121E3A            LCALL    ?INTERBANK_TABLE?_gpio_GetPinBool
00506F 4003              JC       ?C0007?INTERRUPT_DRIVER
  145:   {
  146:     return fStatus;
005071 A253              MOV      C,fStatus
005073 22                RET      
  147:   }
005074         ?C0007?INTERRUPT_DRIVER:
  148: 
  149:   if (ext_interrupts[id].fLevel == (fPinState))
005074 11AC              ACALL    ?L?COM0151
005076 E0                MOVX     A,@DPTR
005077 FE                MOV      R6,A
005078 9041EE            MOV      DPTR,#fPinState
00507B E0                MOVX     A,@DPTR
00507C FD                MOV      R5,A
00507D EE                MOV      A,R6
00507E 6D                XRL      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 83


00507F 7028              JNZ      ?C0009?INTERRUPT_DRIVER
  150:   {
  151:     // The pin is matching expected level => Pin has changed.
  152:     *pDetectedEdge = ext_interrupts[id].fLevel;
005081 EF                MOV      A,R7
005082 11B1              ACALL    ?L?COM0152
005084 E0                MOVX     A,@DPTR
005085 FF                MOV      R7,A
005086 9041EB            MOV      DPTR,#pDetectedEdge
005089 123F95            LCALL    ?L?COM00C0
  153: 
  154:     // Swap the level.
  155:     if (FALSE == ext_interrupts[id].fLevel)
00508C 11AC              ACALL    ?L?COM0151
00508E E0                MOVX     A,@DPTR
00508F 7008              JNZ      ?C0010?INTERRUPT_DRIVER
  156:     {
  157:       // Set expected value
  158:       ext_interrupts[id].fLevel = TRUE;
005091 EF                MOV      A,R7
005092 11B1              ACALL    ?L?COM0152
005094 7401              MOV      A,#01H
005096 F0                MOVX     @DPTR,A
  159:       ZW_DEBUG_INTERRUPT_SEND_BYTE('D');
  160:     }
005097 8008              SJMP     ?C0011?INTERRUPT_DRIVER
005099         ?C0010?INTERRUPT_DRIVER:
  161:     else
  162:     {
  163:       // Set expected value
  164:       ext_interrupts[id].fLevel = FALSE;
005099 9041EA            MOV      DPTR,#id
00509C E0                MOVX     A,@DPTR
00509D 11B1              ACALL    ?L?COM0152
00509F E4                CLR      A
0050A0 F0                MOVX     @DPTR,A
  165:       ZW_DEBUG_INTERRUPT_SEND_BYTE('U');
  166:     }
0050A1         ?C0011?INTERRUPT_DRIVER:
  167: 
  168:     //ext_interrupts[id].fLevel = !(ext_interrupts[id].fLevel);
  169: 
  170:     ZW_SetExtIntLevel(id, ext_interrupts[id].fLevel);
0050A1 11AC              ACALL    ?L?COM0151
0050A3 E0                MOVX     A,@DPTR
0050A4 FD                MOV      R5,A
0050A5 1154              ACALL    _ZW_SetExtIntLevel
  171: 
  172:     fStatus = TRUE;
0050A7 D253              SETB     fStatus
  173:   }
0050A9         ?C0009?INTERRUPT_DRIVER:
  174:   return fStatus;
0050A9 A253              MOV      C,fStatus
  175: }
0050AB 22                RET      
----- FUNCTION _DetectEdge (END) -------


----- FUNCTION ?L?COM0151 (BEGIN) -----
0050AC 9041EA            MOV      DPTR,#id
0050AF E0                MOVX     A,@DPTR
0050B0 FF                MOV      R7,A
0050B1         ?L?COM0152:
0050B1 75F006            MOV      B,#06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 84


0050B4 A4                MUL      AB
0050B5 24A9              ADD      A,#LOW ext_interrupts+05H
0050B7 F582              MOV      DPL,A
0050B9 E4                CLR      A
0050BA 343D              ADDC     A,#HIGH ext_interrupts+05H
0050BC F583              MOV      DPH,A
0050BE 22                RET      
----- FUNCTION ?L?COM0151 (END) -------


----- FUNCTION ?L?COM036A (BEGIN) -----
0050BF 75F006            MOV      B,#06H
0050C2 A4                MUL      AB
0050C3 24A7              ADD      A,#LOW ext_interrupts+03H
0050C5 F582              MOV      DPL,A
0050C7 E4                CLR      A
0050C8 343D              ADDC     A,#HIGH ext_interrupts+03H
0050CA 22                RET      
----- FUNCTION ?L?COM036A (END) -------


----- FUNCTION ZCB_InterruptCallback (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\INTERRUPT_DRIVER.C'
  107: PCB(ZCB_InterruptCallback)(void)
  108: {
  109:   BYTE int_count;
  110: 
  111:   /*
  112:    * This loop assumes that external interrupt pins are numbered from 0 to N-1
  113:    * where N equals the max number of interrupts defined by
  114:    * ZW_NUMBER_OF_EXT_INT.
  115:    */
  116:   for (int_count = 0; int_count < ZW_NUMBER_OF_EXT_INT; int_count++)
0050CB E4                CLR      A
0050CC 904372            MOV      DPTR,#int_count
0050CF F0                MOVX     @DPTR,A
0050D0         ?C0001?INTERRUPT_DRIVER:
0050D0 904372            MOV      DPTR,#int_count
0050D3 E0                MOVX     A,@DPTR
0050D4 FF                MOV      R7,A
0050D5 C3                CLR      C
0050D6 9402              SUBB     A,#02H
0050D8 5056              JNC      ?C0006?INTERRUPT_DRIVER
  117:   {
  118:     if (TRUE == ext_interrupts[int_count].fTrigger)
0050DA EF                MOV      A,R7
0050DB 3131              ACALL    ?L?COM0423
0050DD E0                MOVX     A,@DPTR
0050DE 6401              XRL      A,#01H
0050E0 7046              JNZ      ?C0003?INTERRUPT_DRIVER
  119:     {
  120:       BYTE detectedEdge;
  121:       ext_interrupts[int_count].fTrigger = FALSE;
0050E2 904372            MOV      DPTR,#int_count
0050E5 E0                MOVX     A,@DPTR
0050E6 3131              ACALL    ?L?COM0423
0050E8 E4                CLR      A
0050E9 F0                MOVX     @DPTR,A
  122:       if ((TRUE == DetectEdge(int_count, &detectedEdge)) && (NULL != ext_interrupts[int_count].pEdgeCallback))
0050EA 7B01              MOV      R3,#01H
0050EC 7A43              MOV      R2,#HIGH detectedEdge
0050EE 7973              MOV      R1,#LOW detectedEdge
0050F0 1156              ACALL    _DetectEdge
0050F2 501D              JNC      ?C0005?INTERRUPT_DRIVER
0050F4 904372            MOV      DPTR,#int_count
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 85


0050F7 E0                MOVX     A,@DPTR
0050F8 FE                MOV      R6,A
0050F9 11BF              ACALL    ?L?COM036A
0050FB F583              MOV      DPH,A
0050FD E0                MOVX     A,@DPTR
0050FE FC                MOV      R4,A
0050FF A3                INC      DPTR
005100 E0                MOVX     A,@DPTR
005101 4C                ORL      A,R4
005102 600D              JZ       ?C0005?INTERRUPT_DRIVER
  123:       {
  124:         (ext_interrupts[int_count].pEdgeCallback)(detectedEdge);
005104 904373            MOV      DPTR,#detectedEdge
005107 E0                MOVX     A,@DPTR
005108 FF                MOV      R7,A
005109 EE                MOV      A,R6
00510A 11BF              ACALL    ?L?COM036A
00510C 315B              ACALL    ?L?COM0153
00510E 12271A            LCALL    ?C?ICALL2
  125:       }
005111         ?C0005?INTERRUPT_DRIVER:
  126:       ext_interrupts[int_count].fIgnoreInterrupt = TRUE;
005111 904372            MOV      DPTR,#int_count
005114 E0                MOVX     A,@DPTR
005115 FF                MOV      R7,A
005116 75F006            MOV      B,#06H
005119 A4                MUL      AB
00511A 24A6              ADD      A,#LOW ext_interrupts+02H
00511C F582              MOV      DPL,A
00511E E4                CLR      A
00511F 343D              ADDC     A,#HIGH ext_interrupts+02H
005121 F583              MOV      DPH,A
005123 7401              MOV      A,#01H
005125 F0                MOVX     @DPTR,A
  127:       enable_interrupt(int_count);
005126 313F              ACALL    _enable_interrupt
  128:     }
  129:   }
005128         ?C0003?INTERRUPT_DRIVER:
005128 904372            MOV      DPTR,#int_count
00512B E0                MOVX     A,@DPTR
00512C 04                INC      A
00512D F0                MOVX     @DPTR,A
00512E 80A0              SJMP     ?C0001?INTERRUPT_DRIVER
  130: }
005130         ?C0006?INTERRUPT_DRIVER:
005130 22                RET      
----- FUNCTION ZCB_InterruptCallback (END) -------


----- FUNCTION ?L?COM0423 (BEGIN) -----
005131 75F006            MOV      B,#06H
005134 A4                MUL      AB
005135 24A5              ADD      A,#LOW ext_interrupts+01H
005137 F582              MOV      DPL,A
005139 E4                CLR      A
00513A 343D              ADDC     A,#HIGH ext_interrupts+01H
00513C F583              MOV      DPH,A
00513E 22                RET      
----- FUNCTION ?L?COM0423 (END) -------


----- FUNCTION _enable_interrupt (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\INTERRUPT_DRIVER.C'
  226: enable_interrupt(ZW_EXT_INT_NAME_T id)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 86


  227: {
;---- Variable 'id' assigned to Register 'R7' ----
  228:   switch (id)
  229:   {
00513F EF                MOV      A,R7
005140 14                DEC      A
005141 6006              JZ       ?C0020?INTERRUPT_DRIVER
005143 04                INC      A
005144 7005              JNZ      ?C0022?INTERRUPT_DRIVER
  230:     case ZW_EXT_INT0:
  231:       ENABLE_INTERRUPT_(0);
005146         ?C0019?INTERRUPT_DRIVER:
  232:       break;
005146 D2A8              SETB     EX0
  233: 
005148 22                RET      
  234:     case ZW_EXT_INT1:
005149         ?C0020?INTERRUPT_DRIVER:
  235:       ENABLE_INTERRUPT_(1);
005149 D2AA              SETB     EX1
  236:       break;
  237: 
  238:     default:
  239:       // Do nothing.
  240:       break;
  241:   }
  242: }
00514B         ?C0022?INTERRUPT_DRIVER:
00514B 22                RET      
----- FUNCTION _enable_interrupt (END) -------


----- FUNCTION ?L?COM03E2 (BEGIN) -----
00514C 75F006            MOV      B,#06H
00514F A4                MUL      AB
005150 24A4              ADD      A,#LOW ext_interrupts
005152 F582              MOV      DPL,A
005154 E4                CLR      A
005155 343D              ADDC     A,#HIGH ext_interrupts
005157 F583              MOV      DPH,A
005159 E0                MOVX     A,@DPTR
00515A 22                RET      
----- FUNCTION ?L?COM03E2 (END) -------


----- FUNCTION ?L?COM0153 (BEGIN) -----
00515B F583              MOV      DPH,A
00515D         ?L?COM0154:
00515D E0                MOVX     A,@DPTR
00515E FC                MOV      R4,A
00515F         ?L?COM0155:
00515F A3                INC      DPTR
005160 E0                MOVX     A,@DPTR
005161 FD                MOV      R5,A
005162 F582              MOV      DPL,A
005164 8C83              MOV      DPH,R4
005166 22                RET      
----- FUNCTION ?L?COM0153 (END) -------


----- FUNCTION ?L?COM04E4 (BEGIN) -----
005167 901249            MOV      DPTR,#extInt1TrigLvl
00516A E0                MOVX     A,@DPTR
00516B FD                MOV      R5,A
00516C 7F01              MOV      R7,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 87


----- FUNCTION _ZW_INT_ext_level_set (BEGIN) -----
;---- Variable 'triggerLevel' assigned to Register 'R5' ----
;---- Variable 'intSrc' assigned to Register 'R7' ----
00516E EF                MOV      A,R7
00516F 7011              JNZ      ?C0002?ZW_PHY_050X
005171 ED                MOV      A,R5
005172 6007              JZ       ?C0003?ZW_PHY_050X
005174 75FF01            MOV      SFRPAGE,#01H
005177 43AE01            ORL      INTCON,#01H
00517A 22                RET      
00517B         ?C0003?ZW_PHY_050X:
00517B 75FF01            MOV      SFRPAGE,#01H
00517E 53AEFE            ANL      INTCON,#0FEH
005181 22                RET      
005182         ?C0002?ZW_PHY_050X:
005182 EF                MOV      A,R7
005183 B40114            CJNE     A,#01H,?C0009?ZW_PHY_050X
005186 901249            MOV      DPTR,#extInt1TrigLvl
005189 ED                MOV      A,R5
00518A F0                MOVX     @DPTR,A
00518B 6007              JZ       ?C0007?ZW_PHY_050X
00518D 75FF01            MOV      SFRPAGE,#01H
005190 43AE02            ORL      INTCON,#02H
005193 22                RET      
005194         ?C0007?ZW_PHY_050X:
005194 75FF01            MOV      SFRPAGE,#01H
005197 53AEFD            ANL      INTCON,#0FDH
00519A         ?C0009?ZW_PHY_050X:
00519A 22                RET      
----- FUNCTION _ZW_INT_ext_level_set (END) -------


----- FUNCTION _ZW_TimerLongGetTimeLeft (BEGIN) -----
;---- Variable 'bTimerHandle' assigned to Register 'R7' ----
00519B 1F                DEC      R7
00519C EF                MOV      A,R7
00519D C3                CLR      C
00519E 940E              SUBB     A,#0EH
0051A0 5009              JNC      ?C0039?ZW_TIMER
0051A2 EF                MOV      A,R7
0051A3 124556            LCALL    ?L?COM00D0
0051A6 122499            LCALL    ?C?LLDXDATA
0051A9 8005              SJMP     ?C0040?ZW_TIMER
0051AB         ?C0039?ZW_TIMER:
0051AB E4                CLR      A
0051AC FF                MOV      R7,A
0051AD FE                MOV      R6,A
0051AE FD                MOV      R5,A
0051AF FC                MOV      R4,A
0051B0         ?C0040?ZW_TIMER:
0051B0 22                RET      
----- FUNCTION _ZW_TimerLongGetTimeLeft (END) -------


----- FUNCTION _TimerOptionCount (BEGIN) -----
;---- Variable 'bTimerOptionMask' assigned to Register 'R5' ----
;---- Variable 'bstartElem' assigned to Register 'R7' ----
;---- Variable 'bCount' assigned to Register 'R6' ----
0051B1 E4                CLR      A
0051B2 FE                MOV      R6,A
;---- Variable 'i' assigned to Register 'R7' ----
0051B3         ?C0042?ZW_TIMER:
0051B3 EF                MOV      A,R7
0051B4 C3                CLR      C
0051B5 940E              SUBB     A,#0EH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 88


0051B7 5013              JNC      ?C0043?ZW_TIMER
0051B9 EF                MOV      A,R7
0051BA 12448D            LCALL    ?L?COM014C
0051BD E0                MOVX     A,@DPTR
0051BE 5D                ANL      A,R5
0051BF 7C00              MOV      R4,#00H
0051C1 B50502            CJNE     A,AR5,?C0045?ZW_TIMER
0051C4 7C01              MOV      R4,#01H
0051C6         ?C0045?ZW_TIMER:
0051C6         ?C0046?ZW_TIMER:
0051C6 EC                MOV      A,R4
0051C7 2E                ADD      A,R6
0051C8 FE                MOV      R6,A
0051C9 0F                INC      R7
0051CA 80E7              SJMP     ?C0042?ZW_TIMER
0051CC         ?C0043?ZW_TIMER:
0051CC AF06              MOV      R7,AR6
0051CE 22                RET      
----- FUNCTION _TimerOptionCount (END) -------


----- FUNCTION TimerGetActiveSys (BEGIN) -----
0051CF 7D02              MOV      R5,#02H
0051D1 E4                CLR      A
0051D2 FF                MOV      R7,A
0051D3 80DC              SJMP     _TimerOptionCount
----- FUNCTION TimerGetActiveSys (END) -------


----- FUNCTION TimerGetActive (BEGIN) -----
0051D5 7D01              MOV      R5,#01H
0051D7 7F03              MOV      R7,#03H
0051D9 31B1              ACALL    _TimerOptionCount
0051DB AB07              MOV      R3,AR7
0051DD 31CF              ACALL    TimerGetActiveSys
0051DF EF                MOV      A,R7
0051E0 2B                ADD      A,R3
0051E1 FF                MOV      R7,A
0051E2 22                RET      
----- FUNCTION TimerGetActive (END) -------


----- FUNCTION ZW_TimerGetFree (BEGIN) -----
0051E3 E4                CLR      A
0051E4 FD                MOV      R5,A
0051E5 7F03              MOV      R7,#03H
0051E7 80C8              SJMP     _TimerOptionCount
----- FUNCTION ZW_TimerGetFree (END) -------


----- FUNCTION getTickTime (BEGIN) -----
0051E9 A2AD              MOV      C,EMULTI
0051EB 9225              MOV      EMULTItmp,C
0051ED C2AD              CLR      EMULTI
;---- Variable 'tickTimeTmp' assigned to Register 'R6/R7' ----
0051EF AF71              MOV      R7,tickTime+01H
0051F1 AE70              MOV      R6,tickTime
0051F3 A225              MOV      C,EMULTItmp
0051F5 92AD              MOV      EMULTI,C
0051F7 22                RET      
----- FUNCTION getTickTime (END) -------


----- FUNCTION _getTickTimePassed (BEGIN) -----
;---- Variable 'wStartTickTime' assigned to Register 'R4/R5' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 89


0051F8 AD07              MOV      R5,AR7
0051FA AC06              MOV      R4,AR6
0051FC 31E9              ACALL    getTickTime
;---- Variable 'wTick' assigned to Register 'R6/R7' ----
0051FE C3                CLR      C
0051FF EF                MOV      A,R7
005200 9D                SUBB     A,R5
005201 EE                MOV      A,R6
005202 9C                SUBB     A,R4
005203 4008              JC       ?C0052?ZW_TIMER
005205 EF                MOV      A,R7
005206 9D                SUBB     A,R5
005207 FF                MOV      R7,A
005208 EE                MOV      A,R6
005209 9C                SUBB     A,R4
00520A FE                MOV      R6,A
00520B 8013              SJMP     ?C0053?ZW_TIMER
00520D         ?C0052?ZW_TIMER:
00520D ED                MOV      A,R5
00520E F4                CPL      A
00520F FD                MOV      R5,A
005210 EC                MOV      A,R4
005211 F4                CPL      A
005212 FC                MOV      R4,A
005213 ED                MOV      A,R5
005214 2401              ADD      A,#01H
005216 FD                MOV      R5,A
005217 E4                CLR      A
005218 3C                ADDC     A,R4
005219 FC                MOV      R4,A
00521A ED                MOV      A,R5
00521B 2F                ADD      A,R7
00521C FF                MOV      R7,A
00521D EC                MOV      A,R4
00521E 3E                ADDC     A,R6
00521F FE                MOV      R6,A
005220         ?C0053?ZW_TIMER:
005220 22                RET      
----- FUNCTION _getTickTimePassed (END) -------


----- FUNCTION ?L?COM03D2 (BEGIN) -----
005221 9003CA            MOV      DPTR,#bSleepWaitTimeout
005224 E0                MOVX     A,@DPTR
005225 FE                MOV      R6,A
005226 A3                INC      DPTR
005227 E0                MOVX     A,@DPTR
005228 FF                MOV      R7,A
005229 31F8              ACALL    _getTickTimePassed
00522B D3                SETB     C
00522C EF                MOV      A,R7
00522D 94C8              SUBB     A,#0C8H
00522F EE                MOV      A,R6
005230 22                RET      
----- FUNCTION ?L?COM03D2 (END) -------


----- FUNCTION ?L?COM0403 (BEGIN) -----
005231 E4                CLR      A
005232 9006C1            MOV      DPTR,#bLBTTimeout
005235 F0                MOVX     @DPTR,A
005236 7B01              MOV      R3,#01H
005238 7A06              MOV      R2,#HIGH bLBTFailedTimerhandler
00523A 79D0              MOV      R1,#LOW bLBTFailedTimerhandler
----- FUNCTION _SafeTimerStop (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 90


00523C 904273            MOV      DPTR,#pbTimerHandle
00523F 1225A9            LCALL    ?C?PSTXDATA
005242 904273            MOV      DPTR,#pbTimerHandle
005245 122589            LCALL    ?C?PLDXDATA
005248 121FB3            LCALL    ?C?CLDPTR
00524B FF                MOV      R7,A
00524C 124465            LCALL    _TimerCancel
00524F 904273            MOV      DPTR,#pbTimerHandle
005252 122589            LCALL    ?C?PLDXDATA
005255 E4                CLR      A
005256 022072            LJMP     ?C?CSTPTR
----- FUNCTION _SafeTimerStop (END) -------


----- FUNCTION _RFTransmitNow (BEGIN) -----
005259 900AA7            MOV      DPTR,#pFrameToSend
00525C 1225A9            LCALL    ?C?PSTXDATA
00525F D227              SETB     bUseFrameHandler
005261 C2EB              CLR      ERF
005263 E514              MOV      A,RF_state
005265 6002              JZ       $ + 4H
005267 81C8              AJMP     ?C0107?ZW_RF_DRIVER
005269 E515              MOV      A,RF_status
00526B 30E202            JNB      ACC.2,?C0108?ZW_RF_DRIVER
00526E C3                CLR      C
00526F 22                RET      
005270         ?C0108?ZW_RF_DRIVER:
005270 B117              ACALL    ?L?COM019D
005272 24E3              ADD      A,#0E3H
005274 F9                MOV      R1,A
005275 E4                CLR      A
005276 F165              ACALL    ?L?COM01E3
005278 F190              ACALL    GenerateHomeIDHash
00527A B11F              ACALL    ?L?COM0058
00527C 12216F            LCALL    ?C?ILDPTR
00527F 5407              ANL      A,#07H
005281 FF                MOV      R7,A
005282 9006B0            MOV      DPTR,#rfTxCurrentSpeed
005285 F0                MOVX     @DPTR,A
005286 12603E            LCALL    _Speed2Channel
005289 900AAA            MOV      DPTR,#bChannel
00528C EF                MOV      A,R7
00528D F0                MOVX     @DPTR,A
00528E E515              MOV      A,RF_status
005290 20E072            JB       ACC.0,?C0110?ZW_RF_DRIVER
005293 B1FE              ACALL    RF_demodulator_enable_get
005295 4005              JC       ?C0111?ZW_RF_DRIVER
005297 7F01              MOV      R7,#01H
005299 1236A5            LCALL    _ZW_SetRFReceiveMode
00529C         ?C0111?ZW_RF_DRIVER:
00529C 900AAA            MOV      DPTR,#bChannel
00529F E0                MOVX     A,@DPTR
0052A0 FF                MOV      R7,A
0052A1 7B01              MOV      R3,#01H
0052A3 7A0A              MOV      R2,#HIGH bRSSILevel
0052A5 79AB              MOV      R1,#LOW bRSSILevel
0052A7 126346            LCALL    _RF_lbt_get_rssi
0052AA E4                CLR      A
0052AB 33                RLC      A
;---- Variable 'bRSSIStatus' assigned to Register 'R7' ----
0052AC 7004              JNZ      ?C0112?ZW_RF_DRIVER
0052AE D2EB              SETB     ERF
0052B0 81A7              AJMP     ?C0246?ZW_RF_DRIVER
0052B2         ?C0112?ZW_RF_DRIVER:
0052B2 900AAA            MOV      DPTR,#bChannel
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 91


0052B5 E0                MOVX     A,@DPTR
0052B6 246B              ADD      A,#LOW bListenRSSIThreshold
0052B8 127419            LCALL    ?L?COM062E
0052BB E0                MOVX     A,@DPTR
0052BC FF                MOV      R7,A
0052BD 900AAB            MOV      DPTR,#bRSSILevel
0052C0 E0                MOVX     A,@DPTR
0052C1 D3                SETB     C
0052C2 9F                SUBB     A,R7
0052C3 4040              JC       ?C0110?ZW_RF_DRIVER
0052C5 D2EB              SETB     ERF
0052C7 126096            LCALL    NS_IncLBTBackOffs
0052CA A212              MOV      C,fEUSB
0052CC 92ED              MOV      EUSB,C
0052CE 9006C1            MOV      DPTR,#bLBTTimeout
0052D1 E0                MOVX     A,@DPTR
0052D2 6014              JZ       ?C0114?ZW_RF_DRIVER
0052D4 B117              ACALL    ?L?COM019D
0052D6 24E3              ADD      A,#0E3H
0052D8 F9                MOV      R1,A
0052D9 E4                CLR      A
0052DA 3A                ADDC     A,R2
0052DB FA                MOV      R2,A
0052DC 7401              MOV      A,#01H
0052DE 122072            LCALL    ?C?CSTPTR
0052E1 431504            ORL      RF_status,#04H
0052E4 5131              ACALL    ?L?COM0403
0052E6 D3                SETB     C
0052E7 22                RET      
0052E8         ?C0114?ZW_RF_DRIVER:
0052E8 9006D0            MOV      DPTR,#bLBTFailedTimerhandler
0052EB E0                MOVX     A,@DPTR
0052EC 7015              JNZ      ?C0115?ZW_RF_DRIVER
0052EE 7B01              MOV      R3,#01H
0052F0 7A06              MOV      R2,#HIGH bLBTFailedTimerhandler
0052F2 79D0              MOV      R1,#LOW bLBTFailedTimerhandler
0052F4 7C57              MOV      R4,#HIGH RFLBtTimeoutFunction
0052F6 7DED              MOV      R5,#LOW RFLBtTimeoutFunction
0052F8 904018            MOV      DPTR,#?_SafeTimerSysStart?BYTE+05H
0052FB 7464              MOV      A,#064H
0052FD F0                MOVX     @DPTR,A
0052FE E4                CLR      A
0052FF A3                INC      DPTR
005300 F0                MOVX     @DPTR,A
005301 F1B6              ACALL    _SafeTimerSysStart
005303         ?C0115?ZW_RF_DRIVER:
005303 C3                CLR      C
005304 22                RET      
005305         ?C0110?ZW_RF_DRIVER:
005305 B1FE              ACALL    RF_demodulator_enable_get
005307 5005              JNC      ?C0116?ZW_RF_DRIVER
005309 C233              CLR      ?RF_demodulator_enable?BIT
00530B 12373A            LCALL    RF_demodulator_enable
00530E         ?C0116?ZW_RF_DRIVER:
00530E 125F53            LCALL    ?L?COM02F2
005311         ?C0117?ZW_RF_DRIVER:
005311 E5D1              MOV      A,FHCON1
005313 20E0FB            JB       ACC.0,?C0117?ZW_RF_DRIVER
005316         ?C0118?ZW_RF_DRIVER:
005316 E4                CLR      A
005317 F510              MOV      demodState,A
005319 C213              CLR      RF_WakeupReceived
00531B B11F              ACALL    ?L?COM0058
00531D 12216F            LCALL    ?C?ILDPTR
005320 5407              ANL      A,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 92


005322 C3                CLR      C
005323 9403              SUBB     A,#03H
005325 E4                CLR      A
005326 9400              SUBB     A,#00H
005328 5030              JNC      ?C0119?ZW_RF_DRIVER
00532A B117              ACALL    ?L?COM019D
00532C 24B1              ADD      A,#0B1H
00532E B110              ACALL    ?L?COM000B
005330 FF                MOV      R7,A
005331 B117              ACALL    ?L?COM019D
005333 24D8              ADD      A,#0D8H
005335 B110              ACALL    ?L?COM000B
005337 2F                ADD      A,R7
005338 FF                MOV      R7,A
005339 E4                CLR      A
00533A 33                RLC      A
00533B FE                MOV      R6,A
00533C D3                SETB     C
00533D EF                MOV      A,R7
00533E 9440              SUBB     A,#040H
005340 EE                MOV      A,R6
005341 6480              XRL      A,#080H
005343 9480              SUBB     A,#080H
005345 4013              JC       ?C0119?ZW_RF_DRIVER
005347 B117              ACALL    ?L?COM019D
005349 24E3              ADD      A,#0E3H
00534B 127344            LCALL    ?L?COM04EF
00534E 122072            LCALL    ?C?CSTPTR
005351 431504            ORL      RF_status,#04H
005354 A212              MOV      C,fEUSB
005356 92ED              MOV      EUSB,C
005358 D3                SETB     C
005359 22                RET      
00535A         ?C0119?ZW_RF_DRIVER:
00535A B117              ACALL    ?L?COM019D
00535C 2408              ADD      A,#08H
00535E F9                MOV      R1,A
00535F E4                CLR      A
005360 3A                ADDC     A,R2
005361 CF                XCH      A,R7
005362 E9                MOV      A,R1
005363 CF                XCH      A,R7
005364 F511              MOV      RF_data_addr,A
005366 8F12              MOV      RF_data_addr+01H,R7
005368 B117              ACALL    ?L?COM019D
00536A 24B1              ADD      A,#0B1H
00536C B110              ACALL    ?L?COM000B
00536E F516              MOV      RF_data_count,A
005370 AE11              MOV      R6,RF_data_addr
005372 126E3C            LCALL    _ZW_FH_buf1addr_set
005375 B117              ACALL    ?L?COM019D
005377 24B2              ADD      A,#0B2H
005379 F9                MOV      R1,A
00537A E4                CLR      A
00537B 3A                ADDC     A,R2
00537C 8B1C              MOV      RF_header_addr,R3
00537E F51D              MOV      RF_header_addr+01H,A
005380 891E              MOV      RF_header_addr+02H,R1
005382 B117              ACALL    ?L?COM019D
005384 24D8              ADD      A,#0D8H
005386 B110              ACALL    ?L?COM000B
005388 F51F              MOV      RF_header_count,A
00538A B11F              ACALL    ?L?COM0058
00538C 12216F            LCALL    ?C?ILDPTR
00538F FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 93


005390 ACF0              MOV      R4,B
005392 5460              ANL      A,#060H
005394 602C              JZ       ?C0121?ZW_RF_DRIVER
005396 B117              ACALL    ?L?COM019D
005398 24D9              ADD      A,#0D9H
00539A B110              ACALL    ?L?COM000B
00539C FF                MOV      R7,A
00539D 126070            LCALL    _RFSetupBeamFragmentTX
0053A0 C227              CLR      bUseFrameHandler
0053A2 B100              ACALL    ?L?COM0009
0053A4 FB                MOV      R3,A
0053A5 7A00              MOV      R2,#00H
0053A7 9006D1            MOV      DPTR,#RF_BeamCount
0053AA 7D18              MOV      R5,#018H
0053AC 1270D9            LCALL    ?L?COM01A7
0053AF EF                MOV      A,R7
0053B0 2B                ADD      A,R3
0053B1 FF                MOV      R7,A
0053B2 EA                MOV      A,R2
0053B3 3E                ADDC     A,R6
0053B4 FE                MOV      R6,A
0053B5 EF                MOV      A,R7
0053B6 2414              ADD      A,#014H
0053B8 FB                MOV      R3,A
0053B9 E4                CLR      A
0053BA 3E                ADDC     A,R6
0053BB FA                MOV      R2,A
0053BC 7D02              MOV      R5,#02H
0053BE 7F01              MOV      R7,#01H
0053C0 8197              AJMP     ?C0248?ZW_RF_DRIVER
0053C2         ?C0121?ZW_RF_DRIVER:
0053C2 B11F              ACALL    ?L?COM0058
0053C4 12216F            LCALL    ?C?ILDPTR
0053C7 5407              ANL      A,#07H
0053C9 9006B0            MOV      DPTR,#rfTxCurrentSpeed
0053CC F0                MOVX     @DPTR,A
0053CD 751408            MOV      RF_state,#08H
0053D0 B117              ACALL    ?L?COM019D
0053D2 24B2              ADD      A,#0B2H
0053D4 F9                MOV      R1,A
0053D5 E4                CLR      A
0053D6 3A                ADDC     A,R2
0053D7 FA                MOV      R2,A
0053D8 126E30            LCALL    _ZW_FH_buf0addr_set
0053DB B117              ACALL    ?L?COM019D
0053DD 24D8              ADD      A,#0D8H
0053DF B110              ACALL    ?L?COM000B
0053E1 FF                MOV      R7,A
0053E2 AD16              MOV      R5,RF_data_count
0053E4 126E5B            LCALL    _ZW_FH_tx_buflen_set
0053E7 9006B0            MOV      DPTR,#rfTxCurrentSpeed
0053EA E0                MOVX     A,@DPTR
0053EB 6403              XRL      A,#03H
0053ED 7024              JNZ      ?C0123?ZW_RF_DRIVER
0053EF 7B01              MOV      R3,#01H
0053F1 FD                MOV      R5,A
0053F2 91D0              ACALL    ?L?COM0007
0053F4 D3                SETB     C
0053F5 B16A              ACALL    ?L?COM016F
0053F7 5005              JNC      ?C0124?ZW_RF_DRIVER
0053F9 7401              MOV      A,#01H
0053FB 12201D            LCALL    ?C?CILDPTR
0053FE         ?C0124?ZW_RF_DRIVER:
0053FE E4                CLR      A
0053FF F5FF              MOV      SFRPAGE,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 94


005401 1273D0            LCALL    ?L?COM05C6
005404 121FB3            LCALL    ?C?CLDPTR
005407 2428              ADD      A,#028H
005409 FB                MOV      R3,A
00540A E4                CLR      A
00540B 33                RLC      A
00540C FA                MOV      R2,A
00540D 7D03              MOV      R5,#03H
00540F E4                CLR      A
005410 FF                MOV      R7,A
005411         
005411 8197              AJMP     ?C0248?ZW_RF_DRIVER
005413         ?C0123?ZW_RF_DRIVER:
005413 9006B0            MOV      DPTR,#rfTxCurrentSpeed
005416 E0                MOVX     A,@DPTR
005417 6402              XRL      A,#02H
005419 702A              JNZ      ?C0126?ZW_RF_DRIVER
00541B 91D3              ACALL    ?L?COM0008
00541D D3                SETB     C
00541E B16A              ACALL    ?L?COM016F
005420 4005              JC       ?C0127?ZW_RF_DRIVER
005422 74FF              MOV      A,#0FFH
005424 12201D            LCALL    ?C?CILDPTR
005427         ?C0127?ZW_RF_DRIVER:
005427 E4                CLR      A
005428 F5FF              MOV      SFRPAGE,A
00542A E5D2              MOV      A,FHCON2
00542C 5480              ANL      A,#080H
00542E 440A              ORL      A,#0AH
005430 F5D2              MOV      FHCON2,A
005432 121FB3            LCALL    ?C?CLDPTR
005435 2414              ADD      A,#014H
005437 FB                MOV      R3,A
005438 E4                CLR      A
005439 33                RLC      A
00543A FA                MOV      R2,A
00543B 7D02              MOV      R5,#02H
00543D 7F01              MOV      R7,#01H
00543F B173              ACALL    _UpdateTxTimer
005441 B12D              ACALL    ?L?COM0579
005443 8054              SJMP     ?C0122?ZW_RF_DRIVER
005445         ?C0126?ZW_RF_DRIVER:
005445 E4                CLR      A
005446 FB                MOV      R3,A
005447 7D01              MOV      R5,#01H
005449 91D0              ACALL    ?L?COM0007
00544B D3                SETB     C
00544C B16A              ACALL    ?L?COM016F
00544E 4005              JC       ?C0129?ZW_RF_DRIVER
005450 74FF              MOV      A,#0FFH
005452 12201D            LCALL    ?C?CILDPTR
005455         ?C0129?ZW_RF_DRIVER:
005455 E4                CLR      A
005456 F5FF              MOV      SFRPAGE,A
005458 B11F              ACALL    ?L?COM0058
00545A B1E3              ACALL    ?L?COM05DD
00545C 7F05              MOV      R7,#05H
00545E 6002              JZ       ?C0130?ZW_RF_DRIVER
005460 7F0A              MOV      R7,#0AH
005462         ?C0130?ZW_RF_DRIVER:
005462         ?C0131?ZW_RF_DRIVER:
005462 EF                MOV      A,R7
005463 547F              ANL      A,#07FH
005465 FF                MOV      R7,A
005466 E5D2              MOV      A,FHCON2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 95


005468 5480              ANL      A,#080H
00546A 4F                ORL      A,R7
00546B F5D2              MOV      FHCON2,A
00546D E4                CLR      A
00546E F5FF              MOV      SFRPAGE,A
005470 43D280            ORL      FHCON2,#080H
005473 B100              ACALL    ?L?COM0009
005475 FD                MOV      R5,A
005476 7C00              MOV      R4,#00H
005478 B11F              ACALL    ?L?COM0058
00547A B1E3              ACALL    ?L?COM05DD
00547C 7E00              MOV      R6,#00H
00547E 6004              JZ       ?C0132?ZW_RF_DRIVER
005480 7F0A              MOV      R7,#0AH
005482 8002              SJMP     ?C0133?ZW_RF_DRIVER
005484         ?C0132?ZW_RF_DRIVER:
005484 7F05              MOV      R7,#05H
005486         ?C0133?ZW_RF_DRIVER:
005486 EF                MOV      A,R7
005487 25E0              ADD      A,ACC
005489 FF                MOV      R7,A
00548A EE                MOV      A,R6
00548B 33                RLC      A
00548C FE                MOV      R6,A
00548D EF                MOV      A,R7
00548E 2D                ADD      A,R5
00548F FB                MOV      R3,A
005490 EE                MOV      A,R6
005491 3C                ADDC     A,R4
005492 FA                MOV      R2,A
005493 7D01              MOV      R5,#01H
005495 7F01              MOV      R7,#01H
005497         
005497 B173              ACALL    _UpdateTxTimer
005499         ?C0122?ZW_RF_DRIVER:
005499 B11F              ACALL    ?L?COM0058
00549B 1272B9            LCALL    ?L?COM0455
00549E A227              MOV      C,bUseFrameHandler
0054A0 9226              MOV      ?_SwitchToTX?BIT,C
0054A2 1258AC            LCALL    _SwitchToTX
0054A5 4006              JC       ?C0134?ZW_RF_DRIVER
0054A7         
0054A7 A212              MOV      C,fEUSB
0054A9 92ED              MOV      EUSB,C
0054AB C3                CLR      C
0054AC 22                RET      
0054AD         ?C0134?ZW_RF_DRIVER:
0054AD 5131              ACALL    ?L?COM0403
0054AF 900AAA            MOV      DPTR,#bChannel
0054B2 E0                MOVX     A,@DPTR
0054B3 FF                MOV      R7,A
0054B4 B117              ACALL    ?L?COM019D
0054B6 24E5              ADD      A,#0E5H
0054B8 F9                MOV      R1,A
0054B9 E4                CLR      A
0054BA 3A                ADDC     A,R2
0054BB FA                MOV      R2,A
0054BC EF                MOV      A,R7
0054BD 122072            LCALL    ?C?CSTPTR
0054C0         ?C0135?ZW_RF_DRIVER:
0054C0 A212              MOV      C,fEUSB
0054C2 92ED              MOV      EUSB,C
0054C4 D2EB              SETB     ERF
0054C6 D3                SETB     C
0054C7 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 96


0054C8         ?C0107?ZW_RF_DRIVER:
0054C8 A212              MOV      C,fEUSB
0054CA 92ED              MOV      EUSB,C
0054CC D2EB              SETB     ERF
0054CE C3                CLR      C
0054CF 22                RET      
----- FUNCTION _RFTransmitNow (END) -------


----- FUNCTION ?L?COM0007 (BEGIN) -----
0054D0 FF                MOV      R7,A
0054D1 B132              ACALL    _ZW_FH_tx_init
0054D3         ?L?COM0008:
0054D3 900AA7            MOV      DPTR,#pFrameToSend
0054D6 122589            LCALL    ?C?PLDXDATA
0054D9 E9                MOV      A,R1
0054DA 24B1              ADD      A,#0B1H
0054DC F9                MOV      R1,A
0054DD E4                CLR      A
0054DE 3A                ADDC     A,R2
0054DF FA                MOV      R2,A
0054E0 121FB3            LCALL    ?C?CLDPTR
0054E3 FF                MOV      R7,A
0054E4 900AA7            MOV      DPTR,#pFrameToSend
0054E7 122589            LCALL    ?C?PLDXDATA
0054EA E9                MOV      A,R1
0054EB 24D8              ADD      A,#0D8H
0054ED F9                MOV      R1,A
0054EE E4                CLR      A
0054EF 3A                ADDC     A,R2
0054F0 FA                MOV      R2,A
0054F1 121FB3            LCALL    ?C?CLDPTR
0054F4 2F                ADD      A,R7
0054F5 FF                MOV      R7,A
0054F6 E4                CLR      A
0054F7 33                RLC      A
0054F8 FE                MOV      R6,A
0054F9 EF                MOV      A,R7
0054FA 2401              ADD      A,#01H
0054FC FF                MOV      R7,A
0054FD E4                CLR      A
0054FE 3E                ADDC     A,R6
0054FF FE                MOV      R6,A
005500         ?L?COM0009:
005500 900AA7            MOV      DPTR,#pFrameToSend
005503 122589            LCALL    ?C?PLDXDATA
005506 E9                MOV      A,R1
005507 24B2              ADD      A,#0B2H
005509 F9                MOV      R1,A
00550A E4                CLR      A
00550B 3A                ADDC     A,R2
00550C FA                MOV      R2,A
00550D         ?L?COM000A:
00550D E9                MOV      A,R1
00550E 2407              ADD      A,#07H
005510         ?L?COM000B:
005510 F9                MOV      R1,A
005511 E4                CLR      A
005512 3A                ADDC     A,R2
005513 FA                MOV      R2,A
005514 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0007 (END) -------


----- FUNCTION ?L?COM019D (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 97


005517 900AA7            MOV      DPTR,#pFrameToSend
00551A 122589            LCALL    ?C?PLDXDATA
00551D E9                MOV      A,R1
00551E 22                RET      
----- FUNCTION ?L?COM019D (END) -------


----- FUNCTION ?L?COM0058 (BEGIN) -----
00551F 900AA7            MOV      DPTR,#pFrameToSend
005522         ?L?COM0059:
005522 122589            LCALL    ?C?PLDXDATA
005525         ?L?COM005A:
005525 E9                MOV      A,R1
005526 2404              ADD      A,#04H
005528 F9                MOV      R1,A
005529 E4                CLR      A
00552A 3A                ADDC     A,R2
00552B FA                MOV      R2,A
00552C 22                RET      
----- FUNCTION ?L?COM0058 (END) -------


----- FUNCTION ?L?COM0579 (BEGIN) -----
00552D E4                CLR      A
00552E FB                MOV      R3,A
00552F 7D01              MOV      R5,#01H
005531 FF                MOV      R7,A
----- FUNCTION _ZW_FH_tx_init (BEGIN) -----
;---- Variable 'insert_viola' assigned to Register 'R7' ----
;---- Variable 'insert_crc16' assigned to Register 'R3' ----
;---- Variable 'insert_chksum' assigned to Register 'R5' ----
005532 E4                CLR      A
005533 F5FF              MOV      SFRPAGE,A
005535 75D102            MOV      FHCON1,#02H
005538         ?C0001?ZW_PHY_FRAME_HANDLER_050X:
005538 E5D1              MOV      A,FHCON1
00553A 20E0FB            JB       ACC.0,?C0001?ZW_PHY_FRAME_HANDLER_050X
00553D         ?C0002?ZW_PHY_FRAME_HANDLER_050X:
00553D E4                CLR      A
00553E F5FF              MOV      SFRPAGE,A
005540 F5D1              MOV      FHCON1,A
005542 EF                MOV      A,R7
005543 6008              JZ       ?C0003?ZW_PHY_FRAME_HANDLER_050X
005545 E4                CLR      A
005546 F5FF              MOV      SFRPAGE,A
005548 43D280            ORL      FHCON2,#080H
00554B 8006              SJMP     ?C0004?ZW_PHY_FRAME_HANDLER_050X
00554D         ?C0003?ZW_PHY_FRAME_HANDLER_050X:
00554D E4                CLR      A
00554E F5FF              MOV      SFRPAGE,A
005550 53D27F            ANL      FHCON2,#07FH
005553         ?C0004?ZW_PHY_FRAME_HANDLER_050X:
005553 EB                MOV      A,R3
005554 6006              JZ       ?C0005?ZW_PHY_FRAME_HANDLER_050X
005556 E4                CLR      A
005557 F5FF              MOV      SFRPAGE,A
005559 43D104            ORL      FHCON1,#04H
00555C         ?C0005?ZW_PHY_FRAME_HANDLER_050X:
00555C ED                MOV      A,R5
00555D 6006              JZ       ?C0007?ZW_PHY_FRAME_HANDLER_050X
00555F E4                CLR      A
005560 F5FF              MOV      SFRPAGE,A
005562 43D108            ORL      FHCON1,#08H
005565         ?C0007?ZW_PHY_FRAME_HANDLER_050X:
005565 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 98


----- FUNCTION _ZW_FH_tx_init (END) -------


----- FUNCTION ?L?COM016D (BEGIN) -----
005566 33                RLC      A
005567 FE                MOV      R6,A
005568 E0                MOVX     A,@DPTR
005569         ?L?COM016E:
005569 C3                CLR      C
00556A         ?L?COM016F:
00556A 9F                SUBB     A,R7
00556B EE                MOV      A,R6
00556C         ?L?COM0170:
00556C 6480              XRL      A,#080H
00556E F8                MOV      R0,A
00556F 7480              MOV      A,#080H
005571 98                SUBB     A,R0
005572 22                RET      
----- FUNCTION ?L?COM016D (END) -------


----- FUNCTION _UpdateTxTimer (BEGIN) -----
005573 900ADF            MOV      DPTR,#bChannel
005576 EF                MOV      A,R7
005577 F0                MOVX     @DPTR,A
;---- Variable 'wSize' assigned to Register 'R2/R3' ----
;---- Variable 'bBaudRate' assigned to Register 'R5' ----
005578 ED                MOV      A,R5
005579 24FE              ADD      A,#0FEH
00557B 6019              JZ       ?C0232?ZW_RF_DRIVER
00557D 14                DEC      A
00557E 6026              JZ       ?C0233?ZW_RF_DRIVER
005580 2402              ADD      A,#02H
005582 703B              JNZ      ?C0230?ZW_RF_DRIVER
005584         ?C0231?ZW_RF_DRIVER:
005584 EB                MOV      A,R3
005585 2402              ADD      A,#02H
005587 FF                MOV      R7,A
005588 E4                CLR      A
005589 3A                ADDC     A,R2
00558A FE                MOV      R6,A
00558B 7C00              MOV      R4,#00H
00558D 7D50              MOV      R5,#050H
00558F 1220A6            LCALL    ?C?IMUL
005592 7D60              MOV      R5,#060H
005594 801E              SJMP     ?C0258?ZW_RF_DRIVER
005596         ?C0232?ZW_RF_DRIVER:
005596 B1EB              ACALL    ?L?COM04EC
005598         ?C0243?ZW_RF_DRIVER:
005598 C3                CLR      C
005599 33                RLC      A
00559A CE                XCH      A,R6
00559B 33                RLC      A
00559C CE                XCH      A,R6
00559D D8F9              DJNZ     R0,?C0243?ZW_RF_DRIVER
00559F FF                MOV      R7,A
0055A0 7C00              MOV      R4,#00H
0055A2 7D28              MOV      R5,#028H
0055A4         
0055A4 800E              SJMP     ?C0258?ZW_RF_DRIVER
0055A6         ?C0233?ZW_RF_DRIVER:
0055A6 B1EB              ACALL    ?L?COM04EC
0055A8         ?C0244?ZW_RF_DRIVER:
0055A8 C3                CLR      C
0055A9 33                RLC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 99


0055AA CE                XCH      A,R6
0055AB 33                RLC      A
0055AC CE                XCH      A,R6
0055AD D8F9              DJNZ     R0,?C0244?ZW_RF_DRIVER
0055AF FF                MOV      R7,A
0055B0 7C00              MOV      R4,#00H
0055B2 7D64              MOV      R5,#064H
0055B4         
0055B4 1220B8            LCALL    ?C?UIDIV
0055B7 900AE0            MOV      DPTR,#wTime
0055BA EE                MOV      A,R6
0055BB F0                MOVX     @DPTR,A
0055BC A3                INC      DPTR
0055BD EF                MOV      A,R7
0055BE F0                MOVX     @DPTR,A
0055BF         ?C0230?ZW_RF_DRIVER:
0055BF 900ADF            MOV      DPTR,#bChannel
0055C2 E0                MOVX     A,@DPTR
0055C3 1260F2            LCALL    ?L?COM0437
0055C6 C083              PUSH     DPH
0055C8 C082              PUSH     DPL
0055CA 1224B5            LCALL    ?C?LLDXDATA0
0055CD 900AE1            MOV      DPTR,#wTime+01H
0055D0 E0                MOVX     A,@DPTR
0055D1 2401              ADD      A,#01H
0055D3 900AE0            MOV      DPTR,#wTime
0055D6 1273A3            LCALL    ?L?COM059A
0055D9 12226B            LCALL    ?C?LADD
0055DC D082              POP      DPL
0055DE D083              POP      DPH
0055E0 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION _UpdateTxTimer (END) -------


----- FUNCTION ?L?COM05DD (BEGIN) -----
0055E3 12216F            LCALL    ?C?ILDPTR
0055E6 4410              ORL      A,#010H
0055E8 45F0              ORL      A,B
0055EA 22                RET      
----- FUNCTION ?L?COM05DD (END) -------


----- FUNCTION ?L?COM04EC (BEGIN) -----
0055EB EB                MOV      A,R3
0055EC 2401              ADD      A,#01H
0055EE FF                MOV      R7,A
0055EF E4                CLR      A
0055F0 3A                ADDC     A,R2
0055F1 FE                MOV      R6,A
0055F2 EF                MOV      A,R7
0055F3 7803              MOV      R0,#03H
0055F5 22                RET      
----- FUNCTION ?L?COM04EC (END) -------


----- FUNCTION ?L?COM04BD (BEGIN) -----
0055F6 C2EB              CLR      ERF
0055F8 A2ED              MOV      C,EUSB
0055FA 9212              MOV      fEUSB,C
0055FC C2ED              CLR      EUSB
----- FUNCTION RF_demodulator_enable_get (BEGIN) -----
0055FE E5F4              MOV      A,DMCTRL
005600 C3                CLR      C
005601 30E701            JNB      ACC.7,?C0209?ZW_PHY_RF_050X
005604 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 100


005605         ?C0209?ZW_PHY_RF_050X:
005605 22                RET      
----- FUNCTION RF_demodulator_enable_get (END) -------


----- FUNCTION _RF_WaitForSOForTimeout (BEGIN) -----
005606 900AF4            MOV      DPTR,#bChannel
005609 EF                MOV      A,R7
00560A F0                MOVX     @DPTR,A
00560B C234              CLR      ?RF_demodulator_enable_fast?BIT
00560D 125E33            LCALL    RF_demodulator_enable_fast
005610 D21B              SETB     ?RF_sensor_mode_enable?BIT
005612 900AF4            MOV      DPTR,#bChannel
005615 E0                MOVX     A,@DPTR
005616 904279            MOV      DPTR,#?RF_sensor_mode_enable?BYTE
005619 F0                MOVX     @DPTR,A
00561A D21C              SETB     ?RF_sensor_mode_enable?BIT+01H
00561C A3                INC      DPTR
00561D E4                CLR      A
00561E F0                MOVX     @DPTR,A
00561F A3                INC      DPTR
005620 740D              MOV      A,#0DH
005622 F0                MOVX     @DPTR,A
005623 125C61            LCALL    RF_sensor_mode_enable
005626 E4                CLR      A
005627 900AF5            MOV      DPTR,#res
00562A F0                MOVX     @DPTR,A
00562B         ?C0190?ZW_RF_DRIVER:
00562B B1FE              ACALL    RF_demodulator_enable_get
00562D 5076              JNC      ?C0191?ZW_RF_DRIVER
00562F 900AF5            MOV      DPTR,#res
005632 E0                MOVX     A,@DPTR
005633 7070              JNZ      ?C0191?ZW_RF_DRIVER
005635 E5F7              MOV      A,DMSTAT1
005637 54C0              ANL      A,#0C0H
005639 60F0              JZ       ?C0190?ZW_RF_DRIVER
00563B D1BC              ACALL    RF_byte_get
00563D D1CF              ACALL    ?L?COM0438
00563F 6455              XRL      A,#055H
005641 704E              JNZ      ?C0193?ZW_RF_DRIVER
005643 D1CF              ACALL    ?L?COM0438
005645 901221            MOV      DPTR,#nodeID
005648 E0                MOVX     A,@DPTR
005649 6F                XRL      A,R7
00564A 600E              JZ       ?C0195?ZW_RF_DRIVER
00564C 900AF5            MOV      DPTR,#res
00564F E0                MOVX     A,@DPTR
005650 F4                CPL      A
005651 7039              JNZ      ?C0194?ZW_RF_DRIVER
005653 901215            MOV      DPTR,#bFLiRSStatus
005656 E0                MOVX     A,@DPTR
005657 30E132            JNB      ACC.1,?C0194?ZW_RF_DRIVER
00565A         ?C0195?ZW_RF_DRIVER:
00565A D1CF              ACALL    ?L?COM0438
00565C 6455              XRL      A,#055H
00565E 6018              JZ       ?C0197?ZW_RF_DRIVER
005660 E0                MOVX     A,@DPTR
005661 FF                MOV      R7,A
005662 644A              XRL      A,#04AH
005664 6012              JZ       ?C0197?ZW_RF_DRIVER
005666 EF                MOV      A,R7
005667 640A              XRL      A,#0AH
005669 600D              JZ       ?C0197?ZW_RF_DRIVER
00566B 901221            MOV      DPTR,#nodeID
00566E E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 101


00566F FF                MOV      R7,A
005670 900AF5            MOV      DPTR,#res
005673 E0                MOVX     A,@DPTR
005674 FE                MOV      R6,A
005675 6F                XRL      A,R7
005676 7005              JNZ      ?C0196?ZW_RF_DRIVER
005678         ?C0197?ZW_RF_DRIVER:
005678 900AF5            MOV      DPTR,#res
00567B 800A              SJMP     ?C0253?ZW_RF_DRIVER
00567D         ?C0196?ZW_RF_DRIVER:
00567D 9006AF            MOV      DPTR,#bHomeIDHash
005680 E0                MOVX     A,@DPTR
005681 6E                XRL      A,R6
005682 900AF5            MOV      DPTR,#res
005685 7019              JNZ      ?C0255?ZW_RF_DRIVER
005687         
005687 7402              MOV      A,#02H
005689 F0                MOVX     @DPTR,A
00568A 809F              SJMP     ?C0190?ZW_RF_DRIVER
00568C         ?C0194?ZW_RF_DRIVER:
00568C 900AF5            MOV      DPTR,#res
00568F         
00568F 800F              SJMP     ?C0255?ZW_RF_DRIVER
005691         ?C0193?ZW_RF_DRIVER:
005691 900AF5            MOV      DPTR,#res
005694 E0                MOVX     A,@DPTR
005695 B45405            CJNE     A,#054H,?C0203?ZW_RF_DRIVER
005698 7433              MOV      A,#033H
00569A F0                MOVX     @DPTR,A
00569B 808E              SJMP     ?C0190?ZW_RF_DRIVER
00569D         ?C0203?ZW_RF_DRIVER:
00569D 900AF5            MOV      DPTR,#res
0056A0         
0056A0 7401              MOV      A,#01H
0056A2 F0                MOVX     @DPTR,A
0056A3 8086              SJMP     ?C0190?ZW_RF_DRIVER
0056A5         ?C0191?ZW_RF_DRIVER:
0056A5 900AF5            MOV      DPTR,#res
0056A8 E0                MOVX     A,@DPTR
0056A9 B40207            CJNE     A,#02H,?C0205?ZW_RF_DRIVER
0056AC C233              CLR      ?RF_demodulator_enable?BIT
0056AE 12373A            LCALL    RF_demodulator_enable
0056B1 8000              SJMP     ?C0252?ZW_RF_DRIVER
0056B3         ?C0205?ZW_RF_DRIVER:
0056B3         
0056B3 125C54            LCALL    ?L?COM03D1
0056B6         ?C0206?ZW_RF_DRIVER:
0056B6 900AF5            MOV      DPTR,#res
0056B9 E0                MOVX     A,@DPTR
0056BA FF                MOV      R7,A
0056BB 22                RET      
----- FUNCTION _RF_WaitForSOForTimeout (END) -------


----- FUNCTION RF_byte_get (BEGIN) -----
0056BC         ?C0260?ZW_PHY_RF_050X:
0056BC E5F7              MOV      A,DMSTAT1
0056BE 20E008            JB       ACC.0,?C0261?ZW_PHY_RF_050X
0056C1 E5F7              MOV      A,DMSTAT1
0056C3 54C0              ANL      A,#0C0H
0056C5 70F5              JNZ      ?C0260?ZW_PHY_RF_050X
0056C7 FF                MOV      R7,A
0056C8 22                RET      
0056C9         ?C0261?ZW_PHY_RF_050X:
0056C9 43F701            ORL      DMSTAT1,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 102


0056CC AFF9              MOV      R7,DMOUT
0056CE 22                RET      
----- FUNCTION RF_byte_get (END) -------


----- FUNCTION ?L?COM0438 (BEGIN) -----
0056CF D1BC              ACALL    RF_byte_get
0056D1 900AF5            MOV      DPTR,#res
0056D4 EF                MOV      A,R7
0056D5 F0                MOVX     @DPTR,A
0056D6 22                RET      
----- FUNCTION ?L?COM0438 (END) -------


----- FUNCTION _ZW_GetDefaultPowerLevels (BEGIN) -----
0056D7 900AD9            MOV      DPTR,#pPowerlevels
0056DA 1225A9            LCALL    ?C?PSTXDATA
0056DD 900AD9            MOV      DPTR,#pPowerlevels
0056E0 122589            LCALL    ?C?PLDXDATA
0056E3 E51B              MOV      A,normal_PA_POW
0056E5 F113              ACALL    ?L?COM0418
0056E7 125C41            LCALL    ?L?COM00B6
0056EA F112              ACALL    ?L?COM0417
0056EC 122589            LCALL    ?C?PLDXDATA
0056EF E9                MOV      A,R1
0056F0 2402              ADD      A,#02H
0056F2 F9                MOV      R1,A
0056F3 E4                CLR      A
0056F4 F165              ACALL    ?L?COM01E3
0056F6 900AD9            MOV      DPTR,#pPowerlevels
0056F9 12707E            LCALL    ?L?COM00F2
0056FC F9                MOV      R1,A
0056FD E4                CLR      A
0056FE 3A                ADDC     A,R2
0056FF FA                MOV      R2,A
005700 E513              MOV      A,low_PA_POW
005702 F113              ACALL    ?L?COM0418
005704 B122              ACALL    ?L?COM0059
005706 F112              ACALL    ?L?COM0417
005708 F16B              ACALL    ?L?COM0323
00570A F9                MOV      R1,A
00570B E4                CLR      A
00570C 3A                ADDC     A,R2
00570D FA                MOV      R2,A
00570E E4                CLR      A
00570F 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_GetDefaultPowerLevels (END) -------


----- FUNCTION ?L?COM0417 (BEGIN) -----
005712 E4                CLR      A
005713         ?L?COM0418:
005713 122072            LCALL    ?C?CSTPTR
005716 900AD9            MOV      DPTR,#pPowerlevels
005719 22                RET      
----- FUNCTION ?L?COM0417 (END) -------


----- FUNCTION RF_WaitForBeam (BEGIN) -----
00571A F190              ACALL    GenerateHomeIDHash
00571C 7F02              MOV      R7,#02H
00571E 121DD6            LCALL    ?INTERBANK_TABLE?_ApplicationRfNotify
005721 7F01              MOV      R7,#01H
005723 D106              ACALL    _RF_WaitForSOForTimeout
005725 900B07            MOV      DPTR,#bStatus
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 103


005728 EF                MOV      A,R7
005729 F0                MOVX     @DPTR,A
00572A BF0202            CJNE     R7,#02H,?C0208?ZW_RF_DRIVER
00572D 8013              SJMP     ?C0256?ZW_RF_DRIVER
00572F         ?C0208?ZW_RF_DRIVER:
00572F 900B07            MOV      DPTR,#bStatus
005732 E0                MOVX     A,@DPTR
005733 B43311            CJNE     A,#033H,?C0210?ZW_RF_DRIVER
005736 E4                CLR      A
005737 F0                MOVX     @DPTR,A
005738 7F01              MOV      R7,#01H
00573A D106              ACALL    _RF_WaitForSOForTimeout
00573C BF020D            CJNE     R7,#02H,?C0209?ZW_RF_DRIVER
00573F 900B07            MOV      DPTR,#bStatus
005742         
005742 7401              MOV      A,#01H
005744 F0                MOVX     @DPTR,A
005745 8005              SJMP     ?C0209?ZW_RF_DRIVER
005747         ?C0210?ZW_RF_DRIVER:
005747 E4                CLR      A
005748 900B07            MOV      DPTR,#bStatus
00574B F0                MOVX     @DPTR,A
00574C         ?C0209?ZW_RF_DRIVER:
00574C 900B07            MOV      DPTR,#bStatus
00574F E0                MOVX     A,@DPTR
005750 700C              JNZ      ?C0213?ZW_RF_DRIVER
005752 B1FE              ACALL    RF_demodulator_enable_get
005754 5005              JNC      ?C0214?ZW_RF_DRIVER
005756 C233              CLR      ?RF_demodulator_enable?BIT
005758 12373A            LCALL    RF_demodulator_enable
00575B         ?C0214?ZW_RF_DRIVER:
00575B 1237D0            LCALL    ?L?COM05C5
00575E         ?C0213?ZW_RF_DRIVER:
00575E 900B07            MOV      DPTR,#bStatus
005761 E0                MOVX     A,@DPTR
005762 24FF              ADD      A,#0FFH
005764 22                RET      
----- FUNCTION RF_WaitForBeam (END) -------


----- FUNCTION ?L?COM01E3 (BEGIN) -----
005765 3A                ADDC     A,R2
005766 FA                MOV      R2,A
005767 E4                CLR      A
005768 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM01E3 (END) -------


----- FUNCTION ?L?COM0323 (BEGIN) -----
00576B 122589            LCALL    ?C?PLDXDATA
00576E E9                MOV      A,R1
00576F 2405              ADD      A,#05H
005771 22                RET      
----- FUNCTION ?L?COM0323 (END) -------


----- FUNCTION RFPowerLevelGetReduced (BEGIN) -----
005772 9006B1            MOV      DPTR,#bRediscoveryPowerLevel
005775 E0                MOVX     A,@DPTR
005776 FD                MOV      R5,A
005777 FF                MOV      R7,A
005778 C3                CLR      C
005779 740E              MOV      A,#0EH
00577B 9F                SUBB     A,R7
00577C FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 104


00577D E4                CLR      A
00577E 9400              SUBB     A,#00H
005780 12711F            LCALL    ?L?COM028B
005783 E517              MOV      A,powerIndex
005785 54F0              ANL      A,#0F0H
005787 B169              ACALL    ?L?COM016E
005789 7F00              MOV      R7,#00H
00578B 5002              JNC      ?C0029?ZW_RF_DRIVER
00578D AF05              MOV      R7,AR5
00578F         ?C0029?ZW_RF_DRIVER:
00578F 22                RET      
----- FUNCTION RFPowerLevelGetReduced (END) -------


----- FUNCTION GenerateHomeIDHash (BEGIN) -----
;---- Variable 'bHash' assigned to Register 'R7' ----
005790 901223            MOV      DPTR,#homeID
005793 E0                MOVX     A,@DPTR
005794 F4                CPL      A
005795 FF                MOV      R7,A
005796 A3                INC      DPTR
005797 E0                MOVX     A,@DPTR
005798 6F                XRL      A,R7
005799 FF                MOV      R7,A
00579A A3                INC      DPTR
00579B E0                MOVX     A,@DPTR
00579C 6F                XRL      A,R7
00579D FF                MOV      R7,A
00579E A3                INC      DPTR
00579F E0                MOVX     A,@DPTR
0057A0 6F                XRL      A,R7
0057A1 FF                MOV      R7,A
0057A2 6455              XRL      A,#055H
0057A4 6009              JZ       ?C0239?ZW_RF_DRIVER
0057A6 EF                MOV      A,R7
0057A7 644A              XRL      A,#04AH
0057A9 6004              JZ       ?C0239?ZW_RF_DRIVER
0057AB EF                MOV      A,R7
0057AC B40A01            CJNE     A,#0AH,?C0238?ZW_RF_DRIVER
0057AF         ?C0239?ZW_RF_DRIVER:
0057AF 0F                INC      R7
0057B0         ?C0238?ZW_RF_DRIVER:
0057B0 9006AF            MOV      DPTR,#bHomeIDHash
0057B3 EF                MOV      A,R7
0057B4 F0                MOVX     @DPTR,A
0057B5 22                RET      
----- FUNCTION GenerateHomeIDHash (END) -------


----- FUNCTION _SafeTimerSysStart (BEGIN) -----
0057B6 904016            MOV      DPTR,#func
0057B9 EC                MOV      A,R4
0057BA F0                MOVX     @DPTR,A
0057BB A3                INC      DPTR
0057BC ED                MOV      A,R5
0057BD F0                MOVX     @DPTR,A
0057BE 904013            MOV      DPTR,#pbTimerHandle
0057C1 1225A9            LCALL    ?C?PSTXDATA
0057C4 513C              ACALL    _SafeTimerStop
0057C6 904016            MOV      DPTR,#func
0057C9 12723A            LCALL    ?L?COM0401
0057CC 904013            MOV      DPTR,#pbTimerHandle
0057CF 123F95            LCALL    ?L?COM00C0
0057D2 904013            MOV      DPTR,#pbTimerHandle
0057D5 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 105


0057D8 121FB3            LCALL    ?C?CLDPTR
0057DB B4FF04            CJNE     A,#0FFH,?C0056?ZW_TIMER
0057DE E4                CLR      A
0057DF 122072            LCALL    ?C?CSTPTR
0057E2         ?C0056?ZW_TIMER:
0057E2 904013            MOV      DPTR,#pbTimerHandle
0057E5 122589            LCALL    ?C?PLDXDATA
0057E8 121FB3            LCALL    ?C?CLDPTR
0057EB FF                MOV      R7,A
0057EC 22                RET      
----- FUNCTION _SafeTimerSysStart (END) -------


----- FUNCTION RFLBtTimeoutFunction (BEGIN) -----
0057ED E4                CLR      A
0057EE 9006D0            MOV      DPTR,#bLBTFailedTimerhandler
0057F1 F0                MOVX     @DPTR,A
0057F2 9006C1            MOV      DPTR,#bLBTTimeout
0057F5 04                INC      A
0057F6 F0                MOVX     @DPTR,A
0057F7 22                RET      
----- FUNCTION RFLBtTimeoutFunction (END) -------


----- FUNCTION RFIsReceiving (BEGIN) -----
0057F8 B1FE              ACALL    RF_demodulator_enable_get
0057FA 5005              JNC      ?C0012?ZW_RF_DRIVER
0057FC 125809            LCALL    RF_IsSofOrPreambDetected
0057FF 4003              JC       ?C0011?ZW_RF_DRIVER
005801         ?C0012?ZW_RF_DRIVER:
005801 301303            JNB      RF_WakeupReceived,?C0009?ZW_RF_DRIVER
005804         ?C0011?ZW_RF_DRIVER:
005804 D3                SETB     C
005805 8001              SJMP     ?C0010?ZW_RF_DRIVER
005807         ?C0009?ZW_RF_DRIVER:
005807 C3                CLR      C
005808         ?C0010?ZW_RF_DRIVER:
005808 22                RET      
----- FUNCTION RFIsReceiving (END) -------


----- FUNCTION RF_IsSofOrPreambDetected (BEGIN) -----
005809 E5F7              MOV      A,DMSTAT1
00580B 54E0              ANL      A,#0E0H
00580D 24FF              ADD      A,#0FFH
00580F 22                RET      
----- FUNCTION RF_IsSofOrPreambDetected (END) -------


----- FUNCTION RFIsTransmitting (BEGIN) -----
005810 AF14              MOV      R7,RF_state
005812 EF                MOV      A,R7
005813 C3                CLR      C
005814 6001              JZ       ?C0014?ZW_RF_DRIVER
005816 D3                SETB     C
005817         ?C0014?ZW_RF_DRIVER:
005817 22                RET      
----- FUNCTION RFIsTransmitting (END) -------


----- FUNCTION _ZW_RFPowerlevelRediscoverySet (BEGIN) -----
;---- Variable 'bNewPower' assigned to Register 'R7' ----
005818 EF                MOV      A,R7
005819 C3                CLR      C
00581A 940E              SUBB     A,#0EH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 106


00581C 5005              JNC      ?C0018?ZW_RF_DRIVER
00581E 9006B1            MOV      DPTR,#bRediscoveryPowerLevel
005821 EF                MOV      A,R7
005822 F0                MOVX     @DPTR,A
005823         ?C0018?ZW_RF_DRIVER:
005823 22                RET      
----- FUNCTION _ZW_RFPowerlevelRediscoverySet (END) -------


----- FUNCTION ZW_RFPowerLevelGet (BEGIN) -----
005824 E517              MOV      A,powerIndex
005826 540F              ANL      A,#0FH
005828 FF                MOV      R7,A
005829 22                RET      
----- FUNCTION ZW_RFPowerLevelGet (END) -------


----- FUNCTION _ZW_RFPowerLevelSet (BEGIN) -----
;---- Variable 'powerLevel' assigned to Register 'R7' ----
00582A E517              MOV      A,powerIndex
00582C C3                CLR      C
00582D 94F0              SUBB     A,#0F0H
00582F 501F              JNC      ?C0020?ZW_RF_DRIVER
005831 5317F0            ANL      powerIndex,#0F0H
005834 1153              ACALL    ?L?COM0485
005836 FE                MOV      R6,A
;---- Variable 'p' assigned to Register 'R6' ----
005837 740F              MOV      A,#0FH
005839 C3                CLR      C
00583A 9F                SUBB     A,R7
00583B 4005              JC       ?C0022?ZW_RF_DRIVER
00583D EE                MOV      A,R6
00583E 940E              SUBB     A,#0EH
005840 4005              JC       ?C0021?ZW_RF_DRIVER
005842         ?C0022?ZW_RF_DRIVER:
005842 43170D            ORL      powerIndex,#0DH
005845 8003              SJMP     ?C0023?ZW_RF_DRIVER
005847         ?C0021?ZW_RF_DRIVER:
005847 EF                MOV      A,R7
005848 4217              ORL      powerIndex,A
00584A         ?C0023?ZW_RF_DRIVER:
00584A E517              MOV      A,powerIndex
00584C 540F              ANL      A,#0FH
00584E FF                MOV      R7,A
00584F 22                RET      
005850         ?C0020?ZW_RF_DRIVER:
005850 7F00              MOV      R7,#00H
005852 22                RET      
----- FUNCTION _ZW_RFPowerLevelSet (END) -------


----- FUNCTION ?L?COM0485 (BEGIN) -----
005853 E517              MOV      A,powerIndex
005855 C4                SWAP     A
005856 540F              ANL      A,#0FH
005858 FE                MOV      R6,A
005859 EF                MOV      A,R7
00585A 90318C            MOV      DPTR,#index_map
00585D 93                MOVC     A,@A+DPTR
00585E 2E                ADD      A,R6
00585F 22                RET      
----- FUNCTION ?L?COM0485 (END) -------


----- FUNCTION _RFPowerGetTxPwrReg (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 107


;---- Variable 'powerLevel' assigned to Register 'R7' ----
005860 1153              ACALL    ?L?COM0485
005862 FF                MOV      R7,A
;---- Variable 'i' assigned to Register 'R7' ----
005863 C3                CLR      C
005864 940E              SUBB     A,#0EH
005866 4002              JC       ?C0034?ZW_RF_DRIVER
005868 7F0D              MOV      R7,#0DH
00586A         ?C0034?ZW_RF_DRIVER:
00586A EF                MOV      A,R7
00586B 90316E            MOV      DPTR,#rf_power_table
00586E 93                MOVC     A,@A+DPTR
00586F FF                MOV      R7,A
005870 22                RET      
----- FUNCTION _RFPowerGetTxPwrReg (END) -------


----- FUNCTION _RF_get_tx_power (BEGIN) -----
;---- Variable 'wRFoptions' assigned to Register 'R6/R7' ----
005871 EF                MOV      A,R7
005872 30E303            JNB      ACC.3,?C0054?ZW_RF_DRIVER
005875 AF13              MOV      R7,low_PA_POW
005877 22                RET      
005878         ?C0054?ZW_RF_DRIVER:
;---- Variable 'i' assigned to Register 'R5' ----
005878 AD1B              MOV      R5,normal_PA_POW
00587A 201404            JB       reducedFindNeighborPower,?C0057?ZW_RF_DRIVER
00587D EE                MOV      A,R6
00587E 30E00C            JNB      ACC.0,?C0056?ZW_RF_DRIVER
005881         ?C0057?ZW_RF_DRIVER:
005881 E517              MOV      A,powerIndex
005883 C3                CLR      C
005884 94F0              SUBB     A,#0F0H
005886 5021              JNC      ?C0059?ZW_RF_DRIVER
005888 125772            LCALL    RFPowerLevelGetReduced
00588B 8018              SJMP     ?C0245?ZW_RF_DRIVER
00588D         ?C0056?ZW_RF_DRIVER:
00588D E519              MOV      A,ackPower
00588F 6006              JZ       ?C0060?ZW_RF_DRIVER
005891 FD                MOV      R5,A
005892 E4                CLR      A
005893 F519              MOV      ackPower,A
005895 8012              SJMP     ?C0059?ZW_RF_DRIVER
005897         ?C0060?ZW_RF_DRIVER:
005897 E517              MOV      A,powerIndex
005899 C3                CLR      C
00589A 94F0              SUBB     A,#0F0H
00589C 500B              JNC      ?C0059?ZW_RF_DRIVER
00589E E517              MOV      A,powerIndex
0058A0 540F              ANL      A,#0FH
0058A2 FF                MOV      R7,A
0058A3 6004              JZ       ?C0059?ZW_RF_DRIVER
0058A5         
0058A5 1160              ACALL    _RFPowerGetTxPwrReg
0058A7 AD07              MOV      R5,AR7
0058A9         ?C0059?ZW_RF_DRIVER:
0058A9 AF05              MOV      R7,AR5
0058AB 22                RET      
----- FUNCTION _RF_get_tx_power (END) -------


----- FUNCTION _SwitchToTX (BEGIN) -----
;---- Variable 'wRFoptions' assigned to Register 'R6/R7' ----
0058AC 431501            ORL      RF_status,#01H
0058AF 5315DF            ANL      RF_status,#0DFH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 108


0058B2 1171              ACALL    _RF_get_tx_power
0058B4 D1FC              ACALL    _RF_setup_tx_mode
0058B6 4004              JC       ?C0099?ZW_RF_DRIVER
0058B8 E4                CLR      A
0058B9 F514              MOV      RF_state,A
0058BB 22                RET      
0058BC         ?C0099?ZW_RF_DRIVER:
0058BC 43FA04            ORL      MODCTRL,#04H
0058BF 5315FB            ANL      RF_status,#0FBH
0058C2 302604            JNB      bUseFrameHandler,?C0101?ZW_RF_DRIVER
0058C5 11F1              ACALL    ?L?COM02F5
0058C7 800A              SJMP     ?C0102?ZW_RF_DRIVER
0058C9         ?C0101?ZW_RF_DRIVER:
0058C9 7F55              MOV      R7,#055H
0058CB 11D5              ACALL    _RF_byte_set
0058CD 7F55              MOV      R7,#055H
0058CF 11D5              ACALL    _RF_byte_set
0058D1 D2EB              SETB     ERF
0058D3         ?C0102?ZW_RF_DRIVER:
0058D3 D3                SETB     C
0058D4 22                RET      
----- FUNCTION _SwitchToTX (END) -------


----- FUNCTION _RF_byte_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
0058D5 75FF01            MOV      SFRPAGE,#01H
0058D8 E5D5              MOV      A,RFCON
0058DA 20E602            JB       ACC.6,?C0266?ZW_PHY_RF_050X
0058DD C3                CLR      C
0058DE 22                RET      
0058DF         ?C0266?ZW_PHY_RF_050X:
0058DF E5FA              MOV      A,MODCTRL
0058E1 5403              ANL      A,#03H
0058E3 60FA              JZ       ?C0266?ZW_PHY_RF_050X
0058E5         ?C0267?ZW_PHY_RF_050X:
0058E5 75FF01            MOV      SFRPAGE,#01H
0058E8 8FC3              MOV      MODDATA,R7
0058EA D3                SETB     C
0058EB 22                RET      
----- FUNCTION _RF_byte_set (END) -------


----- FUNCTION ?L?COM02F4 (BEGIN) -----
0058EC 3185              ACALL    _RF_channel_set
0058EE 43FA04            ORL      MODCTRL,#04H
0058F1         ?L?COM02F5:
0058F1 E4                CLR      A
0058F2 F5FF              MOV      SFRPAGE,A
0058F4         ?L?COM02F6:
0058F4 53D1FD            ANL      FHCON1,#0FDH
0058F7 43D101            ORL      FHCON1,#01H
0058FA 22                RET      
----- FUNCTION ?L?COM02F4 (END) -------


----- FUNCTION ?L?COM051D (BEGIN) -----
0058FB AF82              MOV      R7,DPL
0058FD AE83              MOV      R6,DPH
0058FF 7D01              MOV      R5,#01H
----- FUNCTION _RFReceiveRestart (BEGIN) -----
005901 900A8F            MOV      DPTR,#buffer
005904 127085            LCALL    ?L?COM00F3
005907 E514              MOV      A,RF_state
005909 7079              JNZ      ?C0076?ZW_RF_DRIVER
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 109


00590B 1255F6            LCALL    ?L?COM04BD
00590E 5005              JNC      ?C0064?ZW_RF_DRIVER
005910 C233              CLR      ?RF_demodulator_enable?BIT
005912 12373A            LCALL    RF_demodulator_enable
005915         ?C0064?ZW_RF_DRIVER:
005915 900A8F            MOV      DPTR,#buffer
005918 E0                MOVX     A,@DPTR
005919 FE                MOV      R6,A
00591A A3                INC      DPTR
00591B E0                MOVX     A,@DPTR
00591C 8E11              MOV      RF_data_addr,R6
00591E F512              MOV      RF_data_addr+01H,A
005920 A3                INC      DPTR
005921 122589            LCALL    ?C?PLDXDATA
005924 9006B2            MOV      DPTR,#RF_rssi_samples
005927 1225A9            LCALL    ?C?PSTXDATA
00592A AE11              MOV      R6,RF_data_addr
00592C AF12              MOV      R7,RF_data_addr+01H
00592E 7DAA              MOV      R5,#0AAH
005930 126E06            LCALL    _ZW_FH_rx_init
005933 E4                CLR      A
005934 F5FF              MOV      SFRPAGE,A
005936 75D901            MOV      FHINTLVL,#01H
005939 F510              MOV      demodState,A
00593B E515              MOV      A,RF_status
00593D 5421              ANL      A,#021H
00593F 602B              JZ       ?C0065?ZW_RF_DRIVER
005941 E515              MOV      A,RF_status
005943 30E504            JNB      ACC.5,?C0066?ZW_RF_DRIVER
005946 E4                CLR      A
005947 FF                MOV      R7,A
005948 3185              ACALL    _RF_channel_set
00594A         ?C0066?ZW_RF_DRIVER:
00594A E4                CLR      A
00594B 900A94            MOV      DPTR,#bRestartCount
00594E F0                MOVX     @DPTR,A
00594F         ?C0069?ZW_RF_DRIVER:
00594F 900A94            MOV      DPTR,#bRestartCount
005952 E0                MOVX     A,@DPTR
005953 04                INC      A
005954 F0                MOVX     @DPTR,A
005955 126445            LCALL    RF_switch_to_RX
;---- Variable 'bSwitchStatus' assigned to Register 'R7' ----
005958         ?C0070?ZW_RF_DRIVER:
005958         ?C0067?ZW_RF_DRIVER:
005958 EF                MOV      A,R7
005959 6009              JZ       ?C0068?ZW_RF_DRIVER
00595B 900A94            MOV      DPTR,#bRestartCount
00595E E0                MOVX     A,@DPTR
00595F C3                CLR      C
005960 9410              SUBB     A,#010H
005962 40EB              JC       ?C0069?ZW_RF_DRIVER
005964         ?C0068?ZW_RF_DRIVER:
005964 7F02              MOV      R7,#02H
005966 121DD6            LCALL    ?INTERBANK_TABLE?_ApplicationRfNotify
005969 5315DE            ANL      RF_status,#0DEH
00596C         ?C0065?ZW_RF_DRIVER:
00596C 9006AE            MOV      DPTR,#rfRxCurrentSpeed
00596F E0                MOVX     A,@DPTR
005970 7F00              MOV      R7,#00H
005972 B40302            CJNE     A,#03H,?C0074?ZW_RF_DRIVER
005975 7F01              MOV      R7,#01H
005977         ?C0074?ZW_RF_DRIVER:
005977         ?C0075?ZW_RF_DRIVER:
;---- Variable 'bNextRFChannel' assigned to Register 'R7' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 110


005977 11EC              ACALL    ?L?COM02F4
005979 D233              SETB     ?RF_demodulator_enable?BIT
00597B 12373A            LCALL    RF_demodulator_enable
00597E D2EB              SETB     ERF
005980 A212              MOV      C,fEUSB
005982 92ED              MOV      EUSB,C
005984         ?C0076?ZW_RF_DRIVER:
005984 22                RET      
----- FUNCTION _RFReceiveRestart (END) -------


----- FUNCTION _RF_channel_set (BEGIN) -----
;---- Variable 'chsel' assigned to Register 'R7' ----
005985 75FF01            MOV      SFRPAGE,#01H
005988 E5D5              MOV      A,RFCON
00598A 30E602            JNB      ACC.6,?C0191?ZW_PHY_RF_050X
00598D C3                CLR      C
00598E 22                RET      
00598F         ?C0191?ZW_PHY_RF_050X:
00598F E4                CLR      A
005990 F5FF              MOV      SFRPAGE,A
005992 439A80            ORL      DMLSFLT1,#080H
005995 EF                MOV      A,R7
005996 124FEF            LCALL    ?L?COM0482
005999 E4                CLR      A
00599A F5FF              MOV      SFRPAGE,A
00599C 539A7F            ANL      DMLSFLT1,#07FH
00599F D3                SETB     C
0059A0 22                RET      
----- FUNCTION _RF_channel_set (END) -------


----- FUNCTION _RFRxRestart (BEGIN) -----
0059A1 C233              CLR      ?RF_demodulator_enable?BIT
0059A3 12373A            LCALL    RF_demodulator_enable
0059A6 F153              ACALL    ?L?COM02F2
0059A8         ?C0077?ZW_RF_DRIVER:
0059A8 E5D1              MOV      A,FHCON1
0059AA 20E0FB            JB       ACC.0,?C0077?ZW_RF_DRIVER
0059AD         ?C0078?ZW_RF_DRIVER:
0059AD E4                CLR      A
0059AE F5FF              MOV      SFRPAGE,A
0059B0 75D901            MOV      FHINTLVL,#01H
0059B3 9006AE            MOV      DPTR,#rfRxCurrentSpeed
0059B6 E0                MOVX     A,@DPTR
0059B7 7F00              MOV      R7,#00H
0059B9 B40302            CJNE     A,#03H,?C0079?ZW_RF_DRIVER
0059BC 7F01              MOV      R7,#01H
0059BE         ?C0079?ZW_RF_DRIVER:
0059BE         ?C0080?ZW_RF_DRIVER:
;---- Variable 'bNextRFChannel' assigned to Register 'R7' ----
0059BE 11EC              ACALL    ?L?COM02F4
0059C0 D233              SETB     ?RF_demodulator_enable?BIT
0059C2 12373A            LCALL    RF_demodulator_enable
0059C5 E4                CLR      A
0059C6 F510              MOV      demodState,A
0059C8 22                RET      
----- FUNCTION _RFRxRestart (END) -------


----- FUNCTION RFInterrupt (BEGIN) -----
0059C9 C0E0              PUSH     ACC
0059CB C0F0              PUSH     B
0059CD C083              PUSH     DPH
0059CF C082              PUSH     DPL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 111


0059D1 C0D0              PUSH     PSW
0059D3 75D008            MOV      PSW,#08H
0059D6 C0FF              PUSH     SFRPAGE
0059D8 75FF01            MOV      SFRPAGE,#01H
0059DB E5D5              MOV      A,RFCON
0059DD 30E604            JNB      ACC.6,?C0138?ZW_RF_DRIVER
0059E0 7F02              MOV      R7,#02H
0059E2 8009              SJMP     ?C0139?ZW_RF_DRIVER
0059E4         ?C0138?ZW_RF_DRIVER:
0059E4 E5D5              MOV      A,RFCON
0059E6 7F00              MOV      R7,#00H
0059E8 30E702            JNB      ACC.7,?C0141?ZW_RF_DRIVER
0059EB 7F01              MOV      R7,#01H
0059ED         ?C0141?ZW_RF_DRIVER:
0059ED         ?C0142?ZW_RF_DRIVER:
0059ED         ?C0139?ZW_RF_DRIVER:
0059ED 8F18              MOV      bRFIntMode,R7
0059EF E518              MOV      A,bRFIntMode
0059F1 6402              XRL      A,#02H
0059F3 6002              JZ       $ + 4H
0059F5 41A6              AJMP     ?C0143?ZW_RF_DRIVER
0059F7 E514              MOV      A,RF_state
0059F9 1226B6            LCALL    ?C?CCASE
0059FC 5A15              DW       ?C0145?ZW_RF_DRIVER
0059FE 01                DB       01H
0059FF 5A28              DW       ?C0147?ZW_RF_DRIVER
005A01 02                DB       02H
005A02 5A92              DW       ?C0153?ZW_RF_DRIVER
005A04 08                DB       08H
005A05 5A33              DW       ?C0148?ZW_RF_DRIVER
005A07 09                DB       09H
005A08 5A3E              DW       ?C0149?ZW_RF_DRIVER
005A0A 0A                DB       0AH
005A0B 5A4C              DW       ?C0150?ZW_RF_DRIVER
005A0D 0B                DB       0BH
005A0E 5A6C              DW       ?C0152?ZW_RF_DRIVER
005A10 0C                DB       0CH
005A11 0000              DW       00H
005A13 5C26              DW       ?C0155?ZW_RF_DRIVER
005A15         ?C0145?ZW_RF_DRIVER:
005A15 75FF01            MOV      SFRPAGE,#01H
005A18 75C355            MOV      MODDATA,#055H
005A1B 151A              DEC      RF_num
005A1D E51A              MOV      A,RF_num
005A1F 6002              JZ       $ + 4H
005A21 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A23 751402            MOV      RF_state,#02H
005A26 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A28         ?C0147?ZW_RF_DRIVER:
005A28 75FF01            MOV      SFRPAGE,#01H
005A2B 75C3F0            MOV      MODDATA,#0F0H
005A2E 751409            MOV      RF_state,#09H
005A31 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A33         ?C0148?ZW_RF_DRIVER:
005A33 75FF01            MOV      SFRPAGE,#01H
005A36 75C355            MOV      MODDATA,#055H
005A39 75140A            MOV      RF_state,#0AH
005A3C 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A3E         ?C0149?ZW_RF_DRIVER:
005A3E 75FF01            MOV      SFRPAGE,#01H
005A41 9006C2            MOV      DPTR,#bBeamDestAddress
005A44 E0                MOVX     A,@DPTR
005A45 F5C3              MOV      MODDATA,A
005A47 75140B            MOV      RF_state,#0BH
005A4A 8126              AJMP     ?C0155?ZW_RF_DRIVER
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 112


005A4C         ?C0150?ZW_RF_DRIVER:
005A4C 75FF01            MOV      SFRPAGE,#01H
005A4F 9006AF            MOV      DPTR,#bHomeIDHash
005A52 E0                MOVX     A,@DPTR
005A53 F5C3              MOV      MODDATA,A
005A55 751401            MOV      RF_state,#01H
005A58 751A14            MOV      RF_num,#014H
005A5B 9006D1            MOV      DPTR,#RF_BeamCount
005A5E 1272FA            LCALL    ?L?COM049B
005A61 45F0              ORL      A,B
005A63 6002              JZ       $ + 4H
005A65 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A67 75140C            MOV      RF_state,#0CH
005A6A 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A6C         ?C0152?ZW_RF_DRIVER:
005A6C AB1C              MOV      R3,RF_header_addr
005A6E AA1D              MOV      R2,RF_header_addr+01H
005A70 A91E              MOV      R1,RF_header_addr+02H
005A72 126E30            LCALL    _ZW_FH_buf0addr_set
005A75 AD16              MOV      R5,RF_data_count
005A77 AF1F              MOV      R7,RF_header_count
005A79 126E5B            LCALL    _ZW_FH_tx_buflen_set
005A7C 12552D            LCALL    ?L?COM0579
005A7F 75FF00            MOV      SFRPAGE,#00H
005A82 1273D0            LCALL    ?L?COM05C6
005A85 43FA04            ORL      MODCTRL,#04H
005A88 75FF00            MOV      SFRPAGE,#00H
005A8B 11F4              ACALL    ?L?COM02F6
005A8D 751408            MOV      RF_state,#08H
005A90 8126              AJMP     ?C0155?ZW_RF_DRIVER
005A92         ?C0153?ZW_RF_DRIVER:
005A92 C2EB              CLR      ERF
005A94 751400            MOV      RF_state,#00H
005A97 431504            ORL      RF_status,#04H
005A9A 127290            LCALL    ?L?COM0439
005A9D 4002              JC       $ + 4H
005A9F 8126              AJMP     ?C0155?ZW_RF_DRIVER
005AA1 123F7F            LCALL    ?L?COM0081
005AA4 8126              AJMP     ?C0155?ZW_RF_DRIVER
005AA6         ?C0143?ZW_RF_DRIVER:
005AA6 E518              MOV      A,bRFIntMode
005AA8 6401              XRL      A,#01H
005AAA 6002              JZ       $ + 4H
005AAC 8126              AJMP     ?C0155?ZW_RF_DRIVER
005AAE 126B76            LCALL    RF_IsSofDetected
005AB1 4002              JC       $ + 4H
005AB3 8126              AJMP     ?C0155?ZW_RF_DRIVER
005AB5 E510              MOV      A,demodState
005AB7 7022              JNZ      ?C0158?ZW_RF_DRIVER
005AB9 913A              ACALL    ?L?COM0311
005ABB E0                MOVX     A,@DPTR
005ABC FF                MOV      R7,A
;---- Variable 'bData1' assigned to Register 'R7' ----
005ABD 6455              XRL      A,#055H
005ABF 6004              JZ       ?C0160?ZW_RF_DRIVER
005AC1 EF                MOV      A,R7
005AC2 B4540B            CJNE     A,#054H,?C0159?ZW_RF_DRIVER
005AC5         ?C0160?ZW_RF_DRIVER:
005AC5 D213              SETB     RF_WakeupReceived
005AC7 AF71              MOV      R7,tickTime+01H
005AC9 9006CF            MOV      DPTR,#rfWakeupReceivedTickSample
005ACC EF                MOV      A,R7
005ACD F0                MOVX     @DPTR,A
005ACE 61A8              AJMP     ?C0250?ZW_RF_DRIVER
005AD0         ?C0159?ZW_RF_DRIVER:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 113


005AD0 751002            MOV      demodState,#02H
005AD3 75FF00            MOV      SFRPAGE,#00H
005AD6 75D908            MOV      FHINTLVL,#08H
005AD9 8126              AJMP     ?C0155?ZW_RF_DRIVER
005ADB         ?C0158?ZW_RF_DRIVER:
005ADB E510              MOV      A,demodState
005ADD 6402              XRL      A,#02H
005ADF 706E              JNZ      ?C0163?ZW_RF_DRIVER
005AE1 75FF01            MOV      SFRPAGE,#01H
005AE4 F5EA              MOV      DFCON3,A
005AE6 75EAFF            MOV      DFCON3,#0FFH
005AE9 9006B2            MOV      DPTR,#RF_rssi_samples
005AEC 122589            LCALL    ?C?PLDXDATA
005AEF E5D9              MOV      A,DFSTAT
005AF1 122072            LCALL    ?C?CSTPTR
005AF4 126B4C            LCALL    RF_RX_speed_get
005AF7 12605C            LCALL    _ConvertPhySpeedToRFSpeed
005AFA 9006AE            MOV      DPTR,#rfRxCurrentSpeed
005AFD EF                MOV      A,R7
005AFE F0                MOVX     @DPTR,A
005AFF F16B              ACALL    ?L?COM04BC
005B01 E0                MOVX     A,@DPTR
005B02 900B06            MOV      DPTR,#bData2
005B05 F0                MOVX     @DPTR,A
005B06 E0                MOVX     A,@DPTR
005B07 FF                MOV      R7,A
005B08 D3                SETB     C
005B09 9409              SUBB     A,#09H
005B0B 4025              JC       ?C0165?ZW_RF_DRIVER
005B0D 9006AE            MOV      DPTR,#rfRxCurrentSpeed
005B10 E0                MOVX     A,@DPTR
005B11 D3                SETB     C
005B12 9402              SUBB     A,#02H
005B14 400C              JC       ?C0166?ZW_RF_DRIVER
005B16 EF                MOV      A,R7
005B17 D3                SETB     C
005B18 94AA              SUBB     A,#0AAH
005B1A 7F00              MOV      R7,#00H
005B1C 4002              JC       ?C0168?ZW_RF_DRIVER
005B1E 7F01              MOV      R7,#01H
005B20         ?C0168?ZW_RF_DRIVER:
005B20         ?C0169?ZW_RF_DRIVER:
005B20 800D              SJMP     ?C0167?ZW_RF_DRIVER
005B22         ?C0166?ZW_RF_DRIVER:
005B22 900B06            MOV      DPTR,#bData2
005B25 E0                MOVX     A,@DPTR
005B26 D3                SETB     C
005B27 9440              SUBB     A,#040H
005B29 7F00              MOV      R7,#00H
005B2B 4002              JC       ?C0170?ZW_RF_DRIVER
005B2D 7F01              MOV      R7,#01H
005B2F         ?C0170?ZW_RF_DRIVER:
005B2F         ?C0171?ZW_RF_DRIVER:
005B2F         ?C0167?ZW_RF_DRIVER:
005B2F EF                MOV      A,R7
005B30 6004              JZ       ?C0164?ZW_RF_DRIVER
005B32         ?C0165?ZW_RF_DRIVER:
005B32 914C              ACALL    ResetSensorState
005B34         
005B34 8072              SJMP     ?C0250?ZW_RF_DRIVER
005B36         ?C0164?ZW_RF_DRIVER:
005B36 900B06            MOV      DPTR,#bData2
005B39 E0                MOVX     A,@DPTR
005B3A F516              MOV      RF_data_count,A
005B3C 126B41            LCALL    RF_channel_get
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 114


005B3F 901222            MOV      DPTR,#rfRxCurrentCh
005B42 EF                MOV      A,R7
005B43 F0                MOVX     @DPTR,A
005B44 75FF00            MOV      SFRPAGE,#00H
005B47 8516D9            MOV      FHINTLVL,RF_data_count
005B4A 751003            MOV      demodState,#03H
005B4D 8126              AJMP     ?C0155?ZW_RF_DRIVER
005B4F         ?C0163?ZW_RF_DRIVER:
005B4F E510              MOV      A,demodState
005B51 6403              XRL      A,#03H
005B53 6002              JZ       $ + 4H
005B55 8126              AJMP     ?C0155?ZW_RF_DRIVER
005B57 9006B2            MOV      DPTR,#RF_rssi_samples
005B5A 122589            LCALL    ?C?PLDXDATA
005B5D 121FB3            LCALL    ?C?CLDPTR
005B60 FF                MOV      R7,A
005B61 9144              ACALL    ?L?COM00B7
005B63 EF                MOV      A,R7
005B64 122072            LCALL    ?C?CSTPTR
005B67 914C              ACALL    ResetSensorState
005B69 75FF00            MOV      SFRPAGE,#00H
005B6C 9006AE            MOV      DPTR,#rfRxCurrentSpeed
005B6F E0                MOVX     A,@DPTR
005B70 C3                CLR      C
005B71 9403              SUBB     A,#03H
005B73 E5D3              MOV      A,FHSTAT
005B75 5005              JNC      ?C0175?ZW_RF_DRIVER
005B77 5402              ANL      A,#02H
005B79 FF                MOV      R7,A
005B7A 8003              SJMP     ?C0176?ZW_RF_DRIVER
005B7C         ?C0175?ZW_RF_DRIVER:
005B7C 5401              ANL      A,#01H
005B7E FF                MOV      R7,A
005B7F         ?C0176?ZW_RF_DRIVER:
;---- Variable 'bSFRVal' assigned to Register 'R7' ----
005B7F EF                MOV      A,R7
005B80 602A              JZ       ?C0177?ZW_RF_DRIVER
005B82 30E111            JNB      ACC.1,?C0178?ZW_RF_DRIVER
005B85 C3                CLR      C
005B86 9006BC            MOV      DPTR,#sRFStats+07H
005B89 E0                MOVX     A,@DPTR
005B8A 94FF              SUBB     A,#0FFH
005B8C 9006BB            MOV      DPTR,#sRFStats+06H
005B8F E0                MOVX     A,@DPTR
005B90 94FF              SUBB     A,#0FFH
005B92 5014              JNC      ?C0180?ZW_RF_DRIVER
005B94 800F              SJMP     ?C0251?ZW_RF_DRIVER
005B96         ?C0178?ZW_RF_DRIVER:
005B96 C3                CLR      C
005B97 9006BE            MOV      DPTR,#sRFStats+09H
005B9A E0                MOVX     A,@DPTR
005B9B 94FF              SUBB     A,#0FFH
005B9D 9006BD            MOV      DPTR,#sRFStats+08H
005BA0 E0                MOVX     A,@DPTR
005BA1 94FF              SUBB     A,#0FFH
005BA3 5003              JNC      ?C0180?ZW_RF_DRIVER
005BA5         
005BA5 123F7F            LCALL    ?L?COM0081
005BA8         ?C0180?ZW_RF_DRIVER:
005BA8         
005BA8 31A1              ACALL    _RFRxRestart
005BAA 807A              SJMP     ?C0155?ZW_RF_DRIVER
005BAC         ?C0177?ZW_RF_DRIVER:
005BAC C233              CLR      ?RF_demodulator_enable?BIT
005BAE 12373A            LCALL    RF_demodulator_enable
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 115


005BB1 75FF00            MOV      SFRPAGE,#00H
005BB4 F156              ACALL    ?L?COM02F3
005BB6         ?C0183?ZW_RF_DRIVER:
005BB6 E5D1              MOV      A,FHCON1
005BB8 20E0FB            JB       ACC.0,?C0183?ZW_RF_DRIVER
005BBB         ?C0184?ZW_RF_DRIVER:
005BBB C2EB              CLR      ERF
005BBD 431502            ORL      RF_status,#02H
005BC0 913A              ACALL    ?L?COM0311
005BC2 A3                INC      DPTR
005BC3 E0                MOVX     A,@DPTR
005BC4 FF                MOV      R7,A
005BC5 901224            MOV      DPTR,#homeID+01H
005BC8 E0                MOVX     A,@DPTR
005BC9 FE                MOV      R6,A
005BCA EF                MOV      A,R7
005BCB 6E                XRL      A,R6
005BCC 9139              ACALL    ?L?COM0310
005BCE E0                MOVX     A,@DPTR
005BCF 901223            MOV      DPTR,#homeID
005BD2 9133              ACALL    ?L?COM030F
005BD4 A3                INC      DPTR
005BD5 A3                INC      DPTR
005BD6 E0                MOVX     A,@DPTR
005BD7 901225            MOV      DPTR,#homeID+02H
005BDA 9133              ACALL    ?L?COM030F
005BDC A3                INC      DPTR
005BDD A3                INC      DPTR
005BDE A3                INC      DPTR
005BDF E0                MOVX     A,@DPTR
005BE0 FE                MOV      R6,A
005BE1 901226            MOV      DPTR,#homeID+03H
005BE4 E0                MOVX     A,@DPTR
005BE5 FD                MOV      R5,A
005BE6 EE                MOV      A,R6
005BE7 6D                XRL      A,R5
005BE8 4F                ORL      A,R7
005BE9 6012              JZ       ?C0185?ZW_RF_DRIVER
005BEB C3                CLR      C
005BEC 9006C0            MOV      DPTR,#sRFStats+0BH
005BEF E0                MOVX     A,@DPTR
005BF0 94FF              SUBB     A,#0FFH
005BF2 9006BF            MOV      DPTR,#sRFStats+0AH
005BF5 E0                MOVX     A,@DPTR
005BF6 94FF              SUBB     A,#0FFH
005BF8 5003              JNC      ?C0185?ZW_RF_DRIVER
005BFA 123F7F            LCALL    ?L?COM0081
005BFD         ?C0185?ZW_RF_DRIVER:
005BFD C3                CLR      C
005BFE 9006BA            MOV      DPTR,#sRFStats+05H
005C01 E0                MOVX     A,@DPTR
005C02 94FF              SUBB     A,#0FFH
005C04 9006B9            MOV      DPTR,#sRFStats+04H
005C07 E0                MOVX     A,@DPTR
005C08 94FF              SUBB     A,#0FFH
005C0A 5003              JNC      ?C0187?ZW_RF_DRIVER
005C0C 123F7F            LCALL    ?L?COM0081
005C0F         ?C0187?ZW_RF_DRIVER:
005C0F 751000            MOV      demodState,#00H
005C12 9006AE            MOV      DPTR,#rfRxCurrentSpeed
005C15 E0                MOVX     A,@DPTR
005C16 B40307            CJNE     A,#03H,?C0188?ZW_RF_DRIVER
005C19 1516              DEC      RF_data_count
005C1B F16B              ACALL    ?L?COM04BC
005C1D E516              MOV      A,RF_data_count
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 116


005C1F F0                MOVX     @DPTR,A
005C20         ?C0188?ZW_RF_DRIVER:
005C20 9003C4            MOV      DPTR,#receivedLength
005C23 E516              MOV      A,RF_data_count
005C25 F0                MOVX     @DPTR,A
005C26         ?C0155?ZW_RF_DRIVER:
005C26 D0FF              POP      SFRPAGE
005C28 D0D0              POP      PSW
005C2A D082              POP      DPL
005C2C D083              POP      DPH
005C2E D0F0              POP      B
005C30 D0E0              POP      ACC
005C32 32                RETI     
----- FUNCTION RFInterrupt (END) -------


----- FUNCTION ?L?COM030F (BEGIN) -----
005C33 FE                MOV      R6,A
005C34 E0                MOVX     A,@DPTR
005C35 FD                MOV      R5,A
005C36 EE                MOV      A,R6
005C37 6D                XRL      A,R5
005C38 4F                ORL      A,R7
005C39         ?L?COM0310:
005C39 FF                MOV      R7,A
005C3A         ?L?COM0311:
005C3A 851282            MOV      DPL,RF_data_addr+01H
005C3D 851183            MOV      DPH,RF_data_addr
005C40 22                RET      
----- FUNCTION ?L?COM030F (END) -------


----- FUNCTION ?L?COM00B6 (BEGIN) -----
005C41 122589            LCALL    ?C?PLDXDATA
005C44         ?L?COM00B7:
005C44 E9                MOV      A,R1
005C45         ?L?COM00B8:
005C45 2401              ADD      A,#01H
005C47 F9                MOV      R1,A
005C48 E4                CLR      A
005C49 3A                ADDC     A,R2
005C4A FA                MOV      R2,A
005C4B 22                RET      
----- FUNCTION ?L?COM00B6 (END) -------


----- FUNCTION ResetSensorState (BEGIN) -----
005C4C 301304            JNB      RF_WakeupReceived,?C0137?ZW_RF_DRIVER
005C4F C213              CLR      RF_WakeupReceived
005C51 9154              ACALL    ?L?COM03D1
005C53         ?C0137?ZW_RF_DRIVER:
005C53 22                RET      
----- FUNCTION ResetSensorState (END) -------


----- FUNCTION ?L?COM03D1 (BEGIN) -----
005C54 C21B              CLR      ?RF_sensor_mode_enable?BIT
005C56 E4                CLR      A
005C57 904279            MOV      DPTR,#?RF_sensor_mode_enable?BYTE
005C5A F0                MOVX     @DPTR,A
005C5B C21C              CLR      ?RF_sensor_mode_enable?BIT+01H
005C5D A3                INC      DPTR
005C5E F0                MOVX     @DPTR,A
005C5F A3                INC      DPTR
005C60 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 117


----- FUNCTION RF_sensor_mode_enable (BEGIN) -----
;---- Variable 'rssi_threshold' assigned to Register 'R5' ----
005C61 75FF01            MOV      SFRPAGE,#01H
005C64 E5D5              MOV      A,RFCON
005C66 20E702            JB       ACC.7,?C0237?ZW_PHY_RF_050X
005C69 C3                CLR      C
005C6A 22                RET      
005C6B         ?C0237?ZW_PHY_RF_050X:
005C6B C234              CLR      ?RF_demodulator_enable_fast?BIT
005C6D D133              ACALL    RF_demodulator_enable_fast
005C6F 201B02            JB       enable,$ + 5H
005C72 A103              AJMP     ?C0239?ZW_PHY_RF_050X
005C74 53F4DF            ANL      DMCTRL,#0DFH
005C77 904279            MOV      DPTR,#bChannel
005C7A E0                MOVX     A,@DPTR
005C7B FF                MOV      R7,A
005C7C 3185              ACALL    _RF_channel_set
005C7E 124FE7            LCALL    ?L?COM0570
005C81 301C05            JNB      enable_timeout,?C0240?ZW_PHY_RF_050X
005C84 43F440            ORL      DMCTRL,#040H
005C87 8003              SJMP     ?C0241?ZW_PHY_RF_050X
005C89         ?C0240?ZW_PHY_RF_050X:
005C89 53F4BF            ANL      DMCTRL,#0BFH
005C8C         ?C0241?ZW_PHY_RF_050X:
005C8C E4                CLR      A
005C8D F5FF              MOV      SFRPAGE,A
005C8F 53F5F0            ANL      DMSETUP2,#0F0H
005C92 90427A            MOV      DPTR,#timeout
005C95 E0                MOVX     A,@DPTR
005C96 FA                MOV      R2,A
005C97 A3                INC      DPTR
005C98 E0                MOVX     A,@DPTR
005C99 FB                MOV      R3,A
005C9A EA                MOV      A,R2
005C9B 42F5              ORL      DMSETUP2,A
005C9D EB                MOV      A,R3
005C9E F5F6              MOV      DMSETUP3,A
005CA0 D234              SETB     ?RF_demodulator_enable_fast?BIT
005CA2 D133              ACALL    RF_demodulator_enable_fast
005CA4 7FC8              MOV      R7,#0C8H
005CA6 124EF5            LCALL    ?L?COM0124
005CA9         ?C0244?ZW_PHY_RF_050X:
005CA9 E4                CLR      A
005CAA F5FF              MOV      SFRPAGE,A
005CAC E593              MOV      A,SEQCON2
005CAE 20E604            JB       ACC.6,?C0243?ZW_PHY_RF_050X
005CB1 B112              ACALL    phy_timer_runs
005CB3 40F4              JC       ?C0244?ZW_PHY_RF_050X
005CB5         ?C0243?ZW_PHY_RF_050X:
005CB5 301C58            JNB      enable_timeout,?C0258?ZW_PHY_RF_050X
005CB8 E5F4              MOV      A,DMCTRL
005CBA 30E304            JNB      ACC.3,?C0247?ZW_PHY_RF_050X
005CBD 7D28              MOV      R5,#028H
005CBF 8010              SJMP     ?C0248?ZW_PHY_RF_050X
005CC1         ?C0247?ZW_PHY_RF_050X:
005CC1 E5F4              MOV      A,DMCTRL
005CC3 30E204            JNB      ACC.2,?C0249?ZW_PHY_RF_050X
005CC6 7D28              MOV      R5,#028H
005CC8 8007              SJMP     ?C0248?ZW_PHY_RF_050X
005CCA         ?C0249?ZW_PHY_RF_050X:
005CCA E5F4              MOV      A,DMCTRL
005CCC 30E102            JNB      ACC.1,?C0248?ZW_PHY_RF_050X
005CCF 7D28              MOV      R5,#028H
005CD1         ?C0248?ZW_PHY_RF_050X:
005CD1 124FBF            LCALL    stop_phy_timer
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 118


005CD4 7F28              MOV      R7,#028H
005CD6 124EF5            LCALL    ?L?COM0124
005CD9         ?C0252?ZW_PHY_RF_050X:
005CD9 B112              ACALL    phy_timer_runs
005CDB 40FC              JC       ?C0252?ZW_PHY_RF_050X
005CDD         ?C0253?ZW_PHY_RF_050X:
005CDD 7F78              MOV      R7,#078H
005CDF 124EF5            LCALL    ?L?COM0124
005CE2         ?C0254?ZW_PHY_RF_050X:
005CE2 B112              ACALL    phy_timer_runs
005CE4 502A              JNC      ?C0258?ZW_PHY_RF_050X
005CE6 D17F              ACALL    _rssi_rdy
005CE8 50F8              JNC      ?C0254?ZW_PHY_RF_050X
005CEA D1F6              ACALL    _instant_rssi
005CEC EF                MOV      A,R7
005CED C3                CLR      C
005CEE 9D                SUBB     A,R5
005CEF 50F1              JNC      ?C0254?ZW_PHY_RF_050X
005CF1 D17F              ACALL    _rssi_rdy
005CF3 50ED              JNC      ?C0254?ZW_PHY_RF_050X
005CF5 E5F7              MOV      A,DMSTAT1
005CF7 20E5E8            JB       ACC.5,?C0254?ZW_PHY_RF_050X
005CFA C234              CLR      ?RF_demodulator_enable_fast?BIT
005CFC D133              ACALL    RF_demodulator_enable_fast
005CFE 124FBF            LCALL    stop_phy_timer
005D01 80DF              SJMP     ?C0254?ZW_PHY_RF_050X
005D03         ?C0239?ZW_PHY_RF_050X:
005D03 53F4BF            ANL      DMCTRL,#0BFH
005D06 1263E5            LCALL    ?L?COM0347
005D09 4005              JC       ?C0258?ZW_PHY_RF_050X
005D0B 43F420            ORL      DMCTRL,#020H
005D0E F14C              ACALL    ?L?COM056F
005D10         ?C0258?ZW_PHY_RF_050X:
005D10 D3                SETB     C
005D11 22                RET      
----- FUNCTION RF_sensor_mode_enable (END) -------


----- FUNCTION phy_timer_runs (BEGIN) -----
005D12 75FF03            MOV      SFRPAGE,#03H
005D15 E591              MOV      A,PHYTCON1
005D17 C3                CLR      C
005D18 30E701            JNB      ACC.7,?C0018?ZW_PHY_RF_050X
005D1B D3                SETB     C
005D1C         ?C0018?ZW_PHY_RF_050X:
005D1C 22                RET      
----- FUNCTION phy_timer_runs (END) -------


----- FUNCTION _RF_switch_to_TX (BEGIN) -----
005D1D 904021            MOV      DPTR,#chsel
005D20 124765            LCALL    ?L?COM0102
005D23 EB                MOV      A,R3
005D24 F0                MOVX     @DPTR,A
005D25         ?C0151?ZW_PHY_RF_050X:
005D25 904027            MOV      DPTR,#success
005D28 7401              MOV      A,#01H
005D2A F0                MOVX     @DPTR,A
005D2B C232              CLR      rf_inconsistency
005D2D D186              ACALL    ?L?COM035D
005D2F         ?C0152?ZW_PHY_RF_050X:
005D2F B112              ACALL    phy_timer_runs
005D31 5005              JNC      ?C0153?ZW_PHY_RF_050X
005D33 E5FC              MOV      A,SEQCON
005D35 20E6F7            JB       ACC.6,?C0152?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 119


005D38         ?C0153?ZW_PHY_RF_050X:
005D38 D154              ACALL    RF_mode_get
005D3A BF0108            CJNE     R7,#01H,?C0156?ZW_PHY_RF_050X
005D3D E4                CLR      A
005D3E F5FC              MOV      SEQCON,A
005D40 75FC40            MOV      SEQCON,#040H
005D43 8007              SJMP     ?C0157?ZW_PHY_RF_050X
005D45         ?C0156?ZW_PHY_RF_050X:
005D45 D154              ACALL    RF_mode_get
005D47 BF0202            CJNE     R7,#02H,?C0157?ZW_PHY_RF_050X
005D4A D3                SETB     C
005D4B 22                RET      
005D4C         ?C0157?ZW_PHY_RF_050X:
005D4C F14C              ACALL    ?L?COM056F
005D4E 904022            MOV      DPTR,#speed
005D51 E0                MOVX     A,@DPTR
005D52 FF                MOV      R7,A
005D53 126B17            LCALL    _RF_TX_speed_set
005D56 75FF01            MOV      SFRPAGE,#01H
005D59 53D5DF            ANL      RFCON,#0DFH
005D5C 53FAFB            ANL      MODCTRL,#0FBH
005D5F 904021            MOV      DPTR,#chsel
005D62 E0                MOVX     A,@DPTR
005D63 FF                MOV      R7,A
005D64 3185              ACALL    _RF_channel_set
005D66 904022            MOV      DPTR,#speed
005D69 E0                MOVX     A,@DPTR
005D6A 904021            MOV      DPTR,#chsel
005D6D B40811            CJNE     A,#08H,?C0160?ZW_PHY_RF_050X
005D70 E0                MOVX     A,@DPTR
005D71 124F5B            LCALL    ?L?COM028E
005D74 F583              MOV      DPH,A
005D76 127206            LCALL    ?L?COM03A1
005D79 2452              ADD      A,#052H
005D7B 1249DE            LCALL    ?L?COM0075
005D7E FC                MOV      R4,A
005D7F 8004              SJMP     ?C0308?ZW_PHY_RF_050X
005D81         ?C0160?ZW_PHY_RF_050X:
005D81 E0                MOVX     A,@DPTR
005D82 124B9F            LCALL    ?L?COM003A
005D85         
005D85 124F83            LCALL    __set_fcw
005D88         ?C0161?ZW_PHY_RF_050X:
005D88 904023            MOV      DPTR,#rfpower
005D8B E0                MOVX     A,@DPTR
005D8C FF                MOV      R7,A
005D8D 126B70            LCALL    _RF_TX_power_set
005D90 75FF01            MOV      SFRPAGE,#01H
005D93 75FF03            MOV      SFRPAGE,#03H
005D96 759B04            MOV      SEQCON5,#04H
005D99 D186              ACALL    ?L?COM035D
005D9B         ?C0164?ZW_PHY_RF_050X:
005D9B 75FC42            MOV      SEQCON,#042H
005D9E E5FC              MOV      A,SEQCON
005DA0 20E104            JB       ACC.1,?C0163?ZW_PHY_RF_050X
005DA3 B112              ACALL    phy_timer_runs
005DA5 40F4              JC       ?C0164?ZW_PHY_RF_050X
005DA7         ?C0163?ZW_PHY_RF_050X:
005DA7 904024            MOV      DPTR,#highdco
005DAA E0                MOVX     A,@DPTR
005DAB F0                MOVX     @DPTR,A
005DAC         ?C0168?ZW_PHY_RF_050X:
005DAC 75FF03            MOV      SFRPAGE,#03H
005DAF E59B              MOV      A,SEQCON5
005DB1 20E704            JB       ACC.7,?C0167?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 120


005DB4 B112              ACALL    phy_timer_runs
005DB6 40F4              JC       ?C0168?ZW_PHY_RF_050X
005DB8         ?C0167?ZW_PHY_RF_050X:
005DB8 E59B              MOV      A,SEQCON5
005DBA 20E70D            JB       ACC.7,?C0170?ZW_PHY_RF_050X
005DBD 75FF03            MOV      SFRPAGE,#03H
005DC0 759B1F            MOV      SEQCON5,#01FH
005DC3 124F67            LCALL    RF_shutdown
005DC6 D232              SETB     rf_inconsistency
005DC8 804E              SJMP     ?C0171?ZW_PHY_RF_050X
005DCA         ?C0170?ZW_PHY_RF_050X:
005DCA D12C              ACALL    ?L?COM0571
005DCC 1262FC            LCALL    __RF_check_checksum
005DCF 904022            MOV      DPTR,#speed
005DD2 E0                MOVX     A,@DPTR
005DD3 FD                MOV      R5,A
005DD4 90120F            MOV      DPTR,#phyRfData+0EH
005DD7 E0                MOVX     A,@DPTR
005DD8 5D                ANL      A,R5
005DD9 701D              JNZ      ?C0172?ZW_PHY_RF_050X
005DDB 904021            MOV      DPTR,#chsel
005DDE E0                MOVX     A,@DPTR
005DDF FF                MOV      R7,A
005DE0 D12C              ACALL    ?L?COM0571
005DE2 126974            LCALL    __set_separation_TX
005DE5 90120F            MOV      DPTR,#phyRfData+0EH
005DE8 E0                MOVX     A,@DPTR
005DE9 FF                MOV      R7,A
005DEA 904022            MOV      DPTR,#speed
005DED E0                MOVX     A,@DPTR
005DEE FE                MOV      R6,A
005DEF EF                MOV      A,R7
005DF0 4E                ORL      A,R6
005DF1 90120F            MOV      DPTR,#phyRfData+0EH
005DF4 F0                MOVX     @DPTR,A
005DF5 124CE1            LCALL    _RF_generate_checksum
005DF8         ?C0172?ZW_PHY_RF_050X:
005DF8 F18D              ACALL    _PLL_boost_bias
005DFA         ?C0173?ZW_PHY_RF_050X:
005DFA 7B01              MOV      R3,#01H
005DFC 7A40              MOV      R2,#HIGH timer_mark
005DFE 7925              MOV      R1,#LOW timer_mark
005E00 D1C1              ACALL    _get_phy_timer
005E02 500F              JNC      ?C0174?ZW_PHY_RF_050X
005E04 C3                CLR      C
005E05 904026            MOV      DPTR,#timer_mark+01H
005E08 E0                MOVX     A,@DPTR
005E09 9420              SUBB     A,#020H
005E0B 904025            MOV      DPTR,#timer_mark
005E0E E0                MOVX     A,@DPTR
005E0F 9403              SUBB     A,#03H
005E11 40E7              JC       ?C0173?ZW_PHY_RF_050X
005E13         ?C0174?ZW_PHY_RF_050X:
005E13 D12C              ACALL    ?L?COM0571
005E15 1263ED            LCALL    __PLL_wait_lock_and_sequencer_done
005E18         ?C0171?ZW_PHY_RF_050X:
005E18 124F24            LCALL    wait_phy_timer_timeout
005E1B 303202            JNB      rf_inconsistency,$ + 5H
005E1E A125              AJMP     ?C0151?ZW_PHY_RF_050X
005E20 904027            MOV      DPTR,#success
005E23 E0                MOVX     A,@DPTR
005E24 B40103            CJNE     A,#01H,?C0175?ZW_PHY_RF_050X
005E27 D3                SETB     C
005E28 8001              SJMP     ?C0176?ZW_PHY_RF_050X
005E2A         ?C0175?ZW_PHY_RF_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 121


005E2A C3                CLR      C
005E2B         ?C0176?ZW_PHY_RF_050X:
005E2B 22                RET      
----- FUNCTION _RF_switch_to_TX (END) -------


----- FUNCTION ?L?COM0571 (BEGIN) -----
005E2C 7B01              MOV      R3,#01H
005E2E 7A40              MOV      R2,#HIGH success
005E30 7927              MOV      R1,#LOW success
005E32 22                RET      
----- FUNCTION ?L?COM0571 (END) -------


----- FUNCTION RF_demodulator_enable_fast (BEGIN) -----
;---- Variable 'setting' assigned to Register 'R7' ----
005E33 AFF4              MOV      R7,DMCTRL
005E35 EF                MOV      A,R7
005E36 547F              ANL      A,#07FH
005E38 F5F4              MOV      DMCTRL,A
005E3A 303405            JNB      enable,?C0205?ZW_PHY_RF_050X
005E3D EF                MOV      A,R7
005E3E 4480              ORL      A,#080H
005E40 F5F4              MOV      DMCTRL,A
005E42         ?C0205?ZW_PHY_RF_050X:
005E42 75FF01            MOV      SFRPAGE,#01H
005E45 E5D5              MOV      A,RFCON
005E47 20E702            JB       ACC.7,?C0206?ZW_PHY_RF_050X
005E4A C3                CLR      C
005E4B 22                RET      
005E4C         ?C0206?ZW_PHY_RF_050X:
005E4C E5F4              MOV      A,DMCTRL
005E4E D3                SETB     C
005E4F 30E601            JNB      ACC.6,?C0208?ZW_PHY_RF_050X
005E52 C3                CLR      C
005E53         ?C0208?ZW_PHY_RF_050X:
005E53 22                RET      
----- FUNCTION RF_demodulator_enable_fast (END) -------


----- FUNCTION RF_mode_get (BEGIN) -----
005E54 7FFA              MOV      R7,#0FAH
005E56 124EF5            LCALL    ?L?COM0124
005E59         ?C0212?ZW_PHY_RF_050X:
005E59 E5FC              MOV      A,SEQCON
005E5B 30E604            JNB      ACC.6,?C0213?ZW_PHY_RF_050X
005E5E B112              ACALL    phy_timer_runs
005E60 40F7              JC       ?C0212?ZW_PHY_RF_050X
005E62         ?C0213?ZW_PHY_RF_050X:
005E62 E5FC              MOV      A,SEQCON
005E64 30E603            JNB      ACC.6,?C0216?ZW_PHY_RF_050X
005E67 7F03              MOV      R7,#03H
005E69 22                RET      
005E6A         ?C0216?ZW_PHY_RF_050X:
005E6A 75FF01            MOV      SFRPAGE,#01H
005E6D E5D5              MOV      A,RFCON
005E6F 30E603            JNB      ACC.6,?C0219?ZW_PHY_RF_050X
005E72 7F02              MOV      R7,#02H
005E74 22                RET      
005E75         ?C0219?ZW_PHY_RF_050X:
005E75 E5D5              MOV      A,RFCON
005E77 7F00              MOV      R7,#00H
005E79 30E702            JNB      ACC.7,?C0221?ZW_PHY_RF_050X
005E7C 7F01              MOV      R7,#01H
005E7E         ?C0221?ZW_PHY_RF_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 122


005E7E 22                RET      
----- FUNCTION RF_mode_get (END) -------


----- FUNCTION _rssi_rdy (BEGIN) -----
005E7F 75FF01            MOV      SFRPAGE,#01H
005E82 E5E4              MOV      A,SDCON1
005E84 33                RLC      A
005E85 22                RET      
----- FUNCTION _rssi_rdy (END) -------


----- FUNCTION ?L?COM035D (BEGIN) -----
005E86 7FE8              MOV      R7,#0E8H
005E88 7E03              MOV      R6,#03H
005E8A         ?L?COM035E:
005E8A D18F              ACALL    _set_phy_timer_timeout_max
005E8C 024EF9            LJMP     start_phy_timer
----- FUNCTION ?L?COM035D (END) -------


----- FUNCTION _set_phy_timer_timeout_max (BEGIN) -----
005E8F 9041F3            MOV      DPTR,#timeout
005E92 EE                MOV      A,R6
005E93 F0                MOVX     @DPTR,A
005E94 A3                INC      DPTR
005E95 EF                MOV      A,R7
005E96 F0                MOVX     @DPTR,A
005E97 7B01              MOV      R3,#01H
005E99 7A41              MOV      R2,#HIGH temp_timer
005E9B 79F5              MOV      R1,#LOW temp_timer
005E9D D1C1              ACALL    _get_phy_timer
005E9F 5014              JNC      ?C0006?ZW_PHY_RF_050X
005EA1 9041F5            MOV      DPTR,#temp_timer
005EA4 E0                MOVX     A,@DPTR
005EA5 FE                MOV      R6,A
005EA6 A3                INC      DPTR
005EA7 E0                MOVX     A,@DPTR
005EA8 FF                MOV      R7,A
005EA9 9041F4            MOV      DPTR,#timeout+01H
005EAC E0                MOVX     A,@DPTR
005EAD 9F                SUBB     A,R7
005EAE 9041F3            MOV      DPTR,#timeout
005EB1 E0                MOVX     A,@DPTR
005EB2 9E                SUBB     A,R6
005EB3 400B              JC       ?C0007?ZW_PHY_RF_050X
005EB5         ?C0006?ZW_PHY_RF_050X:
005EB5 9041F3            MOV      DPTR,#timeout
005EB8 E0                MOVX     A,@DPTR
005EB9 FE                MOV      R6,A
005EBA A3                INC      DPTR
005EBB E0                MOVX     A,@DPTR
005EBC FF                MOV      R7,A
005EBD 124F00            LCALL    _set_phy_timer_timeout
005EC0         ?C0007?ZW_PHY_RF_050X:
005EC0 22                RET      
----- FUNCTION _set_phy_timer_timeout_max (END) -------


----- FUNCTION _get_phy_timer (BEGIN) -----
;---- Variable 'timer_value' assigned to Register 'R1/R2/R3' ----
005EC1 F15F              ACALL    ?L?COM03CF
005EC3 AD94              MOV      R5,PHYTSL
005EC5 EF                MOV      A,R7
005EC6 4D                ORL      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 123


005EC7 F1EC              ACALL    ?L?COM0638
005EC9 8FF0              MOV      B,R7
005ECB 12221F            LCALL    ?C?ISTPTR
005ECE E591              MOV      A,PHYTCON1
005ED0 C3                CLR      C
005ED1 30E701            JNB      ACC.7,?C0011?ZW_PHY_RF_050X
005ED4 D3                SETB     C
005ED5         ?C0011?ZW_PHY_RF_050X:
005ED5 22                RET      
----- FUNCTION _get_phy_timer (END) -------


----- FUNCTION RF_instant_rssi_get (BEGIN) -----
;---- Variable 'temp' assigned to Register 'R7' ----
005ED6 E4                CLR      A
005ED7 FF                MOV      R7,A
005ED8 E5F7              MOV      A,DMSTAT1
005EDA 54C0              ANL      A,#0C0H
005EDC 6002              JZ       ?C0235?ZW_PHY_RF_050X
005EDE 8016              SJMP     _instant_rssi
005EE0         ?C0235?ZW_PHY_RF_050X:
005EE0 75FF01            MOV      SFRPAGE,#01H
005EE3 E5D5              MOV      A,RFCON
005EE5 30E30D            JNB      ACC.3,?C0232?ZW_PHY_RF_050X
005EE8 D17F              ACALL    _rssi_rdy
005EEA 50F4              JNC      ?C0235?ZW_PHY_RF_050X
005EEC D1F6              ACALL    _instant_rssi
005EEE EF                MOV      A,R7
005EEF 60EF              JZ       ?C0235?ZW_PHY_RF_050X
005EF1 D17F              ACALL    _rssi_rdy
005EF3 50EB              JNC      ?C0235?ZW_PHY_RF_050X
005EF5         ?C0232?ZW_PHY_RF_050X:
005EF5 22                RET      
----- FUNCTION RF_instant_rssi_get (END) -------


----- FUNCTION _instant_rssi (BEGIN) -----
005EF6 1263D5            LCALL    ?L?COM056E
005EF9 AFD9              MOV      R7,DFSTAT
005EFB 22                RET      
----- FUNCTION _instant_rssi (END) -------


----- FUNCTION _RF_setup_tx_mode (BEGIN) -----
;---- Variable 'power' assigned to Register 'R7' ----
005EFC 900ADD            MOV      DPTR,#txPwr
005EFF EF                MOV      A,R7
005F00 F0                MOVX     @DPTR,A
005F01 9006B0            MOV      DPTR,#rfTxCurrentSpeed
005F04 E0                MOVX     A,@DPTR
005F05 FF                MOV      R7,A
005F06 12603E            LCALL    _Speed2Channel
005F09 900ADE            MOV      DPTR,#txCh
005F0C EF                MOV      A,R7
005F0D F0                MOVX     @DPTR,A
005F0E 9006B0            MOV      DPTR,#rfTxCurrentSpeed
005F11 E0                MOVX     A,@DPTR
005F12 24FD              ADD      A,#0FDH
005F14 6013              JZ       ?C0050?ZW_RF_DRIVER
005F16 04                INC      A
005F17 7008              JNZ      ?C0049?ZW_RF_DRIVER
005F19         ?C0047?ZW_RF_DRIVER:
005F19 900ADC            MOV      DPTR,#rfTxCurrentSpeedLocal
005F1C 7404              MOV      A,#04H
005F1E F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 124


005F1F 800E              SJMP     ?C0046?ZW_RF_DRIVER
005F21         ?C0049?ZW_RF_DRIVER:
005F21 900ADC            MOV      DPTR,#rfTxCurrentSpeedLocal
005F24 7408              MOV      A,#08H
005F26 F0                MOVX     @DPTR,A
005F27 8006              SJMP     ?C0046?ZW_RF_DRIVER
005F29         ?C0050?ZW_RF_DRIVER:
005F29 900ADC            MOV      DPTR,#rfTxCurrentSpeedLocal
005F2C 7402              MOV      A,#02H
005F2E F0                MOVX     @DPTR,A
005F2F         ?C0046?ZW_RF_DRIVER:
005F2F 7F01              MOV      R7,#01H
005F31 121DD6            LCALL    ?INTERBANK_TABLE?_ApplicationRfNotify
005F34         ?C0051?ZW_RF_DRIVER:
005F34 900ADE            MOV      DPTR,#txCh
005F37 E0                MOVX     A,@DPTR
005F38 FF                MOV      R7,A
005F39 900ADC            MOV      DPTR,#rfTxCurrentSpeedLocal
005F3C E0                MOVX     A,@DPTR
005F3D FD                MOV      R5,A
005F3E A3                INC      DPTR
005F3F E0                MOVX     A,@DPTR
005F40 FB                MOV      R3,A
005F41 E4                CLR      A
005F42 904024            MOV      DPTR,#?_RF_switch_to_TX?BYTE+03H
005F45 F0                MOVX     @DPTR,A
005F46 B11D              ACALL    _RF_switch_to_TX
005F48 50EA              JNC      ?C0051?ZW_RF_DRIVER
005F4A         ?C0052?ZW_RF_DRIVER:
005F4A D3                SETB     C
005F4B 22                RET      
----- FUNCTION _RF_setup_tx_mode (END) -------


----- FUNCTION ?L?COM056F (BEGIN) -----
005F4C 75FF01            MOV      SFRPAGE,#01H
005F4F 53D8EF            ANL      DFCON2,#0EFH
005F52 22                RET      
----- FUNCTION ?L?COM056F (END) -------


----- FUNCTION ?L?COM02F2 (BEGIN) -----
005F53 E4                CLR      A
005F54 F5FF              MOV      SFRPAGE,A
005F56         ?L?COM02F3:
005F56 E5D1              MOV      A,FHCON1
005F58 54FE              ANL      A,#0FEH
005F5A 4402              ORL      A,#02H
005F5C F5D1              MOV      FHCON1,A
005F5E 22                RET      
----- FUNCTION ?L?COM02F2 (END) -------


----- FUNCTION ?L?COM03CF (BEGIN) -----
005F5F 75FF03            MOV      SFRPAGE,#03H
005F62         ?L?COM03D0:
005F62 AF93              MOV      R7,PHYTSH
005F64 EF                MOV      A,R7
005F65 75F010            MOV      B,#010H
005F68 A4                MUL      AB
005F69 FF                MOV      R7,A
005F6A 22                RET      
----- FUNCTION ?L?COM03CF (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 125


----- FUNCTION ?L?COM04BC (BEGIN) -----
005F6B E512              MOV      A,RF_data_addr+01H
005F6D 2407              ADD      A,#07H
005F6F F582              MOV      DPL,A
005F71 E4                CLR      A
005F72 3511              ADDC     A,RF_data_addr
005F74 F583              MOV      DPH,A
005F76 22                RET      
----- FUNCTION ?L?COM04BC (END) -------


----- FUNCTION _wait_until_no_preamble (BEGIN) -----
005F77         ?C0282?ZW_PHY_RF_050X:
005F77 E5F7              MOV      A,DMSTAT1
005F79 30E50F            JNB      ACC.5,?C0283?ZW_PHY_RF_050X
005F7C E5F7              MOV      A,DMSTAT1
005F7E 54C0              ANL      A,#0C0H
005F80 7004              JNZ      ?C0285?ZW_PHY_RF_050X
005F82 B112              ACALL    phy_timer_runs
005F84 40F1              JC       ?C0282?ZW_PHY_RF_050X
005F86         ?C0285?ZW_PHY_RF_050X:
005F86 124FBF            LCALL    stop_phy_timer
005F89 C3                CLR      C
005F8A 22                RET      
005F8B         ?C0283?ZW_PHY_RF_050X:
005F8B D3                SETB     C
005F8C 22                RET      
----- FUNCTION _wait_until_no_preamble (END) -------


----- FUNCTION _PLL_boost_bias (BEGIN) -----
005F8D E4                CLR      A
005F8E F5FF              MOV      SFRPAGE,A
005F90 75C2E1            MOV      DPLLNRM4,#0E1H
005F93 7F1E              MOV      R7,#01EH
005F95 1263CC            LCALL    ?L?COM05C0
005F98 30E707            JNB      ACC.7,?C0031?ZW_PHY_RF_050X
005F9B E4                CLR      A
005F9C F5FF              MOV      SFRPAGE,A
005F9E 75C2A1            MOV      DPLLNRM4,#0A1H
005FA1 22                RET      
005FA2         ?C0031?ZW_PHY_RF_050X:
005FA2 E4                CLR      A
005FA3 F5FF              MOV      SFRPAGE,A
005FA5 75C281            MOV      DPLLNRM4,#081H
005FA8 22                RET      
----- FUNCTION _PLL_boost_bias (END) -------


----- FUNCTION _wait_phy_timer_elapse (BEGIN) -----
;---- Variable 'time_elapse' assigned to Register 'R4/R5' ----
005FA9 CD                XCH      A,R5
005FAA EF                MOV      A,R7
005FAB CD                XCH      A,R5
005FAC CC                XCH      A,R4
005FAD EE                MOV      A,R6
005FAE CC                XCH      A,R4
005FAF F15F              ACALL    ?L?COM03CF
005FB1 AB94              MOV      R3,PHYTSL
005FB3 EF                MOV      A,R7
005FB4 4B                ORL      A,R3
005FB5 F1EC              ACALL    ?L?COM0638
;---- Variable 'time_now' assigned to Register 'R2/R3' ----
005FB7 CB                XCH      A,R3
005FB8 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 126


005FB9 CB                XCH      A,R3
005FBA FA                MOV      R2,A
005FBB         ?C0014?ZW_PHY_RF_050X:
005FBB E591              MOV      A,PHYTCON1
005FBD 30E71D            JNB      ACC.7,?C0015?ZW_PHY_RF_050X
005FC0 F162              ACALL    ?L?COM03D0
005FC2 A994              MOV      R1,PHYTSL
005FC4 E9                MOV      A,R1
005FC5 F582              MOV      DPL,A
005FC7 EF                MOV      A,R7
005FC8 4582              ORL      A,DPL
005FCA FF                MOV      R7,A
005FCB EB                MOV      A,R3
005FCC 2D                ADD      A,R5
005FCD F582              MOV      DPL,A
005FCF EA                MOV      A,R2
005FD0 3C                ADDC     A,R4
005FD1 F583              MOV      DPH,A
005FD3 C3                CLR      C
005FD4 EF                MOV      A,R7
005FD5 9582              SUBB     A,DPL
005FD7 E5F0              MOV      A,B
005FD9 9583              SUBB     A,DPH
005FDB 40DE              JC       ?C0014?ZW_PHY_RF_050X
005FDD         ?C0015?ZW_PHY_RF_050X:
005FDD E591              MOV      A,PHYTCON1
005FDF 20E709            JB       ACC.7,?C0017?ZW_PHY_RF_050X
005FE2 CE                XCH      A,R6
005FE3 EC                MOV      A,R4
005FE4 CE                XCH      A,R6
005FE5 CF                XCH      A,R7
005FE6 ED                MOV      A,R5
005FE7 CF                XCH      A,R7
005FE8 124F20            LCALL    ?L?COM0326
005FEB         ?C0017?ZW_PHY_RF_050X:
005FEB 22                RET      
----- FUNCTION _wait_phy_timer_elapse (END) -------


----- FUNCTION ?L?COM0638 (BEGIN) -----
005FEC 24FB              ADD      A,#0FBH
005FEE FF                MOV      R7,A
005FEF E5F0              MOV      A,B
005FF1 34FF              ADDC     A,#0FFH
005FF3 22                RET      
----- FUNCTION ?L?COM0638 (END) -------


----- FUNCTION _ZW_SetDefaultPowerLevels (BEGIN) -----
;---- Variable 'bNormalPower0' assigned to Register 'R7' ----
005FF4 9003C9            MOV      DPTR,#bStartupState
005FF7 E0                MOVX     A,@DPTR
005FF8 B4020D            CJNE     A,#02H,?C0026?ZW_RF_DRIVER
005FFB 8F1B              MOV      normal_PA_POW,R7
005FFD 900A8C            MOV      DPTR,#bLowPower0
006000 E0                MOVX     A,@DPTR
006001 F513              MOV      low_PA_POW,A
006003 121A2A            LCALL    ?INTERBANK_TABLE?_RFDriverPowerToIndex
006006 D3                SETB     C
006007 22                RET      
006008         ?C0026?ZW_RF_DRIVER:
006008 C3                CLR      C
006009 22                RET      
----- FUNCTION _ZW_SetDefaultPowerLevels (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 127



----- FUNCTION _RFPowerGetTxPwrReg_100 (BEGIN) -----
;---- Variable 'powerLevel' assigned to Register 'R7' ----
00600A E517              MOV      A,powerIndex
00600C 54F0              ANL      A,#0F0H
00600E C4                SWAP     A
00600F 540F              ANL      A,#0FH
006011 2F                ADD      A,R7
006012 FF                MOV      R7,A
;---- Variable 'i' assigned to Register 'R7' ----
006013 C3                CLR      C
006014 9410              SUBB     A,#010H
006016 4002              JC       ?C0032?ZW_RF_DRIVER
006018 7F0F              MOV      R7,#0FH
00601A         ?C0032?ZW_RF_DRIVER:
00601A EF                MOV      A,R7
00601B 90317C            MOV      DPTR,#rf_power_table_100
00601E 93                MOVC     A,@A+DPTR
00601F FF                MOV      R7,A
006020 22                RET      
----- FUNCTION _RFPowerGetTxPwrReg_100 (END) -------


----- FUNCTION _RFPowerConvert (BEGIN) -----
;---- Variable 'power' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
006021 7E10              MOV      R6,#010H
006023         ?C0036?ZW_RF_DRIVER:
006023 EE                MOV      A,R6
006024 6009              JZ       ?C0037?ZW_RF_DRIVER
006026 1E                DEC      R6
006027 EE                MOV      A,R6
006028 90317C            MOV      DPTR,#rf_power_table_100
00602B 93                MOVC     A,@A+DPTR
00602C B507F4            CJNE     A,AR7,?C0036?ZW_RF_DRIVER
00602F         ?C0037?ZW_RF_DRIVER:
00602F EE                MOV      A,R6
006030 C3                CLR      C
006031 940E              SUBB     A,#0EH
006033 4002              JC       ?C0038?ZW_RF_DRIVER
006035 7E0D              MOV      R6,#0DH
006037         ?C0038?ZW_RF_DRIVER:
006037 EE                MOV      A,R6
006038 90316E            MOV      DPTR,#rf_power_table
00603B 93                MOVC     A,@A+DPTR
00603C FF                MOV      R7,A
00603D 22                RET      
----- FUNCTION _RFPowerConvert (END) -------


----- FUNCTION _Speed2Channel (BEGIN) -----
;---- Variable 'txCh' assigned to Register 'R6' ----
;---- Variable 'bSpeed' assigned to Register 'R7' ----
00603E EF                MOV      A,R7
00603F 24FD              ADD      A,#0FDH
006041 6006              JZ       ?C0044?ZW_RF_DRIVER
006043 8000              SJMP     ?C0043?ZW_RF_DRIVER
006045         ?C0043?ZW_RF_DRIVER:
006045 7E01              MOV      R6,#01H
006047 8002              SJMP     ?C0040?ZW_RF_DRIVER
006049         ?C0044?ZW_RF_DRIVER:
006049 E4                CLR      A
00604A FE                MOV      R6,A
00604B         ?C0040?ZW_RF_DRIVER:
00604B AF06              MOV      R7,AR6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 128


00604D 22                RET      
----- FUNCTION _Speed2Channel (END) -------


----- FUNCTION RFPowerDownForce (BEGIN) -----
00604E E4                CLR      A
00604F F514              MOV      RF_state,A
006051 023712            LJMP     RFPowerDown
----- FUNCTION RFPowerDownForce (END) -------


----- FUNCTION _RFSetStatus (BEGIN) -----
;---- Variable 'bitMask' assigned to Register 'R7' ----
006054 C2AF              CLR      EA
006056 EF                MOV      A,R7
006057 4215              ORL      RF_status,A
006059 D2AF              SETB     EA
00605B 22                RET      
----- FUNCTION _RFSetStatus (END) -------


----- FUNCTION _ConvertPhySpeedToRFSpeed (BEGIN) -----
;---- Variable 'bInSpeed' assigned to Register 'R7' ----
00605C EF                MOV      A,R7
00605D 24FE              ADD      A,#0FEH
00605F 600C              JZ       ?C0095?ZW_RF_DRIVER
006061 24FE              ADD      A,#0FEH
006063 6005              JZ       ?C0094?ZW_RF_DRIVER
006065 8000              SJMP     ?C0092?ZW_RF_DRIVER
006067         ?C0092?ZW_RF_DRIVER:
006067 7F01              MOV      R7,#01H
006069 22                RET      
00606A         ?C0094?ZW_RF_DRIVER:
00606A 7F02              MOV      R7,#02H
00606C 22                RET      
00606D         ?C0095?ZW_RF_DRIVER:
00606D 7F03              MOV      R7,#03H
00606F 22                RET      
----- FUNCTION _ConvertPhySpeedToRFSpeed (END) -------


----- FUNCTION _RFSetupBeamFragmentTX (BEGIN) -----
;---- Variable 'RF_Options' assigned to Register 'R4/R5' ----
;---- Variable 'bBeamAddress' assigned to Register 'R7' ----
006070 751401            MOV      RF_state,#01H
006073 751A13            MOV      RF_num,#013H
006076 9006C2            MOV      DPTR,#bBeamDestAddress
006079 EF                MOV      A,R7
00607A F0                MOVX     @DPTR,A
00607B 9006B0            MOV      DPTR,#rfTxCurrentSpeed
00607E 7402              MOV      A,#02H
006080 F0                MOVX     @DPTR,A
006081 ED                MOV      A,R5
006082 9006D1            MOV      DPTR,#RF_BeamCount
006085 30E507            JNB      ACC.5,?C0096?ZW_RF_DRIVER
006088 E4                CLR      A
006089 F0                MOVX     @DPTR,A
00608A A3                INC      DPTR
00608B 743A              MOV      A,#03AH
00608D F0                MOVX     @DPTR,A
00608E 22                RET      
00608F         ?C0096?ZW_RF_DRIVER:
00608F E4                CLR      A
006090 F0                MOVX     @DPTR,A
006091 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 129


006092 74E6              MOV      A,#0E6H
006094 F0                MOVX     @DPTR,A
006095 22                RET      
----- FUNCTION _RFSetupBeamFragmentTX (END) -------


----- FUNCTION NS_IncLBTBackOffs (BEGIN) -----
006096 C3                CLR      C
006097 9006B8            MOV      DPTR,#sRFStats+03H
00609A E0                MOVX     A,@DPTR
00609B 94FF              SUBB     A,#0FFH
00609D 9006B7            MOV      DPTR,#sRFStats+02H
0060A0 E0                MOVX     A,@DPTR
0060A1 94FF              SUBB     A,#0FFH
0060A3 5003              JNC      ?C0106?ZW_RF_DRIVER
0060A5 123F7F            LCALL    ?L?COM0081
0060A8         ?C0106?ZW_RF_DRIVER:
0060A8 22                RET      
----- FUNCTION NS_IncLBTBackOffs (END) -------


----- FUNCTION RF_EnableFLiRSBroadcast (BEGIN) -----
0060A9 901215            MOV      DPTR,#bFLiRSStatus
0060AC E0                MOVX     A,@DPTR
0060AD 302804            JNB      bEnable,?C0216?ZW_RF_DRIVER
0060B0 4402              ORL      A,#02H
0060B2 F0                MOVX     @DPTR,A
0060B3 22                RET      
0060B4         ?C0216?ZW_RF_DRIVER:
0060B4 54FD              ANL      A,#0FDH
0060B6 F0                MOVX     @DPTR,A
0060B7 22                RET      
----- FUNCTION RF_EnableFLiRSBroadcast (END) -------


----- FUNCTION RF_GetBeamcount (BEGIN) -----
0060B8 9006D1            MOV      DPTR,#RF_BeamCount
0060BB E0                MOVX     A,@DPTR
0060BC A3                INC      DPTR
0060BD E0                MOVX     A,@DPTR
0060BE FF                MOV      R7,A
0060BF 22                RET      
----- FUNCTION RF_GetBeamcount (END) -------


----- FUNCTION _ZW_GetRandomWord (BEGIN) -----
;---- Variable 'randomWord' assigned to Register 'R1/R2/R3' ----
0060C0 7D02              MOV      R5,#02H
0060C2 123780            LCALL    _ZW_GetRandomArray
0060C5 EF                MOV      A,R7
0060C6 C3                CLR      C
0060C7 6001              JZ       ?C0227?ZW_RF_DRIVER
0060C9 D3                SETB     C
0060CA         ?C0227?ZW_RF_DRIVER:
0060CA 22                RET      
----- FUNCTION _ZW_GetRandomWord (END) -------


----- FUNCTION ZW_ClearTxTimers (BEGIN) -----
0060CB E4                CLR      A
0060CC 9006C3            MOV      DPTR,#awTxTimeChannels
0060CF 11E0              ACALL    ?L?COM057E
0060D1 9006C7            MOV      DPTR,#awTxTimeChannels+04H
0060D4 11E0              ACALL    ?L?COM057E
0060D6 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 130


0060D7 FE                MOV      R6,A
0060D8 FD                MOV      R5,A
0060D9 FC                MOV      R4,A
0060DA 9006CB            MOV      DPTR,#awTxTimeChannels+08H
0060DD 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION ZW_ClearTxTimers (END) -------


----- FUNCTION ?L?COM057E (BEGIN) -----
0060E0 FF                MOV      R7,A
0060E1 FE                MOV      R6,A
0060E2 FD                MOV      R5,A
0060E3 FC                MOV      R4,A
0060E4 1224F1            LCALL    ?C?LSTXDATA
0060E7 E4                CLR      A
0060E8 22                RET      
----- FUNCTION ?L?COM057E (END) -------


----- FUNCTION _ZW_GetTxTimer (BEGIN) -----
;---- Variable 'dwValue' assigned to Register 'R1/R2/R3' ----
;---- Variable 'bChannel' assigned to Register 'R7' ----
0060E9 EF                MOV      A,R7
0060EA 11F2              ACALL    ?L?COM0437
0060EC 122499            LCALL    ?C?LLDXDATA
0060EF 02245B            LJMP     ?C?LSTPTR
----- FUNCTION _ZW_GetTxTimer (END) -------


----- FUNCTION ?L?COM0437 (BEGIN) -----
0060F2 25E0              ADD      A,ACC
0060F4 25E0              ADD      A,ACC
0060F6 24C3              ADD      A,#LOW awTxTimeChannels
0060F8 F582              MOV      DPL,A
0060FA E4                CLR      A
0060FB 3406              ADDC     A,#HIGH awTxTimeChannels
0060FD F583              MOV      DPH,A
0060FF 22                RET      
----- FUNCTION ?L?COM0437 (END) -------


----- FUNCTION ZW_ClearNetworkStats (BEGIN) -----
006100 A2EB              MOV      C,ERF
006102 9229              MOV      tmpERF,C
006104 C2EB              CLR      ERF
006106 7A06              MOV      R2,#HIGH sRFStats
006108 79B5              MOV      R1,#LOW sRFStats
00610A 7B01              MOV      R3,#01H
00610C 7D0C              MOV      R5,#0CH
00610E E4                CLR      A
00610F FF                MOV      R7,A
006110 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
006113 A229              MOV      C,tmpERF
006115 92EB              MOV      ERF,C
006117 22                RET      
----- FUNCTION ZW_ClearNetworkStats (END) -------


----- FUNCTION _ZW_GetNetworkStats (BEGIN) -----
;---- Variable 'sNetworkStats' assigned to Register 'R1/R2/R3' ----
006118 A2EB              MOV      C,ERF
00611A 922A              MOV      tmpERF,C
00611C C2EB              CLR      ERF
00611E EB                MOV      A,R3
00611F C0E0              PUSH     ACC
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 131


006121 EA                MOV      A,R2
006122 C0E0              PUSH     ACC
006124 E9                MOV      A,R1
006125 C0E0              PUSH     ACC
006127 7B01              MOV      R3,#01H
006129 7A06              MOV      R2,#HIGH sRFStats
00612B 79B5              MOV      R1,#LOW sRFStats
00612D 3149              ACALL    ?L?COM0047
00612F D0E0              POP      ACC
006131 F9                MOV      R1,A
006132 D0E0              POP      ACC
006134 FA                MOV      R2,A
006135 D0E0              POP      ACC
006137 FB                MOV      R3,A
006138 7F0C              MOV      R7,#0CH
00613A 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
00613D A22A              MOV      C,tmpERF
00613F 92EB              MOV      ERF,C
006141 22                RET      
----- FUNCTION _ZW_GetNetworkStats (END) -------


----- FUNCTION ?L?COM0044 (BEGIN) -----
006142 E9                MOV      A,R1
006143 2401              ADD      A,#01H
006145         ?L?COM0045:
006145 F9                MOV      R1,A
006146 E4                CLR      A
006147 3A                ADDC     A,R2
006148         ?L?COM0046:
006148 FA                MOV      R2,A
006149         ?L?COM0047:
006149 90405D            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
00614C 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0044 (END) -------


----- FUNCTION _ZW_test_interface_driver_getData (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE_DRIVER.C'
  216: BOOL ZW_test_interface_driver_getData(BYTE * pData, BYTE * pLength)
  217: {
00614F 900A82            MOV      DPTR,#pData
006152 1225A9            LCALL    ?C?PSTXDATA
  218:   BOOL fStatus = FALSE;
  219:   ZDB_ES = 0; // Disable interrupt
006155 C255              CLR      fStatus
  220:   if (TRUE == dmaDataIsReady)
006157 C2AC              CLR      ES0
  221:   {
006159 30565C            JNB      dmaDataIsReady,?C0006?ZW_TEST_INTERFACE_DRIVER
  222:     BYTE byteCount;
  223:     for (byteCount = 0; byteCount < DMA_BUFFER_SIZE_SINGLE; byteCount++)
00615C E4                CLR      A
00615D 900A88            MOV      DPTR,#byteCount
006160 F0                MOVX     @DPTR,A
006161         ?C0007?ZW_TEST_INTERFACE_DRIVER:
006161 900A88            MOV      DPTR,#byteCount
006164 E0                MOVX     A,@DPTR
006165 FF                MOV      R7,A
006166 C3                CLR      C
006167 9420              SUBB     A,#020H
006169 5027              JNC      ?C0008?ZW_TEST_INTERFACE_DRIVER
  224:     {
  225:       if (DMA_EOR_CHARACTER == dmaBuffer[dmaBufferOffset + byteCount])
00616B 9009F3            MOV      DPTR,#dmaBufferOffset
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 132


00616E E0                MOVX     A,@DPTR
00616F 2F                ADD      A,R7
006170 242D              ADD      A,#LOW dmaBuffer
006172 F582              MOV      DPL,A
006174 E4                CLR      A
006175 3407              ADDC     A,#HIGH dmaBuffer
006177 F583              MOV      DPH,A
006179 E0                MOVX     A,@DPTR
00617A B40D0D            CJNE     A,#0DH,?C0009?ZW_TEST_INTERFACE_DRIVER
  226:       {
  227:         *pLength = byteCount + 1;
00617D 900A88            MOV      DPTR,#byteCount
006180 E0                MOVX     A,@DPTR
006181 04                INC      A
006182 900A85            MOV      DPTR,#pLength
006185 123F94            LCALL    ?L?COM00BF
  228:         break;
006188 8008              SJMP     ?C0008?ZW_TEST_INTERFACE_DRIVER
  229:       }
  230:     }
00618A         ?C0009?ZW_TEST_INTERFACE_DRIVER:
00618A 900A88            MOV      DPTR,#byteCount
00618D E0                MOVX     A,@DPTR
00618E 04                INC      A
00618F F0                MOVX     @DPTR,A
006190 80CF              SJMP     ?C0007?ZW_TEST_INTERFACE_DRIVER
006192         ?C0008?ZW_TEST_INTERFACE_DRIVER:
  231: 
  232:     dmaDataIsReady = FALSE;
006192 C256              CLR      dmaDataIsReady
  233:     memcpy(pData, &dmaBuffer[dmaBufferOffset], *pLength);
006194 900A85            MOV      DPTR,#pLength
006197 122589            LCALL    ?C?PLDXDATA
00619A 121FB3            LCALL    ?C?CLDPTR
00619D FF                MOV      R7,A
00619E 9009F3            MOV      DPTR,#dmaBufferOffset
0061A1 E0                MOVX     A,@DPTR
0061A2 242D              ADD      A,#LOW dmaBuffer
0061A4 F9                MOV      R1,A
0061A5 E4                CLR      A
0061A6 3407              ADDC     A,#HIGH dmaBuffer
0061A8 FA                MOV      R2,A
0061A9 7B01              MOV      R3,#01H
0061AB 3149              ACALL    ?L?COM0047
0061AD 900A82            MOV      DPTR,#pData
0061B0 122589            LCALL    ?C?PLDXDATA
0061B3 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  234:     fStatus = TRUE;
0061B6 D255              SETB     fStatus
  235:   }
0061B8         ?C0006?ZW_TEST_INTERFACE_DRIVER:
  236:   ZDB_ES = 1; // Enable interrupt
0061B8 D2AC              SETB     ES0
  237:   return fStatus;
0061BA A255              MOV      C,fStatus
  238: }
0061BC 22                RET      
----- FUNCTION _ZW_test_interface_driver_getData (END) -------


----- FUNCTION NetworkManagementSmartStartIsInclude (BEGIN) -----
0061BD 901217            MOV      DPTR,#eSystemTypeState
0061C0 E0                MOVX     A,@DPTR
0061C1 5414              ANL      A,#014H
0061C3 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 133


0061C4 BF1404            CJNE     R7,#014H,?C0007?ZW_NETWORK_MANAGEMENT
0061C7 7F01              MOV      R7,#01H
0061C9 8002              SJMP     ?C0008?ZW_NETWORK_MANAGEMENT
0061CB         ?C0007?ZW_NETWORK_MANAGEMENT:
0061CB 7F00              MOV      R7,#00H
0061CD         ?C0008?ZW_NETWORK_MANAGEMENT:
0061CD 22                RET      
----- FUNCTION NetworkManagementSmartStartIsInclude (END) -------


----- FUNCTION NetworkManagementSmartStartIsListeningNode (BEGIN) -----
0061CE 901217            MOV      DPTR,#eSystemTypeState
0061D1 E0                MOVX     A,@DPTR
0061D2 7F00              MOV      R7,#00H
0061D4 30E002            JNB      ACC.0,?C0010?ZW_NETWORK_MANAGEMENT
0061D7 7F01              MOV      R7,#01H
0061D9         ?C0010?ZW_NETWORK_MANAGEMENT:
0061D9 22                RET      
----- FUNCTION NetworkManagementSmartStartIsListeningNode (END) -------


----- FUNCTION NetworkManagementLearnActive (BEGIN) -----
0061DA 903D32            MOV      DPTR,#learnState
0061DD E0                MOVX     A,@DPTR
0061DE B4040D            CJNE     A,#04H,?C0071?ZW_NETWORK_MANAGEMENT
0061E1 903D37            MOV      DPTR,#learnStateHandle
0061E4 E0                MOVX     A,@DPTR
0061E5 6007              JZ       ?C0071?ZW_NETWORK_MANAGEMENT
0061E7 31CE              ACALL    NetworkManagementSmartStartIsListeningNode
0061E9 EF                MOV      A,R7
0061EA 7002              JNZ      ?C0071?ZW_NETWORK_MANAGEMENT
0061EC FF                MOV      R7,A
0061ED 22                RET      
0061EE         ?C0071?ZW_NETWORK_MANAGEMENT:
0061EE 903D32            MOV      DPTR,#learnState
0061F1 E0                MOVX     A,@DPTR
0061F2 FF                MOV      R7,A
0061F3 22                RET      
----- FUNCTION NetworkManagementLearnActive (END) -------


----- FUNCTION NetworkManagementGenerateDskpart (BEGIN) -----
0061F4 902B43            MOV      DPTR,#Dsk+08H
0061F7 E0                MOVX     A,@DPTR
0061F8 7009              JNZ      ?C0069?ZW_NETWORK_MANAGEMENT
0061FA 7B01              MOV      R3,#01H
0061FC 7A2B              MOV      R2,#HIGH Dsk
0061FE 793B              MOV      R1,#LOW Dsk
006200 121AD4            LCALL    ?INTERBANK_TABLE?_keystore_public_dsk_read
006203         ?C0069?ZW_NETWORK_MANAGEMENT:
006203 902B43            MOV      DPTR,#Dsk+08H
006206 E0                MOVX     A,@DPTR
006207 44C0              ORL      A,#0C0H
006209 F0                MOVX     @DPTR,A
00620A 902B46            MOV      DPTR,#Dsk+0BH
00620D E0                MOVX     A,@DPTR
00620E 54FE              ANL      A,#0FEH
006210 F0                MOVX     @DPTR,A
006211 A3                INC      DPTR
006212 E0                MOVX     A,@DPTR
006213 44C0              ORL      A,#0C0H
006215 F0                MOVX     @DPTR,A
006216 902B4A            MOV      DPTR,#Dsk+0FH
006219 E0                MOVX     A,@DPTR
00621A 54FE              ANL      A,#0FEH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 134


00621C F0                MOVX     @DPTR,A
00621D 22                RET      
----- FUNCTION NetworkManagementGenerateDskpart (END) -------


----- FUNCTION _ZW_NetworkManagementSetMaxInclusionRequestIntervals (BEGIN) -----
;---- Variable 'bInclRequestIntervals' assigned to Register 'R7' ----
00621E 7405              MOV      A,#05H
006220 D3                SETB     C
006221 9F                SUBB     A,R7
006222 500B              JNC      ?C0074?ZW_NETWORK_MANAGEMENT
006224 7463              MOV      A,#063H
006226 C3                CLR      C
006227 9F                SUBB     A,R7
006228 4005              JC       ?C0074?ZW_NETWORK_MANAGEMENT
00622A 903D35            MOV      DPTR,#bInclusionRequestIntervals
00622D EF                MOV      A,R7
00622E F0                MOVX     @DPTR,A
00622F         ?C0074?ZW_NETWORK_MANAGEMENT:
00622F 903D35            MOV      DPTR,#bInclusionRequestIntervals
006232 E0                MOVX     A,@DPTR
006233 FF                MOV      R7,A
006234 22                RET      
----- FUNCTION _ZW_NetworkManagementSetMaxInclusionRequestIntervals (END) -------


----- FUNCTION Reset_GetReset (BEGIN) -----
006235 75FF02            MOV      SFRPAGE,#02H
006238 E5E6              MOV      A,RSETVEC
00623A 30E203            JNB      ACC.2,?C0010?ZW_PHY_050X
00623D 7F03              MOV      R7,#03H
00623F 22                RET      
006240         ?C0010?ZW_PHY_050X:
006240 E5E6              MOV      A,RSETVEC
006242 30E303            JNB      ACC.3,?C0013?ZW_PHY_050X
006245 7F00              MOV      R7,#00H
006247 22                RET      
006248         ?C0013?ZW_PHY_050X:
006248 E5E6              MOV      A,RSETVEC
00624A 30E103            JNB      ACC.1,?C0015?ZW_PHY_050X
00624D 7F04              MOV      R7,#04H
00624F 22                RET      
006250         ?C0015?ZW_PHY_050X:
006250 E5E6              MOV      A,RSETVEC
006252 7F05              MOV      R7,#05H
006254 30E002            JNB      ACC.0,?C0017?ZW_PHY_050X
006257 7F01              MOV      R7,#01H
006259         ?C0017?ZW_PHY_050X:
006259 22                RET      
----- FUNCTION Reset_GetReset (END) -------


----- FUNCTION _ZW_IOS_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
00625A EF                MOV      A,R7
00625B 6007              JZ       ?C0019?ZW_PHY_050X
00625D 75FF02            MOV      SFRPAGE,#02H
006260 53E6BF            ANL      RSETVEC,#0BFH
006263 22                RET      
006264         ?C0019?ZW_PHY_050X:
006264 75FF02            MOV      SFRPAGE,#02H
006267 43E640            ORL      RSETVEC,#040H
00626A 22                RET      
----- FUNCTION _ZW_IOS_enable (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 135



----- FUNCTION _ZW_IOS_set (BEGIN) -----
;---- Variable 'bPort' assigned to Register 'R7' ----
;---- Variable 'bValue' assigned to Register 'R3' ----
;---- Variable 'bDirection' assigned to Register 'R5' ----
00626B EF                MOV      A,R7
00626C 14                DEC      A
00626D 600F              JZ       ?C0024?ZW_PHY_050X
00626F 14                DEC      A
006270 6014              JZ       ?C0025?ZW_PHY_050X
006272 2402              ADD      A,#02H
006274 7018              JNZ      ?C0026?ZW_PHY_050X
006276         ?C0023?ZW_PHY_050X:
006276 8B80              MOV      P0,R3
006278 75FF01            MOV      SFRPAGE,#01H
00627B 8DFD              MOV      P0DIR,R5
00627D 22                RET      
00627E         ?C0024?ZW_PHY_050X:
00627E 8B90              MOV      P1,R3
006280 75FF01            MOV      SFRPAGE,#01H
006283 8DC9              MOV      P1DIR,R5
006285 22                RET      
006286         ?C0025?ZW_PHY_050X:
006286 8BA0              MOV      P2,R3
006288 75FF01            MOV      SFRPAGE,#01H
00628B 8DCA              MOV      P2DIR,R5
00628D 22                RET      
00628E         ?C0026?ZW_PHY_050X:
00628E AF03              MOV      R7,AR3
006290 8FB0              MOV      P3,R7
006292 75FF01            MOV      SFRPAGE,#01H
006295 AF05              MOV      R7,AR5
006297 8FCB              MOV      P3DIR,R7
006299 22                RET      
----- FUNCTION _ZW_IOS_set (END) -------


----- FUNCTION _ZW_IOS_get (BEGIN) -----
00629A 90401B            MOV      DPTR,#bDirection
00629D 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'bPort' assigned to Register 'R7' ----
0062A0 EF                MOV      A,R7
0062A1 14                DEC      A
0062A2 6014              JZ       ?C0030?ZW_PHY_050X
0062A4 14                DEC      A
0062A5 601E              JZ       ?C0031?ZW_PHY_050X
0062A7 2402              ADD      A,#02H
0062A9 7027              JNZ      ?C0032?ZW_PHY_050X
0062AB         ?C0029?ZW_PHY_050X:
0062AB 51E0              ACALL    ?L?COM0484
0062AD E580              MOV      A,P0
0062AF 51E6              ACALL    ?L?COM0348
0062B1 122589            LCALL    ?C?PLDXDATA
0062B4 E5FD              MOV      A,P0DIR
0062B6 8025              SJMP     ?C0038?ZW_PHY_050X
0062B8         ?C0030?ZW_PHY_050X:
0062B8 51E0              ACALL    ?L?COM0484
0062BA E590              MOV      A,P1
0062BC 51E6              ACALL    ?L?COM0348
0062BE 122589            LCALL    ?C?PLDXDATA
0062C1 E5C9              MOV      A,P1DIR
0062C3         
0062C3 8018              SJMP     ?C0038?ZW_PHY_050X
0062C5         ?C0031?ZW_PHY_050X:
0062C5 51E0              ACALL    ?L?COM0484
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 136


0062C7 E5A0              MOV      A,P2
0062C9 51E6              ACALL    ?L?COM0348
0062CB 122589            LCALL    ?C?PLDXDATA
0062CE E5CA              MOV      A,P2DIR
0062D0         
0062D0 800B              SJMP     ?C0038?ZW_PHY_050X
0062D2         ?C0032?ZW_PHY_050X:
0062D2 51E0              ACALL    ?L?COM0484
0062D4 E5B0              MOV      A,P3
0062D6 51E6              ACALL    ?L?COM0348
0062D8 122589            LCALL    ?C?PLDXDATA
0062DB E5CB              MOV      A,P3DIR
0062DD         
0062DD 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_IOS_get (END) -------


----- FUNCTION ?L?COM0484 (BEGIN) -----
0062E0 90401E            MOV      DPTR,#bValue
0062E3 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0484 (END) -------


----- FUNCTION ?L?COM0348 (BEGIN) -----
0062E6 122072            LCALL    ?C?CSTPTR
0062E9 75FF01            MOV      SFRPAGE,#01H
0062EC 90401B            MOV      DPTR,#bDirection
0062EF 22                RET      
----- FUNCTION ?L?COM0348 (END) -------


----- FUNCTION ZW_CHIP_type_get (BEGIN) -----
0062F0 E4                CLR      A
0062F1 F5FF              MOV      SFRPAGE,A
0062F3 AF91              MOV      R7,CHTYPE
0062F5 22                RET      
----- FUNCTION ZW_CHIP_type_get (END) -------


----- FUNCTION ZW_CHIP_revision_get (BEGIN) -----
0062F6 E4                CLR      A
0062F7 F5FF              MOV      SFRPAGE,A
0062F9 AF92              MOV      R7,CHREV
0062FB 22                RET      
----- FUNCTION ZW_CHIP_revision_get (END) -------


----- FUNCTION __RF_check_checksum (BEGIN) -----
0062FC 904276            MOV      DPTR,#success
0062FF 712A              ACALL    ?L?COM015E
;---- Variable 'value' assigned to Register 'R7' ----
006301 7F01              MOV      R7,#01H
006303 7C12              MOV      R4,#HIGH phyRfData
006305 7D01              MOV      R5,#LOW phyRfData
;---- Variable 'adr' assigned to Register 'R4/R5' ----
;---- Variable 'i' assigned to Register 'R6' ----
006307 E4                CLR      A
006308 FE                MOV      R6,A
006309         ?C0025?ZW_PHY_RF_050X:
006309 8D82              MOV      DPL,R5
00630B 8C83              MOV      DPH,R4
00630D ED                MOV      A,R5
00630E 2E                ADD      A,R6
00630F 7133              ACALL    ?L?COM0330
006311 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 137


006312 2F                ADD      A,R7
006313 FF                MOV      R7,A
006314 0E                INC      R6
006315 EE                MOV      A,R6
006316 B412F0            CJNE     A,#012H,?C0025?ZW_PHY_RF_050X
006319         ?C0026?ZW_PHY_RF_050X:
006319 901213            MOV      DPTR,#phyRfData+012H
00631C E0                MOVX     A,@DPTR
00631D 6F                XRL      A,R7
00631E 6009              JZ       ?C0029?ZW_PHY_RF_050X
006320 904276            MOV      DPTR,#success
006323 713D              ACALL    ?L?COM02B3
006325 E4                CLR      A
006326 122072            LCALL    ?C?CSTPTR
006329         ?C0029?ZW_PHY_RF_050X:
006329 22                RET      
----- FUNCTION __RF_check_checksum (END) -------


----- FUNCTION ?L?COM015E (BEGIN) -----
00632A EB                MOV      A,R3
00632B         ?L?COM015F:
00632B F0                MOVX     @DPTR,A
00632C A3                INC      DPTR
00632D EA                MOV      A,R2
00632E F0                MOVX     @DPTR,A
00632F A3                INC      DPTR
006330 E9                MOV      A,R1
006331 F0                MOVX     @DPTR,A
006332 22                RET      
----- FUNCTION ?L?COM015E (END) -------


----- FUNCTION ?L?COM0330 (BEGIN) -----
006333 F582              MOV      DPL,A
006335 E4                CLR      A
006336 3C                ADDC     A,R4
006337 F583              MOV      DPH,A
006339 22                RET      
----- FUNCTION ?L?COM0330 (END) -------


----- FUNCTION ?L?COM02B2 (BEGIN) -----
00633A 903DB0            MOV      DPTR,#randomWord
00633D         ?L?COM02B3:
00633D E0                MOVX     A,@DPTR
00633E FB                MOV      R3,A
00633F A3                INC      DPTR
006340 E0                MOVX     A,@DPTR
006341 FA                MOV      R2,A
006342 A3                INC      DPTR
006343 E0                MOVX     A,@DPTR
006344 F9                MOV      R1,A
006345 22                RET      
----- FUNCTION ?L?COM02B2 (END) -------


----- FUNCTION _RF_lbt_get_rssi (BEGIN) -----
006346 904203            MOV      DPTR,#bChannel
006349 EF                MOV      A,R7
00634A F0                MOVX     @DPTR,A
00634B A3                INC      DPTR
00634C 712A              ACALL    ?L?COM015E
00634E 75FF01            MOV      SFRPAGE,#01H
006351 125E54            LCALL    RF_mode_get
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 138


006354 EF                MOV      A,R7
006355 6401              XRL      A,#01H
006357 6002              JZ       ?C0287?ZW_PHY_RF_050X
006359 C3                CLR      C
00635A 22                RET      
00635B         ?C0287?ZW_PHY_RF_050X:
00635B E5F4              MOV      A,DMCTRL
00635D 30E602            JNB      ACC.6,?C0289?ZW_PHY_RF_050X
006360 C3                CLR      C
006361 22                RET      
006362         ?C0289?ZW_PHY_RF_050X:
006362 7FE8              MOV      R7,#0E8H
006364 7E03              MOV      R6,#03H
006366 124F00            LCALL    _set_phy_timer_timeout
006369 124EF9            LCALL    start_phy_timer
00636C 125F77            LCALL    _wait_until_no_preamble
00636F 4001              JC       ?C0290?ZW_PHY_RF_050X
006371 22                RET      
006372         ?C0290?ZW_PHY_RF_050X:
006372 C233              CLR      ?RF_demodulator_enable?BIT
006374 12373A            LCALL    RF_demodulator_enable
006377 904203            MOV      DPTR,#bChannel
00637A E0                MOVX     A,@DPTR
00637B FF                MOV      R7,A
00637C 125985            LCALL    _RF_channel_set
00637F 53F4DF            ANL      DMCTRL,#0DFH
006382 D233              SETB     ?RF_demodulator_enable?BIT
006384 12373A            LCALL    RF_demodulator_enable
006387 7F78              MOV      R7,#078H
006389 7E00              MOV      R6,#00H
00638B 125FA9            LCALL    _wait_phy_timer_elapse
00638E 75FF01            MOV      SFRPAGE,#01H
006391 53E4BF            ANL      SDCON1,#0BFH
006394         ?C0291?ZW_PHY_RF_050X:
006394 E5E4              MOV      A,SDCON1
006396 30E7FB            JNB      ACC.7,?C0291?ZW_PHY_RF_050X
006399         ?C0292?ZW_PHY_RF_050X:
006399 71D5              ACALL    ?L?COM056E
00639B 7F8A              MOV      R7,#08AH
00639D 71CC              ACALL    ?L?COM05C0
00639F 30E608            JNB      ACC.6,?C0293?ZW_PHY_RF_050X
0063A2 904204            MOV      DPTR,#rssi_value
0063A5 713D              ACALL    ?L?COM02B3
0063A7 E4                CLR      A
0063A8 800A              SJMP     ?C0311?ZW_PHY_RF_050X
0063AA         ?C0293?ZW_PHY_RF_050X:
0063AA 75FF01            MOV      SFRPAGE,#01H
0063AD 904204            MOV      DPTR,#rssi_value
0063B0 713D              ACALL    ?L?COM02B3
0063B2 E5D9              MOV      A,DFSTAT
0063B4         
0063B4 122072            LCALL    ?C?CSTPTR
0063B7         ?C0294?ZW_PHY_RF_050X:
0063B7 75FF01            MOV      SFRPAGE,#01H
0063BA 43E440            ORL      SDCON1,#040H
0063BD 71E5              ACALL    ?L?COM0347
0063BF 4003              JC       ?C0295?ZW_PHY_RF_050X
0063C1 43F420            ORL      DMCTRL,#020H
0063C4         ?C0295?ZW_PHY_RF_050X:
0063C4 125F77            LCALL    _wait_until_no_preamble
0063C7 4001              JC       ?C0296?ZW_PHY_RF_050X
0063C9 22                RET      
0063CA         ?C0296?ZW_PHY_RF_050X:
0063CA D3                SETB     C
0063CB 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 139


----- FUNCTION _RF_lbt_get_rssi (END) -------


----- FUNCTION ?L?COM05C0 (BEGIN) -----
0063CC FE                MOV      R6,A
0063CD 125FA9            LCALL    _wait_phy_timer_elapse
0063D0 90120F            MOV      DPTR,#phyRfData+0EH
0063D3 E0                MOVX     A,@DPTR
0063D4 22                RET      
----- FUNCTION ?L?COM05C0 (END) -------


----- FUNCTION ?L?COM056E (BEGIN) -----
0063D5 75FF01            MOV      SFRPAGE,#01H
0063D8 E4                CLR      A
0063D9 F5EA              MOV      DFCON3,A
0063DB 75EAFF            MOV      DFCON3,#0FFH
0063DE 22                RET      
----- FUNCTION ?L?COM056E (END) -------


----- FUNCTION ?L?COM0346 (BEGIN) -----
0063DF 75FF03            MOV      SFRPAGE,#03H
0063E2 759580            MOV      DMCHAN,#080H
0063E5         ?L?COM0347:
0063E5 90120E            MOV      DPTR,#phyRfData+0DH
0063E8 E0                MOVX     A,@DPTR
0063E9 D3                SETB     C
0063EA 9401              SUBB     A,#01H
0063EC 22                RET      
----- FUNCTION ?L?COM0346 (END) -------


----- FUNCTION __PLL_wait_lock_and_sequencer_done (BEGIN) -----
;---- Variable 'success' assigned to Register 'R1/R2/R3' ----
0063ED C22C              CLR      rf_setting_changed
0063EF 75FF03            MOV      SFRPAGE,#03H
0063F2 759B1F            MOV      SEQCON5,#01FH
0063F5         ?C0036?ZW_PHY_RF_050X:
0063F5 75FF03            MOV      SFRPAGE,#03H
0063F8 90120F            MOV      DPTR,#phyRfData+0EH
0063FB E0                MOVX     A,@DPTR
0063FC 20E71B            JB       ACC.7,?C0034?ZW_PHY_RF_050X
0063FF E59A              MOV      A,SEQCON4
006401 540F              ANL      A,#0FH
006403 C3                CLR      C
006404 9402              SUBB     A,#02H
006406 4012              JC       ?C0034?ZW_PHY_RF_050X
006408 E0                MOVX     A,@DPTR
006409 4480              ORL      A,#080H
00640B F0                MOVX     @DPTR,A
00640C E4                CLR      A
00640D F5FF              MOV      SFRPAGE,A
00640F 75C2A1            MOV      DPLLNRM4,#0A1H
006412 43FC04            ORL      SEQCON,#04H
006415 75FF03            MOV      SFRPAGE,#03H
006418 D22C              SETB     rf_setting_changed
00641A         ?C0034?ZW_PHY_RF_050X:
00641A E5FC              MOV      A,SEQCON
00641C 30E609            JNB      ACC.6,?C0035?ZW_PHY_RF_050X
00641F E59A              MOV      A,SEQCON4
006421 540F              ANL      A,#0FH
006423 C3                CLR      C
006424 9405              SUBB     A,#05H
006426 40CD              JC       ?C0036?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 140


006428         ?C0035?ZW_PHY_RF_050X:
006428 E5FC              MOV      A,SEQCON
00642A 30E611            JNB      ACC.6,?C0040?ZW_PHY_RF_050X
00642D E4                CLR      A
00642E 122072            LCALL    ?C?CSTPTR
006431 75FC80            MOV      SEQCON,#080H
006434 F5FC              MOV      SEQCON,A
006436 75FC40            MOV      SEQCON,#040H
006439         ?C0041?ZW_PHY_RF_050X:
006439 E5FC              MOV      A,SEQCON
00643B 20E6FB            JB       ACC.6,?C0041?ZW_PHY_RF_050X
00643E         ?C0042?ZW_PHY_RF_050X:
00643E         ?C0040?ZW_PHY_RF_050X:
00643E 302C03            JNB      rf_setting_changed,?C0044?ZW_PHY_RF_050X
006441 124CE1            LCALL    _RF_generate_checksum
006444         ?C0044?ZW_PHY_RF_050X:
006444 22                RET      
----- FUNCTION __PLL_wait_lock_and_sequencer_done (END) -------


----- FUNCTION RF_switch_to_RX (BEGIN) -----
006445 E4                CLR      A
006446 9041FB            MOV      DPTR,#success
006449 F0                MOVX     @DPTR,A
00644A A3                INC      DPTR
00644B 04                INC      A
00644C F0                MOVX     @DPTR,A
00644D E4                CLR      A
00644E 9041FE            MOV      DPTR,#from_tx
006451 F0                MOVX     @DPTR,A
006452         ?C0117?ZW_PHY_RF_050X:
006452 E5FA              MOV      A,MODCTRL
006454 30E1FB            JNB      ACC.1,?C0117?ZW_PHY_RF_050X
006457         ?C0118?ZW_PHY_RF_050X:
006457 75FF01            MOV      SFRPAGE,#01H
00645A E5D5              MOV      A,RFCON
00645C 30E703            JNB      ACC.7,?C0119?ZW_PHY_RF_050X
00645F 7F00              MOV      R7,#00H
006461 22                RET      
006462         ?C0119?ZW_PHY_RF_050X:
006462 E4                CLR      A
006463 F5FF              MOV      SFRPAGE,A
006465 75E508            MOV      SDSTAT3,#08H
006468 125F4C            LCALL    ?L?COM056F
00646B E5D5              MOV      A,RFCON
00646D 30E61A            JNB      ACC.6,?C0121?ZW_PHY_RF_050X
006470 75FF01            MOV      SFRPAGE,#01H
006473 9041FD            MOV      DPTR,#temp_rfpow
006476 E5DA              MOV      A,RFPOW
006478 F0                MOVX     @DPTR,A
006479 E4                CLR      A
00647A F5DA              MOV      RFPOW,A
00647C 75FF01            MOV      SFRPAGE,#01H
00647F         ?C0122?ZW_PHY_RF_050X:
00647F E5D6              MOV      A,RFCON2
006481 30E3FB            JNB      ACC.3,?C0122?ZW_PHY_RF_050X
006484         ?C0123?ZW_PHY_RF_050X:
006484 9041FE            MOV      DPTR,#from_tx
006487 7401              MOV      A,#01H
006489 F0                MOVX     @DPTR,A
00648A         ?C0121?ZW_PHY_RF_050X:
00648A 91FA              ACALL    ?L?COM0480
00648C         ?C0124?ZW_PHY_RF_050X:
00648C E59B              MOV      A,SEQCON5
00648E 30E7FB            JNB      ACC.7,?C0124?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 141


006491         ?C0125?ZW_PHY_RF_050X:
;---- Variable 'ch' assigned to Register 'R3' ----
006491 E4                CLR      A
006492 FB                MOV      R3,A
006493         ?C0126?ZW_PHY_RF_050X:
006493 75FF03            MOV      SFRPAGE,#03H
006496 8B95              MOV      DMCHAN,R3
006498 124B9E            LCALL    ?L?COM0039
00649B 124F83            LCALL    __set_fcw
00649E 0B                INC      R3
00649F EB                MOV      A,R3
0064A0 B403F0            CJNE     A,#03H,?C0126?ZW_PHY_RF_050X
0064A3         ?C0127?ZW_PHY_RF_050X:
0064A3 75FF03            MOV      SFRPAGE,#03H
0064A6 759580            MOV      DMCHAN,#080H
0064A9 124EE2            LCALL    ?L?COM0122
0064AC 124FC6            LCALL    ?L?COM04FF
0064AF 43D504            ORL      RFCON,#04H
0064B2 9041FE            MOV      DPTR,#from_tx
0064B5 E0                MOVX     A,@DPTR
0064B6 700B              JNZ      ?C0129?ZW_PHY_RF_050X
0064B8 124FBF            LCALL    stop_phy_timer
0064BB 7FC8              MOV      R7,#0C8H
0064BD 124EF5            LCALL    ?L?COM0124
0064C0 124F24            LCALL    wait_phy_timer_timeout
0064C3         ?C0129?ZW_PHY_RF_050X:
0064C3 7B01              MOV      R3,#01H
0064C5 7A41              MOV      R2,#HIGH tmp_success
0064C7 79FC              MOV      R1,#LOW tmp_success
0064C9 71ED              ACALL    __PLL_wait_lock_and_sequencer_done
0064CB 9041FC            MOV      DPTR,#tmp_success
0064CE E0                MOVX     A,@DPTR
0064CF 9041FB            MOV      DPTR,#success
0064D2 7006              JNZ      ?C0130?ZW_PHY_RF_050X
0064D4 E0                MOVX     A,@DPTR
0064D5 4404              ORL      A,#04H
0064D7 FF                MOV      R7,A
0064D8 8002              SJMP     ?C0131?ZW_PHY_RF_050X
0064DA         ?C0130?ZW_PHY_RF_050X:
0064DA E0                MOVX     A,@DPTR
0064DB FF                MOV      R7,A
0064DC         ?C0131?ZW_PHY_RF_050X:
0064DC 9041FB            MOV      DPTR,#success
0064DF EF                MOV      A,R7
0064E0 F0                MOVX     @DPTR,A
0064E1 90120E            MOV      DPTR,#phyRfData+0DH
0064E4 E0                MOVX     A,@DPTR
0064E5 B40103            CJNE     A,#01H,?C0132?ZW_PHY_RF_050X
0064E8 124FE7            LCALL    ?L?COM0570
0064EB         ?C0132?ZW_PHY_RF_050X:
0064EB 75FF01            MOV      SFRPAGE,#01H
0064EE 9041FD            MOV      DPTR,#temp_rfpow
0064F1 E0                MOVX     A,@DPTR
0064F2 F5DA              MOV      RFPOW,A
0064F4 9041FB            MOV      DPTR,#success
0064F7 E0                MOVX     A,@DPTR
0064F8 FF                MOV      R7,A
0064F9 22                RET      
----- FUNCTION RF_switch_to_RX (END) -------


----- FUNCTION ?L?COM0480 (BEGIN) -----
0064FA 75FF03            MOV      SFRPAGE,#03H
0064FD 759B04            MOV      SEQCON5,#04H
006500 75FC41            MOV      SEQCON,#041H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 142


006503 75FF03            MOV      SFRPAGE,#03H
006506 22                RET      
----- FUNCTION ?L?COM0480 (END) -------


----- FUNCTION __PLL_set_bank5 (BEGIN) -----
006507 903A5A            MOV      DPTR,#fcw
00650A 1224F1            LCALL    ?C?LSTXDATA
00650D E4                CLR      A
00650E F5FF              MOV      SFRPAGE,A
006510 75BB05            MOV      DPLLORBNK,#05H
006513 75BB85            MOV      DPLLORBNK,#085H
006516 75FF01            MOV      SFRPAGE,#01H
006519 75D502            MOV      RFCON,#02H
00651C 202D06            JB       rf_already_calculated,?C0045?ZW_PHY_RF_050X
00651F 124F1D            LCALL    ?L?COM0325
006522 125F8D            LCALL    _PLL_boost_bias
006525         ?C0045?ZW_PHY_RF_050X:
006525 75FF01            MOV      SFRPAGE,#01H
006528 43D520            ORL      RFCON,#020H
00652B 302D02            JNB      rf_already_calculated,$ + 5H
00652E A1CB              AJMP     ?C0046?ZW_PHY_RF_050X
006530 E4                CLR      A
006531 F5FF              MOV      SFRPAGE,A
006533 538EF7            ANL      DPLLSMCON,#0F7H
006536 438E07            ORL      DPLLSMCON,#07H
;---- Variable 'i' assigned to Register 'R5' ----
006539 7D04              MOV      R5,#04H
00653B         ?C0047?ZW_PHY_RF_050X:
00653B E4                CLR      A
00653C F5FF              MOV      SFRPAGE,A
00653E 8DBC              MOV      DPLLORVAL,R5
006540 F5FF              MOV      SFRPAGE,A
006542 43B102            ORL      DPLLCON,#02H
006545         ?C0050?ZW_PHY_RF_050X:
006545 E5B1              MOV      A,DPLLCON
006547 30E2FB            JNB      ACC.2,?C0050?ZW_PHY_RF_050X
00654A         ?C0051?ZW_PHY_RF_050X:
00654A E4                CLR      A
00654B F5FF              MOV      SFRPAGE,A
00654D AFDF              MOV      R7,DPLLSMHI
00654F EF                MOV      A,R7
006550 FE                MOV      R6,A
006551 ACDE              MOV      R4,DPLLSMLO
006553 EC                MOV      A,R4
006554 FB                MOV      R3,A
006555 EB                MOV      A,R3
006556 FF                MOV      R7,A
006557 ED                MOV      A,R5
006558 25E0              ADD      A,ACC
00655A 2458              ADD      A,#LOW b5table-08H
00655C F582              MOV      DPL,A
00655E E4                CLR      A
00655F 343A              ADDC     A,#HIGH b5table-08H
006561 F583              MOV      DPH,A
006563 B1F2              ACALL    ?L?COM043B
006565 F5FF              MOV      SFRPAGE,A
006567 F5FF              MOV      SFRPAGE,A
006569 53B1FD            ANL      DPLLCON,#0FDH
00656C 0D                INC      R5
00656D ED                MOV      A,R5
00656E B40CCA            CJNE     A,#0CH,?C0047?ZW_PHY_RF_050X
006571         ?C0048?ZW_PHY_RF_050X:
006571 903A5A            MOV      DPTR,#fcw
006574 124BAC            LCALL    ?L?COM003B
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 143


006577 7809              MOV      R0,#09H
006579 1223E5            LCALL    ?C?ULSHR
00657C A3                INC      DPTR
00657D B1F2              ACALL    ?L?COM043B
00657F FD                MOV      R5,A
006580         ?C0054?ZW_PHY_RF_050X:
006580 ED                MOV      A,R5
006581 25E0              ADD      A,ACC
006583 2462              ADD      A,#LOW b5table+02H
006585 F582              MOV      DPL,A
006587 E4                CLR      A
006588 343A              ADDC     A,#HIGH b5table+02H
00658A F583              MOV      DPH,A
00658C E0                MOVX     A,@DPTR
00658D C3                CLR      C
00658E 13                RRC      A
00658F FA                MOV      R2,A
006590 A3                INC      DPTR
006591 E0                MOVX     A,@DPTR
006592 13                RRC      A
006593 FB                MOV      R3,A
006594 B1E5              ACALL    ?L?COM035F
006596 E0                MOVX     A,@DPTR
006597 C3                CLR      C
006598 13                RRC      A
006599 FE                MOV      R6,A
00659A A3                INC      DPTR
00659B E0                MOVX     A,@DPTR
00659C 13                RRC      A
00659D 2B                ADD      A,R3
00659E FF                MOV      R7,A
00659F EE                MOV      A,R6
0065A0 3A                ADDC     A,R2
0065A1 FE                MOV      R6,A
0065A2 B1E5              ACALL    ?L?COM035F
0065A4 EE                MOV      A,R6
0065A5 F0                MOVX     @DPTR,A
0065A6 A3                INC      DPTR
0065A7 EF                MOV      A,R7
0065A8 F0                MOVX     @DPTR,A
0065A9 ED                MOV      A,R5
0065AA 2404              ADD      A,#04H
0065AC 90120D            MOV      DPTR,#phyRfData+0CH
0065AF F0                MOVX     @DPTR,A
0065B0 ED                MOV      A,R5
0065B1 C3                CLR      C
0065B2 9407              SUBB     A,#07H
0065B4 5015              JNC      ?C0046?ZW_PHY_RF_050X
0065B6 CF                XCH      A,R7
0065B7 ED                MOV      A,R5
0065B8 CF                XCH      A,R7
0065B9 0D                INC      R5
0065BA EF                MOV      A,R7
0065BB B1E6              ACALL    ?L?COM0360
0065BD B1F9              ACALL    ?L?COM0199
0065BF 903A5F            MOV      DPTR,#fcw_upper+01H
0065C2 E0                MOVX     A,@DPTR
0065C3 9F                SUBB     A,R7
0065C4 903A5E            MOV      DPTR,#fcw_upper
0065C7 E0                MOVX     A,@DPTR
0065C8 9E                SUBB     A,R6
0065C9 50B5              JNC      ?C0054?ZW_PHY_RF_050X
0065CB         ?C0046?ZW_PHY_RF_050X:
0065CB E4                CLR      A
0065CC F5FF              MOV      SFRPAGE,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 144


0065CE 758EC8            MOV      DPLLSMCON,#0C8H
0065D1 F5FF              MOV      SFRPAGE,A
0065D3 90120D            MOV      DPTR,#phyRfData+0CH
0065D6 E0                MOVX     A,@DPTR
0065D7 F5BC              MOV      DPLLORVAL,A
0065D9 E4                CLR      A
0065DA F5FF              MOV      SFRPAGE,A
0065DC 75BB80            MOV      DPLLORBNK,#080H
0065DF 75FF01            MOV      SFRPAGE,#01H
0065E2 F5D5              MOV      RFCON,A
0065E4 22                RET      
----- FUNCTION __PLL_set_bank5 (END) -------


----- FUNCTION ?L?COM035F (BEGIN) -----
0065E5 ED                MOV      A,R5
0065E6         ?L?COM0360:
0065E6 25E0              ADD      A,ACC
0065E8 2460              ADD      A,#LOW b5table
0065EA F582              MOV      DPL,A
0065EC E4                CLR      A
0065ED 343A              ADDC     A,#HIGH b5table
0065EF F583              MOV      DPH,A
0065F1 22                RET      
----- FUNCTION ?L?COM035F (END) -------


----- FUNCTION ?L?COM043B (BEGIN) -----
0065F2 EE                MOV      A,R6
0065F3 F0                MOVX     @DPTR,A
0065F4 A3                INC      DPTR
0065F5 EF                MOV      A,R7
0065F6 F0                MOVX     @DPTR,A
0065F7 E4                CLR      A
0065F8 22                RET      
----- FUNCTION ?L?COM043B (END) -------


----- FUNCTION ?L?COM0199 (BEGIN) -----
0065F9 E0                MOVX     A,@DPTR
0065FA FE                MOV      R6,A
0065FB A3                INC      DPTR
0065FC E0                MOVX     A,@DPTR
0065FD FF                MOV      R7,A
0065FE C3                CLR      C
0065FF 22                RET      
----- FUNCTION ?L?COM0199 (END) -------


----- FUNCTION _NVM_ext_write_long_buffer (BEGIN) -----
006600 903C3D            MOV      DPTR,#offset
006603 1224F1            LCALL    ?C?LSTXDATA
006606 903C41            MOV      DPTR,#buf
006609 1225A9            LCALL    ?C?PSTXDATA
00660C 903C3D            MOV      DPTR,#offset
00660F 122499            LCALL    ?C?LLDXDATA
006612 903BFC            MOV      DPTR,#NVRbNVMPageSize+01H
006615 E0                MOVX     A,@DPTR
006616 24FF              ADD      A,#0FFH
006618 FD                MOV      R5,A
006619 903BFB            MOV      DPTR,#NVRbNVMPageSize
00661C E0                MOVX     A,@DPTR
00661D 34FF              ADDC     A,#0FFH
00661F 5E                ANL      A,R6
006620 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 145


006621 ED                MOV      A,R5
006622 5F                ANL      A,R7
006623 FF                MOV      R7,A
006624 903C46            MOV      DPTR,#i
006627 F1E1              ACALL    ?L?COM0460
006629 605D              JZ       ?C0148?ZW_PHY_GENERIC_SPI_IF
00662B 903C46            MOV      DPTR,#i
00662E B1F9              ACALL    ?L?COM0199
006630 12729E            LCALL    ?L?COM0441
006633 903C46            MOV      DPTR,#i
006636 F0                MOVX     @DPTR,A
006637 A3                INC      DPTR
006638 EF                MOV      A,R7
006639 F0                MOVX     @DPTR,A
00663A 903C44            MOV      DPTR,#length
00663D F1D1              ACALL    ?L?COM0539
00663F 9F                SUBB     A,R7
006640 EC                MOV      A,R4
006641 9E                SUBB     A,R6
006642 5003              JNC      ?C0142?ZW_PHY_GENERIC_SPI_IF
006644 1270D2            LCALL    ?L?COM01A0
006647         ?C0142?ZW_PHY_GENERIC_SPI_IF:
006647 F128              ACALL    ?L?COM0158
006649 126DD0            LCALL    ?L?COM025C
00664C 602A              JZ       ?C0143?ZW_PHY_GENERIC_SPI_IF
00664E 12709B            LCALL    ?L?COM0160
006651 C004              PUSH     AR4
006653 C005              PUSH     AR5
006655 C006              PUSH     AR6
006657 C007              PUSH     AR7
006659 F128              ACALL    ?L?COM0158
00665B E9                MOV      A,R1
00665C 4A                ORL      A,R2
00665D 6005              JZ       ?C0144?ZW_PHY_GENERIC_SPI_IF
00665F F1C4              ACALL    ?L?COM0395
006661 FF                MOV      R7,A
006662 8002              SJMP     ?C0145?ZW_PHY_GENERIC_SPI_IF
006664         ?C0144?ZW_PHY_GENERIC_SPI_IF:
006664 7F00              MOV      R7,#00H
006666         ?C0145?ZW_PHY_GENERIC_SPI_IF:
006666 7E00              MOV      R6,#00H
006668 F128              ACALL    ?L?COM0158
00666A 127188            LCALL    ?L?COM031E
00666D D007              POP      AR7
00666F D006              POP      AR6
006671 D005              POP      AR5
006673 D004              POP      AR4
006675 123AEB            LCALL    _NVMPutArray_long
006678         ?C0143?ZW_PHY_GENERIC_SPI_IF:
006678 F101              ACALL    ?L?COM0157
00667A E9                MOV      A,R1
00667B 4A                ORL      A,R2
00667C 6004              JZ       ?C0146?ZW_PHY_GENERIC_SPI_IF
00667E F1D8              ACALL    ?L?COM058D
006680 8072              SJMP     ?C0156?ZW_PHY_GENERIC_SPI_IF
006682         ?C0146?ZW_PHY_GENERIC_SPI_IF:
006682 7E00              MOV      R6,#00H
006684 7F00              MOV      R7,#00H
006686         ?C0147?ZW_PHY_GENERIC_SPI_IF:
006686 806C              SJMP     ?C0156?ZW_PHY_GENERIC_SPI_IF
006688         ?C0148?ZW_PHY_GENERIC_SPI_IF:
006688 903C44            MOV      DPTR,#length
00668B E0                MOVX     A,@DPTR
00668C FE                MOV      R6,A
00668D A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 146


00668E E0                MOVX     A,@DPTR
00668F FF                MOV      R7,A
006690 4E                ORL      A,R6
006691 606C              JZ       ?C0149?ZW_PHY_GENERIC_SPI_IF
006693 903BFB            MOV      DPTR,#NVRbNVMPageSize
006696 F1D1              ACALL    ?L?COM0539
006698 EF                MOV      A,R7
006699 9D                SUBB     A,R5
00669A EE                MOV      A,R6
00669B 9C                SUBB     A,R4
00669C 400A              JC       ?C0150?ZW_PHY_GENERIC_SPI_IF
00669E 903C46            MOV      DPTR,#i
0066A1 EC                MOV      A,R4
0066A2 F0                MOVX     @DPTR,A
0066A3 A3                INC      DPTR
0066A4 ED                MOV      A,R5
0066A5 F0                MOVX     @DPTR,A
0066A6 800D              SJMP     ?C0151?ZW_PHY_GENERIC_SPI_IF
0066A8         ?C0150?ZW_PHY_GENERIC_SPI_IF:
0066A8 903C44            MOV      DPTR,#length
0066AB E0                MOVX     A,@DPTR
0066AC FF                MOV      R7,A
0066AD A3                INC      DPTR
0066AE E0                MOVX     A,@DPTR
0066AF A3                INC      DPTR
0066B0 CF                XCH      A,R7
0066B1 F0                MOVX     @DPTR,A
0066B2 A3                INC      DPTR
0066B3 EF                MOV      A,R7
0066B4 F0                MOVX     @DPTR,A
0066B5         ?C0151?ZW_PHY_GENERIC_SPI_IF:
0066B5 F128              ACALL    ?L?COM0158
0066B7 126DD0            LCALL    ?L?COM025C
0066BA 602A              JZ       ?C0152?ZW_PHY_GENERIC_SPI_IF
0066BC 12709B            LCALL    ?L?COM0160
0066BF C004              PUSH     AR4
0066C1 C005              PUSH     AR5
0066C3 C006              PUSH     AR6
0066C5 C007              PUSH     AR7
0066C7 F128              ACALL    ?L?COM0158
0066C9 E9                MOV      A,R1
0066CA 4A                ORL      A,R2
0066CB 6005              JZ       ?C0153?ZW_PHY_GENERIC_SPI_IF
0066CD F1C4              ACALL    ?L?COM0395
0066CF FF                MOV      R7,A
0066D0 8002              SJMP     ?C0154?ZW_PHY_GENERIC_SPI_IF
0066D2         ?C0153?ZW_PHY_GENERIC_SPI_IF:
0066D2 7F00              MOV      R7,#00H
0066D4         ?C0154?ZW_PHY_GENERIC_SPI_IF:
0066D4 7E00              MOV      R6,#00H
0066D6 F128              ACALL    ?L?COM0158
0066D8 127188            LCALL    ?L?COM031E
0066DB D007              POP      AR7
0066DD D006              POP      AR6
0066DF D005              POP      AR5
0066E1 D004              POP      AR4
0066E3 123AEB            LCALL    _NVMPutArray_long
0066E6         ?C0152?ZW_PHY_GENERIC_SPI_IF:
0066E6 F101              ACALL    ?L?COM0157
0066E8 E9                MOV      A,R1
0066E9 4A                ORL      A,R2
0066EA 6004              JZ       ?C0155?ZW_PHY_GENERIC_SPI_IF
0066EC F1D8              ACALL    ?L?COM058D
0066EE 8004              SJMP     ?C0156?ZW_PHY_GENERIC_SPI_IF
0066F0         ?C0155?ZW_PHY_GENERIC_SPI_IF:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 147


0066F0 7E00              MOV      R6,#00H
0066F2 7F00              MOV      R7,#00H
0066F4         ?C0156?ZW_PHY_GENERIC_SPI_IF:
0066F4 903C42            MOV      DPTR,#buf+01H
0066F7 EE                MOV      A,R6
0066F8 8FF0              MOV      B,R7
0066FA 122143            LCALL    ?C?IILDX
0066FD 8089              SJMP     ?C0148?ZW_PHY_GENERIC_SPI_IF
0066FF         ?C0149?ZW_PHY_GENERIC_SPI_IF:
0066FF D3                SETB     C
006700 22                RET      
----- FUNCTION _NVM_ext_write_long_buffer (END) -------


----- FUNCTION ?L?COM0157 (BEGIN) -----
006701 903C46            MOV      DPTR,#i
006704 E0                MOVX     A,@DPTR
006705 FE                MOV      R6,A
006706 A3                INC      DPTR
006707 E0                MOVX     A,@DPTR
006708 FF                MOV      R7,A
006709 C3                CLR      C
00670A 903C45            MOV      DPTR,#length+01H
00670D E0                MOVX     A,@DPTR
00670E 9F                SUBB     A,R7
00670F F0                MOVX     @DPTR,A
006710 903C44            MOV      DPTR,#length
006713 E0                MOVX     A,@DPTR
006714 9E                SUBB     A,R6
006715 F0                MOVX     @DPTR,A
006716 903C3D            MOV      DPTR,#offset
006719 1224B5            LCALL    ?C?LLDXDATA0
00671C E4                CLR      A
00671D FC                MOV      R4,A
00671E FD                MOV      R5,A
00671F 12226B            LCALL    ?C?LADD
006722 903C3D            MOV      DPTR,#offset
006725 1224F1            LCALL    ?C?LSTXDATA
006728         ?L?COM0158:
006728 903C41            MOV      DPTR,#buf
00672B 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0157 (END) -------


----- FUNCTION _GetLowestBit (BEGIN) -----
;---- Variable 'val' assigned to Register 'R7' ----
00672E EF                MOV      A,R7
00672F F4                CPL      A
006730 04                INC      A
006731 5F                ANL      A,R7
006732 FF                MOV      R7,A
;----                  JMP      _GetHighestBit
----- FUNCTION _GetLowestBit (END) -------


----- FUNCTION _GetHighestBit (BEGIN) -----
;---- Variable 'val' assigned to Register 'R7' ----
;---- Variable 'retVal' assigned to Register 'R6' ----
006733 E4                CLR      A
006734 FE                MOV      R6,A
006735 EF                MOV      A,R7
006736 7003              JNZ      ?C0130?ZW_PHY_GENERIC_SPI_IF
006738 7FFF              MOV      R7,#0FFH
00673A 22                RET      
00673B         ?C0130?ZW_PHY_GENERIC_SPI_IF:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 148


00673B EF                MOV      A,R7
00673C D3                SETB     C
00673D 940F              SUBB     A,#0FH
00673F 4009              JC       ?C0132?ZW_PHY_GENERIC_SPI_IF
006741 EF                MOV      A,R7
006742 C4                SWAP     A
006743 540F              ANL      A,#0FH
006745 FF                MOV      R7,A
006746 EE                MOV      A,R6
006747 4404              ORL      A,#04H
006749 FE                MOV      R6,A
00674A         ?C0132?ZW_PHY_GENERIC_SPI_IF:
00674A EF                MOV      A,R7
00674B D3                SETB     C
00674C 9403              SUBB     A,#03H
00674E 400A              JC       ?C0133?ZW_PHY_GENERIC_SPI_IF
006750 EF                MOV      A,R7
006751 13                RRC      A
006752 13                RRC      A
006753 543F              ANL      A,#03FH
006755 FF                MOV      R7,A
006756 EE                MOV      A,R6
006757 4402              ORL      A,#02H
006759 FE                MOV      R6,A
00675A         ?C0133?ZW_PHY_GENERIC_SPI_IF:
00675A EF                MOV      A,R7
00675B 30E101            JNB      ACC.1,?C0134?ZW_PHY_GENERIC_SPI_IF
00675E 0E                INC      R6
00675F         ?C0134?ZW_PHY_GENERIC_SPI_IF:
00675F AF06              MOV      R7,AR6
006761 22                RET      
----- FUNCTION _GetHighestBit (END) -------


----- FUNCTION _GetModifiedLength (BEGIN) -----
;---- Variable 'bLength' assigned to Register 'R2/R3' ----
006762 AB07              MOV      R3,AR7
006764 AA06              MOV      R2,AR6
;---- Variable 'bSubBuffers' assigned to Register 'R5' ----
006766 EB                MOV      A,R3
006767 241F              ADD      A,#01FH
006769 FF                MOV      R7,A
00676A E4                CLR      A
00676B 3A                ADDC     A,R2
00676C FE                MOV      R6,A
00676D EF                MOV      A,R7
00676E 7805              MOV      R0,#05H
006770         ?C0188?ZW_PHY_GENERIC_SPI_IF:
006770 CE                XCH      A,R6
006771 C3                CLR      C
006772 13                RRC      A
006773 CE                XCH      A,R6
006774 13                RRC      A
006775 D8F9              DJNZ     R0,?C0188?ZW_PHY_GENERIC_SPI_IF
;---- Variable 'bBlocks' assigned to Register 'R1' ----
006777 F9                MOV      R1,A
006778 EB                MOV      A,R3
006779 541F              ANL      A,#01FH
00677B 90437B            MOV      DPTR,#bRest
00677E F0                MOVX     @DPTR,A
00677F AF05              MOV      R7,AR5
006781 F1C9              ACALL    ?L?COM0396
;---- Variable 'blow' assigned to Register 'R4' ----
006783 FC                MOV      R4,A
006784 AF05              MOV      R7,AR5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 149


006786 F133              ACALL    _GetHighestBit
006788 AE01              MOV      R6,AR1
00678A EE                MOV      A,R6
00678B 14                DEC      A
00678C C3                CLR      C
00678D 9F                SUBB     A,R7
00678E C4                SWAP     A
00678F 33                RLC      A
006790 54E0              ANL      A,#0E0H
;---- Variable 'bhigh' assigned to Register 'R1' ----
006792 F9                MOV      R1,A
006793 AF04              MOV      R7,AR4
006795 C3                CLR      C
006796 EB                MOV      A,R3
006797 9F                SUBB     A,R7
006798 FF                MOV      R7,A
006799 EA                MOV      A,R2
00679A 9400              SUBB     A,#00H
00679C FE                MOV      R6,A
00679D E9                MOV      A,R1
00679E FD                MOV      R5,A
00679F C3                CLR      C
0067A0 EF                MOV      A,R7
0067A1 9D                SUBB     A,R5
0067A2 FF                MOV      R7,A
0067A3 EE                MOV      A,R6
0067A4 9400              SUBB     A,#00H
0067A6 FE                MOV      R6,A
0067A7 ED                MOV      A,R5
0067A8 600F              JZ       ?C0136?ZW_PHY_GENERIC_SPI_IF
0067AA E0                MOVX     A,@DPTR
0067AB FD                MOV      R5,A
0067AC 6007              JZ       ?C0138?ZW_PHY_GENERIC_SPI_IF
0067AE C3                CLR      C
0067AF 7420              MOV      A,#020H
0067B1 9D                SUBB     A,R5
0067B2 FD                MOV      R5,A
0067B3 8006              SJMP     ?C0137?ZW_PHY_GENERIC_SPI_IF
0067B5         ?C0138?ZW_PHY_GENERIC_SPI_IF:
0067B5 7D00              MOV      R5,#00H
0067B7         ?C0139?ZW_PHY_GENERIC_SPI_IF:
0067B7 8002              SJMP     ?C0137?ZW_PHY_GENERIC_SPI_IF
0067B9         ?C0136?ZW_PHY_GENERIC_SPI_IF:
0067B9 7D00              MOV      R5,#00H
0067BB         ?C0137?ZW_PHY_GENERIC_SPI_IF:
0067BB 7C00              MOV      R4,#00H
0067BD EF                MOV      A,R7
0067BE 2D                ADD      A,R5
0067BF FF                MOV      R7,A
0067C0 EC                MOV      A,R4
0067C1 3E                ADDC     A,R6
0067C2 FE                MOV      R6,A
0067C3 22                RET      
----- FUNCTION _GetModifiedLength (END) -------


----- FUNCTION ?L?COM0395 (BEGIN) -----
0067C4 903C4A            MOV      DPTR,#bSubBuffers
0067C7 E0                MOVX     A,@DPTR
0067C8 FF                MOV      R7,A
0067C9         ?L?COM0396:
0067C9 F12E              ACALL    _GetLowestBit
0067CB EF                MOV      A,R7
0067CC C4                SWAP     A
0067CD 33                RLC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 150


0067CE 54E0              ANL      A,#0E0H
0067D0 22                RET      
----- FUNCTION ?L?COM0395 (END) -------


----- FUNCTION ?L?COM0539 (BEGIN) -----
0067D1 E0                MOVX     A,@DPTR
0067D2 FC                MOV      R4,A
0067D3 A3                INC      DPTR
0067D4 E0                MOVX     A,@DPTR
0067D5 FD                MOV      R5,A
0067D6 D3                SETB     C
0067D7 22                RET      
----- FUNCTION ?L?COM0539 (END) -------


----- FUNCTION ?L?COM058D (BEGIN) -----
0067D8 903C46            MOV      DPTR,#i
0067DB E0                MOVX     A,@DPTR
0067DC FE                MOV      R6,A
0067DD A3                INC      DPTR
0067DE E0                MOVX     A,@DPTR
0067DF FF                MOV      R7,A
0067E0 22                RET      
----- FUNCTION ?L?COM058D (END) -------


----- FUNCTION ?L?COM0460 (BEGIN) -----
0067E1 EE                MOV      A,R6
0067E2 F0                MOVX     @DPTR,A
0067E3 A3                INC      DPTR
0067E4 EF                MOV      A,R7
0067E5 F0                MOVX     @DPTR,A
0067E6 4E                ORL      A,R6
0067E7 22                RET      
----- FUNCTION ?L?COM0460 (END) -------


----- FUNCTION __RF_setup_rx_and_filter (BEGIN) -----
;---- Variable 'rxmode' assigned to Register 'R7' ----
0067E8 EF                MOV      A,R7
0067E9 30E00E            JNB      ACC.0,?C0057?ZW_PHY_RF_050X
0067EC 43F401            ORL      DMCTRL,#01H
0067EF E4                CLR      A
0067F0 F5FF              MOV      SFRPAGE,A
0067F2 43A404            ORL      DMHSFLT4,#04H
0067F5 F5FF              MOV      SFRPAGE,A
0067F7 759624            MOV      DMSETUP5,#024H
0067FA         ?C0057?ZW_PHY_RF_050X:
0067FA EF                MOV      A,R7
0067FB 30E10E            JNB      ACC.1,?C0058?ZW_PHY_RF_050X
0067FE 43F401            ORL      DMCTRL,#01H
006801 E4                CLR      A
006802 F5FF              MOV      SFRPAGE,A
006804 43A408            ORL      DMHSFLT4,#08H
006807 F5FF              MOV      SFRPAGE,A
006809 759624            MOV      DMSETUP5,#024H
00680C         ?C0058?ZW_PHY_RF_050X:
00680C EF                MOV      A,R7
00680D 30E209            JNB      ACC.2,?C0059?ZW_PHY_RF_050X
006810 43F402            ORL      DMCTRL,#02H
006813 E4                CLR      A
006814 F5FF              MOV      SFRPAGE,A
006816 75961E            MOV      DMSETUP5,#01EH
006819         ?C0059?ZW_PHY_RF_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 151


006819 EF                MOV      A,R7
00681A 30E309            JNB      ACC.3,?C0060?ZW_PHY_RF_050X
00681D 43F404            ORL      DMCTRL,#04H
006820 E4                CLR      A
006821 F5FF              MOV      SFRPAGE,A
006823 759610            MOV      DMSETUP5,#010H
006826         ?C0060?ZW_PHY_RF_050X:
006826 75FF01            MOV      SFRPAGE,#01H
006829 EF                MOV      A,R7
00682A 5403              ANL      A,#03H
00682C 6004              JZ       ?C0061?ZW_PHY_RF_050X
00682E 75D712            MOV      DFCON1,#012H
006831 22                RET      
006832         ?C0061?ZW_PHY_RF_050X:
006832 75D72D            MOV      DFCON1,#02DH
006835 22                RET      
----- FUNCTION __RF_setup_rx_and_filter (END) -------


----- FUNCTION _RF_init_demodulator (BEGIN) -----
006836 E4                CLR      A
006837 F5FF              MOV      SFRPAGE,A
006839 7584E6            MOV      TRACKCON,#0E6H
00683C F5FF              MOV      SFRPAGE,A
00683E 439404            ORL      DMSETUP1,#04H
006841 F5FF              MOV      SFRPAGE,A
006843 759814            MOV      DMLSPLO,#014H
006846 22                RET      
----- FUNCTION _RF_init_demodulator (END) -------


----- FUNCTION _RF_general_setup (BEGIN) -----
006847 E4                CLR      A
006848 F5FF              MOV      SFRPAGE,A
00684A 75933F            MOV      SEQCON2,#03FH
00684D 75FF03            MOV      SFRPAGE,#03H
006850 759A40            MOV      SEQCON4,#040H
006853 1136              ACALL    _RF_init_demodulator
006855 E4                CLR      A
006856 F5FF              MOV      SFRPAGE,A
006858 759C93            MOV      DMLSFLT3,#093H
00685B F5FF              MOV      SFRPAGE,A
00685D 75A1A3            MOV      DMHSFLT2,#0A3H
006860 F5FF              MOV      SFRPAGE,A
006862 758531            MOV      TRACKHS,#031H
006865 F5FF              MOV      SFRPAGE,A
006867 758628            MOV      TRACKLS,#028H
00686A E5FA              MOV      A,MODCTRL
00686C 5430              ANL      A,#030H
00686E 4480              ORL      A,#080H
006870 F5FA              MOV      MODCTRL,A
006872 75FF01            MOV      SFRPAGE,#01H
006875 75E74A            MOV      SDCON4,#04AH
006878 75FF02            MOV      SFRPAGE,#02H
00687B 75DF49            MOV      SDCON5,#049H
00687E 75FF01            MOV      SFRPAGE,#01H
006881 43D304            ORL      RES1,#04H
006884 75FF01            MOV      SFRPAGE,#01H
006887 53D367            ANL      RES1,#067H
00688A E4                CLR      A
00688B F5FF              MOV      SFRPAGE,A
00688D 53E6BF            ANL      RES3,#0BFH
006890 75FF01            MOV      SFRPAGE,#01H
006893 75D825            MOV      DFCON2,#025H
006896 F5FF              MOV      SFRPAGE,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 152


006898 75B503            MOV      DPLLZXB,#03H
00689B F5FF              MOV      SFRPAGE,A
00689D 75B215            MOV      DPLLZXM,#015H
0068A0 F5FF              MOV      SFRPAGE,A
0068A2 75BA02            MOV      DPLLSBITB,#02H
0068A5 F5FF              MOV      SFRPAGE,A
0068A7 75AFB3            MOV      DPLLMAGEN,#0B3H
0068AA F5FF              MOV      SFRPAGE,A
0068AC 75CD0A            MOV      DPLLGPMD6,#0AH
0068AF F5FF              MOV      SFRPAGE,A
0068B1 75CB08            MOV      DPLLGPMD1,#08H
0068B4 F5FF              MOV      SFRPAGE,A
0068B6 75CA12            MOV      DPLLGIMD1,#012H
0068B9 F5FF              MOV      SFRPAGE,A
0068BB 75BF0E            MOV      DPLLNRM1,#0EH
0068BE F5FF              MOV      SFRPAGE,A
0068C0 75CC96            MOV      DPLLGIMD6,#096H
0068C3 F5FF              MOV      SFRPAGE,A
0068C5 F5BD              MOV      DPLLSTART,A
0068C7 F5FF              MOV      SFRPAGE,A
0068C9 75C281            MOV      DPLLNRM4,#081H
0068CC F5FF              MOV      SFRPAGE,A
0068CE 75AEE1            MOV      DPLLIBBW,#0E1H
0068D1 F5FF              MOV      SFRPAGE,A
0068D3 75DA55            MOV      FHPREAMB,#055H
0068D6 F5FF              MOV      SFRPAGE,A
0068D8 75F580            MOV      DMSETUP2,#080H
0068DB F5FF              MOV      SFRPAGE,A
0068DD 75E903            MOV      DMHSFLT7,#03H
0068E0 F5FF              MOV      SFRPAGE,A
0068E2 75E933            MOV      DMHSFLT7,#033H
0068E5 F5FF              MOV      SFRPAGE,A
0068E7 75972A            MOV      DMSETUP6,#02AH
0068EA 75FF01            MOV      SFRPAGE,#01H
0068ED 759B42            MOV      GSHSET1,#042H
0068F0 759CA4            MOV      GSHSET2,#0A4H
0068F3 759D29            MOV      GSHSET3,#029H
0068F6 759E48            MOV      GSHSET4,#048H
0068F9 759F24            MOV      GSHSET5,#024H
0068FC 75A112            MOV      GSHSET6,#012H
0068FF 75A312            MOV      GSHSET7,#012H
006902 759AF8            MOV      GSHSETX,#0F8H
006905 202F0C            JB       rf_enable,?C0070?ZW_PHY_RF_050X
006908 F5FF              MOV      SFRPAGE,A
00690A 439680            ORL      DMSETUP5,#080H
00690D 90120F            MOV      DPTR,#phyRfData+0EH
006910 E0                MOVX     A,@DPTR
006911 4440              ORL      A,#040H
006913 F0                MOVX     @DPTR,A
006914         ?C0070?ZW_PHY_RF_050X:
006914 22                RET      
----- FUNCTION _RF_general_setup (END) -------


----- FUNCTION __RF_set_IF_setting (BEGIN) -----
;---- Variable 'ch' assigned to Register 'R5' ----
;---- Variable 'highside' assigned to Register 'R4' ----
006915 CC                XCH      A,R4
006916 EF                MOV      A,R7
006917 CC                XCH      A,R4
006918 CF                XCH      A,R7
006919 ED                MOV      A,R5
00691A CF                XCH      A,R7
00691B 7401              MOV      A,#01H
00691D 7E00              MOV      R6,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 153


00691F C8                XCH      A,R0
006920 EF                MOV      A,R7
006921 C8                XCH      A,R0
006922 08                INC      R0
006923 8005              SJMP     ?C0301?ZW_PHY_RF_050X
006925         ?C0300?ZW_PHY_RF_050X:
006925 C3                CLR      C
006926 33                RLC      A
006927 CE                XCH      A,R6
006928 33                RLC      A
006929 CE                XCH      A,R6
00692A         ?C0301?ZW_PHY_RF_050X:
00692A D8F9              DJNZ     R0,?C0300?ZW_PHY_RF_050X
00692C FF                MOV      R7,A
00692D CD                XCH      A,R5
00692E EC                MOV      A,R4
00692F CD                XCH      A,R5
006930 EF                MOV      A,R7
006931 5D                ANL      A,R5
006932 601B              JZ       ?C0065?ZW_PHY_RF_050X
006934 302E18            JNB      rf_enable,?C0065?ZW_PHY_RF_050X
006937 75FF01            MOV      SFRPAGE,#01H
00693A 75DCAD            MOV      RFHSIF,#0ADH
00693D 75FF01            MOV      SFRPAGE,#01H
006940 75DDCD            MOV      RFLSIF,#0CDH
006943 E4                CLR      A
006944 F5FF              MOV      SFRPAGE,A
006946 759A74            MOV      DMLSFLT1,#074H
006949 F5FF              MOV      SFRPAGE,A
00694B 759484            MOV      DMSETUP1,#084H
00694E 22                RET      
00694F         ?C0065?ZW_PHY_RF_050X:
00694F 75FF01            MOV      SFRPAGE,#01H
006952 75DC53            MOV      RFHSIF,#053H
006955 75FF01            MOV      SFRPAGE,#01H
006958 75DD33            MOV      RFLSIF,#033H
00695B E4                CLR      A
00695C F5FF              MOV      SFRPAGE,A
00695E 759A14            MOV      DMLSFLT1,#014H
006961 F5FF              MOV      SFRPAGE,A
006963 759404            MOV      DMSETUP1,#04H
006966 22                RET      
----- FUNCTION __RF_set_IF_setting (END) -------


----- FUNCTION _RF_general_setup_per_ch (BEGIN) -----
006967 75FF01            MOV      SFRPAGE,#01H
00696A 75E465            MOV      SDCON1,#065H
00696D 75FF01            MOV      SFRPAGE,#01H
006970 75D647            MOV      RFCON2,#047H
006973 22                RET      
----- FUNCTION _RF_general_setup_per_ch (END) -------


----- FUNCTION __set_separation_TX (BEGIN) -----
006974 9041FF            MOV      DPTR,#speed
006977 ED                MOV      A,R5
006978 F0                MOVX     @DPTR,A
;---- Variable 'ch' assigned to Register 'R7' ----
;---- Variable 'success' assigned to Register 'R1/R2/R3' ----
006979 901211            MOV      DPTR,#phyRfData+010H
00697C E0                MOVX     A,@DPTR
00697D F4                CPL      A
00697E 6005              JZ       ?C0134?ZW_PHY_RF_050X
006980 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 154


006981 E0                MOVX     A,@DPTR
006982 B4FF0C            CJNE     A,#0FFH,?C0133?ZW_PHY_RF_050X
006985         ?C0134?ZW_PHY_RF_050X:
006985 904201            MOV      DPTR,#txcal1
006988 7418              MOV      A,#018H
00698A F0                MOVX     @DPTR,A
00698B A3                INC      DPTR
00698C 7413              MOV      A,#013H
00698E F0                MOVX     @DPTR,A
00698F 8010              SJMP     ?C0135?ZW_PHY_RF_050X
006991         ?C0133?ZW_PHY_RF_050X:
006991 901211            MOV      DPTR,#phyRfData+010H
006994 E0                MOVX     A,@DPTR
006995 904201            MOV      DPTR,#txcal1
006998 F0                MOVX     @DPTR,A
006999 901212            MOV      DPTR,#phyRfData+011H
00699C E0                MOVX     A,@DPTR
00699D 904202            MOV      DPTR,#txcal2
0069A0 F0                MOVX     @DPTR,A
0069A1         ?C0135?ZW_PHY_RF_050X:
0069A1 121FB3            LCALL    ?C?CLDPTR
0069A4 6401              XRL      A,#01H
0069A6 6002              JZ       $ + 4H
0069A8 41DD              AJMP     ?C0148?ZW_PHY_RF_050X
0069AA 9041FF            MOV      DPTR,#speed
0069AD E0                MOVX     A,@DPTR
0069AE FE                MOV      R6,A
0069AF 6408              XRL      A,#08H
0069B1 6004              JZ       ?C0138?ZW_PHY_RF_050X
0069B3 EE                MOV      A,R6
0069B4 B40408            CJNE     A,#04H,?C0137?ZW_PHY_RF_050X
0069B7         ?C0138?ZW_PHY_RF_050X:
0069B7 904200            MOV      DPTR,#separation
0069BA 7428              MOV      A,#028H
0069BC F0                MOVX     @DPTR,A
0069BD 8006              SJMP     ?C0139?ZW_PHY_RF_050X
0069BF         ?C0137?ZW_PHY_RF_050X:
0069BF 904200            MOV      DPTR,#separation
0069C2 743A              MOV      A,#03AH
0069C4 F0                MOVX     @DPTR,A
0069C5         ?C0139?ZW_PHY_RF_050X:
0069C5 EF                MOV      A,R7
0069C6 124B9F            LCALL    ?L?COM003A
0069C9 1223B0            LCALL    ?C?LNEG
0069CC E4                CLR      A
0069CD 51E5              ACALL    ?L?COM05C1
0069CF EF                MOV      A,R7
0069D0 24D8              ADD      A,#0D8H
0069D2 FF                MOV      R7,A
0069D3 EE                MOV      A,R6
0069D4 343F              ADDC     A,#03FH
0069D6 FE                MOV      R6,A
0069D7 ED                MOV      A,R5
0069D8 3493              ADDC     A,#093H
0069DA FD                MOV      R5,A
0069DB EC                MOV      A,R4
0069DC 3416              ADDC     A,#016H
0069DE FC                MOV      R4,A
0069DF 7B00              MOV      R3,#00H
0069E1 7A80              MOV      R2,#080H
0069E3 7903              MOV      R1,#03H
0069E5 7800              MOV      R0,#00H
0069E7 122F31            LCALL    ?C?SLDIV
0069EA 710A              ACALL    ?L?COM047F
0069EC 904202            MOV      DPTR,#txcal2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 155


0069EF E0                MOVX     A,@DPTR
0069F0 FF                MOV      R7,A
0069F1 904201            MOV      DPTR,#txcal1
0069F4 E0                MOVX     A,@DPTR
0069F5 C3                CLR      C
0069F6 51DE              ACALL    ?L?COM04F0
0069F8 E4                CLR      A
0069F9 FC                MOV      R4,A
0069FA FD                MOV      R5,A
0069FB 122286            LCALL    ?C?LMUL
0069FE EC                MOV      A,R4
0069FF C0E0              PUSH     ACC
006A01 ED                MOV      A,R5
006A02 C0E0              PUSH     ACC
006A04 EE                MOV      A,R6
006A05 C0E0              PUSH     ACC
006A07 EF                MOV      A,R7
006A08 C0E0              PUSH     ACC
006A0A 904202            MOV      DPTR,#txcal2
006A0D E0                MOVX     A,@DPTR
006A0E FF                MOV      R7,A
006A0F E4                CLR      A
006A10 FC                MOV      R4,A
006A11 FD                MOV      R5,A
006A12 FE                MOV      R6,A
006A13 51E5              ACALL    ?L?COM05C1
006A15 D0E0              POP      ACC
006A17 FB                MOV      R3,A
006A18 D0E0              POP      ACC
006A1A FA                MOV      R2,A
006A1B D0E0              POP      ACC
006A1D F9                MOV      R1,A
006A1E D0E0              POP      ACC
006A20 F8                MOV      R0,A
006A21 EB                MOV      A,R3
006A22 2F                ADD      A,R7
006A23 FB                MOV      R3,A
006A24 EA                MOV      A,R2
006A25 3E                ADDC     A,R6
006A26 FA                MOV      R2,A
006A27 E9                MOV      A,R1
006A28 3D                ADDC     A,R5
006A29 F9                MOV      R1,A
006A2A E8                MOV      A,R0
006A2B 3C                ADDC     A,R4
006A2C F8                MOV      R0,A
006A2D 904200            MOV      DPTR,#separation
006A30 E0                MOVX     A,@DPTR
006A31 FF                MOV      R7,A
006A32 E4                CLR      A
006A33 FC                MOV      R4,A
006A34 FD                MOV      R5,A
006A35 FE                MOV      R6,A
006A36 122286            LCALL    ?C?LMUL
006A39 EF                MOV      A,R7
006A3A 2454              ADD      A,#054H
006A3C FF                MOV      R7,A
006A3D EE                MOV      A,R6
006A3E 340B              ADDC     A,#0BH
006A40 1249E1            LCALL    ?L?COM0076
006A43 FC                MOV      R4,A
006A44 E4                CLR      A
006A45 7BA8              MOV      R3,#0A8H
006A47 7A16              MOV      R2,#016H
006A49 F9                MOV      R1,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 156


006A4A F8                MOV      R0,A
006A4B 122F31            LCALL    ?C?SLDIV
;---- Variable 'tx_calibration' assigned to Register 'R3' ----
006A4E CB                XCH      A,R3
006A4F EF                MOV      A,R7
006A50 CB                XCH      A,R3
006A51 9041FF            MOV      DPTR,#speed
006A54 E0                MOVX     A,@DPTR
006A55 14                DEC      A
006A56 605D              JZ       ?C0147?ZW_PHY_RF_050X
006A58 14                DEC      A
006A59 601B              JZ       ?C0143?ZW_PHY_RF_050X
006A5B 24FE              ADD      A,#0FEH
006A5D 600C              JZ       ?C0142?ZW_PHY_RF_050X
006A5F 24FC              ADD      A,#0FCH
006A61 707A              JNZ      ?C0148?ZW_PHY_RF_050X
006A63         ?C0141?ZW_PHY_RF_050X:
006A63 E4                CLR      A
006A64 F5FF              MOV      SFRPAGE,A
006A66 75CE31            MOV      DPLLGSCON,#031H
006A69 8006              SJMP     ?C0307?ZW_PHY_RF_050X
006A6B         ?C0142?ZW_PHY_RF_050X:
006A6B E4                CLR      A
006A6C F5FF              MOV      SFRPAGE,A
006A6E 75CE21            MOV      DPLLGSCON,#021H
006A71         
006A71 F5FF              MOV      SFRPAGE,A
006A73 8BCF              MOV      DPLLGSVLO,R3
006A75 22                RET      
006A76         ?C0143?ZW_PHY_RF_050X:
;---- Variable 'loop' assigned to Register 'R2' ----
006A76 E4                CLR      A
006A77 FA                MOV      R2,A
006A78         ?C0144?ZW_PHY_RF_050X:
006A78 E4                CLR      A
006A79 F5FF              MOV      SFRPAGE,A
006A7B EA                MOV      A,R2
006A7C 2440              ADD      A,#040H
006A7E F5CE              MOV      DPLLGSCON,A
006A80 E4                CLR      A
006A81 F5FF              MOV      SFRPAGE,A
006A83 EA                MOV      A,R2
006A84 FF                MOV      R7,A
006A85 C3                CLR      C
006A86 7407              MOV      A,#07H
006A88 51DE              ACALL    ?L?COM04F0
006A8A 740A              MOV      A,#LOW GAUSS_CONSTANTS
006A8C 2F                ADD      A,R7
006A8D F582              MOV      DPL,A
006A8F 7418              MOV      A,#HIGH GAUSS_CONSTANTS
006A91 3E                ADDC     A,R6
006A92 F583              MOV      DPH,A
006A94 E4                CLR      A
006A95 51ED              ACALL    ?L?COM0281
006A97 C3                CLR      C
006A98 9D                SUBB     A,R5
006A99 F5CF              MOV      DPLLGSVLO,A
006A9B E4                CLR      A
006A9C F5FF              MOV      SFRPAGE,A
006A9E EA                MOV      A,R2
006A9F 2448              ADD      A,#048H
006AA1 F5CE              MOV      DPLLGSCON,A
006AA3 E4                CLR      A
006AA4 F5FF              MOV      SFRPAGE,A
006AA6 EA                MOV      A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 157


006AA7 90180A            MOV      DPTR,#GAUSS_CONSTANTS
006AAA 51ED              ACALL    ?L?COM0281
006AAC 2D                ADD      A,R5
006AAD F5CF              MOV      DPLLGSVLO,A
006AAF 0A                INC      R2
006AB0 EA                MOV      A,R2
006AB1 B408C4            CJNE     A,#08H,?C0144?ZW_PHY_RF_050X
006AB4 22                RET      
006AB5         ?C0147?ZW_PHY_RF_050X:
006AB5 E4                CLR      A
006AB6 F5FF              MOV      SFRPAGE,A
006AB8 75CE01            MOV      DPLLGSCON,#01H
006ABB F5FF              MOV      SFRPAGE,A
006ABD 8BCF              MOV      DPLLGSVLO,R3
006ABF F5FF              MOV      SFRPAGE,A
006AC1 75CE0E            MOV      DPLLGSCON,#0EH
006AC4 F5FF              MOV      SFRPAGE,A
006AC6 EB                MOV      A,R3
006AC7 25E0              ADD      A,ACC
006AC9 F5CF              MOV      DPLLGSVLO,A
006ACB E4                CLR      A
006ACC F5FF              MOV      SFRPAGE,A
006ACE 75CE0F            MOV      DPLLGSCON,#0FH
006AD1 F5FF              MOV      SFRPAGE,A
006AD3 CF                XCH      A,R7
006AD4 EB                MOV      A,R3
006AD5 CF                XCH      A,R7
006AD6 EB                MOV      A,R3
006AD7 75F003            MOV      B,#03H
006ADA A4                MUL      AB
006ADB F5CF              MOV      DPLLGSVLO,A
006ADD         ?C0148?ZW_PHY_RF_050X:
006ADD 22                RET      
----- FUNCTION __set_separation_TX (END) -------


----- FUNCTION ?L?COM04F0 (BEGIN) -----
006ADE 9F                SUBB     A,R7
006ADF FF                MOV      R7,A
006AE0 E4                CLR      A
006AE1 9400              SUBB     A,#00H
006AE3 FE                MOV      R6,A
006AE4 22                RET      
----- FUNCTION ?L?COM04F0 (END) -------


----- FUNCTION ?L?COM05C1 (BEGIN) -----
006AE5 7B64              MOV      R3,#064H
006AE7 FA                MOV      R2,A
006AE8 F9                MOV      R1,A
006AE9 F8                MOV      R0,A
006AEA 022286            LJMP     ?C?LMUL
----- FUNCTION ?L?COM05C1 (END) -------


----- FUNCTION ?L?COM0281 (BEGIN) -----
006AED 93                MOVC     A,@A+DPTR
006AEE 25E0              ADD      A,ACC
006AF0 FD                MOV      R5,A
006AF1 E4                CLR      A
006AF2 33                RLC      A
006AF3 FC                MOV      R4,A
006AF4 EB                MOV      A,R3
006AF5 75F010            MOV      B,#010H
006AF8 A4                MUL      AB
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 158


006AF9 FF                MOV      R7,A
006AFA AEF0              MOV      R6,B
006AFC 1220B8            LCALL    ?C?UIDIV
006AFF CD                XCH      A,R5
006B00 EF                MOV      A,R7
006B01 CD                XCH      A,R5
006B02 EB                MOV      A,R3
006B03 FF                MOV      R7,A
006B04 E4                CLR      A
006B05 C3                CLR      C
006B06 13                RRC      A
006B07 EF                MOV      A,R7
006B08 13                RRC      A
006B09 22                RET      
----- FUNCTION ?L?COM0281 (END) -------


----- FUNCTION ?L?COM047F (BEGIN) -----
006B0A C8                XCH      A,R0
006B0B EC                MOV      A,R4
006B0C C8                XCH      A,R0
006B0D C9                XCH      A,R1
006B0E ED                MOV      A,R5
006B0F C9                XCH      A,R1
006B10 CA                XCH      A,R2
006B11 EE                MOV      A,R6
006B12 CA                XCH      A,R2
006B13 CB                XCH      A,R3
006B14 EF                MOV      A,R7
006B15 CB                XCH      A,R3
006B16 22                RET      
----- FUNCTION ?L?COM047F (END) -------


----- FUNCTION _RF_TX_speed_set (BEGIN) -----
;---- Variable 'speed' assigned to Register 'R7' ----
006B17 75FF01            MOV      SFRPAGE,#01H
006B1A E5D5              MOV      A,RFCON
006B1C 30E602            JNB      ACC.6,?C0182?ZW_PHY_RF_050X
006B1F C3                CLR      C
006B20 22                RET      
006B21         ?C0182?ZW_PHY_RF_050X:
006B21 53FACF            ANL      MODCTRL,#0CFH
006B24 EF                MOV      A,R7
006B25 B40805            CJNE     A,#08H,?C0184?ZW_PHY_RF_050X
006B28 43FA30            ORL      MODCTRL,#030H
006B2B 8012              SJMP     ?C0185?ZW_PHY_RF_050X
006B2D         ?C0184?ZW_PHY_RF_050X:
006B2D EF                MOV      A,R7
006B2E B40405            CJNE     A,#04H,?C0186?ZW_PHY_RF_050X
006B31 43FA20            ORL      MODCTRL,#020H
006B34 8009              SJMP     ?C0185?ZW_PHY_RF_050X
006B36         ?C0186?ZW_PHY_RF_050X:
006B36 EF                MOV      A,R7
006B37 B40205            CJNE     A,#02H,?C0188?ZW_PHY_RF_050X
006B3A 43FA10            ORL      MODCTRL,#010H
006B3D 8000              SJMP     ?C0185?ZW_PHY_RF_050X
006B3F         ?C0188?ZW_PHY_RF_050X:
006B3F         ?C0185?ZW_PHY_RF_050X:
006B3F D3                SETB     C
006B40 22                RET      
----- FUNCTION _RF_TX_speed_set (END) -------


----- FUNCTION RF_channel_get (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 159


006B41 E5F4              MOV      A,DMCTRL
006B43 5418              ANL      A,#018H
006B45 13                RRC      A
006B46 13                RRC      A
006B47 13                RRC      A
006B48 541F              ANL      A,#01FH
006B4A FF                MOV      R7,A
006B4B 22                RET      
----- FUNCTION RF_channel_get (END) -------


----- FUNCTION RF_RX_speed_get (BEGIN) -----
006B4C E5F7              MOV      A,DMSTAT1
006B4E 5406              ANL      A,#06H
006B50 FF                MOV      R7,A
006B51 BF0603            CJNE     R7,#06H,?C0223?ZW_PHY_RF_050X
006B54 7F08              MOV      R7,#08H
006B56 22                RET      
006B57         ?C0223?ZW_PHY_RF_050X:
006B57 E5F7              MOV      A,DMSTAT1
006B59 5406              ANL      A,#06H
006B5B FF                MOV      R7,A
006B5C BF0403            CJNE     R7,#04H,?C0225?ZW_PHY_RF_050X
006B5F 7F04              MOV      R7,#04H
006B61 22                RET      
006B62         ?C0225?ZW_PHY_RF_050X:
006B62 E5F7              MOV      A,DMSTAT1
006B64 5406              ANL      A,#06H
006B66 FF                MOV      R7,A
006B67 BF0203            CJNE     R7,#02H,?C0226?ZW_PHY_RF_050X
006B6A 7F02              MOV      R7,#02H
006B6C 22                RET      
006B6D         ?C0226?ZW_PHY_RF_050X:
006B6D 7F01              MOV      R7,#01H
006B6F 22                RET      
----- FUNCTION RF_RX_speed_get (END) -------


----- FUNCTION _RF_TX_power_set (BEGIN) -----
;---- Variable 'power' assigned to Register 'R7' ----
006B70 75FF01            MOV      SFRPAGE,#01H
006B73 8FDA              MOV      RFPOW,R7
006B75 22                RET      
----- FUNCTION _RF_TX_power_set (END) -------


----- FUNCTION RF_IsSofDetected (BEGIN) -----
006B76 E5F7              MOV      A,DMSTAT1
006B78 54C0              ANL      A,#0C0H
006B7A 24FF              ADD      A,#0FFH
006B7C 22                RET      
----- FUNCTION RF_IsSofDetected (END) -------


----- FUNCTION _ZW_UART0_zm4102_mode_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
006B7D EF                MOV      A,R7
006B7E 6007              JZ       ?C0008?ZW_PHY_UART0_050X
006B80 75FF02            MOV      SFRPAGE,#02H
006B83 43E610            ORL      RSETVEC,#010H
006B86 22                RET      
006B87         ?C0008?ZW_PHY_UART0_050X:
006B87 75FF02            MOV      SFRPAGE,#02H
006B8A 53E6EF            ANL      RSETVEC,#0EFH
006B8D 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 160


----- FUNCTION _ZW_UART0_zm4102_mode_enable (END) -------


----- FUNCTION ZW_UART0_rx_int_clear (BEGIN) -----
006B8E 75ED04            MOV      UARTSTAT,#04H
006B91 22                RET      
----- FUNCTION ZW_UART0_rx_int_clear (END) -------


----- FUNCTION ZDB_UART_RX_TX_interrupt (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE_DRIVER.C'
  201: static void ZDB_UART_RX_TX_interrupt(void) interrupt ZDB_INUM_SERIAL
006B92 C0E0              PUSH     ACC
006B94 C0F0              PUSH     B
006B96 C083              PUSH     DPH
006B98 C082              PUSH     DPL
006B9A C0D0              PUSH     PSW
006B9C 75D000            MOV      PSW,#00H
006B9F C000              PUSH     AR0
006BA1 C001              PUSH     AR1
006BA3 C002              PUSH     AR2
006BA5 C003              PUSH     AR3
006BA7 C004              PUSH     AR4
006BA9 C005              PUSH     AR5
006BAB C006              PUSH     AR6
006BAD C007              PUSH     AR7
  202: {
  203:   _push_(SFRPAGE);
006BAF C0FF              PUSH     SFRPAGE
  204:   if (ZW_UART0_rx_int_get() != 0x00)
006BB1 71E9              ACALL    ZW_UART0_rx_int_get
006BB3 EF                MOV      A,R7
006BB4 6016              JZ       ?C0002?ZW_TEST_INTERFACE_DRIVER
  205:   {
  206:     dmaBufferOffset = (ZW_UART0_rx_dma_status() & 0x02) ? 0 : DMA_BUFFER_SIZE_SINGLE;
006BB6 71EF              ACALL    ZW_UART0_rx_dma_status
006BB8 EF                MOV      A,R7
006BB9 7F20              MOV      R7,#020H
006BBB 30E102            JNB      ACC.1,?C0003?ZW_TEST_INTERFACE_DRIVER
006BBE 7F00              MOV      R7,#00H
006BC0         ?C0003?ZW_TEST_INTERFACE_DRIVER:
006BC0         ?C0004?ZW_TEST_INTERFACE_DRIVER:
006BC0 9009F3            MOV      DPTR,#dmaBufferOffset
006BC3 EF                MOV      A,R7
006BC4 F0                MOVX     @DPTR,A
  207:     dmaDataIsReady = TRUE;
006BC5 D256              SETB     dmaDataIsReady
  208:     TaskInterruptSignal();
006BC7 121E44            LCALL    ?INTERBANK_TABLE?TaskInterruptSignal
  209:     ZW_UART0_rx_int_clear();
006BCA 718E              ACALL    ZW_UART0_rx_int_clear
  210:   }
006BCC         ?C0002?ZW_TEST_INTERFACE_DRIVER:
  211:   _pop_(SFRPAGE);
006BCC D0FF              POP      SFRPAGE
  212: }
006BCE D007              POP      AR7
006BD0 D006              POP      AR6
006BD2 D005              POP      AR5
006BD4 D004              POP      AR4
006BD6 D003              POP      AR3
006BD8 D002              POP      AR2
006BDA D001              POP      AR1
006BDC D000              POP      AR0
006BDE D0D0              POP      PSW
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 161


006BE0 D082              POP      DPL
006BE2 D083              POP      DPH
006BE4 D0F0              POP      B
006BE6 D0E0              POP      ACC
006BE8 32                RETI     
----- FUNCTION ZDB_UART_RX_TX_interrupt (END) -------


----- FUNCTION ZW_UART0_rx_int_get (BEGIN) -----
006BE9 E5ED              MOV      A,UARTSTAT
006BEB 5404              ANL      A,#04H
006BED FF                MOV      R7,A
006BEE 22                RET      
----- FUNCTION ZW_UART0_rx_int_get (END) -------


----- FUNCTION ZW_UART0_rx_dma_status (BEGIN) -----
006BEF 75FF02            MOV      SFRPAGE,#02H
006BF2 E5B2              MOV      A,UART0RXF
006BF4 5402              ANL      A,#02H
006BF6 FF                MOV      R7,A
;---- Variable 'r' assigned to Register 'R6/R7' ----
006BF7 E5B4              MOV      A,UART0RXF2
006BF9 54E0              ANL      A,#0E0H
006BFB FD                MOV      R5,A
006BFC ED                MOV      A,R5
006BFD 4F                ORL      A,R7
006BFE FF                MOV      R7,A
006BFF E5B2              MOV      A,UART0RXF
006C01 5410              ANL      A,#010H
006C03 FD                MOV      R5,A
006C04 EF                MOV      A,R7
006C05 4D                ORL      A,R5
006C06 FF                MOV      R7,A
006C07 43B4E0            ORL      UART0RXF2,#0E0H
006C0A 22                RET      
----- FUNCTION ZW_UART0_rx_dma_status (END) -------


----- FUNCTION ZW_UART0_tx_int_clear (BEGIN) -----
006C0B 75ED02            MOV      UARTSTAT,#02H
006C0E 22                RET      
----- FUNCTION ZW_UART0_tx_int_clear (END) -------


----- FUNCTION ZW_UART0_rx_data_wait_get (BEGIN) -----
006C0F         ?C0013?ZW_PHY_UART0_050X:
006C0F E5ED              MOV      A,UARTSTAT
006C11 30E2FB            JNB      ACC.2,?C0013?ZW_PHY_UART0_050X
006C14         ?C0014?ZW_PHY_UART0_050X:
006C14 75ED04            MOV      UARTSTAT,#04H
;---- Variable 'tmp' assigned to Register 'R7' ----
006C17 AFEF              MOV      R7,UART0BUF
006C19 22                RET      
----- FUNCTION ZW_UART0_rx_data_wait_get (END) -------


----- FUNCTION ZW_UART0_rx_data_get (BEGIN) -----
;---- Variable 'tmp' assigned to Register 'R7' ----
006C1A AFEF              MOV      R7,UART0BUF
006C1C 22                RET      
----- FUNCTION ZW_UART0_rx_data_get (END) -------


----- FUNCTION _ZW_UART0_tx_data_set (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 162


;---- Variable 'bData' assigned to Register 'R7' ----
006C1D 8FEF              MOV      UART0BUF,R7
006C1F 22                RET      
----- FUNCTION _ZW_UART0_tx_data_set (END) -------


----- FUNCTION _ZW_UART0_tx_send_byte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
006C20         ?C0018?ZW_PHY_UART0_050X:
006C20 E5ED              MOV      A,UARTSTAT
006C22 20E0FB            JB       ACC.0,?C0018?ZW_PHY_UART0_050X
006C25         ?C0019?ZW_PHY_UART0_050X:
006C25 8FEF              MOV      UART0BUF,R7
006C27 22                RET      
----- FUNCTION _ZW_UART0_tx_send_byte (END) -------


----- FUNCTION _ZW_UART0_rx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
006C28 EF                MOV      A,R7
006C29 6004              JZ       ?C0021?ZW_PHY_UART0_050X
006C2B 43EC04            ORL      UARTCON,#04H
006C2E 22                RET      
006C2F         ?C0021?ZW_PHY_UART0_050X:
006C2F 53ECFB            ANL      UARTCON,#0FBH
006C32 22                RET      
----- FUNCTION _ZW_UART0_rx_enable (END) -------


----- FUNCTION _ZW_UART0_tx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
006C33 EF                MOV      A,R7
006C34 6004              JZ       ?C0024?ZW_PHY_UART0_050X
006C36 43EC08            ORL      UARTCON,#08H
006C39 22                RET      
006C3A         ?C0024?ZW_PHY_UART0_050X:
006C3A 53ECF7            ANL      UARTCON,#0F7H
006C3D 22                RET      
----- FUNCTION _ZW_UART0_tx_enable (END) -------


----- FUNCTION ZW_UART0_tx_int_get (BEGIN) -----
006C3E E5ED              MOV      A,UARTSTAT
006C40 5402              ANL      A,#02H
006C42 FF                MOV      R7,A
006C43 22                RET      
----- FUNCTION ZW_UART0_tx_int_get (END) -------


----- FUNCTION ZW_UART0_tx_active_get (BEGIN) -----
006C44 E5ED              MOV      A,UARTSTAT
006C46 5401              ANL      A,#01H
006C48 FF                MOV      R7,A
006C49 22                RET      
----- FUNCTION ZW_UART0_tx_active_get (END) -------


----- FUNCTION _NVM_get_id (BEGIN) -----
;---- Variable 'pNVM_type' assigned to Register 'R1/R2/R3' ----
006C4A 903BF4            MOV      DPTR,#manufacturerID
006C4D E0                MOVX     A,@DPTR
006C4E 122072            LCALL    ?C?CSTPTR
006C51 903BF9            MOV      DPTR,#memoryType
006C54 E0                MOVX     A,@DPTR
006C55 900001            MOV      DPTR,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 163


006C58 122084            LCALL    ?C?CSTOPTR
006C5B 903BFA            MOV      DPTR,#memoryCapacity
006C5E E0                MOVX     A,@DPTR
006C5F 900002            MOV      DPTR,#02H
006C62 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _NVM_get_id (END) -------


----- FUNCTION ?L?COM0207 (BEGIN) -----
006C65 AE02              MOV      R6,AR2
006C67 AF01              MOV      R7,AR1
006C69         ?L?COM0208:
006C69 7B01              MOV      R3,#01H
006C6B 7A39              MOV      R2,#HIGH dataLengthNew
006C6D 79C2              MOV      R1,#LOW dataLengthNew
006C6F 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
006C72 E4                CLR      A
006C73 F0                MOVX     @DPTR,A
006C74 A3                INC      DPTR
006C75 7402              MOV      A,#02H
006C77 F0                MOVX     @DPTR,A
----- FUNCTION _NVM_ext_write_buffer (BEGIN) -----
006C78 90402A            MOV      DPTR,#buf
006C7B 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'offset' assigned to Register 'R6/R7' ----
006C7E E4                CLR      A
006C7F FC                MOV      R4,A
006C80 FD                MOV      R5,A
006C81 C007              PUSH     AR7
006C83 90402A            MOV      DPTR,#buf
006C86 122589            LCALL    ?C?PLDXDATA
006C89 90402D            MOV      DPTR,#length
006C8C 9193              ACALL    ?L?COM0467
006C8E D007              POP      AR7
006C90 026600            LJMP     _NVM_ext_write_long_buffer
----- FUNCTION _NVM_ext_write_buffer (END) -------


----- FUNCTION ?L?COM0467 (BEGIN) -----
006C93 E0                MOVX     A,@DPTR
006C94 FF                MOV      R7,A
006C95 A3                INC      DPTR
006C96 E0                MOVX     A,@DPTR
006C97 903C44            MOV      DPTR,#?_NVM_ext_write_long_buffer?BYTE+07H
006C9A CF                XCH      A,R7
006C9B F0                MOVX     @DPTR,A
006C9C A3                INC      DPTR
006C9D EF                MOV      A,R7
006C9E F0                MOVX     @DPTR,A
006C9F 22                RET      
----- FUNCTION ?L?COM0467 (END) -------


----- FUNCTION _IsSaved_long (BEGIN) -----
006CA0 9036F0            MOV      DPTR,#offset
006CA3 1224F1            LCALL    ?C?LSTXDATA
006CA6 9036F4            MOV      DPTR,#buf
006CA9 1225A9            LCALL    ?C?PSTXDATA
006CAC E4                CLR      A
006CAD 903719            MOV      DPTR,#i
006CB0 F0                MOVX     @DPTR,A
006CB1 D3                SETB     C
006CB2 9036F8            MOV      DPTR,#length+01H
006CB5 E0                MOVX     A,@DPTR
006CB6 9420              SUBB     A,#020H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 164


006CB8 9036F7            MOV      DPTR,#length
006CBB E0                MOVX     A,@DPTR
006CBC 9400              SUBB     A,#00H
006CBE 4001              JC       ?C0159?ZW_PHY_GENERIC_SPI_IF
006CC0 22                RET      
006CC1         ?C0159?ZW_PHY_GENERIC_SPI_IF:
006CC1 7B01              MOV      R3,#01H
006CC3 7A36              MOV      R2,#HIGH dataFlash
006CC5 79F9              MOV      R1,#LOW dataFlash
006CC7 9036F7            MOV      DPTR,#length
006CCA E0                MOVX     A,@DPTR
006CCB FF                MOV      R7,A
006CCC A3                INC      DPTR
006CCD E0                MOVX     A,@DPTR
006CCE 903E70            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
006CD1 CF                XCH      A,R7
006CD2 F0                MOVX     @DPTR,A
006CD3 A3                INC      DPTR
006CD4 EF                MOV      A,R7
006CD5 F0                MOVX     @DPTR,A
006CD6 9036F0            MOV      DPTR,#offset
006CD9 122499            LCALL    ?C?LLDXDATA
006CDC 123C58            LCALL    _NVM_ext_read_long_buffer
006CDF         ?C0163?ZW_PHY_GENERIC_SPI_IF:
006CDF 9036F4            MOV      DPTR,#buf
006CE2 122589            LCALL    ?C?PLDXDATA
006CE5 E9                MOV      A,R1
006CE6 4A                ORL      A,R2
006CE7 6009              JZ       ?C0165?ZW_PHY_GENERIC_SPI_IF
006CE9 903719            MOV      DPTR,#i
006CEC E0                MOVX     A,@DPTR
006CED B1C8              ACALL    ?L?COM01D9
006CEF FF                MOV      R7,A
006CF0 8002              SJMP     ?C0166?ZW_PHY_GENERIC_SPI_IF
006CF2         ?C0165?ZW_PHY_GENERIC_SPI_IF:
006CF2 7F00              MOV      R7,#00H
006CF4         ?C0166?ZW_PHY_GENERIC_SPI_IF:
006CF4 903719            MOV      DPTR,#i
006CF7 E0                MOVX     A,@DPTR
006CF8 24F9              ADD      A,#LOW dataFlash
006CFA F582              MOV      DPL,A
006CFC E4                CLR      A
006CFD 3436              ADDC     A,#HIGH dataFlash
006CFF F583              MOV      DPH,A
006D01 E0                MOVX     A,@DPTR
006D02 6F                XRL      A,R7
006D03 6002              JZ       ?C0161?ZW_PHY_GENERIC_SPI_IF
006D05 C3                CLR      C
006D06 22                RET      
006D07         ?C0161?ZW_PHY_GENERIC_SPI_IF:
006D07 903719            MOV      DPTR,#i
006D0A E0                MOVX     A,@DPTR
006D0B 04                INC      A
006D0C FF                MOV      R7,A
006D0D F0                MOVX     @DPTR,A
006D0E D3                SETB     C
006D0F 9036F8            MOV      DPTR,#length+01H
006D12 E0                MOVX     A,@DPTR
006D13 9F                SUBB     A,R7
006D14 9036F7            MOV      DPTR,#length
006D17 E0                MOVX     A,@DPTR
006D18 9400              SUBB     A,#00H
006D1A 50C3              JNC      ?C0163?ZW_PHY_GENERIC_SPI_IF
006D1C 22                RET      
----- FUNCTION _IsSaved_long (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 165




----- FUNCTION _IsSaved_split (BEGIN) -----
006D1D B1BE              ACALL    ?L?COM056C
006D1F 1225A9            LCALL    ?C?PSTXDATA
006D22 E4                CLR      A
006D23 903D42            MOV      DPTR,#bPages
006D26 F0                MOVX     @DPTR,A
006D27 A3                INC      DPTR
006D28 04                INC      A
006D29 F0                MOVX     @DPTR,A
006D2A         ?C0167?ZW_PHY_GENERIC_SPI_IF:
006D2A 903D3F            MOV      DPTR,#length
006D2D E0                MOVX     A,@DPTR
006D2E FE                MOV      R6,A
006D2F A3                INC      DPTR
006D30 E0                MOVX     A,@DPTR
006D31 FF                MOV      R7,A
006D32 4E                ORL      A,R6
006D33 7002              JNZ      $ + 4H
006D35 A1B8              AJMP     ?C0168?ZW_PHY_GENERIC_SPI_IF
006D37 D3                SETB     C
006D38 EF                MOV      A,R7
006D39 9420              SUBB     A,#020H
006D3B EE                MOV      A,R6
006D3C 9400              SUBB     A,#00H
006D3E 4004              JC       ?C0169?ZW_PHY_GENERIC_SPI_IF
006D40 7F20              MOV      R7,#020H
006D42 8006              SJMP     ?C0170?ZW_PHY_GENERIC_SPI_IF
006D44         ?C0169?ZW_PHY_GENERIC_SPI_IF:
006D44 903D3F            MOV      DPTR,#length
006D47 A3                INC      DPTR
006D48 E0                MOVX     A,@DPTR
006D49 FF                MOV      R7,A
006D4A         ?C0170?ZW_PHY_GENERIC_SPI_IF:
006D4A 903D41            MOV      DPTR,#bSubBufferLength
006D4D EF                MOV      A,R7
006D4E F0                MOVX     @DPTR,A
006D4F 903D3C            MOV      DPTR,#buf
006D52 122589            LCALL    ?C?PLDXDATA
006D55 903D41            MOV      DPTR,#bSubBufferLength
006D58 E0                MOVX     A,@DPTR
006D59 FF                MOV      R7,A
006D5A 9036F7            MOV      DPTR,#?_IsSaved_long?BYTE+07H
006D5D E4                CLR      A
006D5E F0                MOVX     @DPTR,A
006D5F A3                INC      DPTR
006D60 EF                MOV      A,R7
006D61 F0                MOVX     @DPTR,A
006D62 903D38            MOV      DPTR,#offset
006D65 122499            LCALL    ?C?LLDXDATA
006D68 91A0              ACALL    _IsSaved_long
006D6A 400E              JC       ?C0171?ZW_PHY_GENERIC_SPI_IF
006D6C 903D42            MOV      DPTR,#bPages
006D6F E0                MOVX     A,@DPTR
006D70 FF                MOV      R7,A
006D71 A3                INC      DPTR
006D72 E0                MOVX     A,@DPTR
006D73 FE                MOV      R6,A
006D74 EF                MOV      A,R7
006D75 4E                ORL      A,R6
006D76 903D42            MOV      DPTR,#bPages
006D79 F0                MOVX     @DPTR,A
006D7A         ?C0171?ZW_PHY_GENERIC_SPI_IF:
006D7A 903D41            MOV      DPTR,#bSubBufferLength
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 166


006D7D E0                MOVX     A,@DPTR
006D7E FF                MOV      R7,A
006D7F C3                CLR      C
006D80 903D40            MOV      DPTR,#length+01H
006D83 E0                MOVX     A,@DPTR
006D84 9F                SUBB     A,R7
006D85 F0                MOVX     @DPTR,A
006D86 903D3F            MOV      DPTR,#length
006D89 E0                MOVX     A,@DPTR
006D8A 9400              SUBB     A,#00H
006D8C F0                MOVX     @DPTR,A
006D8D 903D38            MOV      DPTR,#offset
006D90 1224B5            LCALL    ?C?LLDXDATA0
006D93 903D41            MOV      DPTR,#bSubBufferLength
006D96 B1F3              ACALL    ?L?COM0609
006D98 B1BE              ACALL    ?L?COM056C
006D9A 122589            LCALL    ?C?PLDXDATA
006D9D E9                MOV      A,R1
006D9E 4A                ORL      A,R2
006D9F 6007              JZ       ?C0172?ZW_PHY_GENERIC_SPI_IF
006DA1 903D41            MOV      DPTR,#bSubBufferLength
006DA4 E0                MOVX     A,@DPTR
006DA5 FF                MOV      R7,A
006DA6 8002              SJMP     ?C0173?ZW_PHY_GENERIC_SPI_IF
006DA8         ?C0172?ZW_PHY_GENERIC_SPI_IF:
006DA8 7F00              MOV      R7,#00H
006DAA         ?C0173?ZW_PHY_GENERIC_SPI_IF:
006DAA 903D3D            MOV      DPTR,#buf+01H
006DAD B1ED              ACALL    ?L?COM0518
006DAF 903D43            MOV      DPTR,#flag
006DB2 E0                MOVX     A,@DPTR
006DB3 25E0              ADD      A,ACC
006DB5 F0                MOVX     @DPTR,A
006DB6 A12A              AJMP     ?C0167?ZW_PHY_GENERIC_SPI_IF
006DB8         ?C0168?ZW_PHY_GENERIC_SPI_IF:
006DB8 903D42            MOV      DPTR,#bPages
006DBB E0                MOVX     A,@DPTR
006DBC FF                MOV      R7,A
006DBD 22                RET      
----- FUNCTION _IsSaved_split (END) -------


----- FUNCTION ?L?COM056C (BEGIN) -----
006DBE 903D38            MOV      DPTR,#offset
006DC1 1224F1            LCALL    ?C?LSTXDATA
006DC4 903D3C            MOV      DPTR,#buf
006DC7 22                RET      
----- FUNCTION ?L?COM056C (END) -------


----- FUNCTION ?L?COM01D9 (BEGIN) -----
006DC8 F582              MOV      DPL,A
006DCA         ?L?COM01DA:
006DCA 758300            MOV      DPH,#00H
006DCD 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM01D9 (END) -------


----- FUNCTION ?L?COM025C (BEGIN) -----
006DD0 903C46            MOV      DPTR,#i
006DD3 E0                MOVX     A,@DPTR
006DD4 FF                MOV      R7,A
006DD5 A3                INC      DPTR
006DD6 E0                MOVX     A,@DPTR
006DD7 903D3F            MOV      DPTR,#?_IsSaved_split?BYTE+07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 167


006DDA CF                XCH      A,R7
006DDB F0                MOVX     @DPTR,A
006DDC A3                INC      DPTR
006DDD EF                MOV      A,R7
006DDE F0                MOVX     @DPTR,A
006DDF 903C3D            MOV      DPTR,#offset
006DE2 122499            LCALL    ?C?LLDXDATA
006DE5 B11D              ACALL    _IsSaved_split
006DE7 903C4A            MOV      DPTR,#bSubBuffers
006DEA EF                MOV      A,R7
006DEB F0                MOVX     @DPTR,A
006DEC 22                RET      
----- FUNCTION ?L?COM025C (END) -------


----- FUNCTION ?L?COM0518 (BEGIN) -----
006DED E4                CLR      A
006DEE 8FF0              MOV      B,R7
006DF0 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM0518 (END) -------


----- FUNCTION ?L?COM0609 (BEGIN) -----
006DF3 E4                CLR      A
006DF4 FC                MOV      R4,A
006DF5 FD                MOV      R5,A
006DF6 FE                MOV      R6,A
006DF7 02226B            LJMP     ?C?LADD
----- FUNCTION ?L?COM0609 (END) -------


----- FUNCTION NVM_ext_read_status (BEGIN) -----
006DFA 903BF6            MOV      DPTR,#bNVMstatusReadDisturbed
006DFD E0                MOVX     A,@DPTR
006DFE FF                MOV      R7,A
006DFF 22                RET      
----- FUNCTION NVM_ext_read_status (END) -------


----- FUNCTION NVM_ext_clear_status (BEGIN) -----
006E00 E4                CLR      A
006E01 903BF6            MOV      DPTR,#bNVMstatusReadDisturbed
006E04 F0                MOVX     @DPTR,A
006E05 22                RET      
----- FUNCTION NVM_ext_clear_status (END) -------


----- FUNCTION _ZW_FH_rx_init (BEGIN) -----
;---- Variable 'wRxAddress' assigned to Register 'R6/R7' ----
;---- Variable 'bRxLen' assigned to Register 'R5' ----
006E06 E4                CLR      A
006E07 F5FF              MOV      SFRPAGE,A
006E09 75D102            MOV      FHCON1,#02H
006E0C         ?C0008?ZW_PHY_FRAME_HANDLER_050X:
006E0C E5D1              MOV      A,FHCON1
006E0E 20E0FB            JB       ACC.0,?C0008?ZW_PHY_FRAME_HANDLER_050X
006E11         ?C0009?ZW_PHY_FRAME_HANDLER_050X:
006E11 E4                CLR      A
006E12 F5D1              MOV      FHCON1,A
006E14 F5FF              MOV      SFRPAGE,A
006E16 EF                MOV      A,R7
006E17 D127              ACALL    ?L?COM05BC
006E19 EE                MOV      A,R6
006E1A 540F              ANL      A,#0FH
006E1C 42D6              ORL      FHRAMBUF,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 168


006E1E E4                CLR      A
006E1F F5FF              MOV      SFRPAGE,A
006E21 CF                XCH      A,R7
006E22 ED                MOV      A,R5
006E23 CF                XCH      A,R7
006E24 8FD4              MOV      FHFRML0,R7
006E26 22                RET      
----- FUNCTION _ZW_FH_rx_init (END) -------


----- FUNCTION ?L?COM05BC (BEGIN) -----
006E27 F5D7              MOV      FHRBAL0,A
006E29 E4                CLR      A
006E2A F5FF              MOV      SFRPAGE,A
006E2C 53D6F0            ANL      FHRAMBUF,#0F0H
006E2F 22                RET      
----- FUNCTION ?L?COM05BC (END) -------


----- FUNCTION _ZW_FH_buf0addr_set (BEGIN) -----
;---- Variable 'wAddress' assigned to Register 'R1/R2/R3' ----
006E30 E4                CLR      A
006E31 F5FF              MOV      SFRPAGE,A
006E33 E9                MOV      A,R1
006E34 D127              ACALL    ?L?COM05BC
006E36 EA                MOV      A,R2
006E37 540F              ANL      A,#0FH
006E39 42D6              ORL      FHRAMBUF,A
006E3B 22                RET      
----- FUNCTION _ZW_FH_buf0addr_set (END) -------


----- FUNCTION _ZW_FH_buf1addr_set (BEGIN) -----
;---- Variable 'wAddress' assigned to Register 'R6/R7' ----
006E3C E4                CLR      A
006E3D F5FF              MOV      SFRPAGE,A
006E3F EF                MOV      A,R7
006E40 F5D8              MOV      FHRBAL1,A
006E42 E4                CLR      A
006E43 F5FF              MOV      SFRPAGE,A
006E45 53D60F            ANL      FHRAMBUF,#0FH
006E48 EE                MOV      A,R6
006E49 540F              ANL      A,#0FH
006E4B D150              ACALL    ?L?COM04E0
006E4D 42D6              ORL      FHRAMBUF,A
006E4F 22                RET      
----- FUNCTION _ZW_FH_buf1addr_set (END) -------


----- FUNCTION ?L?COM04E0 (BEGIN) -----
006E50 C4                SWAP     A
006E51 F8                MOV      R0,A
006E52 54F0              ANL      A,#0F0H
006E54 C8                XCH      A,R0
006E55 E4                CLR      A
006E56 C4                SWAP     A
006E57 540F              ANL      A,#0FH
006E59 48                ORL      A,R0
006E5A 22                RET      
----- FUNCTION ?L?COM04E0 (END) -------


----- FUNCTION _ZW_FH_tx_buflen_set (BEGIN) -----
;---- Variable 'bBuf1len' assigned to Register 'R5' ----
;---- Variable 'bBuf0len' assigned to Register 'R7' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 169


006E5B E4                CLR      A
006E5C F5FF              MOV      SFRPAGE,A
006E5E 8FD4              MOV      FHFRML0,R7
006E60 F5FF              MOV      SFRPAGE,A
006E62 CF                XCH      A,R7
006E63 ED                MOV      A,R5
006E64 CF                XCH      A,R7
006E65 8FD5              MOV      FHFRML1,R7
006E67 22                RET      
----- FUNCTION _ZW_FH_tx_buflen_set (END) -------


----- FUNCTION _ZW_FH_rx_buflen_set (BEGIN) -----
;---- Variable 'bBuflen' assigned to Register 'R7' ----
006E68 E4                CLR      A
006E69 F5FF              MOV      SFRPAGE,A
006E6B 8FD4              MOV      FHFRML0,R7
006E6D 22                RET      
----- FUNCTION _ZW_FH_rx_buflen_set (END) -------


----- FUNCTION ZW_FH_status_get (BEGIN) -----
006E6E E4                CLR      A
006E6F F5FF              MOV      SFRPAGE,A
006E71 E5D1              MOV      A,FHCON1
006E73 5401              ANL      A,#01H
006E75 33                RLC      A
006E76 33                RLC      A
006E77 33                RLC      A
006E78 54F8              ANL      A,#0F8H
006E7A FF                MOV      R7,A
;---- Variable 'temp_' assigned to Register 'R7' ----
006E7B E4                CLR      A
006E7C F5FF              MOV      SFRPAGE,A
006E7E E5D3              MOV      A,FHSTAT
006E80 5407              ANL      A,#07H
006E82 4F                ORL      A,R7
006E83 FF                MOV      R7,A
006E84 22                RET      
----- FUNCTION ZW_FH_status_get (END) -------


----- FUNCTION _ZW_SPI1_int_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
006E85 EF                MOV      A,R7
006E86 B40109            CJNE     A,#01H,?C0001?ZW_PHY_SPI1_050X
006E89 D2AD              SETB     ESPI1
006E8B 75FF01            MOV      SFRPAGE,#01H
006E8E 43AE40            ORL      INTCON,#040H
006E91 22                RET      
006E92         ?C0001?ZW_PHY_SPI1_050X:
006E92 C2AD              CLR      ESPI1
006E94 75FF01            MOV      SFRPAGE,#01H
006E97 53AEBF            ANL      INTCON,#0BFH
006E9A 22                RET      
----- FUNCTION _ZW_SPI1_int_enable (END) -------


----- FUNCTION ZW_SPI1_int_clear (BEGIN) -----
006E9B 75C801            MOV      SPISTAT,#01H
006E9E 22                RET      
----- FUNCTION ZW_SPI1_int_clear (END) -------


----- FUNCTION ZW_SPI1_coll_get (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 170


006E9F E5C8              MOV      A,SPISTAT
006EA1 5402              ANL      A,#02H
006EA3 FF                MOV      R7,A
;---- Variable 'r' assigned to Register 'R7' ----
006EA4 75C802            MOV      SPISTAT,#02H
006EA7 22                RET      
----- FUNCTION ZW_SPI1_coll_get (END) -------


----- FUNCTION ZW_SPI1_int_get (BEGIN) -----
006EA8 E5C8              MOV      A,SPISTAT
006EAA 5401              ANL      A,#01H
006EAC FF                MOV      R7,A
006EAD 22                RET      
----- FUNCTION ZW_SPI1_int_get (END) -------


----- FUNCTION ext0_isr (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\INTERRUPT_DRIVER.C'
  182: ext0_isr(void) interrupt INUM_INT0
006EAE C0E0              PUSH     ACC
006EB0 C083              PUSH     DPH
006EB2 C082              PUSH     DPL
006EB4 C0D0              PUSH     PSW
  183: {
  184: //  EA = 0; // Disable global interrupt
  185: //  _push_(SFRPAGE);
  186: 
  187:   if (TRUE == ext_interrupts[ZW_EXT_INT0].fIgnoreInterrupt)
006EB6 903DA6            MOV      DPTR,#ext_interrupts+02H
006EB9 E0                MOVX     A,@DPTR
006EBA B40104            CJNE     A,#01H,?C0012?INTERRUPT_DRIVER
  188:   {
  189:     ext_interrupts[ZW_EXT_INT0].fIgnoreInterrupt = FALSE;
006EBD E4                CLR      A
006EBE F0                MOVX     @DPTR,A
  190:   }
006EBF 8008              SJMP     ?C0014?INTERRUPT_DRIVER
006EC1         ?C0012?INTERRUPT_DRIVER:
  191:   else
  192:   {
  193:     ext_interrupts[ZW_EXT_INT0].fTrigger = TRUE;
006EC1 903DA5            MOV      DPTR,#ext_interrupts+01H
006EC4 7401              MOV      A,#01H
006EC6 F0                MOVX     @DPTR,A
  194:     DISABLE_INTERRUPT_(0);
006EC7 C2A8              CLR      EX0
  195:   }
  196: 
  197: //  _pop_(SFRPAGE);
  198: //  EA = 1; // Enable global interrupt
  199: }
006EC9         ?C0014?INTERRUPT_DRIVER:
006EC9 D0D0              POP      PSW
006ECB D082              POP      DPL
006ECD D083              POP      DPH
006ECF D0E0              POP      ACC
006ED1 32                RETI     
----- FUNCTION ext0_isr (END) -------


----- FUNCTION ext1_isr (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\INTERRUPT_DRIVER.C'
  206: ext1_isr(void) interrupt INUM_INT1
006ED2 C0E0              PUSH     ACC
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 171


006ED4 C083              PUSH     DPH
006ED6 C082              PUSH     DPL
006ED8 C0D0              PUSH     PSW
  207: {
  208: //  EA = 0; // Disable global interrupt
  209: //  _push_(SFRPAGE);
  210: 
  211:   if (TRUE == ext_interrupts[ZW_EXT_INT1].fIgnoreInterrupt)
006EDA 903DAC            MOV      DPTR,#ext_interrupts+08H
006EDD E0                MOVX     A,@DPTR
006EDE B40104            CJNE     A,#01H,?C0015?INTERRUPT_DRIVER
  212:   {
  213:     ext_interrupts[ZW_EXT_INT1].fIgnoreInterrupt = FALSE;
006EE1 E4                CLR      A
006EE2 F0                MOVX     @DPTR,A
  214:   }
006EE3 8008              SJMP     ?C0017?INTERRUPT_DRIVER
006EE5         ?C0015?INTERRUPT_DRIVER:
  215:   else
  216:   {
  217:     ext_interrupts[ZW_EXT_INT1].fTrigger = TRUE;
006EE5 903DAB            MOV      DPTR,#ext_interrupts+07H
006EE8 7401              MOV      A,#01H
006EEA F0                MOVX     @DPTR,A
  218:     DISABLE_INTERRUPT_(1);
006EEB C2AA              CLR      EX1
  219:   }
  220: //  _pop_(SFRPAGE);
  221: //  EA = 1; // Enable global interrupt
  222: }
006EED         ?C0017?INTERRUPT_DRIVER:
006EED D0D0              POP      PSW
006EEF D082              POP      DPL
006EF1 D083              POP      DPH
006EF3 D0E0              POP      ACC
006EF5 32                RETI     
----- FUNCTION ext1_isr (END) -------


----- FUNCTION ZW_test_interface_driver_init (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE_DRIVER.C'
  183: void ZW_test_interface_driver_init(void)
  184: {
  185:   ZDB_UART_INIT(1152, TRUE, TRUE);
  186: 
006EF6 7B01              MOV      R3,#01H
006EF8 7D01              MOV      R5,#01H
006EFA 7F80              MOV      R7,#080H
006EFC 7E04              MOV      R6,#04H
006EFE 1246E5            LCALL    _ZW_UART0_init
  187:   // Init queue used for debug commands.
  188:   ZW_util_queue_Init(&debugQueue, debugBuffer, sizeof(debugBuffer[0]), DEBUG_QUEUE_BUFFER_SIZE);
006F01 7A09              MOV      R2,#HIGH debugBuffer
006F03 79DF              MOV      R1,#LOW debugBuffer
006F05 F12F              ACALL    ?L?COM0291
006F07 7414              MOV      A,#014H
006F09 F0                MOVX     @DPTR,A
006F0A 7A09              MOV      R2,#HIGH debugQueue
006F0C 79D7              MOV      R1,#LOW debugQueue
006F0E 121E49            LCALL    ?INTERBANK_TABLE?_ZW_util_queue_Init
  189: 
  190:   ZDB_ES = 1;  /* Enable "serial" interrupt */
006F11 D2AC              SETB     ES0
  191: 
  192:   // DMA INTERRUPT ON EOR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 172


  193:   ZDB_UART_DMA_INT_BYTE_COUNT(0);
006F13 E4                CLR      A
006F14 FF                MOV      R7,A
006F15 F181              ACALL    _ZW_UART0_rx_dma_int_byte_count
  194:   ZDB_UART_DMA_INIT(dmaBuffer, DMA_BUFFER_SIZE_SINGLE, (UART_RX_DMA_SWITCH_EOR | UART_RX_DMA_SWITCH_FULL));
006F17 7E07              MOV      R6,#HIGH dmaBuffer
006F19 7F2D              MOV      R7,#LOW dmaBuffer
006F1B 7B05              MOV      R3,#05H
006F1D 7D20              MOV      R5,#020H
006F1F F13F              ACALL    _ZW_UART0_rx_dma_init
  195:   ZDB_UART_DMA_EOR_SET(DMA_EOR_CHARACTER);
006F21 7F0D              MOV      R7,#0DH
;----                  JMP      _ZW_UART0_rx_dma_eor_set
----- FUNCTION ZW_test_interface_driver_init (END) -------


----- FUNCTION _ZW_UART0_rx_dma_eor_set (BEGIN) -----
;---- Variable 'bChar' assigned to Register 'R7' ----
006F23 75FF02            MOV      SFRPAGE,#02H
006F26 43B2C0            ORL      UART0RXF,#0C0H
006F29 75FF02            MOV      SFRPAGE,#02H
006F2C 8FB3              MOV      UART0RXF1,R7
006F2E 22                RET      
----- FUNCTION _ZW_UART0_rx_dma_eor_set (END) -------


----- FUNCTION ?L?COM0291 (BEGIN) -----
006F2F 7B01              MOV      R3,#01H
006F31         ?L?COM0292:
006F31 903FF7            MOV      DPTR,#?_ZW_util_queue_Init?BYTE+03H
006F34 1225A9            LCALL    ?C?PSTXDATA
006F37 903FFA            MOV      DPTR,#?_ZW_util_queue_Init?BYTE+06H
006F3A 7401              MOV      A,#01H
006F3C F0                MOVX     @DPTR,A
006F3D A3                INC      DPTR
006F3E 22                RET      
----- FUNCTION ?L?COM0291 (END) -------


----- FUNCTION _ZW_UART0_rx_dma_init (BEGIN) -----
006F3F 904374            MOV      DPTR,#pbAddress
006F42 EE                MOV      A,R6
006F43 F0                MOVX     @DPTR,A
006F44 A3                INC      DPTR
006F45 EF                MOV      A,R7
006F46 F0                MOVX     @DPTR,A
;---- Variable 'bBitMask' assigned to Register 'R3' ----
;---- Variable 'bBufLength' assigned to Register 'R5' ----
006F47 F18D              ACALL    ?L?COM048F
006F49 75FF02            MOV      SFRPAGE,#02H
006F4C 904374            MOV      DPTR,#pbAddress
006F4F A3                INC      DPTR
006F50 E0                MOVX     A,@DPTR
006F51 F5B5              MOV      UART0RXF3,A
006F53 75FF02            MOV      SFRPAGE,#02H
006F56 904374            MOV      DPTR,#pbAddress
006F59 E0                MOVX     A,@DPTR
006F5A FE                MOV      R6,A
006F5B EE                MOV      A,R6
006F5C 540F              ANL      A,#0FH
006F5E F5B4              MOV      UART0RXF2,A
006F60 F179              ACALL    ?L?COM05E8
006F62 4440              ORL      A,#040H
006F64 F5B2              MOV      UART0RXF,A
006F66 75FF02            MOV      SFRPAGE,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 173


006F69 CF                XCH      A,R7
006F6A ED                MOV      A,R5
006F6B CF                XCH      A,R7
006F6C 8FB3              MOV      UART0RXF1,R7
006F6E 75FF02            MOV      SFRPAGE,#02H
006F71 EB                MOV      A,R3
006F72 542D              ANL      A,#02DH
006F74 4410              ORL      A,#010H
006F76 F5B2              MOV      UART0RXF,A
006F78 22                RET      
----- FUNCTION _ZW_UART0_rx_dma_init (END) -------


----- FUNCTION ?L?COM05E8 (BEGIN) -----
006F79 75FF02            MOV      SFRPAGE,#02H
006F7C E5B2              MOV      A,UART0RXF
006F7E 542D              ANL      A,#02DH
006F80 22                RET      
----- FUNCTION ?L?COM05E8 (END) -------


----- FUNCTION _ZW_UART0_rx_dma_int_byte_count (BEGIN) -----
;---- Variable 'bByteCount' assigned to Register 'R7' ----
006F81 75FF02            MOV      SFRPAGE,#02H
006F84 53B22D            ANL      UART0RXF,#02DH
006F87 75FF02            MOV      SFRPAGE,#02H
006F8A 8FB3              MOV      UART0RXF1,R7
006F8C 22                RET      
----- FUNCTION _ZW_UART0_rx_dma_int_byte_count (END) -------


----- FUNCTION ?L?COM048F (BEGIN) -----
006F8D 75FF02            MOV      SFRPAGE,#02H
006F90 E5B4              MOV      A,UART0RXF2
006F92 540F              ANL      A,#0FH
006F94 4410              ORL      A,#010H
006F96 F5B4              MOV      UART0RXF2,A
006F98 22                RET      
----- FUNCTION ?L?COM048F (END) -------


----- FUNCTION ZW_UART0_rx_dma_cancel (BEGIN) -----
006F99 80F2              SJMP     ?L?COM048F
----- FUNCTION ZW_UART0_rx_dma_cancel (END) -------


----- FUNCTION ZW_UART0_rx_dma_bytes_transferred (BEGIN) -----
006F9B F179              ACALL    ?L?COM05E8
006F9D 4480              ORL      A,#080H
006F9F F5B2              MOV      UART0RXF,A
006FA1 75FF02            MOV      SFRPAGE,#02H
006FA4 AFB3              MOV      R7,UART0RXF1
006FA6 22                RET      
----- FUNCTION ZW_UART0_rx_dma_bytes_transferred (END) -------


----- FUNCTION _ZW_UART0_tx_dma_int_byte_count (BEGIN) -----
;---- Variable 'bByteCount' assigned to Register 'R7' ----
006FA7 F1B6              ACALL    ?L?COM058F
006FA9 E5B6              MOV      A,UART0TXF
006FAB 540F              ANL      A,#0FH
006FAD 4E                ORL      A,R6
006FAE F5B6              MOV      UART0TXF,A
006FB0 75FF02            MOV      SFRPAGE,#02H
006FB3 8FB7              MOV      UART0TXF1,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 174


006FB5 22                RET      
----- FUNCTION _ZW_UART0_tx_dma_int_byte_count (END) -------


----- FUNCTION ?L?COM058F (BEGIN) -----
006FB6 75FF02            MOV      SFRPAGE,#02H
006FB9 E5B6              MOV      A,UART0TXF
006FBB 5420              ANL      A,#020H
006FBD FE                MOV      R6,A
006FBE 22                RET      
----- FUNCTION ?L?COM058F (END) -------


----- FUNCTION _ZW_UART0_tx_dma_inter_byte_delay (BEGIN) -----
;---- Variable 'bDelay' assigned to Register 'R7' ----
006FBF F1B6              ACALL    ?L?COM058F
006FC1 EF                MOV      A,R7
006FC2 540F              ANL      A,#0FH
006FC4 4E                ORL      A,R6
006FC5 F5B6              MOV      UART0TXF,A
006FC7 22                RET      
----- FUNCTION _ZW_UART0_tx_dma_inter_byte_delay (END) -------


----- FUNCTION _ZW_UART0_tx_dma_data (BEGIN) -----
;---- Variable 'pbAddress' assigned to Register 'R6/R7' ----
;---- Variable 'bBufferLen' assigned to Register 'R5' ----
006FC8 75FF02            MOV      SFRPAGE,#02H
006FCB 75BA40            MOV      UART0TXF2,#040H
006FCE 75FF02            MOV      SFRPAGE,#02H
006FD1 EF                MOV      A,R7
006FD2 F5BB              MOV      UART0TXF3,A
006FD4 75FF02            MOV      SFRPAGE,#02H
006FD7 EE                MOV      A,R6
006FD8 540F              ANL      A,#0FH
006FDA F5BA              MOV      UART0TXF2,A
006FDC 127013            LCALL    ?L?COM02FD
006FDF 4440              ORL      A,#040H
006FE1 F5B6              MOV      UART0TXF,A
006FE3 75FF02            MOV      SFRPAGE,#02H
006FE6 AF05              MOV      R7,AR5
006FE8 8FB7              MOV      UART0TXF1,R7
006FEA 127013            LCALL    ?L?COM02FD
006FED 4450              ORL      A,#050H
006FEF F5B6              MOV      UART0TXF,A
006FF1 22                RET      
----- FUNCTION _ZW_UART0_tx_dma_data (END) -------


----- FUNCTION ZW_UART0_tx_dma_status (BEGIN) -----
006FF2 75FF02            MOV      SFRPAGE,#02H
006FF5 E5B6              MOV      A,UART0TXF
006FF7 5410              ANL      A,#010H
006FF9 FF                MOV      R7,A
006FFA E5BA              MOV      A,UART0TXF2
006FFC 5480              ANL      A,#080H
006FFE FD                MOV      R5,A
006FFF ED                MOV      A,R5
007000 4F                ORL      A,R7
007001 FF                MOV      R7,A
;---- Variable 'r' assigned to Register 'R6/R7' ----
007002 43BA80            ORL      UART0TXF2,#080H
007005 22                RET      
----- FUNCTION ZW_UART0_tx_dma_status (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 175



----- FUNCTION ZW_UART0_tx_dma_bytes_transferred (BEGIN) -----
007006 127013            LCALL    ?L?COM02FD
007009 4480              ORL      A,#080H
00700B F5B6              MOV      UART0TXF,A
00700D 75FF02            MOV      SFRPAGE,#02H
007010 AFB7              MOV      R7,UART0TXF1
007012 22                RET      
----- FUNCTION ZW_UART0_tx_dma_bytes_transferred (END) -------


----- FUNCTION ?L?COM02FD (BEGIN) -----
007013 75FF02            MOV      SFRPAGE,#02H
007016 E5B6              MOV      A,UART0TXF
007018 5420              ANL      A,#020H
00701A FF                MOV      R7,A
00701B E5B6              MOV      A,UART0TXF
00701D 540F              ANL      A,#0FH
00701F 4F                ORL      A,R7
007020 22                RET      
----- FUNCTION ?L?COM02FD (END) -------


----- FUNCTION ZW_UART0_tx_dma_cancel (BEGIN) -----
007021 75FF02            MOV      SFRPAGE,#02H
007024 E5BA              MOV      A,UART0TXF2
007026 540F              ANL      A,#0FH
007028 4440              ORL      A,#040H
00702A F5BA              MOV      UART0TXF2,A
00702C 22                RET      
----- FUNCTION ZW_UART0_tx_dma_cancel (END) -------


----- FUNCTION _ZW_UART0_rx_dma_byte_count_enable (BEGIN) -----
;---- Variable 'bEnable' assigned to Register 'R7' ----
00702D EF                MOV      A,R7
00702E 6007              JZ       ?C0013?ZW_PHY_UART0_DMA_050X
007030 75FF02            MOV      SFRPAGE,#02H
007033 43B208            ORL      UART0RXF,#08H
007036 22                RET      
007037         ?C0013?ZW_PHY_UART0_DMA_050X:
007037 75FF02            MOV      SFRPAGE,#02H
00703A 53B2F7            ANL      UART0RXF,#0F7H
00703D 22                RET      
----- FUNCTION _ZW_UART0_rx_dma_byte_count_enable (END) -------


----- FUNCTION ?L?COM009E (BEGIN) -----
00703E FF                MOV      R7,A
00703F         ?L?COM009F:
00703F 90095B            MOV      DPTR,#pExploreQueueElement
007042 122589            LCALL    ?C?PLDXDATA
007045 E9                MOV      A,R1
007046 22                RET      
----- FUNCTION ?L?COM009E (END) -------


----- FUNCTION ?L?COM00AD (BEGIN) -----
007047 E0                MOVX     A,@DPTR
007048 FD                MOV      R5,A
007049 7B01              MOV      R3,#01H
00704B         ?L?COM00AE:
00704B 900A50            MOV      DPTR,#?_ZW_SendDataEx?BYTE+04H
00704E 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM00AD (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 176




----- FUNCTION ?L?COM00BE (BEGIN) -----
007051 7D01              MOV      R5,#01H
007053 7B01              MOV      R3,#01H
007055 7E00              MOV      R6,#00H
007057 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM00BE (END) -------


----- FUNCTION ?L?COM00DA (BEGIN) -----
00705A 122589            LCALL    ?C?PLDXDATA
00705D E9                MOV      A,R1
00705E         ?L?COM00DB:
00705E 24DC              ADD      A,#0DCH
007060         ?L?COM00DC:
007060 F9                MOV      R1,A
007061 E4                CLR      A
007062 3A                ADDC     A,R2
007063 FA                MOV      R2,A
007064 02216F            LJMP     ?C?ILDPTR
----- FUNCTION ?L?COM00DA (END) -------


----- FUNCTION ?L?COM00DF (BEGIN) -----
007067 9400              SUBB     A,#HIGH NVM_HOMEID_far
007069 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
00706C F0                MOVX     @DPTR,A
00706D A3                INC      DPTR
00706E CE                XCH      A,R6
00706F         ?L?COM00E0:
00706F F0                MOVX     @DPTR,A
007070         ?L?COM00E1:
007070 7B00              MOV      R3,#00H
007072 7A00              MOV      R2,#00H
007074 7900              MOV      R1,#00H
007076 22                RET      
----- FUNCTION ?L?COM00DF (END) -------


----- FUNCTION ?L?COM00E7 (BEGIN) -----
007077 122589            LCALL    ?C?PLDXDATA
00707A E9                MOV      A,R1
00707B 2407              ADD      A,#07H
00707D 22                RET      
----- FUNCTION ?L?COM00E7 (END) -------


----- FUNCTION ?L?COM00F2 (BEGIN) -----
00707E 122589            LCALL    ?C?PLDXDATA
007081 E9                MOV      A,R1
007082 2403              ADD      A,#03H
007084 22                RET      
----- FUNCTION ?L?COM00F2 (END) -------


----- FUNCTION ?L?COM00F3 (BEGIN) -----
007085 EE                MOV      A,R6
007086 F0                MOVX     @DPTR,A
007087 A3                INC      DPTR
007088         ?L?COM00F4:
007088 EF                MOV      A,R7
007089 F0                MOVX     @DPTR,A
00708A A3                INC      DPTR
00708B 0225A9            LJMP     ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 177


----- FUNCTION ?L?COM00F3 (END) -------


----- FUNCTION ?L?COM0148 (BEGIN) -----
00708E FF                MOV      R7,A
00708F         ?L?COM0149:
00708F 122589            LCALL    ?C?PLDXDATA
007092 A801              MOV      R0,AR1
007094         ?L?COM014A:
007094 AC02              MOV      R4,AR2
007096 AD03              MOV      R5,AR3
007098 7B01              MOV      R3,#01H
00709A 22                RET      
----- FUNCTION ?L?COM0148 (END) -------


----- FUNCTION ?L?COM0160 (BEGIN) -----
00709B 903C46            MOV      DPTR,#i
00709E E0                MOVX     A,@DPTR
00709F FE                MOV      R6,A
0070A0 A3                INC      DPTR
0070A1 E0                MOVX     A,@DPTR
0070A2 FF                MOV      R7,A
0070A3 903C4A            MOV      DPTR,#bSubBuffers
0070A6 E0                MOVX     A,@DPTR
0070A7 FD                MOV      R5,A
0070A8 126762            LCALL    _GetModifiedLength
0070AB 903C48            MOV      DPTR,#wLength
0070AE EE                MOV      A,R6
0070AF F0                MOVX     @DPTR,A
0070B0 A3                INC      DPTR
0070B1 EF                MOV      A,R7
0070B2 F0                MOVX     @DPTR,A
0070B3 A3                INC      DPTR
0070B4 E0                MOVX     A,@DPTR
0070B5 FF                MOV      R7,A
0070B6 12672E            LCALL    _GetLowestBit
0070B9 EF                MOV      A,R7
0070BA 75F020            MOV      B,#020H
0070BD A4                MUL      AB
0070BE FF                MOV      R7,A
0070BF AEF0              MOV      R6,B
0070C1 E4                CLR      A
0070C2 FC                MOV      R4,A
0070C3 FD                MOV      R5,A
0070C4 903C3D            MOV      DPTR,#offset
0070C7         ?L?COM0161:
0070C7 1224B5            LCALL    ?C?LLDXDATA0
0070CA 02226B            LJMP     ?C?LADD
----- FUNCTION ?L?COM0160 (END) -------


----- FUNCTION ?L?COM019E (BEGIN) -----
0070CD EE                MOV      A,R6
0070CE F0                MOVX     @DPTR,A
0070CF A3                INC      DPTR
0070D0         ?L?COM019F:
0070D0 EF                MOV      A,R7
0070D1 F0                MOVX     @DPTR,A
0070D2         ?L?COM01A0:
0070D2 A3                INC      DPTR
0070D3 EC                MOV      A,R4
0070D4 F0                MOVX     @DPTR,A
0070D5 A3                INC      DPTR
0070D6 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 178


0070D7 F0                MOVX     @DPTR,A
0070D8 22                RET      
----- FUNCTION ?L?COM019E (END) -------


----- FUNCTION ?L?COM01A7 (BEGIN) -----
0070D9 E0                MOVX     A,@DPTR
0070DA FE                MOV      R6,A
0070DB A3                INC      DPTR
0070DC E0                MOVX     A,@DPTR
0070DD FF                MOV      R7,A
0070DE 7C00              MOV      R4,#00H
0070E0 0220A6            LJMP     ?C?IMUL
----- FUNCTION ?L?COM01A7 (END) -------


----- FUNCTION ?L?COM01CE (BEGIN) -----
0070E3 900A71            MOV      DPTR,#?_ExploreQueueFrame?BYTE+07H
0070E6 F0                MOVX     @DPTR,A
0070E7 A3                INC      DPTR
0070E8 EF                MOV      A,R7
0070E9 F0                MOVX     @DPTR,A
0070EA 22                RET      
----- FUNCTION ?L?COM01CE (END) -------


----- FUNCTION ?L?COM01E4 (BEGIN) -----
0070EB 900004            MOV      DPTR,#04H
0070EE 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM01E4 (END) -------


----- FUNCTION ?L?COM0232 (BEGIN) -----
0070F1 29                ADD      A,R1
0070F2 F9                MOV      R1,A
0070F3 EA                MOV      A,R2
0070F4 3C                ADDC     A,R4
0070F5 A801              MOV      R0,AR1
0070F7 FC                MOV      R4,A
0070F8 AD03              MOV      R5,AR3
0070FA         ?L?COM0233:
0070FA 122589            LCALL    ?C?PLDXDATA
0070FD 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM0232 (END) -------


----- FUNCTION ?L?COM0272 (BEGIN) -----
007100 75F002            MOV      B,#02H
007103         ?L?COM0273:
007103 A4                MUL      AB
007104 F582              MOV      DPL,A
007106 85F083            MOV      DPH,B
007109 22                RET      
----- FUNCTION ?L?COM0272 (END) -------


----- FUNCTION ?L?COM0284 (BEGIN) -----
00710A 7B01              MOV      R3,#01H
00710C 8F82              MOV      DPL,R7
00710E 8E83              MOV      DPH,R6
007110 22                RET      
----- FUNCTION ?L?COM0284 (END) -------


----- FUNCTION ?L?COM0287 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 179


007111 122589            LCALL    ?C?PLDXDATA
007114 E4                CLR      A
007115 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0287 (END) -------


----- FUNCTION ?L?COM0289 (BEGIN) -----
007118 FF                MOV      R7,A
007119 E0                MOVX     A,@DPTR
00711A FC                MOV      R4,A
00711B A3                INC      DPTR
00711C E0                MOVX     A,@DPTR
00711D FD                MOV      R5,A
00711E 22                RET      
----- FUNCTION ?L?COM0289 (END) -------


----- FUNCTION ?L?COM028B (BEGIN) -----
00711F FE                MOV      R6,A
007120 EF                MOV      A,R7
007121 C4                SWAP     A
007122 F8                MOV      R0,A
007123 540F              ANL      A,#0FH
007125 C8                XCH      A,R0
007126 68                XRL      A,R0
007127 FF                MOV      R7,A
007128 EE                MOV      A,R6
007129 C4                SWAP     A
00712A 54F0              ANL      A,#0F0H
00712C 48                ORL      A,R0
00712D FE                MOV      R6,A
00712E 22                RET      
----- FUNCTION ?L?COM028B (END) -------


----- FUNCTION ?L?COM0298 (BEGIN) -----
00712F FD                MOV      R5,A
007130 ED                MOV      A,R5
007131 FF                MOV      R7,A
007132 EE                MOV      A,R6
007133 F0                MOVX     @DPTR,A
007134 A3                INC      DPTR
007135 EF                MOV      A,R7
007136 F0                MOVX     @DPTR,A
007137 22                RET      
----- FUNCTION ?L?COM0298 (END) -------


----- FUNCTION ?L?COM02A0 (BEGIN) -----
007138 E0                MOVX     A,@DPTR
007139 FE                MOV      R6,A
00713A A3                INC      DPTR
00713B E0                MOVX     A,@DPTR
00713C 29                ADD      A,R1
00713D F9                MOV      R1,A
00713E EA                MOV      A,R2
00713F 3E                ADDC     A,R6
007140 FA                MOV      R2,A
007141 22                RET      
----- FUNCTION ?L?COM02A0 (END) -------


----- FUNCTION ?L?COM02C1 (BEGIN) -----
007142 7B01              MOV      R3,#01H
007144 7A12              MOV      R2,#HIGH nodeID
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 180


007146 7921              MOV      R1,#LOW nodeID
007148 9040F9            MOV      DPTR,#?_MemoryGetID?BYTE+03H
00714B 1225A9            LCALL    ?C?PSTXDATA
00714E 7A12              MOV      R2,#HIGH homeID
007150 22                RET      
----- FUNCTION ?L?COM02C1 (END) -------


----- FUNCTION ?L?COM02C6 (BEGIN) -----
007151 EF                MOV      A,R7
007152         ?L?COM02C7:
007152 C4                SWAP     A
007153 13                RRC      A
007154 13                RRC      A
007155 13                RRC      A
007156 5401              ANL      A,#01H
007158 22                RET      
----- FUNCTION ?L?COM02C6 (END) -------


----- FUNCTION ?L?COM02E7 (BEGIN) -----
007159 F9                MOV      R1,A
00715A EA                MOV      A,R2
00715B 34FF              ADDC     A,#0FFH
00715D FA                MOV      R2,A
00715E 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM02E7 (END) -------


----- FUNCTION ?L?COM0301 (BEGIN) -----
007161 E4                CLR      A
007162 75F010            MOV      B,#010H
007165 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM0301 (END) -------


----- FUNCTION ?L?COM0308 (BEGIN) -----
007168 8E83              MOV      DPH,R6
00716A 7F01              MOV      R7,#01H
00716C 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0308 (END) -------


----- FUNCTION ?L?COM0313 (BEGIN) -----
00716F 900003            MOV      DPTR,#03H
007172 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0313 (END) -------


----- FUNCTION ?L?COM0318 (BEGIN) -----
007175 E0                MOVX     A,@DPTR
007176 FF                MOV      R7,A
007177 7E00              MOV      R6,#00H
007179 EE                MOV      A,R6
00717A F0                MOVX     @DPTR,A
00717B A3                INC      DPTR
00717C EF                MOV      A,R7
00717D F0                MOVX     @DPTR,A
00717E 22                RET      
----- FUNCTION ?L?COM0318 (END) -------


----- FUNCTION ?L?COM0319 (BEGIN) -----
00717F A3                INC      DPTR
007180 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 181


007181         ?L?COM031A:
007181 7F0F              MOV      R7,#0FH
007183 7E1D              MOV      R6,#01DH
007185 021B60            LJMP     ?INTERBANK_TABLE?_ZW_CheckCrc16
----- FUNCTION ?L?COM0319 (END) -------


----- FUNCTION ?L?COM031E (BEGIN) -----
007188 E9                MOV      A,R1
007189 2F                ADD      A,R7
00718A F9                MOV      R1,A
00718B EE                MOV      A,R6
00718C 3A                ADDC     A,R2
00718D FA                MOV      R2,A
00718E 903C48            MOV      DPTR,#wLength
007191 E0                MOVX     A,@DPTR
007192 FF                MOV      R7,A
007193 A3                INC      DPTR
007194 E0                MOVX     A,@DPTR
007195 903E67            MOV      DPTR,#?_NVMPutArray_long?BYTE+07H
007198 CF                XCH      A,R7
007199 F0                MOVX     @DPTR,A
00719A A3                INC      DPTR
00719B EF                MOV      A,R7
00719C F0                MOVX     @DPTR,A
00719D 22                RET      
----- FUNCTION ?L?COM031E (END) -------


----- FUNCTION ?L?COM032A (BEGIN) -----
00719E 7B01              MOV      R3,#01H
0071A0 7D06              MOV      R5,#06H
0071A2 E4                CLR      A
0071A3 FF                MOV      R7,A
0071A4 22                RET      
----- FUNCTION ?L?COM032A (END) -------


----- FUNCTION ?L?COM034B (BEGIN) -----
0071A5 7F02              MOV      R7,#02H
0071A7 1237EF            LCALL    _RFClearStatus
0071AA 9003C3            MOV      DPTR,#currentRxBuffer
0071AD E0                MOVX     A,@DPTR
0071AE 9003C8            MOV      DPTR,#tmpMain
0071B1 F0                MOVX     @DPTR,A
0071B2 9003C3            MOV      DPTR,#currentRxBuffer
0071B5 04                INC      A
0071B6 F0                MOVX     @DPTR,A
0071B7 C3                CLR      C
0071B8 9402              SUBB     A,#02H
0071BA 22                RET      
----- FUNCTION ?L?COM034B (END) -------


----- FUNCTION ?L?COM0361 (BEGIN) -----
0071BB 900005            MOV      DPTR,#05H
0071BE EF                MOV      A,R7
0071BF 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0361 (END) -------


----- FUNCTION ?L?COM036D (BEGIN) -----
0071C2 E4                CLR      A
0071C3 FF                MOV      R7,A
0071C4 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 182


0071C7 7B01              MOV      R3,#01H
0071C9 22                RET      
----- FUNCTION ?L?COM036D (END) -------


----- FUNCTION ?L?COM0373 (BEGIN) -----
0071CA 9003C8            MOV      DPTR,#tmpMain
0071CD E0                MOVX     A,@DPTR
0071CE FD                MOV      R5,A
0071CF 75F0AA            MOV      B,#0AAH
0071D2 9003CD            MOV      DPTR,#frameBuffer
0071D5 12257D            LCALL    ?C?OFFXADD
0071D8 AF82              MOV      R7,DPL
0071DA AE83              MOV      R6,DPH
0071DC EF                MOV      A,R7
0071DD 22                RET      
----- FUNCTION ?L?COM0373 (END) -------


----- FUNCTION ?L?COM0378 (BEGIN) -----
0071DE 900003            MOV      DPTR,#03H
0071E1 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0378 (END) -------


----- FUNCTION ?L?COM037B (BEGIN) -----
0071E4 E0                MOVX     A,@DPTR
0071E5 F582              MOV      DPL,A
0071E7         ?L?COM037C:
0071E7 758300            MOV      DPH,#00H
0071EA EF                MOV      A,R7
0071EB 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM037B (END) -------


----- FUNCTION ?L?COM0382 (BEGIN) -----
0071EE 122589            LCALL    ?C?PLDXDATA
0071F1         ?L?COM0383:
0071F1 E9                MOV      A,R1
0071F2 2F                ADD      A,R7
0071F3 F9                MOV      R1,A
0071F4 EA                MOV      A,R2
0071F5 3E                ADDC     A,R6
0071F6 FA                MOV      R2,A
0071F7 22                RET      
----- FUNCTION ?L?COM0382 (END) -------


----- FUNCTION ?L?COM0385 (BEGIN) -----
0071F8 1225A9            LCALL    ?C?PSTXDATA
0071FB 0225BE            LJMP     ?C?PLDPTR
----- FUNCTION ?L?COM0385 (END) -------


----- FUNCTION ?L?COM039A (BEGIN) -----
0071FE 900001            MOV      DPTR,#01H
007201 7402              MOV      A,#02H
007203 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM039A (END) -------


----- FUNCTION ?L?COM03A1 (BEGIN) -----
007206 E0                MOVX     A,@DPTR
007207 FC                MOV      R4,A
007208 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 183


007209 E0                MOVX     A,@DPTR
00720A FD                MOV      R5,A
00720B A3                INC      DPTR
00720C E0                MOVX     A,@DPTR
00720D FE                MOV      R6,A
00720E A3                INC      DPTR
00720F E0                MOVX     A,@DPTR
007210 22                RET      
----- FUNCTION ?L?COM03A1 (END) -------


----- FUNCTION ?L?COM03B0 (BEGIN) -----
007211 AF03              MOV      R7,AR3
007213 A3                INC      DPTR
007214 EA                MOV      A,R2
007215 F0                MOVX     @DPTR,A
007216 A3                INC      DPTR
007217 EF                MOV      A,R7
007218 F0                MOVX     @DPTR,A
007219 22                RET      
----- FUNCTION ?L?COM03B0 (END) -------


----- FUNCTION ?L?COM03D6 (BEGIN) -----
00721A FD                MOV      R5,A
00721B ED                MOV      A,R5
00721C FF                MOV      R7,A
00721D EE                MOV      A,R6
00721E F0                MOVX     @DPTR,A
00721F A3                INC      DPTR
007220 EF                MOV      A,R7
007221 F0                MOVX     @DPTR,A
007222 22                RET      
----- FUNCTION ?L?COM03D6 (END) -------


----- FUNCTION ?L?COM03EF (BEGIN) -----
007223 900013            MOV      DPTR,#013H
007226 7401              MOV      A,#01H
007228 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM03EF (END) -------


----- FUNCTION ?L?COM03FD (BEGIN) -----
00722B FF                MOV      R7,A
00722C 122589            LCALL    ?C?PLDXDATA
00722F C3                CLR      C
007230 E9                MOV      A,R1
007231 9F                SUBB     A,R7
007232 F9                MOV      R1,A
007233 EA                MOV      A,R2
007234 9E                SUBB     A,R6
007235 FA                MOV      R2,A
007236 E9                MOV      A,R1
007237 2407              ADD      A,#07H
007239 22                RET      
----- FUNCTION ?L?COM03FD (END) -------


----- FUNCTION ?L?COM0401 (BEGIN) -----
00723A E0                MOVX     A,@DPTR
00723B FE                MOV      R6,A
00723C A3                INC      DPTR
00723D E0                MOVX     A,@DPTR
00723E FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 184


00723F A3                INC      DPTR
007240 E0                MOVX     A,@DPTR
007241 FD                MOV      R5,A
007242 A3                INC      DPTR
007243 E0                MOVX     A,@DPTR
007244 FB                MOV      R3,A
007245 024778            LJMP     _TimerSysStart
----- FUNCTION ?L?COM0401 (END) -------


----- FUNCTION ?L?COM0402 (BEGIN) -----
007248 126507            LCALL    __PLL_set_bank5
00724B E4                CLR      A
00724C F5FF              MOV      SFRPAGE,A
00724E E5BD              MOV      A,DPLLSTART
007250 54F8              ANL      A,#0F8H
007252 4404              ORL      A,#04H
007254 F5BD              MOV      DPLLSTART,A
007256 22                RET      
----- FUNCTION ?L?COM0402 (END) -------


----- FUNCTION ?L?COM0404 (BEGIN) -----
007257 ED                MOV      A,R5
007258         ?L?COM0405:
007258 F0                MOVX     @DPTR,A
007259 A3                INC      DPTR
00725A 122589            LCALL    ?C?PLDXDATA
00725D E9                MOV      A,R1
00725E 22                RET      
----- FUNCTION ?L?COM0404 (END) -------


----- FUNCTION ?L?COM0410 (BEGIN) -----
00725F 903D7D            MOV      DPTR,#?_ctimer_set?BYTE+09H
007262 1225A9            LCALL    ?C?PSTXDATA
007265 7B01              MOV      R3,#01H
007267 22                RET      
----- FUNCTION ?L?COM0410 (END) -------


----- FUNCTION ?L?COM0415 (BEGIN) -----
007268 9040B9            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
00726B 7404              MOV      A,#04H
00726D F0                MOVX     @DPTR,A
00726E 023F61            LJMP     _NVM_ext_read_buffer
----- FUNCTION ?L?COM0415 (END) -------


----- FUNCTION ?L?COM0419 (BEGIN) -----
007271 EF                MOV      A,R7
007272 F0                MOVX     @DPTR,A
007273 A3                INC      DPTR
007274 ED                MOV      A,R5
007275 F0                MOVX     @DPTR,A
007276 E4                CLR      A
007277 A3                INC      DPTR
007278 F0                MOVX     @DPTR,A
007279 22                RET      
----- FUNCTION ?L?COM0419 (END) -------


----- FUNCTION ?L?COM0432 (BEGIN) -----
00727A 122589            LCALL    ?C?PLDXDATA
00727D 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 185


00727F 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0432 (END) -------


----- FUNCTION ?L?COM0436 (BEGIN) -----
007282 F5FF              MOV      SFRPAGE,A
007284 F596              MOV      DMSETUP5,A
007286 75FF01            MOV      SFRPAGE,#01H
007289 75D709            MOV      DFCON1,#09H
00728C 75F418            MOV      DMCTRL,#018H
00728F 22                RET      
----- FUNCTION ?L?COM0436 (END) -------


----- FUNCTION ?L?COM0439 (BEGIN) -----
007290 C3                CLR      C
007291 9006B6            MOV      DPTR,#sRFStats+01H
007294 E0                MOVX     A,@DPTR
007295 94FF              SUBB     A,#0FFH
007297 9006B5            MOV      DPTR,#sRFStats
00729A E0                MOVX     A,@DPTR
00729B 94FF              SUBB     A,#0FFH
00729D 22                RET      
----- FUNCTION ?L?COM0439 (END) -------


----- FUNCTION ?L?COM0441 (BEGIN) -----
00729E 903BFC            MOV      DPTR,#NVRbNVMPageSize+01H
0072A1 E0                MOVX     A,@DPTR
0072A2 9F                SUBB     A,R7
0072A3 FF                MOV      R7,A
0072A4 903BFB            MOV      DPTR,#NVRbNVMPageSize
0072A7 E0                MOVX     A,@DPTR
0072A8 9E                SUBB     A,R6
0072A9 FE                MOV      R6,A
0072AA 22                RET      
----- FUNCTION ?L?COM0441 (END) -------


----- FUNCTION ?L?COM0447 (BEGIN) -----
0072AB FD                MOV      R5,A
0072AC E4                CLR      A
0072AD F0                MOVX     @DPTR,A
0072AE A3                INC      DPTR
0072AF ED                MOV      A,R5
0072B0 F0                MOVX     @DPTR,A
0072B1 22                RET      
----- FUNCTION ?L?COM0447 (END) -------


----- FUNCTION ?L?COM0448 (BEGIN) -----
0072B2 2420              ADD      A,#020H
0072B4 F9                MOV      R1,A
0072B5 E4                CLR      A
0072B6 3A                ADDC     A,R2
0072B7 FA                MOV      R2,A
0072B8 22                RET      
----- FUNCTION ?L?COM0448 (END) -------


----- FUNCTION ?L?COM0455 (BEGIN) -----
0072B9 12216F            LCALL    ?C?ILDPTR
0072BC FF                MOV      R7,A
0072BD AEF0              MOV      R6,B
0072BF 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 186


----- FUNCTION ?L?COM0455 (END) -------


----- FUNCTION ?L?COM0466 (BEGIN) -----
0072C0 E0                MOVX     A,@DPTR
0072C1 C3                CLR      C
0072C2 13                RRC      A
0072C3 FE                MOV      R6,A
0072C4 A3                INC      DPTR
0072C5 E0                MOVX     A,@DPTR
0072C6 13                RRC      A
0072C7 FB                MOV      R3,A
0072C8 AA06              MOV      R2,AR6
0072CA E4                CLR      A
0072CB F9                MOV      R1,A
0072CC 22                RET      
----- FUNCTION ?L?COM0466 (END) -------


----- FUNCTION ?L?COM0486 (BEGIN) -----
0072CD E9                MOV      A,R1
0072CE 240C              ADD      A,#0CH
0072D0 F9                MOV      R1,A
0072D1 E4                CLR      A
0072D2 3A                ADDC     A,R2
0072D3 FA                MOV      R2,A
0072D4 22                RET      
----- FUNCTION ?L?COM0486 (END) -------


----- FUNCTION ?L?COM0489 (BEGIN) -----
0072D5 AF05              MOV      R7,AR5
0072D7 EC                MOV      A,R4
0072D8 F0                MOVX     @DPTR,A
0072D9 A3                INC      DPTR
0072DA EF                MOV      A,R7
0072DB F0                MOVX     @DPTR,A
0072DC 22                RET      
----- FUNCTION ?L?COM0489 (END) -------


----- FUNCTION ?L?COM048B (BEGIN) -----
0072DD F9                MOV      R1,A
0072DE EA                MOV      A,R2
0072DF 34FF              ADDC     A,#0FFH
0072E1 FA                MOV      R2,A
0072E2 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM048B (END) -------


----- FUNCTION ?L?COM048E (BEGIN) -----
0072E5 8F82              MOV      DPL,R7
0072E7 8E83              MOV      DPH,R6
0072E9 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM048E (END) -------


----- FUNCTION ?L?COM0491 (BEGIN) -----
0072EC 8D82              MOV      DPL,R5
0072EE 8C83              MOV      DPH,R4
0072F0 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0491 (END) -------


----- FUNCTION ?L?COM0497 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 187


0072F3 7B01              MOV      R3,#01H
0072F5 7F06              MOV      R7,#06H
0072F7 021B8D            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION ?L?COM0497 (END) -------


----- FUNCTION ?L?COM049B (BEGIN) -----
0072FA 74FF              MOV      A,#0FFH
0072FC F5F0              MOV      B,A
0072FE 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM049B (END) -------


----- FUNCTION ?L?COM04C0 (BEGIN) -----
007301 900006            MOV      DPTR,#06H
007304 122084            LCALL    ?C?CSTOPTR
007307 ED                MOV      A,R5
007308 900007            MOV      DPTR,#07H
00730B 22                RET      
----- FUNCTION ?L?COM04C0 (END) -------


----- FUNCTION ?L?COM04C1 (BEGIN) -----
00730C 242D              ADD      A,#02DH
00730E F9                MOV      R1,A
00730F E4                CLR      A
007310 3A                ADDC     A,R2
007311 FA                MOV      R2,A
007312 7D04              MOV      R5,#04H
007314 E4                CLR      A
007315 FF                MOV      R7,A
007316 22                RET      
----- FUNCTION ?L?COM04C1 (END) -------


----- FUNCTION ?L?COM04C2 (BEGIN) -----
007317 A3                INC      DPTR
007318         ?L?COM04C3:
007318 F0                MOVX     @DPTR,A
007319 E4                CLR      A
00731A A3                INC      DPTR
00731B F0                MOVX     @DPTR,A
00731C 7B01              MOV      R3,#01H
00731E 22                RET      
----- FUNCTION ?L?COM04C2 (END) -------


----- FUNCTION ?L?COM04D2 (BEGIN) -----
00731F 122589            LCALL    ?C?PLDXDATA
007322 E9                MOV      A,R1
007323 240A              ADD      A,#0AH
007325 F9                MOV      R1,A
007326 E4                CLR      A
007327 3A                ADDC     A,R2
007328 FA                MOV      R2,A
007329 22                RET      
----- FUNCTION ?L?COM04D2 (END) -------


----- FUNCTION ?L?COM04D7 (BEGIN) -----
00732A EE                MOV      A,R6
00732B         ?L?COM04D8:
00732B F0                MOVX     @DPTR,A
00732C FC                MOV      R4,A
00732D A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 188


00732E EF                MOV      A,R7
00732F F0                MOVX     @DPTR,A
007330 FD                MOV      R5,A
007331 22                RET      
----- FUNCTION ?L?COM04D7 (END) -------


----- FUNCTION ?L?COM04E5 (BEGIN) -----
007332 EE                MOV      A,R6
007333 F0                MOVX     @DPTR,A
007334 A3                INC      DPTR
007335 EF                MOV      A,R7
007336 F0                MOVX     @DPTR,A
007337 AA06              MOV      R2,AR6
007339 F9                MOV      R1,A
00733A 7B01              MOV      R3,#01H
00733C 22                RET      
----- FUNCTION ?L?COM04E5 (END) -------


----- FUNCTION ?L?COM04ED (BEGIN) -----
00733D C4                SWAP     A
00733E F8                MOV      R0,A
00733F 54F0              ANL      A,#0F0H
007341 C8                XCH      A,R0
007342 68                XRL      A,R0
007343 22                RET      
----- FUNCTION ?L?COM04ED (END) -------


----- FUNCTION ?L?COM04EF (BEGIN) -----
007344 F9                MOV      R1,A
007345 E4                CLR      A
007346 3A                ADDC     A,R2
007347 FA                MOV      R2,A
007348 7402              MOV      A,#02H
00734A 22                RET      
----- FUNCTION ?L?COM04EF (END) -------


----- FUNCTION ?L?COM0502 (BEGIN) -----
00734B 904101            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
00734E 7410              MOV      A,#010H
007350 F0                MOVX     @DPTR,A
007351 22                RET      
----- FUNCTION ?L?COM0502 (END) -------


----- FUNCTION ?L?COM0512 (BEGIN) -----
007352 FD                MOV      R5,A
007353 7C00              MOV      R4,#00H
007355 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0512 (END) -------


----- FUNCTION ?L?COM0515 (BEGIN) -----
007358 122589            LCALL    ?C?PLDXDATA
00735B 900002            MOV      DPTR,#02H
00735E 22                RET      
----- FUNCTION ?L?COM0515 (END) -------


----- FUNCTION ?L?COM0532 (BEGIN) -----
00735F F0                MOVX     @DPTR,A
007360 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 189


007361 F0                MOVX     @DPTR,A
007362 FB                MOV      R3,A
007363 FA                MOV      R2,A
007364 F9                MOV      R1,A
007365 22                RET      
----- FUNCTION ?L?COM0532 (END) -------


----- FUNCTION ?L?COM0545 (BEGIN) -----
007366 900003            MOV      DPTR,#03H
007369 02242B            LJMP     ?C?LLDOPTR
----- FUNCTION ?L?COM0545 (END) -------


----- FUNCTION ?L?COM0546 (BEGIN) -----
00736C E9                MOV      A,R1
00736D 9582              SUBB     A,DPL
00736F EA                MOV      A,R2
007370 9583              SUBB     A,DPH
007372 22                RET      
----- FUNCTION ?L?COM0546 (END) -------


----- FUNCTION ?L?COM0548 (BEGIN) -----
007373 1225A9            LCALL    ?C?PSTXDATA
007376 E4                CLR      A
007377 FF                MOV      R7,A
007378 FE                MOV      R6,A
007379 22                RET      
----- FUNCTION ?L?COM0548 (END) -------


----- FUNCTION ?L?COM0578 (BEGIN) -----
00737A 7D01              MOV      R5,#01H
00737C 7B01              MOV      R3,#01H
00737E FE                MOV      R6,A
00737F 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM0578 (END) -------


----- FUNCTION ?L?COM057C (BEGIN) -----
007382 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
007385 901221            MOV      DPTR,#nodeID
007388 E0                MOVX     A,@DPTR
007389 FF                MOV      R7,A
00738A 22                RET      
----- FUNCTION ?L?COM057C (END) -------


----- FUNCTION ?L?COM0591 (BEGIN) -----
00738B 74FF              MOV      A,#0FFH
00738D 75F0F0            MOV      B,#0F0H
007390 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM0591 (END) -------


----- FUNCTION ?L?COM0596 (BEGIN) -----
007393 FE                MOV      R6,A
007394 122589            LCALL    ?C?PLDXDATA
007397 EE                MOV      A,R6
007398 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0596 (END) -------


----- FUNCTION ?L?COM0599 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 190


00739B 122589            LCALL    ?C?PLDXDATA
00739E 7404              MOV      A,#04H
0073A0 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0599 (END) -------


----- FUNCTION ?L?COM059A (BEGIN) -----
0073A3 FF                MOV      R7,A
0073A4 E0                MOVX     A,@DPTR
0073A5 3400              ADDC     A,#00H
0073A7 FE                MOV      R6,A
0073A8 E4                CLR      A
0073A9 FC                MOV      R4,A
0073AA FD                MOV      R5,A
0073AB 22                RET      
----- FUNCTION ?L?COM059A (END) -------


----- FUNCTION ?L?COM05A4 (BEGIN) -----
0073AC A804              MOV      R0,AR4
0073AE A905              MOV      R1,AR5
0073B0 AA06              MOV      R2,AR6
0073B2 AB07              MOV      R3,AR7
0073B4 22                RET      
----- FUNCTION ?L?COM05A4 (END) -------


----- FUNCTION ?L?COM05A7 (BEGIN) -----
0073B5 901221            MOV      DPTR,#nodeID
0073B8 E0                MOVX     A,@DPTR
0073B9 FD                MOV      R5,A
0073BA 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
0073BD 22                RET      
----- FUNCTION ?L?COM05A7 (END) -------


----- FUNCTION ?L?COM05C2 (BEGIN) -----
0073BE 9037C3            MOV      DPTR,#ch
0073C1 E0                MOVX     A,@DPTR
0073C2 FF                MOV      R7,A
0073C3 14                DEC      A
0073C4 F0                MOVX     @DPTR,A
0073C5 EF                MOV      A,R7
0073C6 22                RET      
----- FUNCTION ?L?COM05C2 (END) -------


----- FUNCTION ?L?COM05C3 (BEGIN) -----
0073C7 903940            MOV      DPTR,#ch
0073CA E0                MOVX     A,@DPTR
0073CB FF                MOV      R7,A
0073CC 14                DEC      A
0073CD F0                MOVX     @DPTR,A
0073CE EF                MOV      A,R7
0073CF 22                RET      
----- FUNCTION ?L?COM05C3 (END) -------


----- FUNCTION ?L?COM05C6 (BEGIN) -----
0073D0 E5D2              MOV      A,FHCON2
0073D2 5480              ANL      A,#080H
0073D4 4414              ORL      A,#014H
0073D6 F5D2              MOV      FHCON2,A
0073D8 22                RET      
----- FUNCTION ?L?COM05C6 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 191




----- FUNCTION ?L?COM05D4 (BEGIN) -----
0073D9 F0                MOVX     @DPTR,A
0073DA A3                INC      DPTR
0073DB F0                MOVX     @DPTR,A
0073DC A3                INC      DPTR
0073DD F0                MOVX     @DPTR,A
0073DE A3                INC      DPTR
0073DF F0                MOVX     @DPTR,A
0073E0 22                RET      
----- FUNCTION ?L?COM05D4 (END) -------


----- FUNCTION ?L?COM05DA (BEGIN) -----
0073E1 7C00              MOV      R4,#00H
0073E3 2400              ADD      A,#00H
0073E5 FF                MOV      R7,A
0073E6 EC                MOV      A,R4
0073E7 3E                ADDC     A,R6
0073E8 22                RET      
----- FUNCTION ?L?COM05DA (END) -------


----- FUNCTION ?L?COM05E1 (BEGIN) -----
0073E9 7E00              MOV      R6,#00H
0073EB 121F8D            LCALL    ?C?COPY
0073EE 7B01              MOV      R3,#01H
0073F0 22                RET      
----- FUNCTION ?L?COM05E1 (END) -------


----- FUNCTION ?L?COM05EA (BEGIN) -----
0073F1 FF                MOV      R7,A
0073F2 EE                MOV      A,R6
0073F3 5C                ANL      A,R4
0073F4 FE                MOV      R6,A
0073F5 EF                MOV      A,R7
0073F6 5D                ANL      A,R5
0073F7 4E                ORL      A,R6
0073F8 22                RET      
----- FUNCTION ?L?COM05EA (END) -------


----- FUNCTION ?L?COM05F1 (BEGIN) -----
0073F9 FF                MOV      R7,A
0073FA 907FC0            MOV      DPTR,#firmwareDescriptor+08H
0073FD 7401              MOV      A,#01H
0073FF 93                MOVC     A,@A+DPTR
007400 22                RET      
----- FUNCTION ?L?COM05F1 (END) -------


----- FUNCTION ?L?COM05F4 (BEGIN) -----
007401 7C00              MOV      R4,#00H
007403 FF                MOV      R7,A
007404 EC                MOV      A,R4
007405 35F0              ADDC     A,B
007407 FE                MOV      R6,A
007408 22                RET      
----- FUNCTION ?L?COM05F4 (END) -------


----- FUNCTION ?L?COM05F6 (BEGIN) -----
007409 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 192


00740C AD07              MOV      R5,AR7
00740E AC06              MOV      R4,AR6
007410 22                RET      
----- FUNCTION ?L?COM05F6 (END) -------


----- FUNCTION ?L?COM0613 (BEGIN) -----
007411 FF                MOV      R7,A
007412 54F0              ANL      A,#0F0H
007414 C4                SWAP     A
007415 540F              ANL      A,#0FH
007417 FE                MOV      R6,A
007418 22                RET      
----- FUNCTION ?L?COM0613 (END) -------


----- FUNCTION ?L?COM062E (BEGIN) -----
007419 F582              MOV      DPL,A
00741B E4                CLR      A
00741C 3408              ADDC     A,#HIGH bListenRSSIThreshold
00741E F583              MOV      DPH,A
007420 22                RET      
----- FUNCTION ?L?COM062E (END) -------


----- FUNCTION _ZCB_TsCallbackFunc (BEGIN) -----
;---- Variable 'txS' assigned to Register 'R1/R2/R3' ----
;---- Variable 'txStatus' assigned to Register 'R7' ----
B1:0081AA 90088C            MOV      DPTR,#_ts_stored_callback
B1:0081AD E0                MOVX     A,@DPTR
B1:0081AE FC                MOV      R4,A
B1:0081AF A3                INC      DPTR
B1:0081B0 E0                MOVX     A,@DPTR
B1:0081B1 4C                ORL      A,R4
B1:0081B2 6009              JZ       ?C0002?ZW_TRANSPORT
B1:0081B4 90088C            MOV      DPTR,#_ts_stored_callback
B1:0081B7 12515F            LCALL    ?L?COM0155
B1:0081BA 12271A            LCALL    ?C?ICALL2
B1:0081BD         ?C0002?ZW_TRANSPORT:
B1:0081BD 22                RET      
----- FUNCTION _ZCB_TsCallbackFunc (END) -------


----- FUNCTION _ZCB_TransportDummyApplicationCallback (BEGIN) -----
B1:0081BE 22                RET      
----- FUNCTION _ZCB_TransportDummyApplicationCallback (END) -------


----- FUNCTION _TransportTransmitComplete (BEGIN) -----
B1:0081BF 900AE2            MOV      DPTR,#pTransmittedFrame
B1:0081C2 1225A9            LCALL    ?C?PSTXDATA
B1:0081C5 7F01              MOV      R7,#01H
B1:0081C7 1236A5            LCALL    _ZW_SetRFReceiveMode
B1:0081CA 128CB9            LCALL    ?L?COM050B
B1:0081CD 127060            LCALL    ?L?COM00DC
B1:0081D0 45F0              ORL      A,B
B1:0081D2 601E              JZ       ?C0005?ZW_TRANSPORT
B1:0081D4 900AE2            MOV      DPTR,#pTransmittedFrame
B1:0081D7 122589            LCALL    ?C?PLDXDATA
B1:0081DA C003              PUSH     AR3
B1:0081DC C002              PUSH     AR2
B1:0081DE C001              PUSH     AR1
B1:0081E0 128CB9            LCALL    ?L?COM050B
B1:0081E3 127060            LCALL    ?L?COM00DC
B1:0081E6 12D92D            LCALL    ?L?COM05AD
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 193


B1:0081E9 D001              POP      AR1
B1:0081EB D002              POP      AR2
B1:0081ED D003              POP      AR3
B1:0081EF 12271A            LCALL    ?C?ICALL2
B1:0081F2         ?C0005?ZW_TRANSPORT:
B1:0081F2 22                RET      
----- FUNCTION _TransportTransmitComplete (END) -------


----- FUNCTION TxQueueServiceTransmit (BEGIN) -----
B1:0081F3 E4                CLR      A
B1:0081F4 900B00            MOV      DPTR,#bStatus
;---- Variable 'bFoundWaiting' assigned to Register 'R7' ----
B1:0081F7 F1EF              ACALL    ?L?COM04F2
B1:0081F9 FF                MOV      R7,A
B1:0081FA 9003B3            MOV      DPTR,#bCurrentTransmit
B1:0081FD E0                MOVX     A,@DPTR
B1:0081FE 75F0EB            MOV      B,#0EBH
B1:008201 7146              ACALL    ?L?COM0133
B1:008203 E0                MOVX     A,@DPTR
B1:008204 54F0              ANL      A,#0F0H
B1:008206 6440              XRL      A,#040H
B1:008208 7002              JNZ      $ + 4H
B1:00820A 6100              AJMP     ?C0015?ZW_TX_QUEUE
;---- Variable 'bCount' assigned to Register 'R6' ----
B1:00820C E4                CLR      A
B1:00820D FE                MOV      R6,A
B1:00820E         ?C0016?ZW_TX_QUEUE:
B1:00820E 75F0EB            MOV      B,#0EBH
B1:008211 EE                MOV      A,R6
B1:008212 7146              ACALL    ?L?COM0133
B1:008214 E0                MOVX     A,@DPTR
B1:008215 FD                MOV      R5,A
B1:008216 B40109            CJNE     A,#01H,?C0019?ZW_TX_QUEUE
B1:008219 900B01            MOV      DPTR,#bElement
B1:00821C EE                MOV      A,R6
B1:00821D F0                MOVX     @DPTR,A
B1:00821E E4                CLR      A
B1:00821F FF                MOV      R7,A
B1:008220 8023              SJMP     ?C0017?ZW_TX_QUEUE
B1:008222         ?C0019?ZW_TX_QUEUE:
B1:008222 ED                MOV      A,R5
B1:008223 B4020B            CJNE     A,#02H,?C0020?ZW_TX_QUEUE
B1:008226 900B01            MOV      DPTR,#bElement
B1:008229 E0                MOVX     A,@DPTR
B1:00822A B4FF04            CJNE     A,#0FFH,?C0020?ZW_TX_QUEUE
B1:00822D EE                MOV      A,R6
B1:00822E F0                MOVX     @DPTR,A
B1:00822F 800F              SJMP     ?C0018?ZW_TX_QUEUE
B1:008231         ?C0020?ZW_TX_QUEUE:
B1:008231 75F0EB            MOV      B,#0EBH
B1:008234 EE                MOV      A,R6
B1:008235 7146              ACALL    ?L?COM0133
B1:008237 E0                MOVX     A,@DPTR
B1:008238 54F0              ANL      A,#0F0H
B1:00823A FD                MOV      R5,A
B1:00823B BD8002            CJNE     R5,#080H,?C0018?ZW_TX_QUEUE
B1:00823E 7F01              MOV      R7,#01H
B1:008240         ?C0018?ZW_TX_QUEUE:
B1:008240 0E                INC      R6
B1:008241 EE                MOV      A,R6
B1:008242 B404C9            CJNE     A,#04H,?C0016?ZW_TX_QUEUE
B1:008245         ?C0017?ZW_TX_QUEUE:
B1:008245 EF                MOV      A,R7
B1:008246 6006              JZ       ?C0023?ZW_TX_QUEUE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 194


B1:008248 900B01            MOV      DPTR,#bElement
B1:00824B 74FF              MOV      A,#0FFH
B1:00824D F0                MOVX     @DPTR,A
B1:00824E         ?C0023?ZW_TX_QUEUE:
B1:00824E 900B01            MOV      DPTR,#bElement
B1:008251 E0                MOVX     A,@DPTR
B1:008252 F4                CPL      A
B1:008253 7002              JNZ      $ + 4H
B1:008255 6100              AJMP     ?C0015?ZW_TX_QUEUE
B1:008257 1257F8            LCALL    RFIsReceiving
B1:00825A 5002              JNC      $ + 4H
B1:00825C 6100              AJMP     ?C0015?ZW_TX_QUEUE
B1:00825E E515              MOV      A,RF_status
B1:008260 30E102            JNB      ACC.1,$ + 5H
B1:008263 6100              AJMP     ?C0015?ZW_TX_QUEUE
B1:008265 900B01            MOV      DPTR,#bElement
B1:008268 E0                MOVX     A,@DPTR
B1:008269 90000A            MOV      DPTR,#X4K_TxQueue+03H
B1:00826C F1E8              ACALL    ?L?COM03DD
B1:00826E E0                MOVX     A,@DPTR
B1:00826F 30E409            JNB      ACC.4,?C0025?ZW_TX_QUEUE
B1:008272 90000C            MOV      DPTR,#X4K_TxQueue+05H
B1:008275 12BFEF            LCALL    ?L?COM0422
B1:008278 549F              ANL      A,#09FH
B1:00827A F0                MOVX     @DPTR,A
B1:00827B         ?C0025?ZW_TX_QUEUE:
B1:00827B 900B01            MOV      DPTR,#bElement
B1:00827E E0                MOVX     A,@DPTR
B1:00827F 9000BE            MOV      DPTR,#X4K_TxQueue+0B7H
B1:008282 F1E8              ACALL    ?L?COM03DD
B1:008284 E0                MOVX     A,@DPTR
B1:008285 540F              ANL      A,#0FH
B1:008287 FE                MOV      R6,A
B1:008288 BE0509            CJNE     R6,#05H,?C0028?ZW_TX_QUEUE
B1:00828B 9000C2            MOV      DPTR,#X4K_TxQueue+0BBH
B1:00828E 12BFEF            LCALL    ?L?COM0422
B1:008291 30E120            JNB      ACC.1,?C0027?ZW_TX_QUEUE
B1:008294         ?C0028?ZW_TX_QUEUE:
B1:008294 900B01            MOV      DPTR,#bElement
B1:008297 E0                MOVX     A,@DPTR
B1:008298 FF                MOV      R7,A
B1:008299 75F0EB            MOV      B,#0EBH
B1:00829C 900009            MOV      DPTR,#X4K_TxQueue+02H
B1:00829F 12257D            LCALL    ?C?OFFXADD
B1:0082A2 E0                MOVX     A,@DPTR
B1:0082A3 20E52E            JB       ACC.5,?C0026?ZW_TX_QUEUE
B1:0082A6 75F0EB            MOV      B,#0EBH
B1:0082A9 EF                MOV      A,R7
B1:0082AA 9000C1            MOV      DPTR,#X4K_TxQueue+0BAH
B1:0082AD 12257D            LCALL    ?C?OFFXADD
B1:0082B0 E0                MOVX     A,@DPTR
B1:0082B1 B4FF20            CJNE     A,#0FFH,?C0026?ZW_TX_QUEUE
B1:0082B4         ?C0027?ZW_TX_QUEUE:
B1:0082B4 900B01            MOV      DPTR,#bElement
B1:0082B7 E0                MOVX     A,@DPTR
B1:0082B8 75F0EB            MOV      B,#0EBH
B1:0082BB 90000B            MOV      DPTR,#X4K_TxQueue+04H
B1:0082BE 12257D            LCALL    ?C?OFFXADD
B1:0082C1 C083              PUSH     DPH
B1:0082C3 C082              PUSH     DPL
B1:0082C5 E0                MOVX     A,@DPTR
B1:0082C6 4401              ORL      A,#01H
B1:0082C8 FF                MOV      R7,A
B1:0082C9 A3                INC      DPTR
B1:0082CA E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 195


B1:0082CB D082              POP      DPL
B1:0082CD D083              POP      DPH
B1:0082CF CF                XCH      A,R7
B1:0082D0 F0                MOVX     @DPTR,A
B1:0082D1 A3                INC      DPTR
B1:0082D2 EF                MOV      A,R7
B1:0082D3 F0                MOVX     @DPTR,A
B1:0082D4         ?C0026?ZW_TX_QUEUE:
B1:0082D4 900B01            MOV      DPTR,#bElement
B1:0082D7 F1F6              ACALL    ?L?COM0209
B1:0082D9 125259            LCALL    _RFTransmitNow
B1:0082DC 5022              JNC      ?C0015?ZW_TX_QUEUE
B1:0082DE 900B01            MOV      DPTR,#bElement
B1:0082E1 E0                MOVX     A,@DPTR
B1:0082E2 9003B3            MOV      DPTR,#bCurrentTransmit
B1:0082E5 F0                MOVX     @DPTR,A
B1:0082E6 75F0EB            MOV      B,#0EBH
B1:0082E9 7146              ACALL    ?L?COM0133
B1:0082EB E0                MOVX     A,@DPTR
B1:0082EC 4440              ORL      A,#040H
B1:0082EE F0                MOVX     @DPTR,A
B1:0082EF 900B00            MOV      DPTR,#bStatus
B1:0082F2 7401              MOV      A,#01H
B1:0082F4 F0                MOVX     @DPTR,A
B1:0082F5 900779            MOV      DPTR,#bRestartAckTimerAllowed
B1:0082F8 F0                MOVX     @DPTR,A
B1:0082F9 E515              MOV      A,RF_status
B1:0082FB 30E202            JNB      ACC.2,?C0015?ZW_TX_QUEUE
B1:0082FE D3                SETB     C
B1:0082FF 22                RET      
B1:008300         ?C0015?ZW_TX_QUEUE:
B1:008300 E515              MOV      A,RF_status
B1:008302 30E236            JNB      ACC.2,?C0033?ZW_TX_QUEUE
B1:008305 7F04              MOV      R7,#04H
B1:008307 1237EF            LCALL    _RFClearStatus
B1:00830A 9003B3            MOV      DPTR,#bCurrentTransmit
B1:00830D E0                MOVX     A,@DPTR
B1:00830E FF                MOV      R7,A
B1:00830F 75F0EB            MOV      B,#0EBH
B1:008312 7146              ACALL    ?L?COM0133
B1:008314 E0                MOVX     A,@DPTR
B1:008315 FE                MOV      R6,A
B1:008316 54F0              ANL      A,#0F0H
B1:008318 6440              XRL      A,#040H
B1:00831A 7015              JNZ      ?C0034?ZW_TX_QUEUE
B1:00831C 7142              ACALL    ?L?COM0132
B1:00831E EE                MOV      A,R6
B1:00831F 540F              ANL      A,#0FH
B1:008321 F0                MOVX     @DPTR,A
B1:008322 7142              ACALL    ?L?COM0132
B1:008324 E0                MOVX     A,@DPTR
B1:008325 4480              ORL      A,#080H
B1:008327 F0                MOVX     @DPTR,A
B1:008328 9003B3            MOV      DPTR,#bCurrentTransmit
B1:00832B F1F6              ACALL    ?L?COM0209
B1:00832D 31BF              ACALL    _TransportTransmitComplete
B1:00832F 800A              SJMP     ?C0033?ZW_TX_QUEUE
B1:008331         ?C0034?ZW_TX_QUEUE:
B1:008331 E515              MOV      A,RF_status
B1:008333 30E005            JNB      ACC.0,?C0033?ZW_TX_QUEUE
B1:008336 7F01              MOV      R7,#01H
B1:008338 1236A5            LCALL    _ZW_SetRFReceiveMode
B1:00833B         ?C0033?ZW_TX_QUEUE:
B1:00833B 900B00            MOV      DPTR,#bStatus
B1:00833E E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 196


B1:00833F 24FF              ADD      A,#0FFH
B1:008341 22                RET      
----- FUNCTION TxQueueServiceTransmit (END) -------


----- FUNCTION ?L?COM0132 (BEGIN) -----
B1:008342 75F0EB            MOV      B,#0EBH
B1:008345 EF                MOV      A,R7
B1:008346         ?L?COM0133:
B1:008346 900007            MOV      DPTR,#X4K_TxQueue
B1:008349 02257D            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM0132 (END) -------


----- FUNCTION ?L?COM04C4 (BEGIN) -----
B1:00834C EB                MOV      A,R3
B1:00834D F0                MOVX     @DPTR,A
B1:00834E 7F02              MOV      R7,#02H
----- FUNCTION _TxQueueGetElement (BEGIN) -----
B1:008350 900AFE            MOV      DPTR,#bPriority
B1:008353 EF                MOV      A,R7
;---- Variable 'bFree' assigned to Register 'R7' ----
B1:008354 F1EF              ACALL    ?L?COM04F2
B1:008356 FF                MOV      R7,A
;---- Variable 'fHighPriorityQueued' assigned to Register 'R6' ----
B1:008357 FE                MOV      R6,A
;---- Variable 'bCount' assigned to Register 'R5' ----
B1:008358 FD                MOV      R5,A
B1:008359         ?C0005?ZW_TX_QUEUE:
B1:008359 75F0EB            MOV      B,#0EBH
B1:00835C ED                MOV      A,R5
B1:00835D 7146              ACALL    ?L?COM0133
B1:00835F E0                MOVX     A,@DPTR
B1:008360 FC                MOV      R4,A
B1:008361 700C              JNZ      ?C0008?ZW_TX_QUEUE
B1:008363 900AFF            MOV      DPTR,#bElement
B1:008366 E0                MOVX     A,@DPTR
B1:008367 B4FF02            CJNE     A,#0FFH,?C0009?ZW_TX_QUEUE
B1:00836A ED                MOV      A,R5
B1:00836B F0                MOVX     @DPTR,A
B1:00836C         ?C0009?ZW_TX_QUEUE:
B1:00836C 0F                INC      R7
B1:00836D 8006              SJMP     ?C0007?ZW_TX_QUEUE
B1:00836F         ?C0008?ZW_TX_QUEUE:
B1:00836F EC                MOV      A,R4
B1:008370 30E002            JNB      ACC.0,?C0007?ZW_TX_QUEUE
B1:008373 7E01              MOV      R6,#01H
B1:008375         ?C0007?ZW_TX_QUEUE:
B1:008375 0D                INC      R5
B1:008376 ED                MOV      A,R5
B1:008377 B404DF            CJNE     A,#04H,?C0005?ZW_TX_QUEUE
B1:00837A         ?C0006?ZW_TX_QUEUE:
B1:00837A 900AFE            MOV      DPTR,#bPriority
B1:00837D E0                MOVX     A,@DPTR
B1:00837E 6401              XRL      A,#01H
B1:008380 600D              JZ       ?C0012?ZW_TX_QUEUE
B1:008382 EF                MOV      A,R7
B1:008383 C3                CLR      C
B1:008384 9402              SUBB     A,#02H
B1:008386 5007              JNC      ?C0012?ZW_TX_QUEUE
B1:008388 EE                MOV      A,R6
B1:008389 7004              JNZ      ?C0012?ZW_TX_QUEUE
B1:00838B A3                INC      DPTR
B1:00838C 74FF              MOV      A,#0FFH
B1:00838E F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 197


B1:00838F         ?C0012?ZW_TX_QUEUE:
B1:00838F 900AFF            MOV      DPTR,#bElement
B1:008392 E0                MOVX     A,@DPTR
B1:008393 FF                MOV      R7,A
B1:008394 C3                CLR      C
B1:008395 9404              SUBB     A,#04H
B1:008397 501E              JNC      ?C0013?ZW_TX_QUEUE
B1:008399 EF                MOV      A,R7
B1:00839A F1F7              ACALL    ?L?COM020A
B1:00839C 7DEB              MOV      R5,#0EBH
B1:00839E E4                CLR      A
B1:00839F FF                MOV      R7,A
B1:0083A0 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:0083A3 900AFE            MOV      DPTR,#bPriority
B1:0083A6 E0                MOVX     A,@DPTR
B1:0083A7 4410              ORL      A,#010H
B1:0083A9 FF                MOV      R7,A
B1:0083AA A3                INC      DPTR
B1:0083AB E0                MOVX     A,@DPTR
B1:0083AC FE                MOV      R6,A
B1:0083AD 75F0EB            MOV      B,#0EBH
B1:0083B0 7146              ACALL    ?L?COM0133
B1:0083B2 EF                MOV      A,R7
B1:0083B3 F0                MOVX     @DPTR,A
B1:0083B4 EE                MOV      A,R6
B1:0083B5 E1F7              AJMP     ?L?COM020A
B1:0083B7         ?C0013?ZW_TX_QUEUE:
B1:0083B7 027070            LJMP     ?L?COM00E1
----- FUNCTION _TxQueueGetElement (END) -------


----- FUNCTION _ZCB_ZWRepeatComplete (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B1:0083BA EF                MOV      A,R7
B1:0083BB 7002              JNZ      $ + 4H
B1:0083BD A12D              AJMP     ?C0238?ZW_TRANSPORT
B1:0083BF B138              ACALL    ?L?COM0016
B1:0083C1 4A                ORL      A,R2
B1:0083C2 7002              JNZ      $ + 4H
B1:0083C4 A12D              AJMP     ?C0238?ZW_TRANSPORT
B1:0083C6 E9                MOV      A,R1
B1:0083C7 24BB              ADD      A,#0BBH
B1:0083C9 D122              ACALL    ?L?COM0006
B1:0083CB 30E002            JNB      ACC.0,$ + 5H
B1:0083CE A12D              AJMP     ?C0238?ZW_TRANSPORT
B1:0083D0 B138              ACALL    ?L?COM0016
B1:0083D2 24B8              ADD      A,#0B8H
B1:0083D4 D122              ACALL    ?L?COM0006
B1:0083D6 900A43            MOV      DPTR,#routingBuffer
B1:0083D9 F0                MOVX     @DPTR,A
B1:0083DA B138              ACALL    ?L?COM0016
B1:0083DC 24BA              ADD      A,#0BAH
B1:0083DE 126145            LCALL    ?L?COM0045
B1:0083E1 7B01              MOV      R3,#01H
B1:0083E3 7A0A              MOV      R2,#HIGH routingBuffer+01H
B1:0083E5 7944              MOV      R1,#LOW routingBuffer+01H
B1:0083E7 7F07              MOV      R7,#07H
B1:0083E9 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:0083EC B138              ACALL    ?L?COM0016
B1:0083EE 24B6              ADD      A,#0B6H
B1:0083F0 D122              ACALL    ?L?COM0006
B1:0083F2 900A4B            MOV      DPTR,#repeatSource
B1:0083F5 F0                MOVX     @DPTR,A
B1:0083F6 7F02              MOV      R7,#02H
B1:0083F8 7150              ACALL    _TxQueueGetElement
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 198


B1:0083FA 900A40            MOV      DPTR,#pFrame
B1:0083FD 12976A            LCALL    ?L?COM02DF
B1:008400 7002              JNZ      $ + 4H
B1:008402 A12D              AJMP     ?C0238?ZW_TRANSPORT
B1:008404         ?C0237?ZW_TRANSPORT:
B1:008404 900A40            MOV      DPTR,#pFrame
B1:008407 125C41            LCALL    ?L?COM00B6
B1:00840A 7403              MOV      A,#03H
B1:00840C 122072            LCALL    ?C?CSTPTR
B1:00840F 900A46            MOV      DPTR,#routingBuffer+03H
B1:008412 E0                MOVX     A,@DPTR
B1:008413 C4                SWAP     A
B1:008414 540F              ANL      A,#0FH
B1:008416 F4                CPL      A
B1:008417 04                INC      A
B1:008418 FF                MOV      R7,A
B1:008419 C3                CLR      C
B1:00841A 740B              MOV      A,#0BH
B1:00841C 9F                SUBB     A,R7
B1:00841D B12E              ACALL    ?L?COM0103
B1:00841F 24D8              ADD      A,#0D8H
B1:008421 F1E0              ACALL    ?L?COM002E
B1:008423 B12F              ACALL    ?L?COM0104
B1:008425 24B1              ADD      A,#0B1H
B1:008427 F9                MOV      R1,A
B1:008428 E4                CLR      A
B1:008429 125765            LCALL    ?L?COM01E3
B1:00842C 900A40            MOV      DPTR,#pFrame
B1:00842F 122589            LCALL    ?C?PLDXDATA
B1:008432 128F5A            LCALL    _SetTransmitHomeID
B1:008435 900A44            MOV      DPTR,#routingBuffer+01H
B1:008438 E0                MOVX     A,@DPTR
B1:008439 B12E              ACALL    ?L?COM0103
B1:00843B 24B6              ADD      A,#0B6H
B1:00843D F1E0              ACALL    ?L?COM002E
B1:00843F B12F              ACALL    ?L?COM0104
B1:008441 12FE78            LCALL    ?L?COM0274
B1:008444 4480              ORL      A,#080H
B1:008446 122072            LCALL    ?C?CSTPTR
B1:008449 B12F              ACALL    ?L?COM0104
B1:00844B 24B1              ADD      A,#0B1H
B1:00844D D122              ACALL    ?L?COM0006
B1:00844F B12E              ACALL    ?L?COM0103
B1:008451 24D8              ADD      A,#0D8H
B1:008453 D122              ACALL    ?L?COM0006
B1:008455 2F                ADD      A,R7
B1:008456 04                INC      A
B1:008457 B12E              ACALL    ?L?COM0103
B1:008459 24B9              ADD      A,#0B9H
B1:00845B F1E0              ACALL    ?L?COM002E
B1:00845D 900A43            MOV      DPTR,#routingBuffer
B1:008460 E0                MOVX     A,@DPTR
B1:008461 540F              ANL      A,#0FH
B1:008463 B12E              ACALL    ?L?COM0103
B1:008465 24B8              ADD      A,#0B8H
B1:008467 F1E0              ACALL    ?L?COM002E
B1:008469 900A4B            MOV      DPTR,#repeatSource
B1:00846C E0                MOVX     A,@DPTR
B1:00846D B12E              ACALL    ?L?COM0103
B1:00846F 24BA              ADD      A,#0BAH
B1:008471 F1E0              ACALL    ?L?COM002E
B1:008473 900A46            MOV      DPTR,#routingBuffer+03H
B1:008476 E0                MOVX     A,@DPTR
B1:008477 FF                MOV      R7,A
B1:008478 C4                SWAP     A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 199


B1:008479 54F0              ANL      A,#0F0H
B1:00847B FE                MOV      R6,A
B1:00847C B12F              ACALL    ?L?COM0104
B1:00847E 24BB              ADD      A,#0BBH
B1:008480 F9                MOV      R1,A
B1:008481 E4                CLR      A
B1:008482 3A                ADDC     A,R2
B1:008483 FA                MOV      R2,A
B1:008484 EE                MOV      A,R6
B1:008485 122072            LCALL    ?C?CSTPTR
B1:008488 4401              ORL      A,#01H
B1:00848A 122072            LCALL    ?C?CSTPTR
B1:00848D 4404              ORL      A,#04H
B1:00848F 122072            LCALL    ?C?CSTPTR
B1:008492 EF                MOV      A,R7
B1:008493 24FE              ADD      A,#0FEH
B1:008495 540F              ANL      A,#0FH
B1:008497 FF                MOV      R7,A
B1:008498 900A46            MOV      DPTR,#routingBuffer+03H
B1:00849B E0                MOVX     A,@DPTR
B1:00849C 54F0              ANL      A,#0F0H
B1:00849E FE                MOV      R6,A
B1:00849F 4F                ORL      A,R7
B1:0084A0 B12E              ACALL    ?L?COM0103
B1:0084A2 24BC              ADD      A,#0BCH
B1:0084A4 F1E0              ACALL    ?L?COM002E
B1:0084A6 540F              ANL      A,#0FH
B1:0084A8 FF                MOV      R7,A
B1:0084A9 BF0F0B            CJNE     R7,#0FH,?C0239?ZW_TRANSPORT
B1:0084AC B12F              ACALL    ?L?COM0104
B1:0084AE 24B7              ADD      A,#0B7H
B1:0084B0 D122              ACALL    ?L?COM0006
B1:0084B2 4440              ORL      A,#040H
B1:0084B4 122072            LCALL    ?C?CSTPTR
B1:0084B7         ?C0239?ZW_TRANSPORT:
B1:0084B7 EE                MOV      A,R6
B1:0084B8 C4                SWAP     A
B1:0084B9 540F              ANL      A,#0FH
B1:0084BB FE                MOV      R6,A
B1:0084BC D3                SETB     C
B1:0084BD 9404              SUBB     A,#04H
B1:0084BF AF06              MOV      R7,AR6
B1:0084C1 4002              JC       ?C0240?ZW_TRANSPORT
B1:0084C3 7F04              MOV      R7,#04H
B1:0084C5         ?C0240?ZW_TRANSPORT:
B1:0084C5         ?C0241?ZW_TRANSPORT:
B1:0084C5 B12F              ACALL    ?L?COM0104
B1:0084C7 24BD              ADD      A,#0BDH
B1:0084C9 F9                MOV      R1,A
B1:0084CA E4                CLR      A
B1:0084CB 3A                ADDC     A,R2
B1:0084CC FA                MOV      R2,A
B1:0084CD C003              PUSH     AR3
B1:0084CF C002              PUSH     AR2
B1:0084D1 C001              PUSH     AR1
B1:0084D3 7B01              MOV      R3,#01H
B1:0084D5 7A0A              MOV      R2,#HIGH routingBuffer+04H
B1:0084D7 7947              MOV      R1,#LOW routingBuffer+04H
B1:0084D9 126149            LCALL    ?L?COM0047
B1:0084DC D001              POP      AR1
B1:0084DE D002              POP      AR2
B1:0084E0 D003              POP      AR3
B1:0084E2 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:0084E5         ?C0242?ZW_TRANSPORT:
B1:0084E5 900A40            MOV      DPTR,#pFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 200


B1:0084E8 128FD5            LCALL    ?L?COM0057
B1:0084EB D122              ACALL    ?L?COM0006
B1:0084ED 4420              ORL      A,#020H
B1:0084EF 122072            LCALL    ?C?CSTPTR
B1:0084F2 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:0084F5 E0                MOVX     A,@DPTR
B1:0084F6 B12E              ACALL    ?L?COM0103
B1:0084F8 24B6              ADD      A,#0B6H
B1:0084FA D122              ACALL    ?L?COM0006
B1:0084FC FD                MOV      R5,A
B1:0084FD B12F              ACALL    ?L?COM0104
B1:0084FF 24BA              ADD      A,#0BAH
B1:008501 D122              ACALL    ?L?COM0006
B1:008503 FB                MOV      R3,A
B1:008504 C003              PUSH     AR3
B1:008506 B12F              ACALL    ?L?COM0104
B1:008508 12C7CB            LCALL    ?L?COM0188
B1:00850B 12978D            LCALL    ?L?COM0394
B1:00850E B12F              ACALL    ?L?COM0104
B1:008510 24B1              ADD      A,#0B1H
B1:008512 D122              ACALL    ?L?COM0006
B1:008514 12FEAB            LCALL    ?L?COM0421
B1:008517 900A40            MOV      DPTR,#pFrame
B1:00851A 128FD5            LCALL    ?L?COM0057
B1:00851D D122              ACALL    ?L?COM0006
B1:00851F 12FEB4            LCALL    ?L?COM044B
B1:008522 900A40            MOV      DPTR,#pFrame
B1:008525 129781            LCALL    ?L?COM02DB
B1:008528 D003              POP      AR3
B1:00852A 1292BF            LCALL    _EnqueueSingleDataPtr
B1:00852D         ?C0238?ZW_TRANSPORT:
B1:00852D 22                RET      
----- FUNCTION _ZCB_ZWRepeatComplete (END) -------


----- FUNCTION ?L?COM0103 (BEGIN) -----
B1:00852E FF                MOV      R7,A
B1:00852F         ?L?COM0104:
B1:00852F 900A40            MOV      DPTR,#pFrame
B1:008532 122589            LCALL    ?C?PLDXDATA
B1:008535 E9                MOV      A,R1
B1:008536 22                RET      
----- FUNCTION ?L?COM0103 (END) -------


----- FUNCTION ?L?COM0015 (BEGIN) -----
B1:008537 FF                MOV      R7,A
B1:008538         ?L?COM0016:
B1:008538 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00853B 122589            LCALL    ?C?PLDXDATA
B1:00853E E9                MOV      A,R1
B1:00853F 22                RET      
----- FUNCTION ?L?COM0015 (END) -------


----- FUNCTION _ProtocolWaitForACK (BEGIN) -----
;---- Variable 'pTransmittedFrame' assigned to Register 'R1/R2/R3' ----
B1:008540 903999            MOV      DPTR,#pFrameWaitingForACK
B1:008543 1225A9            LCALL    ?C?PSTXDATA
B1:008546 E9                MOV      A,R1
B1:008547 24E3              ADD      A,#0E3H
B1:008549 D122              ACALL    ?L?COM0006
B1:00854B 6018              JZ       ?C0012?ZW_TXQ_PROTOCOL
B1:00854D E4                CLR      A
B1:00854E 9039B0            MOV      DPTR,#delayCountProtocol
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 201


B1:008551 F0                MOVX     @DPTR,A
B1:008552 B138              ACALL    ?L?COM0016
B1:008554 125C45            LCALL    ?L?COM00B8
B1:008557 7401              MOV      A,#01H
B1:008559 122072            LCALL    ?C?CSTPTR
B1:00855C 7E1A              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:00855E 7F34              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:008560 FD                MOV      R5,A
B1:008561 7C00              MOV      R4,#00H
B1:008563 807C              SJMP     ?C0050?ZW_TXQ_PROTOCOL
B1:008565         ?C0012?ZW_TXQ_PROTOCOL:
B1:008565 B138              ACALL    ?L?COM0016
B1:008567 2401              ADD      A,#01H
B1:008569 D122              ACALL    ?L?COM0006
B1:00856B D3                SETB     C
B1:00856C 9401              SUBB     A,#01H
B1:00856E 403B              JC       ?C0014?ZW_TXQ_PROTOCOL
B1:008570 12CFF3            LCALL    TxRandom
B1:008573 9039B0            MOV      DPTR,#delayCountProtocol
B1:008576 EF                MOV      A,R7
B1:008577 F0                MOVX     @DPTR,A
B1:008578 7E1A              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:00857A 7F34              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:00857C B138              ACALL    ?L?COM0016
B1:00857E 24B7              ADD      A,#0B7H
B1:008580 D122              ACALL    ?L?COM0006
B1:008582 30E719            JNB      ACC.7,?C0015?ZW_TXQ_PROTOCOL
B1:008585 B138              ACALL    ?L?COM0016
B1:008587 24BB              ADD      A,#0BBH
B1:008589 D122              ACALL    ?L?COM0006
B1:00858B 20E010            JB       ACC.0,?C0015?ZW_TXQ_PROTOCOL
B1:00858E B138              ACALL    ?L?COM0016
B1:008590 24BC              ADD      A,#0BCH
B1:008592 D122              ACALL    ?L?COM0006
B1:008594 12DAAA            LCALL    ?L?COM0588
B1:008597 B50404            CJNE     A,AR4,?C0015?ZW_TXQ_PROTOCOL
B1:00859A 7D07              MOV      R5,#07H
B1:00859C 8009              SJMP     ?C0016?ZW_TXQ_PROTOCOL
B1:00859E         ?C0015?ZW_TXQ_PROTOCOL:
B1:00859E B138              ACALL    ?L?COM0016
B1:0085A0 24B1              ADD      A,#0B1H
B1:0085A2 D122              ACALL    ?L?COM0006
B1:0085A4 129005            LCALL    ?L?COM05DF
B1:0085A7         ?C0016?ZW_TXQ_PROTOCOL:
B1:0085A7 7C00              MOV      R4,#00H
B1:0085A9         
B1:0085A9 8036              SJMP     ?C0050?ZW_TXQ_PROTOCOL
B1:0085AB         ?C0014?ZW_TXQ_PROTOCOL:
B1:0085AB E4                CLR      A
B1:0085AC 9039B0            MOV      DPTR,#delayCountProtocol
B1:0085AF F0                MOVX     @DPTR,A
B1:0085B0 7E1A              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:0085B2 7F34              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:0085B4 B138              ACALL    ?L?COM0016
B1:0085B6 24B7              ADD      A,#0B7H
B1:0085B8 D122              ACALL    ?L?COM0006
B1:0085BA 30E719            JNB      ACC.7,?C0018?ZW_TXQ_PROTOCOL
B1:0085BD B138              ACALL    ?L?COM0016
B1:0085BF 24BB              ADD      A,#0BBH
B1:0085C1 D122              ACALL    ?L?COM0006
B1:0085C3 20E010            JB       ACC.0,?C0018?ZW_TXQ_PROTOCOL
B1:0085C6 B138              ACALL    ?L?COM0016
B1:0085C8 24BC              ADD      A,#0BCH
B1:0085CA D122              ACALL    ?L?COM0006
B1:0085CC 12DAAA            LCALL    ?L?COM0588
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 202


B1:0085CF B50404            CJNE     A,AR4,?C0018?ZW_TXQ_PROTOCOL
B1:0085D2 7D07              MOV      R5,#07H
B1:0085D4 8009              SJMP     ?C0019?ZW_TXQ_PROTOCOL
B1:0085D6         ?C0018?ZW_TXQ_PROTOCOL:
B1:0085D6 B138              ACALL    ?L?COM0016
B1:0085D8 24B1              ADD      A,#0B1H
B1:0085DA D122              ACALL    ?L?COM0006
B1:0085DC 129005            LCALL    ?L?COM05DF
B1:0085DF         ?C0019?ZW_TXQ_PROTOCOL:
B1:0085DF 7C00              MOV      R4,#00H
B1:0085E1         
B1:;----                  JMP      _TransmitTimerStart
----- FUNCTION _ProtocolWaitForACK (END) -------


----- FUNCTION _TransmitTimerStart (BEGIN) -----
B1:0085E1 900AF8            MOV      DPTR,#func
B1:0085E4 EE                MOV      A,R6
B1:0085E5 F0                MOVX     @DPTR,A
B1:0085E6 A3                INC      DPTR
B1:0085E7 EF                MOV      A,R7
B1:0085E8 F0                MOVX     @DPTR,A
;---- Variable 'timerTicks' assigned to Register 'R4/R5' ----
B1:0085E9 903998            MOV      DPTR,#bRetransmitTimer
B1:0085EC 7401              MOV      A,#01H
B1:0085EE F0                MOVX     @DPTR,A
B1:0085EF AE04              MOV      R6,AR4
B1:0085F1 AF05              MOV      R7,AR5
B1:0085F3 128806            LCALL    _TimeOutConvert
B1:0085F6 AC06              MOV      R4,AR6
B1:0085F8 AD07              MOV      R5,AR7
B1:0085FA 900AF8            MOV      DPTR,#func
B1:0085FD E0                MOVX     A,@DPTR
B1:0085FE FE                MOV      R6,A
B1:0085FF A3                INC      DPTR
B1:008600 E0                MOVX     A,@DPTR
B1:008601 FF                MOV      R7,A
B1:008602 021C23            LJMP     ?INTERBANK_TABLE?_TransportTimerStart
----- FUNCTION _TransmitTimerStart (END) -------


----- FUNCTION ?L?COM0001 (BEGIN) -----
B1:008605 903C83            MOV      DPTR,#pCmd
B1:008608 122589            LCALL    ?C?PLDXDATA
B1:00860B E9                MOV      A,R1
B1:00860C 2403              ADD      A,#03H
B1:00860E F9                MOV      R1,A
B1:00860F E4                CLR      A
B1:008610 3A                ADDC     A,R2
B1:008611 FA                MOV      R2,A
B1:008612 121FB3            LCALL    ?C?CLDPTR
B1:008615 903C8E            MOV      DPTR,#n
B1:008618         ?L?COM0002:
B1:008618 F0                MOVX     @DPTR,A
B1:008619         ?L?COM0003:
B1:008619 903C83            MOV      DPTR,#pCmd
B1:00861C         ?L?COM0004:
B1:00861C 122589            LCALL    ?C?PLDXDATA
B1:00861F         ?L?COM0005:
B1:00861F E9                MOV      A,R1
B1:008620 2402              ADD      A,#02H
B1:008622         ?L?COM0006:
B1:008622 F9                MOV      R1,A
B1:008623 E4                CLR      A
B1:008624 3A                ADDC     A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 203


B1:008625 FA                MOV      R2,A
B1:008626 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0001 (END) -------


----- FUNCTION _HandleTransferAck (BEGIN) -----
B1:008629 900B0C            MOV      DPTR,#bTransferAckRssi
B1:00862C EF                MOV      A,R7
B1:00862D F0                MOVX     @DPTR,A
B1:00862E B138              ACALL    ?L?COM0016
B1:008630 24B7              ADD      A,#0B7H
B1:008632 D122              ACALL    ?L?COM0006
B1:008634 FF                MOV      R7,A
B1:008635 30E77B            JNB      ACC.7,?C0417?ZW_TRANSPORT
B1:008638 540F              ANL      A,#0FH
B1:00863A 6401              XRL      A,#01H
B1:00863C 7075              JNZ      ?C0417?ZW_TRANSPORT
B1:00863E B138              ACALL    ?L?COM0016
B1:008640 24B6              ADD      A,#0B6H
B1:008642 D122              ACALL    ?L?COM0006
B1:008644 12DA4B            LCALL    ?L?COM0163
B1:008647 706A              JNZ      ?C0417?ZW_TRANSPORT
B1:008649 90076E            MOV      DPTR,#isRoutedAckErr
B1:00864C E0                MOVX     A,@DPTR
B1:00864D 7064              JNZ      ?C0417?ZW_TRANSPORT
B1:00864F 90399C            MOV      DPTR,#waitingForRoutedACK
B1:008652 04                INC      A
B1:008653 F0                MOVX     @DPTR,A
B1:008654 B138              ACALL    ?L?COM0016
B1:008656 24BB              ADD      A,#0BBH
B1:008658 D122              ACALL    ?L?COM0006
B1:00865A 30E33B            JNB      ACC.3,?C0418?ZW_TRANSPORT
B1:00865D B138              ACALL    ?L?COM0016
B1:00865F 24BC              ADD      A,#0BCH
B1:008661 D122              ACALL    ?L?COM0006
B1:008663 903999            MOV      DPTR,#pFrameWaitingForACK
B1:008666 12FE6D            LCALL    ?L?COM000C
B1:008669 128FE6            LCALL    ?L?COM004F
B1:00866C 121FB3            LCALL    ?C?CLDPTR
B1:00866F 540F              ANL      A,#0FH
B1:008671 7025              JNZ      ?C0418?ZW_TRANSPORT
B1:008673 B138              ACALL    ?L?COM0016
B1:008675 2F                ADD      A,R7
B1:008676 F9                MOV      R1,A
B1:008677 EE                MOV      A,R6
B1:008678 3A                ADDC     A,R2
B1:008679 FA                MOV      R2,A
B1:00867A E9                MOV      A,R1
B1:00867B 24BE              ADD      A,#0BEH
B1:00867D D122              ACALL    ?L?COM0006
B1:00867F 5460              ANL      A,#060H
B1:008681 6015              JZ       ?C0418?ZW_TRANSPORT
B1:008683 B138              ACALL    ?L?COM0016
B1:008685 24BC              ADD      A,#0BCH
B1:008687 D122              ACALL    ?L?COM0006
B1:008689 C4                SWAP     A
B1:00868A 540F              ANL      A,#0FH
B1:00868C 2404              ADD      A,#04H
B1:00868E 12FF01            LCALL    ?L?COM05B7
B1:008691 7D6E              MOV      R5,#06EH
B1:008693 7C00              MOV      R4,#00H
B1:008695 02BFF8            LJMP     _TransmitTimerStart_NoSpeed
B1:008698         ?C0418?ZW_TRANSPORT:
B1:008698 E4                CLR      A
B1:008699 900773            MOV      DPTR,#delayCount
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 204


B1:00869C F0                MOVX     @DPTR,A
B1:00869D B138              ACALL    ?L?COM0016
B1:00869F 24BC              ADD      A,#0BCH
B1:0086A1 D122              ACALL    ?L?COM0006
B1:0086A3 C4                SWAP     A
B1:0086A4 540F              ANL      A,#0FH
B1:0086A6 75F03E            MOV      B,#03EH
B1:0086A9 A4                MUL      AB
B1:0086AA FD                MOV      R5,A
B1:0086AB ACF0              MOV      R4,B
B1:0086AD 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:0086AF 7F6C              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:0086B1 A1E1              AJMP     _TransmitTimerStart
B1:0086B3         ?C0417?ZW_TRANSPORT:
B1:0086B3 B138              ACALL    ?L?COM0016
B1:0086B5 24B7              ADD      A,#0B7H
B1:0086B7 D122              ACALL    ?L?COM0006
B1:0086B9 20E714            JB       ACC.7,?C0421?ZW_TRANSPORT
B1:0086BC 900871            MOV      DPTR,#activeTransmit+01H
B1:0086BF E0                MOVX     A,@DPTR
B1:0086C0 F4                CPL      A
B1:0086C1 6003              JZ       ?C0422?ZW_TRANSPORT
B1:0086C3 12C062            LCALL    ?L?COM05B9
B1:0086C6         ?C0422?ZW_TRANSPORT:
B1:0086C6 B138              ACALL    ?L?COM0016
B1:0086C8 24B2              ADD      A,#0B2H
B1:0086CA 12BEFC            LCALL    ?L?COM0312
B1:0086CD 12C17A            LCALL    ?L?COM0505
B1:0086D0         ?C0421?ZW_TRANSPORT:
B1:0086D0 128FFD            LCALL    TransmitTimerStop
B1:0086D3 7A08              MOV      R2,#HIGH abRssiFeedback+01H
B1:0086D5 7990              MOV      R1,#LOW abRssiFeedback+01H
B1:0086D7 12FEEF            LCALL    ?L?COM0567
B1:0086DA 900B0C            MOV      DPTR,#bTransferAckRssi
B1:0086DD E0                MOVX     A,@DPTR
B1:0086DE 90088F            MOV      DPTR,#abRssiFeedback
B1:0086E1 F0                MOVX     @DPTR,A
B1:0086E2 901222            MOV      DPTR,#rfRxCurrentCh
B1:0086E5 E0                MOVX     A,@DPTR
B1:0086E6 B137              ACALL    ?L?COM0015
B1:0086E8 24E4              ADD      A,#0E4H
B1:0086EA F1E0              ACALL    ?L?COM002E
B1:0086EC 7B01              MOV      R3,#01H
B1:0086EE 7A08              MOV      R2,#HIGH abRssiFeedback
B1:0086F0 798F              MOV      R1,#LOW abRssiFeedback
B1:0086F2 7F01              MOV      R7,#01H
B1:;----                  JMP      _TxPermanentlyDone
----- FUNCTION _HandleTransferAck (END) -------


----- FUNCTION _TxPermanentlyDone (BEGIN) -----
B1:0086F4 904217            MOV      DPTR,#fStatus
B1:0086F7 127088            LCALL    ?L?COM00F4
B1:0086FA 12DC6B            LCALL    ClearSendDataTxStatus
B1:0086FD B138              ACALL    ?L?COM0016
B1:0086FF 4A                ORL      A,R2
B1:008700 C3                CLR      C
B1:008701 6001              JZ       ?C0025?ZW_TXQ_PROTOCOL
B1:008703 D3                SETB     C
B1:008704         ?C0025?ZW_TXQ_PROTOCOL:
B1:008704         ?C0026?ZW_TXQ_PROTOCOL:
B1:008704 4002              JC       $ + 4H
B1:008706 E1D1              AJMP     ?C0027?ZW_TXQ_PROTOCOL
B1:008708         ?C0024?ZW_TXQ_PROTOCOL:
B1:008708 12FDAF            LCALL    ?L?COM04B4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 205


B1:00870B 5014              JNC      ?C0028?ZW_TXQ_PROTOCOL
B1:00870D E0                MOVX     A,@DPTR
B1:00870E FF                MOV      R7,A
B1:00870F 9404              SUBB     A,#04H
B1:008711 5002              JNC      ?C0029?ZW_TXQ_PROTOCOL
B1:008713 8002              SJMP     ?C0030?ZW_TXQ_PROTOCOL
B1:008715         ?C0029?ZW_TXQ_PROTOCOL:
B1:008715 7F04              MOV      R7,#04H
B1:008717         ?C0030?ZW_TXQ_PROTOCOL:
B1:008717 B138              ACALL    ?L?COM0016
B1:008719 24BD              ADD      A,#0BDH
B1:00871B 126145            LCALL    ?L?COM0045
B1:00871E 12FEDD            LCALL    ?L?COM0516
B1:008721         ?C0028?ZW_TXQ_PROTOCOL:
B1:008721 12885C            LCALL    ?L?COM000E
B1:008724 12FECC            LCALL    ?L?COM0509
B1:008727 B138              ACALL    ?L?COM0016
B1:008729 24DF              ADD      A,#0DFH
B1:00872B D122              ACALL    ?L?COM0006
B1:00872D 9039A7            MOV      DPTR,#tx_status+0AH
B1:008730 F0                MOVX     @DPTR,A
B1:008731 B138              ACALL    ?L?COM0016
B1:008733 24E6              ADD      A,#0E6H
B1:008735 D122              ACALL    ?L?COM0006
B1:008737 9039AD            MOV      DPTR,#tx_status+010H
B1:00873A F0                MOVX     @DPTR,A
B1:00873B B138              ACALL    ?L?COM0016
B1:00873D 24E7              ADD      A,#0E7H
B1:00873F D122              ACALL    ?L?COM0006
B1:008741 9039AE            MOV      DPTR,#tx_status+011H
B1:008744 F0                MOVX     @DPTR,A
B1:008745 B138              ACALL    ?L?COM0016
B1:008747 24E8              ADD      A,#0E8H
B1:008749 D122              ACALL    ?L?COM0006
B1:00874B 9039AF            MOV      DPTR,#tx_status+012H
B1:00874E F0                MOVX     @DPTR,A
B1:00874F B138              ACALL    ?L?COM0016
B1:008751 24E4              ADD      A,#0E4H
B1:008753 D122              ACALL    ?L?COM0006
B1:008755 9039A5            MOV      DPTR,#tx_status+08H
B1:008758 F0                MOVX     @DPTR,A
B1:008759 B138              ACALL    ?L?COM0016
B1:00875B 24E5              ADD      A,#0E5H
B1:00875D D122              ACALL    ?L?COM0006
B1:00875F 9039A6            MOV      DPTR,#tx_status+09H
B1:008762 F0                MOVX     @DPTR,A
B1:008763 B138              ACALL    ?L?COM0016
B1:008765 24E9              ADD      A,#0E9H
B1:008767 127060            LCALL    ?L?COM00DC
B1:00876A 12FE8E            LCALL    ?L?COM03DC
B1:00876D 903999            MOV      DPTR,#pFrameWaitingForACK
B1:008770 122589            LCALL    ?C?PLDXDATA
B1:008773 12958A            LCALL    _TxQueueReleaseElement
B1:008776 E4                CLR      A
B1:008777 90399C            MOV      DPTR,#waitingForRoutedACK
B1:00877A F0                MOVX     @DPTR,A
B1:00877B 904217            MOV      DPTR,#fStatus
B1:00877E E0                MOVX     A,@DPTR
B1:00877F 6012              JZ       ?C0031?ZW_TXQ_PROTOCOL
B1:008781 A3                INC      DPTR
B1:008782 122589            LCALL    ?C?PLDXDATA
B1:008785 126149            LCALL    ?L?COM0047
B1:008788 7B01              MOV      R3,#01H
B1:00878A 7A39              MOV      R2,#HIGH tx_status+03H
B1:00878C 79A0              MOV      R1,#LOW tx_status+03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 206


B1:00878E 7F05              MOV      R7,#05H
B1:008790 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:008793         ?C0031?ZW_TXQ_PROTOCOL:
B1:008793 904217            MOV      DPTR,#fStatus
B1:008796 E0                MOVX     A,@DPTR
B1:008797 7F01              MOV      R7,#01H
B1:008799 6002              JZ       ?C0032?ZW_TXQ_PROTOCOL
B1:00879B 7F00              MOV      R7,#00H
B1:00879D         ?C0032?ZW_TXQ_PROTOCOL:
B1:00879D         ?C0033?ZW_TXQ_PROTOCOL:
B1:00879D 904217            MOV      DPTR,#fStatus
B1:0087A0 EF                MOV      A,R7
B1:0087A1 F0                MOVX     @DPTR,A
B1:0087A2 B138              ACALL    ?L?COM0016
B1:0087A4 12705E            LCALL    ?L?COM00DB
B1:0087A7 45F0              ORL      A,B
B1:0087A9 601D              JZ       ?C0034?ZW_TXQ_PROTOCOL
B1:0087AB 904217            MOV      DPTR,#fStatus
B1:0087AE 12FDA6            LCALL    ?L?COM04B2
B1:0087B1 C003              PUSH     AR3
B1:0087B3 C002              PUSH     AR2
B1:0087B5 C001              PUSH     AR1
B1:0087B7 B138              ACALL    ?L?COM0016
B1:0087B9 12705E            LCALL    ?L?COM00DB
B1:0087BC 12FEF8            LCALL    ?L?COM0585
B1:0087BF D001              POP      AR1
B1:0087C1 D002              POP      AR2
B1:0087C3 D003              POP      AR3
B1:0087C5 12271A            LCALL    ?C?ICALL2
B1:0087C8         ?C0034?ZW_TXQ_PROTOCOL:
B1:0087C8 127070            LCALL    ?L?COM00E1
B1:0087CB 903999            MOV      DPTR,#pFrameWaitingForACK
B1:0087CE 1225A9            LCALL    ?C?PSTXDATA
B1:0087D1         ?C0027?ZW_TXQ_PROTOCOL:
B1:0087D1 22                RET      
----- FUNCTION _TxPermanentlyDone (END) -------


----- FUNCTION ?L?COM002B (BEGIN) -----
B1:0087D2 FA                MOV      R2,A
B1:0087D3 121FB3            LCALL    ?C?CLDPTR
B1:0087D6         ?L?COM002C:
B1:0087D6 FF                MOV      R7,A
B1:0087D7 900A27            MOV      DPTR,#pRxFrame
B1:0087DA         ?L?COM002D:
B1:0087DA 122589            LCALL    ?C?PLDXDATA
B1:0087DD E9                MOV      A,R1
B1:0087DE 2408              ADD      A,#08H
B1:0087E0         ?L?COM002E:
B1:0087E0 F9                MOV      R1,A
B1:0087E1 E4                CLR      A
B1:0087E2 3A                ADDC     A,R2
B1:0087E3 FA                MOV      R2,A
B1:0087E4 EF                MOV      A,R7
B1:0087E5 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM002B (END) -------


----- FUNCTION ?L?COM03DD (BEGIN) -----
B1:0087E8 FF                MOV      R7,A
B1:0087E9 75F0EB            MOV      B,#0EBH
B1:0087EC 02257D            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM03DD (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 207


----- FUNCTION ?L?COM04F2 (BEGIN) -----
B1:0087EF F0                MOVX     @DPTR,A
B1:0087F0 A3                INC      DPTR
B1:0087F1 74FF              MOV      A,#0FFH
B1:0087F3 F0                MOVX     @DPTR,A
B1:0087F4 E4                CLR      A
B1:0087F5 22                RET      
----- FUNCTION ?L?COM04F2 (END) -------


----- FUNCTION ?L?COM0209 (BEGIN) -----
B1:0087F6 E0                MOVX     A,@DPTR
B1:0087F7         ?L?COM020A:
B1:0087F7 75F0EB            MOV      B,#0EBH
B1:0087FA A4                MUL      AB
B1:0087FB 2407              ADD      A,#LOW X4K_TxQueue
B1:0087FD F9                MOV      R1,A
B1:0087FE 7400              MOV      A,#HIGH X4K_TxQueue
B1:008800 35F0              ADDC     A,B
B1:008802 FA                MOV      R2,A
B1:008803 7B01              MOV      R3,#01H
B1:008805 22                RET      
----- FUNCTION ?L?COM0209 (END) -------


----- FUNCTION _TimeOutConvert (BEGIN) -----
B1:008806 900AF6            MOV      DPTR,#timeOut
B1:008809 EE                MOV      A,R6
B1:00880A F0                MOVX     @DPTR,A
B1:00880B A3                INC      DPTR
B1:00880C EF                MOV      A,R7
B1:00880D F0                MOVX     @DPTR,A
B1:00880E 115C              ACALL    ?L?COM000E
B1:008810 12216F            LCALL    ?C?ILDPTR
B1:008813 5407              ANL      A,#07H
B1:008815 FF                MOV      R7,A
B1:008816 6402              XRL      A,#02H
B1:008818 6005              JZ       ?C0007?ZW_TRANSPORT
B1:00881A EF                MOV      A,R7
B1:00881B 6403              XRL      A,#03H
B1:00881D 7017              JNZ      ?C0006?ZW_TRANSPORT
B1:00881F         ?C0007?ZW_TRANSPORT:
B1:00881F 12D374            LCALL    ?L?COM05BB
B1:008822 25E0              ADD      A,ACC
B1:008824 FB                MOV      R3,A
B1:008825 EC                MOV      A,R4
B1:008826 33                RLC      A
B1:008827 FA                MOV      R2,A
B1:008828 ED                MOV      A,R5
B1:008829 AE04              MOV      R6,AR4
B1:00882B 7803              MOV      R0,#03H
B1:00882D         ?C0556?ZW_TRANSPORT:
B1:00882D C3                CLR      C
B1:00882E 33                RLC      A
B1:00882F CE                XCH      A,R6
B1:008830 33                RLC      A
B1:008831 CE                XCH      A,R6
B1:008832 D8F9              DJNZ     R0,?C0556?ZW_TRANSPORT
B1:008834 801D              SJMP     ?C0575?ZW_TRANSPORT
B1:008836         ?C0006?ZW_TRANSPORT:
B1:008836 12D374            LCALL    ?L?COM05BB
B1:008839 AE04              MOV      R6,AR4
B1:00883B 7803              MOV      R0,#03H
B1:00883D         ?C0557?ZW_TRANSPORT:
B1:00883D C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 208


B1:00883E 33                RLC      A
B1:00883F CE                XCH      A,R6
B1:008840 33                RLC      A
B1:008841 CE                XCH      A,R6
B1:008842 D8F9              DJNZ     R0,?C0557?ZW_TRANSPORT
B1:008844 FB                MOV      R3,A
B1:008845 AA06              MOV      R2,AR6
B1:008847 ED                MOV      A,R5
B1:008848 AE04              MOV      R6,AR4
B1:00884A 7805              MOV      R0,#05H
B1:00884C         ?C0558?ZW_TRANSPORT:
B1:00884C C3                CLR      C
B1:00884D 33                RLC      A
B1:00884E CE                XCH      A,R6
B1:00884F 33                RLC      A
B1:008850 CE                XCH      A,R6
B1:008851 D8F9              DJNZ     R0,?C0558?ZW_TRANSPORT
B1:008853         
B1:008853 2B                ADD      A,R3
B1:008854 FF                MOV      R7,A
B1:008855 EE                MOV      A,R6
B1:008856 3A                ADDC     A,R2
B1:008857 FE                MOV      R6,A
B1:008858 22                RET      
----- FUNCTION _TimeOutConvert (END) -------


----- FUNCTION ?L?COM000D (BEGIN) -----
B1:008859 122072            LCALL    ?C?CSTPTR
B1:00885C         ?L?COM000E:
B1:00885C 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00885F         ?L?COM000F:
B1:00885F 122589            LCALL    ?C?PLDXDATA
B1:008862         ?L?COM0010:
B1:008862 E9                MOV      A,R1
B1:008863 2404              ADD      A,#04H
B1:008865 F9                MOV      R1,A
B1:008866 E4                CLR      A
B1:008867 3A                ADDC     A,R2
B1:008868 FA                MOV      R2,A
B1:008869 22                RET      
----- FUNCTION ?L?COM000D (END) -------


----- FUNCTION ?L?COM0259 (BEGIN) -----
B1:00886A FF                MOV      R7,A
B1:00886B 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00886E 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _BuildTxHeader (BEGIN) -----
B1:008871 900AB6            MOV      DPTR,#pFrame
B1:008874 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'frameType' assigned to Register 'R7' ----
B1:008877 EF                MOV      A,R7
B1:008878 540F              ANL      A,#0FH
B1:00887A FE                MOV      R6,A
;---- Variable 'bframeType' assigned to Register 'R6' ----
B1:00887B 91B1              ACALL    ?L?COM0043
B1:00887D 24B8              ADD      A,#0B8H
B1:00887F 128622            LCALL    ?L?COM0006
B1:008882 54F0              ANL      A,#0F0H
B1:008884 FD                MOV      R5,A
B1:008885 EF                MOV      A,R7
B1:008886 54F0              ANL      A,#0F0H
B1:008888 FF                MOV      R7,A
B1:008889 C4                SWAP     A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 209


B1:00888A 540F              ANL      A,#0FH
B1:00888C 4D                ORL      A,R5
B1:00888D 122072            LCALL    ?C?CSTPTR
B1:008890 EE                MOV      A,R6
B1:008891 14                DEC      A
B1:008892 6064              JZ       ?C0070?ZW_TRANSPORT
B1:008894 14                DEC      A
B1:008895 7002              JNZ      $ + 4H
B1:008897 61A9              AJMP     ?C0096?ZW_TRANSPORT
B1:008899 24FE              ADD      A,#0FEH
B1:00889B 7002              JNZ      $ + 4H
B1:00889D 21D4              AJMP     ?C0082?ZW_TRANSPORT
B1:00889F 24FE              ADD      A,#0FEH
B1:0088A1 7002              JNZ      $ + 4H
B1:0088A3 8119              AJMP     ?C0098?ZW_TRANSPORT
B1:0088A5 2403              ADD      A,#03H
B1:0088A7 6002              JZ       $ + 4H
B1:0088A9 81AD              AJMP     ?C0103?ZW_TRANSPORT
B1:0088AB         ?C0069?ZW_TRANSPORT:
B1:0088AB 91B1              ACALL    ?L?COM0043
B1:0088AD F1CA              ACALL    ?L?COM0193
B1:0088AF C003              PUSH     AR3
B1:0088B1 C002              PUSH     AR2
B1:0088B3 C001              PUSH     AR1
B1:0088B5 7B01              MOV      R3,#01H
B1:0088B7 7A12              MOV      R2,#HIGH homeID
B1:0088B9 7923              MOV      R1,#LOW homeID
B1:0088BB 126149            LCALL    ?L?COM0047
B1:0088BE D001              POP      AR1
B1:0088C0 D002              POP      AR2
B1:0088C2 D003              POP      AR3
B1:0088C4 7F04              MOV      R7,#04H
B1:0088C6 127382            LCALL    ?L?COM057C
B1:0088C9 91B1              ACALL    ?L?COM0043
B1:0088CB 24B6              ADD      A,#0B6H
B1:0088CD 1287E0            LCALL    ?L?COM002E
B1:0088D0 91B1              ACALL    ?L?COM0043
B1:0088D2 24B7              ADD      A,#0B7H
B1:0088D4 F9                MOV      R1,A
B1:0088D5 E4                CLR      A
B1:0088D6 3A                ADDC     A,R2
B1:0088D7 FA                MOV      R2,A
B1:0088D8 7403              MOV      A,#03H
B1:0088DA 91AE              ACALL    ?L?COM0042
B1:0088DC 24B8              ADD      A,#0B8H
B1:0088DE 128622            LCALL    ?L?COM0006
B1:0088E1 54F0              ANL      A,#0F0H
B1:0088E3 F1F5              ACALL    ?L?COM0632
B1:0088E5 4F                ORL      A,R7
B1:0088E6 91AE              ACALL    ?L?COM0042
B1:0088E8 24B9              ADD      A,#0B9H
B1:0088EA F9                MOV      R1,A
B1:0088EB E4                CLR      A
B1:0088EC 3A                ADDC     A,R2
B1:0088ED FA                MOV      R2,A
B1:0088EE 740A              MOV      A,#0AH
B1:0088F0 91AE              ACALL    ?L?COM0042
B1:0088F2 F14D              ACALL    ?L?COM0366
B1:0088F4 7409              MOV      A,#09H
B1:0088F6 81AA              AJMP     ?C0584?ZW_TRANSPORT
B1:0088F8         ?C0070?ZW_TRANSPORT:
B1:0088F8 F154              ACALL    ?L?COM02DA
B1:0088FA 91B1              ACALL    ?L?COM0043
B1:0088FC 12FE78            LCALL    ?L?COM0274
B1:0088FF 900AB6            MOV      DPTR,#pFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 210


B1:008902 12861C            LCALL    ?L?COM0004
B1:008905 30E034            JNB      ACC.0,?C0071?ZW_TRANSPORT
B1:008908 91B1              ACALL    ?L?COM0043
B1:00890A 2403              ADD      A,#03H
B1:00890C 128622            LCALL    ?L?COM0006
B1:00890F 30E70C            JNB      ACC.7,?C0072?ZW_TRANSPORT
B1:008912 91B1              ACALL    ?L?COM0043
B1:008914 24B8              ADD      A,#0B8H
B1:008916 128622            LCALL    ?L?COM0006
B1:008919 4480              ORL      A,#080H
B1:00891B 122072            LCALL    ?C?CSTPTR
B1:00891E         ?C0072?ZW_TRANSPORT:
B1:00891E 900AB6            MOV      DPTR,#pFrame
B1:008921 12861C            LCALL    ?L?COM0004
B1:008924 20E70C            JB       ACC.7,?C0073?ZW_TRANSPORT
B1:008927 91B1              ACALL    ?L?COM0043
B1:008929 24B7              ADD      A,#0B7H
B1:00892B 128622            LCALL    ?L?COM0006
B1:00892E 4440              ORL      A,#040H
B1:008930 122072            LCALL    ?C?CSTPTR
B1:008933         ?C0073?ZW_TRANSPORT:
B1:008933 91B1              ACALL    ?L?COM0043
B1:008935 125C45            LCALL    ?L?COM00B8
B1:008938 7403              MOV      A,#03H
B1:00893A 8007              SJMP     ?C0579?ZW_TRANSPORT
B1:00893C         ?C0071?ZW_TRANSPORT:
B1:00893C 91B1              ACALL    ?L?COM0043
B1:00893E 125C45            LCALL    ?L?COM00B8
B1:008941 7401              MOV      A,#01H
B1:008943         
B1:008943 122072            LCALL    ?C?CSTPTR
B1:008946         ?C0074?ZW_TRANSPORT:
B1:008946 900AB6            MOV      DPTR,#pFrame
B1:008949 12861C            LCALL    ?L?COM0004
B1:00894C 30E10C            JNB      ACC.1,?C0075?ZW_TRANSPORT
B1:00894F 91B1              ACALL    ?L?COM0043
B1:008951 24B7              ADD      A,#0B7H
B1:008953 128622            LCALL    ?L?COM0006
B1:008956 4420              ORL      A,#020H
B1:008958 122072            LCALL    ?C?CSTPTR
B1:00895B         ?C0075?ZW_TRANSPORT:
B1:00895B 91B1              ACALL    ?L?COM0043
B1:00895D 2403              ADD      A,#03H
B1:00895F 128622            LCALL    ?L?COM0006
B1:008962 30E20C            JNB      ACC.2,?C0076?ZW_TRANSPORT
B1:008965 91B1              ACALL    ?L?COM0043
B1:008967 24B7              ADD      A,#0B7H
B1:008969 128622            LCALL    ?L?COM0006
B1:00896C 4410              ORL      A,#010H
B1:00896E 122072            LCALL    ?C?CSTPTR
B1:008971         ?C0076?ZW_TRANSPORT:
B1:008971 900AB6            MOV      DPTR,#pFrame
B1:008974 12861C            LCALL    ?L?COM0004
B1:008977 30E70C            JNB      ACC.7,?C0077?ZW_TRANSPORT
B1:00897A 91B1              ACALL    ?L?COM0043
B1:00897C 24B7              ADD      A,#0B7H
B1:00897E 128622            LCALL    ?L?COM0006
B1:008981 4480              ORL      A,#080H
B1:008983 122072            LCALL    ?C?CSTPTR
B1:008986         ?C0077?ZW_TRANSPORT:
B1:008986 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:008989 E0                MOVX     A,@DPTR
B1:00898A FF                MOV      R7,A
B1:00898B 7E00              MOV      R6,#00H
B1:00898D 30E502            JNB      ACC.5,?C0078?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 211


B1:008990 7E20              MOV      R6,#020H
B1:008992         ?C0078?ZW_TRANSPORT:
B1:008992         ?C0079?ZW_TRANSPORT:
B1:008992 EF                MOV      A,R7
B1:008993 7F00              MOV      R7,#00H
B1:008995 30E402            JNB      ACC.4,?C0080?ZW_TRANSPORT
B1:008998 7F40              MOV      R7,#040H
B1:00899A         ?C0080?ZW_TRANSPORT:
B1:00899A         ?C0081?ZW_TRANSPORT:
B1:00899A EF                MOV      A,R7
B1:00899B 4E                ORL      A,R6
B1:00899C FF                MOV      R7,A
;---- Variable 'transmitRFSpeedOption' assigned to Register 'R7' ----
B1:00899D 91B1              ACALL    ?L?COM0043
B1:00899F 24B8              ADD      A,#0B8H
B1:0089A1 128622            LCALL    ?L?COM0006
B1:0089A4 549F              ANL      A,#09FH
B1:0089A6 FE                MOV      R6,A
B1:0089A7 EF                MOV      A,R7
B1:0089A8 5460              ANL      A,#060H
B1:0089AA 4E                ORL      A,R6
B1:0089AB 91AE              ACALL    ?L?COM0042
B1:0089AD 24BA              ADD      A,#0BAH
B1:0089AF 128622            LCALL    ?L?COM0006
B1:0089B2 FF                MOV      R7,A
B1:0089B3 91B1              ACALL    ?L?COM0043
B1:0089B5 24D9              ADD      A,#0D9H
B1:0089B7 1287E0            LCALL    ?L?COM002E
;---- Variable 'headerLength1' assigned to Register 'R7' ----
B1:0089BA 7F09              MOV      R7,#09H
B1:0089BC 91B1              ACALL    ?L?COM0043
B1:0089BE 24B1              ADD      A,#0B1H
B1:0089C0 128622            LCALL    ?L?COM0006
B1:0089C3 FE                MOV      R6,A
B1:0089C4 EF                MOV      A,R7
B1:0089C5 04                INC      A
B1:0089C6 2E                ADD      A,R6
B1:0089C7 FE                MOV      R6,A
B1:0089C8 91B1              ACALL    ?L?COM0043
B1:0089CA 12D33E            LCALL    ?L?COM05E4
B1:0089CD 91AE              ACALL    ?L?COM0042
B1:0089CF F14D              ACALL    ?L?COM0366
B1:0089D1 EF                MOV      A,R7
B1:0089D2         
B1:0089D2 81AA              AJMP     ?C0584?ZW_TRANSPORT
B1:0089D4         ?C0082?ZW_TRANSPORT:
B1:0089D4 900AB6            MOV      DPTR,#pFrame
B1:0089D7 12861C            LCALL    ?L?COM0004
B1:0089DA 20E602            JB       ACC.6,$ + 5H
B1:0089DD 417D              AJMP     ?C0083?ZW_TRANSPORT
B1:0089DF 91B1              ACALL    ?L?COM0043
B1:0089E1 2409              ADD      A,#09H
B1:0089E3 128622            LCALL    ?L?COM0006
B1:0089E6 127411            LCALL    ?L?COM0613
B1:0089E9 900ABA            MOV      DPTR,#bRepeaterCount
B1:0089EC F0                MOVX     @DPTR,A
B1:0089ED 7404              MOV      A,#04H
B1:0089EF C3                CLR      C
B1:0089F0 9E                SUBB     A,R6
B1:0089F1 500B              JNC      ?C0084?ZW_TRANSPORT
B1:0089F3 7404              MOV      A,#04H
B1:0089F5 F0                MOVX     @DPTR,A
B1:0089F6 EF                MOV      A,R7
B1:0089F7 540F              ANL      A,#0FH
B1:0089F9 4440              ORL      A,#040H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 212


B1:0089FB 122072            LCALL    ?C?CSTPTR
B1:0089FE         ?C0084?ZW_TRANSPORT:
B1:0089FE 900ABA            MOV      DPTR,#bRepeaterCount
B1:008A01 E0                MOVX     A,@DPTR
B1:008A02 2402              ADD      A,#02H
B1:008A04 FF                MOV      R7,A
B1:008A05 91B1              ACALL    ?L?COM0043
B1:008A07 24BB              ADD      A,#0BBH
B1:008A09 F9                MOV      R1,A
B1:008A0A E4                CLR      A
B1:008A0B 3A                ADDC     A,R2
B1:008A0C FA                MOV      R2,A
B1:008A0D C003              PUSH     AR3
B1:008A0F C002              PUSH     AR2
B1:008A11 C001              PUSH     AR1
B1:008A13 91B1              ACALL    ?L?COM0043
B1:008A15 2408              ADD      A,#08H
B1:008A17 126145            LCALL    ?L?COM0045
B1:008A1A D001              POP      AR1
B1:008A1C D002              POP      AR2
B1:008A1E D003              POP      AR3
B1:008A20 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:008A23 91B1              ACALL    ?L?COM0043
B1:008A25 24B1              ADD      A,#0B1H
B1:008A27 128622            LCALL    ?L?COM0006
B1:008A2A FF                MOV      R7,A
B1:008A2B 900ABA            MOV      DPTR,#bRepeaterCount
B1:008A2E E0                MOVX     A,@DPTR
B1:008A2F 2403              ADD      A,#03H
B1:008A31 FD                MOV      R5,A
B1:008A32 E4                CLR      A
B1:008A33 33                RLC      A
B1:008A34 FC                MOV      R4,A
B1:008A35 D3                SETB     C
B1:008A36 EF                MOV      A,R7
B1:008A37 9D                SUBB     A,R5
B1:008A38 EC                MOV      A,R4
B1:008A39 12556C            LCALL    ?L?COM0170
B1:008A3C 4036              JC       ?C0085?ZW_TRANSPORT
B1:008A3E 121FB3            LCALL    ?C?CLDPTR
B1:008A41 FF                MOV      R7,A
B1:008A42 900ABA            MOV      DPTR,#bRepeaterCount
B1:008A45 E0                MOVX     A,@DPTR
B1:008A46 FE                MOV      R6,A
B1:008A47 2403              ADD      A,#03H
B1:008A49 FD                MOV      R5,A
B1:008A4A C3                CLR      C
B1:008A4B EF                MOV      A,R7
B1:008A4C 9D                SUBB     A,R5
B1:008A4D FF                MOV      R7,A
B1:008A4E 91AE              ACALL    ?L?COM0042
B1:008A50 12C7CB            LCALL    ?L?COM0188
B1:008A53 C003              PUSH     AR3
B1:008A55 C002              PUSH     AR2
B1:008A57 C001              PUSH     AR1
B1:008A59 EE                MOV      A,R6
B1:008A5A 240A              ADD      A,#0AH
B1:008A5C FD                MOV      R5,A
B1:008A5D E4                CLR      A
B1:008A5E 33                RLC      A
B1:008A5F FC                MOV      R4,A
B1:008A60 91B1              ACALL    ?L?COM0043
B1:008A62 2D                ADD      A,R5
B1:008A63 F9                MOV      R1,A
B1:008A64 EA                MOV      A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 213


B1:008A65 3C                ADDC     A,R4
B1:008A66 126148            LCALL    ?L?COM0046
B1:008A69 D001              POP      AR1
B1:008A6B D002              POP      AR2
B1:008A6D D003              POP      AR3
B1:008A6F 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:008A72 8009              SJMP     ?C0083?ZW_TRANSPORT
B1:008A74         ?C0085?ZW_TRANSPORT:
B1:008A74 91B1              ACALL    ?L?COM0043
B1:008A76 24B1              ADD      A,#0B1H
B1:008A78 F9                MOV      R1,A
B1:008A79 E4                CLR      A
B1:008A7A 125765            LCALL    ?L?COM01E3
B1:008A7D         ?C0083?ZW_TRANSPORT:
B1:008A7D F154              ACALL    ?L?COM02DA
B1:008A7F 91B1              ACALL    ?L?COM0043
B1:008A81 12FE78            LCALL    ?L?COM0274
B1:008A84 4480              ORL      A,#080H
B1:008A86 122072            LCALL    ?C?CSTPTR
B1:008A89 900AB6            MOV      DPTR,#pFrame
B1:008A8C 12861C            LCALL    ?L?COM0004
B1:008A8F 900AB6            MOV      DPTR,#pFrame
B1:008A92 30E007            JNB      ACC.0,?C0087?ZW_TRANSPORT
B1:008A95 125C41            LCALL    ?L?COM00B6
B1:008A98 7403              MOV      A,#03H
B1:008A9A 8005              SJMP     ?C0581?ZW_TRANSPORT
B1:008A9C         ?C0087?ZW_TRANSPORT:
B1:008A9C 125C41            LCALL    ?L?COM00B6
B1:008A9F 7401              MOV      A,#01H
B1:008AA1         
B1:008AA1 122072            LCALL    ?C?CSTPTR
B1:008AA4         ?C0088?ZW_TRANSPORT:
B1:008AA4 91B1              ACALL    ?L?COM0043
B1:008AA6 24BB              ADD      A,#0BBH
B1:008AA8 F9                MOV      R1,A
B1:008AA9 E4                CLR      A
B1:008AAA 3A                ADDC     A,R2
B1:008AAB FA                MOV      R2,A
B1:008AAC E4                CLR      A
B1:008AAD 91AE              ACALL    ?L?COM0042
B1:008AAF 2403              ADD      A,#03H
B1:008AB1 128622            LCALL    ?L?COM0006
B1:008AB4 30E20C            JNB      ACC.2,?C0089?ZW_TRANSPORT
B1:008AB7 91B1              ACALL    ?L?COM0043
B1:008AB9 24BB              ADD      A,#0BBH
B1:008ABB 128622            LCALL    ?L?COM0006
B1:008ABE 4410              ORL      A,#010H
B1:008AC0 122072            LCALL    ?C?CSTPTR
B1:008AC3         ?C0089?ZW_TRANSPORT:
B1:008AC3 900AB6            MOV      DPTR,#pFrame
B1:008AC6 115F              ACALL    ?L?COM000F
B1:008AC8 12216F            LCALL    ?C?ILDPTR
B1:008ACB 5460              ANL      A,#060H
B1:008ACD 7002              JNZ      $ + 4H
B1:008ACF 6155              AJMP     ?C0090?ZW_TRANSPORT
B1:008AD1 91B1              ACALL    ?L?COM0043
B1:008AD3 24B6              ADD      A,#0B6H
B1:008AD5 128622            LCALL    ?L?COM0006
B1:008AD8 12DA4B            LCALL    ?L?COM0163
B1:008ADB 7078              JNZ      ?C0582?ZW_TRANSPORT
B1:008ADD 91B1              ACALL    ?L?COM0043
B1:008ADF 24BB              ADD      A,#0BBH
B1:008AE1 128622            LCALL    ?L?COM0006
B1:008AE4 FF                MOV      R7,A
B1:008AE5 20E06D            JB       ACC.0,?C0582?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 214


B1:008AE8 91B1              ACALL    ?L?COM0043
B1:008AEA 2403              ADD      A,#03H
B1:008AEC 128622            LCALL    ?L?COM0006
B1:008AEF 20E463            JB       ACC.4,?C0582?ZW_TRANSPORT
B1:008AF2 91B1              ACALL    ?L?COM0043
B1:008AF4 24BB              ADD      A,#0BBH
B1:008AF6 F9                MOV      R1,A
B1:008AF7 E4                CLR      A
B1:008AF8 3A                ADDC     A,R2
B1:008AF9 FA                MOV      R2,A
B1:008AFA EF                MOV      A,R7
B1:008AFB 4408              ORL      A,#08H
B1:008AFD 91AE              ACALL    ?L?COM0042
B1:008AFF 24BC              ADD      A,#0BCH
B1:008B01 128622            LCALL    ?L?COM0006
B1:008B04 900AB6            MOV      DPTR,#pFrame
B1:008B07 12FE6D            LCALL    ?L?COM000C
B1:008B0A F1E6              ACALL    ?L?COM004F
B1:008B0C E4                CLR      A
B1:008B0D 91AE              ACALL    ?L?COM0042
B1:008B0F 24BC              ADD      A,#0BCH
B1:008B11 128622            LCALL    ?L?COM0006
B1:008B14 C4                SWAP     A
B1:008B15 540F              ANL      A,#0FH
B1:008B17 FF                MOV      R7,A
B1:008B18 91B1              ACALL    ?L?COM0043
B1:008B1A F1E6              ACALL    ?L?COM004F
B1:008B1C 121FB3            LCALL    ?C?CLDPTR
B1:008B1F 4410              ORL      A,#010H
B1:008B21 122072            LCALL    ?C?CSTPTR
B1:008B24 900AB6            MOV      DPTR,#pFrame
B1:008B27 115F              ACALL    ?L?COM000F
B1:008B29 12216F            LCALL    ?C?ILDPTR
B1:008B2C 5460              ANL      A,#060H
B1:008B2E FF                MOV      R7,A
B1:008B2F 91B1              ACALL    ?L?COM0043
B1:008B31 24BC              ADD      A,#0BCH
B1:008B33 128622            LCALL    ?L?COM0006
B1:008B36 12D98B            LCALL    ?L?COM01DE
B1:008B39 91B1              ACALL    ?L?COM0043
B1:008B3B 2D                ADD      A,R5
B1:008B3C F9                MOV      R1,A
B1:008B3D EC                MOV      A,R4
B1:008B3E 3A                ADDC     A,R2
B1:008B3F FA                MOV      R2,A
B1:008B40 E9                MOV      A,R1
B1:008B41 24BE              ADD      A,#0BEH
B1:008B43 1287E0            LCALL    ?L?COM002E
B1:008B46 900AB6            MOV      DPTR,#pFrame
B1:008B49 115F              ACALL    ?L?COM000F
B1:008B4B 12216F            LCALL    ?C?ILDPTR
B1:008B4E 549F              ANL      A,#09FH
B1:008B50 12CA07            LCALL    ?L?COM027F
B1:008B53 800C              SJMP     ?C0093?ZW_TRANSPORT
B1:008B55         ?C0090?ZW_TRANSPORT:
B1:008B55         
B1:008B55 91B1              ACALL    ?L?COM0043
B1:008B57 24BB              ADD      A,#0BBH
B1:008B59 128622            LCALL    ?L?COM0006
B1:008B5C 54F7              ANL      A,#0F7H
B1:008B5E 122072            LCALL    ?C?CSTPTR
B1:008B61         ?C0093?ZW_TRANSPORT:
B1:008B61 91B1              ACALL    ?L?COM0043
B1:008B63 24BB              ADD      A,#0BBH
B1:008B65 128622            LCALL    ?L?COM0006
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 215


B1:008B68 30E316            JNB      ACC.3,?C0094?ZW_TRANSPORT
B1:008B6B 91B1              ACALL    ?L?COM0043
B1:008B6D 24BC              ADD      A,#0BCH
B1:008B6F 128622            LCALL    ?L?COM0006
B1:008B72 C4                SWAP     A
B1:008B73 540F              ANL      A,#0FH
B1:008B75 FF                MOV      R7,A
B1:008B76 7E00              MOV      R6,#00H
B1:008B78 91B1              ACALL    ?L?COM0043
B1:008B7A F1E6              ACALL    ?L?COM004F
B1:008B7C 12A264            LCALL    ?L?COM0146
B1:008B7F 8002              SJMP     ?C0095?ZW_TRANSPORT
B1:008B81         ?C0094?ZW_TRANSPORT:
B1:008B81 7F00              MOV      R7,#00H
B1:008B83         ?C0095?ZW_TRANSPORT:
B1:008B83 91B1              ACALL    ?L?COM0043
B1:008B85 24BC              ADD      A,#0BCH
B1:008B87 128622            LCALL    ?L?COM0006
B1:008B8A C4                SWAP     A
B1:008B8B 540F              ANL      A,#0FH
B1:008B8D 240B              ADD      A,#0BH
B1:008B8F 2F                ADD      A,R7
B1:008B90 FF                MOV      R7,A
;---- Variable 'headerLength2' assigned to Register 'R7' ----
B1:008B91 91B1              ACALL    ?L?COM0043
B1:008B93 24B1              ADD      A,#0B1H
B1:008B95 128622            LCALL    ?L?COM0006
B1:008B98 FE                MOV      R6,A
B1:008B99 EF                MOV      A,R7
B1:008B9A 04                INC      A
B1:008B9B 2E                ADD      A,R6
B1:008B9C FE                MOV      R6,A
B1:008B9D 91B1              ACALL    ?L?COM0043
B1:008B9F 12D33E            LCALL    ?L?COM05E4
B1:008BA2 91AE              ACALL    ?L?COM0042
B1:008BA4 F14D              ACALL    ?L?COM0366
B1:008BA6 EF                MOV      A,R7
B1:008BA7         
B1:008BA7 81AA              AJMP     ?C0584?ZW_TRANSPORT
B1:008BA9         ?C0096?ZW_TRANSPORT:
B1:008BA9 F154              ACALL    ?L?COM02DA
B1:008BAB 91B1              ACALL    ?L?COM0043
B1:008BAD 24B7              ADD      A,#0B7H
B1:008BAF 127344            LCALL    ?L?COM04EF
B1:008BB2 122072            LCALL    ?C?CSTPTR
B1:008BB5 900AB6            MOV      DPTR,#pFrame
B1:008BB8 12861C            LCALL    ?L?COM0004
B1:008BBB 30E10C            JNB      ACC.1,?C0097?ZW_TRANSPORT
B1:008BBE 91B1              ACALL    ?L?COM0043
B1:008BC0 24B7              ADD      A,#0B7H
B1:008BC2 128622            LCALL    ?L?COM0006
B1:008BC5 4420              ORL      A,#020H
B1:008BC7 122072            LCALL    ?C?CSTPTR
B1:008BCA         ?C0097?ZW_TRANSPORT:
B1:008BCA 91B1              ACALL    ?L?COM0043
B1:008BCC 12CA10            LCALL    ?L?COM040A
B1:008BCF 741D              MOV      A,#01DH
B1:008BD1 91AE              ACALL    ?L?COM0042
B1:008BD3 24BB              ADD      A,#0BBH
B1:008BD5 F9                MOV      R1,A
B1:008BD6 E4                CLR      A
B1:008BD7 3A                ADDC     A,R2
B1:008BD8 FA                MOV      R2,A
B1:008BD9 C003              PUSH     AR3
B1:008BDB C002              PUSH     AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 216


B1:008BDD C001              PUSH     AR1
B1:008BDF 900775            MOV      DPTR,#pMultiNodeList
B1:008BE2 122589            LCALL    ?C?PLDXDATA
B1:008BE5 126149            LCALL    ?L?COM0047
B1:008BE8 D001              POP      AR1
B1:008BEA D002              POP      AR2
B1:008BEC D003              POP      AR3
B1:008BEE 7F1D              MOV      R7,#01DH
B1:008BF0 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:008BF3 91B1              ACALL    ?L?COM0043
B1:008BF5 125C45            LCALL    ?L?COM00B8
B1:008BF8 7401              MOV      A,#01H
B1:008BFA 122072            LCALL    ?C?CSTPTR
;---- Variable 'headerLength3' assigned to Register 'R7' ----
B1:008BFD 7F26              MOV      R7,#026H
B1:008BFF 91B1              ACALL    ?L?COM0043
B1:008C01 24D8              ADD      A,#0D8H
B1:008C03 1287E0            LCALL    ?L?COM002E
B1:008C06 91B1              ACALL    ?L?COM0043
B1:008C08 24B1              ADD      A,#0B1H
B1:008C0A 128622            LCALL    ?L?COM0006
B1:008C0D FE                MOV      R6,A
B1:008C0E EF                MOV      A,R7
B1:008C0F 04                INC      A
B1:008C10 2E                ADD      A,R6
B1:008C11 FF                MOV      R7,A
B1:008C12 91B1              ACALL    ?L?COM0043
B1:008C14 12D25F            LCALL    ?L?COM05E3
B1:008C17         
B1:008C17 81AA              AJMP     ?C0584?ZW_TRANSPORT
B1:008C19         ?C0098?ZW_TRANSPORT:
B1:008C19 91B1              ACALL    ?L?COM0043
B1:008C1B 24B8              ADD      A,#0B8H
B1:008C1D 128622            LCALL    ?L?COM0006
B1:008C20 540F              ANL      A,#0FH
B1:008C22 900AB9            MOV      DPTR,#bSeqNo
B1:008C25 F0                MOVX     @DPTR,A
B1:008C26 900AB6            MOV      DPTR,#pFrame
B1:008C29 12861C            LCALL    ?L?COM0004
B1:008C2C 20E64D            JB       ACC.6,?C0099?ZW_TRANSPORT
B1:008C2F F154              ACALL    ?L?COM02DA
B1:008C31 91B1              ACALL    ?L?COM0043
B1:008C33 24B7              ADD      A,#0B7H
B1:008C35 F9                MOV      R1,A
B1:008C36 E4                CLR      A
B1:008C37 3A                ADDC     A,R2
B1:008C38 FA                MOV      R2,A
B1:008C39 7405              MOV      A,#05H
B1:008C3B 122072            LCALL    ?C?CSTPTR
B1:008C3E 900AB6            MOV      DPTR,#pFrame
B1:008C41 12861C            LCALL    ?L?COM0004
B1:008C44 30E10C            JNB      ACC.1,?C0100?ZW_TRANSPORT
B1:008C47 91B1              ACALL    ?L?COM0043
B1:008C49 24B7              ADD      A,#0B7H
B1:008C4B 128622            LCALL    ?L?COM0006
B1:008C4E 4420              ORL      A,#020H
B1:008C50 122072            LCALL    ?C?CSTPTR
B1:008C53         ?C0100?ZW_TRANSPORT:
B1:008C53 91B1              ACALL    ?L?COM0043
B1:008C55 24B8              ADD      A,#0B8H
B1:008C57 128622            LCALL    ?L?COM0006
B1:008C5A 54F0              ANL      A,#0F0H
B1:008C5C FF                MOV      R7,A
B1:008C5D 900AB9            MOV      DPTR,#bSeqNo
B1:008C60 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 217


B1:008C61 4F                ORL      A,R7
B1:008C62 122072            LCALL    ?C?CSTPTR
B1:008C65 900AB6            MOV      DPTR,#pFrame
B1:008C68 12861C            LCALL    ?L?COM0004
B1:008C6B 30E018            JNB      ACC.0,?C0102?ZW_TRANSPORT
B1:008C6E 91B1              ACALL    ?L?COM0043
B1:008C70 24B7              ADD      A,#0B7H
B1:008C72 128622            LCALL    ?L?COM0006
B1:008C75 4440              ORL      A,#040H
B1:008C77 122072            LCALL    ?C?CSTPTR
B1:008C7A 800A              SJMP     ?C0102?ZW_TRANSPORT
B1:008C7C         ?C0099?ZW_TRANSPORT:
B1:008C7C 91B1              ACALL    ?L?COM0043
B1:008C7E 12DCE3            LCALL    ?L?COM044A
B1:008C81 74FF              MOV      A,#0FFH
B1:008C83 12201D            LCALL    ?C?CILDPTR
B1:008C86         ?C0102?ZW_TRANSPORT:
B1:008C86 91B1              ACALL    ?L?COM0043
B1:008C88 125C45            LCALL    ?L?COM00B8
B1:008C8B 7401              MOV      A,#01H
B1:008C8D 91AE              ACALL    ?L?COM0042
B1:008C8F F14D              ACALL    ?L?COM0366
B1:008C91 7411              MOV      A,#011H
B1:008C93 91AE              ACALL    ?L?COM0042
B1:008C95 24B1              ADD      A,#0B1H
B1:008C97 128622            LCALL    ?L?COM0006
B1:008C9A FF                MOV      R7,A
B1:008C9B 91B1              ACALL    ?L?COM0043
B1:008C9D 24D8              ADD      A,#0D8H
B1:008C9F 128622            LCALL    ?L?COM0006
B1:008CA2 2F                ADD      A,R7
B1:008CA3 04                INC      A
B1:008CA4 FF                MOV      R7,A
B1:008CA5 91B1              ACALL    ?L?COM0043
B1:008CA7 12D25F            LCALL    ?L?COM05E3
B1:008CAA         
B1:008CAA 122072            LCALL    ?C?CSTPTR
B1:008CAD         ?C0103?ZW_TRANSPORT:
B1:008CAD 22                RET      
----- FUNCTION _BuildTxHeader (END) -------


----- FUNCTION ?L?COM0042 (BEGIN) -----
B1:008CAE 122072            LCALL    ?C?CSTPTR
B1:008CB1         ?L?COM0043:
B1:008CB1 900AB6            MOV      DPTR,#pFrame
B1:008CB4 122589            LCALL    ?C?PLDXDATA
B1:008CB7 E9                MOV      A,R1
B1:008CB8 22                RET      
----- FUNCTION ?L?COM0042 (END) -------


----- FUNCTION ?L?COM050B (BEGIN) -----
B1:008CB9 900AE2            MOV      DPTR,#pTransmittedFrame
B1:008CBC 122589            LCALL    ?C?PLDXDATA
B1:008CBF E9                MOV      A,R1
B1:008CC0 24DA              ADD      A,#0DAH
B1:008CC2 22                RET      
----- FUNCTION ?L?COM050B (END) -------


----- FUNCTION _EnQueueCommon (BEGIN) -----
B1:008CC3 900A34            MOV      DPTR,#rfSpeed
B1:008CC6 124765            LCALL    ?L?COM0102
B1:008CC9 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 218


B1:008CCC 900A3A            MOV      DPTR,#txOptions
B1:008CCF D151              ACALL    ?L?COM02DD
B1:008CD1 E9                MOV      A,R1
B1:008CD2 2402              ADD      A,#02H
B1:008CD4 1287E0            LCALL    ?L?COM002E
B1:008CD7 EF                MOV      A,R7
B1:008CD8 7E00              MOV      R6,#00H
B1:008CDA 30E104            JNB      ACC.1,?C0115?ZW_TRANSPORT
B1:008CDD 7F08              MOV      R7,#08H
B1:008CDF 8002              SJMP     ?C0116?ZW_TRANSPORT
B1:008CE1         ?C0115?ZW_TRANSPORT:
B1:008CE1 7F00              MOV      R7,#00H
B1:008CE3         ?C0116?ZW_TRANSPORT:
B1:008CE3 900A3D            MOV      DPTR,#pFreeTxElement
B1:008CE6 115F              ACALL    ?L?COM000F
B1:008CE8 12A5B6            LCALL    ?L?COM00FA
B1:008CEB 900A39            MOV      DPTR,#dataLength
B1:008CEE E0                MOVX     A,@DPTR
B1:008CEF FF                MOV      R7,A
B1:008CF0 74A9              MOV      A,#0A9H
B1:008CF2 C3                CLR      C
B1:008CF3 9F                SUBB     A,R7
B1:008CF4 5003              JNC      ?C0117?ZW_TRANSPORT
B1:008CF6 74A9              MOV      A,#0A9H
B1:008CF8 F0                MOVX     @DPTR,A
B1:008CF9         ?C0117?ZW_TRANSPORT:
B1:008CF9 900A3D            MOV      DPTR,#pFreeTxElement
B1:008CFC F1D5              ACALL    ?L?COM0057
B1:008CFE 128622            LCALL    ?L?COM0006
B1:008D01 20E522            JB       ACC.5,?C0118?ZW_TRANSPORT
B1:008D04 900A39            MOV      DPTR,#dataLength
B1:008D07 E0                MOVX     A,@DPTR
B1:008D08 900A3D            MOV      DPTR,#pFreeTxElement
B1:008D0B 12C7C6            LCALL    ?L?COM0185
B1:008D0E C003              PUSH     AR3
B1:008D10 C002              PUSH     AR2
B1:008D12 C001              PUSH     AR1
B1:008D14 900A36            MOV      DPTR,#pData
B1:008D17 122589            LCALL    ?C?PLDXDATA
B1:008D1A 126149            LCALL    ?L?COM0047
B1:008D1D D001              POP      AR1
B1:008D1F D002              POP      AR2
B1:008D21 D003              POP      AR3
B1:008D23 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:008D26         ?C0118?ZW_TRANSPORT:
B1:008D26 900A39            MOV      DPTR,#dataLength
B1:008D29 D151              ACALL    ?L?COM02DD
B1:008D2B E9                MOV      A,R1
B1:008D2C 24B1              ADD      A,#0B1H
B1:008D2E 1287E0            LCALL    ?L?COM002E
B1:008D31 900A3B            MOV      DPTR,#completedFunc
B1:008D34 E0                MOVX     A,@DPTR
B1:008D35 FE                MOV      R6,A
B1:008D36 A3                INC      DPTR
B1:008D37 E0                MOVX     A,@DPTR
B1:008D38 A3                INC      DPTR
B1:008D39 12A5AB            LCALL    ?L?COM00F8
B1:008D3C 900A3D            MOV      DPTR,#pFreeTxElement
B1:008D3F 12CB78            LCALL    ?L?COM0218
B1:008D42 12221F            LCALL    ?C?ISTPTR
B1:008D45 900A34            MOV      DPTR,#rfSpeed
B1:008D48 E0                MOVX     A,@DPTR
;---- Variable 'tmpSpeed' assigned to Register 'R6' ----
B1:008D49 FE                MOV      R6,A
B1:008D4A A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 219


B1:008D4B E0                MOVX     A,@DPTR
B1:008D4C 540F              ANL      A,#0FH
B1:008D4E FF                MOV      R7,A
B1:008D4F 6402              XRL      A,#02H
B1:008D51 6033              JZ       ?C0119?ZW_TRANSPORT
B1:008D53 D153              ACALL    ?L?COM02DE
B1:008D55 E9                MOV      A,R1
B1:008D56 24BA              ADD      A,#0BAH
B1:008D58 128622            LCALL    ?L?COM0006
B1:008D5B FD                MOV      R5,A
B1:008D5C 90086E            MOV      DPTR,#tmp
B1:008D5F F0                MOVX     @DPTR,A
B1:008D60 BDFF08            CJNE     R5,#0FFH,?C0120?ZW_TRANSPORT
B1:008D63 EE                MOV      A,R6
B1:008D64 54F8              ANL      A,#0F8H
B1:008D66 4401              ORL      A,#01H
B1:008D68 FE                MOV      R6,A
B1:008D69 801B              SJMP     ?C0119?ZW_TRANSPORT
B1:008D6B         ?C0120?ZW_TRANSPORT:
B1:008D6B EE                MOV      A,R6
B1:008D6C 5407              ANL      A,#07H
B1:008D6E 7016              JNZ      ?C0119?ZW_TRANSPORT
B1:008D70 90086A            MOV      DPTR,#bNodeLastReceivedFrom
B1:008D73 E0                MOVX     A,@DPTR
B1:008D74 FD                MOV      R5,A
B1:008D75 90086E            MOV      DPTR,#tmp
B1:008D78 E0                MOVX     A,@DPTR
B1:008D79 B5050A            CJNE     A,AR5,?C0119?ZW_TRANSPORT
B1:008D7C EE                MOV      A,R6
B1:008D7D 54F8              ANL      A,#0F8H
B1:008D7F FE                MOV      R6,A
B1:008D80 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:008D83 E0                MOVX     A,@DPTR
B1:008D84 4E                ORL      A,R6
B1:008D85 FE                MOV      R6,A
B1:008D86         ?C0119?ZW_TRANSPORT:
B1:008D86 900A3D            MOV      DPTR,#pFreeTxElement
B1:008D89 115F              ACALL    ?L?COM000F
B1:008D8B 12216F            LCALL    ?C?ILDPTR
B1:008D8E 54EF              ANL      A,#0EFH
B1:008D90 FD                MOV      R5,A
B1:008D91 E5F0              MOV      A,B
B1:008D93 8DF0              MOV      B,R5
B1:008D95 12221F            LCALL    ?C?ISTPTR
B1:008D98 900A3D            MOV      DPTR,#pFreeTxElement
B1:008D9B F1D5              ACALL    ?L?COM0057
B1:008D9D 128622            LCALL    ?L?COM0006
B1:008DA0 20E559            JB       ACC.5,?C0124?ZW_TRANSPORT
B1:008DA3 300834            JNB      currentSeqNoUseTX,?C0125?ZW_TRANSPORT
B1:008DA6 EF                MOV      A,R7
B1:008DA7 6404              XRL      A,#04H
B1:008DA9 600A              JZ       ?C0127?ZW_TRANSPORT
B1:008DAB 900A35            MOV      DPTR,#frameType
B1:008DAE E0                MOVX     A,@DPTR
B1:008DAF 540F              ANL      A,#0FH
B1:008DB1 6406              XRL      A,#06H
B1:008DB3 7010              JNZ      ?C0126?ZW_TRANSPORT
B1:008DB5         ?C0127?ZW_TRANSPORT:
B1:008DB5 12D736            LCALL    ?L?COM056B
B1:008DB8 BF0203            CJNE     R7,#02H,?C0128?ZW_TRANSPORT
B1:008DBB D3                SETB     C
B1:008DBC 8001              SJMP     ?C0129?ZW_TRANSPORT
B1:008DBE         ?C0128?ZW_TRANSPORT:
B1:008DBE C3                CLR      C
B1:008DBF         ?C0129?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 220


B1:008DBF 921D              MOV      ?IncSeqNo?BIT,C
B1:008DC1 D21E              SETB     ?IncSeqNo?BIT+01H
B1:008DC3 800E              SJMP     ?C0588?ZW_TRANSPORT
B1:008DC5         ?C0126?ZW_TRANSPORT:
B1:008DC5 12D736            LCALL    ?L?COM056B
B1:008DC8 BF0203            CJNE     R7,#02H,?C0131?ZW_TRANSPORT
B1:008DCB D3                SETB     C
B1:008DCC 8001              SJMP     ?C0132?ZW_TRANSPORT
B1:008DCE         ?C0131?ZW_TRANSPORT:
B1:008DCE C3                CLR      C
B1:008DCF         ?C0132?ZW_TRANSPORT:
B1:008DCF 921D              MOV      ?IncSeqNo?BIT,C
B1:008DD1 C21E              CLR      ?IncSeqNo?BIT+01H
B1:008DD3         
B1:008DD3 12C8E6            LCALL    IncSeqNo
B1:008DD6 ED                MOV      A,R5
B1:008DD7 4F                ORL      A,R7
B1:008DD8 800C              SJMP     ?C0589?ZW_TRANSPORT
B1:008DDA         ?C0125?ZW_TRANSPORT:
B1:008DDA 900A35            MOV      DPTR,#frameType
B1:008DDD E0                MOVX     A,@DPTR
B1:008DDE F1F5              ACALL    ?L?COM0632
B1:008DE0 C4                SWAP     A
B1:008DE1 54F0              ANL      A,#0F0H
B1:008DE3 FD                MOV      R5,A
B1:008DE4 EF                MOV      A,R7
B1:008DE5 4D                ORL      A,R5
B1:008DE6         
B1:008DE6 900A35            MOV      DPTR,#frameType
B1:008DE9 F0                MOVX     @DPTR,A
B1:008DEA         ?C0133?ZW_TRANSPORT:
B1:008DEA D208              SETB     currentSeqNoUseTX
B1:008DEC 900A35            MOV      DPTR,#frameType
B1:008DEF D151              ACALL    ?L?COM02DD
B1:008DF1 E9                MOV      A,R1
B1:008DF2 24B7              ADD      A,#0B7H
B1:008DF4 1287E0            LCALL    ?L?COM002E
B1:008DF7 540F              ANL      A,#0FH
B1:008DF9 122072            LCALL    ?C?CSTPTR
B1:008DFC         ?C0124?ZW_TRANSPORT:
B1:008DFC AF06              MOV      R7,AR6
B1:008DFE 900A3D            MOV      DPTR,#pFreeTxElement
B1:008E01 115F              ACALL    ?L?COM000F
B1:008E03 E4                CLR      A
B1:008E04 8FF0              MOV      B,R7
B1:008E06 12221F            LCALL    ?C?ISTPTR
B1:008E09 900A3D            MOV      DPTR,#pFreeTxElement
B1:008E0C F1D5              ACALL    ?L?COM0057
B1:008E0E 128622            LCALL    ?L?COM0006
B1:008E11 20E507            JB       ACC.5,?C0134?ZW_TRANSPORT
B1:008E14 900A35            MOV      DPTR,#frameType
B1:008E17 D151              ACALL    ?L?COM02DD
B1:008E19 1171              ACALL    _BuildTxHeader
B1:008E1B         ?C0134?ZW_TRANSPORT:
B1:008E1B 900A3D            MOV      DPTR,#pFreeTxElement
B1:008E1E 115F              ACALL    ?L?COM000F
B1:008E20 12216F            LCALL    ?C?ILDPTR
B1:008E23 FF                MOV      R7,A
B1:008E24 900A3D            MOV      DPTR,#pFreeTxElement
B1:008E27 12C8DB            LCALL    ?L?COM01C2
B1:008E2A F9                MOV      R1,A
B1:008E2B E4                CLR      A
B1:008E2C 3A                ADDC     A,R2
B1:008E2D FA                MOV      R2,A
B1:008E2E 12CA08            LCALL    ?L?COM0280
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 221


B1:008E31 D153              ACALL    ?L?COM02DE
B1:;----                  JMP      _TxQueueQueueElement
----- FUNCTION _EnQueueCommon (END) -------


----- FUNCTION _TxQueueQueueElement (BEGIN) -----
B1:008E33 900AF1            MOV      DPTR,#pNewTxElement
B1:008E36 1225A9            LCALL    ?C?PSTXDATA
B1:008E39 900AF1            MOV      DPTR,#pNewTxElement
B1:008E3C 12975B            LCALL    ?L?COM006B
B1:008E3F 540F              ANL      A,#0FH
B1:008E41 122072            LCALL    ?C?CSTPTR
B1:008E44 900AF1            MOV      DPTR,#pNewTxElement
B1:008E47 12CFA8            LCALL    ?L?COM0416
B1:008E4A 3A                ADDC     A,R2
B1:008E4B FA                MOV      R2,A
B1:008E4C 7401              MOV      A,#01H
B1:008E4E 02201D            LJMP     ?C?CILDPTR
----- FUNCTION _TxQueueQueueElement (END) -------


----- FUNCTION ?L?COM02DD (BEGIN) -----
B1:008E51 E0                MOVX     A,@DPTR
B1:008E52 FF                MOV      R7,A
B1:008E53         ?L?COM02DE:
B1:008E53 900A3D            MOV      DPTR,#pFreeTxElement
B1:008E56 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM02DD (END) -------


----- FUNCTION _ZCB_ProtocolTransmitComplete (BEGIN) -----
B1:008E59 90421B            MOV      DPTR,#pTransmittedFrame
B1:008E5C 1225A9            LCALL    ?C?PSTXDATA
B1:008E5F E9                MOV      A,R1
B1:008E60 4A                ORL      A,R2
B1:008E61 C3                CLR      C
B1:008E62 6001              JZ       ?C0036?ZW_TXQ_PROTOCOL
B1:008E64 D3                SETB     C
B1:008E65         ?C0036?ZW_TXQ_PROTOCOL:
B1:008E65         ?C0037?ZW_TXQ_PROTOCOL:
B1:008E65 4002              JC       $ + 4H
B1:008E67 E145              AJMP     ?C0038?ZW_TXQ_PROTOCOL
B1:008E69         ?C0035?ZW_TXQ_PROTOCOL:
B1:008E69 90421B            MOV      DPTR,#pTransmittedFrame
B1:008E6C 12861C            LCALL    ?L?COM0004
B1:008E6F 30E019            JNB      ACC.0,?C0039?ZW_TXQ_PROTOCOL
B1:008E72 F146              ACALL    ?L?COM01DF
B1:008E74 E9                MOV      A,R1
B1:008E75 24B7              ADD      A,#0B7H
B1:008E77 128622            LCALL    ?L?COM0006
B1:008E7A 540F              ANL      A,#0FH
B1:008E7C FF                MOV      R7,A
B1:008E7D BF0503            CJNE     R7,#05H,?C0040?ZW_TXQ_PROTOCOL
B1:008E80 D3                SETB     C
B1:008E81 8001              SJMP     ?C0041?ZW_TXQ_PROTOCOL
B1:008E83         ?C0040?ZW_TXQ_PROTOCOL:
B1:008E83 C3                CLR      C
B1:008E84         ?C0041?ZW_TXQ_PROTOCOL:
B1:008E84 4005              JC       ?C0039?ZW_TXQ_PROTOCOL
B1:008E86 F146              ACALL    ?L?COM01DF
B1:008E88 028540            LJMP     _ProtocolWaitForACK
B1:008E8B         ?C0039?ZW_TXQ_PROTOCOL:
B1:008E8B 12DC6B            LCALL    ClearSendDataTxStatus
B1:008E8E F146              ACALL    ?L?COM01DF
B1:008E90 12FDAF            LCALL    ?L?COM04B4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 222


B1:008E93 5015              JNC      ?C0042?ZW_TXQ_PROTOCOL
B1:008E95 E0                MOVX     A,@DPTR
B1:008E96 FF                MOV      R7,A
B1:008E97 9404              SUBB     A,#04H
B1:008E99 5002              JNC      ?C0043?ZW_TXQ_PROTOCOL
B1:008E9B 8002              SJMP     ?C0044?ZW_TXQ_PROTOCOL
B1:008E9D         ?C0043?ZW_TXQ_PROTOCOL:
B1:008E9D 7F04              MOV      R7,#04H
B1:008E9F         ?C0044?ZW_TXQ_PROTOCOL:
B1:008E9F F146              ACALL    ?L?COM01DF
B1:008EA1 E9                MOV      A,R1
B1:008EA2 24BD              ADD      A,#0BDH
B1:008EA4 126145            LCALL    ?L?COM0045
B1:008EA7 12FEDD            LCALL    ?L?COM0516
B1:008EAA         ?C0042?ZW_TXQ_PROTOCOL:
B1:008EAA 90421B            MOV      DPTR,#pTransmittedFrame
B1:008EAD 115F              ACALL    ?L?COM000F
B1:008EAF 12FECC            LCALL    ?L?COM0509
B1:008EB2 F146              ACALL    ?L?COM01DF
B1:008EB4 E9                MOV      A,R1
B1:008EB5 24DF              ADD      A,#0DFH
B1:008EB7 128622            LCALL    ?L?COM0006
B1:008EBA 9039A7            MOV      DPTR,#tx_status+0AH
B1:008EBD F0                MOVX     @DPTR,A
B1:008EBE F146              ACALL    ?L?COM01DF
B1:008EC0 E9                MOV      A,R1
B1:008EC1 24E6              ADD      A,#0E6H
B1:008EC3 128622            LCALL    ?L?COM0006
B1:008EC6 9039AD            MOV      DPTR,#tx_status+010H
B1:008EC9 F0                MOVX     @DPTR,A
B1:008ECA F146              ACALL    ?L?COM01DF
B1:008ECC E9                MOV      A,R1
B1:008ECD 24E7              ADD      A,#0E7H
B1:008ECF 128622            LCALL    ?L?COM0006
B1:008ED2 9039AE            MOV      DPTR,#tx_status+011H
B1:008ED5 F0                MOVX     @DPTR,A
B1:008ED6 F146              ACALL    ?L?COM01DF
B1:008ED8 E9                MOV      A,R1
B1:008ED9 24E8              ADD      A,#0E8H
B1:008EDB 128622            LCALL    ?L?COM0006
B1:008EDE 9039AF            MOV      DPTR,#tx_status+012H
B1:008EE1 F0                MOVX     @DPTR,A
B1:008EE2 F146              ACALL    ?L?COM01DF
B1:008EE4 E9                MOV      A,R1
B1:008EE5 24E4              ADD      A,#0E4H
B1:008EE7 128622            LCALL    ?L?COM0006
B1:008EEA 9039A5            MOV      DPTR,#tx_status+08H
B1:008EED F0                MOVX     @DPTR,A
B1:008EEE F146              ACALL    ?L?COM01DF
B1:008EF0 E9                MOV      A,R1
B1:008EF1 24E5              ADD      A,#0E5H
B1:008EF3 128622            LCALL    ?L?COM0006
B1:008EF6 9039A6            MOV      DPTR,#tx_status+09H
B1:008EF9 F0                MOVX     @DPTR,A
B1:008EFA F146              ACALL    ?L?COM01DF
B1:008EFC E9                MOV      A,R1
B1:008EFD 24E9              ADD      A,#0E9H
B1:008EFF 127060            LCALL    ?L?COM00DC
B1:008F02 12FE8E            LCALL    ?L?COM03DC
B1:008F05 F146              ACALL    ?L?COM01DF
B1:008F07 E9                MOV      A,R1
B1:008F08 24E3              ADD      A,#0E3H
B1:008F0A 128622            LCALL    ?L?COM0006
B1:008F0D 90421E            MOV      DPTR,#bCallbackStatus
B1:008F10 7003              JNZ      ?C0045?ZW_TXQ_PROTOCOL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 223


B1:008F12 F0                MOVX     @DPTR,A
B1:008F13 8003              SJMP     ?C0046?ZW_TXQ_PROTOCOL
B1:008F15         ?C0045?ZW_TXQ_PROTOCOL:
B1:008F15 7401              MOV      A,#01H
B1:008F17 F0                MOVX     @DPTR,A
B1:008F18         ?C0046?ZW_TXQ_PROTOCOL:
B1:008F18 90421B            MOV      DPTR,#pTransmittedFrame
B1:008F1B 12705A            LCALL    ?L?COM00DA
B1:008F1E 45F0              ORL      A,B
B1:008F20 601E              JZ       ?C0047?ZW_TXQ_PROTOCOL
B1:008F22 90421E            MOV      DPTR,#bCallbackStatus
B1:008F25 12FDA6            LCALL    ?L?COM04B2
B1:008F28 C003              PUSH     AR3
B1:008F2A C002              PUSH     AR2
B1:008F2C C001              PUSH     AR1
B1:008F2E 90421B            MOV      DPTR,#pTransmittedFrame
B1:008F31 12705A            LCALL    ?L?COM00DA
B1:008F34 12FEF8            LCALL    ?L?COM0585
B1:008F37 D001              POP      AR1
B1:008F39 D002              POP      AR2
B1:008F3B D003              POP      AR3
B1:008F3D 12271A            LCALL    ?C?ICALL2
B1:008F40         ?C0047?ZW_TXQ_PROTOCOL:
B1:008F40 F146              ACALL    ?L?COM01DF
B1:008F42 12958A            LCALL    _TxQueueReleaseElement
B1:008F45         ?C0038?ZW_TXQ_PROTOCOL:
B1:008F45 22                RET      
----- FUNCTION _ZCB_ProtocolTransmitComplete (END) -------


----- FUNCTION ?L?COM01DF (BEGIN) -----
B1:008F46 90421B            MOV      DPTR,#pTransmittedFrame
B1:008F49 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM01DF (END) -------


----- FUNCTION ?L?COM0365 (BEGIN) -----
B1:008F4C E9                MOV      A,R1
B1:008F4D         ?L?COM0366:
B1:008F4D 24D8              ADD      A,#0D8H
B1:008F4F F9                MOV      R1,A
B1:008F50 E4                CLR      A
B1:008F51 3A                ADDC     A,R2
B1:008F52 FA                MOV      R2,A
B1:008F53 22                RET      
----- FUNCTION ?L?COM0365 (END) -------


----- FUNCTION ?L?COM02DA (BEGIN) -----
B1:008F54 900AB6            MOV      DPTR,#pFrame
B1:008F57 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _SetTransmitHomeID (BEGIN) -----
B1:008F5A 900AE8            MOV      DPTR,#ptrFrame
B1:008F5D 1225A9            LCALL    ?C?PSTXDATA
B1:008F60 30091F            JNB      inclusionHomeIDActive,?C0060?ZW_TRANSPORT
B1:008F63 F1C3              ACALL    ?L?COM0190
B1:008F65 C003              PUSH     AR3
B1:008F67 C002              PUSH     AR2
B1:008F69 C001              PUSH     AR1
B1:008F6B 7B01              MOV      R3,#01H
B1:008F6D 7A08              MOV      R2,#HIGH inclusionHomeID
B1:008F6F 7994              MOV      R1,#LOW inclusionHomeID
B1:008F71 126149            LCALL    ?L?COM0047
B1:008F74 D001              POP      AR1
B1:008F76 D002              POP      AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 224


B1:008F78 D003              POP      AR3
B1:008F7A 7F04              MOV      R7,#04H
B1:008F7C 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:008F7F C209              CLR      inclusionHomeIDActive
B1:008F81 22                RET      
B1:008F82         ?C0060?ZW_TRANSPORT:
B1:008F82 300322            JNB      learnModeDsk,?C0062?ZW_TRANSPORT
B1:008F85 7B01              MOV      R3,#01H
B1:008F87 7A2B              MOV      R2,#HIGH Dsk+0CH
B1:008F89 7947              MOV      R1,#LOW Dsk+0CH
B1:008F8B 12DBAA            LCALL    ?L?COM012E
B1:008F8E 7A12              MOV      R2,#HIGH homeID
B1:008F90 7923              MOV      R1,#LOW homeID
B1:008F92 12DACB            LCALL    ?L?COM0258
B1:008F95 7010              JNZ      ?C0062?ZW_TRANSPORT
B1:008F97 F1C3              ACALL    ?L?COM0190
B1:008F99 C003              PUSH     AR3
B1:008F9B C002              PUSH     AR2
B1:008F9D C001              PUSH     AR1
B1:008F9F 7B01              MOV      R3,#01H
B1:008FA1 7A2B              MOV      R2,#HIGH Dsk+08H
B1:008FA3 7943              MOV      R1,#LOW Dsk+08H
B1:008FA5 800E              SJMP     ?C0577?ZW_TRANSPORT
B1:008FA7         ?C0062?ZW_TRANSPORT:
B1:008FA7 F1C3              ACALL    ?L?COM0190
B1:008FA9 C003              PUSH     AR3
B1:008FAB C002              PUSH     AR2
B1:008FAD C001              PUSH     AR1
B1:008FAF 7B01              MOV      R3,#01H
B1:008FB1 7A12              MOV      R2,#HIGH homeID
B1:008FB3 7923              MOV      R1,#LOW homeID
B1:008FB5         
B1:008FB5 126149            LCALL    ?L?COM0047
B1:008FB8 D001              POP      AR1
B1:008FBA D002              POP      AR2
B1:008FBC D003              POP      AR3
B1:008FBE 7F04              MOV      R7,#04H
B1:008FC0 021B8D            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION _SetTransmitHomeID (END) -------


----- FUNCTION ?L?COM0190 (BEGIN) -----
B1:008FC3 900AE8            MOV      DPTR,#ptrFrame
B1:008FC6         ?L?COM0191:
B1:008FC6 122589            LCALL    ?C?PLDXDATA
B1:008FC9         ?L?COM0192:
B1:008FC9 E9                MOV      A,R1
B1:008FCA         ?L?COM0193:
B1:008FCA 24B2              ADD      A,#0B2H
B1:008FCC F9                MOV      R1,A
B1:008FCD E4                CLR      A
B1:008FCE 3A                ADDC     A,R2
B1:008FCF FA                MOV      R2,A
B1:008FD0 22                RET      
----- FUNCTION ?L?COM0190 (END) -------


----- FUNCTION ?L?COM0055 (BEGIN) -----
B1:008FD1 F0                MOVX     @DPTR,A
B1:008FD2         ?L?COM0056:
B1:008FD2 903C83            MOV      DPTR,#pCmd
B1:008FD5         ?L?COM0057:
B1:008FD5 122589            LCALL    ?C?PLDXDATA
B1:008FD8 E9                MOV      A,R1
B1:008FD9 2403              ADD      A,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 225


B1:008FDB 22                RET      
----- FUNCTION ?L?COM0055 (END) -------


----- FUNCTION ?L?COM004D (BEGIN) -----
B1:008FDC C4                SWAP     A
B1:008FDD 540F              ANL      A,#0FH
B1:008FDF FF                MOV      R7,A
B1:008FE0 7E00              MOV      R6,#00H
B1:008FE2         ?L?COM004E:
B1:008FE2 122589            LCALL    ?C?PLDXDATA
B1:008FE5 E9                MOV      A,R1
B1:008FE6         ?L?COM004F:
B1:008FE6 24BD              ADD      A,#0BDH
B1:008FE8         ?L?COM0050:
B1:008FE8 F9                MOV      R1,A
B1:008FE9 E4                CLR      A
B1:008FEA         ?L?COM0051:
B1:008FEA 3A                ADDC     A,R2
B1:008FEB FA                MOV      R2,A
B1:008FEC         ?L?COM0052:
B1:008FEC E9                MOV      A,R1
B1:008FED 2F                ADD      A,R7
B1:008FEE F9                MOV      R1,A
B1:008FEF EE                MOV      A,R6
B1:008FF0 3A                ADDC     A,R2
B1:008FF1 FA                MOV      R2,A
B1:008FF2 22                RET      
----- FUNCTION ?L?COM004D (END) -------


----- FUNCTION _TxQueueReQueueElement (BEGIN) -----
;---- Variable 'pElement' assigned to Register 'R1/R2/R3' ----
B1:008FF3 C133              AJMP     _TxQueueQueueElement
----- FUNCTION _TxQueueReQueueElement (END) -------


----- FUNCTION ?L?COM0632 (BEGIN) -----
B1:008FF5 FF                MOV      R7,A
B1:008FF6 90088E            MOV      DPTR,#currentSeqNo
B1:008FF9 E0                MOVX     A,@DPTR
B1:008FFA 540F              ANL      A,#0FH
B1:008FFC 22                RET      
----- FUNCTION ?L?COM0632 (END) -------


----- FUNCTION TransmitTimerStop (BEGIN) -----
B1:008FFD E4                CLR      A
B1:008FFE 903998            MOV      DPTR,#bRetransmitTimer
B1:009001 F0                MOVX     @DPTR,A
B1:009002 021C28            LJMP     ?INTERBANK_TABLE?TransportTimerCancel
----- FUNCTION TransmitTimerStop (END) -------


----- FUNCTION ?L?COM05DF (BEGIN) -----
B1:009005 75F00A            MOV      B,#0AH
B1:009008 84                DIV      AB
B1:009009 2406              ADD      A,#06H
B1:00900B FD                MOV      R5,A
B1:00900C 22                RET      
----- FUNCTION ?L?COM05DF (END) -------


----- FUNCTION _HandleRoutedAck (BEGIN) -----
B1:00900D 900AC9            MOV      DPTR,#pRxFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 226


B1:009010 1225A9            LCALL    ?C?PSTXDATA
B1:009013 900ACC            MOV      DPTR,#bRoutedAckRSSI
B1:009016 ED                MOV      A,R5
B1:009017 F0                MOVX     @DPTR,A
B1:009018 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00901B 12861C            LCALL    ?L?COM0004
B1:00901E 30E20A            JNB      ACC.2,?C0424?ZW_TRANSPORT
B1:009021 900871            MOV      DPTR,#activeTransmit+01H
B1:009024 E0                MOVX     A,@DPTR
B1:009025 F4                CPL      A
B1:009026 6003              JZ       ?C0424?ZW_TRANSPORT
B1:009028 12C062            LCALL    ?L?COM05B9
B1:00902B         ?C0424?ZW_TRANSPORT:
B1:00902B 128FFD            LCALL    TransmitTimerStop
B1:00902E 900AC9            MOV      DPTR,#pRxFrame
B1:009031 11A1              ACALL    ?L?COM01C8
B1:009033 2409              ADD      A,#09H
B1:009035 128622            LCALL    ?L?COM0006
B1:009038 30E33D            JNB      ACC.3,?C0425?ZW_TRANSPORT
B1:00903B 900AC9            MOV      DPTR,#pRxFrame
B1:00903E 11A1              ACALL    ?L?COM01C8
B1:009040 240A              ADD      A,#0AH
B1:009042 128622            LCALL    ?L?COM0006
B1:009045 C4                SWAP     A
B1:009046 540F              ANL      A,#0FH
B1:009048 FF                MOV      R7,A
B1:009049 7E00              MOV      R6,#00H
B1:00904B 900AC9            MOV      DPTR,#pRxFrame
B1:00904E 11A1              ACALL    ?L?COM01C8
B1:009050 240B              ADD      A,#0BH
B1:009052 128FE8            LCALL    ?L?COM0050
B1:009055 121FB3            LCALL    ?C?CLDPTR
B1:009058 540F              ANL      A,#0FH
B1:00905A FD                MOV      R5,A
B1:00905B BD011A            CJNE     R5,#01H,?C0425?ZW_TRANSPORT
B1:00905E 900AC9            MOV      DPTR,#pRxFrame
B1:009061 11A1              ACALL    ?L?COM01C8
B1:009063 240B              ADD      A,#0BH
B1:009065 128FE8            LCALL    ?L?COM0050
B1:009068 126142            LCALL    ?L?COM0044
B1:00906B 7B01              MOV      R3,#01H
B1:00906D 7A08              MOV      R2,#HIGH abRoutedRssiFeedback+01H
B1:00906F 7984              MOV      R1,#LOW abRoutedRssiFeedback+01H
B1:009071 7F04              MOV      R7,#04H
B1:009073 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:009076 8007              SJMP     ?C0426?ZW_TRANSPORT
B1:009078         ?C0425?ZW_TRANSPORT:
B1:009078 7A08              MOV      R2,#HIGH abRoutedRssiFeedback+01H
B1:00907A 7984              MOV      R1,#LOW abRoutedRssiFeedback+01H
B1:00907C 12FEEF            LCALL    ?L?COM0567
B1:00907F         ?C0426?ZW_TRANSPORT:
B1:00907F 900ACC            MOV      DPTR,#bRoutedAckRSSI
B1:009082 E0                MOVX     A,@DPTR
B1:009083 900883            MOV      DPTR,#abRoutedRssiFeedback
B1:009086 F0                MOVX     @DPTR,A
B1:009087 901222            MOV      DPTR,#rfRxCurrentCh
B1:00908A E0                MOVX     A,@DPTR
B1:00908B 128537            LCALL    ?L?COM0015
B1:00908E 24E4              ADD      A,#0E4H
B1:009090 1287E0            LCALL    ?L?COM002E
B1:009093 7B01              MOV      R3,#01H
B1:009095 7A08              MOV      R2,#HIGH abRoutedRssiFeedback
B1:009097 7983              MOV      R1,#LOW abRoutedRssiFeedback
B1:009099 7F01              MOV      R7,#01H
B1:00909B 0286F4            LJMP     _TxPermanentlyDone
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 227


----- FUNCTION _HandleRoutedAck (END) -------


----- FUNCTION ?L?COM01C7 (BEGIN) -----
B1:00909E 900A95            MOV      DPTR,#pRx
B1:0090A1         ?L?COM01C8:
B1:0090A1 122589            LCALL    ?C?PLDXDATA
B1:0090A4 1225BE            LCALL    ?C?PLDPTR
B1:0090A7 E9                MOV      A,R1
B1:0090A8 22                RET      
----- FUNCTION ?L?COM01C7 (END) -------


----- FUNCTION _SendRouteAck (BEGIN) -----
B1:0090A9 900A95            MOV      DPTR,#pRx
B1:0090AC 1225A9            LCALL    ?C?PSTXDATA
B1:0090AF 7F02              MOV      R7,#02H
B1:0090B1 128350            LCALL    _TxQueueGetElement
B1:0090B4 900A98            MOV      DPTR,#pFrame
B1:0090B7 F16A              ACALL    ?L?COM02DF
B1:0090B9 7002              JNZ      $ + 4H
B1:0090BB 41B4              AJMP     ?C0410?ZW_TRANSPORT
B1:0090BD         ?C0409?ZW_TRANSPORT:
B1:0090BD 51B9              ACALL    ?L?COM009D
B1:0090BF 125C44            LCALL    ?L?COM00B7
B1:0090C2 7403              MOV      A,#03H
B1:0090C4 122072            LCALL    ?C?CSTPTR
B1:0090C7 900A95            MOV      DPTR,#pRx
B1:0090CA 12C8DB            LCALL    ?L?COM01C2
B1:0090CD 128622            LCALL    ?L?COM0006
B1:0090D0 FF                MOV      R7,A
B1:0090D1 900A95            MOV      DPTR,#pRx
B1:0090D4 122589            LCALL    ?C?PLDXDATA
B1:0090D7 E9                MOV      A,R1
B1:0090D8 2409              ADD      A,#09H
B1:0090DA 128622            LCALL    ?L?COM0006
B1:0090DD C3                CLR      C
B1:0090DE 9F                SUBB     A,R7
B1:0090DF 14                DEC      A
B1:0090E0 51B8              ACALL    ?L?COM009C
B1:0090E2 E9                MOV      A,R1
B1:0090E3 24D8              ADD      A,#0D8H
B1:0090E5 1287E0            LCALL    ?L?COM002E
B1:0090E8 119E              ACALL    ?L?COM01C7
B1:0090EA 2409              ADD      A,#09H
B1:0090EC 128622            LCALL    ?L?COM0006
B1:0090EF 30E333            JNB      ACC.3,?C0411?ZW_TRANSPORT
B1:0090F2 51B9              ACALL    ?L?COM009D
B1:0090F4 128F4C            LCALL    ?L?COM0365
B1:0090F7 C003              PUSH     AR3
B1:0090F9 C002              PUSH     AR2
B1:0090FB C001              PUSH     AR1
B1:0090FD 121FB3            LCALL    ?C?CLDPTR
B1:009100 FF                MOV      R7,A
B1:009101 119E              ACALL    ?L?COM01C7
B1:009103 240A              ADD      A,#0AH
B1:009105 128622            LCALL    ?L?COM0006
B1:009108 FE                MOV      R6,A
B1:009109 12D98B            LCALL    ?L?COM01DE
B1:00910C 119E              ACALL    ?L?COM01C7
B1:00910E 12DB6B            LCALL    ?L?COM00D2
B1:009111 12E780            LCALL    ?L?COM039C
B1:009114 C4                SWAP     A
B1:009115 540F              ANL      A,#0FH
B1:009117 04                INC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 228


B1:009118 FE                MOV      R6,A
B1:009119 C3                CLR      C
B1:00911A EF                MOV      A,R7
B1:00911B 9E                SUBB     A,R6
B1:00911C D001              POP      AR1
B1:00911E D002              POP      AR2
B1:009120 D003              POP      AR3
B1:009122 122072            LCALL    ?C?CSTPTR
B1:009125         ?C0411?ZW_TRANSPORT:
B1:009125 51B9              ACALL    ?L?COM009D
B1:009127 E9                MOV      A,R1
B1:009128 24D8              ADD      A,#0D8H
B1:00912A 128622            LCALL    ?L?COM0006
B1:00912D FE                MOV      R6,A
B1:00912E D3                SETB     C
B1:00912F 9426              SUBB     A,#026H
B1:009131 AF06              MOV      R7,AR6
B1:009133 4002              JC       ?C0412?ZW_TRANSPORT
B1:009135 7F26              MOV      R7,#026H
B1:009137         ?C0412?ZW_TRANSPORT:
B1:009137         ?C0413?ZW_TRANSPORT:
B1:009137 51B9              ACALL    ?L?COM009D
B1:009139 128FC9            LCALL    ?L?COM0192
B1:00913C C003              PUSH     AR3
B1:00913E C002              PUSH     AR2
B1:009140 C001              PUSH     AR1
B1:009142 900A95            MOV      DPTR,#pRx
B1:009145 122589            LCALL    ?C?PLDXDATA
B1:009148 1225BE            LCALL    ?C?PLDPTR
B1:00914B 126149            LCALL    ?L?COM0047
B1:00914E D001              POP      AR1
B1:009150 D002              POP      AR2
B1:009152 D003              POP      AR3
B1:009154 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:009157         ?C0414?ZW_TRANSPORT:
B1:009157 51B9              ACALL    ?L?COM009D
B1:009159 E9                MOV      A,R1
B1:00915A 24B1              ADD      A,#0B1H
B1:00915C F9                MOV      R1,A
B1:00915D E4                CLR      A
B1:00915E 125765            LCALL    ?L?COM01E3
B1:009161 51B9              ACALL    ?L?COM009D
B1:009163 E9                MOV      A,R1
B1:009164 24BB              ADD      A,#0BBH
B1:009166 128622            LCALL    ?L?COM0006
B1:009169 4401              ORL      A,#01H
B1:00916B 122072            LCALL    ?C?CSTPTR
B1:00916E 4402              ORL      A,#02H
B1:009170 12FD96            LCALL    ?L?COM062C
B1:009173 51B8              ACALL    ?L?COM009C
B1:009175 E9                MOV      A,R1
B1:009176 24B6              ADD      A,#0B6H
B1:009178 1287E0            LCALL    ?L?COM002E
B1:00917B 119E              ACALL    ?L?COM01C7
B1:00917D 2404              ADD      A,#04H
B1:00917F 128622            LCALL    ?L?COM0006
B1:009182 51B8              ACALL    ?L?COM009C
B1:009184 E9                MOV      A,R1
B1:009185 24BA              ADD      A,#0BAH
B1:009187 1287E0            LCALL    ?L?COM002E
B1:00918A 51B9              ACALL    ?L?COM009D
B1:00918C E9                MOV      A,R1
B1:00918D 24BC              ADD      A,#0BCH
B1:00918F 128622            LCALL    ?L?COM0006
B1:009192 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 229


B1:009193 540F              ANL      A,#0FH
B1:009195 FE                MOV      R6,A
;---- Variable 'bTemp' assigned to Register 'R6' ----
B1:009196 EF                MOV      A,R7
B1:009197 54F0              ANL      A,#0F0H
B1:009199 122072            LCALL    ?C?CSTPTR
B1:00919C 54F0              ANL      A,#0F0H
B1:00919E FF                MOV      R7,A
B1:00919F EE                MOV      A,R6
B1:0091A0 14                DEC      A
B1:0091A1 540F              ANL      A,#0FH
B1:0091A3 4F                ORL      A,R7
B1:0091A4 122072            LCALL    ?C?CSTPTR
B1:0091A7 51B9              ACALL    ?L?COM009D
B1:0091A9 E9                MOV      A,R1
B1:0091AA 24BB              ADD      A,#0BBH
B1:0091AC 128622            LCALL    ?L?COM0006
B1:0091AF 4408              ORL      A,#08H
B1:0091B1 122072            LCALL    ?C?CSTPTR
B1:0091B4 51B9              ACALL    ?L?COM009D
B1:0091B6 E9                MOV      A,R1
B1:0091B7 24BC              ADD      A,#0BCH
B1:0091B9 128622            LCALL    ?L?COM0006
B1:0091BC 900A98            MOV      DPTR,#pFrame
B1:0091BF 128FDC            LCALL    ?L?COM004D
B1:0091C2 7401              MOV      A,#01H
B1:0091C4 122072            LCALL    ?C?CSTPTR
B1:0091C7 51B9              ACALL    ?L?COM009D
B1:0091C9 E9                MOV      A,R1
B1:0091CA 24BC              ADD      A,#0BCH
B1:0091CC 128622            LCALL    ?L?COM0006
B1:0091CF C4                SWAP     A
B1:0091D0 540F              ANL      A,#0FH
B1:0091D2 FF                MOV      R7,A
B1:0091D3 900A98            MOV      DPTR,#pFrame
B1:0091D6 128FE2            LCALL    ?L?COM004E
B1:0091D9 121FB3            LCALL    ?C?CLDPTR
B1:0091DC 4440              ORL      A,#040H
B1:0091DE 122072            LCALL    ?C?CSTPTR
B1:0091E1 51B9              ACALL    ?L?COM009D
B1:0091E3 E9                MOV      A,R1
B1:0091E4 24BC              ADD      A,#0BCH
B1:0091E6 128622            LCALL    ?L?COM0006
B1:0091E9 51B5              ACALL    ?L?COM009B
B1:0091EB 128FEC            LCALL    ?L?COM0052
B1:0091EE E9                MOV      A,R1
B1:0091EF 24BE              ADD      A,#0BEH
B1:0091F1 B172              ACALL    ?L?COM0345
B1:0091F3 51B9              ACALL    ?L?COM009D
B1:0091F5 E9                MOV      A,R1
B1:0091F6 24BC              ADD      A,#0BCH
B1:0091F8 128622            LCALL    ?L?COM0006
B1:0091FB 51B5              ACALL    ?L?COM009B
B1:0091FD 128FEC            LCALL    ?L?COM0052
B1:009200 E9                MOV      A,R1
B1:009201 24BF              ADD      A,#0BFH
B1:009203 B172              ACALL    ?L?COM0345
B1:009205 51B9              ACALL    ?L?COM009D
B1:009207 E9                MOV      A,R1
B1:009208 24BC              ADD      A,#0BCH
B1:00920A 128622            LCALL    ?L?COM0006
B1:00920D 51B5              ACALL    ?L?COM009B
B1:00920F 128FEC            LCALL    ?L?COM0052
B1:009212 E9                MOV      A,R1
B1:009213 24C0              ADD      A,#0C0H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 230


B1:009215 B172              ACALL    ?L?COM0345
B1:009217 51B9              ACALL    ?L?COM009D
B1:009219 E9                MOV      A,R1
B1:00921A 24BC              ADD      A,#0BCH
B1:00921C 128622            LCALL    ?L?COM0006
B1:00921F 51B5              ACALL    ?L?COM009B
B1:009221 128FEC            LCALL    ?L?COM0052
B1:009224 E9                MOV      A,R1
B1:009225 24C1              ADD      A,#0C1H
B1:009227 B172              ACALL    ?L?COM0345
B1:009229 51B9              ACALL    ?L?COM009D
B1:00922B 128F4C            LCALL    ?L?COM0365
B1:00922E 7405              MOV      A,#05H
B1:009230 12201D            LCALL    ?C?CILDPTR
B1:009233 51B9              ACALL    ?L?COM009D
B1:009235 125C44            LCALL    ?L?COM00B7
B1:009238 7403              MOV      A,#03H
B1:00923A 122072            LCALL    ?C?CSTPTR
B1:00923D 51B9              ACALL    ?L?COM009D
B1:00923F E9                MOV      A,R1
B1:009240 24B1              ADD      A,#0B1H
B1:009242 128622            LCALL    ?L?COM0006
B1:009245 51B8              ACALL    ?L?COM009C
B1:009247 E9                MOV      A,R1
B1:009248 24D8              ADD      A,#0D8H
B1:00924A 128622            LCALL    ?L?COM0006
B1:00924D 2F                ADD      A,R7
B1:00924E 04                INC      A
B1:00924F 51B8              ACALL    ?L?COM009C
B1:009251 E9                MOV      A,R1
B1:009252 24B9              ADD      A,#0B9H
B1:009254 1287E0            LCALL    ?L?COM002E
B1:009257 900A98            MOV      DPTR,#pFrame
B1:00925A 128FD5            LCALL    ?L?COM0057
B1:00925D 128622            LCALL    ?L?COM0006
B1:009260 4420              ORL      A,#020H
B1:009262 122072            LCALL    ?C?CSTPTR
B1:009265 300905            JNB      inclusionHomeIDActive,?C0415?ZW_TRANSPORT
B1:009268 51B9              ACALL    ?L?COM009D
B1:00926A 128F5A            LCALL    _SetTransmitHomeID
B1:00926D         ?C0415?ZW_TRANSPORT:
B1:00926D 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:009270 E0                MOVX     A,@DPTR
B1:009271 51B8              ACALL    ?L?COM009C
B1:009273 E9                MOV      A,R1
B1:009274 24B6              ADD      A,#0B6H
B1:009276 128622            LCALL    ?L?COM0006
B1:009279 FD                MOV      R5,A
B1:00927A 51B9              ACALL    ?L?COM009D
B1:00927C E9                MOV      A,R1
B1:00927D 24BA              ADD      A,#0BAH
B1:00927F 128622            LCALL    ?L?COM0006
B1:009282 FB                MOV      R3,A
B1:009283 C003              PUSH     AR3
B1:009285 51B9              ACALL    ?L?COM009D
B1:009287 12C7CA            LCALL    ?L?COM0187
B1:00928A F18D              ACALL    ?L?COM0394
B1:00928C 51B9              ACALL    ?L?COM009D
B1:00928E E9                MOV      A,R1
B1:00928F 24B1              ADD      A,#0B1H
B1:009291 128622            LCALL    ?L?COM0006
B1:009294 12FEAB            LCALL    ?L?COM0421
B1:009297 900A98            MOV      DPTR,#pFrame
B1:00929A 128FD5            LCALL    ?L?COM0057
B1:00929D 128622            LCALL    ?L?COM0006
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 231


B1:0092A0 12FEB4            LCALL    ?L?COM044B
B1:0092A3 51B9              ACALL    ?L?COM009D
B1:0092A5 F184              ACALL    ?L?COM02DC
B1:0092A7 D003              POP      AR3
B1:0092A9 51BF              ACALL    _EnqueueSingleDataPtr
B1:0092AB 9003BA            MOV      DPTR,#bPauseTransmitCountdown
B1:0092AE E0                MOVX     A,@DPTR
B1:0092AF 7003              JNZ      ?C0410?ZW_TRANSPORT
B1:0092B1 1281F3            LCALL    TxQueueServiceTransmit
B1:0092B4         ?C0410?ZW_TRANSPORT:
B1:0092B4 22                RET      
----- FUNCTION _SendRouteAck (END) -------


----- FUNCTION ?L?COM009B (BEGIN) -----
B1:0092B5 C4                SWAP     A
B1:0092B6 540F              ANL      A,#0FH
B1:0092B8         ?L?COM009C:
B1:0092B8 FF                MOV      R7,A
B1:0092B9         ?L?COM009D:
B1:0092B9 900A98            MOV      DPTR,#pFrame
B1:0092BC 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM009B (END) -------


----- FUNCTION _EnqueueSingleDataPtr (BEGIN) -----
B1:0092BF 9009F5            MOV      DPTR,#srcNodeID
B1:0092C2 ED                MOV      A,R5
B1:0092C3 F0                MOVX     @DPTR,A
B1:0092C4 A3                INC      DPTR
B1:0092C5 EB                MOV      A,R3
B1:0092C6 F0                MOVX     @DPTR,A
;---- Variable 'rfSpeed' assigned to Register 'R7' ----
B1:0092C7 900A02            MOV      DPTR,#frameType
B1:0092CA 7401              MOV      A,#01H
B1:0092CC F0                MOVX     @DPTR,A
B1:0092CD 900A04            MOV      DPTR,#speed
B1:0092D0 EF                MOV      A,R7
B1:0092D1 F0                MOVX     @DPTR,A
;---- Variable 'engage_transport_service' assigned to Register 'R7' ----
B1:0092D2 E4                CLR      A
B1:0092D3 FF                MOV      R7,A
B1:0092D4 9009FC            MOV      DPTR,#txOptions1
B1:0092D7 E0                MOVX     A,@DPTR
B1:0092D8 FE                MOV      R6,A
B1:0092D9 9009FF            MOV      DPTR,#pFreeTxElement
B1:0092DC 128FD5            LCALL    ?L?COM0057
B1:0092DF F9                MOV      R1,A
B1:0092E0 E4                CLR      A
B1:0092E1 3A                ADDC     A,R2
B1:0092E2 FA                MOV      R2,A
B1:0092E3 EE                MOV      A,R6
B1:0092E4 122072            LCALL    ?C?CSTPTR
B1:0092E7 9009FB            MOV      DPTR,#txOptions
B1:0092EA E0                MOVX     A,@DPTR
B1:0092EB 54C0              ANL      A,#0C0H
B1:0092ED 6002              JZ       $ + 4H
B1:0092EF 61DC              AJMP     ?C0154?ZW_TRANSPORT
B1:0092F1 9009FA            MOV      DPTR,#dataLength
B1:0092F4 E0                MOVX     A,@DPTR
B1:0092F5 FE                MOV      R6,A
B1:0092F6 D3                SETB     C
B1:0092F7 949F              SUBB     A,#09FH
B1:0092F9 4002              JC       ?C0155?ZW_TRANSPORT
B1:0092FB A164              AJMP     clean_up_and_exit?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 232


B1:0092FD         ?C0155?ZW_TRANSPORT:
B1:0092FD 9009F6            MOV      DPTR,#destNodeID
B1:009300 E0                MOVX     A,@DPTR
B1:009301 B4FF08            CJNE     A,#0FFH,?C0158?ZW_TRANSPORT
B1:009304 EE                MOV      A,R6
B1:009305 D3                SETB     C
B1:009306 9436              SUBB     A,#036H
B1:009308 4002              JC       ?C0158?ZW_TRANSPORT
B1:00930A         
B1:00930A A164              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:00930C         ?C0158?ZW_TRANSPORT:
B1:00930C 300A11            JNB      bUseExploreAsRouteResolution,?C0157?ZW_TRANSPORT
B1:00930F F179              ACALL    ?L?COM0631
B1:009311 400D              JC       ?C0157?ZW_TRANSPORT
B1:009313 121FB3            LCALL    ?C?CLDPTR
B1:009316 30E604            JNB      ACC.6,?C0161?ZW_TRANSPORT
B1:009319 7F01              MOV      R7,#01H
B1:00931B 8003              SJMP     ?C0157?ZW_TRANSPORT
B1:00931D         ?C0161?ZW_TRANSPORT:
B1:00931D 7F00              MOV      R7,#00H
B1:00931F 22                RET      
B1:009320         ?C0157?ZW_TRANSPORT:
B1:009320 9009FF            MOV      DPTR,#pFreeTxElement
B1:009323 128FD5            LCALL    ?L?COM0057
B1:009326 128622            LCALL    ?L?COM0006
B1:009329 FE                MOV      R6,A
B1:00932A 20E612            JB       ACC.6,?C0164?ZW_TRANSPORT
B1:00932D 9009FB            MOV      DPTR,#txOptions
B1:009330 E0                MOVX     A,@DPTR
B1:009331 20E40B            JB       ACC.4,?C0164?ZW_TRANSPORT
B1:009334 9009FA            MOV      DPTR,#dataLength
B1:009337 E0                MOVX     A,@DPTR
B1:009338 D3                SETB     C
B1:009339 9497              SUBB     A,#097H
B1:00933B 4002              JC       ?C0164?ZW_TRANSPORT
B1:00933D         
B1:00933D A164              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:00933F         ?C0164?ZW_TRANSPORT:
B1:00933F EE                MOV      A,R6
B1:009340 30E606            JNB      ACC.6,?C0165?ZW_TRANSPORT
B1:009343 F179              ACALL    ?L?COM0631
B1:009345 4002              JC       ?C0165?ZW_TRANSPORT
B1:009347 7F01              MOV      R7,#01H
B1:009349         ?C0165?ZW_TRANSPORT:
B1:009349 EF                MOV      A,R7
B1:00934A 7002              JNZ      $ + 4H
B1:00934C 61DC              AJMP     ?C0154?ZW_TRANSPORT
B1:00934E 9009FF            MOV      DPTR,#pFreeTxElement
B1:009351 128FD5            LCALL    ?L?COM0057
B1:009354 128622            LCALL    ?L?COM0006
B1:009357 20E602            JB       ACC.6,$ + 5H
B1:00935A A164              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:00935C         ?C0168?ZW_TRANSPORT:
B1:00935C 7A0A              MOV      R2,#HIGH proto_ts_param
B1:00935E 7905              MOV      R1,#LOW proto_ts_param
B1:009360 7D07              MOV      R5,#07H
B1:009362 12F46B            LCALL    ?L?COM00ED
B1:009365 9009F5            MOV      DPTR,#srcNodeID
B1:009368 E0                MOVX     A,@DPTR
B1:009369 900A05            MOV      DPTR,#proto_ts_param
B1:00936C F0                MOVX     @DPTR,A
B1:00936D 9009F6            MOV      DPTR,#destNodeID
B1:009370 E0                MOVX     A,@DPTR
B1:009371 900A06            MOV      DPTR,#proto_ts_param+01H
B1:009374 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 233


B1:009375 9009FB            MOV      DPTR,#txOptions
B1:009378 E0                MOVX     A,@DPTR
B1:009379 54DF              ANL      A,#0DFH
B1:00937B F0                MOVX     @DPTR,A
B1:00937C 300A06            JNB      bUseExploreAsRouteResolution,?C0169?ZW_TRANSPORT
B1:00937F E0                MOVX     A,@DPTR
B1:009380 4420              ORL      A,#020H
B1:009382 FF                MOV      R7,A
B1:009383 8005              SJMP     ?C0170?ZW_TRANSPORT
B1:009385         ?C0169?ZW_TRANSPORT:
B1:009385 9009FB            MOV      DPTR,#txOptions
B1:009388 E0                MOVX     A,@DPTR
B1:009389 FF                MOV      R7,A
B1:00938A         ?C0170?ZW_TRANSPORT:
B1:00938A 900A09            MOV      DPTR,#proto_ts_param+04H
B1:00938D EF                MOV      A,R7
B1:00938E F0                MOVX     @DPTR,A
B1:00938F 9009FD            MOV      DPTR,#completedFunc
B1:009392 E0                MOVX     A,@DPTR
B1:009393 FF                MOV      R7,A
B1:009394 A3                INC      DPTR
B1:009395 E0                MOVX     A,@DPTR
B1:009396 90088C            MOV      DPTR,#_ts_stored_callback
B1:009399 CF                XCH      A,R7
B1:00939A F0                MOVX     @DPTR,A
B1:00939B A3                INC      DPTR
B1:00939C EF                MOV      A,R7
B1:00939D F0                MOVX     @DPTR,A
B1:00939E B16C              ACALL    ?L?COM018C
B1:0093A0 B18A              ACALL    _TxQueueReleaseElement
B1:0093A2 C20A              CLR      bUseExploreAsRouteResolution
B1:0093A4 9009F7            MOV      DPTR,#pData
B1:0093A7 122589            LCALL    ?C?PLDXDATA
B1:0093AA 90388E            MOV      DPTR,#?_ZW_TransportService_SendData?BYTE+03H
B1:0093AD 1225A9            LCALL    ?C?PSTXDATA
B1:0093B0 9009FA            MOV      DPTR,#dataLength
B1:0093B3 E0                MOVX     A,@DPTR
B1:0093B4 FF                MOV      R7,A
B1:0093B5 903891            MOV      DPTR,#?_ZW_TransportService_SendData?BYTE+06H
B1:0093B8 E4                CLR      A
B1:0093B9 F0                MOVX     @DPTR,A
B1:0093BA A3                INC      DPTR
B1:0093BB EF                MOV      A,R7
B1:0093BC F0                MOVX     @DPTR,A
B1:0093BD A3                INC      DPTR
B1:0093BE 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_TsCallbackFunc
B1:0093C0 F0                MOVX     @DPTR,A
B1:0093C1 A3                INC      DPTR
B1:0093C2 7458              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_TsCallbackFunc
B1:0093C4 F0                MOVX     @DPTR,A
B1:0093C5 7B01              MOV      R3,#01H
B1:0093C7 7A0A              MOV      R2,#HIGH proto_ts_param
B1:0093C9 7905              MOV      R1,#LOW proto_ts_param
B1:0093CB 121D77            LCALL    ?INTERBANK_TABLE?_ZW_TransportService_SendData
B1:0093CE 4009              JC       ?C0171?ZW_TRANSPORT
B1:0093D0 E4                CLR      A
B1:0093D1 90088C            MOV      DPTR,#_ts_stored_callback
B1:0093D4 F0                MOVX     @DPTR,A
B1:0093D5 A3                INC      DPTR
B1:0093D6 F0                MOVX     @DPTR,A
B1:0093D7 FF                MOV      R7,A
B1:0093D8 22                RET      
B1:0093D9         ?C0171?ZW_TRANSPORT:
B1:0093D9 7F01              MOV      R7,#01H
B1:0093DB 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 234


B1:0093DC         ?C0154?ZW_TRANSPORT:
B1:0093DC 9009F5            MOV      DPTR,#srcNodeID
B1:0093DF E0                MOVX     A,@DPTR
B1:0093E0 B16B              ACALL    ?L?COM018B
B1:0093E2 E9                MOV      A,R1
B1:0093E3 24B6              ADD      A,#0B6H
B1:0093E5 1287E0            LCALL    ?L?COM002E
B1:0093E8 9009F6            MOV      DPTR,#destNodeID
B1:0093EB E0                MOVX     A,@DPTR
B1:0093EC B16B              ACALL    ?L?COM018B
B1:0093EE E9                MOV      A,R1
B1:0093EF 24BA              ADD      A,#0BAH
B1:0093F1 1287E0            LCALL    ?L?COM002E
B1:0093F4 B16C              ACALL    ?L?COM018C
B1:0093F6 E9                MOV      A,R1
B1:0093F7 24DF              ADD      A,#0DFH
B1:0093F9 F9                MOV      R1,A
B1:0093FA E4                CLR      A
B1:0093FB 125765            LCALL    ?L?COM01E3
B1:0093FE 300A0F            JNB      bUseExploreAsRouteResolution,?C0172?ZW_TRANSPORT
B1:009401 C20A              CLR      bUseExploreAsRouteResolution
B1:009403 9009FF            MOV      DPTR,#pFreeTxElement
B1:009406 128FD5            LCALL    ?L?COM0057
B1:009409 128622            LCALL    ?L?COM0006
B1:00940C 4401              ORL      A,#01H
B1:00940E 800F              SJMP     ?C0592?ZW_TRANSPORT
B1:009410         ?C0172?ZW_TRANSPORT:
B1:009410 9009FB            MOV      DPTR,#txOptions
B1:009413 E0                MOVX     A,@DPTR
B1:009414 30E60B            JNB      ACC.6,?C0173?ZW_TRANSPORT
B1:009417 B17B              ACALL    ?L?COM056A
B1:009419 B16C              ACALL    ?L?COM018C
B1:00941B B182              ACALL    ?L?COM034C
B1:00941D 7407              MOV      A,#07H
B1:00941F         
B1:00941F 122072            LCALL    ?C?CSTPTR
B1:009422         ?C0173?ZW_TRANSPORT:
B1:009422 9009FB            MOV      DPTR,#txOptions
B1:009425 E0                MOVX     A,@DPTR
B1:009426 5490              ANL      A,#090H
B1:009428 705D              JNZ      ?C0175?ZW_TRANSPORT
B1:00942A 900A02            MOV      DPTR,#frameType
B1:00942D E0                MOVX     A,@DPTR
B1:00942E 6401              XRL      A,#01H
B1:009430 7055              JNZ      ?C0175?ZW_TRANSPORT
B1:009432 B16C              ACALL    ?L?COM018C
B1:009434 12D014            LCALL    _GetResponseRoute
B1:009437 EF                MOV      A,R7
B1:009438 604D              JZ       ?C0175?ZW_TRANSPORT
B1:00943A 9009FF            MOV      DPTR,#pFreeTxElement
B1:00943D 12885F            LCALL    ?L?COM000F
B1:009440 12216F            LCALL    ?C?ILDPTR
B1:009443 5460              ANL      A,#060H
B1:009445 600E              JZ       ?C0177?ZW_TRANSPORT
B1:009447 9009FF            MOV      DPTR,#pFreeTxElement
B1:00944A 128FD5            LCALL    ?L?COM0057
B1:00944D 128622            LCALL    ?L?COM0006
B1:009450 4410              ORL      A,#010H
B1:009452 122072            LCALL    ?C?CSTPTR
B1:009455         ?C0177?ZW_TRANSPORT:
B1:009455 B16C              ACALL    ?L?COM018C
B1:009457 E9                MOV      A,R1
B1:009458 24BC              ADD      A,#0BCH
B1:00945A 128622            LCALL    ?L?COM0006
B1:00945D 54F0              ANL      A,#0F0H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 235


B1:00945F 6002              JZ       ?C0178?ZW_TRANSPORT
B1:009461 B17B              ACALL    ?L?COM056A
B1:009463         ?C0178?ZW_TRANSPORT:
B1:009463 B16C              ACALL    ?L?COM018C
B1:009465 B182              ACALL    ?L?COM034C
B1:009467 7403              MOV      A,#03H
B1:009469 122072            LCALL    ?C?CSTPTR
B1:00946C 900A04            MOV      DPTR,#speed
B1:00946F E0                MOVX     A,@DPTR
B1:009470 5498              ANL      A,#098H
B1:009472 F0                MOVX     @DPTR,A
B1:009473 E0                MOVX     A,@DPTR
B1:009474 FF                MOV      R7,A
B1:009475 9009FF            MOV      DPTR,#pFreeTxElement
B1:009478 12885F            LCALL    ?L?COM000F
B1:00947B 12216F            LCALL    ?C?ILDPTR
B1:00947E 5467              ANL      A,#067H
B1:009480 FE                MOV      R6,A
B1:009481 EF                MOV      A,R7
B1:009482 4E                ORL      A,R6
B1:009483 900A04            MOV      DPTR,#speed
B1:009486 F0                MOVX     @DPTR,A
B1:009487         ?C0175?ZW_TRANSPORT:
B1:009487 9009F6            MOV      DPTR,#destNodeID
B1:00948A E0                MOVX     A,@DPTR
B1:00948B FD                MOV      R5,A
B1:00948C B4FF07            CJNE     A,#0FFH,?C0179?ZW_TRANSPORT
B1:00948F 9009FB            MOV      DPTR,#txOptions
B1:009492 E0                MOVX     A,@DPTR
B1:009493 54FA              ANL      A,#0FAH
B1:009495 F0                MOVX     @DPTR,A
B1:009496         ?C0179?ZW_TRANSPORT:
B1:009496 B16C              ACALL    ?L?COM018C
B1:009498 E9                MOV      A,R1
B1:009499 24DF              ADD      A,#0DFH
B1:00949B 128622            LCALL    ?L?COM0006
B1:00949E 7078              JNZ      ?C0180?ZW_TRANSPORT
B1:0094A0 9009FB            MOV      DPTR,#txOptions
B1:0094A3 E0                MOVX     A,@DPTR
B1:0094A4 5405              ANL      A,#05H
B1:0094A6 6405              XRL      A,#05H
B1:0094A8 706E              JNZ      ?C0180?ZW_TRANSPORT
B1:0094AA AF05              MOV      R7,AR5
B1:0094AC 12C6B8            LCALL    _ReturnRouteFindFirst
B1:0094AF 5060              JNC      ?C0181?ZW_TRANSPORT
B1:0094B1 AF64              MOV      R7,returnRoute+06H
B1:0094B3 12CB88            LCALL    _ReturnRouteGetSpeed
B1:0094B6 900A04            MOV      DPTR,#speed
B1:0094B9 EF                MOV      A,R7
B1:0094BA F0                MOVX     @DPTR,A
B1:0094BB E55F              MOV      A,returnRoute+01H
B1:0094BD 540F              ANL      A,#0FH
B1:0094BF 900A03            MOV      DPTR,#bRepeaterCountInRoute
B1:0094C2 F0                MOVX     @DPTR,A
B1:0094C3 6037              JZ       ?C0182?ZW_TRANSPORT
B1:0094C5 E0                MOVX     A,@DPTR
B1:0094C6 FF                MOV      R7,A
B1:0094C7 7404              MOV      A,#04H
B1:0094C9 C3                CLR      C
B1:0094CA 9F                SUBB     A,R7
B1:0094CB 402F              JC       ?C0182?ZW_TRANSPORT
B1:0094CD B16C              ACALL    ?L?COM018C
B1:0094CF E9                MOV      A,R1
B1:0094D0 24BD              ADD      A,#0BDH
B1:0094D2 F9                MOV      R1,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 236


B1:0094D3 E4                CLR      A
B1:0094D4 3A                ADDC     A,R2
B1:0094D5 FA                MOV      R2,A
B1:0094D6 C003              PUSH     AR3
B1:0094D8 C002              PUSH     AR2
B1:0094DA C001              PUSH     AR1
B1:0094DC 12C791            LCALL    ?L?COM0569
B1:0094DF 126149            LCALL    ?L?COM0047
B1:0094E2 D001              POP      AR1
B1:0094E4 D002              POP      AR2
B1:0094E6 D003              POP      AR3
B1:0094E8 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:0094EB 900A03            MOV      DPTR,#bRepeaterCountInRoute
B1:0094EE E0                MOVX     A,@DPTR
B1:0094EF C4                SWAP     A
B1:0094F0 54F0              ANL      A,#0F0H
B1:0094F2 B16B              ACALL    ?L?COM018B
B1:0094F4 E9                MOV      A,R1
B1:0094F5 24BC              ADD      A,#0BCH
B1:0094F7 1287E0            LCALL    ?L?COM002E
B1:0094FA B17B              ACALL    ?L?COM056A
B1:0094FC         ?C0182?ZW_TRANSPORT:
B1:0094FC B16C              ACALL    ?L?COM018C
B1:0094FE B182              ACALL    ?L?COM034C
B1:009500 7405              MOV      A,#05H
B1:009502 122072            LCALL    ?C?CSTPTR
B1:009505 B16C              ACALL    ?L?COM018C
B1:009507 12CA0F            LCALL    ?L?COM0409
B1:00950A E55E              MOV      A,returnRoute
B1:00950C 122072            LCALL    ?C?CSTPTR
B1:00950F 8007              SJMP     ?C0180?ZW_TRANSPORT
B1:009511         ?C0181?ZW_TRANSPORT:
B1:009511 9009FB            MOV      DPTR,#txOptions
B1:009514 E0                MOVX     A,@DPTR
B1:009515 54FB              ANL      A,#0FBH
B1:009517 F0                MOVX     @DPTR,A
B1:009518         ?C0180?ZW_TRANSPORT:
B1:009518 B16C              ACALL    ?L?COM018C
B1:00951A E9                MOV      A,R1
B1:00951B 24DF              ADD      A,#0DFH
B1:00951D 128622            LCALL    ?L?COM0006
B1:009520 7005              JNZ      ?C0184?ZW_TRANSPORT
B1:009522 7406              MOV      A,#06H
B1:009524 122072            LCALL    ?C?CSTPTR
B1:009527         ?C0184?ZW_TRANSPORT:
B1:009527 900A04            MOV      DPTR,#speed
B1:00952A E0                MOVX     A,@DPTR
B1:00952B FF                MOV      R7,A
B1:00952C 900A02            MOV      DPTR,#frameType
B1:00952F E0                MOVX     A,@DPTR
B1:009530 FD                MOV      R5,A
B1:009531 9009FA            MOV      DPTR,#dataLength
B1:009534 E0                MOVX     A,@DPTR
B1:009535 900A39            MOV      DPTR,#?_EnQueueCommon?BYTE+05H
B1:009538 F0                MOVX     @DPTR,A
B1:009539 9009FB            MOV      DPTR,#txOptions
B1:00953C E0                MOVX     A,@DPTR
B1:00953D 900A3A            MOV      DPTR,#?_EnQueueCommon?BYTE+06H
B1:009540 F0                MOVX     @DPTR,A
B1:009541 9009FD            MOV      DPTR,#completedFunc
B1:009544 E0                MOVX     A,@DPTR
B1:009545 FB                MOV      R3,A
B1:009546 A3                INC      DPTR
B1:009547 E0                MOVX     A,@DPTR
B1:009548 900A3B            MOV      DPTR,#?_EnQueueCommon?BYTE+07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 237


B1:00954B CB                XCH      A,R3
B1:00954C F0                MOVX     @DPTR,A
B1:00954D A3                INC      DPTR
B1:00954E EB                MOV      A,R3
B1:00954F F0                MOVX     @DPTR,A
B1:009550 B16C              ACALL    ?L?COM018C
B1:009552 900A3D            MOV      DPTR,#?_EnQueueCommon?BYTE+09H
B1:009555 1225A9            LCALL    ?C?PSTXDATA
B1:009558 9009F7            MOV      DPTR,#pData
B1:00955B 122589            LCALL    ?C?PLDXDATA
B1:00955E 128CC3            LCALL    _EnQueueCommon
B1:009561 7F01              MOV      R7,#01H
B1:009563 22                RET      
B1:009564         clean_up_and_exit:
B1:009564 B16C              ACALL    ?L?COM018C
B1:009566 B18A              ACALL    _TxQueueReleaseElement
B1:009568 7F00              MOV      R7,#00H
B1:00956A 22                RET      
----- FUNCTION _EnqueueSingleDataPtr (END) -------


----- FUNCTION ?L?COM018B (BEGIN) -----
B1:00956B FF                MOV      R7,A
B1:00956C         ?L?COM018C:
B1:00956C 9009FF            MOV      DPTR,#pFreeTxElement
B1:00956F 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM018B (END) -------


----- FUNCTION ?L?COM0345 (BEGIN) -----
B1:009572 F9                MOV      R1,A
B1:009573 E4                CLR      A
B1:009574 3A                ADDC     A,R2
B1:009575 FA                MOV      R2,A
B1:009576 747F              MOV      A,#07FH
B1:009578 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0345 (END) -------


----- FUNCTION ?L?COM056A (BEGIN) -----
B1:00957B 900A02            MOV      DPTR,#frameType
B1:00957E 7404              MOV      A,#04H
B1:009580 F0                MOVX     @DPTR,A
B1:009581 22                RET      
----- FUNCTION ?L?COM056A (END) -------


----- FUNCTION ?L?COM034C (BEGIN) -----
B1:009582 E9                MOV      A,R1
B1:009583         ?L?COM034D:
B1:009583 24DF              ADD      A,#0DFH
B1:009585 F9                MOV      R1,A
B1:009586 E4                CLR      A
B1:009587 3A                ADDC     A,R2
B1:009588 FA                MOV      R2,A
B1:009589 22                RET      
----- FUNCTION ?L?COM034C (END) -------


----- FUNCTION _TxQueueReleaseElement (BEGIN) -----
;---- Variable 'pFreeTxElement' assigned to Register 'R1/R2/R3' ----
B1:00958A E4                CLR      A
B1:00958B 122072            LCALL    ?C?CSTPTR
B1:00958E 12F3AF            LCALL    TxQueueIsEmpty
B1:009591 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 238


B1:009592 6401              XRL      A,#01H
B1:009594 704C              JNZ      ?C0053?ZW_TX_QUEUE
B1:009596 F164              ACALL    ?L?COM0474
B1:009598 12D92A            LCALL    _list_head
B1:00959B 803D              SJMP     ?C0059?ZW_TX_QUEUE
B1:00959D         ?C0049?ZW_TX_QUEUE:
B1:00959D 900AEE            MOV      DPTR,#elm
B1:0095A0 122589            LCALL    ?C?PLDXDATA
B1:0095A3 E9                MOV      A,R1
B1:0095A4 4A                ORL      A,R2
B1:0095A5 603B              JZ       ?C0053?ZW_TX_QUEUE
B1:0095A7 900AEE            MOV      DPTR,#elm
B1:0095AA 122589            LCALL    ?C?PLDXDATA
B1:0095AD 903D5F            MOV      DPTR,#?_list_remove?BYTE+03H
B1:0095B0 F161              ACALL    ?L?COM0473
B1:0095B2 129846            LCALL    _list_remove
B1:0095B5 900AEE            MOV      DPTR,#elm
B1:0095B8 128FD5            LCALL    ?L?COM0057
B1:0095BB 127060            LCALL    ?L?COM00DC
B1:0095BE 45F0              ORL      A,B
B1:0095C0 600F              JZ       ?C0051?ZW_TX_QUEUE
B1:0095C2 900AEE            MOV      DPTR,#elm
B1:0095C5 128FD5            LCALL    ?L?COM0057
B1:0095C8 127060            LCALL    ?L?COM00DC
B1:0095CB AAF0              MOV      R2,B
B1:0095CD F9                MOV      R1,A
B1:0095CE 122716            LCALL    ?C?ICALL
B1:0095D1         ?C0051?ZW_TX_QUEUE:
B1:0095D1 900AEE            MOV      DPTR,#elm
B1:0095D4 122589            LCALL    ?C?PLDXDATA
B1:0095D7 1225BE            LCALL    ?C?PLDPTR
B1:0095DA         
B1:0095DA 900AEE            MOV      DPTR,#elm
B1:0095DD 1225A9            LCALL    ?C?PSTXDATA
B1:0095E0 80BB              SJMP     ?C0049?ZW_TX_QUEUE
B1:0095E2         ?C0053?ZW_TX_QUEUE:
B1:0095E2 22                RET      
----- FUNCTION _TxQueueReleaseElement (END) -------


----- FUNCTION _ZW_SendDataEx (BEGIN) -----
B1:0095E3 900A4C            MOV      DPTR,#pData
B1:0095E6 1225A9            LCALL    ?C?PSTXDATA
B1:0095E9 900A4F            MOV      DPTR,#dataLength
B1:0095EC ED                MOV      A,R5
B1:0095ED F0                MOVX     @DPTR,A
B1:0095EE E4                CLR      A
B1:0095EF 900778            MOV      DPTR,#eErrcode
B1:0095F2 F0                MOVX     @DPTR,A
B1:0095F3 900A50            MOV      DPTR,#pTxOptionsEx
B1:0095F6 12861C            LCALL    ?L?COM0004
B1:0095F9 5437              ANL      A,#037H
B1:0095FB 122072            LCALL    ?C?CSTPTR
B1:0095FE F14E              ACALL    ?L?COM0143
B1:009600 128622            LCALL    ?L?COM0006
B1:009603 FF                MOV      R7,A
B1:009604 12DA52            LCALL    _IsKeySupported
B1:009607 4009              JC       ?C0383?ZW_TRANSPORT
B1:009609 900778            MOV      DPTR,#eErrcode
B1:00960C 7402              MOV      A,#02H
B1:00960E F0                MOVX     @DPTR,A
B1:00960F 7F00              MOV      R7,#00H
B1:009611 22                RET      
B1:009612         ?C0383?ZW_TRANSPORT:
B1:009612 F14E              ACALL    ?L?COM0143
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 239


B1:009614 128622            LCALL    ?L?COM0006
B1:009617 6002              JZ       $ + 4H
B1:009619 C1D3              AJMP     ?C0385?ZW_TRANSPORT
B1:00961B 900A50            MOV      DPTR,#pTxOptionsEx
B1:00961E 12861C            LCALL    ?L?COM0004
B1:009621 FF                MOV      R7,A
B1:009622 C3                CLR      C
B1:009623 30E501            JNB      ACC.5,?C0386?ZW_TRANSPORT
B1:009626 D3                SETB     C
B1:009627         ?C0386?ZW_TRANSPORT:
B1:009627         ?C0387?ZW_TRANSPORT:
B1:009627 920A              MOV      bUseExploreAsRouteResolution,C
B1:009629 900A50            MOV      DPTR,#pTxOptionsEx
B1:00962C 12DB78            LCALL    ?L?COM006D
B1:00962F EF                MOV      A,R7
B1:009630 4420              ORL      A,#020H
B1:009632 122072            LCALL    ?C?CSTPTR
B1:009635 C206              CLR      bApplicationTxAbort
B1:009637 7F02              MOV      R7,#02H
B1:009639 128350            LCALL    _TxQueueGetElement
B1:00963C 900A55            MOV      DPTR,#pFreeTxElement
B1:00963F F16A              ACALL    ?L?COM02DF
B1:009641 7002              JNZ      $ + 4H
B1:009643 C1CD              AJMP     ?C0388?ZW_TRANSPORT
B1:009645 1251E9            LCALL    getTickTime
B1:009648 900A55            MOV      DPTR,#pFreeTxElement
B1:00964B 122589            LCALL    ?C?PLDXDATA
B1:00964E E9                MOV      A,R1
B1:00964F 24E9              ADD      A,#0E9H
B1:009651 12A5B2            LCALL    ?L?COM00F9
B1:009654 900A55            MOV      DPTR,#pFreeTxElement
B1:009657 12CFA8            LCALL    ?L?COM0416
B1:00965A 125765            LCALL    ?L?COM01E3
B1:00965D 900A50            MOV      DPTR,#pTxOptionsEx
B1:009660 12BF9A            LCALL    ?L?COM01E1
B1:009663 128622            LCALL    ?L?COM0006
B1:009666 30E00E            JNB      ACC.0,?C0389?ZW_TRANSPORT
B1:009669 900A55            MOV      DPTR,#pFreeTxElement
B1:00966C 128FD5            LCALL    ?L?COM0057
B1:00966F 128622            LCALL    ?L?COM0006
B1:009672 4440              ORL      A,#040H
B1:009674 122072            LCALL    ?C?CSTPTR
B1:009677         ?C0389?ZW_TRANSPORT:
B1:009677 900A50            MOV      DPTR,#pTxOptionsEx
B1:00967A F15B              ACALL    ?L?COM006B
B1:00967C FF                MOV      R7,A
B1:00967D 12CE91            LCALL    _ChooseSpeedForDestination_slave
B1:009680 901221            MOV      DPTR,#nodeID
B1:009683 E0                MOVX     A,@DPTR
B1:009684 FD                MOV      R5,A
B1:009685 900A50            MOV      DPTR,#pTxOptionsEx
B1:009688 F15B              ACALL    ?L?COM006B
B1:00968A FB                MOV      R3,A
B1:00968B C003              PUSH     AR3
B1:00968D 900A4C            MOV      DPTR,#pData
B1:009690 F18A              ACALL    ?L?COM0393
B1:009692 900A4F            MOV      DPTR,#dataLength
B1:009695 E0                MOVX     A,@DPTR
B1:009696 9009FA            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+06H
B1:009699 F0                MOVX     @DPTR,A
B1:00969A 900A50            MOV      DPTR,#pTxOptionsEx
B1:00969D 12861C            LCALL    ?L?COM0004
B1:0096A0 9009FB            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+07H
B1:0096A3 F0                MOVX     @DPTR,A
B1:0096A4 900A55            MOV      DPTR,#pFreeTxElement
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 240


B1:0096A7 128FD5            LCALL    ?L?COM0057
B1:0096AA 128622            LCALL    ?L?COM0006
B1:0096AD 9009FC            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:0096B0 F0                MOVX     @DPTR,A
B1:0096B1 900A53            MOV      DPTR,#completedFunc
B1:0096B4 12CFC8            LCALL    ?L?COM047E
B1:0096B7 900A55            MOV      DPTR,#pFreeTxElement
B1:0096BA F181              ACALL    ?L?COM02DB
B1:0096BC D003              POP      AR3
B1:0096BE 51BF              ACALL    _EnqueueSingleDataPtr
;---- Variable 'return_val' assigned to Register 'R7' ----
B1:0096C0 EF                MOV      A,R7
B1:0096C1 6002              JZ       ?C0390?ZW_TRANSPORT
B1:0096C3 E145              AJMP     ?C0618?ZW_TRANSPORT
B1:0096C5         ?C0390?ZW_TRANSPORT:
B1:0096C5 900A55            MOV      DPTR,#pFreeTxElement
B1:0096C8 122589            LCALL    ?C?PLDXDATA
B1:0096CB B18A              ACALL    _TxQueueReleaseElement
B1:0096CD         ?C0388?ZW_TRANSPORT:
B1:0096CD 12CF8E            LCALL    CleanUpAfterFailedTxElemAlloc
B1:0096D0 7F00              MOV      R7,#00H
B1:0096D2 22                RET      
B1:0096D3         ?C0385?ZW_TRANSPORT:
B1:0096D3 F14E              ACALL    ?L?COM0143
B1:0096D5 128622            LCALL    ?L?COM0006
B1:0096D8 6404              XRL      A,#04H
B1:0096DA 7031              JNZ      ?C0392?ZW_TRANSPORT
B1:0096DC F193              ACALL    ?L?COM05BA
B1:0096DE F15B              ACALL    ?L?COM006B
B1:0096E0 FD                MOV      R5,A
B1:0096E1 900A4F            MOV      DPTR,#dataLength
B1:0096E4 E0                MOVX     A,@DPTR
B1:0096E5 903EBF            MOV      DPTR,#?_sec0_send_data?BYTE+05H
B1:0096E8 F0                MOVX     @DPTR,A
B1:0096E9 900A50            MOV      DPTR,#pTxOptionsEx
B1:0096EC 12861C            LCALL    ?L?COM0004
B1:0096EF 903EC0            MOV      DPTR,#?_sec0_send_data?BYTE+06H
B1:0096F2 F0                MOVX     @DPTR,A
B1:0096F3 900A53            MOV      DPTR,#completedFunc
B1:0096F6 E0                MOVX     A,@DPTR
B1:0096F7 FB                MOV      R3,A
B1:0096F8 A3                INC      DPTR
B1:0096F9 E0                MOVX     A,@DPTR
B1:0096FA 903EC1            MOV      DPTR,#?_sec0_send_data?BYTE+07H
B1:0096FD CB                XCH      A,R3
B1:0096FE F0                MOVX     @DPTR,A
B1:0096FF EB                MOV      A,R3
B1:009700 F171              ACALL    ?L?COM0577
B1:009702 121C5F            LCALL    ?INTERBANK_TABLE?_sec0_send_data
B1:009705 EF                MOV      A,R7
B1:009706 6002              JZ       ?C0393?ZW_TRANSPORT
B1:009708         
B1:009708 803B              SJMP     ?C0618?ZW_TRANSPORT
B1:00970A         ?C0393?ZW_TRANSPORT:
B1:00970A 7F00              MOV      R7,#00H
B1:00970C 22                RET      
B1:00970D         ?C0392?ZW_TRANSPORT:
B1:00970D F14E              ACALL    ?L?COM0143
B1:00970F 128622            LCALL    ?L?COM0006
B1:009712 D3                SETB     C
B1:009713 9403              SUBB     A,#03H
B1:009715 5034              JNC      ?C0391?ZW_TRANSPORT
B1:009717 F193              ACALL    ?L?COM05BA
B1:009719 122589            LCALL    ?C?PLDXDATA
B1:00971C E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 241


B1:00971D 2401              ADD      A,#01H
B1:00971F 1287E0            LCALL    ?L?COM002E
B1:009722 900A4F            MOV      DPTR,#dataLength
B1:009725 E0                MOVX     A,@DPTR
B1:009726 A3                INC      DPTR
B1:009727 127352            LCALL    ?L?COM0512
B1:00972A 903AB4            MOV      DPTR,#?_sec2_send_data?BYTE+05H
B1:00972D 1225A9            LCALL    ?C?PSTXDATA
B1:009730 900A53            MOV      DPTR,#completedFunc
B1:009733 E0                MOVX     A,@DPTR
B1:009734 FF                MOV      R7,A
B1:009735 A3                INC      DPTR
B1:009736 E0                MOVX     A,@DPTR
B1:009737 903AB7            MOV      DPTR,#?_sec2_send_data?BYTE+08H
B1:00973A CF                XCH      A,R7
B1:00973B F0                MOVX     @DPTR,A
B1:00973C EF                MOV      A,R7
B1:00973D F171              ACALL    ?L?COM0577
B1:00973F 121C87            LCALL    ?INTERBANK_TABLE?_sec2_send_data
B1:009742 EF                MOV      A,R7
B1:009743 6003              JZ       ?C0397?ZW_TRANSPORT
B1:009745         
B1:009745 02FD9E            LJMP     ?L?COM062D
B1:009748         ?C0397?ZW_TRANSPORT:
B1:009748 7F00              MOV      R7,#00H
B1:00974A 22                RET      
B1:00974B         ?C0391?ZW_TRANSPORT:
B1:00974B 7F00              MOV      R7,#00H
B1:00974D 22                RET      
----- FUNCTION _ZW_SendDataEx (END) -------


----- FUNCTION ?L?COM0143 (BEGIN) -----
B1:00974E 900A50            MOV      DPTR,#pTxOptionsEx
B1:009751         ?L?COM0144:
B1:009751 122589            LCALL    ?C?PLDXDATA
B1:009754 E9                MOV      A,R1
B1:009755 2404              ADD      A,#04H
B1:009757 22                RET      
----- FUNCTION ?L?COM0143 (END) -------


----- FUNCTION ?L?COM006A (BEGIN) -----
B1:009758 903C83            MOV      DPTR,#pCmd
B1:00975B         ?L?COM006B:
B1:00975B 122589            LCALL    ?C?PLDXDATA
B1:00975E 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM006A (END) -------


----- FUNCTION ?L?COM0473 (BEGIN) -----
B1:009761 1225A9            LCALL    ?C?PSTXDATA
B1:009764         ?L?COM0474:
B1:009764 9003B4            MOV      DPTR,#txQueueEmptyEvent_list
B1:009767 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0473 (END) -------


----- FUNCTION ?L?COM02DF (BEGIN) -----
B1:00976A 1225A9            LCALL    ?C?PSTXDATA
B1:00976D EA                MOV      A,R2
B1:00976E 49                ORL      A,R1
B1:00976F 4B                ORL      A,R3
B1:009770 22                RET      
----- FUNCTION ?L?COM02DF (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 242




----- FUNCTION ?L?COM0577 (BEGIN) -----
B1:009771 A3                INC      DPTR
B1:009772 F0                MOVX     @DPTR,A
B1:009773 900A4C            MOV      DPTR,#pData
B1:009776 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0577 (END) -------


----- FUNCTION ?L?COM0631 (BEGIN) -----
B1:009779 9009FA            MOV      DPTR,#dataLength
B1:00977C E0                MOVX     A,@DPTR
B1:00977D D3                SETB     C
B1:00977E 942E              SUBB     A,#02EH
B1:009780 22                RET      
----- FUNCTION ?L?COM0631 (END) -------


----- FUNCTION ?L?COM02DB (BEGIN) -----
B1:009781 122589            LCALL    ?C?PLDXDATA
B1:009784         ?L?COM02DC:
B1:009784 9009FF            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+0BH
B1:009787 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM02DB (END) -------


----- FUNCTION ?L?COM0393 (BEGIN) -----
B1:00978A 122589            LCALL    ?C?PLDXDATA
B1:00978D         ?L?COM0394:
B1:00978D 9009F7            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+03H
B1:009790 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0393 (END) -------


----- FUNCTION ?L?COM05BA (BEGIN) -----
B1:009793 901221            MOV      DPTR,#nodeID
B1:009796 E0                MOVX     A,@DPTR
B1:009797 FF                MOV      R7,A
B1:009798 900A50            MOV      DPTR,#pTxOptionsEx
B1:00979B 22                RET      
----- FUNCTION ?L?COM05BA (END) -------


----- FUNCTION ?L?COM0564 (BEGIN) -----
B1:00979C 7B01              MOV      R3,#01H
B1:00979E 7A2B              MOV      R2,#HIGH SUC_Update+01H
B1:0097A0 79A7              MOV      R1,#LOW SUC_Update+01H
----- FUNCTION _NetWorkTimerStop (BEGIN) -----
B1:0097A2 90427F            MOV      DPTR,#timerHandle
B1:0097A5 1225A9            LCALL    ?C?PSTXDATA
B1:0097A8 90427F            MOV      DPTR,#timerHandle
B1:0097AB F15B              ACALL    ?L?COM006B
B1:0097AD FF                MOV      R7,A
B1:0097AE 124465            LCALL    _TimerCancel
B1:0097B1 90427F            MOV      DPTR,#timerHandle
B1:0097B4 122589            LCALL    ?C?PLDXDATA
B1:0097B7 74FF              MOV      A,#0FFH
B1:0097B9 022072            LJMP     ?C?CSTPTR
----- FUNCTION _NetWorkTimerStop (END) -------


----- FUNCTION _TxQueueEmptyEvent_Add (BEGIN) -----
;---- Variable 'EmptyEventCallback' assigned to Register 'R4/R5' ----
B1:0097BC 900AEB            MOV      DPTR,#elm
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 243


B1:0097BF 1225A9            LCALL    ?C?PSTXDATA
B1:0097C2 AF05              MOV      R7,AR5
B1:0097C4 E9                MOV      A,R1
B1:0097C5 2403              ADD      A,#03H
B1:0097C7 F9                MOV      R1,A
B1:0097C8 E4                CLR      A
B1:0097C9 3A                ADDC     A,R2
B1:0097CA FA                MOV      R2,A
B1:0097CB EC                MOV      A,R4
B1:0097CC 8FF0              MOV      B,R7
B1:0097CE 12221F            LCALL    ?C?ISTPTR
B1:0097D1 900AEB            MOV      DPTR,#elm
B1:0097D4 122589            LCALL    ?C?PLDXDATA
B1:0097D7 903E7E            MOV      DPTR,#?_list_add?BYTE+03H
B1:0097DA F161              ACALL    ?L?COM0473
B1:;----                  JMP      _list_add
----- FUNCTION _TxQueueEmptyEvent_Add (END) -------


----- FUNCTION _list_add (BEGIN) -----
B1:0097DC 903E7B            MOV      DPTR,#list
B1:0097DF 1225A9            LCALL    ?C?PSTXDATA
B1:0097E2 C003              PUSH     AR3
B1:0097E4 C002              PUSH     AR2
B1:0097E6 C001              PUSH     AR1
B1:0097E8 903E7E            MOV      DPTR,#item
B1:0097EB 122589            LCALL    ?C?PLDXDATA
B1:0097EE 903D5F            MOV      DPTR,#?_list_remove?BYTE+03H
B1:0097F1 1225A9            LCALL    ?C?PSTXDATA
B1:0097F4 D001              POP      AR1
B1:0097F6 D002              POP      AR2
B1:0097F8 D003              POP      AR3
B1:0097FA 129846            LCALL    _list_remove
B1:0097FD 127070            LCALL    ?L?COM00E1
B1:009800 C003              PUSH     AR3
B1:009802 C002              PUSH     AR2
B1:009804 C001              PUSH     AR1
B1:009806 903E7E            MOV      DPTR,#item
B1:009809 122589            LCALL    ?C?PLDXDATA
B1:00980C 1225DE            LCALL    ?C?PSTPTR
B1:00980F 903E7B            MOV      DPTR,#list
B1:009812 122589            LCALL    ?C?PLDXDATA
B1:009815 12F3E4            LCALL    _list_tail
B1:009818 903E81            MOV      DPTR,#l
B1:00981B 1225A9            LCALL    ?C?PSTXDATA
B1:00981E E9                MOV      A,R1
B1:00981F 4A                ORL      A,R2
B1:009820 903E7E            MOV      DPTR,#item
B1:009823 700E              JNZ      ?C0008?LIST
B1:009825 122589            LCALL    ?C?PLDXDATA
B1:009828 C003              PUSH     AR3
B1:00982A C002              PUSH     AR2
B1:00982C C001              PUSH     AR1
B1:00982E 903E7B            MOV      DPTR,#list
B1:009831 800C              SJMP     ?C0021?LIST
B1:009833         ?C0008?LIST:
B1:009833 122589            LCALL    ?C?PLDXDATA
B1:009836 C003              PUSH     AR3
B1:009838 C002              PUSH     AR2
B1:00983A C001              PUSH     AR1
B1:00983C 903E81            MOV      DPTR,#l
B1:00983F         
B1:00983F 122589            LCALL    ?C?PLDXDATA
B1:009842 1225DE            LCALL    ?C?PSTPTR
B1:009845 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 244


----- FUNCTION _list_add (END) -------


----- FUNCTION _list_remove (BEGIN) -----
B1:009846 903D5C            MOV      DPTR,#list
B1:009849 1271F8            LCALL    ?L?COM0385
B1:00984C E9                MOV      A,R1
B1:00984D 4A                ORL      A,R2
B1:00984E 7002              JNZ      $ + 4H
B1:009850 01D4              AJMP     ?C0012?LIST
B1:009852         ?C0011?LIST:
B1:009852 127070            LCALL    ?L?COM00E1
B1:009855 903D65            MOV      DPTR,#r
B1:009858 1225A9            LCALL    ?C?PSTXDATA
B1:00985B 903D5C            MOV      DPTR,#list
B1:00985E 8066              SJMP     ?C0023?LIST
B1:009860         ?C0013?LIST:
B1:009860 11D5              ACALL    ?L?COM0560
B1:009862 E9                MOV      A,R1
B1:009863 4A                ORL      A,R2
B1:009864 606E              JZ       ?C0012?LIST
B1:009866 903D5F            MOV      DPTR,#item
B1:009869 122589            LCALL    ?C?PLDXDATA
B1:00986C C003              PUSH     AR3
B1:00986E C002              PUSH     AR2
B1:009870 C001              PUSH     AR1
B1:009872 11D5              ACALL    ?L?COM0560
B1:009874 D082              POP      DPL
B1:009876 D083              POP      DPH
B1:009878 D0E0              POP      ACC
B1:00987A 6B                XRL      A,R3
B1:00987B 7008              JNZ      ?C0019?LIST
B1:00987D E9                MOV      A,R1
B1:00987E 6582              XRL      A,DPL
B1:009880 7003              JNZ      ?C0019?LIST
B1:009882 EA                MOV      A,R2
B1:009883 6583              XRL      A,DPH
B1:009885         ?C0019?LIST:
B1:009885 7034              JNZ      ?C0016?LIST
B1:009887 903D65            MOV      DPTR,#r
B1:00988A 122589            LCALL    ?C?PLDXDATA
B1:00988D E9                MOV      A,R1
B1:00988E 4A                ORL      A,R2
B1:00988F 903D62            MOV      DPTR,#l
B1:009892 7011              JNZ      ?C0017?LIST
B1:009894 122589            LCALL    ?C?PLDXDATA
B1:009897 1225BE            LCALL    ?C?PLDPTR
B1:00989A C003              PUSH     AR3
B1:00989C C002              PUSH     AR2
B1:00989E C001              PUSH     AR1
B1:0098A0 903D5C            MOV      DPTR,#list
B1:0098A3 800F              SJMP     ?C0022?LIST
B1:0098A5         ?C0017?LIST:
B1:0098A5 122589            LCALL    ?C?PLDXDATA
B1:0098A8 1225BE            LCALL    ?C?PLDPTR
B1:0098AB C003              PUSH     AR3
B1:0098AD C002              PUSH     AR2
B1:0098AF C001              PUSH     AR1
B1:0098B1 903D65            MOV      DPTR,#r
B1:0098B4         
B1:0098B4 122589            LCALL    ?C?PLDXDATA
B1:0098B7 1225DE            LCALL    ?C?PSTPTR
B1:0098BA 22                RET      
B1:0098BB         ?C0016?LIST:
B1:0098BB 11D5              ACALL    ?L?COM0560
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 245


B1:0098BD 903D65            MOV      DPTR,#r
B1:0098C0 1225A9            LCALL    ?C?PSTXDATA
B1:0098C3 903D62            MOV      DPTR,#l
B1:0098C6         
B1:0098C6 122589            LCALL    ?C?PLDXDATA
B1:0098C9 1225BE            LCALL    ?C?PLDPTR
B1:0098CC 903D62            MOV      DPTR,#l
B1:0098CF 1225A9            LCALL    ?C?PSTXDATA
B1:0098D2 808C              SJMP     ?C0013?LIST
B1:0098D4         ?C0012?LIST:
B1:0098D4 22                RET      
----- FUNCTION _list_remove (END) -------


----- FUNCTION ?L?COM0560 (BEGIN) -----
B1:0098D5 903D62            MOV      DPTR,#l
B1:0098D8 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0560 (END) -------


----- FUNCTION _ctimer_stop (BEGIN) -----
B1:0098DB 9042AC            MOV      DPTR,#c
B1:0098DE 1225A9            LCALL    ?C?PSTXDATA
B1:0098E1 9042AC            MOV      DPTR,#c
B1:0098E4 12D900            LCALL    ?L?COM02A7
B1:0098E7 0146              AJMP     _list_remove
----- FUNCTION _ctimer_stop (END) -------


----- FUNCTION _IsMyFrame (BEGIN) -----
B1:0098E9 900A27            MOV      DPTR,#pRxFrame
B1:0098EC 1271F8            LCALL    ?L?COM0385
B1:0098EF 900A31            MOV      DPTR,#fr
B1:0098F2 1225A9            LCALL    ?C?PSTXDATA
B1:0098F5 900A27            MOV      DPTR,#pRxFrame
B1:0098F8 127077            LCALL    ?L?COM00E7
B1:0098FB F9                MOV      R1,A
B1:0098FC E4                CLR      A
B1:0098FD 125765            LCALL    ?L?COM01E3
B1:009900 90086F            MOV      DPTR,#myFrame
B1:009903 F0                MOVX     @DPTR,A
B1:009904 900780            MOV      DPTR,#sACK
B1:009907 F0                MOVX     @DPTR,A
B1:009908 12DBB0            LCALL    ?L?COM0520
B1:00990B 126149            LCALL    ?L?COM0047
B1:00990E 12FED6            LCALL    ?L?COM050C
B1:009911 7F04              MOV      R7,#04H
B1:009913 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:009916 20371C            JB       productionTest,?C0256?ZW_TRANSPORT
B1:009919 7B01              MOV      R3,#01H
B1:00991B 7A12              MOV      R2,#HIGH homeID
B1:00991D 7923              MOV      R1,#LOW homeID
B1:00991F 12DBAA            LCALL    ?L?COM012E
B1:009922 12DAC7            LCALL    ?L?COM0257
B1:009925 600E              JZ       ?C0256?ZW_TRANSPORT
B1:009927 900A27            MOV      DPTR,#pRxFrame
B1:00992A 127077            LCALL    ?L?COM00E7
B1:00992D 128622            LCALL    ?L?COM0006
B1:009930 4480              ORL      A,#080H
B1:009932 122072            LCALL    ?C?CSTPTR
B1:009935         ?C0256?ZW_TRANSPORT:
B1:009935 900A27            MOV      DPTR,#pRxFrame
B1:009938 127077            LCALL    ?L?COM00E7
B1:00993B 128622            LCALL    ?L?COM0006
B1:00993E 20E702            JB       ACC.7,$ + 5H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 246


B1:009941 21E0              AJMP     ?C0258?ZW_TRANSPORT
B1:009943 901221            MOV      DPTR,#nodeID
B1:009946 E0                MOVX     A,@DPTR
B1:009947 6064              JZ       ?C0259?ZW_TRANSPORT
B1:009949 300C61            JNB      exploreInclusionModeRepeat,?C0259?ZW_TRANSPORT
B1:00994C 12A248            LCALL    ?L?COM0014
B1:00994F 2405              ADD      A,#05H
B1:009951 128622            LCALL    ?L?COM0006
B1:009954 540F              ANL      A,#0FH
B1:009956 FF                MOV      R7,A
B1:009957 6405              XRL      A,#05H
B1:009959 7002              JNZ      $ + 4H
B1:00995B 21E0              AJMP     ?C0258?ZW_TRANSPORT
B1:00995D EF                MOV      A,R7
B1:00995E 6401              XRL      A,#01H
B1:009960 704B              JNZ      ?C0259?ZW_TRANSPORT
B1:009962 121FB3            LCALL    ?C?CLDPTR
B1:009965 30E745            JNB      ACC.7,?C0259?ZW_TRANSPORT
B1:009968 12A248            LCALL    ?L?COM0014
B1:00996B 2409              ADD      A,#09H
B1:00996D 128622            LCALL    ?L?COM0006
B1:009970 30E315            JNB      ACC.3,?C0262?ZW_TRANSPORT
B1:009973 12A248            LCALL    ?L?COM0014
B1:009976 240A              ADD      A,#0AH
B1:009978 128622            LCALL    ?L?COM0006
B1:00997B 12A242            LCALL    ?L?COM0011
B1:00997E 240B              ADD      A,#0BH
B1:009980 128FE8            LCALL    ?L?COM0050
B1:009983 12A264            LCALL    ?L?COM0146
B1:009986 8002              SJMP     ?C0263?ZW_TRANSPORT
B1:009988         ?C0262?ZW_TRANSPORT:
B1:009988 7F00              MOV      R7,#00H
B1:00998A         ?C0263?ZW_TRANSPORT:
B1:00998A 12A246            LCALL    ?L?COM0013
B1:00998D 240A              ADD      A,#0AH
B1:00998F 128622            LCALL    ?L?COM0006
B1:009992 12D98B            LCALL    ?L?COM01DE
B1:009995 12A248            LCALL    ?L?COM0014
B1:009998 12DB6B            LCALL    ?L?COM00D2
B1:00999B EC                MOV      A,R4
B1:00999C 128FEA            LCALL    ?L?COM0051
B1:00999F 12DBA3            LCALL    ?L?COM012C
B1:0099A2 7B01              MOV      R3,#01H
B1:0099A4 7A12              MOV      R2,#HIGH homeID
B1:0099A6 7923              MOV      R1,#LOW homeID
B1:0099A8 12DACB            LCALL    ?L?COM0258
B1:0099AB 6033              JZ       ?C0258?ZW_TRANSPORT
B1:0099AD         ?C0259?ZW_TRANSPORT:
B1:0099AD 200103            JB       learnMode,$ + 6H
B1:0099B0 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:0099B3 20042A            JB       learnModeClassic,?C0258?ZW_TRANSPORT
B1:0099B6 12A248            LCALL    ?L?COM0014
B1:0099B9 2405              ADD      A,#05H
B1:0099BB 128622            LCALL    ?L?COM0006
B1:0099BE 20E71F            JB       ACC.7,?C0258?ZW_TRANSPORT
B1:0099C1 12A248            LCALL    ?L?COM0014
B1:0099C4 12A250            LCALL    ?L?COM023E
B1:0099C7 E9                MOV      A,R1
B1:0099C8 2401              ADD      A,#01H
B1:0099CA 128622            LCALL    ?L?COM0006
B1:0099CD B40310            CJNE     A,#03H,?C0258?ZW_TRANSPORT
B1:0099D0 12A248            LCALL    ?L?COM0014
B1:0099D3 12DB9D            LCALL    ?L?COM012B
B1:0099D6 7B01              MOV      R3,#01H
B1:0099D8 12DAC7            LCALL    ?L?COM0257
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 247


B1:0099DB 7003              JNZ      $ + 5H
B1:0099DD 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:0099E0         ?C0258?ZW_TRANSPORT:
B1:0099E0 12A248            LCALL    ?L?COM0014
B1:0099E3 2406              ADD      A,#06H
B1:0099E5 128622            LCALL    ?L?COM0006
B1:0099E8 540F              ANL      A,#0FH
B1:0099EA FF                MOV      R7,A
B1:0099EB 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:0099EE E0                MOVX     A,@DPTR
B1:0099EF 7E00              MOV      R6,#00H
B1:0099F1 B40202            CJNE     A,#02H,?C0265?ZW_TRANSPORT
B1:0099F4 7E80              MOV      R6,#080H
B1:0099F6         ?C0265?ZW_TRANSPORT:
B1:0099F6         ?C0266?ZW_TRANSPORT:
B1:0099F6 EF                MOV      A,R7
B1:0099F7 4E                ORL      A,R6
B1:0099F8 90088E            MOV      DPTR,#currentSeqNo
B1:0099FB F0                MOVX     @DPTR,A
B1:0099FC 128538            LCALL    ?L?COM0016
B1:0099FF 4A                ORL      A,R2
B1:009A00 6046              JZ       ?C0267?ZW_TRANSPORT
B1:009A02 E9                MOV      A,R1
B1:009A03 24B7              ADD      A,#0B7H
B1:009A05 128622            LCALL    ?L?COM0006
B1:009A08 FF                MOV      R7,A
B1:009A09 7B01              MOV      R3,#01H
B1:009A0B 7A0A              MOV      R2,#HIGH bFrameType
B1:009A0D 792D              MOV      R1,#LOW bFrameType
B1:009A0F 12D999            LCALL    _ConvertHeaderInfoToFrameType
B1:009A12 12885C            LCALL    ?L?COM000E
B1:009A15 12216F            LCALL    ?C?ILDPTR
B1:009A18 5407              ANL      A,#07H
;---- Variable 'bFrameSpeed' assigned to Register 'R7' ----
B1:009A1A 128537            LCALL    ?L?COM0015
B1:009A1D 24B8              ADD      A,#0B8H
B1:009A1F 128622            LCALL    ?L?COM0006
B1:009A22 540F              ANL      A,#0FH
B1:009A24 FE                MOV      R6,A
B1:009A25 900A2D            MOV      DPTR,#bFrameType
B1:009A28 E0                MOVX     A,@DPTR
B1:009A29 540F              ANL      A,#0FH
B1:009A2B FD                MOV      R5,A
B1:009A2C BD0404            CJNE     R5,#04H,?C0268?ZW_TRANSPORT
B1:009A2F 7D40              MOV      R5,#040H
B1:009A31 8002              SJMP     ?C0269?ZW_TRANSPORT
B1:009A33         ?C0268?ZW_TRANSPORT:
B1:009A33 7D00              MOV      R5,#00H
B1:009A35         ?C0269?ZW_TRANSPORT:
B1:009A35 EE                MOV      A,R6
B1:009A36 4D                ORL      A,R5
B1:009A37 FE                MOV      R6,A
B1:009A38 EF                MOV      A,R7
B1:009A39 7F00              MOV      R7,#00H
B1:009A3B B40202            CJNE     A,#02H,?C0270?ZW_TRANSPORT
B1:009A3E 7F80              MOV      R7,#080H
B1:009A40         ?C0270?ZW_TRANSPORT:
B1:009A40         ?C0271?ZW_TRANSPORT:
B1:009A40 EE                MOV      A,R6
B1:009A41 4F                ORL      A,R7
B1:009A42 900774            MOV      DPTR,#currentSeqNoToMatch
B1:009A45 F0                MOVX     @DPTR,A
B1:009A46 8006              SJMP     ?C0272?ZW_TRANSPORT
B1:009A48         ?C0267?ZW_TRANSPORT:
B1:009A48 900774            MOV      DPTR,#currentSeqNoToMatch
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 248


B1:009A4B 74FF              MOV      A,#0FFH
B1:009A4D F0                MOVX     @DPTR,A
B1:009A4E         ?C0272?ZW_TRANSPORT:
B1:009A4E 12A248            LCALL    ?L?COM0014
B1:009A51 2405              ADD      A,#05H
B1:009A53 128622            LCALL    ?L?COM0006
B1:009A56 FF                MOV      R7,A
B1:009A57 540F              ANL      A,#0FH
B1:009A59 24FE              ADD      A,#0FEH
B1:009A5B 7003              JNZ      $ + 5H
B1:009A5D 02A022            LJMP     ?C0340?ZW_TRANSPORT
B1:009A60 14                DEC      A
B1:009A61 7003              JNZ      $ + 5H
B1:009A63 02A0C7            LJMP     ?C0343?ZW_TRANSPORT
B1:009A66 24FE              ADD      A,#0FEH
B1:009A68 7003              JNZ      $ + 5H
B1:009A6A 02A0F1            LJMP     ?C0347?ZW_TRANSPORT
B1:009A6D 2404              ADD      A,#04H
B1:009A6F 6003              JZ       $ + 5H
B1:009A71 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009A74         ?C0274?ZW_TRANSPORT:
B1:009A74 12A248            LCALL    ?L?COM0014
B1:009A77 2407              ADD      A,#07H
B1:009A79 128622            LCALL    ?L?COM0006
B1:009A7C FE                MOV      R6,A
B1:009A7D 740A              MOV      A,#0AH
B1:009A7F D3                SETB     C
B1:009A80 9E                SUBB     A,R6
B1:009A81 4002              JC       ?C0275?ZW_TRANSPORT
B1:009A83 802A              SJMP     ?C0606?ZW_TRANSPORT
B1:009A85         ?C0275?ZW_TRANSPORT:
B1:009A85 EF                MOV      A,R7
B1:009A86 20E702            JB       ACC.7,$ + 5H
B1:009A89 E1B2              AJMP     ?C0277?ZW_TRANSPORT
B1:009A8B 90088E            MOV      DPTR,#currentSeqNo
B1:009A8E E0                MOVX     A,@DPTR
B1:009A8F 4440              ORL      A,#040H
B1:009A91 F0                MOVX     @DPTR,A
B1:009A92 12A248            LCALL    ?L?COM0014
B1:009A95 240A              ADD      A,#0AH
B1:009A97 128622            LCALL    ?L?COM0006
B1:009A9A C4                SWAP     A
B1:009A9B 540F              ANL      A,#0FH
B1:009A9D 900A2E            MOV      DPTR,#hopFirst1
B1:009AA0 F0                MOVX     @DPTR,A
B1:009AA1 600C              JZ       ?C0279?ZW_TRANSPORT
B1:009AA3 E0                MOVX     A,@DPTR
B1:009AA4 FF                MOV      R7,A
B1:009AA5 D3                SETB     C
B1:009AA6 9404              SUBB     A,#04H
B1:009AA8 5005              JNC      ?C0279?ZW_TRANSPORT
B1:009AAA 740B              MOV      A,#0BH
B1:009AAC 9E                SUBB     A,R6
B1:009AAD 400E              JC       ?C0278?ZW_TRANSPORT
B1:009AAF         ?C0279?ZW_TRANSPORT:
B1:009AAF         
B1:009AAF 900A27            MOV      DPTR,#pRxFrame
B1:009AB2 127077            LCALL    ?L?COM00E7
B1:009AB5 F9                MOV      R1,A
B1:009AB6 E4                CLR      A
B1:009AB7 3A                ADDC     A,R2
B1:009AB8 FA                MOV      R2,A
B1:009AB9 E4                CLR      A
B1:009ABA 022072            LJMP     ?C?CSTPTR
B1:009ABD         ?C0278?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 249


B1:009ABD 12A248            LCALL    ?L?COM0014
B1:009AC0 2409              ADD      A,#09H
B1:009AC2 128622            LCALL    ?L?COM0006
B1:009AC5 30E127            JNB      ACC.1,?C0280?ZW_TRANSPORT
B1:009AC8 30E324            JNB      ACC.3,?C0280?ZW_TRANSPORT
B1:009ACB 12A248            LCALL    ?L?COM0014
B1:009ACE 2407              ADD      A,#07H
B1:009AD0 128622            LCALL    ?L?COM0006
B1:009AD3 FD                MOV      R5,A
B1:009AD4 EF                MOV      A,R7
B1:009AD5 240D              ADD      A,#0DH
B1:009AD7 FF                MOV      R7,A
B1:009AD8 E4                CLR      A
B1:009AD9 33                RLC      A
B1:009ADA FE                MOV      R6,A
B1:009ADB C3                CLR      C
B1:009ADC ED                MOV      A,R5
B1:009ADD 12556A            LCALL    ?L?COM016F
B1:009AE0 500D              JNC      ?C0280?ZW_TRANSPORT
B1:009AE2 12A248            LCALL    ?L?COM0014
B1:009AE5 2409              ADD      A,#09H
B1:009AE7 128622            LCALL    ?L?COM0006
B1:009AEA 54F7              ANL      A,#0F7H
B1:009AEC 122072            LCALL    ?C?CSTPTR
B1:009AEF         ?C0280?ZW_TRANSPORT:
B1:009AEF 12A248            LCALL    ?L?COM0014
B1:009AF2 2409              ADD      A,#09H
B1:009AF4 128622            LCALL    ?L?COM0006
B1:009AF7 30E315            JNB      ACC.3,?C0283?ZW_TRANSPORT
B1:009AFA 12A248            LCALL    ?L?COM0014
B1:009AFD 240A              ADD      A,#0AH
B1:009AFF 128622            LCALL    ?L?COM0006
B1:009B02 12A242            LCALL    ?L?COM0011
B1:009B05 240B              ADD      A,#0BH
B1:009B07 128FE8            LCALL    ?L?COM0050
B1:009B0A 12A264            LCALL    ?L?COM0146
B1:009B0D 8002              SJMP     ?C0284?ZW_TRANSPORT
B1:009B0F         ?C0283?ZW_TRANSPORT:
B1:009B0F 7F00              MOV      R7,#00H
B1:009B11         ?C0284?ZW_TRANSPORT:
B1:009B11 12A246            LCALL    ?L?COM0013
B1:009B14 240A              ADD      A,#0AH
B1:009B16 128622            LCALL    ?L?COM0006
B1:009B19 12D98B            LCALL    ?L?COM01DE
B1:009B1C 12A248            LCALL    ?L?COM0014
B1:009B1F 12DB6B            LCALL    ?L?COM00D2
B1:009B22 EC                MOV      A,R4
B1:009B23 128FEA            LCALL    ?L?COM0051
B1:009B26 C003              PUSH     AR3
B1:009B28 C002              PUSH     AR2
B1:009B2A C001              PUSH     AR1
B1:009B2C 900A27            MOV      DPTR,#pRxFrame
B1:009B2F 128FD5            LCALL    ?L?COM0057
B1:009B32 F9                MOV      R1,A
B1:009B33 E4                CLR      A
B1:009B34 3A                ADDC     A,R2
B1:009B35 FA                MOV      R2,A
B1:009B36 1225DE            LCALL    ?C?PSTPTR
B1:009B39 12A248            LCALL    ?L?COM0014
B1:009B3C 2409              ADD      A,#09H
B1:009B3E 128622            LCALL    ?L?COM0006
B1:009B41 30E319            JNB      ACC.3,?C0285?ZW_TRANSPORT
B1:009B44 12A248            LCALL    ?L?COM0014
B1:009B47 240A              ADD      A,#0AH
B1:009B49 128622            LCALL    ?L?COM0006
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 250


B1:009B4C C4                SWAP     A
B1:009B4D 540F              ANL      A,#0FH
B1:009B4F FF                MOV      R7,A
B1:009B50 12A248            LCALL    ?L?COM0014
B1:009B53 240B              ADD      A,#0BH
B1:009B55 128FE8            LCALL    ?L?COM0050
B1:009B58 12A264            LCALL    ?L?COM0146
B1:009B5B 8002              SJMP     ?C0286?ZW_TRANSPORT
B1:009B5D         ?C0285?ZW_TRANSPORT:
B1:009B5D 7F00              MOV      R7,#00H
B1:009B5F         ?C0286?ZW_TRANSPORT:
B1:009B5F 12A248            LCALL    ?L?COM0014
B1:009B62 240A              ADD      A,#0AH
B1:009B64 128622            LCALL    ?L?COM0006
B1:009B67 C4                SWAP     A
B1:009B68 540F              ANL      A,#0FH
B1:009B6A FE                MOV      R6,A
B1:009B6B 12A248            LCALL    ?L?COM0014
B1:009B6E 2407              ADD      A,#07H
B1:009B70 128622            LCALL    ?L?COM0006
B1:009B73 24F4              ADD      A,#0F4H
B1:009B75 C3                CLR      C
B1:009B76 9E                SUBB     A,R6
B1:009B77 12C8D5            LCALL    ?L?COM01C0
B1:009B7A 1287E0            LCALL    ?L?COM002E
B1:009B7D 12A248            LCALL    ?L?COM0014
B1:009B80 2408              ADD      A,#08H
B1:009B82 128622            LCALL    ?L?COM0006
B1:009B85 12DA4B            LCALL    ?L?COM0163
B1:009B88 6002              JZ       $ + 4H
B1:009B8A A15F              AJMP     ?C0287?ZW_TRANSPORT
B1:009B8C 12A248            LCALL    ?L?COM0014
B1:009B8F 240A              ADD      A,#0AH
B1:009B91 128622            LCALL    ?L?COM0006
B1:009B94 540F              ANL      A,#0FH
B1:009B96 FF                MOV      R7,A
;---- Variable 'hopFirst4' assigned to Register 'R7' ----
B1:009B97 900A2E            MOV      DPTR,#hopFirst1
B1:009B9A E0                MOVX     A,@DPTR
B1:009B9B 6F                XRL      A,R7
B1:009B9C 6002              JZ       $ + 4H
B1:009B9E 81D3              AJMP     ?C0288?ZW_TRANSPORT
B1:009BA0 12A248            LCALL    ?L?COM0014
B1:009BA3 2405              ADD      A,#05H
B1:009BA5 128622            LCALL    ?L?COM0006
B1:009BA8 900A27            MOV      DPTR,#pRxFrame
B1:009BAB 30E60A            JNB      ACC.6,?C0289?ZW_TRANSPORT
B1:009BAE 127077            LCALL    ?L?COM00E7
B1:009BB1 128622            LCALL    ?L?COM0006
B1:009BB4 440D              ORL      A,#0DH
B1:009BB6 8008              SJMP     ?C0607?ZW_TRANSPORT
B1:009BB8         ?C0289?ZW_TRANSPORT:
B1:009BB8 127077            LCALL    ?L?COM00E7
B1:009BBB 128622            LCALL    ?L?COM0006
B1:009BBE 4409              ORL      A,#09H
B1:009BC0         
B1:009BC0 122072            LCALL    ?C?CSTPTR
B1:009BC3         ?C0290?ZW_TRANSPORT:
B1:009BC3 12A248            LCALL    ?L?COM0014
B1:009BC6 12DB87            LCALL    ?L?COM0262
B1:009BC9 7E00              MOV      R6,#00H
B1:009BCB 128FEC            LCALL    ?L?COM0052
B1:009BCE 12FF0A            LCALL    ?L?COM05CB
B1:009BD1 1287D2            LCALL    ?L?COM002B
B1:009BD4 900A27            MOV      DPTR,#pRxFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 251


B1:009BD7 127077            LCALL    ?L?COM00E7
B1:009BDA 128622            LCALL    ?L?COM0006
B1:009BDD 30E702            JNB      ACC.7,$ + 5H
B1:009BE0 C1E0              AJMP     ?C0307?ZW_TRANSPORT
B1:009BE2 12A248            LCALL    ?L?COM0014
B1:009BE5 2405              ADD      A,#05H
B1:009BE7 128622            LCALL    ?L?COM0006
B1:009BEA 20E702            JB       ACC.7,$ + 5H
B1:009BED C1E0              AJMP     ?C0307?ZW_TRANSPORT
B1:009BEF 12A248            LCALL    ?L?COM0014
B1:009BF2 2409              ADD      A,#09H
B1:009BF4 128622            LCALL    ?L?COM0006
B1:009BF7 30E319            JNB      ACC.3,?C0292?ZW_TRANSPORT
B1:009BFA 12A248            LCALL    ?L?COM0014
B1:009BFD 240A              ADD      A,#0AH
B1:009BFF 128622            LCALL    ?L?COM0006
B1:009C02 C4                SWAP     A
B1:009C03 540F              ANL      A,#0FH
B1:009C05 FF                MOV      R7,A
B1:009C06 12A248            LCALL    ?L?COM0014
B1:009C09 240B              ADD      A,#0BH
B1:009C0B 128FE8            LCALL    ?L?COM0050
B1:009C0E 12A264            LCALL    ?L?COM0146
B1:009C11 8002              SJMP     ?C0293?ZW_TRANSPORT
B1:009C13         ?C0292?ZW_TRANSPORT:
B1:009C13 7F00              MOV      R7,#00H
B1:009C15         ?C0293?ZW_TRANSPORT:
B1:009C15 12A246            LCALL    ?L?COM0013
B1:009C18 240A              ADD      A,#0AH
B1:009C1A 128622            LCALL    ?L?COM0006
B1:009C1D 12D98B            LCALL    ?L?COM01DE
B1:009C20 12A248            LCALL    ?L?COM0014
B1:009C23 12DB6B            LCALL    ?L?COM00D2
B1:009C26 EC                MOV      A,R4
B1:009C27 128FEA            LCALL    ?L?COM0051
B1:009C2A 121FB3            LCALL    ?C?CLDPTR
B1:009C2D D3                SETB     C
B1:009C2E 9401              SUBB     A,#01H
B1:009C30 4002              JC       $ + 4H
B1:009C32 C1E0              AJMP     ?C0307?ZW_TRANSPORT
B1:009C34 12A248            LCALL    ?L?COM0014
B1:009C37 2409              ADD      A,#09H
B1:009C39 128622            LCALL    ?L?COM0006
B1:009C3C 30E319            JNB      ACC.3,?C0294?ZW_TRANSPORT
B1:009C3F 12A248            LCALL    ?L?COM0014
B1:009C42 240A              ADD      A,#0AH
B1:009C44 128622            LCALL    ?L?COM0006
B1:009C47 C4                SWAP     A
B1:009C48 540F              ANL      A,#0FH
B1:009C4A FF                MOV      R7,A
B1:009C4B 12A248            LCALL    ?L?COM0014
B1:009C4E 240B              ADD      A,#0BH
B1:009C50 128FE8            LCALL    ?L?COM0050
B1:009C53 12A264            LCALL    ?L?COM0146
B1:009C56 8002              SJMP     ?C0295?ZW_TRANSPORT
B1:009C58         ?C0294?ZW_TRANSPORT:
B1:009C58 7F00              MOV      R7,#00H
B1:009C5A         ?C0295?ZW_TRANSPORT:
B1:009C5A 12A246            LCALL    ?L?COM0013
B1:009C5D 240A              ADD      A,#0AH
B1:009C5F 128622            LCALL    ?L?COM0006
B1:009C62 12D98B            LCALL    ?L?COM01DE
B1:009C65 12A248            LCALL    ?L?COM0014
B1:009C68 12DB6B            LCALL    ?L?COM00D2
B1:009C6B EC                MOV      A,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 252


B1:009C6C 128FEA            LCALL    ?L?COM0051
B1:009C6F E9                MOV      A,R1
B1:009C70 2401              ADD      A,#01H
B1:009C72 128622            LCALL    ?L?COM0006
B1:009C75 6403              XRL      A,#03H
B1:009C77 6002              JZ       $ + 4H
B1:009C79 C1E0              AJMP     ?C0307?ZW_TRANSPORT
B1:009C7B E550              MOV      A,bNetworkWideInclusion
B1:009C7D 6402              XRL      A,#02H
B1:009C7F 6045              JZ       ?C0296?ZW_TRANSPORT
B1:009C81 12A248            LCALL    ?L?COM0014
B1:009C84 2409              ADD      A,#09H
B1:009C86 128622            LCALL    ?L?COM0006
B1:009C89 30E319            JNB      ACC.3,?C0297?ZW_TRANSPORT
B1:009C8C 12A248            LCALL    ?L?COM0014
B1:009C8F 240A              ADD      A,#0AH
B1:009C91 128622            LCALL    ?L?COM0006
B1:009C94 C4                SWAP     A
B1:009C95 540F              ANL      A,#0FH
B1:009C97 FF                MOV      R7,A
B1:009C98 12A248            LCALL    ?L?COM0014
B1:009C9B 240B              ADD      A,#0BH
B1:009C9D 128FE8            LCALL    ?L?COM0050
B1:009CA0 12A264            LCALL    ?L?COM0146
B1:009CA3 8002              SJMP     ?C0298?ZW_TRANSPORT
B1:009CA5         ?C0297?ZW_TRANSPORT:
B1:009CA5 7F00              MOV      R7,#00H
B1:009CA7         ?C0298?ZW_TRANSPORT:
B1:009CA7 12A246            LCALL    ?L?COM0013
B1:009CAA 240A              ADD      A,#0AH
B1:009CAC 128622            LCALL    ?L?COM0006
B1:009CAF 12D98B            LCALL    ?L?COM01DE
B1:009CB2 12A248            LCALL    ?L?COM0014
B1:009CB5 12DB6B            LCALL    ?L?COM00D2
B1:009CB8 EC                MOV      A,R4
B1:009CB9 128FEA            LCALL    ?L?COM0051
B1:009CBC E9                MOV      A,R1
B1:009CBD 2403              ADD      A,#03H
B1:009CBF 126145            LCALL    ?L?COM0045
B1:009CC2 7B01              MOV      R3,#01H
B1:009CC4 8006              SJMP     ?C0608?ZW_TRANSPORT
B1:009CC6         ?C0296?ZW_TRANSPORT:
B1:009CC6 12FED6            LCALL    ?L?COM050C
B1:009CC9 126149            LCALL    ?L?COM0047
B1:009CCC         
B1:009CCC 12FEE6            LCALL    ?L?COM0565
B1:009CCF         ?C0299?ZW_TRANSPORT:
B1:009CCF D209              SETB     inclusionHomeIDActive
B1:009CD1 C1E0              AJMP     ?C0307?ZW_TRANSPORT
B1:009CD3         ?C0288?ZW_TRANSPORT:
B1:009CD3 12A248            LCALL    ?L?COM0014
B1:009CD6 240A              ADD      A,#0AH
B1:009CD8 128622            LCALL    ?L?COM0006
B1:009CDB 540F              ANL      A,#0FH
B1:009CDD 640F              XRL      A,#0FH
B1:009CDF 6002              JZ       $ + 4H
B1:009CE1 C1E0              AJMP     ?C0307?ZW_TRANSPORT
B1:009CE3 12A248            LCALL    ?L?COM0014
B1:009CE6 2405              ADD      A,#05H
B1:009CE8 128622            LCALL    ?L?COM0006
B1:009CEB 30E60E            JNB      ACC.6,?C0302?ZW_TRANSPORT
B1:009CEE 900A27            MOV      DPTR,#pRxFrame
B1:009CF1 127077            LCALL    ?L?COM00E7
B1:009CF4 128622            LCALL    ?L?COM0006
B1:009CF7 4404              ORL      A,#04H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 253


B1:009CF9 122072            LCALL    ?C?CSTPTR
B1:009CFC         ?C0302?ZW_TRANSPORT:
B1:009CFC 12D9DD            LCALL    CheckSeqNo
B1:009CFF 5022              JNC      ?C0303?ZW_TRANSPORT
B1:009D01 12A248            LCALL    ?L?COM0014
B1:009D04 240A              ADD      A,#0AH
B1:009D06 128622            LCALL    ?L?COM0006
B1:009D09 C4                SWAP     A
B1:009D0A 540F              ANL      A,#0FH
B1:009D0C FF                MOV      R7,A
B1:009D0D 12DBB0            LCALL    ?L?COM0520
B1:009D10 12BE89            LCALL    _RouteMatchesActive
B1:009D13 500E              JNC      ?C0303?ZW_TRANSPORT
B1:009D15 900A27            MOV      DPTR,#pRxFrame
B1:009D18 127077            LCALL    ?L?COM00E7
B1:009D1B 128622            LCALL    ?L?COM0006
B1:009D1E 4401              ORL      A,#01H
B1:009D20 122072            LCALL    ?C?CSTPTR
B1:009D23         ?C0303?ZW_TRANSPORT:
B1:009D23 12A248            LCALL    ?L?COM0014
B1:009D26 2409              ADD      A,#09H
B1:009D28 128622            LCALL    ?L?COM0006
B1:009D2B FF                MOV      R7,A
B1:009D2C 30E10D            JNB      ACC.1,?C0304?ZW_TRANSPORT
B1:009D2F 900A27            MOV      DPTR,#pRxFrame
B1:009D32 127077            LCALL    ?L?COM00E7
B1:009D35 128622            LCALL    ?L?COM0006
B1:009D38 4420              ORL      A,#020H
B1:009D3A 800F              SJMP     ?C0609?ZW_TRANSPORT
B1:009D3C         ?C0304?ZW_TRANSPORT:
B1:009D3C EF                MOV      A,R7
B1:009D3D 30E20E            JNB      ACC.2,?C0305?ZW_TRANSPORT
B1:009D40 900A27            MOV      DPTR,#pRxFrame
B1:009D43 127077            LCALL    ?L?COM00E7
B1:009D46 128622            LCALL    ?L?COM0006
B1:009D49 4440              ORL      A,#040H
B1:009D4B         
B1:009D4B 122072            LCALL    ?C?CSTPTR
B1:009D4E         ?C0305?ZW_TRANSPORT:
B1:009D4E 12A248            LCALL    ?L?COM0014
B1:009D51 240B              ADD      A,#0BH
B1:009D53 128622            LCALL    ?L?COM0006
B1:009D56 900A27            MOV      DPTR,#pRxFrame
B1:009D59 12C7C6            LCALL    ?L?COM0185
B1:009D5C EF                MOV      A,R7
B1:009D5D C16E              AJMP     ?C0612?ZW_TRANSPORT
B1:009D5F         ?C0287?ZW_TRANSPORT:
B1:009D5F 12A248            LCALL    ?L?COM0014
B1:009D62 240A              ADD      A,#0AH
B1:009D64 128622            LCALL    ?L?COM0006
B1:009D67 FF                MOV      R7,A
B1:009D68 540F              ANL      A,#0FH
;---- Variable 'hopFirst2' assigned to Register 'R5' ----
B1:009D6A FD                MOV      R5,A
B1:009D6B EF                MOV      A,R7
B1:009D6C C4                SWAP     A
B1:009D6D 540F              ANL      A,#0FH
;---- Variable 'hopFirst3' assigned to Register 'R4' ----
B1:009D6F FC                MOV      R4,A
B1:009D70 ED                MOV      A,R5
B1:009D71 C3                CLR      C
B1:009D72 9C                SUBB     A,R4
B1:009D73 4002              JC       $ + 4H
B1:009D75 C173              AJMP     ?C0308?ZW_TRANSPORT
B1:009D77 12A248            LCALL    ?L?COM0014
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 254


B1:009D7A 12DA3A            LCALL    ?L?COM0162
B1:009D7D 6002              JZ       $ + 4H
B1:009D7F C173              AJMP     ?C0308?ZW_TRANSPORT
B1:009D81 12A248            LCALL    ?L?COM0014
B1:009D84 2409              ADD      A,#09H
B1:009D86 128622            LCALL    ?L?COM0006
B1:009D89 30E067            JNB      ACC.0,?C0309?ZW_TRANSPORT
B1:009D8C 12D9DD            LCALL    CheckSeqNo
B1:009D8F 500F              JNC      ?C0310?ZW_TRANSPORT
B1:009D91 900A27            MOV      DPTR,#pRxFrame
B1:009D94 127077            LCALL    ?L?COM00E7
B1:009D97 128622            LCALL    ?L?COM0006
B1:009D9A 12DABE            LCALL    ?L?COM0384
B1:009D9D 7405              MOV      A,#05H
B1:009D9F F0                MOVX     @DPTR,A
B1:009DA0         ?C0310?ZW_TRANSPORT:
B1:009DA0 EC                MOV      A,R4
B1:009DA1 14                DEC      A
B1:009DA2 900A31            MOV      DPTR,#fr
B1:009DA5 B50505            CJNE     A,AR5,?C0311?ZW_TRANSPORT
B1:009DA8 129751            LCALL    ?L?COM0144
B1:009DAB 800B              SJMP     ?C0604?ZW_TRANSPORT
B1:009DAD         ?C0311?ZW_TRANSPORT:
B1:009DAD 12DB83            LCALL    ?L?COM0261
B1:009DB0 ED                MOV      A,R5
B1:009DB1 12C59E            LCALL    ?L?COM01B2
B1:009DB4 FA                MOV      R2,A
B1:009DB5 E9                MOV      A,R1
B1:009DB6 2401              ADD      A,#01H
B1:009DB8         
B1:009DB8 128622            LCALL    ?L?COM0006
B1:009DBB 1287D6            LCALL    ?L?COM002C
B1:009DBE         ?C0312?ZW_TRANSPORT:
B1:009DBE ED                MOV      A,R5
B1:009DBF 6002              JZ       $ + 4H
B1:009DC1 C14E              AJMP     ?C0314?ZW_TRANSPORT
B1:009DC3 12A248            LCALL    ?L?COM0014
B1:009DC6 2409              ADD      A,#09H
B1:009DC8 128622            LCALL    ?L?COM0006
B1:009DCB 20E302            JB       ACC.3,$ + 5H
B1:009DCE C14E              AJMP     ?C0314?ZW_TRANSPORT
B1:009DD0 12A248            LCALL    ?L?COM0014
B1:009DD3 240A              ADD      A,#0AH
B1:009DD5 128622            LCALL    ?L?COM0006
B1:009DD8 12A242            LCALL    ?L?COM0011
B1:009DDB 240B              ADD      A,#0BH
B1:009DDD 128FE8            LCALL    ?L?COM0050
B1:009DE0 121FB3            LCALL    ?C?CLDPTR
B1:009DE3 540F              ANL      A,#0FH
B1:009DE5 7067              JNZ      ?C0314?ZW_TRANSPORT
B1:009DE7 E9                MOV      A,R1
B1:009DE8 2401              ADD      A,#01H
B1:009DEA 128622            LCALL    ?L?COM0006
B1:009DED 5418              ANL      A,#018H
B1:009DEF 605D              JZ       ?C0314?ZW_TRANSPORT
B1:009DF1 804D              SJMP     ?C0611?ZW_TRANSPORT
B1:009DF3         ?C0309?ZW_TRANSPORT:
B1:009DF3 ED                MOV      A,R5
B1:009DF4 900A31            MOV      DPTR,#fr
B1:009DF7 7008              JNZ      ?C0315?ZW_TRANSPORT
B1:009DF9 129751            LCALL    ?L?COM0144
B1:009DFC F9                MOV      R1,A
B1:009DFD E4                CLR      A
B1:009DFE 3A                ADDC     A,R2
B1:009DFF 800B              SJMP     ?C0605?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 255


B1:009E01         ?C0315?ZW_TRANSPORT:
B1:009E01 12DB83            LCALL    ?L?COM0261
B1:009E04 ED                MOV      A,R5
B1:009E05 12C59E            LCALL    ?L?COM01B2
B1:009E08 FA                MOV      R2,A
B1:009E09 12FF0A            LCALL    ?L?COM05CB
B1:009E0C         
B1:009E0C 1287D2            LCALL    ?L?COM002B
B1:009E0F         ?C0316?ZW_TRANSPORT:
B1:009E0F EC                MOV      A,R4
B1:009E10 14                DEC      A
B1:009E11 6D                XRL      A,R5
B1:009E12 703A              JNZ      ?C0314?ZW_TRANSPORT
B1:009E14 12A248            LCALL    ?L?COM0014
B1:009E17 2409              ADD      A,#09H
B1:009E19 128622            LCALL    ?L?COM0006
B1:009E1C 30E32F            JNB      ACC.3,?C0314?ZW_TRANSPORT
B1:009E1F 12A248            LCALL    ?L?COM0014
B1:009E22 240A              ADD      A,#0AH
B1:009E24 128622            LCALL    ?L?COM0006
B1:009E27 12A242            LCALL    ?L?COM0011
B1:009E2A 240B              ADD      A,#0BH
B1:009E2C 128FE8            LCALL    ?L?COM0050
B1:009E2F 121FB3            LCALL    ?C?CLDPTR
B1:009E32 540F              ANL      A,#0FH
B1:009E34 7018              JNZ      ?C0314?ZW_TRANSPORT
B1:009E36 E9                MOV      A,R1
B1:009E37 2401              ADD      A,#01H
B1:009E39 128622            LCALL    ?L?COM0006
B1:009E3C 5460              ANL      A,#060H
B1:009E3E 600E              JZ       ?C0314?ZW_TRANSPORT
B1:009E40         
B1:009E40 900A27            MOV      DPTR,#pRxFrame
B1:009E43 127077            LCALL    ?L?COM00E7
B1:009E46 128622            LCALL    ?L?COM0006
B1:009E49 4404              ORL      A,#04H
B1:009E4B 122072            LCALL    ?C?CSTPTR
B1:009E4E         ?C0314?ZW_TRANSPORT:
B1:009E4E 12A248            LCALL    ?L?COM0014
B1:009E51 2405              ADD      A,#05H
B1:009E53 128622            LCALL    ?L?COM0006
B1:009E56 900A27            MOV      DPTR,#pRxFrame
B1:009E59 30E60A            JNB      ACC.6,?C0318?ZW_TRANSPORT
B1:009E5C 127077            LCALL    ?L?COM00E7
B1:009E5F 128622            LCALL    ?L?COM0006
B1:009E62 4414              ORL      A,#014H
B1:009E64         
B1:009E64 8008              SJMP     ?C0612?ZW_TRANSPORT
B1:009E66         ?C0318?ZW_TRANSPORT:
B1:009E66 127077            LCALL    ?L?COM00E7
B1:009E69 128622            LCALL    ?L?COM0006
B1:009E6C 4410              ORL      A,#010H
B1:009E6E         
B1:009E6E 122072            LCALL    ?C?CSTPTR
B1:009E71 806D              SJMP     ?C0307?ZW_TRANSPORT
B1:009E73         ?C0308?ZW_TRANSPORT:
B1:009E73 12A248            LCALL    ?L?COM0014
B1:009E76 240A              ADD      A,#0AH
B1:009E78 128622            LCALL    ?L?COM0006
B1:009E7B 540F              ANL      A,#0FH
;---- Variable 'hopFirst' assigned to Register 'R5' ----
B1:009E7D FD                MOV      R5,A
B1:009E7E 12D9DD            LCALL    CheckSeqNo
B1:009E81 505D              JNC      ?C0307?ZW_TRANSPORT
B1:009E83 12A248            LCALL    ?L?COM0014
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 256


B1:009E86 2409              ADD      A,#09H
B1:009E88 128622            LCALL    ?L?COM0006
B1:009E8B 30E021            JNB      ACC.0,?C0322?ZW_TRANSPORT
B1:009E8E ED                MOV      A,R5
B1:009E8F 2402              ADD      A,#02H
B1:009E91 540F              ANL      A,#0FH
B1:009E93 FD                MOV      R5,A
B1:009E94 12A248            LCALL    ?L?COM0014
B1:009E97 240A              ADD      A,#0AH
B1:009E99 128622            LCALL    ?L?COM0006
B1:009E9C C4                SWAP     A
B1:009E9D 540F              ANL      A,#0FH
B1:009E9F FF                MOV      R7,A
B1:009EA0 ED                MOV      A,R5
B1:009EA1 C3                CLR      C
B1:009EA2 9F                SUBB     A,R7
B1:009EA3 503B              JNC      ?C0307?ZW_TRANSPORT
B1:009EA5 12A248            LCALL    ?L?COM0014
B1:009EA8 12DA3A            LCALL    ?L?COM0162
B1:009EAB 7033              JNZ      ?C0307?ZW_TRANSPORT
B1:009EAD 8022              SJMP     ?C0613?ZW_TRANSPORT
B1:009EAF         ?C0322?ZW_TRANSPORT:
B1:009EAF ED                MOV      A,R5
B1:009EB0 C3                CLR      C
B1:009EB1 9402              SUBB     A,#02H
B1:009EB3 402B              JC       ?C0307?ZW_TRANSPORT
B1:009EB5 12A248            LCALL    ?L?COM0014
B1:009EB8 12DB87            LCALL    ?L?COM0262
B1:009EBB ED                MOV      A,R5
B1:009EBC 24FE              ADD      A,#0FEH
B1:009EBE FF                MOV      R7,A
B1:009EBF E4                CLR      A
B1:009EC0 34FF              ADDC     A,#0FFH
B1:009EC2 FE                MOV      R6,A
B1:009EC3 1271F1            LCALL    ?L?COM0383
B1:009EC6 121FB3            LCALL    ?C?CLDPTR
B1:009EC9 FF                MOV      R7,A
B1:009ECA 901221            MOV      DPTR,#nodeID
B1:009ECD E0                MOVX     A,@DPTR
B1:009ECE B5070F            CJNE     A,AR7,?C0307?ZW_TRANSPORT
B1:009ED1         
B1:009ED1 900A27            MOV      DPTR,#pRxFrame
B1:009ED4 127077            LCALL    ?L?COM00E7
B1:009ED7 128622            LCALL    ?L?COM0006
B1:009EDA 12DABE            LCALL    ?L?COM0384
B1:009EDD 7401              MOV      A,#01H
B1:009EDF F0                MOVX     @DPTR,A
B1:009EE0         ?C0307?ZW_TRANSPORT:
B1:009EE0 12A248            LCALL    ?L?COM0014
B1:009EE3 2404              ADD      A,#04H
B1:009EE5 128622            LCALL    ?L?COM0006
B1:009EE8 12DA4B            LCALL    ?L?COM0163
B1:009EEB 6033              JZ       ?C0328?ZW_TRANSPORT
B1:009EED 128538            LCALL    ?L?COM0016
B1:009EF0 4A                ORL      A,R2
B1:009EF1 7003              JNZ      $ + 5H
B1:009EF3 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009EF6 128538            LCALL    ?L?COM0016
B1:009EF9 24B2              ADD      A,#0B2H
B1:009EFB 12DBA6            LCALL    ?L?COM012D
B1:009EFE 12DBB0            LCALL    ?L?COM0520
B1:009F01 12DACB            LCALL    ?L?COM0258
B1:009F04 6003              JZ       $ + 5H
B1:009F06 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F09 128538            LCALL    ?L?COM0016
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 257


B1:009F0C 24B6              ADD      A,#0B6H
B1:009F0E 128622            LCALL    ?L?COM0006
B1:009F11 FF                MOV      R7,A
B1:009F12 12A248            LCALL    ?L?COM0014
B1:009F15 2404              ADD      A,#04H
B1:009F17 128622            LCALL    ?L?COM0006
B1:009F1A 6F                XRL      A,R7
B1:009F1B 6003              JZ       $ + 5H
B1:009F1D 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F20         ?C0328?ZW_TRANSPORT:
B1:009F20 12D9DD            LCALL    CheckSeqNo
B1:009F23 4003              JC       $ + 5H
B1:009F25 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F28 12A248            LCALL    ?L?COM0014
B1:009F2B 240A              ADD      A,#0AH
B1:009F2D 128622            LCALL    ?L?COM0006
B1:009F30 540F              ANL      A,#0FH
;---- Variable 'hopNext' assigned to Register 'R7' ----
B1:009F32 128537            LCALL    ?L?COM0015
B1:009F35 4A                ORL      A,R2
B1:009F36 7003              JNZ      $ + 5H
B1:009F38 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F3B E9                MOV      A,R1
B1:009F3C 24BA              ADD      A,#0BAH
B1:009F3E 128622            LCALL    ?L?COM0006
B1:009F41 FE                MOV      R6,A
B1:009F42 12A248            LCALL    ?L?COM0014
B1:009F45 2408              ADD      A,#08H
B1:009F47 128622            LCALL    ?L?COM0006
B1:009F4A 6E                XRL      A,R6
B1:009F4B 6003              JZ       $ + 5H
B1:009F4D 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F50 12A248            LCALL    ?L?COM0014
B1:009F53 2409              ADD      A,#09H
B1:009F55 128622            LCALL    ?L?COM0006
B1:009F58 FE                MOV      R6,A
B1:009F59 30E03C            JNB      ACC.0,?C0331?ZW_TRANSPORT
B1:009F5C 128538            LCALL    ?L?COM0016
B1:009F5F 24BB              ADD      A,#0BBH
B1:009F61 128622            LCALL    ?L?COM0006
B1:009F64 5406              ANL      A,#06H
B1:009F66 FD                MOV      R5,A
B1:009F67 EE                MOV      A,R6
B1:009F68 5406              ANL      A,#06H
B1:009F6A 6D                XRL      A,R5
B1:009F6B 6003              JZ       $ + 5H
B1:009F6D 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F70 12A248            LCALL    ?L?COM0014
B1:009F73 240A              ADD      A,#0AH
B1:009F75 128622            LCALL    ?L?COM0006
B1:009F78 FE                MOV      R6,A
B1:009F79 C4                SWAP     A
B1:009F7A 540F              ANL      A,#0FH
B1:009F7C 24FE              ADD      A,#0FEH
B1:009F7E 540F              ANL      A,#0FH
B1:009F80 6F                XRL      A,R7
B1:009F81 6003              JZ       $ + 5H
B1:009F83 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009F86 900A27            MOV      DPTR,#pRxFrame
B1:009F89 127077            LCALL    ?L?COM00E7
B1:009F8C 128622            LCALL    ?L?COM0006
B1:009F8F 12DABE            LCALL    ?L?COM0384
B1:009F92 7403              MOV      A,#03H
B1:009F94 F0                MOVX     @DPTR,A
B1:009F95 02A117            LJMP     ?C0257?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 258


B1:009F98         ?C0331?ZW_TRANSPORT:
B1:009F98 EF                MOV      A,R7
B1:009F99 6401              XRL      A,#01H
B1:009F9B 6003              JZ       $ + 5H
B1:009F9D 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009FA0 900A27            MOV      DPTR,#pRxFrame
B1:009FA3 127077            LCALL    ?L?COM00E7
B1:009FA6 128622            LCALL    ?L?COM0006
B1:009FA9 12DABE            LCALL    ?L?COM0384
B1:009FAC 7401              MOV      A,#01H
B1:009FAE F0                MOVX     @DPTR,A
B1:009FAF 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009FB2         ?C0277?ZW_TRANSPORT:
B1:009FB2 12A248            LCALL    ?L?COM0014
B1:009FB5 2408              ADD      A,#08H
B1:009FB7 128622            LCALL    ?L?COM0006
B1:009FBA 12DA4B            LCALL    ?L?COM0163
B1:009FBD 6007              JZ       ?C0338?ZW_TRANSPORT
B1:009FBF EF                MOV      A,R7
B1:009FC0 F4                CPL      A
B1:009FC1 6003              JZ       $ + 5H
B1:009FC3 02A117            LJMP     ?C0257?ZW_TRANSPORT
B1:009FC6         ?C0338?ZW_TRANSPORT:
B1:009FC6 900A27            MOV      DPTR,#pRxFrame
B1:009FC9 127077            LCALL    ?L?COM00E7
B1:009FCC 128622            LCALL    ?L?COM0006
B1:009FCF 4401              ORL      A,#01H
B1:009FD1 122072            LCALL    ?C?CSTPTR
B1:009FD4 12A248            LCALL    ?L?COM0014
B1:009FD7 2404              ADD      A,#04H
B1:009FD9 128622            LCALL    ?L?COM0006
B1:009FDC 1287D6            LCALL    ?L?COM002C
B1:009FDF 12A248            LCALL    ?L?COM0014
B1:009FE2 12A250            LCALL    ?L?COM023E
B1:009FE5 C003              PUSH     AR3
B1:009FE7 C002              PUSH     AR2
B1:009FE9 C001              PUSH     AR1
B1:009FEB 900A27            MOV      DPTR,#pRxFrame
B1:009FEE 128FD5            LCALL    ?L?COM0057
B1:009FF1 F9                MOV      R1,A
B1:009FF2 E4                CLR      A
B1:009FF3 3A                ADDC     A,R2
B1:009FF4 FA                MOV      R2,A
B1:009FF5 1225DE            LCALL    ?C?PSTPTR
B1:009FF8 12A248            LCALL    ?L?COM0014
B1:009FFB 2407              ADD      A,#07H
B1:009FFD 128622            LCALL    ?L?COM0006
B1:00A000 24F6              ADD      A,#0F6H
B1:00A002 12C8D7            LCALL    ?L?COM01C1
B1:00A005 1287E0            LCALL    ?L?COM002E
B1:00A008 12A248            LCALL    ?L?COM0014
B1:00A00B 2405              ADD      A,#05H
B1:00A00D 128622            LCALL    ?L?COM0006
B1:00A010 20E602            JB       ACC.6,$ + 5H
B1:00A013 2117              AJMP     ?C0257?ZW_TRANSPORT
B1:00A015 900A27            MOV      DPTR,#pRxFrame
B1:00A018 127077            LCALL    ?L?COM00E7
B1:00A01B 128622            LCALL    ?L?COM0006
B1:00A01E 4404              ORL      A,#04H
B1:00A020 01EC              AJMP     ?C0615?ZW_TRANSPORT
B1:00A022         ?C0340?ZW_TRANSPORT:
B1:00A022 5148              ACALL    ?L?COM0014
B1:00A024 2408              ADD      A,#08H
B1:00A026 128622            LCALL    ?L?COM0006
B1:00A029 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 259


B1:00A02A 54E0              ANL      A,#0E0H
B1:00A02C FD                MOV      R5,A
B1:00A02D 901221            MOV      DPTR,#nodeID
B1:00A030 E0                MOVX     A,@DPTR
B1:00A031 D3                SETB     C
B1:00A032 9D                SUBB     A,R5
B1:00A033 5002              JNC      $ + 4H
B1:00A035 2117              AJMP     ?C0257?ZW_TRANSPORT
B1:00A037 EF                MOV      A,R7
B1:00A038 541F              ANL      A,#01FH
B1:00A03A 75F008            MOV      B,#08H
B1:00A03D A4                MUL      AB
B1:00A03E 2D                ADD      A,R5
B1:00A03F 127401            LCALL    ?L?COM05F4
B1:00A042 E0                MOVX     A,@DPTR
B1:00A043 D3                SETB     C
B1:00A044 12556A            LCALL    ?L?COM016F
B1:00A047 4002              JC       $ + 4H
B1:00A049 2117              AJMP     ?C0257?ZW_TRANSPORT
B1:00A04B 5148              ACALL    ?L?COM0014
B1:00A04D 2408              ADD      A,#08H
B1:00A04F 128622            LCALL    ?L?COM0006
B1:00A052 54E0              ANL      A,#0E0H
B1:00A054 FF                MOV      R7,A
B1:00A055 901221            MOV      DPTR,#nodeID
B1:00A058 E0                MOVX     A,@DPTR
B1:00A059 C3                CLR      C
B1:00A05A 9F                SUBB     A,R7
B1:00A05B 14                DEC      A
B1:00A05C FF                MOV      R7,A
;---- Variable 'bBit' assigned to Register 'R7' ----
B1:00A05D 5148              ACALL    ?L?COM0014
B1:00A05F 5150              ACALL    ?L?COM023E
B1:00A061 EF                MOV      A,R7
B1:00A062 13                RRC      A
B1:00A063 13                RRC      A
B1:00A064 13                RRC      A
B1:00A065 541F              ANL      A,#01FH
B1:00A067 29                ADD      A,R1
B1:00A068 12E77F            LCALL    ?L?COM039B
B1:00A06B 12FEC1            LCALL    ?L?COM04EB
B1:00A06E 8002              SJMP     ?C0574?ZW_TRANSPORT
B1:00A070         ?C0573?ZW_TRANSPORT:
B1:00A070 C3                CLR      C
B1:00A071 33                RLC      A
B1:00A072         ?C0574?ZW_TRANSPORT:
B1:00A072 D8FC              DJNZ     R0,?C0573?ZW_TRANSPORT
B1:00A074 5E                ANL      A,R6
B1:00A075 7002              JNZ      $ + 4H
B1:00A077 2117              AJMP     ?C0257?ZW_TRANSPORT
B1:00A079 900A27            MOV      DPTR,#pRxFrame
B1:00A07C 127077            LCALL    ?L?COM00E7
B1:00A07F 128622            LCALL    ?L?COM0006
B1:00A082 4401              ORL      A,#01H
B1:00A084 122072            LCALL    ?C?CSTPTR
B1:00A087 5148              ACALL    ?L?COM0014
B1:00A089 2408              ADD      A,#08H
B1:00A08B 128622            LCALL    ?L?COM0006
B1:00A08E 541F              ANL      A,#01FH
B1:00A090 5145              ACALL    ?L?COM0012
B1:00A092 2409              ADD      A,#09H
B1:00A094 128FE8            LCALL    ?L?COM0050
B1:00A097 C003              PUSH     AR3
B1:00A099 C002              PUSH     AR2
B1:00A09B C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 260


B1:00A09D 900A27            MOV      DPTR,#pRxFrame
B1:00A0A0 128FD5            LCALL    ?L?COM0057
B1:00A0A3 F9                MOV      R1,A
B1:00A0A4 E4                CLR      A
B1:00A0A5 3A                ADDC     A,R2
B1:00A0A6 FA                MOV      R2,A
B1:00A0A7 1225DE            LCALL    ?C?PSTPTR
B1:00A0AA 5148              ACALL    ?L?COM0014
B1:00A0AC 2408              ADD      A,#08H
B1:00A0AE 128622            LCALL    ?L?COM0006
B1:00A0B1 541F              ANL      A,#01FH
B1:00A0B3 FF                MOV      R7,A
B1:00A0B4 5148              ACALL    ?L?COM0014
B1:00A0B6 2407              ADD      A,#07H
B1:00A0B8 128622            LCALL    ?L?COM0006
B1:00A0BB 24F6              ADD      A,#0F6H
B1:00A0BD 12C8D5            LCALL    ?L?COM01C0
B1:00A0C0 F9                MOV      R1,A
B1:00A0C1 E4                CLR      A
B1:00A0C2 3A                ADDC     A,R2
B1:00A0C3 FA                MOV      R2,A
B1:00A0C4 EF                MOV      A,R7
B1:00A0C5         
B1:00A0C5 8025              SJMP     ?C0615?ZW_TRANSPORT
B1:00A0C7         ?C0343?ZW_TRANSPORT:
B1:00A0C7 12DA07            LCALL    ?L?COM062F
B1:00A0CA 6009              JZ       ?C0345?ZW_TRANSPORT
B1:00A0CC 900774            MOV      DPTR,#currentSeqNoToMatch
B1:00A0CF E0                MOVX     A,@DPTR
B1:00A0D0 54BF              ANL      A,#0BFH
B1:00A0D2 6F                XRL      A,R7
B1:00A0D3 7042              JNZ      ?C0257?ZW_TRANSPORT
B1:00A0D5         ?C0345?ZW_TRANSPORT:
B1:00A0D5 5148              ACALL    ?L?COM0014
B1:00A0D7 2408              ADD      A,#08H
B1:00A0D9 128622            LCALL    ?L?COM0006
B1:00A0DC 12DA4B            LCALL    ?L?COM0163
B1:00A0DF 7036              JNZ      ?C0257?ZW_TRANSPORT
B1:00A0E1 900A27            MOV      DPTR,#pRxFrame
B1:00A0E4 127077            LCALL    ?L?COM00E7
B1:00A0E7 128622            LCALL    ?L?COM0006
B1:00A0EA 4403              ORL      A,#03H
B1:00A0EC         
B1:00A0EC 122072            LCALL    ?C?CSTPTR
B1:00A0EF 8026              SJMP     ?C0257?ZW_TRANSPORT
B1:00A0F1         ?C0347?ZW_TRANSPORT:
B1:00A0F1 90086F            MOV      DPTR,#myFrame
B1:00A0F4 E0                MOVX     A,@DPTR
B1:00A0F5 FF                MOV      R7,A
B1:00A0F6 C007              PUSH     AR7
B1:00A0F8 900A2A            MOV      DPTR,#pRssiArray
B1:00A0FB 122589            LCALL    ?C?PLDXDATA
B1:00A0FE 900A7E            MOV      DPTR,#?_IsMyExploreFrame?BYTE+03H
B1:00A101 1225A9            LCALL    ?C?PSTXDATA
B1:00A104 900A27            MOV      DPTR,#pRxFrame
B1:00A107 122589            LCALL    ?C?PLDXDATA
B1:00A10A 121BC4            LCALL    ?INTERBANK_TABLE?_IsMyExploreFrame
B1:00A10D E4                CLR      A
B1:00A10E 33                RLC      A
B1:00A10F FE                MOV      R6,A
B1:00A110 D0E0              POP      ACC
B1:00A112 4E                ORL      A,R6
B1:00A113 90086F            MOV      DPTR,#myFrame
B1:00A116 F0                MOVX     @DPTR,A
B1:00A117         ?C0257?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 261


B1:00A117 5148              ACALL    ?L?COM0014
B1:00A119 2405              ADD      A,#05H
B1:00A11B 128622            LCALL    ?L?COM0006
B1:00A11E FF                MOV      R7,A
B1:00A11F 540F              ANL      A,#0FH
B1:00A121 6401              XRL      A,#01H
B1:00A123 6002              JZ       $ + 4H
B1:00A125 412E              AJMP     ?C0348?ZW_TRANSPORT
B1:00A127 EF                MOV      A,R7
B1:00A128 30E76E            JNB      ACC.7,?C0349?ZW_TRANSPORT
B1:00A12B 5148              ACALL    ?L?COM0014
B1:00A12D 2409              ADD      A,#09H
B1:00A12F 128622            LCALL    ?L?COM0006
B1:00A132 30E312            JNB      ACC.3,?C0350?ZW_TRANSPORT
B1:00A135 5148              ACALL    ?L?COM0014
B1:00A137 240A              ADD      A,#0AH
B1:00A139 128622            LCALL    ?L?COM0006
B1:00A13C 5142              ACALL    ?L?COM0011
B1:00A13E 240B              ADD      A,#0BH
B1:00A140 128FE8            LCALL    ?L?COM0050
B1:00A143 5164              ACALL    ?L?COM0146
B1:00A145 8002              SJMP     ?C0351?ZW_TRANSPORT
B1:00A147         ?C0350?ZW_TRANSPORT:
B1:00A147 7F00              MOV      R7,#00H
B1:00A149         ?C0351?ZW_TRANSPORT:
B1:00A149 5146              ACALL    ?L?COM0013
B1:00A14B 240A              ADD      A,#0AH
B1:00A14D 128622            LCALL    ?L?COM0006
B1:00A150 12D98B            LCALL    ?L?COM01DE
B1:00A153 5148              ACALL    ?L?COM0014
B1:00A155 12DB6B            LCALL    ?L?COM00D2
B1:00A158 EC                MOV      A,R4
B1:00A159 128FEA            LCALL    ?L?COM0051
B1:00A15C 121FB3            LCALL    ?C?CLDPTR
B1:00A15F 900A30            MOV      DPTR,#btmpCmdClass
B1:00A162 127258            LCALL    ?L?COM0405
B1:00A165 2409              ADD      A,#09H
B1:00A167 128622            LCALL    ?L?COM0006
B1:00A16A 30E316            JNB      ACC.3,?C0352?ZW_TRANSPORT
B1:00A16D 5148              ACALL    ?L?COM0014
B1:00A16F 240A              ADD      A,#0AH
B1:00A171 128622            LCALL    ?L?COM0006
B1:00A174 C4                SWAP     A
B1:00A175 540F              ANL      A,#0FH
B1:00A177 FF                MOV      R7,A
B1:00A178 5148              ACALL    ?L?COM0014
B1:00A17A 240B              ADD      A,#0BH
B1:00A17C 128FE8            LCALL    ?L?COM0050
B1:00A17F 5164              ACALL    ?L?COM0146
B1:00A181 8002              SJMP     ?C0353?ZW_TRANSPORT
B1:00A183         ?C0352?ZW_TRANSPORT:
B1:00A183 7F00              MOV      R7,#00H
B1:00A185         ?C0353?ZW_TRANSPORT:
B1:00A185 5146              ACALL    ?L?COM0013
B1:00A187 240A              ADD      A,#0AH
B1:00A189 128622            LCALL    ?L?COM0006
B1:00A18C 12D98B            LCALL    ?L?COM01DE
B1:00A18F 5148              ACALL    ?L?COM0014
B1:00A191 12DB6B            LCALL    ?L?COM00D2
B1:00A194 12DDEF            LCALL    ?L?COM05D6
B1:00A197 8011              SJMP     ?C0616?ZW_TRANSPORT
B1:00A199         ?C0349?ZW_TRANSPORT:
B1:00A199 5148              ACALL    ?L?COM0014
B1:00A19B 2409              ADD      A,#09H
B1:00A19D 128622            LCALL    ?L?COM0006
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 262


B1:00A1A0 900A30            MOV      DPTR,#btmpCmdClass
B1:00A1A3 127258            LCALL    ?L?COM0405
B1:00A1A6 2409              ADD      A,#09H
B1:00A1A8 F9                MOV      R1,A
B1:00A1A9 E4                CLR      A
B1:00A1AA         
B1:00A1AA 3A                ADDC     A,R2
B1:00A1AB FA                MOV      R2,A
B1:00A1AC E9                MOV      A,R1
B1:00A1AD 2401              ADD      A,#01H
B1:00A1AF 128622            LCALL    ?L?COM0006
B1:00A1B2 900A2F            MOV      DPTR,#btmpCmd
B1:00A1B5 F0                MOVX     @DPTR,A
B1:00A1B6         ?C0354?ZW_TRANSPORT:
B1:00A1B6 900A27            MOV      DPTR,#pRxFrame
B1:00A1B9 127077            LCALL    ?L?COM00E7
B1:00A1BC 128622            LCALL    ?L?COM0006
B1:00A1BF FF                MOV      R7,A
;---- Variable 'btmpStatus' assigned to Register 'R7' ----
B1:00A1C0 30016B            JNB      learnMode,?C0348?ZW_TRANSPORT
B1:00A1C3 54E2              ANL      A,#0E2H
B1:00A1C5 6480              XRL      A,#080H
B1:00A1C7 7065              JNZ      ?C0348?ZW_TRANSPORT
B1:00A1C9 900A30            MOV      DPTR,#btmpCmdClass
B1:00A1CC E0                MOVX     A,@DPTR
B1:00A1CD 6401              XRL      A,#01H
B1:00A1CF 704F              JNZ      ?C0356?ZW_TRANSPORT
B1:00A1D1 900A2F            MOV      DPTR,#btmpCmd
B1:00A1D4 E0                MOVX     A,@DPTR
B1:00A1D5 6408              XRL      A,#08H
B1:00A1D7 6055              JZ       ?C0348?ZW_TRANSPORT
B1:00A1D9 30040C            JNB      learnModeClassic,?C0359?ZW_TRANSPORT
B1:00A1DC 5148              ACALL    ?L?COM0014
B1:00A1DE 12DB9D            LCALL    ?L?COM012B
B1:00A1E1 7B01              MOV      R3,#01H
B1:00A1E3 12DAC7            LCALL    ?L?COM0257
B1:00A1E6 6030              JZ       ?C0358?ZW_TRANSPORT
B1:00A1E8         ?C0359?ZW_TRANSPORT:
B1:00A1E8 5148              ACALL    ?L?COM0014
B1:00A1EA 5150              ACALL    ?L?COM023E
B1:00A1EC E9                MOV      A,R1
B1:00A1ED 2404              ADD      A,#04H
B1:00A1EF 128622            LCALL    ?L?COM0006
B1:00A1F2 FF                MOV      R7,A
B1:00A1F3 5148              ACALL    ?L?COM0014
B1:00A1F5 5150              ACALL    ?L?COM023E
B1:00A1F7 E9                MOV      A,R1
B1:00A1F8 2403              ADD      A,#03H
B1:00A1FA 128622            LCALL    ?L?COM0006
B1:00A1FD 4F                ORL      A,R7
B1:00A1FE FF                MOV      R7,A
B1:00A1FF 5148              ACALL    ?L?COM0014
B1:00A201 5150              ACALL    ?L?COM023E
B1:00A203 E9                MOV      A,R1
B1:00A204 2405              ADD      A,#05H
B1:00A206 128622            LCALL    ?L?COM0006
B1:00A209 4F                ORL      A,R7
B1:00A20A FF                MOV      R7,A
B1:00A20B 5148              ACALL    ?L?COM0014
B1:00A20D 5150              ACALL    ?L?COM023E
B1:00A20F E9                MOV      A,R1
B1:00A210 2406              ADD      A,#06H
B1:00A212 128622            LCALL    ?L?COM0006
B1:00A215 4F                ORL      A,R7
B1:00A216 7008              JNZ      ?C0356?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 263


B1:00A218         ?C0358?ZW_TRANSPORT:
B1:00A218 900A2F            MOV      DPTR,#btmpCmd
B1:00A21B E0                MOVX     A,@DPTR
B1:00A21C 6403              XRL      A,#03H
B1:00A21E 600E              JZ       ?C0348?ZW_TRANSPORT
B1:00A220         ?C0356?ZW_TRANSPORT:
B1:00A220 900A27            MOV      DPTR,#pRxFrame
B1:00A223 127077            LCALL    ?L?COM00E7
B1:00A226 128622            LCALL    ?L?COM0006
B1:00A229 54EA              ANL      A,#0EAH
B1:00A22B 122072            LCALL    ?C?CSTPTR
B1:00A22E         ?C0348?ZW_TRANSPORT:
B1:00A22E 900A27            MOV      DPTR,#pRxFrame
B1:00A231 127077            LCALL    ?L?COM00E7
B1:00A234 128622            LCALL    ?L?COM0006
B1:00A237 30E007            JNB      ACC.0,?C0276?ZW_TRANSPORT
B1:00A23A 90086F            MOV      DPTR,#myFrame
B1:00A23D E0                MOVX     A,@DPTR
B1:00A23E 4401              ORL      A,#01H
B1:00A240 F0                MOVX     @DPTR,A
B1:00A241         ?C0276?ZW_TRANSPORT:
B1:00A241 22                RET      
----- FUNCTION _IsMyFrame (END) -------


----- FUNCTION ?L?COM0011 (BEGIN) -----
B1:00A242 C4                SWAP     A
B1:00A243 540F              ANL      A,#0FH
B1:00A245         ?L?COM0012:
B1:00A245 FF                MOV      R7,A
B1:00A246         ?L?COM0013:
B1:00A246 7E00              MOV      R6,#00H
B1:00A248         ?L?COM0014:
B1:00A248 900A31            MOV      DPTR,#fr
B1:00A24B 122589            LCALL    ?C?PLDXDATA
B1:00A24E E9                MOV      A,R1
B1:00A24F 22                RET      
----- FUNCTION ?L?COM0011 (END) -------


----- FUNCTION ?L?COM023E (BEGIN) -----
B1:00A250 2409              ADD      A,#09H
B1:00A252 F9                MOV      R1,A
B1:00A253 E4                CLR      A
B1:00A254 3A                ADDC     A,R2
B1:00A255 FA                MOV      R2,A
B1:00A256 22                RET      
----- FUNCTION ?L?COM023E (END) -------


----- FUNCTION ?L?COM0145 (BEGIN) -----
B1:00A257 EF                MOV      A,R7
B1:00A258 240B              ADD      A,#0BH
B1:00A25A F9                MOV      R1,A
B1:00A25B E4                CLR      A
B1:00A25C 3E                ADDC     A,R6
B1:00A25D FA                MOV      R2,A
B1:00A25E E9                MOV      A,R1
B1:00A25F 2D                ADD      A,R5
B1:00A260 F9                MOV      R1,A
B1:00A261 EC                MOV      A,R4
B1:00A262 3A                ADDC     A,R2
B1:00A263 FA                MOV      R2,A
B1:00A264         ?L?COM0146:
B1:00A264 121FB3            LCALL    ?C?CLDPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 264


B1:00A267 C4                SWAP     A
B1:00A268 540F              ANL      A,#0FH
B1:00A26A 04                INC      A
B1:00A26B FF                MOV      R7,A
B1:00A26C 22                RET      
----- FUNCTION ?L?COM0145 (END) -------


----- FUNCTION RetransmitFail (BEGIN) -----
B1:00A26D 128538            LCALL    ?L?COM0016
B1:00A270 4A                ORL      A,R2
B1:00A271 C3                CLR      C
B1:00A272 6001              JZ       ?C0204?ZW_TRANSPORT
B1:00A274 D3                SETB     C
B1:00A275         ?C0204?ZW_TRANSPORT:
B1:00A275         ?C0205?ZW_TRANSPORT:
B1:00A275 4002              JC       $ + 4H
B1:00A277 A1AA              AJMP     ?C0206?ZW_TRANSPORT
B1:00A279         ?C0203?ZW_TRANSPORT:
B1:00A279 E9                MOV      A,R1
B1:00A27A 24B7              ADD      A,#0B7H
B1:00A27C 128622            LCALL    ?L?COM0006
B1:00A27F FF                MOV      R7,A
B1:00A280 7B01              MOV      R3,#01H
B1:00A282 7A0B              MOV      R2,#HIGH frameType
B1:00A284 790A              MOV      R1,#LOW frameType
B1:00A286 12D999            LCALL    _ConvertHeaderInfoToFrameType
B1:00A289 30060B            JNB      bApplicationTxAbort,?C0207?ZW_TRANSPORT
B1:00A28C 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00A28F 12861C            LCALL    ?L?COM0004
B1:00A292 30E502            JNB      ACC.5,$ + 5H
B1:00A295 61FE              AJMP     ?C0208?ZW_TRANSPORT
B1:00A297         ?C0207?ZW_TRANSPORT:
B1:00A297 128538            LCALL    ?L?COM0016
B1:00A29A 24B6              ADD      A,#0B6H
B1:00A29C 128622            LCALL    ?L?COM0006
B1:00A29F 12DA4B            LCALL    ?L?COM0163
B1:00A2A2 7044              JNZ      ?C0209?ZW_TRANSPORT
B1:00A2A4 128538            LCALL    ?L?COM0016
B1:00A2A7 24B7              ADD      A,#0B7H
B1:00A2A9 128622            LCALL    ?L?COM0006
B1:00A2AC 30E739            JNB      ACC.7,?C0209?ZW_TRANSPORT
B1:00A2AF 12885C            LCALL    ?L?COM000E
B1:00A2B2 1272B9            LCALL    ?L?COM0455
B1:00A2B5 5407              ANL      A,#07H
B1:00A2B7 6403              XRL      A,#03H
B1:00A2B9 702D              JNZ      ?C0209?ZW_TRANSPORT
B1:00A2BB 128538            LCALL    ?L?COM0016
B1:00A2BE 24B9              ADD      A,#0B9H
B1:00A2C0 128622            LCALL    ?L?COM0006
B1:00A2C3 D3                SETB     C
B1:00A2C4 9440              SUBB     A,#040H
B1:00A2C6 5020              JNC      ?C0209?ZW_TRANSPORT
B1:00A2C8 12885C            LCALL    ?L?COM000E
B1:00A2CB EF                MOV      A,R7
B1:00A2CC 54F8              ANL      A,#0F8H
B1:00A2CE 4402              ORL      A,#02H
B1:00A2D0 FF                MOV      R7,A
B1:00A2D1 B1B6              ACALL    ?L?COM00FA
B1:00A2D3 12C8E2            LCALL    ?L?COM04B8
B1:00A2D6 EF                MOV      A,R7
B1:00A2D7 4404              ORL      A,#04H
B1:00A2D9 12886A            LCALL    ?L?COM0259
B1:00A2DC 128538            LCALL    ?L?COM0016
B1:00A2DF 24BB              ADD      A,#0BBH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 265


B1:00A2E1 128622            LCALL    ?L?COM0006
B1:00A2E4 4410              ORL      A,#010H
B1:00A2E6 61F9              AJMP     ?C0598?ZW_TRANSPORT
B1:00A2E8         ?C0209?ZW_TRANSPORT:
B1:00A2E8 128538            LCALL    ?L?COM0016
B1:00A2EB 24B7              ADD      A,#0B7H
B1:00A2ED 128622            LCALL    ?L?COM0006
B1:00A2F0 30E723            JNB      ACC.7,?C0211?ZW_TRANSPORT
B1:00A2F3 540F              ANL      A,#0FH
B1:00A2F5 6401              XRL      A,#01H
B1:00A2F7 701D              JNZ      ?C0211?ZW_TRANSPORT
B1:00A2F9 121FB3            LCALL    ?C?CLDPTR
B1:00A2FC 30E711            JNB      ACC.7,?C0213?ZW_TRANSPORT
B1:00A2FF 128538            LCALL    ?L?COM0016
B1:00A302 24BB              ADD      A,#0BBH
B1:00A304 128622            LCALL    ?L?COM0006
B1:00A307 30E406            JNB      ACC.4,?C0213?ZW_TRANSPORT
B1:00A30A 7E00              MOV      R6,#00H
B1:00A30C 7F01              MOV      R7,#01H
B1:00A30E 8013              SJMP     ?C0212?ZW_TRANSPORT
B1:00A310         ?C0213?ZW_TRANSPORT:
B1:00A310 7E00              MOV      R6,#00H
B1:00A312 7F00              MOV      R7,#00H
B1:00A314         ?C0214?ZW_TRANSPORT:
B1:00A314 800D              SJMP     ?C0212?ZW_TRANSPORT
B1:00A316         ?C0211?ZW_TRANSPORT:
B1:00A316 128538            LCALL    ?L?COM0016
B1:00A319 24B7              ADD      A,#0B7H
B1:00A31B 128622            LCALL    ?L?COM0006
B1:00A31E 5410              ANL      A,#010H
B1:00A320 FF                MOV      R7,A
B1:00A321 7E00              MOV      R6,#00H
B1:00A323         ?C0212?ZW_TRANSPORT:
B1:00A323 EF                MOV      A,R7
B1:00A324 4E                ORL      A,R6
B1:00A325 6017              JZ       ?C0210?ZW_TRANSPORT
B1:00A327 128538            LCALL    ?L?COM0016
B1:00A32A 2403              ADD      A,#03H
B1:00A32C 128622            LCALL    ?L?COM0006
B1:00A32F 54FB              ANL      A,#0FBH
B1:00A331 128859            LCALL    ?L?COM000D
B1:00A334 12216F            LCALL    ?C?ILDPTR
B1:00A337 54F8              ANL      A,#0F8H
B1:00A339 4403              ORL      A,#03H
B1:00A33B 12CA07            LCALL    ?L?COM027F
B1:00A33E         ?C0210?ZW_TRANSPORT:
B1:00A33E 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00A341 12861C            LCALL    ?L?COM0004
B1:00A344 20E202            JB       ACC.2,$ + 5H
B1:00A347 61FE              AJMP     ?C0208?ZW_TRANSPORT
B1:00A349 128538            LCALL    ?L?COM0016
B1:00A34C 24DF              ADD      A,#0DFH
B1:00A34E 128622            LCALL    ?L?COM0006
B1:00A351 D3                SETB     C
B1:00A352 9405              SUBB     A,#05H
B1:00A354 4002              JC       $ + 4H
B1:00A356 61FE              AJMP     ?C0208?ZW_TRANSPORT
B1:00A358 128538            LCALL    ?L?COM0016
B1:00A35B 2403              ADD      A,#03H
B1:00A35D 128622            LCALL    ?L?COM0006
B1:00A360 FF                MOV      R7,A
B1:00A361 30E432            JNB      ACC.4,?C0217?ZW_TRANSPORT
B1:00A364 128538            LCALL    ?L?COM0016
B1:00A367 2403              ADD      A,#03H
B1:00A369 F9                MOV      R1,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 266


B1:00A36A E4                CLR      A
B1:00A36B 3A                ADDC     A,R2
B1:00A36C FA                MOV      R2,A
B1:00A36D EF                MOV      A,R7
B1:00A36E 54EF              ANL      A,#0EFH
B1:00A370 122072            LCALL    ?C?CSTPTR
B1:00A373 128538            LCALL    ?L?COM0016
B1:00A376 2406              ADD      A,#06H
B1:00A378 127060            LCALL    ?L?COM00DC
B1:00A37B FF                MOV      R7,A
B1:00A37C AEF0              MOV      R6,B
B1:00A37E 12885C            LCALL    ?L?COM000E
B1:00A381 B1B6              ACALL    ?L?COM00FA
B1:00A383 EF                MOV      A,R7
B1:00A384 5407              ANL      A,#07H
B1:00A386 6402              XRL      A,#02H
B1:00A388 C3                CLR      C
B1:00A389 7001              JNZ      ?C0218?ZW_TRANSPORT
B1:00A38B D3                SETB     C
B1:00A38C         ?C0218?ZW_TRANSPORT:
B1:00A38C         ?C0219?ZW_TRANSPORT:
B1:00A38C 12C93F            LCALL    ?L?COM0630
B1:00A38F 900B0A            MOV      DPTR,#frameType
B1:00A392 E0                MOVX     A,@DPTR
B1:00A393 4F                ORL      A,R7
B1:00A394 A196              AJMP     ?C0599?ZW_TRANSPORT
B1:00A396         ?C0217?ZW_TRANSPORT:
B1:00A396 128538            LCALL    ?L?COM0016
B1:00A399 24DF              ADD      A,#0DFH
B1:00A39B 128622            LCALL    ?L?COM0006
B1:00A39E D3                SETB     C
B1:00A39F 9403              SUBB     A,#03H
B1:00A3A1 500E              JNC      ?C0220?ZW_TRANSPORT
B1:00A3A3 128538            LCALL    ?L?COM0016
B1:00A3A6 24BA              ADD      A,#0BAH
B1:00A3A8 128622            LCALL    ?L?COM0006
B1:00A3AB FF                MOV      R7,A
B1:00A3AC 12C6B8            LCALL    _ReturnRouteFindFirst
B1:00A3AF 8008              SJMP     ?C0221?ZW_TRANSPORT
B1:00A3B1         ?C0220?ZW_TRANSPORT:
B1:00A3B1 900871            MOV      DPTR,#activeTransmit+01H
B1:00A3B4 E0                MOVX     A,@DPTR
B1:00A3B5 04                INC      A
B1:00A3B6 12C71B            LCALL    ?L?COM0568
B1:00A3B9         ?C0221?ZW_TRANSPORT:
B1:00A3B9 128538            LCALL    ?L?COM0016
B1:00A3BC 129583            LCALL    ?L?COM034D
B1:00A3BF 7405              MOV      A,#05H
B1:00A3C1 122072            LCALL    ?C?CSTPTR
B1:00A3C4 900871            MOV      DPTR,#activeTransmit+01H
B1:00A3C7 E0                MOVX     A,@DPTR
B1:00A3C8 F4                CPL      A
B1:00A3C9 6007              JZ       ?C0222?ZW_TRANSPORT
B1:00A3CB 12C945            LCALL    TransmitReturnRouteSetup
B1:00A3CE 5002              JNC      ?C0222?ZW_TRANSPORT
B1:00A3D0 A199              AJMP     ?C0601?ZW_TRANSPORT
B1:00A3D2         ?C0222?ZW_TRANSPORT:
B1:00A3D2 128538            LCALL    ?L?COM0016
B1:00A3D5 24DF              ADD      A,#0DFH
B1:00A3D7 128622            LCALL    ?L?COM0006
B1:00A3DA C3                CLR      C
B1:00A3DB 9406              SUBB     A,#06H
B1:00A3DD 501F              JNC      ?C0208?ZW_TRANSPORT
B1:00A3DF 12885C            LCALL    ?L?COM000E
B1:00A3E2 12C9FC            LCALL    ?L?COM0420
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 267


B1:00A3E5 7001              JNZ      ?C0225?ZW_TRANSPORT
B1:00A3E7 D3                SETB     C
B1:00A3E8         ?C0225?ZW_TRANSPORT:
B1:00A3E8         ?C0226?ZW_TRANSPORT:
B1:00A3E8 12C93F            LCALL    ?L?COM0630
B1:00A3EB EF                MOV      A,R7
B1:00A3EC 4401              ORL      A,#01H
B1:00A3EE 12886A            LCALL    ?L?COM0259
B1:00A3F1 128538            LCALL    ?L?COM0016
B1:00A3F4 129583            LCALL    ?L?COM034D
B1:00A3F7 7406              MOV      A,#06H
B1:00A3F9         
B1:00A3F9 122072            LCALL    ?C?CSTPTR
B1:00A3FC         
B1:00A3FC A199              AJMP     ?C0601?ZW_TRANSPORT
B1:00A3FE         ?C0208?ZW_TRANSPORT:
B1:00A3FE 300602            JNB      bApplicationTxAbort,$ + 5H
B1:00A401 A1A2              AJMP     ?C0227?ZW_TRANSPORT
B1:00A403 128538            LCALL    ?L?COM0016
B1:00A406 24DF              ADD      A,#0DFH
B1:00A408 128622            LCALL    ?L?COM0006
B1:00A40B C3                CLR      C
B1:00A40C 9407              SUBB     A,#07H
B1:00A40E 4002              JC       $ + 4H
B1:00A410 A1A2              AJMP     ?C0227?ZW_TRANSPORT
B1:00A412 128538            LCALL    ?L?COM0016
B1:00A415 2403              ADD      A,#03H
B1:00A417 128622            LCALL    ?L?COM0006
B1:00A41A 20E002            JB       ACC.0,$ + 5H
B1:00A41D A1A2              AJMP     ?C0227?ZW_TRANSPORT
B1:00A41F 128538            LCALL    ?L?COM0016
B1:00A422 24B6              ADD      A,#0B6H
B1:00A424 128622            LCALL    ?L?COM0006
B1:00A427 FF                MOV      R7,A
B1:00A428 C007              PUSH     AR7
B1:00A42A 128538            LCALL    ?L?COM0016
B1:00A42D 24BA              ADD      A,#0BAH
B1:00A42F 128622            LCALL    ?L?COM0006
B1:00A432 FD                MOV      R5,A
B1:00A433 128538            LCALL    ?L?COM0016
B1:00A436 12C7CB            LCALL    ?L?COM0188
B1:00A439 C003              PUSH     AR3
B1:00A43B C002              PUSH     AR2
B1:00A43D C001              PUSH     AR1
B1:00A43F 128538            LCALL    ?L?COM0016
B1:00A442 24B1              ADD      A,#0B1H
B1:00A444 128622            LCALL    ?L?COM0006
B1:00A447 900A6F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B1:00A44A F0                MOVX     @DPTR,A
B1:00A44B 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00A44E 12861C            LCALL    ?L?COM0004
B1:00A451 5403              ANL      A,#03H
B1:00A453 4401              ORL      A,#01H
B1:00A455 900A70            MOV      DPTR,#?_ExploreQueueFrame?BYTE+06H
B1:00A458 F0                MOVX     @DPTR,A
B1:00A459 128538            LCALL    ?L?COM0016
B1:00A45C 12705E            LCALL    ?L?COM00DB
B1:00A45F FF                MOV      R7,A
B1:00A460 E5F0              MOV      A,B
B1:00A462 1270E3            LCALL    ?L?COM01CE
B1:00A465 D001              POP      AR1
B1:00A467 D002              POP      AR2
B1:00A469 D003              POP      AR3
B1:00A46B D007              POP      AR7
B1:00A46D 121BB0            LCALL    ?INTERBANK_TABLE?_ExploreQueueFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 268


B1:00A470 EF                MOV      A,R7
B1:00A471 7002              JNZ      $ + 4H
B1:00A473 A1A2              AJMP     ?C0227?ZW_TRANSPORT
B1:00A475 12703F            LCALL    ?L?COM009F
B1:00A478 2405              ADD      A,#05H
B1:00A47A 128622            LCALL    ?L?COM0006
B1:00A47D 4420              ORL      A,#020H
B1:00A47F 12703E            LCALL    ?L?COM009E
B1:00A482 2429              ADD      A,#029H
B1:00A484 1287E0            LCALL    ?L?COM002E
B1:00A487 12703F            LCALL    ?L?COM009F
B1:00A48A 242C              ADD      A,#02CH
B1:00A48C F9                MOV      R1,A
B1:00A48D E4                CLR      A
B1:00A48E 3A                ADDC     A,R2
B1:00A48F FA                MOV      R2,A
B1:00A490 7440              MOV      A,#040H
B1:00A492 122072            LCALL    ?C?CSTPTR
B1:00A495 12703F            LCALL    ?L?COM009F
B1:00A498 12730C            LCALL    ?L?COM04C1
B1:00A49B 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00A49E 128538            LCALL    ?L?COM0016
B1:00A4A1 24E9              ADD      A,#0E9H
B1:00A4A3 127060            LCALL    ?L?COM00DC
B1:00A4A6 12703E            LCALL    ?L?COM009E
B1:00A4A9 5150              ACALL    ?L?COM023E
B1:00A4AB 12CA08            LCALL    ?L?COM0280
B1:00A4AE 90095B            MOV      DPTR,#pExploreQueueElement
B1:00A4B1 122589            LCALL    ?C?PLDXDATA
B1:00A4B4 7405              MOV      A,#05H
B1:00A4B6 122072            LCALL    ?C?CSTPTR
B1:00A4B9 12703F            LCALL    ?L?COM009F
B1:00A4BC 2407              ADD      A,#07H
B1:00A4BE F9                MOV      R1,A
B1:00A4BF E4                CLR      A
B1:00A4C0 3A                ADDC     A,R2
B1:00A4C1 FA                MOV      R2,A
B1:00A4C2 7407              MOV      A,#07H
B1:00A4C4 75F0D0            MOV      B,#0D0H
B1:00A4C7 12221F            LCALL    ?C?ISTPTR
B1:00A4CA 128538            LCALL    ?L?COM0016
B1:00A4CD 12CB7C            LCALL    ?L?COM0219
B1:00A4D0 12221F            LCALL    ?C?ISTPTR
B1:00A4D3 128538            LCALL    ?L?COM0016
B1:00A4D6 24DC              ADD      A,#0DCH
B1:00A4D8 F9                MOV      R1,A
B1:00A4D9 E4                CLR      A
B1:00A4DA 3A                ADDC     A,R2
B1:00A4DB FA                MOV      R2,A
B1:00A4DC 741B              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ExploreComplete
B1:00A4DE 75F0B5            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ExploreComplete
B1:00A4E1 12221F            LCALL    ?C?ISTPTR
B1:00A4E4 12885C            LCALL    ?L?COM000E
B1:00A4E7 12216F            LCALL    ?C?ILDPTR
B1:00A4EA AEF0              MOV      R6,B
B1:00A4EC 54F8              ANL      A,#0F8H
B1:00A4EE FF                MOV      R7,A
B1:00A4EF B1B6              ACALL    ?L?COM00FA
B1:00A4F1 EF                MOV      A,R7
B1:00A4F2 4402              ORL      A,#02H
B1:00A4F4 FF                MOV      R7,A
B1:00A4F5 B1B6              ACALL    ?L?COM00FA
B1:00A4F7 12703F            LCALL    ?L?COM009F
B1:00A4FA 2404              ADD      A,#04H
B1:00A4FC 128622            LCALL    ?L?COM0006
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 269


B1:00A4FF 128537            LCALL    ?L?COM0015
B1:00A502 2402              ADD      A,#02H
B1:00A504 1287E0            LCALL    ?L?COM002E
B1:00A507 12703F            LCALL    ?L?COM009F
B1:00A50A 2406              ADD      A,#06H
B1:00A50C 128622            LCALL    ?L?COM0006
B1:00A50F FF                MOV      R7,A
B1:00A510 7440              MOV      A,#040H
B1:00A512 C3                CLR      C
B1:00A513 9F                SUBB     A,R7
B1:00A514 500A              JNC      ?C0229?ZW_TRANSPORT
B1:00A516 128538            LCALL    ?L?COM0016
B1:00A519 12DCE3            LCALL    ?L?COM044A
B1:00A51C 742F              MOV      A,#02FH
B1:00A51E 8019              SJMP     ?C0603?ZW_TRANSPORT
B1:00A520         ?C0229?ZW_TRANSPORT:
B1:00A520 7411              MOV      A,#011H
B1:00A522 D3                SETB     C
B1:00A523 9F                SUBB     A,R7
B1:00A524 500C              JNC      ?C0231?ZW_TRANSPORT
B1:00A526 EF                MOV      A,R7
B1:00A527 24EF              ADD      A,#0EFH
B1:00A529 128537            LCALL    ?L?COM0015
B1:00A52C 12DCE3            LCALL    ?L?COM044A
B1:00A52F EF                MOV      A,R7
B1:00A530         
B1:00A530 8007              SJMP     ?C0603?ZW_TRANSPORT
B1:00A532         ?C0231?ZW_TRANSPORT:
B1:00A532 128538            LCALL    ?L?COM0016
B1:00A535 12DCE3            LCALL    ?L?COM044A
B1:00A538 E4                CLR      A
B1:00A539         
B1:00A539 122072            LCALL    ?C?CSTPTR
B1:00A53C         ?C0230?ZW_TRANSPORT:
B1:00A53C 128538            LCALL    ?L?COM0016
B1:00A53F 24B1              ADD      A,#0B1H
B1:00A541 128622            LCALL    ?L?COM0006
B1:00A544 128537            LCALL    ?L?COM0015
B1:00A547 12C7CB            LCALL    ?L?COM0188
B1:00A54A C003              PUSH     AR3
B1:00A54C C002              PUSH     AR2
B1:00A54E C001              PUSH     AR1
B1:00A550 12703F            LCALL    ?L?COM009F
B1:00A553 2431              ADD      A,#031H
B1:00A555 126145            LCALL    ?L?COM0045
B1:00A558 D001              POP      AR1
B1:00A55A D002              POP      AR2
B1:00A55C D003              POP      AR3
B1:00A55E 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A561 128538            LCALL    ?L?COM0016
B1:00A564 128FCA            LCALL    ?L?COM0193
B1:00A567 7B01              MOV      R3,#01H
B1:00A569 C003              PUSH     AR3
B1:00A56B C002              PUSH     AR2
B1:00A56D C001              PUSH     AR1
B1:00A56F 12703F            LCALL    ?L?COM009F
B1:00A572 1272B2            LCALL    ?L?COM0448
B1:00A575 7B01              MOV      R3,#01H
B1:00A577 126149            LCALL    ?L?COM0047
B1:00A57A D001              POP      AR1
B1:00A57C D002              POP      AR2
B1:00A57E D003              POP      AR3
B1:00A580 7F11              MOV      R7,#011H
B1:00A582 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A585 128538            LCALL    ?L?COM0016
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 270


B1:00A588 129583            LCALL    ?L?COM034D
B1:00A58B 7407              MOV      A,#07H
B1:00A58D 122072            LCALL    ?C?CSTPTR
B1:00A590 12C8E2            LCALL    ?L?COM04B8
B1:00A593 EF                MOV      A,R7
B1:00A594 4406              ORL      A,#06H
B1:00A596         
B1:00A596 12886A            LCALL    ?L?COM0259
B1:00A599         
B1:00A599 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00A59C 122589            LCALL    ?C?PLDXDATA
B1:00A59F 028E33            LJMP     _TxQueueQueueElement
B1:00A5A2         ?C0227?ZW_TRANSPORT:
B1:00A5A2 127070            LCALL    ?L?COM00E1
B1:00A5A5 E4                CLR      A
B1:00A5A6 FF                MOV      R7,A
B1:00A5A7 1286F4            LCALL    _TxPermanentlyDone
B1:00A5AA         ?C0206?ZW_TRANSPORT:
B1:00A5AA 22                RET      
----- FUNCTION RetransmitFail (END) -------


----- FUNCTION ?L?COM00F8 (BEGIN) -----
B1:00A5AB FF                MOV      R7,A
B1:00A5AC 122589            LCALL    ?C?PLDXDATA
B1:00A5AF E9                MOV      A,R1
B1:00A5B0 24DC              ADD      A,#0DCH
B1:00A5B2         ?L?COM00F9:
B1:00A5B2 F9                MOV      R1,A
B1:00A5B3 E4                CLR      A
B1:00A5B4 3A                ADDC     A,R2
B1:00A5B5 FA                MOV      R2,A
B1:00A5B6         ?L?COM00FA:
B1:00A5B6 EE                MOV      A,R6
B1:00A5B7 8FF0              MOV      B,R7
B1:00A5B9 02221F            LJMP     ?C?ISTPTR
----- FUNCTION ?L?COM00F8 (END) -------


----- FUNCTION _ReceiveHandler (BEGIN) -----
B1:00A5BC 900717            MOV      DPTR,#pData
B1:00A5BF EE                MOV      A,R6
B1:00A5C0 F0                MOVX     @DPTR,A
B1:00A5C1 A3                INC      DPTR
B1:00A5C2 124765            LCALL    ?L?COM0102
B1:00A5C5 12DDF7            LCALL    ?L?COM0343
B1:00A5C8 AA06              MOV      R2,AR6
B1:00A5CA F9                MOV      R1,A
B1:00A5CB 7B01              MOV      R3,#01H
B1:00A5CD 900873            MOV      DPTR,#rxFrame
B1:00A5D0 1225A9            LCALL    ?C?PSTXDATA
B1:00A5D3 900719            MOV      DPTR,#dataLength
B1:00A5D6 E0                MOVX     A,@DPTR
B1:00A5D7 90087C            MOV      DPTR,#rxFrame+09H
B1:00A5DA F0                MOVX     @DPTR,A
B1:00A5DB D3                SETB     C
B1:00A5DC 9408              SUBB     A,#08H
B1:00A5DE 5003              JNC      $ + 5H
B1:00A5E0 02AC28            LJMP     ?C0482?ZW_TRANSPORT
B1:00A5E3 EF                MOV      A,R7
B1:00A5E4 2407              ADD      A,#07H
B1:00A5E6 12AC59            LCALL    ?L?COM00A6
B1:00A5E9 12FDD4            LCALL    ?L?COM062B
B1:00A5EC 5003              JNC      $ + 5H
B1:00A5EE 02AC28            LJMP     ?C0482?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 271


B1:00A5F1 E4                CLR      A
B1:00A5F2 90087A            MOV      DPTR,#rxFrame+07H
B1:00A5F5 F0                MOVX     @DPTR,A
B1:00A5F6 9006AE            MOV      DPTR,#rfRxCurrentSpeed
B1:00A5F9 E0                MOVX     A,@DPTR
B1:00A5FA 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00A5FD F0                MOVX     @DPTR,A
B1:00A5FE 12DE03            LCALL    RouteCachedReset
B1:00A601 12AC4E            LCALL    ?L?COM00A3
B1:00A604 FF                MOV      R7,A
B1:00A605 540F              ANL      A,#0FH
B1:00A607 6401              XRL      A,#01H
B1:00A609 6002              JZ       $ + 4H
B1:00A60B C1A4              AJMP     ?C0466?ZW_TRANSPORT
B1:00A60D EF                MOV      A,R7
B1:00A60E 30E74D            JNB      ACC.7,?C0467?ZW_TRANSPORT
B1:00A611 900717            MOV      DPTR,#pData
B1:00A614 A3                INC      DPTR
B1:00A615 E0                MOVX     A,@DPTR
B1:00A616 FF                MOV      R7,A
B1:00A617 2409              ADD      A,#09H
B1:00A619 12AC59            LCALL    ?L?COM00A6
B1:00A61C 30E30D            JNB      ACC.3,?C0468?ZW_TRANSPORT
B1:00A61F EF                MOV      A,R7
B1:00A620 240A              ADD      A,#0AH
B1:00A622 12AC59            LCALL    ?L?COM00A6
B1:00A625 12D98B            LCALL    ?L?COM01DE
B1:00A628 5157              ACALL    ?L?COM0145
B1:00A62A 8002              SJMP     ?C0469?ZW_TRANSPORT
B1:00A62C         ?C0468?ZW_TRANSPORT:
B1:00A62C 7F00              MOV      R7,#00H
B1:00A62E         ?C0469?ZW_TRANSPORT:
B1:00A62E 12DB48            LCALL    ?L?COM00D1
B1:00A631 EC                MOV      A,R4
B1:00A632 128FEA            LCALL    ?L?COM0051
B1:00A635 125C44            LCALL    ?L?COM00B7
B1:00A638 900721            MOV      DPTR,#protPayloadCmd
B1:00A63B 12DDF7            LCALL    ?L?COM0343
B1:00A63E 2409              ADD      A,#09H
B1:00A640 12AC59            LCALL    ?L?COM00A6
B1:00A643 30E30E            JNB      ACC.3,?C0470?ZW_TRANSPORT
B1:00A646 EF                MOV      A,R7
B1:00A647 240A              ADD      A,#0AH
B1:00A649 12AC59            LCALL    ?L?COM00A6
B1:00A64C C4                SWAP     A
B1:00A64D 540F              ANL      A,#0FH
B1:00A64F FD                MOV      R5,A
B1:00A650 5157              ACALL    ?L?COM0145
B1:00A652 8002              SJMP     ?C0471?ZW_TRANSPORT
B1:00A654         ?C0470?ZW_TRANSPORT:
B1:00A654 7F00              MOV      R7,#00H
B1:00A656         ?C0471?ZW_TRANSPORT:
B1:00A656 12DB48            LCALL    ?L?COM00D1
B1:00A659 12DDEF            LCALL    ?L?COM05D6
B1:00A65C 800C              SJMP     ?C0622?ZW_TRANSPORT
B1:00A65E         ?C0467?ZW_TRANSPORT:
B1:00A65E 12AC40            LCALL    ?L?COM0092
B1:00A661 5150              ACALL    ?L?COM023E
B1:00A663 12AC33            LCALL    ?L?COM0091
B1:00A666 2409              ADD      A,#09H
B1:00A668 F9                MOV      R1,A
B1:00A669 E4                CLR      A
B1:00A66A         
B1:00A66A 3A                ADDC     A,R2
B1:00A66B FA                MOV      R2,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 272


B1:00A66C 900724            MOV      DPTR,#protCmdClass
B1:00A66F 1225A9            LCALL    ?C?PSTXDATA
B1:00A672         ?C0472?ZW_TRANSPORT:
B1:00A672 900721            MOV      DPTR,#protPayloadCmd
B1:00A675 12975B            LCALL    ?L?COM006B
B1:00A678 FF                MOV      R7,A
B1:00A679 6022              JZ       ?C0474?ZW_TRANSPORT
B1:00A67B 6418              XRL      A,#018H
B1:00A67D 601E              JZ       ?C0474?ZW_TRANSPORT
B1:00A67F EF                MOV      A,R7
B1:00A680 6407              XRL      A,#07H
B1:00A682 6019              JZ       ?C0474?ZW_TRANSPORT
B1:00A684 EF                MOV      A,R7
B1:00A685 6403              XRL      A,#03H
B1:00A687 7072              JNZ      ?C0475?ZW_TRANSPORT
B1:00A689 900721            MOV      DPTR,#protPayloadCmd
B1:00A68C 12DB78            LCALL    ?L?COM006D
B1:00A68F 12DBAA            LCALL    ?L?COM012E
B1:00A692 7B01              MOV      R3,#01H
B1:00A694 7A12              MOV      R2,#HIGH homeID
B1:00A696 7923              MOV      R1,#LOW homeID
B1:00A698 12DACB            LCALL    ?L?COM0258
B1:00A69B 705E              JNZ      ?C0475?ZW_TRANSPORT
B1:00A69D         ?C0474?ZW_TRANSPORT:
B1:00A69D 7FFE              MOV      R7,#0FEH
B1:00A69F 121BBF            LCALL    ?INTERBANK_TABLE?_ExplorePurgeQueue
B1:00A6A2 8057              SJMP     ?C0475?ZW_TRANSPORT
B1:00A6A4         ?C0466?ZW_TRANSPORT:
B1:00A6A4 12AC4E            LCALL    ?L?COM00A3
B1:00A6A7 540F              ANL      A,#0FH
B1:00A6A9 FF                MOV      R7,A
B1:00A6AA 6405              XRL      A,#05H
B1:00A6AC 7020              JNZ      ?C0476?ZW_TRANSPORT
B1:00A6AE 12AC40            LCALL    ?L?COM0092
B1:00A6B1 2409              ADD      A,#09H
B1:00A6B3 128622            LCALL    ?L?COM0006
B1:00A6B6 541F              ANL      A,#01FH
B1:00A6B8 7041              JNZ      ?C0475?ZW_TRANSPORT
B1:00A6BA 12AC40            LCALL    ?L?COM0092
B1:00A6BD 2411              ADD      A,#011H
B1:00A6BF F9                MOV      R1,A
B1:00A6C0 E4                CLR      A
B1:00A6C1 3A                ADDC     A,R2
B1:00A6C2 FA                MOV      R2,A
B1:00A6C3 12AC33            LCALL    ?L?COM0091
B1:00A6C6 2411              ADD      A,#011H
B1:00A6C8 F9                MOV      R1,A
B1:00A6C9 E4                CLR      A
B1:00A6CA 3A                ADDC     A,R2
B1:00A6CB FA                MOV      R2,A
B1:00A6CC 8027              SJMP     ?C0623?ZW_TRANSPORT
B1:00A6CE         ?C0476?ZW_TRANSPORT:
B1:00A6CE EF                MOV      A,R7
B1:00A6CF 6402              XRL      A,#02H
B1:00A6D1 701F              JNZ      ?C0479?ZW_TRANSPORT
B1:00A6D3 12AC40            LCALL    ?L?COM0092
B1:00A6D6 2408              ADD      A,#08H
B1:00A6D8 128622            LCALL    ?L?COM0006
B1:00A6DB 541F              ANL      A,#01FH
B1:00A6DD FF                MOV      R7,A
B1:00A6DE 7E00              MOV      R6,#00H
B1:00A6E0 12AC40            LCALL    ?L?COM0092
B1:00A6E3 2409              ADD      A,#09H
B1:00A6E5 128FE8            LCALL    ?L?COM0050
B1:00A6E8 12AC33            LCALL    ?L?COM0091
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 273


B1:00A6EB 2409              ADD      A,#09H
B1:00A6ED 128FE8            LCALL    ?L?COM0050
B1:00A6F0 8003              SJMP     ?C0621?ZW_TRANSPORT
B1:00A6F2         ?C0479?ZW_TRANSPORT:
B1:00A6F2 127070            LCALL    ?L?COM00E1
B1:00A6F5         
B1:00A6F5         
B1:00A6F5 900724            MOV      DPTR,#protCmdClass
B1:00A6F8 1225A9            LCALL    ?C?PSTXDATA
B1:00A6FB         ?C0475?ZW_TRANSPORT:
B1:00A6FB 900724            MOV      DPTR,#protCmdClass
B1:00A6FE 122589            LCALL    ?C?PLDXDATA
B1:00A701 900A64            MOV      DPTR,#?_IsFrameIlLegal?BYTE+03H
B1:00A704 1225A9            LCALL    ?C?PSTXDATA
B1:00A707 900721            MOV      DPTR,#protPayloadCmd
B1:00A70A 122589            LCALL    ?C?PLDXDATA
B1:00A70D 900A67            MOV      DPTR,#?_IsFrameIlLegal?BYTE+06H
B1:00A710 1225A9            LCALL    ?C?PSTXDATA
B1:00A713 900873            MOV      DPTR,#rxFrame
B1:00A716 122589            LCALL    ?C?PLDXDATA
B1:00A719 12E8A5            LCALL    _IsFrameIlLegal
B1:00A71C EF                MOV      A,R7
B1:00A71D 6003              JZ       $ + 5H
B1:00A71F 02AC28            LJMP     ?C0482?ZW_TRANSPORT
B1:00A722         ?C0481?ZW_TRANSPORT:
B1:00A722 90071A            MOV      DPTR,#pRssiArray
B1:00A725 122589            LCALL    ?C?PLDXDATA
B1:00A728 900A2A            MOV      DPTR,#?_IsMyFrame?BYTE+03H
B1:00A72B 1225A9            LCALL    ?C?PSTXDATA
B1:00A72E 12E89E            LCALL    ?L?COM0566
B1:00A731 1298E9            LCALL    _IsMyFrame
B1:00A734 12AC40            LCALL    ?L?COM0092
B1:00A737 2404              ADD      A,#04H
B1:00A739 128622            LCALL    ?L?COM0006
B1:00A73C 90086A            MOV      DPTR,#bNodeLastReceivedFrom
B1:00A73F F0                MOVX     @DPTR,A
B1:00A740 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00A743 E0                MOVX     A,@DPTR
B1:00A744 6401              XRL      A,#01H
B1:00A746 6056              JZ       ?C0483?ZW_TRANSPORT
B1:00A748 90087A            MOV      DPTR,#rxFrame+07H
B1:00A74B E0                MOVX     A,@DPTR
B1:00A74C 30E04F            JNB      ACC.0,?C0483?ZW_TRANSPORT
B1:00A74F E4                CLR      A
B1:00A750 90086E            MOV      DPTR,#tmp
B1:00A753 F0                MOVX     @DPTR,A
B1:00A754         ?C0484?ZW_TRANSPORT:
B1:00A754 90086E            MOV      DPTR,#tmp
B1:00A757 E0                MOVX     A,@DPTR
B1:00A758 FF                MOV      R7,A
B1:00A759 C3                CLR      C
B1:00A75A 9402              SUBB     A,#02H
B1:00A75C 5020              JNC      ?C0485?ZW_TRANSPORT
B1:00A75E EF                MOV      A,R7
B1:00A75F 12CFBB            LCALL    ?L?COM047D
B1:00A762 FF                MOV      R7,A
B1:00A763 90086A            MOV      DPTR,#bNodeLastReceivedFrom
B1:00A766 E0                MOVX     A,@DPTR
B1:00A767 FE                MOV      R6,A
B1:00A768 EF                MOV      A,R7
B1:00A769 B5060A            CJNE     A,AR6,?C0486?ZW_TRANSPORT
B1:00A76C 90086E            MOV      DPTR,#tmp
B1:00A76F E0                MOVX     A,@DPTR
B1:00A770 24FF              ADD      A,#0FFH
B1:00A772 9207              MOV      iResponseNodeIndex,C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 274


B1:00A774 8008              SJMP     ?C0485?ZW_TRANSPORT
B1:00A776         ?C0486?ZW_TRANSPORT:
B1:00A776 90086E            MOV      DPTR,#tmp
B1:00A779 E0                MOVX     A,@DPTR
B1:00A77A 04                INC      A
B1:00A77B F0                MOVX     @DPTR,A
B1:00A77C 80D6              SJMP     ?C0484?ZW_TRANSPORT
B1:00A77E         ?C0485?ZW_TRANSPORT:
B1:00A77E 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00A781 E0                MOVX     A,@DPTR
B1:00A782 FD                MOV      R5,A
B1:00A783 A207              MOV      C,iResponseNodeIndex
B1:00A785 E4                CLR      A
B1:00A786 33                RLC      A
B1:00A787 25E0              ADD      A,ACC
B1:00A789 FF                MOV      R7,A
B1:00A78A E4                CLR      A
B1:00A78B 33                RLC      A
B1:00A78C FE                MOV      R6,A
B1:00A78D 7489              MOV      A,#LOW abDirectNodesResponseSpeed+01H
B1:00A78F 2F                ADD      A,R7
B1:00A790 F582              MOV      DPL,A
B1:00A792 7408              MOV      A,#HIGH abDirectNodesResponseSpeed+01H
B1:00A794 3E                ADDC     A,R6
B1:00A795 F583              MOV      DPH,A
B1:00A797 ED                MOV      A,R5
B1:00A798 F0                MOVX     @DPTR,A
B1:00A799 A207              MOV      C,iResponseNodeIndex
B1:00A79B B3                CPL      C
B1:00A79C 9207              MOV      iResponseNodeIndex,C
B1:00A79E         ?C0483?ZW_TRANSPORT:
B1:00A79E 90087A            MOV      DPTR,#rxFrame+07H
B1:00A7A1 E0                MOVX     A,@DPTR
B1:00A7A2 20E203            JB       ACC.2,$ + 6H
B1:00A7A5 02A87A            LJMP     ?C0488?ZW_TRANSPORT
B1:00A7A8 7F01              MOV      R7,#01H
B1:00A7AA 128350            LCALL    _TxQueueGetElement
B1:00A7AD 90071D            MOV      DPTR,#pACKFrame
B1:00A7B0 12976A            LCALL    ?L?COM02DF
B1:00A7B3 7003              JNZ      $ + 5H
B1:00A7B5 02A87A            LJMP     ?C0488?ZW_TRANSPORT
B1:00A7B8 12AC48            LCALL    ?L?COM0315
B1:00A7BB 7F03              MOV      R7,#03H
B1:00A7BD 128871            LCALL    _BuildTxHeader
B1:00A7C0 12AC40            LCALL    ?L?COM0092
B1:00A7C3 2405              ADD      A,#05H
B1:00A7C5 128622            LCALL    ?L?COM0006
B1:00A7C8 30E40E            JNB      ACC.4,?C0490?ZW_TRANSPORT
B1:00A7CB 12AC48            LCALL    ?L?COM0315
B1:00A7CE E9                MOV      A,R1
B1:00A7CF 24B7              ADD      A,#0B7H
B1:00A7D1 128622            LCALL    ?L?COM0006
B1:00A7D4 4410              ORL      A,#010H
B1:00A7D6 122072            LCALL    ?C?CSTPTR
B1:00A7D9         ?C0490?ZW_TRANSPORT:
B1:00A7D9 12AC48            LCALL    ?L?COM0315
B1:00A7DC E9                MOV      A,R1
B1:00A7DD 24B1              ADD      A,#0B1H
B1:00A7DF F9                MOV      R1,A
B1:00A7E0 E4                CLR      A
B1:00A7E1 125765            LCALL    ?L?COM01E3
B1:00A7E4 90071D            MOV      DPTR,#pACKFrame
B1:00A7E7 12CB78            LCALL    ?L?COM0218
B1:00A7EA 12221F            LCALL    ?C?ISTPTR
B1:00A7ED 12AC48            LCALL    ?L?COM0315
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 275


B1:00A7F0 E9                MOV      A,R1
B1:00A7F1 24DC              ADD      A,#0DCH
B1:00A7F3 F9                MOV      R1,A
B1:00A7F4 E4                CLR      A
B1:00A7F5 3A                ADDC     A,R2
B1:00A7F6 FA                MOV      R2,A
B1:00A7F7 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_TransportDummyApplicationCallback
B1:00A7F9 75F05D            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_TransportDummyApplicationCallback
B1:00A7FC 12221F            LCALL    ?C?ISTPTR
B1:00A7FF 90087B            MOV      DPTR,#rxFrame+08H
B1:00A802 E0                MOVX     A,@DPTR
B1:00A803 FF                MOV      R7,A
B1:00A804 12AC48            LCALL    ?L?COM0315
B1:00A807 E9                MOV      A,R1
B1:00A808 24BA              ADD      A,#0BAH
B1:00A80A 1287E0            LCALL    ?L?COM002E
B1:00A80D 90071D            MOV      DPTR,#pACKFrame
B1:00A810 12885F            LCALL    ?L?COM000F
B1:00A813 12216F            LCALL    ?C?ILDPTR
B1:00A816 54F8              ANL      A,#0F8H
B1:00A818 FF                MOV      R7,A
B1:00A819 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00A81C E0                MOVX     A,@DPTR
B1:00A81D FD                MOV      R5,A
B1:00A81E 12CA05            LCALL    ?L?COM027E
B1:00A821 9140              ACALL    ?L?COM0092
B1:00A823 2405              ADD      A,#05H
B1:00A825 128622            LCALL    ?L?COM0006
B1:00A828 30E50F            JNB      ACC.5,?C0491?ZW_TRANSPORT
B1:00A82B 9148              ACALL    ?L?COM0315
B1:00A82D E9                MOV      A,R1
B1:00A82E 24B7              ADD      A,#0B7H
B1:00A830 128622            LCALL    ?L?COM0006
B1:00A833 4420              ORL      A,#020H
B1:00A835 122072            LCALL    ?C?CSTPTR
B1:00A838 8035              SJMP     ?C0492?ZW_TRANSPORT
B1:00A83A         ?C0491?ZW_TRANSPORT:
B1:00A83A 900876            MOV      DPTR,#rxFrame+03H
B1:00A83D 12975B            LCALL    ?L?COM006B
B1:00A840 6401              XRL      A,#01H
B1:00A842 702B              JNZ      ?C0492?ZW_TRANSPORT
B1:00A844 E9                MOV      A,R1
B1:00A845 2401              ADD      A,#01H
B1:00A847 128622            LCALL    ?L?COM0006
B1:00A84A 6418              XRL      A,#018H
B1:00A84C 7021              JNZ      ?C0492?ZW_TRANSPORT
B1:00A84E 900879            MOV      DPTR,#rxFrame+06H
B1:00A851 E0                MOVX     A,@DPTR
B1:00A852 900876            MOV      DPTR,#rxFrame+03H
B1:00A855 B4040E            CJNE     A,#04H,?C0494?ZW_TRANSPORT
B1:00A858 128FD5            LCALL    ?L?COM0057
B1:00A85B 128622            LCALL    ?L?COM0006
B1:00A85E FF                MOV      R7,A
B1:00A85F 125860            LCALL    _RFPowerGetTxPwrReg
B1:00A862 8F19              MOV      ackPower,R7
B1:00A864 8009              SJMP     ?C0492?ZW_TRANSPORT
B1:00A866         ?C0494?ZW_TRANSPORT:
B1:00A866 12861C            LCALL    ?L?COM0004
B1:00A869 FF                MOV      R7,A
B1:00A86A 126021            LCALL    _RFPowerConvert
B1:00A86D 8F19              MOV      ackPower,R7
B1:00A86F         ?C0492?ZW_TRANSPORT:
B1:00A86F 9148              ACALL    ?L?COM0315
B1:00A871 128E33            LCALL    _TxQueueQueueElement
B1:00A874 201003            JB       bPauseEnabled,?C0488?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 276


B1:00A877 1281F3            LCALL    TxQueueServiceTransmit
B1:00A87A         ?C0488?ZW_TRANSPORT:
B1:00A87A 90086F            MOV      DPTR,#myFrame
B1:00A87D E0                MOVX     A,@DPTR
B1:00A87E 7002              JNZ      $ + 4H
B1:00A880 413A              AJMP     ?C0498?ZW_TRANSPORT
B1:00A882 90087A            MOV      DPTR,#rxFrame+07H
B1:00A885 E0                MOVX     A,@DPTR
B1:00A886 5442              ANL      A,#042H
B1:00A888 6440              XRL      A,#040H
B1:00A88A 701E              JNZ      ?C0499?ZW_TRANSPORT
B1:00A88C 90399C            MOV      DPTR,#waitingForRoutedACK
B1:00A88F E0                MOVX     A,@DPTR
B1:00A890 7002              JNZ      $ + 4H
B1:00A892 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A894 E4                CLR      A
B1:00A895 12FF01            LCALL    ?L?COM05B7
B1:00A898 128538            LCALL    ?L?COM0016
B1:00A89B 24BC              ADD      A,#0BCH
B1:00A89D 128622            LCALL    ?L?COM0006
B1:00A8A0 54F0              ANL      A,#0F0H
B1:00A8A2 FD                MOV      R5,A
B1:00A8A3 7C00              MOV      R4,#00H
B1:00A8A5 1285E1            LCALL    _TransmitTimerStart
B1:00A8A8 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A8AA         ?C0499?ZW_TRANSPORT:
B1:00A8AA 90087A            MOV      DPTR,#rxFrame+07H
B1:00A8AD E0                MOVX     A,@DPTR
B1:00A8AE 20E102            JB       ACC.1,$ + 5H
B1:00A8B1 2184              AJMP     ?C0502?ZW_TRANSPORT
B1:00A8B3 E4                CLR      A
B1:00A8B4 90086E            MOV      DPTR,#tmp
B1:00A8B7 F0                MOVX     @DPTR,A
B1:00A8B8 128538            LCALL    ?L?COM0016
B1:00A8BB 4A                ORL      A,R2
B1:00A8BC 607C              JZ       ?C0503?ZW_TRANSPORT
B1:00A8BE E9                MOV      A,R1
B1:00A8BF 24B7              ADD      A,#0B7H
B1:00A8C1 128622            LCALL    ?L?COM0006
B1:00A8C4 FF                MOV      R7,A
B1:00A8C5 540F              ANL      A,#0FH
B1:00A8C7 6401              XRL      A,#01H
B1:00A8C9 706F              JNZ      ?C0503?ZW_TRANSPORT
B1:00A8CB EF                MOV      A,R7
B1:00A8CC 30E75F            JNB      ACC.7,?C0504?ZW_TRANSPORT
B1:00A8CF 128538            LCALL    ?L?COM0016
B1:00A8D2 24D8              ADD      A,#0D8H
B1:00A8D4 128622            LCALL    ?L?COM0006
B1:00A8D7 FF                MOV      R7,A
B1:00A8D8 D3                SETB     C
B1:00A8D9 940A              SUBB     A,#0AH
B1:00A8DB 5002              JNC      $ + 4H
B1:00A8DD 8128              AJMP     ?C0482?ZW_TRANSPORT
B1:00A8DF 128538            LCALL    ?L?COM0016
B1:00A8E2 24BC              ADD      A,#0BCH
B1:00A8E4 128622            LCALL    ?L?COM0006
B1:00A8E7 FE                MOV      R6,A
;---- Variable 'activeNumRepeatersNumHops' assigned to Register 'R6' ----
B1:00A8E8         ?C0506?ZW_TRANSPORT:
B1:00A8E8 EE                MOV      A,R6
B1:00A8E9 540F              ANL      A,#0FH
B1:00A8EB FD                MOV      R5,A
;---- Variable 'numHops' assigned to Register 'R5' ----
B1:00A8EC B40F02            CJNE     A,#0FH,?C0507?ZW_TRANSPORT
B1:00A8EF 802C              SJMP     ?C0624?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 277


B1:00A8F1         ?C0507?ZW_TRANSPORT:
B1:00A8F1 EF                MOV      A,R7
B1:00A8F2 D3                SETB     C
B1:00A8F3 940A              SUBB     A,#0AH
B1:00A8F5 5002              JNC      $ + 4H
B1:00A8F7 8128              AJMP     ?C0482?ZW_TRANSPORT
B1:00A8F9 128538            LCALL    ?L?COM0016
B1:00A8FC 24BD              ADD      A,#0BDH
B1:00A8FE F9                MOV      R1,A
B1:00A8FF E4                CLR      A
B1:00A900 3A                ADDC     A,R2
B1:00A901 FA                MOV      R2,A
B1:00A902 ED                MOV      A,R5
B1:00A903 758300            MOV      DPH,#00H
B1:00A906 29                ADD      A,R1
B1:00A907 F9                MOV      R1,A
B1:00A908 E583              MOV      A,DPH
B1:00A90A 3A                ADDC     A,R2
B1:00A90B FA                MOV      R2,A
B1:00A90C 121FB3            LCALL    ?C?CLDPTR
B1:00A90F 90086E            MOV      DPTR,#tmp
B1:00A912 F0                MOVX     @DPTR,A
B1:00A913         ?C0510?ZW_TRANSPORT:
B1:00A913 EE                MOV      A,R6
B1:00A914 54F0              ANL      A,#0F0H
B1:00A916 FF                MOV      R7,A
B1:00A917 C4                SWAP     A
B1:00A918 540F              ANL      A,#0FH
B1:00A91A B5050C            CJNE     A,AR5,?C0508?ZW_TRANSPORT
B1:00A91D         
B1:00A91D 128538            LCALL    ?L?COM0016
B1:00A920 24BA              ADD      A,#0BAH
B1:00A922 128622            LCALL    ?L?COM0006
B1:00A925 90086E            MOV      DPTR,#tmp
B1:00A928 F0                MOVX     @DPTR,A
B1:00A929         ?C0508?ZW_TRANSPORT:
B1:00A929 12E7DC            LCALL    SetTransmitPause
B1:00A92C 800C              SJMP     ?C0503?ZW_TRANSPORT
B1:00A92E         ?C0504?ZW_TRANSPORT:
B1:00A92E 128538            LCALL    ?L?COM0016
B1:00A931 24BA              ADD      A,#0BAH
B1:00A933 128622            LCALL    ?L?COM0006
B1:00A936 90086E            MOV      DPTR,#tmp
B1:00A939 F0                MOVX     @DPTR,A
B1:00A93A         ?C0503?ZW_TRANSPORT:
B1:00A93A 128538            LCALL    ?L?COM0016
B1:00A93D 4A                ORL      A,R2
B1:00A93E 7002              JNZ      $ + 4H
B1:00A940 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A942 9140              ACALL    ?L?COM0092
B1:00A944 2404              ADD      A,#04H
B1:00A946 128622            LCALL    ?L?COM0006
B1:00A949 FF                MOV      R7,A
B1:00A94A 90086E            MOV      DPTR,#tmp
B1:00A94D E0                MOVX     A,@DPTR
B1:00A94E 6F                XRL      A,R7
B1:00A94F 6008              JZ       ?C0514?ZW_TRANSPORT
B1:00A951 900780            MOV      DPTR,#sACK
B1:00A954 E0                MOVX     A,@DPTR
B1:00A955 7002              JNZ      $ + 4H
B1:00A957 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A959         ?C0514?ZW_TRANSPORT:
B1:00A959 9140              ACALL    ?L?COM0092
B1:00A95B 2405              ADD      A,#05H
B1:00A95D 128622            LCALL    ?L?COM0006
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 278


B1:00A960 30E70D            JNB      ACC.7,?C0515?ZW_TRANSPORT
B1:00A963 9140              ACALL    ?L?COM0092
B1:00A965 2409              ADD      A,#09H
B1:00A967 128622            LCALL    ?L?COM0006
B1:00A96A 5406              ANL      A,#06H
B1:00A96C 90076E            MOV      DPTR,#isRoutedAckErr
B1:00A96F F0                MOVX     @DPTR,A
B1:00A970         ?C0515?ZW_TRANSPORT:
B1:00A970 90076E            MOV      DPTR,#isRoutedAckErr
B1:00A973 E0                MOVX     A,@DPTR
B1:00A974 20E206            JB       ACC.2,?C0516?ZW_TRANSPORT
B1:00A977 12E7F7            LCALL    ?L?COM02AC
B1:00A97A 128629            LCALL    _HandleTransferAck
B1:00A97D         ?C0516?ZW_TRANSPORT:
B1:00A97D E4                CLR      A
B1:00A97E 90076E            MOV      DPTR,#isRoutedAckErr
B1:00A981 F0                MOVX     @DPTR,A
B1:00A982 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A984         ?C0502?ZW_TRANSPORT:
B1:00A984 90087A            MOV      DPTR,#rxFrame+07H
B1:00A987 E0                MOVX     A,@DPTR
B1:00A988 5422              ANL      A,#022H
B1:00A98A 6420              XRL      A,#020H
B1:00A98C 701B              JNZ      ?C0518?ZW_TRANSPORT
B1:00A98E 90399C            MOV      DPTR,#waitingForRoutedACK
B1:00A991 E0                MOVX     A,@DPTR
B1:00A992 7002              JNZ      $ + 4H
B1:00A994 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A996 12DDFA            LCALL    ?L?COM0344
B1:00A999 12C17A            LCALL    ?L?COM0505
B1:00A99C 12E7F7            LCALL    ?L?COM02AC
B1:00A99F AD07              MOV      R5,AR7
B1:00A9A1 12E89E            LCALL    ?L?COM0566
B1:00A9A4 12900D            LCALL    _HandleRoutedAck
B1:00A9A7 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A9A9         ?C0518?ZW_TRANSPORT:
B1:00A9A9 90087A            MOV      DPTR,#rxFrame+07H
B1:00A9AC E0                MOVX     A,@DPTR
B1:00A9AD 30E402            JNB      ACC.4,$ + 5H
B1:00A9B0 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A9B2 900780            MOV      DPTR,#sACK
B1:00A9B5 E0                MOVX     A,@DPTR
B1:00A9B6 30E202            JNB      ACC.2,$ + 5H
B1:00A9B9 4154              AJMP     ?C0528?ZW_TRANSPORT
B1:00A9BB 9140              ACALL    ?L?COM0092
B1:00A9BD 2408              ADD      A,#08H
B1:00A9BF 128622            LCALL    ?L?COM0006
B1:00A9C2 F4                CPL      A
B1:00A9C3 6023              JZ       ?C0522?ZW_TRANSPORT
B1:00A9C5 914E              ACALL    ?L?COM00A3
B1:00A9C7 540F              ANL      A,#0FH
B1:00A9C9 FF                MOV      R7,A
B1:00A9CA BF0203            CJNE     R7,#02H,?C0523?ZW_TRANSPORT
B1:00A9CD D3                SETB     C
B1:00A9CE 8001              SJMP     ?C0524?ZW_TRANSPORT
B1:00A9D0         ?C0523?ZW_TRANSPORT:
B1:00A9D0 C3                CLR      C
B1:00A9D1         ?C0524?ZW_TRANSPORT:
B1:00A9D1 4015              JC       ?C0522?ZW_TRANSPORT
B1:00A9D3 9140              ACALL    ?L?COM0092
B1:00A9D5 2406              ADD      A,#06H
B1:00A9D7 128622            LCALL    ?L?COM0006
B1:00A9DA 30E703            JNB      ACC.7,?C0525?ZW_TRANSPORT
B1:00A9DD 12DE98            LCALL    ZW_FollowUpReceived
B1:00A9E0         ?C0525?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 279


B1:00A9E0 12DDFA            LCALL    ?L?COM0344
B1:00A9E3 9160              ACALL    _StoreRoute
B1:00A9E5 12C17D            LCALL    _UpdateResponseRouteLastReturnRoute
B1:00A9E8         ?C0522?ZW_TRANSPORT:
B1:00A9E8 90087A            MOV      DPTR,#rxFrame+07H
B1:00A9EB E0                MOVX     A,@DPTR
B1:00A9EC 30E306            JNB      ACC.3,?C0526?ZW_TRANSPORT
B1:00A9EF 12E89E            LCALL    ?L?COM0566
B1:00A9F2 1290A9            LCALL    _SendRouteAck
B1:00A9F5         ?C0526?ZW_TRANSPORT:
B1:00A9F5 20375C            JB       productionTest,?C0528?ZW_TRANSPORT
B1:00A9F8 D138              ACALL    UpdateRxStatus
B1:00A9FA 900720            MOV      DPTR,#bRxStatus
B1:00A9FD EF                MOV      A,R7
B1:00A9FE F0                MOVX     @DPTR,A
B1:00A9FF 7A07              MOV      R2,#HIGH rxopt
B1:00AA01 797B              MOV      R1,#LOW rxopt
B1:00AA03 7D05              MOV      R5,#05H
B1:00AA05 12FDEF            LCALL    ?L?COM010B
B1:00AA08 900720            MOV      DPTR,#bRxStatus
B1:00AA0B E0                MOVX     A,@DPTR
B1:00AA0C 90077B            MOV      DPTR,#rxopt
B1:00AA0F F0                MOVX     @DPTR,A
B1:00AA10 9140              ACALL    ?L?COM0092
B1:00AA12 2404              ADD      A,#04H
B1:00AA14 128622            LCALL    ?L?COM0006
B1:00AA17 90077C            MOV      DPTR,#rxopt+01H
B1:00AA1A F0                MOVX     @DPTR,A
B1:00AA1B 12E7F7            LCALL    ?L?COM02AC
B1:00AA1E 90077E            MOV      DPTR,#rxopt+03H
B1:00AA21 EF                MOV      A,R7
B1:00AA22 F0                MOVX     @DPTR,A
B1:00AA23 900879            MOV      DPTR,#rxFrame+06H
B1:00AA26 E0                MOVX     A,@DPTR
B1:00AA27 FD                MOV      R5,A
B1:00AA28 7A07              MOV      R2,#HIGH rxopt
B1:00AA2A 797B              MOV      R1,#LOW rxopt
B1:00AA2C 12EE36            LCALL    ?L?COM03FF
B1:00AA2F 900876            MOV      DPTR,#rxFrame+03H
B1:00AA32 122589            LCALL    ?C?PLDXDATA
B1:00AA35 12B26B            LCALL    _CommandHandler
B1:00AA38 801A              SJMP     ?C0528?ZW_TRANSPORT
B1:00AA3A         ?C0498?ZW_TRANSPORT:
B1:00AA3A 128538            LCALL    ?L?COM0016
B1:00AA3D 4A                ORL      A,R2
B1:00AA3E 6014              JZ       ?C0528?ZW_TRANSPORT
B1:00AA40 903998            MOV      DPTR,#bRetransmitTimer
B1:00AA43 E0                MOVX     A,@DPTR
B1:00AA44 600E              JZ       ?C0528?ZW_TRANSPORT
B1:00AA46 900779            MOV      DPTR,#bRestartAckTimerAllowed
B1:00AA49 E0                MOVX     A,@DPTR
B1:00AA4A 6008              JZ       ?C0528?ZW_TRANSPORT
B1:00AA4C 121C2D            LCALL    ?INTERBANK_TABLE?TransportTimerRestart
B1:00AA4F E4                CLR      A
B1:00AA50 900779            MOV      DPTR,#bRestartAckTimerAllowed
B1:00AA53 F0                MOVX     @DPTR,A
B1:00AA54         ?C0528?ZW_TRANSPORT:
B1:00AA54 90087A            MOV      DPTR,#rxFrame+07H
B1:00AA57 E0                MOVX     A,@DPTR
B1:00AA58 20E409            JB       ACC.4,?C0532?ZW_TRANSPORT
B1:00AA5B 900780            MOV      DPTR,#sACK
B1:00AA5E E0                MOVX     A,@DPTR
B1:00AA5F 20E202            JB       ACC.2,$ + 5H
B1:00AA62 8128              AJMP     ?C0482?ZW_TRANSPORT
B1:00AA64         ?C0532?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 280


B1:00AA64 7F02              MOV      R7,#02H
B1:00AA66 128350            LCALL    _TxQueueGetElement
B1:00AA69 900727            MOV      DPTR,#pFrameToRepeat
B1:00AA6C 12976A            LCALL    ?L?COM02DF
B1:00AA6F 7003              JNZ      ?C0533?ZW_TRANSPORT
B1:00AA71 C209              CLR      inclusionHomeIDActive
B1:00AA73 22                RET      
B1:00AA74         ?C0533?ZW_TRANSPORT:
B1:00AA74 D209              SETB     inclusionHomeIDActive
B1:00AA76 12FED6            LCALL    ?L?COM050C
B1:00AA79 126149            LCALL    ?L?COM0047
B1:00AA7C 12FEE6            LCALL    ?L?COM0565
B1:00AA7F 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00AA82 E0                MOVX     A,@DPTR
B1:00AA83 90086E            MOV      DPTR,#tmp
B1:00AA86 F0                MOVX     @DPTR,A
B1:00AA87 900727            MOV      DPTR,#pFrameToRepeat
B1:00AA8A 125C41            LCALL    ?L?COM00B6
B1:00AA8D 7403              MOV      A,#03H
B1:00AA8F 122072            LCALL    ?C?CSTPTR
B1:00AA92 900879            MOV      DPTR,#rxFrame+06H
B1:00AA95 E0                MOVX     A,@DPTR
B1:00AA96 12FDD4            LCALL    ?L?COM062B
B1:00AA99 14                DEC      A
B1:00AA9A 912A              ACALL    ?L?COM0129
B1:00AA9C 24D8              ADD      A,#0D8H
B1:00AA9E 1287E0            LCALL    ?L?COM002E
B1:00AAA1 D3                SETB     C
B1:00AAA2 9426              SUBB     A,#026H
B1:00AAA4 4004              JC       ?C0534?ZW_TRANSPORT
B1:00AAA6 7F26              MOV      R7,#026H
B1:00AAA8 8008              SJMP     ?C0535?ZW_TRANSPORT
B1:00AAAA         ?C0534?ZW_TRANSPORT:
B1:00AAAA 912B              ACALL    ?L?COM012A
B1:00AAAC 24D8              ADD      A,#0D8H
B1:00AAAE 128622            LCALL    ?L?COM0006
B1:00AAB1 FF                MOV      R7,A
B1:00AAB2         ?C0535?ZW_TRANSPORT:
B1:00AAB2 912B              ACALL    ?L?COM012A
B1:00AAB4 128FCA            LCALL    ?L?COM0193
B1:00AAB7 C003              PUSH     AR3
B1:00AAB9 C002              PUSH     AR2
B1:00AABB C001              PUSH     AR1
B1:00AABD 900873            MOV      DPTR,#rxFrame
B1:00AAC0 122589            LCALL    ?C?PLDXDATA
B1:00AAC3 126149            LCALL    ?L?COM0047
B1:00AAC6 D001              POP      AR1
B1:00AAC8 D002              POP      AR2
B1:00AACA D003              POP      AR3
B1:00AACC 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00AACF         ?C0536?ZW_TRANSPORT:
B1:00AACF 900879            MOV      DPTR,#rxFrame+06H
B1:00AAD2 9129              ACALL    ?L?COM0128
B1:00AAD4 24B1              ADD      A,#0B1H
B1:00AAD6 1287E0            LCALL    ?L?COM002E
B1:00AAD9 D3                SETB     C
B1:00AADA 94A9              SUBB     A,#0A9H
B1:00AADC 4004              JC       ?C0537?ZW_TRANSPORT
B1:00AADE 7FA9              MOV      R7,#0A9H
B1:00AAE0 8008              SJMP     ?C0538?ZW_TRANSPORT
B1:00AAE2         ?C0537?ZW_TRANSPORT:
B1:00AAE2 912B              ACALL    ?L?COM012A
B1:00AAE4 24B1              ADD      A,#0B1H
B1:00AAE6 128622            LCALL    ?L?COM0006
B1:00AAE9 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 281


B1:00AAEA         ?C0538?ZW_TRANSPORT:
B1:00AAEA 912B              ACALL    ?L?COM012A
B1:00AAEC 12C7CB            LCALL    ?L?COM0188
B1:00AAEF C003              PUSH     AR3
B1:00AAF1 C002              PUSH     AR2
B1:00AAF3 C001              PUSH     AR1
B1:00AAF5 900876            MOV      DPTR,#rxFrame+03H
B1:00AAF8 122589            LCALL    ?C?PLDXDATA
B1:00AAFB 126149            LCALL    ?L?COM0047
B1:00AAFE D001              POP      AR1
B1:00AB00 D002              POP      AR2
B1:00AB02 D003              POP      AR3
B1:00AB04 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00AB07         ?C0539?ZW_TRANSPORT:
B1:00AB07 912B              ACALL    ?L?COM012A
B1:00AB09 24BC              ADD      A,#0BCH
B1:00AB0B 128622            LCALL    ?L?COM0006
B1:00AB0E FF                MOV      R7,A
B1:00AB0F 540F              ANL      A,#0FH
B1:00AB11 FE                MOV      R6,A
;---- Variable 'numHops1' assigned to Register 'R6' ----
B1:00AB12 912B              ACALL    ?L?COM012A
B1:00AB14 24BB              ADD      A,#0BBH
B1:00AB16 128622            LCALL    ?L?COM0006
B1:00AB19 30E025            JNB      ACC.0,?C0540?ZW_TRANSPORT
B1:00AB1C 1E                DEC      R6
B1:00AB1D EE                MOV      A,R6
B1:00AB1E 900727            MOV      DPTR,#pFrameToRepeat
B1:00AB21 B4FF0D            CJNE     A,#0FFH,?C0541?ZW_TRANSPORT
B1:00AB24 122589            LCALL    ?C?PLDXDATA
B1:00AB27 E9                MOV      A,R1
B1:00AB28 24B7              ADD      A,#0B7H
B1:00AB2A 128622            LCALL    ?L?COM0006
B1:00AB2D 4440              ORL      A,#040H
B1:00AB2F 800B              SJMP     ?C0625?ZW_TRANSPORT
B1:00AB31         ?C0541?ZW_TRANSPORT:
B1:00AB31 122589            LCALL    ?C?PLDXDATA
B1:00AB34 E9                MOV      A,R1
B1:00AB35 24B7              ADD      A,#0B7H
B1:00AB37 128622            LCALL    ?L?COM0006
B1:00AB3A 54BF              ANL      A,#0BFH
B1:00AB3C         
B1:00AB3C 122072            LCALL    ?C?CSTPTR
B1:00AB3F 8051              SJMP     ?C0543?ZW_TRANSPORT
B1:00AB41         ?C0540?ZW_TRANSPORT:
B1:00AB41 EF                MOV      A,R7
B1:00AB42 C4                SWAP     A
B1:00AB43 540F              ANL      A,#0FH
B1:00AB45 14                DEC      A
B1:00AB46 6E                XRL      A,R6
B1:00AB47 7048              JNZ      ?C0544?ZW_TRANSPORT
B1:00AB49 9140              ACALL    ?L?COM0092
B1:00AB4B 2409              ADD      A,#09H
B1:00AB4D 128622            LCALL    ?L?COM0006
B1:00AB50 30E33E            JNB      ACC.3,?C0544?ZW_TRANSPORT
B1:00AB53 9140              ACALL    ?L?COM0092
B1:00AB55 240A              ADD      A,#0AH
B1:00AB57 128622            LCALL    ?L?COM0006
B1:00AB5A 12D98B            LCALL    ?L?COM01DE
B1:00AB5D 9140              ACALL    ?L?COM0092
B1:00AB5F 12DB6B            LCALL    ?L?COM00D2
B1:00AB62 12E780            LCALL    ?L?COM039C
B1:00AB65 540F              ANL      A,#0FH
B1:00AB67 7028              JNZ      ?C0544?ZW_TRANSPORT
B1:00AB69 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 282


B1:00AB6A 2401              ADD      A,#01H
B1:00AB6C 128622            LCALL    ?L?COM0006
B1:00AB6F 5460              ANL      A,#060H
B1:00AB71 FF                MOV      R7,A
B1:00AB72 601D              JZ       ?C0544?ZW_TRANSPORT
B1:00AB74 90086E            MOV      DPTR,#tmp
B1:00AB77 E0                MOVX     A,@DPTR
B1:00AB78 BF2005            CJNE     R7,#020H,?C0546?ZW_TRANSPORT
B1:00AB7B 4420              ORL      A,#020H
B1:00AB7D F0                MOVX     @DPTR,A
B1:00AB7E 8003              SJMP     ?C0547?ZW_TRANSPORT
B1:00AB80         ?C0546?ZW_TRANSPORT:
B1:00AB80 4440              ORL      A,#040H
B1:00AB82 F0                MOVX     @DPTR,A
B1:00AB83         ?C0547?ZW_TRANSPORT:
B1:00AB83 912B              ACALL    ?L?COM012A
B1:00AB85 24BA              ADD      A,#0BAH
B1:00AB87 128622            LCALL    ?L?COM0006
B1:00AB8A 912A              ACALL    ?L?COM0129
B1:00AB8C 24D9              ADD      A,#0D9H
B1:00AB8E 1287E0            LCALL    ?L?COM002E
B1:00AB91         ?C0544?ZW_TRANSPORT:
B1:00AB91 0E                INC      R6
B1:00AB92         ?C0543?ZW_TRANSPORT:
B1:00AB92 912B              ACALL    ?L?COM012A
B1:00AB94 24BC              ADD      A,#0BCH
B1:00AB96 128622            LCALL    ?L?COM0006
B1:00AB99 54F0              ANL      A,#0F0H
B1:00AB9B FF                MOV      R7,A
B1:00AB9C EE                MOV      A,R6
B1:00AB9D 540F              ANL      A,#0FH
B1:00AB9F 4F                ORL      A,R7
B1:00ABA0 122072            LCALL    ?C?CSTPTR
B1:00ABA3 912B              ACALL    ?L?COM012A
B1:00ABA5 24BB              ADD      A,#0BBH
B1:00ABA7 128622            LCALL    ?L?COM0006
B1:00ABAA 30E126            JNB      ACC.1,?C0548?ZW_TRANSPORT
B1:00ABAD 30E323            JNB      ACC.3,?C0548?ZW_TRANSPORT
B1:00ABB0 912B              ACALL    ?L?COM012A
B1:00ABB2 24BC              ADD      A,#0BCH
B1:00ABB4 128622            LCALL    ?L?COM0006
B1:00ABB7 900727            MOV      DPTR,#pFrameToRepeat
B1:00ABBA 128FDC            LCALL    ?L?COM004D
B1:00ABBD 121FB3            LCALL    ?C?CLDPTR
B1:00ABC0 540F              ANL      A,#0FH
B1:00ABC2 FF                MOV      R7,A
B1:00ABC3 BF010D            CJNE     R7,#01H,?C0548?ZW_TRANSPORT
B1:00ABC6 12E7F7            LCALL    ?L?COM02AC
B1:00ABC9 AD07              MOV      R5,AR7
B1:00ABCB 912B              ACALL    ?L?COM012A
B1:00ABCD 128FCA            LCALL    ?L?COM0193
B1:00ABD0 12D94D            LCALL    _UpdateRssiInRepeatedFrame
B1:00ABD3         ?C0548?ZW_TRANSPORT:
B1:00ABD3 900727            MOV      DPTR,#pFrameToRepeat
B1:00ABD6 128FD5            LCALL    ?L?COM0057
B1:00ABD9 128622            LCALL    ?L?COM0006
B1:00ABDC 4420              ORL      A,#020H
B1:00ABDE 122072            LCALL    ?C?CSTPTR
B1:00ABE1 90086E            MOV      DPTR,#tmp
B1:00ABE4 9129              ACALL    ?L?COM0128
B1:00ABE6 24B6              ADD      A,#0B6H
B1:00ABE8 128622            LCALL    ?L?COM0006
B1:00ABEB FD                MOV      R5,A
B1:00ABEC 912B              ACALL    ?L?COM012A
B1:00ABEE 24BA              ADD      A,#0BAH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 283


B1:00ABF0 128622            LCALL    ?L?COM0006
B1:00ABF3 FB                MOV      R3,A
B1:00ABF4 C003              PUSH     AR3
B1:00ABF6 912B              ACALL    ?L?COM012A
B1:00ABF8 12C7CB            LCALL    ?L?COM0188
B1:00ABFB 12978D            LCALL    ?L?COM0394
B1:00ABFE 912B              ACALL    ?L?COM012A
B1:00AC00 24B1              ADD      A,#0B1H
B1:00AC02 128622            LCALL    ?L?COM0006
B1:00AC05 12FEAB            LCALL    ?L?COM0421
B1:00AC08 900727            MOV      DPTR,#pFrameToRepeat
B1:00AC0B 128FD5            LCALL    ?L?COM0057
B1:00AC0E 128622            LCALL    ?L?COM0006
B1:00AC11 9009FC            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:00AC14 F0                MOVX     @DPTR,A
B1:00AC15 A3                INC      DPTR
B1:00AC16 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ZWRepeatComplete
B1:00AC18 F0                MOVX     @DPTR,A
B1:00AC19 A3                INC      DPTR
B1:00AC1A 7476              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ZWRepeatComplete
B1:00AC1C F0                MOVX     @DPTR,A
B1:00AC1D 900727            MOV      DPTR,#pFrameToRepeat
B1:00AC20 129781            LCALL    ?L?COM02DB
B1:00AC23 D003              POP      AR3
B1:00AC25 1292BF            LCALL    _EnqueueSingleDataPtr
B1:00AC28         ?C0482?ZW_TRANSPORT:
B1:00AC28 22                RET      
----- FUNCTION _ReceiveHandler (END) -------


----- FUNCTION ?L?COM0128 (BEGIN) -----
B1:00AC29 E0                MOVX     A,@DPTR
B1:00AC2A         ?L?COM0129:
B1:00AC2A FF                MOV      R7,A
B1:00AC2B         ?L?COM012A:
B1:00AC2B 900727            MOV      DPTR,#pFrameToRepeat
B1:00AC2E 122589            LCALL    ?C?PLDXDATA
B1:00AC31 E9                MOV      A,R1
B1:00AC32 22                RET      
----- FUNCTION ?L?COM0128 (END) -------


----- FUNCTION ?L?COM0091 (BEGIN) -----
B1:00AC33 E9                MOV      A,R1
B1:00AC34 2401              ADD      A,#01H
B1:00AC36 F9                MOV      R1,A
B1:00AC37 E4                CLR      A
B1:00AC38 3A                ADDC     A,R2
B1:00AC39 FA                MOV      R2,A
B1:00AC3A 900721            MOV      DPTR,#protPayloadCmd
B1:00AC3D 1225A9            LCALL    ?C?PSTXDATA
B1:00AC40         ?L?COM0092:
B1:00AC40 900873            MOV      DPTR,#rxFrame
B1:00AC43 122589            LCALL    ?C?PLDXDATA
B1:00AC46 E9                MOV      A,R1
B1:00AC47 22                RET      
----- FUNCTION ?L?COM0091 (END) -------


----- FUNCTION ?L?COM0315 (BEGIN) -----
B1:00AC48 90071D            MOV      DPTR,#pACKFrame
B1:00AC4B 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0315 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 284


----- FUNCTION ?L?COM00A3 (BEGIN) -----
B1:00AC4E 900717            MOV      DPTR,#pData
B1:00AC51         ?L?COM00A4:
B1:00AC51 E0                MOVX     A,@DPTR
B1:00AC52 FE                MOV      R6,A
B1:00AC53 A3                INC      DPTR
B1:00AC54 E0                MOVX     A,@DPTR
B1:00AC55         ?L?COM00A5:
B1:00AC55 7B01              MOV      R3,#01H
B1:00AC57 2405              ADD      A,#05H
B1:00AC59         ?L?COM00A6:
B1:00AC59 F9                MOV      R1,A
B1:00AC5A E4                CLR      A
B1:00AC5B 3E                ADDC     A,R6
B1:00AC5C FA                MOV      R2,A
B1:00AC5D 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM00A3 (END) -------


----- FUNCTION _StoreRoute (BEGIN) -----
B1:00AC60 904177            MOV      DPTR,#pData
B1:00AC63 EE                MOV      A,R6
B1:00AC64 F0                MOVX     @DPTR,A
B1:00AC65 A3                INC      DPTR
B1:00AC66 EF                MOV      A,R7
B1:00AC67 F0                MOVX     @DPTR,A
B1:00AC68 20160F            JB       bRouteCached,?C0022?ZW_ROUTING_ALL
B1:00AC6B 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00AC6E E0                MOVX     A,@DPTR
B1:00AC6F B4010B            CJNE     A,#01H,?C0021?ZW_ROUTING_ALL
B1:00AC72 904177            MOV      DPTR,#pData
B1:00AC75 9151              ACALL    ?L?COM00A4
B1:00AC77 20E703            JB       ACC.7,?C0021?ZW_ROUTING_ALL
B1:00AC7A         ?C0022?ZW_ROUTING_ALL:
B1:00AC7A 7FFF              MOV      R7,#0FFH
B1:00AC7C 22                RET      
B1:00AC7D         ?C0021?ZW_ROUTING_ALL:
B1:00AC7D D120              ACALL    ?L?COM0351
B1:00AC7F 7B01              MOV      R3,#01H
B1:00AC81 2404              ADD      A,#04H
B1:00AC83 9159              ACALL    ?L?COM00A6
B1:00AC85 12DA4B            LCALL    ?L?COM0163
B1:00AC88 6002              JZ       ?C0024?ZW_ROUTING_ALL
B1:00AC8A 8009              SJMP     ?C0025?ZW_ROUTING_ALL
B1:00AC8C         ?C0024?ZW_ROUTING_ALL:
B1:00AC8C D120              ACALL    ?L?COM0351
B1:00AC8E 7B01              MOV      R3,#01H
B1:00AC90 2408              ADD      A,#08H
B1:00AC92 9159              ACALL    ?L?COM00A6
B1:00AC94 FF                MOV      R7,A
B1:00AC95         ?C0025?ZW_ROUTING_ALL:
;---- Variable 'bNodeID' assigned to Register 'R5' ----
B1:00AC95 AD07              MOV      R5,AR7
B1:00AC97 12E9AA            LCALL    _GetResponseRouteIndex
B1:00AC9A 90417B            MOV      DPTR,#routetmp
B1:00AC9D EF                MOV      A,R7
B1:00AC9E F0                MOVX     @DPTR,A
B1:00AC9F F4                CPL      A
B1:00ACA0 7050              JNZ      ?C0026?ZW_ROUTING_ALL
B1:00ACA2 12FE07            LCALL    ?L?COM0629
B1:00ACA5 5036              JNC      ?C0027?ZW_ROUTING_ALL
B1:00ACA7 E0                MOVX     A,@DPTR
B1:00ACA8 04                INC      A
B1:00ACA9 F0                MOVX     @DPTR,A
B1:00ACAA E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 285


B1:00ACAB 90417B            MOV      DPTR,#routetmp
B1:00ACAE F0                MOVX     @DPTR,A
B1:00ACAF         ?C0028?ZW_ROUTING_ALL:
B1:00ACAF 90417B            MOV      DPTR,#routetmp
B1:00ACB2 E0                MOVX     A,@DPTR
B1:00ACB3 FF                MOV      R7,A
B1:00ACB4 C3                CLR      C
B1:00ACB5 9402              SUBB     A,#02H
B1:00ACB7 5010              JNC      ?C0029?ZW_ROUTING_ALL
B1:00ACB9 741E              MOV      A,#LOW responseRouteNodeID
B1:00ACBB 2F                ADD      A,R7
B1:00ACBC F192              ACALL    ?L?COM02B9
B1:00ACBE E0                MOVX     A,@DPTR
B1:00ACBF 6008              JZ       ?C0029?ZW_ROUTING_ALL
B1:00ACC1         ?C0031?ZW_ROUTING_ALL:
B1:00ACC1         ?C0030?ZW_ROUTING_ALL:
B1:00ACC1 90417B            MOV      DPTR,#routetmp
B1:00ACC4 E0                MOVX     A,@DPTR
B1:00ACC5 04                INC      A
B1:00ACC6 F0                MOVX     @DPTR,A
B1:00ACC7 80E6              SJMP     ?C0028?ZW_ROUTING_ALL
B1:00ACC9         ?C0029?ZW_ROUTING_ALL:
B1:00ACC9 90417B            MOV      DPTR,#routetmp
B1:00ACCC E0                MOVX     A,@DPTR
B1:00ACCD B40203            CJNE     A,#02H,?C0032?ZW_ROUTING_ALL
B1:00ACD0 7401              MOV      A,#01H
B1:00ACD2 F0                MOVX     @DPTR,A
B1:00ACD3         ?C0032?ZW_ROUTING_ALL:
B1:00ACD3 90417B            MOV      DPTR,#routetmp
B1:00ACD6 E0                MOVX     A,@DPTR
B1:00ACD7 24FF              ADD      A,#0FFH
B1:00ACD9 9215              MOV      responseRouteLI,C
B1:00ACDB 8015              SJMP     ?C0026?ZW_ROUTING_ALL
B1:00ACDD         ?C0027?ZW_ROUTING_ALL:
B1:00ACDD 20170C            JB       routesLocked,?C0034?ZW_ROUTING_ALL
B1:00ACE0 B215              CPL      responseRouteLI
B1:00ACE2 A215              MOV      C,responseRouteLI
B1:00ACE4 E4                CLR      A
B1:00ACE5 33                RLC      A
B1:00ACE6 90417B            MOV      DPTR,#routetmp
B1:00ACE9 F0                MOVX     @DPTR,A
B1:00ACEA 8006              SJMP     ?C0026?ZW_ROUTING_ALL
B1:00ACEC         ?C0034?ZW_ROUTING_ALL:
B1:00ACEC 90417B            MOV      DPTR,#routetmp
B1:00ACEF 7401              MOV      A,#01H
B1:00ACF1 F0                MOVX     @DPTR,A
B1:00ACF2         ?C0026?ZW_ROUTING_ALL:
B1:00ACF2 90417B            MOV      DPTR,#routetmp
B1:00ACF5 F18F              ACALL    ?L?COM02B8
B1:00ACF7 ED                MOV      A,R5
B1:00ACF8 D11F              ACALL    ?L?COM0350
B1:00ACFA FF                MOV      R7,A
B1:00ACFB 9155              ACALL    ?L?COM00A5
B1:00ACFD 20E702            JB       ACC.7,$ + 5H
B1:00AD00 A1B3              AJMP     ?C0036?ZW_ROUTING_ALL
B1:00AD02 EF                MOV      A,R7
B1:00AD03 2409              ADD      A,#09H
B1:00AD05 9159              ACALL    ?L?COM00A6
B1:00AD07 30E329            JNB      ACC.3,?C0037?ZW_ROUTING_ALL
B1:00AD0A 904177            MOV      DPTR,#pData
B1:00AD0D A3                INC      DPTR
B1:00AD0E E0                MOVX     A,@DPTR
B1:00AD0F 240A              ADD      A,#0AH
B1:00AD11 9159              ACALL    ?L?COM00A6
B1:00AD13 12D98B            LCALL    ?L?COM01DE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 286


B1:00AD16 EF                MOV      A,R7
B1:00AD17 240B              ADD      A,#0BH
B1:00AD19 F9                MOV      R1,A
B1:00AD1A E4                CLR      A
B1:00AD1B 3E                ADDC     A,R6
B1:00AD1C FA                MOV      R2,A
B1:00AD1D 12D992            LCALL    ?L?COM0501
B1:00AD20 E9                MOV      A,R1
B1:00AD21 2401              ADD      A,#01H
B1:00AD23 128622            LCALL    ?L?COM0006
B1:00AD26 5418              ANL      A,#018H
B1:00AD28 FF                MOV      R7,A
B1:00AD29 90417B            MOV      DPTR,#routetmp
B1:00AD2C E0                MOVX     A,@DPTR
B1:00AD2D D1AF              ACALL    ?L?COM02AA
B1:00AD2F EF                MOV      A,R7
B1:00AD30 F0                MOVX     @DPTR,A
B1:00AD31 8008              SJMP     ?C0038?ZW_ROUTING_ALL
B1:00AD33         ?C0037?ZW_ROUTING_ALL:
B1:00AD33 90417B            MOV      DPTR,#routetmp
B1:00AD36 E0                MOVX     A,@DPTR
B1:00AD37 D1AF              ACALL    ?L?COM02AA
B1:00AD39 E4                CLR      A
B1:00AD3A F0                MOVX     @DPTR,A
B1:00AD3B         ?C0038?ZW_ROUTING_ALL:
B1:00AD3B D120              ACALL    ?L?COM0351
B1:00AD3D 7B01              MOV      R3,#01H
B1:00AD3F 240A              ADD      A,#0AH
B1:00AD41 9159              ACALL    ?L?COM00A6
B1:00AD43 C4                SWAP     A
B1:00AD44 540F              ANL      A,#0FH
B1:00AD46 FF                MOV      R7,A
;---- Variable 'routeLen' assigned to Register 'R7' ----
B1:00AD47 90417B            MOV      DPTR,#routetmp
B1:00AD4A D12D              ACALL    ?L?COM013C
B1:00AD4C EF                MOV      A,R7
B1:00AD4D F0                MOVX     @DPTR,A
B1:00AD4E 904177            MOV      DPTR,#pData
B1:00AD51 E0                MOVX     A,@DPTR
B1:00AD52 FC                MOV      R4,A
B1:00AD53 A3                INC      DPTR
B1:00AD54 E0                MOVX     A,@DPTR
B1:00AD55 240B              ADD      A,#0BH
B1:00AD57 F9                MOV      R1,A
B1:00AD58 E4                CLR      A
B1:00AD59 3C                ADDC     A,R4
B1:00AD5A AD01              MOV      R5,AR1
B1:00AD5C A3                INC      DPTR
B1:00AD5D F0                MOVX     @DPTR,A
B1:00AD5E A3                INC      DPTR
B1:00AD5F ED                MOV      A,R5
B1:00AD60 F0                MOVX     @DPTR,A
B1:00AD61 904177            MOV      DPTR,#pData
B1:00AD64 A3                INC      DPTR
B1:00AD65 E0                MOVX     A,@DPTR
B1:00AD66 2409              ADD      A,#09H
B1:00AD68 F9                MOV      R1,A
B1:00AD69 E4                CLR      A
B1:00AD6A 3C                ADDC     A,R4
B1:00AD6B FA                MOV      R2,A
B1:00AD6C 121FB3            LCALL    ?C?CLDPTR
B1:00AD6F 20E01E            JB       ACC.0,?C0039?ZW_ROUTING_ALL
B1:00AD72         ?C0040?ZW_ROUTING_ALL:
B1:00AD72 AE07              MOV      R6,AR7
B1:00AD74 1F                DEC      R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 287


B1:00AD75 EE                MOV      A,R6
B1:00AD76 6051              JZ       ?C0045?ZW_ROUTING_ALL
B1:00AD78 F1A5              ACALL    ?L?COM0229
B1:00AD7A E0                MOVX     A,@DPTR
B1:00AD7B FE                MOV      R6,A
B1:00AD7C 90417B            MOV      DPTR,#routetmp
B1:00AD7F D1B9              ACALL    ?L?COM0115
B1:00AD81 E582              MOV      A,DPL
B1:00AD83 2F                ADD      A,R7
B1:00AD84 F19D              ACALL    ?L?COM01F5
B1:00AD86 EE                MOV      A,R6
B1:00AD87 F0                MOVX     @DPTR,A
B1:00AD88 904179            MOV      DPTR,#bPtr
B1:00AD8B 123F7F            LCALL    ?L?COM0081
B1:00AD8E 80E2              SJMP     ?C0040?ZW_ROUTING_ALL
B1:00AD90         ?C0039?ZW_ROUTING_ALL:
;---- Variable 'i' assigned to Register 'R6' ----
B1:00AD90 E4                CLR      A
B1:00AD91 FE                MOV      R6,A
B1:00AD92         ?C0043?ZW_ROUTING_ALL:
B1:00AD92 AD07              MOV      R5,AR7
B1:00AD94 1F                DEC      R7
B1:00AD95 ED                MOV      A,R5
B1:00AD96 6031              JZ       ?C0045?ZW_ROUTING_ALL
B1:00AD98 F1A5              ACALL    ?L?COM0229
B1:00AD9A E0                MOVX     A,@DPTR
B1:00AD9B FD                MOV      R5,A
B1:00AD9C AC06              MOV      R4,AR6
B1:00AD9E 0E                INC      R6
B1:00AD9F 90417B            MOV      DPTR,#routetmp
B1:00ADA2 D1B9              ACALL    ?L?COM0115
B1:00ADA4 E582              MOV      A,DPL
B1:00ADA6 2C                ADD      A,R4
B1:00ADA7 F19D              ACALL    ?L?COM01F5
B1:00ADA9 ED                MOV      A,R5
B1:00ADAA F0                MOVX     @DPTR,A
B1:00ADAB 904179            MOV      DPTR,#bPtr
B1:00ADAE 123F7F            LCALL    ?L?COM0081
B1:00ADB1 80DF              SJMP     ?C0043?ZW_ROUTING_ALL
B1:00ADB3         ?C0036?ZW_ROUTING_ALL:
B1:00ADB3 90417B            MOV      DPTR,#routetmp
B1:00ADB6 E0                MOVX     A,@DPTR
B1:00ADB7 FF                MOV      R7,A
B1:00ADB8 D12E              ACALL    ?L?COM013D
B1:00ADBA E4                CLR      A
B1:00ADBB F0                MOVX     @DPTR,A
B1:00ADBC 741C              MOV      A,#LOW responseRouteRFOption
B1:00ADBE 2F                ADD      A,R7
B1:00ADBF D1B1              ACALL    ?L?COM02AB
B1:00ADC1 E4                CLR      A
B1:00ADC2 F0                MOVX     @DPTR,A
B1:00ADC3 EF                MOV      A,R7
B1:00ADC4 D1BA              ACALL    ?L?COM0116
B1:00ADC6 74FE              MOV      A,#0FEH
B1:00ADC8 F0                MOVX     @DPTR,A
B1:00ADC9         ?C0045?ZW_ROUTING_ALL:
B1:00ADC9 90417B            MOV      DPTR,#routetmp
B1:00ADCC D12D              ACALL    ?L?COM013C
B1:00ADCE C083              PUSH     DPH
B1:00ADD0 C082              PUSH     DPL
B1:00ADD2 E0                MOVX     A,@DPTR
B1:00ADD3 FF                MOV      R7,A
B1:00ADD4 12FDFF            LCALL    ?L?COM0628
B1:00ADD7 FE                MOV      R6,A
B1:00ADD8 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 288


B1:00ADD9 4E                ORL      A,R6
B1:00ADDA D082              POP      DPL
B1:00ADDC D083              POP      DPH
B1:00ADDE D11F              ACALL    ?L?COM0350
B1:00ADE0 FF                MOV      R7,A
B1:00ADE1 9155              ACALL    ?L?COM00A5
B1:00ADE3 30E708            JNB      ACC.7,?C0048?ZW_ROUTING_ALL
B1:00ADE6 EF                MOV      A,R7
B1:00ADE7 2409              ADD      A,#09H
B1:00ADE9 9159              ACALL    ?L?COM00A6
B1:00ADEB 20E408            JB       ACC.4,?C0047?ZW_ROUTING_ALL
B1:00ADEE         ?C0048?ZW_ROUTING_ALL:
B1:00ADEE 904177            MOV      DPTR,#pData
B1:00ADF1 9151              ACALL    ?L?COM00A4
B1:00ADF3 30E40F            JNB      ACC.4,?C0046?ZW_ROUTING_ALL
B1:00ADF6         ?C0047?ZW_ROUTING_ALL:
B1:00ADF6 12EC25            LCALL    ?L?COM05B6
B1:00ADF9 12C72C            LCALL    ?L?COM01ED
B1:00ADFC 8002              SJMP     ?C0085?ZW_ROUTING_ALL
B1:00ADFE         ?C0084?ZW_ROUTING_ALL:
B1:00ADFE C3                CLR      C
B1:00ADFF 33                RLC      A
B1:00AE00         ?C0085?ZW_ROUTING_ALL:
B1:00AE00 D8FC              DJNZ     R0,?C0084?ZW_ROUTING_ALL
B1:00AE02 4F                ORL      A,R7
B1:00AE03 800E              SJMP     ?C0094?ZW_ROUTING_ALL
B1:00AE05         ?C0046?ZW_ROUTING_ALL:
B1:00AE05 12EC25            LCALL    ?L?COM05B6
B1:00AE08 12C72C            LCALL    ?L?COM01ED
B1:00AE0B 8002              SJMP     ?C0087?ZW_ROUTING_ALL
B1:00AE0D         ?C0086?ZW_ROUTING_ALL:
B1:00AE0D C3                CLR      C
B1:00AE0E 33                RLC      A
B1:00AE0F         ?C0087?ZW_ROUTING_ALL:
B1:00AE0F D8FC              DJNZ     R0,?C0086?ZW_ROUTING_ALL
B1:00AE11 F4                CPL      A
B1:00AE12 5F                ANL      A,R7
B1:00AE13         
B1:00AE13 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00AE16 F0                MOVX     @DPTR,A
B1:00AE17         ?C0049?ZW_ROUTING_ALL:
B1:00AE17 D216              SETB     bRouteCached
B1:00AE19 90417B            MOV      DPTR,#routetmp
B1:00AE1C E0                MOVX     A,@DPTR
B1:00AE1D FF                MOV      R7,A
B1:00AE1E 22                RET      
----- FUNCTION _StoreRoute (END) -------


----- FUNCTION ?L?COM0350 (BEGIN) -----
B1:00AE1F F0                MOVX     @DPTR,A
B1:00AE20         ?L?COM0351:
B1:00AE20 904177            MOV      DPTR,#pData
B1:00AE23 E0                MOVX     A,@DPTR
B1:00AE24 FE                MOV      R6,A
B1:00AE25 A3                INC      DPTR
B1:00AE26 E0                MOVX     A,@DPTR
B1:00AE27 22                RET      
----- FUNCTION ?L?COM0350 (END) -------


----- FUNCTION ?L?COM013B (BEGIN) -----
B1:00AE28 EF                MOV      A,R7
B1:00AE29 F0                MOVX     @DPTR,A
B1:00AE2A 904213            MOV      DPTR,#bResponseRouteIndex
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 289


B1:00AE2D         ?L?COM013C:
B1:00AE2D E0                MOVX     A,@DPTR
B1:00AE2E         ?L?COM013D:
B1:00AE2E 243B              ADD      A,#LOW responseRouteSpeedNumHops
B1:00AE30         ?L?COM013E:
B1:00AE30 F582              MOV      DPL,A
B1:00AE32 E4                CLR      A
B1:00AE33 3412              ADDC     A,#HIGH responseRouteSpeedNumHops
B1:00AE35 F583              MOV      DPH,A
B1:00AE37 22                RET      
----- FUNCTION ?L?COM013B (END) -------


----- FUNCTION UpdateRxStatus (BEGIN) -----
B1:00AE38 12F04D            LCALL    ResponseRouteFull
B1:00AE3B EF                MOV      A,R7
B1:00AE3C 6004              JZ       ?C0428?ZW_TRANSPORT
B1:00AE3E 7F01              MOV      R7,#01H
B1:00AE40 8002              SJMP     ?C0429?ZW_TRANSPORT
B1:00AE42         ?C0428?ZW_TRANSPORT:
B1:00AE42 7F00              MOV      R7,#00H
B1:00AE44         ?C0429?ZW_TRANSPORT:
;---- Variable 'tRxStatus' assigned to Register 'R6/R7' ----
B1:00AE44 9140              ACALL    ?L?COM0092
B1:00AE46 2405              ADD      A,#05H
B1:00AE48 128622            LCALL    ?L?COM0006
B1:00AE4B FD                MOV      R5,A
B1:00AE4C 30E504            JNB      ACC.5,?C0430?ZW_TRANSPORT
B1:00AE4F EF                MOV      A,R7
B1:00AE50 4402              ORL      A,#02H
B1:00AE52 FF                MOV      R7,A
B1:00AE53         ?C0430?ZW_TRANSPORT:
B1:00AE53 90087A            MOV      DPTR,#rxFrame+07H
B1:00AE56 E0                MOVX     A,@DPTR
B1:00AE57 30E704            JNB      ACC.7,?C0431?ZW_TRANSPORT
B1:00AE5A EF                MOV      A,R7
B1:00AE5B 4480              ORL      A,#080H
B1:00AE5D FF                MOV      R7,A
B1:00AE5E         ?C0431?ZW_TRANSPORT:
B1:00AE5E 90086F            MOV      DPTR,#myFrame
B1:00AE61 E0                MOVX     A,@DPTR
B1:00AE62 30E504            JNB      ACC.5,?C0432?ZW_TRANSPORT
B1:00AE65 EF                MOV      A,R7
B1:00AE66 4420              ORL      A,#020H
B1:00AE68 FF                MOV      R7,A
B1:00AE69         ?C0432?ZW_TRANSPORT:
B1:00AE69 ED                MOV      A,R5
B1:00AE6A 540F              ANL      A,#0FH
B1:00AE6C FD                MOV      R5,A
B1:00AE6D BD0510            CJNE     R5,#05H,?C0433?ZW_TRANSPORT
B1:00AE70 EF                MOV      A,R7
B1:00AE71 4410              ORL      A,#010H
B1:00AE73 FF                MOV      R7,A
B1:00AE74 9140              ACALL    ?L?COM0092
B1:00AE76 2408              ADD      A,#08H
B1:00AE78 128622            LCALL    ?L?COM0006
B1:00AE7B F4                CPL      A
B1:00AE7C 7030              JNZ      ?C0435?ZW_TRANSPORT
B1:00AE7E 8017              SJMP     ?C0619?ZW_TRANSPORT
B1:00AE80         ?C0433?ZW_TRANSPORT:
B1:00AE80 9140              ACALL    ?L?COM0092
B1:00AE82 2405              ADD      A,#05H
B1:00AE84 128622            LCALL    ?L?COM0006
B1:00AE87 540F              ANL      A,#0FH
B1:00AE89 FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 290


B1:00AE8A BD0110            CJNE     R5,#01H,?C0436?ZW_TRANSPORT
B1:00AE8D 9140              ACALL    ?L?COM0092
B1:00AE8F 2408              ADD      A,#08H
B1:00AE91 128622            LCALL    ?L?COM0006
B1:00AE94 B4FF17            CJNE     A,#0FFH,?C0435?ZW_TRANSPORT
B1:00AE97         
B1:00AE97 EF                MOV      A,R7
B1:00AE98 4404              ORL      A,#04H
B1:00AE9A FF                MOV      R7,A
B1:00AE9B 8011              SJMP     ?C0435?ZW_TRANSPORT
B1:00AE9D         ?C0436?ZW_TRANSPORT:
B1:00AE9D 9140              ACALL    ?L?COM0092
B1:00AE9F 2405              ADD      A,#05H
B1:00AEA1 128622            LCALL    ?L?COM0006
B1:00AEA4 540F              ANL      A,#0FH
B1:00AEA6 FD                MOV      R5,A
B1:00AEA7 BD0204            CJNE     R5,#02H,?C0435?ZW_TRANSPORT
B1:00AEAA EF                MOV      A,R7
B1:00AEAB 4408              ORL      A,#08H
B1:00AEAD FF                MOV      R7,A
B1:00AEAE         ?C0435?ZW_TRANSPORT:
B1:00AEAE 22                RET      
----- FUNCTION UpdateRxStatus (END) -------


----- FUNCTION ?L?COM02AA (BEGIN) -----
B1:00AEAF 241C              ADD      A,#LOW responseRouteRFOption
B1:00AEB1         ?L?COM02AB:
B1:00AEB1 F582              MOV      DPL,A
B1:00AEB3 E4                CLR      A
B1:00AEB4 3412              ADDC     A,#HIGH responseRouteRFOption
B1:00AEB6 F583              MOV      DPH,A
B1:00AEB8 22                RET      
----- FUNCTION ?L?COM02AA (END) -------


----- FUNCTION ?L?COM0115 (BEGIN) -----
B1:00AEB9 E0                MOVX     A,@DPTR
B1:00AEBA         ?L?COM0116:
B1:00AEBA 25E0              ADD      A,ACC
B1:00AEBC 25E0              ADD      A,ACC
B1:00AEBE 2441              ADD      A,#LOW responseRouteRepeaterList
B1:00AEC0         ?L?COM0117:
B1:00AEC0 F582              MOV      DPL,A
B1:00AEC2 E4                CLR      A
B1:00AEC3 3412              ADDC     A,#HIGH responseRouteRepeaterList
B1:00AEC5 F583              MOV      DPH,A
B1:00AEC7 22                RET      
----- FUNCTION ?L?COM0115 (END) -------


----- FUNCTION _StoreRouteExplore (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R5' ----
B1:00AEC8 AD07              MOV      R5,AR7
;---- Variable 'routetmp' assigned to Register 'R1' ----
B1:00AECA 79FF              MOV      R1,#0FFH
B1:00AECC 301602            JNB      bRouteCached,$ + 5H
B1:00AECF E18C              AJMP     ?C0050?ZW_ROUTING_ALL
B1:00AED1 12E9AA            LCALL    _GetResponseRouteIndex
B1:00AED4 A907              MOV      R1,AR7
B1:00AED6 EF                MOV      A,R7
B1:00AED7 F4                CPL      A
B1:00AED8 7028              JNZ      ?C0051?ZW_ROUTING_ALL
B1:00AEDA 12FE07            LCALL    ?L?COM0629
B1:00AEDD 501A              JNC      ?C0052?ZW_ROUTING_ALL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 291


B1:00AEDF E0                MOVX     A,@DPTR
B1:00AEE0 04                INC      A
B1:00AEE1 F0                MOVX     @DPTR,A
B1:00AEE2 E4                CLR      A
B1:00AEE3 F9                MOV      R1,A
B1:00AEE4         ?C0053?ZW_ROUTING_ALL:
B1:00AEE4 741E              MOV      A,#LOW responseRouteNodeID
B1:00AEE6 29                ADD      A,R1
B1:00AEE7 F192              ACALL    ?L?COM02B9
B1:00AEE9 E0                MOVX     A,@DPTR
B1:00AEEA 6005              JZ       ?C0054?ZW_ROUTING_ALL
B1:00AEEC         ?C0056?ZW_ROUTING_ALL:
B1:00AEEC         ?C0055?ZW_ROUTING_ALL:
B1:00AEEC 09                INC      R1
B1:00AEED E9                MOV      A,R1
B1:00AEEE B402F3            CJNE     A,#02H,?C0053?ZW_ROUTING_ALL
B1:00AEF1         ?C0054?ZW_ROUTING_ALL:
B1:00AEF1 E9                MOV      A,R1
B1:00AEF2 B4020D            CJNE     A,#02H,?C0051?ZW_ROUTING_ALL
B1:00AEF5 7901              MOV      R1,#01H
B1:00AEF7 8009              SJMP     ?C0051?ZW_ROUTING_ALL
B1:00AEF9         ?C0052?ZW_ROUTING_ALL:
B1:00AEF9 201704            JB       routesLocked,?C0059?ZW_ROUTING_ALL
B1:00AEFC E4                CLR      A
B1:00AEFD F9                MOV      R1,A
B1:00AEFE 8002              SJMP     ?C0051?ZW_ROUTING_ALL
B1:00AF00         ?C0059?ZW_ROUTING_ALL:
B1:00AF00 7901              MOV      R1,#01H
B1:00AF02         ?C0051?ZW_ROUTING_ALL:
B1:00AF02 741E              MOV      A,#LOW responseRouteNodeID
B1:00AF04 29                ADD      A,R1
B1:00AF05 F192              ACALL    ?L?COM02B9
B1:00AF07 ED                MOV      A,R5
B1:00AF08 F0                MOVX     @DPTR,A
B1:00AF09 741C              MOV      A,#LOW responseRouteRFOption
B1:00AF0B 29                ADD      A,R1
B1:00AF0C D1B1              ACALL    ?L?COM02AB
B1:00AF0E E4                CLR      A
B1:00AF0F F0                MOVX     @DPTR,A
B1:00AF10 90427D            MOV      DPTR,#pRoute
B1:00AF13 F1A8              ACALL    ?L?COM022A
B1:00AF15 E0                MOVX     A,@DPTR
B1:00AF16 540F              ANL      A,#0FH
B1:00AF18 FE                MOV      R6,A
;---- Variable 'routeLen' assigned to Register 'R6' ----
B1:00AF19 743B              MOV      A,#LOW responseRouteSpeedNumHops
B1:00AF1B 29                ADD      A,R1
B1:00AF1C D130              ACALL    ?L?COM013E
B1:00AF1E EE                MOV      A,R6
B1:00AF1F F0                MOVX     @DPTR,A
B1:00AF20 743B              MOV      A,#LOW responseRouteSpeedNumHops
B1:00AF22 29                ADD      A,R1
B1:00AF23 D130              ACALL    ?L?COM013E
B1:00AF25 C083              PUSH     DPH
B1:00AF27 C082              PUSH     DPL
B1:00AF29 E0                MOVX     A,@DPTR
B1:00AF2A FD                MOV      R5,A
B1:00AF2B 12FDFF            LCALL    ?L?COM0628
B1:00AF2E FC                MOV      R4,A
B1:00AF2F ED                MOV      A,R5
B1:00AF30 4C                ORL      A,R4
B1:00AF31 D082              POP      DPL
B1:00AF33 D083              POP      DPH
B1:00AF35 F0                MOVX     @DPTR,A
B1:00AF36 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 292


B1:00AF37 6033              JZ       ?C0061?ZW_ROUTING_ALL
;---- Variable 'i' assigned to Register 'R5' ----
B1:00AF39 E4                CLR      A
B1:00AF3A FD                MOV      R5,A
B1:00AF3B         ?C0062?ZW_ROUTING_ALL:
B1:00AF3B AC06              MOV      R4,AR6
B1:00AF3D 1E                DEC      R6
B1:00AF3E EC                MOV      A,R4
B1:00AF3F 6031              JZ       ?C0066?ZW_ROUTING_ALL
B1:00AF41 90427D            MOV      DPTR,#pRoute
B1:00AF44 E4                CLR      A
B1:00AF45 75F001            MOV      B,#01H
B1:00AF48 303610            JNB      bRouteNoneInverted,?C0064?ZW_ROUTING_ALL
B1:00AF4B 12EC35            LCALL    ?L?COM0372
B1:00AF4E E0                MOVX     A,@DPTR
B1:00AF4F FC                MOV      R4,A
B1:00AF50 AB05              MOV      R3,AR5
B1:00AF52 0D                INC      R5
B1:00AF53 E9                MOV      A,R1
B1:00AF54 D1BA              ACALL    ?L?COM0116
B1:00AF56 E582              MOV      A,DPL
B1:00AF58 2B                ADD      A,R3
B1:00AF59 800B              SJMP     ?C0095?ZW_ROUTING_ALL
B1:00AF5B         ?C0064?ZW_ROUTING_ALL:
B1:00AF5B 12EC35            LCALL    ?L?COM0372
B1:00AF5E E0                MOVX     A,@DPTR
B1:00AF5F FC                MOV      R4,A
B1:00AF60 E9                MOV      A,R1
B1:00AF61 D1BA              ACALL    ?L?COM0116
B1:00AF63 E582              MOV      A,DPL
B1:00AF65 2E                ADD      A,R6
B1:00AF66         
B1:00AF66 F19D              ACALL    ?L?COM01F5
B1:00AF68 EC                MOV      A,R4
B1:00AF69 F0                MOVX     @DPTR,A
B1:00AF6A 80CF              SJMP     ?C0062?ZW_ROUTING_ALL
B1:00AF6C         ?C0061?ZW_ROUTING_ALL:
B1:00AF6C E9                MOV      A,R1
B1:00AF6D D1BA              ACALL    ?L?COM0116
B1:00AF6F 74FE              MOV      A,#0FEH
B1:00AF71 F0                MOVX     @DPTR,A
B1:00AF72         ?C0066?ZW_ROUTING_ALL:
B1:00AF72 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00AF75 E0                MOVX     A,@DPTR
B1:00AF76 FE                MOV      R6,A
B1:00AF77 AF01              MOV      R7,AR1
B1:00AF79 7401              MOV      A,#01H
B1:00AF7B A807              MOV      R0,AR7
B1:00AF7D 08                INC      R0
B1:00AF7E 8002              SJMP     ?C0089?ZW_ROUTING_ALL
B1:00AF80         ?C0088?ZW_ROUTING_ALL:
B1:00AF80 C3                CLR      C
B1:00AF81 33                RLC      A
B1:00AF82         ?C0089?ZW_ROUTING_ALL:
B1:00AF82 D8FC              DJNZ     R0,?C0088?ZW_ROUTING_ALL
B1:00AF84 F4                CPL      A
B1:00AF85 5E                ANL      A,R6
B1:00AF86 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00AF89 F0                MOVX     @DPTR,A
B1:00AF8A D216              SETB     bRouteCached
B1:00AF8C         ?C0050?ZW_ROUTING_ALL:
B1:00AF8C AF01              MOV      R7,AR1
B1:00AF8E 22                RET      
----- FUNCTION _StoreRouteExplore (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 293



----- FUNCTION ?L?COM02B8 (BEGIN) -----
B1:00AF8F E0                MOVX     A,@DPTR
B1:00AF90 241E              ADD      A,#LOW responseRouteNodeID
B1:00AF92         ?L?COM02B9:
B1:00AF92 F582              MOV      DPL,A
B1:00AF94 E4                CLR      A
B1:00AF95 3412              ADDC     A,#HIGH responseRouteNodeID
B1:00AF97 F583              MOV      DPH,A
B1:00AF99 22                RET      
----- FUNCTION ?L?COM02B8 (END) -------


----- FUNCTION ?L?COM01F4 (BEGIN) -----
B1:00AF9A E582              MOV      A,DPL
B1:00AF9C 2D                ADD      A,R5
B1:00AF9D         ?L?COM01F5:
B1:00AF9D F582              MOV      DPL,A
B1:00AF9F E4                CLR      A
B1:00AFA0 3583              ADDC     A,DPH
B1:00AFA2 F583              MOV      DPH,A
B1:00AFA4 22                RET      
----- FUNCTION ?L?COM01F4 (END) -------


----- FUNCTION ?L?COM0229 (BEGIN) -----
B1:00AFA5 904179            MOV      DPTR,#bPtr
B1:00AFA8         ?L?COM022A:
B1:00AFA8 E0                MOVX     A,@DPTR
B1:00AFA9 FC                MOV      R4,A
B1:00AFAA         ?L?COM022B:
B1:00AFAA A3                INC      DPTR
B1:00AFAB E0                MOVX     A,@DPTR
B1:00AFAC F582              MOV      DPL,A
B1:00AFAE 8C83              MOV      DPH,R4
B1:00AFB0 22                RET      
----- FUNCTION ?L?COM0229 (END) -------


----- FUNCTION _ZCB_NeighborComplete (BEGIN) -----
;---- Variable 'txStatus' assigned to Register 'R7' ----
B1:00AFB1 902BA9            MOV      DPTR,#bCurrentRangeCheckNodeID
B1:00AFB4 E0                MOVX     A,@DPTR
B1:00AFB5 90437D            MOV      DPTR,#destID
B1:00AFB8 F0                MOVX     @DPTR,A
B1:00AFB9 EF                MOV      A,R7
B1:00AFBA 602A              JZ       ?C0018?ZW_SLAVE
B1:00AFBC E0                MOVX     A,@DPTR
B1:00AFBD FF                MOV      R7,A
B1:00AFBE 13                RRC      A
B1:00AFBF 13                RRC      A
B1:00AFC0 13                RRC      A
B1:00AFC1 541F              ANL      A,#01FH
B1:00AFC3 FE                MOV      R6,A
B1:00AFC4 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00AFC7 F1A8              ACALL    ?L?COM022A
B1:00AFC9 A3                INC      DPTR
B1:00AFCA A3                INC      DPTR
B1:00AFCB A3                INC      DPTR
B1:00AFCC E582              MOV      A,DPL
B1:00AFCE 2E                ADD      A,R6
B1:00AFCF F19D              ACALL    ?L?COM01F5
B1:00AFD1 C083              PUSH     DPH
B1:00AFD3 C082              PUSH     DPL
B1:00AFD5 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 294


B1:00AFD6 12FEC1            LCALL    ?L?COM04EB
B1:00AFD9 8002              SJMP     ?C0295?ZW_SLAVE
B1:00AFDB         ?C0294?ZW_SLAVE:
B1:00AFDB C3                CLR      C
B1:00AFDC 33                RLC      A
B1:00AFDD         ?C0295?ZW_SLAVE:
B1:00AFDD D8FC              DJNZ     R0,?C0294?ZW_SLAVE
B1:00AFDF F4                CPL      A
B1:00AFE0 5E                ANL      A,R6
B1:00AFE1 D082              POP      DPL
B1:00AFE3 D083              POP      DPH
B1:00AFE5 F0                MOVX     @DPTR,A
B1:00AFE6         ?C0018?ZW_SLAVE:
B1:00AFE6 90437D            MOV      DPTR,#destID
B1:00AFE9 E0                MOVX     A,@DPTR
B1:00AFEA 04                INC      A
B1:00AFEB FF                MOV      R7,A
B1:;----                  JMP      _FindNeighbors
----- FUNCTION _ZCB_NeighborComplete (END) -------


----- FUNCTION _FindNeighbors (BEGIN) -----
B1:00AFEC 90433C            MOV      DPTR,#nextNode
B1:00AFEF EF                MOV      A,R7
B1:00AFF0 F0                MOVX     @DPTR,A
B1:00AFF1 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00AFF4 12BE51            LCALL    ?L?COM00BA
B1:00AFF7 A3                INC      DPTR
B1:00AFF8 A3                INC      DPTR
B1:00AFF9 E0                MOVX     A,@DPTR
B1:00AFFA 33                RLC      A
B1:00AFFB 33                RLC      A
B1:00AFFC 33                RLC      A
B1:00AFFD 54F8              ANL      A,#0F8H
B1:00AFFF 90433D            MOV      DPTR,#max
B1:00B002 F0                MOVX     @DPTR,A
B1:00B003 200203            JB       findInProgress,$ + 6H
B1:00B006 02B0B8            LJMP     ?C0030?ZW_SLAVE
B1:00B009         ?C0031?ZW_SLAVE:
B1:00B009 90433D            MOV      DPTR,#max
B1:00B00C E0                MOVX     A,@DPTR
B1:00B00D FF                MOV      R7,A
B1:00B00E 90433C            MOV      DPTR,#nextNode
B1:00B011 E0                MOVX     A,@DPTR
B1:00B012 FE                MOV      R6,A
B1:00B013 C3                CLR      C
B1:00B014 9F                SUBB     A,R7
B1:00B015 5056              JNC      ?C0032?ZW_SLAVE
B1:00B017 EE                MOV      A,R6
B1:00B018 13                RRC      A
B1:00B019 13                RRC      A
B1:00B01A 13                RRC      A
B1:00B01B 541F              ANL      A,#01FH
B1:00B01D FF                MOV      R7,A
B1:00B01E 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00B021 12AFA8            LCALL    ?L?COM022A
B1:00B024 A3                INC      DPTR
B1:00B025 A3                INC      DPTR
B1:00B026 A3                INC      DPTR
B1:00B027 E582              MOV      A,DPL
B1:00B029 2F                ADD      A,R7
B1:00B02A 12AF9D            LCALL    ?L?COM01F5
B1:00B02D E0                MOVX     A,@DPTR
B1:00B02E FD                MOV      R5,A
B1:00B02F 7C00              MOV      R4,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 295


B1:00B031 EE                MOV      A,R6
B1:00B032 5407              ANL      A,#07H
B1:00B034 12D14C            LCALL    ?L?COM0381
B1:00B037 8005              SJMP     ?C0297?ZW_SLAVE
B1:00B039         ?C0296?ZW_SLAVE:
B1:00B039 C3                CLR      C
B1:00B03A 33                RLC      A
B1:00B03B CE                XCH      A,R6
B1:00B03C 33                RLC      A
B1:00B03D CE                XCH      A,R6
B1:00B03E         ?C0297?ZW_SLAVE:
B1:00B03E D8F9              DJNZ     R0,?C0296?ZW_SLAVE
B1:00B040 1273F1            LCALL    ?L?COM05EA
B1:00B043 6020              JZ       ?C0033?ZW_SLAVE
B1:00B045 90433C            MOV      DPTR,#nextNode
B1:00B048 E0                MOVX     A,@DPTR
B1:00B049 902BA9            MOV      DPTR,#bCurrentRangeCheckNodeID
B1:00B04C F0                MOVX     @DPTR,A
B1:00B04D 125772            LCALL    RFPowerLevelGetReduced
B1:00B050 AD07              MOV      R5,AR7
B1:00B052 902BA9            MOV      DPTR,#bCurrentRangeCheckNodeID
B1:00B055 E0                MOVX     A,@DPTR
B1:00B056 04                INC      A
B1:00B057 FF                MOV      R7,A
B1:00B058 7A19              MOV      R2,#HIGH ?INTERBANK_TABLE?_ZCB_NeighborComplete
B1:00B05A 7BCB              MOV      R3,#LOW ?INTERBANK_TABLE?_ZCB_NeighborComplete
B1:00B05C 12CEB0            LCALL    _SendTestFrame
B1:00B05F EF                MOV      A,R7
B1:00B060 7058              JNZ      ?C0036?ZW_SLAVE
B1:00B062 02EC4C            LJMP     DelayNeighborCompleteFailCall
B1:00B065         ?C0033?ZW_SLAVE:
B1:00B065 90433C            MOV      DPTR,#nextNode
B1:00B068 E0                MOVX     A,@DPTR
B1:00B069 04                INC      A
B1:00B06A F0                MOVX     @DPTR,A
B1:00B06B 809C              SJMP     ?C0031?ZW_SLAVE
B1:00B06D         ?C0032?ZW_SLAVE:
B1:00B06D C214              CLR      reducedFindNeighborPower
B1:00B06F C202              CLR      findInProgress
B1:00B071 902BAD            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00B074 7401              MOV      A,#01H
B1:00B076 F0                MOVX     @DPTR,A
B1:00B077 902B25            MOV      DPTR,#cmdBuffer
B1:00B07A F0                MOVX     @DPTR,A
B1:00B07B A3                INC      DPTR
B1:00B07C 7407              MOV      A,#07H
B1:00B07E F0                MOVX     @DPTR,A
B1:00B07F E4                CLR      A
B1:00B080 A3                INC      DPTR
B1:00B081 F0                MOVX     @DPTR,A
B1:00B082 902B24            MOV      DPTR,#assignState
B1:00B085 7403              MOV      A,#03H
B1:00B087 F0                MOVX     @DPTR,A
B1:00B088 902BAA            MOV      DPTR,#oldSpeed
B1:00B08B 11BE              ACALL    ?L?COM01CA
B1:00B08D 7B01              MOV      R3,#01H
B1:00B08F 7A2B              MOV      R2,#HIGH cmdBuffer
B1:00B091 7925              MOV      R1,#LOW cmdBuffer
B1:00B093 12CD18            LCALL    ?L?COM007B
B1:00B096 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00B099 7403              MOV      A,#03H
B1:00B09B F0                MOVX     @DPTR,A
B1:00B09C 902B32            MOV      DPTR,#nodeRange+01H
B1:00B09F 12CDE8            LCALL    ?L?COM0266
B1:00B0A2 12FE3E            LCALL    ?L?COM057F
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 296


B1:00B0A5 902B31            MOV      DPTR,#nodeRange
B1:00B0A8 E0                MOVX     A,@DPTR
B1:00B0A9 FB                MOV      R3,A
B1:00B0AA 12CD71            LCALL    _EnQueueSingleData
B1:00B0AD EF                MOV      A,R7
B1:00B0AE 700A              JNZ      ?C0036?ZW_SLAVE
B1:00B0B0 FB                MOV      R3,A
B1:00B0B1 FA                MOV      R2,A
B1:00B0B2 F9                MOV      R1,A
B1:00B0B3 7F02              MOV      R7,#02H
B1:00B0B5 02EA66            LJMP     _ZCB_AssignComplete
B1:00B0B8         ?C0030?ZW_SLAVE:
B1:00B0B8 C214              CLR      reducedFindNeighborPower
B1:00B0BA         ?C0036?ZW_SLAVE:
B1:00B0BA 22                RET      
----- FUNCTION _FindNeighbors (END) -------


----- FUNCTION ?L?COM01C9 (BEGIN) -----
B1:00B0BB 90337A            MOV      DPTR,#sourceNode
B1:00B0BE         ?L?COM01CA:
B1:00B0BE E0                MOVX     A,@DPTR
B1:00B0BF FF                MOV      R7,A
B1:00B0C0 901221            MOV      DPTR,#nodeID
B1:00B0C3 E0                MOVX     A,@DPTR
B1:00B0C4 FD                MOV      R5,A
B1:00B0C5 22                RET      
----- FUNCTION ?L?COM01C9 (END) -------


----- FUNCTION _SecurityCommandHandler (BEGIN) -----
B1:00B0C6 90336F            MOV      DPTR,#pCmd_
B1:00B0C9 1225A9            LCALL    ?C?PSTXDATA
B1:00B0CC 903372            MOV      DPTR,#cmdLength
B1:00B0CF 127257            LCALL    ?L?COM0404
B1:00B0D2 2401              ADD      A,#01H
B1:00B0D4 128622            LCALL    ?L?COM0006
B1:00B0D7 90337A            MOV      DPTR,#sourceNode
B1:00B0DA F0                MOVX     @DPTR,A
B1:00B0DB 90336F            MOV      DPTR,#pCmd_
B1:00B0DE 122589            LCALL    ?C?PLDXDATA
B1:00B0E1 903376            MOV      DPTR,#pCmd
B1:00B0E4 1225A9            LCALL    ?C?PSTXDATA
B1:00B0E7 903373            MOV      DPTR,#rxopt
B1:00B0EA 12975B            LCALL    ?L?COM006B
B1:00B0ED 7F00              MOV      R7,#00H
B1:00B0EF 30E102            JNB      ACC.1,?C0021?ZW_SECURE_LEARN_SUPPORT
B1:00B0F2 7F02              MOV      R7,#02H
B1:00B0F4         ?C0021?ZW_SECURE_LEARN_SUPPORT:
B1:00B0F4         ?C0022?ZW_SECURE_LEARN_SUPPORT:
B1:00B0F4 EF                MOV      A,R7
B1:00B0F5 4421              ORL      A,#021H
B1:00B0F7 903379            MOV      DPTR,#txOption
B1:00B0FA F0                MOVX     @DPTR,A
B1:00B0FB 903376            MOV      DPTR,#pCmd
B1:00B0FE 122589            LCALL    ?C?PLDXDATA
B1:00B101 E9                MOV      A,R1
B1:00B102 2401              ADD      A,#01H
B1:00B104 128622            LCALL    ?L?COM0006
B1:00B107 1226B6            LCALL    ?C?CCASE
B1:00B10A B1A7              DW       ?C0032?ZW_SECURE_LEARN_SUPPORT
B1:00B10C 02                DB       02H
B1:00B10D B16B              DW       ?C0027?ZW_SECURE_LEARN_SUPPORT
B1:00B10F 04                DB       04H
B1:00B110 B123              DW       ?C0024?ZW_SECURE_LEARN_SUPPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 297


B1:00B112 06                DB       06H
B1:00B113 B1D1              DW       ?C0034?ZW_SECURE_LEARN_SUPPORT
B1:00B115 40                DB       040H
B1:00B116 B1DD              DW       ?C0035?ZW_SECURE_LEARN_SUPPORT
B1:00B118 80                DB       080H
B1:00B119 B1F0              DW       ?C0038?ZW_SECURE_LEARN_SUPPORT
B1:00B11B 81                DB       081H
B1:00B11C B1F0              DW       ?C0038?ZW_SECURE_LEARN_SUPPORT
B1:00B11E C1                DB       0C1H
B1:00B11F 0000              DW       00H
B1:00B121 B24E              DW       ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B123         ?C0024?ZW_SECURE_LEARN_SUPPORT:
B1:00B123 903373            MOV      DPTR,#rxopt
B1:00B126 129751            LCALL    ?L?COM0144
B1:00B129 128622            LCALL    ?L?COM0006
B1:00B12C 6404              XRL      A,#04H
B1:00B12E 6002              JZ       $ + 4H
B1:00B130 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B132 5164              ACALL    ?L?COM0090
B1:00B134 7D02              MOV      R5,#02H
B1:00B136 121CD2            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00B139 EF                MOV      A,R7
B1:00B13A 7002              JNZ      $ + 4H
B1:00B13C 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B13E 903372            MOV      DPTR,#cmdLength
B1:00B141 E0                MOVX     A,@DPTR
B1:00B142 FF                MOV      R7,A
B1:00B143 7412              MOV      A,#012H
B1:00B145 D3                SETB     C
B1:00B146 9F                SUBB     A,R7
B1:00B147 4002              JC       $ + 4H
B1:00B149 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B14B 12DB75            LCALL    ?L?COM006C
B1:00B14E 121C46            LCALL    ?INTERBANK_TABLE?_sec0_persist_netkey
B1:00B151 121C69            LCALL    ?INTERBANK_TABLE?sec0_init
B1:00B154 500B              JNC      ?C0026?ZW_SECURE_LEARN_SUPPORT
B1:00B156 5164              ACALL    ?L?COM0090
B1:00B158 E4                CLR      A
B1:00B159 7F01              MOV      R7,#01H
B1:00B15B FE                MOV      R6,A
B1:00B15C FD                MOV      R5,A
B1:00B15D FC                MOV      R4,A
B1:00B15E 121D1D            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_net_scheme
B1:00B161         ?C0026?ZW_SECURE_LEARN_SUPPORT:
B1:00B161 5152              ACALL    ?L?COM008F
B1:00B163 12ECE4            LCALL    ?L?COM028F
B1:00B166 121CF5            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_key_set
B1:00B169 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B16B         ?C0027?ZW_SECURE_LEARN_SUPPORT:
B1:00B16B 5164              ACALL    ?L?COM0090
B1:00B16D 7D01              MOV      R5,#01H
B1:00B16F 121CD2            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00B172 EF                MOV      A,R7
B1:00B173 700C              JNZ      ?C0029?ZW_SECURE_LEARN_SUPPORT
B1:00B175 5164              ACALL    ?L?COM0090
B1:00B177 7D08              MOV      R5,#08H
B1:00B179 121CD2            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00B17C EF                MOV      A,R7
B1:00B17D 7002              JNZ      $ + 4H
B1:00B17F 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B181         ?C0029?ZW_SECURE_LEARN_SUPPORT:
B1:00B181 903372            MOV      DPTR,#cmdLength
B1:00B184 E0                MOVX     A,@DPTR
B1:00B185 C3                CLR      C
B1:00B186 9403              SUBB     A,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 298


B1:00B188 4018              JC       ?C0030?ZW_SECURE_LEARN_SUPPORT
B1:00B18A 121C82            LCALL    ?INTERBANK_TABLE?sec2_inclusion_abort
B1:00B18D 5164              ACALL    ?L?COM0090
B1:00B18F E4                CLR      A
B1:00B190 7F01              MOV      R7,#01H
B1:00B192 FE                MOV      R6,A
B1:00B193 FD                MOV      R5,A
B1:00B194 FC                MOV      R4,A
B1:00B195 121D13            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_scheme
B1:00B198 5152              ACALL    ?L?COM008F
B1:00B19A 12ECE4            LCALL    ?L?COM028F
B1:00B19D 121CF0            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_scheme_get
B1:00B1A0 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1A2         ?C0030?ZW_SECURE_LEARN_SUPPORT:
B1:00B1A2 12ECCC            LCALL    security_learn_exit
B1:00B1A5 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1A7         ?C0032?ZW_SECURE_LEARN_SUPPORT:
B1:00B1A7 903373            MOV      DPTR,#rxopt
B1:00B1AA 129751            LCALL    ?L?COM0144
B1:00B1AD 128622            LCALL    ?L?COM0006
B1:00B1B0 6404              XRL      A,#04H
B1:00B1B2 6002              JZ       $ + 4H
B1:00B1B4 414E              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1B6 5152              ACALL    ?L?COM008F
B1:00B1B8 12ECE4            LCALL    ?L?COM028F
B1:00B1BB 121D09            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_node
B1:00B1BE 127070            LCALL    ?L?COM00E1
B1:00B1C1 90411D            MOV      DPTR,#?_secure_learnIface_raise_commandsSupportedRequest?BYTE+03H
B1:00B1C4 1225A9            LCALL    ?C?PSTXDATA
B1:00B1C7 0B                INC      R3
B1:00B1C8 7A2D              MOV      R2,#HIGH ctx
B1:00B1CA 797D              MOV      R1,#LOW ctx
B1:00B1CC 121CE1            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_commandsSupportedRequest
B1:00B1CF 807D              SJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1D1         ?C0034?ZW_SECURE_LEARN_SUPPORT:
B1:00B1D1 11BB              ACALL    ?L?COM01C9
B1:00B1D3 903379            MOV      DPTR,#txOption
B1:00B1D6 E0                MOVX     A,@DPTR
B1:00B1D7 FB                MOV      R3,A
B1:00B1D8 121C73            LCALL    ?INTERBANK_TABLE?_sec0_send_nonce
B1:00B1DB 8071              SJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1DD         ?C0035?ZW_SECURE_LEARN_SUPPORT:
B1:00B1DD 903372            MOV      DPTR,#cmdLength
B1:00B1E0 E0                MOVX     A,@DPTR
B1:00B1E1 C3                CLR      C
B1:00B1E2 940A              SUBB     A,#0AH
B1:00B1E4 4068              JC       ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1E6         ?C0036?ZW_SECURE_LEARN_SUPPORT:
B1:00B1E6 11BB              ACALL    ?L?COM01C9
B1:00B1E8 12DB75            LCALL    ?L?COM006C
B1:00B1EB 121C64            LCALL    ?INTERBANK_TABLE?_sec0_register_nonce
B1:00B1EE 805E              SJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B1F0         ?C0038?ZW_SECURE_LEARN_SUPPORT:
B1:00B1F0 11BB              ACALL    ?L?COM01C9
B1:00B1F2 903372            MOV      DPTR,#cmdLength
B1:00B1F5 E0                MOVX     A,@DPTR
B1:00B1F6 90357B            MOV      DPTR,#?_sec0_decrypt_message?BYTE+05H
B1:00B1F9 F0                MOVX     @DPTR,A
B1:00B1FA 7B01              MOV      R3,#01H
B1:00B1FC 7A33              MOV      R2,#HIGH rxBuffer
B1:00B1FE 797B              MOV      R1,#LOW rxBuffer
B1:00B200 A3                INC      DPTR
B1:00B201 1225A9            LCALL    ?C?PSTXDATA
B1:00B204 903376            MOV      DPTR,#pCmd
B1:00B207 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 299


B1:00B20A 121C78            LCALL    ?INTERBANK_TABLE?_sec0_decrypt_message
B1:00B20D 9033BB            MOV      DPTR,#len
B1:00B210 EF                MOV      A,R7
B1:00B211 F0                MOVX     @DPTR,A
B1:00B212 6021              JZ       ?C0039?ZW_SECURE_LEARN_SUPPORT
B1:00B214 903373            MOV      DPTR,#rxopt
B1:00B217 12885F            LCALL    ?L?COM000F
B1:00B21A 7404              MOV      A,#04H
B1:00B21C 122072            LCALL    ?C?CSTPTR
B1:00B21F 9033BB            MOV      DPTR,#len
B1:00B222 E0                MOVX     A,@DPTR
B1:00B223 FD                MOV      R5,A
B1:00B224 903373            MOV      DPTR,#rxopt
B1:00B227 122589            LCALL    ?C?PLDXDATA
B1:00B22A 12EE38            LCALL    ?L?COM0400
B1:00B22D 7B01              MOV      R3,#01H
B1:00B22F 7A33              MOV      R2,#HIGH rxBuffer
B1:00B231 797B              MOV      R1,#LOW rxBuffer
B1:00B233 516B              ACALL    _CommandHandler
B1:00B235         ?C0039?ZW_SECURE_LEARN_SUPPORT:
B1:00B235 903376            MOV      DPTR,#pCmd
B1:00B238 122589            LCALL    ?C?PLDXDATA
B1:00B23B E9                MOV      A,R1
B1:00B23C 2401              ADD      A,#01H
B1:00B23E 128622            LCALL    ?L?COM0006
B1:00B241 B4C10D            CJNE     A,#0C1H,?C0041?ZW_SECURE_LEARN_SUPPORT
B1:00B244 11BB              ACALL    ?L?COM01C9
B1:00B246 903379            MOV      DPTR,#txOption
B1:00B249 E0                MOVX     A,@DPTR
B1:00B24A FB                MOV      R3,A
B1:00B24B 021C73            LJMP     ?INTERBANK_TABLE?_sec0_send_nonce
B1:00B24E         ?C0023?ZW_SECURE_LEARN_SUPPORT:
B1:00B24E 12EC7E            LCALL    runCycle
B1:00B251         ?C0041?ZW_SECURE_LEARN_SUPPORT:
B1:00B251 22                RET      
----- FUNCTION _SecurityCommandHandler (END) -------


----- FUNCTION ?L?COM008F (BEGIN) -----
B1:00B252 7B01              MOV      R3,#01H
B1:00B254 7A2D              MOV      R2,#HIGH ctx
B1:00B256 797D              MOV      R1,#LOW ctx
B1:00B258 903379            MOV      DPTR,#txOption
B1:00B25B E0                MOVX     A,@DPTR
B1:00B25C FF                MOV      R7,A
B1:00B25D E4                CLR      A
B1:00B25E FC                MOV      R4,A
B1:00B25F FD                MOV      R5,A
B1:00B260 FE                MOV      R6,A
B1:00B261 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_txOptions
B1:00B264         ?L?COM0090:
B1:00B264 7B01              MOV      R3,#01H
B1:00B266 7A2D              MOV      R2,#HIGH ctx
B1:00B268 797D              MOV      R1,#LOW ctx
B1:00B26A 22                RET      
----- FUNCTION ?L?COM008F (END) -------


----- FUNCTION _CommandHandler (BEGIN) -----
B1:00B26B 903C83            MOV      DPTR,#pCmd
B1:00B26E 1225A9            LCALL    ?C?PSTXDATA
B1:00B271 903C86            MOV      DPTR,#cmdLength
B1:00B274 ED                MOV      A,R5
B1:00B275 F0                MOVX     @DPTR,A
B1:00B276 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 300


B1:00B278 C3                CLR      C
B1:00B279 9D                SUBB     A,R5
B1:00B27A 4003              JC       $ + 5H
B1:00B27C 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B27F         ?C0167?ZW_SLAVE:
B1:00B27F 903C87            MOV      DPTR,#rxopt
B1:00B282 12975B            LCALL    ?L?COM006B
B1:00B285 903C8B            MOV      DPTR,#rxStatus
B1:00B288 F0                MOVX     @DPTR,A
B1:00B289 E9                MOV      A,R1
B1:00B28A 2401              ADD      A,#01H
B1:00B28C 128622            LCALL    ?L?COM0006
B1:00B28F 903C8D            MOV      DPTR,#sourceNode
B1:00B292 F0                MOVX     @DPTR,A
B1:00B293 903C87            MOV      DPTR,#rxopt
B1:00B296 12861C            LCALL    ?L?COM0004
B1:00B299 903C8C            MOV      DPTR,#destNode
B1:00B29C F0                MOVX     @DPTR,A
B1:00B29D 903C87            MOV      DPTR,#rxopt
B1:00B2A0 122589            LCALL    ?C?PLDXDATA
B1:00B2A3 12EE38            LCALL    ?L?COM0400
B1:00B2A6         ?C0169?ZW_SLAVE:
B1:00B2A6 125810            LCALL    RFIsTransmitting
B1:00B2A9 40FB              JC       ?C0169?ZW_SLAVE
B1:00B2AB         ?C0170?ZW_SLAVE:
B1:00B2AB 123EE9            LCALL    ZW_Poll
B1:00B2AE 129758            LCALL    ?L?COM006A
B1:00B2B1 B49F18            CJNE     A,#09FH,?C0171?ZW_SLAVE
B1:00B2B4 C003              PUSH     AR3
B1:00B2B6 C002              PUSH     AR2
B1:00B2B8 C001              PUSH     AR1
B1:00B2BA 12FE17            LCALL    ?L?COM0479
B1:00B2BD 903C05            MOV      DPTR,#?_Security2CommandHandler?BYTE+04H
B1:00B2C0 1225A9            LCALL    ?C?PSTXDATA
B1:00B2C3 D001              POP      AR1
B1:00B2C5 D002              POP      AR2
B1:00B2C7 D003              POP      AR3
B1:00B2C9 021C9B            LJMP     ?INTERBANK_TABLE?_Security2CommandHandler
B1:00B2CC         ?C0171?ZW_SLAVE:
B1:00B2CC 129758            LCALL    ?L?COM006A
B1:00B2CF B49817            CJNE     A,#098H,?C0172?ZW_SLAVE
B1:00B2D2 C003              PUSH     AR3
B1:00B2D4 C002              PUSH     AR2
B1:00B2D6 C001              PUSH     AR1
B1:00B2D8 12FE17            LCALL    ?L?COM0479
B1:00B2DB 903373            MOV      DPTR,#?_SecurityCommandHandler?BYTE+04H
B1:00B2DE 1225A9            LCALL    ?C?PSTXDATA
B1:00B2E1 D001              POP      AR1
B1:00B2E3 D002              POP      AR2
B1:00B2E5 D003              POP      AR3
B1:00B2E7 01C6              AJMP     _SecurityCommandHandler
B1:00B2E9         ?C0172?ZW_SLAVE:
B1:00B2E9 129758            LCALL    ?L?COM006A
B1:00B2EC 6455              XRL      A,#055H
B1:00B2EE 7052              JNZ      ?C0173?ZW_SLAVE
B1:00B2F0 7B01              MOV      R3,#01H
B1:00B2F2 7A2B              MOV      R2,#HIGH sTsParam
B1:00B2F4 799F              MOV      R1,#LOW sTsParam
B1:00B2F6 7D07              MOV      R5,#07H
B1:00B2F8 FF                MOV      R7,A
B1:00B2F9 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00B2FC 903C8D            MOV      DPTR,#sourceNode
B1:00B2FF E0                MOVX     A,@DPTR
B1:00B300 902B9F            MOV      DPTR,#sTsParam
B1:00B303 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 301


B1:00B304 901221            MOV      DPTR,#nodeID
B1:00B307 E0                MOVX     A,@DPTR
B1:00B308 902BA0            MOV      DPTR,#sTsParam+01H
B1:00B30B F0                MOVX     @DPTR,A
B1:00B30C 903C8B            MOV      DPTR,#rxStatus
B1:00B30F E0                MOVX     A,@DPTR
B1:00B310 902BA4            MOV      DPTR,#sTsParam+05H
B1:00B313 F0                MOVX     @DPTR,A
B1:00B314 902BA3            MOV      DPTR,#sTsParam+04H
B1:00B317 7425              MOV      A,#025H
B1:00B319 F0                MOVX     @DPTR,A
B1:00B31A 7B01              MOV      R3,#01H
B1:00B31C 7A2B              MOV      R2,#HIGH sTsParam
B1:00B31E 799F              MOV      R1,#LOW sTsParam
B1:00B320 902B29            MOV      DPTR,#sTsCmdHandler
B1:00B323 1225A9            LCALL    ?C?PSTXDATA
B1:00B326 12BA3E            LCALL    ?L?COM037D
B1:00B329 902B2C            MOV      DPTR,#sTsCmdHandler+03H
B1:00B32C 1225A9            LCALL    ?C?PSTXDATA
B1:00B32F 903C86            MOV      DPTR,#cmdLength
B1:00B332 E0                MOVX     A,@DPTR
B1:00B333 FF                MOV      R7,A
B1:00B334 902B2F            MOV      DPTR,#sTsCmdHandler+06H
B1:00B337 E4                CLR      A
B1:00B338 12E7B6            LCALL    ?L?COM00D5
B1:00B33B 7A2B              MOV      R2,#HIGH sTsCmdHandler
B1:00B33D 7929              MOV      R1,#LOW sTsCmdHandler
B1:00B33F 021D9A            LJMP     ?INTERBANK_TABLE?_TransportService_ApplicationCommandHandler
B1:00B342         ?C0173?ZW_SLAVE:
B1:00B342 129758            LCALL    ?L?COM006A
B1:00B345 FF                MOV      R7,A
B1:00B346 C3                CLR      C
B1:00B347 9420              SUBB     A,#020H
B1:00B349 4028              JC       ?C0174?ZW_SLAVE
B1:00B34B EF                MOV      A,R7
B1:00B34C D3                SETB     C
B1:00B34D 94FF              SUBB     A,#0FFH
B1:00B34F 5022              JNC      ?C0174?ZW_SLAVE
B1:00B351 903C86            MOV      DPTR,#cmdLength
B1:00B354 E0                MOVX     A,@DPTR
B1:00B355 FD                MOV      R5,A
B1:00B356 949F              SUBB     A,#09FH
B1:00B358 5019              JNC      ?C0174?ZW_SLAVE
B1:00B35A C003              PUSH     AR3
B1:00B35C C002              PUSH     AR2
B1:00B35E C001              PUSH     AR1
B1:00B360 A3                INC      DPTR
B1:00B361 122589            LCALL    ?C?PLDXDATA
B1:00B364 9040B1            MOV      DPTR,#?_ApplicationCommandHandler?BYTE+04H
B1:00B367 1225A9            LCALL    ?C?PSTXDATA
B1:00B36A D001              POP      AR1
B1:00B36C D002              POP      AR2
B1:00B36E D003              POP      AR3
B1:00B370 021EB2            LJMP     ?INTERBANK_TABLE?_ApplicationCommandHandler
B1:00B373         ?C0174?ZW_SLAVE:
B1:00B373 129758            LCALL    ?L?COM006A
B1:00B376 6401              XRL      A,#01H
B1:00B378 6003              JZ       $ + 5H
B1:00B37A 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B37D E9                MOV      A,R1
B1:00B37E 2401              ADD      A,#01H
B1:00B380 128622            LCALL    ?L?COM0006
B1:00B383 1226B6            LCALL    ?C?CCASE
B1:00B386 BA22              DW       ?C0268?ZW_SLAVE
B1:00B388 00                DB       00H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 302


B1:00B389 B8FE              DW       ?C0252?ZW_SLAVE
B1:00B38B 01                DB       01H
B1:00B38C B40E              DW       ?C0187?ZW_SLAVE
B1:00B38E 02                DB       02H
B1:00B38F B42B              DW       ?C0190?ZW_SLAVE
B1:00B391 03                DB       03H
B1:00B392 B745              DW       ?C0235?ZW_SLAVE
B1:00B394 04                DB       04H
B1:00B395 B846              DW       ?C0243?ZW_SLAVE
B1:00B397 05                DB       05H
B1:00B398 B3B7              DW       ?C0178?ZW_SLAVE
B1:00B39A 08                DB       08H
B1:00B39B B714              DW       ?C0232?ZW_SLAVE
B1:00B39D 0B                DB       0BH
B1:00B39E B4EE              DW       ?C0200?ZW_SLAVE
B1:00B3A0 0C                DB       0CH
B1:00B3A1 B693              DW       ?C0226?ZW_SLAVE
B1:00B3A3 14                DB       014H
B1:00B3A4 B4A3              DW       ?C0196?ZW_SLAVE
B1:00B3A6 16                DB       016H
B1:00B3A7 BA22              DW       ?C0268?ZW_SLAVE
B1:00B3A9 18                DB       018H
B1:00B3AA B9F4              DW       ?C0262?ZW_SLAVE
B1:00B3AC 22                DB       022H
B1:00B3AD B69E              DW       ?C0227?ZW_SLAVE
B1:00B3AF 24                DB       024H
B1:00B3B0 B6DC              DW       ?C0230?ZW_SLAVE
B1:00B3B2 25                DB       025H
B1:00B3B3 0000              DW       00H
B1:00B3B5 BA3D              DW       ?C0168?ZW_SLAVE
B1:00B3B7         ?C0178?ZW_SLAVE:
B1:00B3B7 300203            JNB      findInProgress,$ + 6H
B1:00B3BA 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3BD 200103            JB       learnMode,$ + 6H
B1:00B3C0 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3C3 300303            JNB      learnModeDsk,$ + 6H
B1:00B3C6 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3C9         ?C0179?ZW_SLAVE:
B1:00B3C9 903C86            MOV      DPTR,#cmdLength
B1:00B3CC E0                MOVX     A,@DPTR
B1:00B3CD C3                CLR      C
B1:00B3CE 9403              SUBB     A,#03H
B1:00B3D0 5003              JNC      $ + 5H
B1:00B3D2 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3D5 128619            LCALL    ?L?COM0003
B1:00B3D8 FF                MOV      R7,A
B1:00B3D9 20E003            JB       ACC.0,$ + 6H
B1:00B3DC 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3DF E550              MOV      A,bNetworkWideInclusion
B1:00B3E1 B40107            CJNE     A,#01H,?C0184?ZW_SLAVE
B1:00B3E4 EF                MOV      A,R7
B1:00B3E5 30E103            JNB      ACC.1,$ + 6H
B1:00B3E8 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3EB         ?C0184?ZW_SLAVE:
B1:00B3EB E550              MOV      A,bNetworkWideInclusion
B1:00B3ED B40207            CJNE     A,#02H,?C0182?ZW_SLAVE
B1:00B3F0 EF                MOV      A,R7
B1:00B3F1 30E203            JNB      ACC.2,$ + 6H
B1:00B3F4 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B3F7         ?C0182?ZW_SLAVE:
B1:00B3F7 D205              SETB     forceUse40K
B1:00B3F9 903C8D            MOV      DPTR,#sourceNode
B1:00B3FC E0                MOVX     A,@DPTR
B1:00B3FD FF                MOV      R7,A
B1:00B3FE 903C8B            MOV      DPTR,#rxStatus
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 303


B1:00B401 E0                MOVX     A,@DPTR
B1:00B402 7D10              MOV      R5,#010H
B1:00B404 30E102            JNB      ACC.1,?C0185?ZW_SLAVE
B1:00B407 7D12              MOV      R5,#012H
B1:00B409         ?C0185?ZW_SLAVE:
B1:00B409         ?C0186?ZW_SLAVE:
B1:00B409 E4                CLR      A
B1:00B40A FB                MOV      R3,A
B1:00B40B FA                MOV      R2,A
B1:00B40C 801A              SJMP     ?C0318?ZW_SLAVE
B1:00B40E         ?C0187?ZW_SLAVE:
B1:00B40E 903C8B            MOV      DPTR,#rxStatus
B1:00B411 E0                MOVX     A,@DPTR
B1:00B412 903C8D            MOV      DPTR,#sourceNode
B1:00B415 30E109            JNB      ACC.1,?C0188?ZW_SLAVE
B1:00B418 E0                MOVX     A,@DPTR
B1:00B419 FF                MOV      R7,A
B1:00B41A E4                CLR      A
B1:00B41B FB                MOV      R3,A
B1:00B41C FA                MOV      R2,A
B1:00B41D 7D07              MOV      R5,#07H
B1:00B41F         
B1:00B41F 8007              SJMP     ?C0318?ZW_SLAVE
B1:00B421         ?C0188?ZW_SLAVE:
B1:00B421 E0                MOVX     A,@DPTR
B1:00B422 FF                MOV      R7,A
B1:00B423 E4                CLR      A
B1:00B424 FB                MOV      R3,A
B1:00B425 FA                MOV      R2,A
B1:00B426 7D05              MOV      R5,#05H
B1:00B428         
B1:00B428 02CD1E            LJMP     _ZW_SendNodeInformation
B1:00B42B         ?C0190?ZW_SLAVE:
B1:00B42B 300203            JNB      findInProgress,$ + 6H
B1:00B42E 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B431 200103            JB       learnMode,$ + 6H
B1:00B434 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B437 903C86            MOV      DPTR,#cmdLength
B1:00B43A E0                MOVX     A,@DPTR
B1:00B43B C3                CLR      C
B1:00B43C 9407              SUBB     A,#07H
B1:00B43E 4003              JC       ?C0193?ZW_SLAVE
B1:00B440 D3                SETB     C
B1:00B441 8001              SJMP     ?C0194?ZW_SLAVE
B1:00B443         ?C0193?ZW_SLAVE:
B1:00B443 C3                CLR      C
B1:00B444         ?C0194?ZW_SLAVE:
B1:00B444 4003              JC       $ + 5H
B1:00B446 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B449         ?C0192?ZW_SLAVE:
B1:00B449 902B24            MOV      DPTR,#assignState
B1:00B44C 7401              MOV      A,#01H
B1:00B44E 128618            LCALL    ?L?COM0002
B1:00B451 901221            MOV      DPTR,#nodeID
B1:00B454 128FD1            LCALL    ?L?COM0055
B1:00B457 126145            LCALL    ?L?COM0045
B1:00B45A 7B01              MOV      R3,#01H
B1:00B45C 12FDF6            LCALL    ?L?COM03AF
B1:00B45F 7B01              MOV      R3,#01H
B1:00B461 7A12              MOV      R2,#HIGH homeID
B1:00B463 7923              MOV      R1,#LOW homeID
B1:00B465 901221            MOV      DPTR,#nodeID
B1:00B468 E0                MOVX     A,@DPTR
B1:00B469 FD                MOV      R5,A
B1:00B46A 121B74            LCALL    ?INTERBANK_TABLE?_MemoryPutID
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 304


B1:00B46D 901221            MOV      DPTR,#nodeID
B1:00B470 E0                MOVX     A,@DPTR
B1:00B471 7025              JNZ      ?C0195?ZW_SLAVE
B1:00B473 12D155            LCALL    ResetRoutedResponseRoutes
B1:00B476 12E940            LCALL    FlushResponseSpeeds
B1:00B479 12CFD5            LCALL    RemoveAllReturnRouteDestination
B1:00B47C 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far
B1:00B47E 7F0B              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far
B1:00B480 127070            LCALL    ?L?COM00E1
B1:00B483 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00B486 7411              MOV      A,#011H
B1:00B488 F0                MOVX     @DPTR,A
B1:00B489 A3                INC      DPTR
B1:00B48A 744B              MOV      A,#04BH
B1:00B48C F0                MOVX     @DPTR,A
B1:00B48D 126C78            LCALL    _NVM_ext_write_buffer
B1:00B490 E4                CLR      A
B1:00B491 902BB4            MOV      DPTR,#sucNodeID
B1:00B494 F0                MOVX     @DPTR,A
B1:00B495 12D21B            LCALL    security_reset
B1:00B498         ?C0195?ZW_SLAVE:
B1:00B498 127070            LCALL    ?L?COM00E1
B1:00B49B E4                CLR      A
B1:00B49C FF                MOV      R7,A
B1:00B49D 12EA66            LCALL    _ZCB_AssignComplete
B1:00B4A0 02FDE4            LJMP     ?L?COM04E9
B1:00B4A3         ?C0196?ZW_SLAVE:
B1:00B4A3 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00B4A6 E0                MOVX     A,@DPTR
B1:00B4A7 20E003            JB       ACC.0,$ + 6H
B1:00B4AA 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B4AD 902BB4            MOV      DPTR,#sucNodeID
B1:00B4B0 E0                MOVX     A,@DPTR
B1:00B4B1 FF                MOV      R7,A
B1:00B4B2 902BAB            MOV      DPTR,#temp
B1:00B4B5 7004              JNZ      ?C0198?ZW_SLAVE
B1:00B4B7 04                INC      A
B1:00B4B8 F0                MOVX     @DPTR,A
B1:00B4B9 8002              SJMP     ?C0199?ZW_SLAVE
B1:00B4BB         ?C0198?ZW_SLAVE:
B1:00B4BB EF                MOV      A,R7
B1:00B4BC F0                MOVX     @DPTR,A
B1:00B4BD         ?C0199?ZW_SLAVE:
B1:00B4BD 128619            LCALL    ?L?COM0003
B1:00B4C0 902BAC            MOV      DPTR,#helpNodeID
B1:00B4C3 12CF38            LCALL    ?L?COM0398
B1:00B4C6 7416              MOV      A,#016H
B1:00B4C8 F0                MOVX     @DPTR,A
B1:00B4C9 902BAC            MOV      DPTR,#helpNodeID
B1:00B4CC E0                MOVX     A,@DPTR
B1:00B4CD 902BBD            MOV      DPTR,#slaveFrameBuffer+02H
B1:00B4D0 F0                MOVX     @DPTR,A
B1:00B4D1 12CD0D            LCALL    ?L?COM0079
B1:00B4D4 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00B4D7 7403              MOV      A,#03H
B1:00B4D9 12CF6B            LCALL    ?L?COM02E6
B1:00B4DC A3                INC      DPTR
B1:00B4DD 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_CtrlAskedForHelpCallback
B1:00B4DF F0                MOVX     @DPTR,A
B1:00B4E0 A3                INC      DPTR
B1:00B4E1 74C6              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_CtrlAskedForHelpCallback
B1:00B4E3 F0                MOVX     @DPTR,A
B1:00B4E4 902BAB            MOV      DPTR,#temp
B1:00B4E7 E0                MOVX     A,@DPTR
B1:00B4E8 FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 305


B1:00B4E9 7F01              MOV      R7,#01H
B1:00B4EB 02CD71            LJMP     _EnQueueSingleData
B1:00B4EE         ?C0200?ZW_SLAVE:
B1:00B4EE 902BB4            MOV      DPTR,#sucNodeID
B1:00B4F1 E0                MOVX     A,@DPTR
B1:00B4F2 FF                MOV      R7,A
B1:00B4F3 600A              JZ       ?C0201?ZW_SLAVE
B1:00B4F5 128619            LCALL    ?L?COM0003
B1:00B4F8 FE                MOV      R6,A
B1:00B4F9 EF                MOV      A,R7
B1:00B4FA B50602            CJNE     A,AR6,?C0201?ZW_SLAVE
B1:00B4FD C193              AJMP     ?C0319?ZW_SLAVE
B1:00B4FF         ?C0201?ZW_SLAVE:
B1:00B4FF C2D5              CLR      F0
B1:00B501 902BAB            MOV      DPTR,#temp
B1:00B504 74FF              MOV      A,#0FFH
B1:00B506 128FD1            LCALL    ?L?COM0055
B1:00B509 128622            LCALL    ?L?COM0006
B1:00B50C FF                MOV      R7,A
B1:00B50D C4                SWAP     A
B1:00B50E 5407              ANL      A,#07H
B1:00B510 903C8E            MOV      DPTR,#n
B1:00B513 F0                MOVX     @DPTR,A
B1:00B514 7009              JNZ      ?C0202?ZW_SLAVE
B1:00B516 128619            LCALL    ?L?COM0003
B1:00B519 902BB3            MOV      DPTR,#curNodeID
B1:00B51C F0                MOVX     @DPTR,A
B1:00B51D D2D5              SETB     F0
B1:00B51F         ?C0202?ZW_SLAVE:
B1:00B51F 902BB3            MOV      DPTR,#curNodeID
B1:00B522 E0                MOVX     A,@DPTR
B1:00B523 7002              JNZ      $ + 4H
B1:00B525 C132              AJMP     ?C0203?ZW_SLAVE
B1:00B527 E4                CLR      A
B1:00B528 902B38            MOV      DPTR,#tempi
B1:00B52B F0                MOVX     @DPTR,A
B1:00B52C         ?C0204?ZW_SLAVE:
B1:00B52C 12C7A8            LCALL    ?L?COM05B4
B1:00B52F 5028              JNC      ?C0205?ZW_SLAVE
B1:00B531 12C77D            LCALL    ?L?COM027C
B1:00B534 E0                MOVX     A,@DPTR
B1:00B535 FF                MOV      R7,A
B1:00B536 902BB3            MOV      DPTR,#curNodeID
B1:00B539 E0                MOVX     A,@DPTR
B1:00B53A FE                MOV      R6,A
B1:00B53B EF                MOV      A,R7
B1:00B53C 6E                XRL      A,R6
B1:00B53D 601A              JZ       ?C0205?ZW_SLAVE
B1:00B53F EF                MOV      A,R7
B1:00B540 700F              JNZ      ?C0206?ZW_SLAVE
B1:00B542 902BAB            MOV      DPTR,#temp
B1:00B545 E0                MOVX     A,@DPTR
B1:00B546 B4FF08            CJNE     A,#0FFH,?C0206?ZW_SLAVE
B1:00B549 902B38            MOV      DPTR,#tempi
B1:00B54C E0                MOVX     A,@DPTR
B1:00B54D 902BAB            MOV      DPTR,#temp
B1:00B550 F0                MOVX     @DPTR,A
B1:00B551         ?C0206?ZW_SLAVE:
B1:00B551 902B38            MOV      DPTR,#tempi
B1:00B554 E0                MOVX     A,@DPTR
B1:00B555 04                INC      A
B1:00B556 F0                MOVX     @DPTR,A
B1:00B557 80D3              SJMP     ?C0204?ZW_SLAVE
B1:00B559         ?C0205?ZW_SLAVE:
B1:00B559 902B38            MOV      DPTR,#tempi
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 306


B1:00B55C E0                MOVX     A,@DPTR
B1:00B55D C3                CLR      C
B1:00B55E 9405              SUBB     A,#05H
B1:00B560 401E              JC       ?C0207?ZW_SLAVE
B1:00B562 902BAB            MOV      DPTR,#temp
B1:00B565 E0                MOVX     A,@DPTR
B1:00B566 FF                MOV      R7,A
B1:00B567 94FF              SUBB     A,#0FFH
B1:00B569 5015              JNC      ?C0207?ZW_SLAVE
B1:00B56B 902BB3            MOV      DPTR,#curNodeID
B1:00B56E E0                MOVX     A,@DPTR
B1:00B56F FD                MOV      R5,A
B1:00B570 12C77D            LCALL    ?L?COM027C
B1:00B573 ED                MOV      A,R5
B1:00B574 F0                MOVX     @DPTR,A
B1:00B575 7E00              MOV      R6,#00H
B1:00B577 12C7A0            LCALL    ?L?COM0625
B1:00B57A FE                MOV      R6,A
B1:00B57B AF01              MOV      R7,AR1
B1:00B57D 123FC4            LCALL    _NVM_ext_write_byte
B1:00B580         ?C0207?ZW_SLAVE:
B1:00B580 902BB3            MOV      DPTR,#curNodeID
B1:00B583 E0                MOVX     A,@DPTR
B1:00B584 FB                MOV      R3,A
B1:00B585 24FF              ADD      A,#0FFH
B1:00B587 FE                MOV      R6,A
B1:00B588 E4                CLR      A
B1:00B589 34FF              ADDC     A,#0FFH
B1:00B58B 902B36            MOV      DPTR,#tempwi
B1:00B58E F0                MOVX     @DPTR,A
B1:00B58F A3                INC      DPTR
B1:00B590 CE                XCH      A,R6
B1:00B591 F0                MOVX     @DPTR,A
B1:00B592 12FE0F            LCALL    ?L?COM0624
B1:00B595 4002              JC       $ + 4H
B1:00B597 C185              AJMP     ?C0216?ZW_SLAVE
B1:00B599 30D505            JNB      F0,?C0209?ZW_SLAVE
B1:00B59C AF03              MOV      R7,AR3
B1:00B59E 12C04D            LCALL    _ReturnRouteClearPriority
B1:00B5A1         ?C0209?ZW_SLAVE:
B1:00B5A1 30D511            JNB      F0,?C0210?ZW_SLAVE
B1:00B5A4 902B36            MOV      DPTR,#tempwi
B1:00B5A7 7D11              MOV      R5,#011H
B1:00B5A9 1270D9            LCALL    ?L?COM01A7
B1:00B5AC 12ECF3            LCALL    ?L?COM03B5
B1:00B5AF 902BB3            MOV      DPTR,#curNodeID
B1:00B5B2 12C798            LCALL    ?L?COM0586
B1:00B5B5         ?C0210?ZW_SLAVE:
B1:00B5B5 128FD2            LCALL    ?L?COM0056
B1:00B5B8 128622            LCALL    ?L?COM0006
B1:00B5BB 5407              ANL      A,#07H
B1:00B5BD 902BAB            MOV      DPTR,#temp
B1:00B5C0 F0                MOVX     @DPTR,A
B1:00B5C1 E4                CLR      A
B1:00B5C2 903C8F            MOV      DPTR,#repeaterIndex
B1:00B5C5 F0                MOVX     @DPTR,A
B1:00B5C6 30D50E            JNB      F0,?C0212?ZW_SLAVE
B1:00B5C9 902BAB            MOV      DPTR,#temp
B1:00B5CC E0                MOVX     A,@DPTR
B1:00B5CD 7008              JNZ      ?C0212?ZW_SLAVE
B1:00B5CF 12C473            LCALL    ?L?COM00F0
B1:00B5D2 12C7B1            LCALL    ?L?COM0503
B1:00B5D5 802B              SJMP     ?C0320?ZW_SLAVE
B1:00B5D7         ?C0212?ZW_SLAVE:
B1:00B5D7 902BAB            MOV      DPTR,#temp
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 307


B1:00B5DA E0                MOVX     A,@DPTR
B1:00B5DB FF                MOV      R7,A
B1:00B5DC 903C8F            MOV      DPTR,#repeaterIndex
B1:00B5DF E0                MOVX     A,@DPTR
B1:00B5E0 C3                CLR      C
B1:00B5E1 9F                SUBB     A,R7
B1:00B5E2 5029              JNC      ?C0213?ZW_SLAVE
B1:00B5E4 12C473            LCALL    ?L?COM00F0
B1:00B5E7 F9                MOV      R1,A
B1:00B5E8 EA                MOV      A,R2
B1:00B5E9 35F0              ADDC     A,B
B1:00B5EB FA                MOV      R2,A
B1:00B5EC A3                INC      DPTR
B1:00B5ED E0                MOVX     A,@DPTR
B1:00B5EE FD                MOV      R5,A
B1:00B5EF 29                ADD      A,R1
B1:00B5F0 F9                MOV      R1,A
B1:00B5F1 EC                MOV      A,R4
B1:00B5F2 3A                ADDC     A,R2
B1:00B5F3 FE                MOV      R6,A
B1:00B5F4 AF01              MOV      R7,AR1
B1:00B5F6 903C83            MOV      DPTR,#pCmd
B1:00B5F9 12885F            LCALL    ?L?COM000F
B1:00B5FC E9                MOV      A,R1
B1:00B5FD 2D                ADD      A,R5
B1:00B5FE 12E77F            LCALL    ?L?COM039B
B1:00B601 FD                MOV      R5,A
B1:00B602         
B1:00B602 123FC4            LCALL    _NVM_ext_write_byte
B1:00B605 903C8F            MOV      DPTR,#repeaterIndex
B1:00B608 E0                MOVX     A,@DPTR
B1:00B609 04                INC      A
B1:00B60A F0                MOVX     @DPTR,A
B1:00B60B 80CA              SJMP     ?C0212?ZW_SLAVE
B1:00B60D         ?C0213?ZW_SLAVE:
B1:00B60D 903C8F            MOV      DPTR,#repeaterIndex
B1:00B610 E0                MOVX     A,@DPTR
B1:00B611 C3                CLR      C
B1:00B612 9404              SUBB     A,#04H
B1:00B614 5009              JNC      ?C0215?ZW_SLAVE
B1:00B616 12C473            LCALL    ?L?COM00F0
B1:00B619 12C597            LCALL    ?L?COM01B0
B1:00B61C 123FBF            LCALL    ?L?COM030D
B1:00B61F         ?C0215?ZW_SLAVE:
B1:00B61F 12BA3E            LCALL    ?L?COM037D
B1:00B622 902BB3            MOV      DPTR,#curNodeID
B1:00B625 E0                MOVX     A,@DPTR
B1:00B626 FD                MOV      R5,A
B1:00B627 903C86            MOV      DPTR,#cmdLength
B1:00B62A E0                MOVX     A,@DPTR
B1:00B62B 90403A            MOV      DPTR,#?_StoreReturnRouteSpeed?BYTE+04H
B1:00B62E F0                MOVX     @DPTR,A
B1:00B62F 02C494            LJMP     _StoreReturnRouteSpeed
B1:00B632         ?C0203?ZW_SLAVE:
B1:00B632 30D550            JNB      F0,?C0216?ZW_SLAVE
B1:00B635 E4                CLR      A
B1:00B636 902B36            MOV      DPTR,#tempwi
B1:00B639 F0                MOVX     @DPTR,A
B1:00B63A A3                INC      DPTR
B1:00B63B F0                MOVX     @DPTR,A
B1:00B63C         ?C0218?ZW_SLAVE:
B1:00B63C 902B36            MOV      DPTR,#tempwi
B1:00B63F 1265F9            LCALL    ?L?COM0199
B1:00B642 94E8              SUBB     A,#0E8H
B1:00B644 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 308


B1:00B645 9400              SUBB     A,#00H
B1:00B647 5039              JNC      ?C0219?ZW_SLAVE
B1:00B649 7C00              MOV      R4,#00H
B1:00B64B 12ECEE            LCALL    ?L?COM03B4
B1:00B64E 12C67A            LCALL    ?L?COM02E1
B1:00B651 EF                MOV      A,R7
B1:00B652 6026              JZ       ?C0220?ZW_SLAVE
B1:00B654 12C7BB            LCALL    ?L?COM0241
B1:00B657 12ECEE            LCALL    ?L?COM03B4
B1:00B65A 123FBF            LCALL    ?L?COM030D
B1:00B65D E4                CLR      A
B1:00B65E 902B38            MOV      DPTR,#tempi
B1:00B661 F0                MOVX     @DPTR,A
B1:00B662         ?C0222?ZW_SLAVE:
B1:00B662 12C7BB            LCALL    ?L?COM0241
B1:00B665 12C6FF            LCALL    ?L?COM0362
B1:00B668 3E                ADDC     A,R6
B1:00B669 FA                MOV      R2,A
B1:00B66A A3                INC      DPTR
B1:00B66B 12C48D            LCALL    ?L?COM00F1
B1:00B66E F9                MOV      R1,A
B1:00B66F EA                MOV      A,R2
B1:00B670 35F0              ADDC     A,B
B1:00B672 123FBF            LCALL    ?L?COM030D
B1:00B675 12C669            LCALL    ?L?COM0390
B1:00B678 40E8              JC       ?C0222?ZW_SLAVE
B1:00B67A         ?C0220?ZW_SLAVE:
B1:00B67A 902B36            MOV      DPTR,#tempwi
B1:00B67D 123F7F            LCALL    ?L?COM0081
B1:00B680 80BA              SJMP     ?C0218?ZW_SLAVE
B1:00B682         ?C0219?ZW_SLAVE:
B1:00B682 12CFD5            LCALL    RemoveAllReturnRouteDestination
B1:00B685         ?C0216?ZW_SLAVE:
B1:00B685 12CF9A            LCALL    ?L?COM0476
B1:00B688 7003              JNZ      $ + 5H
B1:00B68A 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B68D 12F14B            LCALL    ?L?COM0371
B1:00B690 02F05E            LJMP     _NetWorkTimerStart
B1:00B693         ?C0226?ZW_SLAVE:
B1:00B693         
B1:00B693 12BA3E            LCALL    ?L?COM037D
B1:00B696 903C86            MOV      DPTR,#cmdLength
B1:00B699 E0                MOVX     A,@DPTR
B1:00B69A FD                MOV      R5,A
B1:00B69B 02C5A5            LJMP     _HandleSUCReturnRoute
B1:00B69E         ?C0227?ZW_SLAVE:
B1:00B69E 128605            LCALL    ?L?COM0001
B1:00B6A1 902BB3            MOV      DPTR,#curNodeID
B1:00B6A4 F0                MOVX     @DPTR,A
B1:00B6A5 7003              JNZ      $ + 5H
B1:00B6A7 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B6AA E0                MOVX     A,@DPTR
B1:00B6AB FF                MOV      R7,A
B1:00B6AC 12E9CA            LCALL    _RemoveResponseRoute
B1:00B6AF 902BB3            MOV      DPTR,#curNodeID
B1:00B6B2 E0                MOVX     A,@DPTR
B1:00B6B3 123956            LCALL    ?L?COM01D7
B1:00B6B6 902BB3            MOV      DPTR,#curNodeID
B1:00B6B9 E0                MOVX     A,@DPTR
B1:00B6BA FE                MOV      R6,A
B1:00B6BB 6F                XRL      A,R7
B1:00B6BC 6003              JZ       $ + 5H
B1:00B6BE 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B6C1 EE                MOV      A,R6
B1:00B6C2 12C39E            LCALL    ?L?COM00C4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 309


B1:00B6C5 12C585            LCALL    ?L?COM044F
B1:00B6C8 12FE2B            LCALL    ?L?COM0392
B1:00B6CB 902BAB            MOV      DPTR,#temp
B1:00B6CE F0                MOVX     @DPTR,A
B1:00B6CF 902BB3            MOV      DPTR,#curNodeID
B1:00B6D2 12C39D            LCALL    ?L?COM00C3
B1:00B6D5 902BAB            MOV      DPTR,#temp
B1:00B6D8 E0                MOVX     A,@DPTR
B1:00B6D9 FD                MOV      R5,A
B1:00B6DA 8035              SJMP     ?C0321?ZW_SLAVE
B1:00B6DC         ?C0230?ZW_SLAVE:
B1:00B6DC 128605            LCALL    ?L?COM0001
B1:00B6DF 902BB3            MOV      DPTR,#curNodeID
B1:00B6E2 12C70B            LCALL    ?L?COM0477
B1:00B6E5 AE07              MOV      R6,AR7
B1:00B6E7 902BB3            MOV      DPTR,#curNodeID
B1:00B6EA E0                MOVX     A,@DPTR
B1:00B6EB FF                MOV      R7,A
B1:00B6EC 6E                XRL      A,R6
B1:00B6ED 6003              JZ       $ + 5H
B1:00B6EF 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B6F2 12FE0F            LCALL    ?L?COM0624
B1:00B6F5 4003              JC       $ + 5H
B1:00B6F7 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B6FA 12E9CA            LCALL    _RemoveResponseRoute
B1:00B6FD 12FE20            LCALL    ?L?COM04EA
B1:00B700 123964            LCALL    _NVM_ext_read_byte
B1:00B703 902BB3            MOV      DPTR,#curNodeID
B1:00B706 12FE2B            LCALL    ?L?COM0392
B1:00B709 902BB3            MOV      DPTR,#curNodeID
B1:00B70C F0                MOVX     @DPTR,A
B1:00B70D FD                MOV      R5,A
B1:00B70E 12FE20            LCALL    ?L?COM04EA
B1:00B711         
B1:00B711 023FC4            LJMP     _NVM_ext_write_byte
B1:00B714         ?C0232?ZW_SLAVE:
B1:00B714 12CF9A            LCALL    ?L?COM0476
B1:00B717 7003              JNZ      $ + 5H
B1:00B719 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B71C 12C7D2            LCALL    ResetSUC
B1:00B71F E4                CLR      A
B1:00B720 902B24            MOV      DPTR,#assignState
B1:00B723 F0                MOVX     @DPTR,A
B1:00B724 12EAE1            LCALL    AssignTimerStop
B1:00B727 12C747            LCALL    ReloadRouteDestinations
B1:00B72A 902B39            MOV      DPTR,#_routeUpdateDone
B1:00B72D E0                MOVX     A,@DPTR
B1:00B72E FC                MOV      R4,A
B1:00B72F A3                INC      DPTR
B1:00B730 E0                MOVX     A,@DPTR
B1:00B731 FD                MOV      R5,A
B1:00B732 4C                ORL      A,R4
B1:00B733 7003              JNZ      $ + 5H
B1:00B735 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B738 128619            LCALL    ?L?COM0003
B1:00B73B 24FE              ADD      A,#0FEH
B1:00B73D FF                MOV      R7,A
B1:00B73E 8D82              MOV      DPL,R5
B1:00B740 8C83              MOV      DPH,R4
B1:00B742 02271A            LJMP     ?C?ICALL2
B1:00B745         ?C0235?ZW_SLAVE:
B1:00B745 300203            JNB      findInProgress,$ + 6H
B1:00B748 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B74B 903C86            MOV      DPTR,#cmdLength
B1:00B74E E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 310


B1:00B74F FF                MOV      R7,A
B1:00B750 D3                SETB     C
B1:00B751 9422              SUBB     A,#022H
B1:00B753 4003              JC       $ + 5H
B1:00B755 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B758 EF                MOV      A,R7
B1:00B759 9403              SUBB     A,#03H
B1:00B75B 5003              JNC      $ + 5H
B1:00B75D 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B760 128619            LCALL    ?L?COM0003
B1:00B763 D3                SETB     C
B1:00B764 941D              SUBB     A,#01DH
B1:00B766 4003              JC       $ + 5H
B1:00B768 02BA3D            LJMP     ?C0168?ZW_SLAVE
B1:00B76B 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00B76E E0                MOVX     A,@DPTR
B1:00B76F 902BAA            MOV      DPTR,#oldSpeed
B1:00B772 F0                MOVX     @DPTR,A
B1:00B773 902B24            MOV      DPTR,#assignState
B1:00B776 7402              MOV      A,#02H
B1:00B778 12706F            LCALL    ?L?COM00E0
B1:00B77B E4                CLR      A
B1:00B77C FF                MOV      R7,A
B1:00B77D 12EA66            LCALL    _ZCB_AssignComplete
B1:00B780 D202              SETB     findInProgress
B1:00B782 902BA6            MOV      DPTR,#SUC_Update
B1:00B785 E0                MOVX     A,@DPTR
B1:00B786 B40403            CJNE     A,#04H,?C0237?ZW_SLAVE
B1:00B789 12979C            LCALL    ?L?COM0564
B1:00B78C         ?C0237?ZW_SLAVE:
B1:00B78C 12FDE4            LCALL    ?L?COM04E9
B1:00B78F 12CFB1            LCALL    ?L?COM0563
B1:00B792 128618            LCALL    ?L?COM0002
B1:00B795 FF                MOV      R7,A
B1:00B796 541F              ANL      A,#01FH
B1:00B798 2403              ADD      A,#03H
B1:00B79A FD                MOV      R5,A
B1:00B79B E4                CLR      A
B1:00B79C 33                RLC      A
B1:00B79D FC                MOV      R4,A
B1:00B79E 903C86            MOV      DPTR,#cmdLength
B1:00B7A1 E0                MOVX     A,@DPTR
B1:00B7A2 D3                SETB     C
B1:00B7A3 9D                SUBB     A,R5
B1:00B7A4 EC                MOV      A,R4
B1:00B7A5 12556C            LCALL    ?L?COM0170
B1:00B7A8 400F              JC       ?C0238?ZW_SLAVE
B1:00B7AA 7E00              MOV      R6,#00H
B1:00B7AC 128FD2            LCALL    ?L?COM0056
B1:00B7AF 128FE8            LCALL    ?L?COM0050
B1:00B7B2 121FB3            LCALL    ?C?CLDPTR
B1:00B7B5 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00B7B8 F0                MOVX     @DPTR,A
B1:00B7B9         ?C0238?ZW_SLAVE:
B1:00B7B9 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00B7BC E0                MOVX     A,@DPTR
B1:00B7BD 7006              JNZ      ?C0239?ZW_SLAVE
B1:00B7BF 7E2B              MOV      R6,#HIGH nodeNormalRangeFrame
B1:00B7C1 7FE6              MOV      R7,#LOW nodeNormalRangeFrame
B1:00B7C3 8004              SJMP     ?C0240?ZW_SLAVE
B1:00B7C5         ?C0239?ZW_SLAVE:
B1:00B7C5 7E2B              MOV      R6,#HIGH nodeFLiRSRangeFrame
B1:00B7C7 7F7C              MOV      R7,#LOW nodeFLiRSRangeFrame
B1:00B7C9         ?C0240?ZW_SLAVE:
B1:00B7C9 902BAE            MOV      DPTR,#pNodeRangeFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 311


B1:00B7CC 127332            LCALL    ?L?COM04E5
B1:00B7CF C003              PUSH     AR3
B1:00B7D1 C002              PUSH     AR2
B1:00B7D3 C001              PUSH     AR1
B1:00B7D5 12BA3E            LCALL    ?L?COM037D
B1:00B7D8 126149            LCALL    ?L?COM0047
B1:00B7DB D001              POP      AR1
B1:00B7DD D002              POP      AR2
B1:00B7DF D003              POP      AR3
B1:00B7E1 7F21              MOV      R7,#021H
B1:00B7E3 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00B7E6 128619            LCALL    ?L?COM0003
B1:00B7E9 541F              ANL      A,#01FH
B1:00B7EB 2404              ADD      A,#04H
B1:00B7ED FF                MOV      R7,A
B1:00B7EE E4                CLR      A
B1:00B7EF 33                RLC      A
B1:00B7F0 FE                MOV      R6,A
B1:00B7F1 903C86            MOV      DPTR,#cmdLength
B1:00B7F4 E0                MOVX     A,@DPTR
B1:00B7F5 D3                SETB     C
B1:00B7F6 12556A            LCALL    ?L?COM016F
B1:00B7F9 400F              JC       ?C0241?ZW_SLAVE
B1:00B7FB 903C83            MOV      DPTR,#pCmd
B1:00B7FE 12E4C3            LCALL    ?L?COM0070
B1:00B801 3E                ADDC     A,R6
B1:00B802 FA                MOV      R2,A
B1:00B803 121FB3            LCALL    ?C?CLDPTR
B1:00B806 902BAD            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00B809 F0                MOVX     @DPTR,A
B1:00B80A         ?C0241?ZW_SLAVE:
B1:00B80A 903C8D            MOV      DPTR,#sourceNode
B1:00B80D E0                MOVX     A,@DPTR
B1:00B80E 902B31            MOV      DPTR,#nodeRange
B1:00B811 F0                MOVX     @DPTR,A
B1:00B812 A3                INC      DPTR
B1:00B813 7401              MOV      A,#01H
B1:00B815 F0                MOVX     @DPTR,A
B1:00B816 903C8B            MOV      DPTR,#rxStatus
B1:00B819 E0                MOVX     A,@DPTR
B1:00B81A 30E107            JNB      ACC.1,?C0242?ZW_SLAVE
B1:00B81D 902B32            MOV      DPTR,#nodeRange+01H
B1:00B820 E0                MOVX     A,@DPTR
B1:00B821 4402              ORL      A,#02H
B1:00B823 F0                MOVX     @DPTR,A
B1:00B824         ?C0242?ZW_SLAVE:
B1:00B824 D214              SETB     reducedFindNeighborPower
B1:00B826 514C              ACALL    ?L?COM048D
B1:00B828 2403              ADD      A,#03H
B1:00B82A FD                MOV      R5,A
B1:00B82B E4                CLR      A
B1:00B82C 3E                ADDC     A,R6
B1:00B82D FA                MOV      R2,A
B1:00B82E A905              MOV      R1,AR5
B1:00B830 12710A            LCALL    ?L?COM0284
B1:00B833 A3                INC      DPTR
B1:00B834 A3                INC      DPTR
B1:00B835 E0                MOVX     A,@DPTR
B1:00B836 FD                MOV      R5,A
B1:00B837 121BA6            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskBitsIn
B1:00B83A EF                MOV      A,R7
B1:00B83B 2407              ADD      A,#07H
B1:00B83D 902B23            MOV      DPTR,#assignTimeoutCount
B1:00B840 F0                MOVX     @DPTR,A
B1:00B841 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 312


B1:00B842 FF                MOV      R7,A
B1:00B843 02AFEC            LJMP     _FindNeighbors
B1:00B846         ?C0243?ZW_SLAVE:
B1:00B846 902B24            MOV      DPTR,#assignState
B1:00B849 7404              MOV      A,#04H
B1:00B84B F0                MOVX     @DPTR,A
B1:00B84C 12EAE1            LCALL    AssignTimerStop
B1:00B84F E4                CLR      A
B1:00B850 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00B853 F0                MOVX     @DPTR,A
B1:00B854 903C86            MOV      DPTR,#cmdLength
B1:00B857 E0                MOVX     A,@DPTR
B1:00B858 D3                SETB     C
B1:00B859 9402              SUBB     A,#02H
B1:00B85B 4007              JC       ?C0244?ZW_SLAVE
B1:00B85D 128619            LCALL    ?L?COM0003
B1:00B860 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00B863 F0                MOVX     @DPTR,A
B1:00B864         ?C0244?ZW_SLAVE:
B1:00B864 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00B867 E0                MOVX     A,@DPTR
B1:00B868 FB                MOV      R3,A
B1:00B869 7006              JNZ      ?C0245?ZW_SLAVE
B1:00B86B 7C2B              MOV      R4,#HIGH nodeNormalRangeFrame
B1:00B86D 7DE6              MOV      R5,#LOW nodeNormalRangeFrame
B1:00B86F 8004              SJMP     ?C0246?ZW_SLAVE
B1:00B871         ?C0245?ZW_SLAVE:
B1:00B871 7C2B              MOV      R4,#HIGH nodeFLiRSRangeFrame
B1:00B873 7D7C              MOV      R5,#LOW nodeFLiRSRangeFrame
B1:00B875         ?C0246?ZW_SLAVE:
B1:00B875 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00B878 EC                MOV      A,R4
B1:00B879 F0                MOVX     @DPTR,A
B1:00B87A A3                INC      DPTR
B1:00B87B ED                MOV      A,R5
B1:00B87C F0                MOVX     @DPTR,A
B1:00B87D F582              MOV      DPL,A
B1:00B87F 8C83              MOV      DPH,R4
B1:00B881 7401              MOV      A,#01H
B1:00B883 F0                MOVX     @DPTR,A
B1:00B884 A3                INC      DPTR
B1:00B885 7406              MOV      A,#06H
B1:00B887 F0                MOVX     @DPTR,A
B1:00B888 903C8A            MOV      DPTR,#txOptions
B1:00B88B 7401              MOV      A,#01H
B1:00B88D F0                MOVX     @DPTR,A
B1:00B88E A3                INC      DPTR
B1:00B88F E0                MOVX     A,@DPTR
B1:00B890 30E107            JNB      ACC.1,?C0247?ZW_SLAVE
B1:00B893 903C8A            MOV      DPTR,#txOptions
B1:00B896 E0                MOVX     A,@DPTR
B1:00B897 4402              ORL      A,#02H
B1:00B899 F0                MOVX     @DPTR,A
B1:00B89A         ?C0247?ZW_SLAVE:
B1:00B89A 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00B89D 5158              ACALL    ?L?COM00EC
B1:00B89F A3                INC      DPTR
B1:00B8A0 A3                INC      DPTR
B1:00B8A1 E0                MOVX     A,@DPTR
B1:00B8A2 7005              JNZ      ?C0248?ZW_SLAVE
B1:00B8A4 1232DF            LCALL    ?L?COM03B2
B1:00B8A7 04                INC      A
B1:00B8A8 F0                MOVX     @DPTR,A
B1:00B8A9         ?C0248?ZW_SLAVE:
B1:00B8A9 902BAE            MOV      DPTR,#pNodeRangeFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 313


B1:00B8AC 5158              ACALL    ?L?COM00EC
B1:00B8AE A3                INC      DPTR
B1:00B8AF A3                INC      DPTR
B1:00B8B0 E0                MOVX     A,@DPTR
B1:00B8B1 1232DF            LCALL    ?L?COM03B2
B1:00B8B4 A3                INC      DPTR
B1:00B8B5 2582              ADD      A,DPL
B1:00B8B7 12AF9D            LCALL    ?L?COM01F5
B1:00B8BA EB                MOV      A,R3
B1:00B8BB F0                MOVX     @DPTR,A
B1:00B8BC 901221            MOV      DPTR,#nodeID
B1:00B8BF E0                MOVX     A,@DPTR
B1:00B8C0 FD                MOV      R5,A
B1:00B8C1 514C              ACALL    ?L?COM048D
B1:00B8C3 AA06              MOV      R2,AR6
B1:00B8C5 F9                MOV      R1,A
B1:00B8C6 7B01              MOV      R3,#01H
B1:00B8C8 12CD18            LCALL    ?L?COM007B
B1:00B8CB 1232DF            LCALL    ?L?COM03B2
B1:00B8CE E0                MOVX     A,@DPTR
B1:00B8CF 2404              ADD      A,#04H
B1:00B8D1 FF                MOV      R7,A
B1:00B8D2 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00B8D5 E0                MOVX     A,@DPTR
B1:00B8D6 7E00              MOV      R6,#00H
B1:00B8D8 7002              JNZ      ?C0250?ZW_SLAVE
B1:00B8DA 7E01              MOV      R6,#01H
B1:00B8DC         ?C0250?ZW_SLAVE:
B1:00B8DC         ?C0251?ZW_SLAVE:
B1:00B8DC C3                CLR      C
B1:00B8DD EF                MOV      A,R7
B1:00B8DE 9E                SUBB     A,R6
B1:00B8DF 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00B8E2 F0                MOVX     @DPTR,A
B1:00B8E3 903C8A            MOV      DPTR,#txOptions
B1:00B8E6 12CDE8            LCALL    ?L?COM0266
B1:00B8E9 12FE3E            LCALL    ?L?COM057F
B1:00B8EC 903C8D            MOV      DPTR,#sourceNode
B1:00B8EF 12CD05            LCALL    ?L?COM04B5
B1:00B8F2 6002              JZ       $ + 4H
B1:00B8F4 413D              AJMP     ?C0168?ZW_SLAVE
B1:00B8F6 FB                MOV      R3,A
B1:00B8F7 FA                MOV      R2,A
B1:00B8F8 F9                MOV      R1,A
B1:00B8F9 7F02              MOV      R7,#02H
B1:00B8FB 02EA66            LJMP     _ZCB_AssignComplete
B1:00B8FE         ?C0252?ZW_SLAVE:
B1:00B8FE 903C86            MOV      DPTR,#cmdLength
B1:00B901 E0                MOVX     A,@DPTR
B1:00B902 FF                MOV      R7,A
B1:00B903 C3                CLR      C
B1:00B904 9406              SUBB     A,#06H
B1:00B906 E4                CLR      A
B1:00B907 9400              SUBB     A,#00H
B1:00B909 5002              JNC      $ + 4H
B1:00B90B 413D              AJMP     ?C0168?ZW_SLAVE
B1:00B90D         ?C0253?ZW_SLAVE:
B1:00B90D 902B38            MOV      DPTR,#tempi
B1:00B910 EF                MOV      A,R7
B1:00B911 F0                MOVX     @DPTR,A
B1:00B912 7A2B              MOV      R2,#HIGH nodeInfoFrame+08H
B1:00B914 7958              MOV      R1,#LOW nodeInfoFrame+08H
B1:00B916 7D23              MOV      R5,#023H
B1:00B918 12F46B            LCALL    ?L?COM00ED
B1:00B91B 128FD2            LCALL    ?L?COM0056
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 314


B1:00B91E 128622            LCALL    ?L?COM0006
B1:00B921 FF                MOV      R7,A
B1:00B922 20E261            JB       ACC.2,?C0254?ZW_SLAVE
B1:00B925 4404              ORL      A,#04H
B1:00B927 122072            LCALL    ?C?CSTPTR
B1:00B92A 513E              ACALL    ?L?COM037D
B1:00B92C 126149            LCALL    ?L?COM0047
B1:00B92F 7A2B              MOV      R2,#HIGH nodeInfoFrame
B1:00B931 7950              MOV      R1,#LOW nodeInfoFrame
B1:00B933 1272F3            LCALL    ?L?COM0497
B1:00B936 902B55            MOV      DPTR,#nodeInfoFrame+05H
B1:00B939 E0                MOVX     A,@DPTR
B1:00B93A A3                INC      DPTR
B1:00B93B F0                MOVX     @DPTR,A
B1:00B93C 12D1B7            LCALL    ?L?COM0562
B1:00B93F E4                CLR      A
B1:00B940 902B57            MOV      DPTR,#nodeInfoFrame+07H
B1:00B943 F0                MOVX     @DPTR,A
B1:00B944 902B38            MOV      DPTR,#tempi
B1:00B947 E0                MOVX     A,@DPTR
B1:00B948 2402              ADD      A,#02H
B1:00B94A F0                MOVX     @DPTR,A
B1:00B94B 5144              ACALL    ?L?COM0623
B1:00B94D E4                CLR      A
B1:00B94E 34FF              ADDC     A,#0FFH
B1:00B950 FE                MOV      R6,A
B1:00B951 D3                SETB     C
B1:00B952 EF                MOV      A,R7
B1:00B953 9400              SUBB     A,#00H
B1:00B955 EE                MOV      A,R6
B1:00B956 9400              SUBB     A,#00H
B1:00B958 5002              JNC      $ + 4H
B1:00B95A 21DB              AJMP     ?C0257?ZW_SLAVE
B1:00B95C D3                SETB     C
B1:00B95D EF                MOV      A,R7
B1:00B95E 9423              SUBB     A,#023H
B1:00B960 EE                MOV      A,R6
B1:00B961 9400              SUBB     A,#00H
B1:00B963 4003              JC       ?C0256?ZW_SLAVE
B1:00B965 7429              MOV      A,#029H
B1:00B967 F0                MOVX     @DPTR,A
B1:00B968         ?C0256?ZW_SLAVE:
B1:00B968 5144              ACALL    ?L?COM0623
B1:00B96A 903C83            MOV      DPTR,#pCmd
B1:00B96D 12C8DB            LCALL    ?L?COM01C2
B1:00B970 126145            LCALL    ?L?COM0045
B1:00B973 7B01              MOV      R3,#01H
B1:00B975 7A2B              MOV      R2,#HIGH nodeInfoFrame+08H
B1:00B977 7958              MOV      R1,#LOW nodeInfoFrame+08H
B1:00B979 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00B97C 903C86            MOV      DPTR,#cmdLength
B1:00B97F E0                MOVX     A,@DPTR
B1:00B980 902B38            MOV      DPTR,#tempi
B1:00B983 F0                MOVX     @DPTR,A
B1:00B984 8055              SJMP     ?C0257?ZW_SLAVE
B1:00B986         ?C0254?ZW_SLAVE:
B1:00B986 903C86            MOV      DPTR,#cmdLength
B1:00B989 E0                MOVX     A,@DPTR
B1:00B98A D3                SETB     C
B1:00B98B 942B              SUBB     A,#02BH
B1:00B98D 4007              JC       ?C0258?ZW_SLAVE
B1:00B98F 742B              MOV      A,#02BH
B1:00B991 F0                MOVX     @DPTR,A
B1:00B992 902B38            MOV      DPTR,#tempi
B1:00B995 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 315


B1:00B996         ?C0258?ZW_SLAVE:
B1:00B996 903C86            MOV      DPTR,#cmdLength
B1:00B999 E0                MOVX     A,@DPTR
B1:00B99A FF                MOV      R7,A
B1:00B99B 513E              ACALL    ?L?COM037D
B1:00B99D 126149            LCALL    ?L?COM0047
B1:00B9A0 7B01              MOV      R3,#01H
B1:00B9A2 7A2B              MOV      R2,#HIGH nodeInfoFrame
B1:00B9A4 7950              MOV      R1,#LOW nodeInfoFrame
B1:00B9A6 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00B9A9 902B53            MOV      DPTR,#nodeInfoFrame+03H
B1:00B9AC E0                MOVX     A,@DPTR
B1:00B9AD 20E12B            JB       ACC.1,?C0257?ZW_SLAVE
B1:00B9B0 12D1B7            LCALL    ?L?COM0562
B1:00B9B3 903C86            MOV      DPTR,#cmdLength
B1:00B9B6 E0                MOVX     A,@DPTR
B1:00B9B7 B42B04            CJNE     A,#02BH,?C0260?ZW_SLAVE
B1:00B9BA 14                DEC      A
B1:00B9BB F0                MOVX     @DPTR,A
B1:00B9BC 8006              SJMP     ?C0261?ZW_SLAVE
B1:00B9BE         ?C0260?ZW_SLAVE:
B1:00B9BE 902B38            MOV      DPTR,#tempi
B1:00B9C1 E0                MOVX     A,@DPTR
B1:00B9C2 04                INC      A
B1:00B9C3 F0                MOVX     @DPTR,A
B1:00B9C4         ?C0261?ZW_SLAVE:
B1:00B9C4 903C86            MOV      DPTR,#cmdLength
B1:00B9C7 E0                MOVX     A,@DPTR
B1:00B9C8 24FB              ADD      A,#0FBH
B1:00B9CA 903C83            MOV      DPTR,#pCmd
B1:00B9CD F199              ACALL    ?L?COM01E0
B1:00B9CF 126145            LCALL    ?L?COM0045
B1:00B9D2 7B01              MOV      R3,#01H
B1:00B9D4 7A2B              MOV      R2,#HIGH nodeInfoFrame+06H
B1:00B9D6 7956              MOV      R1,#LOW nodeInfoFrame+06H
B1:00B9D8 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00B9DB         ?C0257?ZW_SLAVE:
B1:00B9DB 903C8D            MOV      DPTR,#sourceNode
B1:00B9DE E0                MOVX     A,@DPTR
B1:00B9DF FD                MOV      R5,A
B1:00B9E0 7B01              MOV      R3,#01H
B1:00B9E2 7A2B              MOV      R2,#HIGH nodeInfoFrame+05H
B1:00B9E4 7955              MOV      R1,#LOW nodeInfoFrame+05H
B1:00B9E6 902B38            MOV      DPTR,#tempi
B1:00B9E9 E0                MOVX     A,@DPTR
B1:00B9EA 24FB              ADD      A,#0FBH
B1:00B9EC 904131            MOV      DPTR,#?_ApplicationSlaveUpdate?BYTE+05H
B1:00B9EF F0                MOVX     @DPTR,A
B1:00B9F0 7F84              MOV      R7,#084H
B1:00B9F2 8046              SJMP     ?C0322?ZW_SLAVE
B1:00B9F4         ?C0262?ZW_SLAVE:
B1:00B9F4 200146            JB       learnMode,?C0168?ZW_SLAVE
B1:00B9F7 E550              MOV      A,bNetworkWideInclusion
B1:00B9F9 7042              JNZ      ?C0168?ZW_SLAVE
B1:00B9FB 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00B9FE E0                MOVX     A,@DPTR
B1:00B9FF 5430              ANL      A,#030H
B1:00BA01 701A              JNZ      ?C0264?ZW_SLAVE
B1:00BA03 903C86            MOV      DPTR,#cmdLength
B1:00BA06 E0                MOVX     A,@DPTR
B1:00BA07 FF                MOV      R7,A
B1:00BA08 7404              MOV      A,#04H
B1:00BA0A D3                SETB     C
B1:00BA0B 9F                SUBB     A,R7
B1:00BA0C 500A              JNC      ?C0265?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 316


B1:00BA0E 128FD2            LCALL    ?L?COM0056
B1:00BA11 128622            LCALL    ?L?COM0006
B1:00BA14 FF                MOV      R7,A
B1:00BA15 121BCE            LCALL    ?INTERBANK_TABLE?_ExploreSetNWITimeout
B1:00BA18         ?C0265?ZW_SLAVE:
B1:00BA18 128619            LCALL    ?L?COM0003
B1:00BA1B 8001              SJMP     ?C0323?ZW_SLAVE
B1:00BA1D         ?C0264?ZW_SLAVE:
B1:00BA1D E4                CLR      A
B1:00BA1E         
B1:00BA1E FF                MOV      R7,A
B1:00BA1F 021BD3            LJMP     ?INTERBANK_TABLE?_ExploreSetNWI
B1:00BA22         ?C0268?ZW_SLAVE:
B1:00BA22 200118            JB       learnMode,?C0168?ZW_SLAVE
B1:00BA25 902B24            MOV      DPTR,#assignState
B1:00BA28 E0                MOVX     A,@DPTR
B1:00BA29 7012              JNZ      ?C0168?ZW_SLAVE
B1:00BA2B 903C8D            MOV      DPTR,#sourceNode
B1:00BA2E E0                MOVX     A,@DPTR
B1:00BA2F FD                MOV      R5,A
B1:00BA30 127070            LCALL    ?L?COM00E1
B1:00BA33 E4                CLR      A
B1:00BA34 904131            MOV      DPTR,#?_ApplicationSlaveUpdate?BYTE+05H
B1:00BA37 F0                MOVX     @DPTR,A
B1:00BA38 7F83              MOV      R7,#083H
B1:00BA3A         
B1:00BA3A 121DEF            LCALL    ?INTERBANK_TABLE?_ApplicationSlaveUpdate
B1:00BA3D         ?C0168?ZW_SLAVE:
B1:00BA3D 22                RET      
----- FUNCTION _CommandHandler (END) -------


----- FUNCTION ?L?COM037D (BEGIN) -----
B1:00BA3E 903C83            MOV      DPTR,#pCmd
B1:00BA41 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM037D (END) -------


----- FUNCTION ?L?COM0623 (BEGIN) -----
B1:00BA44 903C86            MOV      DPTR,#cmdLength
B1:00BA47 E0                MOVX     A,@DPTR
B1:00BA48 24FA              ADD      A,#0FAH
B1:00BA4A FF                MOV      R7,A
B1:00BA4B 22                RET      
----- FUNCTION ?L?COM0623 (END) -------


----- FUNCTION ?L?COM048D (BEGIN) -----
B1:00BA4C 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00BA4F E0                MOVX     A,@DPTR
B1:00BA50 FE                MOV      R6,A
B1:00BA51 A3                INC      DPTR
B1:00BA52 E0                MOVX     A,@DPTR
B1:00BA53 FF                MOV      R7,A
B1:00BA54 22                RET      
----- FUNCTION ?L?COM048D (END) -------


----- FUNCTION ?L?COM00EB (BEGIN) -----
B1:00BA55 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BA58         ?L?COM00EC:
B1:00BA58 E0                MOVX     A,@DPTR
B1:00BA59 FE                MOV      R6,A
B1:00BA5A A3                INC      DPTR
B1:00BA5B E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 317


B1:00BA5C FF                MOV      R7,A
B1:00BA5D F582              MOV      DPL,A
B1:00BA5F 8E83              MOV      DPH,R6
B1:00BA61 22                RET      
----- FUNCTION ?L?COM00EB (END) -------


----- FUNCTION RearrangeNVMmodules (BEGIN) -----
B1:00BA62 7E7F              MOV      R6,#HIGH nvmDescriptorUpdate
B1:00BA64 7F9C              MOV      R7,#LOW nvmDescriptorUpdate
B1:00BA66 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BA69 EE                MOV      A,R6
B1:00BA6A F0                MOVX     @DPTR,A
B1:00BA6B A3                INC      DPTR
B1:00BA6C EF                MOV      A,R7
B1:00BA6D F0                MOVX     @DPTR,A
B1:00BA6E F582              MOV      DPL,A
B1:00BA70 8E83              MOV      DPH,R6
B1:00BA72 D15A              ACALL    ?L?COM02B6
B1:00BA74 4B                ORL      A,R3
B1:00BA75 6075              JZ       ?C0018?ZW_NVM_REARRANGE
B1:00BA77 123F4B            LCALL    ?L?COM00C9
B1:00BA7A F1A9              ACALL    ?L?COM05DC
B1:00BA7C 9039B1            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00BA7F 12722B            LCALL    ?L?COM03FD
B1:00BA82 F9                MOV      R1,A
B1:00BA83 E4                CLR      A
B1:00BA84 3A                ADDC     A,R2
B1:00BA85 FA                MOV      R2,A
B1:00BA86 9039BA            MOV      DPTR,#nvmDescriptorOldPtr
B1:00BA89 1225A9            LCALL    ?C?PSTXDATA
B1:00BA8C 123F86            LCALL    ?L?COM043F
B1:00BA8F 7A39              MOV      R2,#HIGH wValidation
B1:00BA91 79C8              MOV      R1,#LOW wValidation
B1:00BA93 123F5B            LCALL    ?L?COM00CA
B1:00BA96 9039C8            MOV      DPTR,#wValidation
B1:00BA99 E0                MOVX     A,@DPTR
B1:00BA9A FE                MOV      R6,A
B1:00BA9B A3                INC      DPTR
B1:00BA9C E0                MOVX     A,@DPTR
B1:00BA9D 1273F9            LCALL    ?L?COM05F1
B1:00BAA0 6F                XRL      A,R7
B1:00BAA1 7003              JNZ      ?C0047?ZW_NVM_REARRANGE
B1:00BAA3 E4                CLR      A
B1:00BAA4 93                MOVC     A,@A+DPTR
B1:00BAA5 6E                XRL      A,R6
B1:00BAA6         ?C0047?ZW_NVM_REARRANGE:
B1:00BAA6 7F00              MOV      R7,#00H
B1:00BAA8 6002              JZ       ?C0019?ZW_NVM_REARRANGE
B1:00BAAA 7F01              MOV      R7,#01H
B1:00BAAC         ?C0019?ZW_NVM_REARRANGE:
B1:00BAAC         ?C0020?ZW_NVM_REARRANGE:
B1:00BAAC 9039BF            MOV      DPTR,#retVal
B1:00BAAF EF                MOV      A,R7
B1:00BAB0 F0                MOVX     @DPTR,A
B1:00BAB1 9039BA            MOV      DPTR,#nvmDescriptorOldPtr
B1:00BAB4 122589            LCALL    ?C?PLDXDATA
B1:00BAB7 E9                MOV      A,R1
B1:00BAB8 2402              ADD      A,#02H
B1:00BABA D1FC              ACALL    ?L?COM0312
B1:00BABC 7B01              MOV      R3,#01H
B1:00BABE 7A39              MOV      R2,#HIGH wValidation
B1:00BAC0 79C8              MOV      R1,#LOW wValidation
B1:00BAC2 123F5B            LCALL    ?L?COM00CA
B1:00BAC5 9039BF            MOV      DPTR,#retVal
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 318


B1:00BAC8 E0                MOVX     A,@DPTR
B1:00BAC9 9039C8            MOV      DPTR,#wValidation
B1:00BACC 127118            LCALL    ?L?COM0289
B1:00BACF 907FC2            MOV      DPTR,#firmwareDescriptor+0AH
B1:00BAD2 7401              MOV      A,#01H
B1:00BAD4 93                MOVC     A,@A+DPTR
B1:00BAD5 6D                XRL      A,R5
B1:00BAD6 7003              JNZ      ?C0048?ZW_NVM_REARRANGE
B1:00BAD8 E4                CLR      A
B1:00BAD9 93                MOVC     A,@A+DPTR
B1:00BADA 6C                XRL      A,R4
B1:00BADB         ?C0048?ZW_NVM_REARRANGE:
B1:00BADB 7E00              MOV      R6,#00H
B1:00BADD 6002              JZ       ?C0021?ZW_NVM_REARRANGE
B1:00BADF 7E01              MOV      R6,#01H
B1:00BAE1         ?C0021?ZW_NVM_REARRANGE:
B1:00BAE1         ?C0022?ZW_NVM_REARRANGE:
B1:00BAE1 EF                MOV      A,R7
B1:00BAE2 4E                ORL      A,R6
B1:00BAE3 9039BF            MOV      DPTR,#retVal
B1:00BAE6 F0                MOVX     @DPTR,A
B1:00BAE7 6003              JZ       ?C0018?ZW_NVM_REARRANGE
B1:00BAE9 7F00              MOV      R7,#00H
B1:00BAEB 22                RET      
B1:00BAEC         ?C0018?ZW_NVM_REARRANGE:
B1:00BAEC 5155              ACALL    ?L?COM00EB
B1:00BAEE F17C              ACALL    ?L?COM01D5
B1:00BAF0 AE02              MOV      R6,AR2
B1:00BAF2 AF01              MOV      R7,AR1
B1:00BAF4 AC02              MOV      R4,AR2
B1:00BAF6 AD01              MOV      R5,AR1
B1:00BAF8 E0                MOVX     A,@DPTR
B1:00BAF9 2D                ADD      A,R5
B1:00BAFA FD                MOV      R5,A
B1:00BAFB 9039C2            MOV      DPTR,#dataLengthNew
B1:00BAFE E0                MOVX     A,@DPTR
B1:00BAFF 3C                ADDC     A,R4
B1:00BB00 CD                XCH      A,R5
B1:00BB01 2402              ADD      A,#02H
B1:00BB03 CD                XCH      A,R5
B1:00BB04 3400              ADDC     A,#00H
B1:00BB06 FC                MOV      R4,A
B1:00BB07 B129              ACALL    _CinitNVMvariables
B1:00BB09 D167              ACALL    ?L?COM02B7
B1:00BB0B 4B                ORL      A,R3
B1:00BB0C 7002              JNZ      $ + 4H
B1:00BB0E 61AA              AJMP     ?C0025?ZW_NVM_REARRANGE
B1:00BB10 619D              AJMP     ?C0031?ZW_NVM_REARRANGE
B1:00BB12         ?C0026?ZW_NVM_REARRANGE:
B1:00BB12 F1C2              ACALL    ?L?COM05B0
B1:00BB14 C3                CLR      C
B1:00BB15 947E              SUBB     A,#LOW nvmZWlibraryUpdate
B1:00BB17 EC                MOV      A,R4
B1:00BB18 947F              SUBB     A,#HIGH nvmZWlibraryUpdate
B1:00BB1A 5002              JNC      $ + 4H
B1:00BB1C 81EA              AJMP     ?C0032?ZW_NVM_REARRANGE
B1:00BB1E 5155              ACALL    ?L?COM00EB
B1:00BB20 F17C              ACALL    ?L?COM01D5
B1:00BB22 8D82              MOV      DPL,R5
B1:00BB24 8C83              MOV      DPH,R4
B1:00BB26 D15A              ACALL    ?L?COM02B6
B1:00BB28 4B                ORL      A,R3
B1:00BB29 603B              JZ       ?C0028?ZW_NVM_REARRANGE
B1:00BB2B 123F4B            LCALL    ?L?COM00C9
B1:00BB2E F1A9              ACALL    ?L?COM05DC
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 319


B1:00BB30 9039B1            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00BB33 F199              ACALL    ?L?COM01E0
B1:00BB35 F9                MOV      R1,A
B1:00BB36 E4                CLR      A
B1:00BB37 3A                ADDC     A,R2
B1:00BB38 FA                MOV      R2,A
B1:00BB39 C3                CLR      C
B1:00BB3A E9                MOV      A,R1
B1:00BB3B 9F                SUBB     A,R7
B1:00BB3C F9                MOV      R1,A
B1:00BB3D EA                MOV      A,R2
B1:00BB3E 9E                SUBB     A,R6
B1:00BB3F FA                MOV      R2,A
B1:00BB40 B116              ACALL    ?L?COM038F
B1:00BB42 9039B7            MOV      DPTR,#nvmModuleOldPtr
B1:00BB45 122589            LCALL    ?C?PLDXDATA
B1:00BB48 C003              PUSH     AR3
B1:00BB4A C002              PUSH     AR2
B1:00BB4C C001              PUSH     AR1
B1:00BB4E B110              ACALL    ?L?COM017B
B1:00BB50 D3                SETB     C
B1:00BB51 D082              POP      DPL
B1:00BB53 D083              POP      DPH
B1:00BB55 D0E0              POP      ACC
B1:00BB57 12736C            LCALL    ?L?COM0546
B1:00BB5A         ?C0051?ZW_NVM_REARRANGE:
B1:00BB5A 4011              JC       ?C0030?ZW_NVM_REARRANGE
B1:00BB5C 91FE              ACALL    ?L?COM017A
B1:00BB5E 12FE58            LCALL    ?L?COM0355
B1:00BB61 12EF5A            LCALL    _NVM_MoveData
B1:00BB64 8007              SJMP     ?C0030?ZW_NVM_REARRANGE
B1:00BB66         ?C0028?ZW_NVM_REARRANGE:
B1:00BB66 F1B9              ACALL    ?L?COM05AF
B1:00BB68 12706F            LCALL    ?L?COM00E0
B1:00BB6B B116              ACALL    ?L?COM038F
B1:00BB6D         ?C0030?ZW_NVM_REARRANGE:
B1:00BB6D F172              ACALL    ?L?COM0341
B1:00BB6F F1CB              ACALL    ?L?COM04C8
B1:00BB71 402A              JC       ?C0031?ZW_NVM_REARRANGE
B1:00BB73 B110              ACALL    ?L?COM017B
B1:00BB75 F1E2              ACALL    ?L?COM0442
B1:00BB77 CF                XCH      A,R7
B1:00BB78 24FB              ADD      A,#0FBH
B1:00BB7A CF                XCH      A,R7
B1:00BB7B 34FF              ADDC     A,#0FFH
B1:00BB7D FE                MOV      R6,A
B1:00BB7E C006              PUSH     AR6
B1:00BB80 127070            LCALL    ?L?COM00E1
B1:00BB83 12FE47            LCALL    ?L?COM03B6
B1:00BB86 F0                MOVX     @DPTR,A
B1:00BB87 D006              POP      AR6
B1:00BB89 126C78            LCALL    _NVM_ext_write_buffer
B1:00BB8C B110              ACALL    ?L?COM017B
B1:00BB8E F1D6              ACALL    ?L?COM048A
B1:00BB90 CF                XCH      A,R7
B1:00BB91 24FB              ADD      A,#0FBH
B1:00BB93 CF                XCH      A,R7
B1:00BB94 34FF              ADDC     A,#0FFH
B1:00BB96 B11C              ACALL    ?L?COM03CC
B1:00BB98 B110              ACALL    ?L?COM017B
B1:00BB9A 126C65            LCALL    ?L?COM0207
B1:00BB9D         ?C0031?ZW_NVM_REARRANGE:
B1:00BB9D 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BBA0 74FF              MOV      A,#0FFH
B1:00BBA2 75F0F6            MOV      B,#0F6H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 320


B1:00BBA5 122143            LCALL    ?C?IILDX
B1:00BBA8 6112              AJMP     ?C0026?ZW_NVM_REARRANGE
B1:00BBAA         ?C0025?ZW_NVM_REARRANGE:
B1:00BBAA 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BBAD 747F              MOV      A,#HIGH nvmZWlibraryUpdate
B1:00BBAF F0                MOVX     @DPTR,A
B1:00BBB0 A3                INC      DPTR
B1:00BBB1 747E              MOV      A,#LOW nvmZWlibraryUpdate
B1:00BBB3 F0                MOVX     @DPTR,A
B1:00BBB4         ?C0033?ZW_NVM_REARRANGE:
B1:00BBB4 F1C2              ACALL    ?L?COM05B0
B1:00BBB6 C3                CLR      C
B1:00BBB7 949C              SUBB     A,#LOW nvmDescriptorUpdate
B1:00BBB9 EC                MOV      A,R4
B1:00BBBA 947F              SUBB     A,#HIGH nvmDescriptorUpdate
B1:00BBBC 4002              JC       $ + 4H
B1:00BBBE 81EA              AJMP     ?C0032?ZW_NVM_REARRANGE
B1:00BBC0 5155              ACALL    ?L?COM00EB
B1:00BBC2 1225B2            LCALL    ?C?PLDCODE
B1:00BBC5 9039B4            MOV      DPTR,#nvmModuleNewPtr
B1:00BBC8 1225A9            LCALL    ?C?PSTXDATA
B1:00BBCB 8F82              MOV      DPL,R7
B1:00BBCD 8E83              MOV      DPH,R6
B1:00BBCF 7406              MOV      A,#06H
B1:00BBD1 93                MOVC     A,@A+DPTR
B1:00BBD2 24FE              ADD      A,#0FEH
B1:00BBD4 FE                MOV      R6,A
B1:00BBD5 7405              MOV      A,#05H
B1:00BBD7 93                MOVC     A,@A+DPTR
B1:00BBD8 34FF              ADDC     A,#0FFH
B1:00BBDA 9039C2            MOV      DPTR,#dataLengthNew
B1:00BBDD F0                MOVX     @DPTR,A
B1:00BBDE A3                INC      DPTR
B1:00BBDF CE                XCH      A,R6
B1:00BBE0 F0                MOVX     @DPTR,A
B1:00BBE1 F1A1              ACALL    ?L?COM05C7
B1:00BBE3 FF                MOV      R7,A
B1:00BBE4 7404              MOV      A,#04H
B1:00BBE6 93                MOVC     A,@A+DPTR
B1:00BBE7 9039C0            MOV      DPTR,#dataLengthOld
B1:00BBEA CF                XCH      A,R7
B1:00BBEB F0                MOVX     @DPTR,A
B1:00BBEC A3                INC      DPTR
B1:00BBED EF                MOV      A,R7
B1:00BBEE F0                MOVX     @DPTR,A
B1:00BBEF 9039C0            MOV      DPTR,#dataLengthOld
B1:00BBF2 12F09B            LCALL    ?L?COM0248
B1:00BBF5 7002              JNZ      $ + 4H
B1:00BBF7 81A3              AJMP     ?C0035?ZW_NVM_REARRANGE
B1:00BBF9 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BBFC 12AFA8            LCALL    ?L?COM022A
B1:00BBFF 7407              MOV      A,#07H
B1:00BC01 93                MOVC     A,@A+DPTR
B1:00BC02 24FC              ADD      A,#0FCH
B1:00BC04 6022              JZ       ?C0038?ZW_NVM_REARRANGE
B1:00BC06 14                DEC      A
B1:00BC07 6033              JZ       ?C0039?ZW_NVM_REARRANGE
B1:00BC09 2403              ADD      A,#03H
B1:00BC0B 704D              JNZ      ?C0040?ZW_NVM_REARRANGE
B1:00BC0D         ?C0037?ZW_NVM_REARRANGE:
B1:00BC0D 7B01              MOV      R3,#01H
B1:00BC0F 7A00              MOV      R2,#HIGH _FD_ZW_NVM_S_
B1:00BC11 7900              MOV      R1,#LOW _FD_ZW_NVM_S_
B1:00BC13 B116              ACALL    ?L?COM038F
B1:00BC15 B110              ACALL    ?L?COM017B
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 321


B1:00BC17 C3                CLR      C
B1:00BC18 EF                MOV      A,R7
B1:00BC19 99                SUBB     A,R1
B1:00BC1A FF                MOV      R7,A
B1:00BC1B EE                MOV      A,R6
B1:00BC1C 9A                SUBB     A,R2
B1:00BC1D CF                XCH      A,R7
B1:00BC1E 24FE              ADD      A,#0FEH
B1:00BC20 CF                XCH      A,R7
B1:00BC21 34FF              ADDC     A,#0FFH
B1:00BC23 9039C0            MOV      DPTR,#dataLengthOld
B1:00BC26 8026              SJMP     ?C0056?ZW_NVM_REARRANGE
B1:00BC28         ?C0038?ZW_NVM_REARRANGE:
B1:00BC28 7B01              MOV      R3,#01H
B1:00BC2A 7A60              MOV      R2,#HIGH _FD_ZW_NVM_S_+06000H
B1:00BC2C 7900              MOV      R1,#LOW _FD_ZW_NVM_S_+06000H
B1:00BC2E B116              ACALL    ?L?COM038F
B1:00BC30 B110              ACALL    ?L?COM017B
B1:00BC32 12F21F            LCALL    ?L?COM041C
B1:00BC35 24FE              ADD      A,#0FEH
B1:00BC37 CF                XCH      A,R7
B1:00BC38 34FF              ADDC     A,#0FFH
B1:00BC3A         
B1:00BC3A 8012              SJMP     ?C0056?ZW_NVM_REARRANGE
B1:00BC3C         ?C0039?ZW_NVM_REARRANGE:
B1:00BC3C 7B01              MOV      R3,#01H
B1:00BC3E 7A60              MOV      R2,#HIGH _FD_ZW_NVM_S_+06040H
B1:00BC40 7940              MOV      R1,#LOW _FD_ZW_NVM_S_+06040H
B1:00BC42 B116              ACALL    ?L?COM038F
B1:00BC44 B110              ACALL    ?L?COM017B
B1:00BC46 12F21F            LCALL    ?L?COM041C
B1:00BC49 24FE              ADD      A,#0FEH
B1:00BC4B CF                XCH      A,R7
B1:00BC4C 34FF              ADDC     A,#0FFH
B1:00BC4E         
B1:00BC4E F0                MOVX     @DPTR,A
B1:00BC4F A3                INC      DPTR
B1:00BC50 EF                MOV      A,R7
B1:00BC51 F0                MOVX     @DPTR,A
B1:00BC52 12DB7B            LCALL    ?L?COM006E
B1:00BC55 9039B4            MOV      DPTR,#nvmModuleNewPtr
B1:00BC58 800A              SJMP     ?C0057?ZW_NVM_REARRANGE
B1:00BC5A         ?C0040?ZW_NVM_REARRANGE:
B1:00BC5A E4                CLR      A
B1:00BC5B 9039C0            MOV      DPTR,#dataLengthOld
B1:00BC5E 12735F            LCALL    ?L?COM0532
B1:00BC61 9039B7            MOV      DPTR,#nvmModuleOldPtr
B1:00BC64         
B1:00BC64 1225A9            LCALL    ?C?PSTXDATA
B1:00BC67         ?C0036?ZW_NVM_REARRANGE:
B1:00BC67 9039B7            MOV      DPTR,#nvmModuleOldPtr
B1:00BC6A 122589            LCALL    ?C?PLDXDATA
B1:00BC6D AE02              MOV      R6,AR2
B1:00BC6F AF01              MOV      R7,AR1
B1:00BC71 B110              ACALL    ?L?COM017B
B1:00BC73 E9                MOV      A,R1
B1:00BC74 6F                XRL      A,R7
B1:00BC75 7002              JNZ      ?C0052?ZW_NVM_REARRANGE
B1:00BC77 EA                MOV      A,R2
B1:00BC78 6E                XRL      A,R6
B1:00BC79         ?C0052?ZW_NVM_REARRANGE:
B1:00BC79 6008              JZ       ?C0041?ZW_NVM_REARRANGE
B1:00BC7B 91FE              ACALL    ?L?COM017A
B1:00BC7D 12FE58            LCALL    ?L?COM0355
B1:00BC80 12EF5A            LCALL    _NVM_MoveData
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 322


B1:00BC83         ?C0041?ZW_NVM_REARRANGE:
B1:00BC83 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BC86 D151              ACALL    ?L?COM00BA
B1:00BC88 7407              MOV      A,#07H
B1:00BC8A 93                MOVC     A,@A+DPTR
B1:00BC8B 6402              XRL      A,#02H
B1:00BC8D 701B              JNZ      ?C0043?ZW_NVM_REARRANGE
B1:00BC8F 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_VALID_far
B1:00BC91 7F09              MOV      R7,#LOW NVM_CONFIGURATION_VALID_far
B1:00BC93 7D54              MOV      R5,#054H
B1:00BC95 123FC4            LCALL    _NVM_ext_write_byte
B1:00BC98 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_REALLYVALID_far
B1:00BC9A 7F0A              MOV      R7,#LOW NVM_CONFIGURATION_REALLYVALID_far
B1:00BC9C 7DA5              MOV      R5,#0A5H
B1:00BC9E 123FC4            LCALL    _NVM_ext_write_byte
B1:00BCA1 8007              SJMP     ?C0043?ZW_NVM_REARRANGE
B1:00BCA3         ?C0035?ZW_NVM_REARRANGE:
B1:00BCA3 F1B9              ACALL    ?L?COM05AF
B1:00BCA5 12706F            LCALL    ?L?COM00E0
B1:00BCA8 B116              ACALL    ?L?COM038F
B1:00BCAA         ?C0043?ZW_NVM_REARRANGE:
B1:00BCAA F172              ACALL    ?L?COM0341
B1:00BCAC F1CB              ACALL    ?L?COM04C8
B1:00BCAE 402E              JC       ?C0044?ZW_NVM_REARRANGE
B1:00BCB0 B110              ACALL    ?L?COM017B
B1:00BCB2 F1E2              ACALL    ?L?COM0442
B1:00BCB4 FE                MOV      R6,A
B1:00BCB5 C006              PUSH     AR6
B1:00BCB7 127070            LCALL    ?L?COM00E1
B1:00BCBA 12FE47            LCALL    ?L?COM03B6
B1:00BCBD F0                MOVX     @DPTR,A
B1:00BCBE D006              POP      AR6
B1:00BCC0 126C78            LCALL    _NVM_ext_write_buffer
B1:00BCC3 B110              ACALL    ?L?COM017B
B1:00BCC5 F1D6              ACALL    ?L?COM048A
B1:00BCC7 B11C              ACALL    ?L?COM03CC
B1:00BCC9 B110              ACALL    ?L?COM017B
B1:00BCCB E9                MOV      A,R1
B1:00BCCC 24FE              ADD      A,#0FEH
B1:00BCCE 9039B4            MOV      DPTR,#nvmModuleNewPtr
B1:00BCD1 1272DD            LCALL    ?L?COM048B
B1:00BCD4 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BCD7 D151              ACALL    ?L?COM00BA
B1:00BCD9 F189              ACALL    ?L?COM01D6
B1:00BCDB 126C65            LCALL    ?L?COM0207
B1:00BCDE         ?C0044?ZW_NVM_REARRANGE:
B1:00BCDE 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BCE1 E4                CLR      A
B1:00BCE2 75F00A            MOV      B,#0AH
B1:00BCE5 122143            LCALL    ?C?IILDX
B1:00BCE8 61B4              AJMP     ?C0033?ZW_NVM_REARRANGE
B1:00BCEA         ?C0032?ZW_NVM_REARRANGE:
B1:00BCEA 9039C2            MOV      DPTR,#dataLengthNew
B1:00BCED 7414              MOV      A,#HIGH _HDATA_E_
B1:00BCEF F0                MOVX     @DPTR,A
B1:00BCF0 A3                INC      DPTR
B1:00BCF1 7413              MOV      A,#LOW _HDATA_E_
B1:00BCF3 F0                MOVX     @DPTR,A
B1:00BCF4 7E00              MOV      R6,#HIGH nvmTotalEnd
B1:00BCF6 7F00              MOV      R7,#LOW nvmTotalEnd
B1:00BCF8 126C69            LCALL    ?L?COM0208
B1:00BCFB 7F02              MOV      R7,#02H
B1:00BCFD 22                RET      
----- FUNCTION RearrangeNVMmodules (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 323



----- FUNCTION ?L?COM017A (BEGIN) -----
B1:00BCFE 9039B7            MOV      DPTR,#nvmModuleOldPtr
B1:00BD01 122589            LCALL    ?C?PLDXDATA
B1:00BD04 AE02              MOV      R6,AR2
B1:00BD06 AF01              MOV      R7,AR1
B1:00BD08 9039C4            MOV      DPTR,#NVM_WorkPtrRead
B1:00BD0B EE                MOV      A,R6
B1:00BD0C F0                MOVX     @DPTR,A
B1:00BD0D A3                INC      DPTR
B1:00BD0E EF                MOV      A,R7
B1:00BD0F F0                MOVX     @DPTR,A
B1:00BD10         ?L?COM017B:
B1:00BD10 9039B4            MOV      DPTR,#nvmModuleNewPtr
B1:00BD13 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM017A (END) -------


----- FUNCTION ?L?COM038F (BEGIN) -----
B1:00BD16 9039B7            MOV      DPTR,#nvmModuleOldPtr
B1:00BD19 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM038F (END) -------


----- FUNCTION ?L?COM03CC (BEGIN) -----
B1:00BD1C FE                MOV      R6,A
B1:00BD1D 9039C3            MOV      DPTR,#dataLengthNew+01H
B1:00BD20 E0                MOVX     A,@DPTR
B1:00BD21 29                ADD      A,R1
B1:00BD22 FD                MOV      R5,A
B1:00BD23 9039C2            MOV      DPTR,#dataLengthNew
B1:00BD26 E0                MOVX     A,@DPTR
B1:00BD27 3A                ADDC     A,R2
B1:00BD28 FC                MOV      R4,A
----- FUNCTION _CinitNVMvariables (BEGIN) -----
B1:00BD29 903D68            MOV      DPTR,#low
B1:00BD2C 1270CD            LCALL    ?L?COM019E
B1:00BD2F A3                INC      DPTR
B1:00BD30 7429              MOV      A,#HIGH _C_INITSEG_S_
B1:00BD32 F0                MOVX     @DPTR,A
B1:00BD33 A3                INC      DPTR
B1:00BD34 74F3              MOV      A,#LOW _C_INITSEG_S_
B1:00BD36 F0                MOVX     @DPTR,A
B1:00BD37         ?C0001?ZW_NVM_INIT:
B1:00BD37 D14E              ACALL    ?L?COM00B9
B1:00BD39 E4                CLR      A
B1:00BD3A 93                MOVC     A,@A+DPTR
B1:00BD3B 7002              JNZ      $ + 4H
B1:00BD3D C14D              AJMP     ?C0017?ZW_NVM_INIT
B1:00BD3F E4                CLR      A
B1:00BD40 93                MOVC     A,@A+DPTR
B1:00BD41 FF                MOV      R7,A
B1:00BD42 541F              ANL      A,#01FH
B1:00BD44 903D6E            MOV      DPTR,#length
B1:00BD47 1272AB            LCALL    ?L?COM0447
B1:00BD4A EF                MOV      A,R7
B1:00BD4B C4                SWAP     A
B1:00BD4C 13                RRC      A
B1:00BD4D 5407              ANL      A,#07H
B1:00BD4F 1226B6            LCALL    ?C?CCASE
B1:00BD52 BD6E              DW       ?C0004?ZW_NVM_INIT
B1:00BD54 00                DB       00H
B1:00BD55 BD70              DW       ?C0005?ZW_NVM_INIT
B1:00BD57 01                DB       01H
B1:00BD58 BD72              DW       ?C0006?ZW_NVM_INIT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 324


B1:00BD5A 02                DB       02H
B1:00BD5B BD7A              DW       ?C0007?ZW_NVM_INIT
B1:00BD5D 03                DB       03H
B1:00BD5E BD82              DW       ?C0008?ZW_NVM_INIT
B1:00BD60 04                DB       04H
B1:00BD61 BD8A              DW       ?C0009?ZW_NVM_INIT
B1:00BD63 05                DB       05H
B1:00BD64 BD95              DW       ?C0010?ZW_NVM_INIT
B1:00BD66 06                DB       06H
B1:00BD67 BD9F              DW       ?C0011?ZW_NVM_INIT
B1:00BD69 07                DB       07H
B1:00BD6A 0000              DW       00H
B1:00BD6C BD37              DW       ?C0001?ZW_NVM_INIT
B1:00BD6E         ?C0004?ZW_NVM_INIT:
B1:00BD6E 8012              SJMP     ?C0018?ZW_NVM_INIT
B1:00BD70         ?C0005?ZW_NVM_INIT:
B1:00BD70 8018              SJMP     ?C0019?ZW_NVM_INIT
B1:00BD72         ?C0006?ZW_NVM_INIT:
B1:00BD72 903D6F            MOV      DPTR,#length+01H
B1:00BD75 E0                MOVX     A,@DPTR
B1:00BD76 2403              ADD      A,#03H
B1:00BD78 8021              SJMP     ?C0022?ZW_NVM_INIT
B1:00BD7A         ?C0007?ZW_NVM_INIT:
B1:00BD7A D14E              ACALL    ?L?COM00B9
B1:00BD7C D170              ACALL    ?L?COM01F2
B1:00BD7E 2404              ADD      A,#04H
B1:00BD80 800E              SJMP     ?C0021?ZW_NVM_INIT
B1:00BD82         ?C0008?ZW_NVM_INIT:
B1:00BD82         
B1:00BD82 903D6F            MOV      DPTR,#length+01H
B1:00BD85 E0                MOVX     A,@DPTR
B1:00BD86 2402              ADD      A,#02H
B1:00BD88         
B1:00BD88 8011              SJMP     ?C0022?ZW_NVM_INIT
B1:00BD8A         ?C0009?ZW_NVM_INIT:
B1:00BD8A         
B1:00BD8A D14E              ACALL    ?L?COM00B9
B1:00BD8C D170              ACALL    ?L?COM01F2
B1:00BD8E 2403              ADD      A,#03H
B1:00BD90         
B1:00BD90 FF                MOV      R7,A
B1:00BD91 E4                CLR      A
B1:00BD92 3E                ADDC     A,R6
B1:00BD93 C143              AJMP     ?C0024?ZW_NVM_INIT
B1:00BD95         ?C0010?ZW_NVM_INIT:
B1:00BD95 903D6F            MOV      DPTR,#length+01H
B1:00BD98 E0                MOVX     A,@DPTR
B1:00BD99 2401              ADD      A,#01H
B1:00BD9B         
B1:00BD9B F1B1              ACALL    ?L?COM061D
B1:00BD9D         
B1:00BD9D C143              AJMP     ?C0024?ZW_NVM_INIT
B1:00BD9F         ?C0011?ZW_NVM_INIT:
B1:00BD9F 903D6C            MOV      DPTR,#initsegPtr
B1:00BDA2 12515D            LCALL    ?L?COM0154
B1:00BDA5 7401              MOV      A,#01H
B1:00BDA7 93                MOVC     A,@A+DPTR
B1:00BDA8 FB                MOV      R3,A
B1:00BDA9 7A00              MOV      R2,#00H
B1:00BDAB 903D6F            MOV      DPTR,#length+01H
B1:00BDAE E0                MOVX     A,@DPTR
B1:00BDAF FE                MOV      R6,A
B1:00BDB0 E4                CLR      A
B1:00BDB1 2B                ADD      A,R3
B1:00BDB2 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 325


B1:00BDB3 EA                MOV      A,R2
B1:00BDB4 3E                ADDC     A,R6
B1:00BDB5 D181              ACALL    ?L?COM01F3
B1:00BDB7 F1A1              ACALL    ?L?COM05C7
B1:00BDB9 FE                MOV      R6,A
B1:00BDBA 903D6C            MOV      DPTR,#initsegPtr
B1:00BDBD 12AFAA            LCALL    ?L?COM022B
B1:00BDC0 7404              MOV      A,#04H
B1:00BDC2 93                MOVC     A,@A+DPTR
B1:00BDC3 903D70            MOV      DPTR,#address
B1:00BDC6 12712F            LCALL    ?L?COM0298
B1:00BDC9 D3                SETB     C
B1:00BDCA 903D69            MOV      DPTR,#low+01H
B1:00BDCD E0                MOVX     A,@DPTR
B1:00BDCE 9F                SUBB     A,R7
B1:00BDCF 903D68            MOV      DPTR,#low
B1:00BDD2 E0                MOVX     A,@DPTR
B1:00BDD3 9E                SUBB     A,R6
B1:00BDD4 5065              JNC      ?C0012?ZW_NVM_INIT
B1:00BDD6 903D6A            MOV      DPTR,#high
B1:00BDD9 1265F9            LCALL    ?L?COM0199
B1:00BDDC 903D71            MOV      DPTR,#address+01H
B1:00BDDF E0                MOVX     A,@DPTR
B1:00BDE0 9F                SUBB     A,R7
B1:00BDE1 903D70            MOV      DPTR,#address
B1:00BDE4 E0                MOVX     A,@DPTR
B1:00BDE5 9E                SUBB     A,R6
B1:00BDE6 5053              JNC      ?C0012?ZW_NVM_INIT
B1:00BDE8 E4                CLR      A
B1:00BDE9 903D72            MOV      DPTR,#index
B1:00BDEC F0                MOVX     @DPTR,A
B1:00BDED A3                INC      DPTR
B1:00BDEE F0                MOVX     @DPTR,A
B1:00BDEF         ?C0013?ZW_NVM_INIT:
B1:00BDEF 903D6E            MOV      DPTR,#length
B1:00BDF2 1265F9            LCALL    ?L?COM0199
B1:00BDF5 903D73            MOV      DPTR,#index+01H
B1:00BDF8 E0                MOVX     A,@DPTR
B1:00BDF9 9F                SUBB     A,R7
B1:00BDFA 903D72            MOV      DPTR,#index
B1:00BDFD E0                MOVX     A,@DPTR
B1:00BDFE 9E                SUBB     A,R6
B1:00BDFF 503A              JNC      ?C0012?ZW_NVM_INIT
B1:00BE01 E0                MOVX     A,@DPTR
B1:00BE02 FC                MOV      R4,A
B1:00BE03 A3                INC      DPTR
B1:00BE04 E0                MOVX     A,@DPTR
B1:00BE05 FD                MOV      R5,A
B1:00BE06 903D71            MOV      DPTR,#address+01H
B1:00BE09 E0                MOVX     A,@DPTR
B1:00BE0A 2D                ADD      A,R5
B1:00BE0B FF                MOV      R7,A
B1:00BE0C 903D70            MOV      DPTR,#address
B1:00BE0F E0                MOVX     A,@DPTR
B1:00BE10 3C                ADDC     A,R4
B1:00BE11 FE                MOV      R6,A
B1:00BE12 903D6D            MOV      DPTR,#initsegPtr+01H
B1:00BE15 E0                MOVX     A,@DPTR
B1:00BE16 2405              ADD      A,#05H
B1:00BE18 FB                MOV      R3,A
B1:00BE19 903D6C            MOV      DPTR,#initsegPtr
B1:00BE1C E0                MOVX     A,@DPTR
B1:00BE1D 3400              ADDC     A,#00H
B1:00BE1F 8B82              MOV      DPL,R3
B1:00BE21 F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 326


B1:00BE23 E582              MOV      A,DPL
B1:00BE25 2D                ADD      A,R5
B1:00BE26 F582              MOV      DPL,A
B1:00BE28 E583              MOV      A,DPH
B1:00BE2A 3C                ADDC     A,R4
B1:00BE2B F583              MOV      DPH,A
B1:00BE2D E4                CLR      A
B1:00BE2E 93                MOVC     A,@A+DPTR
B1:00BE2F FD                MOV      R5,A
B1:00BE30 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B1:00BE33 903D72            MOV      DPTR,#index
B1:00BE36 123F7F            LCALL    ?L?COM0081
B1:00BE39 80B4              SJMP     ?C0013?ZW_NVM_INIT
B1:00BE3B         ?C0012?ZW_NVM_INIT:
B1:00BE3B 903D6F            MOV      DPTR,#length+01H
B1:00BE3E E0                MOVX     A,@DPTR
B1:00BE3F 2405              ADD      A,#05H
B1:00BE41 F1B1              ACALL    ?L?COM061D
B1:00BE43         
B1:00BE43 903D6C            MOV      DPTR,#initsegPtr
B1:00BE46 8FF0              MOV      B,R7
B1:00BE48 122143            LCALL    ?C?IILDX
B1:00BE4B A137              AJMP     ?C0001?ZW_NVM_INIT
B1:00BE4D         ?C0017?ZW_NVM_INIT:
B1:00BE4D 22                RET      
----- FUNCTION _CinitNVMvariables (END) -------


----- FUNCTION ?L?COM00B9 (BEGIN) -----
B1:00BE4E 903D6C            MOV      DPTR,#initsegPtr
B1:00BE51         ?L?COM00BA:
B1:00BE51 E0                MOVX     A,@DPTR
B1:00BE52 FE                MOV      R6,A
B1:00BE53 A3                INC      DPTR
B1:00BE54 E0                MOVX     A,@DPTR
B1:00BE55 F582              MOV      DPL,A
B1:00BE57 8E83              MOV      DPH,R6
B1:00BE59 22                RET      
----- FUNCTION ?L?COM00B9 (END) -------


----- FUNCTION ?L?COM02B6 (BEGIN) -----
B1:00BE5A 7407              MOV      A,#07H
B1:00BE5C 93                MOVC     A,@A+DPTR
B1:00BE5D FF                MOV      R7,A
B1:00BE5E 12F0A2            LCALL    _FindCorrespondingOldNvmModuleDescriptor
B1:00BE61 9039B1            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00BE64 1225A9            LCALL    ?C?PSTXDATA
B1:00BE67         ?L?COM02B7:
B1:00BE67 9039B1            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00BE6A 122589            LCALL    ?C?PLDXDATA
B1:00BE6D E9                MOV      A,R1
B1:00BE6E 4A                ORL      A,R2
B1:00BE6F 22                RET      
----- FUNCTION ?L?COM02B6 (END) -------


----- FUNCTION ?L?COM01F2 (BEGIN) -----
B1:00BE70 7401              MOV      A,#01H
B1:00BE72 93                MOVC     A,@A+DPTR
B1:00BE73 FD                MOV      R5,A
B1:00BE74 7C00              MOV      R4,#00H
B1:00BE76 903D6F            MOV      DPTR,#length+01H
B1:00BE79 E0                MOVX     A,@DPTR
B1:00BE7A FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 327


B1:00BE7B E4                CLR      A
B1:00BE7C 2D                ADD      A,R5
B1:00BE7D FF                MOV      R7,A
B1:00BE7E EC                MOV      A,R4
B1:00BE7F 3E                ADDC     A,R6
B1:00BE80 FE                MOV      R6,A
B1:00BE81         ?L?COM01F3:
B1:00BE81 903D6E            MOV      DPTR,#length
B1:00BE84 F0                MOVX     @DPTR,A
B1:00BE85 A3                INC      DPTR
B1:00BE86 EF                MOV      A,R7
B1:00BE87 F0                MOVX     @DPTR,A
B1:00BE88 22                RET      
----- FUNCTION ?L?COM01F2 (END) -------


----- FUNCTION _RouteMatchesActive (BEGIN) -----
B1:00BE89 900ABB            MOV      DPTR,#repLen
B1:00BE8C 127088            LCALL    ?L?COM00F4
B1:00BE8F 128538            LCALL    ?L?COM0016
B1:00BE92 4A                ORL      A,R2
B1:00BE93 C3                CLR      C
B1:00BE94 6001              JZ       ?C0245?ZW_TRANSPORT
B1:00BE96 D3                SETB     C
B1:00BE97         ?C0245?ZW_TRANSPORT:
B1:00BE97         ?C0246?ZW_TRANSPORT:
B1:00BE97 5026              JNC      ?C0244?ZW_TRANSPORT
B1:00BE99 E9                MOV      A,R1
B1:00BE9A 24BC              ADD      A,#0BCH
B1:00BE9C 128622            LCALL    ?L?COM0006
B1:00BE9F C4                SWAP     A
B1:00BEA0 540F              ANL      A,#0FH
B1:00BEA2 FF                MOV      R7,A
B1:00BEA3 900ABB            MOV      DPTR,#repLen
B1:00BEA6 E0                MOVX     A,@DPTR
B1:00BEA7 B50715            CJNE     A,AR7,?C0244?ZW_TRANSPORT
B1:00BEAA 128538            LCALL    ?L?COM0016
B1:00BEAD 24BA              ADD      A,#0BAH
B1:00BEAF 128622            LCALL    ?L?COM0006
B1:00BEB2 FF                MOV      R7,A
B1:00BEB3 900ABC            MOV      DPTR,#fr
B1:00BEB6 129751            LCALL    ?L?COM0144
B1:00BEB9 128622            LCALL    ?L?COM0006
B1:00BEBC 6F                XRL      A,R7
B1:00BEBD 6002              JZ       ?C0243?ZW_TRANSPORT
B1:00BEBF         ?C0244?ZW_TRANSPORT:
B1:00BEBF C3                CLR      C
B1:00BEC0 22                RET      
B1:00BEC1         ?C0243?ZW_TRANSPORT:
B1:00BEC1 E4                CLR      A
B1:00BEC2 900ABF            MOV      DPTR,#i
B1:00BEC5 F0                MOVX     @DPTR,A
B1:00BEC6         ?C0248?ZW_TRANSPORT:
B1:00BEC6 900ABB            MOV      DPTR,#repLen
B1:00BEC9 E0                MOVX     A,@DPTR
B1:00BECA FF                MOV      R7,A
B1:00BECB 900ABF            MOV      DPTR,#i
B1:00BECE E0                MOVX     A,@DPTR
B1:00BECF FE                MOV      R6,A
B1:00BED0 C3                CLR      C
B1:00BED1 9F                SUBB     A,R7
B1:00BED2 5026              JNC      ?C0249?ZW_TRANSPORT
B1:00BED4 900ABC            MOV      DPTR,#fr
B1:00BED7 12DB83            LCALL    ?L?COM0261
B1:00BEDA EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 328


B1:00BEDB FF                MOV      R7,A
B1:00BEDC 12C59E            LCALL    ?L?COM01B2
B1:00BEDF FA                MOV      R2,A
B1:00BEE0 121FB3            LCALL    ?C?CLDPTR
B1:00BEE3 FD                MOV      R5,A
B1:00BEE4 128538            LCALL    ?L?COM0016
B1:00BEE7 128FE6            LCALL    ?L?COM004F
B1:00BEEA 121FB3            LCALL    ?C?CLDPTR
B1:00BEED 6D                XRL      A,R5
B1:00BEEE 6002              JZ       ?C0250?ZW_TRANSPORT
B1:00BEF0 C3                CLR      C
B1:00BEF1 22                RET      
B1:00BEF2         ?C0250?ZW_TRANSPORT:
B1:00BEF2 900ABF            MOV      DPTR,#i
B1:00BEF5 E0                MOVX     A,@DPTR
B1:00BEF6 04                INC      A
B1:00BEF7 F0                MOVX     @DPTR,A
B1:00BEF8 80CC              SJMP     ?C0248?ZW_TRANSPORT
B1:00BEFA         ?C0249?ZW_TRANSPORT:
B1:00BEFA D3                SETB     C
B1:00BEFB 22                RET      
----- FUNCTION _RouteMatchesActive (END) -------


----- FUNCTION ?L?COM0312 (BEGIN) -----
B1:00BEFC F9                MOV      R1,A
B1:00BEFD E4                CLR      A
B1:00BEFE 3A                ADDC     A,R2
B1:00BEFF FE                MOV      R6,A
B1:00BF00 AF01              MOV      R7,AR1
B1:00BF02 22                RET      
----- FUNCTION ?L?COM0312 (END) -------


----- FUNCTION _work_cswap (BEGIN) -----
B1:00BF03 90376B            MOV      DPTR,#work
B1:00BF06 12632A            LCALL    ?L?COM015E
B1:00BF09 A3                INC      DPTR
B1:00BF0A ED                MOV      A,R5
B1:00BF0B F0                MOVX     @DPTR,A
B1:00BF0C 7E37              MOV      R6,#HIGH t
B1:00BF0E 7F6F              MOV      R7,#LOW t
B1:00BF10 121DB8            LCALL    ?INTERBANK_TABLE?_fe25519_setzero
B1:00BF13 7E37              MOV      R6,#HIGH t
B1:00BF15 7F6F              MOV      R7,#LOW t
B1:00BF17 F161              ACALL    ?L?COM014E
B1:00BF19 2420              ADD      A,#020H
B1:00BF1B F155              ACALL    ?L?COM014D
B1:00BF1D 2420              ADD      A,#020H
B1:00BF1F D1FC              ACALL    ?L?COM0312
B1:00BF21 90376B            MOV      DPTR,#work
B1:00BF24 A3                INC      DPTR
B1:00BF25 A3                INC      DPTR
B1:00BF26 E0                MOVX     A,@DPTR
B1:00BF27 2460              ADD      A,#060H
B1:00BF29 F155              ACALL    ?L?COM014D
B1:00BF2B 2460              ADD      A,#060H
B1:00BF2D D1FC              ACALL    ?L?COM0312
B1:00BF2F F16A              ACALL    ?L?COM05D1
B1:00BF31 121DC2            LCALL    ?INTERBANK_TABLE?_fe25519_cmov
B1:00BF34 7E37              MOV      R6,#HIGH t
B1:00BF36 7F6F              MOV      R7,#LOW t
B1:00BF38 F161              ACALL    ?L?COM014E
B1:00BF3A 2440              ADD      A,#040H
B1:00BF3C F155              ACALL    ?L?COM014D
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 329


B1:00BF3E 2440              ADD      A,#040H
B1:00BF40 D1FC              ACALL    ?L?COM0312
B1:00BF42 90376B            MOV      DPTR,#work
B1:00BF45 A3                INC      DPTR
B1:00BF46 A3                INC      DPTR
B1:00BF47 E0                MOVX     A,@DPTR
B1:00BF48 2480              ADD      A,#080H
B1:00BF4A F155              ACALL    ?L?COM014D
B1:00BF4C 2480              ADD      A,#080H
B1:00BF4E D1FC              ACALL    ?L?COM0312
B1:00BF50 F16A              ACALL    ?L?COM05D1
B1:00BF52 021DC2            LJMP     ?INTERBANK_TABLE?_fe25519_cmov
----- FUNCTION _work_cswap (END) -------


----- FUNCTION ?L?COM014D (BEGIN) -----
B1:00BF55 F9                MOV      R1,A
B1:00BF56 E4                CLR      A
B1:00BF57 3A                ADDC     A,R2
B1:00BF58 FC                MOV      R4,A
B1:00BF59 AD01              MOV      R5,AR1
B1:00BF5B A3                INC      DPTR
B1:00BF5C E0                MOVX     A,@DPTR
B1:00BF5D FB                MOV      R3,A
B1:00BF5E 121DC2            LCALL    ?INTERBANK_TABLE?_fe25519_cmov
B1:00BF61         ?L?COM014E:
B1:00BF61 90376B            MOV      DPTR,#work
B1:00BF64 A3                INC      DPTR
B1:00BF65 E0                MOVX     A,@DPTR
B1:00BF66 FA                MOV      R2,A
B1:00BF67 A3                INC      DPTR
B1:00BF68 E0                MOVX     A,@DPTR
B1:00BF69 22                RET      
----- FUNCTION ?L?COM014D (END) -------


----- FUNCTION ?L?COM05D1 (BEGIN) -----
B1:00BF6A 7C37              MOV      R4,#HIGH t
B1:00BF6C 7D6F              MOV      R5,#LOW t
B1:00BF6E A3                INC      DPTR
B1:00BF6F E0                MOVX     A,@DPTR
B1:00BF70 FB                MOV      R3,A
B1:00BF71 22                RET      
----- FUNCTION ?L?COM05D1 (END) -------


----- FUNCTION ?L?COM0341 (BEGIN) -----
B1:00BF72 9039C0            MOV      DPTR,#dataLengthOld
B1:00BF75         ?L?COM0342:
B1:00BF75 E0                MOVX     A,@DPTR
B1:00BF76 FE                MOV      R6,A
B1:00BF77 A3                INC      DPTR
B1:00BF78 E0                MOVX     A,@DPTR
B1:00BF79 FF                MOV      R7,A
B1:00BF7A D3                SETB     C
B1:00BF7B 22                RET      
----- FUNCTION ?L?COM0341 (END) -------


----- FUNCTION ?L?COM01D5 (BEGIN) -----
B1:00BF7C 1225B2            LCALL    ?C?PLDCODE
B1:00BF7F 9039B4            MOV      DPTR,#nvmModuleNewPtr
B1:00BF82 1225A9            LCALL    ?C?PSTXDATA
B1:00BF85 8F82              MOV      DPL,R7
B1:00BF87 8E83              MOV      DPH,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 330


B1:00BF89         ?L?COM01D6:
B1:00BF89 7405              MOV      A,#05H
B1:00BF8B 93                MOVC     A,@A+DPTR
B1:00BF8C FF                MOV      R7,A
B1:00BF8D 7406              MOV      A,#06H
B1:00BF8F 93                MOVC     A,@A+DPTR
B1:00BF90 9039C2            MOV      DPTR,#dataLengthNew
B1:00BF93 CF                XCH      A,R7
B1:00BF94 F0                MOVX     @DPTR,A
B1:00BF95 A3                INC      DPTR
B1:00BF96 EF                MOV      A,R7
B1:00BF97 F0                MOVX     @DPTR,A
B1:00BF98 22                RET      
----- FUNCTION ?L?COM01D5 (END) -------


----- FUNCTION ?L?COM01E0 (BEGIN) -----
B1:00BF99 FF                MOV      R7,A
B1:00BF9A         ?L?COM01E1:
B1:00BF9A 122589            LCALL    ?C?PLDXDATA
B1:00BF9D E9                MOV      A,R1
B1:00BF9E 2405              ADD      A,#05H
B1:00BFA0 22                RET      
----- FUNCTION ?L?COM01E0 (END) -------


----- FUNCTION ?L?COM05C7 (BEGIN) -----
B1:00BFA1 8D82              MOV      DPL,R5
B1:00BFA3 8C83              MOV      DPH,R4
B1:00BFA5 7403              MOV      A,#03H
B1:00BFA7 93                MOVC     A,@A+DPTR
B1:00BFA8 22                RET      
----- FUNCTION ?L?COM05C7 (END) -------


----- FUNCTION ?L?COM05DC (BEGIN) -----
B1:00BFA9 9039C0            MOV      DPTR,#dataLengthOld
B1:00BFAC E0                MOVX     A,@DPTR
B1:00BFAD FE                MOV      R6,A
B1:00BFAE A3                INC      DPTR
B1:00BFAF E0                MOVX     A,@DPTR
B1:00BFB0 22                RET      
----- FUNCTION ?L?COM05DC (END) -------


----- FUNCTION ?L?COM061D (BEGIN) -----
B1:00BFB1 FF                MOV      R7,A
B1:00BFB2 903D6E            MOV      DPTR,#length
B1:00BFB5 E0                MOVX     A,@DPTR
B1:00BFB6 3400              ADDC     A,#00H
B1:00BFB8 22                RET      
----- FUNCTION ?L?COM061D (END) -------


----- FUNCTION ?L?COM05AF (BEGIN) -----
B1:00BFB9 9039C0            MOV      DPTR,#dataLengthOld
B1:00BFBC E4                CLR      A
B1:00BFBD F0                MOVX     @DPTR,A
B1:00BFBE A3                INC      DPTR
B1:00BFBF 7405              MOV      A,#05H
B1:00BFC1 22                RET      
----- FUNCTION ?L?COM05AF (END) -------


----- FUNCTION ?L?COM05B0 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 331


B1:00BFC2 9039BD            MOV      DPTR,#nvmModuleUpdatePtr
B1:00BFC5 E0                MOVX     A,@DPTR
B1:00BFC6 FC                MOV      R4,A
B1:00BFC7 A3                INC      DPTR
B1:00BFC8 E0                MOVX     A,@DPTR
B1:00BFC9 FD                MOV      R5,A
B1:00BFCA 22                RET      
----- FUNCTION ?L?COM05B0 (END) -------


----- FUNCTION ?L?COM04C8 (BEGIN) -----
B1:00BFCB 9039C3            MOV      DPTR,#dataLengthNew+01H
B1:00BFCE E0                MOVX     A,@DPTR
B1:00BFCF 9F                SUBB     A,R7
B1:00BFD0 9039C2            MOV      DPTR,#dataLengthNew
B1:00BFD3 E0                MOVX     A,@DPTR
B1:00BFD4 9E                SUBB     A,R6
B1:00BFD5 22                RET      
----- FUNCTION ?L?COM04C8 (END) -------


----- FUNCTION ?L?COM048A (BEGIN) -----
B1:00BFD6 9039C1            MOV      DPTR,#dataLengthOld+01H
B1:00BFD9 E0                MOVX     A,@DPTR
B1:00BFDA 29                ADD      A,R1
B1:00BFDB FF                MOV      R7,A
B1:00BFDC 9039C0            MOV      DPTR,#dataLengthOld
B1:00BFDF E0                MOVX     A,@DPTR
B1:00BFE0 3A                ADDC     A,R2
B1:00BFE1 22                RET      
----- FUNCTION ?L?COM048A (END) -------


----- FUNCTION ?L?COM0442 (BEGIN) -----
B1:00BFE2 9039C0            MOV      DPTR,#dataLengthOld
B1:00BFE5 E0                MOVX     A,@DPTR
B1:00BFE6 FC                MOV      R4,A
B1:00BFE7 A3                INC      DPTR
B1:00BFE8 E0                MOVX     A,@DPTR
B1:00BFE9 FD                MOV      R5,A
B1:00BFEA 29                ADD      A,R1
B1:00BFEB FF                MOV      R7,A
B1:00BFEC EC                MOV      A,R4
B1:00BFED 3A                ADDC     A,R2
B1:00BFEE 22                RET      
----- FUNCTION ?L?COM0442 (END) -------


----- FUNCTION ?L?COM0422 (BEGIN) -----
B1:00BFEF 75F0EB            MOV      B,#0EBH
B1:00BFF2 EF                MOV      A,R7
B1:00BFF3 12257D            LCALL    ?C?OFFXADD
B1:00BFF6 E0                MOVX     A,@DPTR
B1:00BFF7 22                RET      
----- FUNCTION ?L?COM0422 (END) -------


----- FUNCTION _TransmitTimerStart_NoSpeed (BEGIN) -----
;---- Variable 'timerTicks' assigned to Register 'R4/R5' ----
;---- Variable 'func' assigned to Register 'R6/R7' ----
B1:00BFF8 903998            MOV      DPTR,#bRetransmitTimer
B1:00BFFB 7401              MOV      A,#01H
B1:00BFFD F0                MOVX     @DPTR,A
B1:00BFFE C006              PUSH     AR6
B1:00C000 C007              PUSH     AR7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 332


B1:00C002 ED                MOV      A,R5
B1:00C003 AE04              MOV      R6,AR4
B1:00C005 7803              MOV      R0,#03H
B1:00C007         ?C0559?ZW_TRANSPORT:
B1:00C007 C3                CLR      C
B1:00C008 33                RLC      A
B1:00C009 CE                XCH      A,R6
B1:00C00A 33                RLC      A
B1:00C00B CE                XCH      A,R6
B1:00C00C D8F9              DJNZ     R0,?C0559?ZW_TRANSPORT
B1:00C00E FB                MOV      R3,A
B1:00C00F AA06              MOV      R2,AR6
B1:00C011 AE04              MOV      R6,AR4
B1:00C013 ED                MOV      A,R5
B1:00C014 7805              MOV      R0,#05H
B1:00C016         ?C0560?ZW_TRANSPORT:
B1:00C016 C3                CLR      C
B1:00C017 33                RLC      A
B1:00C018 CE                XCH      A,R6
B1:00C019 33                RLC      A
B1:00C01A CE                XCH      A,R6
B1:00C01B D8F9              DJNZ     R0,?C0560?ZW_TRANSPORT
B1:00C01D 2B                ADD      A,R3
B1:00C01E FD                MOV      R5,A
B1:00C01F EE                MOV      A,R6
B1:00C020 3A                ADDC     A,R2
B1:00C021 FC                MOV      R4,A
B1:00C022 D007              POP      AR7
B1:00C024 D006              POP      AR6
B1:00C026 021C23            LJMP     ?INTERBANK_TABLE?_TransportTimerStart
----- FUNCTION _TransmitTimerStart_NoSpeed (END) -------


----- FUNCTION DelayTimerStop (BEGIN) -----
B1:00C029 7B01              MOV      R3,#01H
B1:00C02B 7A08              MOV      R2,#HIGH delayHandle
B1:00C02D 7982              MOV      R1,#LOW delayHandle
B1:00C02F 02523C            LJMP     _SafeTimerStop
----- FUNCTION DelayTimerStop (END) -------


----- FUNCTION ReturnRouteResetPriority (BEGIN) -----
B1:00C032 E4                CLR      A
B1:00C033 900B08            MOV      DPTR,#bDestIndex
B1:00C036 F0                MOVX     @DPTR,A
B1:00C037 F0                MOVX     @DPTR,A
B1:00C038         ?C0014?ZW_TRANSPORT:
B1:00C038 900B08            MOV      DPTR,#bDestIndex
B1:00C03B E0                MOVX     A,@DPTR
B1:00C03C FF                MOV      R7,A
B1:00C03D C3                CLR      C
B1:00C03E 94E9              SUBB     A,#0E9H
B1:00C040 500A              JNC      ?C0017?ZW_TRANSPORT
B1:00C042 114D              ACALL    _ReturnRouteClearPriority
B1:00C044 900B08            MOV      DPTR,#bDestIndex
B1:00C047 E0                MOVX     A,@DPTR
B1:00C048 04                INC      A
B1:00C049 F0                MOVX     @DPTR,A
B1:00C04A 80EC              SJMP     ?C0014?ZW_TRANSPORT
B1:00C04C         ?C0017?ZW_TRANSPORT:
B1:00C04C 22                RET      
----- FUNCTION ReturnRouteResetPriority (END) -------


----- FUNCTION _ReturnRouteClearPriority (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 333


;---- Variable 'bDestIndex' assigned to Register 'R7' ----
B1:00C04D 7481              MOV      A,#LOW abReturnRoutePriority
B1:00C04F 2F                ADD      A,R7
B1:00C050 115A              ACALL    ?L?COM0222
B1:00C052 74E4              MOV      A,#0E4H
B1:00C054 F0                MOVX     @DPTR,A
B1:00C055 22                RET      
----- FUNCTION _ReturnRouteClearPriority (END) -------


----- FUNCTION ?L?COM0221 (BEGIN) -----
B1:00C056 7481              MOV      A,#LOW abReturnRoutePriority
B1:00C058 2565              ADD      A,destRouteIndex
B1:00C05A         ?L?COM0222:
B1:00C05A F582              MOV      DPL,A
B1:00C05C E4                CLR      A
B1:00C05D 3407              ADDC     A,#HIGH abReturnRoutePriority
B1:00C05F F583              MOV      DPH,A
B1:00C061 22                RET      
----- FUNCTION ?L?COM0221 (END) -------


----- FUNCTION ?L?COM05B9 (BEGIN) -----
B1:00C062 900881            MOV      DPTR,#bReturnRoutePriorityIndex
B1:00C065 E0                MOVX     A,@DPTR
B1:00C066 FF                MOV      R7,A
----- FUNCTION _ReturnRouteChangePriority (BEGIN) -----
;---- Variable 'bRouteIndex' assigned to Register 'R7' ----
B1:00C067 7403              MOV      A,#03H
B1:00C069 A807              MOV      R0,AR7
B1:00C06B 08                INC      R0
B1:00C06C 8002              SJMP     ?C0564?ZW_TRANSPORT
B1:00C06E         ?C0563?ZW_TRANSPORT:
B1:00C06E C3                CLR      C
B1:00C06F 33                RLC      A
B1:00C070         ?C0564?ZW_TRANSPORT:
B1:00C070 D8FC              DJNZ     R0,?C0563?ZW_TRANSPORT
B1:00C072 FE                MOV      R6,A
;---- Variable 'bMask' assigned to Register 'R6' ----
B1:00C073 1156              ACALL    ?L?COM0221
B1:00C075 E0                MOVX     A,@DPTR
B1:00C076 5E                ANL      A,R6
B1:00C077 FE                MOV      R6,A
B1:00C078 A807              MOV      R0,AR7
B1:00C07A 08                INC      R0
B1:00C07B 8002              SJMP     ?C0566?ZW_TRANSPORT
B1:00C07D         ?C0565?ZW_TRANSPORT:
B1:00C07D C3                CLR      C
B1:00C07E 13                RRC      A
B1:00C07F         ?C0566?ZW_TRANSPORT:
B1:00C07F D8FC              DJNZ     R0,?C0565?ZW_TRANSPORT
B1:00C081 900AE5            MOV      DPTR,#bOldPriority
B1:00C084 F0                MOVX     @DPTR,A
B1:00C085 E4                CLR      A
B1:00C086 A3                INC      DPTR
B1:00C087 F0                MOVX     @DPTR,A
B1:00C088 A3                INC      DPTR
B1:00C089 04                INC      A
B1:00C08A F0                MOVX     @DPTR,A
B1:00C08B 7E03              MOV      R6,#03H
B1:00C08D         ?C0026?ZW_TRANSPORT:
B1:00C08D 900AE6            MOV      DPTR,#bTemp2
B1:00C090 E0                MOVX     A,@DPTR
B1:00C091 FD                MOV      R5,A
B1:00C092 C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 334


B1:00C093 9404              SUBB     A,#04H
B1:00C095 5056              JNC      ?C0030?ZW_TRANSPORT
B1:00C097 1156              ACALL    ?L?COM0221
B1:00C099 E0                MOVX     A,@DPTR
B1:00C09A 5E                ANL      A,R6
B1:00C09B FC                MOV      R4,A
B1:00C09C A805              MOV      R0,AR5
B1:00C09E 08                INC      R0
B1:00C09F 8002              SJMP     ?C0568?ZW_TRANSPORT
B1:00C0A1         ?C0567?ZW_TRANSPORT:
B1:00C0A1 C3                CLR      C
B1:00C0A2 13                RRC      A
B1:00C0A3         ?C0568?ZW_TRANSPORT:
B1:00C0A3 D8FC              DJNZ     R0,?C0567?ZW_TRANSPORT
B1:00C0A5 FD                MOV      R5,A
;---- Variable 'bPriority' assigned to Register 'R5' ----
B1:00C0A6 C3                CLR      C
B1:00C0A7 9400              SUBB     A,#00H
B1:00C0A9 4013              JC       ?C0029?ZW_TRANSPORT
B1:00C0AB 900AE5            MOV      DPTR,#bOldPriority
B1:00C0AE E0                MOVX     A,@DPTR
B1:00C0AF FC                MOV      R4,A
B1:00C0B0 ED                MOV      A,R5
B1:00C0B1 9C                SUBB     A,R4
B1:00C0B2 500A              JNC      ?C0029?ZW_TRANSPORT
B1:00C0B4 900AE7            MOV      DPTR,#bInc
B1:00C0B7 E0                MOVX     A,@DPTR
B1:00C0B8 FD                MOV      R5,A
B1:00C0B9 1156              ACALL    ?L?COM0221
B1:00C0BB E0                MOVX     A,@DPTR
B1:00C0BC 2D                ADD      A,R5
B1:00C0BD F0                MOVX     @DPTR,A
B1:00C0BE         ?C0029?ZW_TRANSPORT:
B1:00C0BE 1156              ACALL    ?L?COM0221
B1:00C0C0 C083              PUSH     DPH
B1:00C0C2 C082              PUSH     DPL
B1:00C0C4 E0                MOVX     A,@DPTR
B1:00C0C5 FD                MOV      R5,A
B1:00C0C6 7403              MOV      A,#03H
B1:00C0C8 A807              MOV      R0,AR7
B1:00C0CA 08                INC      R0
B1:00C0CB 8002              SJMP     ?C0570?ZW_TRANSPORT
B1:00C0CD         ?C0569?ZW_TRANSPORT:
B1:00C0CD C3                CLR      C
B1:00C0CE 33                RLC      A
B1:00C0CF         ?C0570?ZW_TRANSPORT:
B1:00C0CF D8FC              DJNZ     R0,?C0569?ZW_TRANSPORT
B1:00C0D1 F4                CPL      A
B1:00C0D2 5D                ANL      A,R5
B1:00C0D3 D082              POP      DPL
B1:00C0D5 D083              POP      DPH
B1:00C0D7 F0                MOVX     @DPTR,A
B1:00C0D8 900AE6            MOV      DPTR,#bTemp2
B1:00C0DB E0                MOVX     A,@DPTR
B1:00C0DC 04                INC      A
B1:00C0DD F0                MOVX     @DPTR,A
B1:00C0DE EE                MOV      A,R6
B1:00C0DF 25E0              ADD      A,ACC
B1:00C0E1 25E0              ADD      A,ACC
B1:00C0E3 FE                MOV      R6,A
B1:00C0E4 A3                INC      DPTR
B1:00C0E5 E0                MOVX     A,@DPTR
B1:00C0E6 25E0              ADD      A,ACC
B1:00C0E8 25E0              ADD      A,ACC
B1:00C0EA F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 335


B1:00C0EB 80A0              SJMP     ?C0026?ZW_TRANSPORT
B1:00C0ED         ?C0030?ZW_TRANSPORT:
B1:00C0ED 22                RET      
----- FUNCTION _ReturnRouteChangePriority (END) -------


----- FUNCTION ?L?COM05B5 (BEGIN) -----
B1:00C0EE 902B38            MOV      DPTR,#tempi
B1:00C0F1 E0                MOVX     A,@DPTR
B1:00C0F2 FD                MOV      R5,A
----- FUNCTION _ZCB_ReturnRouteFindPriority (BEGIN) -----
B1:00C0F3 900AB1            MOV      DPTR,#bPriority
B1:00C0F6 127271            LCALL    ?L?COM0419
B1:00C0F9 A3                INC      DPTR
B1:00C0FA F0                MOVX     @DPTR,A
B1:00C0FB A3                INC      DPTR
B1:00C0FC 7403              MOV      A,#03H
B1:00C0FE F0                MOVX     @DPTR,A
B1:00C0FF 900AB2            MOV      DPTR,#bRouteIndex
B1:00C102 719D              ACALL    ?L?COM00C3
B1:00C104 123964            LCALL    _NVM_ext_read_byte
B1:00C107 EF                MOV      A,R7
B1:00C108 541C              ANL      A,#01CH
B1:00C10A 13                RRC      A
B1:00C10B 13                RRC      A
B1:00C10C 543F              ANL      A,#03FH
B1:00C10E 900AB4            MOV      DPTR,#bPriorityRoute
B1:00C111 F0                MOVX     @DPTR,A
B1:00C112 E0                MOVX     A,@DPTR
B1:00C113 FF                MOV      R7,A
B1:00C114 6014              JZ       ?C0022?ZW_TRANSPORT
B1:00C116 900AB1            MOV      DPTR,#bPriority
B1:00C119 E0                MOVX     A,@DPTR
B1:00C11A 700E              JNZ      ?C0022?ZW_TRANSPORT
B1:00C11C EF                MOV      A,R7
B1:00C11D 14                DEC      A
B1:00C11E FF                MOV      R7,A
B1:00C11F 1167              ACALL    _ReturnRouteChangePriority
B1:00C121 900AB4            MOV      DPTR,#bPriorityRoute
B1:00C124 E0                MOVX     A,@DPTR
B1:00C125 C3                CLR      C
B1:00C126 9401              SUBB     A,#01H
B1:00C128 FF                MOV      R7,A
B1:00C129 22                RET      
B1:00C12A         ?C0022?ZW_TRANSPORT:
B1:00C12A 900AB3            MOV      DPTR,#bIndex
B1:00C12D E0                MOVX     A,@DPTR
B1:00C12E FF                MOV      R7,A
B1:00C12F C3                CLR      C
B1:00C130 9404              SUBB     A,#04H
B1:00C132 5043              JNC      ?C0023?ZW_TRANSPORT
B1:00C134 900AB2            MOV      DPTR,#bRouteIndex
B1:00C137 E0                MOVX     A,@DPTR
B1:00C138 2481              ADD      A,#LOW abReturnRoutePriority
B1:00C13A 115A              ACALL    ?L?COM0222
B1:00C13C E0                MOVX     A,@DPTR
B1:00C13D FE                MOV      R6,A
B1:00C13E 900AB5            MOV      DPTR,#bMask
B1:00C141 E0                MOVX     A,@DPTR
B1:00C142 FD                MOV      R5,A
B1:00C143 EE                MOV      A,R6
B1:00C144 5D                ANL      A,R5
B1:00C145 FE                MOV      R6,A
B1:00C146 EF                MOV      A,R7
B1:00C147 25E0              ADD      A,ACC
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 336


B1:00C149 FF                MOV      R7,A
B1:00C14A EE                MOV      A,R6
B1:00C14B A807              MOV      R0,AR7
B1:00C14D 08                INC      R0
B1:00C14E 8002              SJMP     ?C0562?ZW_TRANSPORT
B1:00C150         ?C0561?ZW_TRANSPORT:
B1:00C150 C3                CLR      C
B1:00C151 13                RRC      A
B1:00C152         ?C0562?ZW_TRANSPORT:
B1:00C152 D8FC              DJNZ     R0,?C0561?ZW_TRANSPORT
B1:00C154 FF                MOV      R7,A
B1:00C155 900AB1            MOV      DPTR,#bPriority
B1:00C158 E0                MOVX     A,@DPTR
B1:00C159 B5070A            CJNE     A,AR7,?C0024?ZW_TRANSPORT
B1:00C15C 900AB3            MOV      DPTR,#bIndex
B1:00C15F E0                MOVX     A,@DPTR
B1:00C160 FF                MOV      R7,A
B1:00C161 900881            MOV      DPTR,#bReturnRoutePriorityIndex
B1:00C164 F0                MOVX     @DPTR,A
B1:00C165 22                RET      
B1:00C166         ?C0024?ZW_TRANSPORT:
B1:00C166 900AB3            MOV      DPTR,#bIndex
B1:00C169 E0                MOVX     A,@DPTR
B1:00C16A 04                INC      A
B1:00C16B F0                MOVX     @DPTR,A
B1:00C16C ED                MOV      A,R5
B1:00C16D 25E0              ADD      A,ACC
B1:00C16F 25E0              ADD      A,ACC
B1:00C171 900AB5            MOV      DPTR,#bMask
B1:00C174 F0                MOVX     @DPTR,A
B1:00C175 80B3              SJMP     ?C0022?ZW_TRANSPORT
B1:00C177         ?C0023?ZW_TRANSPORT:
B1:00C177 7F00              MOV      R7,#00H
B1:00C179 22                RET      
----- FUNCTION _ZCB_ReturnRouteFindPriority (END) -------


----- FUNCTION ?L?COM0505 (BEGIN) -----
B1:00C17A 12AC60            LCALL    _StoreRoute
----- FUNCTION _UpdateResponseRouteLastReturnRoute (BEGIN) -----
B1:00C17D 904213            MOV      DPTR,#bResponseRouteIndex
B1:00C180 EF                MOV      A,R7
B1:00C181 F0                MOVX     @DPTR,A
B1:00C182 C3                CLR      C
B1:00C183 9402              SUBB     A,#02H
B1:00C185 4002              JC       $ + 4H
B1:00C187 6187              AJMP     ?C0114?ZW_SLAVE
B1:00C189         ?C0113?ZW_SLAVE:
B1:00C189 904213            MOV      DPTR,#bResponseRouteIndex
B1:00C18C 12AF8F            LCALL    ?L?COM02B8
B1:00C18F E0                MOVX     A,@DPTR
B1:00C190 FF                MOV      R7,A
B1:00C191 904216            MOV      DPTR,#bDestNodeID
B1:00C194 F0                MOVX     @DPTR,A
B1:00C195 902BB4            MOV      DPTR,#sucNodeID
B1:00C198 E0                MOVX     A,@DPTR
B1:00C199 FE                MOV      R6,A
B1:00C19A EF                MOV      A,R7
B1:00C19B B50603            CJNE     A,AR6,?C0115?ZW_SLAVE
B1:00C19E E4                CLR      A
B1:00C19F 8004              SJMP     ?C0310?ZW_SLAVE
B1:00C1A1         ?C0115?ZW_SLAVE:
B1:00C1A1 904216            MOV      DPTR,#bDestNodeID
B1:00C1A4 E0                MOVX     A,@DPTR
B1:00C1A5         
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 337


B1:00C1A5 902B38            MOV      DPTR,#tempi
B1:00C1A8 F0                MOVX     @DPTR,A
B1:00C1A9         ?C0116?ZW_SLAVE:
B1:00C1A9 902B38            MOV      DPTR,#tempi
B1:00C1AC E0                MOVX     A,@DPTR
B1:00C1AD 75F011            MOV      B,#011H
B1:00C1B0 A4                MUL      AB
B1:00C1B1 240B              ADD      A,#LOW NVM_RETURN_ROUTE_START_far
B1:00C1B3 F9                MOV      R1,A
B1:00C1B4 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far
B1:00C1B6 35F0              ADDC     A,B
B1:00C1B8 904216            MOV      DPTR,#bDestNodeID
B1:00C1BB F198              ACALL    ?L?COM0586
B1:00C1BD 902B38            MOV      DPTR,#tempi
B1:00C1C0 719D              ACALL    ?L?COM00C3
B1:00C1C2 B185              ACALL    ?L?COM044F
B1:00C1C4 EF                MOV      A,R7
B1:00C1C5 F0                MOVX     @DPTR,A
B1:00C1C6 E0                MOVX     A,@DPTR
B1:00C1C7 5403              ANL      A,#03H
B1:00C1C9 FF                MOV      R7,A
B1:00C1CA 6033              JZ       ?C0117?ZW_SLAVE
B1:00C1CC 904213            MOV      DPTR,#bResponseRouteIndex
B1:00C1CF E0                MOVX     A,@DPTR
B1:00C1D0 FE                MOV      R6,A
B1:00C1D1 12AE2E            LCALL    ?L?COM013D
B1:00C1D4 E0                MOVX     A,@DPTR
B1:00C1D5 548F              ANL      A,#08FH
B1:00C1D7 F0                MOVX     @DPTR,A
B1:00C1D8 743B              MOV      A,#LOW responseRouteSpeedNumHops
B1:00C1DA 2E                ADD      A,R6
B1:00C1DB 12AE30            LCALL    ?L?COM013E
B1:00C1DE E0                MOVX     A,@DPTR
B1:00C1DF 4420              ORL      A,#020H
B1:00C1E1 F0                MOVX     @DPTR,A
B1:00C1E2 904213            MOV      DPTR,#bResponseRouteIndex
B1:00C1E5 E0                MOVX     A,@DPTR
B1:00C1E6 FE                MOV      R6,A
B1:00C1E7 12AEAF            LCALL    ?L?COM02AA
B1:00C1EA E0                MOVX     A,@DPTR
B1:00C1EB 549F              ANL      A,#09FH
B1:00C1ED F0                MOVX     @DPTR,A
B1:00C1EE 741C              MOV      A,#LOW responseRouteRFOption
B1:00C1F0 2E                ADD      A,R6
B1:00C1F1 12AEB1            LCALL    ?L?COM02AB
B1:00C1F4 E0                MOVX     A,@DPTR
B1:00C1F5 FE                MOV      R6,A
B1:00C1F6 EF                MOV      A,R7
B1:00C1F7 C4                SWAP     A
B1:00C1F8 33                RLC      A
B1:00C1F9 54E0              ANL      A,#0E0H
B1:00C1FB FF                MOV      R7,A
B1:00C1FC EE                MOV      A,R6
B1:00C1FD 4F                ORL      A,R7
B1:00C1FE F0                MOVX     @DPTR,A
B1:00C1FF         ?C0117?ZW_SLAVE:
B1:00C1FF E4                CLR      A
B1:00C200 904215            MOV      DPTR,#q
B1:00C203 F0                MOVX     @DPTR,A
B1:00C204         ?C0118?ZW_SLAVE:
B1:00C204 E4                CLR      A
B1:00C205 904214            MOV      DPTR,#t
B1:00C208 F0                MOVX     @DPTR,A
B1:00C209         ?C0121?ZW_SLAVE:
B1:00C209 902B38            MOV      DPTR,#tempi
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 338


B1:00C20C 7190              ACALL    ?L?COM00CC
B1:00C20E FA                MOV      R2,A
B1:00C20F 904215            MOV      DPTR,#q
B1:00C212 918D              ACALL    ?L?COM00F1
B1:00C214 F9                MOV      R1,A
B1:00C215 EA                MOV      A,R2
B1:00C216 35F0              ADDC     A,B
B1:00C218 FA                MOV      R2,A
B1:00C219 904214            MOV      DPTR,#t
B1:00C21C B19D              ACALL    ?L?COM01B1
B1:00C21E D17A              ACALL    ?L?COM02E1
B1:00C220 902BAB            MOV      DPTR,#temp
B1:00C223 EF                MOV      A,R7
B1:00C224 F0                MOVX     @DPTR,A
B1:00C225 904213            MOV      DPTR,#bResponseRouteIndex
B1:00C228 E0                MOVX     A,@DPTR
B1:00C229 FF                MOV      R7,A
B1:00C22A 12AE2E            LCALL    ?L?COM013D
B1:00C22D E0                MOVX     A,@DPTR
B1:00C22E 540F              ANL      A,#0FH
B1:00C230 FE                MOV      R6,A
B1:00C231 904214            MOV      DPTR,#t
B1:00C234 E0                MOVX     A,@DPTR
B1:00C235 FD                MOV      R5,A
B1:00C236 C3                CLR      C
B1:00C237 9E                SUBB     A,R6
B1:00C238 500D              JNC      ?C0124?ZW_SLAVE
B1:00C23A EF                MOV      A,R7
B1:00C23B 12AEBA            LCALL    ?L?COM0116
B1:00C23E 12AF9A            LCALL    ?L?COM01F4
B1:00C241 E0                MOVX     A,@DPTR
B1:00C242 FD                MOV      R5,A
B1:00C243 7C00              MOV      R4,#00H
B1:00C245 800F              SJMP     ?C0125?ZW_SLAVE
B1:00C247         ?C0124?ZW_SLAVE:
B1:00C247 904214            MOV      DPTR,#t
B1:00C24A E0                MOVX     A,@DPTR
B1:00C24B 7005              JNZ      ?C0126?ZW_SLAVE
B1:00C24D FC                MOV      R4,A
B1:00C24E 7DFE              MOV      R5,#0FEH
B1:00C250 8004              SJMP     ?C0127?ZW_SLAVE
B1:00C252         ?C0126?ZW_SLAVE:
B1:00C252 7C00              MOV      R4,#00H
B1:00C254 7D00              MOV      R5,#00H
B1:00C256         ?C0127?ZW_SLAVE:
B1:00C256         ?C0125?ZW_SLAVE:
B1:00C256 AF05              MOV      R7,AR5
;---- Variable 'bRepeat' assigned to Register 'R7' ----
B1:00C258 902BAB            MOV      DPTR,#temp
B1:00C25B E0                MOVX     A,@DPTR
B1:00C25C 6F                XRL      A,R7
B1:00C25D 6002              JZ       ?C0128?ZW_SLAVE
B1:00C25F 801E              SJMP     ?C0122?ZW_SLAVE
B1:00C261         ?C0128?ZW_SLAVE:
B1:00C261 EF                MOV      A,R7
B1:00C262 64FE              XRL      A,#0FEH
B1:00C264 7002              JNZ      $ + 4H
B1:00C266 6187              AJMP     ?C0114?ZW_SLAVE
B1:00C268 904214            MOV      DPTR,#t
B1:00C26B E0                MOVX     A,@DPTR
B1:00C26C FD                MOV      R5,A
B1:00C26D 6009              JZ       ?C0123?ZW_SLAVE
B1:00C26F EF                MOV      A,R7
B1:00C270 7006              JNZ      ?C0123?ZW_SLAVE
B1:00C272 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 339


B1:00C273 6D                XRL      A,R5
B1:00C274 7002              JNZ      $ + 4H
B1:00C276 6187              AJMP     ?C0114?ZW_SLAVE
B1:00C278         ?C0123?ZW_SLAVE:
B1:00C278 904214            MOV      DPTR,#t
B1:00C27B D16C              ACALL    ?L?COM0391
B1:00C27D 408A              JC       ?C0121?ZW_SLAVE
B1:00C27F         ?C0122?ZW_SLAVE:
B1:00C27F 904214            MOV      DPTR,#t
B1:00C282 E0                MOVX     A,@DPTR
B1:00C283 6404              XRL      A,#04H
B1:00C285 7002              JNZ      $ + 4H
B1:00C287 6187              AJMP     ?C0114?ZW_SLAVE
B1:00C289         ?C0132?ZW_SLAVE:
B1:00C289         ?C0120?ZW_SLAVE:
B1:00C289 904215            MOV      DPTR,#q
B1:00C28C D16C              ACALL    ?L?COM0391
B1:00C28E 5002              JNC      $ + 4H
B1:00C290 4104              AJMP     ?C0118?ZW_SLAVE
B1:00C292         ?C0119?ZW_SLAVE:
B1:00C292 902B38            MOV      DPTR,#tempi
B1:00C295 7190              ACALL    ?L?COM00CC
B1:00C297 AF01              MOV      R7,AR1
B1:00C299 902B36            MOV      DPTR,#tempwi
B1:00C29C F0                MOVX     @DPTR,A
B1:00C29D A3                INC      DPTR
B1:00C29E 12AE28            LCALL    ?L?COM013B
B1:00C2A1 E0                MOVX     A,@DPTR
B1:00C2A2 540F              ANL      A,#0FH
B1:00C2A4 902BAB            MOV      DPTR,#temp
B1:00C2A7 F0                MOVX     @DPTR,A
B1:00C2A8 E4                CLR      A
B1:00C2A9 904214            MOV      DPTR,#t
B1:00C2AC F0                MOVX     @DPTR,A
B1:00C2AD         ?C0133?ZW_SLAVE:
B1:00C2AD 904214            MOV      DPTR,#t
B1:00C2B0 E0                MOVX     A,@DPTR
B1:00C2B1 FF                MOV      R7,A
B1:00C2B2 C3                CLR      C
B1:00C2B3 9404              SUBB     A,#04H
B1:00C2B5 5014              JNC      ?C0134?ZW_SLAVE
B1:00C2B7 11EE              ACALL    ?L?COM05B5
B1:00C2B9 902B38            MOV      DPTR,#tempi
B1:00C2BC 7188              ACALL    ?L?COM00CB
B1:00C2BE D174              ACALL    ?L?COM02E0
B1:00C2C0 EF                MOV      A,R7
B1:00C2C1 6008              JZ       ?C0134?ZW_SLAVE
B1:00C2C3         ?C0136?ZW_SLAVE:
B1:00C2C3         ?C0135?ZW_SLAVE:
B1:00C2C3 904214            MOV      DPTR,#t
B1:00C2C6 E0                MOVX     A,@DPTR
B1:00C2C7 04                INC      A
B1:00C2C8 F0                MOVX     @DPTR,A
B1:00C2C9 80E2              SJMP     ?C0133?ZW_SLAVE
B1:00C2CB         ?C0134?ZW_SLAVE:
B1:00C2CB 904214            MOV      DPTR,#t
B1:00C2CE E0                MOVX     A,@DPTR
B1:00C2CF C3                CLR      C
B1:00C2D0 9404              SUBB     A,#04H
B1:00C2D2 4003              JC       ?C0137?ZW_SLAVE
B1:00C2D4 7403              MOV      A,#03H
B1:00C2D6 F0                MOVX     @DPTR,A
B1:00C2D7         ?C0137?ZW_SLAVE:
B1:00C2D7 904214            MOV      DPTR,#t
B1:00C2DA E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 340


B1:00C2DB FF                MOV      R7,A
B1:00C2DC 11EE              ACALL    ?L?COM05B5
B1:00C2DE 904214            MOV      DPTR,#t
B1:00C2E1 12AE28            LCALL    ?L?COM013B
B1:00C2E4 E0                MOVX     A,@DPTR
B1:00C2E5 540F              ANL      A,#0FH
B1:00C2E7 FF                MOV      R7,A
B1:00C2E8 902BAB            MOV      DPTR,#temp
B1:00C2EB F0                MOVX     @DPTR,A
B1:00C2EC E4                CLR      A
B1:00C2ED 904215            MOV      DPTR,#q
B1:00C2F0 F0                MOVX     @DPTR,A
B1:00C2F1 EF                MOV      A,R7
B1:00C2F2 700F              JNZ      ?C0139?ZW_SLAVE
B1:00C2F4 902B38            MOV      DPTR,#tempi
B1:00C2F7 7190              ACALL    ?L?COM00CC
B1:00C2F9 FA                MOV      R2,A
B1:00C2FA 904214            MOV      DPTR,#t
B1:00C2FD 918D              ACALL    ?L?COM00F1
B1:00C2FF F1B1              ACALL    ?L?COM0503
B1:00C301 802A              SJMP     ?C0311?ZW_SLAVE
B1:00C303         ?C0139?ZW_SLAVE:
B1:00C303 902BAB            MOV      DPTR,#temp
B1:00C306 E0                MOVX     A,@DPTR
B1:00C307 FF                MOV      R7,A
B1:00C308 904215            MOV      DPTR,#q
B1:00C30B E0                MOVX     A,@DPTR
B1:00C30C C3                CLR      C
B1:00C30D 9F                SUBB     A,R7
B1:00C30E 5028              JNC      ?C0140?ZW_SLAVE
B1:00C310 902B38            MOV      DPTR,#tempi
B1:00C313 7190              ACALL    ?L?COM00CC
B1:00C315 FA                MOV      R2,A
B1:00C316 904214            MOV      DPTR,#t
B1:00C319 918D              ACALL    ?L?COM00F1
B1:00C31B B197              ACALL    ?L?COM01B0
B1:00C31D FE                MOV      R6,A
B1:00C31E AF01              MOV      R7,AR1
B1:00C320 E0                MOVX     A,@DPTR
B1:00C321 FD                MOV      R5,A
B1:00C322 904213            MOV      DPTR,#bResponseRouteIndex
B1:00C325 12AEB9            LCALL    ?L?COM0115
B1:00C328 12AF9A            LCALL    ?L?COM01F4
B1:00C32B E0                MOVX     A,@DPTR
B1:00C32C FD                MOV      R5,A
B1:00C32D         
B1:00C32D 123FC4            LCALL    _NVM_ext_write_byte
B1:00C330 904215            MOV      DPTR,#q
B1:00C333 E0                MOVX     A,@DPTR
B1:00C334 04                INC      A
B1:00C335 F0                MOVX     @DPTR,A
B1:00C336 80CB              SJMP     ?C0139?ZW_SLAVE
B1:00C338         ?C0140?ZW_SLAVE:
B1:00C338 904215            MOV      DPTR,#q
B1:00C33B E0                MOVX     A,@DPTR
B1:00C33C C3                CLR      C
B1:00C33D 9404              SUBB     A,#04H
B1:00C33F 5010              JNC      ?C0142?ZW_SLAVE
B1:00C341 902B38            MOV      DPTR,#tempi
B1:00C344 7190              ACALL    ?L?COM00CC
B1:00C346 FA                MOV      R2,A
B1:00C347 904214            MOV      DPTR,#t
B1:00C34A 918D              ACALL    ?L?COM00F1
B1:00C34C B197              ACALL    ?L?COM01B0
B1:00C34E 123FBF            LCALL    ?L?COM030D
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 341


B1:00C351         ?C0142?ZW_SLAVE:
B1:00C351 902B38            MOV      DPTR,#tempi
B1:00C354 B17A              ACALL    ?L?COM0252
B1:00C356 71A7              ACALL    ?L?COM00C5
B1:00C358 B185              ACALL    ?L?COM044F
B1:00C35A 12AE28            LCALL    ?L?COM013B
B1:00C35D E0                MOVX     A,@DPTR
B1:00C35E 54F0              ANL      A,#0F0H
B1:00C360 C3                CLR      C
B1:00C361 9402              SUBB     A,#02H
B1:00C363 500C              JNC      ?C0143?ZW_SLAVE
B1:00C365 F124              ACALL    ?L?COM01EC
B1:00C367 8002              SJMP     ?C0299?ZW_SLAVE
B1:00C369         ?C0298?ZW_SLAVE:
B1:00C369 C3                CLR      C
B1:00C36A 33                RLC      A
B1:00C36B         ?C0299?ZW_SLAVE:
B1:00C36B D8FC              DJNZ     R0,?C0298?ZW_SLAVE
B1:00C36D F4                CPL      A
B1:00C36E 5F                ANL      A,R7
B1:00C36F 8009              SJMP     ?C0312?ZW_SLAVE
B1:00C371         ?C0143?ZW_SLAVE:
B1:00C371 F124              ACALL    ?L?COM01EC
B1:00C373 8002              SJMP     ?C0301?ZW_SLAVE
B1:00C375         ?C0300?ZW_SLAVE:
B1:00C375 C3                CLR      C
B1:00C376 33                RLC      A
B1:00C377         ?C0301?ZW_SLAVE:
B1:00C377 D8FC              DJNZ     R0,?C0300?ZW_SLAVE
B1:00C379 4F                ORL      A,R7
B1:00C37A         
B1:00C37A 902BAB            MOV      DPTR,#temp
B1:00C37D F0                MOVX     @DPTR,A
B1:00C37E         ?C0144?ZW_SLAVE:
B1:00C37E 902B38            MOV      DPTR,#tempi
B1:00C381 B17A              ACALL    ?L?COM0252
B1:00C383 71A7              ACALL    ?L?COM00C5
B1:00C385 D159              ACALL    ?L?COM058E
B1:00C387         ?C0114?ZW_SLAVE:
B1:00C387 22                RET      
----- FUNCTION _UpdateResponseRouteLastReturnRoute (END) -------


----- FUNCTION ?L?COM00CB (BEGIN) -----
B1:00C388 EF                MOV      A,R7
B1:00C389 75F004            MOV      B,#04H
B1:00C38C A4                MUL      AB
B1:00C38D FD                MOV      R5,A
B1:00C38E ACF0              MOV      R4,B
B1:00C390         ?L?COM00CC:
B1:00C390 E0                MOVX     A,@DPTR
B1:00C391         ?L?COM00CD:
B1:00C391 75F011            MOV      B,#011H
B1:00C394         ?L?COM00CE:
B1:00C394 A4                MUL      AB
B1:00C395 240C              ADD      A,#LOW NVM_RETURN_ROUTE_START_far+01H
B1:00C397 F9                MOV      R1,A
B1:00C398 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+01H
B1:00C39A 35F0              ADDC     A,B
B1:00C39C 22                RET      
----- FUNCTION ?L?COM00CB (END) -------


----- FUNCTION ?L?COM00C3 (BEGIN) -----
B1:00C39D E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 342


B1:00C39E         ?L?COM00C4:
B1:00C39E 75F002            MOV      B,#02H
B1:00C3A1 A4                MUL      AB
B1:00C3A2 2485              ADD      A,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00C3A4 F9                MOV      R1,A
B1:00C3A5 740F              MOV      A,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00C3A7         ?L?COM00C5:
B1:00C3A7 35F0              ADDC     A,B
B1:00C3A9 7B02              MOV      R3,#MBYTE NVM_RETURN_ROUTE_SPEED_START_far
B1:00C3AB FE                MOV      R6,A
B1:00C3AC AF01              MOV      R7,AR1
B1:00C3AE 22                RET      
----- FUNCTION ?L?COM00C3 (END) -------


----- FUNCTION _ReturnRouteFindNext (BEGIN) -----
B1:00C3AF 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C3B2 EF                MOV      A,R7
B1:00C3B3 F0                MOVX     @DPTR,A
B1:00C3B4         ?C0031?ZW_TRANSPORT:
B1:00C3B4 D161              ACALL    ?L?COM0633
B1:00C3B6 505C              JNC      ?C0032?ZW_TRANSPORT
B1:00C3B8 E565              MOV      A,destRouteIndex
B1:00C3BA 123956            LCALL    ?L?COM01D7
B1:00C3BD 8F5E              MOV      returnRoute,R7
B1:00C3BF EF                MOV      A,R7
B1:00C3C0 604A              JZ       ?C0033?ZW_TRANSPORT
B1:00C3C2 B18C              ACALL    ?L?COM04B9
B1:00C3C4 75F004            MOV      B,#04H
B1:00C3C7 A4                MUL      AB
B1:00C3C8 FD                MOV      R5,A
B1:00C3C9 ACF0              MOV      R4,B
B1:00C3CB E565              MOV      A,destRouteIndex
B1:00C3CD 7191              ACALL    ?L?COM00CD
B1:00C3CF FA                MOV      R2,A
B1:00C3D0 E9                MOV      A,R1
B1:00C3D1 2D                ADD      A,R5
B1:00C3D2 F9                MOV      R1,A
B1:00C3D3 EA                MOV      A,R2
B1:00C3D4 3C                ADDC     A,R4
B1:00C3D5 FE                MOV      R6,A
B1:00C3D6 AF01              MOV      R7,AR1
B1:00C3D8 F191              ACALL    ?L?COM0569
B1:00C3DA 127268            LCALL    ?L?COM0415
B1:00C3DD 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C3E0 E0                MOVX     A,@DPTR
B1:00C3E1 C4                SWAP     A
B1:00C3E2 54F0              ANL      A,#0F0H
B1:00C3E4 F55F              MOV      returnRoute+01H,A
B1:00C3E6 E560              MOV      A,returnRoute+02H
B1:00C3E8 64FE              XRL      A,#0FEH
B1:00C3EA 6028              JZ       ?C0032?ZW_TRANSPORT
;---- Variable 'index' assigned to Register 'R7' ----
B1:00C3EC E4                CLR      A
B1:00C3ED FF                MOV      R7,A
B1:00C3EE         ?C0035?ZW_TRANSPORT:
B1:00C3EE 7460              MOV      A,#LOW returnRoute+02H
B1:00C3F0 2F                ADD      A,R7
B1:00C3F1 F8                MOV      R0,A
B1:00C3F2 E6                MOV      A,@R0
B1:00C3F3 700E              JNZ      ?C0038?ZW_TRANSPORT
B1:00C3F5 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C3F8 E0                MOVX     A,@DPTR
B1:00C3F9 6019              JZ       ?C0032?ZW_TRANSPORT
B1:00C3FB EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 343


B1:00C3FC 7016              JNZ      ?C0032?ZW_TRANSPORT
B1:00C3FE 74FF              MOV      A,#0FFH
B1:00C400 F0                MOVX     @DPTR,A
B1:00C401 8011              SJMP     ?C0032?ZW_TRANSPORT
B1:00C403         ?C0038?ZW_TRANSPORT:
B1:00C403 055F              INC      returnRoute+01H
B1:00C405 0F                INC      R7
B1:00C406 EF                MOV      A,R7
B1:00C407 B404E4            CJNE     A,#04H,?C0035?ZW_TRANSPORT
B1:00C40A 8008              SJMP     ?C0032?ZW_TRANSPORT
B1:00C40C         ?C0033?ZW_TRANSPORT:
B1:00C40C 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C40F 7404              MOV      A,#04H
B1:00C411 F0                MOVX     @DPTR,A
B1:00C412 80A0              SJMP     ?C0031?ZW_TRANSPORT
B1:00C414         ?C0032?ZW_TRANSPORT:
B1:00C414 D161              ACALL    ?L?COM0633
B1:00C416 4005              JC       ?C0041?ZW_TRANSPORT
B1:00C418 74FF              MOV      A,#0FFH
B1:00C41A F0                MOVX     @DPTR,A
B1:00C41B 8050              SJMP     ?C0042?ZW_TRANSPORT
B1:00C41D         ?C0041?ZW_TRANSPORT:
B1:00C41D E565              MOV      A,destRouteIndex
B1:00C41F B17B              ACALL    ?L?COM0253
B1:00C421 71A7              ACALL    ?L?COM00C5
B1:00C423 123964            LCALL    _NVM_ext_read_byte
B1:00C426 900AFB            MOV      DPTR,#bSpeed
B1:00C429 EF                MOV      A,R7
B1:00C42A F0                MOVX     @DPTR,A
B1:00C42B B18C              ACALL    ?L?COM04B9
B1:00C42D 25E0              ADD      A,ACC
B1:00C42F FF                MOV      R7,A
B1:00C430 900AFB            MOV      DPTR,#bSpeed
B1:00C433 E0                MOVX     A,@DPTR
B1:00C434 FE                MOV      R6,A
B1:00C435 A807              MOV      R0,AR7
B1:00C437 08                INC      R0
B1:00C438 8002              SJMP     ?C0572?ZW_TRANSPORT
B1:00C43A         ?C0571?ZW_TRANSPORT:
B1:00C43A C3                CLR      C
B1:00C43B 13                RRC      A
B1:00C43C         ?C0572?ZW_TRANSPORT:
B1:00C43C D8FC              DJNZ     R0,?C0571?ZW_TRANSPORT
B1:00C43E 5403              ANL      A,#03H
B1:00C440 600C              JZ       ?C0045?ZW_TRANSPORT
B1:00C442 24FE              ADD      A,#0FEH
B1:00C444 600D              JZ       ?C0046?ZW_TRANSPORT
B1:00C446 14                DEC      A
B1:00C447 700F              JNZ      ?C0048?ZW_TRANSPORT
B1:00C449         ?C0044?ZW_TRANSPORT:
B1:00C449 756418            MOV      returnRoute+06H,#018H
B1:00C44C 800D              SJMP     ?C0043?ZW_TRANSPORT
B1:00C44E         ?C0045?ZW_TRANSPORT:
B1:00C44E 756420            MOV      returnRoute+06H,#020H
B1:00C451 8008              SJMP     ?C0043?ZW_TRANSPORT
B1:00C453         ?C0046?ZW_TRANSPORT:
B1:00C453 756410            MOV      returnRoute+06H,#010H
B1:00C456 8003              SJMP     ?C0043?ZW_TRANSPORT
B1:00C458         ?C0048?ZW_TRANSPORT:
B1:00C458 756408            MOV      returnRoute+06H,#08H
B1:00C45B         ?C0043?ZW_TRANSPORT:
B1:00C45B E565              MOV      A,destRouteIndex
B1:00C45D 719E              ACALL    ?L?COM00C4
B1:00C45F 123964            LCALL    _NVM_ext_read_byte
B1:00C462 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 344


B1:00C463 5403              ANL      A,#03H
;---- Variable 'bBeam' assigned to Register 'R7' ----
B1:00C465 6006              JZ       ?C0042?ZW_TRANSPORT
B1:00C467 25E0              ADD      A,ACC
B1:00C469 4410              ORL      A,#010H
B1:00C46B F564              MOV      returnRoute+06H,A
B1:00C46D         ?C0042?ZW_TRANSPORT:
B1:00C46D 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C470 E0                MOVX     A,@DPTR
B1:00C471 FF                MOV      R7,A
B1:00C472 22                RET      
----- FUNCTION _ReturnRouteFindNext (END) -------


----- FUNCTION ?L?COM00F0 (BEGIN) -----
B1:00C473 902B36            MOV      DPTR,#tempwi
B1:00C476 E0                MOVX     A,@DPTR
B1:00C477 FE                MOV      R6,A
B1:00C478 A3                INC      DPTR
B1:00C479 E0                MOVX     A,@DPTR
B1:00C47A FF                MOV      R7,A
B1:00C47B 7C00              MOV      R4,#00H
B1:00C47D 7D11              MOV      R5,#011H
B1:00C47F 1220A6            LCALL    ?C?IMUL
B1:00C482 741D              MOV      A,#LOW NVM_RETURN_ROUTE_START_far+012H
B1:00C484 2F                ADD      A,R7
B1:00C485 F9                MOV      R1,A
B1:00C486 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+012H
B1:00C488 3E                ADDC     A,R6
B1:00C489 FA                MOV      R2,A
B1:00C48A 903C8E            MOV      DPTR,#n
B1:00C48D         ?L?COM00F1:
B1:00C48D E0                MOVX     A,@DPTR
B1:00C48E 75F004            MOV      B,#04H
B1:00C491 A4                MUL      AB
B1:00C492 29                ADD      A,R1
B1:00C493 22                RET      
----- FUNCTION ?L?COM00F0 (END) -------


----- FUNCTION _StoreReturnRouteSpeed (BEGIN) -----
B1:00C494 904039            MOV      DPTR,#destIndex
B1:00C497 ED                MOV      A,R5
B1:00C498 F0                MOVX     @DPTR,A
B1:00C499 904036            MOV      DPTR,#returnRoute
B1:00C49C 1225A9            LCALL    ?C?PSTXDATA
B1:00C49F E4                CLR      A
B1:00C4A0 90403C            MOV      DPTR,#beamInfo
B1:00C4A3 F0                MOVX     @DPTR,A
B1:00C4A4 12861F            LCALL    ?L?COM0005
B1:00C4A7 7002              JNZ      $ + 4H
B1:00C4A9 A176              AJMP     ?C0147?ZW_SLAVE
B1:00C4AB         ?C0146?ZW_SLAVE:
B1:00C4AB B177              ACALL    ?L?COM0251
B1:00C4AD 71A7              ACALL    ?L?COM00C5
B1:00C4AF B185              ACALL    ?L?COM044F
B1:00C4B1 EF                MOV      A,R7
B1:00C4B2 F0                MOVX     @DPTR,A
B1:00C4B3 904036            MOV      DPTR,#returnRoute
B1:00C4B6 128FD5            LCALL    ?L?COM0057
B1:00C4B9 128622            LCALL    ?L?COM0006
B1:00C4BC FF                MOV      R7,A
B1:00C4BD C4                SWAP     A
B1:00C4BE 540F              ANL      A,#0FH
B1:00C4C0 902B38            MOV      DPTR,#tempi
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 345


B1:00C4C3 F0                MOVX     @DPTR,A
B1:00C4C4 EF                MOV      A,R7
B1:00C4C5 540F              ANL      A,#0FH
B1:00C4C7 FF                MOV      R7,A
B1:00C4C8 90403A            MOV      DPTR,#bPayloadSize
B1:00C4CB E0                MOVX     A,@DPTR
B1:00C4CC C3                CLR      C
B1:00C4CD 9F                SUBB     A,R7
B1:00C4CE C3                CLR      C
B1:00C4CF 9405              SUBB     A,#05H
B1:00C4D1 404B              JC       ?C0148?ZW_SLAVE
B1:00C4D3 7E00              MOV      R6,#00H
B1:00C4D5 904036            MOV      DPTR,#returnRoute
B1:00C4D8 12885F            LCALL    ?L?COM000F
B1:00C4DB 128FEC            LCALL    ?L?COM0052
B1:00C4DE 121FB3            LCALL    ?C?CLDPTR
B1:00C4E1 FF                MOV      R7,A
B1:00C4E2 904036            MOV      DPTR,#returnRoute
B1:00C4E5 1287DA            LCALL    ?L?COM002D
B1:00C4E8 90403B            MOV      DPTR,#n
B1:00C4EB F0                MOVX     @DPTR,A
B1:00C4EC 902B38            MOV      DPTR,#tempi
B1:00C4EF E0                MOVX     A,@DPTR
B1:00C4F0 7040              JNZ      ?C0150?ZW_SLAVE
B1:00C4F2 904039            MOV      DPTR,#destIndex
B1:00C4F5 719D              ACALL    ?L?COM00C3
B1:00C4F7 123964            LCALL    _NVM_ext_read_byte
B1:00C4FA 90403C            MOV      DPTR,#beamInfo
B1:00C4FD EF                MOV      A,R7
B1:00C4FE F0                MOVX     @DPTR,A
B1:00C4FF E0                MOVX     A,@DPTR
B1:00C500 54FC              ANL      A,#0FCH
B1:00C502 FF                MOV      R7,A
B1:00C503 F0                MOVX     @DPTR,A
B1:00C504 90403B            MOV      DPTR,#n
B1:00C507 E0                MOVX     A,@DPTR
B1:00C508 5406              ANL      A,#06H
B1:00C50A C3                CLR      C
B1:00C50B 13                RRC      A
B1:00C50C 4F                ORL      A,R7
B1:00C50D A3                INC      DPTR
B1:00C50E F0                MOVX     @DPTR,A
B1:00C50F 904039            MOV      DPTR,#destIndex
B1:00C512 719D              ACALL    ?L?COM00C3
B1:00C514 90403C            MOV      DPTR,#beamInfo
B1:00C517 E0                MOVX     A,@DPTR
B1:00C518 FD                MOV      R5,A
B1:00C519 123FC4            LCALL    _NVM_ext_write_byte
B1:00C51C 8014              SJMP     ?C0150?ZW_SLAVE
B1:00C51E         ?C0148?ZW_SLAVE:
B1:00C51E 902BAB            MOV      DPTR,#temp
B1:00C521 E0                MOVX     A,@DPTR
B1:00C522 54FC              ANL      A,#0FCH
B1:00C524 F0                MOVX     @DPTR,A
B1:00C525 4401              ORL      A,#01H
B1:00C527 F0                MOVX     @DPTR,A
B1:00C528 904036            MOV      DPTR,#returnRoute
B1:00C52B F1C7              ACALL    ?L?COM0186
B1:00C52D 7408              MOV      A,#08H
B1:00C52F 122072            LCALL    ?C?CSTPTR
B1:00C532         ?C0150?ZW_SLAVE:
B1:00C532 902BAB            MOV      DPTR,#temp
B1:00C535 E0                MOVX     A,@DPTR
B1:00C536 FF                MOV      R7,A
B1:00C537 902B38            MOV      DPTR,#tempi
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 346


B1:00C53A E0                MOVX     A,@DPTR
B1:00C53B 25E0              ADD      A,ACC
B1:00C53D FE                MOV      R6,A
B1:00C53E 7403              MOV      A,#03H
B1:00C540 A806              MOV      R0,AR6
B1:00C542 08                INC      R0
B1:00C543 8002              SJMP     ?C0303?ZW_SLAVE
B1:00C545         ?C0302?ZW_SLAVE:
B1:00C545 C3                CLR      C
B1:00C546 33                RLC      A
B1:00C547         ?C0303?ZW_SLAVE:
B1:00C547 D8FC              DJNZ     R0,?C0302?ZW_SLAVE
B1:00C549 F4                CPL      A
B1:00C54A 5F                ANL      A,R7
B1:00C54B FF                MOV      R7,A
B1:00C54C 902BAB            MOV      DPTR,#temp
B1:00C54F F0                MOVX     @DPTR,A
B1:00C550 904036            MOV      DPTR,#returnRoute
B1:00C553 122589            LCALL    ?C?PLDXDATA
B1:00C556 E9                MOV      A,R1
B1:00C557 2408              ADD      A,#08H
B1:00C559 128622            LCALL    ?L?COM0006
B1:00C55C 13                RRC      A
B1:00C55D 13                RRC      A
B1:00C55E 13                RRC      A
B1:00C55F 5403              ANL      A,#03H
B1:00C561 FD                MOV      R5,A
B1:00C562 A806              MOV      R0,AR6
B1:00C564 08                INC      R0
B1:00C565 8002              SJMP     ?C0305?ZW_SLAVE
B1:00C567         ?C0304?ZW_SLAVE:
B1:00C567 C3                CLR      C
B1:00C568 33                RLC      A
B1:00C569         ?C0305?ZW_SLAVE:
B1:00C569 D8FC              DJNZ     R0,?C0304?ZW_SLAVE
B1:00C56B 4F                ORL      A,R7
B1:00C56C 902BAB            MOV      DPTR,#temp
B1:00C56F F0                MOVX     @DPTR,A
B1:00C570 B177              ACALL    ?L?COM0251
B1:00C572 71A7              ACALL    ?L?COM00C5
B1:00C574 D159              ACALL    ?L?COM058E
B1:00C576         ?C0147?ZW_SLAVE:
B1:00C576 22                RET      
----- FUNCTION _StoreReturnRouteSpeed (END) -------


----- FUNCTION ?L?COM0251 (BEGIN) -----
B1:00C577 904039            MOV      DPTR,#destIndex
B1:00C57A         ?L?COM0252:
B1:00C57A E0                MOVX     A,@DPTR
B1:00C57B         ?L?COM0253:
B1:00C57B 75F002            MOV      B,#02H
B1:00C57E A4                MUL      AB
B1:00C57F 2484              ADD      A,#LOW NVM_RETURN_ROUTE_SPEED_START_far
B1:00C581 F9                MOV      R1,A
B1:00C582 740F              MOV      A,#HIGH NVM_RETURN_ROUTE_SPEED_START_far
B1:00C584 22                RET      
----- FUNCTION ?L?COM0251 (END) -------


----- FUNCTION ?L?COM044F (BEGIN) -----
B1:00C585 123964            LCALL    _NVM_ext_read_byte
B1:00C588 902BAB            MOV      DPTR,#temp
B1:00C58B 22                RET      
----- FUNCTION ?L?COM044F (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 347




----- FUNCTION ?L?COM04B9 (BEGIN) -----
B1:00C58C 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C58F E0                MOVX     A,@DPTR
B1:00C590 FF                MOV      R7,A
B1:00C591 AD65              MOV      R5,destRouteIndex
B1:00C593 11F3              ACALL    _ZCB_ReturnRouteFindPriority
B1:00C595 EF                MOV      A,R7
B1:00C596 22                RET      
----- FUNCTION ?L?COM04B9 (END) -------


----- FUNCTION ?L?COM01B0 (BEGIN) -----
B1:00C597 F9                MOV      R1,A
B1:00C598 EA                MOV      A,R2
B1:00C599 35F0              ADDC     A,B
B1:00C59B FA                MOV      R2,A
B1:00C59C A3                INC      DPTR
B1:00C59D         ?L?COM01B1:
B1:00C59D E0                MOVX     A,@DPTR
B1:00C59E         ?L?COM01B2:
B1:00C59E 7E00              MOV      R6,#00H
B1:00C5A0 29                ADD      A,R1
B1:00C5A1 F9                MOV      R1,A
B1:00C5A2 EE                MOV      A,R6
B1:00C5A3 3A                ADDC     A,R2
B1:00C5A4 22                RET      
----- FUNCTION ?L?COM01B0 (END) -------


----- FUNCTION _HandleSUCReturnRoute (BEGIN) -----
B1:00C5A5 90417F            MOV      DPTR,#cmdLength
B1:00C5A8 ED                MOV      A,R5
B1:00C5A9 F0                MOVX     @DPTR,A
B1:00C5AA 90417C            MOV      DPTR,#pCmd
B1:00C5AD 1225A9            LCALL    ?C?PSTXDATA
B1:00C5B0 E9                MOV      A,R1
B1:00C5B1 2403              ADD      A,#03H
B1:00C5B3 128622            LCALL    ?L?COM0006
B1:00C5B6 FF                MOV      R7,A
B1:00C5B7 C4                SWAP     A
B1:00C5B8 5407              ANL      A,#07H
B1:00C5BA FE                MOV      R6,A
B1:00C5BB 904180            MOV      DPTR,#n
B1:00C5BE F0                MOVX     @DPTR,A
B1:00C5BF EF                MOV      A,R7
B1:00C5C0 5407              ANL      A,#07H
B1:00C5C2 902BAB            MOV      DPTR,#temp
B1:00C5C5 F0                MOVX     @DPTR,A
B1:00C5C6 EE                MOV      A,R6
B1:00C5C7 7016              JNZ      ?C0158?ZW_SLAVE
B1:00C5C9 7FE8              MOV      R7,#0E8H
B1:00C5CB 114D              ACALL    _ReturnRouteClearPriority
B1:00C5CD 90417C            MOV      DPTR,#pCmd
B1:00C5D0 12861C            LCALL    ?L?COM0004
B1:00C5D3 902BB4            MOV      DPTR,#sucNodeID
B1:00C5D6 F0                MOVX     @DPTR,A
B1:00C5D7 FD                MOV      R5,A
B1:00C5D8 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far
B1:00C5DA 7F0B              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far
B1:00C5DC 123FC4            LCALL    _NVM_ext_write_byte
B1:00C5DF         ?C0158?ZW_SLAVE:
B1:00C5DF 904180            MOV      DPTR,#n
B1:00C5E2 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 348


B1:00C5E3 FF                MOV      R7,A
B1:00C5E4 C3                CLR      C
B1:00C5E5 9404              SUBB     A,#04H
B1:00C5E7 506F              JNC      ?C0166?ZW_SLAVE
B1:00C5E9 902BAB            MOV      DPTR,#temp
B1:00C5EC E0                MOVX     A,@DPTR
B1:00C5ED 6018              JZ       ?C0160?ZW_SLAVE
B1:00C5EF EF                MOV      A,R7
B1:00C5F0 75F004            MOV      B,#04H
B1:00C5F3 7194              ACALL    ?L?COM00CE
B1:00C5F5 FE                MOV      R6,A
B1:00C5F6 AF01              MOV      R7,AR1
B1:00C5F8 90417C            MOV      DPTR,#pCmd
B1:00C5FB 12885F            LCALL    ?L?COM000F
B1:00C5FE 902BAB            MOV      DPTR,#temp
B1:00C601 12F042            LCALL    ?L?COM0140
B1:00C604 126C78            LCALL    _NVM_ext_write_buffer
B1:00C607         ?C0160?ZW_SLAVE:
B1:00C607 902BAB            MOV      DPTR,#temp
B1:00C60A E0                MOVX     A,@DPTR
B1:00C60B 700E              JNZ      ?C0161?ZW_SLAVE
B1:00C60D 904180            MOV      DPTR,#n
B1:00C610 E0                MOVX     A,@DPTR
B1:00C611 7008              JNZ      ?C0161?ZW_SLAVE
B1:00C613 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far+01H
B1:00C615 7F0C              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far+01H
B1:00C617 7DFE              MOV      R5,#0FEH
B1:00C619 801D              SJMP     ?C0316?ZW_SLAVE
B1:00C61B         ?C0161?ZW_SLAVE:
B1:00C61B 902BAB            MOV      DPTR,#temp
B1:00C61E E0                MOVX     A,@DPTR
B1:00C61F C3                CLR      C
B1:00C620 9404              SUBB     A,#04H
B1:00C622 5017              JNC      ?C0162?ZW_SLAVE
B1:00C624 904180            MOV      DPTR,#n
B1:00C627 E0                MOVX     A,@DPTR
B1:00C628 75F004            MOV      B,#04H
B1:00C62B 7194              ACALL    ?L?COM00CE
B1:00C62D FA                MOV      R2,A
B1:00C62E 902BAB            MOV      DPTR,#temp
B1:00C631 B19D              ACALL    ?L?COM01B1
B1:00C633 FE                MOV      R6,A
B1:00C634 AF01              MOV      R7,AR1
B1:00C636 E4                CLR      A
B1:00C637 FD                MOV      R5,A
B1:00C638         
B1:00C638 123FC4            LCALL    _NVM_ext_write_byte
B1:00C63B         ?C0162?ZW_SLAVE:
B1:00C63B 902BB4            MOV      DPTR,#sucNodeID
B1:00C63E E0                MOVX     A,@DPTR
B1:00C63F 6012              JZ       ?C0165?ZW_SLAVE
B1:00C641 90417C            MOV      DPTR,#pCmd
B1:00C644 122589            LCALL    ?C?PLDXDATA
B1:00C647 90417F            MOV      DPTR,#cmdLength
B1:00C64A E0                MOVX     A,@DPTR
B1:00C64B 90403A            MOV      DPTR,#?_StoreReturnRouteSpeed?BYTE+04H
B1:00C64E F0                MOVX     @DPTR,A
B1:00C64F E4                CLR      A
B1:00C650 FD                MOV      R5,A
B1:00C651 9194              ACALL    _StoreReturnRouteSpeed
B1:00C653         ?C0165?ZW_SLAVE:
B1:00C653 7F03              MOV      R7,#03H
B1:00C655 12EB14            LCALL    _AssignTimerStart
B1:00C658         ?C0166?ZW_SLAVE:
B1:00C658 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 349


----- FUNCTION _HandleSUCReturnRoute (END) -------


----- FUNCTION ?L?COM058E (BEGIN) -----
B1:00C659 902BAB            MOV      DPTR,#temp
B1:00C65C E0                MOVX     A,@DPTR
B1:00C65D FD                MOV      R5,A
B1:00C65E 023FC4            LJMP     _NVM_ext_write_byte
----- FUNCTION ?L?COM058E (END) -------


----- FUNCTION ?L?COM0633 (BEGIN) -----
B1:00C661 900AFA            MOV      DPTR,#bStartRouteNo
B1:00C664 E0                MOVX     A,@DPTR
B1:00C665 C3                CLR      C
B1:00C666 9404              SUBB     A,#04H
B1:00C668 22                RET      
----- FUNCTION ?L?COM0633 (END) -------


----- FUNCTION ?L?COM0390 (BEGIN) -----
B1:00C669 902B38            MOV      DPTR,#tempi
B1:00C66C         ?L?COM0391:
B1:00C66C E0                MOVX     A,@DPTR
B1:00C66D 04                INC      A
B1:00C66E F0                MOVX     @DPTR,A
B1:00C66F E0                MOVX     A,@DPTR
B1:00C670 C3                CLR      C
B1:00C671 9404              SUBB     A,#04H
B1:00C673 22                RET      
----- FUNCTION ?L?COM0390 (END) -------


----- FUNCTION ?L?COM02E0 (BEGIN) -----
B1:00C674 FA                MOV      R2,A
B1:00C675 E9                MOV      A,R1
B1:00C676 2D                ADD      A,R5
B1:00C677 F9                MOV      R1,A
B1:00C678 EA                MOV      A,R2
B1:00C679 3C                ADDC     A,R4
B1:00C67A         ?L?COM02E1:
B1:00C67A FE                MOV      R6,A
B1:00C67B AF01              MOV      R7,AR1
B1:00C67D 023964            LJMP     _NVM_ext_read_byte
----- FUNCTION ?L?COM02E0 (END) -------


----- FUNCTION _ZW_IsNodeWithinDirectRange (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00C680 EF                MOV      A,R7
B1:00C681 7002              JNZ      ?C0276?ZW_SLAVE
B1:00C683 C3                CLR      C
B1:00C684 22                RET      
B1:00C685         ?C0276?ZW_SLAVE:
B1:00C685 EF                MOV      A,R7
B1:00C686 F114              ACALL    ?L?COM04E8
B1:00C688 FE                MOV      R6,A
B1:00C689 902B36            MOV      DPTR,#tempwi
B1:00C68C F0                MOVX     @DPTR,A
B1:00C68D A3                INC      DPTR
B1:00C68E EF                MOV      A,R7
B1:00C68F F0                MOVX     @DPTR,A
B1:00C690 7C00              MOV      R4,#00H
B1:00C692 D1FF              ACALL    ?L?COM0362
B1:00C694 3E                ADDC     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 350


B1:00C695 D17A              ACALL    ?L?COM02E1
B1:00C697 EF                MOV      A,R7
B1:00C698 601C              JZ       ?C0278?ZW_SLAVE
B1:00C69A E4                CLR      A
B1:00C69B 902B38            MOV      DPTR,#tempi
B1:00C69E F0                MOVX     @DPTR,A
B1:00C69F         ?C0279?ZW_SLAVE:
B1:00C69F F1BB              ACALL    ?L?COM0241
B1:00C6A1 D1FF              ACALL    ?L?COM0362
B1:00C6A3 3E                ADDC     A,R6
B1:00C6A4 FA                MOV      R2,A
B1:00C6A5 A3                INC      DPTR
B1:00C6A6 918D              ACALL    ?L?COM00F1
B1:00C6A8 F9                MOV      R1,A
B1:00C6A9 EA                MOV      A,R2
B1:00C6AA 12395F            LCALL    ?L?COM01D8
B1:00C6AD BFFE02            CJNE     R7,#0FEH,?C0281?ZW_SLAVE
B1:00C6B0 D3                SETB     C
B1:00C6B1 22                RET      
B1:00C6B2         ?C0281?ZW_SLAVE:
B1:00C6B2 D169              ACALL    ?L?COM0390
B1:00C6B4 40E9              JC       ?C0279?ZW_SLAVE
B1:00C6B6         ?C0278?ZW_SLAVE:
B1:00C6B6 C3                CLR      C
B1:00C6B7 22                RET      
----- FUNCTION _ZW_IsNodeWithinDirectRange (END) -------


----- FUNCTION _ReturnRouteFindFirst (BEGIN) -----
B1:00C6B8 900B09            MOV      DPTR,#bDestNode
B1:00C6BB EF                MOV      A,R7
B1:00C6BC F10B              ACALL    ?L?COM0477
B1:00C6BE 902BB4            MOV      DPTR,#sucNodeID
B1:00C6C1 EF                MOV      A,R7
B1:00C6C2 F0                MOVX     @DPTR,A
B1:00C6C3 7565FF            MOV      destRouteIndex,#0FFH
B1:00C6C6 900871            MOV      DPTR,#activeTransmit+01H
B1:00C6C9 74FF              MOV      A,#0FFH
B1:00C6CB F0                MOVX     @DPTR,A
B1:00C6CC 900B09            MOV      DPTR,#bDestNode
B1:00C6CF E0                MOVX     A,@DPTR
B1:00C6D0 B50705            CJNE     A,AR7,?C0051?ZW_TRANSPORT
B1:00C6D3 E4                CLR      A
B1:00C6D4 F565              MOV      destRouteIndex,A
B1:00C6D6 801A              SJMP     ?C0576?ZW_TRANSPORT
B1:00C6D8         ?C0051?ZW_TRANSPORT:
B1:00C6D8 900B09            MOV      DPTR,#bDestNode
B1:00C6DB E0                MOVX     A,@DPTR
B1:00C6DC FD                MOV      R5,A
B1:00C6DD E4                CLR      A
B1:00C6DE FF                MOV      R7,A
B1:00C6DF 11F3              ACALL    _ZCB_ReturnRouteFindPriority
B1:00C6E1 900B09            MOV      DPTR,#bDestNode
B1:00C6E4 7188              ACALL    ?L?COM00CB
B1:00C6E6 D174              ACALL    ?L?COM02E0
B1:00C6E8 EF                MOV      A,R7
B1:00C6E9 6009              JZ       ?C0052?ZW_TRANSPORT
B1:00C6EB 900B09            MOV      DPTR,#bDestNode
B1:00C6EE E0                MOVX     A,@DPTR
B1:00C6EF F565              MOV      destRouteIndex,A
B1:00C6F1 E4                CLR      A
B1:00C6F2         
B1:00C6F2 F11B              ACALL    ?L?COM0568
B1:00C6F4         ?C0052?ZW_TRANSPORT:
B1:00C6F4 E565              MOV      A,destRouteIndex
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 351


B1:00C6F6 C3                CLR      C
B1:00C6F7 94FF              SUBB     A,#0FFH
B1:00C6F9 5002              JNC      ?C0054?ZW_TRANSPORT
B1:00C6FB 8001              SJMP     ?C0055?ZW_TRANSPORT
B1:00C6FD         ?C0054?ZW_TRANSPORT:
B1:00C6FD C3                CLR      C
B1:00C6FE         ?C0055?ZW_TRANSPORT:
B1:00C6FE 22                RET      
----- FUNCTION _ReturnRouteFindFirst (END) -------


----- FUNCTION ?L?COM0362 (BEGIN) -----
B1:00C6FF 7D11              MOV      R5,#011H
B1:00C701 1220A6            LCALL    ?C?IMUL
B1:00C704 741D              MOV      A,#LOW NVM_RETURN_ROUTE_START_far+012H
B1:00C706 2F                ADD      A,R7
B1:00C707 F9                MOV      R1,A
B1:00C708 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+012H
B1:00C70A 22                RET      
----- FUNCTION ?L?COM0362 (END) -------


----- FUNCTION ?L?COM0477 (BEGIN) -----
B1:00C70B F0                MOVX     @DPTR,A
B1:00C70C         ?L?COM0478:
B1:00C70C 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far
B1:00C70E 7F0B              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far
B1:00C710 023964            LJMP     _NVM_ext_read_byte
----- FUNCTION ?L?COM0477 (END) -------


----- FUNCTION ?L?COM04E7 (BEGIN) -----
B1:00C713 E0                MOVX     A,@DPTR
B1:00C714         ?L?COM04E8:
B1:00C714 24FF              ADD      A,#0FFH
B1:00C716 FF                MOV      R7,A
B1:00C717 E4                CLR      A
B1:00C718 34FF              ADDC     A,#0FFH
B1:00C71A 22                RET      
----- FUNCTION ?L?COM04E7 (END) -------


----- FUNCTION ?L?COM0568 (BEGIN) -----
B1:00C71B FF                MOV      R7,A
B1:00C71C 71AF              ACALL    _ReturnRouteFindNext
B1:00C71E 900871            MOV      DPTR,#activeTransmit+01H
B1:00C721 EF                MOV      A,R7
B1:00C722 F0                MOVX     @DPTR,A
B1:00C723 22                RET      
----- FUNCTION ?L?COM0568 (END) -------


----- FUNCTION ?L?COM01EC (BEGIN) -----
B1:00C724 902BAB            MOV      DPTR,#temp
B1:00C727 E0                MOVX     A,@DPTR
B1:00C728 FF                MOV      R7,A
B1:00C729 904214            MOV      DPTR,#t
B1:00C72C         ?L?COM01ED:
B1:00C72C E0                MOVX     A,@DPTR
B1:00C72D         ?L?COM01EE:
B1:00C72D FE                MOV      R6,A
B1:00C72E 7401              MOV      A,#01H
B1:00C730 A806              MOV      R0,AR6
B1:00C732 08                INC      R0
B1:00C733 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 352


----- FUNCTION ?L?COM01EC (END) -------


----- FUNCTION SlaveInitDone (BEGIN) -----
B1:00C734 D200              SETB     slaveInitialized
B1:00C736 127142            LCALL    ?L?COM02C1
B1:00C739 7923              MOV      R1,#LOW homeID
B1:00C73B 121B6F            LCALL    ?INTERBANK_TABLE?_MemoryGetID
B1:00C73E F1D2              ACALL    ResetSUC
B1:00C740 F10C              ACALL    ?L?COM0478
B1:00C742 902BB4            MOV      DPTR,#sucNodeID
B1:00C745 EF                MOV      A,R7
B1:00C746 F0                MOVX     @DPTR,A
B1:;----                  JMP      ReloadRouteDestinations
----- FUNCTION SlaveInitDone (END) -------


----- FUNCTION ReloadRouteDestinations (BEGIN) -----
B1:00C747 7E11              MOV      R6,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C749 7F56              MOV      R7,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C74B 7A2B              MOV      R2,#HIGH ZW_RouteDestinations
B1:00C74D 794B              MOV      R1,#LOW ZW_RouteDestinations
B1:00C74F 7405              MOV      A,#05H
B1:00C751 F188              ACALL    ?L?COM02F7
B1:00C753 E4                CLR      A
B1:00C754 902B38            MOV      DPTR,#tempi
B1:00C757 F0                MOVX     @DPTR,A
B1:00C758         ?C0108?ZW_SLAVE:
B1:00C758 F1A8              ACALL    ?L?COM05B4
B1:00C75A 5020              JNC      ?C0112?ZW_SLAVE
B1:00C75C F17D              ACALL    ?L?COM027C
B1:00C75E E0                MOVX     A,@DPTR
B1:00C75F D3                SETB     C
B1:00C760 94E8              SUBB     A,#0E8H
B1:00C762 4010              JC       ?C0110?ZW_SLAVE
B1:00C764 902B38            MOV      DPTR,#tempi
B1:00C767 E0                MOVX     A,@DPTR
B1:00C768 244B              ADD      A,#LOW ZW_RouteDestinations
B1:00C76A F180              ACALL    ?L?COM027D
B1:00C76C E4                CLR      A
B1:00C76D F0                MOVX     @DPTR,A
B1:00C76E FE                MOV      R6,A
B1:00C76F F1A0              ACALL    ?L?COM0625
B1:00C771 123FBF            LCALL    ?L?COM030D
B1:00C774         ?C0110?ZW_SLAVE:
B1:00C774 902B38            MOV      DPTR,#tempi
B1:00C777 E0                MOVX     A,@DPTR
B1:00C778 04                INC      A
B1:00C779 F0                MOVX     @DPTR,A
B1:00C77A 80DC              SJMP     ?C0108?ZW_SLAVE
B1:00C77C         ?C0112?ZW_SLAVE:
B1:00C77C 22                RET      
----- FUNCTION ReloadRouteDestinations (END) -------


----- FUNCTION ?L?COM027C (BEGIN) -----
B1:00C77D 744B              MOV      A,#LOW ZW_RouteDestinations
B1:00C77F 2F                ADD      A,R7
B1:00C780         ?L?COM027D:
B1:00C780 F582              MOV      DPL,A
B1:00C782 E4                CLR      A
B1:00C783 342B              ADDC     A,#HIGH ZW_RouteDestinations
B1:00C785 F583              MOV      DPH,A
B1:00C787 22                RET      
----- FUNCTION ?L?COM027C (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 353




----- FUNCTION ?L?COM02F7 (BEGIN) -----
B1:00C788 7B01              MOV      R3,#01H
B1:00C78A 9040B9            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B1:00C78D F0                MOVX     @DPTR,A
B1:00C78E 023F61            LJMP     _NVM_ext_read_buffer
----- FUNCTION ?L?COM02F7 (END) -------


----- FUNCTION ?L?COM0569 (BEGIN) -----
B1:00C791 7B00              MOV      R3,#00H
B1:00C793 7A00              MOV      R2,#HIGH returnRoute+02H
B1:00C795 7960              MOV      R1,#LOW returnRoute+02H
B1:00C797 22                RET      
----- FUNCTION ?L?COM0569 (END) -------


----- FUNCTION ?L?COM0586 (BEGIN) -----
B1:00C798 FE                MOV      R6,A
B1:00C799 AF01              MOV      R7,AR1
B1:00C79B E0                MOVX     A,@DPTR
B1:00C79C FD                MOV      R5,A
B1:00C79D 023FC4            LJMP     _NVM_ext_write_byte
----- FUNCTION ?L?COM0586 (END) -------


----- FUNCTION ?L?COM0625 (BEGIN) -----
B1:00C7A0 7456              MOV      A,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C7A2 2F                ADD      A,R7
B1:00C7A3 F9                MOV      R1,A
B1:00C7A4 EE                MOV      A,R6
B1:00C7A5 3411              ADDC     A,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C7A7 22                RET      
----- FUNCTION ?L?COM0625 (END) -------


----- FUNCTION ?L?COM05B4 (BEGIN) -----
B1:00C7A8 902B38            MOV      DPTR,#tempi
B1:00C7AB E0                MOVX     A,@DPTR
B1:00C7AC FF                MOV      R7,A
B1:00C7AD C3                CLR      C
B1:00C7AE 9405              SUBB     A,#05H
B1:00C7B0 22                RET      
----- FUNCTION ?L?COM05B4 (END) -------


----- FUNCTION ?L?COM0503 (BEGIN) -----
B1:00C7B1 F9                MOV      R1,A
B1:00C7B2 EA                MOV      A,R2
B1:00C7B3 35F0              ADDC     A,B
B1:00C7B5 FE                MOV      R6,A
B1:00C7B6 AF01              MOV      R7,AR1
B1:00C7B8 7DFE              MOV      R5,#0FEH
B1:00C7BA 22                RET      
----- FUNCTION ?L?COM0503 (END) -------


----- FUNCTION ?L?COM0241 (BEGIN) -----
B1:00C7BB 902B36            MOV      DPTR,#tempwi
B1:00C7BE         ?L?COM0242:
B1:00C7BE E0                MOVX     A,@DPTR
B1:00C7BF FE                MOV      R6,A
B1:00C7C0 A3                INC      DPTR
B1:00C7C1 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 354


B1:00C7C2 FF                MOV      R7,A
B1:00C7C3 7C00              MOV      R4,#00H
B1:00C7C5 22                RET      
----- FUNCTION ?L?COM0241 (END) -------


----- FUNCTION ?L?COM0185 (BEGIN) -----
B1:00C7C6 FF                MOV      R7,A
B1:00C7C7         ?L?COM0186:
B1:00C7C7 122589            LCALL    ?C?PLDXDATA
B1:00C7CA         ?L?COM0187:
B1:00C7CA E9                MOV      A,R1
B1:00C7CB         ?L?COM0188:
B1:00C7CB 2408              ADD      A,#08H
B1:00C7CD F9                MOV      R1,A
B1:00C7CE E4                CLR      A
B1:00C7CF 3A                ADDC     A,R2
B1:00C7D0 FA                MOV      R2,A
B1:00C7D1 22                RET      
----- FUNCTION ?L?COM0185 (END) -------


----- FUNCTION ResetSUC (BEGIN) -----
B1:00C7D2 12979C            LCALL    ?L?COM0564
B1:00C7D5 902BA6            MOV      DPTR,#SUC_Update
B1:00C7D8 7401              MOV      A,#01H
B1:00C7DA F0                MOVX     @DPTR,A
B1:00C7DB E4                CLR      A
B1:00C7DC 902BA8            MOV      DPTR,#SUC_Update+02H
B1:00C7DF F0                MOVX     @DPTR,A
B1:00C7E0 22                RET      
----- FUNCTION ResetSUC (END) -------


----- FUNCTION _TransportEnQueueExploreFrame (BEGIN) -----
B1:00C7E1 900A1C            MOV      DPTR,#pData
B1:00C7E4 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'destNodeID' assigned to Register 'R5' ----
;---- Variable 'srcNodeID' assigned to Register 'R7' ----
B1:00C7E7 900A23            MOV      DPTR,#frameType
B1:00C7EA 7406              MOV      A,#06H
B1:00C7EC F0                MOVX     @DPTR,A
B1:00C7ED 900A1F            MOV      DPTR,#dataLength
B1:00C7F0 E0                MOVX     A,@DPTR
B1:00C7F1 FE                MOV      R6,A
B1:00C7F2 7411              MOV      A,#011H
B1:00C7F4 D3                SETB     C
B1:00C7F5 9E                SUBB     A,R6
B1:00C7F6 4003              JC       $ + 5H
B1:00C7F8 02C8C9            LJMP     ?C0136?ZW_TRANSPORT
B1:00C7FB 7440              MOV      A,#040H
B1:00C7FD 9E                SUBB     A,R6
B1:00C7FE 5003              JNC      $ + 5H
B1:00C800 02C8C9            LJMP     ?C0136?ZW_TRANSPORT
B1:00C803 7F02              MOV      R7,#02H
B1:00C805 128350            LCALL    _TxQueueGetElement
B1:00C808 900A24            MOV      DPTR,#pFreeTxElement
B1:00C80B 12976A            LCALL    ?L?COM02DF
B1:00C80E 7002              JNZ      $ + 4H
B1:00C810 01C9              AJMP     ?C0136?ZW_TRANSPORT
B1:00C812 900A23            MOV      DPTR,#frameType
B1:00C815 E0                MOVX     A,@DPTR
B1:00C816 300808            JNB      currentSeqNoUseTX,?C0138?ZW_TRANSPORT
B1:00C819 FE                MOV      R6,A
B1:00C81A 11E2              ACALL    ?L?COM04B8
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 355


B1:00C81C EE                MOV      A,R6
B1:00C81D 4F                ORL      A,R7
B1:00C81E F0                MOVX     @DPTR,A
B1:00C81F 8015              SJMP     ?C0139?ZW_TRANSPORT
B1:00C821         ?C0138?ZW_TRANSPORT:
B1:00C821 FF                MOV      R7,A
B1:00C822 900A1C            MOV      DPTR,#pData
B1:00C825 11DB              ACALL    ?L?COM01C2
B1:00C827 128622            LCALL    ?L?COM0006
B1:00C82A 540F              ANL      A,#0FH
B1:00C82C C4                SWAP     A
B1:00C82D 54F0              ANL      A,#0F0H
B1:00C82F FE                MOV      R6,A
B1:00C830 EF                MOV      A,R7
B1:00C831 4E                ORL      A,R6
B1:00C832 900A23            MOV      DPTR,#frameType
B1:00C835 F0                MOVX     @DPTR,A
B1:00C836         ?C0139?ZW_TRANSPORT:
B1:00C836 900A20            MOV      DPTR,#exploreTxOptions
B1:00C839 E0                MOVX     A,@DPTR
B1:00C83A 11CE              ACALL    ?L?COM04CC
B1:00C83C E9                MOV      A,R1
B1:00C83D 2402              ADD      A,#02H
B1:00C83F 1287E0            LCALL    ?L?COM002E
B1:00C842 900A24            MOV      DPTR,#pFreeTxElement
B1:00C845 12885F            LCALL    ?L?COM000F
B1:00C848 E4                CLR      A
B1:00C849 75F002            MOV      B,#02H
B1:00C84C 12221F            LCALL    ?C?ISTPTR
B1:00C84F 900A24            MOV      DPTR,#pFreeTxElement
B1:00C852 128FC6            LCALL    ?L?COM0191
B1:00C855 C003              PUSH     AR3
B1:00C857 C002              PUSH     AR2
B1:00C859 C001              PUSH     AR1
B1:00C85B 900A1C            MOV      DPTR,#pData
B1:00C85E 122589            LCALL    ?C?PLDXDATA
B1:00C861 126149            LCALL    ?L?COM0047
B1:00C864 D001              POP      AR1
B1:00C866 D002              POP      AR2
B1:00C868 D003              POP      AR3
B1:00C86A 7F11              MOV      R7,#011H
B1:00C86C 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C86F 900A1F            MOV      DPTR,#dataLength
B1:00C872 E0                MOVX     A,@DPTR
B1:00C873 24EF              ADD      A,#0EFH
B1:00C875 11CE              ACALL    ?L?COM04CC
B1:00C877 E9                MOV      A,R1
B1:00C878 24B1              ADD      A,#0B1H
B1:00C87A 1287E0            LCALL    ?L?COM002E
B1:00C87D 900A24            MOV      DPTR,#pFreeTxElement
B1:00C880 12C7C7            LCALL    ?L?COM0186
B1:00C883 C003              PUSH     AR3
B1:00C885 C002              PUSH     AR2
B1:00C887 C001              PUSH     AR1
B1:00C889 900A1C            MOV      DPTR,#pData
B1:00C88C 122589            LCALL    ?C?PLDXDATA
B1:00C88F E9                MOV      A,R1
B1:00C890 2411              ADD      A,#011H
B1:00C892 126145            LCALL    ?L?COM0045
B1:00C895 D001              POP      AR1
B1:00C897 D002              POP      AR2
B1:00C899 D003              POP      AR3
B1:00C89B 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C89E 900A24            MOV      DPTR,#pFreeTxElement
B1:00C8A1 7178              ACALL    ?L?COM0218
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 356


B1:00C8A3 12221F            LCALL    ?C?ISTPTR
B1:00C8A6 900A21            MOV      DPTR,#completedFunc
B1:00C8A9 E0                MOVX     A,@DPTR
B1:00C8AA FE                MOV      R6,A
B1:00C8AB A3                INC      DPTR
B1:00C8AC E0                MOVX     A,@DPTR
B1:00C8AD 900A24            MOV      DPTR,#pFreeTxElement
B1:00C8B0 12A5AB            LCALL    ?L?COM00F8
B1:00C8B3 D208              SETB     currentSeqNoUseTX
B1:00C8B5 900A23            MOV      DPTR,#frameType
B1:00C8B8 E0                MOVX     A,@DPTR
B1:00C8B9 FF                MOV      R7,A
B1:00C8BA A3                INC      DPTR
B1:00C8BB 122589            LCALL    ?C?PLDXDATA
B1:00C8BE 128871            LCALL    _BuildTxHeader
B1:00C8C1 11CF              ACALL    ?L?COM04CD
B1:00C8C3 128E33            LCALL    _TxQueueQueueElement
B1:00C8C6 7F01              MOV      R7,#01H
B1:00C8C8 22                RET      
B1:00C8C9         ?C0136?ZW_TRANSPORT:
B1:00C8C9 D208              SETB     currentSeqNoUseTX
B1:00C8CB 7F00              MOV      R7,#00H
B1:00C8CD 22                RET      
----- FUNCTION _TransportEnQueueExploreFrame (END) -------


----- FUNCTION ?L?COM04CC (BEGIN) -----
B1:00C8CE FF                MOV      R7,A
B1:00C8CF         ?L?COM04CD:
B1:00C8CF 900A24            MOV      DPTR,#pFreeTxElement
B1:00C8D2 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04CC (END) -------


----- FUNCTION ?L?COM01C0 (BEGIN) -----
B1:00C8D5 C3                CLR      C
B1:00C8D6 9F                SUBB     A,R7
B1:00C8D7         ?L?COM01C1:
B1:00C8D7 FF                MOV      R7,A
B1:00C8D8 900A27            MOV      DPTR,#pRxFrame
B1:00C8DB         ?L?COM01C2:
B1:00C8DB 122589            LCALL    ?C?PLDXDATA
B1:00C8DE E9                MOV      A,R1
B1:00C8DF 2406              ADD      A,#06H
B1:00C8E1 22                RET      
----- FUNCTION ?L?COM01C0 (END) -------


----- FUNCTION ?L?COM04B8 (BEGIN) -----
B1:00C8E2 D21D              SETB     ?IncSeqNo?BIT
B1:00C8E4 D21E              SETB     ?IncSeqNo?BIT+01H
----- FUNCTION IncSeqNo (BEGIN) -----
B1:00C8E6 201D2A            JB       baud40k,?C0104?ZW_TRANSPORT
B1:00C8E9 301E13            JNB      routed,?C0105?ZW_TRANSPORT
B1:00C8EC E567              MOV      A,current9600SeqNosTX
B1:00C8EE 54F0              ANL      A,#0F0H
B1:00C8F0 FF                MOV      R7,A
B1:00C8F1 BFF003            CJNE     R7,#0F0H,?C0106?ZW_TRANSPORT
B1:00C8F4 53670F            ANL      current9600SeqNosTX,#0FH
B1:00C8F7         ?C0106?ZW_TRANSPORT:
B1:00C8F7 7410              MOV      A,#010H
B1:00C8F9 2567              ADD      A,current9600SeqNosTX
B1:00C8FB F567              MOV      current9600SeqNosTX,A
B1:00C8FD 803C              SJMP     ?C0587?ZW_TRANSPORT
B1:00C8FF         ?C0105?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 357


B1:00C8FF E567              MOV      A,current9600SeqNosTX
B1:00C901 540F              ANL      A,#0FH
B1:00C903 FF                MOV      R7,A
B1:00C904 BF0F03            CJNE     R7,#0FH,?C0109?ZW_TRANSPORT
B1:00C907 5367F0            ANL      current9600SeqNosTX,#0F0H
B1:00C90A         ?C0109?ZW_TRANSPORT:
B1:00C90A 0567              INC      current9600SeqNosTX
B1:00C90C E567              MOV      A,current9600SeqNosTX
B1:00C90E 540F              ANL      A,#0FH
B1:00C910 C4                SWAP     A
B1:00C911         
B1:00C911 8028              SJMP     ?C0587?ZW_TRANSPORT
B1:00C913         ?C0104?ZW_TRANSPORT:
B1:00C913 301E13            JNB      routed,?C0111?ZW_TRANSPORT
B1:00C916 E566              MOV      A,current40kSeqNosTX
B1:00C918 54F0              ANL      A,#0F0H
B1:00C91A FF                MOV      R7,A
B1:00C91B BFF003            CJNE     R7,#0F0H,?C0112?ZW_TRANSPORT
B1:00C91E 53660F            ANL      current40kSeqNosTX,#0FH
B1:00C921         ?C0112?ZW_TRANSPORT:
B1:00C921 7410              MOV      A,#010H
B1:00C923 2566              ADD      A,current40kSeqNosTX
B1:00C925 F566              MOV      current40kSeqNosTX,A
B1:00C927         
B1:00C927 8012              SJMP     ?C0587?ZW_TRANSPORT
B1:00C929         ?C0111?ZW_TRANSPORT:
B1:00C929 E566              MOV      A,current40kSeqNosTX
B1:00C92B 540F              ANL      A,#0FH
B1:00C92D FF                MOV      R7,A
B1:00C92E BF0F03            CJNE     R7,#0FH,?C0114?ZW_TRANSPORT
B1:00C931 5366F0            ANL      current40kSeqNosTX,#0F0H
B1:00C934         ?C0114?ZW_TRANSPORT:
B1:00C934 0566              INC      current40kSeqNosTX
B1:00C936 E566              MOV      A,current40kSeqNosTX
B1:00C938 540F              ANL      A,#0FH
B1:00C93A C4                SWAP     A
B1:00C93B         
B1:00C93B 54F0              ANL      A,#0F0H
B1:00C93D FF                MOV      R7,A
B1:00C93E 22                RET      
----- FUNCTION IncSeqNo (END) -------


----- FUNCTION ?L?COM0630 (BEGIN) -----
B1:00C93F 921D              MOV      ?IncSeqNo?BIT,C
B1:00C941 C21E              CLR      ?IncSeqNo?BIT+01H
B1:00C943 80A1              SJMP     IncSeqNo
----- FUNCTION ?L?COM0630 (END) -------


----- FUNCTION TransmitReturnRouteSetup (BEGIN) -----
B1:00C945 900871            MOV      DPTR,#activeTransmit+01H
B1:00C948 E0                MOVX     A,@DPTR
B1:00C949 F4                CPL      A
B1:00C94A 7002              JNZ      $ + 4H
B1:00C94C 21FA              AJMP     ?C0193?ZW_TRANSPORT
B1:00C94E 128538            LCALL    ?L?COM0016
B1:00C951 5110              ACALL    ?L?COM040A
B1:00C953 E55E              MOV      A,returnRoute
B1:00C955 128859            LCALL    ?L?COM000D
B1:00C958 12216F            LCALL    ?C?ILDPTR
B1:00C95B 5418              ANL      A,#018H
;---- Variable 'tmpRFOptions' assigned to Register 'R5' ----
B1:00C95D FD                MOV      R5,A
B1:00C95E AF64              MOV      R7,returnRoute+06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 358


B1:00C960 7188              ACALL    _ReturnRouteGetSpeed
B1:00C962 12885C            LCALL    ?L?COM000E
B1:00C965 E4                CLR      A
B1:00C966 8FF0              MOV      B,R7
B1:00C968 12221F            LCALL    ?C?ISTPTR
B1:00C96B 12216F            LCALL    ?C?ILDPTR
B1:00C96E FF                MOV      R7,A
B1:00C96F 5105              ACALL    ?L?COM027E
B1:00C971 E55F              MOV      A,returnRoute+01H
B1:00C973 540F              ANL      A,#0FH
B1:00C975 900AFD            MOV      DPTR,#bRepeaterCountInReturnRoute
B1:00C978 F0                MOVX     @DPTR,A
B1:00C979 603D              JZ       ?C0194?ZW_TRANSPORT
B1:00C97B E0                MOVX     A,@DPTR
B1:00C97C FF                MOV      R7,A
B1:00C97D 7404              MOV      A,#04H
B1:00C97F C3                CLR      C
B1:00C980 9F                SUBB     A,R7
B1:00C981 4035              JC       ?C0194?ZW_TRANSPORT
B1:00C983 900AFC            MOV      DPTR,#tmpFrameType
B1:00C986 7404              MOV      A,#04H
B1:00C988 F0                MOVX     @DPTR,A
B1:00C989 128538            LCALL    ?L?COM0016
B1:00C98C 24BD              ADD      A,#0BDH
B1:00C98E F9                MOV      R1,A
B1:00C98F E4                CLR      A
B1:00C990 3A                ADDC     A,R2
B1:00C991 FA                MOV      R2,A
B1:00C992 C003              PUSH     AR3
B1:00C994 C002              PUSH     AR2
B1:00C996 C001              PUSH     AR1
B1:00C998 12C791            LCALL    ?L?COM0569
B1:00C99B 126149            LCALL    ?L?COM0047
B1:00C99E D001              POP      AR1
B1:00C9A0 D002              POP      AR2
B1:00C9A2 D003              POP      AR3
B1:00C9A4 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C9A7 900AFD            MOV      DPTR,#bRepeaterCountInReturnRoute
B1:00C9AA E0                MOVX     A,@DPTR
B1:00C9AB C4                SWAP     A
B1:00C9AC 54F0              ANL      A,#0F0H
B1:00C9AE 128537            LCALL    ?L?COM0015
B1:00C9B1 24BC              ADD      A,#0BCH
B1:00C9B3 1287E0            LCALL    ?L?COM002E
B1:00C9B6 8006              SJMP     ?C0195?ZW_TRANSPORT
B1:00C9B8         ?C0194?ZW_TRANSPORT:
B1:00C9B8 900AFC            MOV      DPTR,#tmpFrameType
B1:00C9BB 7401              MOV      A,#01H
B1:00C9BD F0                MOVX     @DPTR,A
B1:00C9BE         ?C0195?ZW_TRANSPORT:
B1:00C9BE 900AFC            MOV      DPTR,#tmpFrameType
B1:00C9C1 E0                MOVX     A,@DPTR
B1:00C9C2 6404              XRL      A,#04H
B1:00C9C4 7010              JNZ      ?C0196?ZW_TRANSPORT
B1:00C9C6 E0                MOVX     A,@DPTR
B1:00C9C7 FE                MOV      R6,A
B1:00C9C8 12885C            LCALL    ?L?COM000E
B1:00C9CB 31FC              ACALL    ?L?COM0420
B1:00C9CD 7001              JNZ      ?C0197?ZW_TRANSPORT
B1:00C9CF D3                SETB     C
B1:00C9D0         ?C0197?ZW_TRANSPORT:
B1:00C9D0         ?C0198?ZW_TRANSPORT:
B1:00C9D0 921D              MOV      ?IncSeqNo?BIT,C
B1:00C9D2 D21E              SETB     ?IncSeqNo?BIT+01H
B1:00C9D4 8011              SJMP     ?C0597?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 359


B1:00C9D6         ?C0196?ZW_TRANSPORT:
B1:00C9D6 900AFC            MOV      DPTR,#tmpFrameType
B1:00C9D9 E0                MOVX     A,@DPTR
B1:00C9DA FE                MOV      R6,A
B1:00C9DB 12885C            LCALL    ?L?COM000E
B1:00C9DE 31FC              ACALL    ?L?COM0420
B1:00C9E0 7001              JNZ      ?C0200?ZW_TRANSPORT
B1:00C9E2 D3                SETB     C
B1:00C9E3         ?C0200?ZW_TRANSPORT:
B1:00C9E3         ?C0201?ZW_TRANSPORT:
B1:00C9E3 921D              MOV      ?IncSeqNo?BIT,C
B1:00C9E5 C21E              CLR      ?IncSeqNo?BIT+01H
B1:00C9E7         
B1:00C9E7 11E6              ACALL    IncSeqNo
B1:00C9E9 EE                MOV      A,R6
B1:00C9EA 4F                ORL      A,R7
B1:00C9EB 900AFC            MOV      DPTR,#tmpFrameType
B1:00C9EE F0                MOVX     @DPTR,A
B1:00C9EF         ?C0199?ZW_TRANSPORT:
B1:00C9EF D208              SETB     currentSeqNoUseTX
B1:00C9F1 900AFC            MOV      DPTR,#tmpFrameType
B1:00C9F4 E0                MOVX     A,@DPTR
B1:00C9F5 12886A            LCALL    ?L?COM0259
B1:00C9F8 D3                SETB     C
B1:00C9F9 22                RET      
B1:00C9FA         ?C0193?ZW_TRANSPORT:
B1:00C9FA C3                CLR      C
B1:00C9FB 22                RET      
----- FUNCTION TransmitReturnRouteSetup (END) -------


----- FUNCTION ?L?COM0420 (BEGIN) -----
B1:00C9FC 12216F            LCALL    ?C?ILDPTR
B1:00C9FF 5407              ANL      A,#07H
B1:00CA01 6402              XRL      A,#02H
B1:00CA03 C3                CLR      C
B1:00CA04 22                RET      
----- FUNCTION ?L?COM0420 (END) -------


----- FUNCTION ?L?COM027E (BEGIN) -----
B1:00CA05 EF                MOV      A,R7
B1:00CA06 4D                ORL      A,R5
B1:00CA07         ?L?COM027F:
B1:00CA07 FF                MOV      R7,A
B1:00CA08         ?L?COM0280:
B1:00CA08 E5F0              MOV      A,B
B1:00CA0A 8FF0              MOV      B,R7
B1:00CA0C 02221F            LJMP     ?C?ISTPTR
----- FUNCTION ?L?COM027E (END) -------


----- FUNCTION ?L?COM0409 (BEGIN) -----
B1:00CA0F E9                MOV      A,R1
B1:00CA10         ?L?COM040A:
B1:00CA10 24BA              ADD      A,#0BAH
B1:00CA12 F9                MOV      R1,A
B1:00CA13 E4                CLR      A
B1:00CA14 3A                ADDC     A,R2
B1:00CA15 FA                MOV      R2,A
B1:00CA16 22                RET      
----- FUNCTION ?L?COM0409 (END) -------


----- FUNCTION _SendMulticastFrame (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 360


B1:00CA17 903D44            MOV      DPTR,#speed
B1:00CA1A 124765            LCALL    ?L?COM0102
B1:00CA1D 12834C            LCALL    ?L?COM04C4
B1:00CA20 903D4D            MOV      DPTR,#pFreeTxElement
B1:00CA23 12976A            LCALL    ?L?COM02DF
B1:00CA26 6058              JZ       ?C0001?ZW_TRANSPORT_MULTI
B1:00CA28 903D45            MOV      DPTR,#bSrcNodeID
B1:00CA2B E0                MOVX     A,@DPTR
B1:00CA2C FF                MOV      R7,A
B1:00CA2D 903D4D            MOV      DPTR,#pFreeTxElement
B1:00CA30 122589            LCALL    ?C?PLDXDATA
B1:00CA33 E9                MOV      A,R1
B1:00CA34 24B6              ADD      A,#0B6H
B1:00CA36 1287E0            LCALL    ?L?COM002E
B1:00CA39 E4                CLR      A
B1:00CA3A 900870            MOV      DPTR,#activeTransmit
B1:00CA3D F0                MOVX     @DPTR,A
B1:00CA3E 903D44            MOV      DPTR,#speed
B1:00CA41 7402              MOV      A,#02H
B1:00CA43 F0                MOVX     @DPTR,A
B1:00CA44 903D46            MOV      DPTR,#txOptions
B1:00CA47 E0                MOVX     A,@DPTR
B1:00CA48 FF                MOV      R7,A
B1:00CA49 30E122            JNB      ACC.1,?C0002?ZW_TRANSPORT_MULTI
B1:00CA4C 903D4D            MOV      DPTR,#pFreeTxElement
B1:00CA4F 122589            LCALL    ?C?PLDXDATA
B1:00CA52 510F              ACALL    ?L?COM0409
B1:00CA54 74FF              MOV      A,#0FFH
B1:00CA56 122072            LCALL    ?C?CSTPTR
B1:00CA59 EF                MOV      A,R7
B1:00CA5A 54FC              ANL      A,#0FCH
B1:00CA5C 903D46            MOV      DPTR,#txOptions
B1:00CA5F F0                MOVX     @DPTR,A
B1:00CA60 FE                MOV      R6,A
B1:00CA61 903DFE            MOV      DPTR,#bMultiTxOptions
B1:00CA64 E0                MOVX     A,@DPTR
B1:00CA65 54FD              ANL      A,#0FDH
B1:00CA67 F0                MOVX     @DPTR,A
B1:00CA68 5183              ACALL    ?L?COM01AF
B1:00CA6A 7D01              MOV      R5,#01H
B1:00CA6C 800C              SJMP     ?C0018?ZW_TRANSPORT_MULTI
B1:00CA6E         ?C0002?ZW_TRANSPORT_MULTI:
B1:00CA6E 903D46            MOV      DPTR,#txOptions
B1:00CA71 E0                MOVX     A,@DPTR
B1:00CA72 54FE              ANL      A,#0FEH
B1:00CA74 F0                MOVX     @DPTR,A
B1:00CA75 FE                MOV      R6,A
B1:00CA76 5183              ACALL    ?L?COM01AF
B1:00CA78 7D02              MOV      R5,#02H
B1:00CA7A         
B1:00CA7A 128CC3            LCALL    _EnQueueCommon
B1:00CA7D         ?C0003?ZW_TRANSPORT_MULTI:
B1:00CA7D 7F01              MOV      R7,#01H
B1:00CA7F 22                RET      
B1:00CA80         ?C0001?ZW_TRANSPORT_MULTI:
B1:00CA80 7F00              MOV      R7,#00H
B1:00CA82 22                RET      
----- FUNCTION _SendMulticastFrame (END) -------


----- FUNCTION ?L?COM01AF (BEGIN) -----
B1:00CA83 903D44            MOV      DPTR,#speed
B1:00CA86 E0                MOVX     A,@DPTR
B1:00CA87 FF                MOV      R7,A
B1:00CA88 903D4A            MOV      DPTR,#dataLength
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 361


B1:00CA8B E0                MOVX     A,@DPTR
B1:00CA8C 900A39            MOV      DPTR,#?_EnQueueCommon?BYTE+05H
B1:00CA8F F0                MOVX     @DPTR,A
B1:00CA90 A3                INC      DPTR
B1:00CA91 EE                MOV      A,R6
B1:00CA92 F0                MOVX     @DPTR,A
B1:00CA93 903D4B            MOV      DPTR,#completedFunc
B1:00CA96 E0                MOVX     A,@DPTR
B1:00CA97 FD                MOV      R5,A
B1:00CA98 A3                INC      DPTR
B1:00CA99 E0                MOVX     A,@DPTR
B1:00CA9A 900A3B            MOV      DPTR,#?_EnQueueCommon?BYTE+07H
B1:00CA9D CD                XCH      A,R5
B1:00CA9E F0                MOVX     @DPTR,A
B1:00CA9F A3                INC      DPTR
B1:00CAA0 ED                MOV      A,R5
B1:00CAA1 F0                MOVX     @DPTR,A
B1:00CAA2 903D4D            MOV      DPTR,#pFreeTxElement
B1:00CAA5 122589            LCALL    ?C?PLDXDATA
B1:00CAA8 900A3D            MOV      DPTR,#?_EnQueueCommon?BYTE+09H
B1:00CAAB 1225A9            LCALL    ?C?PSTXDATA
B1:00CAAE 903D47            MOV      DPTR,#pData
B1:00CAB1 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM01AF (END) -------


----- FUNCTION _ZW_SendDataMultiWorker (BEGIN) -----
B1:00CAB4 903D51            MOV      DPTR,#pNodeIDList
B1:00CAB7 1225A9            LCALL    ?C?PSTXDATA
B1:00CABA 903D50            MOV      DPTR,#bSrcNodeID
B1:00CABD EF                MOV      A,R7
B1:00CABE F0                MOVX     @DPTR,A
B1:00CABF FC                MOV      R4,A
B1:00CAC0 903D5B            MOV      DPTR,#speed
B1:00CAC3 7402              MOV      A,#02H
B1:00CAC5 F0                MOVX     @DPTR,A
B1:00CAC6 903D58            MOV      DPTR,#txOptions
B1:00CAC9 E0                MOVX     A,@DPTR
B1:00CACA 5437              ANL      A,#037H
B1:00CACC F0                MOVX     @DPTR,A
B1:00CACD E0                MOVX     A,@DPTR
B1:00CACE FF                MOV      R7,A
B1:00CACF 5420              ANL      A,#020H
B1:00CAD1 903E00            MOV      DPTR,#bMultiFrameOptions
B1:00CAD4 F0                MOVX     @DPTR,A
B1:00CAD5 903DFF            MOV      DPTR,#bMultiSrcNodeID
B1:00CAD8 EC                MOV      A,R4
B1:00CAD9 F0                MOVX     @DPTR,A
B1:00CADA 903D59            MOV      DPTR,#completedFunc
B1:00CADD E0                MOVX     A,@DPTR
B1:00CADE FD                MOV      R5,A
B1:00CADF A3                INC      DPTR
B1:00CAE0 E0                MOVX     A,@DPTR
B1:00CAE1 903DFC            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00CAE4 CD                XCH      A,R5
B1:00CAE5 F0                MOVX     @DPTR,A
B1:00CAE6 A3                INC      DPTR
B1:00CAE7 ED                MOV      A,R5
B1:00CAE8 F0                MOVX     @DPTR,A
B1:00CAE9 903D54            MOV      DPTR,#pData
B1:00CAEC 122589            LCALL    ?C?PLDXDATA
B1:00CAEF 903E03            MOV      DPTR,#pMultiData
B1:00CAF2 1225A9            LCALL    ?C?PSTXDATA
B1:00CAF5 903D57            MOV      DPTR,#dataLength
B1:00CAF8 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 362


B1:00CAF9 FE                MOV      R6,A
B1:00CAFA 903E01            MOV      DPTR,#bMultiDataLength
B1:00CAFD F0                MOVX     @DPTR,A
B1:00CAFE 903D51            MOV      DPTR,#pNodeIDList
B1:00CB01 122589            LCALL    ?C?PLDXDATA
B1:00CB04 900775            MOV      DPTR,#pMultiNodeList
B1:00CB07 1225A9            LCALL    ?C?PSTXDATA
B1:00CB0A EF                MOV      A,R7
B1:00CB0B 4420              ORL      A,#020H
B1:00CB0D 903DFE            MOV      DPTR,#bMultiTxOptions
B1:00CB10 F0                MOVX     @DPTR,A
B1:00CB11 E4                CLR      A
B1:00CB12 903E02            MOV      DPTR,#bMultiStatus
B1:00CB15 F0                MOVX     @DPTR,A
B1:00CB16 C206              CLR      bApplicationTxAbort
B1:00CB18 EE                MOV      A,R6
B1:00CB19 D3                SETB     C
B1:00CB1A 9482              SUBB     A,#082H
B1:00CB1C 4003              JC       ?C0012?ZW_TRANSPORT_MULTI
B1:00CB1E 7F00              MOV      R7,#00H
B1:00CB20 22                RET      
B1:00CB21         ?C0012?ZW_TRANSPORT_MULTI:
B1:00CB21 903D58            MOV      DPTR,#txOptions
B1:00CB24 E0                MOVX     A,@DPTR
B1:00CB25 FB                MOV      R3,A
B1:00CB26 903D5B            MOV      DPTR,#speed
B1:00CB29 30E00C            JNB      ACC.0,?C0014?ZW_TRANSPORT_MULTI
B1:00CB2C 7152              ACALL    ?L?COM062A
B1:00CB2E C003              PUSH     AR3
B1:00CB30 715A              ACALL    ?L?COM035C
B1:00CB32 716F              ACALL    ?L?COM0575
B1:00CB34 D003              POP      AR3
B1:00CB36 8018              SJMP     ?C0020?ZW_TRANSPORT_MULTI
B1:00CB38         ?C0014?ZW_TRANSPORT_MULTI:
B1:00CB38 7152              ACALL    ?L?COM062A
B1:00CB3A 715A              ACALL    ?L?COM035C
B1:00CB3C 903DFC            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00CB3F E0                MOVX     A,@DPTR
B1:00CB40 FB                MOV      R3,A
B1:00CB41 A3                INC      DPTR
B1:00CB42 E0                MOVX     A,@DPTR
B1:00CB43 903D4B            MOV      DPTR,#?_SendMulticastFrame?BYTE+07H
B1:00CB46 CB                XCH      A,R3
B1:00CB47 F0                MOVX     @DPTR,A
B1:00CB48 A3                INC      DPTR
B1:00CB49 EB                MOV      A,R3
B1:00CB4A F0                MOVX     @DPTR,A
B1:00CB4B 903D58            MOV      DPTR,#txOptions
B1:00CB4E E0                MOVX     A,@DPTR
B1:00CB4F FB                MOV      R3,A
B1:00CB50         
B1:00CB50 4117              AJMP     _SendMulticastFrame
----- FUNCTION _ZW_SendDataMultiWorker (END) -------


----- FUNCTION ?L?COM062A (BEGIN) -----
B1:00CB52 E0                MOVX     A,@DPTR
B1:00CB53 FF                MOV      R7,A
B1:00CB54 903D50            MOV      DPTR,#bSrcNodeID
B1:00CB57 E0                MOVX     A,@DPTR
B1:00CB58 FD                MOV      R5,A
B1:00CB59 22                RET      
----- FUNCTION ?L?COM062A (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 363


----- FUNCTION ?L?COM035C (BEGIN) -----
B1:00CB5A 903D54            MOV      DPTR,#pData
B1:00CB5D 122589            LCALL    ?C?PLDXDATA
B1:00CB60 903D47            MOV      DPTR,#?_SendMulticastFrame?BYTE+03H
B1:00CB63 1225A9            LCALL    ?C?PSTXDATA
B1:00CB66 903D57            MOV      DPTR,#dataLength
B1:00CB69 E0                MOVX     A,@DPTR
B1:00CB6A 903D4A            MOV      DPTR,#?_SendMulticastFrame?BYTE+06H
B1:00CB6D F0                MOVX     @DPTR,A
B1:00CB6E 22                RET      
----- FUNCTION ?L?COM035C (END) -------


----- FUNCTION ?L?COM0575 (BEGIN) -----
B1:00CB6F A3                INC      DPTR
B1:00CB70 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_MulticastCompletedFunc
B1:00CB72 F0                MOVX     @DPTR,A
B1:00CB73 A3                INC      DPTR
B1:00CB74 74A3              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_MulticastCompletedFunc
B1:00CB76 F0                MOVX     @DPTR,A
B1:00CB77 22                RET      
----- FUNCTION ?L?COM0575 (END) -------


----- FUNCTION ?L?COM0218 (BEGIN) -----
B1:00CB78 122589            LCALL    ?C?PLDXDATA
B1:00CB7B E9                MOV      A,R1
B1:00CB7C         ?L?COM0219:
B1:00CB7C 24DA              ADD      A,#0DAH
B1:00CB7E F9                MOV      R1,A
B1:00CB7F E4                CLR      A
B1:00CB80 3A                ADDC     A,R2
B1:00CB81 FA                MOV      R2,A
B1:00CB82 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00CB84 75F039            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00CB87 22                RET      
----- FUNCTION ?L?COM0218 (END) -------


----- FUNCTION _ReturnRouteGetSpeed (BEGIN) -----
;---- Variable 'bReturnSpeed' assigned to Register 'R7' ----
;---- Variable 'beamInfo' assigned to Register 'R6' ----
B1:00CB88 E4                CLR      A
B1:00CB89 FE                MOV      R6,A
B1:00CB8A EF                MOV      A,R7
B1:00CB8B 30E205            JNB      ACC.2,?C0141?ZW_TRANSPORT
B1:00CB8E 7440              MOV      A,#040H
B1:00CB90 FE                MOV      R6,A
B1:00CB91 8008              SJMP     ?C0142?ZW_TRANSPORT
B1:00CB93         ?C0141?ZW_TRANSPORT:
B1:00CB93 EF                MOV      A,R7
B1:00CB94 30E104            JNB      ACC.1,?C0142?ZW_TRANSPORT
B1:00CB97 EE                MOV      A,R6
B1:00CB98 4420              ORL      A,#020H
B1:00CB9A FE                MOV      R6,A
B1:00CB9B         ?C0142?ZW_TRANSPORT:
B1:00CB9B EF                MOV      A,R7
B1:00CB9C 5438              ANL      A,#038H
B1:00CB9E 24F0              ADD      A,#0F0H
B1:00CBA0 6007              JZ       ?C0147?ZW_TRANSPORT
B1:00CBA2 24F0              ADD      A,#0F0H
B1:00CBA4 7008              JNZ      ?C0149?ZW_TRANSPORT
B1:00CBA6         ?C0145?ZW_TRANSPORT:
B1:00CBA6 7F03              MOV      R7,#03H
B1:00CBA8 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 364


B1:00CBA9         ?C0147?ZW_TRANSPORT:
B1:00CBA9 EE                MOV      A,R6
B1:00CBAA 4402              ORL      A,#02H
B1:00CBAC FF                MOV      R7,A
B1:00CBAD 22                RET      
B1:00CBAE         ?C0149?ZW_TRANSPORT:
B1:00CBAE 7F01              MOV      R7,#01H
B1:00CBB0 22                RET      
----- FUNCTION _ReturnRouteGetSpeed (END) -------


----- FUNCTION _ZW_SendDataMulti (BEGIN) -----
;---- Variable 'pNodeIDList' assigned to Register 'R1/R2/R3' ----
B1:00CBB1 901221            MOV      DPTR,#nodeID
B1:00CBB4 E0                MOVX     A,@DPTR
B1:00CBB5 FF                MOV      R7,A
B1:00CBB6 C003              PUSH     AR3
B1:00CBB8 C002              PUSH     AR2
B1:00CBBA C001              PUSH     AR1
B1:00CBBC 903DF5            MOV      DPTR,#pData
B1:00CBBF 122589            LCALL    ?C?PLDXDATA
B1:00CBC2 903D54            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+04H
B1:00CBC5 1225A9            LCALL    ?C?PSTXDATA
B1:00CBC8 903DF8            MOV      DPTR,#dataLength
B1:00CBCB E0                MOVX     A,@DPTR
B1:00CBCC 903D57            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+07H
B1:00CBCF F0                MOVX     @DPTR,A
B1:00CBD0 903DF9            MOV      DPTR,#txOptions
B1:00CBD3 E0                MOVX     A,@DPTR
B1:00CBD4 903D58            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+08H
B1:00CBD7 F0                MOVX     @DPTR,A
B1:00CBD8 903DFA            MOV      DPTR,#completedFunc
B1:00CBDB E0                MOVX     A,@DPTR
B1:00CBDC FD                MOV      R5,A
B1:00CBDD A3                INC      DPTR
B1:00CBDE E0                MOVX     A,@DPTR
B1:00CBDF 903D59            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+09H
B1:00CBE2 CD                XCH      A,R5
B1:00CBE3 F0                MOVX     @DPTR,A
B1:00CBE4 A3                INC      DPTR
B1:00CBE5 ED                MOV      A,R5
B1:00CBE6 F0                MOVX     @DPTR,A
B1:00CBE7 D001              POP      AR1
B1:00CBE9 D002              POP      AR2
B1:00CBEB D003              POP      AR3
B1:00CBED 41B4              AJMP     _ZW_SendDataMultiWorker
----- FUNCTION _ZW_SendDataMulti (END) -------


----- FUNCTION ProtocolWaitACKTimeout (BEGIN) -----
B1:00CBEF 128538            LCALL    ?L?COM0016
B1:00CBF2 4A                ORL      A,R2
B1:00CBF3 C3                CLR      C
B1:00CBF4 6001              JZ       ?C0002?ZW_TXQ_PROTOCOL
B1:00CBF6 D3                SETB     C
B1:00CBF7         ?C0002?ZW_TXQ_PROTOCOL:
B1:00CBF7         ?C0003?ZW_TXQ_PROTOCOL:
B1:00CBF7 4002              JC       $ + 4H
B1:00CBF9 8183              AJMP     ?C0004?ZW_TXQ_PROTOCOL
B1:00CBFB         ?C0001?ZW_TXQ_PROTOCOL:
B1:00CBFB 128538            LCALL    ?L?COM0016
B1:00CBFE 125C45            LCALL    ?L?COM00B8
B1:00CC01 74FF              MOV      A,#0FFH
B1:00CC03 12201D            LCALL    ?C?CILDPTR
B1:00CC06 121FB3            LCALL    ?C?CLDPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 365


B1:00CC09 FF                MOV      R7,A
B1:00CC0A D3                SETB     C
B1:00CC0B 9401              SUBB     A,#01H
B1:00CC0D 4007              JC       ?C0005?ZW_TXQ_PROTOCOL
B1:00CC0F EF                MOV      A,R7
B1:00CC10 9403              SUBB     A,#03H
B1:00CC12 5002              JNC      ?C0005?ZW_TXQ_PROTOCOL
B1:00CC14 805C              SJMP     ?C0048?ZW_TXQ_PROTOCOL
B1:00CC16         ?C0005?ZW_TXQ_PROTOCOL:
B1:00CC16 128538            LCALL    ?L?COM0016
B1:00CC19 2401              ADD      A,#01H
B1:00CC1B 128622            LCALL    ?L?COM0006
B1:00CC1E 6401              XRL      A,#01H
B1:00CC20 7059              JNZ      ?C0007?ZW_TXQ_PROTOCOL
B1:00CC22 12885C            LCALL    ?L?COM000E
B1:00CC25 1272B9            LCALL    ?L?COM0455
B1:00CC28 5407              ANL      A,#07H
B1:00CC2A 6403              XRL      A,#03H
B1:00CC2C 7044              JNZ      ?C0008?ZW_TXQ_PROTOCOL
B1:00CC2E 128538            LCALL    ?L?COM0016
B1:00CC31 24B6              ADD      A,#0B6H
B1:00CC33 128622            LCALL    ?L?COM0006
B1:00CC36 FD                MOV      R5,A
B1:00CC37 901221            MOV      DPTR,#nodeID
B1:00CC3A E0                MOVX     A,@DPTR
B1:00CC3B 6D                XRL      A,R5
B1:00CC3C 7034              JNZ      ?C0008?ZW_TXQ_PROTOCOL
B1:00CC3E 128538            LCALL    ?L?COM0016
B1:00CC41 24B7              ADD      A,#0B7H
B1:00CC43 128622            LCALL    ?L?COM0006
B1:00CC46 20E729            JB       ACC.7,?C0008?ZW_TXQ_PROTOCOL
B1:00CC49 128538            LCALL    ?L?COM0016
B1:00CC4C 24B9              ADD      A,#0B9H
B1:00CC4E 128622            LCALL    ?L?COM0006
B1:00CC51 D3                SETB     C
B1:00CC52 9440              SUBB     A,#040H
B1:00CC54 501C              JNC      ?C0008?ZW_TXQ_PROTOCOL
B1:00CC56 200219            JB       findInProgress,?C0008?ZW_TXQ_PROTOCOL
B1:00CC59 12885C            LCALL    ?L?COM000E
B1:00CC5C EF                MOV      A,R7
B1:00CC5D 54F8              ANL      A,#0F8H
B1:00CC5F 4402              ORL      A,#02H
B1:00CC61 FF                MOV      R7,A
B1:00CC62 12A5B6            LCALL    ?L?COM00FA
B1:00CC65 128538            LCALL    ?L?COM0016
B1:00CC68 24B7              ADD      A,#0B7H
B1:00CC6A 128622            LCALL    ?L?COM0006
B1:00CC6D 4410              ORL      A,#010H
B1:00CC6F 122072            LCALL    ?C?CSTPTR
B1:00CC72         ?C0008?ZW_TXQ_PROTOCOL:
B1:00CC72         
B1:00CC72 903999            MOV      DPTR,#pFrameWaitingForACK
B1:00CC75 122589            LCALL    ?C?PLDXDATA
B1:00CC78 028E33            LJMP     _TxQueueQueueElement
B1:00CC7B         ?C0007?ZW_TXQ_PROTOCOL:
B1:00CC7B E4                CLR      A
B1:00CC7C 90399C            MOV      DPTR,#waitingForRoutedACK
B1:00CC7F F0                MOVX     @DPTR,A
B1:00CC80 12A26D            LCALL    RetransmitFail
B1:00CC83         ?C0004?ZW_TXQ_PROTOCOL:
B1:00CC83 22                RET      
----- FUNCTION ProtocolWaitACKTimeout (END) -------


----- FUNCTION ZCB_RetransmitDelay (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 366


B1:00CC84 9039B0            MOV      DPTR,#delayCountProtocol
B1:00CC87 E0                MOVX     A,@DPTR
B1:00CC88 6003              JZ       ?C0010?ZW_TXQ_PROTOCOL
B1:00CC8A 14                DEC      A
B1:00CC8B F0                MOVX     @DPTR,A
B1:00CC8C 22                RET      
B1:00CC8D         ?C0010?ZW_TXQ_PROTOCOL:
B1:00CC8D 128FFD            LCALL    TransmitTimerStop
B1:00CC90 61EF              AJMP     ProtocolWaitACKTimeout
----- FUNCTION ZCB_RetransmitDelay (END) -------


----- FUNCTION _ZCB_MulticastCompletedFunc (BEGIN) -----
;---- Variable 'bStatus' assigned to Register 'R7' ----
B1:00CC92 EF                MOV      A,R7
B1:00CC93 6004              JZ       ?C0005?ZW_TRANSPORT_MULTI
B1:00CC95 903E02            MOV      DPTR,#bMultiStatus
B1:00CC98 F0                MOVX     @DPTR,A
B1:00CC99         ?C0005?ZW_TRANSPORT_MULTI:
B1:00CC99 900870            MOV      DPTR,#activeTransmit
B1:00CC9C E0                MOVX     A,@DPTR
B1:00CC9D FF                MOV      R7,A
B1:00CC9E 900775            MOV      DPTR,#pMultiNodeList
B1:00CCA1 122589            LCALL    ?C?PLDXDATA
B1:00CCA4 121BAB            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskGetNextNode
B1:00CCA7 900870            MOV      DPTR,#activeTransmit
B1:00CCAA EF                MOV      A,R7
B1:00CCAB F0                MOVX     @DPTR,A
B1:00CCAC 6048              JZ       ?C0006?ZW_TRANSPORT_MULTI
B1:00CCAE 200645            JB       bApplicationTxAbort,?C0006?ZW_TRANSPORT_MULTI
B1:00CCB1 903E00            MOV      DPTR,#bMultiFrameOptions
B1:00CCB4 E0                MOVX     A,@DPTR
B1:00CCB5 C3                CLR      C
B1:00CCB6 30E501            JNB      ACC.5,?C0007?ZW_TRANSPORT_MULTI
B1:00CCB9 D3                SETB     C
B1:00CCBA         ?C0007?ZW_TRANSPORT_MULTI:
B1:00CCBA         ?C0008?ZW_TRANSPORT_MULTI:
B1:00CCBA 920A              MOV      bUseExploreAsRouteResolution,C
B1:00CCBC 903DFF            MOV      DPTR,#bMultiSrcNodeID
B1:00CCBF E0                MOVX     A,@DPTR
B1:00CCC0 FD                MOV      R5,A
B1:00CCC1 903E03            MOV      DPTR,#pMultiData
B1:00CCC4 122589            LCALL    ?C?PLDXDATA
B1:00CCC7 B118              ACALL    ?L?COM007B
B1:00CCC9 903E01            MOV      DPTR,#bMultiDataLength
B1:00CCCC E0                MOVX     A,@DPTR
B1:00CCCD 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00CCD0 F0                MOVX     @DPTR,A
B1:00CCD1 903DFE            MOV      DPTR,#bMultiTxOptions
B1:00CCD4 E0                MOVX     A,@DPTR
B1:00CCD5 900A13            MOV      DPTR,#?_EnQueueSingleData?BYTE+07H
B1:00CCD8 F0                MOVX     @DPTR,A
B1:00CCD9 A3                INC      DPTR
B1:00CCDA 7480              MOV      A,#080H
B1:00CCDC F0                MOVX     @DPTR,A
B1:00CCDD 716F              ACALL    ?L?COM0575
B1:00CCDF 900870            MOV      DPTR,#activeTransmit
B1:00CCE2 B105              ACALL    ?L?COM04B5
B1:00CCE4 701E              JNZ      ?C0011?ZW_TRANSPORT_MULTI
B1:00CCE6 903E02            MOV      DPTR,#bMultiStatus
B1:00CCE9 7402              MOV      A,#02H
B1:00CCEB F0                MOVX     @DPTR,A
B1:00CCEC 903DFC            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00CCEF 12BE51            LCALL    ?L?COM00BA
B1:00CCF2 7F02              MOV      R7,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 367


B1:00CCF4 800B              SJMP     ?C0019?ZW_TRANSPORT_MULTI
B1:00CCF6         ?C0006?ZW_TRANSPORT_MULTI:
B1:00CCF6 903E02            MOV      DPTR,#bMultiStatus
B1:00CCF9 E0                MOVX     A,@DPTR
B1:00CCFA FF                MOV      R7,A
B1:00CCFB 903DFC            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00CCFE 12515D            LCALL    ?L?COM0154
B1:00CD01         
B1:00CD01 12271A            LCALL    ?C?ICALL2
B1:00CD04         ?C0011?ZW_TRANSPORT_MULTI:
B1:00CD04 22                RET      
----- FUNCTION _ZCB_MulticastCompletedFunc (END) -------


----- FUNCTION ?L?COM04B5 (BEGIN) -----
B1:00CD05 E0                MOVX     A,@DPTR
B1:00CD06 FB                MOV      R3,A
B1:00CD07         ?L?COM04B6:
B1:00CD07 E4                CLR      A
B1:00CD08 FF                MOV      R7,A
B1:00CD09 B171              ACALL    _EnQueueSingleData
B1:00CD0B EF                MOV      A,R7
B1:00CD0C 22                RET      
----- FUNCTION ?L?COM04B5 (END) -------


----- FUNCTION ?L?COM0079 (BEGIN) -----
B1:00CD0D 901221            MOV      DPTR,#nodeID
B1:00CD10 E0                MOVX     A,@DPTR
B1:00CD11 FD                MOV      R5,A
B1:00CD12         ?L?COM007A:
B1:00CD12 7B01              MOV      R3,#01H
B1:00CD14 7A2B              MOV      R2,#HIGH slaveFrameBuffer
B1:00CD16 79BB              MOV      R1,#LOW slaveFrameBuffer
B1:00CD18         ?L?COM007B:
B1:00CD18 900A0F            MOV      DPTR,#?_EnQueueSingleData?BYTE+03H
B1:00CD1B 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0079 (END) -------


----- FUNCTION _ZW_SendNodeInformation (BEGIN) -----
B1:00CD1E 90420F            MOV      DPTR,#destNode
B1:00CD21 124765            LCALL    ?L?COM0102
B1:00CD24 EA                MOV      A,R2
B1:00CD25 F0                MOVX     @DPTR,A
B1:00CD26 A3                INC      DPTR
B1:00CD27 EB                MOV      A,R3
B1:00CD28 F0                MOVX     @DPTR,A
B1:00CD29 7B01              MOV      R3,#01H
B1:00CD2B 7A2B              MOV      R2,#HIGH slaveFrameBuffer
B1:00CD2D 79BB              MOV      R1,#LOW slaveFrameBuffer
B1:00CD2F 12DBB6            LCALL    _GenerateNodeInformation
B1:00CD32 904210            MOV      DPTR,#txOptions
B1:00CD35 E0                MOVX     A,@DPTR
B1:00CD36 5437              ANL      A,#037H
B1:00CD38 F0                MOVX     @DPTR,A
B1:00CD39 30E502            JNB      ACC.5,?C0049?ZW_SLAVE
B1:00CD3C D20A              SETB     bUseExploreAsRouteResolution
B1:00CD3E         ?C0049?ZW_SLAVE:
B1:00CD3E 904210            MOV      DPTR,#txOptions
B1:00CD41 E0                MOVX     A,@DPTR
B1:00CD42 54DF              ANL      A,#0DFH
B1:00CD44 F0                MOVX     @DPTR,A
B1:00CD45 300514            JNB      forceUse40K,?C0050?ZW_SLAVE
B1:00CD48 C205              CLR      forceUse40K
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 368


B1:00CD4A B10D              ACALL    ?L?COM0079
B1:00CD4C B1DD              ACALL    ?L?COM0265
B1:00CD4E 904211            MOV      DPTR,#completedFunc
B1:00CD51 F174              ACALL    ?L?COM0475
B1:00CD53 90420F            MOV      DPTR,#destNode
B1:00CD56 E0                MOVX     A,@DPTR
B1:00CD57 FB                MOV      R3,A
B1:00CD58 7F02              MOV      R7,#02H
B1:00CD5A 8015              SJMP     ?C0306?ZW_SLAVE
B1:00CD5C         ?C0050?ZW_SLAVE:
B1:00CD5C 90420F            MOV      DPTR,#destNode
B1:00CD5F E0                MOVX     A,@DPTR
B1:00CD60 FF                MOV      R7,A
B1:00CD61 D191              ACALL    _ChooseSpeedForDestination_slave
B1:00CD63 B10D              ACALL    ?L?COM0079
B1:00CD65 B1DD              ACALL    ?L?COM0265
B1:00CD67 904211            MOV      DPTR,#completedFunc
B1:00CD6A F181              ACALL    ?L?COM047C
B1:00CD6C 90420F            MOV      DPTR,#destNode
B1:00CD6F E0                MOVX     A,@DPTR
B1:00CD70 FB                MOV      R3,A
B1:00CD71         
B1:;----                  JMP      _EnQueueSingleData
----- FUNCTION _ZW_SendNodeInformation (END) -------


----- FUNCTION _EnQueueSingleData (BEGIN) -----
B1:00CD71 900A0C            MOV      DPTR,#rfSpeed
B1:00CD74 124765            LCALL    ?L?COM0102
B1:00CD77 12834C            LCALL    ?L?COM04C4
B1:00CD7A 900A17            MOV      DPTR,#pFreeTxElement
B1:00CD7D 12976A            LCALL    ?L?COM02DF
B1:00CD80 6056              JZ       ?C0151?ZW_TRANSPORT
B1:00CD82 1251E9            LCALL    getTickTime
B1:00CD85 900A17            MOV      DPTR,#pFreeTxElement
B1:00CD88 122589            LCALL    ?C?PLDXDATA
B1:00CD8B E9                MOV      A,R1
B1:00CD8C 24E9              ADD      A,#0E9H
B1:00CD8E 12A5B2            LCALL    ?L?COM00F9
B1:00CD91 900A17            MOV      DPTR,#pFreeTxElement
B1:00CD94 F1A8              ACALL    ?L?COM0416
B1:00CD96 125765            LCALL    ?L?COM01E3
B1:00CD99 900A0C            MOV      DPTR,#rfSpeed
B1:00CD9C E0                MOVX     A,@DPTR
B1:00CD9D FF                MOV      R7,A
B1:00CD9E A3                INC      DPTR
B1:00CD9F E0                MOVX     A,@DPTR
B1:00CDA0 FD                MOV      R5,A
B1:00CDA1 900A0F            MOV      DPTR,#pData
B1:00CDA4 12978A            LCALL    ?L?COM0393
B1:00CDA7 900A12            MOV      DPTR,#dataLength
B1:00CDAA E0                MOVX     A,@DPTR
B1:00CDAB 9009FA            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+06H
B1:00CDAE F0                MOVX     @DPTR,A
B1:00CDAF 900A13            MOV      DPTR,#txOptions
B1:00CDB2 E0                MOVX     A,@DPTR
B1:00CDB3 9009FB            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+07H
B1:00CDB6 F0                MOVX     @DPTR,A
B1:00CDB7 900A14            MOV      DPTR,#txOptions1
B1:00CDBA E0                MOVX     A,@DPTR
B1:00CDBB 9009FC            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:00CDBE F0                MOVX     @DPTR,A
B1:00CDBF 900A15            MOV      DPTR,#completedFunc
B1:00CDC2 F1C8              ACALL    ?L?COM047E
B1:00CDC4 900A17            MOV      DPTR,#pFreeTxElement
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 369


B1:00CDC7 129781            LCALL    ?L?COM02DB
B1:00CDCA 900A0E            MOV      DPTR,#destNodeID
B1:00CDCD E0                MOVX     A,@DPTR
B1:00CDCE FB                MOV      R3,A
B1:00CDCF 1292BF            LCALL    _EnqueueSingleDataPtr
B1:00CDD2 EF                MOV      A,R7
B1:00CDD3 6003              JZ       ?C0151?ZW_TRANSPORT
B1:00CDD5 7F01              MOV      R7,#01H
B1:00CDD7 22                RET      
B1:00CDD8         ?C0151?ZW_TRANSPORT:
B1:00CDD8 F18E              ACALL    CleanUpAfterFailedTxElemAlloc
B1:00CDDA 7F00              MOV      R7,#00H
B1:00CDDC 22                RET      
----- FUNCTION _EnQueueSingleData (END) -------


----- FUNCTION ?L?COM0265 (BEGIN) -----
B1:00CDDD 902BE5            MOV      DPTR,#blnodeInfoLength
B1:00CDE0 E0                MOVX     A,@DPTR
B1:00CDE1 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00CDE4 F0                MOVX     @DPTR,A
B1:00CDE5 904210            MOV      DPTR,#txOptions
B1:00CDE8         ?L?COM0266:
B1:00CDE8 E0                MOVX     A,@DPTR
B1:00CDE9 900A13            MOV      DPTR,#?_EnQueueSingleData?BYTE+07H
B1:00CDEC F0                MOVX     @DPTR,A
B1:00CDED E4                CLR      A
B1:00CDEE A3                INC      DPTR
B1:00CDEF F0                MOVX     @DPTR,A
B1:00CDF0 22                RET      
----- FUNCTION ?L?COM0265 (END) -------


----- FUNCTION _ZW_RequestNodeInfo (BEGIN) -----
B1:00CDF1 904342            MOV      DPTR,#completedFunc
B1:00CDF4 EC                MOV      A,R4
B1:00CDF5 F0                MOVX     @DPTR,A
B1:00CDF6 A3                INC      DPTR
B1:00CDF7 ED                MOV      A,R5
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00CDF8 F138              ACALL    ?L?COM0398
B1:00CDFA 04                INC      A
B1:00CDFB F0                MOVX     @DPTR,A
B1:00CDFC D20A              SETB     bUseExploreAsRouteResolution
B1:00CDFE 901221            MOV      DPTR,#nodeID
B1:00CE01 E0                MOVX     A,@DPTR
B1:00CE02 FD                MOV      R5,A
B1:00CE03 AB07              MOV      R3,AR7
B1:00CE05 C003              PUSH     AR3
B1:00CE07 B112              ACALL    ?L?COM007A
B1:00CE09 7402              MOV      A,#02H
B1:00CE0B F168              ACALL    ?L?COM02E5
B1:00CE0D 904342            MOV      DPTR,#completedFunc
B1:00CE10 F174              ACALL    ?L?COM0475
B1:00CE12 D003              POP      AR3
B1:00CE14 B107              ACALL    ?L?COM04B6
B1:00CE16 24FF              ADD      A,#0FFH
B1:00CE18 22                RET      
----- FUNCTION _ZW_RequestNodeInfo (END) -------


----- FUNCTION _ZW_RequestNetworkUpdateInternal (BEGIN) -----
B1:00CE19 90433E            MOV      DPTR,#force
B1:00CE1C EF                MOV      A,R7
B1:00CE1D F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 370


;---- Variable 'completedFunc' assigned to Register 'R4/R5' ----
B1:00CE1E A3                INC      DPTR
B1:00CE1F 7407              MOV      A,#07H
B1:00CE21 F0                MOVX     @DPTR,A
B1:00CE22 902BB4            MOV      DPTR,#sucNodeID
B1:00CE25 E0                MOVX     A,@DPTR
B1:00CE26 6004              JZ       ?C0271?ZW_SLAVE
B1:00CE28 F19A              ACALL    ?L?COM0476
B1:00CE2A 6003              JZ       ?C0270?ZW_SLAVE
B1:00CE2C         ?C0271?ZW_SLAVE:
B1:00CE2C 7F00              MOV      R7,#00H
B1:00CE2E 22                RET      
B1:00CE2F         ?C0270?ZW_SLAVE:
B1:00CE2F 902BA6            MOV      DPTR,#SUC_Update
B1:00CE32 7402              MOV      A,#02H
B1:00CE34 F0                MOVX     @DPTR,A
B1:00CE35 902B39            MOV      DPTR,#_routeUpdateDone
B1:00CE38 F193              ACALL    ?L?COM031F
B1:00CE3A F138              ACALL    ?L?COM0398
B1:00CE3C 7415              MOV      A,#015H
B1:00CE3E F0                MOVX     @DPTR,A
B1:00CE3F F1A1              ACALL    ?L?COM04F1
B1:00CE41 126149            LCALL    ?L?COM0047
B1:00CE44 7A2B              MOV      R2,#HIGH slaveFrameBuffer+02H
B1:00CE46 79BD              MOV      R1,#LOW slaveFrameBuffer+02H
B1:00CE48 7F05              MOV      R7,#05H
B1:00CE4A 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00CE4D 90433E            MOV      DPTR,#force
B1:00CE50 E0                MOVX     A,@DPTR
B1:00CE51 600C              JZ       ?C0273?ZW_SLAVE
B1:00CE53 902BC2            MOV      DPTR,#slaveFrameBuffer+07H
B1:00CE56 74FF              MOV      A,#0FFH
B1:00CE58 F0                MOVX     @DPTR,A
B1:00CE59 90433F            MOV      DPTR,#frameSize
B1:00CE5C E0                MOVX     A,@DPTR
B1:00CE5D 04                INC      A
B1:00CE5E F0                MOVX     @DPTR,A
B1:00CE5F         ?C0273?ZW_SLAVE:
B1:00CE5F 902BB4            MOV      DPTR,#sucNodeID
B1:00CE62 E0                MOVX     A,@DPTR
B1:00CE63 FF                MOV      R7,A
B1:00CE64 D191              ACALL    _ChooseSpeedForDestination_slave
B1:00CE66 B10D              ACALL    ?L?COM0079
B1:00CE68 90433F            MOV      DPTR,#frameSize
B1:00CE6B E0                MOVX     A,@DPTR
B1:00CE6C F168              ACALL    ?L?COM02E5
B1:00CE6E A3                INC      DPTR
B1:00CE6F 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ReqUpdateCallback
B1:00CE71 F0                MOVX     @DPTR,A
B1:00CE72 A3                INC      DPTR
B1:00CE73 74C1              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ReqUpdateCallback
B1:00CE75 F0                MOVX     @DPTR,A
B1:00CE76 902BB4            MOV      DPTR,#sucNodeID
B1:00CE79 E0                MOVX     A,@DPTR
B1:00CE7A FB                MOV      R3,A
B1:00CE7B B171              ACALL    _EnQueueSingleData
B1:00CE7D EF                MOV      A,R7
B1:00CE7E 700E              JNZ      ?C0274?ZW_SLAVE
B1:00CE80 902BA6            MOV      DPTR,#SUC_Update
B1:00CE83 04                INC      A
B1:00CE84 F0                MOVX     @DPTR,A
B1:00CE85 E4                CLR      A
B1:00CE86 902B39            MOV      DPTR,#_routeUpdateDone
B1:00CE89 F0                MOVX     @DPTR,A
B1:00CE8A A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 371


B1:00CE8B F0                MOVX     @DPTR,A
B1:00CE8C FF                MOV      R7,A
B1:00CE8D 22                RET      
B1:00CE8E         ?C0274?ZW_SLAVE:
B1:00CE8E 7F01              MOV      R7,#01H
B1:00CE90 22                RET      
----- FUNCTION _ZW_RequestNetworkUpdateInternal (END) -------


----- FUNCTION _ChooseSpeedForDestination_slave (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
;---- Variable 'idx' assigned to Register 'R6' ----
B1:00CE91 E4                CLR      A
B1:00CE92 FE                MOV      R6,A
B1:00CE93         ?C0363?ZW_TRANSPORT:
B1:00CE93 EE                MOV      A,R6
B1:00CE94 F1BB              ACALL    ?L?COM047D
B1:00CE96 B5070F            CJNE     A,AR7,?C0365?ZW_TRANSPORT
B1:00CE99 EE                MOV      A,R6
B1:00CE9A 25E0              ADD      A,ACC
B1:00CE9C 2489              ADD      A,#LOW abDirectNodesResponseSpeed+01H
B1:00CE9E F582              MOV      DPL,A
B1:00CEA0 E4                CLR      A
B1:00CEA1 3408              ADDC     A,#HIGH abDirectNodesResponseSpeed+01H
B1:00CEA3 F583              MOV      DPH,A
B1:00CEA5 E0                MOVX     A,@DPTR
B1:00CEA6 FF                MOV      R7,A
B1:00CEA7 22                RET      
B1:00CEA8         ?C0365?ZW_TRANSPORT:
B1:00CEA8 0E                INC      R6
B1:00CEA9 EE                MOV      A,R6
B1:00CEAA B402E6            CJNE     A,#02H,?C0363?ZW_TRANSPORT
B1:00CEAD         ?C0364?ZW_TRANSPORT:
B1:00CEAD 7F01              MOV      R7,#01H
B1:00CEAF 22                RET      
----- FUNCTION _ChooseSpeedForDestination_slave (END) -------


----- FUNCTION _SendTestFrame (BEGIN) -----
B1:00CEB0 90420B            MOV      DPTR,#bNodeID
B1:00CEB3 124765            LCALL    ?L?COM0102
B1:00CEB6 EA                MOV      A,R2
B1:00CEB7 F0                MOVX     @DPTR,A
B1:00CEB8 A3                INC      DPTR
B1:00CEB9 EB                MOV      A,R3
B1:00CEBA F0                MOVX     @DPTR,A
B1:00CEBB 902B25            MOV      DPTR,#cmdBuffer
B1:00CEBE 7401              MOV      A,#01H
B1:00CEC0 F0                MOVX     @DPTR,A
B1:00CEC1 A3                INC      DPTR
B1:00CEC2 7418              MOV      A,#018H
B1:00CEC4 F0                MOVX     @DPTR,A
B1:00CEC5 90420C            MOV      DPTR,#powerLevel
B1:00CEC8 E0                MOVX     A,@DPTR
B1:00CEC9 FF                MOV      R7,A
B1:00CECA 12600A            LCALL    _RFPowerGetTxPwrReg_100
B1:00CECD 902B27            MOV      DPTR,#cmdBuffer+02H
B1:00CED0 EF                MOV      A,R7
B1:00CED1 F0                MOVX     @DPTR,A
B1:00CED2 90420C            MOV      DPTR,#powerLevel
B1:00CED5 E0                MOVX     A,@DPTR
B1:00CED6 902B28            MOV      DPTR,#cmdBuffer+03H
B1:00CED9 F0                MOVX     @DPTR,A
B1:00CEDA 902BAB            MOV      DPTR,#temp
B1:00CEDD 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 372


B1:00CEDF F0                MOVX     @DPTR,A
B1:00CEE0 902BAD            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00CEE3 E0                MOVX     A,@DPTR
B1:00CEE4 FF                MOV      R7,A
B1:00CEE5 B40206            CJNE     A,#02H,?C0020?ZW_SLAVE
B1:00CEE8 902BAB            MOV      DPTR,#temp
B1:00CEEB 7402              MOV      A,#02H
B1:00CEED F0                MOVX     @DPTR,A
B1:00CEEE         ?C0020?ZW_SLAVE:
B1:00CEEE EF                MOV      A,R7
B1:00CEEF B40306            CJNE     A,#03H,?C0021?ZW_SLAVE
B1:00CEF2 902BAB            MOV      DPTR,#temp
B1:00CEF5 7403              MOV      A,#03H
B1:00CEF7 F0                MOVX     @DPTR,A
B1:00CEF8         ?C0021?ZW_SLAVE:
B1:00CEF8 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00CEFB E0                MOVX     A,@DPTR
B1:00CEFC 600E              JZ       ?C0022?ZW_SLAVE
B1:00CEFE 7F40              MOV      R7,#040H
B1:00CF00 B40202            CJNE     A,#02H,?C0023?ZW_SLAVE
B1:00CF03 7F20              MOV      R7,#020H
B1:00CF05         ?C0023?ZW_SLAVE:
B1:00CF05         ?C0024?ZW_SLAVE:
B1:00CF05 EF                MOV      A,R7
B1:00CF06 4402              ORL      A,#02H
B1:00CF08 902BAB            MOV      DPTR,#temp
B1:00CF0B F0                MOVX     @DPTR,A
B1:00CF0C         ?C0022?ZW_SLAVE:
B1:00CF0C 902BAB            MOV      DPTR,#temp
B1:00CF0F 12B0BE            LCALL    ?L?COM01CA
B1:00CF12 7B01              MOV      R3,#01H
B1:00CF14 7A2B              MOV      R2,#HIGH cmdBuffer
B1:00CF16 7925              MOV      R1,#LOW cmdBuffer
B1:00CF18 B118              ACALL    ?L?COM007B
B1:00CF1A 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00CF1D 7404              MOV      A,#04H
B1:00CF1F F0                MOVX     @DPTR,A
B1:00CF20 A3                INC      DPTR
B1:00CF21 7411              MOV      A,#011H
B1:00CF23 F0                MOVX     @DPTR,A
B1:00CF24 E4                CLR      A
B1:00CF25 A3                INC      DPTR
B1:00CF26 F0                MOVX     @DPTR,A
B1:00CF27 90420D            MOV      DPTR,#func
B1:00CF2A F181              ACALL    ?L?COM047C
B1:00CF2C 90420B            MOV      DPTR,#bNodeID
B1:00CF2F E0                MOVX     A,@DPTR
B1:00CF30 FB                MOV      R3,A
B1:00CF31 A171              AJMP     _EnQueueSingleData
----- FUNCTION _SendTestFrame (END) -------


----- FUNCTION _ZW_SendTestFrame (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
;---- Variable 'func' assigned to Register 'R2/R3' ----
;---- Variable 'powerLevel' assigned to Register 'R5' ----
B1:00CF33 F1B1              ACALL    ?L?COM0563
B1:00CF35 F0                MOVX     @DPTR,A
B1:00CF36 C1B0              AJMP     _SendTestFrame
----- FUNCTION _ZW_SendTestFrame (END) -------


----- FUNCTION ?L?COM0398 (BEGIN) -----
B1:00CF38 F0                MOVX     @DPTR,A
B1:00CF39         ?L?COM0399:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 373


B1:00CF39 902BBB            MOV      DPTR,#slaveFrameBuffer
B1:00CF3C 7401              MOV      A,#01H
B1:00CF3E F0                MOVX     @DPTR,A
B1:00CF3F A3                INC      DPTR
B1:00CF40 22                RET      
----- FUNCTION ?L?COM0398 (END) -------


----- FUNCTION _ZCB_CtrlAskedForHelpCallback (BEGIN) -----
;---- Variable 'txStatus' assigned to Register 'R7' ----
B1:00CF41 F139              ACALL    ?L?COM0399
B1:00CF43 7417              MOV      A,#017H
B1:00CF45 F0                MOVX     @DPTR,A
B1:00CF46 EF                MOV      A,R7
B1:00CF47 7006              JNZ      ?C0015?ZW_SLAVE
B1:00CF49 A3                INC      DPTR
B1:00CF4A 7405              MOV      A,#05H
B1:00CF4C F0                MOVX     @DPTR,A
B1:00CF4D 8006              SJMP     ?C0016?ZW_SLAVE
B1:00CF4F         ?C0015?ZW_SLAVE:
B1:00CF4F 902BBD            MOV      DPTR,#slaveFrameBuffer+02H
B1:00CF52 7404              MOV      A,#04H
B1:00CF54 F0                MOVX     @DPTR,A
B1:00CF55         ?C0016?ZW_SLAVE:
B1:00CF55 B10D              ACALL    ?L?COM0079
B1:00CF57 7403              MOV      A,#03H
B1:00CF59 F168              ACALL    ?L?COM02E5
B1:00CF5B A3                INC      DPTR
B1:00CF5C F0                MOVX     @DPTR,A
B1:00CF5D A3                INC      DPTR
B1:00CF5E F0                MOVX     @DPTR,A
B1:00CF5F 902BAC            MOV      DPTR,#helpNodeID
B1:00CF62 E0                MOVX     A,@DPTR
B1:00CF63 FB                MOV      R3,A
B1:00CF64 7F01              MOV      R7,#01H
B1:00CF66 A171              AJMP     _EnQueueSingleData
----- FUNCTION _ZCB_CtrlAskedForHelpCallback (END) -------


----- FUNCTION ?L?COM02E5 (BEGIN) -----
B1:00CF68 900A12            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00CF6B         ?L?COM02E6:
B1:00CF6B F0                MOVX     @DPTR,A
B1:00CF6C A3                INC      DPTR
B1:00CF6D 7405              MOV      A,#05H
B1:00CF6F F0                MOVX     @DPTR,A
B1:00CF70 E4                CLR      A
B1:00CF71 A3                INC      DPTR
B1:00CF72 F0                MOVX     @DPTR,A
B1:00CF73 22                RET      
----- FUNCTION ?L?COM02E5 (END) -------


----- FUNCTION ?L?COM0475 (BEGIN) -----
B1:00CF74 E0                MOVX     A,@DPTR
B1:00CF75 FF                MOV      R7,A
B1:00CF76 A3                INC      DPTR
B1:00CF77 E0                MOVX     A,@DPTR
B1:00CF78 900A15            MOV      DPTR,#?_EnQueueSingleData?BYTE+09H
B1:00CF7B CF                XCH      A,R7
B1:00CF7C F0                MOVX     @DPTR,A
B1:00CF7D A3                INC      DPTR
B1:00CF7E EF                MOV      A,R7
B1:00CF7F F0                MOVX     @DPTR,A
B1:00CF80 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 374


----- FUNCTION ?L?COM0475 (END) -------


----- FUNCTION ?L?COM047C (BEGIN) -----
B1:00CF81 E0                MOVX     A,@DPTR
B1:00CF82 FB                MOV      R3,A
B1:00CF83 A3                INC      DPTR
B1:00CF84 E0                MOVX     A,@DPTR
B1:00CF85 900A15            MOV      DPTR,#?_EnQueueSingleData?BYTE+09H
B1:00CF88 CB                XCH      A,R3
B1:00CF89 F0                MOVX     @DPTR,A
B1:00CF8A A3                INC      DPTR
B1:00CF8B EB                MOV      A,R3
B1:00CF8C F0                MOVX     @DPTR,A
B1:00CF8D 22                RET      
----- FUNCTION ?L?COM047C (END) -------


----- FUNCTION CleanUpAfterFailedTxElemAlloc (BEGIN) -----
B1:00CF8E C20A              CLR      bUseExploreAsRouteResolution
B1:00CF90 D208              SETB     currentSeqNoUseTX
B1:00CF92 22                RET      
----- FUNCTION CleanUpAfterFailedTxElemAlloc (END) -------


----- FUNCTION ?L?COM031F (BEGIN) -----
B1:00CF93 AF05              MOV      R7,AR5
B1:00CF95 EC                MOV      A,R4
B1:00CF96 F0                MOVX     @DPTR,A
B1:00CF97 A3                INC      DPTR
B1:00CF98 EF                MOV      A,R7
B1:00CF99 22                RET      
----- FUNCTION ?L?COM031F (END) -------


----- FUNCTION ?L?COM0476 (BEGIN) -----
B1:00CF9A 902BA6            MOV      DPTR,#SUC_Update
B1:00CF9D E0                MOVX     A,@DPTR
B1:00CF9E 6401              XRL      A,#01H
B1:00CFA0 22                RET      
----- FUNCTION ?L?COM0476 (END) -------


----- FUNCTION ?L?COM04F1 (BEGIN) -----
B1:00CFA1 7B01              MOV      R3,#01H
B1:00CFA3 7A2B              MOV      R2,#HIGH ZW_RouteDestinations
B1:00CFA5 794B              MOV      R1,#LOW ZW_RouteDestinations
B1:00CFA7 22                RET      
----- FUNCTION ?L?COM04F1 (END) -------


----- FUNCTION ?L?COM0416 (BEGIN) -----
B1:00CFA8 122589            LCALL    ?C?PLDXDATA
B1:00CFAB E9                MOV      A,R1
B1:00CFAC 24E6              ADD      A,#0E6H
B1:00CFAE F9                MOV      R1,A
B1:00CFAF E4                CLR      A
B1:00CFB0 22                RET      
----- FUNCTION ?L?COM0416 (END) -------


----- FUNCTION ?L?COM0563 (BEGIN) -----
B1:00CFB1 E4                CLR      A
B1:00CFB2 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00CFB5 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 375


B1:00CFB6 902BAD            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00CFB9 04                INC      A
B1:00CFBA 22                RET      
----- FUNCTION ?L?COM0563 (END) -------


----- FUNCTION ?L?COM047D (BEGIN) -----
B1:00CFBB 25E0              ADD      A,ACC
B1:00CFBD 2488              ADD      A,#LOW abDirectNodesResponseSpeed
B1:00CFBF F582              MOV      DPL,A
B1:00CFC1 E4                CLR      A
B1:00CFC2 3408              ADDC     A,#HIGH abDirectNodesResponseSpeed
B1:00CFC4 F583              MOV      DPH,A
B1:00CFC6 E0                MOVX     A,@DPTR
B1:00CFC7 22                RET      
----- FUNCTION ?L?COM047D (END) -------


----- FUNCTION ?L?COM047E (BEGIN) -----
B1:00CFC8 E0                MOVX     A,@DPTR
B1:00CFC9 FB                MOV      R3,A
B1:00CFCA A3                INC      DPTR
B1:00CFCB E0                MOVX     A,@DPTR
B1:00CFCC 9009FD            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+09H
B1:00CFCF CB                XCH      A,R3
B1:00CFD0 F0                MOVX     @DPTR,A
B1:00CFD1 A3                INC      DPTR
B1:00CFD2 EB                MOV      A,R3
B1:00CFD3 F0                MOVX     @DPTR,A
B1:00CFD4 22                RET      
----- FUNCTION ?L?COM047E (END) -------


----- FUNCTION RemoveAllReturnRouteDestination (BEGIN) -----
B1:00CFD5 7E11              MOV      R6,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00CFD7 7F56              MOV      R7,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00CFD9 127070            LCALL    ?L?COM00E1
B1:00CFDC F1E7              ACALL    ?L?COM043C
B1:00CFDE F1A1              ACALL    ?L?COM04F1
B1:00CFE0 7D05              MOV      R5,#05H
B1:00CFE2 E4                CLR      A
B1:00CFE3 FF                MOV      R7,A
B1:00CFE4 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION RemoveAllReturnRouteDestination (END) -------


----- FUNCTION ?L?COM043C (BEGIN) -----
B1:00CFE7 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00CFEA E4                CLR      A
B1:00CFEB F0                MOVX     @DPTR,A
B1:00CFEC A3                INC      DPTR
B1:00CFED 7405              MOV      A,#05H
B1:00CFEF F0                MOVX     @DPTR,A
B1:00CFF0 026C78            LJMP     _NVM_ext_write_buffer
----- FUNCTION ?L?COM043C (END) -------


----- FUNCTION TxRandom (BEGIN) -----
B1:00CFF3 12413E            LCALL    ZW_Random
;---- Variable 'delay' assigned to Register 'R7' ----
B1:00CFF6 EF                MOV      A,R7
B1:00CFF7 C4                SWAP     A
B1:00CFF8 540F              ANL      A,#0FH
B1:00CFFA 6F                XRL      A,R7
B1:00CFFB FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 376


B1:00CFFC EF                MOV      A,R7
B1:00CFFD C4                SWAP     A
B1:00CFFE 13                RRC      A
B1:00CFFF 5407              ANL      A,#07H
B1:00D001 6E                XRL      A,R6
B1:00D002 FE                MOV      R6,A
B1:00D003 127151            LCALL    ?L?COM02C6
B1:00D006 6E                XRL      A,R6
B1:00D007 5403              ANL      A,#03H
B1:00D009 FF                MOV      R7,A
B1:00D00A 22                RET      
----- FUNCTION TxRandom (END) -------


----- FUNCTION _SetTransmitSpeedOptions (BEGIN) -----
;---- Variable 'pFrame' assigned to Register 'R1/R2/R3' ----
;---- Variable 'speedOptions' assigned to Register 'R6/R7' ----
B1:00D00B 128862            LCALL    ?L?COM0010
B1:00D00E EE                MOV      A,R6
B1:00D00F 8FF0              MOV      B,R7
B1:00D011 02221F            LJMP     ?C?ISTPTR
----- FUNCTION _SetTransmitSpeedOptions (END) -------


----- FUNCTION _GetResponseRoute (BEGIN) -----
B1:00D014 9040BB            MOV      DPTR,#pFrame
B1:00D017 1225A9            LCALL    ?C?PSTXDATA
B1:00D01A 9040BA            MOV      DPTR,#bNodeID
B1:00D01D EF                MOV      A,R7
B1:00D01E F0                MOVX     @DPTR,A
B1:00D01F 9040BE            MOV      DPTR,#rtmp
B1:00D022 7402              MOV      A,#02H
B1:00D024 F0                MOVX     @DPTR,A
B1:00D025 EF                MOV      A,R7
B1:00D026 7002              JNZ      $ + 4H
B1:00D028 2128              AJMP     ?C0014?ZW_ROUTING_ALL
B1:00D02A 901216            MOV      DPTR,#responseRouteCount
B1:00D02D E0                MOVX     A,@DPTR
B1:00D02E 7002              JNZ      $ + 4H
B1:00D030 2128              AJMP     ?C0014?ZW_ROUTING_ALL
B1:00D032         ?C0017?ZW_ROUTING_ALL:
B1:00D032 9040BE            MOV      DPTR,#rtmp
B1:00D035 E0                MOVX     A,@DPTR
B1:00D036 FF                MOV      R7,A
B1:00D037 241D              ADD      A,#LOW responseRouteNodeID-01H
B1:00D039 3144              ACALL    ?L?COM04B7
B1:00D03B E0                MOVX     A,@DPTR
B1:00D03C FE                MOV      R6,A
B1:00D03D 9040BA            MOV      DPTR,#bNodeID
B1:00D040 E0                MOVX     A,@DPTR
B1:00D041 6E                XRL      A,R6
B1:00D042 6002              JZ       $ + 4H
B1:00D044 211E              AJMP     ?C0015?ZW_ROUTING_ALL
B1:00D046 3132              ACALL    ?L?COM03CD
B1:00D048 FE                MOV      R6,A
B1:00D049 540F              ANL      A,#0FH
B1:00D04B 9040BF            MOV      DPTR,#repeaterCount
B1:00D04E F0                MOVX     @DPTR,A
B1:00D04F 9040BB            MOV      DPTR,#pFrame
B1:00D052 12885F            LCALL    ?L?COM000F
B1:00D055 12216F            LCALL    ?C?ILDPTR
B1:00D058 54F8              ANL      A,#0F8H
B1:00D05A FD                MOV      R5,A
B1:00D05B EE                MOV      A,R6
B1:00D05C C4                SWAP     A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 377


B1:00D05D 540F              ANL      A,#0FH
B1:00D05F FF                MOV      R7,A
B1:00D060 E5F0              MOV      A,B
B1:00D062 FE                MOV      R6,A
B1:00D063 ED                MOV      A,R5
B1:00D064 4F                ORL      A,R7
B1:00D065 FF                MOV      R7,A
B1:00D066 12A5B6            LCALL    ?L?COM00FA
B1:00D069 312C              ACALL    ?L?COM040F
B1:00D06B 313E              ACALL    _GetTransmitSpeedOptions
B1:00D06D EF                MOV      A,R7
B1:00D06E 549F              ANL      A,#09FH
B1:00D070 FF                MOV      R7,A
B1:00D071 9040BE            MOV      DPTR,#rtmp
B1:00D074 E0                MOVX     A,@DPTR
B1:00D075 241B              ADD      A,#LOW responseRouteRFOption-01H
B1:00D077 F582              MOV      DPL,A
B1:00D079 E4                CLR      A
B1:00D07A 3412              ADDC     A,#HIGH responseRouteRFOption-01H
B1:00D07C F583              MOV      DPH,A
B1:00D07E E0                MOVX     A,@DPTR
B1:00D07F 5460              ANL      A,#060H
B1:00D081 FD                MOV      R5,A
B1:00D082 EF                MOV      A,R7
B1:00D083 4D                ORL      A,R5
B1:00D084 312B              ACALL    ?L?COM040E
B1:00D086 110B              ACALL    _SetTransmitSpeedOptions
B1:00D088 312C              ACALL    ?L?COM040F
B1:00D08A E9                MOV      A,R1
B1:00D08B 24BD              ADD      A,#0BDH
B1:00D08D F9                MOV      R1,A
B1:00D08E E4                CLR      A
B1:00D08F 3A                ADDC     A,R2
B1:00D090 FA                MOV      R2,A
B1:00D091 C003              PUSH     AR3
B1:00D093 C002              PUSH     AR2
B1:00D095 C001              PUSH     AR1
B1:00D097 9040BE            MOV      DPTR,#rtmp
B1:00D09A E0                MOVX     A,@DPTR
B1:00D09B 75F004            MOV      B,#04H
B1:00D09E A4                MUL      AB
B1:00D09F 243D              ADD      A,#LOW responseRouteRepeaterList-04H
B1:00D0A1 F9                MOV      R1,A
B1:00D0A2 7412              MOV      A,#HIGH responseRouteRepeaterList-04H
B1:00D0A4 35F0              ADDC     A,B
B1:00D0A6 FA                MOV      R2,A
B1:00D0A7 7B01              MOV      R3,#01H
B1:00D0A9 126149            LCALL    ?L?COM0047
B1:00D0AC 9040BF            MOV      DPTR,#repeaterCount
B1:00D0AF E0                MOVX     A,@DPTR
B1:00D0B0 FF                MOV      R7,A
B1:00D0B1 D001              POP      AR1
B1:00D0B3 D002              POP      AR2
B1:00D0B5 D003              POP      AR3
B1:00D0B7 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00D0BA 9040BF            MOV      DPTR,#repeaterCount
B1:00D0BD E0                MOVX     A,@DPTR
B1:00D0BE C4                SWAP     A
B1:00D0BF 54F0              ANL      A,#0F0H
B1:00D0C1 312B              ACALL    ?L?COM040E
B1:00D0C3 E9                MOV      A,R1
B1:00D0C4 24BC              ADD      A,#0BCH
B1:00D0C6 1287E0            LCALL    ?L?COM002E
B1:00D0C9 9040BE            MOV      DPTR,#rtmp
B1:00D0CC E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 378


B1:00D0CD 14                DEC      A
B1:00D0CE 314C              ACALL    ?L?COM0381
B1:00D0D0 8005              SJMP     ?C0081?ZW_ROUTING_ALL
B1:00D0D2         ?C0080?ZW_ROUTING_ALL:
B1:00D0D2 C3                CLR      C
B1:00D0D3 33                RLC      A
B1:00D0D4 CE                XCH      A,R6
B1:00D0D5 33                RLC      A
B1:00D0D6 CE                XCH      A,R6
B1:00D0D7         ?C0081?ZW_ROUTING_ALL:
B1:00D0D7 D8F9              DJNZ     R0,?C0080?ZW_ROUTING_ALL
B1:00D0D9 FF                MOV      R7,A
B1:00D0DA 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00D0DD E0                MOVX     A,@DPTR
B1:00D0DE FD                MOV      R5,A
B1:00D0DF EF                MOV      A,R7
B1:00D0E0 5D                ANL      A,R5
B1:00D0E1 6038              JZ       ?C0019?ZW_ROUTING_ALL
B1:00D0E3 9040BB            MOV      DPTR,#pFrame
B1:00D0E6 128FD5            LCALL    ?L?COM0057
B1:00D0E9 128622            LCALL    ?L?COM0006
B1:00D0EC 4404              ORL      A,#04H
B1:00D0EE 122072            LCALL    ?C?CSTPTR
B1:00D0F1 9040BE            MOV      DPTR,#rtmp
B1:00D0F4 E0                MOVX     A,@DPTR
B1:00D0F5 FF                MOV      R7,A
B1:00D0F6 243A              ADD      A,#LOW responseRouteSpeedNumHops-01H
B1:00D0F8 3135              ACALL    ?L?COM03CE
B1:00D0FA 548F              ANL      A,#08FH
B1:00D0FC F0                MOVX     @DPTR,A
B1:00D0FD 3132              ACALL    ?L?COM03CD
B1:00D0FF 4430              ORL      A,#030H
B1:00D101 F0                MOVX     @DPTR,A
B1:00D102 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00D105 E0                MOVX     A,@DPTR
B1:00D106 FF                MOV      R7,A
B1:00D107 9040BE            MOV      DPTR,#rtmp
B1:00D10A E0                MOVX     A,@DPTR
B1:00D10B 14                DEC      A
B1:00D10C 12C72D            LCALL    ?L?COM01EE
B1:00D10F 8002              SJMP     ?C0083?ZW_ROUTING_ALL
B1:00D111         ?C0082?ZW_ROUTING_ALL:
B1:00D111 C3                CLR      C
B1:00D112 33                RLC      A
B1:00D113         ?C0083?ZW_ROUTING_ALL:
B1:00D113 D8FC              DJNZ     R0,?C0082?ZW_ROUTING_ALL
B1:00D115 F4                CPL      A
B1:00D116 5F                ANL      A,R7
B1:00D117 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00D11A F0                MOVX     @DPTR,A
B1:00D11B         ?C0019?ZW_ROUTING_ALL:
B1:00D11B 7F01              MOV      R7,#01H
B1:00D11D 22                RET      
B1:00D11E         ?C0015?ZW_ROUTING_ALL:
B1:00D11E 9040BE            MOV      DPTR,#rtmp
B1:00D121 E0                MOVX     A,@DPTR
B1:00D122 14                DEC      A
B1:00D123 F0                MOVX     @DPTR,A
B1:00D124 6002              JZ       $ + 4H
B1:00D126 0132              AJMP     ?C0017?ZW_ROUTING_ALL
B1:00D128         ?C0014?ZW_ROUTING_ALL:
B1:00D128 7F00              MOV      R7,#00H
B1:00D12A 22                RET      
----- FUNCTION _GetResponseRoute (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 379



----- FUNCTION ?L?COM040E (BEGIN) -----
B1:00D12B FF                MOV      R7,A
B1:00D12C         ?L?COM040F:
B1:00D12C 9040BB            MOV      DPTR,#pFrame
B1:00D12F 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM040E (END) -------


----- FUNCTION ?L?COM03CD (BEGIN) -----
B1:00D132 743A              MOV      A,#LOW responseRouteSpeedNumHops-01H
B1:00D134 2F                ADD      A,R7
B1:00D135         ?L?COM03CE:
B1:00D135 F582              MOV      DPL,A
B1:00D137 E4                CLR      A
B1:00D138 3412              ADDC     A,#HIGH responseRouteSpeedNumHops-01H
B1:00D13A F583              MOV      DPH,A
B1:00D13C E0                MOVX     A,@DPTR
B1:00D13D 22                RET      
----- FUNCTION ?L?COM03CD (END) -------


----- FUNCTION _GetTransmitSpeedOptions (BEGIN) -----
;---- Variable 'pFrame' assigned to Register 'R1/R2/R3' ----
B1:00D13E 128862            LCALL    ?L?COM0010
B1:00D141 0272B9            LJMP     ?L?COM0455
----- FUNCTION _GetTransmitSpeedOptions (END) -------


----- FUNCTION ?L?COM04B7 (BEGIN) -----
B1:00D144 F582              MOV      DPL,A
B1:00D146 E4                CLR      A
B1:00D147 3412              ADDC     A,#HIGH responseRouteNodeID-01H
B1:00D149 F583              MOV      DPH,A
B1:00D14B 22                RET      
----- FUNCTION ?L?COM04B7 (END) -------


----- FUNCTION ?L?COM0381 (BEGIN) -----
B1:00D14C FF                MOV      R7,A
B1:00D14D 7401              MOV      A,#01H
B1:00D14F 7E00              MOV      R6,#00H
B1:00D151 A807              MOV      R0,AR7
B1:00D153 08                INC      R0
B1:00D154 22                RET      
----- FUNCTION ?L?COM0381 (END) -------


----- FUNCTION ResetRoutedResponseRoutes (BEGIN) -----
;---- Variable 'rtmp' assigned to Register 'R7' ----
B1:00D155 7F02              MOV      R7,#02H
B1:00D157 E4                CLR      A
B1:00D158 901216            MOV      DPTR,#responseRouteCount
B1:00D15B F0                MOVX     @DPTR,A
B1:00D15C         ?C0012?ZW_ROUTING_ALL:
B1:00D15C 741D              MOV      A,#LOW responseRouteNodeID-01H
B1:00D15E 2F                ADD      A,R7
B1:00D15F 3144              ACALL    ?L?COM04B7
B1:00D161 E4                CLR      A
B1:00D162 F0                MOVX     @DPTR,A
B1:00D163 DFF7              DJNZ     R7,?C0012?ZW_ROUTING_ALL
B1:00D165 22                RET      
----- FUNCTION ResetRoutedResponseRoutes (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 380


----- FUNCTION ZW_SetDefault (BEGIN) -----
B1:00D166 7F01              MOV      R7,#01H
B1:00D168 12EB3B            LCALL    _SlaveInit
B1:00D16B E4                CLR      A
B1:00D16C FF                MOV      R7,A
B1:00D16D FE                MOV      R6,A
B1:00D16E FD                MOV      R5,A
B1:00D16F FC                MOV      R4,A
B1:00D170 901223            MOV      DPTR,#homeID
B1:00D173 1224F1            LCALL    ?C?LSTXDATA
B1:00D176 7B01              MOV      R3,#01H
B1:00D178 7A12              MOV      R2,#HIGH homeID
B1:00D17A 7923              MOV      R1,#LOW homeID
B1:00D17C E4                CLR      A
B1:00D17D FD                MOV      R5,A
B1:00D17E 121B74            LCALL    ?INTERBANK_TABLE?_MemoryPutID
B1:00D181 3155              ACALL    ResetRoutedResponseRoutes
B1:00D183 7E00              MOV      R6,#HIGH NVM_HOMEID_far
B1:00D185 7F04              MOV      R7,#LOW NVM_HOMEID_far
B1:00D187 C006              PUSH     AR6
B1:00D189 C3                CLR      C
B1:00D18A 7411              MOV      A,#LOW _FD_ZW_NVM_L_
B1:00D18C 9404              SUBB     A,#LOW NVM_HOMEID_far
B1:00D18E FE                MOV      R6,A
B1:00D18F 7412              MOV      A,#HIGH _FD_ZW_NVM_L_
B1:00D191 127067            LCALL    ?L?COM00DF
B1:00D194 D006              POP      AR6
B1:00D196 123FE9            LCALL    ?L?COM0622
B1:00D199 E4                CLR      A
B1:00D19A FF                MOV      R7,A
B1:00D19B FE                MOV      R6,A
B1:00D19C 12BD29            LCALL    _CinitNVMvariables
B1:00D19F 12C734            LCALL    SlaveInitDone
B1:00D1A2 12D936            LCALL    TxQueueInit
B1:00D1A5 511B              ACALL    security_reset
B1:00D1A7 127142            LCALL    ?L?COM02C1
B1:00D1AA 7923              MOV      R1,#LOW homeID
B1:00D1AC 121B6F            LCALL    ?INTERBANK_TABLE?_MemoryGetID
B1:00D1AF 7F01              MOV      R7,#01H
B1:00D1B1 12E9A4            LCALL    _ZW_EnableRoutedRssiFeedback
B1:00D1B4 021C00            LJMP     ?INTERBANK_TABLE?NoiseDetectSetDefault
----- FUNCTION ZW_SetDefault (END) -------


----- FUNCTION ?L?COM0562 (BEGIN) -----
B1:00D1B7 7B01              MOV      R3,#01H
B1:00D1B9 7A2B              MOV      R2,#HIGH nodeInfoFrame+02H
B1:00D1BB 7952              MOV      R1,#LOW nodeInfoFrame+02H
----- FUNCTION _ZW_GetNodeTypeBasic (BEGIN) -----
B1:00D1BD 904288            MOV      DPTR,#nodeInfo
B1:00D1C0 1225A9            LCALL    ?C?PSTXDATA
B1:00D1C3 904288            MOV      DPTR,#nodeInfo
B1:00D1C6 122589            LCALL    ?C?PLDXDATA
B1:00D1C9 E9                MOV      A,R1
B1:00D1CA 2401              ADD      A,#01H
B1:00D1CC 128622            LCALL    ?L?COM0006
B1:00D1CF FF                MOV      R7,A
B1:00D1D0 30E11F            JNB      ACC.1,?C0151?ZW_SLAVE
B1:00D1D3 904288            MOV      DPTR,#nodeInfo
B1:00D1D6 12975B            LCALL    ?L?COM006B
B1:00D1D9 30E708            JNB      ACC.7,?C0152?ZW_SLAVE
B1:00D1DC E9                MOV      A,R1
B1:00D1DD 2403              ADD      A,#03H
B1:00D1DF 127344            LCALL    ?L?COM04EF
B1:00D1E2 8029              SJMP     ?C0315?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 381


B1:00D1E4         ?C0152?ZW_SLAVE:
B1:00D1E4 904288            MOV      DPTR,#nodeInfo
B1:00D1E7 128FD5            LCALL    ?L?COM0057
B1:00D1EA F9                MOV      R1,A
B1:00D1EB E4                CLR      A
B1:00D1EC 3A                ADDC     A,R2
B1:00D1ED FA                MOV      R2,A
B1:00D1EE 7401              MOV      A,#01H
B1:00D1F0         
B1:00D1F0 801B              SJMP     ?C0315?ZW_SLAVE
B1:00D1F2         ?C0151?ZW_SLAVE:
B1:00D1F2 EF                MOV      A,R7
B1:00D1F3 904288            MOV      DPTR,#nodeInfo
B1:00D1F6 30E30B            JNB      ACC.3,?C0155?ZW_SLAVE
B1:00D1F9 128FD5            LCALL    ?L?COM0057
B1:00D1FC F9                MOV      R1,A
B1:00D1FD E4                CLR      A
B1:00D1FE 3A                ADDC     A,R2
B1:00D1FF FA                MOV      R2,A
B1:00D200 7404              MOV      A,#04H
B1:00D202         
B1:00D202 8009              SJMP     ?C0315?ZW_SLAVE
B1:00D204         ?C0155?ZW_SLAVE:
B1:00D204 128FD5            LCALL    ?L?COM0057
B1:00D207 F9                MOV      R1,A
B1:00D208 E4                CLR      A
B1:00D209 3A                ADDC     A,R2
B1:00D20A FA                MOV      R2,A
B1:00D20B 7403              MOV      A,#03H
B1:00D20D         
B1:00D20D 122072            LCALL    ?C?CSTPTR
B1:00D210         ?C0154?ZW_SLAVE:
B1:00D210 904288            MOV      DPTR,#nodeInfo
B1:00D213 128FD5            LCALL    ?L?COM0057
B1:00D216 128622            LCALL    ?L?COM0006
B1:00D219 FF                MOV      R7,A
B1:00D21A 22                RET      
----- FUNCTION _ZW_GetNodeTypeBasic (END) -------


----- FUNCTION security_reset (BEGIN) -----
B1:00D21B 7FFF              MOV      R7,#0FFH
B1:00D21D 5167              ACALL    _keystore_network_key_clear
B1:00D21F 7E12              MOV      R6,#HIGH span_mpan_table_valid
B1:00D221 7F94              MOV      R7,#LOW span_mpan_table_valid
B1:00D223 E4                CLR      A
B1:00D224 FD                MOV      R5,A
B1:00D225 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B1:;----                  JMP      security_init
----- FUNCTION security_reset (END) -------


----- FUNCTION security_init (BEGIN) -----
B1:00D228 12B264            LCALL    ?L?COM0090
B1:00D22B 121CBE            LCALL    ?INTERBANK_TABLE?_secure_learn_init
B1:00D22E 12B264            LCALL    ?L?COM0090
B1:00D231 121CC3            LCALL    ?INTERBANK_TABLE?_secure_learn_enter
B1:00D234 121C69            LCALL    ?INTERBANK_TABLE?sec0_init
B1:00D237 12B264            LCALL    ?L?COM0090
B1:00D23A E4                CLR      A
B1:00D23B 5004              JNC      ?C0006?ZW_SECURE_LEARN_SUPPORT
B1:00D23D 7F01              MOV      R7,#01H
B1:00D23F 8001              SJMP     ?C0087?ZW_SECURE_LEARN_SUPPORT
B1:00D241         ?C0006?ZW_SECURE_LEARN_SUPPORT:
B1:00D241 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 382


B1:00D242         
B1:00D242 FE                MOV      R6,A
B1:00D243 FD                MOV      R5,A
B1:00D244 FC                MOV      R4,A
B1:00D245 121D1D            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_net_scheme
B1:00D248         ?C0007?ZW_SECURE_LEARN_SUPPORT:
B1:00D248 121C7D            LCALL    ?INTERBANK_TABLE?sec2_init
B1:00D24B 12B264            LCALL    ?L?COM0090
B1:00D24E E4                CLR      A
B1:00D24F FD                MOV      R5,A
B1:00D250 121D04            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_isController
B1:00D253 121E17            LCALL    ?INTERBANK_TABLE?ApplicationSecureKeysRequested
B1:00D256 AB07              MOV      R3,AR7
B1:00D258 7D01              MOV      R5,#01H
B1:00D25A 7F02              MOV      R7,#02H
B1:00D25C 021D6D            LJMP     ?INTERBANK_TABLE?_s2_inclusion_init
----- FUNCTION security_init (END) -------


----- FUNCTION ?L?COM05E3 (BEGIN) -----
B1:00D25F 24B9              ADD      A,#0B9H
B1:00D261 F9                MOV      R1,A
B1:00D262 E4                CLR      A
B1:00D263 3A                ADDC     A,R2
B1:00D264 FA                MOV      R2,A
B1:00D265 EF                MOV      A,R7
B1:00D266 22                RET      
----- FUNCTION ?L?COM05E3 (END) -------


----- FUNCTION _keystore_network_key_clear (BEGIN) -----
B1:00D267 904382            MOV      DPTR,#keyclass
B1:00D26A EF                MOV      A,R7
B1:00D26B F0                MOVX     @DPTR,A
B1:00D26C F4                CPL      A
B1:00D26D 701E              JNZ      ?C0024?ZW_KEYSTORE
B1:00D26F FB                MOV      R3,A
B1:00D270 FA                MOV      R2,A
B1:00D271 F9                MOV      R1,A
B1:00D272 7F01              MOV      R7,#01H
B1:00D274 51B3              ACALL    _keystore_network_key_write
B1:00D276 127070            LCALL    ?L?COM00E1
B1:00D279 7F02              MOV      R7,#02H
B1:00D27B 51B3              ACALL    _keystore_network_key_write
B1:00D27D 127070            LCALL    ?L?COM00E1
B1:00D280 7F04              MOV      R7,#04H
B1:00D282 51B3              ACALL    _keystore_network_key_write
B1:00D284 127070            LCALL    ?L?COM00E1
B1:00D287 7F80              MOV      R7,#080H
B1:00D289 51B3              ACALL    _keystore_network_key_write
B1:00D28B 800F              SJMP     ?C0025?ZW_KEYSTORE
B1:00D28D         ?C0024?ZW_KEYSTORE:
B1:00D28D 904382            MOV      DPTR,#keyclass
B1:00D290 E0                MOVX     A,@DPTR
B1:00D291 FF                MOV      R7,A
B1:00D292 127070            LCALL    ?L?COM00E1
B1:00D295 51B3              ACALL    _keystore_network_key_write
B1:00D297 EF                MOV      A,R7
B1:00D298 7002              JNZ      ?C0025?ZW_KEYSTORE
B1:00D29A FF                MOV      R7,A
B1:00D29B 22                RET      
B1:00D29C         ?C0025?ZW_KEYSTORE:
B1:00D29C 7131              ACALL    ?L?COM033E
B1:00D29E 904382            MOV      DPTR,#keyclass
B1:00D2A1 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 383


B1:00D2A2 F4                CPL      A
B1:00D2A3 5F                ANL      A,R7
B1:;----                  JMP      ?L?COM03FB
----- FUNCTION _keystore_network_key_clear (END) -------


----- FUNCTION ?L?COM03FB (BEGIN) -----
B1:00D2A4 90344D            MOV      DPTR,#assignedSec_keys
B1:00D2A7 F0                MOVX     @DPTR,A
B1:00D2A8 FD                MOV      R5,A
B1:00D2A9 7E12              MOV      R6,#HIGH keyclasses_assigned
B1:00D2AB 7F13              MOV      R7,#LOW keyclasses_assigned
B1:00D2AD 123FC4            LCALL    _NVM_ext_write_byte
B1:00D2B0 7F01              MOV      R7,#01H
B1:00D2B2 22                RET      
----- FUNCTION ?L?COM03FB (END) -------


----- FUNCTION _keystore_network_key_write (BEGIN) -----
B1:00D2B3 9042A9            MOV      DPTR,#keybuf
B1:00D2B6 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'key_class' assigned to Register 'R7' ----
B1:00D2B9 9042A9            MOV      DPTR,#keybuf
B1:00D2BC 122589            LCALL    ?C?PLDXDATA
B1:00D2BF 903F58            MOV      DPTR,#?_keystore_network_key_write_impl?BYTE+04H
B1:00D2C2 1225A9            LCALL    ?C?PSTXDATA
B1:00D2C5 F1AF              ACALL    ?L?COM044C
B1:;----                  JMP      _keystore_network_key_write_impl
----- FUNCTION _keystore_network_key_write (END) -------


----- FUNCTION _keystore_network_key_write_impl (BEGIN) -----
B1:00D2C7 903F54            MOV      DPTR,#key_class
B1:00D2CA 127088            LCALL    ?L?COM00F4
B1:00D2CD 903F54            MOV      DPTR,#key_class
B1:00D2D0 E0                MOVX     A,@DPTR
B1:00D2D1 FF                MOV      R7,A
B1:00D2D2 14                DEC      A
B1:00D2D3 FE                MOV      R6,A
B1:00D2D4 EF                MOV      A,R7
B1:00D2D5 5E                ANL      A,R6
B1:00D2D6 7006              JNZ      ?C0016?ZW_KEYSTORE
B1:00D2D8 E0                MOVX     A,@DPTR
B1:00D2D9 FD                MOV      R5,A
B1:00D2DA 5487              ANL      A,#087H
B1:00D2DC 7003              JNZ      ?C0015?ZW_KEYSTORE
B1:00D2DE         ?C0016?ZW_KEYSTORE:
B1:00D2DE 7F00              MOV      R7,#00H
B1:00D2E0 22                RET      
B1:00D2E1         ?C0015?ZW_KEYSTORE:
B1:00D2E1 EE                MOV      A,R6
B1:00D2E2 C4                SWAP     A
B1:00D2E3 13                RRC      A
B1:00D2E4 5407              ANL      A,#07H
B1:00D2E6 FF                MOV      R7,A
B1:00D2E7 ED                MOV      A,R5
B1:00D2E8 C3                CLR      C
B1:00D2E9 13                RRC      A
B1:00D2EA 4F                ORL      A,R7
B1:00D2EB 5403              ANL      A,#03H
B1:00D2ED 903F5B            MOV      DPTR,#key_index
B1:00D2F0 F0                MOVX     @DPTR,A
B1:00D2F1 711C              ACALL    ?L?COM05AE
B1:00D2F3 6004              JZ       ?C0018?ZW_KEYSTORE
B1:00D2F5 7125              ACALL    ?L?COM01E9
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 384


B1:00D2F7 F140              ACALL    ?L?COM0449
B1:00D2F9         ?C0018?ZW_KEYSTORE:
B1:00D2F9 903F5B            MOV      DPTR,#key_index
B1:00D2FC E0                MOVX     A,@DPTR
B1:00D2FD 903F58            MOV      DPTR,#keybuf
B1:00D300 12FD67            LCALL    ?L?COM02F9
B1:00D303 904057            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B1:00D306 F104              ACALL    ?L?COM00EA
B1:00D308 121B88            LCALL    ?INTERBANK_TABLE?_ZW_MemoryPutBuffer
B1:00D30B 711C              ACALL    ?L?COM05AE
B1:00D30D 6004              JZ       ?C0019?ZW_KEYSTORE
B1:00D30F 7125              ACALL    ?L?COM01E9
B1:00D311 F140              ACALL    ?L?COM0449
B1:00D313         ?C0019?ZW_KEYSTORE:
B1:00D313 7131              ACALL    ?L?COM033E
B1:00D315 903F54            MOV      DPTR,#key_class
B1:00D318 E0                MOVX     A,@DPTR
B1:00D319 4F                ORL      A,R7
B1:00D31A 8088              SJMP     ?L?COM03FB
----- FUNCTION _keystore_network_key_write_impl (END) -------


----- FUNCTION ?L?COM05AE (BEGIN) -----
B1:00D31C 903F58            MOV      DPTR,#keybuf
B1:00D31F 122589            LCALL    ?C?PLDXDATA
B1:00D322 E9                MOV      A,R1
B1:00D323 4A                ORL      A,R2
B1:00D324 22                RET      
----- FUNCTION ?L?COM05AE (END) -------


----- FUNCTION ?L?COM01E9 (BEGIN) -----
B1:00D325 903F58            MOV      DPTR,#keybuf
B1:00D328         ?L?COM01EA:
B1:00D328 122589            LCALL    ?C?PLDXDATA
B1:00D32B         ?L?COM01EB:
B1:00D32B 90404E            MOV      DPTR,#?_ZW_s2_key_scrambler_descramble?BYTE+03H
B1:00D32E 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01E9 (END) -------


----- FUNCTION ?L?COM033E (BEGIN) -----
B1:00D331 7E12              MOV      R6,#HIGH keyclasses_assigned
B1:00D333 7F13              MOV      R7,#LOW keyclasses_assigned
B1:00D335 123964            LCALL    _NVM_ext_read_byte
B1:00D338 90344D            MOV      DPTR,#assignedSec_keys
B1:00D33B EF                MOV      A,R7
B1:00D33C F0                MOVX     @DPTR,A
B1:00D33D 22                RET      
----- FUNCTION ?L?COM033E (END) -------


----- FUNCTION ?L?COM05E4 (BEGIN) -----
B1:00D33E 24B9              ADD      A,#0B9H
B1:00D340 F9                MOV      R1,A
B1:00D341 E4                CLR      A
B1:00D342 3A                ADDC     A,R2
B1:00D343 FA                MOV      R2,A
B1:00D344 EE                MOV      A,R6
B1:00D345 22                RET      
----- FUNCTION ?L?COM05E4 (END) -------


----- FUNCTION _keystore_private_key_write (BEGIN) -----
B1:00D346 9042A3            MOV      DPTR,#buf
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 385


B1:00D349 1225A9            LCALL    ?C?PSTXDATA
B1:00D34C 9042A3            MOV      DPTR,#buf
B1:00D34F 7128              ACALL    ?L?COM01EA
B1:00D351 F1AF              ACALL    ?L?COM044C
B1:00D353 F146              ACALL    _ZW_s2_key_scrambler_descramble
B1:00D355 9042A3            MOV      DPTR,#buf
B1:00D358 7180              ACALL    ?L?COM008E
B1:00D35A FA                MOV      R2,A
B1:00D35B 712B              ACALL    ?L?COM01EB
B1:00D35D 7BFF              MOV      R3,#0FFH
B1:00D35F 7A40              MOV      R2,#040H
B1:00D361 790C              MOV      R1,#0CH
B1:00D363 F146              ACALL    _ZW_s2_key_scrambler_descramble
B1:00D365 9042A3            MOV      DPTR,#buf
B1:00D368 12E786            LCALL    ?L?COM04C5
B1:00D36B 904057            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B1:00D36E 12DEC2            LCALL    ?L?COM00F7
B1:00D371 021B88            LJMP     ?INTERBANK_TABLE?_ZW_MemoryPutBuffer
----- FUNCTION _keystore_private_key_write (END) -------


----- FUNCTION ?L?COM05BB (BEGIN) -----
B1:00D374 900AF6            MOV      DPTR,#timeOut
B1:00D377 E0                MOVX     A,@DPTR
B1:00D378 FC                MOV      R4,A
B1:00D379 A3                INC      DPTR
B1:00D37A E0                MOVX     A,@DPTR
B1:00D37B FD                MOV      R5,A
B1:00D37C 22                RET      
----- FUNCTION ?L?COM05BB (END) -------


----- FUNCTION ?L?COM008D (BEGIN) -----
B1:00D37D 9039CA            MOV      DPTR,#blocks
B1:00D380         ?L?COM008E:
B1:00D380 122589            LCALL    ?C?PLDXDATA
B1:00D383 E9                MOV      A,R1
B1:00D384 2410              ADD      A,#010H
B1:00D386 F9                MOV      R1,A
B1:00D387 E4                CLR      A
B1:00D388 3A                ADDC     A,R2
B1:00D389 22                RET      
----- FUNCTION ?L?COM008D (END) -------


----- FUNCTION _format_aad (BEGIN) -----
B1:00D38A 9039CA            MOV      DPTR,#blocks
B1:00D38D 1225A9            LCALL    ?C?PSTXDATA
B1:00D390 E4                CLR      A
B1:00D391 9039DB            MOV      DPTR,#new_aad_len
B1:00D394 1273D9            LCALL    ?L?COM05D4
B1:00D397 9039E1            MOV      DPTR,#aad_start
B1:00D39A F0                MOVX     @DPTR,A
B1:00D39B A3                INC      DPTR
B1:00D39C 7402              MOV      A,#02H
B1:00D39E F0                MOVX     @DPTR,A
B1:00D39F F19F              ACALL    ?L?COM01C3
B1:00D3A1 5015              JNC      ?C0014?CCM
B1:00D3A3 12FCE8            LCALL    ?L?COM023D
B1:00D3A6 E4                CLR      A
B1:00D3A7 122084            LCALL    ?C?CSTOPTR
B1:00D3AA B19E              ACALL    ?L?COM0472
B1:00D3AC 900011            MOV      DPTR,#011H
B1:00D3AF EF                MOV      A,R7
B1:00D3B0 12FD33            LCALL    ?L?COM055E
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 386


B1:00D3B3 740E              MOV      A,#0EH
B1:00D3B5 F0                MOVX     @DPTR,A
B1:00D3B6 8048              SJMP     ?C0015?CCM
B1:00D3B8         ?C0014?CCM:
B1:00D3B8 F19F              ACALL    ?L?COM01C3
B1:00D3BA 4040              JC       ?C0016?CCM
B1:00D3BC 74FF              MOV      A,#0FFH
B1:00D3BE FF                MOV      R7,A
B1:00D3BF FE                MOV      R6,A
B1:00D3C0 F1BC              ACALL    ?L?COM0367
B1:00D3C2 D3                SETB     C
B1:00D3C3 1223D4            LCALL    ?C?ULCMP
B1:00D3C6 5034              JNC      ?C0016?CCM
B1:00D3C8 12FCE8            LCALL    ?L?COM023D
B1:00D3CB 74FF              MOV      A,#0FFH
B1:00D3CD 122084            LCALL    ?C?CSTOPTR
B1:00D3D0 900011            MOV      DPTR,#011H
B1:00D3D3 74FE              MOV      A,#0FEH
B1:00D3D5 122084            LCALL    ?C?CSTOPTR
B1:00D3D8 900012            MOV      DPTR,#012H
B1:00D3DB E4                CLR      A
B1:00D3DC 122084            LCALL    ?C?CSTOPTR
B1:00D3DF 127223            LCALL    ?L?COM03EF
B1:00D3E2 900014            MOV      DPTR,#014H
B1:00D3E5 E4                CLR      A
B1:00D3E6 122084            LCALL    ?C?CSTOPTR
B1:00D3E9 900015            MOV      DPTR,#015H
B1:00D3EC E4                CLR      A
B1:00D3ED 12FD33            LCALL    ?L?COM055E
B1:00D3F0 740A              MOV      A,#0AH
B1:00D3F2 F0                MOVX     @DPTR,A
B1:00D3F3 A3                INC      DPTR
B1:00D3F4 E4                CLR      A
B1:00D3F5 F0                MOVX     @DPTR,A
B1:00D3F6 A3                INC      DPTR
B1:00D3F7 7406              MOV      A,#06H
B1:00D3F9 F0                MOVX     @DPTR,A
B1:00D3FA 8004              SJMP     ?C0015?CCM
B1:00D3FC         ?C0016?CCM:
B1:00D3FC E4                CLR      A
B1:00D3FD FE                MOV      R6,A
B1:00D3FE FF                MOV      R7,A
B1:00D3FF 22                RET      
B1:00D400         ?C0015?CCM:
B1:00D400 9039DF            MOV      DPTR,#aad_bytes_in_first_block
B1:00D403 E0                MOVX     A,@DPTR
B1:00D404 FE                MOV      R6,A
B1:00D405 A3                INC      DPTR
B1:00D406 E0                MOVX     A,@DPTR
B1:00D407 FF                MOV      R7,A
B1:00D408 717D              ACALL    ?L?COM008D
B1:00D40A FA                MOV      R2,A
B1:00D40B 9039E1            MOV      DPTR,#aad_start
B1:00D40E E0                MOVX     A,@DPTR
B1:00D40F FC                MOV      R4,A
B1:00D410 A3                INC      DPTR
B1:00D411 E0                MOVX     A,@DPTR
B1:00D412 9039CD            MOV      DPTR,#aad
B1:00D415 1270F1            LCALL    ?L?COM0232
B1:00D418 12FD1F            LCALL    ?L?COM0374
B1:00D41B 33                RLC      A
B1:00D41C 95E0              SUBB     A,ACC
B1:00D41E F1A3              ACALL    ?L?COM01C4
B1:00D420 5030              JNC      ?C0019?CCM
B1:00D422 B19E              ACALL    ?L?COM0472
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 387


B1:00D424 C3                CLR      C
B1:00D425 9039E0            MOV      DPTR,#aad_bytes_in_first_block+01H
B1:00D428 E0                MOVX     A,@DPTR
B1:00D429 9F                SUBB     A,R7
B1:00D42A FF                MOV      R7,A
B1:00D42B 9039DF            MOV      DPTR,#aad_bytes_in_first_block
B1:00D42E E0                MOVX     A,@DPTR
B1:00D42F 9E                SUBB     A,R6
B1:00D430 FE                MOV      R6,A
B1:00D431 C006              PUSH     AR6
B1:00D433 C007              PUSH     AR7
B1:00D435 7F00              MOV      R7,#00H
B1:00D437 C007              PUSH     AR7
B1:00D439 717D              ACALL    ?L?COM008D
B1:00D43B FA                MOV      R2,A
B1:00D43C 9039E1            MOV      DPTR,#aad_start
B1:00D43F 127138            LCALL    ?L?COM02A0
B1:00D442 B19E              ACALL    ?L?COM0472
B1:00D444 1271F1            LCALL    ?L?COM0383
B1:00D447 EB                MOV      A,R3
B1:00D448 3D                ADDC     A,R5
B1:00D449 FB                MOV      R3,A
B1:00D44A D005              POP      AR5
B1:00D44C D007              POP      AR7
B1:00D44E D006              POP      AR6
B1:00D450 A12E              AJMP     ?C0061?CCM
B1:00D452         ?C0019?CCM:
B1:00D452 12FD1F            LCALL    ?L?COM0374
B1:00D455 33                RLC      A
B1:00D456 95E0              SUBB     A,ACC
B1:00D458 F1BC              ACALL    ?L?COM0367
B1:00D45A D3                SETB     C
B1:00D45B 1223D4            LCALL    ?C?ULCMP
B1:00D45E 5002              JNC      $ + 4H
B1:00D460 A17B              AJMP     ?C0021?CCM
B1:00D462 717D              ACALL    ?L?COM008D
B1:00D464 FA                MOV      R2,A
B1:00D465 C003              PUSH     AR3
B1:00D467 C002              PUSH     AR2
B1:00D469 C001              PUSH     AR1
B1:00D46B 9039CA            MOV      DPTR,#blocks
B1:00D46E D1F8              ACALL    ?L?COM00E9
B1:00D470 D001              POP      AR1
B1:00D472 D002              POP      AR2
B1:00D474 D003              POP      AR3
B1:00D476 D1E7              ACALL    ?L?COM0178
B1:00D478 9039CA            MOV      DPTR,#blocks
B1:00D47B F116              ACALL    ?L?COM0471
B1:00D47D B19E              ACALL    ?L?COM0472
B1:00D47F 9039DF            MOV      DPTR,#aad_bytes_in_first_block
B1:00D482 E0                MOVX     A,@DPTR
B1:00D483 FC                MOV      R4,A
B1:00D484 A3                INC      DPTR
B1:00D485 12F870            LCALL    ?L?COM01DD
B1:00D488 9C                SUBB     A,R4
B1:00D489 9039DB            MOV      DPTR,#new_aad_len
B1:00D48C F0                MOVX     @DPTR,A
B1:00D48D A3                INC      DPTR
B1:00D48E EF                MOV      A,R7
B1:00D48F F0                MOVX     @DPTR,A
B1:00D490 12FD59            LCALL    ?L?COM0435
B1:00D493 AE02              MOV      R6,AR2
B1:00D495 12210D            LCALL    ?C?SIDIV
B1:00D498 A3                INC      DPTR
B1:00D499 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 388


B1:00D49A F0                MOVX     @DPTR,A
B1:00D49B A3                INC      DPTR
B1:00D49C EF                MOV      A,R7
B1:00D49D F0                MOVX     @DPTR,A
B1:00D49E 12FD4E            LCALL    ?L?COM030C
B1:00D4A1 ED                MOV      A,R5
B1:00D4A2 4C                ORL      A,R4
B1:00D4A3 6006              JZ       ?C0022?CCM
B1:00D4A5 9039DD            MOV      DPTR,#no_of_blocks_for_aad
B1:00D4A8 123F7F            LCALL    ?L?COM0081
B1:00D4AB         ?C0022?CCM:
B1:00D4AB 9039DF            MOV      DPTR,#aad_bytes_in_first_block
B1:00D4AE E0                MOVX     A,@DPTR
B1:00D4AF FF                MOV      R7,A
B1:00D4B0 A3                INC      DPTR
B1:00D4B1 E0                MOVX     A,@DPTR
B1:00D4B2 9039D9            MOV      DPTR,#offset
B1:00D4B5 1247BD            LCALL    ?L?COM055C
B1:00D4B8 9039D7            MOV      DPTR,#i
B1:00D4BB F0                MOVX     @DPTR,A
B1:00D4BC A3                INC      DPTR
B1:00D4BD F0                MOVX     @DPTR,A
B1:00D4BE         ?C0023?CCM:
B1:00D4BE 9039DD            MOV      DPTR,#no_of_blocks_for_aad
B1:00D4C1 E0                MOVX     A,@DPTR
B1:00D4C2 FE                MOV      R6,A
B1:00D4C3 A3                INC      DPTR
B1:00D4C4 E0                MOVX     A,@DPTR
B1:00D4C5 9039D7            MOV      DPTR,#i
B1:00D4C8 12FD3D            LCALL    ?L?COM03CB
B1:00D4CB 4002              JC       $ + 4H
B1:00D4CD A199              AJMP     ?C0020?CCM
B1:00D4CF F1DE              ACALL    ?L?COM044D
B1:00D4D1 ED                MOV      A,R5
B1:00D4D2 6F                XRL      A,R7
B1:00D4D3 7002              JNZ      ?C0055?CCM
B1:00D4D5 EC                MOV      A,R4
B1:00D4D6 6E                XRL      A,R6
B1:00D4D7         ?C0055?CCM:
B1:00D4D7 705A              JNZ      ?C0026?CCM
B1:00D4D9 12FD59            LCALL    ?L?COM0435
B1:00D4DC AE02              MOV      R6,AR2
B1:00D4DE 12210D            LCALL    ?C?SIDIV
B1:00D4E1 ED                MOV      A,R5
B1:00D4E2 4C                ORL      A,R4
B1:00D4E3 604E              JZ       ?C0026?CCM
B1:00D4E5 12FD4E            LCALL    ?L?COM030C
B1:00D4E8 AE04              MOV      R6,AR4
B1:00D4EA AF05              MOV      R7,AR5
B1:00D4EC 12FD29            LCALL    ?L?COM055D
B1:00D4EF F1D5              ACALL    ?L?COM02F8
B1:00D4F1 FA                MOV      R2,A
B1:00D4F2 C003              PUSH     AR3
B1:00D4F4 C002              PUSH     AR2
B1:00D4F6 C001              PUSH     AR1
B1:00D4F8 717D              ACALL    ?L?COM008D
B1:00D4FA A801              MOV      R0,AR1
B1:00D4FC FC                MOV      R4,A
B1:00D4FD AD03              MOV      R5,AR3
B1:00D4FF D001              POP      AR1
B1:00D501 D002              POP      AR2
B1:00D503 D003              POP      AR3
B1:00D505 121F8D            LCALL    ?C?COPY
B1:00D508 9039DB            MOV      DPTR,#new_aad_len
B1:00D50B 12C7BE            LCALL    ?L?COM0242
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 389


B1:00D50E 7D10              MOV      R5,#010H
B1:00D510 12210D            LCALL    ?C?SIDIV
B1:00D513 C3                CLR      C
B1:00D514 7410              MOV      A,#010H
B1:00D516 9D                SUBB     A,R5
B1:00D517 FF                MOV      R7,A
B1:00D518 E4                CLR      A
B1:00D519 9C                SUBB     A,R4
B1:00D51A FE                MOV      R6,A
B1:00D51B C007              PUSH     AR7
B1:00D51D 7F00              MOV      R7,#00H
B1:00D51F C007              PUSH     AR7
B1:00D521 717D              ACALL    ?L?COM008D
B1:00D523 FA                MOV      R2,A
B1:00D524 E9                MOV      A,R1
B1:00D525 2D                ADD      A,R5
B1:00D526 F9                MOV      R1,A
B1:00D527 EA                MOV      A,R2
B1:00D528 3C                ADDC     A,R4
B1:00D529 FA                MOV      R2,A
B1:00D52A D005              POP      AR5
B1:00D52C D007              POP      AR7
B1:00D52E         
B1:00D52E 122917            LCALL    ?C?MEMSET
B1:00D531 8048              SJMP     ?C0062?CCM
B1:00D533         ?C0026?CCM:
B1:00D533 12FD29            LCALL    ?L?COM055D
B1:00D536 127138            LCALL    ?L?COM02A0
B1:00D539 C003              PUSH     AR3
B1:00D53B C002              PUSH     AR2
B1:00D53D C001              PUSH     AR1
B1:00D53F 717D              ACALL    ?L?COM008D
B1:00D541 A801              MOV      R0,AR1
B1:00D543 FC                MOV      R4,A
B1:00D544 AD03              MOV      R5,AR3
B1:00D546 D001              POP      AR1
B1:00D548 D002              POP      AR2
B1:00D54A D003              POP      AR3
B1:00D54C 12E232            LCALL    ?L?COM0078
B1:00D54F 717D              ACALL    ?L?COM008D
B1:00D551 FA                MOV      R2,A
B1:00D552 C003              PUSH     AR3
B1:00D554 C002              PUSH     AR2
B1:00D556 C001              PUSH     AR1
B1:00D558 9039CA            MOV      DPTR,#blocks
B1:00D55B D1F8              ACALL    ?L?COM00E9
B1:00D55D D001              POP      AR1
B1:00D55F D002              POP      AR2
B1:00D561 D003              POP      AR3
B1:00D563 D1E7              ACALL    ?L?COM0178
B1:00D565 9039CA            MOV      DPTR,#blocks
B1:00D568 122589            LCALL    ?C?PLDXDATA
B1:00D56B F119              ACALL    _ciph_block
B1:00D56D 9039D9            MOV      DPTR,#offset
B1:00D570 127161            LCALL    ?L?COM0301
B1:00D573 9039D7            MOV      DPTR,#i
B1:00D576 123F7F            LCALL    ?L?COM0081
B1:00D579 81BE              AJMP     ?C0023?CCM
B1:00D57B         ?C0021?CCM:
B1:00D57B         
B1:00D57B 717D              ACALL    ?L?COM008D
B1:00D57D FA                MOV      R2,A
B1:00D57E C003              PUSH     AR3
B1:00D580 C002              PUSH     AR2
B1:00D582 C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 390


B1:00D584 9039CA            MOV      DPTR,#blocks
B1:00D587 D1F8              ACALL    ?L?COM00E9
B1:00D589 D001              POP      AR1
B1:00D58B D002              POP      AR2
B1:00D58D D003              POP      AR3
B1:00D58F D1E7              ACALL    ?L?COM0178
B1:00D591 9039CA            MOV      DPTR,#blocks
B1:00D594 122589            LCALL    ?C?PLDXDATA
B1:00D597 F119              ACALL    _ciph_block
B1:00D599         ?C0020?CCM:
B1:00D599 7E00              MOV      R6,#00H
B1:00D59B 7F01              MOV      R7,#01H
B1:00D59D 22                RET      
----- FUNCTION _format_aad (END) -------


----- FUNCTION ?L?COM0472 (BEGIN) -----
B1:00D59E 9039D0            MOV      DPTR,#aad_len
B1:00D5A1 022499            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM0472 (END) -------


----- FUNCTION _bit_xor (BEGIN) -----
B1:00D5A4 903F5C            MOV      DPTR,#block
;---- Variable 'i' assigned to Register 'R6/R7' ----
B1:00D5A7 127373            LCALL    ?L?COM0548
B1:00D5AA         ?C0010?CCM:
B1:00D5AA D3                SETB     C
B1:00D5AB 903F63            MOV      DPTR,#size+01H
B1:00D5AE E0                MOVX     A,@DPTR
B1:00D5AF 9F                SUBB     A,R7
B1:00D5B0 EE                MOV      A,R6
B1:00D5B1 6480              XRL      A,#080H
B1:00D5B3 F8                MOV      R0,A
B1:00D5B4 903F62            MOV      DPTR,#size
B1:00D5B7 E0                MOVX     A,@DPTR
B1:00D5B8 6480              XRL      A,#080H
B1:00D5BA 98                SUBB     A,R0
B1:00D5BB 4023              JC       ?C0013?CCM
B1:00D5BD 903F5F            MOV      DPTR,#next_block
B1:00D5C0 F10E              ACALL    ?L?COM0172
B1:00D5C2 121FF0            LCALL    ?C?CLDOPTR
B1:00D5C5 FD                MOV      R5,A
B1:00D5C6 903F5C            MOV      DPTR,#block
B1:00D5C9 F10E              ACALL    ?L?COM0172
B1:00D5CB 121FF0            LCALL    ?C?CLDOPTR
B1:00D5CE 6D                XRL      A,R5
B1:00D5CF FD                MOV      R5,A
B1:00D5D0 903F5F            MOV      DPTR,#next_block
B1:00D5D3 F10E              ACALL    ?L?COM0172
B1:00D5D5 ED                MOV      A,R5
B1:00D5D6 122084            LCALL    ?C?CSTOPTR
B1:00D5D9 0F                INC      R7
B1:00D5DA BF0001            CJNE     R7,#00H,?C0054?CCM
B1:00D5DD 0E                INC      R6
B1:00D5DE         ?C0054?CCM:
B1:00D5DE 80CA              SJMP     ?C0010?CCM
B1:00D5E0         ?C0013?CCM:
B1:00D5E0 22                RET      
----- FUNCTION _bit_xor (END) -------


----- FUNCTION _format_payload_block (BEGIN) -----
B1:00D5E1 903B6D            MOV      DPTR,#blocks
B1:00D5E4 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 391


B1:00D5E7 903B73            MOV      DPTR,#text_to_encrypt_len
B1:00D5EA 1247B6            LCALL    ?L?COM031C
B1:00D5ED 12733D            LCALL    ?L?COM04ED
B1:00D5F0 FF                MOV      R7,A
B1:00D5F1 ED                MOV      A,R5
B1:00D5F2 C4                SWAP     A
B1:00D5F3 540F              ANL      A,#0FH
B1:00D5F5 48                ORL      A,R0
B1:00D5F6 903B7A            MOV      DPTR,#no_blocks_payload
B1:00D5F9 1247BD            LCALL    ?L?COM055C
B1:00D5FC A3                INC      DPTR
B1:00D5FD F0                MOVX     @DPTR,A
B1:00D5FE A3                INC      DPTR
B1:00D5FF F0                MOVX     @DPTR,A
B1:00D600 ED                MOV      A,R5
B1:00D601 540F              ANL      A,#0FH
B1:00D603 6006              JZ       ?C0028?CCM
B1:00D605 903B7A            MOV      DPTR,#no_blocks_payload
B1:00D608 123F7F            LCALL    ?L?COM0081
B1:00D60B         ?C0028?CCM:
B1:00D60B E4                CLR      A
B1:00D60C 903B78            MOV      DPTR,#i
B1:00D60F F0                MOVX     @DPTR,A
B1:00D610 A3                INC      DPTR
B1:00D611 F0                MOVX     @DPTR,A
B1:00D612         ?C0029?CCM:
B1:00D612 903B7A            MOV      DPTR,#no_blocks_payload
B1:00D615 E0                MOVX     A,@DPTR
B1:00D616 FE                MOV      R6,A
B1:00D617 A3                INC      DPTR
B1:00D618 E0                MOVX     A,@DPTR
B1:00D619 903B78            MOV      DPTR,#i
B1:00D61C 12FD3D            LCALL    ?L?COM03CB
B1:00D61F 4002              JC       $ + 4H
B1:00D621 C1E6              AJMP     ?C0033?CCM
B1:00D623 F1DE              ACALL    ?L?COM044D
B1:00D625 ED                MOV      A,R5
B1:00D626 6F                XRL      A,R7
B1:00D627 7002              JNZ      ?C0056?CCM
B1:00D629 EC                MOV      A,R4
B1:00D62A 6E                XRL      A,R6
B1:00D62B         ?C0056?CCM:
B1:00D62B 706C              JNZ      ?C0032?CCM
B1:00D62D FE                MOV      R6,A
B1:00D62E F1C4              ACALL    ?L?COM061C
B1:00D630 6067              JZ       ?C0032?CCM
B1:00D632 12FCF2            LCALL    ?L?COM055B
B1:00D635 F1D5              ACALL    ?L?COM02F8
B1:00D637 FA                MOV      R2,A
B1:00D638 C003              PUSH     AR3
B1:00D63A C002              PUSH     AR2
B1:00D63C C001              PUSH     AR1
B1:00D63E 903B6D            MOV      DPTR,#blocks
B1:00D641 7180              ACALL    ?L?COM008E
B1:00D643 A801              MOV      R0,AR1
B1:00D645 FC                MOV      R4,A
B1:00D646 AD03              MOV      R5,AR3
B1:00D648 D001              POP      AR1
B1:00D64A D002              POP      AR2
B1:00D64C D003              POP      AR3
B1:00D64E 121F8D            LCALL    ?C?COPY
B1:00D651 F1C4              ACALL    ?L?COM061C
B1:00D653 C3                CLR      C
B1:00D654 7410              MOV      A,#010H
B1:00D656 126ADE            LCALL    ?L?COM04F0
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 392


B1:00D659 7D00              MOV      R5,#00H
B1:00D65B 903B6D            MOV      DPTR,#blocks
B1:00D65E 7180              ACALL    ?L?COM008E
B1:00D660 FA                MOV      R2,A
B1:00D661 903B73            MOV      DPTR,#text_to_encrypt_len
B1:00D664 E0                MOVX     A,@DPTR
B1:00D665 F8                MOV      R0,A
B1:00D666 A3                INC      DPTR
B1:00D667 E0                MOVX     A,@DPTR
B1:00D668 758300            MOV      DPH,#00H
B1:00D66B 540F              ANL      A,#0FH
B1:00D66D 29                ADD      A,R1
B1:00D66E F9                MOV      R1,A
B1:00D66F E583              MOV      A,DPH
B1:00D671 3A                ADDC     A,R2
B1:00D672 FA                MOV      R2,A
B1:00D673 122917            LCALL    ?C?MEMSET
B1:00D676 903B6D            MOV      DPTR,#blocks
B1:00D679 7180              ACALL    ?L?COM008E
B1:00D67B FA                MOV      R2,A
B1:00D67C C003              PUSH     AR3
B1:00D67E C002              PUSH     AR2
B1:00D680 C001              PUSH     AR1
B1:00D682 D1F5              ACALL    ?L?COM00E8
B1:00D684 D001              POP      AR1
B1:00D686 D002              POP      AR2
B1:00D688 D003              POP      AR3
B1:00D68A B1A4              ACALL    _bit_xor
B1:00D68C 903B75            MOV      DPTR,#key
B1:00D68F D1EC              ACALL    ?L?COM0179
B1:00D691 903B6D            MOV      DPTR,#blocks
B1:00D694 122589            LCALL    ?C?PLDXDATA
B1:00D697 E119              AJMP     _ciph_block
B1:00D699         ?C0032?CCM:
B1:00D699 12FCF2            LCALL    ?L?COM055B
B1:00D69C 127138            LCALL    ?L?COM02A0
B1:00D69F C003              PUSH     AR3
B1:00D6A1 C002              PUSH     AR2
B1:00D6A3 C001              PUSH     AR1
B1:00D6A5 903B6D            MOV      DPTR,#blocks
B1:00D6A8 7180              ACALL    ?L?COM008E
B1:00D6AA A801              MOV      R0,AR1
B1:00D6AC FC                MOV      R4,A
B1:00D6AD AD03              MOV      R5,AR3
B1:00D6AF D001              POP      AR1
B1:00D6B1 D002              POP      AR2
B1:00D6B3 D003              POP      AR3
B1:00D6B5 12E232            LCALL    ?L?COM0078
B1:00D6B8 903B6D            MOV      DPTR,#blocks
B1:00D6BB 7180              ACALL    ?L?COM008E
B1:00D6BD FA                MOV      R2,A
B1:00D6BE C003              PUSH     AR3
B1:00D6C0 C002              PUSH     AR2
B1:00D6C2 C001              PUSH     AR1
B1:00D6C4 D1F5              ACALL    ?L?COM00E8
B1:00D6C6 D001              POP      AR1
B1:00D6C8 D002              POP      AR2
B1:00D6CA D003              POP      AR3
B1:00D6CC B1A4              ACALL    _bit_xor
B1:00D6CE 903B75            MOV      DPTR,#key
B1:00D6D1 D1EC              ACALL    ?L?COM0179
B1:00D6D3 903B6D            MOV      DPTR,#blocks
B1:00D6D6 F116              ACALL    ?L?COM0471
B1:00D6D8 903B7C            MOV      DPTR,#offset
B1:00D6DB 127161            LCALL    ?L?COM0301
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 393


B1:00D6DE 903B78            MOV      DPTR,#i
B1:00D6E1 123F7F            LCALL    ?L?COM0081
B1:00D6E4 C112              AJMP     ?C0029?CCM
B1:00D6E6         ?C0033?CCM:
B1:00D6E6 22                RET      
----- FUNCTION _format_payload_block (END) -------


----- FUNCTION ?L?COM0178 (BEGIN) -----
B1:00D6E7 B1A4              ACALL    _bit_xor
B1:00D6E9 9039D4            MOV      DPTR,#key
B1:00D6EC         ?L?COM0179:
B1:00D6EC 122589            LCALL    ?C?PLDXDATA
B1:00D6EF 9040E1            MOV      DPTR,#?_ciph_block?BYTE+03H
B1:00D6F2 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0178 (END) -------


----- FUNCTION ?L?COM00E8 (BEGIN) -----
B1:00D6F5 903B6D            MOV      DPTR,#blocks
B1:00D6F8         ?L?COM00E9:
B1:00D6F8 122589            LCALL    ?C?PLDXDATA
B1:00D6FB 903F5F            MOV      DPTR,#?_bit_xor?BYTE+03H
B1:00D6FE 1225A9            LCALL    ?C?PSTXDATA
B1:00D701 903F62            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00D704         ?L?COM00EA:
B1:00D704 E4                CLR      A
B1:00D705 F0                MOVX     @DPTR,A
B1:00D706 A3                INC      DPTR
B1:00D707 7410              MOV      A,#010H
B1:00D709 F0                MOVX     @DPTR,A
B1:00D70A 22                RET      
----- FUNCTION ?L?COM00E8 (END) -------


----- FUNCTION ?L?COM0171 (BEGIN) -----
B1:00D70B 904047            MOV      DPTR,#pad
B1:00D70E         ?L?COM0172:
B1:00D70E 122589            LCALL    ?C?PLDXDATA
B1:00D711 8F82              MOV      DPL,R7
B1:00D713 8E83              MOV      DPH,R6
B1:00D715 22                RET      
----- FUNCTION ?L?COM0171 (END) -------


----- FUNCTION ?L?COM0471 (BEGIN) -----
B1:00D716 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _ciph_block (BEGIN) -----
B1:00D719 9040DE            MOV      DPTR,#blocks
B1:00D71C 1225A9            LCALL    ?C?PSTXDATA
B1:00D71F 9040DE            MOV      DPTR,#blocks
B1:00D722 122589            LCALL    ?C?PLDXDATA
B1:00D725 12E213            LCALL    ?L?COM0142
B1:00D728 9040DE            MOV      DPTR,#blocks
B1:00D72B F1CC              ACALL    ?L?COM023A
B1:00D72D 9040E1            MOV      DPTR,#key
B1:00D730 122589            LCALL    ?C?PLDXDATA
B1:00D733 021D4F            LJMP     ?INTERBANK_TABLE?_ZW_AES_ecb
----- FUNCTION _ciph_block (END) -------


----- FUNCTION ?L?COM056B (BEGIN) -----
B1:00D736 900A35            MOV      DPTR,#frameType
B1:00D739 E0                MOVX     A,@DPTR
B1:00D73A FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 394


B1:00D73B EE                MOV      A,R6
B1:00D73C 5407              ANL      A,#07H
B1:00D73E FF                MOV      R7,A
B1:00D73F 22                RET      
----- FUNCTION ?L?COM056B (END) -------


----- FUNCTION ?L?COM0449 (BEGIN) -----
B1:00D740 903F55            MOV      DPTR,#p_scramble_key
B1:00D743 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _ZW_s2_key_scrambler_descramble (BEGIN) -----
;---- Variable 'p_scramble_key' assigned to Register 'R1/R2/R3' ----
B1:00D746 C003              PUSH     AR3
B1:00D748 C002              PUSH     AR2
B1:00D74A C001              PUSH     AR1
B1:00D74C 7B01              MOV      R3,#01H
B1:00D74E 7A37              MOV      R2,#HIGH random_aes_input
B1:00D750 79D1              MOV      R1,#LOW random_aes_input
B1:00D752 12E213            LCALL    ?L?COM0142
B1:00D755 7A37              MOV      R2,#HIGH aes_output
B1:00D757 79E1              MOV      R1,#LOW aes_output
B1:00D759 F1CF              ACALL    ?L?COM023B
B1:00D75B D001              POP      AR1
B1:00D75D D002              POP      AR2
B1:00D75F D003              POP      AR3
B1:00D761 121D4F            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
B1:00D764 E4                CLR      A
B1:00D765 904051            MOV      DPTR,#count_scram
B1:00D768 F0                MOVX     @DPTR,A
B1:00D769         ?C0001?ZW_S2_KEY_SCRAMBLER:
B1:00D769 904051            MOV      DPTR,#count_scram
B1:00D76C E0                MOVX     A,@DPTR
B1:00D76D FF                MOV      R7,A
B1:00D76E C3                CLR      C
B1:00D76F 9410              SUBB     A,#010H
B1:00D771 502B              JNC      ?C0004?ZW_S2_KEY_SCRAMBLER
B1:00D773 90404E            MOV      DPTR,#p_key
B1:00D776 122589            LCALL    ?C?PLDXDATA
B1:00D779 904051            MOV      DPTR,#count_scram
B1:00D77C E0                MOVX     A,@DPTR
B1:00D77D FE                MOV      R6,A
B1:00D77E 126DC8            LCALL    ?L?COM01D9
B1:00D781 FD                MOV      R5,A
B1:00D782 74E1              MOV      A,#LOW aes_output
B1:00D784 2E                ADD      A,R6
B1:00D785 F582              MOV      DPL,A
B1:00D787 E4                CLR      A
B1:00D788 3437              ADDC     A,#HIGH aes_output
B1:00D78A F583              MOV      DPH,A
B1:00D78C E0                MOVX     A,@DPTR
B1:00D78D 6D                XRL      A,R5
B1:00D78E 8F82              MOV      DPL,R7
B1:00D790 758300            MOV      DPH,#00H
B1:00D793 122084            LCALL    ?C?CSTOPTR
B1:00D796 904051            MOV      DPTR,#count_scram
B1:00D799 E0                MOVX     A,@DPTR
B1:00D79A 04                INC      A
B1:00D79B F0                MOVX     @DPTR,A
B1:00D79C 80CB              SJMP     ?C0001?ZW_S2_KEY_SCRAMBLER
B1:00D79E         ?C0004?ZW_S2_KEY_SCRAMBLER:
B1:00D79E 22                RET      
----- FUNCTION _ZW_s2_key_scrambler_descramble (END) -------


----- FUNCTION ?L?COM01C3 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 395


B1:00D79F E4                CLR      A
B1:00D7A0 FF                MOV      R7,A
B1:00D7A1 7EFF              MOV      R6,#0FFH
B1:00D7A3         ?L?COM01C4:
B1:00D7A3 FD                MOV      R5,A
B1:00D7A4 FC                MOV      R4,A
B1:00D7A5 9039D0            MOV      DPTR,#aad_len
B1:00D7A8         ?L?COM01C5:
B1:00D7A8 1224B5            LCALL    ?C?LLDXDATA0
B1:00D7AB C3                CLR      C
B1:00D7AC 0223D4            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM01C3 (END) -------


----- FUNCTION ?L?COM044C (BEGIN) -----
B1:00D7AF 7BFF              MOV      R3,#0FFH
B1:00D7B1 7A3F              MOV      R2,#03FH
B1:00D7B3 79FC              MOV      R1,#0FCH
B1:00D7B5 22                RET      
----- FUNCTION ?L?COM044C (END) -------


----- FUNCTION _ZW_SetSecurityS0NetworkKey (BEGIN) -----
;---- Variable 'network_key' assigned to Register 'R1/R2/R3' ----
B1:00D7B6 7F80              MOV      R7,#080H
B1:00D7B8 51B3              ACALL    _keystore_network_key_write
B1:00D7BA 4128              AJMP     security_init
----- FUNCTION _ZW_SetSecurityS0NetworkKey (END) -------


----- FUNCTION ?L?COM0367 (BEGIN) -----
B1:00D7BC FD                MOV      R5,A
B1:00D7BD FC                MOV      R4,A
B1:00D7BE 9039D0            MOV      DPTR,#aad_len
B1:00D7C1 0224B5            LJMP     ?C?LLDXDATA0
----- FUNCTION ?L?COM0367 (END) -------


----- FUNCTION ?L?COM061C (BEGIN) -----
B1:00D7C4 903B74            MOV      DPTR,#text_to_encrypt_len+01H
B1:00D7C7 E0                MOVX     A,@DPTR
B1:00D7C8 540F              ANL      A,#0FH
B1:00D7CA FF                MOV      R7,A
B1:00D7CB 22                RET      
----- FUNCTION ?L?COM061C (END) -------


----- FUNCTION ?L?COM023A (BEGIN) -----
B1:00D7CC 122589            LCALL    ?C?PLDXDATA
B1:00D7CF         ?L?COM023B:
B1:00D7CF 903EC9            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B1:00D7D2 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM023A (END) -------


----- FUNCTION ?L?COM02F8 (BEGIN) -----
B1:00D7D5 E0                MOVX     A,@DPTR
B1:00D7D6 FC                MOV      R4,A
B1:00D7D7 A3                INC      DPTR
B1:00D7D8 E0                MOVX     A,@DPTR
B1:00D7D9 29                ADD      A,R1
B1:00D7DA F9                MOV      R1,A
B1:00D7DB EA                MOV      A,R2
B1:00D7DC 3C                ADDC     A,R4
B1:00D7DD 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 396


----- FUNCTION ?L?COM02F8 (END) -------


----- FUNCTION ?L?COM044D (BEGIN) -----
B1:00D7DE EF                MOV      A,R7
B1:00D7DF 24FF              ADD      A,#0FFH
B1:00D7E1 FF                MOV      R7,A
B1:00D7E2 EE                MOV      A,R6
B1:00D7E3 34FF              ADDC     A,#0FFH
B1:00D7E5 FE                MOV      R6,A
B1:00D7E6 22                RET      
----- FUNCTION ?L?COM044D (END) -------


----- FUNCTION _ctimer_set (BEGIN) -----
B1:00D7E7 903D74            MOV      DPTR,#c
B1:00D7EA 1225A9            LCALL    ?C?PSTXDATA
B1:00D7ED 903D77            MOV      DPTR,#t
B1:00D7F0 1224F1            LCALL    ?C?LSTXDATA
B1:00D7F3 903D7B            MOV      DPTR,#f
B1:00D7F6 E0                MOVX     A,@DPTR
B1:00D7F7 FE                MOV      R6,A
B1:00D7F8 A3                INC      DPTR
B1:00D7F9 E0                MOVX     A,@DPTR
B1:00D7FA FF                MOV      R7,A
B1:00D7FB 903D74            MOV      DPTR,#c
B1:00D7FE 12D850            LCALL    ?L?COM0317
B1:00D801 EE                MOV      A,R6
B1:00D802 8FF0              MOV      B,R7
B1:00D804 12223E            LCALL    ?C?ISTOPTR
B1:00D807 903D7D            MOV      DPTR,#ptr
B1:00D80A 122589            LCALL    ?C?PLDXDATA
B1:00D80D C003              PUSH     AR3
B1:00D80F C002              PUSH     AR2
B1:00D811 C001              PUSH     AR1
B1:00D813 1147              ACALL    ?L?COM04F3
B1:00D815 90000D            MOV      DPTR,#0DH
B1:00D818 12265D            LCALL    ?C?PSTOPTR
B1:00D81B 900000            MOV      DPTR,#timerCount
B1:00D81E 1246BB            LCALL    ?L?COM0451
B1:00D821 FC                MOV      R4,A
B1:00D822 FD                MOV      R5,A
B1:00D823 903D77            MOV      DPTR,#t
B1:00D826 1270C7            LCALL    ?L?COM0161
B1:00D829 1147              ACALL    ?L?COM04F3
B1:00D82B 900003            MOV      DPTR,#03H
B1:00D82E 122475            LCALL    ?C?LSTOPTR
B1:00D831 903D77            MOV      DPTR,#t
B1:00D834 122499            LCALL    ?C?LLDXDATA
B1:00D837 900007            MOV      DPTR,#07H
B1:00D83A 122475            LCALL    ?C?LSTOPTR
B1:00D83D 1147              ACALL    ?L?COM04F3
B1:00D83F 903E7E            MOV      DPTR,#?_list_add?BYTE+03H
B1:00D842 3106              ACALL    ?L?COM02A8
B1:00D844 0297DC            LJMP     _list_add
----- FUNCTION _ctimer_set (END) -------


----- FUNCTION ?L?COM04F3 (BEGIN) -----
B1:00D847 903D74            MOV      DPTR,#c
B1:00D84A 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04F3 (END) -------


----- FUNCTION ?L?COM0316 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 397


B1:00D84D 904188            MOV      DPTR,#c
B1:00D850         ?L?COM0317:
B1:00D850 122589            LCALL    ?C?PLDXDATA
B1:00D853 90000B            MOV      DPTR,#0BH
B1:00D856 22                RET      
----- FUNCTION ?L?COM0316 (END) -------


----- FUNCTION _ctimer_poll (BEGIN) -----
B1:00D857 904186            MOV      DPTR,#bTicks
B1:00D85A EE                MOV      A,R6
B1:00D85B F0                MOVX     @DPTR,A
B1:00D85C A3                INC      DPTR
B1:00D85D EF                MOV      A,R7
B1:00D85E F0                MOVX     @DPTR,A
B1:00D85F 3109              ACALL    ?L?COM02A9
B1:00D861 312A              ACALL    _list_head
B1:00D863 01F7              AJMP     ?C0012?ZW_CTIMER
B1:00D865         ?C0001?ZW_CTIMER:
B1:00D865 904188            MOV      DPTR,#c
B1:00D868 122589            LCALL    ?C?PLDXDATA
B1:00D86B E9                MOV      A,R1
B1:00D86C 4A                ORL      A,R2
B1:00D86D 7002              JNZ      $ + 4H
B1:00D86F 01FF              AJMP     ?C0008?ZW_CTIMER
B1:00D871 127366            LCALL    ?L?COM0545
B1:00D874 EC                MOV      A,R4
B1:00D875 4D                ORL      A,R5
B1:00D876 4E                ORL      A,R6
B1:00D877 4F                ORL      A,R7
B1:00D878 6074              JZ       ?C0003?ZW_CTIMER
B1:00D87A 900003            MOV      DPTR,#03H
B1:00D87D 1224C1            LCALL    ?C?LLDOPTR0
B1:00D880 904186            MOV      DPTR,#bTicks
B1:00D883 1246BB            LCALL    ?L?COM0451
B1:00D886 FC                MOV      R4,A
B1:00D887 FD                MOV      R5,A
B1:00D888 D3                SETB     C
B1:00D889 1223D4            LCALL    ?C?ULCMP
B1:00D88C 5032              JNC      ?C0005?ZW_CTIMER
B1:00D88E 904188            MOV      DPTR,#c
B1:00D891 3100              ACALL    ?L?COM02A7
B1:00D893 129846            LCALL    _list_remove
B1:00D896 114D              ACALL    ?L?COM0316
B1:00D898 12219A            LCALL    ?C?ILDOPTR
B1:00D89B 45F0              ORL      A,B
B1:00D89D 601C              JZ       ?C0006?ZW_CTIMER
B1:00D89F 90000D            MOV      DPTR,#0DH
B1:00D8A2 12262D            LCALL    ?C?PLDOPTR
B1:00D8A5 C003              PUSH     AR3
B1:00D8A7 C002              PUSH     AR2
B1:00D8A9 C001              PUSH     AR1
B1:00D8AB 114D              ACALL    ?L?COM0316
B1:00D8AD 12219A            LCALL    ?C?ILDOPTR
B1:00D8B0 312D              ACALL    ?L?COM05AD
B1:00D8B2 D001              POP      AR1
B1:00D8B4 D002              POP      AR2
B1:00D8B6 D003              POP      AR3
B1:00D8B8 12271A            LCALL    ?C?ICALL2
B1:00D8BB         ?C0006?ZW_CTIMER:
B1:00D8BB 123EE9            LCALL    ZW_Poll
B1:00D8BE 802E              SJMP     ?C0003?ZW_CTIMER
B1:00D8C0         ?C0005?ZW_CTIMER:
B1:00D8C0 904188            MOV      DPTR,#c
B1:00D8C3 128FD5            LCALL    ?L?COM0057
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 398


B1:00D8C6 F9                MOV      R1,A
B1:00D8C7 E4                CLR      A
B1:00D8C8 3A                ADDC     A,R2
B1:00D8C9 FA                MOV      R2,A
B1:00D8CA C003              PUSH     AR3
B1:00D8CC C002              PUSH     AR2
B1:00D8CE C001              PUSH     AR1
B1:00D8D0 12240B            LCALL    ?C?LLDPTR
B1:00D8D3 C006              PUSH     AR6
B1:00D8D5 C007              PUSH     AR7
B1:00D8D7 904186            MOV      DPTR,#bTicks
B1:00D8DA 1246DB            LCALL    ?L?COM02E4
B1:00D8DD F8                MOV      R0,A
B1:00D8DE D007              POP      AR7
B1:00D8E0 D006              POP      AR6
B1:00D8E2 122278            LCALL    ?C?LSUB
B1:00D8E5 D001              POP      AR1
B1:00D8E7 D002              POP      AR2
B1:00D8E9 D003              POP      AR3
B1:00D8EB 12245B            LCALL    ?C?LSTPTR
B1:00D8EE         ?C0003?ZW_CTIMER:
B1:00D8EE 904188            MOV      DPTR,#c
B1:00D8F1 122589            LCALL    ?C?PLDXDATA
B1:00D8F4 1225BE            LCALL    ?C?PLDPTR
B1:00D8F7         
B1:00D8F7 904188            MOV      DPTR,#c
B1:00D8FA 1225A9            LCALL    ?C?PSTXDATA
B1:00D8FD 0165              AJMP     ?C0001?ZW_CTIMER
B1:00D8FF         ?C0008?ZW_CTIMER:
B1:00D8FF 22                RET      
----- FUNCTION _ctimer_poll (END) -------


----- FUNCTION ?L?COM02A7 (BEGIN) -----
B1:00D900 122589            LCALL    ?C?PLDXDATA
B1:00D903 903D5F            MOV      DPTR,#?_list_remove?BYTE+03H
B1:00D906         ?L?COM02A8:
B1:00D906 1225A9            LCALL    ?C?PSTXDATA
B1:00D909         ?L?COM02A9:
B1:00D909 9040D8            MOV      DPTR,#ctimer_list
B1:00D90C 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM02A7 (END) -------


----- FUNCTION ctimer_init (BEGIN) -----
B1:00D90F 3109              ACALL    ?L?COM02A9
B1:;----                  JMP      _list_init
----- FUNCTION ctimer_init (END) -------


----- FUNCTION _list_init (BEGIN) -----
B1:00D911 90428E            MOV      DPTR,#list
B1:00D914 1225A9            LCALL    ?C?PSTXDATA
B1:00D917 127070            LCALL    ?L?COM00E1
B1:00D91A C003              PUSH     AR3
B1:00D91C C002              PUSH     AR2
B1:00D91E C001              PUSH     AR1
B1:00D920 90428E            MOV      DPTR,#list
B1:00D923 122589            LCALL    ?C?PLDXDATA
B1:00D926 1225DE            LCALL    ?C?PSTPTR
B1:00D929 22                RET      
----- FUNCTION _list_init (END) -------


----- FUNCTION _list_head (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 399


;---- Variable 'list' assigned to Register 'R1/R2/R3' ----
B1:00D92A 0225BE            LJMP     ?C?PLDPTR
----- FUNCTION _list_head (END) -------


----- FUNCTION ?L?COM05AD (BEGIN) -----
B1:00D92D FF                MOV      R7,A
B1:00D92E AEF0              MOV      R6,B
B1:00D930 F582              MOV      DPL,A
B1:00D932 85F083            MOV      DPH,B
B1:00D935 22                RET      
----- FUNCTION ?L?COM05AD (END) -------


----- FUNCTION TxQueueInit (BEGIN) -----
;---- Variable 'bCount' assigned to Register 'R7' ----
B1:00D936 E4                CLR      A
B1:00D937 FF                MOV      R7,A
B1:00D938         ?C0001?ZW_TX_QUEUE:
B1:00D938 128342            LCALL    ?L?COM0132
B1:00D93B E4                CLR      A
B1:00D93C F0                MOVX     @DPTR,A
B1:00D93D 0F                INC      R7
B1:00D93E EF                MOV      A,R7
B1:00D93F B404F6            CJNE     A,#04H,?C0001?ZW_TX_QUEUE
B1:00D942         ?C0002?ZW_TX_QUEUE:
B1:00D942 E4                CLR      A
B1:00D943 9003B3            MOV      DPTR,#bCurrentTransmit
B1:00D946 F0                MOVX     @DPTR,A
B1:00D947 A3                INC      DPTR
B1:00D948 122589            LCALL    ?C?PLDXDATA
B1:00D94B 80C4              SJMP     _list_init
----- FUNCTION TxQueueInit (END) -------


----- FUNCTION _UpdateRssiInRepeatedFrame (BEGIN) -----
;---- Variable 'rssiValue' assigned to Register 'R5' ----
B1:00D94D 900AC5            MOV      DPTR,#pFrame
B1:00D950 1225A9            LCALL    ?C?PSTXDATA
B1:00D953 E9                MOV      A,R1
B1:00D954 240A              ADD      A,#0AH
B1:00D956 128622            LCALL    ?L?COM0006
B1:00D959 FF                MOV      R7,A
B1:00D95A 540F              ANL      A,#0FH
B1:00D95C FE                MOV      R6,A
B1:00D95D 900AC8            MOV      DPTR,#repeaterIndex
B1:00D960 F0                MOVX     @DPTR,A
B1:00D961 BE0F04            CJNE     R6,#0FH,?C0065?ZW_TRANSPORT
B1:00D964 E4                CLR      A
B1:00D965 F0                MOVX     @DPTR,A
B1:00D966 8006              SJMP     ?C0066?ZW_TRANSPORT
B1:00D968         ?C0065?ZW_TRANSPORT:
B1:00D968 900AC8            MOV      DPTR,#repeaterIndex
B1:00D96B E0                MOVX     A,@DPTR
B1:00D96C 04                INC      A
B1:00D96D F0                MOVX     @DPTR,A
B1:00D96E         ?C0066?ZW_TRANSPORT:
B1:00D96E AE05              MOV      R6,AR5
B1:00D970 EF                MOV      A,R7
B1:00D971 318B              ACALL    ?L?COM01DE
B1:00D973 900AC5            MOV      DPTR,#pFrame
B1:00D976 122589            LCALL    ?C?PLDXDATA
B1:00D979 3192              ACALL    ?L?COM0501
B1:00D97B 1272CD            LCALL    ?L?COM0486
B1:00D97E 900AC8            MOV      DPTR,#repeaterIndex
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 400


B1:00D981 E0                MOVX     A,@DPTR
B1:00D982 29                ADD      A,R1
B1:00D983 F9                MOV      R1,A
B1:00D984 EC                MOV      A,R4
B1:00D985 3A                ADDC     A,R2
B1:00D986 FA                MOV      R2,A
B1:00D987 EE                MOV      A,R6
B1:00D988 022072            LJMP     ?C?CSTPTR
----- FUNCTION _UpdateRssiInRepeatedFrame (END) -------


----- FUNCTION ?L?COM01DE (BEGIN) -----
B1:00D98B C4                SWAP     A
B1:00D98C 540F              ANL      A,#0FH
B1:00D98E FD                MOV      R5,A
B1:00D98F 7C00              MOV      R4,#00H
B1:00D991 22                RET      
----- FUNCTION ?L?COM01DE (END) -------


----- FUNCTION ?L?COM0501 (BEGIN) -----
B1:00D992 E9                MOV      A,R1
B1:00D993 2D                ADD      A,R5
B1:00D994 F9                MOV      R1,A
B1:00D995 EC                MOV      A,R4
B1:00D996 3A                ADDC     A,R2
B1:00D997 FA                MOV      R2,A
B1:00D998 22                RET      
----- FUNCTION ?L?COM0501 (END) -------


----- FUNCTION _ConvertHeaderInfoToFrameType (BEGIN) -----
;---- Variable 'frameType' assigned to Register 'R1/R2/R3' ----
;---- Variable 'hdrInfo' assigned to Register 'R7' ----
B1:00D999 EF                MOV      A,R7
B1:00D99A 540F              ANL      A,#0FH
B1:00D99C 24FE              ADD      A,#0FEH
B1:00D99E 6016              JZ       ?C0189?ZW_TRANSPORT
B1:00D9A0 14                DEC      A
B1:00D9A1 6017              JZ       ?C0190?ZW_TRANSPORT
B1:00D9A3 14                DEC      A
B1:00D9A4 6018              JZ       ?C0191?ZW_TRANSPORT
B1:00D9A6 2403              ADD      A,#03H
B1:00D9A8 7019              JNZ      ?C0192?ZW_TRANSPORT
B1:00D9AA         ?C0186?ZW_TRANSPORT:
B1:00D9AA EF                MOV      A,R7
B1:00D9AB 30E704            JNB      ACC.7,?C0187?ZW_TRANSPORT
B1:00D9AE 7404              MOV      A,#04H
B1:00D9B0 800E              SJMP     ?C0596?ZW_TRANSPORT
B1:00D9B2         ?C0187?ZW_TRANSPORT:
B1:00D9B2 7401              MOV      A,#01H
B1:00D9B4         
B1:00D9B4 800A              SJMP     ?C0596?ZW_TRANSPORT
B1:00D9B6         ?C0189?ZW_TRANSPORT:
B1:00D9B6 7402              MOV      A,#02H
B1:00D9B8         
B1:00D9B8 8006              SJMP     ?C0596?ZW_TRANSPORT
B1:00D9BA         ?C0190?ZW_TRANSPORT:
B1:00D9BA 7403              MOV      A,#03H
B1:00D9BC         
B1:00D9BC 8002              SJMP     ?C0596?ZW_TRANSPORT
B1:00D9BE         ?C0191?ZW_TRANSPORT:
B1:00D9BE 7405              MOV      A,#05H
B1:00D9C0         
B1:00D9C0 122072            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 401


B1:00D9C3         ?C0192?ZW_TRANSPORT:
B1:00D9C3 22                RET      
----- FUNCTION _ConvertHeaderInfoToFrameType (END) -------


----- FUNCTION ZCB_DelayedRetransmitFail (BEGIN) -----
B1:00D9C4 900773            MOV      DPTR,#delayCount
B1:00D9C7 E0                MOVX     A,@DPTR
B1:00D9C8 D3                SETB     C
B1:00D9C9 9400              SUBB     A,#00H
B1:00D9CB 4008              JC       ?C0233?ZW_TRANSPORT
B1:00D9CD E0                MOVX     A,@DPTR
B1:00D9CE 14                DEC      A
B1:00D9CF F0                MOVX     @DPTR,A
B1:00D9D0 D3                SETB     C
B1:00D9D1 9400              SUBB     A,#00H
B1:00D9D3 5006              JNC      ?C0234?ZW_TRANSPORT
B1:00D9D5         ?C0233?ZW_TRANSPORT:
B1:00D9D5 128FFD            LCALL    TransmitTimerStop
B1:00D9D8 12A26D            LCALL    RetransmitFail
B1:00D9DB         ?C0234?ZW_TRANSPORT:
B1:00D9DB 22                RET      
----- FUNCTION ZCB_DelayedRetransmitFail (END) -------


----- FUNCTION _ZCB_ZWTransmitComplete (BEGIN) -----
B1:00D9DC 22                RET      
----- FUNCTION _ZCB_ZWTransmitComplete (END) -------


----- FUNCTION CheckSeqNo (BEGIN) -----
B1:00D9DD 5107              ACALL    ?L?COM062F
B1:00D9DF 6021              JZ       ?C0254?ZW_TRANSPORT
B1:00D9E1 900774            MOV      DPTR,#currentSeqNoToMatch
B1:00D9E4 E0                MOVX     A,@DPTR
B1:00D9E5 FE                MOV      R6,A
B1:00D9E6 EF                MOV      A,R7
B1:00D9E7 6E                XRL      A,R6
B1:00D9E8 6018              JZ       ?C0254?ZW_TRANSPORT
B1:00D9EA 128538            LCALL    ?L?COM0016
B1:00D9ED 4A                ORL      A,R2
B1:00D9EE 6015              JZ       ?C0252?ZW_TRANSPORT
B1:00D9F0 E9                MOV      A,R1
B1:00D9F1 24B7              ADD      A,#0B7H
B1:00D9F3 128622            LCALL    ?L?COM0006
B1:00D9F6 30E70C            JNB      ACC.7,?C0252?ZW_TRANSPORT
B1:00D9F9 90088E            MOV      DPTR,#currentSeqNo
B1:00D9FC E0                MOVX     A,@DPTR
B1:00D9FD 54BF              ANL      A,#0BFH
B1:00D9FF B50603            CJNE     A,AR6,?C0252?ZW_TRANSPORT
B1:00DA02         ?C0254?ZW_TRANSPORT:
B1:00DA02 D3                SETB     C
B1:00DA03 8001              SJMP     ?C0253?ZW_TRANSPORT
B1:00DA05         ?C0252?ZW_TRANSPORT:
B1:00DA05 C3                CLR      C
B1:00DA06         ?C0253?ZW_TRANSPORT:
B1:00DA06 22                RET      
----- FUNCTION CheckSeqNo (END) -------


----- FUNCTION ?L?COM062F (BEGIN) -----
B1:00DA07 90088E            MOV      DPTR,#currentSeqNo
B1:00DA0A E0                MOVX     A,@DPTR
B1:00DA0B FF                MOV      R7,A
B1:00DA0C 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 402


B1:00DA0E 22                RET      
----- FUNCTION ?L?COM062F (END) -------


----- FUNCTION _ZW_SetListenBeforeTalkThreshold (BEGIN) -----
;---- Variable 'bChannel' assigned to Register 'R7' ----
;---- Variable 'bThreshold' assigned to Register 'R5' ----
B1:00DA0F EF                MOV      A,R7
B1:00DA10 C3                CLR      C
B1:00DA11 9403              SUBB     A,#03H
B1:00DA13 5008              JNC      ?C0362?ZW_TRANSPORT
B1:00DA15 746B              MOV      A,#LOW bListenRSSIThreshold
B1:00DA17 2F                ADD      A,R7
B1:00DA18 127419            LCALL    ?L?COM062E
B1:00DA1B ED                MOV      A,R5
B1:00DA1C F0                MOVX     @DPTR,A
B1:00DA1D         ?C0362?ZW_TRANSPORT:
B1:00DA1D 22                RET      
----- FUNCTION _ZW_SetListenBeforeTalkThreshold (END) -------


----- FUNCTION _SetSpeedOptions (BEGIN) -----
;---- Variable 'bOldOptions' assigned to Register 'R7' ----
;---- Variable 'bNewOption' assigned to Register 'R5' ----
B1:00DA1E EF                MOV      A,R7
B1:00DA1F 54F8              ANL      A,#0F8H
B1:00DA21 4D                ORL      A,R5
B1:00DA22 FF                MOV      R7,A
B1:00DA23 22                RET      
----- FUNCTION _SetSpeedOptions (END) -------


----- FUNCTION _ZW_Transport_CommandClassVersionGet (BEGIN) -----
;---- Variable 'commandClass' assigned to Register 'R7' ----
B1:00DA24 EF                MOV      A,R7
B1:00DA25 24AB              ADD      A,#0ABH
B1:00DA27 600B              JZ       ?C0373?ZW_TRANSPORT
B1:00DA29 24B6              ADD      A,#0B6H
B1:00DA2B 6004              JZ       ?C0370?ZW_TRANSPORT
B1:00DA2D 2407              ADD      A,#07H
B1:00DA2F 7006              JNZ      ?C0374?ZW_TRANSPORT
B1:00DA31         ?C0370?ZW_TRANSPORT:
B1:00DA31 7F01              MOV      R7,#01H
B1:00DA33 22                RET      
B1:00DA34         ?C0373?ZW_TRANSPORT:
B1:00DA34 7F02              MOV      R7,#02H
B1:00DA36 22                RET      
B1:00DA37         ?C0374?ZW_TRANSPORT:
B1:00DA37 7F00              MOV      R7,#00H
B1:00DA39 22                RET      
----- FUNCTION _ZW_Transport_CommandClassVersionGet (END) -------


----- FUNCTION ?L?COM0162 (BEGIN) -----
B1:00DA3A 240B              ADD      A,#0BH
B1:00DA3C F9                MOV      R1,A
B1:00DA3D E4                CLR      A
B1:00DA3E 3A                ADDC     A,R2
B1:00DA3F FA                MOV      R2,A
B1:00DA40 ED                MOV      A,R5
B1:00DA41 7E00              MOV      R6,#00H
B1:00DA43 29                ADD      A,R1
B1:00DA44 F9                MOV      R1,A
B1:00DA45 EE                MOV      A,R6
B1:00DA46 3A                ADDC     A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 403


B1:00DA47 FA                MOV      R2,A
B1:00DA48 121FB3            LCALL    ?C?CLDPTR
B1:00DA4B         ?L?COM0163:
B1:00DA4B FF                MOV      R7,A
B1:00DA4C 901221            MOV      DPTR,#nodeID
B1:00DA4F E0                MOVX     A,@DPTR
B1:00DA50 6F                XRL      A,R7
B1:00DA51 22                RET      
----- FUNCTION ?L?COM0162 (END) -------


----- FUNCTION _IsKeySupported (BEGIN) -----
B1:00DA52 900B0B            MOV      DPTR,#sc
B1:00DA55 EF                MOV      A,R7
B1:00DA56 F0                MOVX     @DPTR,A
B1:00DA57 517F              ACALL    ZW_GetSecurityKeys
;---- Variable 'bSecKeyMask' assigned to Register 'R7' ----
B1:00DA59 900B0B            MOV      DPTR,#sc
B1:00DA5C E0                MOVX     A,@DPTR
B1:00DA5D 14                DEC      A
B1:00DA5E 600F              JZ       ?C0378?ZW_TRANSPORT
B1:00DA60 14                DEC      A
B1:00DA61 600F              JZ       ?C0379?ZW_TRANSPORT
B1:00DA63 14                DEC      A
B1:00DA64 6010              JZ       ?C0380?ZW_TRANSPORT
B1:00DA66 14                DEC      A
B1:00DA67 6011              JZ       ?C0381?ZW_TRANSPORT
B1:00DA69 2404              ADD      A,#04H
B1:00DA6B 7010              JNZ      ?C0375?ZW_TRANSPORT
B1:00DA6D         ?C0376?ZW_TRANSPORT:
B1:00DA6D D3                SETB     C
B1:00DA6E 22                RET      
B1:00DA6F         ?C0378?ZW_TRANSPORT:
B1:00DA6F EF                MOV      A,R7
B1:00DA70 13                RRC      A
B1:00DA71 22                RET      
B1:00DA72         ?C0379?ZW_TRANSPORT:
B1:00DA72 EF                MOV      A,R7
B1:00DA73 A2E1              MOV      C,ACC.1
B1:00DA75 22                RET      
B1:00DA76         ?C0380?ZW_TRANSPORT:
B1:00DA76 EF                MOV      A,R7
B1:00DA77 A2E2              MOV      C,ACC.2
B1:00DA79 22                RET      
B1:00DA7A         ?C0381?ZW_TRANSPORT:
B1:00DA7A EF                MOV      A,R7
B1:00DA7B 33                RLC      A
B1:00DA7C 22                RET      
B1:00DA7D         ?C0375?ZW_TRANSPORT:
B1:00DA7D C3                CLR      C
B1:00DA7E 22                RET      
----- FUNCTION _IsKeySupported (END) -------


----- FUNCTION ZW_GetSecurityKeys (BEGIN) -----
B1:00DA7F 90344D            MOV      DPTR,#assignedSec_keys
B1:00DA82 E0                MOVX     A,@DPTR
B1:00DA83 FF                MOV      R7,A
B1:00DA84 22                RET      
----- FUNCTION ZW_GetSecurityKeys (END) -------


----- FUNCTION _GetRepeaters (BEGIN) -----
B1:00DA85 90428B            MOV      DPTR,#elem
B1:00DA88 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 404


B1:00DA8B 51B6              ACALL    ?L?COM0620
B1:00DA8D 24B7              ADD      A,#0B7H
B1:00DA8F 128622            LCALL    ?L?COM0006
B1:00DA92 30E712            JNB      ACC.7,?C0020?ZW_TXQ_PROTOCOL
B1:00DA95 540F              ANL      A,#0FH
B1:00DA97 FF                MOV      R7,A
B1:00DA98 BF010C            CJNE     R7,#01H,?C0020?ZW_TXQ_PROTOCOL
B1:00DA9B 51B6              ACALL    ?L?COM0620
B1:00DA9D 24BC              ADD      A,#0BCH
B1:00DA9F 128622            LCALL    ?L?COM0006
B1:00DAA2 C4                SWAP     A
B1:00DAA3 540F              ANL      A,#0FH
B1:00DAA5 FF                MOV      R7,A
B1:00DAA6 22                RET      
B1:00DAA7         ?C0020?ZW_TXQ_PROTOCOL:
B1:00DAA7 7F00              MOV      R7,#00H
B1:00DAA9 22                RET      
----- FUNCTION _GetRepeaters (END) -------


----- FUNCTION ?L?COM0588 (BEGIN) -----
B1:00DAAA FD                MOV      R5,A
B1:00DAAB C4                SWAP     A
B1:00DAAC 540F              ANL      A,#0FH
B1:00DAAE FC                MOV      R4,A
B1:00DAAF ED                MOV      A,R5
B1:00DAB0 540F              ANL      A,#0FH
B1:00DAB2 22                RET      
----- FUNCTION ?L?COM0588 (END) -------


----- FUNCTION ZW_GetMaxPayloadSize (BEGIN) -----
B1:00DAB3 7F2E              MOV      R7,#02EH
B1:00DAB5 22                RET      
----- FUNCTION ZW_GetMaxPayloadSize (END) -------


----- FUNCTION ?L?COM0620 (BEGIN) -----
B1:00DAB6 90428B            MOV      DPTR,#elem
B1:00DAB9 122589            LCALL    ?C?PLDXDATA
B1:00DABC E9                MOV      A,R1
B1:00DABD 22                RET      
----- FUNCTION ?L?COM0620 (END) -------


----- FUNCTION ?L?COM0384 (BEGIN) -----
B1:00DABE 4403              ORL      A,#03H
B1:00DAC0 122072            LCALL    ?C?CSTPTR
B1:00DAC3 900780            MOV      DPTR,#sACK
B1:00DAC6 22                RET      
----- FUNCTION ?L?COM0384 (END) -------


----- FUNCTION ?L?COM0257 (BEGIN) -----
B1:00DAC7 7A07              MOV      R2,#HIGH crH
B1:00DAC9 796F              MOV      R1,#LOW crH
B1:00DACB         ?L?COM0258:
B1:00DACB 7F04              MOV      R7,#04H
B1:00DACD 121B92            LCALL    ?INTERBANK_TABLE?___ZW_memcmp
B1:00DAD0 EF                MOV      A,R7
B1:00DAD1 22                RET      
----- FUNCTION ?L?COM0257 (END) -------


----- FUNCTION _ZW_SendDataMultiEx (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 405


B1:00DAD2 900A58            MOV      DPTR,#pData
B1:00DAD5 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'dataLength' assigned to Register 'R5' ----
B1:00DAD8 E4                CLR      A
B1:00DAD9 900778            MOV      DPTR,#eErrcode
B1:00DADC F0                MOVX     @DPTR,A
B1:00DADD 900A5C            MOV      DPTR,#pTxOptionsMultiEx
B1:00DAE0 128FD5            LCALL    ?L?COM0057
B1:00DAE3 128622            LCALL    ?L?COM0006
B1:00DAE6 6003              JZ       ?C0400?ZW_TRANSPORT
B1:00DAE8 B40409            CJNE     A,#04H,?C0399?ZW_TRANSPORT
B1:00DAEB         ?C0400?ZW_TRANSPORT:
B1:00DAEB 900778            MOV      DPTR,#eErrcode
B1:00DAEE 7403              MOV      A,#03H
B1:00DAF0 F0                MOVX     @DPTR,A
B1:00DAF1 7F00              MOV      R7,#00H
B1:00DAF3 22                RET      
B1:00DAF4         ?C0399?ZW_TRANSPORT:
B1:00DAF4 7401              MOV      A,#01H
B1:00DAF6 D3                SETB     C
B1:00DAF7 9D                SUBB     A,R5
B1:00DAF8 5005              JNC      ?C0403?ZW_TRANSPORT
B1:00DAFA ED                MOV      A,R5
B1:00DAFB 9472              SUBB     A,#072H
B1:00DAFD 4003              JC       ?C0402?ZW_TRANSPORT
B1:00DAFF         ?C0403?ZW_TRANSPORT:
B1:00DAFF 7F00              MOV      R7,#00H
B1:00DB01 22                RET      
B1:00DB02         ?C0402?ZW_TRANSPORT:
B1:00DB02 900A5C            MOV      DPTR,#pTxOptionsMultiEx
B1:00DB05 7178              ACALL    ?L?COM006D
B1:00DB07 7420              MOV      A,#020H
B1:00DB09 12FD96            LCALL    ?L?COM062C
B1:00DB0C FF                MOV      R7,A
B1:00DB0D 900A5C            MOV      DPTR,#pTxOptionsMultiEx
B1:00DB10 122589            LCALL    ?C?PLDXDATA
B1:00DB13 E9                MOV      A,R1
B1:00DB14 2401              ADD      A,#01H
B1:00DB16 1287E0            LCALL    ?L?COM002E
B1:00DB19 7C00              MOV      R4,#00H
B1:00DB1B 900A5C            MOV      DPTR,#pTxOptionsMultiEx
B1:00DB1E 122589            LCALL    ?C?PLDXDATA
B1:00DB21 903B4E            MOV      DPTR,#?_sec2_send_data_multi?BYTE+05H
B1:00DB24 1225A9            LCALL    ?C?PSTXDATA
B1:00DB27 900A5F            MOV      DPTR,#completedFunc
B1:00DB2A E0                MOVX     A,@DPTR
B1:00DB2B FF                MOV      R7,A
B1:00DB2C A3                INC      DPTR
B1:00DB2D E0                MOVX     A,@DPTR
B1:00DB2E 903B51            MOV      DPTR,#?_sec2_send_data_multi?BYTE+08H
B1:00DB31 CF                XCH      A,R7
B1:00DB32 F0                MOVX     @DPTR,A
B1:00DB33 A3                INC      DPTR
B1:00DB34 EF                MOV      A,R7
B1:00DB35 F0                MOVX     @DPTR,A
B1:00DB36 900A58            MOV      DPTR,#pData
B1:00DB39 122589            LCALL    ?C?PLDXDATA
B1:00DB3C 121C91            LCALL    ?INTERBANK_TABLE?_sec2_send_data_multi
B1:00DB3F EF                MOV      A,R7
B1:00DB40 6003              JZ       ?C0404?ZW_TRANSPORT
B1:00DB42 02FD9E            LJMP     ?L?COM062D
B1:00DB45         ?C0404?ZW_TRANSPORT:
B1:00DB45 7F00              MOV      R7,#00H
B1:00DB47 22                RET      
----- FUNCTION _ZW_SendDataMultiEx (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 406




----- FUNCTION ?L?COM00D1 (BEGIN) -----
B1:00DB48 7E00              MOV      R6,#00H
B1:00DB4A 900717            MOV      DPTR,#pData
B1:00DB4D E0                MOVX     A,@DPTR
B1:00DB4E FC                MOV      R4,A
B1:00DB4F A3                INC      DPTR
B1:00DB50 E0                MOVX     A,@DPTR
B1:00DB51 7B01              MOV      R3,#01H
B1:00DB53 240A              ADD      A,#0AH
B1:00DB55 F9                MOV      R1,A
B1:00DB56 E4                CLR      A
B1:00DB57 3C                ADDC     A,R4
B1:00DB58 FA                MOV      R2,A
B1:00DB59 121FB3            LCALL    ?C?CLDPTR
B1:00DB5C C4                SWAP     A
B1:00DB5D 540F              ANL      A,#0FH
B1:00DB5F FD                MOV      R5,A
B1:00DB60 7C00              MOV      R4,#00H
B1:00DB62 900717            MOV      DPTR,#pData
B1:00DB65 E0                MOVX     A,@DPTR
B1:00DB66 FA                MOV      R2,A
B1:00DB67 A3                INC      DPTR
B1:00DB68 E0                MOVX     A,@DPTR
B1:00DB69 7B01              MOV      R3,#01H
B1:00DB6B         ?L?COM00D2:
B1:00DB6B 240B              ADD      A,#0BH
B1:00DB6D F9                MOV      R1,A
B1:00DB6E E4                CLR      A
B1:00DB6F 3A                ADDC     A,R2
B1:00DB70 FA                MOV      R2,A
B1:00DB71 E9                MOV      A,R1
B1:00DB72 2D                ADD      A,R5
B1:00DB73 F9                MOV      R1,A
B1:00DB74 22                RET      
----- FUNCTION ?L?COM00D1 (END) -------


----- FUNCTION ?L?COM006C (BEGIN) -----
B1:00DB75 903376            MOV      DPTR,#pCmd
B1:00DB78         ?L?COM006D:
B1:00DB78 122589            LCALL    ?C?PLDXDATA
B1:00DB7B         ?L?COM006E:
B1:00DB7B E9                MOV      A,R1
B1:00DB7C 2402              ADD      A,#02H
B1:00DB7E F9                MOV      R1,A
B1:00DB7F E4                CLR      A
B1:00DB80 3A                ADDC     A,R2
B1:00DB81 FA                MOV      R2,A
B1:00DB82 22                RET      
----- FUNCTION ?L?COM006C (END) -------


----- FUNCTION ?L?COM0261 (BEGIN) -----
B1:00DB83 122589            LCALL    ?C?PLDXDATA
B1:00DB86 E9                MOV      A,R1
B1:00DB87         ?L?COM0262:
B1:00DB87 240B              ADD      A,#0BH
B1:00DB89 F9                MOV      R1,A
B1:00DB8A E4                CLR      A
B1:00DB8B 3A                ADDC     A,R2
B1:00DB8C FA                MOV      R2,A
B1:00DB8D 22                RET      
----- FUNCTION ?L?COM0261 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 407




----- FUNCTION ZW_SendDataAbort (BEGIN) -----
B1:00DB8E 128538            LCALL    ?L?COM0016
B1:00DB91 4A                ORL      A,R2
B1:00DB92 6008              JZ       ?C0408?ZW_TRANSPORT
B1:00DB94 12861F            LCALL    ?L?COM0005
B1:00DB97 30E502            JNB      ACC.5,?C0408?ZW_TRANSPORT
B1:00DB9A D206              SETB     bApplicationTxAbort
B1:00DB9C         ?C0408?ZW_TRANSPORT:
B1:00DB9C 22                RET      
----- FUNCTION ZW_SendDataAbort (END) -------


----- FUNCTION ?L?COM012B (BEGIN) -----
B1:00DB9D 2409              ADD      A,#09H
B1:00DB9F F9                MOV      R1,A
B1:00DBA0 E4                CLR      A
B1:00DBA1 3A                ADDC     A,R2
B1:00DBA2 FA                MOV      R2,A
B1:00DBA3         ?L?COM012C:
B1:00DBA3 E9                MOV      A,R1
B1:00DBA4 2403              ADD      A,#03H
B1:00DBA6         ?L?COM012D:
B1:00DBA6 F9                MOV      R1,A
B1:00DBA7 E4                CLR      A
B1:00DBA8 3A                ADDC     A,R2
B1:00DBA9 FA                MOV      R2,A
B1:00DBAA         ?L?COM012E:
B1:00DBAA 904064            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B1:00DBAD 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM012B (END) -------


----- FUNCTION ?L?COM0520 (BEGIN) -----
B1:00DBB0 900A31            MOV      DPTR,#fr
B1:00DBB3 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0520 (END) -------


----- FUNCTION _GenerateNodeInformation (BEGIN) -----
B1:00DBB6 904285            MOV      DPTR,#pnodeInfo
B1:00DBB9 1225A9            LCALL    ?C?PSTXDATA
B1:00DBBC 7D2A              MOV      R5,#02AH
B1:00DBBE E4                CLR      A
B1:00DBBF FF                MOV      R7,A
B1:00DBC0 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00DBC3 904285            MOV      DPTR,#pnodeInfo
B1:00DBC6 122589            LCALL    ?C?PLDXDATA
B1:00DBC9 B1D1              ACALL    _UpdateNodeInformation
B1:00DBCB 904285            MOV      DPTR,#pnodeInfo
B1:00DBCE 12727A            LCALL    ?L?COM0432
B1:00DBD1 904285            MOV      DPTR,#pnodeInfo
B1:00DBD4 125C41            LCALL    ?L?COM00B6
B1:00DBD7 7401              MOV      A,#01H
B1:00DBD9 122072            LCALL    ?C?CSTPTR
B1:00DBDC 904285            MOV      DPTR,#pnodeInfo
B1:00DBDF 7178              ACALL    ?L?COM006D
B1:00DBE1 7453              MOV      A,#053H
B1:00DBE3 122072            LCALL    ?C?CSTPTR
B1:00DBE6 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00DBE9 E0                MOVX     A,@DPTR
B1:00DBEA FF                MOV      R7,A
B1:00DBEB 30E008            JNB      ACC.0,?C0040?ZW_SLAVE
B1:00DBEE 121FB3            LCALL    ?C?CLDPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 408


B1:00DBF1 4480              ORL      A,#080H
B1:00DBF3 122072            LCALL    ?C?CSTPTR
B1:00DBF6         ?C0040?ZW_SLAVE:
B1:00DBF6 EF                MOV      A,R7
B1:00DBF7 7F00              MOV      R7,#00H
B1:00DBF9 30E102            JNB      ACC.1,?C0041?ZW_SLAVE
B1:00DBFC 7F80              MOV      R7,#080H
B1:00DBFE         ?C0041?ZW_SLAVE:
B1:00DBFE         ?C0042?ZW_SLAVE:
B1:00DBFE EF                MOV      A,R7
B1:00DBFF 441C              ORL      A,#01CH
B1:00DC01 FF                MOV      R7,A
B1:00DC02 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00DC05 E0                MOVX     A,@DPTR
B1:00DC06 FE                MOV      R6,A
B1:00DC07 7D00              MOV      R5,#00H
B1:00DC09 30E402            JNB      ACC.4,?C0043?ZW_SLAVE
B1:00DC0C 7D40              MOV      R5,#040H
B1:00DC0E         ?C0043?ZW_SLAVE:
B1:00DC0E         ?C0044?ZW_SLAVE:
B1:00DC0E EF                MOV      A,R7
B1:00DC0F 4D                ORL      A,R5
B1:00DC10 FF                MOV      R7,A
B1:00DC11 EE                MOV      A,R6
B1:00DC12 7E00              MOV      R6,#00H
B1:00DC14 30E502            JNB      ACC.5,?C0045?ZW_SLAVE
B1:00DC17 7E20              MOV      R6,#020H
B1:00DC19         ?C0045?ZW_SLAVE:
B1:00DC19         ?C0046?ZW_SLAVE:
B1:00DC19 EF                MOV      A,R7
B1:00DC1A 4E                ORL      A,R6
B1:00DC1B FF                MOV      R7,A
B1:00DC1C 904285            MOV      DPTR,#pnodeInfo
B1:00DC1F 128FD5            LCALL    ?L?COM0057
B1:00DC22 1287E0            LCALL    ?L?COM002E
B1:00DC25 904285            MOV      DPTR,#pnodeInfo
B1:00DC28 12885F            LCALL    ?L?COM000F
B1:00DC2B 7401              MOV      A,#01H
B1:00DC2D 122072            LCALL    ?C?CSTPTR
B1:00DC30 902BBA            MOV      DPTR,#blparmLength
B1:00DC33 E0                MOVX     A,@DPTR
B1:00DC34 D3                SETB     C
B1:00DC35 9423              SUBB     A,#023H
B1:00DC37 4003              JC       ?C0047?ZW_SLAVE
B1:00DC39 7423              MOV      A,#023H
B1:00DC3B F0                MOVX     @DPTR,A
B1:00DC3C         ?C0047?ZW_SLAVE:
B1:00DC3C 902BBA            MOV      DPTR,#blparmLength
B1:00DC3F E0                MOVX     A,@DPTR
B1:00DC40 FE                MOV      R6,A
B1:00DC41 2407              ADD      A,#07H
B1:00DC43 902BE5            MOV      DPTR,#blnodeInfoLength
B1:00DC46 F0                MOVX     @DPTR,A
B1:00DC47 AF06              MOV      R7,AR6
B1:00DC49 904285            MOV      DPTR,#pnodeInfo
B1:00DC4C 127077            LCALL    ?L?COM00E7
B1:00DC4F F9                MOV      R1,A
B1:00DC50 E4                CLR      A
B1:00DC51 3A                ADDC     A,R2
B1:00DC52 FA                MOV      R2,A
B1:00DC53 C003              PUSH     AR3
B1:00DC55 C002              PUSH     AR2
B1:00DC57 C001              PUSH     AR1
B1:00DC59 902B33            MOV      DPTR,#plnodeParm
B1:00DC5C 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 409


B1:00DC5F 126149            LCALL    ?L?COM0047
B1:00DC62 D001              POP      AR1
B1:00DC64 D002              POP      AR2
B1:00DC66 D003              POP      AR3
B1:00DC68 021B8D            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION _GenerateNodeInformation (END) -------


----- FUNCTION ClearSendDataTxStatus (BEGIN) -----
B1:00DC6B 12FDA8            LCALL    ?L?COM04B3
B1:00DC6E 7D13              MOV      R5,#013H
B1:00DC70 1271C2            LCALL    ?L?COM036D
B1:00DC73 7A39              MOV      R2,#HIGH tx_status+03H
B1:00DC75 79A0              MOV      R1,#LOW tx_status+03H
B1:00DC77 7D05              MOV      R5,#05H
B1:00DC79 7F7F              MOV      R7,#07FH
B1:00DC7B 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ClearSendDataTxStatus (END) -------


----- FUNCTION _keystore_network_key_read (BEGIN) -----
B1:00DC7E 9042A6            MOV      DPTR,#buf
B1:00DC81 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'key_class' assigned to Register 'R7' ----
B1:00DC84 9042A6            MOV      DPTR,#buf
B1:00DC87 122589            LCALL    ?C?PLDXDATA
B1:00DC8A 904041            MOV      DPTR,#?_keystore_network_key_read_impl?BYTE+04H
B1:00DC8D 1225A9            LCALL    ?C?PSTXDATA
B1:00DC90 12D7AF            LCALL    ?L?COM044C
B1:;----                  JMP      _keystore_network_key_read_impl
----- FUNCTION _keystore_network_key_read (END) -------


----- FUNCTION _keystore_network_key_read_impl (BEGIN) -----
B1:00DC93 90403D            MOV      DPTR,#key_class
B1:00DC96 127088            LCALL    ?L?COM00F4
B1:00DC99 12D331            LCALL    ?L?COM033E
B1:00DC9C 90403D            MOV      DPTR,#key_class
B1:00DC9F E0                MOVX     A,@DPTR
B1:00DCA0 FE                MOV      R6,A
B1:00DCA1 5F                ANL      A,R7
B1:00DCA2 7002              JNZ      ?C0020?ZW_KEYSTORE
B1:00DCA4 FF                MOV      R7,A
B1:00DCA5 22                RET      
B1:00DCA6         ?C0020?ZW_KEYSTORE:
B1:00DCA6 90403D            MOV      DPTR,#key_class
B1:00DCA9 E0                MOVX     A,@DPTR
B1:00DCAA FF                MOV      R7,A
B1:00DCAB 14                DEC      A
B1:00DCAC FD                MOV      R5,A
B1:00DCAD EF                MOV      A,R7
B1:00DCAE 5D                ANL      A,R5
B1:00DCAF 7005              JNZ      ?C0023?ZW_KEYSTORE
B1:00DCB1 EE                MOV      A,R6
B1:00DCB2 5487              ANL      A,#087H
B1:00DCB4 7003              JNZ      ?C0022?ZW_KEYSTORE
B1:00DCB6         ?C0023?ZW_KEYSTORE:
B1:00DCB6 7F00              MOV      R7,#00H
B1:00DCB8 22                RET      
B1:00DCB9         ?C0022?ZW_KEYSTORE:
B1:00DCB9 90403D            MOV      DPTR,#key_class
B1:00DCBC E0                MOVX     A,@DPTR
B1:00DCBD FF                MOV      R7,A
B1:00DCBE ED                MOV      A,R5
B1:00DCBF B1C7              ACALL    ?L?COM055F
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 410


B1:00DCC1 5403              ANL      A,#03H
B1:00DCC3 F0                MOVX     @DPTR,A
B1:00DCC4 E0                MOVX     A,@DPTR
B1:00DCC5 904041            MOV      DPTR,#buf
B1:00DCC8 12FD67            LCALL    ?L?COM02F9
B1:00DCCB 12734B            LCALL    ?L?COM0502
B1:00DCCE 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetBuffer
B1:00DCD1 904041            MOV      DPTR,#buf
B1:00DCD4 12D328            LCALL    ?L?COM01EA
B1:00DCD7 90403E            MOV      DPTR,#p_scramble_key
B1:00DCDA 122589            LCALL    ?C?PLDXDATA
B1:00DCDD 12D746            LCALL    _ZW_s2_key_scrambler_descramble
B1:00DCE0 7F01              MOV      R7,#01H
B1:00DCE2 22                RET      
----- FUNCTION _keystore_network_key_read_impl (END) -------


----- FUNCTION ?L?COM044A (BEGIN) -----
B1:00DCE3 24B1              ADD      A,#0B1H
B1:00DCE5 F9                MOV      R1,A
B1:00DCE6 E4                CLR      A
B1:00DCE7 3A                ADDC     A,R2
B1:00DCE8 FA                MOV      R2,A
B1:00DCE9 22                RET      
----- FUNCTION ?L?COM044A (END) -------


----- FUNCTION _ZW_KeystoreNvmUpdate (BEGIN) -----
B1:00DCEA 9040D2            MOV      DPTR,#scramblingKeyIndex
B1:00DCED 1224F1            LCALL    ?C?LSTXDATA
B1:00DCF0 90344D            MOV      DPTR,#assignedSec_keys
B1:00DCF3 E0                MOVX     A,@DPTR
B1:00DCF4 9040D6            MOV      DPTR,#keys
B1:00DCF7 F0                MOVX     @DPTR,A
B1:00DCF8 7E12              MOV      R6,#HIGH span_mpan_table_valid
B1:00DCFA 7F94              MOV      R7,#LOW span_mpan_table_valid
B1:00DCFC E4                CLR      A
B1:00DCFD FD                MOV      R5,A
B1:00DCFE 123FC4            LCALL    _NVM_ext_write_byte
B1:00DD01 9040D2            MOV      DPTR,#scramblingKeyIndex
B1:00DD04 122499            LCALL    ?C?LLDXDATA
B1:00DD07 7A34              MOV      R2,#HIGH buffer
B1:00DD09 794E              MOV      R1,#LOW buffer
B1:00DD0B 7410              MOV      A,#010H
B1:00DD0D 12C788            LCALL    ?L?COM02F7
B1:00DD10         ?C0034?ZW_KEYSTORE:
B1:00DD10 9040D6            MOV      DPTR,#keys
B1:00DD13 E0                MOVX     A,@DPTR
B1:00DD14 FE                MOV      R6,A
B1:00DD15 6036              JZ       ?C0036?ZW_KEYSTORE
B1:00DD17 FF                MOV      R7,A
B1:00DD18 14                DEC      A
B1:00DD19 F4                CPL      A
B1:00DD1A FD                MOV      R5,A
B1:00DD1B EF                MOV      A,R7
B1:00DD1C 5D                ANL      A,R5
B1:00DD1D FF                MOV      R7,A
B1:00DD1E A3                INC      DPTR
B1:00DD1F F0                MOVX     @DPTR,A
B1:00DD20 F4                CPL      A
B1:00DD21 FD                MOV      R5,A
B1:00DD22 EE                MOV      A,R6
B1:00DD23 5D                ANL      A,R5
B1:00DD24 9040D6            MOV      DPTR,#keys
B1:00DD27 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 411


B1:00DD28 B160              ACALL    ?L?COM01FF
B1:00DD2A 917E              ACALL    _keystore_network_key_read
B1:00DD2C B160              ACALL    ?L?COM01FF
B1:00DD2E 12D32B            LCALL    ?L?COM01EB
B1:00DD31 7A34              MOV      R2,#HIGH buffer
B1:00DD33 794E              MOV      R1,#LOW buffer
B1:00DD35 12D746            LCALL    _ZW_s2_key_scrambler_descramble
B1:00DD38 9040D7            MOV      DPTR,#key
B1:00DD3B E0                MOVX     A,@DPTR
B1:00DD3C FF                MOV      R7,A
B1:00DD3D 14                DEC      A
B1:00DD3E B1C7              ACALL    ?L?COM055F
B1:00DD40 B14E              ACALL    ?L?COM01FD
B1:00DD42 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00DD45 12D704            LCALL    ?L?COM00EA
B1:00DD48 126C78            LCALL    _NVM_ext_write_buffer
B1:00DD4B 80C3              SJMP     ?C0034?ZW_KEYSTORE
B1:00DD4D         ?C0036?ZW_KEYSTORE:
B1:00DD4D 22                RET      
----- FUNCTION _ZW_KeystoreNvmUpdate (END) -------


----- FUNCTION ?L?COM01FD (BEGIN) -----
B1:00DD4E 5403              ANL      A,#03H
B1:00DD50 F0                MOVX     @DPTR,A
B1:00DD51 E0                MOVX     A,@DPTR
B1:00DD52 75F010            MOV      B,#010H
B1:00DD55 A4                MUL      AB
B1:00DD56 2495              ADD      A,#LOW span_mpan_table
B1:00DD58 F9                MOV      R1,A
B1:00DD59 7412              MOV      A,#HIGH span_mpan_table
B1:00DD5B         ?L?COM01FE:
B1:00DD5B 35F0              ADDC     A,B
B1:00DD5D FE                MOV      R6,A
B1:00DD5E AF01              MOV      R7,AR1
B1:00DD60         ?L?COM01FF:
B1:00DD60 7B01              MOV      R3,#01H
B1:00DD62 7A34              MOV      R2,#HIGH buffer+010H
B1:00DD64 795E              MOV      R1,#LOW buffer+010H
B1:00DD66 22                RET      
----- FUNCTION ?L?COM01FD (END) -------


----- FUNCTION _ZW_KeystoreInit (BEGIN) -----
;---- Variable 'nvmLayout' assigned to Register 'R7' ----
B1:00DD67 EF                MOV      A,R7
B1:00DD68 6402              XRL      A,#02H
B1:00DD6A 705A              JNZ      ?C0033?ZW_KEYSTORE
B1:00DD6C D106              ACALL    keystore_keypair_check_and_generate
B1:00DD6E 7E12              MOV      R6,#HIGH keyclasses_assigned
B1:00DD70 7F13              MOV      R7,#LOW keyclasses_assigned
B1:00DD72 123964            LCALL    _NVM_ext_read_byte
B1:00DD75 904349            MOV      DPTR,#keys
B1:00DD78 EF                MOV      A,R7
B1:00DD79 F0                MOVX     @DPTR,A
B1:00DD7A         ?C0031?ZW_KEYSTORE:
B1:00DD7A 904349            MOV      DPTR,#keys
B1:00DD7D E0                MOVX     A,@DPTR
B1:00DD7E FC                MOV      R4,A
B1:00DD7F 6045              JZ       ?C0033?ZW_KEYSTORE
B1:00DD81 FE                MOV      R6,A
B1:00DD82 14                DEC      A
B1:00DD83 F4                CPL      A
B1:00DD84 FD                MOV      R5,A
B1:00DD85 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 412


B1:00DD86 5D                ANL      A,R5
B1:00DD87 904348            MOV      DPTR,#key
B1:00DD8A F0                MOVX     @DPTR,A
B1:00DD8B E0                MOVX     A,@DPTR
B1:00DD8C FD                MOV      R5,A
B1:00DD8D F4                CPL      A
B1:00DD8E FE                MOV      R6,A
B1:00DD8F EC                MOV      A,R4
B1:00DD90 5E                ANL      A,R6
B1:00DD91 A3                INC      DPTR
B1:00DD92 F0                MOVX     @DPTR,A
B1:00DD93 ED                MOV      A,R5
B1:00DD94 14                DEC      A
B1:00DD95 C4                SWAP     A
B1:00DD96 13                RRC      A
B1:00DD97 5407              ANL      A,#07H
B1:00DD99 FF                MOV      R7,A
B1:00DD9A 904348            MOV      DPTR,#key
B1:00DD9D E0                MOVX     A,@DPTR
B1:00DD9E C3                CLR      C
B1:00DD9F 13                RRC      A
B1:00DDA0 4F                ORL      A,R7
B1:00DDA1 B14E              ACALL    ?L?COM01FD
B1:00DDA3 9040B9            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B1:00DDA6 7410              MOV      A,#010H
B1:00DDA8 F0                MOVX     @DPTR,A
B1:00DDA9 123F61            LCALL    _NVM_ext_read_buffer
B1:00DDAC 904348            MOV      DPTR,#key
B1:00DDAF E0                MOVX     A,@DPTR
B1:00DDB0 75F010            MOV      B,#010H
B1:00DDB3 A4                MUL      AB
B1:00DDB4 2454              ADD      A,#LOW s2_network_keys
B1:00DDB6 F9                MOV      R1,A
B1:00DDB7 7412              MOV      A,#HIGH s2_network_keys
B1:00DDB9 B15B              ACALL    ?L?COM01FE
B1:00DDBB 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00DDBE 12D704            LCALL    ?L?COM00EA
B1:00DDC1 126C78            LCALL    _NVM_ext_write_buffer
B1:00DDC4 80B4              SJMP     ?C0031?ZW_KEYSTORE
B1:00DDC6         ?C0033?ZW_KEYSTORE:
B1:00DDC6 22                RET      
----- FUNCTION _ZW_KeystoreInit (END) -------


----- FUNCTION ?L?COM055F (BEGIN) -----
B1:00DDC7 C4                SWAP     A
B1:00DDC8 13                RRC      A
B1:00DDC9 5407              ANL      A,#07H
B1:00DDCB FE                MOV      R6,A
B1:00DDCC EF                MOV      A,R7
B1:00DDCD C3                CLR      C
B1:00DDCE 13                RRC      A
B1:00DDCF 4E                ORL      A,R6
B1:00DDD0 22                RET      
----- FUNCTION ?L?COM055F (END) -------


----- FUNCTION _UpdateNodeInformation (BEGIN) -----
B1:00DDD1 904282            MOV      DPTR,#pnodeInfo
B1:00DDD4 1225A9            LCALL    ?C?PSTXDATA
B1:00DDD7 904282            MOV      DPTR,#pnodeInfo
B1:00DDDA 12BF9A            LCALL    ?L?COM01E1
B1:00DDDD F9                MOV      R1,A
B1:00DDDE E4                CLR      A
B1:00DDDF 3A                ADDC     A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 413


B1:00DDE0 FA                MOV      R2,A
B1:00DDE1 903C31            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+03H
B1:00DDE4 1225A9            LCALL    ?C?PSTXDATA
B1:00DDE7 7B01              MOV      R3,#01H
B1:00DDE9 12FDBB            LCALL    ?L?COM02F0
B1:00DDEC 021EA8            LJMP     ?INTERBANK_TABLE?_ApplicationNodeInformation
----- FUNCTION _UpdateNodeInformation (END) -------


----- FUNCTION ?L?COM05D6 (BEGIN) -----
B1:00DDEF EC                MOV      A,R4
B1:00DDF0 3A                ADDC     A,R2
B1:00DDF1 FA                MOV      R2,A
B1:00DDF2 E9                MOV      A,R1
B1:00DDF3 2F                ADD      A,R7
B1:00DDF4 F9                MOV      R1,A
B1:00DDF5 EE                MOV      A,R6
B1:00DDF6 22                RET      
----- FUNCTION ?L?COM05D6 (END) -------


----- FUNCTION ?L?COM0343 (BEGIN) -----
B1:00DDF7 1225A9            LCALL    ?C?PSTXDATA
B1:00DDFA         ?L?COM0344:
B1:00DDFA 900717            MOV      DPTR,#pData
B1:00DDFD E0                MOVX     A,@DPTR
B1:00DDFE FE                MOV      R6,A
B1:00DDFF A3                INC      DPTR
B1:00DE00 E0                MOVX     A,@DPTR
B1:00DE01 FF                MOV      R7,A
B1:00DE02 22                RET      
----- FUNCTION ?L?COM0343 (END) -------


----- FUNCTION RouteCachedReset (BEGIN) -----
B1:00DE03 C216              CLR      bRouteCached
B1:00DE05 22                RET      
----- FUNCTION RouteCachedReset (END) -------


----- FUNCTION keystore_keypair_check_and_generate (BEGIN) -----
B1:00DE06 12E724            LCALL    ?L?COM0340
B1:00DE09 4007              JC       ?C0037?ZW_KEYSTORE
B1:00DE0B 121C1E            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00DE0E EF                MOV      A,R7
B1:00DE0F F4                CPL      A
B1:00DE10 7079              JNZ      ?C0038?ZW_KEYSTORE
B1:00DE12         ?C0037?ZW_KEYSTORE:
B1:00DE12 7E12              MOV      R6,#HIGH s2_private_key
B1:00DE14 7F14              MOV      R7,#LOW s2_private_key
B1:00DE16 7B01              MOV      R3,#01H
B1:00DE18 7A34              MOV      R2,#HIGH buffer
B1:00DE1A 794E              MOV      R1,#LOW buffer
B1:00DE1C 12E7A5            LCALL    ?L?COM0314
;---- Variable 'idx0' assigned to Register 'R7' ----
B1:00DE1F E4                CLR      A
B1:00DE20 FF                MOV      R7,A
B1:00DE21         ?C0039?ZW_KEYSTORE:
B1:00DE21 D18C              ACALL    ?L?COM04B0
B1:00DE23 7066              JNZ      ?C0038?ZW_KEYSTORE
B1:00DE25         ?C0042?ZW_KEYSTORE:
B1:00DE25         ?C0041?ZW_KEYSTORE:
B1:00DE25 0F                INC      R7
B1:00DE26 EF                MOV      A,R7
B1:00DE27 B420F7            CJNE     A,#020H,?C0039?ZW_KEYSTORE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 414


B1:00DE2A         ?C0040?ZW_KEYSTORE:
B1:00DE2A 7B01              MOV      R3,#01H
B1:00DE2C 7A34              MOV      R2,#HIGH buffer
B1:00DE2E 794E              MOV      R1,#LOW buffer
B1:00DE30 12E6F2            LCALL    _keystore_public_key_read
;---- Variable 'idx1' assigned to Register 'R7' ----
B1:00DE33 E4                CLR      A
B1:00DE34 FF                MOV      R7,A
B1:00DE35         ?C0043?ZW_KEYSTORE:
B1:00DE35 D18C              ACALL    ?L?COM04B0
B1:00DE37 7052              JNZ      ?C0038?ZW_KEYSTORE
B1:00DE39         ?C0046?ZW_KEYSTORE:
B1:00DE39         ?C0045?ZW_KEYSTORE:
B1:00DE39 0F                INC      R7
B1:00DE3A EF                MOV      A,R7
B1:00DE3B B420F7            CJNE     A,#020H,?C0043?ZW_KEYSTORE
B1:00DE3E         ?C0044?ZW_KEYSTORE:
B1:00DE3E E4                CLR      A
B1:00DE3F 904383            MOV      DPTR,#idx2
B1:00DE42 F0                MOVX     @DPTR,A
B1:00DE43         ?C0047?ZW_KEYSTORE:
B1:00DE43 904383            MOV      DPTR,#idx2
B1:00DE46 E0                MOVX     A,@DPTR
B1:00DE47 FF                MOV      R7,A
B1:00DE48 C3                CLR      C
B1:00DE49 9420              SUBB     A,#020H
B1:00DE4B 501A              JNC      ?C0048?ZW_KEYSTORE
B1:00DE4D 744E              MOV      A,#LOW buffer
B1:00DE4F 2F                ADD      A,R7
B1:00DE50 F9                MOV      R1,A
B1:00DE51 E4                CLR      A
B1:00DE52 3434              ADDC     A,#HIGH buffer
B1:00DE54 FA                MOV      R2,A
B1:00DE55 7B01              MOV      R3,#01H
B1:00DE57 C3                CLR      C
B1:00DE58 7420              MOV      A,#020H
B1:00DE5A 9F                SUBB     A,R7
B1:00DE5B FD                MOV      R5,A
B1:00DE5C 123780            LCALL    _ZW_GetRandomArray
B1:00DE5F 904383            MOV      DPTR,#idx2
B1:00DE62 E0                MOVX     A,@DPTR
B1:00DE63 2F                ADD      A,R7
B1:00DE64 F0                MOVX     @DPTR,A
B1:00DE65 80DC              SJMP     ?C0047?ZW_KEYSTORE
B1:00DE67         ?C0048?ZW_KEYSTORE:
B1:00DE67 7B01              MOV      R3,#01H
B1:00DE69 7A34              MOV      R2,#HIGH buffer
B1:00DE6B 794E              MOV      R1,#LOW buffer
B1:00DE6D 9040F3            MOV      DPTR,#?_crypto_scalarmult_curve25519_base?BYTE+03H
B1:00DE70 1225A9            LCALL    ?C?PSTXDATA
B1:00DE73 7A34              MOV      R2,#HIGH buffer+020H
B1:00DE75 796E              MOV      R1,#LOW buffer+020H
B1:00DE77 12FCC5            LCALL    _crypto_scalarmult_curve25519_base
B1:00DE7A 7B01              MOV      R3,#01H
B1:00DE7C 7A34              MOV      R2,#HIGH buffer
B1:00DE7E 794E              MOV      R1,#LOW buffer
B1:00DE80 12D346            LCALL    _keystore_private_key_write
B1:00DE83 7B01              MOV      R3,#01H
B1:00DE85 7A34              MOV      R2,#HIGH buffer+020H
B1:00DE87 796E              MOV      R1,#LOW buffer+020H
B1:00DE89 D19D              ACALL    _keystore_public_key_write
B1:00DE8B         ?C0038?ZW_KEYSTORE:
B1:00DE8B 22                RET      
----- FUNCTION keystore_keypair_check_and_generate (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 415



----- FUNCTION ?L?COM04B0 (BEGIN) -----
B1:00DE8C 744E              MOV      A,#LOW buffer
B1:00DE8E 2F                ADD      A,R7
B1:00DE8F F582              MOV      DPL,A
B1:00DE91 E4                CLR      A
B1:00DE92 3434              ADDC     A,#HIGH buffer
B1:00DE94 F583              MOV      DPH,A
B1:00DE96 E0                MOVX     A,@DPTR
B1:00DE97 22                RET      
----- FUNCTION ?L?COM04B0 (END) -------


----- FUNCTION ZW_FollowUpReceived (BEGIN) -----
B1:00DE98 D228              SETB     ?RF_EnableFLiRSBroadcast?BIT
B1:00DE9A 0260A9            LJMP     RF_EnableFLiRSBroadcast
----- FUNCTION ZW_FollowUpReceived (END) -------


----- FUNCTION _keystore_public_key_write (BEGIN) -----
B1:00DE9D 9042A0            MOV      DPTR,#buf
B1:00DEA0 1225A9            LCALL    ?C?PSTXDATA
B1:00DEA3 7E12              MOV      R6,#HIGH s2_public_key
B1:00DEA5 7F34              MOV      R7,#LOW s2_public_key
B1:00DEA7 9042A0            MOV      DPTR,#buf
B1:00DEAA 122589            LCALL    ?C?PLDXDATA
B1:00DEAD 904057            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B1:00DEB0 D1C2              ACALL    ?L?COM00F7
B1:00DEB2 021B88            LJMP     ?INTERBANK_TABLE?_ZW_MemoryPutBuffer
----- FUNCTION _keystore_public_key_write (END) -------


----- FUNCTION ?L?COM00F5 (BEGIN) -----
B1:00DEB5 7A32              MOV      R2,#HIGH t0
B1:00DEB7 79E0              MOV      R1,#LOW t0
B1:00DEB9         ?L?COM00F6:
B1:00DEB9 9030C6            MOV      DPTR,#?_aes_cmac_calculate?BYTE+03H
B1:00DEBC 1225A9            LCALL    ?C?PSTXDATA
B1:00DEBF 9030C9            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00DEC2         ?L?COM00F7:
B1:00DEC2 E4                CLR      A
B1:00DEC3 F0                MOVX     @DPTR,A
B1:00DEC4 A3                INC      DPTR
B1:00DEC5 7420              MOV      A,#020H
B1:00DEC7 F0                MOVX     @DPTR,A
B1:00DEC8 22                RET      
----- FUNCTION ?L?COM00F5 (END) -------


----- FUNCTION _generic_expand (BEGIN) -----
B1:00DEC9 90363E            MOV      DPTR,#network_key
B1:00DECC 1225A9            LCALL    ?C?PSTXDATA
B1:00DECF 784D              MOV      R0,#LOW temp
B1:00DED1 7C36              MOV      R4,#HIGH temp
B1:00DED3 12FD7C            LCALL    ?L?COM02B1
B1:00DED6 12E68B            LCALL    ?L?COM010D
B1:00DED9 90365C            MOV      DPTR,#temp+0FH
B1:00DEDC 7401              MOV      A,#01H
B1:00DEDE F0                MOVX     @DPTR,A
B1:00DEDF FB                MOV      R3,A
B1:00DEE0 7A36              MOV      R2,#HIGH temp
B1:00DEE2 794D              MOV      R1,#LOW temp
B1:00DEE4 12F947            LCALL    ?L?COM0519
B1:00DEE7 9030C9            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00DEEA 12D704            LCALL    ?L?COM00EA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 416


B1:00DEED 903644            MOV      DPTR,#ccm_key
B1:00DEF0 F152              ACALL    ?L?COM01A5
B1:00DEF2 12FD84            LCALL    ?L?COM04F5
B1:00DEF5 903644            MOV      DPTR,#ccm_key
B1:00DEF8 122589            LCALL    ?C?PLDXDATA
B1:00DEFB 12E232            LCALL    ?L?COM0078
B1:00DEFE 12FD78            LCALL    ?L?COM02B0
B1:00DF01 12E68B            LCALL    ?L?COM010D
B1:00DF04 7402              MOV      A,#02H
B1:00DF06 12FD8B            LCALL    ?L?COM03AD
B1:00DF09 D1B9              ACALL    ?L?COM00F6
B1:00DF0B 903647            MOV      DPTR,#nonce_pstring
B1:00DF0E F152              ACALL    ?L?COM01A5
B1:00DF10 12FD84            LCALL    ?L?COM04F5
B1:00DF13 903647            MOV      DPTR,#nonce_pstring
B1:00DF16 122589            LCALL    ?C?PLDXDATA
B1:00DF19 12E232            LCALL    ?L?COM0078
B1:00DF1C 12FD78            LCALL    ?L?COM02B0
B1:00DF1F 12E68B            LCALL    ?L?COM010D
B1:00DF22 90366C            MOV      DPTR,#temp+01FH
B1:00DF25 7403              MOV      A,#03H
B1:00DF27 12FD8E            LCALL    ?L?COM03AE
B1:00DF2A D1B9              ACALL    ?L?COM00F6
B1:00DF2C 903647            MOV      DPTR,#nonce_pstring
B1:00DF2F 12D380            LCALL    ?L?COM008E
B1:00DF32 FA                MOV      R2,A
B1:00DF33 F155              ACALL    ?L?COM01A6
B1:00DF35 903647            MOV      DPTR,#nonce_pstring
B1:00DF38 12D380            LCALL    ?L?COM008E
B1:00DF3B FA                MOV      R2,A
B1:00DF3C 12FD84            LCALL    ?L?COM04F5
B1:00DF3F 12E232            LCALL    ?L?COM0078
B1:00DF42 12FD78            LCALL    ?L?COM02B0
B1:00DF45 12E68B            LCALL    ?L?COM010D
B1:00DF48 7404              MOV      A,#04H
B1:00DF4A 12FD8B            LCALL    ?L?COM03AD
B1:00DF4D D1B9              ACALL    ?L?COM00F6
B1:00DF4F 90364A            MOV      DPTR,#mpan_key
B1:;----                  JMP      ?L?COM01A5
----- FUNCTION _generic_expand (END) -------


----- FUNCTION ?L?COM01A5 (BEGIN) -----
B1:00DF52 122589            LCALL    ?C?PLDXDATA
B1:00DF55         ?L?COM01A6:
B1:00DF55 9030CB            MOV      DPTR,#?_aes_cmac_calculate?BYTE+08H
B1:00DF58 1225A9            LCALL    ?C?PSTXDATA
B1:00DF5B 90363E            MOV      DPTR,#network_key
B1:00DF5E 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _aes_cmac_calculate (BEGIN) -----
B1:00DF61 9030C3            MOV      DPTR,#key
B1:00DF64 1225A9            LCALL    ?C?PSTXDATA
B1:00DF67 C003              PUSH     AR3
B1:00DF69 C002              PUSH     AR2
B1:00DF6B C001              PUSH     AR1
B1:00DF6D 7B01              MOV      R3,#01H
B1:00DF6F 7A31              MOV      R2,#HIGH K1
B1:00DF71 790E              MOV      R1,#LOW K1
B1:00DF73 9033BF            MOV      DPTR,#?_generate_subkey?BYTE+03H
B1:00DF76 1225A9            LCALL    ?C?PSTXDATA
B1:00DF79 7A31              MOV      R2,#HIGH K2
B1:00DF7B 791E              MOV      R1,#LOW K2
B1:00DF7D 9033C2            MOV      DPTR,#?_generate_subkey?BYTE+06H
B1:00DF80 1225A9            LCALL    ?C?PSTXDATA
B1:00DF83 D001              POP      AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 417


B1:00DF85 D002              POP      AR2
B1:00DF87 D003              POP      AR3
B1:00DF89 12E0E6            LCALL    _generate_subkey
B1:00DF8C 9030C9            MOV      DPTR,#message_length
B1:00DF8F E0                MOVX     A,@DPTR
B1:00DF90 FC                MOV      R4,A
B1:00DF91 A3                INC      DPTR
B1:00DF92 E0                MOVX     A,@DPTR
B1:00DF93 FD                MOV      R5,A
B1:00DF94 240F              ADD      A,#0FH
B1:00DF96 FF                MOV      R7,A
B1:00DF97 E4                CLR      A
B1:00DF98 3C                ADDC     A,R4
B1:00DF99 C4                SWAP     A
B1:00DF9A F8                MOV      R0,A
B1:00DF9B 54F0              ANL      A,#0F0H
B1:00DF9D C8                XCH      A,R0
B1:00DF9E EF                MOV      A,R7
B1:00DF9F C4                SWAP     A
B1:00DFA0 540F              ANL      A,#0FH
B1:00DFA2 48                ORL      A,R0
B1:00DFA3 90312F            MOV      DPTR,#n
B1:00DFA6 F0                MOVX     @DPTR,A
B1:00DFA7 7004              JNZ      ?C0024?AES_CMAC
B1:00DFA9 04                INC      A
B1:00DFAA F0                MOVX     @DPTR,A
B1:00DFAB 800C              SJMP     ?C0049?AES_CMAC
B1:00DFAD         ?C0024?AES_CMAC:
B1:00DFAD ED                MOV      A,R5
B1:00DFAE 540F              ANL      A,#0FH
B1:00DFB0 7007              JNZ      ?C0026?AES_CMAC
B1:00DFB2 90312E            MOV      DPTR,#flag
B1:00DFB5 04                INC      A
B1:00DFB6 F0                MOVX     @DPTR,A
B1:00DFB7 8005              SJMP     ?C0025?AES_CMAC
B1:00DFB9         ?C0026?AES_CMAC:
B1:00DFB9         
B1:00DFB9 E4                CLR      A
B1:00DFBA 90312E            MOV      DPTR,#flag
B1:00DFBD F0                MOVX     @DPTR,A
B1:00DFBE         ?C0025?AES_CMAC:
B1:00DFBE 90312E            MOV      DPTR,#flag
B1:00DFC1 E0                MOVX     A,@DPTR
B1:00DFC2 6029              JZ       ?C0028?AES_CMAC
B1:00DFC4 A3                INC      DPTR
B1:00DFC5 12C713            LCALL    ?L?COM04E7
B1:00DFC8 12711F            LCALL    ?L?COM028B
B1:00DFCB 9030C6            MOV      DPTR,#message
B1:00DFCE 12E4C3            LCALL    ?L?COM0070
B1:00DFD1 3E                ADDC     A,R6
B1:00DFD2 FA                MOV      R2,A
B1:00DFD3 C003              PUSH     AR3
B1:00DFD5 C002              PUSH     AR2
B1:00DFD7 C001              PUSH     AR1
B1:00DFD9 7B01              MOV      R3,#01H
B1:00DFDB 7A31              MOV      R2,#HIGH K1
B1:00DFDD 790E              MOV      R1,#LOW K1
B1:00DFDF 12E0B4            LCALL    ?L?COM0237
B1:00DFE2 12E6AC            LCALL    ?L?COM04C6
B1:00DFE5 D001              POP      AR1
B1:00DFE7 D002              POP      AR2
B1:00DFE9 D003              POP      AR3
B1:00DFEB 8044              SJMP     ?C0050?AES_CMAC
B1:00DFED         ?C0028?AES_CMAC:
B1:00DFED 90312F            MOV      DPTR,#n
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 418


B1:00DFF0 12C713            LCALL    ?L?COM04E7
B1:00DFF3 12711F            LCALL    ?L?COM028B
B1:00DFF6 9030C6            MOV      DPTR,#message
B1:00DFF9 12E4C3            LCALL    ?L?COM0070
B1:00DFFC 3E                ADDC     A,R6
B1:00DFFD FA                MOV      R2,A
B1:00DFFE C003              PUSH     AR3
B1:00E000 C002              PUSH     AR2
B1:00E002 C001              PUSH     AR1
B1:00E004 7B01              MOV      R3,#01H
B1:00E006 7A30              MOV      R2,#HIGH padded
B1:00E008 79FE              MOV      R1,#LOW padded
B1:00E00A 904047            MOV      DPTR,#?_padding?BYTE+03H
B1:00E00D 1225A9            LCALL    ?C?PSTXDATA
B1:00E010 9030CA            MOV      DPTR,#message_length+01H
B1:00E013 E0                MOVX     A,@DPTR
B1:00E014 540F              ANL      A,#0FH
B1:00E016 90404A            MOV      DPTR,#?_padding?BYTE+06H
B1:00E019 F0                MOVX     @DPTR,A
B1:00E01A D001              POP      AR1
B1:00E01C D002              POP      AR2
B1:00E01E D003              POP      AR3
B1:00E020 12F8AA            LCALL    _padding
B1:00E023 7B01              MOV      R3,#01H
B1:00E025 7A31              MOV      R2,#HIGH K2
B1:00E027 791E              MOV      R1,#LOW K2
B1:00E029 11B4              ACALL    ?L?COM0237
B1:00E02B D1AC              ACALL    ?L?COM04C6
B1:00E02D 7A30              MOV      R2,#HIGH padded
B1:00E02F 79FE              MOV      R1,#LOW padded
B1:00E031         
B1:00E031 11BA              ACALL    _xor_128
B1:00E033         ?C0029?AES_CMAC:
B1:00E033 E4                CLR      A
B1:00E034 903130            MOV      DPTR,#i
B1:00E037 F0                MOVX     @DPTR,A
B1:00E038         ?C0030?AES_CMAC:
B1:00E038 903130            MOV      DPTR,#i
B1:00E03B E0                MOVX     A,@DPTR
B1:00E03C FF                MOV      R7,A
B1:00E03D C3                CLR      C
B1:00E03E 9410              SUBB     A,#010H
B1:00E040 500B              JNC      ?C0031?AES_CMAC
B1:00E042 74CE              MOV      A,#LOW X
B1:00E044 2F                ADD      A,R7
B1:00E045 5126              ACALL    ?L?COM0617
B1:00E047 E4                CLR      A
B1:00E048 F0                MOVX     @DPTR,A
B1:00E049 511F              ACALL    ?L?COM0555
B1:00E04B 80EB              SJMP     ?C0030?AES_CMAC
B1:00E04D         ?C0031?AES_CMAC:
B1:00E04D E4                CLR      A
B1:00E04E 903130            MOV      DPTR,#i
B1:00E051 F0                MOVX     @DPTR,A
B1:00E052         ?C0033?AES_CMAC:
B1:00E052 90312F            MOV      DPTR,#n
B1:00E055 E0                MOVX     A,@DPTR
B1:00E056 14                DEC      A
B1:00E057 FF                MOV      R7,A
B1:00E058 A3                INC      DPTR
B1:00E059 E0                MOVX     A,@DPTR
B1:00E05A FE                MOV      R6,A
B1:00E05B C3                CLR      C
B1:00E05C 9F                SUBB     A,R7
B1:00E05D 5024              JNC      ?C0034?AES_CMAC
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 419


B1:00E05F EE                MOV      A,R6
B1:00E060 75F010            MOV      B,#010H
B1:00E063 A4                MUL      AB
B1:00E064 FF                MOV      R7,A
B1:00E065 9030C6            MOV      DPTR,#message
B1:00E068 91C3              ACALL    ?L?COM0070
B1:00E06A 35F0              ADDC     A,B
B1:00E06C FA                MOV      R2,A
B1:00E06D 11B4              ACALL    ?L?COM0237
B1:00E06F 7B01              MOV      R3,#01H
B1:00E071 31FD              ACALL    ?L?COM0141
B1:00E073 7A30              MOV      R2,#HIGH X
B1:00E075 79CE              MOV      R1,#LOW X
B1:00E077 12D7CF            LCALL    ?L?COM023B
B1:00E07A 9030C3            MOV      DPTR,#key
B1:00E07D 5119              ACALL    ?L?COM0556
B1:00E07F 511F              ACALL    ?L?COM0555
B1:00E081 80CF              SJMP     ?C0033?AES_CMAC
B1:00E083         ?C0034?AES_CMAC:
B1:00E083 7A30              MOV      R2,#HIGH M_last
B1:00E085 79EE              MOV      R1,#LOW M_last
B1:00E087 11B2              ACALL    ?L?COM0236
B1:00E089 31FD              ACALL    ?L?COM0141
B1:00E08B 7A30              MOV      R2,#HIGH X
B1:00E08D 79CE              MOV      R1,#LOW X
B1:00E08F 12D7CF            LCALL    ?L?COM023B
B1:00E092 9030C3            MOV      DPTR,#key
B1:00E095 5119              ACALL    ?L?COM0556
B1:00E097 E4                CLR      A
B1:00E098 903130            MOV      DPTR,#i
B1:00E09B F0                MOVX     @DPTR,A
B1:00E09C         ?C0036?AES_CMAC:
B1:00E09C 903130            MOV      DPTR,#i
B1:00E09F E0                MOVX     A,@DPTR
B1:00E0A0 FF                MOV      R7,A
B1:00E0A1 24CE              ADD      A,#LOW X
B1:00E0A3 5126              ACALL    ?L?COM0617
B1:00E0A5 E0                MOVX     A,@DPTR
B1:00E0A6 9030CB            MOV      DPTR,#mac
B1:00E0A9 D1C0              ACALL    ?L?COM030A
B1:00E0AB 511F              ACALL    ?L?COM0555
B1:00E0AD E0                MOVX     A,@DPTR
B1:00E0AE B410EB            CJNE     A,#010H,?C0036?AES_CMAC
B1:00E0B1 22                RET      
----- FUNCTION _aes_cmac_calculate (END) -------


----- FUNCTION ?L?COM0236 (BEGIN) -----
B1:00E0B2 7B01              MOV      R3,#01H
B1:00E0B4         ?L?COM0237:
B1:00E0B4 903E99            MOV      DPTR,#?_xor_128?BYTE+03H
B1:00E0B7 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0236 (END) -------


----- FUNCTION _xor_128 (BEGIN) -----
B1:00E0BA 903E96            MOV      DPTR,#a
B1:00E0BD 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'count' assigned to Register 'R7' ----
B1:00E0C0 E4                CLR      A
B1:00E0C1 FF                MOV      R7,A
B1:00E0C2         ?C0001?AES_CMAC:
B1:00E0C2 903E99            MOV      DPTR,#b
B1:00E0C5 122589            LCALL    ?C?PLDXDATA
B1:00E0C8 8F82              MOV      DPL,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 420


B1:00E0CA 126DCA            LCALL    ?L?COM01DA
B1:00E0CD FE                MOV      R6,A
B1:00E0CE 903E96            MOV      DPTR,#a
B1:00E0D1 122589            LCALL    ?C?PLDXDATA
B1:00E0D4 8F82              MOV      DPL,R7
B1:00E0D6 126DCA            LCALL    ?L?COM01DA
B1:00E0D9 6E                XRL      A,R6
B1:00E0DA FE                MOV      R6,A
B1:00E0DB 903E9C            MOV      DPTR,#out
B1:00E0DE D1C1              ACALL    ?L?COM030B
B1:00E0E0 0F                INC      R7
B1:00E0E1 EF                MOV      A,R7
B1:00E0E2 B410DD            CJNE     A,#010H,?C0001?AES_CMAC
B1:00E0E5 22                RET      
----- FUNCTION _xor_128 (END) -------


----- FUNCTION _generate_subkey (BEGIN) -----
B1:00E0E6 9033BC            MOV      DPTR,#key
B1:00E0E9 1225A9            LCALL    ?C?PSTXDATA
B1:00E0EC 78E5              MOV      R0,#LOW const_Zero
B1:00E0EE 7C33              MOV      R4,#HIGH const_Zero
B1:00E0F0 7A31              MOV      R2,#HIGH _?ix1000
B1:00E0F2 79C3              MOV      R1,#LOW _?ix1000
B1:00E0F4 512E              ACALL    ?L?COM0077
B1:00E0F6 78F5              MOV      R0,#LOW const_Rb
B1:00E0F8 7C33              MOV      R4,#HIGH const_Rb
B1:00E0FA 7A31              MOV      R2,#HIGH _?ix1001
B1:00E0FC 79D3              MOV      R1,#LOW _?ix1001
B1:00E0FE 512E              ACALL    ?L?COM0077
B1:00E100 7B01              MOV      R3,#01H
B1:00E102 7A33              MOV      R2,#HIGH const_Zero
B1:00E104 79E5              MOV      R1,#LOW const_Zero
B1:00E106 5113              ACALL    ?L?COM0142
B1:00E108 7A33              MOV      R2,#HIGH L
B1:00E10A 79C5              MOV      R1,#LOW L
B1:00E10C 12D7CF            LCALL    ?L?COM023B
B1:00E10F 9033BC            MOV      DPTR,#key
B1:00E112 5119              ACALL    ?L?COM0556
B1:00E114 9033C5            MOV      DPTR,#L
B1:00E117 E0                MOVX     A,@DPTR
B1:00E118 20E70E            JB       ACC.7,?C0011?AES_CMAC
B1:00E11B 9033BF            MOV      DPTR,#K1
B1:00E11E 122589            LCALL    ?C?PLDXDATA
B1:00E121 3176              ACALL    ?L?COM0443
B1:00E123 7B01              MOV      R3,#01H
B1:00E125 318C              ACALL    ?L?COM0618
B1:00E127 8013              SJMP     ?C0012?AES_CMAC
B1:00E129         ?C0011?AES_CMAC:
B1:00E129 3185              ACALL    ?L?COM033D
B1:00E12B 3176              ACALL    ?L?COM0443
B1:00E12D 318C              ACALL    ?L?COM0618
B1:00E12F 7A33              MOV      R2,#HIGH const_Rb
B1:00E131 79F5              MOV      R1,#LOW const_Rb
B1:00E133 11B2              ACALL    ?L?COM0236
B1:00E135 9033BF            MOV      DPTR,#K1
B1:00E138 317C              ACALL    ?L?COM033C
B1:00E13A 11BA              ACALL    _xor_128
B1:00E13C         ?C0012?AES_CMAC:
B1:00E13C 9033BF            MOV      DPTR,#K1
B1:00E13F 12975B            LCALL    ?L?COM006B
B1:00E142 20E716            JB       ACC.7,?C0013?AES_CMAC
B1:00E145 C003              PUSH     AR3
B1:00E147 C002              PUSH     AR2
B1:00E149 C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 421


B1:00E14B 9033C2            MOV      DPTR,#K2
B1:00E14E 122589            LCALL    ?C?PLDXDATA
B1:00E151 3176              ACALL    ?L?COM0443
B1:00E153 D001              POP      AR1
B1:00E155 D002              POP      AR2
B1:00E157 D003              POP      AR3
B1:00E159 8035              SJMP     _leftshift_onebit
B1:00E15B         ?C0013?AES_CMAC:
B1:00E15B 3185              ACALL    ?L?COM033D
B1:00E15D 3176              ACALL    ?L?COM0443
B1:00E15F 9033BF            MOV      DPTR,#K1
B1:00E162 122589            LCALL    ?C?PLDXDATA
B1:00E165 3190              ACALL    _leftshift_onebit
B1:00E167 7B01              MOV      R3,#01H
B1:00E169 7A33              MOV      R2,#HIGH const_Rb
B1:00E16B 79F5              MOV      R1,#LOW const_Rb
B1:00E16D 11B4              ACALL    ?L?COM0237
B1:00E16F 9033C2            MOV      DPTR,#K2
B1:00E172 317C              ACALL    ?L?COM033C
B1:00E174 01BA              AJMP     _xor_128
----- FUNCTION _generate_subkey (END) -------


----- FUNCTION ?L?COM0443 (BEGIN) -----
B1:00E176 903F67            MOV      DPTR,#?_leftshift_onebit?BYTE+03H
B1:00E179 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0443 (END) -------


----- FUNCTION ?L?COM033C (BEGIN) -----
B1:00E17C 122589            LCALL    ?C?PLDXDATA
B1:00E17F 903E9C            MOV      DPTR,#?_xor_128?BYTE+06H
B1:00E182 1225A9            LCALL    ?C?PSTXDATA
B1:00E185         ?L?COM033D:
B1:00E185 7B01              MOV      R3,#01H
B1:00E187 7A33              MOV      R2,#HIGH tmp
B1:00E189 79D5              MOV      R1,#LOW tmp
B1:00E18B 22                RET      
----- FUNCTION ?L?COM033C (END) -------


----- FUNCTION ?L?COM0618 (BEGIN) -----
B1:00E18C 7A33              MOV      R2,#HIGH L
B1:00E18E 79C5              MOV      R1,#LOW L
----- FUNCTION _leftshift_onebit (BEGIN) -----
B1:00E190 903F64            MOV      DPTR,#input
B1:00E193 1225A9            LCALL    ?C?PSTXDATA
B1:00E196 E4                CLR      A
B1:00E197 903F6B            MOV      DPTR,#overflow
B1:00E19A F0                MOVX     @DPTR,A
B1:00E19B 903F6A            MOV      DPTR,#count
B1:00E19E 740F              MOV      A,#0FH
B1:00E1A0 F0                MOVX     @DPTR,A
B1:00E1A1         ?C0005?AES_CMAC:
B1:00E1A1 903F6A            MOV      DPTR,#count
B1:00E1A4 F195              ACALL    ?L?COM0615
B1:00E1A6 4054              JC       ?C0010?AES_CMAC
B1:00E1A8 903F64            MOV      DPTR,#input
B1:00E1AB 122589            LCALL    ?C?PLDXDATA
B1:00E1AE EF                MOV      A,R7
B1:00E1AF 33                RLC      A
B1:00E1B0 95E0              SUBB     A,ACC
B1:00E1B2 FE                MOV      R6,A
B1:00E1B3 8F82              MOV      DPL,R7
B1:00E1B5 F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 422


B1:00E1B7 121FF0            LCALL    ?C?CLDOPTR
B1:00E1BA 25E0              ADD      A,ACC
B1:00E1BC FD                MOV      R5,A
B1:00E1BD 903F67            MOV      DPTR,#output
B1:00E1C0 12D70E            LCALL    ?L?COM0172
B1:00E1C3 ED                MOV      A,R5
B1:00E1C4 122084            LCALL    ?C?CSTOPTR
B1:00E1C7 903F6A            MOV      DPTR,#count
B1:00E1CA E0                MOVX     A,@DPTR
B1:00E1CB FF                MOV      R7,A
B1:00E1CC 33                RLC      A
B1:00E1CD 95E0              SUBB     A,ACC
B1:00E1CF FE                MOV      R6,A
B1:00E1D0 1271F1            LCALL    ?L?COM0383
B1:00E1D3 121FB3            LCALL    ?C?CLDPTR
B1:00E1D6 FD                MOV      R5,A
B1:00E1D7 903F6B            MOV      DPTR,#overflow
B1:00E1DA E0                MOVX     A,@DPTR
B1:00E1DB 4D                ORL      A,R5
B1:00E1DC 122072            LCALL    ?C?CSTPTR
B1:00E1DF 903F64            MOV      DPTR,#input
B1:00E1E2 12D70E            LCALL    ?L?COM0172
B1:00E1E5 121FF0            LCALL    ?C?CLDOPTR
B1:00E1E8 7F00              MOV      R7,#00H
B1:00E1EA 30E702            JNB      ACC.7,?C0008?AES_CMAC
B1:00E1ED 7F01              MOV      R7,#01H
B1:00E1EF         ?C0008?AES_CMAC:
B1:00E1EF         ?C0009?AES_CMAC:
B1:00E1EF 903F6B            MOV      DPTR,#overflow
B1:00E1F2 EF                MOV      A,R7
B1:00E1F3 F0                MOVX     @DPTR,A
B1:00E1F4 903F6A            MOV      DPTR,#count
B1:00E1F7 E0                MOVX     A,@DPTR
B1:00E1F8 14                DEC      A
B1:00E1F9 F0                MOVX     @DPTR,A
B1:00E1FA 80A5              SJMP     ?C0005?AES_CMAC
B1:00E1FC         ?C0010?AES_CMAC:
B1:00E1FC 22                RET      
----- FUNCTION _leftshift_onebit (END) -------


----- FUNCTION ?L?COM0141 (BEGIN) -----
B1:00E1FD 7A30              MOV      R2,#HIGH Y
B1:00E1FF 79DE              MOV      R1,#LOW Y
B1:00E201 903E9C            MOV      DPTR,#?_xor_128?BYTE+06H
B1:00E204 1225A9            LCALL    ?C?PSTXDATA
B1:00E207 7A30              MOV      R2,#HIGH X
B1:00E209 79CE              MOV      R1,#LOW X
B1:00E20B 11BA              ACALL    _xor_128
B1:00E20D 7B01              MOV      R3,#01H
B1:00E20F 7A30              MOV      R2,#HIGH Y
B1:00E211 79DE              MOV      R1,#LOW Y
B1:00E213         ?L?COM0142:
B1:00E213 903EC6            MOV      DPTR,#?_ZW_AES_ecb?BYTE+03H
B1:00E216 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0141 (END) -------


----- FUNCTION ?L?COM0556 (BEGIN) -----
B1:00E219 122589            LCALL    ?C?PLDXDATA
B1:00E21C 021D4F            LJMP     ?INTERBANK_TABLE?_ZW_AES_ecb
----- FUNCTION ?L?COM0556 (END) -------


----- FUNCTION ?L?COM0555 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 423


B1:00E21F 903130            MOV      DPTR,#i
B1:00E222 E0                MOVX     A,@DPTR
B1:00E223 04                INC      A
B1:00E224 F0                MOVX     @DPTR,A
B1:00E225 22                RET      
----- FUNCTION ?L?COM0555 (END) -------


----- FUNCTION ?L?COM0617 (BEGIN) -----
B1:00E226 F582              MOV      DPL,A
B1:00E228 E4                CLR      A
B1:00E229 3430              ADDC     A,#HIGH X
B1:00E22B F583              MOV      DPH,A
B1:00E22D 22                RET      
----- FUNCTION ?L?COM0617 (END) -------


----- FUNCTION ?L?COM0077 (BEGIN) -----
B1:00E22E 7D01              MOV      R5,#01H
B1:00E230 7BFF              MOV      R3,#0FFH
B1:00E232         ?L?COM0078:
B1:00E232 7E00              MOV      R6,#00H
B1:00E234 7F10              MOV      R7,#010H
B1:00E236 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM0077 (END) -------


----- FUNCTION _next_nonce_instantiate (BEGIN) -----
B1:00E239 903131            MOV      DPTR,#ctx
B1:00E23C 1225A9            LCALL    ?C?PSTXDATA
B1:00E23F 783D              MOV      R0,#LOW constant_nonce
B1:00E241 7C31              MOV      R4,#HIGH constant_nonce
B1:00E243 7D01              MOV      R5,#01H
B1:00E245 7BFF              MOV      R3,#0FFH
B1:00E247 7A31              MOV      R2,#HIGH _?ix1001
B1:00E249 79F2              MOV      R1,#LOW _?ix1001
B1:00E24B 5132              ACALL    ?L?COM0078
B1:00E24D 784D              MOV      R0,#LOW temp
B1:00E24F 7C31              MOV      R4,#HIGH temp
B1:00E251 7D01              MOV      R5,#01H
B1:00E253 903134            MOV      DPTR,#ei_sender
B1:00E256 122589            LCALL    ?C?PLDXDATA
B1:00E259 5132              ACALL    ?L?COM0078
B1:00E25B 785D              MOV      R0,#LOW temp+010H
B1:00E25D 7C31              MOV      R4,#HIGH temp+010H
B1:00E25F 7D01              MOV      R5,#01H
B1:00E261 903137            MOV      DPTR,#ei_receiver
B1:00E264 122589            LCALL    ?C?PLDXDATA
B1:00E267 5132              ACALL    ?L?COM0078
B1:00E269 7B01              MOV      R3,#01H
B1:00E26B 7A31              MOV      R2,#HIGH temp
B1:00E26D 794D              MOV      R1,#LOW temp
B1:00E26F 12DEB9            LCALL    ?L?COM00F6
B1:00E272 7A31              MOV      R2,#HIGH X
B1:00E274 796D              MOV      R1,#LOW X
B1:00E276 A3                INC      DPTR
B1:00E277 1225A9            LCALL    ?C?PSTXDATA
B1:00E27A 7A31              MOV      R2,#HIGH constant_nonce
B1:00E27C 793D              MOV      R1,#LOW constant_nonce
B1:00E27E 12DF61            LCALL    _aes_cmac_calculate
B1:00E281 9032CE            MOV      DPTR,#?_ckdf_nonce0_expand?BYTE+03H
B1:00E284 9195              ACALL    ?L?COM03F8
B1:00E286 7A31              MOV      R2,#HIGH X
B1:00E288 796D              MOV      R1,#LOW X
B1:00E28A D106              ACALL    _ckdf_nonce0_expand
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 424


B1:00E28C 903EA2            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+03H
B1:00E28F 9195              ACALL    ?L?COM03F8
B1:00E291 90313A            MOV      DPTR,#k_nonce
B1:00E294 122589            LCALL    ?C?PLDXDATA
B1:00E297 903EA5            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+06H
B1:00E29A 1225A9            LCALL    ?C?PSTXDATA
B1:00E29D 903131            MOV      DPTR,#ctx
B1:00E2A0 122589            LCALL    ?C?PLDXDATA
B1:;----                  JMP      _AES_CTR_DRBG_Instantiate
----- FUNCTION _next_nonce_instantiate (END) -------


----- FUNCTION _AES_CTR_DRBG_Instantiate (BEGIN) -----
B1:00E2A3 903E9F            MOV      DPTR,#ctx
B1:00E2A6 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'i' assigned to Register 'R7' ----
B1:00E2A9 E4                CLR      A
B1:00E2AA FF                MOV      R7,A
B1:00E2AB         ?C0013?CTR_DRBG:
B1:00E2AB 903EA2            MOV      DPTR,#entropy
B1:00E2AE 122589            LCALL    ?C?PLDXDATA
B1:00E2B1 E9                MOV      A,R1
B1:00E2B2 2F                ADD      A,R7
B1:00E2B3 F9                MOV      R1,A
B1:00E2B4 E4                CLR      A
B1:00E2B5 3A                ADDC     A,R2
B1:00E2B6 FA                MOV      R2,A
B1:00E2B7 C003              PUSH     AR3
B1:00E2B9 C002              PUSH     AR2
B1:00E2BB C001              PUSH     AR1
B1:00E2BD 121FB3            LCALL    ?C?CLDPTR
B1:00E2C0 FE                MOV      R6,A
B1:00E2C1 903EA5            MOV      DPTR,#personal
B1:00E2C4 122589            LCALL    ?C?PLDXDATA
B1:00E2C7 8F82              MOV      DPL,R7
B1:00E2C9 126DCA            LCALL    ?L?COM01DA
B1:00E2CC 6E                XRL      A,R6
B1:00E2CD D001              POP      AR1
B1:00E2CF D002              POP      AR2
B1:00E2D1 D003              POP      AR3
B1:00E2D3 122072            LCALL    ?C?CSTPTR
B1:00E2D6 0F                INC      R7
B1:00E2D7 EF                MOV      A,R7
B1:00E2D8 B420D0            CJNE     A,#020H,?C0013?CTR_DRBG
B1:00E2DB         ?C0014?CTR_DRBG:
B1:00E2DB 919E              ACALL    ?L?COM0554
B1:00E2DD 71E0              ACALL    ?L?COM0246
B1:00E2DF FA                MOV      R2,A
B1:00E2E0 122917            LCALL    ?C?MEMSET
B1:00E2E3 919E              ACALL    ?L?COM0554
B1:00E2E5 125C41            LCALL    ?L?COM00B6
B1:00E2E8 122917            LCALL    ?C?MEMSET
B1:00E2EB 903E9F            MOV      DPTR,#ctx
B1:00E2EE 127111            LCALL    ?L?COM0287
B1:00E2F1 903EA2            MOV      DPTR,#entropy
B1:00E2F4 122589            LCALL    ?C?PLDXDATA
B1:00E2F7 9040E7            MOV      DPTR,#?_AES_CTR_DRBG_Reseed?BYTE+03H
B1:00E2FA 1225A9            LCALL    ?C?PSTXDATA
B1:00E2FD 903E9F            MOV      DPTR,#ctx
B1:00E300 122589            LCALL    ?C?PLDXDATA
B1:;----                  JMP      _AES_CTR_DRBG_Reseed
----- FUNCTION _AES_CTR_DRBG_Instantiate (END) -------


----- FUNCTION _AES_CTR_DRBG_Reseed (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 425


;---- Variable 'ctx' assigned to Register 'R1/R2/R3' ----
B1:00E303 C003              PUSH     AR3
B1:00E305 C002              PUSH     AR2
B1:00E307 C001              PUSH     AR1
B1:00E309 9040E7            MOV      DPTR,#seed
B1:00E30C 122589            LCALL    ?C?PLDXDATA
B1:00E30F 9036C8            MOV      DPTR,#?_AES_CTR_DRBG_Update?BYTE+03H
B1:00E312 1225A9            LCALL    ?C?PSTXDATA
B1:00E315 D001              POP      AR1
B1:00E317 D002              POP      AR2
B1:00E319 D003              POP      AR3
B1:;----                  JMP      _AES_CTR_DRBG_Update
----- FUNCTION _AES_CTR_DRBG_Reseed (END) -------


----- FUNCTION _AES_CTR_DRBG_Update (BEGIN) -----
B1:00E31B 9036C5            MOV      DPTR,#ctx
B1:00E31E 71D2              ACALL    ?L?COM03F9
B1:00E320 7B01              MOV      R3,#01H
B1:00E322 7A36              MOV      R2,#HIGH tmp
B1:00E324 79CD              MOV      R1,#LOW tmp
B1:00E326 9036ED            MOV      DPTR,#t
B1:00E329 71D2              ACALL    ?L?COM03F9
B1:00E32B         ?C0005?CTR_DRBG:
B1:00E32B C3                CLR      C
B1:00E32C 9036CC            MOV      DPTR,#i+01H
B1:00E32F E0                MOVX     A,@DPTR
B1:00E330 9420              SUBB     A,#020H
B1:00E332 9036CB            MOV      DPTR,#i
B1:00E335 E0                MOVX     A,@DPTR
B1:00E336 9400              SUBB     A,#00H
B1:00E338 5036              JNC      ?C0006?CTR_DRBG
B1:00E33A 9036C5            MOV      DPTR,#ctx
B1:00E33D 125C41            LCALL    ?L?COM00B6
B1:00E340 B1DD              ACALL    ?L?COM05D7
B1:00E342 71DD              ACALL    ?L?COM0245
B1:00E344 FA                MOV      R2,A
B1:00E345 C003              PUSH     AR3
B1:00E347 C002              PUSH     AR2
B1:00E349 C001              PUSH     AR1
B1:00E34B 9036C5            MOV      DPTR,#ctx
B1:00E34E 125C41            LCALL    ?L?COM00B6
B1:00E351 5113              ACALL    ?L?COM0142
B1:00E353 9036ED            MOV      DPTR,#t
B1:00E356 12D7CC            LCALL    ?L?COM023A
B1:00E359 D001              POP      AR1
B1:00E35B D002              POP      AR2
B1:00E35D D003              POP      AR3
B1:00E35F 121D4F            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
B1:00E362 9036EE            MOV      DPTR,#t+01H
B1:00E365 127161            LCALL    ?L?COM0301
B1:00E368 9036CB            MOV      DPTR,#i
B1:00E36B 127161            LCALL    ?L?COM0301
B1:00E36E 80BB              SJMP     ?C0005?CTR_DRBG
B1:00E370         ?C0006?CTR_DRBG:
B1:00E370 71D5              ACALL    ?L?COM03FA
B1:00E372         ?C0008?CTR_DRBG:
B1:00E372 9036CB            MOV      DPTR,#i
B1:00E375 E0                MOVX     A,@DPTR
B1:00E376 FE                MOV      R6,A
B1:00E377 A3                INC      DPTR
B1:00E378 E0                MOVX     A,@DPTR
B1:00E379 FF                MOV      R7,A
B1:00E37A 24CD              ADD      A,#LOW tmp
B1:00E37C F582              MOV      DPL,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 426


B1:00E37E 7436              MOV      A,#HIGH tmp
B1:00E380 3E                ADDC     A,R6
B1:00E381 F583              MOV      DPH,A
B1:00E383 C083              PUSH     DPH
B1:00E385 C082              PUSH     DPL
B1:00E387 E0                MOVX     A,@DPTR
B1:00E388 FD                MOV      R5,A
B1:00E389 9036C8            MOV      DPTR,#__data
B1:00E38C 12D70E            LCALL    ?L?COM0172
B1:00E38F 121FF0            LCALL    ?C?CLDOPTR
B1:00E392 FF                MOV      R7,A
B1:00E393 ED                MOV      A,R5
B1:00E394 6F                XRL      A,R7
B1:00E395 D082              POP      DPL
B1:00E397 D083              POP      DPH
B1:00E399 F0                MOVX     @DPTR,A
B1:00E39A 9036CB            MOV      DPTR,#i
B1:00E39D 123F7F            LCALL    ?L?COM0081
B1:00E3A0 9036CB            MOV      DPTR,#i
B1:00E3A3 E0                MOVX     A,@DPTR
B1:00E3A4 7004              JNZ      ?C0023?CTR_DRBG
B1:00E3A6 A3                INC      DPTR
B1:00E3A7 E0                MOVX     A,@DPTR
B1:00E3A8 6420              XRL      A,#020H
B1:00E3AA         ?C0023?CTR_DRBG:
B1:00E3AA 70C6              JNZ      ?C0008?CTR_DRBG
B1:00E3AC         ?C0009?CTR_DRBG:
B1:00E3AC 71DD              ACALL    ?L?COM0245
B1:00E3AE A801              MOV      R0,AR1
B1:00E3B0 FC                MOV      R4,A
B1:00E3B1 AD03              MOV      R5,AR3
B1:00E3B3 7B01              MOV      R3,#01H
B1:00E3B5 7A36              MOV      R2,#HIGH tmp
B1:00E3B7 79CD              MOV      R1,#LOW tmp
B1:00E3B9 5132              ACALL    ?L?COM0078
B1:00E3BB 9036C5            MOV      DPTR,#ctx
B1:00E3BE 122589            LCALL    ?C?PLDXDATA
B1:00E3C1 E9                MOV      A,R1
B1:00E3C2 2401              ADD      A,#01H
B1:00E3C4 F9                MOV      R1,A
B1:00E3C5 E4                CLR      A
B1:00E3C6 3A                ADDC     A,R2
B1:00E3C7 A801              MOV      R0,AR1
B1:00E3C9 7A36              MOV      R2,#HIGH tmp+010H
B1:00E3CB 79DD              MOV      R1,#LOW tmp+010H
B1:00E3CD D1B6              ACALL    ?L?COM051E
B1:00E3CF 021F8D            LJMP     ?C?COPY
----- FUNCTION _AES_CTR_DRBG_Update (END) -------


----- FUNCTION ?L?COM03F9 (BEGIN) -----
B1:00E3D2 1225A9            LCALL    ?C?PSTXDATA
B1:00E3D5         ?L?COM03FA:
B1:00E3D5 E4                CLR      A
B1:00E3D6 9036CB            MOV      DPTR,#i
B1:00E3D9 F0                MOVX     @DPTR,A
B1:00E3DA A3                INC      DPTR
B1:00E3DB F0                MOVX     @DPTR,A
B1:00E3DC 22                RET      
----- FUNCTION ?L?COM03F9 (END) -------


----- FUNCTION ?L?COM0245 (BEGIN) -----
B1:00E3DD 9036C5            MOV      DPTR,#ctx
B1:00E3E0         ?L?COM0246:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 427


B1:00E3E0 122589            LCALL    ?C?PLDXDATA
B1:00E3E3 E9                MOV      A,R1
B1:00E3E4 2411              ADD      A,#011H
B1:00E3E6 F9                MOV      R1,A
B1:00E3E7 E4                CLR      A
B1:00E3E8 3A                ADDC     A,R2
B1:00E3E9 22                RET      
----- FUNCTION ?L?COM0245 (END) -------


----- FUNCTION _AES_CTR_DRBG_Generate (BEGIN) -----
B1:00E3EA 90371A            MOV      DPTR,#ctx
B1:00E3ED 1225A9            LCALL    ?C?PSTXDATA
B1:00E3F0 903742            MOV      DPTR,#size
B1:00E3F3 12D704            LCALL    ?L?COM00EA
B1:00E3F6         ?C0017?CTR_DRBG:
B1:00E3F6 903742            MOV      DPTR,#size
B1:00E3F9 E0                MOVX     A,@DPTR
B1:00E3FA 7002              JNZ      ?C0024?CTR_DRBG
B1:00E3FC A3                INC      DPTR
B1:00E3FD E0                MOVX     A,@DPTR
B1:00E3FE         ?C0024?CTR_DRBG:
B1:00E3FE 606B              JZ       ?C0018?CTR_DRBG
B1:00E400 90371A            MOV      DPTR,#ctx
B1:00E403 125C41            LCALL    ?L?COM00B6
B1:00E406 B1DD              ACALL    ?L?COM05D7
B1:00E408 90371A            MOV      DPTR,#ctx
B1:00E40B 71E0              ACALL    ?L?COM0246
B1:00E40D FA                MOV      R2,A
B1:00E40E C003              PUSH     AR3
B1:00E410 C002              PUSH     AR2
B1:00E412 C001              PUSH     AR1
B1:00E414 90371A            MOV      DPTR,#ctx
B1:00E417 125C41            LCALL    ?L?COM00B6
B1:00E41A 5113              ACALL    ?L?COM0142
B1:00E41C 9186              ACALL    ?L?COM04F4
B1:00E41E 12D7CF            LCALL    ?L?COM023B
B1:00E421 D001              POP      AR1
B1:00E423 D002              POP      AR2
B1:00E425 D003              POP      AR3
B1:00E427 121D4F            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
B1:00E42A 903742            MOV      DPTR,#size
B1:00E42D 1265F9            LCALL    ?L?COM0199
B1:00E430 9410              SUBB     A,#010H
B1:00E432 EE                MOV      A,R6
B1:00E433 9400              SUBB     A,#00H
B1:00E435 5002              JNC      ?C0019?CTR_DRBG
B1:00E437 8004              SJMP     ?C0020?CTR_DRBG
B1:00E439         ?C0019?CTR_DRBG:
B1:00E439 7E00              MOV      R6,#00H
B1:00E43B 7F10              MOV      R7,#010H
B1:00E43D         ?C0020?CTR_DRBG:
B1:00E43D 903740            MOV      DPTR,#copy
B1:00E440 EE                MOV      A,R6
B1:00E441 F0                MOVX     @DPTR,A
B1:00E442 A3                INC      DPTR
B1:00E443 EF                MOV      A,R7
B1:00E444 F0                MOVX     @DPTR,A
B1:00E445 918D              ACALL    ?L?COM0616
B1:00E447 90371D            MOV      DPTR,#rand
B1:00E44A 12708E            LCALL    ?L?COM0148
B1:00E44D 7A37              MOV      R2,#HIGH __data
B1:00E44F 7920              MOV      R1,#LOW __data
B1:00E451 121F8D            LCALL    ?C?COPY
B1:00E454 918D              ACALL    ?L?COM0616
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 428


B1:00E456 FF                MOV      R7,A
B1:00E457 90371E            MOV      DPTR,#rand+01H
B1:00E45A F138              ACALL    ?L?COM0250
B1:00E45C C3                CLR      C
B1:00E45D 903743            MOV      DPTR,#size+01H
B1:00E460 E0                MOVX     A,@DPTR
B1:00E461 9F                SUBB     A,R7
B1:00E462 F0                MOVX     @DPTR,A
B1:00E463 903742            MOV      DPTR,#size
B1:00E466 E0                MOVX     A,@DPTR
B1:00E467 9E                SUBB     A,R6
B1:00E468 F0                MOVX     @DPTR,A
B1:00E469 808B              SJMP     ?C0017?CTR_DRBG
B1:00E46B         ?C0018?CTR_DRBG:
B1:00E46B 7E00              MOV      R6,#00H
B1:00E46D 7F20              MOV      R7,#020H
B1:00E46F 7D00              MOV      R5,#00H
B1:00E471 9186              ACALL    ?L?COM04F4
B1:00E473 122917            LCALL    ?C?MEMSET
B1:00E476 9186              ACALL    ?L?COM04F4
B1:00E478 9036C8            MOV      DPTR,#?_AES_CTR_DRBG_Update?BYTE+03H
B1:00E47B 1225A9            LCALL    ?C?PSTXDATA
B1:00E47E 90371A            MOV      DPTR,#ctx
B1:00E481 122589            LCALL    ?C?PLDXDATA
B1:00E484 611B              AJMP     _AES_CTR_DRBG_Update
----- FUNCTION _AES_CTR_DRBG_Generate (END) -------


----- FUNCTION ?L?COM04F4 (BEGIN) -----
B1:00E486 7B01              MOV      R3,#01H
B1:00E488 7A37              MOV      R2,#HIGH __data
B1:00E48A 7920              MOV      R1,#LOW __data
B1:00E48C 22                RET      
----- FUNCTION ?L?COM04F4 (END) -------


----- FUNCTION ?L?COM0616 (BEGIN) -----
B1:00E48D 903740            MOV      DPTR,#copy
B1:00E490 E0                MOVX     A,@DPTR
B1:00E491 FE                MOV      R6,A
B1:00E492 A3                INC      DPTR
B1:00E493 E0                MOVX     A,@DPTR
B1:00E494 22                RET      
----- FUNCTION ?L?COM0616 (END) -------


----- FUNCTION ?L?COM03F8 (BEGIN) -----
B1:00E495 7B01              MOV      R3,#01H
B1:00E497 7A31              MOV      R2,#HIGH mei
B1:00E499 797D              MOV      R1,#LOW mei
B1:00E49B 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM03F8 (END) -------


----- FUNCTION ?L?COM0554 (BEGIN) -----
B1:00E49E 7E00              MOV      R6,#00H
B1:00E4A0 7F10              MOV      R7,#010H
B1:00E4A2 7D00              MOV      R5,#00H
B1:00E4A4 903E9F            MOV      DPTR,#ctx
B1:00E4A7 22                RET      
----- FUNCTION ?L?COM0554 (END) -------


----- FUNCTION ?L?COM006F (BEGIN) -----
B1:00E4A8 24FF              ADD      A,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 429


B1:00E4AA FF                MOV      R7,A
B1:00E4AB 9036B1            MOV      DPTR,#i
B1:00E4AE E0                MOVX     A,@DPTR
B1:00E4AF 34FF              ADDC     A,#0FFH
B1:00E4B1 FE                MOV      R6,A
B1:00E4B2 EF                MOV      A,R7
B1:00E4B3 C4                SWAP     A
B1:00E4B4 F8                MOV      R0,A
B1:00E4B5 540F              ANL      A,#0FH
B1:00E4B7 C8                XCH      A,R0
B1:00E4B8 68                XRL      A,R0
B1:00E4B9 FF                MOV      R7,A
B1:00E4BA EE                MOV      A,R6
B1:00E4BB C4                SWAP     A
B1:00E4BC 54F0              ANL      A,#0F0H
B1:00E4BE 48                ORL      A,R0
B1:00E4BF FE                MOV      R6,A
B1:00E4C0 90369A            MOV      DPTR,#data_array
B1:00E4C3         ?L?COM0070:
B1:00E4C3 122589            LCALL    ?C?PLDXDATA
B1:00E4C6 E9                MOV      A,R1
B1:00E4C7 2F                ADD      A,R7
B1:00E4C8 F9                MOV      R1,A
B1:00E4C9 EA                MOV      A,R2
B1:00E4CA 22                RET      
----- FUNCTION ?L?COM006F (END) -------


----- FUNCTION _encrypt_or_decrypt (BEGIN) -----
B1:00E4CB 90369A            MOV      DPTR,#data_array
B1:00E4CE 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'data_len' assigned to Register 'R4/R5' ----
B1:00E4D1 9036C3            MOV      DPTR,#length
B1:00E4D4 1272D5            LCALL    ?L?COM0489
B1:00E4D7 E4                CLR      A
B1:00E4D8 9036B1            MOV      DPTR,#i
B1:00E4DB F0                MOVX     @DPTR,A
B1:00E4DC A3                INC      DPTR
B1:00E4DD F0                MOVX     @DPTR,A
B1:00E4DE         ?C0034?CCM:
B1:00E4DE 90369F            MOV      DPTR,#num_ctr_blks
B1:00E4E1 1265F9            LCALL    ?L?COM0199
B1:00E4E4 9036B2            MOV      DPTR,#i+01H
B1:00E4E7 E0                MOVX     A,@DPTR
B1:00E4E8 9F                SUBB     A,R7
B1:00E4E9 9036B1            MOV      DPTR,#i
B1:00E4EC E0                MOVX     A,@DPTR
B1:00E4ED 9E                SUBB     A,R6
B1:00E4EE 4002              JC       $ + 4H
B1:00E4F0 A1C5              AJMP     ?C0043?CCM
B1:00E4F2 7E00              MOV      R6,#00H
B1:00E4F4 7F10              MOV      R7,#010H
B1:00E4F6 7D00              MOV      R5,#00H
B1:00E4F8 B1C6              ACALL    ?L?COM0504
B1:00E4FA 122917            LCALL    ?C?MEMSET
B1:00E4FD E4                CLR      A
B1:00E4FE 9036B3            MOV      DPTR,#ctr
B1:00E501 F0                MOVX     @DPTR,A
B1:00E502 F19D              ACALL    ?L?COM061B
B1:00E504 9036B3            MOV      DPTR,#ctr
B1:00E507 F0                MOVX     @DPTR,A
B1:00E508 9042AF            MOV      DPTR,#n
B1:00E50B E0                MOVX     A,@DPTR
B1:00E50C FF                MOV      R7,A
B1:00E50D 7E00              MOV      R6,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 430


B1:00E50F 78B4              MOV      R0,#LOW ctr+01H
B1:00E511 7C36              MOV      R4,#HIGH ctr+01H
B1:00E513 7D01              MOV      R5,#01H
B1:00E515 9036A4            MOV      DPTR,#nonce
B1:00E518 1270FA            LCALL    ?L?COM0233
B1:00E51B 9036B1            MOV      DPTR,#i
B1:00E51E 1247B6            LCALL    ?L?COM031C
B1:00E521 9036C1            MOV      DPTR,#ctr+0EH
B1:00E524 F0                MOVX     @DPTR,A
B1:00E525 ED                MOV      A,R5
B1:00E526 A3                INC      DPTR
B1:00E527 F0                MOVX     @DPTR,A
B1:00E528 9036A9            MOV      DPTR,#key
B1:00E52B 12D6EC            LCALL    ?L?COM0179
B1:00E52E B1C6              ACALL    ?L?COM0504
B1:00E530 12D719            LCALL    _ciph_block
B1:00E533 9036B1            MOV      DPTR,#i
B1:00E536 E0                MOVX     A,@DPTR
B1:00E537 7002              JNZ      ?C0057?CCM
B1:00E539 A3                INC      DPTR
B1:00E53A E0                MOVX     A,@DPTR
B1:00E53B         ?C0057?CCM:
B1:00E53B 7024              JNZ      ?C0037?CCM
B1:00E53D 9036AF            MOV      DPTR,#mode
B1:00E540 E0                MOVX     A,@DPTR
B1:00E541 7004              JNZ      ?C0058?CCM
B1:00E543 A3                INC      DPTR
B1:00E544 E0                MOVX     A,@DPTR
B1:00E545 6401              XRL      A,#01H
B1:00E547         ?C0058?CCM:
B1:00E547 7018              JNZ      ?C0037?CCM
B1:00E549 9036AC            MOV      DPTR,#mac
B1:00E54C 122589            LCALL    ?C?PLDXDATA
B1:00E54F B1CF              ACALL    ?L?COM03E1
B1:00E551 9036A7            MOV      DPTR,#mac_len
B1:00E554 B1D5              ACALL    ?L?COM061A
B1:00E556 F1B5              ACALL    ?L?COM00D4
B1:00E558 7A36              MOV      R2,#HIGH ctr
B1:00E55A 79B3              MOV      R1,#LOW ctr
B1:00E55C 12D5A4            LCALL    _bit_xor
B1:00E55F 805C              SJMP     ?C0036?CCM
B1:00E561         ?C0037?CCM:
B1:00E561 9036B1            MOV      DPTR,#i
B1:00E564 E0                MOVX     A,@DPTR
B1:00E565 7002              JNZ      ?C0059?CCM
B1:00E567 A3                INC      DPTR
B1:00E568 E0                MOVX     A,@DPTR
B1:00E569         ?C0059?CCM:
B1:00E569 7018              JNZ      ?C0039?CCM
B1:00E56B 9036AF            MOV      DPTR,#mode
B1:00E56E E0                MOVX     A,@DPTR
B1:00E56F 7002              JNZ      ?C0060?CCM
B1:00E571 A3                INC      DPTR
B1:00E572 E0                MOVX     A,@DPTR
B1:00E573         ?C0060?CCM:
B1:00E573 700E              JNZ      ?C0039?CCM
B1:00E575 9036A1            MOV      DPTR,#block
B1:00E578 12708F            LCALL    ?L?COM0149
B1:00E57B 7A36              MOV      R2,#HIGH ctr
B1:00E57D 79B3              MOV      R1,#LOW ctr
B1:00E57F 5132              ACALL    ?L?COM0078
B1:00E581 803A              SJMP     ?C0036?CCM
B1:00E583         ?C0039?CCM:
B1:00E583 C3                CLR      C
B1:00E584 9036C4            MOV      DPTR,#length+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 431


B1:00E587 E0                MOVX     A,@DPTR
B1:00E588 9410              SUBB     A,#010H
B1:00E58A 9036C3            MOV      DPTR,#length
B1:00E58D E0                MOVX     A,@DPTR
B1:00E58E 9400              SUBB     A,#00H
B1:00E590 9036B2            MOV      DPTR,#i+01H
B1:00E593 E0                MOVX     A,@DPTR
B1:00E594 400E              JC       ?C0041?CCM
B1:00E596 91A8              ACALL    ?L?COM006F
B1:00E598 B1CD              ACALL    ?L?COM03E0
B1:00E59A 903F62            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00E59D E4                CLR      A
B1:00E59E F0                MOVX     @DPTR,A
B1:00E59F A3                INC      DPTR
B1:00E5A0 7410              MOV      A,#010H
B1:00E5A2 800D              SJMP     ?C0063?CCM
B1:00E5A4         ?C0041?CCM:
B1:00E5A4 91A8              ACALL    ?L?COM006F
B1:00E5A6 B1CD              ACALL    ?L?COM03E0
B1:00E5A8 9036C3            MOV      DPTR,#length
B1:00E5AB B1D5              ACALL    ?L?COM061A
B1:00E5AD CF                XCH      A,R7
B1:00E5AE F0                MOVX     @DPTR,A
B1:00E5AF A3                INC      DPTR
B1:00E5B0 EF                MOV      A,R7
B1:00E5B1         
B1:00E5B1 F0                MOVX     @DPTR,A
B1:00E5B2 B1C6              ACALL    ?L?COM0504
B1:00E5B4 12D5A4            LCALL    _bit_xor
B1:00E5B7         ?C0042?CCM:
B1:00E5B7 9036C3            MOV      DPTR,#length
B1:00E5BA 12738B            LCALL    ?L?COM0591
B1:00E5BD         ?C0036?CCM:
B1:00E5BD 9036B1            MOV      DPTR,#i
B1:00E5C0 123F7F            LCALL    ?L?COM0081
B1:00E5C3 81DE              AJMP     ?C0034?CCM
B1:00E5C5         ?C0043?CCM:
B1:00E5C5 22                RET      
----- FUNCTION _encrypt_or_decrypt (END) -------


----- FUNCTION ?L?COM0504 (BEGIN) -----
B1:00E5C6 7B01              MOV      R3,#01H
B1:00E5C8 7A36              MOV      R2,#HIGH ctr
B1:00E5CA 79B3              MOV      R1,#LOW ctr
B1:00E5CC 22                RET      
----- FUNCTION ?L?COM0504 (END) -------


----- FUNCTION ?L?COM03E0 (BEGIN) -----
B1:00E5CD 3E                ADDC     A,R6
B1:00E5CE FA                MOV      R2,A
B1:00E5CF         ?L?COM03E1:
B1:00E5CF 903F5F            MOV      DPTR,#?_bit_xor?BYTE+03H
B1:00E5D2 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM03E0 (END) -------


----- FUNCTION ?L?COM061A (BEGIN) -----
B1:00E5D5 E0                MOVX     A,@DPTR
B1:00E5D6 FF                MOV      R7,A
B1:00E5D7 A3                INC      DPTR
B1:00E5D8 E0                MOVX     A,@DPTR
B1:00E5D9 903F62            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00E5DC 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 432


----- FUNCTION ?L?COM061A (END) -------


----- FUNCTION ?L?COM05D7 (BEGIN) -----
B1:00E5DD 7D10              MOV      R5,#010H
B1:00E5DF 7C00              MOV      R4,#00H
----- FUNCTION _AES_CTR_DRBG_Increment (BEGIN) -----
B1:00E5E1 9042B2            MOV      DPTR,#__data
B1:00E5E4 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'size' assigned to Register 'R4/R5' ----
B1:00E5E7         ?C0001?CTR_DRBG:
B1:00E5E7 ED                MOV      A,R5
B1:00E5E8 1D                DEC      R5
B1:00E5E9 AE04              MOV      R6,AR4
B1:00E5EB 7001              JNZ      ?C0022?CTR_DRBG
B1:00E5ED 1C                DEC      R4
B1:00E5EE         ?C0022?CTR_DRBG:
B1:00E5EE 4E                ORL      A,R6
B1:00E5EF 6014              JZ       ?C0004?CTR_DRBG
B1:00E5F1 9042B2            MOV      DPTR,#__data
B1:00E5F4 F18D              ACALL    ?L?COM05CC
B1:00E5F6 7401              MOV      A,#01H
B1:00E5F8 12203F            LCALL    ?C?CILDOPTR
B1:00E5FB 8D82              MOV      DPL,R5
B1:00E5FD 8C83              MOV      DPH,R4
B1:00E5FF 121FF0            LCALL    ?C?CLDOPTR
B1:00E602 60E3              JZ       ?C0001?CTR_DRBG
B1:00E604 22                RET      
B1:00E605         ?C0004?CTR_DRBG:
B1:00E605 22                RET      
----- FUNCTION _AES_CTR_DRBG_Increment (END) -------


----- FUNCTION _ckdf_nonce0_expand (BEGIN) -----
B1:00E606 9032CB            MOV      DPTR,#prk
B1:00E609 1225A9            LCALL    ?C?PSTXDATA
B1:00E60C 78D1              MOV      R0,#LOW constant_ei
B1:00E60E 7C32              MOV      R4,#HIGH constant_ei
B1:00E610 7D01              MOV      R5,#01H
B1:00E612 7BFF              MOV      R3,#0FFH
B1:00E614 7A31              MOV      R2,#HIGH _?ix1000
B1:00E616 79E3              MOV      R1,#LOW _?ix1000
B1:00E618 D18B              ACALL    ?L?COM010D
B1:00E61A 7A32              MOV      R2,#HIGH constant_ei
B1:00E61C 79D1              MOV      R1,#LOW constant_ei
B1:00E61E 7F0F              MOV      R7,#0FH
B1:00E620 D192              ACALL    ?L?COM0063
B1:00E622 E4                CLR      A
B1:00E623 9032EF            MOV      DPTR,#t0+0FH
B1:00E626 F0                MOVX     @DPTR,A
B1:00E627 78F0              MOV      R0,#LOW t0+010H
B1:00E629 7C32              MOV      R4,#HIGH t0+010H
B1:00E62B 7A32              MOV      R2,#HIGH constant_ei
B1:00E62D 79D1              MOV      R1,#LOW constant_ei
B1:00E62F 7F0F              MOV      R7,#0FH
B1:00E631 12737A            LCALL    ?L?COM0578
B1:00E634 9032FF            MOV      DPTR,#t0+01FH
B1:00E637 7401              MOV      A,#01H
B1:00E639 F0                MOVX     @DPTR,A
B1:00E63A FB                MOV      R3,A
B1:00E63B 12DEB5            LCALL    ?L?COM00F5
B1:00E63E 7A33              MOV      R2,#HIGH t1
B1:00E640 7900              MOV      R1,#LOW t1
B1:00E642 D19F              ACALL    ?L?COM041A
B1:00E644 7A33              MOV      R2,#HIGH t1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 433


B1:00E646 7900              MOV      R1,#LOW t1
B1:00E648 7F10              MOV      R7,#010H
B1:00E64A D192              ACALL    ?L?COM0063
B1:00E64C 78F0              MOV      R0,#LOW t0+010H
B1:00E64E 7C32              MOV      R4,#HIGH t0+010H
B1:00E650 7A32              MOV      R2,#HIGH constant_ei
B1:00E652 79D1              MOV      R1,#LOW constant_ei
B1:00E654 7F0F              MOV      R7,#0FH
B1:00E656 127051            LCALL    ?L?COM00BE
B1:00E659 9032FF            MOV      DPTR,#t0+01FH
B1:00E65C 7402              MOV      A,#02H
B1:00E65E F0                MOVX     @DPTR,A
B1:00E65F 7B01              MOV      R3,#01H
B1:00E661 12DEB5            LCALL    ?L?COM00F5
B1:00E664 7A33              MOV      R2,#HIGH t2
B1:00E666 7910              MOV      R1,#LOW t2
B1:00E668 D19F              ACALL    ?L?COM041A
B1:00E66A 9032CE            MOV      DPTR,#mei
B1:00E66D 12708F            LCALL    ?L?COM0149
B1:00E670 7A33              MOV      R2,#HIGH t1
B1:00E672 7900              MOV      R1,#LOW t1
B1:00E674 5132              ACALL    ?L?COM0078
B1:00E676 9032CE            MOV      DPTR,#mei
B1:00E679 12D380            LCALL    ?L?COM008E
B1:00E67C A801              MOV      R0,AR1
B1:00E67E 7A33              MOV      R2,#HIGH t2
B1:00E680 7910              MOV      R1,#LOW t2
B1:00E682 D1B6              ACALL    ?L?COM051E
B1:00E684 021F8D            LJMP     ?C?COPY
----- FUNCTION _ckdf_nonce0_expand (END) -------


----- FUNCTION ?L?COM010C (BEGIN) -----
B1:00E687 7D01              MOV      R5,#01H
B1:00E689 7BFF              MOV      R3,#0FFH
B1:00E68B         ?L?COM010D:
B1:00E68B 7E00              MOV      R6,#00H
B1:00E68D 7F0F              MOV      R7,#0FH
B1:00E68F 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM010C (END) -------


----- FUNCTION ?L?COM0063 (BEGIN) -----
B1:00E692 78E0              MOV      R0,#LOW t0
B1:00E694 7C32              MOV      R4,#HIGH t0
B1:00E696 7D01              MOV      R5,#01H
B1:00E698 7B01              MOV      R3,#01H
B1:00E69A 7E00              MOV      R6,#00H
B1:00E69C 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM0063 (END) -------


----- FUNCTION ?L?COM041A (BEGIN) -----
B1:00E69F A3                INC      DPTR
B1:00E6A0 1225A9            LCALL    ?C?PSTXDATA
B1:00E6A3 9032CB            MOV      DPTR,#prk
B1:00E6A6 122589            LCALL    ?C?PLDXDATA
B1:00E6A9 02DF61            LJMP     _aes_cmac_calculate
----- FUNCTION ?L?COM041A (END) -------


----- FUNCTION ?L?COM04C6 (BEGIN) -----
B1:00E6AC 7A30              MOV      R2,#HIGH M_last
B1:00E6AE 79EE              MOV      R1,#LOW M_last
B1:00E6B0 903E9C            MOV      DPTR,#?_xor_128?BYTE+06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 434


B1:00E6B3 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04C6 (END) -------


----- FUNCTION ?L?COM051E (BEGIN) -----
B1:00E6B6 FC                MOV      R4,A
B1:00E6B7 AD03              MOV      R5,AR3
B1:00E6B9 7B01              MOV      R3,#01H
B1:00E6BB 7E00              MOV      R6,#00H
B1:00E6BD 7F10              MOV      R7,#010H
B1:00E6BF 22                RET      
----- FUNCTION ?L?COM051E (END) -------


----- FUNCTION ?L?COM030A (BEGIN) -----
B1:00E6C0 FE                MOV      R6,A
B1:00E6C1         ?L?COM030B:
B1:00E6C1 122589            LCALL    ?C?PLDXDATA
B1:00E6C4 8F82              MOV      DPL,R7
B1:00E6C6 758300            MOV      DPH,#00H
B1:00E6C9 EE                MOV      A,R6
B1:00E6CA 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM030A (END) -------


----- FUNCTION _keystore_public_dsk_read (BEGIN) -----
B1:00E6CD 904297            MOV      DPTR,#buf
B1:00E6D0 F121              ACALL    ?L?COM033F
B1:00E6D2 4006              JC       ?C0002?ZW_KEYSTORE
B1:00E6D4 121C1E            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00E6D7 BFFF0B            CJNE     R7,#0FFH,?C0001?ZW_KEYSTORE
B1:00E6DA         ?C0002?ZW_KEYSTORE:
B1:00E6DA 904297            MOV      DPTR,#buf
B1:00E6DD F11A              ACALL    ?L?COM03FC
B1:00E6DF 12734B            LCALL    ?L?COM0502
B1:00E6E2 021B83            LJMP     ?INTERBANK_TABLE?_MemoryGetBuffer
B1:00E6E5         ?C0001?ZW_KEYSTORE:
B1:00E6E5 904297            MOV      DPTR,#buf
B1:00E6E8 122589            LCALL    ?C?PLDXDATA
B1:00E6EB 7D10              MOV      R5,#010H
B1:00E6ED 7F23              MOV      R7,#023H
B1:00E6EF 021C0F            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION _keystore_public_dsk_read (END) -------


----- FUNCTION _keystore_public_key_read (BEGIN) -----
B1:00E6F2 90429A            MOV      DPTR,#buf
B1:00E6F5 F121              ACALL    ?L?COM033F
B1:00E6F7 4006              JC       ?C0006?ZW_KEYSTORE
B1:00E6F9 121C1E            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00E6FC BFFF0E            CJNE     R7,#0FFH,?C0005?ZW_KEYSTORE
B1:00E6FF         ?C0006?ZW_KEYSTORE:
B1:00E6FF 90429A            MOV      DPTR,#buf
B1:00E702 F11A              ACALL    ?L?COM03FC
B1:00E704 904101            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B1:00E707 7420              MOV      A,#020H
B1:00E709 F0                MOVX     @DPTR,A
B1:00E70A 021B83            LJMP     ?INTERBANK_TABLE?_MemoryGetBuffer
B1:00E70D         ?C0005?ZW_KEYSTORE:
B1:00E70D 90429A            MOV      DPTR,#buf
B1:00E710 122589            LCALL    ?C?PLDXDATA
B1:00E713 7D20              MOV      R5,#020H
B1:00E715 7F23              MOV      R7,#023H
B1:00E717 021C0F            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION _keystore_public_key_read (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 435




----- FUNCTION ?L?COM03FC (BEGIN) -----
B1:00E71A 7E12              MOV      R6,#HIGH s2_public_key
B1:00E71C 7F34              MOV      R7,#LOW s2_public_key
B1:00E71E 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03FC (END) -------


----- FUNCTION ?L?COM033F (BEGIN) -----
B1:00E721 1225A9            LCALL    ?C?PSTXDATA
B1:00E724         ?L?COM0340:
B1:00E724 121C1E            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00E727 EF                MOV      A,R7
B1:00E728 C3                CLR      C
B1:00E729 9402              SUBB     A,#02H
B1:00E72B 22                RET      
----- FUNCTION ?L?COM033F (END) -------


----- FUNCTION ?L?COM024F (BEGIN) -----
B1:00E72C 902F41            MOV      DPTR,#NVM_WorkPtrRead
B1:00E72F EE                MOV      A,R6
B1:00E730 8FF0              MOV      B,R7
B1:00E732 122143            LCALL    ?C?IILDX
B1:00E735 902F43            MOV      DPTR,#NVM_WorkPtrWrite
B1:00E738         ?L?COM0250:
B1:00E738 EE                MOV      A,R6
B1:00E739 8FF0              MOV      B,R7
B1:00E73B 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM024F (END) -------


----- FUNCTION _keystore_private_key_read (BEGIN) -----
B1:00E73E 90429D            MOV      DPTR,#buf
B1:00E741 F121              ACALL    ?L?COM033F
B1:00E743 4007              JC       ?C0010?ZW_KEYSTORE
B1:00E745 121C1E            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00E748 EF                MOV      A,R7
B1:00E749 F4                CPL      A
B1:00E74A 7026              JNZ      ?C0009?ZW_KEYSTORE
B1:00E74C         ?C0010?ZW_KEYSTORE:
B1:00E74C 90429D            MOV      DPTR,#buf
B1:00E74F F186              ACALL    ?L?COM04C5
B1:00E751 F1A5              ACALL    ?L?COM0314
B1:00E753 90429D            MOV      DPTR,#buf
B1:00E756 12D328            LCALL    ?L?COM01EA
B1:00E759 12D7AF            LCALL    ?L?COM044C
B1:00E75C 12D746            LCALL    _ZW_s2_key_scrambler_descramble
B1:00E75F 90429D            MOV      DPTR,#buf
B1:00E762 12D380            LCALL    ?L?COM008E
B1:00E765 FA                MOV      R2,A
B1:00E766 12D32B            LCALL    ?L?COM01EB
B1:00E769 7BFF              MOV      R3,#0FFH
B1:00E76B 7A40              MOV      R2,#040H
B1:00E76D 790C              MOV      R1,#0CH
B1:00E76F 02D746            LJMP     _ZW_s2_key_scrambler_descramble
B1:00E772         ?C0009?ZW_KEYSTORE:
B1:00E772 90429D            MOV      DPTR,#buf
B1:00E775 122589            LCALL    ?C?PLDXDATA
B1:00E778 7D20              MOV      R5,#020H
B1:00E77A 7F43              MOV      R7,#043H
B1:00E77C 021C0F            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION _keystore_private_key_read (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 436



----- FUNCTION ?L?COM039B (BEGIN) -----
B1:00E77F F9                MOV      R1,A
B1:00E780         ?L?COM039C:
B1:00E780 EC                MOV      A,R4
B1:00E781 3A                ADDC     A,R2
B1:00E782 FA                MOV      R2,A
B1:00E783 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM039B (END) -------


----- FUNCTION ?L?COM04C5 (BEGIN) -----
B1:00E786 7E12              MOV      R6,#HIGH s2_private_key
B1:00E788 7F14              MOV      R7,#LOW s2_private_key
B1:00E78A 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04C5 (END) -------


----- FUNCTION ?L?COM05CC (BEGIN) -----
B1:00E78D 122589            LCALL    ?C?PLDXDATA
B1:00E790 8D82              MOV      DPL,R5
B1:00E792 8C83              MOV      DPH,R4
B1:00E794 22                RET      
----- FUNCTION ?L?COM05CC (END) -------


----- FUNCTION ?L?COM0615 (BEGIN) -----
B1:00E795 E0                MOVX     A,@DPTR
B1:00E796 FF                MOV      R7,A
B1:00E797 C3                CLR      C
B1:00E798 6480              XRL      A,#080H
B1:00E79A 9480              SUBB     A,#080H
B1:00E79C 22                RET      
----- FUNCTION ?L?COM0615 (END) -------


----- FUNCTION ?L?COM061B (BEGIN) -----
B1:00E79D 9042B0            MOV      DPTR,#q
B1:00E7A0 E0                MOVX     A,@DPTR
B1:00E7A1 14                DEC      A
B1:00E7A2 5407              ANL      A,#07H
B1:00E7A4 22                RET      
----- FUNCTION ?L?COM061B (END) -------


----- FUNCTION ?L?COM0314 (BEGIN) -----
B1:00E7A5 904101            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B1:00E7A8 7420              MOV      A,#020H
B1:00E7AA F0                MOVX     @DPTR,A
B1:00E7AB 021B83            LJMP     ?INTERBANK_TABLE?_MemoryGetBuffer
----- FUNCTION ?L?COM0314 (END) -------


----- FUNCTION ?L?COM00D3 (BEGIN) -----
B1:00E7AE E0                MOVX     A,@DPTR
B1:00E7AF FF                MOV      R7,A
B1:00E7B0 A3                INC      DPTR
B1:00E7B1 E0                MOVX     A,@DPTR
B1:00E7B2 90369F            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+05H
B1:00E7B5         ?L?COM00D4:
B1:00E7B5 CF                XCH      A,R7
B1:00E7B6         ?L?COM00D5:
B1:00E7B6 F0                MOVX     @DPTR,A
B1:00E7B7 A3                INC      DPTR
B1:00E7B8 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 437


B1:00E7B9 F0                MOVX     @DPTR,A
B1:00E7BA 7B01              MOV      R3,#01H
B1:00E7BC 22                RET      
----- FUNCTION ?L?COM00D3 (END) -------


----- FUNCTION _next_nonce_generate (BEGIN) -----
;---- Variable 'ctx' assigned to Register 'R1/R2/R3' ----
B1:00E7BD C003              PUSH     AR3
B1:00E7BF C002              PUSH     AR2
B1:00E7C1 C001              PUSH     AR1
B1:00E7C3 9040ED            MOV      DPTR,#rand
B1:00E7C6 122589            LCALL    ?C?PLDXDATA
B1:00E7C9 90371D            MOV      DPTR,#?_AES_CTR_DRBG_Generate?BYTE+03H
B1:00E7CC 1225A9            LCALL    ?C?PSTXDATA
B1:00E7CF D001              POP      AR1
B1:00E7D1 D002              POP      AR2
B1:00E7D3 D003              POP      AR3
B1:00E7D5 71EA              ACALL    _AES_CTR_DRBG_Generate
B1:00E7D7 7E00              MOV      R6,#00H
B1:00E7D9 7F01              MOV      R7,#01H
B1:00E7DB 22                RET      
----- FUNCTION _next_nonce_generate (END) -------


----- FUNCTION SetTransmitPause (BEGIN) -----
B1:00E7DC 900780            MOV      DPTR,#sACK
B1:00E7DF E0                MOVX     A,@DPTR
B1:00E7E0 30E10A            JNB      ACC.1,?C0442?ZW_TRANSPORT
B1:00E7E3 D210              SETB     bPauseEnabled
B1:00E7E5 1251E9            LCALL    getTickTime
B1:00E7E8 EF                MOV      A,R7
B1:00E7E9 9003BA            MOV      DPTR,#bPauseTransmitCountdown
B1:00E7EC F0                MOVX     @DPTR,A
B1:00E7ED         ?C0442?ZW_TRANSPORT:
B1:00E7ED 22                RET      
----- FUNCTION SetTransmitPause (END) -------


----- FUNCTION _IsSpecialRssiValue (BEGIN) -----
;---- Variable 'rssi_sample' assigned to Register 'R7' ----
B1:00E7EE EF                MOV      A,R7
B1:00E7EF B47F03            CJNE     A,#07FH,?C0443?ZW_TRANSPORT
B1:00E7F2 D3                SETB     C
B1:00E7F3 8001              SJMP     ?C0444?ZW_TRANSPORT
B1:00E7F5         ?C0443?ZW_TRANSPORT:
B1:00E7F5 C3                CLR      C
B1:00E7F6         ?C0444?ZW_TRANSPORT:
B1:00E7F6 22                RET      
----- FUNCTION _IsSpecialRssiValue (END) -------


----- FUNCTION ?L?COM02AC (BEGIN) -----
B1:00E7F7 90071A            MOV      DPTR,#pRssiArray
B1:00E7FA 122589            LCALL    ?C?PLDXDATA
B1:00E7FD 7D02              MOV      R5,#02H
----- FUNCTION _CalculateRssi (BEGIN) -----
B1:00E7FF 900AC0            MOV      DPTR,#rssi_array
B1:00E802 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R5' ----
B1:00E805 E4                CLR      A
B1:00E806 900AC3            MOV      DPTR,#sum
B1:00E809 F0                MOVX     @DPTR,A
B1:00E80A A3                INC      DPTR
B1:00E80B F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 438


;---- Variable 'i' assigned to Register 'R6' ----
B1:00E80C FE                MOV      R6,A
B1:00E80D         ?C0446?ZW_TRANSPORT:
B1:00E80D EE                MOV      A,R6
B1:00E80E C3                CLR      C
B1:00E80F 9D                SUBB     A,R5
B1:00E810 5024              JNC      ?C0447?ZW_TRANSPORT
B1:00E812 1195              ACALL    ?L?COM05B8
B1:00E814 128622            LCALL    ?L?COM0006
B1:00E817 FF                MOV      R7,A
B1:00E818 FB                MOV      R3,A
B1:00E819 900AC3            MOV      DPTR,#sum
B1:00E81C E4                CLR      A
B1:00E81D 8BF0              MOV      B,R3
B1:00E81F 122143            LCALL    ?C?IILDX
B1:00E822 12E7EE            LCALL    _IsSpecialRssiValue
B1:00E825 500C              JNC      ?C0448?ZW_TRANSPORT
B1:00E827 1195              ACALL    ?L?COM05B8
B1:00E829 128622            LCALL    ?L?COM0006
B1:00E82C FF                MOV      R7,A
B1:00E82D 900AC3            MOV      DPTR,#sum
B1:00E830 E4                CLR      A
B1:00E831 8057              SJMP     ?C0620?ZW_TRANSPORT
B1:00E833         ?C0448?ZW_TRANSPORT:
B1:00E833 0E                INC      R6
B1:00E834 80D7              SJMP     ?C0446?ZW_TRANSPORT
B1:00E836         ?C0447?ZW_TRANSPORT:
B1:00E836 900AC3            MOV      DPTR,#sum
B1:00E839 12C7BE            LCALL    ?L?COM0242
B1:00E83C 1220B8            LCALL    ?C?UIDIV
B1:00E83F 900AC3            MOV      DPTR,#sum
B1:00E842 EE                MOV      A,R6
B1:00E843 F0                MOVX     @DPTR,A
B1:00E844 A3                INC      DPTR
B1:00E845 EF                MOV      A,R7
B1:00E846 F0                MOVX     @DPTR,A
B1:00E847 D3                SETB     C
B1:00E848 9450              SUBB     A,#050H
B1:00E84A EE                MOV      A,R6
B1:00E84B 9400              SUBB     A,#00H
B1:00E84D 400B              JC       ?C0451?ZW_TRANSPORT
B1:00E84F 900AC3            MOV      DPTR,#sum
B1:00E852 E4                CLR      A
B1:00E853 F0                MOVX     @DPTR,A
B1:00E854 A3                INC      DPTR
B1:00E855 747E              MOV      A,#07EH
B1:00E857 F0                MOVX     @DPTR,A
B1:00E858 8034              SJMP     return_now?ZW_TRANSPORT
B1:00E85A         ?C0451?ZW_TRANSPORT:
B1:00E85A 900AC3            MOV      DPTR,#sum
B1:00E85D 1265F9            LCALL    ?L?COM0199
B1:00E860 9428              SUBB     A,#028H
B1:00E862 EE                MOV      A,R6
B1:00E863 9400              SUBB     A,#00H
B1:00E865 500B              JNC      ?C0452?ZW_TRANSPORT
B1:00E867 900AC3            MOV      DPTR,#sum
B1:00E86A E4                CLR      A
B1:00E86B F0                MOVX     @DPTR,A
B1:00E86C A3                INC      DPTR
B1:00E86D 747D              MOV      A,#07DH
B1:00E86F F0                MOVX     @DPTR,A
B1:00E870 801C              SJMP     return_now?ZW_TRANSPORT
B1:00E872         ?C0452?ZW_TRANSPORT:
B1:00E872 7C00              MOV      R4,#00H
B1:00E874 7D9B              MOV      R5,#09BH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 439


B1:00E876 1220A6            LCALL    ?C?IMUL
B1:00E879 EF                MOV      A,R7
B1:00E87A 24DA              ADD      A,#0DAH
B1:00E87C FF                MOV      R7,A
B1:00E87D EE                MOV      A,R6
B1:00E87E 34C2              ADDC     A,#0C2H
B1:00E880 FE                MOV      R6,A
B1:00E881 7D64              MOV      R5,#064H
B1:00E883 12210D            LCALL    ?C?SIDIV
B1:00E886 900AC3            MOV      DPTR,#sum
B1:00E889 EE                MOV      A,R6
B1:00E88A         
B1:00E88A F0                MOVX     @DPTR,A
B1:00E88B A3                INC      DPTR
B1:00E88C EF                MOV      A,R7
B1:00E88D F0                MOVX     @DPTR,A
B1:00E88E         return_now:
B1:00E88E 900AC3            MOV      DPTR,#sum
B1:00E891 A3                INC      DPTR
B1:00E892 E0                MOVX     A,@DPTR
B1:00E893 FF                MOV      R7,A
B1:00E894 22                RET      
----- FUNCTION _CalculateRssi (END) -------


----- FUNCTION ?L?COM05B8 (BEGIN) -----
B1:00E895 900AC0            MOV      DPTR,#rssi_array
B1:00E898 122589            LCALL    ?C?PLDXDATA
B1:00E89B E9                MOV      A,R1
B1:00E89C 2E                ADD      A,R6
B1:00E89D 22                RET      
----- FUNCTION ?L?COM05B8 (END) -------


----- FUNCTION ?L?COM0566 (BEGIN) -----
B1:00E89E 7B01              MOV      R3,#01H
B1:00E8A0 7A08              MOV      R2,#HIGH rxFrame
B1:00E8A2 7973              MOV      R1,#LOW rxFrame
B1:00E8A4 22                RET      
----- FUNCTION ?L?COM0566 (END) -------


----- FUNCTION _IsFrameIlLegal (BEGIN) -----
B1:00E8A5 900A61            MOV      DPTR,#pRxFrame
B1:00E8A8 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'frameState' assigned to Register 'R7' ----
B1:00E8AB E4                CLR      A
B1:00E8AC FF                MOV      R7,A
B1:00E8AD 900A61            MOV      DPTR,#pRxFrame
B1:00E8B0 129751            LCALL    ?L?COM0144
B1:00E8B3 128622            LCALL    ?L?COM0006
B1:00E8B6 FE                MOV      R6,A
B1:00E8B7 901221            MOV      DPTR,#nodeID
B1:00E8BA E0                MOVX     A,@DPTR
B1:00E8BB FD                MOV      R5,A
B1:00E8BC 6E                XRL      A,R6
B1:00E8BD 702D              JNZ      ?C0455?ZW_TRANSPORT
B1:00E8BF 900A61            MOV      DPTR,#pRxFrame
B1:00E8C2 12BF9A            LCALL    ?L?COM01E1
B1:00E8C5 128622            LCALL    ?L?COM0006
B1:00E8C8 FE                MOV      R6,A
B1:00E8C9 540F              ANL      A,#0FH
B1:00E8CB FC                MOV      R4,A
B1:00E8CC BC0119            CJNE     R4,#01H,?C0456?ZW_TRANSPORT
B1:00E8CF EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 440


B1:00E8D0 30E715            JNB      ACC.7,?C0456?ZW_TRANSPORT
B1:00E8D3 121FB3            LCALL    ?C?CLDPTR
B1:00E8D6 30E713            JNB      ACC.7,?C0455?ZW_TRANSPORT
B1:00E8D9 900A61            MOV      DPTR,#pRxFrame
B1:00E8DC 122589            LCALL    ?C?PLDXDATA
B1:00E8DF E9                MOV      A,R1
B1:00E8E0 2408              ADD      A,#08H
B1:00E8E2 128622            LCALL    ?L?COM0006
B1:00E8E5 B50504            CJNE     A,AR5,?C0455?ZW_TRANSPORT
B1:00E8E8         ?C0456?ZW_TRANSPORT:
B1:00E8E8 EF                MOV      A,R7
B1:00E8E9 4401              ORL      A,#01H
B1:00E8EB FF                MOV      R7,A
B1:00E8EC         ?C0455?ZW_TRANSPORT:
B1:00E8EC 900A64            MOV      DPTR,#pCmdClass
B1:00E8EF 122589            LCALL    ?C?PLDXDATA
B1:00E8F2 E9                MOV      A,R1
B1:00E8F3 4A                ORL      A,R2
B1:00E8F4 602C              JZ       ?C0457?ZW_TRANSPORT
B1:00E8F6 121FB3            LCALL    ?C?CLDPTR
B1:00E8F9 FE                MOV      R6,A
B1:00E8FA 649F              XRL      A,#09FH
B1:00E8FC 6005              JZ       ?C0458?ZW_TRANSPORT
B1:00E8FE EE                MOV      A,R6
B1:00E8FF 6498              XRL      A,#098H
B1:00E901 701F              JNZ      ?C0457?ZW_TRANSPORT
B1:00E903         ?C0458?ZW_TRANSPORT:
B1:00E903 EF                MOV      A,R7
B1:00E904 30E003            JNB      ACC.0,?C0459?ZW_TRANSPORT
B1:00E907 7F01              MOV      R7,#01H
B1:00E909 22                RET      
B1:00E90A         ?C0459?ZW_TRANSPORT:
B1:00E90A 121FB3            LCALL    ?C?CLDPTR
B1:00E90D B49812            CJNE     A,#098H,?C0457?ZW_TRANSPORT
B1:00E910 900A61            MOV      DPTR,#pRxFrame
B1:00E913 122589            LCALL    ?C?PLDXDATA
B1:00E916 E9                MOV      A,R1
B1:00E917 2408              ADD      A,#08H
B1:00E919 128622            LCALL    ?L?COM0006
B1:00E91C B4FF03            CJNE     A,#0FFH,?C0457?ZW_TRANSPORT
B1:00E91F 7F01              MOV      R7,#01H
B1:00E921 22                RET      
B1:00E922         ?C0457?ZW_TRANSPORT:
B1:00E922 200107            JB       learnMode,?C0464?ZW_TRANSPORT
B1:00E925 EF                MOV      A,R7
B1:00E926 30E003            JNB      ACC.0,?C0464?ZW_TRANSPORT
B1:00E929 7F01              MOV      R7,#01H
B1:00E92B 22                RET      
B1:00E92C         ?C0464?ZW_TRANSPORT:
B1:00E92C EF                MOV      A,R7
B1:00E92D 5402              ANL      A,#02H
B1:00E92F FF                MOV      R7,A
B1:00E930 22                RET      
----- FUNCTION _IsFrameIlLegal (END) -------


----- FUNCTION TransportInit (BEGIN) -----
B1:00E931 3140              ACALL    FlushResponseSpeeds
B1:00E933 C210              CLR      bPauseEnabled
B1:00E935 E4                CLR      A
B1:00E936 9003BA            MOV      DPTR,#bPauseTransmitCountdown
B1:00E939 F0                MOVX     @DPTR,A
B1:00E93A 90077A            MOV      DPTR,#bRoutedRssiFeedbackEnabled
B1:00E93D 04                INC      A
B1:00E93E F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 441


B1:00E93F 22                RET      
----- FUNCTION TransportInit (END) -------


----- FUNCTION FlushResponseSpeeds (BEGIN) -----
B1:00E940 7B01              MOV      R3,#01H
B1:00E942 7A08              MOV      R2,#HIGH abDirectNodesResponseSpeed
B1:00E944 7988              MOV      R1,#LOW abDirectNodesResponseSpeed
B1:00E946 7D04              MOV      R5,#04H
B1:00E948 E4                CLR      A
B1:00E949 FF                MOV      R7,A
B1:00E94A 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION FlushResponseSpeeds (END) -------


----- FUNCTION transportVarInit (BEGIN) -----
B1:00E94D C206              CLR      bApplicationTxAbort
B1:00E94F C209              CLR      inclusionHomeIDActive
B1:00E951 D208              SETB     currentSeqNoUseTX
B1:00E953 E4                CLR      A
B1:00E954 900881            MOV      DPTR,#bReturnRoutePriorityIndex
B1:00E957 F0                MOVX     @DPTR,A
B1:00E958 C207              CLR      iResponseNodeIndex
B1:00E95A 90088C            MOV      DPTR,#_ts_stored_callback
B1:00E95D F0                MOVX     @DPTR,A
B1:00E95E A3                INC      DPTR
B1:00E95F F0                MOVX     @DPTR,A
B1:00E960 22                RET      
----- FUNCTION transportVarInit (END) -------


----- FUNCTION _ZW_RxToTxOptions (BEGIN) -----
B1:00E961 900A9B            MOV      DPTR,#rxopt
B1:00E964 1225A9            LCALL    ?C?PSTXDATA
B1:00E967 900A9E            MOV      DPTR,#txopt
B1:00E96A 122589            LCALL    ?C?PLDXDATA
B1:00E96D 7D06              MOV      R5,#06H
B1:00E96F E4                CLR      A
B1:00E970 FF                MOV      R7,A
B1:00E971 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00E974 900A9B            MOV      DPTR,#rxopt
B1:00E977 122589            LCALL    ?C?PLDXDATA
B1:00E97A E9                MOV      A,R1
B1:00E97B 2401              ADD      A,#01H
B1:00E97D 128622            LCALL    ?L?COM0006
B1:00E980 900A9E            MOV      DPTR,#txopt
B1:00E983 123F94            LCALL    ?L?COM00BF
B1:00E986 900A9E            MOV      DPTR,#txopt
B1:00E989 12DB78            LCALL    ?L?COM006D
B1:00E98C E4                CLR      A
B1:00E98D 122072            LCALL    ?C?CSTPTR
B1:00E990 900A9B            MOV      DPTR,#rxopt
B1:00E993 129751            LCALL    ?L?COM0144
B1:00E996 128622            LCALL    ?L?COM0006
B1:00E999 FF                MOV      R7,A
B1:00E99A 900A9E            MOV      DPTR,#txopt
B1:00E99D 12885F            LCALL    ?L?COM000F
B1:00E9A0 EF                MOV      A,R7
B1:00E9A1 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_RxToTxOptions (END) -------


----- FUNCTION _ZW_EnableRoutedRssiFeedback (BEGIN) -----
;---- Variable 'bEnabled' assigned to Register 'R7' ----
B1:00E9A4 90077A            MOV      DPTR,#bRoutedRssiFeedbackEnabled
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 442


B1:00E9A7 EF                MOV      A,R7
B1:00E9A8 F0                MOVX     @DPTR,A
B1:00E9A9 22                RET      
----- FUNCTION _ZW_EnableRoutedRssiFeedback (END) -------


----- FUNCTION _GetResponseRouteIndex (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
;---- Variable 'rtmp' assigned to Register 'R6' ----
B1:00E9AA 7E02              MOV      R6,#02H
B1:00E9AC EF                MOV      A,R7
B1:00E9AD 6018              JZ       ?C0001?ZW_ROUTING_ALL
B1:00E9AF 901216            MOV      DPTR,#responseRouteCount
B1:00E9B2 E0                MOVX     A,@DPTR
B1:00E9B3 6012              JZ       ?C0001?ZW_ROUTING_ALL
B1:00E9B5         ?C0004?ZW_ROUTING_ALL:
B1:00E9B5 741D              MOV      A,#LOW responseRouteNodeID-01H
B1:00E9B7 2E                ADD      A,R6
B1:00E9B8 12D144            LCALL    ?L?COM04B7
B1:00E9BB E0                MOVX     A,@DPTR
B1:00E9BC B50706            CJNE     A,AR7,?C0002?ZW_ROUTING_ALL
B1:00E9BF C3                CLR      C
B1:00E9C0 EE                MOV      A,R6
B1:00E9C1 9401              SUBB     A,#01H
B1:00E9C3 FF                MOV      R7,A
B1:00E9C4 22                RET      
B1:00E9C5         ?C0002?ZW_ROUTING_ALL:
B1:00E9C5 DEEE              DJNZ     R6,?C0004?ZW_ROUTING_ALL
B1:00E9C7         ?C0001?ZW_ROUTING_ALL:
B1:00E9C7 7FFF              MOV      R7,#0FFH
B1:00E9C9 22                RET      
----- FUNCTION _GetResponseRouteIndex (END) -------


----- FUNCTION _RemoveResponseRoute (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00E9CA 31AA              ACALL    _GetResponseRouteIndex
;---- Variable 'routetmp' assigned to Register 'R7' ----
B1:00E9CC EF                MOV      A,R7
B1:00E9CD F4                CPL      A
B1:00E9CE 600C              JZ       ?C0078?ZW_ROUTING_ALL
B1:00E9D0 201709            JB       routesLocked,?C0078?ZW_ROUTING_ALL
B1:00E9D3 741E              MOV      A,#LOW responseRouteNodeID
B1:00E9D5 2F                ADD      A,R7
B1:00E9D6 12AF92            LCALL    ?L?COM02B9
B1:00E9D9 E4                CLR      A
B1:00E9DA 718C              ACALL    ?L?COM0627
B1:00E9DC         ?C0078?ZW_ROUTING_ALL:
B1:00E9DC 22                RET      
----- FUNCTION _RemoveResponseRoute (END) -------


----- FUNCTION _ZW_LockRoute (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00E9DD EF                MOV      A,R7
B1:00E9DE 7002              JNZ      $ + 4H
B1:00E9E0 4163              AJMP     ?C0068?ZW_ROUTING_ALL
B1:00E9E2 D217              SETB     routesLocked
B1:00E9E4 31AA              ACALL    _GetResponseRouteIndex
;---- Variable 'routetmp' assigned to Register 'R5' ----
B1:00E9E6 AD07              MOV      R5,AR7
B1:00E9E8 ED                MOV      A,R5
B1:00E9E9 6401              XRL      A,#01H
B1:00E9EB 7078              JNZ      ?C0076?ZW_ROUTING_ALL
B1:00E9ED 90121F            MOV      DPTR,#responseRouteNodeID+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 443


B1:00E9F0 E0                MOVX     A,@DPTR
B1:00E9F1 90121E            MOV      DPTR,#responseRouteNodeID
B1:00E9F4 F0                MOVX     @DPTR,A
B1:00E9F5 E4                CLR      A
B1:00E9F6 A3                INC      DPTR
B1:00E9F7 F0                MOVX     @DPTR,A
B1:00E9F8 90123C            MOV      DPTR,#responseRouteSpeedNumHops+01H
B1:00E9FB E0                MOVX     A,@DPTR
B1:00E9FC 90123B            MOV      DPTR,#responseRouteSpeedNumHops
B1:00E9FF F0                MOVX     @DPTR,A
B1:00EA00 90121D            MOV      DPTR,#responseRouteRFOption+01H
B1:00EA03 E0                MOVX     A,@DPTR
B1:00EA04 90121C            MOV      DPTR,#responseRouteRFOption
B1:00EA07 718C              ACALL    ?L?COM0627
B1:00EA09 7401              MOV      A,#01H
B1:00EA0B 7E00              MOV      R6,#00H
B1:00EA0D A805              MOV      R0,AR5
B1:00EA0F 08                INC      R0
B1:00EA10 8005              SJMP     ?C0091?ZW_ROUTING_ALL
B1:00EA12         ?C0090?ZW_ROUTING_ALL:
B1:00EA12 C3                CLR      C
B1:00EA13 33                RLC      A
B1:00EA14 CE                XCH      A,R6
B1:00EA15 33                RLC      A
B1:00EA16 CE                XCH      A,R6
B1:00EA17         ?C0091?ZW_ROUTING_ALL:
B1:00EA17 D8F9              DJNZ     R0,?C0090?ZW_ROUTING_ALL
B1:00EA19 FF                MOV      R7,A
B1:00EA1A 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00EA1D E0                MOVX     A,@DPTR
B1:00EA1E FC                MOV      R4,A
B1:00EA1F FB                MOV      R3,A
B1:00EA20 EF                MOV      A,R7
B1:00EA21 5B                ANL      A,R3
B1:00EA22 6006              JZ       ?C0070?ZW_ROUTING_ALL
B1:00EA24 EC                MOV      A,R4
B1:00EA25 4401              ORL      A,#01H
B1:00EA27 F0                MOVX     @DPTR,A
B1:00EA28 8007              SJMP     ?C0071?ZW_ROUTING_ALL
B1:00EA2A         ?C0070?ZW_ROUTING_ALL:
B1:00EA2A 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00EA2D E0                MOVX     A,@DPTR
B1:00EA2E 54FE              ANL      A,#0FEH
B1:00EA30 F0                MOVX     @DPTR,A
B1:00EA31         ?C0071?ZW_ROUTING_ALL:
B1:00EA31 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00EA34 E0                MOVX     A,@DPTR
B1:00EA35 FF                MOV      R7,A
B1:00EA36 7401              MOV      A,#01H
B1:00EA38 A805              MOV      R0,AR5
B1:00EA3A 08                INC      R0
B1:00EA3B 8002              SJMP     ?C0093?ZW_ROUTING_ALL
B1:00EA3D         ?C0092?ZW_ROUTING_ALL:
B1:00EA3D C3                CLR      C
B1:00EA3E 33                RLC      A
B1:00EA3F         ?C0093?ZW_ROUTING_ALL:
B1:00EA3F D8FC              DJNZ     R0,?C0092?ZW_ROUTING_ALL
B1:00EA41 F4                CPL      A
B1:00EA42 5F                ANL      A,R7
B1:00EA43 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00EA46 F0                MOVX     @DPTR,A
B1:00EA47 E4                CLR      A
B1:00EA48 FD                MOV      R5,A
B1:00EA49         ?C0072?ZW_ROUTING_ALL:
B1:00EA49 7445              MOV      A,#LOW responseRouteRepeaterList+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 444


B1:00EA4B 2D                ADD      A,R5
B1:00EA4C F582              MOV      DPL,A
B1:00EA4E E4                CLR      A
B1:00EA4F 3412              ADDC     A,#HIGH responseRouteRepeaterList+04H
B1:00EA51 F583              MOV      DPH,A
B1:00EA53 E0                MOVX     A,@DPTR
B1:00EA54 FF                MOV      R7,A
B1:00EA55 7441              MOV      A,#LOW responseRouteRepeaterList
B1:00EA57 2D                ADD      A,R5
B1:00EA58 12AEC0            LCALL    ?L?COM0117
B1:00EA5B EF                MOV      A,R7
B1:00EA5C F0                MOVX     @DPTR,A
B1:00EA5D 0D                INC      R5
B1:00EA5E ED                MOV      A,R5
B1:00EA5F B404E7            CJNE     A,#04H,?C0072?ZW_ROUTING_ALL
B1:00EA62 22                RET      
B1:00EA63         ?C0068?ZW_ROUTING_ALL:
B1:00EA63 C217              CLR      routesLocked
B1:00EA65         ?C0076?ZW_ROUTING_ALL:
B1:00EA65 22                RET      
----- FUNCTION _ZW_LockRoute (END) -------


----- FUNCTION _ZCB_AssignComplete (BEGIN) -----
B1:00EA66 51DA              ACALL    ?L?COM0626
B1:00EA68 FF                MOV      R7,A
B1:00EA69 6404              XRL      A,#04H
B1:00EA6B 6068              JZ       ?C0308?ZW_SLAVE
B1:00EA6D EF                MOV      A,R7
B1:00EA6E B40302            CJNE     A,#03H,?C0063?ZW_SLAVE
B1:00EA71         ?C0064?ZW_SLAVE:
B1:00EA71 8062              SJMP     ?C0308?ZW_SLAVE
B1:00EA73         ?C0063?ZW_SLAVE:
B1:00EA73 902B24            MOV      DPTR,#assignState
B1:00EA76 E0                MOVX     A,@DPTR
B1:00EA77 B4010E            CJNE     A,#01H,?C0066?ZW_SLAVE
B1:00EA7A C201              CLR      learnMode
B1:00EA7C C203              CLR      learnModeDsk
B1:00EA7E 901221            MOV      DPTR,#nodeID
B1:00EA81 E0                MOVX     A,@DPTR
B1:00EA82 7004              JNZ      ?C0066?ZW_SLAVE
B1:00EA84 902B24            MOV      DPTR,#assignState
B1:00EA87 F0                MOVX     @DPTR,A
B1:00EA88         ?C0066?ZW_SLAVE:
B1:00EA88 902B24            MOV      DPTR,#assignState
B1:00EA8B E0                MOVX     A,@DPTR
B1:00EA8C 7022              JNZ      ?C0068?ZW_SLAVE
B1:00EA8E FF                MOV      R7,A
B1:00EA8F 31DD              ACALL    _ZW_LockRoute
B1:00EA91 C201              CLR      learnMode
B1:00EA93 C203              CLR      learnModeDsk
B1:00EA95 E4                CLR      A
B1:00EA96 902B7B            MOV      DPTR,#zensorWakeupTime
B1:00EA99 F0                MOVX     @DPTR,A
B1:00EA9A 200411            JB       learnModeClassic,?C0069?ZW_SLAVE
B1:00EA9D 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00EAA0 E0                MOVX     A,@DPTR
B1:00EAA1 5430              ANL      A,#030H
B1:00EAA3 7004              JNZ      ?C0070?ZW_SLAVE
B1:00EAA5 7F01              MOV      R7,#01H
B1:00EAA7 8002              SJMP     ?C0309?ZW_SLAVE
B1:00EAA9         ?C0070?ZW_SLAVE:
B1:00EAA9 E4                CLR      A
B1:00EAAA FF                MOV      R7,A
B1:00EAAB         
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 445


B1:00EAAB 121BD3            LCALL    ?INTERBANK_TABLE?_ExploreSetNWI
B1:00EAAE         ?C0069?ZW_SLAVE:
B1:00EAAE C204              CLR      learnModeClassic
B1:00EAB0         ?C0068?ZW_SLAVE:
B1:00EAB0 902B9D            MOV      DPTR,#_learnNodeFunc
B1:00EAB3 7197              ACALL    ?L?COM047B
B1:00EAB5 6014              JZ       ?C0072?ZW_SLAVE
B1:00EAB7 902B24            MOV      DPTR,#assignState
B1:00EABA 12B0BE            LCALL    ?L?COM01CA
B1:00EABD 912E              ACALL    ?L?COM05D0
B1:00EABF 902B24            MOV      DPTR,#assignState
B1:00EAC2 E0                MOVX     A,@DPTR
B1:00EAC3 7006              JNZ      ?C0072?ZW_SLAVE
B1:00EAC5 902B9D            MOV      DPTR,#_learnNodeFunc
B1:00EAC8 F0                MOVX     @DPTR,A
B1:00EAC9 A3                INC      DPTR
B1:00EACA F0                MOVX     @DPTR,A
B1:00EACB         ?C0072?ZW_SLAVE:
B1:00EACB 902B24            MOV      DPTR,#assignState
B1:00EACE E0                MOVX     A,@DPTR
B1:00EACF B40107            CJNE     A,#01H,?C0075?ZW_SLAVE
B1:00EAD2 7403              MOV      A,#03H
B1:00EAD4 F0                MOVX     @DPTR,A
B1:00EAD5         
B1:00EAD5 7F04              MOV      R7,#04H
B1:00EAD7 7114              ACALL    _AssignTimerStart
B1:00EAD9         ?C0075?ZW_SLAVE:
B1:00EAD9 22                RET      
----- FUNCTION _ZCB_AssignComplete (END) -------


----- FUNCTION ?L?COM0626 (BEGIN) -----
B1:00EADA 51E1              ACALL    AssignTimerStop
B1:00EADC 902B24            MOV      DPTR,#assignState
B1:00EADF E0                MOVX     A,@DPTR
B1:00EAE0 22                RET      
----- FUNCTION ?L?COM0626 (END) -------


----- FUNCTION AssignTimerStop (BEGIN) -----
B1:00EAE1 902BB2            MOV      DPTR,#assignTimerHandle
B1:00EAE4 E0                MOVX     A,@DPTR
B1:00EAE5 FF                MOV      R7,A
B1:00EAE6 F4                CPL      A
B1:00EAE7 6003              JZ       ?C0053?ZW_SLAVE
B1:00EAE9 124465            LCALL    _TimerCancel
B1:00EAEC         ?C0053?ZW_SLAVE:
B1:00EAEC 902BB2            MOV      DPTR,#assignTimerHandle
B1:00EAEF 74FF              MOV      A,#0FFH
B1:00EAF1 F0                MOVX     @DPTR,A
B1:00EAF2 22                RET      
----- FUNCTION AssignTimerStop (END) -------


----- FUNCTION ZCB_AssignTimeout (BEGIN) -----
B1:00EAF3 902B23            MOV      DPTR,#assignTimeoutCount
B1:00EAF6 E0                MOVX     A,@DPTR
B1:00EAF7 FF                MOV      R7,A
B1:00EAF8 14                DEC      A
B1:00EAF9 F0                MOVX     @DPTR,A
B1:00EAFA EF                MOV      A,R7
B1:00EAFB 7016              JNZ      ?C0059?ZW_SLAVE
B1:00EAFD 51DA              ACALL    ?L?COM0626
B1:00EAFF B40302            CJNE     A,#03H,?C0056?ZW_SLAVE
B1:00EB02 8007              SJMP     ?C0307?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 446


B1:00EB04         ?C0056?ZW_SLAVE:
B1:00EB04 902B24            MOV      DPTR,#assignState
B1:00EB07 E0                MOVX     A,@DPTR
B1:00EB08 B40408            CJNE     A,#04H,?C0059?ZW_SLAVE
B1:00EB0B         
B1:00EB0B E4                CLR      A
B1:00EB0C F0                MOVX     @DPTR,A
B1:00EB0D FB                MOV      R3,A
B1:00EB0E FA                MOV      R2,A
B1:00EB0F F9                MOV      R1,A
B1:00EB10 FF                MOV      R7,A
B1:00EB11 5166              ACALL    _ZCB_AssignComplete
B1:00EB13         ?C0059?ZW_SLAVE:
B1:00EB13 22                RET      
----- FUNCTION ZCB_AssignTimeout (END) -------


----- FUNCTION _AssignTimerStart (BEGIN) -----
B1:00EB14 90437E            MOV      DPTR,#count
B1:00EB17 EF                MOV      A,R7
B1:00EB18 F0                MOVX     @DPTR,A
B1:00EB19 51E1              ACALL    AssignTimerStop
B1:00EB1B 90437E            MOV      DPTR,#count
B1:00EB1E E0                MOVX     A,@DPTR
B1:00EB1F 6004              JZ       ?C0060?ZW_SLAVE
B1:00EB21 902B23            MOV      DPTR,#assignTimeoutCount
B1:00EB24 F0                MOVX     @DPTR,A
B1:00EB25         ?C0060?ZW_SLAVE:
B1:00EB25 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_AssignTimeout
B1:00EB27 7FE9              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_AssignTimeout
B1:00EB29 7BFF              MOV      R3,#0FFH
B1:00EB2B 7D2F              MOV      R5,#02FH
B1:00EB2D 124778            LCALL    _TimerSysStart
B1:00EB30 902BB2            MOV      DPTR,#assignTimerHandle
B1:00EB33 EF                MOV      A,R7
B1:00EB34 F0                MOVX     @DPTR,A
B1:00EB35 BFFF02            CJNE     R7,#0FFH,?C0062?ZW_SLAVE
B1:00EB38 51F3              ACALL    ZCB_AssignTimeout
B1:00EB3A         ?C0062?ZW_SLAVE:
B1:00EB3A 22                RET      
----- FUNCTION _AssignTimerStart (END) -------


----- FUNCTION _SlaveInit (BEGIN) -----
;---- Variable 'bLoadNodeInformation' assigned to Register 'R7' ----
B1:00EB3B 902BE8            MOV      DPTR,#nodeNormalRangeFrame+02H
B1:00EB3E 7401              MOV      A,#01H
B1:00EB40 F0                MOVX     @DPTR,A
B1:00EB41 E4                CLR      A
B1:00EB42 A3                INC      DPTR
B1:00EB43 F0                MOVX     @DPTR,A
B1:00EB44 902B7E            MOV      DPTR,#nodeFLiRSRangeFrame+02H
B1:00EB47 04                INC      A
B1:00EB48 F0                MOVX     @DPTR,A
B1:00EB49 E4                CLR      A
B1:00EB4A A3                INC      DPTR
B1:00EB4B F0                MOVX     @DPTR,A
B1:00EB4C 902BAE            MOV      DPTR,#pNodeRangeFrame
B1:00EB4F 742B              MOV      A,#HIGH nodeNormalRangeFrame
B1:00EB51 F0                MOVX     @DPTR,A
B1:00EB52 A3                INC      DPTR
B1:00EB53 74E6              MOV      A,#LOW nodeNormalRangeFrame
B1:00EB55 F0                MOVX     @DPTR,A
B1:00EB56 902BAD            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00EB59 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 447


B1:00EB5B F0                MOVX     @DPTR,A
B1:00EB5C EF                MOV      A,R7
B1:00EB5D 6019              JZ       ?C0105?ZW_SLAVE
B1:00EB5F 901215            MOV      DPTR,#bFLiRSStatus
B1:00EB62 E0                MOVX     A,@DPTR
B1:00EB63 54FD              ANL      A,#0FDH
B1:00EB65 F0                MOVX     @DPTR,A
B1:00EB66 7B01              MOV      R3,#01H
B1:00EB68 7A2B              MOV      R2,#HIGH slaveFrameBuffer+05H
B1:00EB6A 79C0              MOV      R1,#LOW slaveFrameBuffer+05H
B1:00EB6C 903C31            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+03H
B1:00EB6F 1225A9            LCALL    ?C?PSTXDATA
B1:00EB72 12FDBB            LCALL    ?L?COM02F0
B1:00EB75 121EA8            LCALL    ?INTERBANK_TABLE?_ApplicationNodeInformation
B1:00EB78         ?C0105?ZW_SLAVE:
B1:00EB78 51E1              ACALL    AssignTimerStop
B1:00EB7A E4                CLR      A
B1:00EB7B 902B24            MOV      DPTR,#assignState
B1:00EB7E F0                MOVX     @DPTR,A
B1:00EB7F C201              CLR      learnMode
B1:00EB81 C203              CLR      learnModeDsk
B1:00EB83 C202              CLR      findInProgress
B1:00EB85 C204              CLR      learnModeClassic
B1:00EB87 C205              CLR      forceUse40K
B1:00EB89 FF                MOV      R7,A
B1:00EB8A 21DD              AJMP     _ZW_LockRoute
----- FUNCTION _SlaveInit (END) -------


----- FUNCTION ?L?COM0627 (BEGIN) -----
B1:00EB8C F0                MOVX     @DPTR,A
B1:00EB8D 901216            MOV      DPTR,#responseRouteCount
B1:00EB90 E0                MOVX     A,@DPTR
B1:00EB91 14                DEC      A
B1:00EB92 F0                MOVX     @DPTR,A
B1:00EB93 22                RET      
----- FUNCTION ?L?COM0627 (END) -------


----- FUNCTION ?L?COM047A (BEGIN) -----
B1:00EB94 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B1:00EB97         ?L?COM047B:
B1:00EB97 E0                MOVX     A,@DPTR
B1:00EB98 FA                MOV      R2,A
B1:00EB99 A3                INC      DPTR
B1:00EB9A E0                MOVX     A,@DPTR
B1:00EB9B FB                MOV      R3,A
B1:00EB9C 4A                ORL      A,R2
B1:00EB9D 22                RET      
----- FUNCTION ?L?COM047A (END) -------


----- FUNCTION _ZCB_SecureLearnProtocolCallback (BEGIN) -----
B1:00EB9E 903E72            MOV      DPTR,#txStatus
B1:00EBA1 EF                MOV      A,R7
B1:00EBA2 F0                MOVX     @DPTR,A
B1:00EBA3 901221            MOV      DPTR,#nodeID
B1:00EBA6 E0                MOVX     A,@DPTR
B1:00EBA7 701C              JNZ      ?C0076?ZW_SLAVE
B1:00EBA9 12D21B            LCALL    security_reset
B1:00EBAC 7194              ACALL    ?L?COM047A
B1:00EBAE 600D              JZ       ?C0077?ZW_SLAVE
B1:00EBB0 903E72            MOV      DPTR,#txStatus
B1:00EBB3 12B0BE            LCALL    ?L?COM01CA
B1:00EBB6 8B82              MOV      DPL,R3
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 448


B1:00EBB8 8A83              MOV      DPH,R2
B1:00EBBA 12F444            LCALL    ?L?COM03FE
B1:00EBBD         ?C0077?ZW_SLAVE:
B1:00EBBD E4                CLR      A
B1:00EBBE 902B9D            MOV      DPTR,#_learnNodeFunc
B1:00EBC1 F0                MOVX     @DPTR,A
B1:00EBC2 A3                INC      DPTR
B1:00EBC3 F0                MOVX     @DPTR,A
B1:00EBC4 22                RET      
B1:00EBC5         ?C0076?ZW_SLAVE:
B1:00EBC5 903E72            MOV      DPTR,#txStatus
B1:00EBC8 E0                MOVX     A,@DPTR
B1:00EBC9 7008              JNZ      ?C0079?ZW_SLAVE
B1:00EBCB 911D              ACALL    ?L?COM0488
B1:00EBCD FF                MOV      R7,A
B1:00EBCE 9159              ACALL    _security_learn_begin
B1:00EBD0 021D63            LJMP     ?INTERBANK_TABLE?s2_inclusion_neighbor_discovery_complete
B1:00EBD3         ?C0079?ZW_SLAVE:
B1:00EBD3 903E72            MOV      DPTR,#txStatus
B1:00EBD6 E0                MOVX     A,@DPTR
B1:00EBD7 6401              XRL      A,#01H
B1:00EBD9 7035              JNZ      ?C0081?ZW_SLAVE
B1:00EBDB 911D              ACALL    ?L?COM0488
B1:00EBDD FF                MOV      R7,A
B1:00EBDE 91A1              ACALL    _security_learn_begin_early
B1:00EBE0 E4                CLR      A
B1:00EBE1 FF                MOV      R7,A
B1:00EBE2 91C6              ACALL    _secure_learn_set_errno
B1:00EBE4 901223            MOV      DPTR,#homeID
B1:00EBE7 122499            LCALL    ?C?LLDXDATA
B1:00EBEA 121D54            LCALL    ?INTERBANK_TABLE?_S2_init_ctx
B1:00EBED 903501            MOV      DPTR,#s2_ctx
B1:00EBF0 1225A9            LCALL    ?C?PSTXDATA
B1:00EBF3 7A3E              MOV      R2,#HIGH peer
B1:00EBF5 7973              MOV      R1,#LOW peer
B1:00EBF7 7D08              MOV      R5,#08H
B1:00EBF9 12FDEF            LCALL    ?L?COM010B
B1:00EBFC 903E77            MOV      DPTR,#peer+04H
B1:00EBFF 7425              MOV      A,#025H
B1:00EC01 F0                MOVX     @DPTR,A
B1:00EC02 121E1C            LCALL    ?INTERBANK_TABLE?ApplicationSecureAuthenticationRequested
B1:00EC05 AD07              MOV      R5,AR7
B1:00EC07 7B01              MOV      R3,#01H
B1:00EC09 7A3E              MOV      R2,#HIGH peer
B1:00EC0B 7973              MOV      R1,#LOW peer
B1:00EC0D 121D5E            LCALL    ?INTERBANK_TABLE?_s2_inclusion_joining_start
B1:00EC10         ?C0081?ZW_SLAVE:
B1:00EC10 7194              ACALL    ?L?COM047A
B1:00EC12 6008              JZ       ?C0078?ZW_SLAVE
B1:00EC14 903E72            MOV      DPTR,#txStatus
B1:00EC17 12B0BE            LCALL    ?L?COM01CA
B1:00EC1A 912E              ACALL    ?L?COM05D0
B1:00EC1C         ?C0078?ZW_SLAVE:
B1:00EC1C 22                RET      
----- FUNCTION _ZCB_SecureLearnProtocolCallback (END) -------


----- FUNCTION ?L?COM0488 (BEGIN) -----
B1:00EC1D 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B1:00EC20 E0                MOVX     A,@DPTR
B1:00EC21 FE                MOV      R6,A
B1:00EC22 A3                INC      DPTR
B1:00EC23 E0                MOVX     A,@DPTR
B1:00EC24 22                RET      
----- FUNCTION ?L?COM0488 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 449




----- FUNCTION ?L?COM05B6 (BEGIN) -----
B1:00EC25 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00EC28 E0                MOVX     A,@DPTR
B1:00EC29 FF                MOV      R7,A
B1:00EC2A 90417B            MOV      DPTR,#routetmp
B1:00EC2D 22                RET      
----- FUNCTION ?L?COM05B6 (END) -------


----- FUNCTION ?L?COM05D0 (BEGIN) -----
B1:00EC2E 8B82              MOV      DPL,R3
B1:00EC30 8A83              MOV      DPH,R2
B1:00EC32 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM05D0 (END) -------


----- FUNCTION ?L?COM0372 (BEGIN) -----
B1:00EC35 122143            LCALL    ?C?IILDX
B1:00EC38 90427D            MOV      DPTR,#pRoute
B1:00EC3B E0                MOVX     A,@DPTR
B1:00EC3C FA                MOV      R2,A
B1:00EC3D A3                INC      DPTR
B1:00EC3E E0                MOVX     A,@DPTR
B1:00EC3F F582              MOV      DPL,A
B1:00EC41 8A83              MOV      DPH,R2
B1:00EC43 22                RET      
----- FUNCTION ?L?COM0372 (END) -------


----- FUNCTION ZCB_NeighborCompleteFailCall (BEGIN) -----
B1:00EC44 127070            LCALL    ?L?COM00E1
B1:00EC47 E4                CLR      A
B1:00EC48 FF                MOV      R7,A
B1:00EC49 02AFB1            LJMP     _ZCB_NeighborComplete
----- FUNCTION ZCB_NeighborCompleteFailCall (END) -------


----- FUNCTION DelayNeighborCompleteFailCall (BEGIN) -----
B1:00EC4C 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_NeighborCompleteFailCall
B1:00EC4E 7FD5              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_NeighborCompleteFailCall
B1:00EC50 124774            LCALL    ?L?COM0304
B1:00EC53 BFFF02            CJNE     R7,#0FFH,?C0029?ZW_SLAVE
B1:00EC56 9144              ACALL    ZCB_NeighborCompleteFailCall
B1:00EC58         ?C0029?ZW_SLAVE:
B1:00EC58 22                RET      
----- FUNCTION DelayNeighborCompleteFailCall (END) -------


----- FUNCTION _security_learn_begin (BEGIN) -----
B1:00EC59 904344            MOV      DPTR,#__cb
B1:00EC5C EE                MOV      A,R6
B1:00EC5D F0                MOVX     @DPTR,A
B1:00EC5E A3                INC      DPTR
B1:00EC5F EF                MOV      A,R7
B1:00EC60 F0                MOVX     @DPTR,A
B1:00EC61 12B264            LCALL    ?L?COM0090
B1:00EC64 7D08              MOV      R5,#08H
B1:00EC66 121CD2            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00EC69 BF0111            CJNE     R7,#01H,?C0061?ZW_SECURE_LEARN_SUPPORT
B1:00EC6C E4                CLR      A
B1:00EC6D FF                MOV      R7,A
B1:00EC6E 91C6              ACALL    _secure_learn_set_errno
B1:00EC70 904344            MOV      DPTR,#__cb
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 450


B1:00EC73 D1C2              ACALL    ?L?COM043D
B1:00EC75 12B264            LCALL    ?L?COM0090
B1:00EC78 121CD7            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_learnRequest
B1:00EC7B 917E              ACALL    runCycle
B1:00EC7D         ?C0061?ZW_SECURE_LEARN_SUPPORT:
B1:00EC7D 22                RET      
----- FUNCTION _security_learn_begin (END) -------


----- FUNCTION runCycle (BEGIN) -----
B1:00EC7E 902D7D            MOV      DPTR,#ctx
B1:00EC81 E0                MOVX     A,@DPTR
B1:00EC82 904381            MOV      DPTR,#oldState
B1:00EC85 F0                MOVX     @DPTR,A
B1:00EC86 12B264            LCALL    ?L?COM0090
B1:00EC89 021CC8            LJMP     ?INTERBANK_TABLE?_secure_learn_runCycle
----- FUNCTION runCycle (END) -------


----- FUNCTION secure_learnIface_update_callback (BEGIN) -----
B1:00EC8C 22                RET      
----- FUNCTION secure_learnIface_update_callback (END) -------


----- FUNCTION _ZCB_send_data_callback (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B1:00EC8D EF                MOV      A,R7
B1:00EC8E 12B264            LCALL    ?L?COM0090
B1:00EC91 7005              JNZ      ?C0012?ZW_SECURE_LEARN_SUPPORT
B1:00EC93 121CE6            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_done
B1:00EC96 8003              SJMP     ?C0013?ZW_SECURE_LEARN_SUPPORT
B1:00EC98         ?C0012?ZW_SECURE_LEARN_SUPPORT:
B1:00EC98 121CEB            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00EC9B         ?C0013?ZW_SECURE_LEARN_SUPPORT:
B1:00EC9B 917E              ACALL    runCycle
B1:00EC9D 917E              ACALL    runCycle
B1:00EC9F 80DD              SJMP     runCycle
----- FUNCTION _ZCB_send_data_callback (END) -------


----- FUNCTION _security_learn_begin_early (BEGIN) -----
B1:00ECA1 904346            MOV      DPTR,#__cb
B1:00ECA4 EE                MOV      A,R6
B1:00ECA5 F0                MOVX     @DPTR,A
B1:00ECA6 A3                INC      DPTR
B1:00ECA7 EF                MOV      A,R7
B1:00ECA8 F0                MOVX     @DPTR,A
B1:00ECA9 12B264            LCALL    ?L?COM0090
B1:00ECAC 7D09              MOV      R5,#09H
B1:00ECAE 121CD2            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00ECB1 BF0111            CJNE     R7,#01H,?C0063?ZW_SECURE_LEARN_SUPPORT
B1:00ECB4 E4                CLR      A
B1:00ECB5 FF                MOV      R7,A
B1:00ECB6 91C6              ACALL    _secure_learn_set_errno
B1:00ECB8 904346            MOV      DPTR,#__cb
B1:00ECBB D1C2              ACALL    ?L?COM043D
B1:00ECBD 12B264            LCALL    ?L?COM0090
B1:00ECC0 121CDC            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_assignIdDone
B1:00ECC3 917E              ACALL    runCycle
B1:00ECC5         ?C0063?ZW_SECURE_LEARN_SUPPORT:
B1:00ECC5 22                RET      
----- FUNCTION _security_learn_begin_early (END) -------


----- FUNCTION _secure_learn_set_errno (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 451


;---- Variable 'errno' assigned to Register 'R7' ----
B1:00ECC6 902D69            MOV      DPTR,#secureLearnErrno
B1:00ECC9 EF                MOV      A,R7
B1:00ECCA F0                MOVX     @DPTR,A
B1:00ECCB 22                RET      
----- FUNCTION _secure_learn_set_errno (END) -------


----- FUNCTION security_learn_exit (BEGIN) -----
B1:00ECCC 12B264            LCALL    ?L?COM0090
B1:00ECCF 7D09              MOV      R5,#09H
B1:00ECD1 121CD2            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00ECD4 EF                MOV      A,R7
B1:00ECD5 700C              JNZ      ?C0010?ZW_SECURE_LEARN_SUPPORT
B1:00ECD7 12B264            LCALL    ?L?COM0090
B1:00ECDA 121CBE            LCALL    ?INTERBANK_TABLE?_secure_learn_init
B1:00ECDD 12B264            LCALL    ?L?COM0090
B1:00ECE0 121CC3            LCALL    ?INTERBANK_TABLE?_secure_learn_enter
B1:00ECE3         ?C0010?ZW_SECURE_LEARN_SUPPORT:
B1:00ECE3 22                RET      
----- FUNCTION security_learn_exit (END) -------


----- FUNCTION ?L?COM028F (BEGIN) -----
B1:00ECE4 90337A            MOV      DPTR,#sourceNode
B1:00ECE7         ?L?COM0290:
B1:00ECE7 E0                MOVX     A,@DPTR
B1:00ECE8 FF                MOV      R7,A
B1:00ECE9 E4                CLR      A
B1:00ECEA FC                MOV      R4,A
B1:00ECEB FD                MOV      R5,A
B1:00ECEC FE                MOV      R6,A
B1:00ECED 22                RET      
----- FUNCTION ?L?COM028F (END) -------


----- FUNCTION ?L?COM03B4 (BEGIN) -----
B1:00ECEE 7D11              MOV      R5,#011H
B1:00ECF0 1220A6            LCALL    ?C?IMUL
B1:00ECF3         ?L?COM03B5:
B1:00ECF3 741C              MOV      A,#LOW NVM_RETURN_ROUTE_START_far+011H
B1:00ECF5 2F                ADD      A,R7
B1:00ECF6 F9                MOV      R1,A
B1:00ECF7 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+011H
B1:00ECF9 3E                ADDC     A,R6
B1:00ECFA 22                RET      
----- FUNCTION ?L?COM03B4 (END) -------


----- FUNCTION _InternSetLearnMode (BEGIN) -----
B1:00ECFB 90437F            MOV      DPTR,#mode
B1:00ECFE EF                MOV      A,R7
B1:00ECFF F0                MOVX     @DPTR,A
;---- Variable 'learnFunc' assigned to Register 'R4/R5' ----
B1:00ED00 902B24            MOV      DPTR,#assignState
B1:00ED03 E0                MOVX     A,@DPTR
B1:00ED04 7079              JNZ      ?C0085?ZW_SLAVE
B1:00ED06 90437F            MOV      DPTR,#mode
B1:00ED09 E0                MOVX     A,@DPTR
B1:00ED0A FF                MOV      R7,A
B1:00ED0B C3                CLR      C
B1:00ED0C 6001              JZ       ?C0086?ZW_SLAVE
B1:00ED0E D3                SETB     C
B1:00ED0F         ?C0086?ZW_SLAVE:
B1:00ED0F         ?C0087?ZW_SLAVE:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 452


B1:00ED0F 9201              MOV      learnMode,C
B1:00ED11 EF                MOV      A,R7
B1:00ED12 B40103            CJNE     A,#01H,?C0088?ZW_SLAVE
B1:00ED15 D3                SETB     C
B1:00ED16 8001              SJMP     ?C0089?ZW_SLAVE
B1:00ED18         ?C0088?ZW_SLAVE:
B1:00ED18 C3                CLR      C
B1:00ED19         ?C0089?ZW_SLAVE:
B1:00ED19 9204              MOV      learnModeClassic,C
B1:00ED1B 90437F            MOV      DPTR,#mode
B1:00ED1E E0                MOVX     A,@DPTR
B1:00ED1F B40403            CJNE     A,#04H,?C0090?ZW_SLAVE
B1:00ED22 D3                SETB     C
B1:00ED23 8001              SJMP     ?C0091?ZW_SLAVE
B1:00ED25         ?C0090?ZW_SLAVE:
B1:00ED25 C3                CLR      C
B1:00ED26         ?C0091?ZW_SLAVE:
B1:00ED26 9203              MOV      learnModeDsk,C
B1:00ED28 E4                CLR      A
B1:00ED29 F550              MOV      bNetworkWideInclusion,A
B1:00ED2B 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B1:00ED2E 12CF93            LCALL    ?L?COM031F
B1:00ED31 F0                MOVX     @DPTR,A
B1:00ED32 902B9D            MOV      DPTR,#_learnNodeFunc
B1:00ED35 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_SecureLearnProtocolCallback
B1:00ED37 F0                MOVX     @DPTR,A
B1:00ED38 A3                INC      DPTR
B1:00ED39 74F3              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_SecureLearnProtocolCallback
B1:00ED3B F0                MOVX     @DPTR,A
B1:00ED3C 30013B            JNB      learnMode,zw_setlearnmode_abort?ZW_SLAVE
B1:00ED3F 12DE06            LCALL    keystore_keypair_check_and_generate
B1:00ED42 20042F            JB       learnModeClassic,?C0093?ZW_SLAVE
B1:00ED45 90437F            MOV      DPTR,#mode
B1:00ED48 E0                MOVX     A,@DPTR
B1:00ED49 24FE              ADD      A,#0FEH
B1:00ED4B 6015              JZ       ?C0096?ZW_SLAVE
B1:00ED4D 14                DEC      A
B1:00ED4E 6018              JZ       ?C0097?ZW_SLAVE
B1:00ED50 14                DEC      A
B1:00ED51 701B              JNZ      ?C0098?ZW_SLAVE
B1:00ED53         ?C0095?ZW_SLAVE:
B1:00ED53 1261F4            LCALL    NetworkManagementGenerateDskpart
B1:00ED56 7B01              MOV      R3,#01H
B1:00ED58 7A2B              MOV      R2,#HIGH Dsk+0CH
B1:00ED5A 7947              MOV      R1,#LOW Dsk+0CH
B1:00ED5C 126149            LCALL    ?L?COM0047
B1:00ED5F 12FDF6            LCALL    ?L?COM03AF
B1:00ED62         ?C0096?ZW_SLAVE:
B1:00ED62 755001            MOV      bNetworkWideInclusion,#01H
B1:00ED65 C20C              CLR      exploreInclusionModeRepeat
B1:00ED67 22                RET      
B1:00ED68         ?C0097?ZW_SLAVE:
B1:00ED68 755002            MOV      bNetworkWideInclusion,#02H
B1:00ED6B C20C              CLR      exploreInclusionModeRepeat
B1:00ED6D 22                RET      
B1:00ED6E         ?C0098?ZW_SLAVE:
B1:00ED6E C203              CLR      learnModeDsk
B1:00ED70 C201              CLR      learnMode
B1:00ED72 8006              SJMP     zw_setlearnmode_abort?ZW_SLAVE
B1:00ED74         ?C0093?ZW_SLAVE:
B1:00ED74 E4                CLR      A
B1:00ED75 F550              MOV      bNetworkWideInclusion,A
B1:00ED77 C20C              CLR      exploreInclusionModeRepeat
B1:00ED79 22                RET      
B1:00ED7A         zw_setlearnmode_abort:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 453


B1:00ED7A 91CC              ACALL    security_learn_exit
B1:00ED7C 021C82            LJMP     ?INTERBANK_TABLE?sec2_inclusion_abort
B1:00ED7F         ?C0085?ZW_SLAVE:
B1:00ED7F 127070            LCALL    ?L?COM00E1
B1:00ED82 E4                CLR      A
B1:00ED83 FF                MOV      R7,A
B1:00ED84 4166              AJMP     _ZCB_AssignComplete
----- FUNCTION _InternSetLearnMode (END) -------


----- FUNCTION _secure_learnIfaceL_send_scheme_report (BEGIN) -----
B1:00ED86 903C9D            MOV      DPTR,#node
B1:00ED89 1224F1            LCALL    ?C?LSTXDATA
B1:00ED8C 12B264            LCALL    ?L?COM0090
B1:00ED8F 121D0E            LCALL    ?INTERBANK_TABLE?_secure_learnIface_get_scheme
B1:00ED92 903CA9            MOV      DPTR,#ctrlScheme
B1:00ED95 EF                MOV      A,R7
B1:00ED96 F0                MOVX     @DPTR,A
B1:00ED97 12B264            LCALL    ?L?COM0090
B1:00ED9A 121CFA            LCALL    ?INTERBANK_TABLE?_secure_learnIface_get_supported_schemes
B1:00ED9D 1273AC            LCALL    ?L?COM05A4
B1:00EDA0 903CA9            MOV      DPTR,#ctrlScheme
B1:00EDA3 91E7              ACALL    ?L?COM0290
B1:00EDA5 1223A3            LCALL    ?C?LAND
;---- Variable 'my_schemes' assigned to Register 'R7' ----
B1:00EDA8 902DC3            MOV      DPTR,#tx
B1:00EDAB 7498              MOV      A,#098H
B1:00EDAD F0                MOVX     @DPTR,A
B1:00EDAE A3                INC      DPTR
B1:00EDAF 7405              MOV      A,#05H
B1:00EDB1 F0                MOVX     @DPTR,A
B1:00EDB2 EF                MOV      A,R7
B1:00EDB3 30E003            JNB      ACC.0,?C0064?ZW_SECURE_LEARN_SUPPORT
B1:00EDB6 54FE              ANL      A,#0FEH
B1:00EDB8 FF                MOV      R7,A
B1:00EDB9         ?C0064?ZW_SECURE_LEARN_SUPPORT:
B1:00EDB9 902DC5            MOV      DPTR,#tx+02H
B1:00EDBC EF                MOV      A,R7
B1:00EDBD F0                MOVX     @DPTR,A
B1:00EDBE 903C9D            MOV      DPTR,#node
B1:00EDC1 122499            LCALL    ?C?LLDXDATA
B1:00EDC4 C007              PUSH     AR7
B1:00EDC6 7B01              MOV      R3,#01H
B1:00EDC8 7A2D              MOV      R2,#HIGH tx
B1:00EDCA 79C3              MOV      R1,#LOW tx
B1:00EDCC 9040D0            MOV      DPTR,#?_send_and_raise?BYTE+04H
B1:00EDCF 7403              MOV      A,#03H
B1:00EDD1 F0                MOVX     @DPTR,A
B1:00EDD2 903CA1            MOV      DPTR,#txOptions
B1:00EDD5 F149              ACALL    ?L?COM05B1
B1:00EDD7 903CA5            MOV      DPTR,#secure
B1:00EDDA 1247D3            LCALL    ?L?COM061F
B1:00EDDD 24FF              ADD      A,#0FFH
B1:00EDDF 9238              MOV      ?_send_and_raise?BIT,C
B1:00EDE1 D007              POP      AR7
B1:;----                  JMP      _send_and_raise
----- FUNCTION _secure_learnIfaceL_send_scheme_report (END) -------


----- FUNCTION _send_and_raise (BEGIN) -----
B1:00EDE3 9040CC            MOV      DPTR,#node
B1:00EDE6 127088            LCALL    ?L?COM00F4
B1:00EDE9 7A2D              MOV      R2,#HIGH txopt
B1:00EDEB 795D              MOV      R1,#LOW txopt
B1:00EDED 12719E            LCALL    ?L?COM032A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 454


B1:00EDF0 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00EDF3 9040CC            MOV      DPTR,#node
B1:00EDF6 E0                MOVX     A,@DPTR
B1:00EDF7 902D5D            MOV      DPTR,#txopt
B1:00EDFA F0                MOVX     @DPTR,A
B1:00EDFB 9040D1            MOV      DPTR,#txOptions
B1:00EDFE E0                MOVX     A,@DPTR
B1:00EDFF 902D5F            MOV      DPTR,#txopt+02H
B1:00EE02 F0                MOVX     @DPTR,A
B1:00EE03 7F00              MOV      R7,#00H
B1:00EE05 303802            JNB      secure,?C0054?ZW_SECURE_LEARN_SUPPORT
B1:00EE08 7F04              MOV      R7,#04H
B1:00EE0A         ?C0054?ZW_SECURE_LEARN_SUPPORT:
B1:00EE0A         ?C0055?ZW_SECURE_LEARN_SUPPORT:
B1:00EE0A 902D61            MOV      DPTR,#txopt+04H
B1:00EE0D EF                MOV      A,R7
B1:00EE0E F0                MOVX     @DPTR,A
B1:00EE0F 9040D0            MOV      DPTR,#dataLength
B1:00EE12 7A2D              MOV      R2,#HIGH txopt
B1:00EE14 795D              MOV      R1,#LOW txopt
B1:00EE16 127047            LCALL    ?L?COM00AD
B1:00EE19 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B1:00EE1C 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_send_data_callback
B1:00EE1E F0                MOVX     @DPTR,A
B1:00EE1F A3                INC      DPTR
B1:00EE20 747A              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_send_data_callback
B1:00EE22 F0                MOVX     @DPTR,A
B1:00EE23 9040CD            MOV      DPTR,#pBufData
B1:00EE26 122589            LCALL    ?C?PLDXDATA
B1:00EE29 1295E3            LCALL    _ZW_SendDataEx
B1:00EE2C EF                MOV      A,R7
B1:00EE2D 7006              JNZ      ?C0057?ZW_SECURE_LEARN_SUPPORT
B1:00EE2F 12B264            LCALL    ?L?COM0090
B1:00EE32 121CEB            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00EE35         ?C0057?ZW_SECURE_LEARN_SUPPORT:
B1:00EE35 22                RET      
----- FUNCTION _send_and_raise (END) -------


----- FUNCTION ?L?COM03FF (BEGIN) -----
B1:00EE36 7B01              MOV      R3,#01H
B1:00EE38         ?L?COM0400:
B1:00EE38 903C87            MOV      DPTR,#?_CommandHandler?BYTE+04H
B1:00EE3B 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM03FF (END) -------


----- FUNCTION _secure_learn_unsetTimer (BEGIN) -----
B1:00EE3E 904294            MOV      DPTR,#evid
B1:00EE41 1225A9            LCALL    ?C?PSTXDATA
B1:00EE44         ?C0018?ZW_SECURE_LEARN_SUPPORT:
B1:00EE44 7B01              MOV      R3,#01H
B1:00EE46 7A2D              MOV      R2,#HIGH timer
B1:00EE48 796B              MOV      R1,#LOW timer
B1:00EE4A 0298DB            LJMP     _ctimer_stop
----- FUNCTION _secure_learn_unsetTimer (END) -------


----- FUNCTION _secure_learn_setTimer (BEGIN) -----
B1:00EE4D 903F24            MOV      DPTR,#evid
B1:00EE50 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'time_ms' assigned to Register 'R4/R5/R6/R7' ----
B1:00EE53         ?C0016?ZW_SECURE_LEARN_SUPPORT:
B1:00EE53 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B1:00EE56 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_timeout
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 455


B1:00EE58 F0                MOVX     @DPTR,A
B1:00EE59 A3                INC      DPTR
B1:00EE5A 747F              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_timeout
B1:00EE5C F0                MOVX     @DPTR,A
B1:00EE5D 903F24            MOV      DPTR,#evid
B1:00EE60 122589            LCALL    ?C?PLDXDATA
B1:00EE63 12725F            LCALL    ?L?COM0410
B1:00EE66 7A2D              MOV      R2,#HIGH timer
B1:00EE68 796B              MOV      R1,#LOW timer
B1:00EE6A 02D7E7            LJMP     _ctimer_set
----- FUNCTION _secure_learn_setTimer (END) -------


----- FUNCTION _secure_learnIfaceL_send_key_verify (BEGIN) -----
B1:00EE6D 903F2C            MOV      DPTR,#node
B1:00EE70 1224F1            LCALL    ?C?LSTXDATA
B1:00EE73 7B01              MOV      R3,#01H
B1:00EE75 7A2D              MOV      R2,#HIGH txopt
B1:00EE77 7963              MOV      R1,#LOW txopt
B1:00EE79 7D06              MOV      R5,#06H
B1:00EE7B E4                CLR      A
B1:00EE7C FF                MOV      R7,A
B1:00EE7D 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00EE80 903F2C            MOV      DPTR,#node
B1:00EE83 122499            LCALL    ?C?LLDXDATA
B1:00EE86 902D63            MOV      DPTR,#txopt
B1:00EE89 EF                MOV      A,R7
B1:00EE8A F0                MOVX     @DPTR,A
B1:00EE8B 903F30            MOV      DPTR,#txOptions
B1:00EE8E 122499            LCALL    ?C?LLDXDATA
B1:00EE91 902D65            MOV      DPTR,#txopt+02H
B1:00EE94 EF                MOV      A,R7
B1:00EE95 F0                MOVX     @DPTR,A
B1:00EE96 902D67            MOV      DPTR,#txopt+04H
B1:00EE99 7404              MOV      A,#04H
B1:00EE9B F0                MOVX     @DPTR,A
B1:00EE9C 7B01              MOV      R3,#01H
B1:00EE9E 7A2D              MOV      R2,#HIGH txopt
B1:00EEA0 7963              MOV      R1,#LOW txopt
B1:00EEA2 12704B            LCALL    ?L?COM00AE
B1:00EEA5 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B1:00EEA8 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_send_key_verify_callback
B1:00EEAA F0                MOVX     @DPTR,A
B1:00EEAB A3                INC      DPTR
B1:00EEAC 74B6              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_send_key_verify_callback
B1:00EEAE F0                MOVX     @DPTR,A
B1:00EEAF 7A2D              MOV      R2,#HIGH key_verify
B1:00EEB1 797B              MOV      R1,#LOW key_verify
B1:00EEB3 7D02              MOV      R5,#02H
B1:00EEB5 1295E3            LCALL    _ZW_SendDataEx
B1:00EEB8 EF                MOV      A,R7
B1:00EEB9 7006              JNZ      ?C0071?ZW_SECURE_LEARN_SUPPORT
B1:00EEBB 12B264            LCALL    ?L?COM0090
B1:00EEBE 121CEB            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00EEC1         ?C0071?ZW_SECURE_LEARN_SUPPORT:
B1:00EEC1 22                RET      
----- FUNCTION _secure_learnIfaceL_send_key_verify (END) -------


----- FUNCTION ?L?COM043D (BEGIN) -----
B1:00EEC2 E0                MOVX     A,@DPTR
B1:00EEC3 FF                MOV      R7,A
B1:00EEC4 A3                INC      DPTR
B1:00EEC5 E0                MOVX     A,@DPTR
B1:00EEC6 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 456


B1:00EEC9 CF                XCH      A,R7
B1:00EECA F0                MOVX     @DPTR,A
B1:00EECB A3                INC      DPTR
B1:00EECC EF                MOV      A,R7
B1:00EECD F0                MOVX     @DPTR,A
B1:00EECE 22                RET      
----- FUNCTION ?L?COM043D (END) -------


----- FUNCTION _ZCB_send_key_verify_callback (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B1:00EECF EF                MOV      A,R7
B1:00EED0 12B264            LCALL    ?L?COM0090
B1:00EED3 7005              JNZ      ?C0067?ZW_SECURE_LEARN_SUPPORT
B1:00EED5 121CE6            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_done
B1:00EED8 8003              SJMP     ?C0068?ZW_SECURE_LEARN_SUPPORT
B1:00EEDA         ?C0067?ZW_SECURE_LEARN_SUPPORT:
B1:00EEDA 121CEB            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00EEDD         ?C0068?ZW_SECURE_LEARN_SUPPORT:
B1:00EEDD 917E              ACALL    runCycle
B1:00EEDF 817E              AJMP     runCycle
----- FUNCTION _ZCB_send_key_verify_callback (END) -------


----- FUNCTION _secure_learnIfaceI_register_scheme (BEGIN) -----
B1:00EEE1 903F4C            MOV      DPTR,#node
B1:00EEE4 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_register_scheme (END) -------


----- FUNCTION _secure_learnIface_send_commands_supported (BEGIN) -----
B1:00EEE7 903C90            MOV      DPTR,#node
B1:00EEEA 1224F1            LCALL    ?C?LSTXDATA
B1:00EEED E4                CLR      A
B1:00EEEE 903C98            MOV      DPTR,#scheme
B1:00EEF1 F0                MOVX     @DPTR,A
B1:00EEF2 A3                INC      DPTR
B1:00EEF3 F0                MOVX     @DPTR,A
B1:00EEF4 902DC3            MOV      DPTR,#tx
B1:00EEF7 7498              MOV      A,#098H
B1:00EEF9 F0                MOVX     @DPTR,A
B1:00EEFA 7403              MOV      A,#03H
B1:00EEFC 127317            LCALL    ?L?COM04C2
B1:00EEFF 7A3C              MOV      R2,#HIGH cls_count
B1:00EF01 7999              MOV      R1,#LOW cls_count
B1:00EF03 903E5A            MOV      DPTR,#?_ApplicationSecureCommandsSupported?BYTE+04H
B1:00EF06 1225A9            LCALL    ?C?PSTXDATA
B1:00EF09 7A3C              MOV      R2,#HIGH p
B1:00EF0B 09                INC      R1
B1:00EF0C 7F04              MOV      R7,#04H
B1:00EF0E 121EAD            LCALL    ?INTERBANK_TABLE?_ApplicationSecureCommandsSupported
B1:00EF11 903C99            MOV      DPTR,#cls_count
B1:00EF14 E0                MOVX     A,@DPTR
B1:00EF15 FF                MOV      R7,A
B1:00EF16 A3                INC      DPTR
B1:00EF17 122589            LCALL    ?C?PLDXDATA
B1:00EF1A 126149            LCALL    ?L?COM0047
B1:00EF1D 7B01              MOV      R3,#01H
B1:00EF1F 7A2D              MOV      R2,#HIGH tx+03H
B1:00EF21 79C6              MOV      R1,#LOW tx+03H
B1:00EF23 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00EF26 903C90            MOV      DPTR,#node
B1:00EF29 122499            LCALL    ?C?LLDXDATA
B1:00EF2C C007              PUSH     AR7
B1:00EF2E 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 457


B1:00EF30 7A2D              MOV      R2,#HIGH tx
B1:00EF32 79C3              MOV      R1,#LOW tx
B1:00EF34 903C99            MOV      DPTR,#cls_count
B1:00EF37 E0                MOVX     A,@DPTR
B1:00EF38 2403              ADD      A,#03H
B1:00EF3A 9040D0            MOV      DPTR,#?_send_and_raise?BYTE+04H
B1:00EF3D F0                MOVX     @DPTR,A
B1:00EF3E 903C94            MOV      DPTR,#txOptions
B1:00EF41 F149              ACALL    ?L?COM05B1
B1:00EF43 D238              SETB     ?_send_and_raise?BIT
B1:00EF45 D007              POP      AR7
B1:00EF47 A1E3              AJMP     _send_and_raise
----- FUNCTION _secure_learnIface_send_commands_supported (END) -------


----- FUNCTION ?L?COM05B1 (BEGIN) -----
B1:00EF49 122499            LCALL    ?C?LLDXDATA
B1:00EF4C 9040D1            MOV      DPTR,#?_send_and_raise?BYTE+05H
B1:00EF4F EF                MOV      A,R7
B1:00EF50 F0                MOVX     @DPTR,A
B1:00EF51 22                RET      
----- FUNCTION ?L?COM05B1 (END) -------


----- FUNCTION secure_learnIfaceL_set_inclusion_key (BEGIN) -----
B1:00EF52 7F80              MOV      R7,#080H
B1:00EF54 12D267            LCALL    _keystore_network_key_clear
B1:00EF57 021C41            LJMP     ?INTERBANK_TABLE?sec0_unpersist_netkey
----- FUNCTION secure_learnIfaceL_set_inclusion_key (END) -------


----- FUNCTION _NVM_MoveData (BEGIN) -----
B1:00EF5A 902F41            MOV      DPTR,#NVM_WorkPtrRead
;---- Variable 'dataLengthOld' assigned to Register 'R2/R3' ----
B1:00EF5D 1270CD            LCALL    ?L?COM019E
B1:00EF60 127211            LCALL    ?L?COM03B0
B1:00EF63 D3                SETB     C
B1:00EF64 902F42            MOV      DPTR,#NVM_WorkPtrRead+01H
B1:00EF67 E0                MOVX     A,@DPTR
B1:00EF68 9D                SUBB     A,R5
B1:00EF69 902F41            MOV      DPTR,#NVM_WorkPtrRead
B1:00EF6C E0                MOVX     A,@DPTR
B1:00EF6D 9C                SUBB     A,R4
B1:00EF6E 403F              JC       ?C0007?ZW_NVM_REARRANGE
B1:00EF70         ?C0008?ZW_NVM_REARRANGE:
B1:00EF70 902F45            MOV      DPTR,#dataLength
B1:00EF73 12BF75            LCALL    ?L?COM0342
B1:00EF76 9400              SUBB     A,#00H
B1:00EF78 EE                MOV      A,R6
B1:00EF79 9400              SUBB     A,#00H
B1:00EF7B 5003              JNC      $ + 5H
B1:00EF7D 02F00B            LJMP     ?C0017?ZW_NVM_REARRANGE
B1:00EF80 12FDDC            LCALL    ?L?COM061E
B1:00EF83 4004              JC       ?C0010?ZW_NVM_REARRANGE
B1:00EF85 7F80              MOV      R7,#080H
B1:00EF87 8006              SJMP     ?C0011?ZW_NVM_REARRANGE
B1:00EF89         ?C0010?ZW_NVM_REARRANGE:
B1:00EF89 902F45            MOV      DPTR,#dataLength
B1:00EF8C A3                INC      DPTR
B1:00EF8D E0                MOVX     A,@DPTR
B1:00EF8E FF                MOV      R7,A
B1:00EF8F         ?C0011?ZW_NVM_REARRANGE:
B1:00EF8F 902F47            MOV      DPTR,#dataLengthWork
B1:00EF92 EF                MOV      A,R7
B1:00EF93 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 458


B1:00EF94 902F41            MOV      DPTR,#NVM_WorkPtrRead
B1:00EF97 E0                MOVX     A,@DPTR
B1:00EF98 FE                MOV      R6,A
B1:00EF99 A3                INC      DPTR
B1:00EF9A E0                MOVX     A,@DPTR
B1:00EF9B FF                MOV      R7,A
B1:00EF9C 12F020            LCALL    ?L?COM013F
B1:00EF9F 12F00C            LCALL    ?L?COM05E7
B1:00EFA2 FF                MOV      R7,A
B1:00EFA3 7E00              MOV      R6,#00H
B1:00EFA5 12F014            LCALL    ?L?COM04B1
B1:00EFA8 9E                SUBB     A,R6
B1:00EFA9 F0                MOVX     @DPTR,A
B1:00EFAA 12E72C            LCALL    ?L?COM024F
B1:00EFAD 80C1              SJMP     ?C0008?ZW_NVM_REARRANGE
B1:00EFAF         ?C0007?ZW_NVM_REARRANGE:
B1:00EFAF 902F45            MOV      DPTR,#dataLength
B1:00EFB2 E0                MOVX     A,@DPTR
B1:00EFB3 FE                MOV      R6,A
B1:00EFB4 A3                INC      DPTR
B1:00EFB5 E0                MOVX     A,@DPTR
B1:00EFB6 FF                MOV      R7,A
B1:00EFB7 12E72C            LCALL    ?L?COM024F
B1:00EFBA         ?C0013?ZW_NVM_REARRANGE:
B1:00EFBA 902F45            MOV      DPTR,#dataLength
B1:00EFBD 12BF75            LCALL    ?L?COM0342
B1:00EFC0 9400              SUBB     A,#00H
B1:00EFC2 EE                MOV      A,R6
B1:00EFC3 9400              SUBB     A,#00H
B1:00EFC5 4044              JC       ?C0017?ZW_NVM_REARRANGE
B1:00EFC7 12FDDC            LCALL    ?L?COM061E
B1:00EFCA 4004              JC       ?C0015?ZW_NVM_REARRANGE
B1:00EFCC 7F80              MOV      R7,#080H
B1:00EFCE 8006              SJMP     ?C0016?ZW_NVM_REARRANGE
B1:00EFD0         ?C0015?ZW_NVM_REARRANGE:
B1:00EFD0 902F45            MOV      DPTR,#dataLength
B1:00EFD3 A3                INC      DPTR
B1:00EFD4 E0                MOVX     A,@DPTR
B1:00EFD5 FF                MOV      R7,A
B1:00EFD6         ?C0016?ZW_NVM_REARRANGE:
B1:00EFD6 902F47            MOV      DPTR,#dataLengthWork
B1:00EFD9 EF                MOV      A,R7
B1:00EFDA F0                MOVX     @DPTR,A
B1:00EFDB FD                MOV      R5,A
B1:00EFDC 7C00              MOV      R4,#00H
B1:00EFDE C3                CLR      C
B1:00EFDF 902F42            MOV      DPTR,#NVM_WorkPtrRead+01H
B1:00EFE2 E0                MOVX     A,@DPTR
B1:00EFE3 9D                SUBB     A,R5
B1:00EFE4 FF                MOV      R7,A
B1:00EFE5 902F41            MOV      DPTR,#NVM_WorkPtrRead
B1:00EFE8 E0                MOVX     A,@DPTR
B1:00EFE9 9C                SUBB     A,R4
B1:00EFEA FE                MOV      R6,A
B1:00EFEB F0                MOVX     @DPTR,A
B1:00EFEC A3                INC      DPTR
B1:00EFED EF                MOV      A,R7
B1:00EFEE F0                MOVX     @DPTR,A
B1:00EFEF C3                CLR      C
B1:00EFF0 902F44            MOV      DPTR,#NVM_WorkPtrWrite+01H
B1:00EFF3 E0                MOVX     A,@DPTR
B1:00EFF4 9D                SUBB     A,R5
B1:00EFF5 F0                MOVX     @DPTR,A
B1:00EFF6 902F43            MOV      DPTR,#NVM_WorkPtrWrite
B1:00EFF9 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 459


B1:00EFFA 9C                SUBB     A,R4
B1:00EFFB F0                MOVX     @DPTR,A
B1:00EFFC 12F020            LCALL    ?L?COM013F
B1:00EFFF 12F00C            LCALL    ?L?COM05E7
B1:00F002 FF                MOV      R7,A
B1:00F003 12F014            LCALL    ?L?COM04B1
B1:00F006 9400              SUBB     A,#00H
B1:00F008 F0                MOVX     @DPTR,A
B1:00F009 80AF              SJMP     ?C0013?ZW_NVM_REARRANGE
B1:00F00B         ?C0017?ZW_NVM_REARRANGE:
B1:00F00B 22                RET      
----- FUNCTION _NVM_MoveData (END) -------


----- FUNCTION ?L?COM05E7 (BEGIN) -----
B1:00F00C 126C78            LCALL    _NVM_ext_write_buffer
B1:00F00F 902F47            MOV      DPTR,#dataLengthWork
B1:00F012 E0                MOVX     A,@DPTR
B1:00F013 22                RET      
----- FUNCTION ?L?COM05E7 (END) -------


----- FUNCTION ?L?COM04B1 (BEGIN) -----
B1:00F014 C3                CLR      C
B1:00F015 902F46            MOV      DPTR,#dataLength+01H
B1:00F018 E0                MOVX     A,@DPTR
B1:00F019 9F                SUBB     A,R7
B1:00F01A F0                MOVX     @DPTR,A
B1:00F01B 902F45            MOV      DPTR,#dataLength
B1:00F01E E0                MOVX     A,@DPTR
B1:00F01F 22                RET      
----- FUNCTION ?L?COM04B1 (END) -------


----- FUNCTION ?L?COM013F (BEGIN) -----
B1:00F020 7B01              MOV      R3,#01H
B1:00F022 7A2F              MOV      R2,#HIGH workbuf
B1:00F024 7948              MOV      R1,#LOW workbuf
B1:00F026 902F47            MOV      DPTR,#dataLengthWork
B1:00F029 E0                MOVX     A,@DPTR
B1:00F02A 9040B9            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B1:00F02D F0                MOVX     @DPTR,A
B1:00F02E 123F61            LCALL    _NVM_ext_read_buffer
B1:00F031 902F43            MOV      DPTR,#NVM_WorkPtrWrite
B1:00F034 E0                MOVX     A,@DPTR
B1:00F035 FE                MOV      R6,A
B1:00F036 A3                INC      DPTR
B1:00F037 E0                MOVX     A,@DPTR
B1:00F038 FF                MOV      R7,A
B1:00F039 7B01              MOV      R3,#01H
B1:00F03B 7A2F              MOV      R2,#HIGH workbuf
B1:00F03D 7948              MOV      R1,#LOW workbuf
B1:00F03F 902F47            MOV      DPTR,#dataLengthWork
B1:00F042         ?L?COM0140:
B1:00F042 E0                MOVX     A,@DPTR
B1:00F043 FD                MOV      R5,A
B1:00F044 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00F047 E4                CLR      A
B1:00F048 F0                MOVX     @DPTR,A
B1:00F049 A3                INC      DPTR
B1:00F04A ED                MOV      A,R5
B1:00F04B F0                MOVX     @DPTR,A
B1:00F04C 22                RET      
----- FUNCTION ?L?COM013F (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 460



----- FUNCTION ResponseRouteFull (BEGIN) -----
B1:00F04D 901216            MOV      DPTR,#responseRouteCount
B1:00F050 E0                MOVX     A,@DPTR
B1:00F051 B40207            CJNE     A,#02H,?C0007?ZW_ROUTING_ALL
B1:00F054 301704            JNB      routesLocked,?C0007?ZW_ROUTING_ALL
B1:00F057 7F01              MOV      R7,#01H
B1:00F059 8002              SJMP     ?C0008?ZW_ROUTING_ALL
B1:00F05B         ?C0007?ZW_ROUTING_ALL:
B1:00F05B 7F00              MOV      R7,#00H
B1:00F05D         ?C0008?ZW_ROUTING_ALL:
B1:00F05D 22                RET      
----- FUNCTION ResponseRouteFull (END) -------


----- FUNCTION _NetWorkTimerStart (BEGIN) -----
B1:00F05E 904032            MOV      DPTR,#timeOutFunc
B1:00F061 EC                MOV      A,R4
B1:00F062 F0                MOVX     @DPTR,A
B1:00F063 A3                INC      DPTR
B1:00F064 ED                MOV      A,R5
B1:00F065 F0                MOVX     @DPTR,A
B1:00F066 90402F            MOV      DPTR,#timeoutHandle
B1:00F069 1225A9            LCALL    ?C?PSTXDATA
B1:00F06C 121FB3            LCALL    ?C?CLDPTR
B1:00F06F FF                MOV      R7,A
B1:00F070 F4                CPL      A
B1:00F071 6003              JZ       ?C0003?ZW_SLAVE
B1:00F073 0246A0            LJMP     _TimerRestart
B1:00F076         ?C0003?ZW_SLAVE:
B1:00F076 904032            MOV      DPTR,#timeOutFunc
B1:00F079 12723A            LCALL    ?L?COM0401
B1:00F07C 90402F            MOV      DPTR,#timeoutHandle
B1:00F07F 123F95            LCALL    ?L?COM00C0
B1:00F082 90402F            MOV      DPTR,#timeoutHandle
B1:00F085 12975B            LCALL    ?L?COM006B
B1:00F088 B4FF0C            CJNE     A,#0FFH,?C0007?ZW_SLAVE
B1:00F08B 12C7D2            LCALL    ResetSUC
B1:00F08E 1198              ACALL    ?L?COM0247
B1:00F090 6005              JZ       ?C0007?ZW_SLAVE
B1:00F092 8F82              MOV      DPL,R7
B1:00F094 127168            LCALL    ?L?COM0308
B1:00F097         ?C0007?ZW_SLAVE:
B1:00F097 22                RET      
----- FUNCTION _NetWorkTimerStart (END) -------


----- FUNCTION ?L?COM0247 (BEGIN) -----
B1:00F098 902B39            MOV      DPTR,#_routeUpdateDone
B1:00F09B         ?L?COM0248:
B1:00F09B E0                MOVX     A,@DPTR
B1:00F09C FE                MOV      R6,A
B1:00F09D A3                INC      DPTR
B1:00F09E E0                MOVX     A,@DPTR
B1:00F09F FF                MOV      R7,A
B1:00F0A0 4E                ORL      A,R6
B1:00F0A1 22                RET      
----- FUNCTION ?L?COM0247 (END) -------


----- FUNCTION _FindCorrespondingOldNvmModuleDescriptor (BEGIN) -----
B1:00F0A2 903DBB            MOV      DPTR,#bNvmModuleType
B1:00F0A5 EF                MOV      A,R7
B1:00F0A6 F0                MOVX     @DPTR,A
B1:00F0A7 7B02              MOV      R3,#MBYTE nvmZWlibrarySize
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 461


B1:00F0A9 7A00              MOV      R2,#HIGH nvmZWlibrarySize
B1:00F0AB 7902              MOV      R1,#LOW nvmZWlibrarySize
B1:00F0AD A3                INC      DPTR
B1:00F0AE 1225A9            LCALL    ?C?PSTXDATA
B1:00F0B1 8068              SJMP     ?C0053?ZW_NVM_REARRANGE
B1:00F0B3         ?C0001?ZW_NVM_REARRANGE:
B1:00F0B3 903DC2            MOV      DPTR,#nvmModuleSize
B1:00F0B6 119B              ACALL    ?L?COM0248
B1:00F0B8 606D              JZ       ?C0002?ZW_NVM_REARRANGE
B1:00F0BA 903DBC            MOV      DPTR,#nvmModuleWorkPtr
B1:00F0BD 12E4C3            LCALL    ?L?COM0070
B1:00F0C0 3E                ADDC     A,R6
B1:00F0C1 FA                MOV      R2,A
B1:00F0C2 E9                MOV      A,R1
B1:00F0C3 24FB              ADD      A,#0FBH
B1:00F0C5 903DBF            MOV      DPTR,#nvmModuleDescriptorWorkPtr
B1:00F0C8 127159            LCALL    ?L?COM02E7
B1:00F0CB 123F86            LCALL    ?L?COM043F
B1:00F0CE 7A3D              MOV      R2,#HIGH nvmModuleSizeInDescriptor
B1:00F0D0 79C4              MOV      R1,#LOW nvmModuleSizeInDescriptor
B1:00F0D2 123F5B            LCALL    ?L?COM00CA
B1:00F0D5 903DC4            MOV      DPTR,#nvmModuleSizeInDescriptor
B1:00F0D8 E0                MOVX     A,@DPTR
B1:00F0D9 FE                MOV      R6,A
B1:00F0DA A3                INC      DPTR
B1:00F0DB E0                MOVX     A,@DPTR
B1:00F0DC FF                MOV      R7,A
B1:00F0DD 903DC2            MOV      DPTR,#nvmModuleSize
B1:00F0E0 E0                MOVX     A,@DPTR
B1:00F0E1 B50621            CJNE     A,AR6,?C0003?ZW_NVM_REARRANGE
B1:00F0E4 A3                INC      DPTR
B1:00F0E5 E0                MOVX     A,@DPTR
B1:00F0E6 B5071C            CJNE     A,AR7,?C0003?ZW_NVM_REARRANGE
B1:00F0E9 903DBF            MOV      DPTR,#nvmModuleDescriptorWorkPtr
B1:00F0EC 122589            LCALL    ?C?PLDXDATA
B1:00F0EF E9                MOV      A,R1
B1:00F0F0 2402              ADD      A,#02H
B1:00F0F2 F9                MOV      R1,A
B1:00F0F3 E4                CLR      A
B1:00F0F4 3A                ADDC     A,R2
B1:00F0F5 12C67A            LCALL    ?L?COM02E1
;---- Variable 'nvmModuleType' assigned to Register 'R7' ----
B1:00F0F8 903DBB            MOV      DPTR,#bNvmModuleType
B1:00F0FB E0                MOVX     A,@DPTR
B1:00F0FC B50708            CJNE     A,AR7,?C0006?ZW_NVM_REARRANGE
B1:00F0FF 903DBF            MOV      DPTR,#nvmModuleDescriptorWorkPtr
B1:00F102 022589            LJMP     ?C?PLDXDATA
B1:00F105         ?C0003?ZW_NVM_REARRANGE:
B1:00F105 8020              SJMP     ?C0054?ZW_NVM_REARRANGE
B1:00F107         ?C0006?ZW_NVM_REARRANGE:
B1:00F107 903DC2            MOV      DPTR,#nvmModuleSize
B1:00F10A E0                MOVX     A,@DPTR
B1:00F10B FE                MOV      R6,A
B1:00F10C A3                INC      DPTR
B1:00F10D E0                MOVX     A,@DPTR
B1:00F10E FF                MOV      R7,A
B1:00F10F 903DBD            MOV      DPTR,#nvmModuleWorkPtr+01H
B1:00F112 12E738            LCALL    ?L?COM0250
B1:00F115 903DBC            MOV      DPTR,#nvmModuleWorkPtr
B1:00F118 122589            LCALL    ?C?PLDXDATA
B1:00F11B         
B1:00F11B 123F86            LCALL    ?L?COM043F
B1:00F11E 7A3D              MOV      R2,#HIGH nvmModuleSize
B1:00F120 79C2              MOV      R1,#LOW nvmModuleSize
B1:00F122 123F5B            LCALL    ?L?COM00CA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 462


B1:00F125 808C              SJMP     ?C0001?ZW_NVM_REARRANGE
B1:00F127         ?C0002?ZW_NVM_REARRANGE:
B1:00F127         
B1:00F127 027070            LJMP     ?L?COM00E1
----- FUNCTION _FindCorrespondingOldNvmModuleDescriptor (END) -------


----- FUNCTION _ZCB_ReqUpdateCallback (BEGIN) -----
B1:00F12A 90437C            MOV      DPTR,#txStatus
B1:00F12D EF                MOV      A,R7
B1:00F12E F0                MOVX     @DPTR,A
B1:00F12F 7F01              MOV      R7,#01H
B1:00F131 1236A5            LCALL    _ZW_SetRFReceiveMode
B1:00F134 90437C            MOV      DPTR,#txStatus
B1:00F137 E0                MOVX     A,@DPTR
B1:00F138 7004              JNZ      ?C0011?ZW_SLAVE
B1:00F13A 314B              ACALL    ?L?COM0371
B1:00F13C 015E              AJMP     _NetWorkTimerStart
B1:00F13E         ?C0011?ZW_SLAVE:
B1:00F13E 12C7D2            LCALL    ResetSUC
B1:00F141 1198              ACALL    ?L?COM0247
B1:00F143 6005              JZ       ?C0014?ZW_SLAVE
B1:00F145 8F82              MOV      DPL,R7
B1:00F147 127168            LCALL    ?L?COM0308
B1:00F14A         ?C0014?ZW_SLAVE:
B1:00F14A 22                RET      
----- FUNCTION _ZCB_ReqUpdateCallback (END) -------


----- FUNCTION ?L?COM0371 (BEGIN) -----
B1:00F14B 7B01              MOV      R3,#01H
B1:00F14D 7A2B              MOV      R2,#HIGH SUC_Update+01H
B1:00F14F 79A7              MOV      R1,#LOW SUC_Update+01H
B1:00F151 7C19              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_RequestUpdateTimeout
B1:00F153 7DBC              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_RequestUpdateTimeout
B1:00F155 904034            MOV      DPTR,#?_NetWorkTimerStart?BYTE+05H
B1:00F158 74FE              MOV      A,#0FEH
B1:00F15A F0                MOVX     @DPTR,A
B1:00F15B A3                INC      DPTR
B1:00F15C 04                INC      A
B1:00F15D F0                MOVX     @DPTR,A
B1:00F15E 22                RET      
----- FUNCTION ?L?COM0371 (END) -------


----- FUNCTION ZCB_RequestUpdateTimeout (BEGIN) -----
B1:00F15F 902BA8            MOV      DPTR,#SUC_Update+02H
B1:00F162 E0                MOVX     A,@DPTR
B1:00F163 04                INC      A
B1:00F164 F0                MOVX     @DPTR,A
B1:00F165 D3                SETB     C
B1:00F166 9414              SUBB     A,#014H
B1:00F168 400C              JC       ?C0010?ZW_SLAVE
B1:00F16A 1198              ACALL    ?L?COM0247
B1:00F16C 6005              JZ       ?C0009?ZW_SLAVE
B1:00F16E 8F82              MOV      DPL,R7
B1:00F170 127168            LCALL    ?L?COM0308
B1:00F173         ?C0009?ZW_SLAVE:
B1:00F173 12C7D2            LCALL    ResetSUC
B1:00F176         ?C0010?ZW_SLAVE:
B1:00F176 22                RET      
----- FUNCTION ZCB_RequestUpdateTimeout (END) -------


----- FUNCTION _ZW_SetLearnMode (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 463


;---- Variable 'mode' assigned to Register 'R7' ----
;---- Variable 'learnFunc' assigned to Register 'R4/R5' ----
B1:00F177 7403              MOV      A,#03H
B1:00F179 C3                CLR      C
B1:00F17A 9F                SUBB     A,R7
B1:00F17B 5002              JNC      ?C0083?ZW_SLAVE
B1:00F17D E4                CLR      A
B1:00F17E FF                MOV      R7,A
B1:00F17F         ?C0083?ZW_SLAVE:
B1:00F17F 02ECFB            LJMP     _InternSetLearnMode
----- FUNCTION _ZW_SetLearnMode (END) -------


----- FUNCTION ZW_GetSUCNodeID (BEGIN) -----
B1:00F182 902BB4            MOV      DPTR,#sucNodeID
B1:00F185 E0                MOVX     A,@DPTR
B1:00F186 FF                MOV      R7,A
B1:00F187 22                RET      
----- FUNCTION ZW_GetSUCNodeID (END) -------


----- FUNCTION _ZW_RequestNetWorkUpdate (BEGIN) -----
B1:00F188 904340            MOV      DPTR,#completedFunc
B1:00F18B EE                MOV      A,R6
B1:00F18C F0                MOVX     @DPTR,A
B1:00F18D A3                INC      DPTR
B1:00F18E EF                MOV      A,R7
B1:00F18F F0                MOVX     @DPTR,A
B1:00F190 12C747            LCALL    ReloadRouteDestinations
B1:00F193 904340            MOV      DPTR,#completedFunc
B1:00F196 E0                MOVX     A,@DPTR
B1:00F197 FC                MOV      R4,A
B1:00F198 A3                INC      DPTR
B1:00F199 E0                MOVX     A,@DPTR
B1:00F19A FD                MOV      R5,A
B1:00F19B E4                CLR      A
B1:00F19C FF                MOV      R7,A
B1:00F19D 02CE19            LJMP     _ZW_RequestNetworkUpdateInternal
----- FUNCTION _ZW_RequestNetWorkUpdate (END) -------


----- FUNCTION _ZW_RequestNewRouteDestinations (BEGIN) -----
B1:00F1A0 9040C0            MOV      DPTR,#destList
B1:00F1A3 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'destListLen' assigned to Register 'R5' ----
;---- Variable 'i' assigned to Register 'R7' ----
B1:00F1A6 902BB4            MOV      DPTR,#sucNodeID
B1:00F1A9 E0                MOVX     A,@DPTR
B1:00F1AA 6005              JZ       ?C0284?ZW_SLAVE
B1:00F1AC 12CF9A            LCALL    ?L?COM0476
B1:00F1AF 6002              JZ       ?C0283?ZW_SLAVE
B1:00F1B1         ?C0284?ZW_SLAVE:
B1:00F1B1 C3                CLR      C
B1:00F1B2 22                RET      
B1:00F1B3         ?C0283?ZW_SLAVE:
B1:00F1B3 E4                CLR      A
B1:00F1B4 FF                MOV      R7,A
B1:00F1B5         ?C0286?ZW_SLAVE:
B1:00F1B5 EF                MOV      A,R7
B1:00F1B6 C3                CLR      C
B1:00F1B7 9D                SUBB     A,R5
B1:00F1B8 500E              JNC      ?C0289?ZW_SLAVE
B1:00F1BA 9040C0            MOV      DPTR,#destList
B1:00F1BD 122589            LCALL    ?C?PLDXDATA
B1:00F1C0 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 464


B1:00F1C1 2F                ADD      A,R7
B1:00F1C2 128622            LCALL    ?L?COM0006
B1:00F1C5 FE                MOV      R6,A
B1:00F1C6 8002              SJMP     ?C0290?ZW_SLAVE
B1:00F1C8         ?C0289?ZW_SLAVE:
B1:00F1C8 7E00              MOV      R6,#00H
B1:00F1CA         ?C0290?ZW_SLAVE:
B1:00F1CA 12C77D            LCALL    ?L?COM027C
B1:00F1CD EE                MOV      A,R6
B1:00F1CE F0                MOVX     @DPTR,A
B1:00F1CF 0F                INC      R7
B1:00F1D0 EF                MOV      A,R7
B1:00F1D1 B405E1            CJNE     A,#05H,?C0286?ZW_SLAVE
B1:00F1D4         ?C0287?ZW_SLAVE:
B1:00F1D4 7E11              MOV      R6,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00F1D6 7F56              MOV      R7,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00F1D8 12CFA1            LCALL    ?L?COM04F1
B1:00F1DB 12CFE7            LCALL    ?L?COM043C
B1:00F1DE 9040C4            MOV      DPTR,#completedFunc
B1:00F1E1 E0                MOVX     A,@DPTR
B1:00F1E2 FC                MOV      R4,A
B1:00F1E3 A3                INC      DPTR
B1:00F1E4 E0                MOVX     A,@DPTR
B1:00F1E5 FD                MOV      R5,A
B1:00F1E6 7F01              MOV      R7,#01H
B1:00F1E8 12CE19            LCALL    _ZW_RequestNetworkUpdateInternal
B1:00F1EB EF                MOV      A,R7
B1:00F1EC 24FF              ADD      A,#0FFH
B1:00F1EE 22                RET      
----- FUNCTION _ZW_RequestNewRouteDestinations (END) -------


----- FUNCTION _TransportService_msg_received_event (BEGIN) -----
;---- Variable 'cmdLen' assigned to Register 'R5' ----
;---- Variable 'pCmd' assigned to Register 'R1/R2/R3' ----
B1:00F1EF E4                CLR      A
B1:00F1F0 902BB5            MOV      DPTR,#ts_rxOpt
B1:00F1F3 F0                MOVX     @DPTR,A
B1:00F1F4 904185            MOV      DPTR,#srcNode
B1:00F1F7 E0                MOVX     A,@DPTR
B1:00F1F8 902BB6            MOV      DPTR,#ts_rxOpt+01H
B1:00F1FB F0                MOVX     @DPTR,A
B1:00F1FC 901221            MOV      DPTR,#nodeID
B1:00F1FF E0                MOVX     A,@DPTR
B1:00F200 902BB7            MOV      DPTR,#ts_rxOpt+02H
B1:00F203 F0                MOVX     @DPTR,A
B1:00F204 E4                CLR      A
B1:00F205 A3                INC      DPTR
B1:00F206 F0                MOVX     @DPTR,A
B1:00F207 A3                INC      DPTR
B1:00F208 F0                MOVX     @DPTR,A
B1:00F209 C003              PUSH     AR3
B1:00F20B C002              PUSH     AR2
B1:00F20D C001              PUSH     AR1
B1:00F20F 7A2B              MOV      R2,#HIGH ts_rxOpt
B1:00F211 79B5              MOV      R1,#LOW ts_rxOpt
B1:00F213 12EE36            LCALL    ?L?COM03FF
B1:00F216 D001              POP      AR1
B1:00F218 D002              POP      AR2
B1:00F21A D003              POP      AR3
B1:00F21C 02B26B            LJMP     _CommandHandler
----- FUNCTION _TransportService_msg_received_event (END) -------


----- FUNCTION ?L?COM041C (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 465


B1:00F21F C3                CLR      C
B1:00F220 9039C1            MOV      DPTR,#dataLengthOld+01H
B1:00F223 E0                MOVX     A,@DPTR
B1:00F224 99                SUBB     A,R1
B1:00F225 FF                MOV      R7,A
B1:00F226 9039C0            MOV      DPTR,#dataLengthOld
B1:00F229 E0                MOVX     A,@DPTR
B1:00F22A 9A                SUBB     A,R2
B1:00F22B CF                XCH      A,R7
B1:00F22C 22                RET      
----- FUNCTION ?L?COM041C (END) -------


----- FUNCTION Init_ZW_HW (BEGIN) -----
B1:00F22D E4                CLR      A
B1:00F22E F56C              MOV      P0Shadow,A
B1:00F230 F56D              MOV      P1Shadow,A
B1:00F232 F56E              MOV      P2Shadow,A
B1:00F234 F56F              MOV      P3Shadow,A
B1:00F236 75FF01            MOV      SFRPAGE,#01H
B1:00F239 85FD68            MOV      P0ShadowDIR,P0DIR
B1:00F23C 75FF01            MOV      SFRPAGE,#01H
B1:00F23F 85C969            MOV      P1ShadowDIR,P1DIR
B1:00F242 75FF01            MOV      SFRPAGE,#01H
B1:00F245 85CA6A            MOV      P2ShadowDIR,P2DIR
B1:00F248 75FF01            MOV      SFRPAGE,#01H
B1:00F24B 85CB6B            MOV      P3ShadowDIR,P3DIR
B1:00F24E 22                RET      
----- FUNCTION Init_ZW_HW (END) -------


----- FUNCTION _ZW_SoftReset (BEGIN) -----
;---- Variable 'reason' assigned to Register 'R7' ----
B1:00F24F EF                MOV      A,R7
B1:00F250 5156              ACALL    ?L?COM0621
B1:00F252 F0                MOVX     @DPTR,A
B1:00F253 020000            LJMP     00H
----- FUNCTION _ZW_SoftReset (END) -------


----- FUNCTION ?L?COM0621 (BEGIN) -----
B1:00F256 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F259 F0                MOVX     @DPTR,A
B1:00F25A 904380            MOV      DPTR,#wakeUpReason
B1:00F25D 22                RET      
----- FUNCTION ?L?COM0621 (END) -------


----- FUNCTION ZW_getSwWakeupReason (BEGIN) -----
B1:00F25E 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F261 E0                MOVX     A,@DPTR
B1:00F262 FF                MOV      R7,A
B1:00F263 F4                CPL      A
B1:00F264 6005              JZ       ?C0003?ZW_HW_INIT
B1:00F266 904380            MOV      DPTR,#wakeUpReason
B1:00F269 EF                MOV      A,R7
B1:00F26A F0                MOVX     @DPTR,A
B1:00F26B         ?C0003?ZW_HW_INIT:
B1:00F26B 74FF              MOV      A,#0FFH
B1:00F26D 5156              ACALL    ?L?COM0621
B1:00F26F E0                MOVX     A,@DPTR
B1:00F270 FF                MOV      R7,A
B1:00F271 22                RET      
----- FUNCTION ZW_getSwWakeupReason (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 466



----- FUNCTION _ZW_setSwWakeupReason (BEGIN) -----
;---- Variable 'reason' assigned to Register 'R7' ----
B1:00F272 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F275 E0                MOVX     A,@DPTR
B1:00F276 FE                MOV      R6,A
B1:00F277 6406              XRL      A,#06H
B1:00F279 601A              JZ       ?C0005?ZW_HW_INIT
B1:00F27B EF                MOV      A,R7
B1:00F27C B4010F            CJNE     A,#01H,?C0006?ZW_HW_INIT
B1:00F27F 901217            MOV      DPTR,#eSystemTypeState
B1:00F282 E0                MOVX     A,@DPTR
B1:00F283 30E208            JNB      ACC.2,?C0006?ZW_HW_INIT
B1:00F286 904380            MOV      DPTR,#wakeUpReason
B1:00F289 7407              MOV      A,#07H
B1:00F28B F0                MOVX     @DPTR,A
B1:00F28C 8012              SJMP     ?C0008?ZW_HW_INIT
B1:00F28E         ?C0006?ZW_HW_INIT:
B1:00F28E 904380            MOV      DPTR,#wakeUpReason
B1:00F291 EF                MOV      A,R7
B1:00F292 F0                MOVX     @DPTR,A
B1:00F293 800B              SJMP     ?C0008?ZW_HW_INIT
B1:00F295         ?C0005?ZW_HW_INIT:
B1:00F295 904380            MOV      DPTR,#wakeUpReason
B1:00F298 EE                MOV      A,R6
B1:00F299 F0                MOVX     @DPTR,A
B1:00F29A 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F29D 74FF              MOV      A,#0FFH
B1:00F29F F0                MOVX     @DPTR,A
B1:00F2A0         ?C0008?ZW_HW_INIT:
B1:00F2A0 904380            MOV      DPTR,#wakeUpReason
B1:00F2A3 E0                MOVX     A,@DPTR
B1:00F2A4 FF                MOV      R7,A
B1:00F2A5 22                RET      
----- FUNCTION _ZW_setSwWakeupReason (END) -------


----- FUNCTION RFDriverInitHWFLiRS (BEGIN) -----
B1:00F2A6         ?C0001?ZW_RF_DRIVER_INIT:
B1:00F2A6 903206            MOV      DPTR,#rf_table+04H
B1:00F2A9 1224A5            LCALL    ?C?LLDCODE
B1:00F2AC 9037B5            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+04H
B1:00F2AF 51E8              ACALL    ?L?COM0561
B1:00F2B1 9037B9            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+08H
B1:00F2B4 717F              ACALL    ?L?COM05B3
B1:00F2B6 9037BD            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0CH
B1:00F2B9 F0                MOVX     @DPTR,A
B1:00F2BA 90320F            MOV      DPTR,#rf_table+0DH
B1:00F2BD E4                CLR      A
B1:00F2BE 93                MOVC     A,@A+DPTR
B1:00F2BF 9037BE            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0DH
B1:00F2C2 F0                MOVX     @DPTR,A
B1:00F2C3 903210            MOV      DPTR,#rf_table+0EH
B1:00F2C6 E4                CLR      A
B1:00F2C7 93                MOVC     A,@A+DPTR
B1:00F2C8 9037BF            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0EH
B1:00F2CB F0                MOVX     @DPTR,A
B1:00F2CC 903211            MOV      DPTR,#rf_table+0FH
B1:00F2CF E4                CLR      A
B1:00F2D0 93                MOVC     A,@A+DPTR
B1:00F2D1 9037C0            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0FH
B1:00F2D4 F0                MOVX     @DPTR,A
B1:00F2D5 D231              SETB     ?_RF_onetime_init_and_rx?BIT
B1:00F2D7 903202            MOV      DPTR,#rf_table
B1:00F2DA 1224A5            LCALL    ?C?LLDCODE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 467


B1:00F2DD 1249E8            LCALL    _RF_onetime_init_and_rx
B1:00F2E0 50C4              JNC      ?C0001?ZW_RF_DRIVER_INIT
B1:00F2E2         ?C0002?ZW_RF_DRIVER_INIT:
B1:00F2E2 E4                CLR      A
B1:00F2E3 F510              MOV      demodState,A
B1:00F2E5 F514              MOV      RF_state,A
B1:00F2E7 22                RET      
----- FUNCTION RFDriverInitHWFLiRS (END) -------


----- FUNCTION ?L?COM0561 (BEGIN) -----
B1:00F2E8 1224F1            LCALL    ?C?LSTXDATA
B1:00F2EB 90320A            MOV      DPTR,#rf_table+08H
B1:00F2EE 0224A5            LJMP     ?C?LLDCODE
----- FUNCTION ?L?COM0561 (END) -------


----- FUNCTION RFDriverInitHW (BEGIN) -----
B1:00F2F1 C2EB              CLR      ERF
B1:00F2F3 D2FB              SETB     PRF
B1:00F2F5 903206            MOV      DPTR,#rf_table+04H
B1:00F2F8 1224A5            LCALL    ?C?LLDCODE
B1:00F2FB 903934            MOV      DPTR,#?_RF_onetime_init?BYTE+04H
B1:00F2FE 51E8              ACALL    ?L?COM0561
B1:00F300 903938            MOV      DPTR,#?_RF_onetime_init?BYTE+08H
B1:00F303 717F              ACALL    ?L?COM05B3
B1:00F305 90393C            MOV      DPTR,#?_RF_onetime_init?BYTE+0CH
B1:00F308 F0                MOVX     @DPTR,A
B1:00F309 90320F            MOV      DPTR,#rf_table+0DH
B1:00F30C E4                CLR      A
B1:00F30D 93                MOVC     A,@A+DPTR
B1:00F30E 90393D            MOV      DPTR,#?_RF_onetime_init?BYTE+0DH
B1:00F311 F0                MOVX     @DPTR,A
B1:00F312 903210            MOV      DPTR,#rf_table+0EH
B1:00F315 E4                CLR      A
B1:00F316 93                MOVC     A,@A+DPTR
B1:00F317 90393E            MOV      DPTR,#?_RF_onetime_init?BYTE+0EH
B1:00F31A F0                MOVX     @DPTR,A
B1:00F31B 903211            MOV      DPTR,#rf_table+0FH
B1:00F31E E4                CLR      A
B1:00F31F 93                MOVC     A,@A+DPTR
B1:00F320 90393F            MOV      DPTR,#?_RF_onetime_init?BYTE+0FH
B1:00F323 F0                MOVX     @DPTR,A
B1:00F324 D230              SETB     ?_RF_onetime_init?BIT
B1:00F326 903202            MOV      DPTR,#rf_table
B1:00F329 1224A5            LCALL    ?C?LLDCODE
B1:00F32C 124BB8            LCALL    _RF_onetime_init
B1:;----                  JMP      ?L?COM05B2
----- FUNCTION RFDriverInitHW (END) -------


----- FUNCTION ?L?COM05B2 (BEGIN) -----
B1:00F32F E4                CLR      A
B1:00F330 F510              MOV      demodState,A
B1:00F332 F514              MOV      RF_state,A
B1:00F334 751520            MOV      RF_status,#020H
B1:00F337 22                RET      
----- FUNCTION ?L?COM05B2 (END) -------


----- FUNCTION RFDriverInitSW (BEGIN) -----
B1:00F338 712F              ACALL    ?L?COM05B2
B1:00F33A 903212            MOV      DPTR,#rf_table+010H
B1:00F33D 93                MOVC     A,@A+DPTR
B1:00F33E F51B              MOV      normal_PA_POW,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 468


B1:00F340 903215            MOV      DPTR,#rf_table+013H
B1:00F343 E4                CLR      A
B1:00F344 93                MOVC     A,@A+DPTR
B1:00F345 F513              MOV      low_PA_POW,A
B1:00F347 907FB2            MOV      DPTR,#sFlashApplTable+02H
B1:00F34A E4                CLR      A
B1:00F34B 93                MOVC     A,@A+DPTR
B1:00F34C FF                MOV      R7,A
B1:00F34D F4                CPL      A
B1:00F34E 6002              JZ       ?C0012?ZW_RF_DRIVER_INIT
B1:00F350 8F1B              MOV      normal_PA_POW,R7
B1:00F352         ?C0012?ZW_RF_DRIVER_INIT:
B1:00F352 907FB5            MOV      DPTR,#sFlashApplTable+05H
B1:00F355 E4                CLR      A
B1:00F356 93                MOVC     A,@A+DPTR
B1:00F357 FF                MOV      R7,A
B1:00F358 F4                CPL      A
B1:00F359 6002              JZ       ?C0013?ZW_RF_DRIVER_INIT
B1:00F35B 8F13              MOV      low_PA_POW,R7
B1:00F35D         ?C0013?ZW_RF_DRIVER_INIT:
B1:00F35D AF1B              MOV      R7,normal_PA_POW
B1:00F35F 7188              ACALL    _RFDriverPowerToIndex
B1:00F361 903218            MOV      DPTR,#rf_table+016H
B1:00F364 E4                CLR      A
B1:00F365 93                MOVC     A,@A+DPTR
B1:00F366 90086B            MOV      DPTR,#bListenRSSIThreshold
B1:00F369 F0                MOVX     @DPTR,A
B1:00F36A 903219            MOV      DPTR,#rf_table+017H
B1:00F36D E4                CLR      A
B1:00F36E 93                MOVC     A,@A+DPTR
B1:00F36F 90086C            MOV      DPTR,#bListenRSSIThreshold+01H
B1:00F372 F0                MOVX     @DPTR,A
B1:00F373 90321A            MOV      DPTR,#rf_table+018H
B1:00F376 E4                CLR      A
B1:00F377 93                MOVC     A,@A+DPTR
B1:00F378 90086D            MOV      DPTR,#bListenRSSIThreshold+02H
B1:00F37B F0                MOVX     @DPTR,A
B1:00F37C 0260CB            LJMP     ZW_ClearTxTimers
----- FUNCTION RFDriverInitSW (END) -------


----- FUNCTION ?L?COM05B3 (BEGIN) -----
B1:00F37F 1224F1            LCALL    ?C?LSTXDATA
B1:00F382 90320E            MOV      DPTR,#rf_table+0CH
B1:00F385 E4                CLR      A
B1:00F386 93                MOVC     A,@A+DPTR
B1:00F387 22                RET      
----- FUNCTION ?L?COM05B3 (END) -------


----- FUNCTION _RFDriverPowerToIndex (BEGIN) -----
;---- Variable 'bPower' assigned to Register 'R7' ----
B1:00F388 E4                CLR      A
B1:00F389 F517              MOV      powerIndex,A
B1:00F38B         ?C0005?ZW_RF_DRIVER_INIT:
B1:00F38B E517              MOV      A,powerIndex
B1:00F38D 90316E            MOV      DPTR,#rf_power_table
B1:00F390 93                MOVC     A,@A+DPTR
B1:00F391 D3                SETB     C
B1:00F392 9F                SUBB     A,R7
B1:00F393 4007              JC       ?C0006?ZW_RF_DRIVER_INIT
B1:00F395         ?C0008?ZW_RF_DRIVER_INIT:
B1:00F395         ?C0007?ZW_RF_DRIVER_INIT:
B1:00F395 0517              INC      powerIndex
B1:00F397 E517              MOV      A,powerIndex
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 469


B1:00F399 B40EEF            CJNE     A,#0EH,?C0005?ZW_RF_DRIVER_INIT
B1:00F39C         ?C0006?ZW_RF_DRIVER_INIT:
B1:00F39C E517              MOV      A,powerIndex
B1:00F39E C3                CLR      C
B1:00F39F 940E              SUBB     A,#0EH
B1:00F3A1 4004              JC       ?C0009?ZW_RF_DRIVER_INIT
B1:00F3A3 7517FF            MOV      powerIndex,#0FFH
B1:00F3A6 22                RET      
B1:00F3A7         ?C0009?ZW_RF_DRIVER_INIT:
B1:00F3A7 E517              MOV      A,powerIndex
B1:00F3A9 C4                SWAP     A
B1:00F3AA 54F0              ANL      A,#0F0H
B1:00F3AC F517              MOV      powerIndex,A
B1:00F3AE 22                RET      
----- FUNCTION _RFDriverPowerToIndex (END) -------


----- FUNCTION TxQueueIsEmpty (BEGIN) -----
;---- Variable 'bCount' assigned to Register 'R7' ----
B1:00F3AF E4                CLR      A
B1:00F3B0 FF                MOV      R7,A
B1:00F3B1         ?C0038?ZW_TX_QUEUE:
B1:00F3B1 128342            LCALL    ?L?COM0132
B1:00F3B4 E0                MOVX     A,@DPTR
B1:00F3B5 6003              JZ       ?C0040?ZW_TX_QUEUE
B1:00F3B7 7F00              MOV      R7,#00H
B1:00F3B9 22                RET      
B1:00F3BA         ?C0040?ZW_TX_QUEUE:
B1:00F3BA 0F                INC      R7
B1:00F3BB EF                MOV      A,R7
B1:00F3BC B404F2            CJNE     A,#04H,?C0038?ZW_TX_QUEUE
B1:00F3BF         ?C0039?ZW_TX_QUEUE:
B1:00F3BF 7F01              MOV      R7,#01H
B1:00F3C1 22                RET      
----- FUNCTION TxQueueIsEmpty (END) -------


----- FUNCTION TxQueueIsIdle (BEGIN) -----
;---- Variable 'bCount' assigned to Register 'R7' ----
B1:00F3C2 E4                CLR      A
B1:00F3C3 FF                MOV      R7,A
B1:00F3C4         ?C0043?ZW_TX_QUEUE:
B1:00F3C4 128342            LCALL    ?L?COM0132
B1:00F3C7 E0                MOVX     A,@DPTR
B1:00F3C8 54F0              ANL      A,#0F0H
B1:00F3CA FE                MOV      R6,A
B1:00F3CB BE4003            CJNE     R6,#040H,?C0045?ZW_TX_QUEUE
B1:00F3CE 7F00              MOV      R7,#00H
B1:00F3D0 22                RET      
B1:00F3D1         ?C0045?ZW_TX_QUEUE:
B1:00F3D1 0F                INC      R7
B1:00F3D2 EF                MOV      A,R7
B1:00F3D3 B404EE            CJNE     A,#04H,?C0043?ZW_TX_QUEUE
B1:00F3D6         ?C0044?ZW_TX_QUEUE:
B1:00F3D6 7F01              MOV      R7,#01H
B1:00F3D8 22                RET      
----- FUNCTION TxQueueIsIdle (END) -------


----- FUNCTION TxQueueWaitForIdle (BEGIN) -----
B1:00F3D9         ?C0055?ZW_TX_QUEUE:
B1:00F3D9 71C2              ACALL    TxQueueIsIdle
B1:00F3DB EF                MOV      A,R7
B1:00F3DC 7005              JNZ      ?C0057?ZW_TX_QUEUE
B1:00F3DE 1281F3            LCALL    TxQueueServiceTransmit
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 470


B1:00F3E1 80F6              SJMP     ?C0055?ZW_TX_QUEUE
B1:00F3E3         ?C0057?ZW_TX_QUEUE:
B1:00F3E3 22                RET      
----- FUNCTION TxQueueWaitForIdle (END) -------


----- FUNCTION _list_tail (BEGIN) -----
B1:00F3E4 9040C6            MOV      DPTR,#list
B1:00F3E7 1271F8            LCALL    ?L?COM0385
B1:00F3EA E9                MOV      A,R1
B1:00F3EB 4A                ORL      A,R2
B1:00F3EC 7004              JNZ      ?C0003?LIST
B1:00F3EE FB                MOV      R3,A
B1:00F3EF FA                MOV      R2,A
B1:00F3F0 F9                MOV      R1,A
B1:00F3F1 22                RET      
B1:00F3F2         ?C0003?LIST:
B1:00F3F2 9040C6            MOV      DPTR,#list
B1:00F3F5 122589            LCALL    ?C?PLDXDATA
B1:00F3F8 1225BE            LCALL    ?C?PLDPTR
B1:00F3FB 8009              SJMP     ?C0020?LIST
B1:00F3FD         ?C0005?LIST:
B1:00F3FD 9040C9            MOV      DPTR,#l
B1:00F400 1290A1            LCALL    ?L?COM01C8
B1:00F403 4A                ORL      A,R2
B1:00F404 6008              JZ       ?C0006?LIST
B1:00F406         
B1:00F406 9040C9            MOV      DPTR,#l
B1:00F409 1225A9            LCALL    ?C?PSTXDATA
B1:00F40C 80EF              SJMP     ?C0005?LIST
B1:00F40E         ?C0006?LIST:
B1:00F40E 9040C9            MOV      DPTR,#l
B1:00F411 022589            LJMP     ?C?PLDXDATA
----- FUNCTION _list_tail (END) -------


----- FUNCTION secure_learn_get_errno (BEGIN) -----
B1:00F414 902D69            MOV      DPTR,#secureLearnErrno
B1:00F417 E0                MOVX     A,@DPTR
B1:00F418 FF                MOV      R7,A
B1:00F419 22                RET      
----- FUNCTION secure_learn_get_errno (END) -------


----- FUNCTION _secure_learnIface_complete (BEGIN) -----
B1:00F41A 90421F            MOV      DPTR,#scheme_mask
B1:00F41D 1224F1            LCALL    ?C?LSTXDATA
B1:00F420         ?C0045?ZW_SECURE_LEARN_SUPPORT:
B1:00F420         ?C0046?ZW_SECURE_LEARN_SUPPORT:
B1:00F420 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F423 E0                MOVX     A,@DPTR
B1:00F424 7002              JNZ      ?C0086?ZW_SECURE_LEARN_SUPPORT
B1:00F426 A3                INC      DPTR
B1:00F427 E0                MOVX     A,@DPTR
B1:00F428         ?C0086?ZW_SECURE_LEARN_SUPPORT:
B1:00F428 6013              JZ       ?C0053?ZW_SECURE_LEARN_SUPPORT
B1:00F42A 9114              ACALL    secure_learn_get_errno
B1:00F42C EF                MOV      A,R7
B1:00F42D 6401              XRL      A,#01H
B1:00F42F 600A              JZ       ?C0051?ZW_SECURE_LEARN_SUPPORT
B1:00F431 1273B5            LCALL    ?L?COM05A7
B1:00F434 12BE51            LCALL    ?L?COM00BA
B1:00F437 E4                CLR      A
B1:00F438 FF                MOV      R7,A
B1:00F439 8009              SJMP     ?L?COM03FE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 471


B1:00F43B         ?C0051?ZW_SECURE_LEARN_SUPPORT:
B1:00F43B 913E              ACALL    secure_learn_set_errno_reset
B1:00F43D         ?C0053?ZW_SECURE_LEARN_SUPPORT:
B1:00F43D 22                RET      
----- FUNCTION _secure_learnIface_complete (END) -------


----- FUNCTION secure_learn_set_errno_reset (BEGIN) -----
B1:00F43E E4                CLR      A
B1:00F43F 902D69            MOV      DPTR,#secureLearnErrno
B1:00F442 F0                MOVX     @DPTR,A
B1:00F443 22                RET      
----- FUNCTION secure_learn_set_errno_reset (END) -------


----- FUNCTION ?L?COM03FE (BEGIN) -----
B1:00F444 12271A            LCALL    ?C?ICALL2
B1:00F447 E4                CLR      A
B1:00F448 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F44B F0                MOVX     @DPTR,A
B1:00F44C A3                INC      DPTR
B1:00F44D F0                MOVX     @DPTR,A
B1:00F44E 22                RET      
----- FUNCTION ?L?COM03FE (END) -------


----- FUNCTION security_save_state (BEGIN) -----
B1:00F44F 22                RET      
----- FUNCTION security_save_state (END) -------


----- FUNCTION _ZCB_timeout (BEGIN) -----
B1:00F450 904291            MOV      DPTR,#user
B1:00F453 1225A9            LCALL    ?C?PSTXDATA
B1:00F456 904291            MOV      DPTR,#user
B1:00F459 122589            LCALL    ?C?PLDXDATA
B1:00F45C 904117            MOV      DPTR,#?_secure_learn_raiseTimeEvent?BYTE+03H
B1:00F45F 1225A9            LCALL    ?C?PSTXDATA
B1:00F462 12B264            LCALL    ?L?COM0090
B1:00F465 121CCD            LCALL    ?INTERBANK_TABLE?_secure_learn_raiseTimeEvent
B1:00F468 02EC7E            LJMP     runCycle
----- FUNCTION _ZCB_timeout (END) -------


----- FUNCTION ?L?COM00ED (BEGIN) -----
B1:00F46B 7B01              MOV      R3,#01H
B1:00F46D E4                CLR      A
B1:00F46E FF                MOV      R7,A
B1:00F46F 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM00ED (END) -------


----- FUNCTION secure_learnIfaceL_save_state (BEGIN) -----
B1:00F472 22                RET      
----- FUNCTION secure_learnIfaceL_save_state (END) -------


----- FUNCTION secure_learnIface_state_start_timeout (BEGIN) -----
B1:00F473 7F01              MOV      R7,#01H
B1:00F475 02ECC6            LJMP     _secure_learn_set_errno
----- FUNCTION secure_learnIface_state_start_timeout (END) -------


----- FUNCTION secure_learnIfaceL_new_keys (BEGIN) -----
B1:00F478 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 472


----- FUNCTION secure_learnIfaceL_new_keys (END) -------


----- FUNCTION get_net_scheme (BEGIN) -----
B1:00F479 12B264            LCALL    ?L?COM0090
B1:00F47C 021D18            LJMP     ?INTERBANK_TABLE?_secure_learnIface_get_net_scheme
----- FUNCTION get_net_scheme (END) -------


----- FUNCTION _security_add_begin (BEGIN) -----
B1:00F47F A239              MOV      C,controller
B1:00F481 9239              MOV      controller,C
B1:00F483 22                RET      
----- FUNCTION _security_add_begin (END) -------


----- FUNCTION _secure_learnIfaceI_send_scheme_get (BEGIN) -----
B1:00F484 903F34            MOV      DPTR,#node
B1:00F487 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_send_scheme_get (END) -------


----- FUNCTION _secure_learnIfaceI_send_key (BEGIN) -----
B1:00F48A 903F3C            MOV      DPTR,#node
B1:00F48D 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_send_key (END) -------


----- FUNCTION _secure_learnIfaceI_send_scheme_inherit (BEGIN) -----
B1:00F490 903F44            MOV      DPTR,#node
B1:00F493 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_send_scheme_inherit (END) -------


----- FUNCTION secure_learnIfaceI_restore_key (BEGIN) -----
B1:00F496 22                RET      
----- FUNCTION secure_learnIfaceI_restore_key (END) -------


----- FUNCTION _convert_to_octet_string (BEGIN) -----
B1:00F497 903E86            MOV      DPTR,#Q
;---- Variable 'text_to_encrypt_len' assigned to Register 'R4/R5' ----
B1:00F49A 127409            LCALL    ?L?COM05F6
B1:00F49D 903E8B            MOV      DPTR,#bitmask
B1:00F4A0 74FF              MOV      A,#0FFH
B1:00F4A2 F0                MOVX     @DPTR,A
B1:00F4A3 A3                INC      DPTR
B1:00F4A4 E4                CLR      A
B1:00F4A5 F0                MOVX     @DPTR,A
B1:00F4A6 903E8A            MOV      DPTR,#i
B1:00F4A9 F0                MOVX     @DPTR,A
B1:00F4AA         ?C0001?CCM:
B1:00F4AA 903E89            MOV      DPTR,#q
B1:00F4AD E0                MOVX     A,@DPTR
B1:00F4AE 24FE              ADD      A,#0FEH
B1:00F4B0 FF                MOV      R7,A
B1:00F4B1 A3                INC      DPTR
B1:00F4B2 E0                MOVX     A,@DPTR
B1:00F4B3 FE                MOV      R6,A
B1:00F4B4 C3                CLR      C
B1:00F4B5 9F                SUBB     A,R7
B1:00F4B6 5017              JNC      ?C0002?CCM
B1:00F4B8 903E86            MOV      DPTR,#Q
B1:00F4BB 122589            LCALL    ?C?PLDXDATA
B1:00F4BE 8E82              MOV      DPL,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 473


B1:00F4C0 758300            MOV      DPH,#00H
B1:00F4C3 E4                CLR      A
B1:00F4C4 122084            LCALL    ?C?CSTOPTR
B1:00F4C7 903E8A            MOV      DPTR,#i
B1:00F4CA E0                MOVX     A,@DPTR
B1:00F4CB 04                INC      A
B1:00F4CC F0                MOVX     @DPTR,A
B1:00F4CD 80DB              SJMP     ?C0001?CCM
B1:00F4CF         ?C0002?CCM:
B1:00F4CF 903E8B            MOV      DPTR,#bitmask
B1:00F4D2 E0                MOVX     A,@DPTR
B1:00F4D3 5C                ANL      A,R4
B1:00F4D4 FE                MOV      R6,A
B1:00F4D5 EE                MOV      A,R6
B1:00F4D6 FF                MOV      R7,A
B1:00F4D7 903E86            MOV      DPTR,#Q
B1:00F4DA 122589            LCALL    ?C?PLDXDATA
B1:00F4DD 903E8A            MOV      DPTR,#i
B1:00F4E0 1271E4            LCALL    ?L?COM037B
B1:00F4E3 903E8B            MOV      DPTR,#bitmask
B1:00F4E6 127175            LCALL    ?L?COM0318
B1:00F4E9 5D                ANL      A,R5
B1:00F4EA FF                MOV      R7,A
B1:00F4EB 903E8A            MOV      DPTR,#i
B1:00F4EE E0                MOVX     A,@DPTR
B1:00F4EF F582              MOV      DPL,A
B1:00F4F1 758300            MOV      DPH,#00H
B1:00F4F4 A3                INC      DPTR
B1:00F4F5 EF                MOV      A,R7
B1:00F4F6 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _convert_to_octet_string (END) -------


----- FUNCTION _format_b0 (BEGIN) -----
B1:00F4F9 903B38            MOV      DPTR,#text_to_encrypt_len
B1:00F4FC EC                MOV      A,R4
B1:00F4FD F0                MOVX     @DPTR,A
B1:00F4FE A3                INC      DPTR
B1:00F4FF ED                MOV      A,R5
B1:00F500 F0                MOVX     @DPTR,A
B1:00F501 A3                INC      DPTR
B1:00F502 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 't' assigned to Register 'R7' ----
B1:00F505 903B3A            MOV      DPTR,#first_block
B1:00F508 127111            LCALL    ?L?COM0287
B1:00F50B 903B3A            MOV      DPTR,#first_block
B1:00F50E 12975B            LCALL    ?L?COM006B
B1:00F511 4440              ORL      A,#040H
B1:00F513 122072            LCALL    ?C?CSTPTR
B1:00F516 EF                MOV      A,R7
B1:00F517 24FE              ADD      A,#0FEH
B1:00F519 FF                MOV      R7,A
B1:00F51A E4                CLR      A
B1:00F51B 34FF              ADDC     A,#0FFH
B1:00F51D C3                CLR      C
B1:00F51E 13                RRC      A
B1:00F51F EF                MOV      A,R7
B1:00F520 13                RRC      A
B1:00F521 5407              ANL      A,#07H
B1:00F523 33                RLC      A
B1:00F524 33                RLC      A
B1:00F525 33                RLC      A
B1:00F526 54F8              ANL      A,#0F8H
B1:00F528 FF                MOV      R7,A
B1:00F529 903B3A            MOV      DPTR,#first_block
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 474


B1:00F52C 12975B            LCALL    ?L?COM006B
B1:00F52F 4F                ORL      A,R7
B1:00F530 122072            LCALL    ?C?CSTPTR
B1:00F533 903B3A            MOV      DPTR,#first_block
B1:00F536 12975B            LCALL    ?L?COM006B
B1:00F539 FF                MOV      R7,A
B1:00F53A 12E79D            LCALL    ?L?COM061B
B1:00F53D 4F                ORL      A,R7
B1:00F53E 122072            LCALL    ?C?CSTPTR
B1:00F541 903B40            MOV      DPTR,#i
B1:00F544 7401              MOV      A,#01H
B1:00F546 F0                MOVX     @DPTR,A
B1:00F547         ?C0005?CCM:
B1:00F547 9042AF            MOV      DPTR,#n
B1:00F54A E0                MOVX     A,@DPTR
B1:00F54B 2401              ADD      A,#01H
B1:00F54D FF                MOV      R7,A
B1:00F54E E4                CLR      A
B1:00F54F 903B40            MOV      DPTR,#i
B1:00F552 125566            LCALL    ?L?COM016D
B1:00F555 5020              JNC      ?C0006?CCM
B1:00F557 E0                MOVX     A,@DPTR
B1:00F558 FF                MOV      R7,A
B1:00F559 24FF              ADD      A,#0FFH
B1:00F55B FD                MOV      R5,A
B1:00F55C E4                CLR      A
B1:00F55D 34FF              ADDC     A,#0FFH
B1:00F55F FC                MOV      R4,A
B1:00F560 903B3D            MOV      DPTR,#nonce
B1:00F563 12E78D            LCALL    ?L?COM05CC
B1:00F566 121FF0            LCALL    ?C?CLDOPTR
B1:00F569 903B3A            MOV      DPTR,#first_block
B1:00F56C 12E6C0            LCALL    ?L?COM030A
B1:00F56F 903B40            MOV      DPTR,#i
B1:00F572 E0                MOVX     A,@DPTR
B1:00F573 04                INC      A
B1:00F574 F0                MOVX     @DPTR,A
B1:00F575 80D0              SJMP     ?C0005?CCM
B1:00F577         ?C0006?CCM:
B1:00F577 903B38            MOV      DPTR,#text_to_encrypt_len
B1:00F57A E0                MOVX     A,@DPTR
B1:00F57B FE                MOV      R6,A
B1:00F57C A3                INC      DPTR
B1:00F57D E0                MOVX     A,@DPTR
B1:00F57E FF                MOV      R7,A
B1:00F57F 7B01              MOV      R3,#01H
B1:00F581 7A3B              MOV      R2,#HIGH Q
B1:00F583 7941              MOV      R1,#LOW Q
B1:00F585 9042B0            MOV      DPTR,#q
B1:00F588 E0                MOVX     A,@DPTR
B1:00F589 903E89            MOV      DPTR,#?_convert_to_octet_string?BYTE+05H
B1:00F58C F0                MOVX     @DPTR,A
B1:00F58D 9197              ACALL    _convert_to_octet_string
B1:00F58F 9042B0            MOV      DPTR,#q
B1:00F592 E0                MOVX     A,@DPTR
B1:00F593 FF                MOV      R7,A
B1:00F594 7E00              MOV      R6,#00H
B1:00F596 903B3A            MOV      DPTR,#first_block
B1:00F599 122589            LCALL    ?C?PLDXDATA
B1:00F59C 903B40            MOV      DPTR,#i
B1:00F59F E0                MOVX     A,@DPTR
B1:00F5A0 7C00              MOV      R4,#00H
B1:00F5A2 29                ADD      A,R1
B1:00F5A3 F9                MOV      R1,A
B1:00F5A4 EC                MOV      A,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 475


B1:00F5A5 3A                ADDC     A,R2
B1:00F5A6 A801              MOV      R0,AR1
B1:00F5A8 FC                MOV      R4,A
B1:00F5A9 AD03              MOV      R5,AR3
B1:00F5AB 7B01              MOV      R3,#01H
B1:00F5AD 7A3B              MOV      R2,#HIGH Q
B1:00F5AF 7941              MOV      R1,#LOW Q
B1:00F5B1 121F8D            LCALL    ?C?COPY
B1:00F5B4 7E00              MOV      R6,#00H
B1:00F5B6 7F01              MOV      R7,#01H
B1:00F5B8 22                RET      
----- FUNCTION _format_b0 (END) -------


----- FUNCTION _CCM_encrypt_and_auth (BEGIN) -----
B1:00F5B9 903540            MOV      DPTR,#key
B1:00F5BC D1F7              ACALL    ?L?COM057A
B1:00F5BE 903572            MOV      DPTR,#mac_len
B1:00F5C1 E4                CLR      A
B1:00F5C2 F0                MOVX     @DPTR,A
B1:00F5C3 A3                INC      DPTR
B1:00F5C4 EF                MOV      A,R7
B1:00F5C5 F0                MOVX     @DPTR,A
B1:00F5C6 903550            MOV      DPTR,#text_to_encrypt_len
B1:00F5C9 1247B6            LCALL    ?L?COM031C
B1:00F5CC 12733D            LCALL    ?L?COM04ED
B1:00F5CF FE                MOV      R6,A
B1:00F5D0 ED                MOV      A,R5
B1:00F5D1 C4                SWAP     A
B1:00F5D2 540F              ANL      A,#0FH
B1:00F5D4 48                ORL      A,R0
B1:00F5D5 2401              ADD      A,#01H
B1:00F5D7 FF                MOV      R7,A
B1:00F5D8 E4                CLR      A
B1:00F5D9 3E                ADDC     A,R6
B1:00F5DA 903574            MOV      DPTR,#counter_blocks
B1:00F5DD F0                MOVX     @DPTR,A
B1:00F5DE A3                INC      DPTR
B1:00F5DF EF                MOV      A,R7
B1:00F5E0 F0                MOVX     @DPTR,A
B1:00F5E1 ED                MOV      A,R5
B1:00F5E2 540F              ANL      A,#0FH
B1:00F5E4 6006              JZ       ?C0044?CCM
B1:00F5E6 903574            MOV      DPTR,#counter_blocks
B1:00F5E9 123F7F            LCALL    ?L?COM0081
B1:00F5EC         ?C0044?CCM:
B1:00F5EC 903572            MOV      DPTR,#mac_len
B1:00F5EF A3                INC      DPTR
B1:00F5F0 E0                MOVX     A,@DPTR
B1:00F5F1 FF                MOV      R7,A
B1:00F5F2 D1B9              ACALL    ?L?COM057B
B1:00F5F4 903543            MOV      DPTR,#nonce
B1:00F5F7 122589            LCALL    ?C?PLDXDATA
B1:00F5FA 903B3D            MOV      DPTR,#?_format_b0?BYTE+06H
B1:00F5FD D1A4              ACALL    ?L?COM0282
B1:00F5FF 91F9              ACALL    _format_b0
B1:00F601 903540            MOV      DPTR,#key
B1:00F604 12D6EC            LCALL    ?L?COM0179
B1:00F607 D1A7              ACALL    ?L?COM0283
B1:00F609 12D719            LCALL    _ciph_block
B1:00F60C 903546            MOV      DPTR,#aad
B1:00F60F D1E5              ACALL    ?L?COM0559
B1:00F611 903549            MOV      DPTR,#aad_len
B1:00F614 D1DC              ACALL    ?L?COM0558
B1:00F616 D1B3              ACALL    ?L?COM03D5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 476


B1:00F618 9039D4            MOV      DPTR,#?_format_aad?BYTE+0AH
B1:00F61B D1A4              ACALL    ?L?COM0282
B1:00F61D 12D38A            LCALL    _format_aad
B1:00F620 EF                MOV      A,R7
B1:00F621 4E                ORL      A,R6
B1:00F622 7005              JNZ      ?C0045?CCM
B1:00F624 FF                MOV      R7,A
B1:00F625 FE                MOV      R6,A
B1:00F626 FD                MOV      R5,A
B1:00F627 FC                MOV      R4,A
B1:00F628 22                RET      
B1:00F629         ?C0045?CCM:
B1:00F629 90354D            MOV      DPTR,#plain_ciphertext
B1:00F62C D1D3              ACALL    ?L?COM0557
B1:00F62E 903550            MOV      DPTR,#text_to_encrypt_len
B1:00F631 E0                MOVX     A,@DPTR
B1:00F632 FF                MOV      R7,A
B1:00F633 A3                INC      DPTR
B1:00F634 E0                MOVX     A,@DPTR
B1:00F635 903B73            MOV      DPTR,#?_format_payload_block?BYTE+06H
B1:00F638 D1AE              ACALL    ?L?COM03D4
B1:00F63A 903B75            MOV      DPTR,#?_format_payload_block?BYTE+08H
B1:00F63D D1A4              ACALL    ?L?COM0282
B1:00F63F 12D5E1            LCALL    _format_payload_block
B1:00F642 D1B9              ACALL    ?L?COM057B
B1:00F644 903574            MOV      DPTR,#counter_blocks
B1:00F647 12E7AE            LCALL    ?L?COM00D3
B1:00F64A 7A35              MOV      R2,#HIGH blocks
B1:00F64C 7952              MOV      R1,#LOW blocks
B1:00F64E A3                INC      DPTR
B1:00F64F 1225A9            LCALL    ?C?PSTXDATA
B1:00F652 903543            MOV      DPTR,#nonce
B1:00F655 D1EE              ACALL    ?L?COM055A
B1:00F657 903572            MOV      DPTR,#mac_len
B1:00F65A D1CB              ACALL    ?L?COM0619
B1:00F65C D1AE              ACALL    ?L?COM03D4
B1:00F65E 9036A9            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0FH
B1:00F661 D1A4              ACALL    ?L?COM0282
B1:00F663 9036AC            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+012H
B1:00F666 1225A9            LCALL    ?C?PSTXDATA
B1:00F669 9036AF            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+015H
B1:00F66C E4                CLR      A
B1:00F66D F0                MOVX     @DPTR,A
B1:00F66E A3                INC      DPTR
B1:00F66F 04                INC      A
B1:00F670 F0                MOVX     @DPTR,A
B1:00F671 90354D            MOV      DPTR,#plain_ciphertext
B1:00F674 122589            LCALL    ?C?PLDXDATA
B1:00F677 12E4CB            LCALL    _encrypt_or_decrypt
B1:00F67A D1C2              ACALL    ?L?COM05AC
B1:00F67C 90354D            MOV      DPTR,#plain_ciphertext
B1:00F67F 122589            LCALL    ?C?PLDXDATA
B1:00F682 903550            MOV      DPTR,#text_to_encrypt_len
B1:00F685 12D7D5            LCALL    ?L?COM02F8
B1:00F688 A801              MOV      R0,AR1
B1:00F68A FC                MOV      R4,A
B1:00F68B AD03              MOV      R5,AR3
B1:00F68D D1A7              ACALL    ?L?COM0283
B1:00F68F 121F8D            LCALL    ?C?COPY
B1:00F692 D1C2              ACALL    ?L?COM05AC
B1:00F694 903551            MOV      DPTR,#text_to_encrypt_len+01H
B1:00F697 E0                MOVX     A,@DPTR
B1:00F698 2F                ADD      A,R7
B1:00F699 FF                MOV      R7,A
B1:00F69A 903550            MOV      DPTR,#text_to_encrypt_len
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 477


B1:00F69D E0                MOVX     A,@DPTR
B1:00F69E 3E                ADDC     A,R6
B1:00F69F FE                MOV      R6,A
B1:00F6A0 E4                CLR      A
B1:00F6A1 FC                MOV      R4,A
B1:00F6A2 FD                MOV      R5,A
B1:00F6A3 22                RET      
----- FUNCTION _CCM_encrypt_and_auth (END) -------


----- FUNCTION ?L?COM0282 (BEGIN) -----
B1:00F6A4 1225A9            LCALL    ?C?PSTXDATA
B1:00F6A7         ?L?COM0283:
B1:00F6A7 7B01              MOV      R3,#01H
B1:00F6A9 7A35              MOV      R2,#HIGH blocks
B1:00F6AB 7952              MOV      R1,#LOW blocks
B1:00F6AD 22                RET      
----- FUNCTION ?L?COM0282 (END) -------


----- FUNCTION ?L?COM03D4 (BEGIN) -----
B1:00F6AE CF                XCH      A,R7
B1:00F6AF F0                MOVX     @DPTR,A
B1:00F6B0 A3                INC      DPTR
B1:00F6B1 EF                MOV      A,R7
B1:00F6B2 F0                MOVX     @DPTR,A
B1:00F6B3         ?L?COM03D5:
B1:00F6B3 903540            MOV      DPTR,#key
B1:00F6B6 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03D4 (END) -------


----- FUNCTION ?L?COM057B (BEGIN) -----
B1:00F6B9 903550            MOV      DPTR,#text_to_encrypt_len
B1:00F6BC E0                MOVX     A,@DPTR
B1:00F6BD FC                MOV      R4,A
B1:00F6BE A3                INC      DPTR
B1:00F6BF E0                MOVX     A,@DPTR
B1:00F6C0 FD                MOV      R5,A
B1:00F6C1 22                RET      
----- FUNCTION ?L?COM057B (END) -------


----- FUNCTION ?L?COM05AC (BEGIN) -----
B1:00F6C2 903572            MOV      DPTR,#mac_len
B1:00F6C5 E0                MOVX     A,@DPTR
B1:00F6C6 FE                MOV      R6,A
B1:00F6C7 A3                INC      DPTR
B1:00F6C8 E0                MOVX     A,@DPTR
B1:00F6C9 FF                MOV      R7,A
B1:00F6CA 22                RET      
----- FUNCTION ?L?COM05AC (END) -------


----- FUNCTION ?L?COM0619 (BEGIN) -----
B1:00F6CB E0                MOVX     A,@DPTR
B1:00F6CC FF                MOV      R7,A
B1:00F6CD A3                INC      DPTR
B1:00F6CE E0                MOVX     A,@DPTR
B1:00F6CF 9036A7            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0DH
B1:00F6D2 22                RET      
----- FUNCTION ?L?COM0619 (END) -------


----- FUNCTION ?L?COM0557 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 478


B1:00F6D3 122589            LCALL    ?C?PLDXDATA
B1:00F6D6 903B70            MOV      DPTR,#?_format_payload_block?BYTE+03H
B1:00F6D9 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0557 (END) -------


----- FUNCTION ?L?COM0558 (BEGIN) -----
B1:00F6DC 122499            LCALL    ?C?LLDXDATA
B1:00F6DF 9039D0            MOV      DPTR,#?_format_aad?BYTE+06H
B1:00F6E2 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM0558 (END) -------


----- FUNCTION ?L?COM0559 (BEGIN) -----
B1:00F6E5 122589            LCALL    ?C?PLDXDATA
B1:00F6E8 9039CD            MOV      DPTR,#?_format_aad?BYTE+03H
B1:00F6EB 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0559 (END) -------


----- FUNCTION ?L?COM055A (BEGIN) -----
B1:00F6EE 122589            LCALL    ?C?PLDXDATA
B1:00F6F1 9036A4            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0AH
B1:00F6F4 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM055A (END) -------


----- FUNCTION ?L?COM057A (BEGIN) -----
B1:00F6F7 1225A9            LCALL    ?C?PSTXDATA
B1:00F6FA 9042B1            MOV      DPTR,#t
B1:00F6FD E0                MOVX     A,@DPTR
B1:00F6FE FF                MOV      R7,A
B1:00F6FF 22                RET      
----- FUNCTION ?L?COM057A (END) -------


----- FUNCTION _CCM_decrypt_and_auth (BEGIN) -----
B1:00F700 903405            MOV      DPTR,#key
B1:00F703 D1F7              ACALL    ?L?COM057A
B1:00F705 12FE83            LCALL    ?L?COM0352
B1:00F708 122278            LCALL    ?C?LSUB
B1:00F70B E4                CLR      A
B1:00F70C 7B10              MOV      R3,#010H
B1:00F70E F8                MOV      R0,A
B1:00F70F 122311            LCALL    ?C?ULDIV
B1:00F712 EF                MOV      A,R7
B1:00F713 2401              ADD      A,#01H
B1:00F715 FF                MOV      R7,A
B1:00F716 E4                CLR      A
B1:00F717 3E                ADDC     A,R6
B1:00F718 903439            MOV      DPTR,#num_counter_blocks
B1:00F71B F0                MOVX     @DPTR,A
B1:00F71C A3                INC      DPTR
B1:00F71D EF                MOV      A,R7
B1:00F71E F0                MOVX     @DPTR,A
B1:00F71F 9042B1            MOV      DPTR,#t
B1:00F722 E0                MOVX     A,@DPTR
B1:00F723 FF                MOV      R7,A
B1:00F724 FD                MOV      R5,A
B1:00F725 90344B            MOV      DPTR,#mac_len
B1:00F728 E4                CLR      A
B1:00F729 F0                MOVX     @DPTR,A
B1:00F72A A3                INC      DPTR
B1:00F72B ED                MOV      A,R5
B1:00F72C F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 479


B1:00F72D 12FE83            LCALL    ?L?COM0352
B1:00F730 122278            LCALL    ?C?LSUB
B1:00F733 EF                MOV      A,R7
B1:00F734 540F              ANL      A,#0FH
B1:00F736 FF                MOV      R7,A
B1:00F737 EF                MOV      A,R7
B1:00F738 6006              JZ       ?C0047?CCM
B1:00F73A 903439            MOV      DPTR,#num_counter_blocks
B1:00F73D 123F7F            LCALL    ?L?COM0081
B1:00F740         ?C0047?CCM:
B1:00F740 9042B1            MOV      DPTR,#t
B1:00F743 12ECE7            LCALL    ?L?COM0290
B1:00F746 903415            MOV      DPTR,#ciphertext_len
B1:00F749 12D7A8            LCALL    ?L?COM01C5
B1:00F74C 5003              JNC      ?C0048?CCM
B1:00F74E 02F84C            LJMP     ?C0064?CCM
B1:00F751         ?C0048?CCM:
B1:00F751 12FE88            LCALL    ?L?COM0353
B1:00F754 12FE9D            LCALL    ?L?COM0411
B1:00F757 903439            MOV      DPTR,#num_counter_blocks
B1:00F75A 12E7AE            LCALL    ?L?COM00D3
B1:00F75D 7A34              MOV      R2,#HIGH blocks
B1:00F75F 7919              MOV      R1,#LOW blocks
B1:00F761 A3                INC      DPTR
B1:00F762 1225A9            LCALL    ?C?PSTXDATA
B1:00F765 903408            MOV      DPTR,#nonce
B1:00F768 D1EE              ACALL    ?L?COM055A
B1:00F76A 90344B            MOV      DPTR,#mac_len
B1:00F76D D1CB              ACALL    ?L?COM0619
B1:00F76F CF                XCH      A,R7
B1:00F770 12F85D            LCALL    ?L?COM0406
B1:00F773 9036A9            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0FH
B1:00F776 1225A9            LCALL    ?C?PSTXDATA
B1:00F779 7B01              MOV      R3,#01H
B1:00F77B 7A34              MOV      R2,#HIGH mac
B1:00F77D 793B              MOV      R1,#LOW mac
B1:00F77F 9036AC            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+012H
B1:00F782 1225A9            LCALL    ?C?PSTXDATA
B1:00F785 E4                CLR      A
B1:00F786 9036AF            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+015H
B1:00F789 F0                MOVX     @DPTR,A
B1:00F78A A3                INC      DPTR
B1:00F78B F0                MOVX     @DPTR,A
B1:00F78C 903412            MOV      DPTR,#cipher_plaintext
B1:00F78F 122589            LCALL    ?C?PLDXDATA
B1:00F792 12E4CB            LCALL    _encrypt_or_decrypt
B1:00F795 12F867            LCALL    ?L?COM01DC
B1:00F798 9400              SUBB     A,#00H
B1:00F79A FE                MOV      R6,A
B1:00F79B 903412            MOV      DPTR,#cipher_plaintext
B1:00F79E 12E4C3            LCALL    ?L?COM0070
B1:00F7A1 3E                ADDC     A,R6
B1:00F7A2 FA                MOV      R2,A
B1:00F7A3 C003              PUSH     AR3
B1:00F7A5 C002              PUSH     AR2
B1:00F7A7 C001              PUSH     AR1
B1:00F7A9 12F856            LCALL    ?L?COM0375
B1:00F7AC 12E5CF            LCALL    ?L?COM03E1
B1:00F7AF 9042B1            MOV      DPTR,#t
B1:00F7B2 E0                MOVX     A,@DPTR
B1:00F7B3 FF                MOV      R7,A
B1:00F7B4 903F62            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00F7B7 E4                CLR      A
B1:00F7B8 F0                MOVX     @DPTR,A
B1:00F7B9 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 480


B1:00F7BA EF                MOV      A,R7
B1:00F7BB F0                MOVX     @DPTR,A
B1:00F7BC D001              POP      AR1
B1:00F7BE D002              POP      AR2
B1:00F7C0 D003              POP      AR3
B1:00F7C2 12D5A4            LCALL    _bit_xor
B1:00F7C5 783B              MOV      R0,#LOW mac
B1:00F7C7 7C34              MOV      R4,#HIGH mac
B1:00F7C9 12F878            LCALL    ?L?COM0470
B1:00F7CC 12F856            LCALL    ?L?COM0375
B1:00F7CF 121F8D            LCALL    ?C?COPY
B1:00F7D2 90344B            MOV      DPTR,#mac_len
B1:00F7D5 A3                INC      DPTR
B1:00F7D6 E0                MOVX     A,@DPTR
B1:00F7D7 FF                MOV      R7,A
B1:00F7D8 C007              PUSH     AR7
B1:00F7DA 12FE88            LCALL    ?L?COM0353
B1:00F7DD 12FE9D            LCALL    ?L?COM0411
B1:00F7E0 903408            MOV      DPTR,#nonce
B1:00F7E3 122589            LCALL    ?C?PLDXDATA
B1:00F7E6 903B3D            MOV      DPTR,#?_format_b0?BYTE+06H
B1:00F7E9 1225A9            LCALL    ?C?PSTXDATA
B1:00F7EC 12F856            LCALL    ?L?COM0375
B1:00F7EF D007              POP      AR7
B1:00F7F1 91F9              ACALL    _format_b0
B1:00F7F3 903405            MOV      DPTR,#key
B1:00F7F6 12D6EC            LCALL    ?L?COM0179
B1:00F7F9 12F856            LCALL    ?L?COM0375
B1:00F7FC 12D719            LCALL    _ciph_block
B1:00F7FF 90340B            MOV      DPTR,#aad
B1:00F802 12F6E5            LCALL    ?L?COM0559
B1:00F805 90340E            MOV      DPTR,#aad_len
B1:00F808 12F6DC            LCALL    ?L?COM0558
B1:00F80B 12F861            LCALL    ?L?COM0407
B1:00F80E 9039D4            MOV      DPTR,#?_format_aad?BYTE+0AH
B1:00F811 1225A9            LCALL    ?C?PSTXDATA
B1:00F814 1156              ACALL    ?L?COM0375
B1:00F816 12D38A            LCALL    _format_aad
B1:00F819 EF                MOV      A,R7
B1:00F81A 4E                ORL      A,R6
B1:00F81B 7003              JNZ      ?C0050?CCM
B1:00F81D FE                MOV      R6,A
B1:00F81E FF                MOV      R7,A
B1:00F81F 22                RET      
B1:00F820         ?C0050?CCM:
B1:00F820 903412            MOV      DPTR,#cipher_plaintext
B1:00F823 12F6D3            LCALL    ?L?COM0557
B1:00F826 1167              ACALL    ?L?COM01DC
B1:00F828 9400              SUBB     A,#00H
B1:00F82A 903B73            MOV      DPTR,#?_format_payload_block?BYTE+06H
B1:00F82D 115D              ACALL    ?L?COM0406
B1:00F82F 903B75            MOV      DPTR,#?_format_payload_block?BYTE+08H
B1:00F832 1225A9            LCALL    ?C?PSTXDATA
B1:00F835 1156              ACALL    ?L?COM0375
B1:00F837 12D5E1            LCALL    _format_payload_block
B1:00F83A 7819              MOV      R0,#LOW blocks
B1:00F83C 7C34              MOV      R4,#HIGH blocks
B1:00F83E 1178              ACALL    ?L?COM0470
B1:00F840 7B01              MOV      R3,#01H
B1:00F842 7A34              MOV      R2,#HIGH mac
B1:00F844 793B              MOV      R1,#LOW mac
B1:00F846 1228F3            LCALL    ?C?MEMCMP
B1:00F849 EF                MOV      A,R7
B1:00F84A 6004              JZ       ?C0051?CCM
B1:00F84C         
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 481


B1:00F84C E4                CLR      A
B1:00F84D FE                MOV      R6,A
B1:00F84E FF                MOV      R7,A
B1:00F84F 22                RET      
B1:00F850         ?C0051?CCM:
B1:00F850 1167              ACALL    ?L?COM01DC
B1:00F852 9400              SUBB     A,#00H
B1:00F854 FE                MOV      R6,A
B1:00F855 22                RET      
----- FUNCTION _CCM_decrypt_and_auth (END) -------


----- FUNCTION ?L?COM0375 (BEGIN) -----
B1:00F856 7B01              MOV      R3,#01H
B1:00F858 7A34              MOV      R2,#HIGH blocks
B1:00F85A 7919              MOV      R1,#LOW blocks
B1:00F85C 22                RET      
----- FUNCTION ?L?COM0375 (END) -------


----- FUNCTION ?L?COM0406 (BEGIN) -----
B1:00F85D F0                MOVX     @DPTR,A
B1:00F85E A3                INC      DPTR
B1:00F85F EF                MOV      A,R7
B1:00F860 F0                MOVX     @DPTR,A
B1:00F861         ?L?COM0407:
B1:00F861 903405            MOV      DPTR,#key
B1:00F864 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0406 (END) -------


----- FUNCTION ?L?COM01DC (BEGIN) -----
B1:00F867 903415            MOV      DPTR,#ciphertext_len
B1:00F86A 122499            LCALL    ?C?LLDXDATA
B1:00F86D 9042B1            MOV      DPTR,#t
B1:00F870         ?L?COM01DD:
B1:00F870 E0                MOVX     A,@DPTR
B1:00F871 FD                MOV      R5,A
B1:00F872 C3                CLR      C
B1:00F873 EF                MOV      A,R7
B1:00F874 9D                SUBB     A,R5
B1:00F875 FF                MOV      R7,A
B1:00F876 EE                MOV      A,R6
B1:00F877 22                RET      
----- FUNCTION ?L?COM01DC (END) -------


----- FUNCTION ?L?COM0470 (BEGIN) -----
B1:00F878 9042B1            MOV      DPTR,#t
B1:00F87B E0                MOVX     A,@DPTR
B1:00F87C FF                MOV      R7,A
B1:00F87D 7E00              MOV      R6,#00H
B1:00F87F 7D01              MOV      R5,#01H
B1:00F881 22                RET      
----- FUNCTION ?L?COM0470 (END) -------


----- FUNCTION _get_q_n_t (BEGIN) -----
;---- Variable 'q_out' assigned to Register 'R1/R2/R3' ----
B1:00F882 9042B0            MOV      DPTR,#q
B1:00F885 E0                MOVX     A,@DPTR
B1:00F886 122072            LCALL    ?C?CSTPTR
B1:00F889 9042AF            MOV      DPTR,#n
B1:00F88C E0                MOVX     A,@DPTR
B1:00F88D FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 482


B1:00F88E 903E90            MOV      DPTR,#n_out
B1:00F891 123F95            LCALL    ?L?COM00C0
B1:00F894 9042B1            MOV      DPTR,#t
B1:00F897 E0                MOVX     A,@DPTR
B1:00F898 FF                MOV      R7,A
B1:00F899 903E93            MOV      DPTR,#t_out
B1:00F89C 122589            LCALL    ?C?PLDXDATA
B1:00F89F EF                MOV      A,R7
B1:00F8A0 022072            LJMP     ?C?CSTPTR
----- FUNCTION _get_q_n_t (END) -------


----- FUNCTION _get_q (BEGIN) -----
;---- Variable 'q_out' assigned to Register 'R1/R2/R3' ----
B1:00F8A3 9042B0            MOV      DPTR,#q
B1:00F8A6 E0                MOVX     A,@DPTR
B1:00F8A7 022072            LJMP     ?C?CSTPTR
----- FUNCTION _get_q (END) -------


----- FUNCTION _padding (BEGIN) -----
B1:00F8AA 904044            MOV      DPTR,#lastb
;---- Variable 'j' assigned to Register 'R6/R7' ----
B1:00F8AD 127373            LCALL    ?L?COM0548
B1:00F8B0         ?C0016?AES_CMAC:
B1:00F8B0 90404A            MOV      DPTR,#length
B1:00F8B3 E0                MOVX     A,@DPTR
B1:00F8B4 FD                MOV      R5,A
B1:00F8B5 C3                CLR      C
B1:00F8B6 EF                MOV      A,R7
B1:00F8B7 9D                SUBB     A,R5
B1:00F8B8 7480              MOV      A,#080H
B1:00F8BA F8                MOV      R0,A
B1:00F8BB 6E                XRL      A,R6
B1:00F8BC 98                SUBB     A,R0
B1:00F8BD 5010              JNC      ?C0019?AES_CMAC
B1:00F8BF 904044            MOV      DPTR,#lastb
B1:00F8C2 12D70E            LCALL    ?L?COM0172
B1:00F8C5 121FF0            LCALL    ?C?CLDOPTR
B1:00F8C8 FD                MOV      R5,A
B1:00F8C9 12D70B            LCALL    ?L?COM0171
B1:00F8CC ED                MOV      A,R5
B1:00F8CD 8016              SJMP     ?C0048?AES_CMAC
B1:00F8CF         ?C0019?AES_CMAC:
B1:00F8CF 90404A            MOV      DPTR,#length
B1:00F8D2 E0                MOVX     A,@DPTR
B1:00F8D3 B5070B            CJNE     A,AR7,?C0021?AES_CMAC
B1:00F8D6 E4                CLR      A
B1:00F8D7 B50607            CJNE     A,AR6,?C0021?AES_CMAC
B1:00F8DA 12D70B            LCALL    ?L?COM0171
B1:00F8DD 7480              MOV      A,#080H
B1:00F8DF         
B1:00F8DF 8004              SJMP     ?C0048?AES_CMAC
B1:00F8E1         ?C0021?AES_CMAC:
B1:00F8E1 12D70B            LCALL    ?L?COM0171
B1:00F8E4 E4                CLR      A
B1:00F8E5         
B1:00F8E5 122084            LCALL    ?C?CSTOPTR
B1:00F8E8         ?C0018?AES_CMAC:
B1:00F8E8 0F                INC      R7
B1:00F8E9 BF0001            CJNE     R7,#00H,?C0046?AES_CMAC
B1:00F8EC 0E                INC      R6
B1:00F8ED         ?C0046?AES_CMAC:
B1:00F8ED EF                MOV      A,R7
B1:00F8EE 6410              XRL      A,#010H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 483


B1:00F8F0 4E                ORL      A,R6
B1:00F8F1 70BD              JNZ      ?C0016?AES_CMAC
B1:00F8F3 22                RET      
----- FUNCTION _padding (END) -------


----- FUNCTION _aes_cmac_verify (BEGIN) -----
;---- Variable 'key' assigned to Register 'R1/R2/R3' ----
B1:00F8F4 C003              PUSH     AR3
B1:00F8F6 C002              PUSH     AR2
B1:00F8F8 C001              PUSH     AR1
B1:00F8FA 9038C7            MOV      DPTR,#message
B1:00F8FD 122589            LCALL    ?C?PLDXDATA
B1:00F900 3147              ACALL    ?L?COM0519
B1:00F902 9038CA            MOV      DPTR,#message_length
B1:00F905 E0                MOVX     A,@DPTR
B1:00F906 FF                MOV      R7,A
B1:00F907 A3                INC      DPTR
B1:00F908 E0                MOVX     A,@DPTR
B1:00F909 9030C9            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00F90C 12E7B5            LCALL    ?L?COM00D4
B1:00F90F 7A38              MOV      R2,#HIGH calculated_mac
B1:00F911 79CF              MOV      R1,#LOW calculated_mac
B1:00F913 A3                INC      DPTR
B1:00F914 1225A9            LCALL    ?C?PSTXDATA
B1:00F917 D001              POP      AR1
B1:00F919 D002              POP      AR2
B1:00F91B D003              POP      AR3
B1:00F91D 12DF61            LCALL    _aes_cmac_calculate
;---- Variable 'count' assigned to Register 'R7' ----
B1:00F920 E4                CLR      A
B1:00F921 FF                MOV      R7,A
B1:00F922         ?C0040?AES_CMAC:
B1:00F922 9038CC            MOV      DPTR,#mac
B1:00F925 122589            LCALL    ?C?PLDXDATA
B1:00F928 8F82              MOV      DPL,R7
B1:00F92A 126DCA            LCALL    ?L?COM01DA
B1:00F92D FE                MOV      R6,A
B1:00F92E 74CF              MOV      A,#LOW calculated_mac
B1:00F930 2F                ADD      A,R7
B1:00F931 F582              MOV      DPL,A
B1:00F933 E4                CLR      A
B1:00F934 3438              ADDC     A,#HIGH calculated_mac
B1:00F936 F583              MOV      DPH,A
B1:00F938 E0                MOVX     A,@DPTR
B1:00F939 6E                XRL      A,R6
B1:00F93A 6003              JZ       ?C0042?AES_CMAC
B1:00F93C 7F01              MOV      R7,#01H
B1:00F93E 22                RET      
B1:00F93F         ?C0042?AES_CMAC:
B1:00F93F 0F                INC      R7
B1:00F940 EF                MOV      A,R7
B1:00F941 B410DE            CJNE     A,#010H,?C0040?AES_CMAC
B1:00F944         ?C0041?AES_CMAC:
B1:00F944 7F00              MOV      R7,#00H
B1:00F946 22                RET      
----- FUNCTION _aes_cmac_verify (END) -------


----- FUNCTION ?L?COM0519 (BEGIN) -----
B1:00F947 9030C6            MOV      DPTR,#?_aes_cmac_calculate?BYTE+03H
B1:00F94A 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0519 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 484


----- FUNCTION _tempkey_extract (BEGIN) -----
B1:00F94D 90304A            MOV      DPTR,#ecdh_share_secret
B1:00F950 1225A9            LCALL    ?C?PSTXDATA
B1:00F953 78B3              MOV      R0,#LOW constant_prk
B1:00F955 7C30              MOV      R4,#HIGH constant_prk
B1:00F957 7D01              MOV      R5,#01H
B1:00F959 7BFF              MOV      R3,#0FFH
B1:00F95B 7A31              MOV      R2,#HIGH _?ix1001
B1:00F95D 794F              MOV      R1,#LOW _?ix1001
B1:00F95F 12E232            LCALL    ?L?COM0078
B1:00F962 7853              MOV      R0,#LOW temp
B1:00F964 7C30              MOV      R4,#HIGH temp
B1:00F966 7D01              MOV      R5,#01H
B1:00F968 90304A            MOV      DPTR,#ecdh_share_secret
B1:00F96B 122589            LCALL    ?C?PLDXDATA
B1:00F96E 31A6              ACALL    ?L?COM03B9
B1:00F970 7873              MOV      R0,#LOW temp+020H
B1:00F972 7C30              MOV      R4,#HIGH temp+020H
B1:00F974 7D01              MOV      R5,#01H
B1:00F976 90304D            MOV      DPTR,#auth_tag
B1:00F979 122589            LCALL    ?C?PLDXDATA
B1:00F97C 7F40              MOV      R7,#040H
B1:00F97E 1273E9            LCALL    ?L?COM05E1
B1:00F981 7A30              MOV      R2,#HIGH temp
B1:00F983 7953              MOV      R1,#LOW temp
B1:00F985 3147              ACALL    ?L?COM0519
B1:00F987 9030C9            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00F98A E4                CLR      A
B1:00F98B F0                MOVX     @DPTR,A
B1:00F98C A3                INC      DPTR
B1:00F98D 7460              MOV      A,#060H
B1:00F98F F0                MOVX     @DPTR,A
B1:00F990 903050            MOV      DPTR,#pseudo_random_keymat_output
B1:00F993 122589            LCALL    ?C?PLDXDATA
B1:00F996 9030CB            MOV      DPTR,#?_aes_cmac_calculate?BYTE+08H
B1:00F999 1225A9            LCALL    ?C?PSTXDATA
B1:00F99C 7B01              MOV      R3,#01H
B1:00F99E 7A30              MOV      R2,#HIGH constant_prk
B1:00F9A0 79B3              MOV      R1,#LOW constant_prk
B1:00F9A2 02DF61            LJMP     _aes_cmac_calculate
----- FUNCTION _tempkey_extract (END) -------


----- FUNCTION ?L?COM03B8 (BEGIN) -----
B1:00F9A5 F9                MOV      R1,A
B1:00F9A6         ?L?COM03B9:
B1:00F9A6 7E00              MOV      R6,#00H
B1:00F9A8 7F20              MOV      R7,#020H
B1:00F9AA 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM03B8 (END) -------


----- FUNCTION _mladder (BEGIN) -----
B1:00F9AD 902C07            MOV      DPTR,#xr
B1:00F9B0 12632A            LCALL    ?L?COM015E
B1:00F9B3 E4                CLR      A
B1:00F9B4 902CB1            MOV      DPTR,#prevbit
B1:00F9B7 F0                MOVX     @DPTR,A
B1:00F9B8 7810              MOV      R0,#LOW work
B1:00F9BA 7C2C              MOV      R4,#HIGH work
B1:00F9BC 516C              ACALL    ?L?COM01A2
B1:00F9BE 31A5              ACALL    ?L?COM03B8
B1:00F9C0 7E2C              MOV      R6,#HIGH work+020H
B1:00F9C2 7F30              MOV      R7,#LOW work+020H
B1:00F9C4 121DBD            LCALL    ?INTERBANK_TABLE?_fe25519_setone
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 485


B1:00F9C7 7E2C              MOV      R6,#HIGH work+040H
B1:00F9C9 7F50              MOV      R7,#LOW work+040H
B1:00F9CB 121DB8            LCALL    ?INTERBANK_TABLE?_fe25519_setzero
B1:00F9CE 7870              MOV      R0,#LOW work+060H
B1:00F9D0 7C2C              MOV      R4,#HIGH work+060H
B1:00F9D2 516C              ACALL    ?L?COM01A2
B1:00F9D4 31A5              ACALL    ?L?COM03B8
B1:00F9D6 7E2C              MOV      R6,#HIGH work+080H
B1:00F9D8 7F90              MOV      R7,#LOW work+080H
B1:00F9DA 121DBD            LCALL    ?INTERBANK_TABLE?_fe25519_setone
B1:00F9DD 902CB3            MOV      DPTR,#j
B1:00F9E0 7406              MOV      A,#06H
B1:00F9E2 F0                MOVX     @DPTR,A
B1:00F9E3 A3                INC      DPTR
B1:00F9E4 741F              MOV      A,#01FH
B1:00F9E6 F0                MOVX     @DPTR,A
B1:00F9E7         ?C0003?CURVE25519:
B1:00F9E7         ?C0006?CURVE25519:
B1:00F9E7 902CB3            MOV      DPTR,#j
B1:00F9EA 12E795            LCALL    ?L?COM0615
B1:00F9ED 404B              JC       ?C0007?CURVE25519
B1:00F9EF 902C0D            MOV      DPTR,#s
B1:00F9F2 5171              ACALL    ?L?COM01A4
B1:00F9F4 F9                MOV      R1,A
B1:00F9F5 902CB4            MOV      DPTR,#i
B1:00F9F8 E0                MOVX     A,@DPTR
B1:00F9F9 FD                MOV      R5,A
B1:00F9FA 33                RLC      A
B1:00F9FB 95E0              SUBB     A,ACC
B1:00F9FD 8D82              MOV      DPL,R5
B1:00F9FF F583              MOV      DPH,A
B1:00FA01 121FF0            LCALL    ?C?CLDOPTR
B1:00FA04 FE                MOV      R6,A
B1:00FA05 A807              MOV      R0,AR7
B1:00FA07 08                INC      R0
B1:00FA08 8002              SJMP     ?C0015?CURVE25519
B1:00FA0A         ?C0014?CURVE25519:
B1:00FA0A C3                CLR      C
B1:00FA0B 13                RRC      A
B1:00FA0C         ?C0015?CURVE25519:
B1:00FA0C D8FC              DJNZ     R0,?C0014?CURVE25519
B1:00FA0E 5401              ANL      A,#01H
B1:00FA10 FF                MOV      R7,A
B1:00FA11 902CB0            MOV      DPTR,#bit_
B1:00FA14 F0                MOVX     @DPTR,A
B1:00FA15 A3                INC      DPTR
B1:00FA16 E0                MOVX     A,@DPTR
B1:00FA17 6F                XRL      A,R7
B1:00FA18 FE                MOV      R6,A
B1:00FA19 A3                INC      DPTR
B1:00FA1A F0                MOVX     @DPTR,A
B1:00FA1B FD                MOV      R5,A
B1:00FA1C 902CB1            MOV      DPTR,#prevbit
B1:00FA1F EF                MOV      A,R7
B1:00FA20 F0                MOVX     @DPTR,A
B1:00FA21 7B01              MOV      R3,#01H
B1:00FA23 7A2C              MOV      R2,#HIGH work
B1:00FA25 7910              MOV      R1,#LOW work
B1:00FA27 12BF03            LCALL    _work_cswap
B1:00FA2A 7B01              MOV      R3,#01H
B1:00FA2C 7A2C              MOV      R2,#HIGH work
B1:00FA2E 7910              MOV      R1,#LOW work
B1:00FA30 5179              ACALL    _ladderstep
B1:00FA32 902CB3            MOV      DPTR,#j
B1:00FA35 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 486


B1:00FA36 14                DEC      A
B1:00FA37 F0                MOVX     @DPTR,A
B1:00FA38 80AD              SJMP     ?C0006?CURVE25519
B1:00FA3A         ?C0007?CURVE25519:
B1:00FA3A 902CB3            MOV      DPTR,#j
B1:00FA3D 7407              MOV      A,#07H
B1:00FA3F F0                MOVX     @DPTR,A
B1:00FA40 A3                INC      DPTR
B1:00FA41 E0                MOVX     A,@DPTR
B1:00FA42 14                DEC      A
B1:00FA43 F0                MOVX     @DPTR,A
B1:00FA44 E0                MOVX     A,@DPTR
B1:00FA45 C3                CLR      C
B1:00FA46 6480              XRL      A,#080H
B1:00FA48 9480              SUBB     A,#080H
B1:00FA4A 509B              JNC      ?C0003?CURVE25519
B1:00FA4C         ?C0004?CURVE25519:
B1:00FA4C 516E              ACALL    ?L?COM01A3
B1:00FA4E F8                MOV      R0,A
B1:00FA4F 127094            LCALL    ?L?COM014A
B1:00FA52 7A2C              MOV      R2,#HIGH work+020H
B1:00FA54 7930              MOV      R1,#LOW work+020H
B1:00FA56 31A6              ACALL    ?L?COM03B9
B1:00FA58 902C0A            MOV      DPTR,#zr
B1:00FA5B 5171              ACALL    ?L?COM01A4
B1:00FA5D F8                MOV      R0,A
B1:00FA5E 127094            LCALL    ?L?COM014A
B1:00FA61 7A2C              MOV      R2,#HIGH work+040H
B1:00FA63 7950              MOV      R1,#LOW work+040H
B1:00FA65 7E00              MOV      R6,#00H
B1:00FA67 7F20              MOV      R7,#020H
B1:00FA69 021F8D            LJMP     ?C?COPY
----- FUNCTION _mladder (END) -------


----- FUNCTION ?L?COM01A2 (BEGIN) -----
B1:00FA6C 7D01              MOV      R5,#01H
B1:00FA6E         ?L?COM01A3:
B1:00FA6E 902C07            MOV      DPTR,#xr
B1:00FA71         ?L?COM01A4:
B1:00FA71 E0                MOVX     A,@DPTR
B1:00FA72 FB                MOV      R3,A
B1:00FA73 A3                INC      DPTR
B1:00FA74 E0                MOVX     A,@DPTR
B1:00FA75 FA                MOV      R2,A
B1:00FA76 A3                INC      DPTR
B1:00FA77 E0                MOVX     A,@DPTR
B1:00FA78 22                RET      
----- FUNCTION ?L?COM01A2 (END) -------


----- FUNCTION _ladderstep (BEGIN) -----
B1:00FA79 902A31            MOV      DPTR,#work
B1:00FA7C 12632A            LCALL    ?L?COM015E
B1:00FA7F 902A31            MOV      DPTR,#work
B1:00FA82 124FCF            LCALL    ?L?COM02C5
B1:00FA85 902B14            MOV      DPTR,#x0
B1:00FA88 C9                XCH      A,R1
B1:00FA89 12632B            LCALL    ?L?COM015F
B1:00FA8C 902A31            MOV      DPTR,#work
B1:00FA8F E0                MOVX     A,@DPTR
B1:00FA90 FB                MOV      R3,A
B1:00FA91 A3                INC      DPTR
B1:00FA92 A3                INC      DPTR
B1:00FA93 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 487


B1:00FA94 1272B2            LCALL    ?L?COM0448
B1:00FA97 902B17            MOV      DPTR,#xp
B1:00FA9A 12632A            LCALL    ?L?COM015E
B1:00FA9D 912C              ACALL    ?L?COM041E
B1:00FA9F 2440              ADD      A,#040H
B1:00FAA1 F9                MOV      R1,A
B1:00FAA2 E4                CLR      A
B1:00FAA3 3A                ADDC     A,R2
B1:00FAA4 FA                MOV      R2,A
B1:00FAA5 902B1A            MOV      DPTR,#zp
B1:00FAA8 12632A            LCALL    ?L?COM015E
B1:00FAAB 912C              ACALL    ?L?COM041E
B1:00FAAD 2460              ADD      A,#060H
B1:00FAAF F9                MOV      R1,A
B1:00FAB0 E4                CLR      A
B1:00FAB1 3A                ADDC     A,R2
B1:00FAB2 FA                MOV      R2,A
B1:00FAB3 902B1D            MOV      DPTR,#xq
B1:00FAB6 12632A            LCALL    ?L?COM015E
B1:00FAB9 912C              ACALL    ?L?COM041E
B1:00FABB 2480              ADD      A,#080H
B1:00FABD F9                MOV      R1,A
B1:00FABE E4                CLR      A
B1:00FABF 3A                ADDC     A,R2
B1:00FAC0 FA                MOV      R2,A
B1:00FAC1 902B20            MOV      DPTR,#zq
B1:00FAC4 12632A            LCALL    ?L?COM015E
B1:00FAC7 7E2A              MOV      R6,#HIGH t1
B1:00FAC9 7F34              MOV      R7,#LOW t1
B1:00FACB 71B2              ACALL    ?L?COM0173
B1:00FACD 121DA4            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00FAD0 7E2A              MOV      R6,#HIGH t2
B1:00FAD2 7F54              MOV      R7,#LOW t2
B1:00FAD4 71B2              ACALL    ?L?COM0173
B1:00FAD6 121DA9            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00FAD9 7E2A              MOV      R6,#HIGH t7
B1:00FADB 7FF4              MOV      R7,#LOW t7
B1:00FADD 7C2A              MOV      R4,#HIGH t2
B1:00FADF 7D54              MOV      R5,#LOW t2
B1:00FAE1 121DB3            LCALL    ?INTERBANK_TABLE?_fe25519_square
B1:00FAE4 7E2A              MOV      R6,#HIGH t6
B1:00FAE6 7FD4              MOV      R7,#LOW t6
B1:00FAE8 7C2A              MOV      R4,#HIGH t1
B1:00FAEA 7D34              MOV      R5,#LOW t1
B1:00FAEC 121DB3            LCALL    ?INTERBANK_TABLE?_fe25519_square
B1:00FAEF 7E2A              MOV      R6,#HIGH t5
B1:00FAF1 7FB4              MOV      R7,#LOW t5
B1:00FAF3 7C2A              MOV      R4,#HIGH t6
B1:00FAF5 7DD4              MOV      R5,#LOW t6
B1:00FAF7 7A2A              MOV      R2,#HIGH t7
B1:00FAF9 7BF4              MOV      R3,#LOW t7
B1:00FAFB 121DA9            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00FAFE 7E2A              MOV      R6,#HIGH t3
B1:00FB00 7F74              MOV      R7,#LOW t3
B1:00FB02 902B1D            MOV      DPTR,#xq
B1:00FB05 71B5              ACALL    ?L?COM0174
B1:00FB07 121DA4            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00FB0A 7E2A              MOV      R6,#HIGH t4
B1:00FB0C 7F94              MOV      R7,#LOW t4
B1:00FB0E 902B1D            MOV      DPTR,#xq
B1:00FB11 71B5              ACALL    ?L?COM0174
B1:00FB13 121DA9            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00FB16 7A2A              MOV      R2,#HIGH t2
B1:00FB18 7B54              MOV      R3,#LOW t2
B1:00FB1A AF03              MOV      R7,AR3
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 488


B1:00FB1C AE02              MOV      R6,AR2
B1:00FB1E 7C2A              MOV      R4,#HIGH t3
B1:00FB20 7D74              MOV      R5,#LOW t3
B1:00FB22 121DAE            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00FB25 7E2A              MOV      R6,#HIGH t3
B1:00FB27 7F74              MOV      R7,#LOW t3
B1:00FB29 7C2A              MOV      R4,#HIGH t4
B1:00FB2B 7D94              MOV      R5,#LOW t4
B1:00FB2D 7A2A              MOV      R2,#HIGH t1
B1:00FB2F 7B34              MOV      R3,#LOW t1
B1:00FB31 121DAE            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00FB34 902B1D            MOV      DPTR,#xq
B1:00FB37 9123              ACALL    ?L?COM0309
B1:00FB39 7C2A              MOV      R4,#HIGH t3
B1:00FB3B 7D74              MOV      R5,#LOW t3
B1:00FB3D 7A2A              MOV      R2,#HIGH t2
B1:00FB3F 7B54              MOV      R3,#LOW t2
B1:00FB41 121DA4            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00FB44 902B20            MOV      DPTR,#zq
B1:00FB47 9123              ACALL    ?L?COM0309
B1:00FB49 7C2A              MOV      R4,#HIGH t3
B1:00FB4B 7D74              MOV      R5,#LOW t3
B1:00FB4D 7A2A              MOV      R2,#HIGH t2
B1:00FB4F 7B54              MOV      R3,#LOW t2
B1:00FB51 121DA9            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00FB54 902B1D            MOV      DPTR,#xq
B1:00FB57 71A6              ACALL    ?L?COM01FC
B1:00FB59 121DB3            LCALL    ?INTERBANK_TABLE?_fe25519_square
B1:00FB5C 902B20            MOV      DPTR,#zq
B1:00FB5F 71A6              ACALL    ?L?COM01FC
B1:00FB61 121DB3            LCALL    ?INTERBANK_TABLE?_fe25519_square
B1:00FB64 902B20            MOV      DPTR,#zq
B1:00FB67 71A6              ACALL    ?L?COM01FC
B1:00FB69 902B14            MOV      DPTR,#x0
B1:00FB6C 71BE              ACALL    ?L?COM0175
B1:00FB6E 121DAE            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00FB71 902B17            MOV      DPTR,#xp
B1:00FB74 9123              ACALL    ?L?COM0309
B1:00FB76 7C2A              MOV      R4,#HIGH t6
B1:00FB78 7DD4              MOV      R5,#LOW t6
B1:00FB7A 7A2A              MOV      R2,#HIGH t7
B1:00FB7C 7BF4              MOV      R3,#LOW t7
B1:00FB7E 121DAE            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00FB81 902B1A            MOV      DPTR,#zp
B1:00FB84 9123              ACALL    ?L?COM0309
B1:00FB86 7C2A              MOV      R4,#HIGH t5
B1:00FB88 7DB4              MOV      R5,#LOW t5
B1:00FB8A 7A34              MOV      R2,#HIGH _121666
B1:00FB8C 7B8E              MOV      R3,#LOW _121666
B1:00FB8E 121DAE            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00FB91 71A3              ACALL    ?L?COM01FB
B1:00FB93 7A2A              MOV      R2,#HIGH t7
B1:00FB95 7BF4              MOV      R3,#LOW t7
B1:00FB97 121DA4            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00FB9A 71A3              ACALL    ?L?COM01FB
B1:00FB9C 7A2A              MOV      R2,#HIGH t5
B1:00FB9E 7BB4              MOV      R3,#LOW t5
B1:00FBA0 021DAE            LJMP     ?INTERBANK_TABLE?_fe25519_mul
----- FUNCTION _ladderstep (END) -------


----- FUNCTION ?L?COM01FB (BEGIN) -----
B1:00FBA3 902B1A            MOV      DPTR,#zp
B1:00FBA6         ?L?COM01FC:
B1:00FBA6 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 489


B1:00FBA7 E0                MOVX     A,@DPTR
B1:00FBA8 FA                MOV      R2,A
B1:00FBA9 A3                INC      DPTR
B1:00FBAA E0                MOVX     A,@DPTR
B1:00FBAB AC02              MOV      R4,AR2
B1:00FBAD FD                MOV      R5,A
B1:00FBAE FF                MOV      R7,A
B1:00FBAF AE04              MOV      R6,AR4
B1:00FBB1 22                RET      
----- FUNCTION ?L?COM01FB (END) -------


----- FUNCTION ?L?COM0173 (BEGIN) -----
B1:00FBB2 902B17            MOV      DPTR,#xp
B1:00FBB5         ?L?COM0174:
B1:00FBB5 A3                INC      DPTR
B1:00FBB6 E0                MOVX     A,@DPTR
B1:00FBB7 FA                MOV      R2,A
B1:00FBB8 A3                INC      DPTR
B1:00FBB9 E0                MOVX     A,@DPTR
B1:00FBBA AC02              MOV      R4,AR2
B1:00FBBC FD                MOV      R5,A
B1:00FBBD A3                INC      DPTR
B1:00FBBE         ?L?COM0175:
B1:00FBBE A3                INC      DPTR
B1:00FBBF E0                MOVX     A,@DPTR
B1:00FBC0 FA                MOV      R2,A
B1:00FBC1 A3                INC      DPTR
B1:00FBC2 E0                MOVX     A,@DPTR
B1:00FBC3 FB                MOV      R3,A
B1:00FBC4 22                RET      
----- FUNCTION ?L?COM0173 (END) -------


----- FUNCTION _networkkey_expand (BEGIN) -----
B1:00FBC5 9038DF            MOV      DPTR,#network_key
B1:00FBC8 1225A9            LCALL    ?C?PSTXDATA
B1:00FBCB 78EB              MOV      R0,#LOW constant_nk
B1:00FBCD 7C38              MOV      R4,#HIGH constant_nk
B1:00FBCF 7A31              MOV      R2,#HIGH _?ix1000
B1:00FBD1 7940              MOV      R1,#LOW _?ix1000
B1:00FBD3 12E687            LCALL    ?L?COM010C
B1:00FBD6 7A38              MOV      R2,#HIGH constant_nk
B1:00FBD8 79EB              MOV      R1,#LOW constant_nk
B1:00FBDA 91FC              ACALL    ?L?COM05AB
B1:00FBDC 9038E2            MOV      DPTR,#ccm_key
B1:00FBDF B116              ACALL    ?L?COM0553
B1:00FBE1 9038E5            MOV      DPTR,#nonce_pstring
B1:00FBE4 B10D              ACALL    ?L?COM0552
B1:00FBE6 9038E8            MOV      DPTR,#mpan_key
B1:00FBE9 B104              ACALL    ?L?COM0551
B1:00FBEB 9038DF            MOV      DPTR,#network_key
B1:00FBEE 122589            LCALL    ?C?PLDXDATA
B1:00FBF1 02DEC9            LJMP     _generic_expand
----- FUNCTION _networkkey_expand (END) -------


----- FUNCTION _tempkey_expand (BEGIN) -----
B1:00FBF4 9038FA            MOV      DPTR,#prk
B1:00FBF7 1225A9            LCALL    ?C?PSTXDATA
B1:00FBFA 7806              MOV      R0,#LOW constant_TE
B1:00FBFC 7C39              MOV      R4,#HIGH constant_TE
B1:00FBFE 7A31              MOV      R2,#HIGH _?ix1002
B1:00FC00 795F              MOV      R1,#LOW _?ix1002
B1:00FC02 12E687            LCALL    ?L?COM010C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 490


B1:00FC05 7A39              MOV      R2,#HIGH constant_TE
B1:00FC07 7906              MOV      R1,#LOW constant_TE
B1:00FC09 91FC              ACALL    ?L?COM05AB
B1:00FC0B 9038FD            MOV      DPTR,#temp_ccm_key
B1:00FC0E B116              ACALL    ?L?COM0553
B1:00FC10 903900            MOV      DPTR,#temp_nonce_pstring
B1:00FC13 B10D              ACALL    ?L?COM0552
B1:00FC15 903903            MOV      DPTR,#temp_mpan_key
B1:00FC18 B104              ACALL    ?L?COM0551
B1:00FC1A 9038FA            MOV      DPTR,#prk
B1:00FC1D 122589            LCALL    ?C?PLDXDATA
B1:00FC20 02DEC9            LJMP     _generic_expand
----- FUNCTION _tempkey_expand (END) -------


----- FUNCTION ?L?COM0309 (BEGIN) -----
B1:00FC23 A3                INC      DPTR
B1:00FC24 E0                MOVX     A,@DPTR
B1:00FC25 FA                MOV      R2,A
B1:00FC26 A3                INC      DPTR
B1:00FC27 E0                MOVX     A,@DPTR
B1:00FC28 AE02              MOV      R6,AR2
B1:00FC2A FF                MOV      R7,A
B1:00FC2B 22                RET      
----- FUNCTION ?L?COM0309 (END) -------


----- FUNCTION ?L?COM041E (BEGIN) -----
B1:00FC2C 902A31            MOV      DPTR,#work
B1:00FC2F A3                INC      DPTR
B1:00FC30 E0                MOVX     A,@DPTR
B1:00FC31 FA                MOV      R2,A
B1:00FC32 A3                INC      DPTR
B1:00FC33 E0                MOVX     A,@DPTR
B1:00FC34 22                RET      
----- FUNCTION ?L?COM041E (END) -------


----- FUNCTION _crypto_scalarmult_curve25519 (BEGIN) -----
B1:00FC35 90319D            MOV      DPTR,#r
B1:00FC38 12632A            LCALL    ?L?COM015E
;---- Variable 'i' assigned to Register 'R7' ----
B1:00FC3B E4                CLR      A
B1:00FC3C FF                MOV      R7,A
B1:00FC3D         ?C0009?CURVE25519:
B1:00FC3D 9031A0            MOV      DPTR,#s
B1:00FC40 5171              ACALL    ?L?COM01A4
B1:00FC42 F9                MOV      R1,A
B1:00FC43 8F82              MOV      DPL,R7
B1:00FC45 126DCA            LCALL    ?L?COM01DA
B1:00FC48 FE                MOV      R6,A
B1:00FC49 74E6              MOV      A,#LOW e
B1:00FC4B 2F                ADD      A,R7
B1:00FC4C F582              MOV      DPL,A
B1:00FC4E E4                CLR      A
B1:00FC4F 3431              ADDC     A,#HIGH e
B1:00FC51 F583              MOV      DPH,A
B1:00FC53 EE                MOV      A,R6
B1:00FC54 F0                MOVX     @DPTR,A
B1:00FC55 0F                INC      R7
B1:00FC56 EF                MOV      A,R7
B1:00FC57 B420E3            CJNE     A,#020H,?C0009?CURVE25519
B1:00FC5A         ?C0010?CURVE25519:
B1:00FC5A 9031E6            MOV      DPTR,#e
B1:00FC5D E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 491


B1:00FC5E 54F8              ANL      A,#0F8H
B1:00FC60 F0                MOVX     @DPTR,A
B1:00FC61 903205            MOV      DPTR,#e+01FH
B1:00FC64 E0                MOVX     A,@DPTR
B1:00FC65 547F              ANL      A,#07FH
B1:00FC67 F0                MOVX     @DPTR,A
B1:00FC68 4440              ORL      A,#040H
B1:00FC6A F0                MOVX     @DPTR,A
B1:00FC6B 7E31              MOV      R6,#HIGH t
B1:00FC6D 7FA6              MOV      R7,#LOW t
B1:00FC6F 9031A3            MOV      DPTR,#p
B1:00FC72 A3                INC      DPTR
B1:00FC73 E0                MOVX     A,@DPTR
B1:00FC74 FA                MOV      R2,A
B1:00FC75 A3                INC      DPTR
B1:00FC76 E0                MOVX     A,@DPTR
B1:00FC77 AC02              MOV      R4,AR2
B1:00FC79 FD                MOV      R5,A
B1:00FC7A 121DC7            LCALL    ?INTERBANK_TABLE?_fe25519_unpack
B1:00FC7D 902C0A            MOV      DPTR,#?_mladder?BYTE+03H
B1:00FC80 7401              MOV      A,#01H
B1:00FC82 F0                MOVX     @DPTR,A
B1:00FC83 A3                INC      DPTR
B1:00FC84 7431              MOV      A,#HIGH z
B1:00FC86 F0                MOVX     @DPTR,A
B1:00FC87 A3                INC      DPTR
B1:00FC88 74C6              MOV      A,#LOW z
B1:00FC8A F0                MOVX     @DPTR,A
B1:00FC8B A3                INC      DPTR
B1:00FC8C 7401              MOV      A,#01H
B1:00FC8E F0                MOVX     @DPTR,A
B1:00FC8F A3                INC      DPTR
B1:00FC90 7431              MOV      A,#HIGH e
B1:00FC92 F0                MOVX     @DPTR,A
B1:00FC93 A3                INC      DPTR
B1:00FC94 74E6              MOV      A,#LOW e
B1:00FC96 F0                MOVX     @DPTR,A
B1:00FC97 7B01              MOV      R3,#01H
B1:00FC99 7A31              MOV      R2,#HIGH t
B1:00FC9B 79A6              MOV      R1,#LOW t
B1:00FC9D 31AD              ACALL    _mladder
B1:00FC9F 7C31              MOV      R4,#HIGH z
B1:00FCA1 7DC6              MOV      R5,#LOW z
B1:00FCA3 AF05              MOV      R7,AR5
B1:00FCA5 AE04              MOV      R6,AR4
B1:00FCA7 121DD1            LCALL    ?INTERBANK_TABLE?_fe25519_invert
B1:00FCAA 7C31              MOV      R4,#HIGH t
B1:00FCAC 7DA6              MOV      R5,#LOW t
B1:00FCAE AF05              MOV      R7,AR5
B1:00FCB0 AE04              MOV      R6,AR4
B1:00FCB2 7A31              MOV      R2,#HIGH z
B1:00FCB4 7BC6              MOV      R3,#LOW z
B1:00FCB6 121DAE            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00FCB9 90319D            MOV      DPTR,#r
B1:00FCBC 9123              ACALL    ?L?COM0309
B1:00FCBE 7C31              MOV      R4,#HIGH t
B1:00FCC0 7DA6              MOV      R5,#LOW t
B1:00FCC2 021DCC            LJMP     ?INTERBANK_TABLE?_fe25519_pack
----- FUNCTION _crypto_scalarmult_curve25519 (END) -------


----- FUNCTION _crypto_scalarmult_curve25519_base (BEGIN) -----
;---- Variable 'q' assigned to Register 'R1/R2/R3' ----
B1:00FCC5 C002              PUSH     AR2
B1:00FCC7 C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 492


B1:00FCC9 9040F3            MOV      DPTR,#n
B1:00FCCC 124FCF            LCALL    ?L?COM02C5
B1:00FCCF 9031A0            MOV      DPTR,#?_crypto_scalarmult_curve25519?BYTE+03H
B1:00FCD2 C9                XCH      A,R1
B1:00FCD3 12632B            LCALL    ?L?COM015F
B1:00FCD6 A3                INC      DPTR
B1:00FCD7 7401              MOV      A,#01H
B1:00FCD9 F0                MOVX     @DPTR,A
B1:00FCDA A3                INC      DPTR
B1:00FCDB 7434              MOV      A,#HIGH base
B1:00FCDD F0                MOVX     @DPTR,A
B1:00FCDE A3                INC      DPTR
B1:00FCDF 74AE              MOV      A,#LOW base
B1:00FCE1 F0                MOVX     @DPTR,A
B1:00FCE2 D001              POP      AR1
B1:00FCE4 D002              POP      AR2
B1:00FCE6 8135              AJMP     _crypto_scalarmult_curve25519
----- FUNCTION _crypto_scalarmult_curve25519_base (END) -------


----- FUNCTION ?L?COM023D (BEGIN) -----
B1:00FCE8 9039CA            MOV      DPTR,#blocks
B1:00FCEB 122589            LCALL    ?C?PLDXDATA
B1:00FCEE 900010            MOV      DPTR,#010H
B1:00FCF1 22                RET      
----- FUNCTION ?L?COM023D (END) -------


----- FUNCTION ?L?COM055B (BEGIN) -----
B1:00FCF2 903B70            MOV      DPTR,#P
B1:00FCF5 122589            LCALL    ?C?PLDXDATA
B1:00FCF8 903B7C            MOV      DPTR,#offset
B1:00FCFB 22                RET      
----- FUNCTION ?L?COM055B (END) -------


----- FUNCTION ?L?COM05AB (BEGIN) -----
B1:00FCFC 7B01              MOV      R3,#01H
B1:00FCFE 903641            MOV      DPTR,#?_generic_expand?BYTE+03H
B1:00FD01 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM05AB (END) -------


----- FUNCTION ?L?COM0551 (BEGIN) -----
B1:00FD04 122589            LCALL    ?C?PLDXDATA
B1:00FD07 90364A            MOV      DPTR,#?_generic_expand?BYTE+0CH
B1:00FD0A 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0551 (END) -------


----- FUNCTION ?L?COM0552 (BEGIN) -----
B1:00FD0D 122589            LCALL    ?C?PLDXDATA
B1:00FD10 903647            MOV      DPTR,#?_generic_expand?BYTE+09H
B1:00FD13 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0552 (END) -------


----- FUNCTION ?L?COM0553 (BEGIN) -----
B1:00FD16 122589            LCALL    ?C?PLDXDATA
B1:00FD19 903644            MOV      DPTR,#?_generic_expand?BYTE+06H
B1:00FD1C 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0553 (END) -------


----- FUNCTION ?L?COM0374 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 493


B1:00FD1F 9039DF            MOV      DPTR,#aad_bytes_in_first_block
B1:00FD22 E0                MOVX     A,@DPTR
B1:00FD23 FE                MOV      R6,A
B1:00FD24 A3                INC      DPTR
B1:00FD25 E0                MOVX     A,@DPTR
B1:00FD26 FF                MOV      R7,A
B1:00FD27 EE                MOV      A,R6
B1:00FD28 22                RET      
----- FUNCTION ?L?COM0374 (END) -------


----- FUNCTION ?L?COM055D (BEGIN) -----
B1:00FD29 9039CD            MOV      DPTR,#aad
B1:00FD2C 122589            LCALL    ?C?PLDXDATA
B1:00FD2F 9039D9            MOV      DPTR,#offset
B1:00FD32 22                RET      
----- FUNCTION ?L?COM055D (END) -------


----- FUNCTION ?L?COM055E (BEGIN) -----
B1:00FD33 122084            LCALL    ?C?CSTOPTR
B1:00FD36 9039DF            MOV      DPTR,#aad_bytes_in_first_block
B1:00FD39 E4                CLR      A
B1:00FD3A F0                MOVX     @DPTR,A
B1:00FD3B A3                INC      DPTR
B1:00FD3C 22                RET      
----- FUNCTION ?L?COM055E (END) -------


----- FUNCTION ?L?COM03CB (BEGIN) -----
B1:00FD3D FF                MOV      R7,A
B1:00FD3E E0                MOVX     A,@DPTR
B1:00FD3F FC                MOV      R4,A
B1:00FD40 A3                INC      DPTR
B1:00FD41 E0                MOVX     A,@DPTR
B1:00FD42 FD                MOV      R5,A
B1:00FD43 C3                CLR      C
B1:00FD44 9F                SUBB     A,R7
B1:00FD45 EE                MOV      A,R6
B1:00FD46 6480              XRL      A,#080H
B1:00FD48 F8                MOV      R0,A
B1:00FD49 EC                MOV      A,R4
B1:00FD4A 6480              XRL      A,#080H
B1:00FD4C 98                SUBB     A,R0
B1:00FD4D 22                RET      
----- FUNCTION ?L?COM03CB (END) -------


----- FUNCTION ?L?COM030C (BEGIN) -----
B1:00FD4E 7C00              MOV      R4,#00H
B1:00FD50 7D10              MOV      R5,#010H
B1:00FD52 AF03              MOV      R7,AR3
B1:00FD54 AE02              MOV      R6,AR2
B1:00FD56 02210D            LJMP     ?C?SIDIV
----- FUNCTION ?L?COM030C (END) -------


----- FUNCTION ?L?COM0435 (BEGIN) -----
B1:00FD59 9039DB            MOV      DPTR,#new_aad_len
B1:00FD5C E0                MOVX     A,@DPTR
B1:00FD5D FA                MOV      R2,A
B1:00FD5E A3                INC      DPTR
B1:00FD5F E0                MOVX     A,@DPTR
B1:00FD60 FB                MOV      R3,A
B1:00FD61 7C00              MOV      R4,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 494


B1:00FD63 7D10              MOV      R5,#010H
B1:00FD65 FF                MOV      R7,A
B1:00FD66 22                RET      
----- FUNCTION ?L?COM0435 (END) -------


----- FUNCTION ?L?COM02F9 (BEGIN) -----
B1:00FD67 75F010            MOV      B,#010H
B1:00FD6A A4                MUL      AB
B1:00FD6B 2454              ADD      A,#LOW s2_network_keys
B1:00FD6D F9                MOV      R1,A
B1:00FD6E 7412              MOV      A,#HIGH s2_network_keys
B1:00FD70 35F0              ADDC     A,B
B1:00FD72 FE                MOV      R6,A
B1:00FD73 AF01              MOV      R7,AR1
B1:00FD75 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM02F9 (END) -------


----- FUNCTION ?L?COM02B0 (BEGIN) -----
B1:00FD78 785D              MOV      R0,#LOW temp+010H
B1:00FD7A 7C36              MOV      R4,#HIGH temp+010H
B1:00FD7C         ?L?COM02B1:
B1:00FD7C 7D01              MOV      R5,#01H
B1:00FD7E 903641            MOV      DPTR,#constant_nk
B1:00FD81 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM02B0 (END) -------


----- FUNCTION ?L?COM04F5 (BEGIN) -----
B1:00FD84 784D              MOV      R0,#LOW temp
B1:00FD86 7C36              MOV      R4,#HIGH temp
B1:00FD88 7D01              MOV      R5,#01H
B1:00FD8A 22                RET      
----- FUNCTION ?L?COM04F5 (END) -------


----- FUNCTION ?L?COM03AD (BEGIN) -----
B1:00FD8B 90366C            MOV      DPTR,#temp+01FH
B1:00FD8E         ?L?COM03AE:
B1:00FD8E F0                MOVX     @DPTR,A
B1:00FD8F 7B01              MOV      R3,#01H
B1:00FD91 7A36              MOV      R2,#HIGH temp
B1:00FD93 794D              MOV      R1,#LOW temp
B1:00FD95 22                RET      
----- FUNCTION ?L?COM03AD (END) -------


----- FUNCTION ?L?COM062C (BEGIN) -----
B1:00FD96 122072            LCALL    ?C?CSTPTR
B1:00FD99 901221            MOV      DPTR,#nodeID
B1:00FD9C E0                MOVX     A,@DPTR
B1:00FD9D 22                RET      
----- FUNCTION ?L?COM062C (END) -------


----- FUNCTION ?L?COM062D (BEGIN) -----
B1:00FD9E 900778            MOV      DPTR,#eErrcode
B1:00FDA1 7401              MOV      A,#01H
B1:00FDA3 F0                MOVX     @DPTR,A
B1:00FDA4 FF                MOV      R7,A
B1:00FDA5 22                RET      
----- FUNCTION ?L?COM062D (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 495


----- FUNCTION ?L?COM04B2 (BEGIN) -----
B1:00FDA6 E0                MOVX     A,@DPTR
B1:00FDA7 FF                MOV      R7,A
B1:00FDA8         ?L?COM04B3:
B1:00FDA8 7B01              MOV      R3,#01H
B1:00FDAA 7A39              MOV      R2,#HIGH tx_status
B1:00FDAC 799D              MOV      R1,#LOW tx_status
B1:00FDAE 22                RET      
----- FUNCTION ?L?COM04B2 (END) -------


----- FUNCTION ?L?COM04B4 (BEGIN) -----
B1:00FDAF 12DA85            LCALL    _GetRepeaters
B1:00FDB2 90399F            MOV      DPTR,#tx_status+02H
B1:00FDB5 EF                MOV      A,R7
B1:00FDB6 F0                MOVX     @DPTR,A
B1:00FDB7 E4                CLR      A
B1:00FDB8 C3                CLR      C
B1:00FDB9 9F                SUBB     A,R7
B1:00FDBA 22                RET      
----- FUNCTION ?L?COM04B4 (END) -------


----- FUNCTION ?L?COM02F0 (BEGIN) -----
B1:00FDBB 7A2B              MOV      R2,#HIGH plnodeParm
B1:00FDBD 7933              MOV      R1,#LOW plnodeParm
B1:00FDBF 903C34            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+06H
B1:00FDC2 1225A9            LCALL    ?C?PSTXDATA
B1:00FDC5 7A2B              MOV      R2,#HIGH blparmLength
B1:00FDC7 79BA              MOV      R1,#LOW blparmLength
B1:00FDC9 903C37            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+09H
B1:00FDCC 1225A9            LCALL    ?C?PSTXDATA
B1:00FDCF 7A12              MOV      R2,#HIGH bldeviceOptionsMask
B1:00FDD1 792A              MOV      R1,#LOW bldeviceOptionsMask
B1:00FDD3 22                RET      
----- FUNCTION ?L?COM02F0 (END) -------


----- FUNCTION ?L?COM062B (BEGIN) -----
B1:00FDD4 FF                MOV      R7,A
B1:00FDD5 900719            MOV      DPTR,#dataLength
B1:00FDD8 E0                MOVX     A,@DPTR
B1:00FDD9 C3                CLR      C
B1:00FDDA 9F                SUBB     A,R7
B1:00FDDB 22                RET      
----- FUNCTION ?L?COM062B (END) -------


----- FUNCTION ?L?COM061E (BEGIN) -----
B1:00FDDC D3                SETB     C
B1:00FDDD EF                MOV      A,R7
B1:00FDDE 9480              SUBB     A,#080H
B1:00FDE0 EE                MOV      A,R6
B1:00FDE1 9400              SUBB     A,#00H
B1:00FDE3 22                RET      
----- FUNCTION ?L?COM061E (END) -------


----- FUNCTION ?L?COM04E9 (BEGIN) -----
B1:00FDE4 903C8D            MOV      DPTR,#sourceNode
B1:00FDE7 E0                MOVX     A,@DPTR
B1:00FDE8 FF                MOV      R7,A
B1:00FDE9 12E9DD            LCALL    _ZW_LockRoute
B1:00FDEC D211              SETB     protocolLockedCachedRoute
B1:00FDEE 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 496


----- FUNCTION ?L?COM04E9 (END) -------


----- FUNCTION ?L?COM010B (BEGIN) -----
B1:00FDEF 7B01              MOV      R3,#01H
B1:00FDF1 E4                CLR      A
B1:00FDF2 FF                MOV      R7,A
B1:00FDF3 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM010B (END) -------


----- FUNCTION ?L?COM03AF (BEGIN) -----
B1:00FDF6 7A12              MOV      R2,#HIGH homeID
B1:00FDF8 7923              MOV      R1,#LOW homeID
B1:00FDFA 7F04              MOV      R7,#04H
B1:00FDFC 021B8D            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION ?L?COM03AF (END) -------


----- FUNCTION ?L?COM0628 (BEGIN) -----
B1:00FDFF 90076D            MOV      DPTR,#bRxCurrentSpeed
B1:00FE02 E0                MOVX     A,@DPTR
B1:00FE03 C4                SWAP     A
B1:00FE04 54F0              ANL      A,#0F0H
B1:00FE06 22                RET      
----- FUNCTION ?L?COM0628 (END) -------


----- FUNCTION ?L?COM0629 (BEGIN) -----
B1:00FE07 901216            MOV      DPTR,#responseRouteCount
B1:00FE0A E0                MOVX     A,@DPTR
B1:00FE0B C3                CLR      C
B1:00FE0C 9402              SUBB     A,#02H
B1:00FE0E 22                RET      
----- FUNCTION ?L?COM0629 (END) -------


----- FUNCTION ?L?COM0624 (BEGIN) -----
B1:00FE0F 903C8E            MOV      DPTR,#n
B1:00FE12 E0                MOVX     A,@DPTR
B1:00FE13 C3                CLR      C
B1:00FE14 9404              SUBB     A,#04H
B1:00FE16 22                RET      
----- FUNCTION ?L?COM0624 (END) -------


----- FUNCTION ?L?COM0479 (BEGIN) -----
B1:00FE17 903C86            MOV      DPTR,#cmdLength
B1:00FE1A E0                MOVX     A,@DPTR
B1:00FE1B FD                MOV      R5,A
B1:00FE1C A3                INC      DPTR
B1:00FE1D 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0479 (END) -------


----- FUNCTION ?L?COM04EA (BEGIN) -----
B1:00FE20 7B02              MOV      R3,#MBYTE NVM_RETURN_ROUTE_SPEED_START_far
B1:00FE22 7A0F              MOV      R2,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FE24 7985              MOV      R1,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FE26 7E0F              MOV      R6,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FE28 7F85              MOV      R7,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FE2A 22                RET      
----- FUNCTION ?L?COM04EA (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 497


----- FUNCTION ?L?COM0392 (BEGIN) -----
B1:00FE2B EF                MOV      A,R7
B1:00FE2C 5403              ANL      A,#03H
B1:00FE2E F0                MOVX     @DPTR,A
B1:00FE2F E0                MOVX     A,@DPTR
B1:00FE30 FF                MOV      R7,A
B1:00FE31 903C8E            MOV      DPTR,#n
B1:00FE34 E0                MOVX     A,@DPTR
B1:00FE35 04                INC      A
B1:00FE36 25E0              ADD      A,ACC
B1:00FE38 25E0              ADD      A,ACC
B1:00FE3A FE                MOV      R6,A
B1:00FE3B EF                MOV      A,R7
B1:00FE3C 4E                ORL      A,R6
B1:00FE3D 22                RET      
----- FUNCTION ?L?COM0392 (END) -------


----- FUNCTION ?L?COM057F (BEGIN) -----
B1:00FE3E A3                INC      DPTR
B1:00FE3F 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_AssignComplete
B1:00FE41 F0                MOVX     @DPTR,A
B1:00FE42 A3                INC      DPTR
B1:00FE43 74EE              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_AssignComplete
B1:00FE45 F0                MOVX     @DPTR,A
B1:00FE46 22                RET      
----- FUNCTION ?L?COM057F (END) -------


----- FUNCTION ?L?COM03B6 (BEGIN) -----
B1:00FE47 A3                INC      DPTR
B1:00FE48 E0                MOVX     A,@DPTR
B1:00FE49 F8                MOV      R0,A
B1:00FE4A A3                INC      DPTR
B1:00FE4B E0                MOVX     A,@DPTR
B1:00FE4C C3                CLR      C
B1:00FE4D 9D                SUBB     A,R5
B1:00FE4E FE                MOV      R6,A
B1:00FE4F E8                MOV      A,R0
B1:00FE50 9C                SUBB     A,R4
B1:00FE51 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00FE54 F0                MOVX     @DPTR,A
B1:00FE55 A3                INC      DPTR
B1:00FE56 CE                XCH      A,R6
B1:00FE57 22                RET      
----- FUNCTION ?L?COM03B6 (END) -------


----- FUNCTION ?L?COM0355 (BEGIN) -----
B1:00FE58 AC02              MOV      R4,AR2
B1:00FE5A AD01              MOV      R5,AR1
B1:00FE5C 9039C6            MOV      DPTR,#NVM_WorkPtrWrite
B1:00FE5F EC                MOV      A,R4
B1:00FE60 F0                MOVX     @DPTR,A
B1:00FE61 A3                INC      DPTR
B1:00FE62 ED                MOV      A,R5
B1:00FE63 F0                MOVX     @DPTR,A
B1:00FE64 9039C0            MOV      DPTR,#dataLengthOld
B1:00FE67 E0                MOVX     A,@DPTR
B1:00FE68 FA                MOV      R2,A
B1:00FE69 A3                INC      DPTR
B1:00FE6A E0                MOVX     A,@DPTR
B1:00FE6B FB                MOV      R3,A
B1:00FE6C 22                RET      
----- FUNCTION ?L?COM0355 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 498




----- FUNCTION ?L?COM000C (BEGIN) -----
B1:00FE6D C4                SWAP     A
B1:00FE6E 540F              ANL      A,#0FH
B1:00FE70 FF                MOV      R7,A
B1:00FE71 7E00              MOV      R6,#00H
B1:00FE73 122589            LCALL    ?C?PLDXDATA
B1:00FE76 E9                MOV      A,R1
B1:00FE77 22                RET      
----- FUNCTION ?L?COM000C (END) -------


----- FUNCTION ?L?COM0274 (BEGIN) -----
B1:00FE78 24B7              ADD      A,#0B7H
B1:00FE7A F9                MOV      R1,A
B1:00FE7B E4                CLR      A
B1:00FE7C 3A                ADDC     A,R2
B1:00FE7D FA                MOV      R2,A
B1:00FE7E 7401              MOV      A,#01H
B1:00FE80 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0274 (END) -------


----- FUNCTION ?L?COM0352 (BEGIN) -----
B1:00FE83 FB                MOV      R3,A
B1:00FE84 E4                CLR      A
B1:00FE85 FA                MOV      R2,A
B1:00FE86 F9                MOV      R1,A
B1:00FE87 F8                MOV      R0,A
B1:00FE88         ?L?COM0353:
B1:00FE88 903415            MOV      DPTR,#ciphertext_len
B1:00FE8B 022499            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM0352 (END) -------


----- FUNCTION ?L?COM03DC (BEGIN) -----
B1:00FE8E FF                MOV      R7,A
B1:00FE8F AEF0              MOV      R6,B
B1:00FE91 1251F8            LCALL    _getTickTimePassed
B1:00FE94 90399D            MOV      DPTR,#tx_status
B1:00FE97 EE                MOV      A,R6
B1:00FE98 F0                MOVX     @DPTR,A
B1:00FE99 A3                INC      DPTR
B1:00FE9A EF                MOV      A,R7
B1:00FE9B F0                MOVX     @DPTR,A
B1:00FE9C 22                RET      
----- FUNCTION ?L?COM03DC (END) -------


----- FUNCTION ?L?COM0411 (BEGIN) -----
B1:00FE9D 9042B1            MOV      DPTR,#t
B1:00FEA0 E0                MOVX     A,@DPTR
B1:00FEA1 FD                MOV      R5,A
B1:00FEA2 C3                CLR      C
B1:00FEA3 EF                MOV      A,R7
B1:00FEA4 9D                SUBB     A,R5
B1:00FEA5 FD                MOV      R5,A
B1:00FEA6 EE                MOV      A,R6
B1:00FEA7 9400              SUBB     A,#00H
B1:00FEA9 FC                MOV      R4,A
B1:00FEAA 22                RET      
----- FUNCTION ?L?COM0411 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 499


----- FUNCTION ?L?COM0421 (BEGIN) -----
B1:00FEAB 9009FA            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+06H
B1:00FEAE F0                MOVX     @DPTR,A
B1:00FEAF A3                INC      DPTR
B1:00FEB0 7481              MOV      A,#081H
B1:00FEB2 F0                MOVX     @DPTR,A
B1:00FEB3 22                RET      
----- FUNCTION ?L?COM0421 (END) -------


----- FUNCTION ?L?COM044B (BEGIN) -----
B1:00FEB4 9009FC            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:00FEB7 F0                MOVX     @DPTR,A
B1:00FEB8 A3                INC      DPTR
B1:00FEB9 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ZWTransmitComplete
B1:00FEBB F0                MOVX     @DPTR,A
B1:00FEBC A3                INC      DPTR
B1:00FEBD 7471              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ZWTransmitComplete
B1:00FEBF F0                MOVX     @DPTR,A
B1:00FEC0 22                RET      
----- FUNCTION ?L?COM044B (END) -------


----- FUNCTION ?L?COM04EB (BEGIN) -----
B1:00FEC1 FE                MOV      R6,A
B1:00FEC2 EF                MOV      A,R7
B1:00FEC3 5407              ANL      A,#07H
B1:00FEC5 FF                MOV      R7,A
B1:00FEC6 7401              MOV      A,#01H
B1:00FEC8 A807              MOV      R0,AR7
B1:00FECA 08                INC      R0
B1:00FECB 22                RET      
----- FUNCTION ?L?COM04EB (END) -------


----- FUNCTION ?L?COM0509 (BEGIN) -----
B1:00FECC 12216F            LCALL    ?C?ILDPTR
B1:00FECF 5467              ANL      A,#067H
B1:00FED1 9039AC            MOV      DPTR,#tx_status+0FH
B1:00FED4 F0                MOVX     @DPTR,A
B1:00FED5 22                RET      
----- FUNCTION ?L?COM0509 (END) -------


----- FUNCTION ?L?COM050C (BEGIN) -----
B1:00FED6 7B01              MOV      R3,#01H
B1:00FED8 7A07              MOV      R2,#HIGH crH
B1:00FEDA 796F              MOV      R1,#LOW crH
B1:00FEDC 22                RET      
----- FUNCTION ?L?COM050C (END) -------


----- FUNCTION ?L?COM0516 (BEGIN) -----
B1:00FEDD 7B01              MOV      R3,#01H
B1:00FEDF 7A39              MOV      R2,#HIGH tx_status+0BH
B1:00FEE1 79A8              MOV      R1,#LOW tx_status+0BH
B1:00FEE3 021B8D            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION ?L?COM0516 (END) -------


----- FUNCTION ?L?COM0565 (BEGIN) -----
B1:00FEE6 7A08              MOV      R2,#HIGH inclusionHomeID
B1:00FEE8 7994              MOV      R1,#LOW inclusionHomeID
B1:00FEEA 7F04              MOV      R7,#04H
B1:00FEEC 021B8D            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 500


----- FUNCTION ?L?COM0565 (END) -------


----- FUNCTION ?L?COM0567 (BEGIN) -----
B1:00FEEF 7B01              MOV      R3,#01H
B1:00FEF1 7D04              MOV      R5,#04H
B1:00FEF3 7F7F              MOV      R7,#07FH
B1:00FEF5 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM0567 (END) -------


----- FUNCTION ?L?COM0585 (BEGIN) -----
B1:00FEF8 FD                MOV      R5,A
B1:00FEF9 ACF0              MOV      R4,B
B1:00FEFB F582              MOV      DPL,A
B1:00FEFD 85F083            MOV      DPH,B
B1:00FF00 22                RET      
----- FUNCTION ?L?COM0585 (END) -------


----- FUNCTION ?L?COM05B7 (BEGIN) -----
B1:00FF01 900773            MOV      DPTR,#delayCount
B1:00FF04 F0                MOVX     @DPTR,A
B1:00FF05 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:00FF07 7F6C              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:00FF09 22                RET      
----- FUNCTION ?L?COM05B7 (END) -------


----- FUNCTION ?L?COM05CB (BEGIN) -----
B1:00FF0A E9                MOV      A,R1
B1:00FF0B 24FF              ADD      A,#0FFH
B1:00FF0D F9                MOV      R1,A
B1:00FF0E EA                MOV      A,R2
B1:00FF0F 34FF              ADDC     A,#0FFH
B1:00FF11 22                RET      
----- FUNCTION ?L?COM05CB (END) -------


----- FUNCTION _ApplicationSlaveUpdate (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  517: ApplicationSlaveUpdate(
  518:   BYTE bStatus,
  519:   BYTE bNodeID,
  520:   BYTE* pCmd,
  521:   BYTE bLen)
  522: {
  523:   UNUSED(bStatus);
  524:   UNUSED(bNodeID);
  525:   UNUSED(pCmd);
  526:   UNUSED(bLen);
  527: }
B2:008000 22                RET      
----- FUNCTION _ApplicationSlaveUpdate (END) -------


----- FUNCTION _ZW_TransportMulticast_SendRequest (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTMULTICAST.C'
   92: ZW_TransportMulticast_SendRequest(const uint8_t * const p_data,
   93:                                   uint8_t data_length,
B2:008001 903BB1            MOV      DPTR,#p_data
B2:008004 12818B            LCALL    ?L?COM0529
B2:008007 ED                MOV      A,R5
B2:008008 12DBAD            LCALL    ?L?COM05D9
B2:00800B E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 501


B2:00800C 4A                ORL      A,R2
B2:00800D 6011              JZ       ?C0002?ZW_TRANSPORTMULTICAST
B2:00800F 12B431            LCALL    ?L?COM02ED
B2:008012 600C              JZ       ?C0002?ZW_TRANSPORTMULTICAST
B2:008014 3177              ACALL    ?L?COM03BF
B2:008016 E9                MOV      A,R1
B2:008017 4A                ORL      A,R2
B2:008018 6006              JZ       ?C0002?ZW_TRANSPORTMULTICAST
B2:00801A 903BB4            MOV      DPTR,#data_length
B2:00801D E0                MOVX     A,@DPTR
B2:00801E 7003              JNZ      ?C0001?ZW_TRANSPORTMULTICAST
B2:008020         ?C0002?ZW_TRANSPORTMULTICAST:
   94:                                   uint8_t fSupervisionEnable,
   95:                                   TRANSMIT_OPTIONS_TYPE_EX * p_nodelist,
   96:                                   VOID_CALLBACKFUNC(p_callback)(TRANSMISSION_RESULT * pTransmissionResult))
   97: {
   98:   uint8_t node_count;
   99:   uint8_t s2_node_count;
  100:   uint8_t nonsecure_node_count;
  101: 
  102:   if (IS_NULL(p_nodelist) || 0 == p_nodelist->list_length || IS_NULL(p_data) || 0 == data_length)
  103:   {
  104:     return ZW_TX_FAILED;
B2:008020 7F00              MOV      R7,#00H
B2:008022 22                RET      
  105:   }
B2:008023         ?C0001?ZW_TRANSPORTMULTICAST:
  106: 
  107:   p_callback_hold = p_callback;
B2:008023 903BB9            MOV      DPTR,#p_callback
B2:008026 E0                MOVX     A,@DPTR
B2:008027 FF                MOV      R7,A
B2:008028 A3                INC      DPTR
B2:008029 E0                MOVX     A,@DPTR
B2:00802A 903671            MOV      DPTR,#_p_callback_hold
B2:00802D CF                XCH      A,R7
B2:00802E F0                MOVX     @DPTR,A
B2:00802F A3                INC      DPTR
B2:008030 EF                MOV      A,R7
B2:008031 12DBAD            LCALL    ?L?COM05D9
B2:008034 903690            MOV      DPTR,#p_nodelist_hold
B2:008037 1225A9            LCALL    ?C?PSTXDATA
  108:   p_nodelist_hold = p_nodelist;
  109:   p_data_hold = (uint8_t *)p_data;
B2:00803A 3177              ACALL    ?L?COM03BF
B2:00803C 903696            MOV      DPTR,#p_data_hold
B2:00803F 318B              ACALL    ?L?COM0529
B2:008041 E0                MOVX     A,@DPTR
B2:008042 FD                MOV      R5,A
B2:008043 903670            MOV      DPTR,#data_length_hold
B2:008046 3176              ACALL    ?L?COM03BE
B2:008048 12D4AD            LCALL    _RequestBufferSetPayloadLength
B2:00804B 4003              JC       ?C0004?ZW_TRANSPORTMULTICAST
  110:   data_length_hold = data_length;
  111: 
  112:   if (TRUE != RequestBufferSetPayloadLength((ZW_APPLICATION_TX_BUFFER *)p_data, data_length))
  113:   {
  114:     // Something is fucked up.
  115:     return ZW_TX_FAILED;
B2:00804D 7F00              MOV      R7,#00H
B2:00804F 22                RET      
  116:   }
B2:008050         ?C0004?ZW_TRANSPORTMULTICAST:
  117: 
  118:   // Set the supervision hold variable in order to use it for singlecast
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 502


  119:   fSupervisionEnableHold = fSupervisionEnable;
B2:008050 903BB5            MOV      DPTR,#fSupervisionEnable
B2:008053 E0                MOVX     A,@DPTR
B2:008054 903695            MOV      DPTR,#fSupervisionEnableHold
B2:008057 F0                MOVX     @DPTR,A
  120: 
  121:   // Get the active security keys
  122:   secKeys = ZW_GetSecurityKeys();
B2:008058 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:00805B 903694            MOV      DPTR,#secKeys
B2:00805E EF                MOV      A,R7
B2:00805F 12DA68            LCALL    ?L?COM0425
B2:008062 EF                MOV      A,R7
B2:008063 5407              ANL      A,#07H
B2:008065 6009              JZ       ?C0006?ZW_TRANSPORTMULTICAST
B2:008067 903695            MOV      DPTR,#fSupervisionEnableHold
B2:00806A E0                MOVX     A,@DPTR
B2:00806B 6003              JZ       ?C0006?ZW_TRANSPORTMULTICAST
B2:00806D D3                SETB     C
B2:00806E 8001              SJMP     ?C0007?ZW_TRANSPORTMULTICAST
B2:008070         ?C0006?ZW_TRANSPORTMULTICAST:
B2:008070 C3                CLR      C
B2:008071         ?C0007?ZW_TRANSPORTMULTICAST:
B2:008071 12D4D5            LCALL    ?L?COM0493
B2:008074 4003              JC       ?C0005?ZW_TRANSPORTMULTICAST
  123: 
  124:   ZW_DEBUG__SEND_NL();
  125:   ZW_DEBUG__SEND_STR("Sec: ");
  126:   ZW_DEBUG__SEND_NUM(secKeys);
  127: 
  128:   // Use supervision if security scheme is 2 and supervision is enabled.
  129:   if (TRUE != RequestBufferSupervisionPayloadActivate((ZW_APPLICATION_TX_BUFFER**)&p_data_hold, &data_length_hold
>> , ((0 != (SECURITY_KEY_S2_MASK & secKeys)) && fSupervisionEnableHold)))
  130:   {
  131:     // Something is wrong.
  132:     return ZW_TX_FAILED;
B2:008076 7F00              MOV      R7,#00H
B2:008078 22                RET      
  133:   }
B2:008079         ?C0005?ZW_TRANSPORTMULTICAST:
  134: 
  135:   ZW_NodeMaskClear(node_mask, sizeof(node_mask));
B2:008079 3184              ACALL    ?L?COM0528
B2:00807B 7D1D              MOV      R5,#01DH
B2:00807D 121BA1            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskClear
  136: 
  137:   s2_node_count = 0;
B2:008080 E4                CLR      A
B2:008081 903BBC            MOV      DPTR,#s2_node_count
B2:008084 F0                MOVX     @DPTR,A
  138:   nonsecure_node_count = 0;
B2:008085 A3                INC      DPTR
B2:008086 F0                MOVX     @DPTR,A
  139:   for (node_count = 0; node_count < p_nodelist->list_length; node_count++)
B2:008087 903BBB            MOV      DPTR,#node_count
B2:00808A F0                MOVX     @DPTR,A
B2:00808B         ?C0008?ZW_TRANSPORTMULTICAST:
B2:00808B 903BB6            MOV      DPTR,#p_nodelist
B2:00808E 12B42E            LCALL    ?L?COM02EC
B2:008091 FF                MOV      R7,A
B2:008092 903BBB            MOV      DPTR,#node_count
B2:008095 E0                MOVX     A,@DPTR
B2:008096 FE                MOV      R6,A
B2:008097 C3                CLR      C
B2:008098 9F                SUBB     A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 503


B2:008099 505B              JNC      ?C0009?ZW_TRANSPORTMULTICAST
  140:   {
  141: 
  142:     //Do not support end-points in multicast!
  143:     if(0 == p_nodelist->pList[node_count].node.endpoint)
B2:00809B 12B438            LCALL    ?L?COM0255
B2:00809E EE                MOV      A,R6
B2:00809F 51DA              ACALL    ?L?COM0036
B2:0080A1 FA                MOV      R2,A
B2:0080A2 12B3A2            LCALL    ?L?COM0182
B2:0080A5 547F              ANL      A,#07FH
B2:0080A7 7045              JNZ      ?C0010?ZW_TRANSPORTMULTICAST
  144:     {
  145:       if (SECURITY_KEY_S2_UNAUTHENTICATED == p_nodelist->pList[node_count].nodeInfo.security ||
B2:0080A9 128CA5            LCALL    ?L?COM0080
B2:0080AC FF                MOV      R7,A
B2:0080AD 6401              XRL      A,#01H
B2:0080AF 6009              JZ       ?C0013?ZW_TRANSPORTMULTICAST
B2:0080B1 EF                MOV      A,R7
B2:0080B2 6402              XRL      A,#02H
B2:0080B4 6004              JZ       ?C0013?ZW_TRANSPORTMULTICAST
B2:0080B6 EF                MOV      A,R7
B2:0080B7 B40308            CJNE     A,#03H,?C0012?ZW_TRANSPORTMULTICAST
B2:0080BA         ?C0013?ZW_TRANSPORTMULTICAST:
  146:           SECURITY_KEY_S2_AUTHENTICATED   == p_nodelist->pList[node_count].nodeInfo.security ||
  147:           SECURITY_KEY_S2_ACCESS          == p_nodelist->pList[node_count].nodeInfo.security)
  148:       {
  149:         // The node is S2.
  150:         s2_node_count++;
B2:0080BA 903BBC            MOV      DPTR,#s2_node_count
B2:0080BD E0                MOVX     A,@DPTR
B2:0080BE 04                INC      A
B2:0080BF F0                MOVX     @DPTR,A
  151:       }
B2:0080C0 8025              SJMP     ?C0014?ZW_TRANSPORTMULTICAST
B2:0080C2         ?C0012?ZW_TRANSPORTMULTICAST:
  152:       else if (SECURITY_KEY_NONE == p_nodelist->pList[node_count].nodeInfo.security)
B2:0080C2 EF                MOV      A,R7
B2:0080C3 7022              JNZ      ?C0014?ZW_TRANSPORTMULTICAST
  153:       {
  154:         // The node is non-secure.
  155:         nonsecure_node_count++;
B2:0080C5 903BBD            MOV      DPTR,#nonsecure_node_count
B2:0080C8 E0                MOVX     A,@DPTR
B2:0080C9 04                INC      A
B2:0080CA F0                MOVX     @DPTR,A
  156:         ZW_NodeMaskSetBit(node_mask, p_nodelist->pList[node_count].node.nodeId);
B2:0080CB 903BB6            MOV      DPTR,#p_nodelist
B2:0080CE 12B57F            LCALL    ?L?COM00E6
B2:0080D1 12262D            LCALL    ?C?PLDOPTR
B2:0080D4 903BBB            MOV      DPTR,#node_count
B2:0080D7 E0                MOVX     A,@DPTR
B2:0080D8 75F004            MOV      B,#04H
B2:0080DB 127103            LCALL    ?L?COM0273
B2:0080DE 121FF0            LCALL    ?C?CLDOPTR
B2:0080E1 FD                MOV      R5,A
B2:0080E2 3184              ACALL    ?L?COM0528
B2:0080E4 121B9C            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskSetBit
  157:       }
B2:0080E7         ?C0014?ZW_TRANSPORTMULTICAST:
  158: 
  159:       if (1 < s2_node_count)
B2:0080E7 903BBC            MOV      DPTR,#s2_node_count
B2:0080EA 317D              ACALL    ?L?COM0458
B2:0080EC 4008              JC       ?C0009?ZW_TRANSPORTMULTICAST
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 504


  160:       {
  161:         // We got two S2 nodes => Skip the rest and go to S2 multicast.
  162:         break;
  163:       }
B2:0080EE         ?C0016?ZW_TRANSPORTMULTICAST:
  164:     }
  165:   }
B2:0080EE         ?C0010?ZW_TRANSPORTMULTICAST:
B2:0080EE 903BBB            MOV      DPTR,#node_count
B2:0080F1 E0                MOVX     A,@DPTR
B2:0080F2 04                INC      A
B2:0080F3 F0                MOVX     @DPTR,A
B2:0080F4 8095              SJMP     ?C0008?ZW_TRANSPORTMULTICAST
B2:0080F6         ?C0009?ZW_TRANSPORTMULTICAST:
  166: 
  167:   singlecast_node_count = 0;
B2:0080F6 E4                CLR      A
B2:0080F7 903693            MOV      DPTR,#singlecast_node_count
B2:0080FA F0                MOVX     @DPTR,A
  168:   txSecOptions = 0;
B2:0080FB 903699            MOV      DPTR,#txSecOptions
B2:0080FE F0                MOVX     @DPTR,A
  169: 
  170:   if (1 < s2_node_count)
B2:0080FF 903BBC            MOV      DPTR,#s2_node_count
B2:008102 317D              ACALL    ?L?COM0458
B2:008104 503A              JNC      ?C0017?ZW_TRANSPORTMULTICAST
  171:   {
  172:     // We got more than one s2 node => Transmit S2 multicast.
  173:     TRANSMIT_MULTI_OPTIONS_TYPE txOptionsMultiEx;
  174: 
  175:     txOptionsMultiEx.groupID = p_nodelist->S2_groupID;
B2:008106 903BB6            MOV      DPTR,#p_nodelist
B2:008109 12AE26            LCALL    ?L?COM0049
B2:00810C 903BBE            MOV      DPTR,#txOptionsMultiEx
B2:00810F F0                MOVX     @DPTR,A
  176:     txOptionsMultiEx.bSrcNode = 0xFF;
B2:008110 A3                INC      DPTR
B2:008111 74FF              MOV      A,#0FFH
B2:008113 12A0DE            LCALL    ?L?COM0296
B2:008116 903BC1            MOV      DPTR,#txOptionsMultiEx+03H
B2:008119 EF                MOV      A,R7
B2:00811A F0                MOVX     @DPTR,A
  177:     txOptionsMultiEx.txOptions = 0;
  178:     txOptionsMultiEx.securityKey = GetHighestSecureLevel(ZW_GetSecurityKeys());
  179:     txSecOptions = S2_TXOPTION_VERIFY_DELIVERY | S2_TXOPTION_SINGLECAST_FOLLOWUP;
B2:00811B 903699            MOV      DPTR,#txSecOptions
B2:00811E 7403              MOV      A,#03H
B2:008120 F0                MOVX     @DPTR,A
  180: 
  181:     ZW_DEBUG_SEND_STR("\r\nMulti dest grp ID: ");
  182:     ZW_DEBUG_SEND_NUM(txOptionsMultiEx.groupID);
  183:     ZW_DEBUG_SEND_NL();
  184: 
  185:     return (ZW_SendDataMultiEx((BYTE *)p_data, data_length, &txOptionsMultiEx, ZCB_callback_wrapper));
B2:008121 903BB4            MOV      DPTR,#data_length
B2:008124 E0                MOVX     A,@DPTR
B2:008125 FD                MOV      R5,A
B2:008126 7B01              MOV      R3,#01H
B2:008128 7A3B              MOV      R2,#HIGH txOptionsMultiEx
B2:00812A 79BE              MOV      R1,#LOW txOptionsMultiEx
B2:00812C 900A5C            MOV      DPTR,#?_ZW_SendDataMultiEx?BYTE+04H
B2:00812F 1225A9            LCALL    ?C?PSTXDATA
B2:008132 900A5F            MOV      DPTR,#?_ZW_SendDataMultiEx?BYTE+07H
B2:008135 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_callback_wrapper
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 505


B2:008137 F0                MOVX     @DPTR,A
B2:008138 A3                INC      DPTR
B2:008139 7494              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_callback_wrapper
B2:00813B 3176              ACALL    ?L?COM03BE
B2:00813D 021985            LJMP     ?INTERBANK_TABLE?_ZW_SendDataMultiEx
  186:   }
B2:008140         ?C0017?ZW_TRANSPORTMULTICAST:
  187:   else if (1 < nonsecure_node_count)
B2:008140 903BBD            MOV      DPTR,#nonsecure_node_count
B2:008143 317D              ACALL    ?L?COM0458
B2:008145 5023              JNC      ?C0019?ZW_TRANSPORTMULTICAST
  188:   {
  189:     if (!ZW_SendDataMulti(node_mask, (BYTE *)p_data, data_length, 0, ZCB_callback_wrapper))
B2:008147 3177              ACALL    ?L?COM03BF
B2:008149 903DF5            MOV      DPTR,#?_ZW_SendDataMulti?BYTE+03H
B2:00814C 318B              ACALL    ?L?COM0529
B2:00814E E0                MOVX     A,@DPTR
B2:00814F 903DF8            MOV      DPTR,#?_ZW_SendDataMulti?BYTE+06H
B2:008152 F0                MOVX     @DPTR,A
B2:008153 E4                CLR      A
B2:008154 A3                INC      DPTR
B2:008155 F0                MOVX     @DPTR,A
B2:008156 A3                INC      DPTR
B2:008157 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_callback_wrapper
B2:008159 F0                MOVX     @DPTR,A
B2:00815A A3                INC      DPTR
B2:00815B 7494              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_callback_wrapper
B2:00815D F0                MOVX     @DPTR,A
B2:00815E 3184              ACALL    ?L?COM0528
B2:008160 1219A8            LCALL    ?INTERBANK_TABLE?_ZW_SendDataMulti
B2:008163 EF                MOV      A,R7
B2:008164 7F01              MOV      R7,#01H
B2:008166 700A              JNZ      ?C0003?ZW_TRANSPORTMULTICAST
  190:     {
  191:       return ZW_TX_FAILED;
B2:008168 FF                MOV      R7,A
  192:     }
  193:     else
  194:     {
  195:       return ZW_TX_IN_PROGRESS;
B2:008169 22                RET      
  196:     }
  197:   }
B2:00816A         ?C0019?ZW_TRANSPORTMULTICAST:
  198:   else
  199:   {
  200:     /*
  201:      * If there's only one non-endpoint node, we skip the multicast and call
  202:      * the multicast callback directly. This callback will initiate singlecast
  203:      * transmission. The argument can be ignored.
  204:      */
  205:     ZCB_multicast_callback(NULL);
B2:00816A 12B299            LCALL    ?L?COM0069
B2:00816D 12B2A2            LCALL    _ZCB_multicast_callback
  206:     return ZW_TX_IN_PROGRESS;
B2:008170 7F01              MOV      R7,#01H
  207:   }
  208: }
B2:008172         ?C0003?ZW_TRANSPORTMULTICAST:
B2:008172 22                RET      
----- FUNCTION _ZW_TransportMulticast_SendRequest (END) -------


----- FUNCTION ApplicationSecureKeysRequested (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 506


 1156: BYTE ApplicationSecureKeysRequested(void)
 1157: {
 1158:   return REQUESTED_SECURITY_KEYS;
 1159: }
B2:008173 7F81              MOV      R7,#081H
 1160: 
B2:008175 22                RET      
----- FUNCTION ApplicationSecureKeysRequested (END) -------


----- FUNCTION ?L?COM03BE (BEGIN) -----
B2:008176 F0                MOVX     @DPTR,A
B2:008177         ?L?COM03BF:
B2:008177 903BB1            MOV      DPTR,#p_data
B2:00817A 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03BE (END) -------


----- FUNCTION ?L?COM0458 (BEGIN) -----
B2:00817D E0                MOVX     A,@DPTR
B2:00817E FF                MOV      R7,A
B2:00817F 7401              MOV      A,#01H
B2:008181 C3                CLR      C
B2:008182 9F                SUBB     A,R7
B2:008183 22                RET      
----- FUNCTION ?L?COM0458 (END) -------


----- FUNCTION ?L?COM0528 (BEGIN) -----
B2:008184 7B01              MOV      R3,#01H
B2:008186 7A36              MOV      R2,#HIGH node_mask
B2:008188 7973              MOV      R1,#LOW node_mask
B2:00818A 22                RET      
----- FUNCTION ?L?COM0528 (END) -------


----- FUNCTION ?L?COM0529 (BEGIN) -----
B2:00818B 1225A9            LCALL    ?C?PSTXDATA
B2:00818E 903BB4            MOV      DPTR,#data_length
B2:008191 22                RET      
----- FUNCTION ?L?COM0529 (END) -------


----- FUNCTION ti_csa_prompt (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  565: ti_csa_prompt(void)
  566: {
  567: #ifdef TEST_INTERFACE_SUPPORT
  568:   ZW_UART0_tx_send_nl();
B2:008192 121D31            LCALL    ?INTERBANK_TABLE?ZW_UART0_tx_send_nl
  569:   ZW_UART0_tx_send_str((BYTE*)"Type 'a csa <10 digit key>' and press Enter.");
B2:008195 7A2E              MOV      R2,#HIGH 01002EFDH
B2:008197 79FD              MOV      R1,#LOW 01002EFDH
B2:008199 31A4              ACALL    ?L?COM03EB
  570:   ZW_UART0_tx_send_nl();
  571:   ZW_UART0_tx_send_str((BYTE*)"> ");
B2:00819B 7BFF              MOV      R3,#0FFH
B2:00819D 7A2F              MOV      R2,#HIGH 01002F2AH
B2:00819F 792A              MOV      R1,#LOW 01002F2AH
B2:0081A1 021D2C            LJMP     ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
----- FUNCTION ti_csa_prompt (END) -------


----- FUNCTION ?L?COM03EB (BEGIN) -----
B2:0081A4 7BFF              MOV      R3,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 507


B2:0081A6 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
B2:0081A9 021D31            LJMP     ?INTERBANK_TABLE?ZW_UART0_tx_send_nl
----- FUNCTION ?L?COM03EB (END) -------


----- FUNCTION _CC_Version_getCommandClassVersion_handler (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  452: handleCommandClassVersionAppl( BYTE cmdClass )
  453: {
;---- Variable 'cmdClass' assigned to Register 'R7' ----
  454:   BYTE commandClassVersion = UNKNOWN_VERSION;
  455: 
B2:0081AC E4                CLR      A
B2:0081AD 90439F            MOV      DPTR,#commandClassVersion
B2:0081B0 F0                MOVX     @DPTR,A
  456:   switch (cmdClass)
B2:0081B1 EF                MOV      A,R7
B2:0081B2 1226B6            LCALL    ?C?CCASE
B2:0081B5 81F3              DW       ?C0028?SWITCHONOFF
B2:0081B7 20                DB       020H
B2:0081B8 81FB              DW       ?C0029?SWITCHONOFF
B2:0081BA 25                DB       025H
B2:0081BB 81ED              DW       ?C0025?SWITCHONOFF
B2:0081BD 59                DB       059H
B2:0081BE 81EF              DW       ?C0026?SWITCHONOFF
B2:0081C0 5A                DB       05AH
B2:0081C1 81F1              DW       ?C0027?SWITCHONOFF
B2:0081C3 5E                DB       05EH
B2:0081C4 8205              DW       ?C0031?SWITCHONOFF
B2:0081C6 6C                DB       06CH
B2:0081C7 81E9              DW       ?C0023?SWITCHONOFF
B2:0081C9 72                DB       072H
B2:0081CA 81E7              DW       ?C0022?SWITCHONOFF
B2:0081CC 73                DB       073H
B2:0081CD 81DF              DW       ?C0021?SWITCHONOFF
B2:0081CF 7A                DB       07AH
B2:0081D0 81EB              DW       ?C0024?SWITCHONOFF
B2:0081D2 85                DB       085H
B2:0081D3 81DD              DW       ?C0020?SWITCHONOFF
B2:0081D5 86                DB       086H
B2:0081D6 81DD              DW       ?C0020?SWITCHONOFF
B2:0081D8 8E                DB       08EH
B2:0081D9 0000              DW       00H
B2:0081DB 820D              DW       ?C0032?SWITCHONOFF
  457:   {
  458:     case COMMAND_CLASS_VERSION:
B2:0081DD         ?C0020?SWITCHONOFF:
  459:      commandClassVersion = CommandClassVersionVersionGet();
  460:       break;
B2:0081DD 801E              SJMP     ?C0133?SWITCHONOFF
  461: 
  462: #ifdef BOOTLOADER_ENABLED
  463:     case COMMAND_CLASS_FIRMWARE_UPDATE_MD:
B2:0081DF         ?C0021?SWITCHONOFF:
  464:       commandClassVersion = CommandClassFirmwareUpdateMdVersionGet();
B2:0081DF 90439F            MOV      DPTR,#commandClassVersion
B2:0081E2 7404              MOV      A,#04H
B2:0081E4 F0                MOVX     @DPTR,A
  465:       break;
B2:0081E5 802E              SJMP     ?C0019?SWITCHONOFF
  466: #endif
  467: 
  468:     case COMMAND_CLASS_POWERLEVEL:
B2:0081E7         ?C0022?SWITCHONOFF:
  469:      commandClassVersion = CommandClassPowerLevelVersionGet();
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 508


  470:       break;
B2:0081E7 801C              SJMP     ?C0140?SWITCHONOFF
  471: 
  472:     case COMMAND_CLASS_MANUFACTURER_SPECIFIC:
B2:0081E9         ?C0023?SWITCHONOFF:
  473:      commandClassVersion = CommandClassManufacturerVersionGet();
  474:       break;
B2:0081E9 8008              SJMP     ?C0139?SWITCHONOFF
  475: 
  476:     case COMMAND_CLASS_ASSOCIATION:
B2:0081EB         ?C0024?SWITCHONOFF:
  477:      commandClassVersion = CommandClassAssociationVersionGet();
B2:0081EB         
  478:       break;
B2:0081EB 8006              SJMP     ?C0139?SWITCHONOFF
  479: 
  480:     case COMMAND_CLASS_ASSOCIATION_GRP_INFO:
B2:0081ED         ?C0025?SWITCHONOFF:
  481:      commandClassVersion = CommandClassAssociationGroupInfoVersionGet();
B2:0081ED         
  482:       break;
B2:0081ED 8016              SJMP     ?C0140?SWITCHONOFF
  483: 
  484:     case COMMAND_CLASS_DEVICE_RESET_LOCALLY:
B2:0081EF         ?C0026?SWITCHONOFF:
  485:      commandClassVersion = CommandClassDeviceResetLocallyVersionGet();
B2:0081EF         
  486:       break;
B2:0081EF 8014              SJMP     ?C0140?SWITCHONOFF
  487: 
  488:     case COMMAND_CLASS_ZWAVEPLUS_INFO:
B2:0081F1         ?C0027?SWITCHONOFF:
  489:      commandClassVersion = CommandClassZWavePlusVersion();
B2:0081F1         
  490:       break;
B2:0081F1 8000              SJMP     ?C0139?SWITCHONOFF
  491:     case COMMAND_CLASS_BASIC:
B2:0081F3         ?C0028?SWITCHONOFF:
  492:      commandClassVersion =  CommandClassBasicVersionGet();
B2:0081F3         
B2:0081F3 90439F            MOV      DPTR,#commandClassVersion
B2:0081F6 7402              MOV      A,#02H
B2:0081F8 F0                MOVX     @DPTR,A
  493:       break;
B2:0081F9 801A              SJMP     ?C0019?SWITCHONOFF
  494:     case COMMAND_CLASS_SWITCH_BINARY:
B2:0081FB         ?C0029?SWITCHONOFF:
  495:      commandClassVersion = CommandClassBinarySwitchVersionGet();
B2:0081FB         
  496:       break;
B2:0081FB 8008              SJMP     ?C0140?SWITCHONOFF
  497: 
  498:     case COMMAND_CLASS_MULTI_CHANNEL_ASSOCIATION_V2:
B2:0081FD         
B2:0081FD 90439F            MOV      DPTR,#commandClassVersion
B2:008200 7403              MOV      A,#03H
B2:008202 F0                MOVX     @DPTR,A
  499:       commandClassVersion = CmdClassMultiChannelAssociationVersion();
  500:       break;
B2:008203 8010              SJMP     ?C0019?SWITCHONOFF
  501: 
  502:     case COMMAND_CLASS_SUPERVISION:
B2:008205         ?C0031?SWITCHONOFF:
  503:       commandClassVersion = CommandClassSupervisionVersionGet();
B2:008205         
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 509


B2:008205 90439F            MOV      DPTR,#commandClassVersion
B2:008208 7401              MOV      A,#01H
B2:00820A F0                MOVX     @DPTR,A
  504:       break;
B2:00820B 8008              SJMP     ?C0019?SWITCHONOFF
  505: 
  506:     default:
B2:00820D         ?C0032?SWITCHONOFF:
  507:      commandClassVersion = ZW_Transport_CommandClassVersionGet(cmdClass);
B2:00820D 12197B            LCALL    ?INTERBANK_TABLE?_ZW_Transport_CommandClassVersionGet
B2:008210 90439F            MOV      DPTR,#commandClassVersion
B2:008213 EF                MOV      A,R7
B2:008214 F0                MOVX     @DPTR,A
  508:   }
B2:008215         ?C0019?SWITCHONOFF:
  509:   return commandClassVersion;
B2:008215 90439F            MOV      DPTR,#commandClassVersion
B2:008218 E0                MOVX     A,@DPTR
B2:008219 FF                MOV      R7,A
  510: }
B2:00821A 22                RET      
----- FUNCTION _CC_Version_getCommandClassVersion_handler (END) -------


----- FUNCTION handleCommandClassFirmwareUpdateMaxFragmentSize (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
 1006: uint16_t handleCommandClassFirmwareUpdateMaxFragmentSize(void)
 1007: {
 1008:   register BYTE bMaxPayload;
 1009: 
 1010:   /*
 1011:    * Since this function does not include security nor command classes in it's return value, we
 1012:    * have to calculate it.
 1013:    */
 1014:   bMaxPayload = ZW_GetMaxPayloadSize();
B2:00821B 12199E            LCALL    ?INTERBANK_TABLE?ZW_GetMaxPayloadSize
B2:00821E 9043B1            MOV      DPTR,#bMaxPayload
B2:008221 EF                MOV      A,R7
B2:008222 F0                MOVX     @DPTR,A
 1015: 
 1016:   if (SECURITY_KEY_S2_MASK & ZW_GetSecurityKeys())
B2:008223 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:008226 EF                MOV      A,R7
B2:008227 5407              ANL      A,#07H
B2:008229 6008              JZ       ?C0126?OTA_UTIL
 1017:   {
 1018:     return (bMaxPayload - S2_ENCAPSULATION_LENGTH - FIRMWARE_UPDATE_MD_REPORT_ENCAPSULATION_LENGTH);
B2:00822B 9043B1            MOV      DPTR,#bMaxPayload
B2:00822E E0                MOVX     A,@DPTR
B2:00822F 24EE              ADD      A,#0EEH
B2:008231 801D              SJMP     ?C0162?OTA_UTIL
 1019:   }
B2:008233         ?C0126?OTA_UTIL:
 1020:   else if (SECURITY_KEY_S0_BIT & ZW_GetSecurityKeys())
B2:008233 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:008236 EF                MOV      A,R7
B2:008237 30E70A            JNB      ACC.7,?C0129?OTA_UTIL
 1021:   {
 1022:     return ((bMaxPayload - S0_ENCAPSULATION_LENGTH) * S0_SEQUENCING_FACTOR - FIRMWARE_UPDATE_MD_REPORT_ENCAPSULAT
>> ION_LENGTH);
B2:00823A 9043B1            MOV      DPTR,#bMaxPayload
B2:00823D E0                MOVX     A,@DPTR
B2:00823E 25E0              ADD      A,ACC
B2:008240 24D2              ADD      A,#0D2H
B2:008242         
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 510


B2:008242 800C              SJMP     ?C0162?OTA_UTIL
 1023:   }
B2:008244         ?C0129?OTA_UTIL:
 1024:   else if (SECURITY_KEY_NONE_MASK == ZW_GetSecurityKeys())
B2:008244 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:008247 EF                MOV      A,R7
B2:008248 700A              JNZ      ?C0128?OTA_UTIL
 1025:   {
 1026:     return (bMaxPayload - FIRMWARE_UPDATE_MD_REPORT_ENCAPSULATION_LENGTH);
B2:00824A 9043B1            MOV      DPTR,#bMaxPayload
B2:00824D E0                MOVX     A,@DPTR
B2:00824E 24FA              ADD      A,#0FAH
B2:008250         
B2:008250 FF                MOV      R7,A
B2:008251 7E00              MOV      R6,#00H
B2:008253 22                RET      
 1027:   }
B2:008254         ?C0128?OTA_UTIL:
 1028:   return 0;
B2:008254 E4                CLR      A
B2:008255 FE                MOV      R6,A
B2:008256 FF                MOV      R7,A
 1029: }
B2:008257 22                RET      
----- FUNCTION handleCommandClassFirmwareUpdateMaxFragmentSize (END) -------


----- FUNCTION ?L?COM0386 (BEGIN) -----
B2:008258 9043B3            MOV      DPTR,#?GetEndpointcmdClassList?BYTE
B2:00825B EF                MOV      A,R7
B2:00825C F0                MOVX     @DPTR,A
----- FUNCTION GetEndpointcmdClassList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  182: GetEndpointcmdClassList( BOOL secList, BYTE endpoint)
  183: {
  184:   if( (endpoint > myTransportEndpoint.sizeList) || (0 == endpoint) )
  185:   {
B2:00825D 9035F8            MOV      DPTR,#myTransportEndpoint+04H
B2:008260 E0                MOVX     A,@DPTR
B2:008261 FF                MOV      R7,A
B2:008262 9043B3            MOV      DPTR,#endpoint
B2:008265 E0                MOVX     A,@DPTR
B2:008266 FE                MOV      R6,A
B2:008267 D3                SETB     C
B2:008268 9F                SUBB     A,R7
B2:008269 5037              JNC      ?C0053?ZW_TRANSPORTENDPOINT
B2:00826B EE                MOV      A,R6
B2:00826C 7002              JNZ      ?C0010?ZW_TRANSPORTENDPOINT
B2:00826E         ?C0011?ZW_TRANSPORTENDPOINT:
  186:     return NULL;
  187:   }
B2:00826E 8032              SJMP     ?C0053?ZW_TRANSPORTENDPOINT
  188: 
B2:008270         ?C0010?ZW_TRANSPORTENDPOINT:
  189:   if(SECURITY_KEY_NONE == GetHighestSecureLevel(ZW_GetSecurityKeys()))
B2:008270 128CAB            LCALL    ?L?COM0510
B2:008273 EF                MOV      A,R7
B2:008274 7014              JNZ      ?C0013?ZW_TRANSPORTENDPOINT
  190:   {
  191:     /*Non-secure included*/
  192:     if(FALSE == secList){
B2:008276 204D0A            JB       secList,?C0014?ZW_TRANSPORTENDPOINT
  193:       return &(myTransportEndpoint.pList[endpoint - 1].CmdClass3List.unsecList);
B2:008279 12D61F            LCALL    ?L?COM02FE
B2:00827C 51AD              ACALL    ?L?COM0086
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 511


B2:00827E E9                MOV      A,R1
B2:00827F 24F4              ADD      A,#0F4H
B2:008281 8019              SJMP     ?C0054?ZW_TRANSPORTENDPOINT
  194:     }
B2:008283         ?C0014?ZW_TRANSPORTENDPOINT:
  195:     else {
  196:       return &(myTransportEndpoint.emptyList);
B2:008283 7B01              MOV      R3,#01H
B2:008285 7A36              MOV      R2,#HIGH myTransportEndpoint+0CH
B2:008287 7900              MOV      R1,#LOW myTransportEndpoint+0CH
B2:008289 22                RET      
  197:     }
  198:   }
B2:00828A         ?C0013?ZW_TRANSPORTENDPOINT:
  199:   else{
  200:     /*Secure included*/
  201:     if(FALSE == secList){
B2:00828A 12D61F            LCALL    ?L?COM02FE
B2:00828D 204D07            JB       secList,?C0017?ZW_TRANSPORTENDPOINT
  202:       return &(myTransportEndpoint.pList[endpoint - 1].CmdClass3List.sec.unsecList);
B2:008290 51AD              ACALL    ?L?COM0086
B2:008292 E9                MOV      A,R1
B2:008293 24F8              ADD      A,#0F8H
B2:008295 8005              SJMP     ?C0052?ZW_TRANSPORTENDPOINT
  203:     }
B2:008297         ?C0017?ZW_TRANSPORTENDPOINT:
  204:     else {
  205:       return &(myTransportEndpoint.pList[endpoint - 1].CmdClass3List.sec.secList);
B2:008297 51AD              ACALL    ?L?COM0086
B2:008299 E9                MOV      A,R1
B2:00829A 24FC              ADD      A,#0FCH
B2:00829C         
B2:00829C         
B2:00829C F9                MOV      R1,A
B2:00829D EA                MOV      A,R2
B2:00829E 34FF              ADDC     A,#0FFH
B2:0082A0 FA                MOV      R2,A
B2:0082A1 22                RET      
  206:     }
  207:   }
B2:0082A2         
B2:0082A2 02B299            LJMP     ?L?COM0069
  208:   return NULL;
----- FUNCTION GetEndpointcmdClassList (END) -------


----- FUNCTION ?L?COM0085 (BEGIN) -----
B2:0082A5 75F004            MOV      B,#04H
B2:0082A8 A4                MUL      AB
B2:0082A9 FF                MOV      R7,A
B2:0082AA 90426B            MOV      DPTR,#myIcon
B2:0082AD         ?L?COM0086:
B2:0082AD 122589            LCALL    ?C?PLDXDATA
B2:0082B0 E9                MOV      A,R1
B2:0082B1 2F                ADD      A,R7
B2:0082B2 F9                MOV      R1,A
B2:0082B3 EA                MOV      A,R2
B2:0082B4 35F0              ADDC     A,B
B2:0082B6 FA                MOV      R2,A
B2:0082B7 22                RET      
----- FUNCTION ?L?COM0085 (END) -------


----- FUNCTION ?L?COM0033 (BEGIN) -----
B2:0082B8 903FED            MOV      DPTR,#ep
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 512


B2:0082BB E0                MOVX     A,@DPTR
B2:0082BC 75F014            MOV      B,#014H
B2:0082BF A4                MUL      AB
B2:0082C0 246B              ADD      A,#LOW groups-014H
B2:0082C2 F9                MOV      R1,A
B2:0082C3 7439              MOV      A,#HIGH groups-014H
B2:0082C5 35F0              ADDC     A,B
B2:0082C7 FA                MOV      R2,A
B2:0082C8 7B01              MOV      R3,#01H
B2:0082CA A3                INC      DPTR
B2:0082CB         ?L?COM0034:
B2:0082CB E0                MOVX     A,@DPTR
B2:0082CC 75F014            MOV      B,#014H
B2:0082CF A4                MUL      AB
B2:0082D0 29                ADD      A,R1
B2:0082D1 F9                MOV      R1,A
B2:0082D2 EA                MOV      A,R2
B2:0082D3 35F0              ADDC     A,B
B2:0082D5 FA                MOV      R2,A
B2:0082D6 903994            MOV      DPTR,#indx
B2:0082D9         ?L?COM0035:
B2:0082D9 E0                MOVX     A,@DPTR
B2:0082DA         ?L?COM0036:
B2:0082DA 75F004            MOV      B,#04H
B2:0082DD         ?L?COM0037:
B2:0082DD A4                MUL      AB
B2:0082DE 29                ADD      A,R1
B2:0082DF F9                MOV      R1,A
B2:0082E0 EA                MOV      A,R2
B2:0082E1 35F0              ADDC     A,B
B2:0082E3 22                RET      
----- FUNCTION ?L?COM0033 (END) -------


----- FUNCTION _AssociationAddNode (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  207: AssociationAddNode(
  208:     BYTE groupID,
B2:0082E4 9041BD            MOV      DPTR,#groupID
B2:0082E7 124765            LCALL    ?L?COM0102
B2:0082EA 1225A9            LCALL    ?C?PSTXDATA
  209:     BYTE endpoint,
  210:     MULTICHAN_DEST_NODE_ID* pNode,
  211:     BOOL multiChannelAssociation)
  212: {
  213:   AssGroupMappingLookUp(&endpoint, &groupID);
B2:0082ED 7B01              MOV      R3,#01H
B2:0082EF 7A41              MOV      R2,#HIGH groupID
B2:0082F1 79BD              MOV      R1,#LOW groupID
B2:0082F3 12D9F6            LCALL    ?L?COM038B
B2:0082F6 7A41              MOV      R2,#HIGH endpoint
B2:0082F8 09                INC      R1
B2:0082F9 12C501            LCALL    _AssGroupMappingLookUp
  214: 
  215:   for (indx = 0; indx < handleGetMaxNodesInGroup(groupID, endpoint) /*MAX_ASSOCIATION_IN_GROUP*/; indx++)
B2:0082FC E4                CLR      A
B2:0082FD 903994            MOV      DPTR,#indx
B2:008300 F0                MOVX     @DPTR,A
B2:008301         ?C0019?ASSOCIATION_PLUS:
B2:008301 9041BD            MOV      DPTR,#groupID
B2:008304 E0                MOVX     A,@DPTR
B2:008305 A3                INC      DPTR
B2:008306 12C4A5            LCALL    ?L?COM0533
B2:008309 903994            MOV      DPTR,#indx
B2:00830C E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 513


B2:00830D FE                MOV      R6,A
B2:00830E C3                CLR      C
B2:00830F 9F                SUBB     A,R7
B2:008310 4002              JC       $ + 4H
B2:008312 8123              AJMP     ?C0020?ASSOCIATION_PLUS
  216:   {
  217:     if (((groups[endpoint][groupID - 1].subGrp[indx].node.nodeId == pNode->nodeId) &&
B2:008314 9041BF            MOV      DPTR,#pNode
B2:008317 12AE26            LCALL    ?L?COM0049
B2:00831A FF                MOV      R7,A
B2:00831B 9041BE            MOV      DPTR,#endpoint
B2:00831E E0                MOVX     A,@DPTR
B2:00831F B1ED              ACALL    ?L?COM01BA
B2:008321 C083              PUSH     DPH
B2:008323 C082              PUSH     DPL
B2:008325 9041BD            MOV      DPTR,#groupID
B2:008328 E0                MOVX     A,@DPTR
B2:008329 FD                MOV      R5,A
B2:00832A D082              POP      DPL
B2:00832C D083              POP      DPH
B2:00832E B1D7              ACALL    ?L?COM018E
B2:008330 75F004            MOV      B,#04H
B2:008333 EE                MOV      A,R6
B2:008334 12257D            LCALL    ?C?OFFXADD
B2:008337 E0                MOVX     A,@DPTR
B2:008338 6F                XRL      A,R7
B2:008339 703B              JNZ      ?C0024?ASSOCIATION_PLUS
B2:00833B B1FB              ACALL    ?L?COM04FE
B2:00833D E9                MOV      A,R1
B2:00833E 2401              ADD      A,#01H
B2:008340 125510            LCALL    ?L?COM000B
B2:008343 547F              ANL      A,#07FH
B2:008345 FF                MOV      R7,A
B2:008346 9041BE            MOV      DPTR,#endpoint
B2:008349 12D968            LCALL    ?L?COM026B
B2:00834C 12D9CB            LCALL    ?L?COM037A
B2:00834F C083              PUSH     DPH
B2:008351 C082              PUSH     DPL
B2:008353 903994            MOV      DPTR,#indx
B2:008356 E0                MOVX     A,@DPTR
B2:008357 D082              POP      DPL
B2:008359 D083              POP      DPH
B2:00835B B1DD              ACALL    ?L?COM01A1
B2:00835D FE                MOV      R6,A
B2:00835E 547F              ANL      A,#07FH
B2:008360 B50713            CJNE     A,AR7,?C0024?ASSOCIATION_PLUS
B2:008363 B1FB              ACALL    ?L?COM04FE
B2:008365 E9                MOV      A,R1
B2:008366 2401              ADD      A,#01H
B2:008368 125510            LCALL    ?L?COM000B
B2:00836B 127152            LCALL    ?L?COM02C7
B2:00836E FF                MOV      R7,A
B2:00836F EE                MOV      A,R6
B2:008370 127152            LCALL    ?L?COM02C7
B2:008373 6F                XRL      A,R7
B2:008374 6026              JZ       ?C0023?ASSOCIATION_PLUS
B2:008376         ?C0024?ASSOCIATION_PLUS:
B2:008376 9041BE            MOV      DPTR,#endpoint
B2:008379 E0                MOVX     A,@DPTR
B2:00837A B1ED              ACALL    ?L?COM01BA
B2:00837C C083              PUSH     DPH
B2:00837E C082              PUSH     DPL
B2:008380 9041BD            MOV      DPTR,#groupID
B2:008383 E0                MOVX     A,@DPTR
B2:008384 D082              POP      DPL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 514


B2:008386 D083              POP      DPH
B2:008388 B1D7              ACALL    ?L?COM018E
B2:00838A C083              PUSH     DPH
B2:00838C C082              PUSH     DPL
B2:00838E 903994            MOV      DPTR,#indx
B2:008391 E0                MOVX     A,@DPTR
B2:008392 D082              POP      DPL
B2:008394 D083              POP      DPH
B2:008396 B1DD              ACALL    ?L?COM01A1
B2:008398 6002              JZ       $ + 4H
B2:00839A 811E              AJMP     ?C0021?ASSOCIATION_PLUS
B2:00839C         ?C0023?ASSOCIATION_PLUS:
  218:          (groups[endpoint][groupID - 1].subGrp[indx].node.endpoint == pNode->endpoint)&&
  219:          (groups[endpoint][groupID - 1].subGrp[indx].node.BitAddress == pNode->BitAddress)) ||
  220:         (0 == groups[endpoint][groupID - 1].subGrp[indx].node.nodeId))
  221:     {
  222:       memcpy((BYTE*)&groups[endpoint][groupID - 1].subGrp[indx].node, (BYTE*)pNode, sizeof(MULTICHAN_DEST_NODE_ID
>> ));
B2:00839C 9041BE            MOV      DPTR,#endpoint
B2:00839F 12D91B            LCALL    ?L?COM018A
B2:0083A2 9041BD            MOV      DPTR,#groupID
B2:0083A5 51CB              ACALL    ?L?COM0034
B2:0083A7 FA                MOV      R2,A
B2:0083A8 C003              PUSH     AR3
B2:0083AA C002              PUSH     AR2
B2:0083AC C001              PUSH     AR1
B2:0083AE B1FB              ACALL    ?L?COM04FE
B2:0083B0 12C4EF            LCALL    ?L?COM0022
B2:0083B3 D001              POP      AR1
B2:0083B5 D002              POP      AR2
B2:0083B7 D003              POP      AR3
B2:0083B9 7F02              MOV      R7,#02H
B2:0083BB 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  223:       groups[endpoint][groupID - 1].subGrp[indx].nodeInfo.BitMultiChannelEncap = multiChannelAssociation;
B2:0083BE A243              MOV      C,multiChannelAssociation
B2:0083C0 E4                CLR      A
B2:0083C1 33                RLC      A
B2:0083C2 FF                MOV      R7,A
B2:0083C3 9041BE            MOV      DPTR,#endpoint
B2:0083C6 E0                MOVX     A,@DPTR
B2:0083C7 12D94C            LCALL    ?L?COM01F7
B2:0083CA C083              PUSH     DPH
B2:0083CC C082              PUSH     DPL
B2:0083CE 9041BD            MOV      DPTR,#groupID
B2:0083D1 E0                MOVX     A,@DPTR
B2:0083D2 D082              POP      DPL
B2:0083D4 D083              POP      DPH
B2:0083D6 B1D7              ACALL    ?L?COM018E
B2:0083D8 C083              PUSH     DPH
B2:0083DA C082              PUSH     DPL
B2:0083DC 903994            MOV      DPTR,#indx
B2:0083DF E0                MOVX     A,@DPTR
B2:0083E0 D082              POP      DPL
B2:0083E2 D083              POP      DPH
B2:0083E4 75F004            MOV      B,#04H
B2:0083E7 12257D            LCALL    ?C?OFFXADD
B2:0083EA EF                MOV      A,R7
B2:0083EB 12A0E1            LCALL    ?L?COM0297
B2:0083EE 9041BE            MOV      DPTR,#endpoint
B2:0083F1 E0                MOVX     A,@DPTR
B2:0083F2 75F014            MOV      B,#014H
B2:0083F5 A4                MUL      AB
B2:0083F6 246E              ADD      A,#LOW groups-011H
B2:0083F8 F582              MOV      DPL,A
B2:0083FA E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 515


B2:0083FB 3439              ADDC     A,#HIGH groups-011H
B2:0083FD F583              MOV      DPH,A
B2:0083FF C083              PUSH     DPH
B2:008401 C082              PUSH     DPL
B2:008403 9041BD            MOV      DPTR,#groupID
B2:008406 E0                MOVX     A,@DPTR
B2:008407 D082              POP      DPL
B2:008409 D083              POP      DPH
B2:00840B B1D7              ACALL    ?L?COM018E
B2:00840D C083              PUSH     DPH
B2:00840F C082              PUSH     DPL
B2:008411 903994            MOV      DPTR,#indx
B2:008414 E0                MOVX     A,@DPTR
B2:008415 D082              POP      DPL
B2:008417 D083              POP      DPH
B2:008419 12DA5F            LCALL    ?L?COM040D
  224:       groups[endpoint][groupID - 1].subGrp[indx].nodeInfo.security = GetHighestSecureLevel(ZW_GetSecurityKeys());
>> 
  225:       return TRUE;
B2:00841C D3                SETB     C
B2:00841D 22                RET      
  226:     }
  227:   }
B2:00841E         ?C0021?ASSOCIATION_PLUS:
B2:00841E 12DB6A            LCALL    ?L?COM0535
B2:008421 6101              AJMP     ?C0019?ASSOCIATION_PLUS
B2:008423         ?C0020?ASSOCIATION_PLUS:
  228: 
  229:   return FALSE;
B2:008423 C3                CLR      C
  230: }
B2:008424 22                RET      
----- FUNCTION _AssociationAddNode (END) -------


----- FUNCTION _RemoveAssociationsFromGroup (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  325: RemoveAssociationsFromGroup(
  326:     uint8_t cmdClass,
B2:008425 903FEC            MOV      DPTR,#cmdClass
B2:008428 124765            LCALL    ?L?COM0102
B2:00842B EB                MOV      A,R3
B2:00842C F0                MOVX     @DPTR,A
  327:     uint8_t ep,
  328:     uint8_t groupId,
  329:     ASSOCIATION_NODE_LIST * pListOfNodes)
  330: {
  331:   uint8_t i;
  332:   uint8_t numberOfNodes;
  333: 
  334:   numberOfNodes = ((0 == pListOfNodes->noOfNodes) ? 1 : pListOfNodes->noOfNodes);
B2:00842D A3                INC      DPTR
B2:00842E 12707E            LCALL    ?L?COM00F2
B2:008431 125510            LCALL    ?L?COM000B
B2:008434 FF                MOV      R7,A
B2:008435 7004              JNZ      ?C0047?ASSOCIATION_PLUS
B2:008437 7F01              MOV      R7,#01H
B2:008439 8000              SJMP     ?C0048?ASSOCIATION_PLUS
B2:00843B         ?C0047?ASSOCIATION_PLUS:
B2:00843B         ?C0048?ASSOCIATION_PLUS:
B2:00843B 12DB38            LCALL    ?L?COM04D9
B2:00843E         ?C0049?ASSOCIATION_PLUS:
B2:00843E 12DAF5            LCALL    ?L?COM04A0
B2:008441 4002              JC       $ + 4H
B2:008443 81C8              AJMP     ?C0050?ASSOCIATION_PLUS
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 516


  335: 
  336:   // Remove all Node ID Associations in the given list.
  337:   for (i = 0; i < numberOfNodes; i++)
  338:   {
  339:     for (indx = 0; indx < MAX_ASSOCIATION_IN_GROUP; indx++)
B2:008445 E4                CLR      A
B2:008446 903994            MOV      DPTR,#indx
B2:008449 F0                MOVX     @DPTR,A
B2:00844A         ?C0052?ASSOCIATION_PLUS:
B2:00844A 12DB8C            LCALL    ?L?COM0597
B2:00844D 5071              JNC      ?C0051?ASSOCIATION_PLUS
  340:     {
  341:       if ((FALSE == groups[ep][groupId-1].subGrp[indx].nodeInfo.BitMultiChannelEncap) &&
B2:00844F 12D947            LCALL    ?L?COM01F6
B2:008452 C083              PUSH     DPH
B2:008454 C082              PUSH     DPL
B2:008456 903FEE            MOV      DPTR,#groupId
B2:008459 E0                MOVX     A,@DPTR
B2:00845A FD                MOV      R5,A
B2:00845B D082              POP      DPL
B2:00845D D083              POP      DPH
B2:00845F B1D7              ACALL    ?L?COM018E
B2:008461 12C636            LCALL    ?L?COM0324
B2:008464 E0                MOVX     A,@DPTR
B2:008465 7054              JNZ      ?C0054?ASSOCIATION_PLUS
B2:008467 903FEF            MOV      DPTR,#pListOfNodes
B2:00846A 12707E            LCALL    ?L?COM00F2
B2:00846D 125510            LCALL    ?L?COM000B
B2:008470 7007              JNZ      ?C0057?ASSOCIATION_PLUS
B2:008472 B1E5              ACALL    ?L?COM0456
B2:008474 12550D            LCALL    ?L?COM000A
B2:008477 6024              JZ       ?C0056?ASSOCIATION_PLUS
B2:008479         ?C0057?ASSOCIATION_PLUS:
B2:008479 903FEF            MOV      DPTR,#pListOfNodes
B2:00847C 12B441            LCALL    ?L?COM0101
B2:00847F 903FF2            MOV      DPTR,#i
B2:008482 E0                MOVX     A,@DPTR
B2:008483 29                ADD      A,R1
B2:008484 125510            LCALL    ?L?COM000B
B2:008487 B1EB              ACALL    ?L?COM01B9
B2:008489 12D9CB            LCALL    ?L?COM037A
B2:00848C C083              PUSH     DPH
B2:00848E C082              PUSH     DPL
B2:008490 903994            MOV      DPTR,#indx
B2:008493 E0                MOVX     A,@DPTR
B2:008494 D082              POP      DPL
B2:008496 D083              POP      DPH
B2:008498 B1DD              ACALL    ?L?COM01A1
B2:00849A 6F                XRL      A,R7
B2:00849B 701E              JNZ      ?C0054?ASSOCIATION_PLUS
B2:00849D         ?C0056?ASSOCIATION_PLUS:
  342:           ((0 == pListOfNodes->noOfNodes && 0 == pListOfNodes->noOfMulchanNodes) || groups[ep][groupId-1].subGrp[
>> indx].node.nodeId == pListOfNodes->pNodeId[i]))
  343:       {
  344:         memset((uint8_t*)&groups[ep][groupId-1].subGrp[indx], 0, sizeof(MULTICHAN_NODE_ID));
B2:00849D 51B8              ACALL    ?L?COM0033
B2:00849F FA                MOV      R2,A
B2:0084A0 7D04              MOV      R5,#04H
B2:0084A2 E4                CLR      A
B2:0084A3 FF                MOV      R7,A
B2:0084A4 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
  345:         if (0 < pListOfNodes->noOfNodes)
B2:0084A7 903FEF            MOV      DPTR,#pListOfNodes
B2:0084AA 12707E            LCALL    ?L?COM00F2
B2:0084AD 125510            LCALL    ?L?COM000B
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 517


B2:0084B0 FF                MOV      R7,A
B2:0084B1 E4                CLR      A
B2:0084B2 C3                CLR      C
B2:0084B3 9F                SUBB     A,R7
B2:0084B4 5005              JNC      ?C0054?ASSOCIATION_PLUS
  346:         {
  347:           ReorderGroupAfterRemove(groupId-1, ep, indx);
B2:0084B6 12C218            LCALL    ?L?COM036E
  348:           break;
B2:0084B9 8005              SJMP     ?C0051?ASSOCIATION_PLUS
  349:         }
  350:       }
  351:     }
B2:0084BB         ?C0054?ASSOCIATION_PLUS:
B2:0084BB 12DB6A            LCALL    ?L?COM0535
B2:0084BE 808A              SJMP     ?C0052?ASSOCIATION_PLUS
  352:   }
B2:0084C0         ?C0051?ASSOCIATION_PLUS:
B2:0084C0 903FF2            MOV      DPTR,#i
B2:0084C3 E0                MOVX     A,@DPTR
B2:0084C4 04                INC      A
B2:0084C5 F0                MOVX     @DPTR,A
B2:0084C6 813E              AJMP     ?C0049?ASSOCIATION_PLUS
B2:0084C8         ?C0050?ASSOCIATION_PLUS:
  353: 
  354:   if (COMMAND_CLASS_ASSOCIATION == cmdClass)
B2:0084C8 903FEC            MOV      DPTR,#cmdClass
B2:0084CB E0                MOVX     A,@DPTR
B2:0084CC 6485              XRL      A,#085H
B2:0084CE 7002              JNZ      $ + 4H
B2:0084D0 A1D6              AJMP     ?C0060?ASSOCIATION_PLUS
  355:   {
  356:     return;
  357:   }
B2:0084D2         ?C0059?ASSOCIATION_PLUS:
  358: 
  359:   numberOfNodes = ((0 == pListOfNodes->noOfMulchanNodes) ? 1 : pListOfNodes->noOfMulchanNodes);
B2:0084D2 B1E5              ACALL    ?L?COM0456
B2:0084D4 12550D            LCALL    ?L?COM000A
B2:0084D7 FF                MOV      R7,A
B2:0084D8 7004              JNZ      ?C0061?ASSOCIATION_PLUS
B2:0084DA 7F01              MOV      R7,#01H
B2:0084DC 8000              SJMP     ?C0062?ASSOCIATION_PLUS
B2:0084DE         ?C0061?ASSOCIATION_PLUS:
B2:0084DE         ?C0062?ASSOCIATION_PLUS:
B2:0084DE 12DB38            LCALL    ?L?COM04D9
B2:0084E1         ?C0063?ASSOCIATION_PLUS:
B2:0084E1 12DAF5            LCALL    ?L?COM04A0
B2:0084E4 4002              JC       $ + 4H
B2:0084E6 A1D6              AJMP     ?C0060?ASSOCIATION_PLUS
  360: 
  361:   // Remove all Endpoint Node ID Associations in the given list.
  362:   for (i = 0; i < numberOfNodes; i++)
  363:   {
  364:     for (indx = 0; indx < MAX_ASSOCIATION_IN_GROUP; indx++)
B2:0084E8 E4                CLR      A
B2:0084E9 903994            MOV      DPTR,#indx
B2:0084EC F0                MOVX     @DPTR,A
B2:0084ED         ?C0066?ASSOCIATION_PLUS:
B2:0084ED 12DB8C            LCALL    ?L?COM0597
B2:0084F0 4002              JC       $ + 4H
B2:0084F2 A1CE              AJMP     ?C0065?ASSOCIATION_PLUS
  365:     {
  366:       if ((TRUE == groups[ep][groupId-1].subGrp[indx].nodeInfo.BitMultiChannelEncap) &&
B2:0084F4 12D947            LCALL    ?L?COM01F6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 518


B2:0084F7 C083              PUSH     DPH
B2:0084F9 C082              PUSH     DPL
B2:0084FB 903FEE            MOV      DPTR,#groupId
B2:0084FE E0                MOVX     A,@DPTR
B2:0084FF FD                MOV      R5,A
B2:008500 D082              POP      DPL
B2:008502 D083              POP      DPH
B2:008504 B1D7              ACALL    ?L?COM018E
B2:008506 12C636            LCALL    ?L?COM0324
B2:008509 E0                MOVX     A,@DPTR
B2:00850A 6401              XRL      A,#01H
B2:00850C 6002              JZ       $ + 4H
B2:00850E A1C9              AJMP     ?C0068?ASSOCIATION_PLUS
B2:008510 903FEF            MOV      DPTR,#pListOfNodes
B2:008513 12707E            LCALL    ?L?COM00F2
B2:008516 125510            LCALL    ?L?COM000B
B2:008519 7009              JNZ      ?C0071?ASSOCIATION_PLUS
B2:00851B B1E5              ACALL    ?L?COM0456
B2:00851D 12550D            LCALL    ?L?COM000A
B2:008520 7002              JNZ      $ + 4H
B2:008522 A1AF              AJMP     ?C0070?ASSOCIATION_PLUS
B2:008524         ?C0071?ASSOCIATION_PLUS:
B2:008524 903FEF            MOV      DPTR,#pListOfNodes
B2:008527 125522            LCALL    ?L?COM0059
B2:00852A 12DB0C            LCALL    ?L?COM04CB
B2:00852D 51DD              ACALL    ?L?COM0037
B2:00852F FA                MOV      R2,A
B2:008530 121FB3            LCALL    ?C?CLDPTR
B2:008533 B1EB              ACALL    ?L?COM01B9
B2:008535 12D9CB            LCALL    ?L?COM037A
B2:008538 C083              PUSH     DPH
B2:00853A C082              PUSH     DPL
B2:00853C 903994            MOV      DPTR,#indx
B2:00853F E0                MOVX     A,@DPTR
B2:008540 D082              POP      DPL
B2:008542 D083              POP      DPH
B2:008544 B1DD              ACALL    ?L?COM01A1
B2:008546 6F                XRL      A,R7
B2:008547 6002              JZ       $ + 4H
B2:008549 A1C9              AJMP     ?C0068?ASSOCIATION_PLUS
B2:00854B 903FEF            MOV      DPTR,#pListOfNodes
B2:00854E 125522            LCALL    ?L?COM0059
B2:008551 12DB0C            LCALL    ?L?COM04CB
B2:008554 51DD              ACALL    ?L?COM0037
B2:008556 FA                MOV      R2,A
B2:008557 E9                MOV      A,R1
B2:008558 2401              ADD      A,#01H
B2:00855A 125510            LCALL    ?L?COM000B
B2:00855D FF                MOV      R7,A
B2:00855E 547F              ANL      A,#07FH
B2:008560 FE                MOV      R6,A
B2:008561 12D965            LCALL    ?L?COM026A
B2:008564 C083              PUSH     DPH
B2:008566 C082              PUSH     DPL
B2:008568 903FEE            MOV      DPTR,#groupId
B2:00856B E0                MOVX     A,@DPTR
B2:00856C D082              POP      DPL
B2:00856E D083              POP      DPH
B2:008570 B1D7              ACALL    ?L?COM018E
B2:008572 C083              PUSH     DPH
B2:008574 C082              PUSH     DPL
B2:008576 903994            MOV      DPTR,#indx
B2:008579 E0                MOVX     A,@DPTR
B2:00857A D082              POP      DPL
B2:00857C D083              POP      DPH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 519


B2:00857E B1DD              ACALL    ?L?COM01A1
B2:008580 547F              ANL      A,#07FH
B2:008582 6E                XRL      A,R6
B2:008583 7044              JNZ      ?C0068?ASSOCIATION_PLUS
B2:008585 127151            LCALL    ?L?COM02C6
B2:008588 FF                MOV      R7,A
B2:008589 12D965            LCALL    ?L?COM026A
B2:00858C C083              PUSH     DPH
B2:00858E C082              PUSH     DPL
B2:008590 903FEE            MOV      DPTR,#groupId
B2:008593 E0                MOVX     A,@DPTR
B2:008594 D082              POP      DPL
B2:008596 D083              POP      DPH
B2:008598 B1D7              ACALL    ?L?COM018E
B2:00859A C083              PUSH     DPH
B2:00859C C082              PUSH     DPL
B2:00859E 903994            MOV      DPTR,#indx
B2:0085A1 E0                MOVX     A,@DPTR
B2:0085A2 D082              POP      DPL
B2:0085A4 D083              POP      DPH
B2:0085A6 B1DD              ACALL    ?L?COM01A1
B2:0085A8 FE                MOV      R6,A
B2:0085A9 127152            LCALL    ?L?COM02C7
B2:0085AC 6F                XRL      A,R7
B2:0085AD 701A              JNZ      ?C0068?ASSOCIATION_PLUS
B2:0085AF         ?C0070?ASSOCIATION_PLUS:
  367:           ((0 == pListOfNodes->noOfNodes && 0 == pListOfNodes->noOfMulchanNodes) ||
  368:               ((groups[ep][groupId-1].subGrp[indx].node.nodeId == pListOfNodes->pMulChanNodeId[i].nodeId) &&
  369:                   (groups[ep][groupId-1].subGrp[indx].node.endpoint == pListOfNodes->pMulChanNodeId[i].endpoint) 
>> &&
  370:                   (groups[ep][groupId-1].subGrp[indx].node.BitAddress == pListOfNodes->pMulChanNodeId[i].BitAddre
>> ss))))
  371:       {
  372:         memset((uint8_t*)&groups[ep][groupId-1].subGrp[indx], 0, sizeof(MULTICHAN_NODE_ID));
B2:0085AF 51B8              ACALL    ?L?COM0033
B2:0085B1 FA                MOV      R2,A
B2:0085B2 7D04              MOV      R5,#04H
B2:0085B4 E4                CLR      A
B2:0085B5 FF                MOV      R7,A
B2:0085B6 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
  373:         if (0 < pListOfNodes->noOfMulchanNodes)
B2:0085B9 B1E5              ACALL    ?L?COM0456
B2:0085BB 12550D            LCALL    ?L?COM000A
B2:0085BE FF                MOV      R7,A
B2:0085BF E4                CLR      A
B2:0085C0 C3                CLR      C
B2:0085C1 9F                SUBB     A,R7
B2:0085C2 5005              JNC      ?C0068?ASSOCIATION_PLUS
  374:         {
  375:           ReorderGroupAfterRemove(groupId-1, ep, indx);
B2:0085C4 12C218            LCALL    ?L?COM036E
  376:           break;
B2:0085C7 8005              SJMP     ?C0065?ASSOCIATION_PLUS
  377:         }
  378:       }
  379:     }
B2:0085C9         ?C0068?ASSOCIATION_PLUS:
B2:0085C9 12DB6A            LCALL    ?L?COM0535
B2:0085CC 81ED              AJMP     ?C0066?ASSOCIATION_PLUS
  380:   }
B2:0085CE         ?C0065?ASSOCIATION_PLUS:
B2:0085CE 903FF2            MOV      DPTR,#i
B2:0085D1 E0                MOVX     A,@DPTR
B2:0085D2 04                INC      A
B2:0085D3 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 520


B2:0085D4 81E1              AJMP     ?C0063?ASSOCIATION_PLUS
  381: }
B2:0085D6         ?C0060?ASSOCIATION_PLUS:
B2:0085D6 22                RET      
----- FUNCTION _RemoveAssociationsFromGroup (END) -------


----- FUNCTION ?L?COM018E (BEGIN) -----
B2:0085D7 75F014            MOV      B,#014H
B2:0085DA 02257D            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM018E (END) -------


----- FUNCTION ?L?COM01A1 (BEGIN) -----
B2:0085DD 75F004            MOV      B,#04H
B2:0085E0 12257D            LCALL    ?C?OFFXADD
B2:0085E3 E0                MOVX     A,@DPTR
B2:0085E4 22                RET      
----- FUNCTION ?L?COM01A1 (END) -------


----- FUNCTION ?L?COM0456 (BEGIN) -----
B2:0085E5 903FEF            MOV      DPTR,#pListOfNodes
B2:0085E8 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0456 (END) -------


----- FUNCTION ?L?COM01B9 (BEGIN) -----
B2:0085EB FF                MOV      R7,A
B2:0085EC EE                MOV      A,R6
B2:0085ED         ?L?COM01BA:
B2:0085ED 75F014            MOV      B,#014H
B2:0085F0 A4                MUL      AB
B2:0085F1 246B              ADD      A,#LOW groups-014H
B2:0085F3 F582              MOV      DPL,A
B2:0085F5 E4                CLR      A
B2:0085F6 3439              ADDC     A,#HIGH groups-014H
B2:0085F8 F583              MOV      DPH,A
B2:0085FA 22                RET      
----- FUNCTION ?L?COM01B9 (END) -------


----- FUNCTION ?L?COM04FE (BEGIN) -----
B2:0085FB 9041BF            MOV      DPTR,#pNode
B2:0085FE 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04FE (END) -------


----- FUNCTION SendTestReport (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
   87: SendTestReport(void)
   88: {
   89:   ZW_APPLICATION_TX_BUFFER *pTxBuf = GetRequestBuffer(NULL);
   90:   /*Check pTxBuf is free*/
B2:008601 E4                CLR      A
B2:008602 FF                MOV      R7,A
B2:008603 FE                MOV      R6,A
B2:008604 12B6AD            LCALL    _GetRequestBuffer
B2:008607 903CD1            MOV      DPTR,#pTxBuf
B2:00860A 1225A9            LCALL    ?C?PSTXDATA
   91:   if (NON_NULL(pTxBuf))
B2:00860D E9                MOV      A,R1
B2:00860E 4A                ORL      A,R2
B2:00860F 6077              JZ       ?C0003?COMMANDCLASSPOWERLEVEL
   92:   {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 521


   93:     MULTICHAN_NODE_ID masterNode;
   94:     TRANSMIT_OPTIONS_TYPE_SINGLE_EX txOptionsEx;
   95: 
   96:     masterNode.node.nodeId = testSourceNodeID;
B2:008611 903DD8            MOV      DPTR,#testSourceNodeID
B2:008614 E0                MOVX     A,@DPTR
B2:008615 903CD4            MOV      DPTR,#masterNode
B2:008618 12D77D            LCALL    ?L?COM049C
B2:00861B 12A0DE            LCALL    ?L?COM0296
B2:00861E 903CD7            MOV      DPTR,#masterNode+03H
B2:008621 EF                MOV      A,R7
B2:008622 F0                MOVX     @DPTR,A
   97:     masterNode.node.endpoint = 0;
   98:     masterNode.node.BitAddress = 0;
   99:     masterNode.nodeInfo.BitMultiChannelEncap = 0;
  100:     masterNode.nodeInfo.security = GetHighestSecureLevel(ZW_GetSecurityKeys());
  101:     txOptionsEx.txOptions = ZWAVE_PLUS_TX_OPTIONS;
B2:008623 A3                INC      DPTR
B2:008624 7425              MOV      A,#025H
B2:008626 F0                MOVX     @DPTR,A
  102:     txOptionsEx.sourceEndpoint = 0;
B2:008627 E4                CLR      A
B2:008628 903CDA            MOV      DPTR,#txOptionsEx+02H
B2:00862B F0                MOVX     @DPTR,A
  103:     txOptionsEx.pDestNode = &masterNode;
B2:00862C 7B01              MOV      R3,#01H
B2:00862E 7A3C              MOV      R2,#HIGH masterNode
B2:008630 79D4              MOV      R1,#LOW masterNode
B2:008632 A3                INC      DPTR
B2:008633 1225A9            LCALL    ?C?PSTXDATA
  104: 
  105:     pTxBuf->ZW_PowerlevelTestNodeReportFrame.cmdClass = COMMAND_CLASS_POWERLEVEL;
B2:008636 12DB43            LCALL    ?L?COM050E
B2:008639 7473              MOV      A,#073H
B2:00863B 122072            LCALL    ?C?CSTPTR
  106:     pTxBuf->ZW_PowerlevelTestNodeReportFrame.cmd = POWERLEVEL_TEST_NODE_REPORT;
B2:00863E 903CD1            MOV      DPTR,#pTxBuf
B2:008641 12B17A            LCALL    ?L?COM0054
B2:008644 12DB01            LCALL    ?L?COM04C9
B2:008647 903CD1            MOV      DPTR,#pTxBuf
B2:00864A 129A66            LCALL    ?L?COM008C
B2:00864D 129A76            LCALL    ?L?COM0019
  107:     pTxBuf->ZW_PowerlevelTestNodeReportFrame.testNodeid = testNodeID;
  108:     pTxBuf->ZW_PowerlevelTestNodeReportFrame.statusOfOperation = testState;
B2:008650 903DD7            MOV      DPTR,#testState
B2:008653 E0                MOVX     A,@DPTR
B2:008654 FF                MOV      R7,A
B2:008655 903CD1            MOV      DPTR,#pTxBuf
B2:008658 129A70            LCALL    ?L?COM0018
  109:     pTxBuf->ZW_PowerlevelTestNodeReportFrame.testFrameCount1 =
  110:         (uint8_t)(testFrameSuccessCount >> 8);
B2:00865B 12D90E            LCALL    ?L?COM0183
B2:00865E FF                MOV      R7,A
B2:00865F 12DB43            LCALL    ?L?COM050E
B2:008662 E9                MOV      A,R1
B2:008663 2404              ADD      A,#04H
B2:008665 129A76            LCALL    ?L?COM0019
  111:     pTxBuf->ZW_PowerlevelTestNodeReportFrame.testFrameCount2 = (uint8_t)testFrameSuccessCount;
B2:008668 903CD1            MOV      DPTR,#pTxBuf
B2:00866B 12D903            LCALL    ?L?COM0120
B2:00866E ED                MOV      A,R5
B2:00866F 122072            LCALL    ?C?CSTPTR
  112: 
  113:     if (ZW_TX_IN_PROGRESS != Transport_SendRequestEP(
  114:         (uint8_t*)pTxBuf,
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 522


B2:008672 7B01              MOV      R3,#01H
B2:008674 7A3C              MOV      R2,#HIGH txOptionsEx
B2:008676 79D8              MOV      R1,#LOW txOptionsEx
B2:008678 12CD44            LCALL    ?L?COM0214
B2:00867B 12DB43            LCALL    ?L?COM050E
B2:00867E 7D06              MOV      R5,#06H
B2:008680 12B452            LCALL    ?L?COM03E4
B2:008683 6003              JZ       ?C0003?COMMANDCLASSPOWERLEVEL
  115:         sizeof(pTxBuf->ZW_PowerlevelTestNodeReportFrame),
  116:         &txOptionsEx,
  117:         ZCB_RequestJobStatus))
  118:     {
  119:       /*Free transmit-buffer mutex*/
  120:       FreeRequestBuffer();
B2:008685 12CCF6            LCALL    FreeRequestBuffer
  121:     }
  122:   }
  123:   return;
  124: }
B2:008688         ?C0003?COMMANDCLASSPOWERLEVEL:
B2:008688 22                RET      
----- FUNCTION SendTestReport (END) -------


----- FUNCTION _NVM_Action (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  388: NVM_Action(NVM_ACTION action)
  389: {
B2:008689 90413E            MOV      DPTR,#action
B2:00868C EF                MOV      A,R7
B2:00868D F0                MOVX     @DPTR,A
  390:   BYTE i,j,k;
  391:   BYTE transportCap;
  392: 
  393:   ZW_DEBUG_ASSOCIATION_SEND_NL();
  394:   ZW_DEBUG_ASSOCIATION_SEND_STR("NVM_Action groups");
  395:   if(READ_DATA == action){    ZW_DEBUG_ASSOCIATION_SEND_STR(" read ");}
B2:00868E         ?C0073?ASSOCIATION_PLUS:
  396:   else{ ZW_DEBUG_ASSOCIATION_SEND_STR(" write ");}
B2:00868E         ?C0074?ASSOCIATION_PLUS:
  397: 
  398: 
  399:   for(i = 0; i < MAX_ASSOCIATION_GROUPS; i++)
B2:00868E E4                CLR      A
B2:00868F 90413F            MOV      DPTR,#i
B2:008692 F0                MOVX     @DPTR,A
B2:008693         ?C0075?ASSOCIATION_PLUS:
  400:   {
  401:     ZW_DEBUG_ASSOCIATION_SEND_NL();
  402:     ZW_DEBUG_ASSOCIATION_SEND_STR("groupeId ");
  403:     ZW_DEBUG_ASSOCIATION_SEND_NUM(i + 1);
  404:     ZW_DEBUG_ASSOCIATION_SEND_NL();
  405:     for(j = 0; j < NUMBER_OF_ENDPOINTS + 1; j++)
B2:008693 E4                CLR      A
B2:008694 904140            MOV      DPTR,#j
B2:008697 F0                MOVX     @DPTR,A
B2:008698         ?C0078?ASSOCIATION_PLUS:
  406:     {
  407:       ZW_DEBUG_ASSOCIATION_SEND_STR("[ep");
  408:       ZW_DEBUG_ASSOCIATION_SEND_NUM(j);
  409:       ZW_DEBUG_ASSOCIATION_SEND_STR("] ");
  410:       for(k = 0; k < MAX_ASSOCIATION_IN_GROUP; k++)
B2:008698 E4                CLR      A
B2:008699 904141            MOV      DPTR,#k
B2:00869C F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 523


B2:00869D         ?C0081?ASSOCIATION_PLUS:
B2:00869D 904141            MOV      DPTR,#k
B2:0086A0 E0                MOVX     A,@DPTR
B2:0086A1 FD                MOV      R5,A
B2:0086A2 C3                CLR      C
B2:0086A3 9405              SUBB     A,#05H
B2:0086A5 4003              JC       $ + 5H
B2:0086A7 0288B7            LJMP     ?C0080?ASSOCIATION_PLUS
  411:       {
  412:         if(READ_DATA == action)
B2:0086AA 90413E            MOV      DPTR,#action
B2:0086AD E0                MOVX     A,@DPTR
B2:0086AE 6002              JZ       $ + 4H
B2:0086B0 E1A9              AJMP     ?C0084?ASSOCIATION_PLUS
  413:         {
  414:           //MemoryGetByte((WORD)&nvmApplDescriptor.EEOFFSET_ASSOCIATION_MAGIC_far)
  415:           groups[j][i].subGrp[k].node.nodeId =   MemoryGetByte((WORD)&EEOFFSET_ASSOCIATION_START_far[MAX_ASSOCIAT
>> ION_IN_GROUP*(NUMBER_OF_ENDPOINTS + 1)*i + MAX_ASSOCIATION_IN_GROUP*j + k ]);
B2:0086B2 12D8DF            LCALL    ?L?COM00A7
B2:0086B5 12DB95            LCALL    ?L?COM05C9
B2:0086B8 12D9AE            LCALL    ?L?COM032D
B2:0086BB 904140            MOV      DPTR,#j
B2:0086BE E0                MOVX     A,@DPTR
B2:0086BF FE                MOV      R6,A
B2:0086C0 12C2B4            LCALL    ?L?COM03A6
B2:0086C3 12DBA5            LCALL    ?L?COM05D3
B2:0086C6 C083              PUSH     DPH
B2:0086C8 C082              PUSH     DPL
B2:0086CA 90413F            MOV      DPTR,#i
B2:0086CD E0                MOVX     A,@DPTR
B2:0086CE D082              POP      DPL
B2:0086D0 D083              POP      DPH
B2:0086D2 B1D7              ACALL    ?L?COM018E
B2:0086D4 C083              PUSH     DPH
B2:0086D6 C082              PUSH     DPL
B2:0086D8 904141            MOV      DPTR,#k
B2:0086DB E0                MOVX     A,@DPTR
B2:0086DC FD                MOV      R5,A
B2:0086DD D082              POP      DPL
B2:0086DF D083              POP      DPH
B2:0086E1 12DA5F            LCALL    ?L?COM040D
  416:           {
  417:             BYTE ep = MemoryGetByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_START_far[MAX_ASSOCIATION_IN_GROUP*(NUMB
>> ER_OF_ENDPOINTS + 1)*i + MAX_ASSOCIATION_IN_GROUP*j + k ]);
B2:0086E4 EE                MOV      A,R6
B2:0086E5 12D8E3            LCALL    ?L?COM00A8
B2:0086E8 12DBBB            LCALL    ?L?COM05E5
B2:0086EB 12D9AE            LCALL    ?L?COM032D
B2:0086EE 904143            MOV      DPTR,#ep
B2:0086F1 EF                MOV      A,R7
B2:0086F2 F0                MOVX     @DPTR,A
  418:             groups[j][i].subGrp[k].node.endpoint = 0x7f & ep;
B2:0086F3 E0                MOVX     A,@DPTR
B2:0086F4 FF                MOV      R7,A
B2:0086F5 547F              ANL      A,#07FH
B2:0086F7 FE                MOV      R6,A
B2:0086F8 904140            MOV      DPTR,#j
B2:0086FB E0                MOVX     A,@DPTR
B2:0086FC 12D99A            LCALL    ?L?COM0302
B2:0086FF C083              PUSH     DPH
B2:008701 C082              PUSH     DPL
B2:008703 90413F            MOV      DPTR,#i
B2:008706 E0                MOVX     A,@DPTR
B2:008707 D082              POP      DPL
B2:008709 D083              POP      DPH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 524


B2:00870B B1D7              ACALL    ?L?COM018E
B2:00870D C083              PUSH     DPH
B2:00870F C082              PUSH     DPL
B2:008711 904141            MOV      DPTR,#k
B2:008714 E0                MOVX     A,@DPTR
B2:008715 D082              POP      DPL
B2:008717 D083              POP      DPH
B2:008719 B1DD              ACALL    ?L?COM01A1
B2:00871B 5480              ANL      A,#080H
B2:00871D 4E                ORL      A,R6
B2:00871E F0                MOVX     @DPTR,A
  419:             groups[j][i].subGrp[k].node.BitAddress = ((0x80 & ep) == 0) ? 0 : 1;
B2:00871F EF                MOV      A,R7
B2:008720 7F01              MOV      R7,#01H
B2:008722 20E702            JB       ACC.7,?C0085?ASSOCIATION_PLUS
B2:008725 7F00              MOV      R7,#00H
B2:008727         ?C0085?ASSOCIATION_PLUS:
B2:008727         ?C0086?ASSOCIATION_PLUS:
B2:008727 EF                MOV      A,R7
B2:008728 12B61B            LCALL    ?L?COM01AA
B2:00872B FF                MOV      R7,A
B2:00872C 904140            MOV      DPTR,#j
B2:00872F E0                MOVX     A,@DPTR
B2:008730 FE                MOV      R6,A
B2:008731 12D99A            LCALL    ?L?COM0302
B2:008734 C083              PUSH     DPH
B2:008736 C082              PUSH     DPL
B2:008738 90413F            MOV      DPTR,#i
B2:00873B E0                MOVX     A,@DPTR
B2:00873C D082              POP      DPL
B2:00873E D083              POP      DPH
B2:008740 B1D7              ACALL    ?L?COM018E
B2:008742 C083              PUSH     DPH
B2:008744 C082              PUSH     DPL
B2:008746 904141            MOV      DPTR,#k
B2:008749 E0                MOVX     A,@DPTR
B2:00874A FD                MOV      R5,A
B2:00874B D082              POP      DPL
B2:00874D D083              POP      DPH
B2:00874F B1DD              ACALL    ?L?COM01A1
B2:008751 547F              ANL      A,#07FH
B2:008753 4F                ORL      A,R7
B2:008754 F0                MOVX     @DPTR,A
  420:           }
  421: 
  422:           transportCap = MemoryGetByte((WORD)&EEOFFSET_TRANSPORT_CAPABILITIES_START_far[MAX_ASSOCIATION_IN_GROUP*
>> (NUMBER_OF_ENDPOINTS + 1)*i + MAX_ASSOCIATION_IN_GROUP*j + k ]);
B2:008755 EE                MOV      A,R6
B2:008756 12D8E3            LCALL    ?L?COM00A8
B2:008759 FE                MOV      R6,A
B2:00875A 12D9A8            LCALL    ?L?COM032C
B2:00875D 904142            MOV      DPTR,#transportCap
B2:008760 EF                MOV      A,R7
B2:008761 F0                MOVX     @DPTR,A
  423:           groups[j][i].subGrp[k].nodeInfo.BitMultiChannelEncap = (*((EEOFFSET_TRANSPORT_CAPABILITIES_STRUCT*)&tra
>> nsportCap)).BitMultiChannelEncap;
B2:008762 E0                MOVX     A,@DPTR
B2:008763 C4                SWAP     A
B2:008764 13                RRC      A
B2:008765 5401              ANL      A,#01H
B2:008767 FF                MOV      R7,A
B2:008768 904140            MOV      DPTR,#j
B2:00876B E0                MOVX     A,@DPTR
B2:00876C FE                MOV      R6,A
B2:00876D 12DA91            LCALL    ?L?COM042A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 525


B2:008770 C083              PUSH     DPH
B2:008772 C082              PUSH     DPL
B2:008774 90413F            MOV      DPTR,#i
B2:008777 E0                MOVX     A,@DPTR
B2:008778 FD                MOV      R5,A
B2:008779 D082              POP      DPL
B2:00877B D083              POP      DPH
B2:00877D B1D7              ACALL    ?L?COM018E
B2:00877F C083              PUSH     DPH
B2:008781 C082              PUSH     DPL
B2:008783 904141            MOV      DPTR,#k
B2:008786 E0                MOVX     A,@DPTR
B2:008787 FC                MOV      R4,A
B2:008788 D082              POP      DPL
B2:00878A D083              POP      DPH
B2:00878C 12DA5F            LCALL    ?L?COM040D
  424:           groups[j][i].subGrp[k].nodeInfo.security =  (*((EEOFFSET_TRANSPORT_CAPABILITIES_STRUCT*)&transportCap))
>> .security;
B2:00878F 904142            MOV      DPTR,#transportCap
B2:008792 E0                MOVX     A,@DPTR
B2:008793 540F              ANL      A,#0FH
B2:008795 FF                MOV      R7,A
B2:008796 EE                MOV      A,R6
B2:008797 12DA83            LCALL    ?L?COM0429
B2:00879A 12D9CB            LCALL    ?L?COM037A
B2:00879D 75F004            MOV      B,#04H
B2:0087A0 EC                MOV      A,R4
B2:0087A1 12257D            LCALL    ?C?OFFXADD
B2:0087A4 EF                MOV      A,R7
B2:0087A5 F0                MOVX     @DPTR,A
  425:           ZW_DEBUG_ASSOCIATION_SEND_NUM( groups[j][i].subGrp[k].node.nodeId );
  426:           ZW_DEBUG_ASSOCIATION_SEND_BYTE('.');
  427:           ZW_DEBUG_ASSOCIATION_SEND_NUM( groups[j][i].subGrp[k].node.endpoint );
  428:           ZW_DEBUG_ASSOCIATION_SEND_BYTE(' ');
  429:         }
B2:0087A6 0288AE            LJMP     ?C0083?ASSOCIATION_PLUS
B2:0087A9         ?C0084?ASSOCIATION_PLUS:
  430:         else
  431:         {
  432:           MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_START_far[MAX_ASSOCIATION_IN_GROUP*(NUMBER_OF_ENDPOINTS + 1)*
>> i + MAX_ASSOCIATION_IN_GROUP*j + k ],
B2:0087A9 904140            MOV      DPTR,#j
B2:0087AC E0                MOVX     A,@DPTR
B2:0087AD 75F005            MOV      B,#05H
B2:0087B0 A4                MUL      AB
B2:0087B1 FD                MOV      R5,A
B2:0087B2 ACF0              MOV      R4,B
B2:0087B4 90413F            MOV      DPTR,#i
B2:0087B7 E0                MOVX     A,@DPTR
B2:0087B8 75F005            MOV      B,#05H
B2:0087BB A4                MUL      AB
B2:0087BC 2D                ADD      A,R5
B2:0087BD FF                MOV      R7,A
B2:0087BE E5F0              MOV      A,B
B2:0087C0 3C                ADDC     A,R4
B2:0087C1 FE                MOV      R6,A
B2:0087C2 904141            MOV      DPTR,#k
B2:0087C5 E0                MOVX     A,@DPTR
B2:0087C6 7C00              MOV      R4,#00H
B2:0087C8 2F                ADD      A,R7
B2:0087C9 FF                MOV      R7,A
B2:0087CA EC                MOV      A,R4
B2:0087CB 3E                ADDC     A,R6
B2:0087CC 12DB95            LCALL    ?L?COM05C9
B2:0087CF 3E                ADDC     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 526


B2:0087D0 FE                MOV      R6,A
B2:0087D1 AF01              MOV      R7,AR1
B2:0087D3 904140            MOV      DPTR,#j
B2:0087D6 12C2B3            LCALL    ?L?COM03A5
B2:0087D9 12DBA5            LCALL    ?L?COM05D3
B2:0087DC C083              PUSH     DPH
B2:0087DE C082              PUSH     DPL
B2:0087E0 90413F            MOV      DPTR,#i
B2:0087E3 E0                MOVX     A,@DPTR
B2:0087E4 D082              POP      DPL
B2:0087E6 D083              POP      DPH
B2:0087E8 B1D7              ACALL    ?L?COM018E
B2:0087EA C083              PUSH     DPH
B2:0087EC C082              PUSH     DPL
B2:0087EE 904141            MOV      DPTR,#k
B2:0087F1 E0                MOVX     A,@DPTR
B2:0087F2 D082              POP      DPL
B2:0087F4 D083              POP      DPH
B2:0087F6 B1DD              ACALL    ?L?COM01A1
B2:0087F8 FD                MOV      R5,A
B2:0087F9 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
  433:                         groups[j][i].subGrp[k].node.nodeId);
  434:           {
  435:             BYTE node = groups[j][i].subGrp[k].node.endpoint | (groups[j][i].subGrp[k].node.BitAddress << 7);
B2:0087FC 904140            MOV      DPTR,#j
B2:0087FF E0                MOVX     A,@DPTR
B2:008800 FB                MOV      R3,A
B2:008801 12D99A            LCALL    ?L?COM0302
B2:008804 C083              PUSH     DPH
B2:008806 C082              PUSH     DPL
B2:008808 90413F            MOV      DPTR,#i
B2:00880B E0                MOVX     A,@DPTR
B2:00880C D082              POP      DPL
B2:00880E D083              POP      DPH
B2:008810 1285D7            LCALL    ?L?COM018E
B2:008813 C083              PUSH     DPH
B2:008815 C082              PUSH     DPL
B2:008817 904141            MOV      DPTR,#k
B2:00881A E0                MOVX     A,@DPTR
B2:00881B FD                MOV      R5,A
B2:00881C D082              POP      DPL
B2:00881E D083              POP      DPH
B2:008820 1285DD            LCALL    ?L?COM01A1
B2:008823 FE                MOV      R6,A
B2:008824 12B617            LCALL    ?L?COM01A9
B2:008827 FC                MOV      R4,A
B2:008828 EE                MOV      A,R6
B2:008829 547F              ANL      A,#07FH
B2:00882B 4C                ORL      A,R4
B2:00882C 904143            MOV      DPTR,#node
B2:00882F F0                MOVX     @DPTR,A
  436:             MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_START_far[MAX_ASSOCIATION_IN_GROUP*(NUMBER_OF_ENDP
>> OINTS + 1)*i + MAX_ASSOCIATION_IN_GROUP*j + k ],
B2:008830 EB                MOV      A,R3
B2:008831 12D8E3            LCALL    ?L?COM00A8
B2:008834 12DBBB            LCALL    ?L?COM05E5
B2:008837 904143            MOV      DPTR,#node
B2:00883A 12DA56            LCALL    ?L?COM03E9
  437:                         node);
  438:           }
  439:           /**
  440:            * To be independent of nodeInfo bit-structure is each bit-group saved separately. This cost in NVM siz
>> e!!!
  441:            */
  442:           transportCap = 0;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 527


B2:00883D E4                CLR      A
B2:00883E 904142            MOV      DPTR,#transportCap
B2:008841 F0                MOVX     @DPTR,A
  443:           (*((EEOFFSET_TRANSPORT_CAPABILITIES_STRUCT*)&transportCap)).BitMultiChannelEncap = groups[j][i].subGrp[
>> k].nodeInfo.BitMultiChannelEncap;
B2:008842 904140            MOV      DPTR,#j
B2:008845 E0                MOVX     A,@DPTR
B2:008846 FB                MOV      R3,A
B2:008847 12DA91            LCALL    ?L?COM042A
B2:00884A C083              PUSH     DPH
B2:00884C C082              PUSH     DPL
B2:00884E 90413F            MOV      DPTR,#i
B2:008851 E0                MOVX     A,@DPTR
B2:008852 FE                MOV      R6,A
B2:008853 D082              POP      DPL
B2:008855 D083              POP      DPH
B2:008857 1285D7            LCALL    ?L?COM018E
B2:00885A C083              PUSH     DPH
B2:00885C C082              PUSH     DPL
B2:00885E 904141            MOV      DPTR,#k
B2:008861 E0                MOVX     A,@DPTR
B2:008862 D082              POP      DPL
B2:008864 D083              POP      DPH
B2:008866 1285DD            LCALL    ?L?COM01A1
B2:008869 5401              ANL      A,#01H
B2:00886B C4                SWAP     A
B2:00886C 33                RLC      A
B2:00886D 54E0              ANL      A,#0E0H
B2:00886F FD                MOV      R5,A
B2:008870 904142            MOV      DPTR,#transportCap
B2:008873 E0                MOVX     A,@DPTR
B2:008874 54DF              ANL      A,#0DFH
B2:008876 4D                ORL      A,R5
B2:008877 F0                MOVX     @DPTR,A
  444:           (*((EEOFFSET_TRANSPORT_CAPABILITIES_STRUCT*)&transportCap)).security             = groups[j][i].subGrp[
>> k].nodeInfo.security;
B2:008878 EB                MOV      A,R3
B2:008879 12DA83            LCALL    ?L?COM0429
B2:00887C 75F014            MOV      B,#014H
B2:00887F EE                MOV      A,R6
B2:008880 12257D            LCALL    ?C?OFFXADD
B2:008883 C083              PUSH     DPH
B2:008885 C082              PUSH     DPL
B2:008887 904141            MOV      DPTR,#k
B2:00888A E0                MOVX     A,@DPTR
B2:00888B FD                MOV      R5,A
B2:00888C D082              POP      DPL
B2:00888E D083              POP      DPH
B2:008890 1285DD            LCALL    ?L?COM01A1
B2:008893 540F              ANL      A,#0FH
B2:008895 FF                MOV      R7,A
B2:008896 904142            MOV      DPTR,#transportCap
B2:008899 E0                MOVX     A,@DPTR
B2:00889A 54F0              ANL      A,#0F0H
B2:00889C 4F                ORL      A,R7
B2:00889D F0                MOVX     @DPTR,A
  445: 
  446:           MemoryPutByte((WORD)&EEOFFSET_TRANSPORT_CAPABILITIES_START_far[MAX_ASSOCIATION_IN_GROUP*(NUMBER_OF_ENDP
>> OINTS + 1)*i + MAX_ASSOCIATION_IN_GROUP*j + k ], transportCap);
B2:00889E 12D8DF            LCALL    ?L?COM00A7
B2:0088A1 FE                MOV      R6,A
B2:0088A2 74F2              MOV      A,#LOW EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:0088A4 2F                ADD      A,R7
B2:0088A5 F9                MOV      R1,A
B2:0088A6 7413              MOV      A,#HIGH EEOFFSET_TRANSPORT_CAPABILITIES_START_far
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 528


B2:0088A8 904142            MOV      DPTR,#transportCap
B2:0088AB 12DA56            LCALL    ?L?COM03E9
  447: 
  448:           ZW_DEBUG_ASSOCIATION_SEND_NUM( groups[j][i].subGrp[k].node.nodeId );
  449:           ZW_DEBUG_ASSOCIATION_SEND_BYTE('.');
  450:           ZW_DEBUG_ASSOCIATION_SEND_NUM( groups[j][i].subGrp[k].node.endpoint );
  451:           ZW_DEBUG_ASSOCIATION_SEND_BYTE(' ');
  452:         }
  453:       }
B2:0088AE         ?C0083?ASSOCIATION_PLUS:
B2:0088AE 904141            MOV      DPTR,#k
B2:0088B1 E0                MOVX     A,@DPTR
B2:0088B2 04                INC      A
B2:0088B3 F0                MOVX     @DPTR,A
B2:0088B4 02869D            LJMP     ?C0081?ASSOCIATION_PLUS
  454:       ZW_DEBUG_ASSOCIATION_SEND_NL();
  455:     }
B2:0088B7         ?C0080?ASSOCIATION_PLUS:
B2:0088B7 904140            MOV      DPTR,#j
B2:0088BA 12DBDB            LCALL    ?L?COM05F8
B2:0088BD 5003              JNC      $ + 5H
B2:0088BF 028698            LJMP     ?C0078?ASSOCIATION_PLUS
  456:   }
B2:0088C2         ?C0077?ASSOCIATION_PLUS:
B2:0088C2 90413F            MOV      DPTR,#i
B2:0088C5 12DBDB            LCALL    ?L?COM05F8
B2:0088C8 5003              JNC      $ + 5H
B2:0088CA 028693            LJMP     ?C0075?ASSOCIATION_PLUS
  457: }
B2:0088CD 22                RET      
----- FUNCTION _NVM_Action (END) -------


----- FUNCTION _ZCB_AppTestInterface (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  308: PCB(ZCB_AppTestInterface)(char channel, char * pString)
  309: {
B2:0088CE 903B5B            MOV      DPTR,#pString
B2:0088D1 1225A9            LCALL    ?C?PSTXDATA
  310:   uint8_t stringLength;
  311:   KEY_NAME_T keyName = NUMBER_OF_KEYS; /**<Not legal key number*/
B2:0088D4 903B5F            MOV      DPTR,#keyName
B2:0088D7 7406              MOV      A,#06H
B2:0088D9 F0                MOVX     @DPTR,A
  312:   KEY_EVENT_T keyEvent = NUMBER_OF_KEY_EVENTS; /**<Not legal key event*/
B2:0088DA A3                INC      DPTR
B2:0088DB 14                DEC      A
B2:0088DC F0                MOVX     @DPTR,A
  313:   BYTE holdCount = 1;
B2:0088DD A3                INC      DPTR
B2:0088DE 7401              MOV      A,#01H
B2:0088E0 F0                MOVX     @DPTR,A
  314:   UNUSED(channel);
  315:   //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  316:   //ZW_DEBUG_IO_ZDP03A_SEND_BYTE(channel);
  317:   //ZW_DEBUG_IO_ZDP03A_SEND_STR(": ");
  318:   //ZW_DEBUG_IO_ZDP03A_SEND_STR(pString);
  319:   //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  320: 
  321:   stringLength = ZW_strlen((BYTE *)pString);
B2:0088E1 12C159            LCALL    _ZW_strlen
B2:0088E4 903B5E            MOV      DPTR,#stringLength
B2:0088E7 EF                MOV      A,R7
B2:0088E8 F0                MOVX     @DPTR,A
  322: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 529


  323:   /**< Check legal key*/
  324:   if ('k' == pString[0])
B2:0088E9 903B5B            MOV      DPTR,#pString
B2:0088EC 12AE26            LCALL    ?L?COM0049
B2:0088EF 646B              XRL      A,#06BH
B2:0088F1 6002              JZ       $ + 4H
B2:0088F3 21AE              AJMP     ?C0031?IO_ZDP03A
  325:   {
  326:     /**< Find key name*/
  327:     switch (pString[1])
B2:0088F5 12B3A2            LCALL    ?L?COM0182
B2:0088F8 24CE              ADD      A,#0CEH
B2:0088FA 6019              JZ       ?C0034?IO_ZDP03A
B2:0088FC 14                DEC      A
B2:0088FD 601E              JZ       ?C0035?IO_ZDP03A
B2:0088FF 14                DEC      A
B2:008900 6023              JZ       ?C0036?IO_ZDP03A
B2:008902 14                DEC      A
B2:008903 6028              JZ       ?C0037?IO_ZDP03A
B2:008905 14                DEC      A
B2:008906 602D              JZ       ?C0038?IO_ZDP03A
B2:008908 2405              ADD      A,#05H
B2:00890A 6002              JZ       $ + 4H
B2:00890C 61A5              AJMP     ?C0040?IO_ZDP03A
  328:     {
  329:       case '1':
B2:00890E         ?C0033?IO_ZDP03A:
  330:         keyName = KEY01;
B2:00890E E4                CLR      A
B2:00890F 903B5F            MOV      DPTR,#keyName
B2:008912 F0                MOVX     @DPTR,A
  331:         break;
B2:008913 8026              SJMP     ?C0032?IO_ZDP03A
  332:       case '2':
B2:008915         ?C0034?IO_ZDP03A:
  333:         keyName = KEY02;
B2:008915 903B5F            MOV      DPTR,#keyName
B2:008918 7401              MOV      A,#01H
B2:00891A F0                MOVX     @DPTR,A
  334:         break;
B2:00891B 801E              SJMP     ?C0032?IO_ZDP03A
  335:       case '3':
B2:00891D         ?C0035?IO_ZDP03A:
  336:         keyName = KEY03;
B2:00891D 903B5F            MOV      DPTR,#keyName
B2:008920 7402              MOV      A,#02H
B2:008922 F0                MOVX     @DPTR,A
  337:         break;
B2:008923 8016              SJMP     ?C0032?IO_ZDP03A
  338:       case '4':
B2:008925         ?C0036?IO_ZDP03A:
  339:         keyName = KEY04;
B2:008925 903B5F            MOV      DPTR,#keyName
B2:008928 7403              MOV      A,#03H
B2:00892A F0                MOVX     @DPTR,A
  340:         break;
B2:00892B 800E              SJMP     ?C0032?IO_ZDP03A
  341:       case '5':
B2:00892D         ?C0037?IO_ZDP03A:
  342:         keyName = KEY05;
B2:00892D 903B5F            MOV      DPTR,#keyName
B2:008930 7404              MOV      A,#04H
B2:008932 F0                MOVX     @DPTR,A
  343:         break;
B2:008933 8006              SJMP     ?C0032?IO_ZDP03A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 530


  344:       case '6':
B2:008935         ?C0038?IO_ZDP03A:
  345:         keyName = KEY06;
B2:008935 903B5F            MOV      DPTR,#keyName
B2:008938 7405              MOV      A,#05H
B2:00893A F0                MOVX     @DPTR,A
  346:         break;
  347:       default:
  348:         // Unknown key => Return
  349:         return;
  350:         break;
  351:     }
B2:00893B         ?C0032?IO_ZDP03A:
  352: 
  353:     /**< Find key action (add 2 to see key action)*/
  354:     switch (pString[2])
B2:00893B 903B5B            MOV      DPTR,#pString
B2:00893E F13E              ACALL    ?L?COM0029
B2:008940 2498              ADD      A,#098H
B2:008942 6028              JZ       ?C0045?IO_ZDP03A
B2:008944 24F8              ADD      A,#0F8H
B2:008946 601C              JZ       ?C0044?IO_ZDP03A
B2:008948 24FC              ADD      A,#0FCH
B2:00894A 6042              JZ       ?C0048?IO_ZDP03A
B2:00894C 14                DEC      A
B2:00894D 600D              JZ       ?C0043?IO_ZDP03A
B2:00894F 2411              ADD      A,#011H
B2:008951 6002              JZ       $ + 4H
B2:008953 61A5              AJMP     ?C0040?IO_ZDP03A
  355:     {
  356:       case 'd':
B2:008955         ?C0042?IO_ZDP03A:
  357:         keyEvent = KEY_DOWN;
B2:008955 E4                CLR      A
B2:008956 903B60            MOV      DPTR,#keyEvent
B2:008959 F0                MOVX     @DPTR,A
  358:         break;
B2:00895A 8038              SJMP     ?C0041?IO_ZDP03A
  359:       case 'u':
B2:00895C         ?C0043?IO_ZDP03A:
  360:         keyEvent = KEY_UP;
B2:00895C 903B60            MOV      DPTR,#keyEvent
B2:00895F 7401              MOV      A,#01H
B2:008961 F0                MOVX     @DPTR,A
  361:         break;
B2:008962 8030              SJMP     ?C0041?IO_ZDP03A
  362:       case 'p':
B2:008964         ?C0044?IO_ZDP03A:
  363:         keyEvent = KEY_PRESS;
B2:008964 903B60            MOV      DPTR,#keyEvent
B2:008967 7402              MOV      A,#02H
B2:008969 F0                MOVX     @DPTR,A
  364:         break;
B2:00896A 8028              SJMP     ?C0041?IO_ZDP03A
  365:       case 'h':
B2:00896C         ?C0045?IO_ZDP03A:
  366:         keyEvent = KEY_HOLD;
B2:00896C 903B60            MOV      DPTR,#keyEvent
B2:00896F 7403              MOV      A,#03H
B2:008971 F0                MOVX     @DPTR,A
  367:         if (stringLength > 3)
B2:008972 903B5E            MOV      DPTR,#stringLength
B2:008975 E0                MOVX     A,@DPTR
B2:008976 D3                SETB     C
B2:008977 9403              SUBB     A,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 531


B2:008979 4019              JC       ?C0041?IO_ZDP03A
  368:         {
  369:           // There's a hold value
  370:           if (('1' == pString[3])
B2:00897B 91A5              ACALL    ?L?COM0080
B2:00897D B43114            CJNE     A,#031H,?C0041?IO_ZDP03A
B2:008980 1270EB            LCALL    ?L?COM01E4
B2:008983 B4300E            CJNE     A,#030H,?C0041?IO_ZDP03A
  371:            && ('0' == pString[4]))
  372:           {
  373:             holdCount = 10;
B2:008986 903B61            MOV      DPTR,#holdCount
B2:008989 740A              MOV      A,#0AH
B2:00898B F0                MOVX     @DPTR,A
  374:           }
  375:         }
  376:         break;
B2:00898C 8006              SJMP     ?C0041?IO_ZDP03A
  377:       case 't':
B2:00898E         ?C0048?IO_ZDP03A:
  378:         keyEvent = KEY_TRIPLE_PRESS;
B2:00898E 903B60            MOV      DPTR,#keyEvent
B2:008991 7404              MOV      A,#04H
B2:008993 F0                MOVX     @DPTR,A
  379:         break;
  380:       default:
  381:         // Unknown event => Return.
  382:         return;
  383:         break;
  384:     }
B2:008994         ?C0041?IO_ZDP03A:
  385: 
  386:     if((NUMBER_OF_KEYS != keyName) && (NUMBER_OF_KEY_EVENTS != keyEvent))
B2:008994 903B5F            MOV      DPTR,#keyName
B2:008997 E0                MOVX     A,@DPTR
B2:008998 FF                MOV      R7,A
B2:008999 6406              XRL      A,#06H
B2:00899B 7002              JNZ      $ + 4H
B2:00899D 61A5              AJMP     ?C0040?IO_ZDP03A
B2:00899F A3                INC      DPTR
B2:0089A0 E0                MOVX     A,@DPTR
B2:0089A1 FD                MOV      R5,A
B2:0089A2 6405              XRL      A,#05H
B2:0089A4 7002              JNZ      $ + 4H
B2:0089A6 61A5              AJMP     ?C0040?IO_ZDP03A
  387:     {
  388:       ZCB_KeyAction(keyName, keyEvent, holdCount);
B2:0089A8 A3                INC      DPTR
B2:0089A9 E0                MOVX     A,@DPTR
B2:0089AA FB                MOV      R3,A
B2:0089AB 02BAA9            LJMP     _ZCB_KeyAction
  389:     }
  390:     else
  391:     {
  392:       //ZW_DEBUG_IO_ZDP03A_SEND_STR("key error!");
  393:       //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  394:     }
  395:   }
B2:0089AE         ?C0031?IO_ZDP03A:
  396:   else if ('s' == pString[0] && 'p' == pString[1])
B2:0089AE 903B5B            MOV      DPTR,#pString
B2:0089B1 12AE26            LCALL    ?L?COM0049
B2:0089B4 6473              XRL      A,#073H
B2:0089B6 7024              JNZ      ?C0053?IO_ZDP03A
B2:0089B8 12B3A2            LCALL    ?L?COM0182
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 532


B2:0089BB 6470              XRL      A,#070H
B2:0089BD 701D              JNZ      ?C0053?IO_ZDP03A
  397:   {
  398:     // "a sp XX Y"
  399:     uint8_t pin;
  400:     pin = ((pString[3] - 0x30) << 4) + (pString[4] - 0x30);
B2:0089BF 91A5              ACALL    ?L?COM0080
B2:0089C1 24D0              ADD      A,#0D0H
B2:0089C3 C4                SWAP     A
B2:0089C4 54F0              ANL      A,#0F0H
B2:0089C6 FF                MOV      R7,A
B2:0089C7 1270EB            LCALL    ?L?COM01E4
B2:0089CA 12DB7A            LCALL    ?L?COM058B
  401:     gpio_SetPin(pin, (0x31 == pString[6])?TRUE:FALSE);
B2:0089CD 12B431            LCALL    ?L?COM02ED
B2:0089D0 B43103            CJNE     A,#031H,?C0054?IO_ZDP03A
B2:0089D3 D3                SETB     C
B2:0089D4 8001              SJMP     ?C0055?IO_ZDP03A
B2:0089D6         ?C0054?IO_ZDP03A:
B2:0089D6 C3                CLR      C
B2:0089D7         ?C0055?IO_ZDP03A:
B2:0089D7 9241              MOV      ?_gpio_SetPin?BIT,C
B2:0089D9 02AC50            LJMP     _gpio_SetPin
  402:   }
B2:0089DC         ?C0053?IO_ZDP03A:
  403:   else if ('g' == pString[0] && 'p' == pString[1])
B2:0089DC 903B5B            MOV      DPTR,#pString
B2:0089DF 12AE26            LCALL    ?L?COM0049
B2:0089E2 6467              XRL      A,#067H
B2:0089E4 702D              JNZ      ?C0057?IO_ZDP03A
B2:0089E6 12B3A2            LCALL    ?L?COM0182
B2:0089E9 6470              XRL      A,#070H
B2:0089EB 7026              JNZ      ?C0057?IO_ZDP03A
  404:   {
  405:     uint8_t pin;
  406: 
  407:     //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  408:     //ZW_DEBUG_IO_ZDP03A_SEND_BYTE('G');
  409:     //ZW_DEBUG_IO_ZDP03A_SEND_BYTE('P');
  410: 
  411:     if (5 != stringLength)
B2:0089ED 903B5E            MOV      DPTR,#stringLength
B2:0089F0 E0                MOVX     A,@DPTR
B2:0089F1 6405              XRL      A,#05H
B2:0089F3 6002              JZ       $ + 4H
B2:0089F5 61A5              AJMP     ?C0040?IO_ZDP03A
  412:     {
  413:       // Simple check for the command length. Return if invalid.
  414:       return;
  415:     }
B2:0089F7         ?C0058?IO_ZDP03A:
  416: 
  417:     pin = ((pString[3] - 0x30) << 4) + (pString[4] - 0x30);
B2:0089F7 91A5              ACALL    ?L?COM0080
B2:0089F9 24D0              ADD      A,#0D0H
B2:0089FB C4                SWAP     A
B2:0089FC 54F0              ANL      A,#0F0H
B2:0089FE FF                MOV      R7,A
B2:0089FF 1270EB            LCALL    ?L?COM01E4
B2:008A02 12DB7A            LCALL    ?L?COM058B
  418: 
  419:     if (TRUE == gpio_GetPin(pin))
B2:008A05 12BC92            LCALL    _gpio_GetPin
B2:008A08 5004              JNC      ?C0059?IO_ZDP03A
  420:     {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 533


  421:       ZW_UART0_tx_send_byte('1');
B2:008A0A 7F31              MOV      R7,#031H
  422:     }
B2:008A0C 8002              SJMP     ?C0088?IO_ZDP03A
B2:008A0E         ?C0059?IO_ZDP03A:
  423:     else
  424:     {
  425:       ZW_UART0_tx_send_byte('0');
B2:008A0E 7F30              MOV      R7,#030H
B2:008A10         
B2:008A10 026C20            LJMP     _ZW_UART0_tx_send_byte
  426:     }
  427:   }
B2:008A13         ?C0057?IO_ZDP03A:
  428:   else if (!memcmp(pString, "reset", 5))
B2:008A13 7A2E              MOV      R2,#HIGH 01002EB6H
B2:008A15 79B6              MOV      R1,#LOW 01002EB6H
B2:008A17 71A6              ACALL    ?L?COM0159
B2:008A19 7F05              MOV      R7,#05H
B2:008A1B 121B92            LCALL    ?INTERBANK_TABLE?___ZW_memcmp
B2:008A1E EF                MOV      A,R7
B2:008A1F 7009              JNZ      ?C0062?IO_ZDP03A
  429:   {
  430:     mykeyMan.pEventKeyQueue(EVENT_SYSTEM_RESET);
B2:008A21 12D92B            LCALL    ?L?COM01E2
B2:008A24 8E83              MOV      DPH,R6
B2:008A26 7F30              MOV      R7,#030H
  431:   }
B2:008A28 6124              AJMP     ?C0091?IO_ZDP03A
B2:008A2A         ?C0062?IO_ZDP03A:
  432:   else if (!memcmp(pString, "csa", 3))
B2:008A2A 7A2E              MOV      R2,#HIGH 01002EBCH
B2:008A2C 79BC              MOV      R1,#LOW 01002EBCH
B2:008A2E 71A6              ACALL    ?L?COM0159
B2:008A30 12DAB2            LCALL    ?L?COM0453
B2:008A33 6002              JZ       $ + 4H
B2:008A35 41E4              AJMP     ?C0064?IO_ZDP03A
  433:   {
  434:     /*
  435:      * This is used for Client Side Authentification (CSA).
  436:      */
  437: #define DSK_PART_SIZE (5)
  438: #define DSK_OFFSET (4)
  439:     uint8_t partCount;
  440:     uint8_t charCount;
  441:     union DSK_PART dskPart;
  442:     s_SecurityS2InclusionCSAPublicDSK_t response;
  443:     uint8_t byteCount = 0;
B2:008A37 903B6A            MOV      DPTR,#byteCount
B2:008A3A F0                MOVX     @DPTR,A
  444: 
  445:     for (partCount = 0; partCount < 2; partCount++)
B2:008A3B 903B62            MOV      DPTR,#partCount
B2:008A3E F0                MOVX     @DPTR,A
B2:008A3F         ?C0065?IO_ZDP03A:
  446:     {
  447:       dskPart.key16 = 0;
B2:008A3F E4                CLR      A
B2:008A40 903B64            MOV      DPTR,#dskPart
B2:008A43 F0                MOVX     @DPTR,A
B2:008A44 A3                INC      DPTR
B2:008A45 F0                MOVX     @DPTR,A
  448:       for (charCount = 0; charCount < 5; charCount++)
B2:008A46 903B63            MOV      DPTR,#charCount
B2:008A49 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 534


B2:008A4A         ?C0068?IO_ZDP03A:
B2:008A4A 903B63            MOV      DPTR,#charCount
B2:008A4D E0                MOVX     A,@DPTR
B2:008A4E FD                MOV      R5,A
B2:008A4F C3                CLR      C
B2:008A50 9405              SUBB     A,#05H
B2:008A52 5046              JNC      ?C0069?IO_ZDP03A
  449:       {
  450:         dskPart.key16 += (pString[DSK_OFFSET + (DSK_PART_SIZE * partCount) + charCount] - 0x30); // Convert from 
>> ascii to int and add.
B2:008A54 903B62            MOV      DPTR,#partCount
B2:008A57 E0                MOVX     A,@DPTR
B2:008A58 75F005            MOV      B,#05H
B2:008A5B A4                MUL      AB
B2:008A5C 2404              ADD      A,#04H
B2:008A5E FF                MOV      R7,A
B2:008A5F E4                CLR      A
B2:008A60 35F0              ADDC     A,B
B2:008A62 12D8F7            LCALL    ?L?COM00A9
B2:008A65 FE                MOV      R6,A
B2:008A66 71AE              ACALL    ?L?COM015B
B2:008A68 1272E5            LCALL    ?L?COM048E
B2:008A6B 24D0              ADD      A,#0D0H
B2:008A6D FF                MOV      R7,A
B2:008A6E 33                RLC      A
B2:008A6F 95E0              SUBB     A,ACC
B2:008A71 903B64            MOV      DPTR,#dskPart
B2:008A74 8FF0              MOV      B,R7
B2:008A76 122143            LCALL    ?C?IILDX
  451:         if (charCount < 4)
B2:008A79 903B63            MOV      DPTR,#charCount
B2:008A7C E0                MOVX     A,@DPTR
B2:008A7D C3                CLR      C
B2:008A7E 9404              SUBB     A,#04H
B2:008A80 5010              JNC      ?C0070?IO_ZDP03A
  452:         {
  453:           // Do only "shift" the first four digits.
  454:           dskPart.key16 *= 10;
B2:008A82 124BB1            LCALL    ?L?COM003C
B2:008A85 7D0A              MOV      R5,#0AH
B2:008A87 1220A6            LCALL    ?C?IMUL
B2:008A8A 903B64            MOV      DPTR,#dskPart
B2:008A8D EE                MOV      A,R6
B2:008A8E F0                MOVX     @DPTR,A
B2:008A8F A3                INC      DPTR
B2:008A90 EF                MOV      A,R7
B2:008A91 F0                MOVX     @DPTR,A
  455:         }
  456:       }
B2:008A92         ?C0070?IO_ZDP03A:
B2:008A92 903B63            MOV      DPTR,#charCount
B2:008A95 E0                MOVX     A,@DPTR
B2:008A96 04                INC      A
B2:008A97 F0                MOVX     @DPTR,A
B2:008A98 80B0              SJMP     ?C0068?IO_ZDP03A
B2:008A9A         ?C0069?IO_ZDP03A:
  457:       response.aCSA_DSK[byteCount++] = dskPart.keyArray[0];
B2:008A9A 903B64            MOV      DPTR,#dskPart
B2:008A9D 12D9B5            LCALL    ?L?COM032F
  458:       response.aCSA_DSK[byteCount++] = dskPart.keyArray[1];
B2:008AA0 903B65            MOV      DPTR,#dskPart+01H
B2:008AA3 12D9B5            LCALL    ?L?COM032F
  459:     }
B2:008AA6 903B62            MOV      DPTR,#partCount
B2:008AA9 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 535


B2:008AAA 04                INC      A
B2:008AAB F0                MOVX     @DPTR,A
B2:008AAC E0                MOVX     A,@DPTR
B2:008AAD 6402              XRL      A,#02H
B2:008AAF 708E              JNZ      ?C0065?IO_ZDP03A
B2:008AB1         ?C0066?IO_ZDP03A:
  460: 
  461:     ZW_UART0_tx_send_nl();
B2:008AB1 121D31            LCALL    ?INTERBANK_TABLE?ZW_UART0_tx_send_nl
  462:     ZW_UART0_tx_send_str((BYTE*)"Got it!");
B2:008AB4 7A2E              MOV      R2,#HIGH 01002EC0H
B2:008AB6 79C0              MOV      R1,#LOW 01002EC0H
B2:008AB8 1281A4            LCALL    ?L?COM03EB
  463: 
  464: #ifdef __C51__
  465:     ZW_UART0_tx_send_nl();
  466:     ZW_UART0_tx_send_num(response.aCSA_DSK[0]);
B2:008ABB 903B66            MOV      DPTR,#response
B2:008ABE E0                MOVX     A,@DPTR
B2:008ABF FF                MOV      R7,A
B2:008AC0 121D22            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_hex
  467:     ZW_UART0_tx_send_num(response.aCSA_DSK[1]);
B2:008AC3 903B67            MOV      DPTR,#response+01H
B2:008AC6 E0                MOVX     A,@DPTR
B2:008AC7 FF                MOV      R7,A
B2:008AC8 121D22            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_hex
  468:     ZW_UART0_tx_send_num(response.aCSA_DSK[2]);
B2:008ACB 903B68            MOV      DPTR,#response+02H
B2:008ACE E0                MOVX     A,@DPTR
B2:008ACF FF                MOV      R7,A
B2:008AD0 121D22            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_hex
  469:     ZW_UART0_tx_send_num(response.aCSA_DSK[3]);
B2:008AD3 903B69            MOV      DPTR,#response+03H
B2:008AD6 E0                MOVX     A,@DPTR
B2:008AD7 FF                MOV      R7,A
B2:008AD8 121D22            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_hex
  470: #endif
  471: 
  472:     ZW_SetSecurityS2InclusionPublicDSK_CSA(&response);
B2:008ADB 7B01              MOV      R3,#01H
B2:008ADD 7A3B              MOV      R2,#HIGH response
B2:008ADF 7966              MOV      R1,#LOW response
B2:008AE1 021CAA            LJMP     ?INTERBANK_TABLE?_ZW_SetSecurityS2InclusionPublicDSK_CSA
  473:   }
B2:008AE4         ?C0064?IO_ZDP03A:
  474:   else if (!memcmp(pString, "lms", 3))
B2:008AE4 7BFF              MOV      R3,#0FFH
B2:008AE6 7A2E              MOV      R2,#HIGH 01002EC8H
B2:008AE8 79C8              MOV      R1,#LOW 01002EC8H
B2:008AEA 71A8              ACALL    ?L?COM015A
B2:008AEC 12DAB2            LCALL    ?L?COM0453
B2:008AEF 7009              JNZ      ?C0073?IO_ZDP03A
  475:   {
  476:     mykeyMan.pEventKeyQueue(EVENT_SYSTEM_LEARNMODE_START);
B2:008AF1 12D92B            LCALL    ?L?COM01E2
B2:008AF4 8E83              MOV      DPH,R6
B2:008AF6 7F31              MOV      R7,#031H
B2:008AF8         
  477:   }
B2:008AF8 802A              SJMP     ?C0091?IO_ZDP03A
B2:008AFA         ?C0073?IO_ZDP03A:
  478:   else if (!memcmp(pString, "lme", 3))
B2:008AFA 7BFF              MOV      R3,#0FFH
B2:008AFC 7A2E              MOV      R2,#HIGH 01002ECCH
B2:008AFE 79CC              MOV      R1,#LOW 01002ECCH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 536


B2:008B00 71A8              ACALL    ?L?COM015A
B2:008B02 12DAB2            LCALL    ?L?COM0453
B2:008B05 7009              JNZ      ?C0075?IO_ZDP03A
  479:   {
  480:     mykeyMan.pEventKeyQueue(EVENT_SYSTEM_LEARNMODE_END);
B2:008B07 12D92B            LCALL    ?L?COM01E2
B2:008B0A 8E83              MOV      DPH,R6
B2:008B0C 7F33              MOV      R7,#033H
B2:008B0E         
  481:   }
B2:008B0E 8014              SJMP     ?C0091?IO_ZDP03A
B2:008B10         ?C0075?IO_ZDP03A:
  482:   else if (!memcmp(pString, "wdr", 3))
B2:008B10 7BFF              MOV      R3,#0FFH
B2:008B12 7A2E              MOV      R2,#HIGH 01002ED0H
B2:008B14 79D0              MOV      R1,#LOW 01002ED0H
B2:008B16 71A8              ACALL    ?L?COM015A
B2:008B18 12DAB2            LCALL    ?L?COM0453
B2:008B1B 700A              JNZ      ?C0077?IO_ZDP03A
  483:   {
  484:     mykeyMan.pEventKeyQueue(EVENT_SYSTEM_WATCHDOG_RESET);
B2:008B1D 12D92B            LCALL    ?L?COM01E2
B2:008B20 8E83              MOV      DPH,R6
B2:008B22 7F34              MOV      R7,#034H
B2:008B24         
B2:008B24 02271A            LJMP     ?C?ICALL2
  485:   }
B2:008B27         ?C0077?IO_ZDP03A:
  486: #ifdef IO_ZDP03A_EXTRAS
  487:   else if (!memcmp(pString, "ast", 3))
  488:   {
  489:     ZW_UART0_tx_send_nl();
  490:     ZW_UART0_tx_send_str((BYTE*)"Application state: ");
  491:     ZW_UART0_tx_send_num(GetAppState());
  492:     ZW_UART0_tx_send_nl();
  493:   }
  494: #endif
  495: //#ifdef IO_ZDP03A_EXTRAS
  496:   else if (!memcmp(pString, "ZW", 2))
B2:008B27 7BFF              MOV      R3,#0FFH
B2:008B29 7A2E              MOV      R2,#HIGH 01002ED4H
B2:008B2B 79D4              MOV      R1,#LOW 01002ED4H
B2:008B2D 71A8              ACALL    ?L?COM015A
B2:008B2F 7F02              MOV      R7,#02H
B2:008B31 121B92            LCALL    ?INTERBANK_TABLE?___ZW_memcmp
B2:008B34 EF                MOV      A,R7
B2:008B35 706E              JNZ      ?C0040?IO_ZDP03A
  497:   {
  498:     BYTE tempString[10];
  499:     BYTE x;
  500:     ZW_UART0_tx_send_nl();
B2:008B37 121D31            LCALL    ?INTERBANK_TABLE?ZW_UART0_tx_send_nl
  501:     ZW_UART0_tx_send_str((BYTE*)"ZW app:\r\n");
B2:008B3A 7BFF              MOV      R3,#0FFH
B2:008B3C 7A2E              MOV      R2,#HIGH 01002ED7H
B2:008B3E 79D7              MOV      R1,#LOW 01002ED7H
B2:008B40 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
  502:     ZW_UART0_tx_send_str((BYTE*)" Firmware ID: ");
B2:008B43 7BFF              MOV      R3,#0FFH
B2:008B45 7A2E              MOV      R2,#HIGH 01002EE1H
B2:008B47 79E1              MOV      R1,#LOW 01002EE1H
B2:008B49 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
  503:     ZW_UART0_tx_send_w_num(handleFirmWareIdGet(0));
B2:008B4C E4                CLR      A
B2:008B4D FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 537


B2:008B4E 12B45D            LCALL    _handleFirmWareIdGet
B2:008B51 121D27            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_w_num
  504:     ZW_UART0_tx_send_str((BYTE*)"\r\n Version: ");
B2:008B54 7BFF              MOV      R3,#0FFH
B2:008B56 7A2E              MOV      R2,#HIGH 01002EF0H
B2:008B58 79F0              MOV      R1,#LOW 01002EF0H
B2:008B5A 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
  505:     handleGetFirmwareVersion( 0, (VG_VERSION_REPORT_V2_VG*)tempString ); // tempString[0,1] = APP_VERSION;
B2:008B5D 7B01              MOV      R3,#01H
B2:008B5F 7A3B              MOV      R2,#HIGH tempString
B2:008B61 7962              MOV      R1,#LOW tempString
B2:008B63 E4                CLR      A
B2:008B64 FF                MOV      R7,A
B2:008B65 12B133            LCALL    _CC_Version_GetFirmwareVersion_handler
  506:     tempString[0] += 0x30; //convert to ASCII
B2:008B68 903B62            MOV      DPTR,#tempString
B2:008B6B E0                MOVX     A,@DPTR
B2:008B6C 2430              ADD      A,#030H
B2:008B6E F0                MOVX     @DPTR,A
  507:     x = tempString[1];
B2:008B6F A3                INC      DPTR
B2:008B70 E0                MOVX     A,@DPTR
B2:008B71 903B6C            MOV      DPTR,#x
B2:008B74 F0                MOVX     @DPTR,A
  508:     tempString[1] = '.';
B2:008B75 903B63            MOV      DPTR,#tempString+01H
B2:008B78 742E              MOV      A,#02EH
B2:008B7A F0                MOVX     @DPTR,A
  509:     tempString[2] = 0x30 + x/10;
B2:008B7B 903B6C            MOV      DPTR,#x
B2:008B7E E0                MOVX     A,@DPTR
B2:008B7F FD                MOV      R5,A
B2:008B80 75F00A            MOV      B,#0AH
B2:008B83 84                DIV      AB
B2:008B84 2430              ADD      A,#030H
B2:008B86 903B64            MOV      DPTR,#tempString+02H
B2:008B89 F0                MOVX     @DPTR,A
  510:     tempString[3] = 0x30 + x%10;
B2:008B8A ED                MOV      A,R5
B2:008B8B 75F00A            MOV      B,#0AH
B2:008B8E 84                DIV      AB
B2:008B8F E5F0              MOV      A,B
B2:008B91 2430              ADD      A,#030H
B2:008B93 A3                INC      DPTR
B2:008B94 F0                MOVX     @DPTR,A
  511:     tempString[4] = '\r';
B2:008B95 A3                INC      DPTR
B2:008B96 740D              MOV      A,#0DH
B2:008B98 F0                MOVX     @DPTR,A
  512:     tempString[5] = '\n';
B2:008B99 740A              MOV      A,#0AH
B2:008B9B 127317            LCALL    ?L?COM04C2
B2:008B9E 7A3B              MOV      R2,#HIGH tempString
B2:008BA0 7962              MOV      R1,#LOW tempString
B2:008BA2 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
  513:     tempString[6] = 0; // line end
  514:     ZW_UART0_tx_send_str(tempString);
  515:   }
  516: //#endif
  517: #ifdef IO_ZDP03A_HELP
  518:   else if (!memcmp(pString, "help", 4))
  519:   {
  520:     ZW_UART0_tx_send_nl();
  521:     ZW_UART0_tx_send_str((BYTE*)"*************************************\r\n");
  522:     ZW_UART0_tx_send_str((BYTE*)"io_zdp03a command descriptions.\r\n");
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 538


  523:     ZW_UART0_tx_send_str((BYTE*)"Desc:\t>'chan' 'cmd'\\r\t-> chan~channel, cmd~commands\r\n");
  524:     ZW_UART0_tx_send_str((BYTE*)"Eks:\t>a k1p\t\t-> a~application, k1p~key1Press\r\n");
  525:     ZW_UART0_tx_send_nl();
  526:     ZW_UART0_tx_send_str((BYTE*)"Commmands:\r\n");
  527:     ZW_UART0_tx_send_str((BYTE*)"-help:\r\n");
  528:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..3]\t= help\r\n");
  529:     ZW_UART0_tx_send_str((BYTE*)"-Reset:\r\n");
  530:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..4]\t= reset\r\n");
  531:     ZW_UART0_tx_send_str((BYTE*)"-LearnMode start:\r\n");
  532:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..2]\t= lms\r\n");
  533:     ZW_UART0_tx_send_str((BYTE*)"-LearnMode end:\r\n");
  534:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..2]\t= lme\r\n");
  535:     ZW_UART0_tx_send_str((BYTE*)"-Watchdog reset:\r\n");
  536:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..2]\t= wdr\r\n");
  537:     ZW_UART0_tx_send_str((BYTE*)"-Get application state:\r\n");
  538:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..2]\t= ast\r\n");
  539:     ZW_UART0_tx_send_str((BYTE*)"-Get IO pin:\r\n");
  540:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0..5]\t= getpin\r\n");
  541:     ZW_UART0_tx_send_str((BYTE*)"-Zw device firmware-Id & -version:\r\n");
  542:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0,1]\t= ZW\r\n");
  543:     ZW_UART0_tx_send_str((BYTE*)"-Key :\r\n");
  544:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[0]\t\t= k (k)ey\r\n");
  545:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[1]\t\t= 1..6 key number\r\n");
  546:     ZW_UART0_tx_send_str((BYTE*)"\tcmd[2,3]\t= d (d)own\r\n");
  547:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= u (u)p\r\n");
  548:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= p   -> (p)ress\r\n");
  549:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= h   -> (h)old\r\n");
  550:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= tp  -> (t)riple (p)ress\r\n");
  551:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= t   -> (t)riple press\r\n");
  552:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= h   -> (h)old\r\n");
  553:     ZW_UART0_tx_send_str((BYTE*)"\t\t\t= 10h -> 10 sec (h)old\r\n");
  554:     ZW_UART0_tx_send_str((BYTE*)"*************************************\r\n");
  555:   }
  556:   else
  557:   {
  558:     ZW_UART0_tx_send_str((BYTE*)"\r\nUnknown command! >a help\r\n");
  559:   }
  560: #endif /* IO_ZDP03A_HELP */
  561: }
B2:008BA5         ?C0040?IO_ZDP03A:
B2:008BA5 22                RET      
----- FUNCTION _ZCB_AppTestInterface (END) -------


----- FUNCTION ?L?COM0159 (BEGIN) -----
B2:008BA6 7BFF              MOV      R3,#0FFH
B2:008BA8         ?L?COM015A:
B2:008BA8 904064            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B2:008BAB 1225A9            LCALL    ?C?PSTXDATA
B2:008BAE         ?L?COM015B:
B2:008BAE 903B5B            MOV      DPTR,#pString
B2:008BB1 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0159 (END) -------


----- FUNCTION GetCommandClassList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  195: GetCommandClassList(
  196:     BOOL included,
  197:     security_key_t eKey,
  198:     BYTE endpoint)
  199: {
  200:   static CMD_CLASS_LIST cmd_class_list;
  201:   static CMD_CLASS_LIST* pCmdClassList = NULL;
  202:   ZW_DEBUG_SECURITY_SEND_STR("\r\nCommandsSuppported(");
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 539


  203:   ZW_DEBUG_SECURITY_SEND_NUM(included);
  204:   ZW_DEBUG_SECURITY_SEND_NUM(eKey);
  205:   ZW_DEBUG_SECURITY_SEND_NUM(endpoint);
  206:   ZW_DEBUG_SECURITY_SEND_STR(")\r\n");
  207:   if (TRUE == included)
B2:008BB4 205002            JB       included,$ + 5H
B2:008BB7 816A              AJMP     ?C0014?ZW_TRANSPORTSECPROTOCOL
  208:   {
  209: 
  210:     if (SECURITY_KEY_NONE == eKey)
B2:008BB9 904324            MOV      DPTR,#eKey
B2:008BBC E0                MOVX     A,@DPTR
B2:008BBD 7027              JNZ      ?C0015?ZW_TRANSPORTSECPROTOCOL
  211:     {
  212:       BYTE keys = ZW_GetSecurityKeys();
B2:008BBF 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:008BC2 904326            MOV      DPTR,#keys
B2:008BC5 EF                MOV      A,R7
B2:008BC6 F0                MOVX     @DPTR,A
  213: 
  214:       /*Check non secure command class list*/
  215:       if(0 == endpoint)
B2:008BC7 904325            MOV      DPTR,#endpoint
B2:008BCA E0                MOVX     A,@DPTR
B2:008BCB FF                MOV      R7,A
B2:008BCC 7011              JNZ      ?C0016?ZW_TRANSPORTSECPROTOCOL
  216:       {
  217:         if(SECURITY_KEY_NONE_MASK == keys)
B2:008BCE A3                INC      DPTR
B2:008BCF E0                MOVX     A,@DPTR
B2:008BD0 903614            MOV      DPTR,#m_AppInfo
B2:008BD3 7005              JNZ      ?C0017?ZW_TRANSPORTSECPROTOCOL
  218:         {
  219:           /*Non-secure included, non-secure cmd class list*/
  220:           pCmdClassList =  &(m_AppInfo.u.pCmdLists->unsecList);
B2:008BD5 122589            LCALL    ?C?PLDXDATA
  221:         }
B2:008BD8 8193              AJMP     ?C0055?ZW_TRANSPORTSECPROTOCOL
B2:008BDA         ?C0017?ZW_TRANSPORTSECPROTOCOL:
  222:         else{
  223:           /*secure included, non-secure cmd class list*/
  224:           pCmdClassList =  &(m_AppInfo.u.pCmdLists->sec.unsecList);
B2:008BDA 125522            LCALL    ?L?COM0059
B2:008BDD         
  225:         }
  226:       }
B2:008BDD 8193              AJMP     ?C0055?ZW_TRANSPORTSECPROTOCOL
B2:008BDF         ?C0016?ZW_TRANSPORTSECPROTOCOL:
  227: #ifndef SERIAL_API_APP
  228: 
  229:       else
  230:       {
  231:         pCmdClassList = GetEndpointcmdClassList(FALSE, endpoint);
B2:008BDF C24D              CLR      ?GetEndpointcmdClassList?BIT
B2:008BE1 128258            LCALL    ?L?COM0386
B2:008BE4         
  232:       }
  233: #endif
  234:       //Copy cmd class list into buffer and only add active CC_SECURITY + CC_SECURITY_2
  235:       /*
  236:       cmd_class_list.pList = cmd_class_buffer;
  237:       cmd_class_list.size = 0;
  238: 
  239: 
  240:       for(i = 0; i < pCmdClassList->size; i++)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 540


  241:       {
  242:         if( ( (COMMAND_CLASS_SECURITY != *(pCmdClassList->pList + i)) &&
  243:               (COMMAND_CLASS_SECURITY_2 != *(pCmdClassList->pList + i))
  244:             ) ||
  245:             (
  246:               (((COMMAND_CLASS_SECURITY == *(pCmdClassList->pList + i)) && (SECURITY_KEY_S0_BIT & keys)) ||
  247:               ((COMMAND_CLASS_SECURITY_2 == *(pCmdClassList->pList + i)) && (SECURITY_KEY_S2_MASK & keys)))
  248:             )
  249:           )
  250:         {
  251:           //Only add security CC if device support it
  252:           cmd_class_buffer[cmd_class_list.size] = *(pCmdClassList->pList + i);
  253:           cmd_class_list.size++;
  254:         }
  255:       }
  256:       pCmdClassList = &cmd_class_list;
  257:       */
  258:     }
B2:008BE4 8193              AJMP     ?C0055?ZW_TRANSPORTSECPROTOCOL
B2:008BE6         ?C0015?ZW_TRANSPORTSECPROTOCOL:
  259:     else
  260:     {
  261:       /*Check secure command class list*/
  262: 
  263:       /*If eKey not is supported, return NULL pointer!!*/
  264:       if(eKey == GetHighestSecureLevel( ZW_GetSecurityKeys()) )
B2:008BE6 91AB              ACALL    ?L?COM0510
B2:008BE8 904324            MOV      DPTR,#eKey
B2:008BEB E0                MOVX     A,@DPTR
B2:008BEC 6F                XRL      A,R7
B2:008BED 6002              JZ       $ + 4H
B2:008BEF 817C              AJMP     ?C0054?ZW_TRANSPORTSECPROTOCOL
  265:       {
  266:         if(0 == endpoint)
B2:008BF1 A3                INC      DPTR
B2:008BF2 E0                MOVX     A,@DPTR
B2:008BF3 FF                MOV      R7,A
B2:008BF4 700C              JNZ      ?C0022?ZW_TRANSPORTSECPROTOCOL
  267:         {
  268:           pCmdClassList = &(m_AppInfo.u.pCmdLists->sec.secList);
B2:008BF6 12945E            LCALL    ?L?COM037F
B2:008BF9 E9                MOV      A,R1
B2:008BFA 2408              ADD      A,#08H
B2:008BFC F9                MOV      R1,A
B2:008BFD E4                CLR      A
B2:008BFE 3A                ADDC     A,R2
B2:008BFF FA                MOV      R2,A
  269:         }
B2:008C00 8005              SJMP     ?C0050?ZW_TRANSPORTSECPROTOCOL
B2:008C02         ?C0022?ZW_TRANSPORTSECPROTOCOL:
  270:   #ifndef SERIAL_API_APP
  271:         else
  272:         {
  273:           pCmdClassList = GetEndpointcmdClassList(TRUE, endpoint);
B2:008C02 D24D              SETB     ?GetEndpointcmdClassList?BIT
B2:008C04 128258            LCALL    ?L?COM0386
B2:008C07         
B2:008C07 903611            MOV      DPTR,#pCmdClassList
B2:008C0A 1225A9            LCALL    ?C?PSTXDATA
  274:         }
B2:008C0D         ?C0023?ZW_TRANSPORTSECPROTOCOL:
  275:   #endif
  276:         /*Remove marker and commands*/
  277:         if( (SECURITY_KEY_S2_UNAUTHENTICATED == eKey) ||
B2:008C0D 904324            MOV      DPTR,#eKey
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 541


B2:008C10 E0                MOVX     A,@DPTR
B2:008C11 FF                MOV      R7,A
B2:008C12 6401              XRL      A,#01H
B2:008C14 600A              JZ       ?C0025?ZW_TRANSPORTSECPROTOCOL
B2:008C16 EF                MOV      A,R7
B2:008C17 6402              XRL      A,#02H
B2:008C19 6005              JZ       ?C0025?ZW_TRANSPORTSECPROTOCOL
B2:008C1B EF                MOV      A,R7
B2:008C1C 6403              XRL      A,#03H
B2:008C1E 7079              JNZ      ?C0029?ZW_TRANSPORTSECPROTOCOL
B2:008C20         ?C0025?ZW_TRANSPORTSECPROTOCOL:
  278:             (SECURITY_KEY_S2_AUTHENTICATED == eKey) ||
  279:             (SECURITY_KEY_S2_ACCESS == eKey)
  280:           )
  281:         {
  282:           cmd_class_list.pList = cmd_class_buffer;
B2:008C20 7B01              MOV      R3,#01H
B2:008C22 7A36              MOV      R2,#HIGH cmd_class_buffer
B2:008C24 791B              MOV      R1,#LOW cmd_class_buffer
B2:008C26 12DA0E            LCALL    ?L?COM03B7
B2:008C29 903610            MOV      DPTR,#cmd_class_list+03H
B2:008C2C F0                MOVX     @DPTR,A
B2:008C2D         ?C0026?ZW_TRANSPORTSECPROTOCOL:
  283:           cmd_class_list.size = 0;
  284:           while(((BYTE)*(pCmdClassList->pList + cmd_class_list.size) != COMMAND_CLASS_MARK) &&
B2:008C2D 903611            MOV      DPTR,#pCmdClassList
B2:008C30 12B441            LCALL    ?L?COM0101
B2:008C33 903610            MOV      DPTR,#cmd_class_list+03H
B2:008C36 E0                MOVX     A,@DPTR
B2:008C37 FF                MOV      R7,A
B2:008C38 126DC8            LCALL    ?L?COM01D9
B2:008C3B FE                MOV      R6,A
B2:008C3C 64EF              XRL      A,#0EFH
B2:008C3E 6022              JZ       ?C0027?ZW_TRANSPORTSECPROTOCOL
B2:008C40 903611            MOV      DPTR,#pCmdClassList
B2:008C43 91A2              ACALL    ?L?COM007F
B2:008C45 FD                MOV      R5,A
B2:008C46 EF                MOV      A,R7
B2:008C47 C3                CLR      C
B2:008C48 9D                SUBB     A,R5
B2:008C49 5017              JNC      ?C0027?ZW_TRANSPORTSECPROTOCOL
  285:                 (cmd_class_list.size < pCmdClassList->size))
  286:           {
  287:             cmd_class_buffer[cmd_class_list.size] = *(pCmdClassList->pList + cmd_class_list.size);
B2:008C4B 903610            MOV      DPTR,#cmd_class_list+03H
B2:008C4E E0                MOVX     A,@DPTR
B2:008C4F 241B              ADD      A,#LOW cmd_class_buffer
B2:008C51 F582              MOV      DPL,A
B2:008C53 E4                CLR      A
B2:008C54 3436              ADDC     A,#HIGH cmd_class_buffer
B2:008C56 F583              MOV      DPH,A
B2:008C58 EE                MOV      A,R6
B2:008C59 F0                MOVX     @DPTR,A
  288:             cmd_class_list.size++;
B2:008C5A 903610            MOV      DPTR,#cmd_class_list+03H
B2:008C5D E0                MOVX     A,@DPTR
B2:008C5E 04                INC      A
B2:008C5F F0                MOVX     @DPTR,A
  289:           }
B2:008C60 80CB              SJMP     ?C0026?ZW_TRANSPORTSECPROTOCOL
B2:008C62         ?C0027?ZW_TRANSPORTSECPROTOCOL:
  290:           pCmdClassList = &cmd_class_list;
B2:008C62 7B01              MOV      R3,#01H
B2:008C64 7A36              MOV      R2,#HIGH cmd_class_list
B2:008C66 790D              MOV      R1,#LOW cmd_class_list
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 542


B2:008C68         
  291:         }
  292:       }
B2:008C68 8029              SJMP     ?C0055?ZW_TRANSPORTSECPROTOCOL
B2:008C6A         ?C0014?ZW_TRANSPORTSECPROTOCOL:
  293:       else
  294:       {
  295:         /*not included. Deliver empty list*/
  296:         cmd_class_list.pList = NULL;
  297:         cmd_class_list.size = 0;
  298:         pCmdClassList = &cmd_class_list;
  299:       }
  300:     }
  301:   }
  302:   else
  303:   {
  304:     /*Not included!*/
  305:     if(0 == endpoint)
B2:008C6A 904325            MOV      DPTR,#endpoint
B2:008C6D E0                MOVX     A,@DPTR
B2:008C6E FF                MOV      R7,A
B2:008C6F 701D              JNZ      ?C0030?ZW_TRANSPORTSECPROTOCOL
  306:     {
  307:       if (SECURITY_KEY_NONE == eKey)
B2:008C71 904324            MOV      DPTR,#eKey
B2:008C74 E0                MOVX     A,@DPTR
B2:008C75 7005              JNZ      ?C0031?ZW_TRANSPORTSECPROTOCOL
  308:       {
  309:         pCmdClassList = &(m_AppInfo.u.pCmdLists->unsecList);
B2:008C77 12945E            LCALL    ?L?COM037F
B2:008C7A         
  310:       }
B2:008C7A 8017              SJMP     ?C0055?ZW_TRANSPORTSECPROTOCOL
B2:008C7C         ?C0031?ZW_TRANSPORTSECPROTOCOL:
  311:       else
  312:       {
  313:         /*not included. Deliver empty list*/
  314:         cmd_class_list.pList = NULL;
B2:008C7C         
B2:008C7C 12B299            LCALL    ?L?COM0069
B2:008C7F 12DA0E            LCALL    ?L?COM03B7
B2:008C82 903610            MOV      DPTR,#cmd_class_list+03H
B2:008C85 F0                MOVX     @DPTR,A
  315:         cmd_class_list.size = 0;
  316:         pCmdClassList = &cmd_class_list;
B2:008C86 0B                INC      R3
B2:008C87 7A36              MOV      R2,#HIGH cmd_class_list
B2:008C89 790D              MOV      R1,#LOW cmd_class_list
B2:008C8B A3                INC      DPTR
  317:       }
  318:     }
B2:008C8C 8008              SJMP     ?C0056?ZW_TRANSPORTSECPROTOCOL
B2:008C8E         ?C0030?ZW_TRANSPORTSECPROTOCOL:
  319: #ifndef SERIAL_API_APP
  320:     else
  321:     {
  322:       pCmdClassList = GetEndpointcmdClassList(FALSE, endpoint);
B2:008C8E C24D              CLR      ?GetEndpointcmdClassList?BIT
B2:008C90 128258            LCALL    ?L?COM0386
B2:008C93         
B2:008C93 903611            MOV      DPTR,#pCmdClassList
B2:008C96         
B2:008C96 1225A9            LCALL    ?C?PSTXDATA
  323:     }
  324: #endif
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 543


  325:   }
B2:008C99         ?C0029?ZW_TRANSPORTSECPROTOCOL:
  326: 
  327:   return pCmdClassList;
B2:008C99 903611            MOV      DPTR,#pCmdClassList
B2:008C9C 022589            LJMP     ?C?PLDXDATA
  328: }
----- FUNCTION GetCommandClassList (END) -------


----- FUNCTION ?L?COM007E (BEGIN) -----
B2:008C9F 903A56            MOV      DPTR,#pCmdClassList
B2:008CA2         ?L?COM007F:
B2:008CA2 122589            LCALL    ?C?PLDXDATA
B2:008CA5         ?L?COM0080:
B2:008CA5 900003            MOV      DPTR,#03H
B2:008CA8 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM007E (END) -------


----- FUNCTION ?L?COM0510 (BEGIN) -----
B2:008CAB 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:008CAE 02A0E5            LJMP     _GetHighestSecureLevel
----- FUNCTION ?L?COM0510 (END) -------


----- FUNCTION _SetupActiveNIF (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  434: SetupActiveNIF(BYTE nodeId)
  435: {
;---- Variable 'nodeId' assigned to Register 'R7' ----
  436:   if(0 == nodeId || (SECURITY_KEY_NONE == GetHighestSecureLevel(ZW_GetSecurityKeys())) )
  437:   {
B2:008CB1 EF                MOV      A,R7
B2:008CB2 6005              JZ       ?C0046?ZW_TRANSPORTSECPROTOCOL
B2:008CB4 91AB              ACALL    ?L?COM0510
B2:008CB6 EF                MOV      A,R7
B2:008CB7 700B              JNZ      ?C0045?ZW_TRANSPORTSECPROTOCOL
B2:008CB9         ?C0046?ZW_TRANSPORTSECPROTOCOL:
  438:     m_AppInfo.activeNonsecureList = m_AppInfo.u.pCmdLists->unsecList;
  439:   }
B2:008CB9 7817              MOV      R0,#LOW m_AppInfo+03H
B2:008CBB 7C36              MOV      R4,#HIGH m_AppInfo+03H
B2:008CBD 7D01              MOV      R5,#01H
B2:008CBF 12945E            LCALL    ?L?COM037F
  440:   else
B2:008CC2 800C              SJMP     ?C0057?ZW_TRANSPORTSECPROTOCOL
B2:008CC4         ?C0045?ZW_TRANSPORTSECPROTOCOL:
  441:   {
  442:     m_AppInfo.activeNonsecureList = m_AppInfo.u.pCmdLists->sec.unsecList;
B2:008CC4 903614            MOV      DPTR,#m_AppInfo
B2:008CC7 125522            LCALL    ?L?COM0059
B2:008CCA 7817              MOV      R0,#LOW m_AppInfo+03H
B2:008CCC 7C36              MOV      R4,#HIGH m_AppInfo+03H
B2:008CCE 7D01              MOV      R5,#01H
B2:008CD0         
B2:008CD0 7E00              MOV      R6,#00H
B2:008CD2 7F04              MOV      R7,#04H
B2:008CD4 021F8D            LJMP     ?C?COPY
  443:   }
----- FUNCTION _SetupActiveNIF (END) -------


----- FUNCTION _MultiChanCommandHandler (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMULTICHAN.C'
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 544


   50: received_frame_status_t MultiChanCommandHandler(
   51:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:008CD7 903A43            MOV      DPTR,#rxOpt
B2:008CDA 1225A9            LCALL    ?C?PSTXDATA
   52:   ZW_APPLICATION_TX_BUFFER *pCmd,
   53:   BYTE cmdLength)
   54: {
   55:   ZW_APPLICATION_TX_BUFFER * pTxBuf;
   56:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX * pTxOptionsEx;
   57: 
   58:   switch(pCmd->ZW_Common.cmd)
B2:008CDD 903A46            MOV      DPTR,#pCmd
B2:008CE0 12A5A3            LCALL    ?L?COM001F
B2:008CE3 121FF0            LCALL    ?C?CLDOPTR
B2:008CE6 24F7              ADD      A,#0F7H
B2:008CE8 6052              JZ       ?C0007?COMMANDCLASSMULTICHAN
B2:008CEA 24FE              ADD      A,#0FEH
B2:008CEC 7002              JNZ      $ + 4H
B2:008CEE C130              AJMP     ?C0018?COMMANDCLASSMULTICHAN
B2:008CF0 24FE              ADD      A,#0FEH
B2:008CF2 7002              JNZ      $ + 4H
B2:008CF4 C198              AJMP     ?C0022?COMMANDCLASSMULTICHAN
B2:008CF6 14                DEC      A
B2:008CF7 7002              JNZ      $ + 4H
B2:008CF9 C1B5              AJMP     ?C0023?COMMANDCLASSMULTICHAN
B2:008CFB 2407              ADD      A,#07H
B2:008CFD 6002              JZ       $ + 4H
B2:008CFF E11E              AJMP     ?C0001?COMMANDCLASSMULTICHAN
   59:   {
   60:     case MULTI_CHANNEL_END_POINT_GET_V4:
B2:008D01         ?C0002?COMMANDCLASSMULTICHAN:
   61:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:008D01 903A43            MOV      DPTR,#rxOpt
B2:008D04 12A19D            LCALL    ?L?COM01BF
B2:008D07 5003              JNC      ?C0003?COMMANDCLASSMULTICHAN
   62:       {
   63:         // None of the following commands support endpoint bit addressing.
   64:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008D09 7F02              MOV      R7,#02H
B2:008D0B 22                RET      
   65:       }
B2:008D0C         ?C0003?COMMANDCLASSMULTICHAN:
   66: 
   67:       pTxBuf = GetResponseBuffer();
B2:008D0C 12D977            LCALL    ?L?COM0293
B2:008D0F 7003              JNZ      ?C0005?COMMANDCLASSMULTICHAN
   68: 
   69:       if (IS_NULL(pTxBuf))
   70:       {
   71:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008D11 7F02              MOV      R7,#02H
B2:008D13 22                RET      
   72:       }
B2:008D14         ?C0005?COMMANDCLASSMULTICHAN:
   73: 
   74:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:008D14 12ACED            LCALL    ?L?COM00B1
   75: 
   76:       pTxBuf->ZW_MultiChannelEndPointReportV4Frame.cmdClass      = COMMAND_CLASS_MULTI_CHANNEL_V4;
B2:008D17 12D938            LCALL    ?L?COM01E6
B2:008D1A 12A5A3            LCALL    ?L?COM001F
B2:008D1D 7408              MOV      A,#08H
B2:008D1F 12CD25            LCALL    ?L?COM03D8
B2:008D22 12B5BE            LCALL    _GetMultiChannelEndPointFunctionality
   77:       pTxBuf->ZW_MultiChannelEndPointReportV4Frame.cmd           = MULTI_CHANNEL_END_POINT_REPORT_V4;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 545


   78:       GetMultiChannelEndPointFunctionality((EP_FUNCTIONALITY_DATA*) &pTxBuf->ZW_MultiChannelEndPointReportV4Frame
>> .properties1);
   79: 
   80:       if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
   81:           (BYTE *)pTxBuf,
B2:008D25 12A144            LCALL    ?L?COM001C
B2:008D28 903A4A            MOV      DPTR,#pTxBuf
B2:008D2B 122589            LCALL    ?C?PLDXDATA
B2:008D2E 7D05              MOV      R5,#05H
B2:008D30 12A13D            LCALL    ?L?COM00BD
B2:008D33 7002              JNZ      $ + 4H
B2:008D35 E11E              AJMP     ?C0001?COMMANDCLASSMULTICHAN
   82:           sizeof(ZW_MULTI_CHANNEL_END_POINT_REPORT_V4_FRAME),
   83:           pTxOptionsEx,
   84:           ZCB_ResponseJobStatus))
   85:       {
   86:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
   87:         FreeResponseBuffer();
B2:008D37 12A0B6            LCALL    FreeResponseBuffer
   88:       }
   89:       break;
B2:008D3A E11E              AJMP     ?C0001?COMMANDCLASSMULTICHAN
   90: 
   91:     case MULTI_CHANNEL_CAPABILITY_GET_V4:
B2:008D3C         ?C0007?COMMANDCLASSMULTICHAN:
   92:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:008D3C 903A43            MOV      DPTR,#rxOpt
B2:008D3F 12A19D            LCALL    ?L?COM01BF
B2:008D42 5003              JNC      ?C0008?COMMANDCLASSMULTICHAN
   93:       {
   94:         // None of the following commands support endpoint bit addressing.
   95:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008D44 7F02              MOV      R7,#02H
B2:008D46 22                RET      
   96:       }
B2:008D47         ?C0008?COMMANDCLASSMULTICHAN:
   97:       pTxBuf = GetResponseBuffer();
B2:008D47 12D977            LCALL    ?L?COM0293
B2:008D4A 7003              JNZ      ?C0009?COMMANDCLASSMULTICHAN
   98:       if (IS_NULL(pTxBuf))
   99:       {
  100:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008D4C 7F02              MOV      R7,#02H
B2:008D4E 22                RET      
  101:       }
B2:008D4F         ?C0009?COMMANDCLASSMULTICHAN:
  102:       if ((0 == (pCmd->ZW_MultiChannelCapabilityGetV4Frame.properties1 & 0x7F)) ||
B2:008D4F 903A46            MOV      DPTR,#pCmd
B2:008D52 F13E              ACALL    ?L?COM0029
B2:008D54 547F              ANL      A,#07FH
B2:008D56 FF                MOV      R7,A
B2:008D57 607C              JZ       ?C0050?COMMANDCLASSMULTICHAN
B2:008D59 E4                CLR      A
B2:008D5A C3                CLR      C
B2:008D5B 9F                SUBB     A,R7
B2:008D5C 5002              JNC      ?C0010?COMMANDCLASSMULTICHAN
B2:008D5E         ?C0011?COMMANDCLASSMULTICHAN:
  103:           (NUMBER_OF_ENDPOINTS < (pCmd->ZW_MultiChannelCapabilityGetV4Frame.properties1 & 0x7F)))
  104:       {
  105:         FreeResponseBuffer();
  106:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008D5E 8075              SJMP     ?C0050?COMMANDCLASSMULTICHAN
  107:       }
B2:008D60         ?C0010?COMMANDCLASSMULTICHAN:
  108: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 546


  109:       {
  110:         ZW_MULTI_CHANNEL_CAPABILITY_GET_V4_FRAME * pCmdCap = (ZW_MULTI_CHANNEL_CAPABILITY_GET_V4_FRAME *)pCmd;
B2:008D60 12DAAC            LCALL    ?L?COM0445
B2:008D63 903A50            MOV      DPTR,#pCmdCap
B2:008D66 1225A9            LCALL    ?C?PSTXDATA
  111:         DEVICE_CLASS* pDevClass = GetEndpointDeviceClass(pCmdCap->properties1 & 0x7F);
B2:008D69 F141              ACALL    ?L?COM002A
B2:008D6B 547F              ANL      A,#07FH
B2:008D6D FF                MOV      R7,A
B2:008D6E 12D5E5            LCALL    _GetEndpointDeviceClass
B2:008D71 903A53            MOV      DPTR,#pDevClass
B2:008D74 12952A            LCALL    ?L?COM0424
B2:008D77 6001              JZ       ?C0012?COMMANDCLASSMULTICHAN
B2:008D79 D3                SETB     C
B2:008D7A         ?C0012?COMMANDCLASSMULTICHAN:
B2:008D7A         ?C0013?COMMANDCLASSMULTICHAN:
B2:008D7A 12DBC3            LCALL    ?L?COM05EB
B2:008D7D 903A50            MOV      DPTR,#pCmdCap
B2:008D80 F13E              ACALL    ?L?COM0029
B2:008D82 547F              ANL      A,#07FH
B2:008D84 904325            MOV      DPTR,#?GetCommandClassList?BYTE+01H
B2:008D87 F0                MOVX     @DPTR,A
B2:008D88 71B4              ACALL    GetCommandClassList
B2:008D8A 903A56            MOV      DPTR,#pCmdClassList
B2:008D8D 1225A9            LCALL    ?C?PSTXDATA
  112:         CMD_CLASS_LIST* pCmdClassList = GetCommandClassList((0 != GetNodeId()), SECURITY_KEY_NONE, (pCmdCap->prop
>> erties1 & 0x7F));
  113:         uint8_t ccListSize = 0;
B2:008D90 E4                CLR      A
B2:008D91 903A59            MOV      DPTR,#ccListSize
B2:008D94 F0                MOVX     @DPTR,A
  114: 
  115:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:008D95 12ACED            LCALL    ?L?COM00B1
  116: 
  117:         pTxBuf->ZW_MultiChannelCapabilityReport4byteV4Frame.cmdClass    = COMMAND_CLASS_MULTI_CHANNEL_V4;
B2:008D98 12D938            LCALL    ?L?COM01E6
B2:008D9B 12A5A3            LCALL    ?L?COM001F
B2:008D9E 740A              MOV      A,#0AH
B2:008DA0 122084            LCALL    ?C?CSTOPTR
  118:         pTxBuf->ZW_MultiChannelCapabilityReport4byteV4Frame.cmd         = MULTI_CHANNEL_CAPABILITY_REPORT_V4;
  119:         pTxBuf->ZW_MultiChannelCapabilityReport4byteV4Frame.properties1 = (pCmdCap->properties1 & 0x7f);
B2:008DA3 903A50            MOV      DPTR,#pCmdCap
B2:008DA6 F13E              ACALL    ?L?COM0029
B2:008DA8 547F              ANL      A,#07FH
B2:008DAA 12B69F            LCALL    ?L?COM00B2
  120:         if (IS_NULL(pCmdClassList) || IS_NULL(pCmdClassList->pList) || (0 == pCmdClassList->size) || IS_NULL(pDev
>> Class) || (0 == (pCmdCap->properties1 & 0x7f)))
B2:008DAD 903A56            MOV      DPTR,#pCmdClassList
B2:008DB0 122589            LCALL    ?C?PLDXDATA
B2:008DB3 E9                MOV      A,R1
B2:008DB4 4A                ORL      A,R2
B2:008DB5 601E              JZ       ?C0015?COMMANDCLASSMULTICHAN
B2:008DB7 1225BE            LCALL    ?C?PLDPTR
B2:008DBA E9                MOV      A,R1
B2:008DBB 4A                ORL      A,R2
B2:008DBC 6017              JZ       ?C0015?COMMANDCLASSMULTICHAN
B2:008DBE 919F              ACALL    ?L?COM007E
B2:008DC0 6013              JZ       ?C0015?COMMANDCLASSMULTICHAN
B2:008DC2 903A53            MOV      DPTR,#pDevClass
B2:008DC5 122589            LCALL    ?C?PLDXDATA
B2:008DC8 E9                MOV      A,R1
B2:008DC9 4A                ORL      A,R2
B2:008DCA 6009              JZ       ?C0015?COMMANDCLASSMULTICHAN
B2:008DCC 903A50            MOV      DPTR,#pCmdCap
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 547


B2:008DCF F13E              ACALL    ?L?COM0029
B2:008DD1 547F              ANL      A,#07FH
B2:008DD3 7006              JNZ      ?C0014?COMMANDCLASSMULTICHAN
B2:008DD5         ?C0015?COMMANDCLASSMULTICHAN:
  121:         {
  122:           FreeResponseBuffer();
B2:008DD5         
B2:008DD5 12A0B6            LCALL    FreeResponseBuffer
  123:           return RECEIVED_FRAME_STATUS_FAIL;
B2:008DD8 7F02              MOV      R7,#02H
B2:008DDA 22                RET      
  124:         }
B2:008DDB         ?C0014?COMMANDCLASSMULTICHAN:
  125:         else
  126:         {
  127:           pTxBuf->ZW_MultiChannelCapabilityReport4byteV4Frame.genericDeviceClass  = pDevClass->genericDeviceClass
>> ;
B2:008DDB 903A53            MOV      DPTR,#pDevClass
B2:008DDE 12AE26            LCALL    ?L?COM0049
B2:008DE1 FF                MOV      R7,A
B2:008DE2 903A4A            MOV      DPTR,#pTxBuf
B2:008DE5 12B57F            LCALL    ?L?COM00E6
B2:008DE8 EF                MOV      A,R7
B2:008DE9 122084            LCALL    ?C?CSTOPTR
  128:           pTxBuf->ZW_MultiChannelCapabilityReport4byteV4Frame.specificDeviceClass = pDevClass->specificDeviceClas
>> s;
B2:008DEC 903A53            MOV      DPTR,#pDevClass
B2:008DEF 12A5A3            LCALL    ?L?COM001F
B2:008DF2 121FF0            LCALL    ?C?CLDOPTR
B2:008DF5 12BF20            LCALL    ?L?COM0210
  129:           memcpy( &(pTxBuf->ZW_MultiChannelCapabilityReport4byteV4Frame.commandClass1), pCmdClassList->pList, pCm
>> dClassList->size);
B2:008DF8 919F              ACALL    ?L?COM007E
B2:008DFA FF                MOV      R7,A
B2:008DFB 12D900            LCALL    ?L?COM011F
B2:008DFE C003              PUSH     AR3
B2:008E00 C002              PUSH     AR2
B2:008E02 C001              PUSH     AR1
B2:008E04 903A56            MOV      DPTR,#pCmdClassList
B2:008E07 12B441            LCALL    ?L?COM0101
B2:008E0A 12C4EF            LCALL    ?L?COM0022
B2:008E0D D001              POP      AR1
B2:008E0F D002              POP      AR2
B2:008E11 D003              POP      AR3
B2:008E13 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  130:           ccListSize = pCmdClassList->size;
B2:008E16 919F              ACALL    ?L?COM007E
B2:008E18 903A59            MOV      DPTR,#ccListSize
B2:008E1B F0                MOVX     @DPTR,A
  131:         }
B2:008E1C         ?C0016?COMMANDCLASSMULTICHAN:
  132: 
  133:         if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  134:             (BYTE *)pTxBuf,
B2:008E1C 903A59            MOV      DPTR,#ccListSize
B2:008E1F E0                MOVX     A,@DPTR
B2:008E20 2405              ADD      A,#05H
B2:008E22 12A143            LCALL    ?L?COM001B
B2:008E25 12A137            LCALL    ?L?COM00BB
B2:008E28 6003              JZ       ?C0017?COMMANDCLASSMULTICHAN
  135:             sizeof(ZW_MULTI_CHANNEL_CAPABILITY_REPORT_1BYTE_V4_FRAME) + ccListSize - 1,
  136:             pTxOptionsEx,
  137:             ZCB_ResponseJobStatus))
  138:         {
  139:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 548


  140:           FreeResponseBuffer();
B2:008E2A 12A0B6            LCALL    FreeResponseBuffer
  141:         }
B2:008E2D         ?C0017?COMMANDCLASSMULTICHAN:
  142:       }
  143:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:008E2D 7FFF              MOV      R7,#0FFH
B2:008E2F 22                RET      
  144:       break;
  145: 
  146:     case MULTI_CHANNEL_END_POINT_FIND_V4:
B2:008E30         ?C0018?COMMANDCLASSMULTICHAN:
  147:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:008E30 903A43            MOV      DPTR,#rxOpt
B2:008E33 12A19D            LCALL    ?L?COM01BF
B2:008E36 5003              JNC      ?C0019?COMMANDCLASSMULTICHAN
  148:       {
  149:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008E38 7F02              MOV      R7,#02H
B2:008E3A 22                RET      
  150:       }
B2:008E3B         ?C0019?COMMANDCLASSMULTICHAN:
  151: 
  152:       pTxBuf = GetResponseBuffer();
B2:008E3B 12D977            LCALL    ?L?COM0293
B2:008E3E 7003              JNZ      ?C0020?COMMANDCLASSMULTICHAN
  153: 
  154:       if (IS_NULL(pTxBuf))
  155:       {
  156:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008E40 7F02              MOV      R7,#02H
B2:008E42 22                RET      
  157:       }
B2:008E43         ?C0020?COMMANDCLASSMULTICHAN:
  158: 
  159:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:008E43 12ACED            LCALL    ?L?COM00B1
  160: 
  161:       {
  162:         BYTE bufLen = 0;
B2:008E46 E4                CLR      A
B2:008E47 903A50            MOV      DPTR,#bufLen
B2:008E4A F0                MOVX     @DPTR,A
  163:         ZW_MULTI_CHANNEL_END_POINT_FIND_V4_FRAME* pcmdEpfind = (ZW_MULTI_CHANNEL_END_POINT_FIND_V4_FRAME *)pCmd;
B2:008E4B 12DAAC            LCALL    ?L?COM0445
B2:008E4E 903A51            MOV      DPTR,#pcmdEpfind
B2:008E51 12D935            LCALL    ?L?COM01E5
B2:008E54 12A5A3            LCALL    ?L?COM001F
B2:008E57 740C              MOV      A,#0CH
B2:008E59 12C9B0            LCALL    ?L?COM025A
  164: 
  165:         pTxBuf->ZW_MultiChannelEndPointFindReport1byteV4Frame.cmdClass = COMMAND_CLASS_MULTI_CHANNEL_V4;
  166:         pTxBuf->ZW_MultiChannelEndPointFindReport1byteV4Frame.cmd = MULTI_CHANNEL_END_POINT_FIND_REPORT_V4;
  167:         pTxBuf->ZW_MultiChannelEndPointFindReport1byteV4Frame.reportsToFollow = 0;
  168:         pTxBuf->ZW_MultiChannelEndPointFindReport1byteV4Frame.genericDeviceClass = pcmdEpfind->genericDeviceClass
>> ;
B2:008E5C 903A51            MOV      DPTR,#pcmdEpfind
B2:008E5F F13E              ACALL    ?L?COM0029
B2:008E61 FF                MOV      R7,A
B2:008E62 903A4A            MOV      DPTR,#pTxBuf
B2:008E65 12B57F            LCALL    ?L?COM00E6
B2:008E68 EF                MOV      A,R7
B2:008E69 122084            LCALL    ?C?CSTOPTR
  169:         pTxBuf->ZW_MultiChannelEndPointFindReport1byteV4Frame.specificDeviceClass = pcmdEpfind->specificDeviceCla
>> ss;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 549


B2:008E6C 903A51            MOV      DPTR,#pcmdEpfind
B2:008E6F 91A2              ACALL    ?L?COM007F
B2:008E71 12BF20            LCALL    ?L?COM0210
  170:         bufLen = FindEndPoints(pcmdEpfind->genericDeviceClass,
B2:008E74 903A51            MOV      DPTR,#pcmdEpfind
B2:008E77 F13E              ACALL    ?L?COM0029
B2:008E79 FF                MOV      R7,A
B2:008E7A 91A5              ACALL    ?L?COM0080
B2:008E7C FD                MOV      R5,A
B2:008E7D 12D900            LCALL    ?L?COM011F
B2:008E80 12D62C            LCALL    _FindEndPoints
B2:008E83 903A50            MOV      DPTR,#bufLen
B2:008E86 EF                MOV      A,R7
B2:008E87 F0                MOVX     @DPTR,A
  171:                                pcmdEpfind->specificDeviceClass,
  172:                                &pTxBuf->ZW_MultiChannelEndPointFindReport1byteV4Frame.variantgroup1.properties1);
>> 
  173: 
  174:         if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  175:             (BYTE *)pTxBuf,
B2:008E88 2405              ADD      A,#05H
B2:008E8A 12A143            LCALL    ?L?COM001B
B2:008E8D 12A137            LCALL    ?L?COM00BB
B2:008E90 6003              JZ       ?C0021?COMMANDCLASSMULTICHAN
  176:             sizeof(ZW_MULTI_CHANNEL_END_POINT_FIND_REPORT_1BYTE_V4_FRAME) + bufLen - 1 ,
  177:             pTxOptionsEx,
  178:             ZCB_ResponseJobStatus))
  179:         {
  180:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  181:           FreeResponseBuffer();
B2:008E92 12A0B6            LCALL    FreeResponseBuffer
  182:         }
B2:008E95         ?C0021?COMMANDCLASSMULTICHAN:
  183:       }
  184:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:008E95 7FFF              MOV      R7,#0FFH
B2:008E97 22                RET      
  185:       break;
  186:     case MULTI_CHANNEL_CMD_ENCAP_V4:
B2:008E98         ?C0022?COMMANDCLASSMULTICHAN:
  187:       CmdClassMultiChannelEncapsulateCmd(rxOpt,(ZW_MULTI_CHANNEL_CMD_ENCAP_V2_FRAME*) pCmd, cmdLength);
B2:008E98 12DAAC            LCALL    ?L?COM0445
B2:008E9B 904007            MOV      DPTR,#?_CmdClassMultiChannelEncapsulateCmd?BYTE+03H
B2:008E9E 1225A9            LCALL    ?C?PSTXDATA
B2:008EA1 903A49            MOV      DPTR,#cmdLength
B2:008EA4 E0                MOVX     A,@DPTR
B2:008EA5 90400A            MOV      DPTR,#?_CmdClassMultiChannelEncapsulateCmd?BYTE+06H
B2:008EA8 F0                MOVX     @DPTR,A
B2:008EA9 903A43            MOV      DPTR,#rxOpt
B2:008EAC 122589            LCALL    ?C?PLDXDATA
B2:008EAF 12AE2C            LCALL    _CmdClassMultiChannelEncapsulateCmd
  188:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:008EB2 7FFF              MOV      R7,#0FFH
B2:008EB4 22                RET      
  189:       break;
  190:     case MULTI_CHANNEL_AGGREGATED_MEMBERS_GET_V4:
B2:008EB5         ?C0023?COMMANDCLASSMULTICHAN:
  191:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:008EB5 903A43            MOV      DPTR,#rxOpt
B2:008EB8 12A19D            LCALL    ?L?COM01BF
B2:008EBB 5003              JNC      ?C0024?COMMANDCLASSMULTICHAN
  192:       {
  193:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008EBD 7F02              MOV      R7,#02H
B2:008EBF 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 550


  194:       }
B2:008EC0         ?C0024?COMMANDCLASSMULTICHAN:
  195: 
  196:       pTxBuf = GetResponseBuffer();
B2:008EC0 12D977            LCALL    ?L?COM0293
B2:008EC3 7003              JNZ      ?C0025?COMMANDCLASSMULTICHAN
  197: 
  198:       if (IS_NULL(pTxBuf))
  199:       {
  200:         return RECEIVED_FRAME_STATUS_FAIL;
B2:008EC5 7F02              MOV      R7,#02H
B2:008EC7 22                RET      
  201:       }
B2:008EC8         ?C0025?COMMANDCLASSMULTICHAN:
  202: 
  203:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:008EC8 12ACED            LCALL    ?L?COM00B1
  204: 
  205:       {
  206:         ZW_MULTI_CHANNEL_AGGREGATED_MEMBERS_GET_V4_FRAME* pcmdEpAgg = (ZW_MULTI_CHANNEL_AGGREGATED_MEMBERS_GET_V4
>> _FRAME *)pCmd;
B2:008ECB 12DAAC            LCALL    ?L?COM0445
B2:008ECE 903A50            MOV      DPTR,#pcmdEpAgg
B2:008ED1 12D935            LCALL    ?L?COM01E5
B2:008ED4 12A5A3            LCALL    ?L?COM001F
B2:008ED7 740F              MOV      A,#0FH
B2:008ED9 122084            LCALL    ?C?CSTOPTR
  207:         pTxBuf->ZW_MultiChannelAggregatedMembersReport1byteV4Frame.cmdClass = COMMAND_CLASS_MULTI_CHANNEL_V4;
  208:         pTxBuf->ZW_MultiChannelAggregatedMembersReport1byteV4Frame.cmd = MULTI_CHANNEL_AGGREGATED_MEMBERS_REPORT_
>> V4;
  209:         pTxBuf->ZW_MultiChannelAggregatedMembersReport1byteV4Frame.properties1 = pcmdEpAgg->properties1;
B2:008EDC 903A50            MOV      DPTR,#pcmdEpAgg
B2:008EDF F13E              ACALL    ?L?COM0029
B2:008EE1 12B69F            LCALL    ?L?COM00B2
  210:         pTxBuf->ZW_MultiChannelAggregatedMembersReport1byteV4Frame.numberOfBitMasks =
B2:008EE4 903A50            MOV      DPTR,#pcmdEpAgg
B2:008EE7 F13E              ACALL    ?L?COM0029
B2:008EE9 FF                MOV      R7,A
B2:008EEA 903A4A            MOV      DPTR,#pTxBuf
B2:008EED 125522            LCALL    ?L?COM0059
B2:008EF0 12B3AF            LCALL    _ReadAggregatedEndpointGroup
B2:008EF3 903A4A            MOV      DPTR,#pTxBuf
B2:008EF6 12B57F            LCALL    ?L?COM00E6
B2:008EF9 EF                MOV      A,R7
B2:008EFA 122084            LCALL    ?C?CSTOPTR
  211:           ReadAggregatedEndpointGroup( pcmdEpAgg->properties1,
  212:                                        &pTxBuf->ZW_MultiChannelAggregatedMembersReport1byteV4Frame.aggregatedMemb
>> ersBitMask1);
  213: 
  214:         if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  215:             (BYTE *)pTxBuf,
B2:008EFD C003              PUSH     AR3
B2:008EFF C002              PUSH     AR2
B2:008F01 C001              PUSH     AR1
B2:008F03 903A4A            MOV      DPTR,#pTxBuf
B2:008F06 91A2              ACALL    ?L?COM007F
B2:008F08 2404              ADD      A,#04H
B2:008F0A 12A143            LCALL    ?L?COM001B
B2:008F0D D001              POP      AR1
B2:008F0F D002              POP      AR2
B2:008F11 D003              POP      AR3
B2:008F13 12A13D            LCALL    ?L?COM00BD
B2:008F16 6003              JZ       ?C0026?COMMANDCLASSMULTICHAN
  216:             sizeof(ZW_MULTI_CHANNEL_AGGREGATED_MEMBERS_REPORT_1BYTE_V4_FRAME) + pTxBuf->ZW_MultiChannelAggregated
>> MembersReport1byteV4Frame.numberOfBitMasks - 1 ,
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 551


  217:             pTxOptionsEx,
  218:             ZCB_ResponseJobStatus))
  219:         {
  220:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  221:           FreeResponseBuffer();
B2:008F18 12A0B6            LCALL    FreeResponseBuffer
  222:         }
B2:008F1B         ?C0026?COMMANDCLASSMULTICHAN:
  223:       }
  224:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:008F1B 7FFF              MOV      R7,#0FFH
B2:008F1D 22                RET      
  225:       break;
  226: 
  227:   }
B2:008F1E         ?C0001?COMMANDCLASSMULTICHAN:
  228:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:008F1E 7F00              MOV      R7,#00H
  229: }
B2:008F20 22                RET      
----- FUNCTION _MultiChanCommandHandler (END) -------


----- FUNCTION ?L?COM0026 (BEGIN) -----
B2:008F21 903AD7            MOV      DPTR,#rxOpt
B2:008F24 122589            LCALL    ?C?PLDXDATA
B2:008F27         ?L?COM0027:
B2:008F27 E9                MOV      A,R1
B2:008F28 2404              ADD      A,#04H
B2:008F2A F9                MOV      R1,A
B2:008F2B E4                CLR      A
B2:008F2C 3A                ADDC     A,R2
B2:008F2D FA                MOV      R2,A
B2:008F2E 782A              MOV      R0,#LOW ?mustCommandBeHandled?BYTE
B2:008F30 7C43              MOV      R4,#HIGH ?mustCommandBeHandled?BYTE
B2:008F32 7D01              MOV      R5,#01H
B2:008F34 7E00              MOV      R6,#00H
B2:008F36 7F02              MOV      R7,#02H
B2:008F38 121F8D            LCALL    ?C?COPY
B2:008F3B         ?L?COM0028:
B2:008F3B 903ADA            MOV      DPTR,#pCmd
B2:008F3E         ?L?COM0029:
B2:008F3E 122589            LCALL    ?C?PLDXDATA
B2:008F41         ?L?COM002A:
B2:008F41 900002            MOV      DPTR,#02H
B2:008F44 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0026 (END) -------


----- FUNCTION _CmdClassSupported (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_CMD_CLASS_LIST.C'
   84: CmdClassSupported(security_key_t eKey,
   85:                   BYTE commandClass,
B2:008F47 903DE7            MOV      DPTR,#eKey
B2:008F4A 124765            LCALL    ?L?COM0102
B2:008F4D EB                MOV      A,R3
B2:008F4E 12A0E1            LCALL    ?L?COM0297
;---- Variable 'device_higest_secure_level' assigned to Register 'R4' ----
B2:008F51 AC07              MOV      R4,AR7
   86:                   BYTE command,
   87:                   BYTE* pSecurelist,
   88:                   BYTE securelistLen,
   89:                   BYTE* pNonSecurelist,
   90:                   BYTE nonSecurelistLen)
   91: {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 552


   92:   security_key_t device_higest_secure_level = GetHighestSecureLevel(ZW_GetSecurityKeys());
   93:   /*Only allow secure command list if node is securely included.*/
   94:   /*Check if cmd Class are supported in current mode (non-secure or secure)*/
   95:   if((SECURITY_KEY_NONE != device_higest_secure_level) && (eKey == device_higest_secure_level) && NON_NULL( pSecu
>> relist ))
B2:008F53 EC                MOV      A,R4
B2:008F54 6029              JZ       ?C0006?ZW_CMD_CLASS_LIST
B2:008F56 903DE7            MOV      DPTR,#eKey
B2:008F59 E0                MOVX     A,@DPTR
B2:008F5A 6C                XRL      A,R4
B2:008F5B 7022              JNZ      ?C0006?ZW_CMD_CLASS_LIST
B2:008F5D 903DEA            MOV      DPTR,#pSecurelist
B2:008F60 122589            LCALL    ?C?PLDXDATA
B2:008F63 E9                MOV      A,R1
B2:008F64 4A                ORL      A,R2
B2:008F65 6018              JZ       ?C0006?ZW_CMD_CLASS_LIST
   96:   {
   97:     if ((COMMAND_CLASS_BASIC == commandClass) ||
B2:008F67 903DE8            MOV      DPTR,#commandClass
B2:008F6A E0                MOVX     A,@DPTR
B2:008F6B FF                MOV      R7,A
B2:008F6C 6420              XRL      A,#020H
B2:008F6E 600D              JZ       ?C0008?ZW_CMD_CLASS_LIST
B2:008F70 903DED            MOV      DPTR,#securelistLen
B2:008F73 E0                MOVX     A,@DPTR
B2:008F74 9041E9            MOV      DPTR,#?_CheckCmdClass?BYTE+04H
B2:008F77 F0                MOVX     @DPTR,A
B2:008F78 12D7EC            LCALL    _CheckCmdClass
B2:008F7B 5002              JNC      ?C0006?ZW_CMD_CLASS_LIST
B2:008F7D         ?C0008?ZW_CMD_CLASS_LIST:
   98:         (TRUE == CheckCmdClass(commandClass, pSecurelist, securelistLen)))
   99:     {
  100:       return TRUE; /*cmd is supported!*/
B2:008F7D D3                SETB     C
B2:008F7E 22                RET      
  101:     }
  102:   }
B2:008F7F         ?C0006?ZW_CMD_CLASS_LIST:
  103: 
  104:   if ((SECURITY_KEY_S0 == device_higest_secure_level) &&     /* Security S0 */
  105:       (SECURITY_KEY_NONE == eKey) &&                         /* non-secure input */
  106:       (COMMAND_CLASS_MANUFACTURER_SPECIFIC == commandClass) &&
  107:       (MANUFACTURER_SPECIFIC_GET == command) &&
  108:       NON_NULL( pSecurelist ))                               /* Securely included */
B2:008F7F EC                MOV      A,R4
B2:008F80 6404              XRL      A,#04H
B2:008F82 701A              JNZ      ?C0010?ZW_CMD_CLASS_LIST
B2:008F84 903DE7            MOV      DPTR,#eKey
B2:008F87 E0                MOVX     A,@DPTR
B2:008F88 7014              JNZ      ?C0010?ZW_CMD_CLASS_LIST
B2:008F8A A3                INC      DPTR
B2:008F8B E0                MOVX     A,@DPTR
B2:008F8C B4720F            CJNE     A,#072H,?C0010?ZW_CMD_CLASS_LIST
B2:008F8F A3                INC      DPTR
B2:008F90 E0                MOVX     A,@DPTR
B2:008F91 B4040A            CJNE     A,#04H,?C0010?ZW_CMD_CLASS_LIST
B2:008F94 A3                INC      DPTR
B2:008F95 122589            LCALL    ?C?PLDXDATA
B2:008F98 E9                MOV      A,R1
B2:008F99 4A                ORL      A,R2
B2:008F9A 6002              JZ       ?C0010?ZW_CMD_CLASS_LIST
  109:   {
  110:     return TRUE; /*cmd is supported!*/
B2:008F9C D3                SETB     C
B2:008F9D 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 553


  111:   }
B2:008F9E         ?C0010?ZW_CMD_CLASS_LIST:
  112: 
  113:   if ((SECURITY_KEY_NONE == device_higest_secure_level) && (commandClass == COMMAND_CLASS_BASIC))
B2:008F9E EC                MOV      A,R4
B2:008F9F 7009              JNZ      ?C0011?ZW_CMD_CLASS_LIST
B2:008FA1 903DE8            MOV      DPTR,#commandClass
B2:008FA4 E0                MOVX     A,@DPTR
B2:008FA5 B42002            CJNE     A,#020H,?C0011?ZW_CMD_CLASS_LIST
  114:   {
  115:     /* Non-secure node always support CC Basic. */
  116:     return TRUE;
B2:008FA8 D3                SETB     C
B2:008FA9 22                RET      
  117:   }
B2:008FAA         ?C0011?ZW_CMD_CLASS_LIST:
  118: 
  119:   /*Check cmdClass is in non-secure list*/
  120:   if(NON_NULL( pNonSecurelist ))
B2:008FAA 903DEE            MOV      DPTR,#pNonSecurelist
B2:008FAD 122589            LCALL    ?C?PLDXDATA
B2:008FB0 E9                MOV      A,R1
B2:008FB1 4A                ORL      A,R2
B2:008FB2 6010              JZ       ?C0012?ZW_CMD_CLASS_LIST
  121:   {
  122:     return CheckCmdClass(commandClass, pNonSecurelist, nonSecurelistLen);
B2:008FB4 903DE8            MOV      DPTR,#commandClass
B2:008FB7 E0                MOVX     A,@DPTR
B2:008FB8 FF                MOV      R7,A
B2:008FB9 903DF1            MOV      DPTR,#nonSecurelistLen
B2:008FBC E0                MOVX     A,@DPTR
B2:008FBD 9041E9            MOV      DPTR,#?_CheckCmdClass?BYTE+04H
B2:008FC0 F0                MOVX     @DPTR,A
B2:008FC1 02D7EC            LJMP     _CheckCmdClass
  123:   }
B2:008FC4         ?C0012?ZW_CMD_CLASS_LIST:
  124:   return FALSE; /* Cmd not in list*/
B2:008FC4 C3                CLR      C
  125: }
B2:008FC5 22                RET      
----- FUNCTION _CmdClassSupported (END) -------


----- FUNCTION _handleCommandClassSupervision (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
  103: received_frame_status_t handleCommandClassSupervision(
  104:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:008FC6 903AD7            MOV      DPTR,#rxOpt
B2:008FC9 1225A9            LCALL    ?C?PSTXDATA
  105:   ZW_APPLICATION_TX_BUFFER *pCmd,
  106:   uint8_t cmdLength)
  107: {
  108: 
  109:   UNUSED(cmdLength);
  110: 
  111:   switch (pCmd->ZW_Common.cmd)
B2:008FCC 903ADA            MOV      DPTR,#pCmd
B2:008FCF 12A5A3            LCALL    ?L?COM001F
B2:008FD2 121FF0            LCALL    ?C?CLDOPTR
B2:008FD5 24FE              ADD      A,#0FEH
B2:008FD7 7003              JNZ      $ + 5H
B2:008FD9 029128            LJMP     ?C0018?COMMANDCLASSSUPERVISION
B2:008FDC 04                INC      A
B2:008FDD 6003              JZ       $ + 5H
B2:008FDF 029154            LJMP     ?C0005?COMMANDCLASSSUPERVISION
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 554


  112:   {
  113:     case SUPERVISION_GET:
B2:008FE2         ?C0006?COMMANDCLASSSUPERVISION:
  114:     {
  115:       /**
  116:        * SUPERVISION_GET handle:
  117:        * 1. Single-cast:
  118:        *    a. Transport_ApplicationCommandHandlerEx() is called by checking previously_receive_session_id.
  119:        *    b. single-cast trigger supervision_report is send back.
  120:        *
  121:        * 2. Multi-cast:
  122:        *    a. If multi-cast is received (rxStatus includes flag RECEIVE_STATUS_TYPE_MULTI).
  123:        *    b. Transport_ApplicationCommandHandlerEx() is called
  124:        *    c. Do not send supervision_report.
  125:        *
  126:        * 3. Multi-cast single-cast follow up:
  127:        *    a. Transport_ApplicationCommandHandlerEx is discarded on single-cast by checking previously_receive_s
>> ession_id.
  128:        *    b. single-cast trigger supervision_report is send back.
  129:        *
  130:        * 4. Single-cast CC multichannel bit-adr.:
  131:        *    CommandClassMultiChan handle bit addressing by calling each endpoint with the payload.
  132:        *    a. If Single-cast CC multichannel bit-adr. (rxStatus includes flag RECEIVE_STATUS_TYPE_MULTI).
  133:        *    b. Transport_ApplicationCommandHandlerEx() must be called every time. Check previously_received_desti
>> nation
  134:        *       differ from EXTRACT_SESSION_ID(pCmd->ZW_SupervisionGetFrame.sessionid)
  135:        *    c. Do not send supervision_report.
  136:        */
  137:       uint8_t properties1;
  138:       /*
  139:        * status need to be static to handle multi-cast single-cast follow up.
  140:        * Multi-cast get status Transport_ApplicationCommandHandlerEx() and sing-cast send Supervision report.
  141:        */
  142:       static cc_supervision_status_t status = CC_SUPERVISION_STATUS_NOT_SUPPORTED;
  143:       uint8_t duration;
  144:       TRANSMIT_OPTIONS_TYPE_SINGLE_EX * pTxOptions;
  145: 
  146:       SetFlagSupervisionEncap(TRUE);
B2:008FE2 D24F              SETB     ?SetFlagSupervisionEncap?BIT
B2:008FE4 12D7E1            LCALL    SetFlagSupervisionEncap
  147: 
  148:       if(previously_receive_session_id != CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_SupervisionGetFrame.properti
>> es1))
B2:008FE7 F13B              ACALL    ?L?COM0028
B2:008FE9 543F              ANL      A,#03FH
B2:008FEB FF                MOV      R7,A
B2:008FEC 903D9F            MOV      DPTR,#previously_receive_session_id
B2:008FEF E0                MOVX     A,@DPTR
B2:008FF0 6F                XRL      A,R7
B2:008FF1 6005              JZ       ?C0007?COMMANDCLASSSUPERVISION
  149:       {
  150:         /*
  151:          * Reset status session id is changed.
  152:          */
  153:         ZW_DEBUG_CC_SUPERVISION_SEND_BYTE('a');
  154:         status = CC_SUPERVISION_STATUS_NOT_SUPPORTED;
B2:008FF3 E4                CLR      A
B2:008FF4 903D98            MOV      DPTR,#status
B2:008FF7 F0                MOVX     @DPTR,A
  155:       }
B2:008FF8         ?C0007?COMMANDCLASSSUPERVISION:
  156:       /* ZF-378, ZF-379 fix - Make sure encapsulated CmdClass are supported (including possible endpoints) using 
>> current keyclass */
  157:       if (TRUE == ZAF_CC_MultiChannel_IsCCSupported(rxOpt, (ZW_APPLICATION_TX_BUFFER *)(((uint8_t *)pCmd) + sizeo
>> f(ZW_SUPERVISION_GET_FRAME))))
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 555


B2:008FF8 903ADA            MOV      DPTR,#pCmd
B2:008FFB 125522            LCALL    ?L?COM0059
B2:008FFE 903D83            MOV      DPTR,#?_ZAF_CC_MultiChannel_IsCCSupported?BYTE+03H
B2:009001 1225A9            LCALL    ?C?PSTXDATA
B2:009004 129465            LCALL    ?L?COM04D0
B2:009007 12AD80            LCALL    _ZAF_CC_MultiChannel_IsCCSupported
B2:00900A 5025              JNC      ?C0008?COMMANDCLASSSUPERVISION
  158:       {
  159:         if (TRUE == mustCommandBeHandled(rxOpt->destNode, CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_SupervisionG
>> etFrame.properties1)))
B2:00900C 128F21            LCALL    ?L?COM0026
B2:00900F 9172              ACALL    ?L?COM0524
B2:009011 9139              ACALL    mustCommandBeHandled
B2:009013 5021              JNC      ?C0010?COMMANDCLASSSUPERVISION
  160:         {
  161:           ZW_DEBUG_CC_SUPERVISION_SEND_BYTE('b');
  162:           status = (cc_supervision_status_t)Transport_ApplicationCommandHandlerEx(
  163:                   rxOpt,
  164:                   (ZW_APPLICATION_TX_BUFFER *)(((uint8_t *)pCmd) + sizeof(ZW_SUPERVISION_GET_FRAME)),
B2:009015 903ADA            MOV      DPTR,#pCmd
B2:009018 125522            LCALL    ?L?COM0059
B2:00901B B15D              ACALL    ?L?COM050A
B2:00901D 903ADA            MOV      DPTR,#pCmd
B2:009020 128CA2            LCALL    ?L?COM007F
B2:009023 903FE2            MOV      DPTR,#?_Transport_ApplicationCommandHandlerEx?BYTE+06H
B2:009026 9164              ACALL    ?L?COM04CF
B2:009028 F155              ACALL    _Transport_ApplicationCommandHandlerEx
B2:00902A 903D98            MOV      DPTR,#status
B2:00902D EF                MOV      A,R7
B2:00902E F0                MOVX     @DPTR,A
  165:                   (pCmd->ZW_SupervisionGetFrame.encapsulatedCommandLength));
  166:         }
  167:       }
B2:00902F 8005              SJMP     ?C0010?COMMANDCLASSSUPERVISION
B2:009031         ?C0008?COMMANDCLASSSUPERVISION:
  168:       else
  169:       {
  170:         status = CC_SUPERVISION_STATUS_NOT_SUPPORTED;
B2:009031 E4                CLR      A
B2:009032 903D98            MOV      DPTR,#status
B2:009035 F0                MOVX     @DPTR,A
  171:       }
B2:009036         ?C0010?COMMANDCLASSSUPERVISION:
  172:       /*
  173:        * Deactivate FlagSupervisionEncap because frame is extracted. (ZF_235)
  174:        */
  175:       SetFlagSupervisionEncap(FALSE);
B2:009036 C24F              CLR      ?SetFlagSupervisionEncap?BIT
B2:009038 12D7E1            LCALL    SetFlagSupervisionEncap
  176: 
  177:       /*
  178:        * Check whether the frame was sent using multicast or broadcast. In that case we MUST NOT
  179:        * respond to it.
  180:        * RECEIVE_STATUS_TYPE_MULTI applies in two scenarios: non-securely and Multichannel endpoint
  181:        * bit addressing frames.
  182:        * RECEIVE_STATUS_TYPE_BROAD applies in the case of S2 multicast frames.
  183:        */
  184:       if ((rxOpt->rxStatus & RECEIVE_STATUS_TYPE_MULTI) ||
B2:00903B 903AD7            MOV      DPTR,#rxOpt
B2:00903E 12AE26            LCALL    ?L?COM0049
B2:009041 20E303            JB       ACC.3,?C0012?COMMANDCLASSSUPERVISION
B2:009044 30E223            JNB      ACC.2,?C0011?COMMANDCLASSSUPERVISION
B2:009047         ?C0012?COMMANDCLASSSUPERVISION:
  185:           (rxOpt->rxStatus & RECEIVE_STATUS_TYPE_BROAD))
  186:       {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 556


  187:         ZW_DEBUG_CC_SUPERVISION_SEND_BYTE('c');
  188:         if (FALSE == mustCommandBeHandled(rxOpt->destNode, CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_Supervision
>> GetFrame.properties1)))
B2:009047 128F27            LCALL    ?L?COM0027
B2:00904A 9172              ACALL    ?L?COM0524
B2:00904C 9139              ACALL    mustCommandBeHandled
B2:00904E 4003              JC       ?C0013?COMMANDCLASSSUPERVISION
  189:         {
  190:           return RECEIVED_FRAME_STATUS_FAIL;
B2:009050 7F02              MOV      R7,#02H
B2:009052 22                RET      
  191:         }
B2:009053         ?C0013?COMMANDCLASSSUPERVISION:
  192: 
  193:         /*update previously session-id and reset previously_received_destination [node-id + endpoint]*/
  194:         previously_receive_session_id = CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_SupervisionGetFrame.properties
>> 1);
B2:009053 12C4D0            LCALL    ?L?COM0020
B2:009056 916B              ACALL    ?L?COM0522
B2:009058 7F02              MOV      R7,#02H
B2:00905A 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  195:         memcpy((uint8_t*)&previously_received_destination, (uint8_t*)&rxOpt->destNode, sizeof(MULTICHAN_DEST_NODE
>> _ID));
  196:         previously_rxStatus = rxOpt->rxStatus;
B2:00905D 903AD7            MOV      DPTR,#rxOpt
B2:009060 12AE26            LCALL    ?L?COM0049
B2:009063 903D9E            MOV      DPTR,#previously_rxStatus
B2:009066 F0                MOVX     @DPTR,A
  197: 
  198:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009067 7FFF              MOV      R7,#0FFH
B2:009069 22                RET      
  199:       }
B2:00906A         ?C0011?COMMANDCLASSSUPERVISION:
  200:       else
  201:       {
  202:         /*
  203:          * In this case the frame is sent using singlecast.
  204:          *
  205:          * We cannot respond to a singlecast in the following scenarios:
  206:          * - Session ID is unchanged from last singlecast
  207:          */
  208:           if ((FALSE == mustCommandBeHandled(rxOpt->destNode, CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_Supervis
>> ionGetFrame.properties1))) &&
B2:00906A 128F21            LCALL    ?L?COM0026
B2:00906D 9172              ACALL    ?L?COM0524
B2:00906F 9139              ACALL    mustCommandBeHandled
B2:009071 4009              JC       ?C0015?COMMANDCLASSSUPERVISION
B2:009073 903D9E            MOV      DPTR,#previously_rxStatus
B2:009076 E0                MOVX     A,@DPTR
B2:009077 7003              JNZ      ?C0015?COMMANDCLASSSUPERVISION
  209:               (0 == previously_rxStatus))
  210:         {
  211:           ZW_DEBUG_CC_SUPERVISION_SEND_BYTE('e');
  212:           return RECEIVED_FRAME_STATUS_FAIL;
B2:009079 7F02              MOV      R7,#02H
B2:00907B 22                RET      
  213:         }
  214:       }
B2:00907C         ?C0015?COMMANDCLASSSUPERVISION:
  215:       /*update previously session-id and reset previously_received_destination [node-id + endpoint]*/
  216:       previously_receive_session_id = CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_SupervisionGetFrame.properties1)
>> ;
B2:00907C 12C4D0            LCALL    ?L?COM0020
B2:00907F 916B              ACALL    ?L?COM0522
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 557


B2:009081 7F02              MOV      R7,#02H
B2:009083 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  217:       memcpy((uint8_t*)&previously_received_destination, (uint8_t*)&rxOpt->destNode, sizeof(MULTICHAN_DEST_NODE_I
>> D));
  218:       previously_rxStatus = 0;
B2:009086 E4                CLR      A
B2:009087 903D9E            MOV      DPTR,#previously_rxStatus
B2:00908A F0                MOVX     @DPTR,A
  219: 
  220:       duration = 0;
B2:00908B 903ADF            MOV      DPTR,#duration
B2:00908E F0                MOVX     @DPTR,A
  221:       properties1 = CC_SUPERVISION_EXTRACT_SESSION_ID(pCmd->ZW_SupervisionGetFrame.properties1);
B2:00908F 128F3B            LCALL    ?L?COM0028
B2:009092 543F              ANL      A,#03FH
B2:009094 903ADE            MOV      DPTR,#properties1
B2:009097 F0                MOVX     @DPTR,A
  222:       properties1 |= CC_SUPERVISION_ADD_MORE_STATUS_UPDATE(CC_SUPERVISION_MORE_STATUS_UPDATES_THIS_IS_LAST);
B2:009098 F0                MOVX     @DPTR,A
  223:       if ((CC_SUPERVISION_STATUS_FAIL != status) &&
  224:           (CC_SUPERVISION_STATUS_NOT_SUPPORTED != status) &&
  225:           NON_NULL(m_pGetReceivedHandler))
B2:009099 903D98            MOV      DPTR,#status
B2:00909C E0                MOVX     A,@DPTR
B2:00909D FF                MOV      R7,A
B2:00909E 6402              XRL      A,#02H
B2:0090A0 6053              JZ       ?C0017?COMMANDCLASSSUPERVISION
B2:0090A2 EF                MOV      A,R7
B2:0090A3 6050              JZ       ?C0017?COMMANDCLASSSUPERVISION
B2:0090A5 903DA0            MOV      DPTR,#_m_pGetReceivedHandler
B2:0090A8 D1A4              ACALL    ?L?COM0137
B2:0090AA 6049              JZ       ?C0017?COMMANDCLASSSUPERVISION
  226:       {
  227:         // Call the assigned function.
  228:         SUPERVISION_GET_RECEIVED_HANDLER_ARGS args;
  229: 
  230:         args.cmdClass = *(((uint8_t *)pCmd) + sizeof(ZW_SUPERVISION_GET_FRAME));
B2:0090AC 1270EB            LCALL    ?L?COM01E4
B2:0090AF 903AE3            MOV      DPTR,#args
B2:0090B2 F0                MOVX     @DPTR,A
  231:         args.cmd      = *(((uint8_t *)pCmd) + sizeof(ZW_SUPERVISION_GET_FRAME) + 1);
B2:0090B3 12CB9D            LCALL    ?L?COM0514
B2:0090B6 903AE4            MOV      DPTR,#args+01H
B2:0090B9 F0                MOVX     @DPTR,A
  232:         args.properties1 = pCmd->ZW_SupervisionGetFrame.properties1;
B2:0090BA 128F41            LCALL    ?L?COM002A
B2:0090BD 903AE5            MOV      DPTR,#args+02H
B2:0090C0 9164              ACALL    ?L?COM04CF
B2:0090C2 903AE8            MOV      DPTR,#args+05H
B2:0090C5 1225A9            LCALL    ?C?PSTXDATA
  233:         args.rxOpt = rxOpt;
  234:         args.status = status;
B2:0090C8 903D98            MOV      DPTR,#status
B2:0090CB E0                MOVX     A,@DPTR
B2:0090CC 903AE6            MOV      DPTR,#args+03H
B2:0090CF F0                MOVX     @DPTR,A
  235:         args.duration = 0;
B2:0090D0 E4                CLR      A
B2:0090D1 A3                INC      DPTR
B2:0090D2 F0                MOVX     @DPTR,A
  236: 
  237:         m_pGetReceivedHandler(&args);
B2:0090D3 7A3A              MOV      R2,#HIGH args
B2:0090D5 79E3              MOV      R1,#LOW args
B2:0090D7 12710A            LCALL    ?L?COM0284
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 558


B2:0090DA 12271A            LCALL    ?C?ICALL2
  238: 
  239:         status = args.status;
B2:0090DD 903AE6            MOV      DPTR,#args+03H
B2:0090E0 E0                MOVX     A,@DPTR
B2:0090E1 903D98            MOV      DPTR,#status
B2:0090E4 F0                MOVX     @DPTR,A
  240:         duration = args.duration;
B2:0090E5 903AE7            MOV      DPTR,#args+04H
B2:0090E8 E0                MOVX     A,@DPTR
B2:0090E9 903ADF            MOV      DPTR,#duration
B2:0090EC F0                MOVX     @DPTR,A
  241:         properties1 = args.properties1;
B2:0090ED 903AE5            MOV      DPTR,#args+02H
B2:0090F0 E0                MOVX     A,@DPTR
B2:0090F1 903ADE            MOV      DPTR,#properties1
B2:0090F4 F0                MOVX     @DPTR,A
  242:       }
B2:0090F5         ?C0017?COMMANDCLASSSUPERVISION:
  243: 
  244:       // When we have gotten the information, we can send a Supervision report.
  245:       RxToTxOptions(rxOpt, &pTxOptions);
B2:0090F5 7B01              MOV      R3,#01H
B2:0090F7 7A3A              MOV      R2,#HIGH pTxOptions
B2:0090F9 79E0              MOV      R1,#LOW pTxOptions
B2:0090FB 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:0090FE 1225A9            LCALL    ?C?PSTXDATA
B2:009101 903AD7            MOV      DPTR,#rxOpt
B2:009104 12AB5D            LCALL    ?L?COM0107
  246:       CmdClassSupervisionReportSend(
B2:009107 903AE0            MOV      DPTR,#pTxOptions
B2:00910A 122589            LCALL    ?C?PLDXDATA
B2:00910D 903ADE            MOV      DPTR,#properties1
B2:009110 E0                MOVX     A,@DPTR
B2:009111 FD                MOV      R5,A
B2:009112 903D98            MOV      DPTR,#status
B2:009115 E0                MOVX     A,@DPTR
B2:009116 904166            MOV      DPTR,#?_CmdClassSupervisionReportSend?BYTE+04H
B2:009119 F0                MOVX     @DPTR,A
B2:00911A 903ADF            MOV      DPTR,#duration
B2:00911D E0                MOVX     A,@DPTR
B2:00911E 904167            MOV      DPTR,#?_CmdClassSupervisionReportSend?BYTE+05H
B2:009121 F0                MOVX     @DPTR,A
B2:009122 12D87C            LCALL    _CmdClassSupervisionReportSend
  247:               pTxOptions,
  248:               properties1,
  249:               status,
  250:               duration);
  251:     }
  252:     return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009125 7FFF              MOV      R7,#0FFH
B2:009127 22                RET      
  253:     break;
  254: 
  255:     case SUPERVISION_REPORT:
B2:009128         ?C0018?COMMANDCLASSSUPERVISION:
  256:       if (((m_sessionId - 1) & 0x3F) == pCmd->ZW_SupervisionReportFrame.properties1)
B2:009128 128F3B            LCALL    ?L?COM0028
B2:00912B FF                MOV      R7,A
B2:00912C 903D99            MOV      DPTR,#m_sessionId
B2:00912F E0                MOVX     A,@DPTR
B2:009130 14                DEC      A
B2:009131 543F              ANL      A,#03FH
B2:009133 B5071B            CJNE     A,AR7,?C0019?COMMANDCLASSSUPERVISION
  257:       {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 559


  258:         // The received session ID matches the one we sent.
  259:         if (NON_NULL(m_pReportReceivedHandler))
B2:009136 903D9C            MOV      DPTR,#_m_pReportReceivedHandler
B2:009139 E0                MOVX     A,@DPTR
B2:00913A FE                MOV      R6,A
B2:00913B A3                INC      DPTR
B2:00913C E0                MOVX     A,@DPTR
B2:00913D 4E                ORL      A,R6
B2:00913E 600E              JZ       ?C0020?COMMANDCLASSSUPERVISION
  260:         {
  261:           m_pReportReceivedHandler(
B2:009140 128CA5            LCALL    ?L?COM0080
B2:009143 FF                MOV      R7,A
B2:009144 1270EB            LCALL    ?L?COM01E4
B2:009147 FD                MOV      R5,A
B2:009148 903D9C            MOV      DPTR,#_m_pReportReceivedHandler
B2:00914B 12D3E7            LCALL    ?L?COM0457
  262:                   pCmd->ZW_SupervisionReportFrame.status,
  263:                   pCmd->ZW_SupervisionReportFrame.duration);
  264:         }
B2:00914E         ?C0020?COMMANDCLASSSUPERVISION:
  265: 
  266:         ZW_TransportMulticast_clearTimeout();
B2:00914E 12B425            LCALL    ZW_TransportMulticast_clearTimeout
  267:       }
B2:009151         ?C0019?COMMANDCLASSSUPERVISION:
  268:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009151 7FFF              MOV      R7,#0FFH
B2:009153 22                RET      
  269:       break;
  270:   }
B2:009154         ?C0005?COMMANDCLASSSUPERVISION:
  271:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:009154 7F00              MOV      R7,#00H
  272: }
B2:009156 22                RET      
----- FUNCTION _handleCommandClassSupervision (END) -------


----- FUNCTION NvmApplicationDataMigrate (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\NVM_UTIL.C'
   51: NvmApplicationDataMigrate ( void )
   52: {
   53:   BYTE buffer[NETWORK_KEY_LENGTH];
   54:   BYTE version = 0x01; // By coming here, we know the data meets 6.51 req.
B2:009157 903A3C            MOV      DPTR,#version
B2:00915A 7401              MOV      A,#01H
B2:00915C F0                MOVX     @DPTR,A
   55:   WORD i;
   56:   // Current knowledge:
   57:   // At this point it is already detected that valid application data is present.
   58:   // Thus it must be detected which layout is in use: 6.51, 6.6x, 6.7x w/ or wo/ security.
   59:   // The bit mask will be created depending on the magic values to identify the firmware:
   60:   // the following bits will denote version.
   61:   // 000s 0nba
   62:   // 00a = 6.51, 0ba=6.6x.
   63:   // n = node info security.
   64:   // s = with security.
   65: 
   66:   version |= MemoryGetByte((WORD)&EEOFFS_SECURITY_RESERVED.EEOFFS_MAGIC_BYTE_field) == EEPROM_MAGIC_BYTE_VALUE ? 
>> BIT_SECURITY0_SUPPORTED : 0; // Security magic byte. If present, then security was enabled.
B2:00915D E0                MOVX     A,@DPTR
B2:00915E FF                MOV      R7,A
B2:00915F C007              PUSH     AR7
B2:009161 7E13              MOV      R6,#HIGH EEOFFS_SECURITY_RESERVED+011H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 560


B2:009163 7FEB              MOV      R7,#LOW EEOFFS_SECURITY_RESERVED+011H
B2:009165 121B79            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009168 7E00              MOV      R6,#00H
B2:00916A BF5602            CJNE     R7,#056H,?C0001?NVM_UTIL
B2:00916D 7E10              MOV      R6,#010H
B2:00916F         ?C0001?NVM_UTIL:
B2:00916F         ?C0002?NVM_UTIL:
B2:00916F D0E0              POP      ACC
B2:009171 4E                ORL      A,R6
B2:009172 903A3C            MOV      DPTR,#version
B2:009175 F0                MOVX     @DPTR,A
   67:   if (version & BIT_SECURITY0_SUPPORTED) // Security field was present, hence offset of 6.6x magic can be directl
>> y checked.
B2:009176 30E438            JNB      ACC.4,?C0003?NVM_UTIL
   68:   {
   69:     version |= MemoryGetByte((WORD)&EEOFFS_SECURITY_RESERVED.EEOFFS_NETWORK_SECURITY_field) == TRUE ? BIT_SECURIT
>> Y0_ENABLED : 0; // 0x04 = S0 Secure, 0x00 = non-secure.
B2:009179 E0                MOVX     A,@DPTR
B2:00917A FF                MOV      R7,A
B2:00917B C007              PUSH     AR7
B2:00917D 7E13              MOV      R6,#HIGH EEOFFS_SECURITY_RESERVED
B2:00917F 7FDA              MOV      R7,#LOW EEOFFS_SECURITY_RESERVED
B2:009181 121B79            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009184 7E00              MOV      R6,#00H
B2:009186 BF0102            CJNE     R7,#01H,?C0004?NVM_UTIL
B2:009189 7E04              MOV      R6,#04H
B2:00918B         ?C0004?NVM_UTIL:
B2:00918B         ?C0005?NVM_UTIL:
B2:00918B D0E0              POP      ACC
B2:00918D B122              ACALL    ?L?COM0494
B2:00918F C007              PUSH     AR7
B2:009191 12A124            LCALL    ?L?COM05EF
B2:009194 7E00              MOV      R6,#00H
B2:009196 BF4202            CJNE     R7,#042H,?C0006?NVM_UTIL
B2:009199 7E02              MOV      R6,#02H
B2:00919B         ?C0006?NVM_UTIL:
B2:00919B         ?C0007?NVM_UTIL:
B2:00919B D0E0              POP      ACC
B2:00919D B122              ACALL    ?L?COM0494
B2:00919F C007              PUSH     AR7
B2:0091A1 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far
B2:0091A3 7FF9              MOV      R7,#LOW EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far
B2:0091A5 121B79            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:0091A8 7E00              MOV      R6,#00H
B2:0091AA BF4202            CJNE     R7,#042H,?C0008?NVM_UTIL
B2:0091AD 7E08              MOV      R6,#08H
B2:0091AF         ?C0008?NVM_UTIL:
B2:0091AF         ?C0009?NVM_UTIL:
   70:     version |= MemoryGetByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far) == MAGIC_VALUE ? BIT_SDK_660_UPDATE 
>> : 0;
   71:     version |= MemoryGetByte((WORD)&EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far) == MAGIC_VALUE ? BIT_SDK_67X_
>> UPDATE : 0;
   72:   }
B2:0091AF 804F              SJMP     ?C0037?NVM_UTIL
B2:0091B1         ?C0003?NVM_UTIL:
   73:   else
   74:   {
   75:     WORD EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr = (WORD)(&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far);
B2:0091B1 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:0091B3 7FF7              MOV      R7,#LOW EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:0091B5 903A3F            MOV      DPTR,#EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr
B2:0091B8 12732A            LCALL    ?L?COM04D7
   76:     WORD EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far_addr = (WORD)(&EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE
>> _far) -sizeof(EEOFFS_NETWORK_SECURITY_STRUCT);
B2:0091BB 74F9              MOV      A,#LOW EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 561


B2:0091BD 24ED              ADD      A,#0EDH
B2:0091BF FE                MOV      R6,A
B2:0091C0 7413              MOV      A,#HIGH EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far
B2:0091C2 34FF              ADDC     A,#0FFH
B2:0091C4 A3                INC      DPTR
B2:0091C5 F0                MOVX     @DPTR,A
B2:0091C6 A3                INC      DPTR
B2:0091C7 CE                XCH      A,R6
B2:0091C8 F0                MOVX     @DPTR,A
   77: 
   78:     // Some sample apps have the EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far located after the
   79:     // EEOFFS_NETWORK_SECURITY_STRUCT, hence to find the value before update, the size of
   80:     // EEOFFS_NETWORK_SECURITY_STRUCT must be subtracted.
   81:     if (EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr > ((WORD)&EEOFFS_SECURITY_RESERVED))
B2:0091C9 D3                SETB     C
B2:0091CA ED                MOV      A,R5
B2:0091CB 94DA              SUBB     A,#LOW EEOFFS_SECURITY_RESERVED
B2:0091CD EC                MOV      A,R4
B2:0091CE 9413              SUBB     A,#HIGH EEOFFS_SECURITY_RESERVED
B2:0091D0 400B              JC       ?C0011?NVM_UTIL
   82:     {
   83:       EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr -= sizeof(EEOFFS_NETWORK_SECURITY_STRUCT);
B2:0091D2 903A3F            MOV      DPTR,#EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr
B2:0091D5 74FF              MOV      A,#0FFH
B2:0091D7 75F0ED            MOV      B,#0EDH
B2:0091DA 122143            LCALL    ?C?IILDX
   84:     }
B2:0091DD         ?C0011?NVM_UTIL:
   85: 
   86:     version |= MemoryGetByte(EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr) == MAGIC_VALUE ? BIT_SDK_660_UPDATE : 
>> 0;
B2:0091DD 903A3C            MOV      DPTR,#version
B2:0091E0 E0                MOVX     A,@DPTR
B2:0091E1 FF                MOV      R7,A
B2:0091E2 C007              PUSH     AR7
B2:0091E4 903A3F            MOV      DPTR,#EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far_addr
B2:0091E7 12DB2D            LCALL    ?L?COM04D6
B2:0091EA BF4202            CJNE     R7,#042H,?C0012?NVM_UTIL
B2:0091ED 7E02              MOV      R6,#02H
B2:0091EF         ?C0012?NVM_UTIL:
B2:0091EF         ?C0013?NVM_UTIL:
B2:0091EF D0E0              POP      ACC
B2:0091F1 B122              ACALL    ?L?COM0494
B2:0091F3 C007              PUSH     AR7
B2:0091F5 903A41            MOV      DPTR,#EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far_addr
B2:0091F8 12DB2D            LCALL    ?L?COM04D6
B2:0091FB BF4202            CJNE     R7,#042H,?C0014?NVM_UTIL
B2:0091FE 7E08              MOV      R6,#08H
B2:009200         ?C0014?NVM_UTIL:
B2:009200         ?C0015?NVM_UTIL:
B2:009200         
B2:009200 D0E0              POP      ACC
B2:009202 4E                ORL      A,R6
B2:009203 903A3C            MOV      DPTR,#version
B2:009206 F0                MOVX     @DPTR,A
   87:     version |= MemoryGetByte(EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far_addr) == MAGIC_VALUE ? BIT_SDK_67X_UP
>> DATE : 0;
   88:   }
B2:009207         ?C0010?NVM_UTIL:
   89: 
   90:   switch (version)
B2:009207 903A3C            MOV      DPTR,#version
B2:00920A E0                MOVX     A,@DPTR
B2:00920B 14                DEC      A
B2:00920C 7002              JNZ      $ + 4H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 562


B2:00920E 611B              AJMP     ?C0029?NVM_UTIL
B2:009210 24F0              ADD      A,#0F0H
B2:009212 7002              JNZ      $ + 4H
B2:009214 611B              AJMP     ?C0029?NVM_UTIL
B2:009216 24FE              ADD      A,#0FEH
B2:009218 7002              JNZ      $ + 4H
B2:00921A 611B              AJMP     ?C0029?NVM_UTIL
B2:00921C 24FE              ADD      A,#0FEH
B2:00921E 7002              JNZ      $ + 4H
B2:009220 41F6              AJMP     ?C0026?NVM_UTIL
B2:009222 24FE              ADD      A,#0FEH
B2:009224 7002              JNZ      $ + 4H
B2:009226 41BB              AJMP     ?C0022?NVM_UTIL
B2:009228 2414              ADD      A,#014H
B2:00922A 6002              JZ       $ + 4H
B2:00922C 611E              AJMP     ?C0033?NVM_UTIL
   91:   {
   92:     case 0x03:  // We are coming from 6.6x without security.
B2:00922E         ?C0017?NVM_UTIL:
   93:                 // Need to relocate data, and set default NodeInfo secure to 0 (non-secure).
   94:       for (i = (((WORD)&nvmApplicationDescriptor - ((WORD)&EEOFFS_SECURITY_RESERVED + sizeof(EEOFFS_NETWORK_SECUR
>> ITY_STRUCT))) - sizeof(buffer)); !(i & 0x8000); i -= sizeof(buffer))
B2:00922E C3                CLR      C
B2:00922F 74FA              MOV      A,#LOW nvmApplicationDescriptor
B2:009231 94DA              SUBB     A,#LOW EEOFFS_SECURITY_RESERVED
B2:009233 FF                MOV      R7,A
B2:009234 7413              MOV      A,#HIGH nvmApplicationDescriptor
B2:009236 9413              SUBB     A,#HIGH EEOFFS_SECURITY_RESERVED
B2:009238 CF                XCH      A,R7
B2:009239 24DD              ADD      A,#0DDH
B2:00923B CF                XCH      A,R7
B2:00923C 34FF              ADDC     A,#0FFH
B2:00923E 903A3D            MOV      DPTR,#i
B2:009241 F0                MOVX     @DPTR,A
B2:009242 A3                INC      DPTR
B2:009243 EF                MOV      A,R7
B2:009244 F0                MOVX     @DPTR,A
B2:009245         ?C0018?NVM_UTIL:
B2:009245 F141              ACALL    ?L?COM05CE
B2:009247 FF                MOV      R7,A
B2:009248 EE                MOV      A,R6
B2:009249 20E735            JB       ACC.7,?C0019?NVM_UTIL
   95:       {
   96:         MemoryGetBuffer(((WORD)&EEOFFS_SECURITY_RESERVED + i), buffer, sizeof(buffer));
B2:00924C EF                MOV      A,R7
B2:00924D 24DA              ADD      A,#LOW EEOFFS_SECURITY_RESERVED
B2:00924F FF                MOV      R7,A
B2:009250 EE                MOV      A,R6
B2:009251 3413              ADDC     A,#HIGH EEOFFS_SECURITY_RESERVED
B2:009253 FE                MOV      R6,A
B2:009254 7123              ACALL    ?L?COM0276
B2:009256 904101            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B2:009259 7410              MOV      A,#010H
B2:00925B 12DA75            LCALL    ?L?COM0427
B2:00925E 903A3E            MOV      DPTR,#i+01H
B2:009261 E0                MOVX     A,@DPTR
B2:009262 2F                ADD      A,R7
B2:009263 FF                MOV      R7,A
B2:009264 903A3D            MOV      DPTR,#i
B2:009267 E0                MOVX     A,@DPTR
B2:009268 3E                ADDC     A,R6
B2:009269 FE                MOV      R6,A
B2:00926A 7123              ACALL    ?L?COM0276
B2:00926C 903E15            MOV      DPTR,#?_MemoryPutBuffer?BYTE+05H
B2:00926F E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 563


B2:009270 F0                MOVX     @DPTR,A
B2:009271 A3                INC      DPTR
B2:009272 7410              MOV      A,#010H
B2:009274 F11A              ACALL    ?L?COM00EF
B2:009276 121B97            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
   97:         MemoryPutBuffer(((WORD)&EEOFFS_SECURITY_RESERVED + sizeof(EEOFFS_NETWORK_SECURITY_STRUCT) + i), buffer, s
>> izeof(buffer), NULL);
   98:       }
B2:009279 903A3D            MOV      DPTR,#i
B2:00927C 12738B            LCALL    ?L?COM0591
B2:00927F 80C4              SJMP     ?C0018?NVM_UTIL
B2:009281         ?C0019?NVM_UTIL:
   99: 
  100:       if (i != 0)
B2:009281 903A3D            MOV      DPTR,#i
B2:009284 E0                MOVX     A,@DPTR
B2:009285 7002              JNZ      ?C0036?NVM_UTIL
B2:009287 A3                INC      DPTR
B2:009288 E0                MOVX     A,@DPTR
B2:009289         ?C0036?NVM_UTIL:
B2:009289 7002              JNZ      $ + 4H
B2:00928B 611B              AJMP     ?C0038?NVM_UTIL
  101:       {
  102:         i += sizeof(buffer);
B2:00928D 903A3D            MOV      DPTR,#i
B2:009290 127161            LCALL    ?L?COM0301
  103:         MemoryGetBuffer(((WORD)&EEOFFS_SECURITY_RESERVED), buffer, i);
B2:009293 7E13              MOV      R6,#HIGH EEOFFS_SECURITY_RESERVED
B2:009295 7FDA              MOV      R7,#LOW EEOFFS_SECURITY_RESERVED
B2:009297 7123              ACALL    ?L?COM0276
B2:009299 903A3D            MOV      DPTR,#i
B2:00929C A3                INC      DPTR
B2:00929D E0                MOVX     A,@DPTR
B2:00929E 904101            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B2:0092A1 12DA75            LCALL    ?L?COM0427
B2:0092A4 7123              ACALL    ?L?COM0276
B2:0092A6 903A3D            MOV      DPTR,#i
B2:0092A9 E0                MOVX     A,@DPTR
B2:0092AA FD                MOV      R5,A
B2:0092AB A3                INC      DPTR
B2:0092AC E0                MOVX     A,@DPTR
B2:0092AD 903E15            MOV      DPTR,#?_MemoryPutBuffer?BYTE+05H
B2:0092B0 CD                XCH      A,R5
B2:0092B1 F0                MOVX     @DPTR,A
B2:0092B2 A3                INC      DPTR
B2:0092B3 ED                MOV      A,R5
B2:0092B4 F11A              ACALL    ?L?COM00EF
B2:0092B6 121B97            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
  104:         MemoryPutBuffer(((WORD)&EEOFFS_SECURITY_RESERVED + sizeof(EEOFFS_NETWORK_SECURITY_STRUCT)), buffer, i, NU
>> LL);
  105:       }
B2:0092B9         ?C0021?NVM_UTIL:
  106:       MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far, MAGIC_VALUE);
  107:       MemoryPutByte((WORD)&EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far, MAGIC_VALUE);
  108:       break;
B2:0092B9 8060              SJMP     ?C0038?NVM_UTIL
  109: 
  110:     case 0x17:  // We are coming from 6.6x with security and S0 on end-points.
B2:0092BB         ?C0022?NVM_UTIL:
  111:                 // No need to relocate data, only fetch S0 key and push to protocol and update NodeInfo 0x04 (S0 
>> secure).
  112:       for (i = 0; i < ((NUMBER_OF_ENDPOINTS + 1) * ASSOCIATION_SIZE); ++i)
B2:0092BB E4                CLR      A
B2:0092BC 903A3D            MOV      DPTR,#i
B2:0092BF F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 564


B2:0092C0 A3                INC      DPTR
B2:0092C1 F0                MOVX     @DPTR,A
B2:0092C2         ?C0023?NVM_UTIL:
B2:0092C2 903A3D            MOV      DPTR,#i
B2:0092C5 1265F9            LCALL    ?L?COM0199
B2:0092C8 9405              SUBB     A,#05H
B2:0092CA EE                MOV      A,R6
B2:0092CB 9400              SUBB     A,#00H
B2:0092CD 5027              JNC      ?C0026?NVM_UTIL
  113:       {
  114:         BYTE transportCap = MemoryGetByte( (WORD)&EEOFFSET_TRANSPORT_CAPABILITIES_START_far[i]);
B2:0092CF 12D9A8            LCALL    ?L?COM032C
B2:0092D2 903A3F            MOV      DPTR,#transportCap
B2:0092D5 EF                MOV      A,R7
B2:0092D6 F0                MOVX     @DPTR,A
  115: 
  116:         (((EEOFFSET_TRANSPORT_CAPABILITIES_STRUCT*)&transportCap))->security = SECURITY_KEY_S0;
B2:0092D7 E0                MOVX     A,@DPTR
B2:0092D8 54F0              ANL      A,#0F0H
B2:0092DA 4404              ORL      A,#04H
B2:0092DC F0                MOVX     @DPTR,A
  117: 
  118:         MemoryPutByte((WORD)&EEOFFSET_TRANSPORT_CAPABILITIES_START_far[i], transportCap);
B2:0092DD F141              ACALL    ?L?COM05CE
B2:0092DF 24F2              ADD      A,#LOW EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:0092E1 F9                MOV      R1,A
B2:0092E2 7413              MOV      A,#HIGH EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:0092E4 3E                ADDC     A,R6
B2:0092E5 FE                MOV      R6,A
B2:0092E6 AF01              MOV      R7,AR1
B2:0092E8 A3                INC      DPTR
B2:0092E9 E0                MOVX     A,@DPTR
B2:0092EA FD                MOV      R5,A
B2:0092EB 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
  119:       }
B2:0092EE 903A3D            MOV      DPTR,#i
B2:0092F1 123F7F            LCALL    ?L?COM0081
B2:0092F4 80CC              SJMP     ?C0023?NVM_UTIL
  120:       /** Fall-through */
  121: #ifdef slave_routing
  122: #else
  123:     case 0x15:  // We are coming from 6.51 with security set and S0 key.
B2:0092F6         ?C0026?NVM_UTIL:
  124:                 // No need to relocate data, only fetch S0 key and push to protocol.
  125:       MemoryGetBuffer((WORD)&EEOFFS_SECURITY_RESERVED.EEOFFS_NETWORK_KEY_START_field, buffer, sizeof(buffer));
B2:0092F6 711F              ACALL    ?L?COM0275
B2:0092F8 12734B            LCALL    ?L?COM0502
B2:0092FB 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetBuffer
  126:       ZW_SetSecurityS0NetworkKey(buffer);
B2:0092FE 7123              ACALL    ?L?COM0276
B2:009300 121B01            LCALL    ?INTERBANK_TABLE?_ZW_SetSecurityS0NetworkKey
  127:       /*Clear application NMV key!*/
  128:       memset(buffer, 0,  sizeof(buffer));
B2:009303 7123              ACALL    ?L?COM0276
B2:009305 7D10              MOV      R5,#010H
B2:009307 E4                CLR      A
B2:009308 FF                MOV      R7,A
B2:009309 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
  129:       MemoryPutBuffer((WORD)&EEOFFS_SECURITY_RESERVED.EEOFFS_NETWORK_KEY_START_field, buffer,  sizeof(buffer), NU
>> LL);
B2:00930C 711F              ACALL    ?L?COM0275
B2:00930E 903E15            MOV      DPTR,#?_MemoryPutBuffer?BYTE+05H
B2:009311 E4                CLR      A
B2:009312 F0                MOVX     @DPTR,A
B2:009313 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 565


B2:009314 7410              MOV      A,#010H
B2:009316 F11A              ACALL    ?L?COM00EF
B2:009318 121B97            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
  130:       /** Fall-through */
  131: #endif
  132:     case 0x13:  // We are coming from 6.6x with security, but no S0 key.
  133:     case 0x11:  // We are coming from 6.51 with security, but no S0 key.
  134:     case 0x01:
B2:00931B         ?C0029?NVM_UTIL:
  135:       MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far, MAGIC_VALUE); /* Now ASSOCIATION EP should be
>>  OK */
B2:00931B         
B2:00931B 12D9D2            LCALL    ?L?COM0387
  136:       MemoryPutByte((WORD)&EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far, MAGIC_VALUE);
  137:       break;
  138: 
  139:     case 0x0B:
  140:     case 0x1B:
  141:       /*FWU from SDK 6.7x. Nothing to migrate*/
  142:       break;
  143:     default:
  144:       break;
  145:   }
  146: }
B2:00931E         ?C0033?NVM_UTIL:
B2:00931E 22                RET      
----- FUNCTION NvmApplicationDataMigrate (END) -------


----- FUNCTION ?L?COM0275 (BEGIN) -----
B2:00931F 7E13              MOV      R6,#HIGH EEOFFS_SECURITY_RESERVED+01H
B2:009321 7FDB              MOV      R7,#LOW EEOFFS_SECURITY_RESERVED+01H
B2:009323         ?L?COM0276:
B2:009323 7B01              MOV      R3,#01H
B2:009325 7A3A              MOV      R2,#HIGH buffer
B2:009327 792C              MOV      R1,#LOW buffer
B2:009329 22                RET      
----- FUNCTION ?L?COM0275 (END) -------


----- FUNCTION _ApplicationNodeInformation (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  129: ApplicationNodeInformation(
  130:   BYTE *deviceOptionsMask,
B2:00932A 903C2E            MOV      DPTR,#deviceOptionsMask
B2:00932D B12A              ACALL    ?L?COM0424
B2:00932F 6001              JZ       ?C0001?ZW_TRANSPORTSECPROTOCOL
B2:009331 D3                SETB     C
B2:009332         ?C0001?ZW_TRANSPORTSECPROTOCOL:
B2:009332         ?C0002?ZW_TRANSPORTSECPROTOCOL:
B2:009332 12DBC3            LCALL    ?L?COM05EB
B2:009335 A3                INC      DPTR
B2:009336 F0                MOVX     @DPTR,A
B2:009337 128BB4            LCALL    GetCommandClassList
B2:00933A 903C3A            MOV      DPTR,#pCmdClassList
B2:00933D 1225A9            LCALL    ?C?PSTXDATA
  131:   APPL_NODE_TYPE *nodeType,
  132:   BYTE **nodeParm,
  133:   BYTE *parmLength)
  134: {
  135:   CMD_CLASS_LIST* pCmdClassList = GetCommandClassList((0 != GetNodeId()), SECURITY_KEY_NONE, 0);
  136: 
  137: 
  138:   *deviceOptionsMask  = m_AppInfo.u.pNifs->deviceOptionsMask;  //APPLICATION_NODEINFO_LISTENING | APPLICATION_NOD
>> EINFO_OPTIONAL_FUNCTIONALITY;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 566


B2:009340 915E              ACALL    ?L?COM037F
B2:009342 90000C            MOV      DPTR,#0CH
B2:009345 121FF0            LCALL    ?C?CLDOPTR
B2:009348 FF                MOV      R7,A
B2:009349 903C2E            MOV      DPTR,#deviceOptionsMask
B2:00934C 123F95            LCALL    ?L?COM00C0
  139:   nodeType->generic   = m_AppInfo.u.pNifs->nodeType.generic;  /* Generic device class */
B2:00934F 915E              ACALL    ?L?COM037F
B2:009351 90000D            MOV      DPTR,#0DH
B2:009354 12DBCB            LCALL    ?L?COM05EC
B2:009357 123F95            LCALL    ?L?COM00C0
  140:   nodeType->specific  = m_AppInfo.u.pNifs->nodeType.specific; /* Specific device class */
B2:00935A 915E              ACALL    ?L?COM037F
B2:00935C 90000E            MOV      DPTR,#0EH
B2:00935F 12DBCB            LCALL    ?L?COM05EC
B2:009362 12A5A3            LCALL    ?L?COM001F
B2:009365 EF                MOV      A,R7
B2:009366 122084            LCALL    ?C?CSTOPTR
  141:   *nodeParm = pCmdClassList->pList;
B2:009369 903C3A            MOV      DPTR,#pCmdClassList
B2:00936C 12B441            LCALL    ?L?COM0101
B2:00936F C003              PUSH     AR3
B2:009371 C002              PUSH     AR2
B2:009373 C001              PUSH     AR1
B2:009375 903C34            MOV      DPTR,#nodeParm
B2:009378 122589            LCALL    ?C?PLDXDATA
B2:00937B 1225DE            LCALL    ?C?PSTPTR
  142:   *parmLength = pCmdClassList->size;
B2:00937E 903C3A            MOV      DPTR,#pCmdClassList
B2:009381 128CA2            LCALL    ?L?COM007F
B2:009384 FF                MOV      R7,A
B2:009385 903C37            MOV      DPTR,#parmLength
B2:009388 122589            LCALL    ?C?PLDXDATA
B2:00938B EF                MOV      A,R7
B2:00938C 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ApplicationNodeInformation (END) -------


----- FUNCTION _SendFirmwareUpdateStatusReport (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  758: SendFirmwareUpdateStatusReport(BYTE status)
  759: {
B2:00938F 90436C            MOV      DPTR,#status
B2:009392 EF                MOV      A,R7
B2:009393 F0                MOVX     @DPTR,A
  760:   BYTE waitTime = WAITTIME_FWU_FAIL;
  761:   TimerCancelFwUpdateFrameGet();
B2:009394 A3                INC      DPTR
B2:009395 7402              MOV      A,#02H
B2:009397 F0                MOVX     @DPTR,A
  762: 
B2:009398 F12C              ACALL    TimerCancelFwUpdateFrameGet
  763:   if(FALSE == myOta.fwExtern)
B2:00939A 90387F            MOV      DPTR,#myOta+011H
B2:00939D E0                MOVX     A,@DPTR
B2:00939E 7029              JNZ      ?C0090?OTA_UTIL
  764:   {
  765:     BOOL retVal = FALSE;
B2:0093A0 C24A              CLR      retVal
  766:     if((FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_STORED_V4 == status) ||
B2:0093A2 90436C            MOV      DPTR,#status
B2:0093A5 E0                MOVX     A,@DPTR
B2:0093A6 FF                MOV      R7,A
B2:0093A7 64FE              XRL      A,#0FEH
B2:0093A9 6008              JZ       ?C0092?OTA_UTIL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 567


B2:0093AB EF                MOV      A,R7
B2:0093AC F4                CPL      A
B2:0093AD 6004              JZ       ?C0092?OTA_UTIL
B2:0093AF EF                MOV      A,R7
B2:0093B0 B4FD0E            CJNE     A,#0FDH,?C0091?OTA_UTIL
B2:0093B3         ?C0092?OTA_UTIL:
  767:         (FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_V4 == status) ||
  768:         (FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_WAITING_FOR_ACTIVATION_V4 == status))
  769:     {
  770:       retVal = ZW_FirmwareUpdate_NVM_isValidCRC16();
B2:0093B3 121D40            LCALL    ?INTERBANK_TABLE?ZW_FirmwareUpdate_NVM_isValidCRC16
B2:0093B6 924A              MOV      retVal,C
  771:       if(FALSE == retVal)
B2:0093B8 204A06            JB       retVal,?C0091?OTA_UTIL
  772:       {
  773:         status = FIRMWARE_UPDATE_MD_STATUS_REPORT_INSUFFICIENT_MEMORY_V4;
B2:0093BB 90436C            MOV      DPTR,#status
B2:0093BE 7407              MOV      A,#07H
B2:0093C0 F0                MOVX     @DPTR,A
  774:       }
  775:     }
B2:0093C1         ?C0091?OTA_UTIL:
  776:     ZW_FirmwareUpdate_NVM_Set_NEWIMAGE(retVal);
B2:0093C1 A24A              MOV      C,retVal
B2:0093C3 E4                CLR      A
B2:0093C4 33                RLC      A
B2:0093C5 FF                MOV      R7,A
B2:0093C6 121D3B            LCALL    ?INTERBANK_TABLE?_ZW_FirmwareUpdate_NVM_Set_NEWIMAGE
  777:   }
B2:0093C9         ?C0090?OTA_UTIL:
  778: 
  779:   if((FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_STORED_V4 == status) ||
B2:0093C9 90436C            MOV      DPTR,#status
B2:0093CC E0                MOVX     A,@DPTR
B2:0093CD FD                MOV      R5,A
B2:0093CE 64FE              XRL      A,#0FEH
B2:0093D0 6008              JZ       ?C0095?OTA_UTIL
B2:0093D2 ED                MOV      A,R5
B2:0093D3 F4                CPL      A
B2:0093D4 6004              JZ       ?C0095?OTA_UTIL
B2:0093D6 ED                MOV      A,R5
B2:0093D7 B4FD06            CJNE     A,#0FDH,?C0094?OTA_UTIL
B2:0093DA         ?C0095?OTA_UTIL:
  780:       (FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_V4 == status) ||
  781:       (FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_WAITING_FOR_ACTIVATION_V4 == status))
  782:   {
  783:     waitTime = WAITTIME_FWU_SUCCESS;
B2:0093DA 90436D            MOV      DPTR,#waitTime
B2:0093DD 741E              MOV      A,#01EH
B2:0093DF F0                MOVX     @DPTR,A
  784:   }
B2:0093E0         ?C0094?OTA_UTIL:
  785: 
  786:   if(JOB_STATUS_SUCCESS != CmdClassFirmwareUpdateMdStatusReport( &myOta.rxOpt,
B2:0093E0 90436D            MOV      DPTR,#waitTime
B2:0093E3 F14D              ACALL    ?L?COM05F0
B2:0093E5 903BA4            MOV      DPTR,#?_CmdClassFirmwareUpdateMdStatusReport?BYTE+04H
B2:0093E8 123FDA            LCALL    ?L?COM0212
B2:0093EB A3                INC      DPTR
B2:0093EC 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_FinishFwUpdate
B2:0093EE F0                MOVX     @DPTR,A
B2:0093EF A3                INC      DPTR
B2:0093F0 747B              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_FinishFwUpdate
B2:0093F2 F0                MOVX     @DPTR,A
B2:0093F3 12B706            LCALL    _CmdClassFirmwareUpdateMdStatusReport
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 568


B2:0093F6 EF                MOV      A,R7
B2:0093F7 6006              JZ       ?C0097?OTA_UTIL
  787:                                                               status,
  788:                                                               waitTime,
  789:                                                               ZCB_FinishFwUpdate))
  790:   {
  791:     /*Failed to send frame and we do not get a CB. Inform app we are finish*/
  792:     ZCB_FinishFwUpdate(NULL);
B2:0093F9 12B299            LCALL    ?L?COM0069
B2:0093FC 12D459            LCALL    _ZCB_FinishFwUpdate
  793:   }
  794: }
B2:0093FF         ?C0097?OTA_UTIL:
B2:0093FF 22                RET      
----- FUNCTION _SendFirmwareUpdateStatusReport (END) -------


----- FUNCTION OTA_Invalidate (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  271: OTA_Invalidate()
  272: {
  273:   /* Mark possible current NVM Image Not Valid */
  274:   ZW_FirmwareUpdate_NVM_Set_NEWIMAGE(0);
B2:009400 E4                CLR      A
B2:009401 FF                MOV      R7,A
B2:009402 021D3B            LJMP     ?INTERBANK_TABLE?_ZW_FirmwareUpdate_NVM_Set_NEWIMAGE
----- FUNCTION OTA_Invalidate (END) -------


----- FUNCTION _ZW_NVRGetAppValue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_NVR_APP_API.C'
   57: ZW_NVRGetAppValue(BYTE bOffset, BYTE bLength, BYTE *bRetBuffer)
   58: {
B2:009405 9041B3            MOV      DPTR,#bOffset
B2:009408 124765            LCALL    ?L?COM0102
B2:00940B 1225A9            LCALL    ?C?PSTXDATA
   59:   ZW_DEBUG_NVR_APP_SEND_BYTE('N');
B2:00940E         ?C0001?ZW_NVR_APP_API:
   60:   ZW_DEBUG_NVR_APP_SEND_BYTE('g');
   61:   ZW_DEBUG_NVR_APP_SEND_NUM(NVR_APP_START_ADDRESS + bOffset);
   62:   ZW_DEBUG_NVR_APP_SEND_BYTE(',');
   63:   while (bLength)
B2:00940E 9041B4            MOV      DPTR,#bLength
B2:009411 E0                MOVX     A,@DPTR
B2:009412 6024              JZ       ?C0003?ZW_NVR_APP_API
   64:   {
   65:     /* NVR is valid, get value from NVR */
   66:     *bRetBuffer = ZW_FLASH_nvr0_get(bOffset + NVR_APP_START_ADDRESS);
B2:009414 9041B3            MOV      DPTR,#bOffset
B2:009417 E0                MOVX     A,@DPTR
B2:009418 2480              ADD      A,#080H
B2:00941A FF                MOV      R7,A
B2:00941B 121D4A            LCALL    ?INTERBANK_TABLE?_ZW_FLASH_nvr0_get
B2:00941E 9041B5            MOV      DPTR,#bRetBuffer
B2:009421 123F95            LCALL    ?L?COM00C0
   67: 
   68:     ZW_DEBUG_NVR_APP_SEND_NUM(*bRetBuffer);
   69: 
   70:     bRetBuffer++;
B2:009424 9041B6            MOV      DPTR,#bRetBuffer+01H
B2:009427 123F7F            LCALL    ?L?COM0081
   71:     bLength--;
B2:00942A 9041B4            MOV      DPTR,#bLength
B2:00942D E0                MOVX     A,@DPTR
B2:00942E 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 569


B2:00942F F0                MOVX     @DPTR,A
   72:     bOffset++;
B2:009430 9041B3            MOV      DPTR,#bOffset
B2:009433 E0                MOVX     A,@DPTR
B2:009434 04                INC      A
B2:009435 F0                MOVX     @DPTR,A
   73:   }
B2:009436 80D6              SJMP     ?C0001?ZW_NVR_APP_API
   74:   ZW_DEBUG_NVR_APP_SEND_NL();
   75: }
B2:009438         ?C0003?ZW_NVR_APP_API:
B2:009438 22                RET      
----- FUNCTION _ZW_NVRGetAppValue (END) -------


----- FUNCTION mustCommandBeHandled (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
   87: static BOOL mustCommandBeHandled(MULTICHAN_DEST_NODE_ID nodeID, uint8_t sessionID)
   88: {
   89:   ZW_DEBUG_CC_SUPERVISION_SEND_NL();
   90:   ZW_DEBUG_CC_SUPERVISION_SEND_NUM(previously_receive_session_id);
   91:   ZW_DEBUG_CC_SUPERVISION_SEND_NUM(sessionID);
   92:   if (previously_receive_session_id != sessionID)
B2:009439 90432C            MOV      DPTR,#sessionID
B2:00943C E0                MOVX     A,@DPTR
B2:00943D FF                MOV      R7,A
B2:00943E 903D9F            MOV      DPTR,#previously_receive_session_id
B2:009441 E0                MOVX     A,@DPTR
B2:009442 6F                XRL      A,R7
B2:009443 6002              JZ       ?C0002?COMMANDCLASSSUPERVISION
   93:   {
   94:     return TRUE;
B2:009445 D3                SETB     C
B2:009446 22                RET      
   95:   }
B2:009447         ?C0002?COMMANDCLASSSUPERVISION:
   96:   if (0 != memcmp((uint8_t *)&nodeID, (uint8_t *)&previously_received_destination, sizeof(MULTICHAN_DEST_NODE_ID)
>> ))
B2:009447 916B              ACALL    ?L?COM0522
B2:009449 904064            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B2:00944C 1225A9            LCALL    ?C?PSTXDATA
B2:00944F 7A43              MOV      R2,#HIGH nodeID
B2:009451 792A              MOV      R1,#LOW nodeID
B2:009453 7F02              MOV      R7,#02H
B2:009455 121B92            LCALL    ?INTERBANK_TABLE?___ZW_memcmp
B2:009458 EF                MOV      A,R7
B2:009459 C3                CLR      C
B2:00945A 6001              JZ       ?C0004?COMMANDCLASSSUPERVISION
   97:   {
   98:     return TRUE;
B2:00945C D3                SETB     C
   99:   }
B2:00945D         ?C0004?COMMANDCLASSSUPERVISION:
  100:   return FALSE;
  101: }
B2:00945D 22                RET      
----- FUNCTION mustCommandBeHandled (END) -------


----- FUNCTION ?L?COM037F (BEGIN) -----
B2:00945E 903614            MOV      DPTR,#m_AppInfo
B2:009461 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM037F (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 570


----- FUNCTION ?L?COM04CF (BEGIN) -----
B2:009464 F0                MOVX     @DPTR,A
B2:009465         ?L?COM04D0:
B2:009465 903AD7            MOV      DPTR,#rxOpt
B2:009468 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04CF (END) -------


----- FUNCTION ?L?COM0522 (BEGIN) -----
B2:00946B 7B01              MOV      R3,#01H
B2:00946D 7A3D              MOV      R2,#HIGH previously_received_destination
B2:00946F 799A              MOV      R1,#LOW previously_received_destination
B2:009471 22                RET      
----- FUNCTION ?L?COM0522 (END) -------


----- FUNCTION ?L?COM0524 (BEGIN) -----
B2:009472 543F              ANL      A,#03FH
B2:009474 90432C            MOV      DPTR,#?mustCommandBeHandled?BYTE+02H
B2:009477 F0                MOVX     @DPTR,A
B2:009478 22                RET      
----- FUNCTION ?L?COM0524 (END) -------


----- FUNCTION _ApplicationSecureCommandsSupported (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  332: ApplicationSecureCommandsSupported(
  333:     enum SECURITY_KEY eKey, /* IN Security Scheme to report on */
B2:009479 903E56            MOV      DPTR,#eKey
B2:00947C 127088            LCALL    ?L?COM00F4
  334:     BYTE **pCmdClasses,   /* OUT Cmd classes supported by endpoint */
  335:     BYTE *pLength)        /* OUT Length of pCmdClasses, 0 if endpoint does not exist */
  336: {
  337:   CMD_CLASS_LIST *pCmdClassList  = NULL;
B2:00947F 12B299            LCALL    ?L?COM0069
B2:009482 903E5D            MOV      DPTR,#pCmdClassList
B2:009485 B12A              ACALL    ?L?COM0424
B2:009487 6001              JZ       ?C0035?ZW_TRANSPORTSECPROTOCOL
B2:009489 D3                SETB     C
B2:00948A         ?C0035?ZW_TRANSPORTSECPROTOCOL:
B2:00948A         ?C0036?ZW_TRANSPORTSECPROTOCOL:
B2:00948A 9250              MOV      ?GetCommandClassList?BIT,C
B2:00948C 903E56            MOV      DPTR,#eKey
B2:00948F E0                MOVX     A,@DPTR
B2:009490 904324            MOV      DPTR,#?GetCommandClassList?BYTE
B2:009493 F0                MOVX     @DPTR,A
B2:009494 E4                CLR      A
B2:009495 A3                INC      DPTR
B2:009496 F0                MOVX     @DPTR,A
B2:009497 128BB4            LCALL    GetCommandClassList
B2:00949A 903E5D            MOV      DPTR,#pCmdClassList
B2:00949D 1271F8            LCALL    ?L?COM0385
B2:0094A0 C003              PUSH     AR3
B2:0094A2 C002              PUSH     AR2
B2:0094A4 C001              PUSH     AR1
B2:0094A6 903E57            MOV      DPTR,#pCmdClasses
B2:0094A9 122589            LCALL    ?C?PLDXDATA
B2:0094AC 1225DE            LCALL    ?C?PSTPTR
  338:   pCmdClassList = GetCommandClassList((0 != GetNodeId()), eKey, 0);
  339:   *pCmdClasses = pCmdClassList->pList;
  340:   *pLength = pCmdClassList->size;
B2:0094AF 903E5D            MOV      DPTR,#pCmdClassList
B2:0094B2 128CA2            LCALL    ?L?COM007F
B2:0094B5 FF                MOV      R7,A
B2:0094B6 903E5A            MOV      DPTR,#pLength
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 571


B2:0094B9 122589            LCALL    ?C?PLDXDATA
B2:0094BC EF                MOV      A,R7
B2:0094BD 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ApplicationSecureCommandsSupported (END) -------


----- FUNCTION ApplicationSecureAuthenticationRequested (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
 1165: BYTE ApplicationSecureAuthenticationRequested(void)
 1166: {
 1167:   return REQUESTED_SECURITY_AUTHENTICATION;
 1168: }
B2:0094C0 7F00              MOV      R7,#00H
 1169: 
B2:0094C2 22                RET      
----- FUNCTION ApplicationSecureAuthenticationRequested (END) -------


----- FUNCTION GetNodeId (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  350: BYTE GetNodeId(void)
  351: {
  352:   BYTE nodeId;
  353:   MemoryGetID(NULL, &nodeId);
B2:0094C3 7A43              MOV      R2,#HIGH nodeId
B2:0094C5 79B4              MOV      R1,#LOW nodeId
B2:0094C7 B163              ACALL    ?L?COM0294
B2:0094C9 121B6F            LCALL    ?INTERBANK_TABLE?_MemoryGetID
  354:   return nodeId;
B2:0094CC 9043B4            MOV      DPTR,#nodeId
B2:0094CF E0                MOVX     A,@DPTR
B2:0094D0 FF                MOV      R7,A
  355: }
B2:0094D1 22                RET      
----- FUNCTION GetNodeId (END) -------


----- FUNCTION _LoadConfiguration (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
 1036: LoadConfiguration(ZW_NVM_STATUS nvmStatus)
 1037: {
B2:0094D2 9043A4            MOV      DPTR,#nvmStatus
B2:0094D5 EF                MOV      A,R7
B2:0094D6 F0                MOVX     @DPTR,A
 1038:   uint8_t magicValue;
 1039: 
 1040:   /* Get this sensors identification on the network */
 1041:   MemoryGetID( NULL, &myNodeID);
B2:0094D7 7A38              MOV      R2,#HIGH myNodeID
B2:0094D9 7930              MOV      R1,#LOW myNodeID
B2:0094DB B163              ACALL    ?L?COM0294
B2:0094DD 121B6F            LCALL    ?INTERBANK_TABLE?_MemoryGetID
 1042:   ManufacturerSpecificDeviceIDInit();
B2:0094E0 12D01D            LCALL    ManufacturerSpecificDeviceIDInit
 1043: #ifdef BOOTLOADER_ENABLED
 1044:   NvmInit(nvmStatus);
B2:0094E3 9043A4            MOV      DPTR,#nvmStatus
B2:0094E6 E0                MOVX     A,@DPTR
B2:0094E7 FF                MOV      R7,A
B2:0094E8 B154              ACALL    _NvmInit
 1045: #else
 1046:   UNUSED(nvmStatus);
 1047: #endif
 1048:   /* Check to see, if any valid configuration is stored in the EEPROM */
 1049:   magicValue = MemoryGetByte((WORD)&EEOFFSET_MAGIC_far);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 572


B2:0094EA 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_far
B2:0094EC 7FD9              MOV      R7,#LOW EEOFFSET_MAGIC_far
B2:0094EE 121B79            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
;---- Variable 'magicValue' assigned to Register 'R7' ----
 1050:   ZW_DEBUG_MYPRODUCT_SEND_NL();
 1051:   ZW_DEBUG_MYPRODUCT_SEND_BYTE('M');
 1052:   ZW_DEBUG_MYPRODUCT_SEND_NUM(magicValue);
 1053:   if (APPL_MAGIC_VALUE == magicValue)
B2:0094F1 EF                MOV      A,R7
B2:0094F2 B45511            CJNE     A,#055H,?C0108?SWITCHONOFF
 1054:   {
 1055:     loadStatusPowerLevel();
B2:0094F5 B15B              ACALL    loadStatusPowerLevel
 1056:     /* There is a configuration stored, so load it */
 1057:     onOffState = MemoryGetByte((WORD)&OnOffState_far);
B2:0094F7 12A184            LCALL    ?L?COM05F9
B2:0094FA 903813            MOV      DPTR,#onOffState
B2:0094FD EF                MOV      A,R7
B2:0094FE F0                MOVX     @DPTR,A
 1058:     ZW_DEBUG_MYPRODUCT_SEND_NL();
 1059:     ZW_DEBUG_MYPRODUCT_SEND_BYTE('C');
 1060:     ZW_DEBUG_MYPRODUCT_SEND_BYTE('l');
 1061: 
 1062:     AssociationInit(FALSE);
B2:0094FF C244              CLR      ?AssociationInit?BIT
B2:009501 12A103            LCALL    AssociationInit
 1063:   }
B2:009504 8019              SJMP     ?C0109?SWITCHONOFF
B2:009506         ?C0108?SWITCHONOFF:
 1064:   else
 1065:   {
 1066:     ZW_MEM_PUT_BYTE((WORD)&EEOFFS_SECURITY_RESERVED.EEOFFS_MAGIC_BYTE_field, EEPROM_MAGIC_BYTE_VALUE);
B2:009506 7E13              MOV      R6,#HIGH EEOFFS_SECURITY_RESERVED+011H
B2:009508 7FEB              MOV      R7,#LOW EEOFFS_SECURITY_RESERVED+011H
B2:00950A 7D56              MOV      R5,#056H
B2:00950C 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1067:     /* Initialize transport layer NVM */
 1068:     Transport_SetDefault();
B2:00950F B15C              ACALL    Transport_SetDefault
 1069:     /* Reset protocol */
 1070:     ZW_SetDefault();
B2:009511 121A0C            LCALL    ?INTERBANK_TABLE?ZW_SetDefault
 1071: 
 1072:     /* Apparently there is no valid configuration in EEPROM, so load */
 1073:     /* default values and save them to EEPROM. */
 1074:     SetDefaultConfiguration();
B2:009514 12B6E7            LCALL    SetDefaultConfiguration
 1075: 
 1076:     /*Clear association*/
 1077:     AssociationInit(TRUE);
B2:009517 D244              SETB     ?AssociationInit?BIT
B2:009519 12A103            LCALL    AssociationInit
 1078: 
 1079:     loadInitStatusPowerLevel();
B2:00951C 12CE7C            LCALL    loadInitStatusPowerLevel
 1080:   }
B2:00951F         ?C0109?SWITCHONOFF:
 1081:   RefreshMMI();
B2:00951F 02ACD5            LJMP     RefreshMMI
----- FUNCTION _LoadConfiguration (END) -------


----- FUNCTION ?L?COM0494 (BEGIN) -----
B2:009522 4E                ORL      A,R6
B2:009523 903A3C            MOV      DPTR,#version
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 573


B2:009526 F0                MOVX     @DPTR,A
B2:009527 E0                MOVX     A,@DPTR
B2:009528 FF                MOV      R7,A
B2:009529 22                RET      
----- FUNCTION ?L?COM0494 (END) -------


----- FUNCTION ?L?COM0424 (BEGIN) -----
B2:00952A 1225A9            LCALL    ?C?PSTXDATA
B2:00952D 91C3              ACALL    GetNodeId
B2:00952F EF                MOV      A,R7
B2:009530 C3                CLR      C
B2:009531 22                RET      
----- FUNCTION ?L?COM0424 (END) -------


----- FUNCTION ZCB_DelayTestFrame (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  214: PCB(ZCB_DelayTestFrame) (void)
  215: {
  216:   DelayTestFrameHandle = 0;
  217:   if (TRUE != ZW_SendTestFrame(testNodeID, testPowerLevel, ZCB_SendTestDone))
B2:009532 E4                CLR      A
B2:009533 903DDA            MOV      DPTR,#DelayTestFrameHandle
B2:009536 F0                MOVX     @DPTR,A
  218:   {
B2:009537 A3                INC      DPTR
B2:009538 E0                MOVX     A,@DPTR
B2:009539 FF                MOV      R7,A
B2:00953A 903DD9            MOV      DPTR,#testPowerLevel
B2:00953D E0                MOVX     A,@DPTR
B2:00953E FD                MOV      R5,A
B2:00953F 7A1E              MOV      R2,#HIGH ?INTERBANK_TABLE?_ZCB_SendTestDone
B2:009541 7B58              MOV      R3,#LOW ?INTERBANK_TABLE?_ZCB_SendTestDone
B2:009543 1219D0            LCALL    ?INTERBANK_TABLE?_ZW_SendTestFrame
B2:009546 EF                MOV      A,R7
B2:009547 6401              XRL      A,#01H
B2:009549 6008              JZ       ?C0018?COMMANDCLASSPOWERLEVEL
  219:     ZCB_SendTestDone(TRANSMIT_COMPLETE_FAIL, NULL);
  220:   }
B2:00954B 12B299            LCALL    ?L?COM0069
B2:00954E 7F02              MOV      R7,#02H
B2:009550 12CDA8            LCALL    _ZCB_SendTestDone
  221: }
  222: 
B2:009553         ?C0018?COMMANDCLASSPOWERLEVEL:
B2:009553 22                RET      
----- FUNCTION ZCB_DelayTestFrame (END) -------


----- FUNCTION _NvmInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\NVM_UTIL.C'
  151: NvmInit(ZW_NVM_STATUS nvmStatus)
  152: {
;---- Variable 'nvmStatus' assigned to Register 'R7' ----
  153:   if (ZW_NVM_UPGRADED == nvmStatus)
  154:   {
B2:009554 EF                MOV      A,R7
B2:009555 B40202            CJNE     A,#02H,?C0035?NVM_UTIL
  155:     NvmApplicationDataMigrate();
  156:   }
B2:009558 3157              ACALL    NvmApplicationDataMigrate
  157: }
  158: 
B2:00955A         ?C0035?NVM_UTIL:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 574


B2:00955A 22                RET      
----- FUNCTION _NvmInit (END) -------


----- FUNCTION loadStatusPowerLevel (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  223: void loadStatusPowerLevel(void)
  224: {
  225: 
  226: }
B2:00955B 22                RET      
----- FUNCTION loadStatusPowerLevel (END) -------


----- FUNCTION Transport_SetDefault (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  345: Transport_SetDefault()
  346: {
  347: }
  348: 
B2:00955C 22                RET      
----- FUNCTION Transport_SetDefault (END) -------


----- FUNCTION ?L?COM050A (BEGIN) -----
B2:00955D 903FDF            MOV      DPTR,#?_Transport_ApplicationCommandHandlerEx?BYTE+03H
B2:009560 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM050A (END) -------


----- FUNCTION ?L?COM0294 (BEGIN) -----
B2:009563 7B01              MOV      R3,#01H
B2:009565 9040F9            MOV      DPTR,#?_MemoryGetID?BYTE+03H
B2:009568         ?L?COM0295:
B2:009568 1225A9            LCALL    ?C?PSTXDATA
B2:00956B 1B                DEC      R3
B2:00956C 7A00              MOV      R2,#00H
B2:00956E 7900              MOV      R1,#00H
B2:009570 22                RET      
----- FUNCTION ?L?COM0294 (END) -------


----- FUNCTION _SetEvState (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  592: SetEvState(FW_EV ev)
  593: {
B2:009571 9043B0            MOV      DPTR,#ev
B2:009574 EF                MOV      A,R7
B2:009575 F0                MOVX     @DPTR,A
  594:   ZW_DEBUG_CMD_OTA_SEND_STR("SetEvState ev=");
  595:   ZW_DEBUG_CMD_OTA_SEND_NUM(ev);
  596:   ZW_DEBUG_CMD_OTA_SEND_STR(", st=");
  597:   ZW_DEBUG_CMD_OTA_SEND_NUM(myOta.fwState);
  598:   ZW_DEBUG_CMD_OTA_SEND_NL();
  599: 
  600:   switch(myOta.fwState)
B2:009576 903874            MOV      DPTR,#myOta+06H
B2:009579 E0                MOVX     A,@DPTR
B2:00957A 14                DEC      A
B2:00957B 6024              JZ       ?C0059?OTA_UTIL
B2:00957D 14                DEC      A
B2:00957E 7002              JNZ      $ + 4H
B2:009580 C113              AJMP     ?C0072?OTA_UTIL
B2:009582 2402              ADD      A,#02H
B2:009584 6002              JZ       $ + 4H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 575


B2:009586 C19F              AJMP     ?C0089?OTA_UTIL
  601:   {
  602:     case FW_STATE_DISABLE:
B2:009588         ?C0054?OTA_UTIL:
  603:       if(ev == FW_EV_VALID_COMBINATION)
B2:009588 9043B0            MOV      DPTR,#ev
B2:00958B E0                MOVX     A,@DPTR
B2:00958C FF                MOV      R7,A
B2:00958D B40108            CJNE     A,#01H,?C0055?OTA_UTIL
  604:       {
  605:         myOta.fwState = FW_STATE_READY;
B2:009590 903874            MOV      DPTR,#myOta+06H
B2:009593 7401              MOV      A,#01H
B2:009595 F0                MOVX     @DPTR,A
  606:         SetEvState(ev);
  607:       }
B2:009596 C17E              AJMP     ?C0154?OTA_UTIL
B2:009598         ?C0055?OTA_UTIL:
  608:       else
  609:       {
  610:         if( NON_NULL( myOta.pOtaFinish ) )
B2:009598 903872            MOV      DPTR,#myOta+04H
B2:00959B D1A4              ACALL    ?L?COM0137
B2:00959D 6072              JZ       ?C0152?OTA_UTIL
  611:         {
  612:           myOta.pOtaFinish(OTA_STATUS_ABORT);
  613:         }
B2:00959F 8067              SJMP     ?C0151?OTA_UTIL
  614:         else
  615:         {
  616:           Reboot();
  617:         }
  618:       }
  619:       break;
  620: 
  621: 
  622:     case FW_STATE_READY:
B2:0095A1         ?C0059?OTA_UTIL:
  623:       if(ev == FW_EV_FORCE_DISABLE)
B2:0095A1 9043B0            MOV      DPTR,#ev
B2:0095A4 E0                MOVX     A,@DPTR
B2:0095A5 7012              JNZ      ?C0060?OTA_UTIL
  624:       {
  625:         /*Tell application it is aborted*/
  626:         if( NON_NULL( myOta.pOtaFinish ) )
B2:0095A7 903872            MOV      DPTR,#myOta+04H
B2:0095AA D1A4              ACALL    ?L?COM0137
B2:0095AC 6007              JZ       ?C0061?OTA_UTIL
  627:         {
  628:           myOta.pOtaFinish(OTA_STATUS_ABORT);
B2:0095AE 8F82              MOV      DPL,R7
B2:0095B0 127168            LCALL    ?L?COM0308
  629:         }
B2:0095B3 C193              AJMP     ?C0155?OTA_UTIL
B2:0095B5         ?C0061?OTA_UTIL:
  630:         else
  631:         {
  632:           Reboot();
B2:0095B5 F121              ACALL    Reboot
  633:         }
B2:0095B7         ?C0062?OTA_UTIL:
  634:         myOta.fwState = FW_STATE_DISABLE;
  635:       }
B2:0095B7 C193              AJMP     ?C0155?OTA_UTIL
B2:0095B9         ?C0060?OTA_UTIL:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 576


  636:       else  if (ev == FW_EV_VALID_COMBINATION)
B2:0095B9 9043B0            MOV      DPTR,#ev
B2:0095BC E0                MOVX     A,@DPTR
B2:0095BD B40107            CJNE     A,#01H,?C0064?OTA_UTIL
  637:       {
  638:         OTA_Invalidate();
B2:0095C0 9100              ACALL    OTA_Invalidate
  639:         myOta.fw_crcrunning = 0x1D0F;
B2:0095C2 12D409            LCALL    ?L?COM03A2
  640:         myOta.firmwareUpdateReportNumberPrevious = 0;
  641:         //myOta.fw_numOfRetries = 0;
  642:         //myOta.timerFwUpdateFrameGetHandle = 0;
  643:         TimerCancelFwUpdateFrameGet();
B2:0095C5 E12C              AJMP     TimerCancelFwUpdateFrameGet
  644:         /*Stop timer*/
  645:       }
B2:0095C7         ?C0064?OTA_UTIL:
  646:       else if(ev == FW_EV_MD_REQUEST_REPORT_SUCCESS)
B2:0095C7 9043B0            MOV      DPTR,#ev
B2:0095CA E0                MOVX     A,@DPTR
B2:0095CB B4020A            CJNE     A,#02H,?C0066?OTA_UTIL
  647:       {
  648:         myOta.fwState = FW_STATE_ACTIVE;
B2:0095CE 903874            MOV      DPTR,#myOta+06H
B2:0095D1 7402              MOV      A,#02H
B2:0095D3 F0                MOVX     @DPTR,A
  649:         SetEvState(FW_EV_GET_NEXT_FW_FRAME);
B2:0095D4 7F04              MOV      R7,#04H
B2:0095D6         
  650:       }
B2:0095D6 C17E              AJMP     ?C0154?OTA_UTIL
B2:0095D8         ?C0066?OTA_UTIL:
  651:       else if((ev == FW_EV_MD_REQUEST_REPORT_FAILED)||
B2:0095D8 9043B0            MOV      DPTR,#ev
B2:0095DB E0                MOVX     A,@DPTR
B2:0095DC FF                MOV      R7,A
B2:0095DD 6403              XRL      A,#03H
B2:0095DF 601B              JZ       ?C0069?OTA_UTIL
B2:0095E1 EF                MOV      A,R7
B2:0095E2 6404              XRL      A,#04H
B2:0095E4 6016              JZ       ?C0069?OTA_UTIL
B2:0095E6 EF                MOV      A,R7
B2:0095E7 6405              XRL      A,#05H
B2:0095E9 6011              JZ       ?C0069?OTA_UTIL
B2:0095EB EF                MOV      A,R7
B2:0095EC 6406              XRL      A,#06H
B2:0095EE 600C              JZ       ?C0069?OTA_UTIL
B2:0095F0 EF                MOV      A,R7
B2:0095F1 6407              XRL      A,#07H
B2:0095F3 6007              JZ       ?C0069?OTA_UTIL
B2:0095F5 EF                MOV      A,R7
B2:0095F6 6408              XRL      A,#08H
B2:0095F8 6002              JZ       $ + 4H
B2:0095FA C19F              AJMP     ?C0089?OTA_UTIL
B2:0095FC         ?C0069?OTA_UTIL:
  652:               (ev == FW_EV_GET_NEXT_FW_FRAME)||
  653:               (ev == FW_EV_RETRY_NEXT_FW_FRAME)||
  654:               (ev == FW_EV_UPDATE_STATUS_SUCCESS)||
  655:               (ev == FW_EV_UPDATE_STATUS_SUCCESS_USER_REBOOT)||
  656:               (ev == FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE))
  657:       {
  658:         myOta.fwState = FW_STATE_DISABLE;
B2:0095FC E4                CLR      A
B2:0095FD 903874            MOV      DPTR,#myOta+06H
B2:009600 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 577


  659:         if( NON_NULL( myOta.pOtaFinish ) )
B2:009601 903872            MOV      DPTR,#myOta+04H
B2:009604 D1A4              ACALL    ?L?COM0137
B2:009606 6009              JZ       ?C0070?OTA_UTIL
  660:         {
  661:           myOta.pOtaFinish(OTA_STATUS_ABORT);
B2:009608         
B2:009608 8F82              MOV      DPL,R7
B2:00960A 8E83              MOV      DPH,R6
B2:00960C 7F01              MOV      R7,#01H
B2:00960E 02271A            LJMP     ?C?ICALL2
  662:         }
B2:009611         ?C0070?OTA_UTIL:
  663:         else
  664:         {
  665:           Reboot();
B2:009611         
B2:009611 E121              AJMP     Reboot
  666:         }
  667: 
  668:         /*Stop timer*/
  669:       }
  670:       break;
  671: 
  672: 
  673:     case FW_STATE_ACTIVE:
B2:009613         ?C0072?OTA_UTIL:
  674:       switch(ev)
B2:009613 9043B0            MOV      DPTR,#ev
B2:009616 E0                MOVX     A,@DPTR
B2:009617 1226B6            LCALL    ?C?CCASE
B2:00961A 9636              DW       ?C0075?OTA_UTIL
B2:00961C 00                DB       00H
B2:00961D 9636              DW       ?C0075?OTA_UTIL
B2:00961F 01                DB       01H
B2:009620 964A              DW       ?C0080?OTA_UTIL
B2:009622 04                DB       04H
B2:009623 964F              DW       ?C0081?OTA_UTIL
B2:009625 05                DB       05H
B2:009626 9680              DW       ?C0085?OTA_UTIL
B2:009628 06                DB       06H
B2:009629 9684              DW       ?C0086?OTA_UTIL
B2:00962B 07                DB       07H
B2:00962C 968F              DW       ?C0087?OTA_UTIL
B2:00962E 08                DB       08H
B2:00962F 9696              DW       ?C0088?OTA_UTIL
B2:009631 09                DB       09H
B2:009632 0000              DW       00H
B2:009634 969F              DW       ?C0089?OTA_UTIL
  675:       {
  676:         case FW_EV_FORCE_DISABLE:
  677:         case FW_EV_VALID_COMBINATION:
B2:009636         ?C0075?OTA_UTIL:
  678:           TimerCancelFwUpdateFrameGet();
B2:009636 F12C              ACALL    TimerCancelFwUpdateFrameGet
  679:           /*Tell application it is aborted*/
  680:           if( NON_NULL( myOta.pOtaFinish ) )
B2:009638 903872            MOV      DPTR,#myOta+04H
B2:00963B D1A4              ACALL    ?L?COM0137
B2:00963D 6007              JZ       ?C0076?OTA_UTIL
  681:           {
  682:             myOta.pOtaFinish(OTA_STATUS_ABORT);
B2:00963F 8F82              MOV      DPL,R7
B2:009641 127168            LCALL    ?L?COM0308
  683:           }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 578


B2:009644 8002              SJMP     ?C0077?OTA_UTIL
B2:009646         ?C0076?OTA_UTIL:
  684:           else
  685:           {
  686:             Reboot();
B2:009646 F121              ACALL    Reboot
  687:           }
B2:009648         ?C0077?OTA_UTIL:
  688: 
  689:           myOta.fwState = FW_STATE_DISABLE;
B2:009648         
  690:           break;
B2:009648 8049              SJMP     ?C0155?OTA_UTIL
  691: 
  692:         case FW_EV_MD_REQUEST_REPORT_SUCCESS:
  693:         case FW_EV_MD_REQUEST_REPORT_FAILED:
  694:           /* Ignore - this happens when someone sends us Request Gets
  695:            * while we are busy updating */
  696:           break;
  697: 
  698:         case FW_EV_GET_NEXT_FW_FRAME:
B2:00964A         ?C0080?OTA_UTIL:
  699:           TimerStartFwUpdateFrameGet();
B2:00964A 12D47A            LCALL    TimerStartFwUpdateFrameGet
  700:           CmdClassFirmwareUpdateMdGet( &myOta.rxOpt, myOta.firmwareUpdateReportNumberPrevious + 1);
  701:           /*Start/restart timer*/
  702:           break;
B2:00964D 801B              SJMP     ?C0156?OTA_UTIL
  703:         case FW_EV_RETRY_NEXT_FW_FRAME:
B2:00964F         ?C0081?OTA_UTIL:
  704:           ZW_DEBUG_CMD_OTA_SEND_STR(" FWUpdateCount ");
  705:           ZW_DEBUG_CMD_OTA_SEND_NUM(myOta.timerFWUpdateCount);
  706:           ZW_DEBUG_CMD_OTA_SEND_STR(" retry nbr ");
  707:           ZW_DEBUG_CMD_OTA_SEND_NUM(myOta.fw_numOfRetries);
  708:           if( FIRMWARE_UPDATE_REQUEST_TIMEOUTS < ++(myOta.timerFWUpdateCount))
B2:00964F 90387E            MOV      DPTR,#myOta+010H
B2:009652 E0                MOVX     A,@DPTR
B2:009653 04                INC      A
B2:009654 FF                MOV      R7,A
B2:009655 F0                MOVX     @DPTR,A
B2:009656 7405              MOV      A,#05H
B2:009658 C3                CLR      C
B2:009659 9F                SUBB     A,R7
B2:00965A 5043              JNC      ?C0089?OTA_UTIL
  709:           {
  710:             myOta.timerFWUpdateCount = 0;
B2:00965C E4                CLR      A
B2:00965D F0                MOVX     @DPTR,A
  711:             if (FIRMWARE_UPDATE_MAX_RETRY > ++(myOta.fw_numOfRetries))
B2:00965E 903878            MOV      DPTR,#myOta+0AH
B2:009661 E0                MOVX     A,@DPTR
B2:009662 04                INC      A
B2:009663 FF                MOV      R7,A
B2:009664 F0                MOVX     @DPTR,A
B2:009665 740A              MOV      A,#0AH
B2:009667 9F                SUBB     A,R7
B2:009668 4012              JC       ?C0083?OTA_UTIL
  712:             {
  713:               CmdClassFirmwareUpdateMdGet( &myOta.rxOpt, myOta.firmwareUpdateReportNumberPrevious + 1);
B2:00966A         
B2:00966A 90387B            MOV      DPTR,#myOta+0DH
B2:00966D F14D              ACALL    ?L?COM05F0
B2:00966F 2401              ADD      A,#01H
B2:009671 FD                MOV      R5,A
B2:009672 90387A            MOV      DPTR,#myOta+0CH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 579


B2:009675 E0                MOVX     A,@DPTR
B2:009676 3400              ADDC     A,#00H
B2:009678 FC                MOV      R4,A
B2:009679 02B624            LJMP     _CmdClassFirmwareUpdateMdGet
  714:               /*Start/restart timer*/
  715:             }
B2:00967C         ?C0083?OTA_UTIL:
  716:             else
  717:             {
  718:               ZW_DEBUG_CMD_OTA_SEND_BYTE('+');
  719:               SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
B2:00967C 7F08              MOV      R7,#08H
B2:00967E         
B2:00967E A171              AJMP     _SetEvState
  720:             }
  721:           }
  722:           break;
  723:         case FW_EV_UPDATE_STATUS_SUCCESS:
B2:009680         ?C0085?OTA_UTIL:
  724:           SendFirmwareUpdateStatusReport(FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_V4);
B2:009680 7FFF              MOV      R7,#0FFH
  725:           myOta.finishStatus = OTA_STATUS_DONE;
  726:           myOta.fwState = FW_STATE_DISABLE;
  727:           break;
B2:009682 8002              SJMP     ?C0157?OTA_UTIL
  728: 
  729:         case FW_EV_UPDATE_STATUS_SUCCESS_USER_REBOOT:
B2:009684         ?C0086?OTA_UTIL:
  730:           /*Success but user need to reboot device*/
  731:           SendFirmwareUpdateStatusReport(FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_STORED_V4);
B2:009684 7FFE              MOV      R7,#0FEH
B2:009686         
B2:009686 718F              ACALL    _SendFirmwareUpdateStatusReport
  732:           myOta.finishStatus = OTA_STATUS_DONE;
B2:009688 E4                CLR      A
B2:009689 903875            MOV      DPTR,#myOta+07H
B2:00968C F0                MOVX     @DPTR,A
  733:           myOta.fwState = FW_STATE_DISABLE;
  734:           break;
B2:00968D 800C              SJMP     ?C0159?OTA_UTIL
  735: 
  736:         case FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE:
B2:00968F         ?C0087?OTA_UTIL:
  737:           SendFirmwareUpdateStatusReport(FIRMWARE_UPDATE_MD_STATUS_REPORT_UNABLE_TO_RECEIVE_V4);
B2:00968F 7F01              MOV      R7,#01H
B2:009691 F123              ACALL    ?L?COM052A
  738:           ZW_DEBUG_CMD_OTA_SEND_STR("FIRMWARE_UPDATE_MD_STATUS_REPORT_UNABLE_TO_RECEIVE_V4");
  739:           myOta.finishStatus = OTA_STATUS_ABORT;
  740:           myOta.fwState = FW_STATE_DISABLE;
B2:009693         
B2:009693 E4                CLR      A
B2:009694         
  741:           break;
B2:009694 8005              SJMP     ?C0159?OTA_UTIL
  742: 
  743:         case FW_EV_UPDATE_STATUS_CRC_ERROR:
B2:009696         ?C0088?OTA_UTIL:
  744:           SendFirmwareUpdateStatusReport(FIRMWARE_UPDATE_MD_STATUS_REPORT_UNABLE_TO_RECEIVE_WITHOUT_CHECKSUM_ERRO
>> R_V4);
B2:009696 E4                CLR      A
B2:009697 FF                MOV      R7,A
B2:009698 F123              ACALL    ?L?COM052A
  745:           ZW_DEBUG_CMD_OTA_SEND_STR("FIRMWARE_UPDATE_MD_STATUS_REPORT_UNABLE_TO_RECEIVE_WITHOUT_CHECKSUM_ERROR_V4
>> ");
  746:           myOta.finishStatus = OTA_STATUS_ABORT;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 580


  747:           myOta.fwState = FW_STATE_DISABLE;
B2:00969A E4                CLR      A
B2:00969B         
B2:00969B 903874            MOV      DPTR,#myOta+06H
B2:00969E F0                MOVX     @DPTR,A
  748:           break;
  749: 
  750:       }
  751:       break;
  752:   }
  753: }
B2:00969F         ?C0089?OTA_UTIL:
B2:00969F 22                RET      
----- FUNCTION _SetEvState (END) -------


----- FUNCTION ?L?COM0136 (BEGIN) -----
B2:0096A0 F0                MOVX     @DPTR,A
B2:0096A1 903671            MOV      DPTR,#_p_callback_hold
B2:0096A4         ?L?COM0137:
B2:0096A4 E0                MOVX     A,@DPTR
B2:0096A5 FE                MOV      R6,A
B2:0096A6 A3                INC      DPTR
B2:0096A7 E0                MOVX     A,@DPTR
B2:0096A8 FF                MOV      R7,A
B2:0096A9 4E                ORL      A,R6
B2:0096AA 22                RET      
----- FUNCTION ?L?COM0136 (END) -------


----- FUNCTION _CC_DeviceResetLocally_notification_tx (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSDEVICERESETLOCALLY.C'
   39: void CC_DeviceResetLocally_notification_tx(
   40:   agi_profile_t * pProfile,
B2:0096AB 903E4C            MOV      DPTR,#pProfile
B2:0096AE 1225A9            LCALL    ?C?PSTXDATA
B2:0096B1 903E4F            MOV      DPTR,#pCallback
B2:0096B4 EC                MOV      A,R4
B2:0096B5 F0                MOVX     @DPTR,A
B2:0096B6 A3                INC      DPTR
B2:0096B7 ED                MOV      A,R5
B2:0096B8 F11A              ACALL    ?L?COM00EF
   41:   VOID_CALLBACKFUNC(pCallback)(transmission_result_t * pTransmissionResult))
   42: {
   43:   transmission_result_t transmissionResult;
   44:   transmissionResult.nodeId = 0;
   45:   transmissionResult.status = ZW_TX_FAILED;
   46:   transmissionResult.isFinished = TRANSMISSION_RESULT_FINISHED;
B2:0096BA A3                INC      DPTR
B2:0096BB 04                INC      A
B2:0096BC F0                MOVX     @DPTR,A
   47: 
   48:   if(!GetMyNodeID())
B2:0096BD 12AB33            LCALL    GetMyNodeID
B2:0096C0 EF                MOV      A,R7
B2:0096C1 7009              JNZ      ?C0001?COMMANDCLASSDEVICERESETLOCALLY
   49:   {
   50:     /*
   51:      * The node is not included, and therefore it makes no sense to send
   52:      * anything. Finish by calling the callback function.
   53:      */
   54: 
   55:     if (NON_NULL( pCallback ))
B2:0096C3 903E4F            MOV      DPTR,#pCallback
B2:0096C6 D1A4              ACALL    ?L?COM0137
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 581


B2:0096C8 6047              JZ       ?C0006?COMMANDCLASSDEVICERESETLOCALLY
   56:     {
   57:       pCallback(&transmissionResult);
   58:     }
   59:   }
B2:0096CA 803E              SJMP     ?C0007?COMMANDCLASSDEVICERESETLOCALLY
B2:0096CC         ?C0001?COMMANDCLASSDEVICERESETLOCALLY:
   60:   else
   61:   {
   62:     cc_group_t cmdGrp = {COMMAND_CLASS_DEVICE_RESET_LOCALLY, DEVICE_RESET_LOCALLY_NOTIFICATION};
B2:0096CC 7854              MOV      R0,#LOW cmdGrp
B2:0096CE 7C3E              MOV      R4,#HIGH cmdGrp
B2:0096D0 7A32              MOV      R2,#HIGH _?ix1000
B2:0096D2 7999              MOV      R1,#LOW _?ix1000
B2:0096D4 12C487            LCALL    ?L?COM0166
   63: 
   64:     if(JOB_STATUS_SUCCESS != cc_engine_multicast_request(
B2:0096D7 7B01              MOV      R3,#01H
B2:0096D9 7A3E              MOV      R2,#HIGH cmdGrp
B2:0096DB 7954              MOV      R1,#LOW cmdGrp
B2:0096DD 903A9E            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+04H
B2:0096E0 B168              ACALL    ?L?COM0295
B2:0096E2 903AA1            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+07H
B2:0096E5 1225A9            LCALL    ?C?PSTXDATA
B2:0096E8 E4                CLR      A
B2:0096E9 903AA4            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+0AH
B2:0096EC F0                MOVX     @DPTR,A
B2:0096ED A3                INC      DPTR
B2:0096EE F0                MOVX     @DPTR,A
B2:0096EF 903E4F            MOV      DPTR,#pCallback
B2:0096F2 12CED5            LCALL    ?L?COM032E
B2:0096F5 903E4C            MOV      DPTR,#pProfile
B2:0096F8 122589            LCALL    ?C?PLDXDATA
B2:0096FB E4                CLR      A
B2:0096FC FD                MOV      R5,A
B2:0096FD 12CC17            LCALL    _cc_engine_multicast_request
B2:009700 EF                MOV      A,R7
B2:009701 600E              JZ       ?C0006?COMMANDCLASSDEVICERESETLOCALLY
   65:         pProfile,
   66:         ENDPOINT_ROOT,
   67:         &cmdGrp,
   68:         NULL,
   69:         0,
   70:         FALSE,
   71:         pCallback))
   72:     {
   73:       if (NON_NULL(pCallback))
B2:009703 903E4F            MOV      DPTR,#pCallback
B2:009706 D1A4              ACALL    ?L?COM0137
B2:009708 6007              JZ       ?C0006?COMMANDCLASSDEVICERESETLOCALLY
   74:       {
   75:         pCallback(&transmissionResult);
B2:00970A         
B2:00970A 7A3E              MOV      R2,#HIGH transmissionResult
B2:00970C 7951              MOV      R1,#LOW transmissionResult
B2:00970E 12B447            LCALL    ?L?COM0363
   76:       }
   77:     }
   78:   }
   79: }
B2:009711         ?C0006?COMMANDCLASSDEVICERESETLOCALLY:
B2:009711 22                RET      
----- FUNCTION _CC_DeviceResetLocally_notification_tx (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 582


----- FUNCTION ?L?COM00EE (BEGIN) -----
B2:009712 903E15            MOV      DPTR,#?_MemoryPutBuffer?BYTE+05H
B2:009715 E4                CLR      A
B2:009716 F0                MOVX     @DPTR,A
B2:009717 A3                INC      DPTR
B2:009718 7405              MOV      A,#05H
B2:00971A         ?L?COM00EF:
B2:00971A F0                MOVX     @DPTR,A
B2:00971B E4                CLR      A
B2:00971C A3                INC      DPTR
B2:00971D F0                MOVX     @DPTR,A
B2:00971E A3                INC      DPTR
B2:00971F F0                MOVX     @DPTR,A
B2:009720 22                RET      
----- FUNCTION ?L?COM00EE (END) -------


----- FUNCTION Reboot (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  218: Reboot()
  219: {
  220: #ifdef WATCHDOG_ENABLED
B2:009721         ?C0001?OTA_UTIL:
  221:   ZW_WatchDogEnable();
  222: #endif
  223:   while(1);
B2:009721 80FE              SJMP     ?C0001?OTA_UTIL
----- FUNCTION Reboot (END) -------


----- FUNCTION ?L?COM052A (BEGIN) -----
B2:009723 718F              ACALL    _SendFirmwareUpdateStatusReport
B2:009725 903875            MOV      DPTR,#myOta+07H
B2:009728 7401              MOV      A,#01H
B2:00972A F0                MOVX     @DPTR,A
B2:00972B 22                RET      
----- FUNCTION ?L?COM052A (END) -------


----- FUNCTION TimerCancelFwUpdateFrameGet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  829: TimerCancelFwUpdateFrameGet(void)
  830: {
  831:   if (myOta.timerFwUpdateFrameGetHandle)
  832:   {
B2:00972C 903879            MOV      DPTR,#myOta+0BH
B2:00972F E0                MOVX     A,@DPTR
B2:009730 FF                MOV      R7,A
B2:009731 6008              JZ       ?C0102?OTA_UTIL
  833:     ZW_TIMER_CANCEL(myOta.timerFwUpdateFrameGetHandle);
  834:     myOta.timerFwUpdateFrameGetHandle = 0;
B2:009733 124465            LCALL    _TimerCancel
  835:   }
B2:009736 E4                CLR      A
B2:009737 903879            MOV      DPTR,#myOta+0BH
B2:00973A F0                MOVX     @DPTR,A
  836:   myOta.fw_numOfRetries = 0;
B2:00973B         ?C0102?OTA_UTIL:
  837: }
B2:00973B E4                CLR      A
B2:00973C 903878            MOV      DPTR,#myOta+0AH
B2:00973F F0                MOVX     @DPTR,A
  838: 
B2:009740 22                RET      
----- FUNCTION TimerCancelFwUpdateFrameGet (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 583




----- FUNCTION ?L?COM05CE (BEGIN) -----
B2:009741 903A3D            MOV      DPTR,#i
B2:009744 E0                MOVX     A,@DPTR
B2:009745 FE                MOV      R6,A
B2:009746 A3                INC      DPTR
B2:009747 E0                MOVX     A,@DPTR
B2:009748 22                RET      
----- FUNCTION ?L?COM05CE (END) -------


----- FUNCTION ZCB_TimerOutFwUpdateFrameGet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  848: PCB(ZCB_TimerOutFwUpdateFrameGet)(void)
  849: {
  850:   SetEvState(FW_EV_RETRY_NEXT_FW_FRAME);
  851: }
B2:009749 7F05              MOV      R7,#05H
B2:00974B A171              AJMP     _SetEvState
----- FUNCTION ZCB_TimerOutFwUpdateFrameGet (END) -------


----- FUNCTION ?L?COM05F0 (BEGIN) -----
B2:00974D 7B01              MOV      R3,#01H
B2:00974F 7A38              MOV      R2,#HIGH myOta+014H
B2:009751 7982              MOV      R1,#LOW myOta+014H
B2:009753 E0                MOVX     A,@DPTR
B2:009754 22                RET      
----- FUNCTION ?L?COM05F0 (END) -------


----- FUNCTION _Transport_ApplicationCommandHandlerEx (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  385: Transport_ApplicationCommandHandlerEx(
  386:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:009755 903FDC            MOV      DPTR,#rxOpt
B2:009758 1225A9            LCALL    ?C?PSTXDATA
  387:   ZW_APPLICATION_TX_BUFFER *pCmd,
  388:   BYTE cmdLength)
  389: {
  390:   received_frame_status_t frame_status = RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00975B E4                CLR      A
B2:00975C 903FE3            MOV      DPTR,#frame_status
B2:00975F F0                MOVX     @DPTR,A
  391:   ZW_DEBUG_MYPRODUCT_SEND_NL();
  392:   ZW_DEBUG_MYPRODUCT_SEND_STR("AppH");
  393:   ZW_DEBUG_MYPRODUCT_SEND_NUM(pCmd->ZW_Common.cmdClass);
  394: 
  395:   /* Call command class handlers */
  396:   switch (pCmd->ZW_Common.cmdClass)
B2:009760 903FDF            MOV      DPTR,#pCmd
B2:009763 12AE26            LCALL    ?L?COM0049
B2:009766 1226B6            LCALL    ?C?CCASE
B2:009769 983E              DW       ?C0014?SWITCHONOFF
B2:00976B 20                DB       020H
B2:00976C 9855              DW       ?C0015?SWITCHONOFF
B2:00976E 25                DB       025H
B2:00976F 97C2              DW       ?C0009?SWITCHONOFF
B2:009771 59                DB       059H
B2:009772 9827              DW       ?C0013?SWITCHONOFF
B2:009774 5E                DB       05EH
B2:009775 986C              DW       ?C0016?SWITCHONOFF
B2:009777 6C                DB       06CH
B2:009778 9810              DW       ?C0012?SWITCHONOFF
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 584


B2:00977A 72                DB       072H
B2:00977B 97F6              DW       ?C0011?SWITCHONOFF
B2:00977D 73                DB       073H
B2:00977E 97A8              DW       ?C0008?SWITCHONOFF
B2:009780 7A                DB       07AH
B2:009781 97DC              DW       ?C0010?SWITCHONOFF
B2:009783 85                DB       085H
B2:009784 978E              DW       ?C0007?SWITCHONOFF
B2:009786 86                DB       086H
B2:009787 9883              DW       ?C0017?SWITCHONOFF
B2:009789 8E                DB       08EH
B2:00978A 0000              DW       00H
B2:00978C 989D              DW       ?C0006?SWITCHONOFF
  397:   {
  398:     case COMMAND_CLASS_VERSION:
B2:00978E         ?C0007?SWITCHONOFF:
  399:       frame_status = handleCommandClassVersion(rxOpt, pCmd, cmdLength);
B2:00978E 1298A3            LCALL    ?L?COM023C
B2:009791 9039E6            MOV      DPTR,#?_CC_Version_handler?BYTE+03H
B2:009794 1298A9            LCALL    ?L?COM0249
B2:009797 E0                MOVX     A,@DPTR
B2:009798 9039E9            MOV      DPTR,#?_CC_Version_handler?BYTE+06H
B2:00979B F0                MOVX     @DPTR,A
B2:00979C 903FDC            MOV      DPTR,#rxOpt
B2:00979F 122589            LCALL    ?C?PLDXDATA
B2:0097A2 12A1E0            LCALL    _CC_Version_handler
  400:       break;
B2:0097A5 029898            LJMP     ?C0132?SWITCHONOFF
  401: 
  402: #ifdef BOOTLOADER_ENABLED
  403:     case COMMAND_CLASS_FIRMWARE_UPDATE_MD_V2:
B2:0097A8         ?C0008?SWITCHONOFF:
  404:       frame_status = handleCommandClassFWUpdate(rxOpt, pCmd, cmdLength);
B2:0097A8 1298A3            LCALL    ?L?COM023C
B2:0097AB 9039FF            MOV      DPTR,#?_handleCommandClassFWUpdate?BYTE+03H
B2:0097AE 1298A9            LCALL    ?L?COM0249
B2:0097B1 E0                MOVX     A,@DPTR
B2:0097B2 903A02            MOV      DPTR,#?_handleCommandClassFWUpdate?BYTE+06H
B2:0097B5 F0                MOVX     @DPTR,A
B2:0097B6 903FDC            MOV      DPTR,#rxOpt
B2:0097B9 122589            LCALL    ?C?PLDXDATA
B2:0097BC 129DB9            LCALL    _handleCommandClassFWUpdate
B2:0097BF         
  405:       break;
B2:0097BF 029898            LJMP     ?C0132?SWITCHONOFF
  406: #endif
  407: 
  408:     case COMMAND_CLASS_ASSOCIATION_GRP_INFO:
B2:0097C2         ?C0009?SWITCHONOFF:
  409:       frame_status = CC_AGI_handler( rxOpt, pCmd, cmdLength);
B2:0097C2 1298A3            LCALL    ?L?COM023C
B2:0097C5 903BE5            MOV      DPTR,#?_CC_AGI_handler?BYTE+03H
B2:0097C8 1298A9            LCALL    ?L?COM0249
B2:0097CB E0                MOVX     A,@DPTR
B2:0097CC 903BE8            MOV      DPTR,#?_CC_AGI_handler?BYTE+06H
B2:0097CF F0                MOVX     @DPTR,A
B2:0097D0 903FDC            MOV      DPTR,#rxOpt
B2:0097D3 122589            LCALL    ?C?PLDXDATA
B2:0097D6 12A5AA            LCALL    _CC_AGI_handler
B2:0097D9         
  410:       break;
B2:0097D9 029898            LJMP     ?C0132?SWITCHONOFF
  411: 
  412:     case COMMAND_CLASS_ASSOCIATION:
B2:0097DC         ?C0010?SWITCHONOFF:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 585


  413: 			frame_status = handleCommandClassAssociation(rxOpt, pCmd, cmdLength);
B2:0097DC 1298A3            LCALL    ?L?COM023C
B2:0097DF 903B27            MOV      DPTR,#?_handleCommandClassAssociation?BYTE+03H
B2:0097E2 1298A9            LCALL    ?L?COM0249
B2:0097E5 E0                MOVX     A,@DPTR
B2:0097E6 903B2A            MOV      DPTR,#?_handleCommandClassAssociation?BYTE+06H
B2:0097E9 F0                MOVX     @DPTR,A
B2:0097EA 903FDC            MOV      DPTR,#rxOpt
B2:0097ED 122589            LCALL    ?C?PLDXDATA
B2:0097F0 12A437            LCALL    _handleCommandClassAssociation
B2:0097F3         
  414:       break;
B2:0097F3 029898            LJMP     ?C0132?SWITCHONOFF
  415: 
  416:     case COMMAND_CLASS_POWERLEVEL:
B2:0097F6         ?C0011?SWITCHONOFF:
  417:       frame_status = handleCommandClassPowerLevel(rxOpt, pCmd, cmdLength);
B2:0097F6 1298A3            LCALL    ?L?COM023C
B2:0097F9 903CE1            MOV      DPTR,#?_CC_Powerlevel_handler?BYTE+03H
B2:0097FC 1298A9            LCALL    ?L?COM0249
B2:0097FF E0                MOVX     A,@DPTR
B2:009800 903CE4            MOV      DPTR,#?_CC_Powerlevel_handler?BYTE+06H
B2:009803 F0                MOVX     @DPTR,A
B2:009804 903FDC            MOV      DPTR,#rxOpt
B2:009807 122589            LCALL    ?C?PLDXDATA
B2:00980A 1298B0            LCALL    _CC_Powerlevel_handler
B2:00980D         
  418:       break;
B2:00980D 029898            LJMP     ?C0132?SWITCHONOFF
  419: 
  420:     case COMMAND_CLASS_MANUFACTURER_SPECIFIC:
B2:009810         ?C0012?SWITCHONOFF:
  421:       frame_status = handleCommandClassManufacturerSpecific(rxOpt, pCmd, cmdLength);
B2:009810 11A3              ACALL    ?L?COM023C
B2:009812 903CEE            MOV      DPTR,#?_handleCommandClassManufacturerSpecific?BYTE+03H
B2:009815 11A9              ACALL    ?L?COM0249
B2:009817 E0                MOVX     A,@DPTR
B2:009818 903CF1            MOV      DPTR,#?_handleCommandClassManufacturerSpecific?BYTE+06H
B2:00981B F0                MOVX     @DPTR,A
B2:00981C 903FDC            MOV      DPTR,#rxOpt
B2:00981F 122589            LCALL    ?C?PLDXDATA
B2:009822 12C9BA            LCALL    _handleCommandClassManufacturerSpecific
B2:009825         
  422:       break;
B2:009825 8071              SJMP     ?C0132?SWITCHONOFF
  423: 
  424:     case COMMAND_CLASS_ZWAVEPLUS_INFO:
B2:009827         ?C0013?SWITCHONOFF:
  425:       frame_status = handleCommandClassZWavePlusInfo(rxOpt, pCmd, cmdLength);
B2:009827 11A3              ACALL    ?L?COM023C
B2:009829 903C5C            MOV      DPTR,#?_handleCommandClassZWavePlusInfo?BYTE+03H
B2:00982C 11A9              ACALL    ?L?COM0249
B2:00982E E0                MOVX     A,@DPTR
B2:00982F 903C5F            MOV      DPTR,#?_handleCommandClassZWavePlusInfo?BYTE+06H
B2:009832 F0                MOVX     @DPTR,A
B2:009833 903FDC            MOV      DPTR,#rxOpt
B2:009836 122589            LCALL    ?C?PLDXDATA
B2:009839 12AA47            LCALL    _handleCommandClassZWavePlusInfo
B2:00983C         
  426:       break;
B2:00983C 805A              SJMP     ?C0132?SWITCHONOFF
  427: 
  428:     case COMMAND_CLASS_BASIC:
B2:00983E         ?C0014?SWITCHONOFF:
  429:       frame_status = handleCommandClassBasic(rxOpt, pCmd, cmdLength);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 586


B2:00983E 11A3              ACALL    ?L?COM023C
B2:009840 903CFB            MOV      DPTR,#?_handleCommandClassBasic?BYTE+03H
B2:009843 11A9              ACALL    ?L?COM0249
B2:009845 E0                MOVX     A,@DPTR
B2:009846 903CFE            MOV      DPTR,#?_handleCommandClassBasic?BYTE+06H
B2:009849 F0                MOVX     @DPTR,A
B2:00984A 903FDC            MOV      DPTR,#rxOpt
B2:00984D 122589            LCALL    ?C?PLDXDATA
B2:009850 12B7A3            LCALL    _handleCommandClassBasic
B2:009853         
  430:       break;
B2:009853 8043              SJMP     ?C0132?SWITCHONOFF
  431: 
  432:     case COMMAND_CLASS_SWITCH_BINARY:
B2:009855         ?C0015?SWITCHONOFF:
  433:       frame_status = handleCommandClassBinarySwitch(rxOpt, pCmd, cmdLength);
B2:009855 11A3              ACALL    ?L?COM023C
B2:009857 903D08            MOV      DPTR,#?_handleCommandClassBinarySwitch?BYTE+03H
B2:00985A 11A9              ACALL    ?L?COM0249
B2:00985C E0                MOVX     A,@DPTR
B2:00985D 903D0B            MOV      DPTR,#?_handleCommandClassBinarySwitch?BYTE+06H
B2:009860 F0                MOVX     @DPTR,A
B2:009861 903FDC            MOV      DPTR,#rxOpt
B2:009864 122589            LCALL    ?C?PLDXDATA
B2:009867 12D036            LCALL    _handleCommandClassBinarySwitch
B2:00986A         
  434:       break;
B2:00986A 802C              SJMP     ?C0132?SWITCHONOFF
  435: 
  436:     case COMMAND_CLASS_SUPERVISION:
B2:00986C         ?C0016?SWITCHONOFF:
  437:       frame_status = handleCommandClassSupervision(rxOpt, pCmd, cmdLength);
B2:00986C 11A3              ACALL    ?L?COM023C
B2:00986E 903ADA            MOV      DPTR,#?_handleCommandClassSupervision?BYTE+03H
B2:009871 11A9              ACALL    ?L?COM0249
B2:009873 E0                MOVX     A,@DPTR
B2:009874 903ADD            MOV      DPTR,#?_handleCommandClassSupervision?BYTE+06H
B2:009877 F0                MOVX     @DPTR,A
B2:009878 903FDC            MOV      DPTR,#rxOpt
B2:00987B 122589            LCALL    ?C?PLDXDATA
B2:00987E 128FC6            LCALL    _handleCommandClassSupervision
B2:009881         
  438:       break;
B2:009881 8015              SJMP     ?C0132?SWITCHONOFF
  439: 
  440:     case COMMAND_CLASS_MULTI_CHANNEL_ASSOCIATION_V2:
B2:009883         ?C0017?SWITCHONOFF:
  441:       frame_status = handleCommandClassMultiChannelAssociation(rxOpt, pCmd, cmdLength);
B2:009883 11A3              ACALL    ?L?COM023C
B2:009885 903C78            MOV      DPTR,#?_handleCommandClassMultiChannelAssociation?BYTE+03H
B2:009888 11A9              ACALL    ?L?COM0249
B2:00988A E0                MOVX     A,@DPTR
B2:00988B 903C7B            MOV      DPTR,#?_handleCommandClassMultiChannelAssociation?BYTE+06H
B2:00988E F0                MOVX     @DPTR,A
B2:00988F 903FDC            MOV      DPTR,#rxOpt
B2:009892 122589            LCALL    ?C?PLDXDATA
B2:009895 12A7C6            LCALL    _handleCommandClassMultiChannelAssociation
B2:009898         
B2:009898 903FE3            MOV      DPTR,#frame_status
B2:00989B EF                MOV      A,R7
B2:00989C F0                MOVX     @DPTR,A
  442:       break;
  443:   }
B2:00989D         ?C0006?SWITCHONOFF:
  444:   return frame_status;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 587


B2:00989D 903FE3            MOV      DPTR,#frame_status
B2:0098A0 E0                MOVX     A,@DPTR
B2:0098A1 FF                MOV      R7,A
  445: }
B2:0098A2 22                RET      
----- FUNCTION _Transport_ApplicationCommandHandlerEx (END) -------


----- FUNCTION ?L?COM023C (BEGIN) -----
B2:0098A3 903FDF            MOV      DPTR,#pCmd
B2:0098A6 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM023C (END) -------


----- FUNCTION ?L?COM0249 (BEGIN) -----
B2:0098A9 1225A9            LCALL    ?C?PSTXDATA
B2:0098AC 903FE2            MOV      DPTR,#cmdLength
B2:0098AF 22                RET      
----- FUNCTION ?L?COM0249 (END) -------


----- FUNCTION _CC_Powerlevel_handler (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  239: CC_Powerlevel_handler(
  240:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:0098B0 903CDE            MOV      DPTR,#rxOpt
B2:0098B3 1225A9            LCALL    ?C?PSTXDATA
  241:   ZW_APPLICATION_TX_BUFFER *pCmd,
  242:   uint8_t cmdLength)
  243: {
  244:   ZW_APPLICATION_TX_BUFFER * pTxBuf = NULL;
B2:0098B6 12B299            LCALL    ?L?COM0069
B2:0098B9 5186              ACALL    ?L?COM045C
  245:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX * pTxOptionsEx;
  246: 
  247:   UNUSED(cmdLength);
  248: 
  249:   switch (pCmd->ZW_Common.cmd)
B2:0098BB 12DB9D            LCALL    ?L?COM05CF
B2:0098BE 2401              ADD      A,#01H
B2:0098C0 125510            LCALL    ?L?COM000B
B2:0098C3 24FE              ADD      A,#0FEH
B2:0098C5 607C              JZ       ?C0030?COMMANDCLASSPOWERLEVEL
B2:0098C7 24FE              ADD      A,#0FEH
B2:0098C9 7002              JNZ      $ + 4H
B2:0098CB 21A7              AJMP     ?C0036?COMMANDCLASSPOWERLEVEL
B2:0098CD 14                DEC      A
B2:0098CE 7002              JNZ      $ + 4H
B2:0098D0 4114              AJMP     ?C0039?COMMANDCLASSPOWERLEVEL
B2:0098D2 2404              ADD      A,#04H
B2:0098D4 6002              JZ       $ + 4H
B2:0098D6 4160              AJMP     ?C0021?COMMANDCLASSPOWERLEVEL
  250:   {
  251:     case POWERLEVEL_SET:
B2:0098D8         ?C0022?COMMANDCLASSPOWERLEVEL:
  252:       if (pCmd->ZW_PowerlevelSetFrame.powerLevel > miniumPower)
B2:0098D8 903CE1            MOV      DPTR,#pCmd
B2:0098DB 5166              ACALL    ?L?COM008C
B2:0098DD 125510            LCALL    ?L?COM000B
B2:0098E0 D3                SETB     C
B2:0098E1 9409              SUBB     A,#09H
B2:0098E3 4003              JC       ?C0023?COMMANDCLASSPOWERLEVEL
  253:       {
  254:         return RECEIVED_FRAME_STATUS_FAIL;
B2:0098E5 7F02              MOV      R7,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 588


B2:0098E7 22                RET      
  255:       }
B2:0098E8         ?C0023?COMMANDCLASSPOWERLEVEL:
  256: 
  257:       /*Allways cancel timer if receiving POWERLEVEL_SET*/
  258:       if (timerPowerLevelHandle)
B2:0098E8 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:0098EB E0                MOVX     A,@DPTR
B2:0098EC 6003              JZ       ?C0025?COMMANDCLASSPOWERLEVEL
  259:       {
  260:         PowerLevelTimerCancel();
B2:0098EE 12CE09            LCALL    PowerLevelTimerCancel
  261:       }
B2:0098F1         ?C0025?COMMANDCLASSPOWERLEVEL:
  262: 
  263:       if (normalPower == pCmd->ZW_PowerlevelSetFrame.powerLevel)
B2:0098F1 903CE1            MOV      DPTR,#pCmd
B2:0098F4 5166              ACALL    ?L?COM008C
B2:0098F6 125510            LCALL    ?L?COM000B
B2:0098F9 7002              JNZ      ?C0026?COMMANDCLASSPOWERLEVEL
  264:       {
  265:         // If the power level is set to normal, we ignore the timeout.
  266:         ZW_RFPowerLevelSet(normalPower);
  267:       }
B2:0098FB 803F              SJMP     ?C0050?COMMANDCLASSPOWERLEVEL
B2:0098FD         ?C0026?COMMANDCLASSPOWERLEVEL:
  268:       else
  269:       {
  270:         if (0 == pCmd->ZW_PowerlevelSetFrame.timeout)
B2:0098FD 903CE1            MOV      DPTR,#pCmd
B2:009900 12707E            LCALL    ?L?COM00F2
B2:009903 125510            LCALL    ?L?COM000B
B2:009906 FD                MOV      R5,A
B2:009907 7003              JNZ      ?C0028?COMMANDCLASSPOWERLEVEL
  271:         {
  272:           // A timeout value of zero is invalid.
  273:           return RECEIVED_FRAME_STATUS_FAIL;
B2:009909 7F02              MOV      R7,#02H
B2:00990B 22                RET      
  274:         }
B2:00990C         ?C0028?COMMANDCLASSPOWERLEVEL:
  275: 
  276:         /*Start or Restart test*/
  277:         timerPowerLevelHandle = ZW_TimerLongStart(
  278:             ZCB_PowerLevelTimeout,
  279:             (DWORD)pCmd->ZW_PowerlevelSetFrame.timeout * 1000,
B2:00990C 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_PowerLevelTimeout
B2:00990E 7F5D              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_PowerLevelTimeout
B2:009910 C006              PUSH     AR6
B2:009912 C007              PUSH     AR7
B2:009914 ED                MOV      A,R5
B2:009915 FF                MOV      R7,A
B2:009916 7E00              MOV      R6,#00H
B2:009918 7C03              MOV      R4,#03H
B2:00991A 7DE8              MOV      R5,#0E8H
B2:00991C 122740            LCALL    ?C?LIMUL
B2:00991F 124680            LCALL    ?L?COM0239
B2:009922 D007              POP      AR7
B2:009924 D006              POP      AR6
B2:009926 12436A            LCALL    _ZW_TimerLongStart
B2:009929 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:00992C EF                MOV      A,R7
B2:00992D F0                MOVX     @DPTR,A
  280:             TIMER_ONE_TIME);
  281:         if (0xFF > timerPowerLevelHandle)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 589


B2:00992E 74FF              MOV      A,#0FFH
B2:009930 D3                SETB     C
B2:009931 9F                SUBB     A,R7
B2:009932 400C              JC       ?C0027?COMMANDCLASSPOWERLEVEL
  282:         {
  283:           ZW_RFPowerLevelSet(pCmd->ZW_PowerlevelSetFrame.powerLevel);
B2:009934 903CE1            MOV      DPTR,#pCmd
B2:009937 5166              ACALL    ?L?COM008C
B2:009939 125510            LCALL    ?L?COM000B
B2:00993C         
B2:00993C FF                MOV      R7,A
B2:00993D 12582A            LCALL    _ZW_RFPowerLevelSet
  284:         }
  285:       }
B2:009940         ?C0027?COMMANDCLASSPOWERLEVEL:
  286:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009940 7FFF              MOV      R7,#0FFH
B2:009942 22                RET      
  287:     break;
  288: 
  289:     case POWERLEVEL_GET:
B2:009943         ?C0030?COMMANDCLASSPOWERLEVEL:
  290:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:009943 12A19A            LCALL    ?L?COM01BE
B2:009946 5003              JNC      ?C0031?COMMANDCLASSPOWERLEVEL
  291:       {
  292:         return RECEIVED_FRAME_STATUS_FAIL;
B2:009948 7F02              MOV      R7,#02H
B2:00994A 22                RET      
  293:       }
B2:00994B         ?C0031?COMMANDCLASSPOWERLEVEL:
  294: 
  295:       pTxBuf = GetResponseBuffer();
B2:00994B 5184              ACALL    ?L?COM045B
  296:       /*Check pTxBuf is free*/
  297:       if (IS_NULL(pTxBuf))
B2:00994D E9                MOV      A,R1
B2:00994E 4A                ORL      A,R2
B2:00994F 7003              JNZ      ?C0032?COMMANDCLASSPOWERLEVEL
  298:       {
  299:         return RECEIVED_FRAME_STATUS_FAIL;
B2:009951 7F02              MOV      R7,#02H
B2:009953 22                RET      
  300:       }
B2:009954         ?C0032?COMMANDCLASSPOWERLEVEL:
  301: 
  302:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:009954 12B157            LCALL    ?L?COM0053
B2:009957 7403              MOV      A,#03H
B2:009959 122072            LCALL    ?C?CSTPTR
  303:       pTxBuf->ZW_PowerlevelReportFrame.cmdClass = COMMAND_CLASS_POWERLEVEL;
  304:       pTxBuf->ZW_PowerlevelReportFrame.cmd = POWERLEVEL_REPORT;
  305:       pTxBuf->ZW_PowerlevelReportFrame.powerLevel = ZW_RFPowerLevelGet();
B2:00995C 125824            LCALL    ZW_RFPowerLevelGet
B2:00995F 5163              ACALL    ?L?COM008B
B2:009961 5176              ACALL    ?L?COM0019
  306:       pTxBuf->ZW_PowerlevelReportFrame.timeout = 0;
B2:009963 903CE5            MOV      DPTR,#pTxBuf
B2:009966 12B27A            LCALL    ?L?COM0088
B2:009969 E4                CLR      A
B2:00996A 122072            LCALL    ?C?CSTPTR
  307: 
  308:       if (IsPowerLevelTimerActive())
B2:00996D 12CE36            LCALL    IsPowerLevelTimerActive
B2:009970 501D              JNC      ?C0033?COMMANDCLASSPOWERLEVEL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 590


  309:       {
  310:         pTxBuf->ZW_PowerlevelReportFrame.timeout = (uint8_t)(ZW_TimerLongGetTimeLeft(timerPowerLevelHandle) / 100
>> 0);
B2:009972 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:009975 E0                MOVX     A,@DPTR
B2:009976 FF                MOV      R7,A
B2:009977 12519B            LCALL    _ZW_TimerLongGetTimeLeft
B2:00997A 124127            LCALL    ?L?COM034A
B2:00997D 122311            LCALL    ?C?ULDIV
B2:009980 516D              ACALL    ?L?COM0017
  311:         if (0 == pTxBuf->ZW_PowerlevelReportFrame.timeout)
B2:009982 700B              JNZ      ?C0033?COMMANDCLASSPOWERLEVEL
  312:         {
  313:           /*we always report 1 sec left if we have less than 1 sec before timeout*/
  314:           pTxBuf->ZW_PowerlevelReportFrame.timeout = 1;
B2:009984 903CE5            MOV      DPTR,#pTxBuf
B2:009987 12B27A            LCALL    ?L?COM0088
B2:00998A 7401              MOV      A,#01H
B2:00998C 122072            LCALL    ?C?CSTPTR
  315:         }
  316:       }
B2:00998F         ?C0033?COMMANDCLASSPOWERLEVEL:
  317: 
  318:       if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  319:                                                         (uint8_t *)pTxBuf,
B2:00998F 903CE8            MOV      DPTR,#pTxOptionsEx
B2:009992 12A147            LCALL    ?L?COM001D
B2:009995 517E              ACALL    ?L?COM0523
B2:009997 7D04              MOV      R5,#04H
B2:009999 12A13D            LCALL    ?L?COM00BD
B2:00999C 6006              JZ       ?C0035?COMMANDCLASSPOWERLEVEL
  320:                                                         sizeof(pTxBuf->ZW_PowerlevelReportFrame),
  321:                                                         pTxOptionsEx,
  322:                                                         ZCB_ResponseJobStatus))
  323:       {
  324:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  325:         FreeResponseBuffer();
B2:00999E 12A0B6            LCALL    FreeResponseBuffer
  326:         return RECEIVED_FRAME_STATUS_FAIL;
B2:0099A1 7F02              MOV      R7,#02H
B2:0099A3 22                RET      
  327:       }
B2:0099A4         ?C0035?COMMANDCLASSPOWERLEVEL:
  328:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:0099A4 7FFF              MOV      R7,#0FFH
B2:0099A6 22                RET      
  329:     break;
  330: 
  331:     case POWERLEVEL_TEST_NODE_SET:
B2:0099A7         ?C0036?COMMANDCLASSPOWERLEVEL:
  332:       if (POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_INPROGRESS == testState) // 0x02
B2:0099A7 903DD7            MOV      DPTR,#testState
B2:0099AA E0                MOVX     A,@DPTR
B2:0099AB B40203            CJNE     A,#02H,?C0037?COMMANDCLASSPOWERLEVEL
  333:       {
  334:         return RECEIVED_FRAME_STATUS_FAIL;
B2:0099AE 7F02              MOV      R7,#02H
B2:0099B0 22                RET      
  335:       }
B2:0099B1         ?C0037?COMMANDCLASSPOWERLEVEL:
  336: 
  337:       testFrameCount = (((uint16_t)pCmd->ZW_PowerlevelTestNodeSetFrame.testFrameCount1) << 8);
B2:0099B1 12DB9D            LCALL    ?L?COM05CF
B2:0099B4 2404              ADD      A,#04H
B2:0099B6 125510            LCALL    ?L?COM000B
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 591


B2:0099B9 903DD5            MOV      DPTR,#testFrameCount
B2:0099BC F0                MOVX     @DPTR,A
B2:0099BD A3                INC      DPTR
B2:0099BE E4                CLR      A
B2:0099BF F0                MOVX     @DPTR,A
  338:       testFrameCount |= (uint16_t)pCmd->ZW_PowerlevelTestNodeSetFrame.testFrameCount2;
B2:0099C0 903CE1            MOV      DPTR,#pCmd
B2:0099C3 12576B            LCALL    ?L?COM0323
B2:0099C6 125510            LCALL    ?L?COM000B
B2:0099C9 FF                MOV      R7,A
B2:0099CA 903DD5            MOV      DPTR,#testFrameCount
B2:0099CD E0                MOVX     A,@DPTR
B2:0099CE FE                MOV      R6,A
B2:0099CF A3                INC      DPTR
B2:0099D0 E0                MOVX     A,@DPTR
B2:0099D1 4F                ORL      A,R7
B2:0099D2 FF                MOV      R7,A
B2:0099D3 903DD5            MOV      DPTR,#testFrameCount
B2:0099D6 EE                MOV      A,R6
B2:0099D7 F0                MOVX     @DPTR,A
B2:0099D8 FE                MOV      R6,A
B2:0099D9 A3                INC      DPTR
B2:0099DA EF                MOV      A,R7
B2:0099DB F0                MOVX     @DPTR,A
  339: 
  340:       if (0 == testFrameCount)
B2:0099DC 4E                ORL      A,R6
B2:0099DD 7003              JNZ      ?C0038?COMMANDCLASSPOWERLEVEL
  341:       {
  342:         return RECEIVED_FRAME_STATUS_FAIL;
B2:0099DF 7F02              MOV      R7,#02H
B2:0099E1 22                RET      
  343:       }
B2:0099E2         ?C0038?COMMANDCLASSPOWERLEVEL:
  344: 
  345:       testSourceNodeID = rxOpt->sourceNode.nodeId;
B2:0099E2 903CDE            MOV      DPTR,#rxOpt
B2:0099E5 5166              ACALL    ?L?COM008C
B2:0099E7 125510            LCALL    ?L?COM000B
B2:0099EA 903DD8            MOV      DPTR,#testSourceNodeID
B2:0099ED F0                MOVX     @DPTR,A
  346:       testNodeID = pCmd->ZW_PowerlevelTestNodeSetFrame.testNodeid;
B2:0099EE 903CE1            MOV      DPTR,#pCmd
B2:0099F1 5166              ACALL    ?L?COM008C
B2:0099F3 125510            LCALL    ?L?COM000B
B2:0099F6 903DDB            MOV      DPTR,#testNodeID
B2:0099F9 F0                MOVX     @DPTR,A
  347:       testPowerLevel = pCmd->ZW_PowerlevelTestNodeSetFrame.powerLevel;
B2:0099FA 903CE1            MOV      DPTR,#pCmd
B2:0099FD 12707E            LCALL    ?L?COM00F2
B2:009A00 125510            LCALL    ?L?COM000B
B2:009A03 903DD9            MOV      DPTR,#testPowerLevel
B2:009A06 F0                MOVX     @DPTR,A
  348:       testFrameSuccessCount = 0;
B2:009A07 E4                CLR      A
B2:009A08 903DD3            MOV      DPTR,#testFrameSuccessCount
B2:009A0B F0                MOVX     @DPTR,A
B2:009A0C A3                INC      DPTR
B2:009A0D F0                MOVX     @DPTR,A
  349: 
  350:       StartTest();
B2:009A0E 12CE1E            LCALL    StartTest
  351:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009A11 7FFF              MOV      R7,#0FFH
B2:009A13 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 592


  352:     break;
  353: 
  354:     case POWERLEVEL_TEST_NODE_GET:
B2:009A14         ?C0039?COMMANDCLASSPOWERLEVEL:
  355:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:009A14 12A19A            LCALL    ?L?COM01BE
B2:009A17 5003              JNC      ?C0040?COMMANDCLASSPOWERLEVEL
  356:       {
  357:         return RECEIVED_FRAME_STATUS_FAIL;
B2:009A19 7F02              MOV      R7,#02H
B2:009A1B 22                RET      
  358:       }
B2:009A1C         ?C0040?COMMANDCLASSPOWERLEVEL:
  359: 
  360:       pTxBuf = GetResponseBuffer();
B2:009A1C 5184              ACALL    ?L?COM045B
  361:       /*Check pTxBuf is free*/
  362:       if (IS_NULL(pTxBuf))
B2:009A1E E9                MOV      A,R1
B2:009A1F 4A                ORL      A,R2
B2:009A20 7003              JNZ      ?C0041?COMMANDCLASSPOWERLEVEL
  363:       {
  364:         return RECEIVED_FRAME_STATUS_FAIL;
B2:009A22 7F02              MOV      R7,#02H
B2:009A24 22                RET      
  365:       }
B2:009A25         ?C0041?COMMANDCLASSPOWERLEVEL:
  366: 
  367:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:009A25 12B157            LCALL    ?L?COM0053
B2:009A28 12DB01            LCALL    ?L?COM04C9
B2:009A2B 5163              ACALL    ?L?COM008B
B2:009A2D 5176              ACALL    ?L?COM0019
  368:       pTxBuf->ZW_PowerlevelTestNodeReportFrame.cmdClass = COMMAND_CLASS_POWERLEVEL;
  369:       pTxBuf->ZW_PowerlevelTestNodeReportFrame.cmd = POWERLEVEL_TEST_NODE_REPORT;
  370:       pTxBuf->ZW_PowerlevelTestNodeReportFrame.testNodeid = testNodeID;
  371:       pTxBuf->ZW_PowerlevelTestNodeReportFrame.statusOfOperation = testState;
B2:009A2F 903DD7            MOV      DPTR,#testState
B2:009A32 E0                MOVX     A,@DPTR
B2:009A33 FF                MOV      R7,A
B2:009A34 516D              ACALL    ?L?COM0017
  372:       pTxBuf->ZW_PowerlevelTestNodeReportFrame.testFrameCount1 = (uint8_t)(testFrameSuccessCount
B2:009A36 12D90E            LCALL    ?L?COM0183
B2:009A39 FF                MOV      R7,A
B2:009A3A 517E              ACALL    ?L?COM0523
B2:009A3C E9                MOV      A,R1
B2:009A3D 2404              ADD      A,#04H
B2:009A3F 5176              ACALL    ?L?COM0019
  373:                                                                            >> 8);
  374:       pTxBuf->ZW_PowerlevelTestNodeReportFrame.testFrameCount2 = (uint8_t)testFrameSuccessCount;
B2:009A41 903CE5            MOV      DPTR,#pTxBuf
B2:009A44 12D903            LCALL    ?L?COM0120
B2:009A47 ED                MOV      A,R5
B2:009A48 122072            LCALL    ?C?CSTPTR
  375: 
  376:       if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  377:           (uint8_t *)pTxBuf,
B2:009A4B 903CE8            MOV      DPTR,#pTxOptionsEx
B2:009A4E 12A147            LCALL    ?L?COM001D
B2:009A51 517E              ACALL    ?L?COM0523
B2:009A53 7D06              MOV      R5,#06H
B2:009A55 12A13D            LCALL    ?L?COM00BD
B2:009A58 6003              JZ       ?C0042?COMMANDCLASSPOWERLEVEL
  378:           sizeof(pTxBuf->ZW_PowerlevelTestNodeReportFrame),
  379:           pTxOptionsEx,
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 593


  380:           ZCB_ResponseJobStatus))
  381:       {
  382:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  383:         FreeResponseBuffer();
B2:009A5A 12A0B6            LCALL    FreeResponseBuffer
  384:       }
B2:009A5D         ?C0042?COMMANDCLASSPOWERLEVEL:
  385:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009A5D 7FFF              MOV      R7,#0FFH
B2:009A5F 22                RET      
  386:     break;
  387: 
  388:     default:
  389:       break;
  390:   }
B2:009A60         ?C0021?COMMANDCLASSPOWERLEVEL:
  391:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:009A60 7F00              MOV      R7,#00H
  392: }
B2:009A62 22                RET      
----- FUNCTION _CC_Powerlevel_handler (END) -------


----- FUNCTION ?L?COM008B (BEGIN) -----
B2:009A63 903CE5            MOV      DPTR,#pTxBuf
B2:009A66         ?L?COM008C:
B2:009A66 122589            LCALL    ?C?PLDXDATA
B2:009A69 E9                MOV      A,R1
B2:009A6A 2402              ADD      A,#02H
B2:009A6C 22                RET      
----- FUNCTION ?L?COM008B (END) -------


----- FUNCTION ?L?COM0017 (BEGIN) -----
B2:009A6D 903CE5            MOV      DPTR,#pTxBuf
B2:009A70         ?L?COM0018:
B2:009A70 122589            LCALL    ?C?PLDXDATA
B2:009A73 E9                MOV      A,R1
B2:009A74 2403              ADD      A,#03H
B2:009A76         ?L?COM0019:
B2:009A76 F9                MOV      R1,A
B2:009A77 E4                CLR      A
B2:009A78         ?L?COM001A:
B2:009A78 3A                ADDC     A,R2
B2:009A79 FA                MOV      R2,A
B2:009A7A EF                MOV      A,R7
B2:009A7B 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0017 (END) -------


----- FUNCTION ?L?COM0523 (BEGIN) -----
B2:009A7E 903CE5            MOV      DPTR,#pTxBuf
B2:009A81 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0523 (END) -------


----- FUNCTION ?L?COM045B (BEGIN) -----
B2:009A84 518C              ACALL    GetResponseBuffer
B2:009A86         ?L?COM045C:
B2:009A86 903CE5            MOV      DPTR,#pTxBuf
B2:009A89 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM045B (END) -------


----- FUNCTION GetResponseBuffer (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 594


 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  150: GetResponseBuffer(void)
  151: {
  152:   return GetResponseBufferCb(NULL);
  153: }
B2:009A8C E4                CLR      A
B2:009A8D FF                MOV      R7,A
B2:009A8E FE                MOV      R6,A
B2:;----                  JMP      _GetResponseBufferCb
----- FUNCTION GetResponseBuffer (END) -------


----- FUNCTION _GetResponseBufferCb (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  156: GetResponseBufferCb(VOID_CALLBACKFUNC(completedFunc)(BYTE))
  157: {
B2:009A8F 904370            MOV      DPTR,#completedFunc
B2:009A92 EE                MOV      A,R6
B2:009A93 F0                MOVX     @DPTR,A
B2:009A94 A3                INC      DPTR
B2:009A95 EF                MOV      A,R7
B2:009A96 12A191            LCALL    ?L?COM05EE
B2:009A99 12D568            LCALL    _MutexSet
B2:009A9C 4003              JC       ?C0015?ZW_TX_MUTEX
  158:    ZW_DEBUG_MUTEX_SEND_STR("GetResponseBufferCb ");
  159:    ZW_DEBUG_MUTEX_SEND_NUM((BYTE)completedFunc);
  160:    ZW_DEBUG_MUTEX_SEND_NL();
  161: 
  162:   /*Set mutex*/
  163:   if(FALSE == MutexSet(&(myMutex.mutexResponseActive)))
  164:   {
  165:     /*Mutex is not free.. stop current job*/
  166:     ZW_DEBUG_MUTEX_SEND_STR("Mutex RES not free!");
  167:     ZW_DEBUG_MUTEX_SEND_NL();
  168:     return NULL;
B2:009A9E 02B299            LJMP     ?L?COM0069
  169:   }
B2:009AA1         ?C0015?ZW_TX_MUTEX:
  170:   myMutex.pResponseJob = completedFunc;
B2:009AA1 904370            MOV      DPTR,#completedFunc
B2:009AA4 E0                MOVX     A,@DPTR
B2:009AA5 FF                MOV      R7,A
B2:009AA6 A3                INC      DPTR
B2:009AA7 E0                MOVX     A,@DPTR
B2:009AA8 902EA7            MOV      DPTR,#myMutex+04H
B2:009AAB CF                XCH      A,R7
B2:009AAC F0                MOVX     @DPTR,A
B2:009AAD A3                INC      DPTR
B2:009AAE EF                MOV      A,R7
B2:009AAF F0                MOVX     @DPTR,A
  171:   ZW_DEBUG_MUTEX_SEND_STR("rMutexOn");
  172:   ZW_DEBUG_MUTEX_SEND_NL();
  173:   memset((BYTE*)&myMutex.responseTxBuf, 0, sizeof(ZW_APPLICATION_TX_BUFFER) );
B2:009AB0 7B01              MOV      R3,#01H
B2:009AB2 7A2E              MOV      R2,#HIGH myMutex+056H
B2:009AB4 79F9              MOV      R1,#LOW myMutex+056H
B2:009AB6 7D48              MOV      R5,#048H
B2:009AB8 1271C2            LCALL    ?L?COM036D
B2:009ABB 7A2E              MOV      R2,#HIGH myMutex+056H
B2:009ABD 79F9              MOV      R1,#LOW myMutex+056H
  174:   return &myMutex.responseTxBuf;
  175: }
B2:009ABF 22                RET      
----- FUNCTION _GetResponseBufferCb (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 595



----- FUNCTION AssociationEndpointClearAll (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  488: AssociationEndpointClearAll(void)
  489: {
  490:   MemoryPutBuffer((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_START_far,
  491:                   NULL,
B2:009AC0 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_ENDPOINT_START_far
B2:009AC2 7FED              MOV      R7,#LOW EEOFFSET_ASSOCIATION_ENDPOINT_START_far
B2:009AC4 12B299            LCALL    ?L?COM0069
B2:009AC7 129712            LCALL    ?L?COM00EE
B2:009ACA 121B97            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
  492:                   MAX_ASSOCIATION_GROUPS*(NUMBER_OF_ENDPOINTS + 1)*MAX_ASSOCIATION_IN_GROUP,
  493:                   NULL);
  494:   MemoryPutBuffer((WORD)&EEOFFSET_TRANSPORT_CAPABILITIES_START_far,
B2:009ACD 7E13              MOV      R6,#HIGH EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:009ACF 7FF2              MOV      R7,#LOW EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:009AD1 12B299            LCALL    ?L?COM0069
B2:009AD4 129712            LCALL    ?L?COM00EE
B2:009AD7 121B97            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
  495:                   NULL,
  496:                   MAX_ASSOCIATION_GROUPS*(NUMBER_OF_ENDPOINTS + 1)*MAX_ASSOCIATION_IN_GROUP,
  497:                   NULL);
  498:   MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far, MAGIC_VALUE); /* Now ASSOCIATION EP should be OK 
>> */
B2:009ADA 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:009ADC 7FF7              MOV      R7,#LOW EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:009ADE 7D42              MOV      R5,#042H
B2:009AE0 021B7E            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION AssociationEndpointClearAll (END) -------


----- FUNCTION _AssociationGet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  668: AssociationGet(
  669:     uint8_t endpoint,
B2:009AE3 903B12            MOV      DPTR,#incomingFrame
B2:009AE6 1225A9            LCALL    ?C?PSTXDATA
B2:009AE9 903B11            MOV      DPTR,#endpoint
B2:009AEC EF                MOV      A,R7
B2:009AED F0                MOVX     @DPTR,A
  670:     uint8_t * incomingFrame,
  671:     uint8_t * outgoingFrame,
  672:     uint8_t * outgoingFrameLength)
  673: {
  674:   uint8_t nodeCount;
  675:   uint8_t nodeCountMax;
  676:   uint8_t nodeCountNoEndpoint;
  677:   uint8_t nodeFieldCount;
  678:   uint8_t mappedEndpoint;
  679:   uint8_t mappedGroupID;
  680:   MULTICHAN_NODE_ID * pCurrentNode;
  681: 
  682:   if ((*(incomingFrame + 2) > CC_AGI_groupCount_handler(endpoint)) || (0 == *(incomingFrame + 2)))
B2:009AEE 12B59D            LCALL    _CC_AGI_groupCount_handler
B2:009AF1 903B12            MOV      DPTR,#incomingFrame
B2:009AF4 5166              ACALL    ?L?COM008C
B2:009AF6 125510            LCALL    ?L?COM000B
B2:009AF9 FE                MOV      R6,A
B2:009AFA D3                SETB     C
B2:009AFB 9F                SUBB     A,R7
B2:009AFC 5003              JNC      ?C0129?ASSOCIATION_PLUS
B2:009AFE EE                MOV      A,R6
B2:009AFF 7005              JNZ      ?C0128?ASSOCIATION_PLUS
B2:009B01         ?C0129?ASSOCIATION_PLUS:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 596


  683:   {
  684:     // If the group is invalid, we return group 1
  685:     *(incomingFrame + 2) = 1;
B2:009B01 7401              MOV      A,#01H
B2:009B03 122072            LCALL    ?C?CSTPTR
  686:   }
B2:009B06         ?C0128?ASSOCIATION_PLUS:
  687: 
  688:   mappedEndpoint = endpoint;
B2:009B06 903B11            MOV      DPTR,#endpoint
B2:009B09 E0                MOVX     A,@DPTR
B2:009B0A FF                MOV      R7,A
B2:009B0B 903B1F            MOV      DPTR,#mappedEndpoint
B2:009B0E F0                MOVX     @DPTR,A
  689:   mappedGroupID = *(incomingFrame + 2);
B2:009B0F 121FB3            LCALL    ?C?CLDPTR
B2:009B12 903B20            MOV      DPTR,#mappedGroupID
B2:009B15 F0                MOVX     @DPTR,A
  690:   if (0 == endpoint)
B2:009B16 EF                MOV      A,R7
B2:009B17 700D              JNZ      ?C0130?ASSOCIATION_PLUS
  691:   {
  692:     AssGroupMappingLookUp(&mappedEndpoint, &mappedGroupID);
B2:009B19 7A3B              MOV      R2,#HIGH mappedGroupID
B2:009B1B 7920              MOV      R1,#LOW mappedGroupID
B2:009B1D 12D9F4            LCALL    ?L?COM038A
B2:009B20 7A3B              MOV      R2,#HIGH mappedEndpoint
B2:009B22 19                DEC      R1
B2:009B23 12C501            LCALL    _AssGroupMappingLookUp
  693:   }
B2:009B26         ?C0130?ASSOCIATION_PLUS:
  694: 
  695:   nodeCountMax = handleGetMaxNodesInGroup(*(incomingFrame + 2), endpoint);
B2:009B26 903B12            MOV      DPTR,#incomingFrame
B2:009B29 5166              ACALL    ?L?COM008C
B2:009B2B 125510            LCALL    ?L?COM000B
B2:009B2E 903B11            MOV      DPTR,#endpoint
B2:009B31 12C4A5            LCALL    ?L?COM0533
B2:009B34 903B1C            MOV      DPTR,#nodeCountMax
B2:009B37 EF                MOV      A,R7
B2:009B38 F0                MOVX     @DPTR,A
  696: 
  697:   *outgoingFrame = *incomingFrame; // Set the command class.
B2:009B39 903B12            MOV      DPTR,#incomingFrame
B2:009B3C 12AE26            LCALL    ?L?COM0049
B2:009B3F 903B15            MOV      DPTR,#outgoingFrame
B2:009B42 127393            LCALL    ?L?COM0596
  698: 
  699:   *(outgoingFrame + 2) = *(incomingFrame + 2); // The group
B2:009B45 903B12            MOV      DPTR,#incomingFrame
B2:009B48 5166              ACALL    ?L?COM008C
B2:009B4A 125510            LCALL    ?L?COM000B
B2:009B4D FE                MOV      R6,A
B2:009B4E 903B15            MOV      DPTR,#outgoingFrame
B2:009B51 5166              ACALL    ?L?COM008C
B2:009B53 F9                MOV      R1,A
B2:009B54 E4                CLR      A
B2:009B55 3A                ADDC     A,R2
B2:009B56 FA                MOV      R2,A
B2:009B57 EE                MOV      A,R6
B2:009B58 122072            LCALL    ?C?CSTPTR
  700:   *(outgoingFrame + 3) = nodeCountMax;
B2:009B5B 903B15            MOV      DPTR,#outgoingFrame
B2:009B5E 5170              ACALL    ?L?COM0018
  701:   *(outgoingFrame + 4) = 0; // Number of reports to follow.
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 597


B2:009B60 903B15            MOV      DPTR,#outgoingFrame
B2:009B63 125522            LCALL    ?L?COM0059
B2:009B66 E4                CLR      A
B2:009B67 122072            LCALL    ?C?CSTPTR
  702: 
  703:   // Add node IDs without endpoints if any.
  704:   nodeCountNoEndpoint = 0;
B2:009B6A 903B1D            MOV      DPTR,#nodeCountNoEndpoint
B2:009B6D F0                MOVX     @DPTR,A
  705:   for (nodeCount = 0; nodeCount < nodeCountMax; nodeCount++)
B2:009B6E 903B1B            MOV      DPTR,#nodeCount
B2:009B71 F0                MOVX     @DPTR,A
B2:009B72         ?C0131?ASSOCIATION_PLUS:
B2:009B72 12DAE9            LCALL    ?L?COM049F
B2:009B75 506B              JNC      ?C0132?ASSOCIATION_PLUS
  706:   {
  707:     pCurrentNode = &(groups[mappedEndpoint][mappedGroupID - 1].subGrp[nodeCount]);
B2:009B77 12D918            LCALL    ?L?COM0189
B2:009B7A A3                INC      DPTR
B2:009B7B E0                MOVX     A,@DPTR
B2:009B7C 75F014            MOV      B,#014H
B2:009B7F 1282DD            LCALL    ?L?COM0037
B2:009B82 FA                MOV      R2,A
B2:009B83 903B1B            MOV      DPTR,#nodeCount
B2:009B86 1282D9            LCALL    ?L?COM0035
B2:009B89 12DB17            LCALL    ?L?COM04D1
B2:009B8C 125510            LCALL    ?L?COM000B
B2:009B8F 7049              JNZ      ?C0133?ASSOCIATION_PLUS
B2:009B91 903B21            MOV      DPTR,#pCurrentNode
B2:009B94 12AE26            LCALL    ?L?COM0049
B2:009B97 FF                MOV      R7,A
B2:009B98 E4                CLR      A
B2:009B99 C3                CLR      C
B2:009B9A 9F                SUBB     A,R7
B2:009B9B 503D              JNC      ?C0133?ASSOCIATION_PLUS
  708:     if (FALSE == pCurrentNode->nodeInfo.BitMultiChannelEncap &&
  709:         0 < pCurrentNode->node.nodeId)
  710:     {
  711:       // No endpoints in the association
  712:       *(outgoingFrame + 5 + nodeCountNoEndpoint) = groups[mappedEndpoint][mappedGroupID - 1].subGrp[nodeCount].no
>> de.nodeId;
B2:009B9D 903B1F            MOV      DPTR,#mappedEndpoint
B2:009BA0 E0                MOVX     A,@DPTR
B2:009BA1 1285ED            LCALL    ?L?COM01BA
B2:009BA4 C083              PUSH     DPH
B2:009BA6 C082              PUSH     DPL
B2:009BA8 903B20            MOV      DPTR,#mappedGroupID
B2:009BAB E0                MOVX     A,@DPTR
B2:009BAC D082              POP      DPL
B2:009BAE D083              POP      DPH
B2:009BB0 1285D7            LCALL    ?L?COM018E
B2:009BB3 C083              PUSH     DPH
B2:009BB5 C082              PUSH     DPL
B2:009BB7 903B1B            MOV      DPTR,#nodeCount
B2:009BBA E0                MOVX     A,@DPTR
B2:009BBB D082              POP      DPL
B2:009BBD D083              POP      DPH
B2:009BBF 1285DD            LCALL    ?L?COM01A1
B2:009BC2 FF                MOV      R7,A
B2:009BC3 903B15            MOV      DPTR,#outgoingFrame
B2:009BC6 12D903            LCALL    ?L?COM0120
B2:009BC9 903B1D            MOV      DPTR,#nodeCountNoEndpoint
B2:009BCC E0                MOVX     A,@DPTR
B2:009BCD 7C00              MOV      R4,#00H
B2:009BCF 29                ADD      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 598


B2:009BD0 F9                MOV      R1,A
B2:009BD1 EC                MOV      A,R4
B2:009BD2 5178              ACALL    ?L?COM001A
  713:       nodeCountNoEndpoint++;
B2:009BD4 903B1D            MOV      DPTR,#nodeCountNoEndpoint
B2:009BD7 E0                MOVX     A,@DPTR
B2:009BD8 04                INC      A
B2:009BD9 F0                MOVX     @DPTR,A
  714:     }
  715:   }
B2:009BDA         ?C0133?ASSOCIATION_PLUS:
B2:009BDA 903B1B            MOV      DPTR,#nodeCount
B2:009BDD E0                MOVX     A,@DPTR
B2:009BDE 04                INC      A
B2:009BDF F0                MOVX     @DPTR,A
B2:009BE0 8090              SJMP     ?C0131?ASSOCIATION_PLUS
B2:009BE2         ?C0132?ASSOCIATION_PLUS:
  716: 
  717:   switch (*(incomingFrame)) // Check command class.
B2:009BE2 903B12            MOV      DPTR,#incomingFrame
B2:009BE5 12AE26            LCALL    ?L?COM0049
B2:009BE8 2472              ADD      A,#072H
B2:009BEA 6010              JZ       ?C0137?ASSOCIATION_PLUS
B2:009BEC 2409              ADD      A,#09H
B2:009BEE 6002              JZ       $ + 4H
B2:009BF0 8184              AJMP     ?C0144?ASSOCIATION_PLUS
  718:   {
  719:   case COMMAND_CLASS_ASSOCIATION:
B2:009BF2         ?C0136?ASSOCIATION_PLUS:
  720:     *(outgoingFrame + 1) = ASSOCIATION_REPORT_V2; // The response command.
B2:009BF2 903B15            MOV      DPTR,#outgoingFrame
B2:009BF5 12B17A            LCALL    ?L?COM0054
B2:009BF8 7403              MOV      A,#03H
  721:     break;
B2:009BFA 818B              AJMP     ?C0148?ASSOCIATION_PLUS
  722:   case COMMAND_CLASS_MULTI_CHANNEL_ASSOCIATION_V3:
B2:009BFC         ?C0137?ASSOCIATION_PLUS:
  723:     *(outgoingFrame + 1) = MULTI_CHANNEL_ASSOCIATION_REPORT_V3; // The response command.
B2:009BFC 903B15            MOV      DPTR,#outgoingFrame
B2:009BFF 12B17A            LCALL    ?L?COM0054
B2:009C02 7403              MOV      A,#03H
B2:009C04 122072            LCALL    ?C?CSTPTR
  724: 
  725:     // Add endpoint nodes if any.
  726:     nodeFieldCount = 0;
B2:009C07 E4                CLR      A
B2:009C08 903B1E            MOV      DPTR,#nodeFieldCount
B2:009C0B F0                MOVX     @DPTR,A
  727:     for (nodeCount = 0; nodeCount < nodeCountMax; nodeCount++)
B2:009C0C 903B1B            MOV      DPTR,#nodeCount
B2:009C0F F0                MOVX     @DPTR,A
B2:009C10         ?C0138?ASSOCIATION_PLUS:
B2:009C10 12DAE9            LCALL    ?L?COM049F
B2:009C13 504F              JNC      ?C0139?ASSOCIATION_PLUS
  728:     {
  729:       pCurrentNode = &(groups[mappedEndpoint][mappedGroupID - 1].subGrp[nodeCount]);
B2:009C15 12D918            LCALL    ?L?COM0189
B2:009C18 A3                INC      DPTR
B2:009C19 E0                MOVX     A,@DPTR
B2:009C1A 75F014            MOV      B,#014H
B2:009C1D 1282DD            LCALL    ?L?COM0037
B2:009C20 FA                MOV      R2,A
B2:009C21 903B1B            MOV      DPTR,#nodeCount
B2:009C24 1282D9            LCALL    ?L?COM0035
B2:009C27 12DB17            LCALL    ?L?COM04D1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 599


B2:009C2A 125510            LCALL    ?L?COM000B
B2:009C2D 6401              XRL      A,#01H
B2:009C2F 702B              JNZ      ?C0140?ASSOCIATION_PLUS
B2:009C31 903B21            MOV      DPTR,#pCurrentNode
B2:009C34 12AE26            LCALL    ?L?COM0049
B2:009C37 FF                MOV      R7,A
B2:009C38 E4                CLR      A
B2:009C39 C3                CLR      C
B2:009C3A 9F                SUBB     A,R7
B2:009C3B 501F              JNC      ?C0140?ASSOCIATION_PLUS
  730:       if (TRUE == pCurrentNode->nodeInfo.BitMultiChannelEncap &&
  731:           0 < pCurrentNode->node.nodeId)
  732:       {
  733:         // The association contains endpoints.
  734:         *(outgoingFrame + 6 + nodeCountNoEndpoint + nodeFieldCount++) = *((uint8_t *)pCurrentNode);
B2:009C3D 12D9FC            LCALL    ?L?COM039F
B2:009C40 7C00              MOV      R4,#00H
B2:009C42 12DA47            LCALL    ?L?COM03E8
B2:009C45 5178              ACALL    ?L?COM001A
  735:         *(outgoingFrame + 6 + nodeCountNoEndpoint + nodeFieldCount++) = *(((uint8_t *)pCurrentNode) + 1);
B2:009C47 903B21            MOV      DPTR,#pCurrentNode
B2:009C4A 122589            LCALL    ?C?PLDXDATA
B2:009C4D E9                MOV      A,R1
B2:009C4E 2401              ADD      A,#01H
B2:009C50 125510            LCALL    ?L?COM000B
B2:009C53 FF                MOV      R7,A
B2:009C54 12D9FC            LCALL    ?L?COM039F
B2:009C57 12DA47            LCALL    ?L?COM03E8
B2:009C5A 5178              ACALL    ?L?COM001A
  736:       }
  737:     }
B2:009C5C         ?C0140?ASSOCIATION_PLUS:
B2:009C5C 903B1B            MOV      DPTR,#nodeCount
B2:009C5F E0                MOVX     A,@DPTR
B2:009C60 04                INC      A
B2:009C61 F0                MOVX     @DPTR,A
B2:009C62 80AC              SJMP     ?C0138?ASSOCIATION_PLUS
B2:009C64         ?C0139?ASSOCIATION_PLUS:
  738: 
  739:     if (nodeFieldCount)
B2:009C64 903B1E            MOV      DPTR,#nodeFieldCount
B2:009C67 E0                MOVX     A,@DPTR
B2:009C68 FF                MOV      R7,A
B2:009C69 6023              JZ       ?C0135?ASSOCIATION_PLUS
  740:     {
  741:       *(outgoingFrame + 5 + nodeCountNoEndpoint) = MULTI_CHANNEL_ASSOCIATION_REPORT_MARKER_V3;
B2:009C6B 903B15            MOV      DPTR,#outgoingFrame
B2:009C6E 12D903            LCALL    ?L?COM0120
B2:009C71 903B1D            MOV      DPTR,#nodeCountNoEndpoint
B2:009C74 E0                MOVX     A,@DPTR
B2:009C75 FE                MOV      R6,A
B2:009C76 7C00              MOV      R4,#00H
B2:009C78 29                ADD      A,R1
B2:009C79 F9                MOV      R1,A
B2:009C7A EC                MOV      A,R4
B2:009C7B 125765            LCALL    ?L?COM01E3
  742:       *outgoingFrameLength = sizeof(ZW_MULTI_CHANNEL_ASSOCIATION_REPORT_1BYTE_V3_FRAME) - 3 + nodeCountNoEndpoint
>>  + nodeFieldCount;
B2:009C7E EE                MOV      A,R6
B2:009C7F 2406              ADD      A,#06H
B2:009C81 2F                ADD      A,R7
B2:009C82 8010              SJMP     ?C0149?ASSOCIATION_PLUS
  743: 
  744:       // We return if there are endpoint associations.
  745:       return;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 600


  746:     }
  747:     break;
  748:   default:
B2:009C84         ?C0144?ASSOCIATION_PLUS:
  749:     // We should never get here, but if we do it means that we got an invalid command class.
  750:     // Set the length to zero.
  751:     *outgoingFrameLength = 0;
B2:009C84 903B18            MOV      DPTR,#outgoingFrameLength
B2:009C87 122589            LCALL    ?C?PLDXDATA
B2:009C8A E4                CLR      A
B2:009C8B         
B2:009C8B 122072            LCALL    ?C?CSTPTR
  752:     break;
  753:   }
B2:009C8E         ?C0135?ASSOCIATION_PLUS:
  754: 
  755:   // If there are no endpoint associations we end up here.
  756:   *outgoingFrameLength = sizeof(ZW_ASSOCIATION_REPORT_1BYTE_FRAME) - 1 + nodeCountNoEndpoint;
B2:009C8E 903B1D            MOV      DPTR,#nodeCountNoEndpoint
B2:009C91 E0                MOVX     A,@DPTR
B2:009C92 2405              ADD      A,#05H
B2:009C94         
B2:009C94 FF                MOV      R7,A
B2:009C95 903B18            MOV      DPTR,#outgoingFrameLength
B2:009C98 023F95            LJMP     ?L?COM00C0
  757: }
----- FUNCTION _AssociationGet (END) -------


----- FUNCTION _handleAssociationSet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  519: BOOL handleAssociationSet(
  520:     BYTE ep,
B2:009C9B 903B90            MOV      DPTR,#pCmd
B2:009C9E 1225A9            LCALL    ?C?PSTXDATA
B2:009CA1 903B8F            MOV      DPTR,#ep
B2:009CA4 EF                MOV      A,R7
B2:009CA5 F0                MOVX     @DPTR,A
  521:     ZW_MULTI_CHANNEL_ASSOCIATION_SET_1BYTE_V2_FRAME* pCmd,
  522:     BYTE cmdLength)
  523: {
  524:   BYTE i = 0;
B2:009CA6 E4                CLR      A
B2:009CA7 903B94            MOV      DPTR,#i
B2:009CAA F0                MOVX     @DPTR,A
  525:   ASSOCIATION_NODE_LIST list;
  526:   BYTE multiChannelAssociation = FALSE;
B2:009CAB 903B9D            MOV      DPTR,#multiChannelAssociation
B2:009CAE F0                MOVX     @DPTR,A
  527: 
  528:   // Set up lifeline for root device only.
  529:   if (((NUMBER_OF_ENDPOINTS + 1) < ep || ((1 == pCmd->groupingIdentifier) && (0 < ep) )) ||
B2:009CAF 04                INC      A
B2:009CB0 C3                CLR      C
B2:009CB1 9F                SUBB     A,R7
B2:009CB2 402F              JC       ?C0099?ASSOCIATION_PLUS
B2:009CB4 903B90            MOV      DPTR,#pCmd
B2:009CB7 5166              ACALL    ?L?COM008C
B2:009CB9 125510            LCALL    ?L?COM000B
B2:009CBC FF                MOV      R7,A
B2:009CBD B4010A            CJNE     A,#01H,?C0100?ASSOCIATION_PLUS
B2:009CC0 903B8F            MOV      DPTR,#ep
B2:009CC3 E0                MOVX     A,@DPTR
B2:009CC4 FE                MOV      R6,A
B2:009CC5 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 601


B2:009CC6 C3                CLR      C
B2:009CC7 9E                SUBB     A,R6
B2:009CC8 4019              JC       ?C0099?ASSOCIATION_PLUS
B2:009CCA         ?C0100?ASSOCIATION_PLUS:
B2:009CCA EF                MOV      A,R7
B2:009CCB 6016              JZ       ?C0099?ASSOCIATION_PLUS
B2:009CCD 903B8F            MOV      DPTR,#ep
B2:009CD0 E0                MOVX     A,@DPTR
B2:009CD1 FF                MOV      R7,A
B2:009CD2 12B59D            LCALL    _CC_AGI_groupCount_handler
B2:009CD5 903B90            MOV      DPTR,#pCmd
B2:009CD8 5166              ACALL    ?L?COM008C
B2:009CDA 125510            LCALL    ?L?COM000B
B2:009CDD FE                MOV      R6,A
B2:009CDE EF                MOV      A,R7
B2:009CDF C3                CLR      C
B2:009CE0 9E                SUBB     A,R6
B2:009CE1 5002              JNC      ?C0098?ASSOCIATION_PLUS
B2:009CE3         ?C0099?ASSOCIATION_PLUS:
  530:      (0 == pCmd->groupingIdentifier) || (CC_AGI_groupCount_handler(ep) < pCmd->groupingIdentifier))
  531:   {
  532:     return FALSE;
B2:009CE3 C3                CLR      C
B2:009CE4 22                RET      
  533:   }
B2:009CE5         ?C0098?ASSOCIATION_PLUS:
  534: 
  535:   ExtractCmdClassNodeList(&list, pCmd, cmdLength, &multiChannelAssociation);
B2:009CE5 903B90            MOV      DPTR,#pCmd
B2:009CE8 122589            LCALL    ?C?PLDXDATA
B2:009CEB 903CC7            MOV      DPTR,#?_ExtractCmdClassNodeList?BYTE+03H
B2:009CEE 1225A9            LCALL    ?C?PSTXDATA
B2:009CF1 903B93            MOV      DPTR,#cmdLength
B2:009CF4 E0                MOVX     A,@DPTR
B2:009CF5 903CCA            MOV      DPTR,#?_ExtractCmdClassNodeList?BYTE+06H
B2:009CF8 F0                MOVX     @DPTR,A
B2:009CF9 7B01              MOV      R3,#01H
B2:009CFB 7A3B              MOV      R2,#HIGH multiChannelAssociation
B2:009CFD 799D              MOV      R1,#LOW multiChannelAssociation
B2:009CFF A3                INC      DPTR
B2:009D00 1225A9            LCALL    ?C?PSTXDATA
B2:009D03 7A3B              MOV      R2,#HIGH list
B2:009D05 7995              MOV      R1,#LOW list
B2:009D07 12B18E            LCALL    _ExtractCmdClassNodeList
  536: 
  537:   if ((list.noOfNodes + list.noOfMulchanNodes) > handleGetMaxNodesInGroup(pCmd->groupingIdentifier, ep))
B2:009D0A 903B90            MOV      DPTR,#pCmd
B2:009D0D 5166              ACALL    ?L?COM008C
B2:009D0F 125510            LCALL    ?L?COM000B
B2:009D12 FF                MOV      R7,A
B2:009D13 903B8F            MOV      DPTR,#ep
B2:009D16 E0                MOVX     A,@DPTR
B2:009D17 FD                MOV      R5,A
B2:009D18 12C4A8            LCALL    _handleGetMaxNodesInGroup
B2:009D1B 903B9C            MOV      DPTR,#list+07H
B2:009D1E E0                MOVX     A,@DPTR
B2:009D1F FE                MOV      R6,A
B2:009D20 903B98            MOV      DPTR,#list+03H
B2:009D23 E0                MOVX     A,@DPTR
B2:009D24 2E                ADD      A,R6
B2:009D25 D3                SETB     C
B2:009D26 9F                SUBB     A,R7
B2:009D27 4001              JC       ?C0102?ASSOCIATION_PLUS
  538:   {
  539:     return FALSE;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 602


B2:009D29 22                RET      
  540:   }
B2:009D2A         ?C0102?ASSOCIATION_PLUS:
  541: 
  542:   for(i = 0; i < list.noOfNodes; i++)
B2:009D2A E4                CLR      A
B2:009D2B 903B94            MOV      DPTR,#i
B2:009D2E F0                MOVX     @DPTR,A
B2:009D2F         ?C0103?ASSOCIATION_PLUS:
B2:009D2F 903B98            MOV      DPTR,#list+03H
B2:009D32 12DB60            LCALL    ?L?COM0534
B2:009D35 5034              JNC      ?C0104?ASSOCIATION_PLUS
  543:   {
  544:     MULTICHAN_DEST_NODE_ID node;
  545:     node.nodeId = *(list.pNodeId + i);
B2:009D37 A3                INC      DPTR
B2:009D38 122589            LCALL    ?C?PLDXDATA
B2:009D3B E9                MOV      A,R1
B2:009D3C 2E                ADD      A,R6
B2:009D3D 125510            LCALL    ?L?COM000B
B2:009D40 903B9E            MOV      DPTR,#node
B2:009D43 12D77D            LCALL    ?L?COM049C
B2:009D46 F0                MOVX     @DPTR,A
  546:     node.endpoint = 0;
  547:     node.BitAddress = 0;
  548:     if(FALSE == AssociationAddNode( pCmd->groupingIdentifier, ep, &node, FALSE ))
B2:009D47 903B90            MOV      DPTR,#pCmd
B2:009D4A 5166              ACALL    ?L?COM008C
B2:009D4C 125510            LCALL    ?L?COM000B
B2:009D4F FF                MOV      R7,A
B2:009D50 903B8F            MOV      DPTR,#ep
B2:009D53 E0                MOVX     A,@DPTR
B2:009D54 FD                MOV      R5,A
B2:009D55 7B01              MOV      R3,#01H
B2:009D57 7A3B              MOV      R2,#HIGH node
B2:009D59 799E              MOV      R1,#LOW node
B2:009D5B C243              CLR      ?_AssociationAddNode?BIT
B2:009D5D 1282E4            LCALL    _AssociationAddNode
B2:009D60 4001              JC       ?C0105?ASSOCIATION_PLUS
  549:     {
  550:       return FALSE;
B2:009D62 22                RET      
  551:     }
  552:   }
B2:009D63         ?C0105?ASSOCIATION_PLUS:
B2:009D63 903B94            MOV      DPTR,#i
B2:009D66 E0                MOVX     A,@DPTR
B2:009D67 04                INC      A
B2:009D68 F0                MOVX     @DPTR,A
B2:009D69 80C4              SJMP     ?C0103?ASSOCIATION_PLUS
B2:009D6B         ?C0104?ASSOCIATION_PLUS:
  553: 
  554:   for(i = 0; i < list.noOfMulchanNodes; i++)
B2:009D6B E4                CLR      A
B2:009D6C 903B94            MOV      DPTR,#i
B2:009D6F F0                MOVX     @DPTR,A
B2:009D70         ?C0107?ASSOCIATION_PLUS:
B2:009D70 903B9C            MOV      DPTR,#list+07H
B2:009D73 12DB60            LCALL    ?L?COM0534
B2:009D76 503C              JNC      ?C0108?ASSOCIATION_PLUS
  555:   {
  556:     if(FALSE == AssociationAddNode( pCmd->groupingIdentifier, ep, &list.pMulChanNodeId[i], multiChannelAssociatio
>> n ))
B2:009D78 EE                MOV      A,R6
B2:009D79 75F002            MOV      B,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 603


B2:009D7C A4                MUL      AB
B2:009D7D FF                MOV      R7,A
B2:009D7E 903B99            MOV      DPTR,#list+04H
B2:009D81 1282AD            LCALL    ?L?COM0086
B2:009D84 C003              PUSH     AR3
B2:009D86 C002              PUSH     AR2
B2:009D88 C001              PUSH     AR1
B2:009D8A 903B90            MOV      DPTR,#pCmd
B2:009D8D 5166              ACALL    ?L?COM008C
B2:009D8F 125510            LCALL    ?L?COM000B
B2:009D92 FF                MOV      R7,A
B2:009D93 903B8F            MOV      DPTR,#ep
B2:009D96 E0                MOVX     A,@DPTR
B2:009D97 FD                MOV      R5,A
B2:009D98 903B9D            MOV      DPTR,#multiChannelAssociation
B2:009D9B E0                MOVX     A,@DPTR
B2:009D9C 24FF              ADD      A,#0FFH
B2:009D9E 9243              MOV      ?_AssociationAddNode?BIT,C
B2:009DA0 D001              POP      AR1
B2:009DA2 D002              POP      AR2
B2:009DA4 D003              POP      AR3
B2:009DA6 1282E4            LCALL    _AssociationAddNode
B2:009DA9 4001              JC       ?C0109?ASSOCIATION_PLUS
  557:     {
  558:       return FALSE;
B2:009DAB 22                RET      
  559:     }
  560:   }
B2:009DAC         ?C0109?ASSOCIATION_PLUS:
B2:009DAC 903B94            MOV      DPTR,#i
B2:009DAF E0                MOVX     A,@DPTR
B2:009DB0 04                INC      A
B2:009DB1 F0                MOVX     @DPTR,A
B2:009DB2 80BC              SJMP     ?C0107?ASSOCIATION_PLUS
B2:009DB4         ?C0108?ASSOCIATION_PLUS:
  561:   AssociationStoreAll();
B2:009DB4 12B128            LCALL    AssociationStoreAll
  562:   return TRUE;
B2:009DB7 D3                SETB     C
  563: }
B2:009DB8 22                RET      
----- FUNCTION _handleAssociationSet (END) -------


----- FUNCTION _handleCommandClassFWUpdate (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSFIRMWAREUPDATE.C'
   92: handleCommandClassFWUpdate(
   93:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:009DB9 9039FC            MOV      DPTR,#rxOpt
B2:009DBC 12A130            LCALL    ?L?COM02CA
B2:009DBF 12A19D            LCALL    ?L?COM01BF
B2:009DC2 5003              JNC      ?C0001?COMMANDCLASSFIRMWAREUPDATE
   94:   ZW_APPLICATION_TX_BUFFER *pCmd,
   95:   BYTE cmdLength)
   96: {
   97:   if (TRUE == Check_not_legal_response_job(rxOpt))
   98:   {
   99:     // None of the following commands support endpoint bit addressing.
  100:     return RECEIVED_FRAME_STATUS_FAIL;
B2:009DC4 7F02              MOV      R7,#02H
B2:009DC6 22                RET      
  101:   }
B2:009DC7         ?C0001?COMMANDCLASSFIRMWAREUPDATE:
  102: 
  103:   switch (pCmd->ZW_Common.cmd)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 604


B2:009DC7 9039FF            MOV      DPTR,#pCmd
B2:009DCA 12A5A3            LCALL    ?L?COM001F
B2:009DCD 121FF0            LCALL    ?C?CLDOPTR
B2:009DD0 24FD              ADD      A,#0FDH
B2:009DD2 7002              JNZ      $ + 4H
B2:009DD4 E147              AJMP     ?C0011?COMMANDCLASSFIRMWAREUPDATE
B2:009DD6 24FD              ADD      A,#0FDH
B2:009DD8 7002              JNZ      $ + 4H
B2:009DDA C1E5              AJMP     ?C0010?COMMANDCLASSFIRMWAREUPDATE
B2:009DDC 24FE              ADD      A,#0FEH
B2:009DDE 7003              JNZ      $ + 5H
B2:009DE0 02A056            LJMP     ?C0018?COMMANDCLASSFIRMWAREUPDATE
B2:009DE3 2407              ADD      A,#07H
B2:009DE5 6003              JZ       $ + 5H
B2:009DE7 02A0B3            LJMP     ?C0003?COMMANDCLASSFIRMWAREUPDATE
  104:   {
  105:     case FIRMWARE_MD_GET_V4:
B2:009DEA         ?C0004?COMMANDCLASSFIRMWAREUPDATE:
  106:     {
  107:       ZW_APPLICATION_TX_BUFFER* pTxBuf = GetResponseBuffer();
B2:009DEA 12DA1D            LCALL    ?L?COM03C0
B2:009DED 7002              JNZ      $ + 4H
B2:009DEF C1E2              AJMP     ?C0005?COMMANDCLASSFIRMWAREUPDATE
  108:       if( NON_NULL( pTxBuf ) )
  109:       {
  110:         uint8_t i;
  111:         uint8_t * pData;
  112:         TRANSMIT_OPTIONS_TYPE_SINGLE_EX * pTxOptionsEx;
  113:         uint16_t fragment_size = handleCommandClassFirmwareUpdateMaxFragmentSize();
B2:009DF1 12821B            LCALL    handleCommandClassFirmwareUpdateMaxFragmentSize
B2:009DF4 903A0D            MOV      DPTR,#fragment_size
B2:009DF7 EE                MOV      A,R6
B2:009DF8 F0                MOVX     @DPTR,A
B2:009DF9 A3                INC      DPTR
B2:009DFA EF                MOV      A,R7
B2:009DFB F0                MOVX     @DPTR,A
  114: 
  115:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:009DFC 7A3A              MOV      R2,#HIGH pTxOptionsEx
B2:009DFE 790A              MOV      R1,#LOW pTxOptionsEx
B2:009E00 12A12B            LCALL    ?L?COM02C8
B2:009E03 12AB5D            LCALL    ?L?COM0107
  116: 
  117:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.cmdClass = COMMAND_CLASS_FIRMWARE_UPDATE_MD_V4;
B2:009E06 12D95A            LCALL    ?L?COM0267
  118:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.cmd = FIRMWARE_MD_REPORT_V4;
B2:009E09 903A03            MOV      DPTR,#pTxBuf
B2:009E0C 12A5A3            LCALL    ?L?COM001F
B2:009E0F 7402              MOV      A,#02H
B2:009E11 122084            LCALL    ?C?CSTOPTR
  119:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.manufacturerId1 = firmwareDescriptor.manufacturerID >> 8;
B2:009E14 907FC0            MOV      DPTR,#firmwareDescriptor+08H
B2:009E17 12DB83            LCALL    ?L?COM0593
B2:009E1A 12CFD2            LCALL    ?L?COM0369
  120:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.manufacturerId2 = firmwareDescriptor.manufacturerID & 0xFF;
B2:009E1D ED                MOV      A,R5
B2:009E1E 12716F            LCALL    ?L?COM0313
  121:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.firmware0Id1 = (BYTE)(handleFirmWareIdGet(0) >> 8);
B2:009E21 E4                CLR      A
B2:009E22 FF                MOV      R7,A
B2:009E23 12B45D            LCALL    _handleFirmWareIdGet
B2:009E26 EE                MOV      A,R6
B2:009E27 FF                MOV      R7,A
B2:009E28 903A03            MOV      DPTR,#pTxBuf
B2:009E2B 12BF24            LCALL    ?L?COM0211
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 605


  122:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.firmware0Id2 = (BYTE)(handleFirmWareIdGet(0) & 0xff);
B2:009E2E E4                CLR      A
B2:009E2F FF                MOV      R7,A
B2:009E30 12B45D            LCALL    _handleFirmWareIdGet
B2:009E33 903A03            MOV      DPTR,#pTxBuf
B2:009E36 122589            LCALL    ?C?PLDXDATA
B2:009E39 1271BB            LCALL    ?L?COM0361
  123:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.firmware0Checksum1 = firmwareDescriptor.checksum >> 8;
B2:009E3C 907FC4            MOV      DPTR,#firmwareDescriptor+0CH
B2:009E3F 12DB83            LCALL    ?L?COM0593
B2:009E42 127301            LCALL    ?L?COM04C0
B2:009E45 122084            LCALL    ?C?CSTOPTR
  124:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.firmware0Checksum2 = firmwareDescriptor.checksum & 0xFF;
  125:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.firmwareUpgradable = FIRMWARE_UPGRADABLE;
B2:009E48 74FF              MOV      A,#0FFH
B2:009E4A 12DB5A            LCALL    ?L?COM052D
  126:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.numberOfFirmwareTargets = handleNbrFirmwareVersions() - 1;
B2:009E4D 12B130            LCALL    CC_Version_getNumberOfFirmwareTargets_handler
B2:009E50 EF                MOV      A,R7
B2:009E51 14                DEC      A
B2:009E52 FF                MOV      R7,A
B2:009E53 903A03            MOV      DPTR,#pTxBuf
B2:009E56 122589            LCALL    ?C?PLDXDATA
B2:009E59 900009            MOV      DPTR,#09H
B2:009E5C EF                MOV      A,R7
B2:009E5D 122084            LCALL    ?C?CSTOPTR
  127:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.maxFragmentSize1 = (fragment_size >> 8);
B2:009E60 903A0D            MOV      DPTR,#fragment_size
B2:009E63 12D911            LCALL    ?L?COM0184
B2:009E66 90000A            MOV      DPTR,#0AH
B2:009E69 122084            LCALL    ?C?CSTOPTR
  128:         pTxBuf->ZW_FirmwareMdReport1byteV4Frame.maxFragmentSize2 = (fragment_size & 0xFF);
B2:009E6C ED                MOV      A,R5
B2:009E6D 90000B            MOV      DPTR,#0BH
B2:009E70 122084            LCALL    ?C?CSTOPTR
  129: 
  130:         pData = (uint8_t *)pTxBuf;
B2:009E73 903A07            MOV      DPTR,#pData
B2:009E76 1225A9            LCALL    ?C?PSTXDATA
  131: 
  132:         for (i = 1; i < handleNbrFirmwareVersions(); i++)
B2:009E79 903A06            MOV      DPTR,#i
B2:009E7C 7401              MOV      A,#01H
B2:009E7E F0                MOVX     @DPTR,A
B2:009E7F         ?C0006?COMMANDCLASSFIRMWAREUPDATE:
B2:009E7F 12B130            LCALL    CC_Version_getNumberOfFirmwareTargets_handler
B2:009E82 AE07              MOV      R6,AR7
B2:009E84 903A06            MOV      DPTR,#i
B2:009E87 E0                MOVX     A,@DPTR
B2:009E88 FF                MOV      R7,A
B2:009E89 C3                CLR      C
B2:009E8A 9E                SUBB     A,R6
B2:009E8B 5038              JNC      ?C0007?COMMANDCLASSFIRMWAREUPDATE
  133:         {
  134:           *(pData + 10 + (2 * i)) = (uint8_t)(handleFirmWareIdGet(i) >> 8);
B2:009E8D 12B45D            LCALL    _handleFirmWareIdGet
B2:009E90 EE                MOV      A,R6
B2:009E91 FE                MOV      R6,A
B2:009E92 903A07            MOV      DPTR,#pData
B2:009E95 12731F            LCALL    ?L?COM04D2
B2:009E98 903A06            MOV      DPTR,#i
B2:009E9B E0                MOVX     A,@DPTR
B2:009E9C FF                MOV      R7,A
B2:009E9D 127100            LCALL    ?L?COM0272
B2:009EA0 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 606


B2:009EA1 122084            LCALL    ?C?CSTOPTR
  135:           *(pData + 10 + (2 * i) + 1) = (uint8_t)(handleFirmWareIdGet(i) & 0xff);
B2:009EA4 12B45D            LCALL    _handleFirmWareIdGet
B2:009EA7 EF                MOV      A,R7
B2:009EA8 FD                MOV      R5,A
B2:009EA9 903A06            MOV      DPTR,#i
B2:009EAC E0                MOVX     A,@DPTR
B2:009EAD 75F002            MOV      B,#02H
B2:009EB0 A4                MUL      AB
B2:009EB1 FF                MOV      R7,A
B2:009EB2 A3                INC      DPTR
B2:009EB3 1282AD            LCALL    ?L?COM0086
B2:009EB6 90000B            MOV      DPTR,#0BH
B2:009EB9 ED                MOV      A,R5
B2:009EBA 122084            LCALL    ?C?CSTOPTR
  136:         }
B2:009EBD 903A06            MOV      DPTR,#i
B2:009EC0 E0                MOVX     A,@DPTR
B2:009EC1 04                INC      A
B2:009EC2 F0                MOVX     @DPTR,A
B2:009EC3 80BA              SJMP     ?C0006?COMMANDCLASSFIRMWAREUPDATE
B2:009EC5         ?C0007?COMMANDCLASSFIRMWAREUPDATE:
  137: 
  138:         if ( ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  139:                (BYTE *)pTxBuf,
B2:009EC5 903A06            MOV      DPTR,#i
B2:009EC8 E0                MOVX     A,@DPTR
B2:009EC9 25E0              ADD      A,ACC
B2:009ECB 240A              ADD      A,#0AH
B2:009ECD FD                MOV      R5,A
B2:009ECE 903A0A            MOV      DPTR,#pTxOptionsEx
B2:009ED1 12A147            LCALL    ?L?COM001D
B2:009ED4 903A03            MOV      DPTR,#pTxBuf
B2:009ED7 12A13A            LCALL    ?L?COM00BC
B2:009EDA 6003              JZ       ?C0009?COMMANDCLASSFIRMWAREUPDATE
  140:                10 + (2 * i),
  141:                pTxOptionsEx,
  142:                ZCB_ResponseJobStatus))
  143:         {
  144:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  145:           FreeResponseBuffer();
B2:009EDC 12A0B6            LCALL    FreeResponseBuffer
  146:         }
B2:009EDF         ?C0009?COMMANDCLASSFIRMWAREUPDATE:
  147:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009EDF 7FFF              MOV      R7,#0FFH
B2:009EE1 22                RET      
  148:       }
B2:009EE2         ?C0005?COMMANDCLASSFIRMWAREUPDATE:
  149:     }
  150:     return RECEIVED_FRAME_STATUS_FAIL;
B2:009EE2 7F02              MOV      R7,#02H
B2:009EE4 22                RET      
  151:     break;
  152:     case FIRMWARE_UPDATE_MD_REPORT_V4:
B2:009EE5         ?C0010?COMMANDCLASSFIRMWAREUPDATE:
  153:       {
  154:         WORD crc16Result = ZW_CheckCrc16(0x1D0F, &(pCmd->ZW_Common.cmdClass), cmdLength);
B2:009EE5 12A178            LCALL    ?L?COM050F
B2:009EE8 903A02            MOV      DPTR,#cmdLength
B2:009EEB E0                MOVX     A,@DPTR
B2:009EEC FF                MOV      R7,A
B2:009EED 903F79            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B2:009EF0 E4                CLR      A
B2:009EF1 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 607


B2:009EF2 EF                MOV      A,R7
B2:009EF3 12717F            LCALL    ?L?COM0319
B2:009EF6 903A03            MOV      DPTR,#crc16Result
B2:009EF9 EE                MOV      A,R6
B2:009EFA F0                MOVX     @DPTR,A
B2:009EFB A3                INC      DPTR
B2:009EFC EF                MOV      A,R7
B2:009EFD F0                MOVX     @DPTR,A
  155:         WORD  firmwareUpdateReportNumber = ((WORD)(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.properties1 &
B2:009EFE 9039FF            MOV      DPTR,#pCmd
B2:009F01 128F3E            LCALL    ?L?COM0029
B2:009F04 547F              ANL      A,#07FH
B2:009F06 FE                MOV      R6,A
B2:009F07 128CA5            LCALL    ?L?COM0080
B2:009F0A 1273E1            LCALL    ?L?COM05DA
B2:009F0D 903A05            MOV      DPTR,#firmwareUpdateReportNumber
B2:009F10 12732B            LCALL    ?L?COM04D8
  156:                                       FIRMWARE_UPDATE_MD_REPORT_PROPERTIES1_REPORT_NUMBER_1_MASK_V4) << 8) +
  157:                                      (WORD)(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.reportNumber2);
  158:         BYTE fw_actualFrameSize =  cmdLength -
B2:009F13 903A02            MOV      DPTR,#cmdLength
B2:009F16 E0                MOVX     A,@DPTR
B2:009F17 24FA              ADD      A,#0FAH
B2:009F19 903A07            MOV      DPTR,#fw_actualFrameSize
B2:009F1C F0                MOVX     @DPTR,A
  159:                                   /* Calculate length of actual data1 field */
  160:                                   (sizeof(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.cmdClass) +
  161:                                    sizeof(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.cmd) +
  162:                                    sizeof(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.properties1) +
  163:                                    sizeof(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.reportNumber2) +
  164:                                    sizeof(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.checksum1) +
  165:                                    sizeof(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.checksum2));
  166: 
  167: 
  168:         handleCmdClassFirmwareUpdateMdReport(crc16Result,
B2:009F1D 903A03            MOV      DPTR,#crc16Result
B2:009F20 E0                MOVX     A,@DPTR
B2:009F21 FE                MOV      R6,A
B2:009F22 A3                INC      DPTR
B2:009F23 E0                MOVX     A,@DPTR
B2:009F24 FF                MOV      R7,A
B2:009F25 128F41            LCALL    ?L?COM002A
B2:009F28 FB                MOV      R3,A
B2:009F29 C003              PUSH     AR3
B2:009F2B 9039FF            MOV      DPTR,#pCmd
B2:009F2E 125522            LCALL    ?L?COM0059
B2:009F31 903D17            MOV      DPTR,#?_handleCmdClassFirmwareUpdateMdReport?BYTE+05H
B2:009F34 1225A9            LCALL    ?C?PSTXDATA
B2:009F37 903A07            MOV      DPTR,#fw_actualFrameSize
B2:009F3A E0                MOVX     A,@DPTR
B2:009F3B 903D1A            MOV      DPTR,#?_handleCmdClassFirmwareUpdateMdReport?BYTE+08H
B2:009F3E F0                MOVX     @DPTR,A
B2:009F3F D003              POP      AR3
B2:009F41 12D17E            LCALL    _handleCmdClassFirmwareUpdateMdReport
  169:                                              firmwareUpdateReportNumber,
  170:                                              pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.properties1,
  171:                                              &(pCmd->ZW_FirmwareUpdateMdReport1byteV4Frame.data1),
  172:                                              fw_actualFrameSize);
  173: 
  174: 
  175:       }
  176:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:009F44 7FFF              MOV      R7,#0FFH
B2:009F46 22                RET      
  177:       break;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 608


  178:     case FIRMWARE_UPDATE_MD_REQUEST_GET_V4:
B2:009F47         ?C0011?COMMANDCLASSFIRMWAREUPDATE:
  179:       {
  180:         ZW_APPLICATION_TX_BUFFER* pTxBuf = GetResponseBufferCb(ZCB_CmdClassFwUpdateMdReqReport);
B2:009F47 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_CmdClassFwUpdateMdReqReport
B2:009F49 7F76              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_CmdClassFwUpdateMdReqReport
B2:009F4B 518F              ACALL    _GetResponseBufferCb
B2:009F4D 12DA20            LCALL    ?L?COM03C1
B2:009F50 7003              JNZ      $ + 5H
B2:009F52 02A053            LJMP     ?C0012?COMMANDCLASSFIRMWAREUPDATE
  181:         ZW_DEBUG_FIRMWARE_UPDATE_SEND_BYTE('a');
  182:         /*Check pTxBuf is free*/
  183:         if( NON_NULL( pTxBuf ) )
  184:         {
  185:           BYTE fwTarget = 0;
B2:009F55 E4                CLR      A
B2:009F56 903A06            MOV      DPTR,#fwTarget
B2:009F59 F0                MOVX     @DPTR,A
  186:           WORD fragmentSize = 0;
B2:009F5A A3                INC      DPTR
B2:009F5B F0                MOVX     @DPTR,A
B2:009F5C A3                INC      DPTR
B2:009F5D F0                MOVX     @DPTR,A
  187: 
  188:           TRANSMIT_OPTIONS_TYPE_SINGLE_EX * pTxOptionsEx;
  189:           ZW_DEBUG_FIRMWARE_UPDATE_SEND_BYTE('b');
  190:           RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:009F5E 7B01              MOV      R3,#01H
B2:009F60 7A3A              MOV      R2,#HIGH pTxOptionsEx
B2:009F62 7909              MOV      R1,#LOW pTxOptionsEx
B2:009F64 12A12D            LCALL    ?L?COM02C9
B2:009F67 12AB5D            LCALL    ?L?COM0107
  191: 
  192:           /*Get max size for V4 commands*/
  193:           fragmentSize = handleCommandClassFirmwareUpdateMaxFragmentSize();
B2:009F6A 12821B            LCALL    handleCommandClassFirmwareUpdateMaxFragmentSize
B2:009F6D 903A07            MOV      DPTR,#fragmentSize
B2:009F70 EE                MOV      A,R6
B2:009F71 F0                MOVX     @DPTR,A
B2:009F72 A3                INC      DPTR
B2:009F73 EF                MOV      A,R7
B2:009F74 F0                MOVX     @DPTR,A
  194: 
  195:           /*Check V4 commands*/
  196:           if( (sizeof(ZW_FIRMWARE_UPDATE_MD_REQUEST_GET_V3_FRAME) == cmdLength) ||
B2:009F75 903A02            MOV      DPTR,#cmdLength
B2:009F78 E0                MOVX     A,@DPTR
B2:009F79 FF                MOV      R7,A
B2:009F7A 640B              XRL      A,#0BH
B2:009F7C 6005              JZ       ?C0014?COMMANDCLASSFIRMWAREUPDATE
B2:009F7E EF                MOV      A,R7
B2:009F7F 640C              XRL      A,#0CH
B2:009F81 7027              JNZ      ?C0013?COMMANDCLASSFIRMWAREUPDATE
B2:009F83         ?C0014?COMMANDCLASSFIRMWAREUPDATE:
  197:               (sizeof(ZW_FIRMWARE_UPDATE_MD_REQUEST_GET_V4_FRAME) == cmdLength ))
  198:           {
  199:             ZW_DEBUG_FIRMWARE_UPDATE_SEND_BYTE('c');
  200:             fwTarget = pCmd->ZW_FirmwareUpdateMdRequestGetV4Frame.firmwareTarget;
B2:009F83 12A178            LCALL    ?L?COM050F
B2:009F86 900008            MOV      DPTR,#08H
B2:009F89 121FF0            LCALL    ?C?CLDOPTR
B2:009F8C 903A06            MOV      DPTR,#fwTarget
B2:009F8F F0                MOVX     @DPTR,A
  201:             fragmentSize =  (((WORD)pCmd->ZW_FirmwareUpdateMdRequestGetV4Frame.fragmentSize1) << 8);
B2:009F90 900009            MOV      DPTR,#09H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 609


B2:009F93 121FF0            LCALL    ?C?CLDOPTR
B2:009F96 903A07            MOV      DPTR,#fragmentSize
B2:009F99 F0                MOVX     @DPTR,A
B2:009F9A A3                INC      DPTR
B2:009F9B E4                CLR      A
B2:009F9C F0                MOVX     @DPTR,A
  202:             fragmentSize +=  (((WORD)pCmd->ZW_FirmwareUpdateMdRequestGetV4Frame.fragmentSize2) & 0xff);
B2:009F9D 90000A            MOV      DPTR,#0AH
B2:009FA0 121FF0            LCALL    ?C?CLDOPTR
B2:009FA3 FF                MOV      R7,A
B2:009FA4 903A07            MOV      DPTR,#fragmentSize
B2:009FA7 126DED            LCALL    ?L?COM0518
  203:           }
B2:009FAA         ?C0013?COMMANDCLASSFIRMWAREUPDATE:
  204: 
  205:           pTxBuf->ZW_FirmwareUpdateMdRequestReportV4Frame.cmdClass = COMMAND_CLASS_FIRMWARE_UPDATE_MD_V4;
B2:009FAA 12D95A            LCALL    ?L?COM0267
  206:           pTxBuf->ZW_FirmwareUpdateMdRequestReportV4Frame.cmd = FIRMWARE_UPDATE_MD_REQUEST_REPORT_V4;
B2:009FAD 903A03            MOV      DPTR,#pTxBuf
B2:009FB0 12A5A3            LCALL    ?L?COM001F
B2:009FB3 7404              MOV      A,#04H
B2:009FB5 12B12D            LCALL    ?L?COM052C
B2:009FB8 903A06            MOV      DPTR,#fwTarget
B2:009FBB E0                MOVX     A,@DPTR
B2:009FBC C3                CLR      C
B2:009FBD 9F                SUBB     A,R7
B2:009FBE 506D              JNC      ?C0015?COMMANDCLASSFIRMWAREUPDATE
  207: 
  208:           if( fwTarget < handleNbrFirmwareVersions())
  209:           {
  210:             uint8_t * pData = (uint8_t *)&(pCmd->ZW_FirmwareUpdateMdRequestGetV4Frame.manufacturerId1);
B2:009FC0 9039FF            MOV      DPTR,#pCmd
B2:009FC3 5166              ACALL    ?L?COM008C
B2:009FC5 F9                MOV      R1,A
B2:009FC6 E4                CLR      A
B2:009FC7 3A                ADDC     A,R2
B2:009FC8 FA                MOV      R2,A
B2:009FC9 903A0C            MOV      DPTR,#pData
B2:009FCC 1225A9            LCALL    ?C?PSTXDATA
  211:             FW_UPDATE_GET fwUpdateData;
  212:             ZW_DEBUG_FIRMWARE_UPDATE_SEND_BYTE('d');
  213: 
  214:             fwUpdateData.manufacturerId = (((uint16_t)*(pData + 0)) << 8) | *(pData + 1);
B2:009FCF 12B3A2            LCALL    ?L?COM0182
B2:009FD2 FD                MOV      R5,A
B2:009FD3 121FB3            LCALL    ?C?CLDPTR
B2:009FD6 FF                MOV      R7,A
B2:009FD7 ED                MOV      A,R5
B2:009FD8 903A0F            MOV      DPTR,#fwUpdateData
B2:009FDB CF                XCH      A,R7
B2:009FDC F0                MOVX     @DPTR,A
B2:009FDD A3                INC      DPTR
B2:009FDE EF                MOV      A,R7
B2:009FDF F0                MOVX     @DPTR,A
  215:             fwUpdateData.firmwareId     = (((uint16_t)*(pData + 2)) << 8) | *(pData + 3);
B2:009FE0 128F41            LCALL    ?L?COM002A
B2:009FE3 FE                MOV      R6,A
B2:009FE4 128CA5            LCALL    ?L?COM0080
B2:009FE7 903A11            MOV      DPTR,#fwUpdateData+02H
B2:009FEA 12721A            LCALL    ?L?COM03D6
  216:             fwUpdateData.checksum       = (((uint16_t)*(pData + 4)) << 8) | *(pData + 5);
B2:009FED 1270EB            LCALL    ?L?COM01E4
B2:009FF0 FE                MOV      R6,A
B2:009FF1 12CB9D            LCALL    ?L?COM0514
B2:009FF4 903A13            MOV      DPTR,#fwUpdateData+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 610


B2:009FF7 12712F            LCALL    ?L?COM0298
  217: 
  218:             handleCmdClassFirmwareUpdateMdReqGet(
B2:009FFA 903A06            MOV      DPTR,#fwTarget
B2:009FFD E0                MOVX     A,@DPTR
B2:009FFE FD                MOV      R5,A
B2:009FFF A3                INC      DPTR
B2:00A000 E0                MOVX     A,@DPTR
B2:00A001 FF                MOV      R7,A
B2:00A002 A3                INC      DPTR
B2:00A003 E0                MOVX     A,@DPTR
B2:00A004 903C6B            MOV      DPTR,#?_handleCmdClassFirmwareUpdateMdReqGet?BYTE+04H
B2:00A007 CF                XCH      A,R7
B2:00A008 F0                MOVX     @DPTR,A
B2:00A009 A3                INC      DPTR
B2:00A00A EF                MOV      A,R7
B2:00A00B F0                MOVX     @DPTR,A
B2:00A00C 7B01              MOV      R3,#01H
B2:00A00E 7A3A              MOV      R2,#HIGH fwUpdateData
B2:00A010 790F              MOV      R1,#LOW fwUpdateData
B2:00A012 A3                INC      DPTR
B2:00A013 1225A9            LCALL    ?C?PSTXDATA
B2:00A016 903A03            MOV      DPTR,#pTxBuf
B2:00A019 129A66            LCALL    ?L?COM008C
B2:00A01C F9                MOV      R1,A
B2:00A01D E4                CLR      A
B2:00A01E 3A                ADDC     A,R2
B2:00A01F FA                MOV      R2,A
B2:00A020 903C70            MOV      DPTR,#?_handleCmdClassFirmwareUpdateMdReqGet?BYTE+09H
B2:00A023 3130              ACALL    ?L?COM02CA
B2:00A025 122589            LCALL    ?C?PLDXDATA
B2:00A028 12D2C6            LCALL    _handleCmdClassFirmwareUpdateMdReqGet
  219:                 rxOpt,
  220:                 fwTarget,
  221:                 fragmentSize,
  222:                 &fwUpdateData,
  223:                 &(pTxBuf->ZW_FirmwareUpdateMdRequestReportV4Frame.status));
  224:           }
B2:00A02B 800B              SJMP     ?C0016?COMMANDCLASSFIRMWAREUPDATE
B2:00A02D         ?C0015?COMMANDCLASSFIRMWAREUPDATE:
  225:           else
  226:           {
  227:             ZW_DEBUG_FIRMWARE_UPDATE_SEND_BYTE('e');
  228:             /*wrong target!!*/
  229:             pTxBuf->ZW_FirmwareUpdateMdRequestReportV4Frame.status = FIRMWARE_UPDATE_MD_REQUEST_REPORT_NOT_UPGRAD
>> ABLE_V4;
B2:00A02D 903A03            MOV      DPTR,#pTxBuf
B2:00A030 127358            LCALL    ?L?COM0515
B2:00A033 7403              MOV      A,#03H
B2:00A035 122084            LCALL    ?C?CSTOPTR
  230:           }
B2:00A038         ?C0016?COMMANDCLASSFIRMWAREUPDATE:
  231: 
  232:           if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  233:                   (BYTE *)pTxBuf,
B2:00A038 903A09            MOV      DPTR,#pTxOptionsEx
B2:00A03B 3147              ACALL    ?L?COM001D
B2:00A03D 903A03            MOV      DPTR,#pTxBuf
B2:00A040 122589            LCALL    ?C?PLDXDATA
B2:00A043 7D03              MOV      R5,#03H
B2:00A045 313D              ACALL    ?L?COM00BD
B2:00A047 6007              JZ       ?C0017?COMMANDCLASSFIRMWAREUPDATE
  234:                   sizeof(ZW_FIRMWARE_UPDATE_MD_REQUEST_REPORT_V4_FRAME),
  235:                   pTxOptionsEx,
  236:                   ZCB_ResponseJobStatus))
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 611


  237:           {
  238:             ZW_DEBUG_FIRMWARE_UPDATE_SEND_BYTE('f');
  239:             FreeResponseBuffer();
B2:00A049 11B6              ACALL    FreeResponseBuffer
  240:             ZCB_CmdClassFwUpdateMdReqReport(TRANSMIT_COMPLETE_FAIL);
B2:00A04B 7F02              MOV      R7,#02H
B2:00A04D 12D445            LCALL    _ZCB_CmdClassFwUpdateMdReqReport
  241:           }
B2:00A050         ?C0017?COMMANDCLASSFIRMWAREUPDATE:
  242:           return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A050 7FFF              MOV      R7,#0FFH
B2:00A052 22                RET      
  243:         }
B2:00A053         ?C0012?COMMANDCLASSFIRMWAREUPDATE:
  244:       }
  245:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00A053 7F02              MOV      R7,#02H
B2:00A055 22                RET      
  246:       break;
  247: 
  248:     case FIRMWARE_UPDATE_ACTIVATION_SET_V4:
B2:00A056         ?C0018?COMMANDCLASSFIRMWAREUPDATE:
  249:       if(FALSE == Check_not_legal_response_job(rxOpt) &&
B2:00A056 9039FC            MOV      DPTR,#rxOpt
B2:00A059 319D              ACALL    ?L?COM01BF
B2:00A05B 4053              JC       ?C0019?COMMANDCLASSFIRMWAREUPDATE
B2:00A05D 903A02            MOV      DPTR,#cmdLength
B2:00A060 E0                MOVX     A,@DPTR
B2:00A061 6409              XRL      A,#09H
B2:00A063 704B              JNZ      ?C0019?COMMANDCLASSFIRMWAREUPDATE
  250:          (cmdLength == sizeof(ZW_FIRMWARE_UPDATE_ACTIVATION_SET_V4_FRAME)))
  251:       {
  252:         ZW_APPLICATION_TX_BUFFER *pTxBuf = GetResponseBuffer();
B2:00A065 12DA1D            LCALL    ?L?COM03C0
B2:00A068 6046              JZ       ?C0019?COMMANDCLASSFIRMWAREUPDATE
  253: 
  254:         /*Check pTxBuf is free*/
  255:         if( NON_NULL( pTxBuf ) )
  256:         {
  257:           TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
  258:           RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A06A 7A3A              MOV      R2,#HIGH pTxOptionsEx
B2:00A06C 7906              MOV      R1,#LOW pTxOptionsEx
B2:00A06E 312B              ACALL    ?L?COM02C8
B2:00A070 12AB5D            LCALL    ?L?COM0107
  259: 
  260:           memcpy(
  261:               (uint8_t*)&pTxBuf->ZW_FirmwareUpdateActivationStatusReportV4Frame,
  262:               (uint8_t*)&pCmd->ZW_FirmwareUpdateActivationSetV4Frame,
  263:               sizeof(ZW_FIRMWARE_UPDATE_ACTIVATION_SET_V4_FRAME));
B2:00A073 3178              ACALL    ?L?COM050F
B2:00A075 12C4EF            LCALL    ?L?COM0022
B2:00A078 903A03            MOV      DPTR,#pTxBuf
B2:00A07B 122589            LCALL    ?C?PLDXDATA
B2:00A07E 7F09              MOV      R7,#09H
B2:00A080 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  264: 
  265:           pTxBuf->ZW_FirmwareUpdateActivationStatusReportV4Frame.cmdClass = COMMAND_CLASS_FIRMWARE_UPDATE_MD_V4;
B2:00A083 12D95A            LCALL    ?L?COM0267
  266:           pTxBuf->ZW_FirmwareUpdateActivationStatusReportV4Frame.cmd = FIRMWARE_UPDATE_ACTIVATION_STATUS_REPORT_V
>> 4;
B2:00A086 903A03            MOV      DPTR,#pTxBuf
B2:00A089 B1A3              ACALL    ?L?COM001F
B2:00A08B 7409              MOV      A,#09H
B2:00A08D 122084            LCALL    ?C?CSTOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 612


  267:           pTxBuf->ZW_FirmwareUpdateActivationStatusReportV4Frame.firmwareUpdateStatus = ERROR_ACTIVATION_FIRMWARE
>> ;
B2:00A090 7401              MOV      A,#01H
B2:00A092 317E              ACALL    ?L?COM052B
  268: 
  269:           if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  270:               (BYTE *)pTxBuf,
B2:00A094 C003              PUSH     AR3
B2:00A096 C002              PUSH     AR2
B2:00A098 C001              PUSH     AR1
B2:00A09A 903A06            MOV      DPTR,#pTxOptionsEx
B2:00A09D 3147              ACALL    ?L?COM001D
B2:00A09F D001              POP      AR1
B2:00A0A1 D002              POP      AR2
B2:00A0A3 D003              POP      AR3
B2:00A0A5 7D0A              MOV      R5,#0AH
B2:00A0A7 313D              ACALL    ?L?COM00BD
B2:00A0A9 6002              JZ       ?C0021?COMMANDCLASSFIRMWAREUPDATE
  271:               sizeof(ZW_FIRMWARE_UPDATE_ACTIVATION_STATUS_REPORT_V4_FRAME),
  272:               pTxOptionsEx,
  273:               ZCB_ResponseJobStatus))
  274:           {
  275:             /*Job failed, free transmit-buffer pTxBuf by clearing mutex */
  276:             FreeResponseBuffer();
B2:00A0AB 11B6              ACALL    FreeResponseBuffer
  277:           }
B2:00A0AD         ?C0021?COMMANDCLASSFIRMWAREUPDATE:
  278:           return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A0AD 7FFF              MOV      R7,#0FFH
B2:00A0AF 22                RET      
  279:         }
  280:       }
B2:00A0B0         ?C0019?COMMANDCLASSFIRMWAREUPDATE:
  281:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00A0B0 7F02              MOV      R7,#02H
B2:00A0B2 22                RET      
  282:       break;
  283:     default:
  284:       break;
  285:   }
B2:00A0B3         ?C0003?COMMANDCLASSFIRMWAREUPDATE:
  286:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00A0B3 7F00              MOV      R7,#00H
  287: }
B2:00A0B5 22                RET      
----- FUNCTION _handleCommandClassFWUpdate (END) -------


----- FUNCTION FreeResponseBuffer (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  192: FreeResponseBuffer(void)
  193: {
  194:   ZW_DEBUG_MUTEX_SEND_STR("FreeResponseBuffer");
  195:   ZW_DEBUG_MUTEX_SEND_NL();
  196:   /*Remove application func-callback. User should not be called any more*/
  197:   myMutex.pResponseJob = NULL;
B2:00A0B6 E4                CLR      A
B2:00A0B7 902EA7            MOV      DPTR,#myMutex+04H
B2:00A0BA F0                MOVX     @DPTR,A
B2:00A0BB A3                INC      DPTR
B2:00A0BC 3191              ACALL    ?L?COM05EE
B2:;----                  JMP      _MutexFree
  198:   /*Free Mutex*/
----- FUNCTION FreeResponseBuffer (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 613



----- FUNCTION _MutexFree (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  224: MutexFree(BYTE* pMutex)
  225: {
;---- Variable 'pMutex' assigned to Register 'R1/R2/R3' ----
  226:   ZW_DEBUG_MUTEX_SEND_STR("MutexFree ");
  227:   ZW_DEBUG_MUTEX_SEND_NUM((BYTE)pMutex);
  228:   ZW_DEBUG_MUTEX_SEND_NL();
  229:   *pMutex = FALSE;
B2:00A0BE E4                CLR      A
B2:00A0BF 022072            LJMP     ?C?CSTPTR
----- FUNCTION _MutexFree (END) -------


----- FUNCTION AssociationClearAll (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  472: AssociationClearAll(void)
  473: {
  474:   MemoryPutBuffer((WORD)&EEOFFSET_ASSOCIATION_START_far,
  475:                   NULL, // Write zeros.
B2:00A0C2 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_START_far
B2:00A0C4 7FC3              MOV      R7,#LOW EEOFFSET_ASSOCIATION_START_far
B2:00A0C6 12B299            LCALL    ?L?COM0069
B2:00A0C9 129712            LCALL    ?L?COM00EE
B2:00A0CC 121B97            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
  476:                   MAX_ASSOCIATION_GROUPS * (NUMBER_OF_ENDPOINTS + 1) * MAX_ASSOCIATION_IN_GROUP,
  477:                   NULL);
  478:   MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_MAGIC_far, MAGIC_VALUE); /* Now ASSOCIATION should be OK */
B2:00A0CF 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_MAGIC_far
B2:00A0D1 7FC8              MOV      R7,#LOW EEOFFSET_ASSOCIATION_MAGIC_far
B2:00A0D3 7D42              MOV      R5,#042H
B2:00A0D5 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
  479:   MemoryPutByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far, MAGIC_VALUE); /* Now ASSOCIATION EP should be OK 
>> */
B2:00A0D8 12D9D2            LCALL    ?L?COM0387
  480:   MemoryPutByte((WORD)&EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far, MAGIC_VALUE);/* Now ASSOCIATION secure lev
>> el should be OK */
  481:   AssociationEndpointClearAll();
B2:00A0DB 029AC0            LJMP     AssociationEndpointClearAll
----- FUNCTION AssociationClearAll (END) -------


----- FUNCTION ?L?COM0296 (BEGIN) -----
B2:00A0DE F0                MOVX     @DPTR,A
B2:00A0DF E4                CLR      A
B2:00A0E0 A3                INC      DPTR
B2:00A0E1         ?L?COM0297:
B2:00A0E1 F0                MOVX     @DPTR,A
B2:00A0E2 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
----- FUNCTION _GetHighestSecureLevel (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  170: GetHighestSecureLevel(BYTE protocolSecBits)
  171: {
;---- Variable 'protocolSecBits' assigned to Register 'R7' ----
  172:   if(SECURITY_KEY_S2_ACCESS_BIT & protocolSecBits)
  173:   {
B2:00A0E5 EF                MOV      A,R7
B2:00A0E6 30E203            JNB      ACC.2,?C0006?ZW_TRANSPORTSECPROTOCOL
  174:     return SECURITY_KEY_S2_ACCESS;
  175:   }
B2:00A0E9 7F03              MOV      R7,#03H
B2:00A0EB 22                RET      
  176:   else if(SECURITY_KEY_S2_AUTHENTICATED_BIT & protocolSecBits)
B2:00A0EC         ?C0006?ZW_TRANSPORTSECPROTOCOL:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 614


  177:   {
B2:00A0EC EF                MOV      A,R7
B2:00A0ED 30E103            JNB      ACC.1,?C0009?ZW_TRANSPORTSECPROTOCOL
  178:     return SECURITY_KEY_S2_AUTHENTICATED;
  179:   }
B2:00A0F0 7F02              MOV      R7,#02H
B2:00A0F2 22                RET      
  180:   else if(SECURITY_KEY_S2_UNAUTHENTICATED_BIT & protocolSecBits)
B2:00A0F3         ?C0009?ZW_TRANSPORTSECPROTOCOL:
  181:   {
B2:00A0F3 EF                MOV      A,R7
B2:00A0F4 30E003            JNB      ACC.0,?C0011?ZW_TRANSPORTSECPROTOCOL
  182:     return SECURITY_KEY_S2_UNAUTHENTICATED;
  183:   }
B2:00A0F7 7F01              MOV      R7,#01H
B2:00A0F9 22                RET      
  184:   else if(SECURITY_KEY_S0_BIT & protocolSecBits)
B2:00A0FA         ?C0011?ZW_TRANSPORTSECPROTOCOL:
  185:   {
B2:00A0FA EF                MOV      A,R7
B2:00A0FB 7F00              MOV      R7,#00H
B2:00A0FD 30E702            JNB      ACC.7,?C0008?ZW_TRANSPORTSECPROTOCOL
  186:     return SECURITY_KEY_S0;
  187:   }
B2:00A100 7F04              MOV      R7,#04H
  188: 
B2:00A102         ?C0008?ZW_TRANSPORTSECPROTOCOL:
  189:   return SECURITY_KEY_NONE;
  190: }
B2:00A102 22                RET      
----- FUNCTION _GetHighestSecureLevel (END) -------


----- FUNCTION AssociationInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  502: AssociationInit(BOOL forceClearMem)
  503: {
  504:   if ((MemoryGetByte((WORD)&EEOFFSET_ASSOCIATION_MAGIC_far) != MAGIC_VALUE) ||
  505:       (TRUE == forceClearMem))
B2:00A103 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_MAGIC_far
B2:00A105 7FC8              MOV      R7,#LOW EEOFFSET_ASSOCIATION_MAGIC_far
B2:00A107 121B79            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00A10A BF4203            CJNE     R7,#042H,?C0093?ASSOCIATION_PLUS
B2:00A10D 304404            JNB      forceClearMem,?C0092?ASSOCIATION_PLUS
B2:00A110         ?C0093?ASSOCIATION_PLUS:
  506:   {
  507:     /* Clear it */
  508:     AssociationClearAll();
B2:00A110 11C2              ACALL    AssociationClearAll
  509:   }
B2:00A112 800B              SJMP     ?C0094?ASSOCIATION_PLUS
B2:00A114         ?C0092?ASSOCIATION_PLUS:
  510:   else if ((MemoryGetByte((WORD)&EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far) != MAGIC_VALUE) ||
B2:00A114 3124              ACALL    ?L?COM05EF
B2:00A116 BF4203            CJNE     R7,#042H,?C0096?ASSOCIATION_PLUS
B2:00A119 304403            JNB      forceClearMem,?C0094?ASSOCIATION_PLUS
B2:00A11C         ?C0096?ASSOCIATION_PLUS:
  511:       (TRUE == forceClearMem))
  512:   {
  513:     /* Clear it */
  514:     AssociationEndpointClearAll();
B2:00A11C 129AC0            LCALL    AssociationEndpointClearAll
  515:   }
B2:00A11F         ?C0094?ASSOCIATION_PLUS:
  516:   NVM_Action(READ_DATA);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 615


B2:00A11F E4                CLR      A
B2:00A120 FF                MOV      R7,A
B2:00A121 028689            LJMP     _NVM_Action
----- FUNCTION AssociationInit (END) -------


----- FUNCTION ?L?COM05EF (BEGIN) -----
B2:00A124 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:00A126 7FF7              MOV      R7,#LOW EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:00A128 021B79            LJMP     ?INTERBANK_TABLE?_MemoryGetByte
----- FUNCTION ?L?COM05EF (END) -------


----- FUNCTION ?L?COM02C8 (BEGIN) -----
B2:00A12B 7B01              MOV      R3,#01H
B2:00A12D         ?L?COM02C9:
B2:00A12D 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00A130         ?L?COM02CA:
B2:00A130 1225A9            LCALL    ?C?PSTXDATA
B2:00A133 9039FC            MOV      DPTR,#rxOpt
B2:00A136 22                RET      
----- FUNCTION ?L?COM02C8 (END) -------


----- FUNCTION ?L?COM00BB (BEGIN) -----
B2:00A137 903A4A            MOV      DPTR,#pTxBuf
B2:00A13A         ?L?COM00BC:
B2:00A13A 122589            LCALL    ?C?PLDXDATA
B2:00A13D         ?L?COM00BD:
B2:00A13D F141              ACALL    _Transport_SendResponseEP
B2:00A13F EF                MOV      A,R7
B2:00A140 6401              XRL      A,#01H
B2:00A142 22                RET      
----- FUNCTION ?L?COM00BB (END) -------


----- FUNCTION ?L?COM001B (BEGIN) -----
B2:00A143 FD                MOV      R5,A
B2:00A144         ?L?COM001C:
B2:00A144 903A4D            MOV      DPTR,#pTxOptionsEx
B2:00A147         ?L?COM001D:
B2:00A147 122589            LCALL    ?C?PLDXDATA
B2:00A14A 903F0F            MOV      DPTR,#?_Transport_SendResponseEP?BYTE+04H
B2:00A14D 1225A9            LCALL    ?C?PSTXDATA
B2:00A150 903F12            MOV      DPTR,#?_Transport_SendResponseEP?BYTE+07H
B2:00A153 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ResponseJobStatus
B2:00A155 F0                MOVX     @DPTR,A
B2:00A156 A3                INC      DPTR
B2:00A157 748F              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ResponseJobStatus
B2:00A159 F0                MOVX     @DPTR,A
B2:00A15A 22                RET      
----- FUNCTION ?L?COM001B (END) -------


----- FUNCTION _OTA_WriteData (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  257: OTA_WriteData(DWORD offset, BYTE *pData, WORD length)
  258: {
B2:00A15B 903EF0            MOV      DPTR,#offset
B2:00A15E 1224F1            LCALL    ?C?LSTXDATA
;---- Variable 'pData' assigned to Register 'R1/R2/R3' ----
  259:   ZW_FirmwareUpdate_NVM_Write(pData, length, offset);
  260: }
B2:00A161 903EF0            MOV      DPTR,#offset
B2:00A164 122499            LCALL    ?C?LLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 616


B2:00A167 903E1F            MOV      DPTR,#?_ZW_FirmwareUpdate_NVM_Write?BYTE+05H
B2:00A16A 1224F1            LCALL    ?C?LSTXDATA
B2:00A16D 903EF7            MOV      DPTR,#length
B2:00A170 E0                MOVX     A,@DPTR
B2:00A171 FC                MOV      R4,A
B2:00A172 A3                INC      DPTR
B2:00A173 E0                MOVX     A,@DPTR
B2:00A174 FD                MOV      R5,A
B2:00A175 021D45            LJMP     ?INTERBANK_TABLE?_ZW_FirmwareUpdate_NVM_Write
----- FUNCTION _OTA_WriteData (END) -------


----- FUNCTION ?L?COM050F (BEGIN) -----
B2:00A178 9039FF            MOV      DPTR,#pCmd
B2:00A17B 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM050F (END) -------


----- FUNCTION ?L?COM052B (BEGIN) -----
B2:00A17E 900009            MOV      DPTR,#09H
B2:00A181 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM052B (END) -------


----- FUNCTION ?L?COM05F9 (BEGIN) -----
B2:00A184 7E13              MOV      R6,#HIGH OnOffState_far
B2:00A186 7FD8              MOV      R7,#LOW OnOffState_far
B2:00A188 021B79            LJMP     ?INTERBANK_TABLE?_MemoryGetByte
----- FUNCTION ?L?COM05F9 (END) -------


----- FUNCTION _handleAppltBinarySwitchGet (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  989: handleAppltBinarySwitchGet(BYTE endpoint)
  990: {
  991:   UNUSED(endpoint);
  992:   return MemoryGetByte((WORD)&OnOffState_far);
  993: }
B2:00A18B 80F7              SJMP     ?L?COM05F9
----- FUNCTION _handleAppltBinarySwitchGet (END) -------


----- FUNCTION _getAppBasicReport (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  905: getAppBasicReport( BYTE endpoint )
  906: {
;---- Variable 'endpoint' assigned to Register 'R7' ----
  907:   return handleAppltBinarySwitchGet(endpoint);
  908: }
B2:00A18D 80FC              SJMP     _handleAppltBinarySwitchGet
----- FUNCTION _getAppBasicReport (END) -------


----- FUNCTION _getAppBasicReportTarget (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  916: getAppBasicReportTarget( BYTE endpoint )
  917: {
;---- Variable 'endpoint' assigned to Register 'R7' ----
  918:   return handleAppltBinarySwitchGet(endpoint);
  919: }
B2:00A18F 80FA              SJMP     _handleAppltBinarySwitchGet
----- FUNCTION _getAppBasicReportTarget (END) -------


----- FUNCTION ?L?COM05EE (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 617


B2:00A191 F0                MOVX     @DPTR,A
B2:00A192 7B01              MOV      R3,#01H
B2:00A194 7A2E              MOV      R2,#HIGH myMutex+01H
B2:00A196 79A4              MOV      R1,#LOW myMutex+01H
B2:00A198 22                RET      
----- FUNCTION ?L?COM05EE (END) -------


----- FUNCTION _ApplicationRfNotify (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  277: ApplicationRfNotify(BYTE rfState)
  278: {
  279:   UNUSED(rfState);
  280: }
  281: 
B2:00A199 22                RET      
----- FUNCTION _ApplicationRfNotify (END) -------


----- FUNCTION ?L?COM01BE (BEGIN) -----
B2:00A19A 903CDE            MOV      DPTR,#rxOpt
B2:00A19D         ?L?COM01BF:
B2:00A19D 122589            LCALL    ?C?PLDXDATA
B2:00A1A0 02CB4C            LJMP     _Check_not_legal_response_job
----- FUNCTION ?L?COM01BE (END) -------


----- FUNCTION _ApplicationInitHW (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  287: ApplicationInitHW(SW_WAKEUP bWakeupReason)
  288: {
B2:00A1A3 90439D            MOV      DPTR,#bWakeupReason
B2:00A1A6 EF                MOV      A,R7
B2:00A1A7 F0                MOVX     @DPTR,A
  289:   wakeupReason = bWakeupReason;
  290:   /* hardware initialization */
B2:00A1A8 90382F            MOV      DPTR,#wakeupReason
B2:00A1AB F0                MOVX     @DPTR,A
  291:   ZDP03A_InitHW(ZCB_eventSchedulerEventAdd);
B2:00A1AC 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_eventSchedulerEventAdd
B2:00A1AE 7F4E              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_eventSchedulerEventAdd
B2:00A1B0 12B8A7            LCALL    _ZDP03A_InitHW
  292:   SetPinIn(ZDP03A_KEY_1,TRUE);
B2:00A1B3 D23C              SETB     ?_SetPinIn?BIT
B2:00A1B5 7F24              MOV      R7,#024H
B2:00A1B7 12B911            LCALL    _SetPinIn
  293:   SetPinIn(ZDP03A_KEY_2,TRUE);
B2:00A1BA D23C              SETB     ?_SetPinIn?BIT
B2:00A1BC 7F36              MOV      R7,#036H
B2:00A1BE 12B911            LCALL    _SetPinIn
  294: 
  295:   SetPinOut(ZDP03A_LED_D1); /**< Learn mode indication*/
B2:00A1C1 7F07              MOV      R7,#07H
B2:00A1C3 12BA8C            LCALL    _SetPinOut
  296:   Led(ZDP03A_LED_D1,ON);
B2:00A1C6 12AC47            LCALL    ?L?COM05FB
  297:   SetPinOut(ZDP03A_LED_D2);
B2:00A1C9 7F37              MOV      R7,#037H
B2:00A1CB 12BA8C            LCALL    _SetPinOut
  298:   Led(ZDP03A_LED_D2,ON);
B2:00A1CE E4                CLR      A
B2:00A1CF FD                MOV      R5,A
B2:00A1D0 7F37              MOV      R7,#037H
B2:00A1D2 12AC4B            LCALL    _Led
  299:   Transport_OnApplicationInitHW(bWakeupReason);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 618


B2:00A1D5 90439D            MOV      DPTR,#bWakeupReason
B2:00A1D8 E0                MOVX     A,@DPTR
B2:00A1D9 FF                MOV      R7,A
B2:00A1DA 12D7EA            LCALL    _Transport_OnApplicationInitHW
  300: 
  301:   return(TRUE);
B2:00A1DD 7F01              MOV      R7,#01H
  302: }
B2:00A1DF 22                RET      
----- FUNCTION _ApplicationInitHW (END) -------


----- FUNCTION _CC_Version_handler (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSVERSION.C'
   40: CC_Version_handler(
   41:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00A1E0 9039E3            MOV      DPTR,#rxOpt
B2:00A1E3 1225A9            LCALL    ?C?PSTXDATA
   42:   ZW_APPLICATION_TX_BUFFER *pCmd,
   43:   uint8_t cmdLength)
   44: {
   45:   PROTOCOL_VERSION protocolVersion;
   46:   ZW_APPLICATION_TX_BUFFER * pTxBuf;
   47:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
   48:   UNUSED(cmdLength);
   49: 
   50:   if(TRUE == Check_not_legal_response_job(rxOpt))
B2:00A1E6 12CB4C            LCALL    _Check_not_legal_response_job
B2:00A1E9 5003              JNC      ?C0001?COMMANDCLASSVERSION
   51:   {
   52:     /*Do not support endpoint bit-addressing */
   53:     return RECEIVED_FRAME_STATUS_FAIL;
B2:00A1EB 7F02              MOV      R7,#02H
B2:00A1ED 22                RET      
   54:   }
B2:00A1EE         ?C0001?COMMANDCLASSVERSION:
   55: 
   56:   switch (pCmd->ZW_VersionGetFrame.cmd)
B2:00A1EE 9039E6            MOV      DPTR,#pCmd
B2:00A1F1 B1A3              ACALL    ?L?COM001F
B2:00A1F3 121FF0            LCALL    ?C?CLDOPTR
B2:00A1F6 24ED              ADD      A,#0EDH
B2:00A1F8 7002              JNZ      $ + 4H
B2:00A1FA 41BA              AJMP     ?C0010?COMMANDCLASSVERSION
B2:00A1FC 24FE              ADD      A,#0FEH
B2:00A1FE 7002              JNZ      $ + 4H
B2:00A200 6103              AJMP     ?C0013?COMMANDCLASSVERSION
B2:00A202 24FE              ADD      A,#0FEH
B2:00A204 7002              JNZ      $ + 4H
B2:00A206 613E              AJMP     ?C0016?COMMANDCLASSVERSION
B2:00A208 2406              ADD      A,#06H
B2:00A20A 6002              JZ       $ + 4H
B2:00A20C 8134              AJMP     ?C0003?COMMANDCLASSVERSION
   57:   {
   58:     case VERSION_GET_V2:
B2:00A20E         ?C0004?COMMANDCLASSVERSION:
   59:       pTxBuf = GetResponseBuffer();
B2:00A20E 12D983            LCALL    ?L?COM0299
B2:00A211 7002              JNZ      $ + 4H
B2:00A213 41B7              AJMP     ?C0005?COMMANDCLASSVERSION
   60:       /*Check pTxBuf is free*/
   61:       if( NON_NULL( pTxBuf ) )
   62:       {
   63:         uint8_t firmwareTargetIndex;/*firmware target number 1..N */
   64:         uint8_t numberOfFirmwareTargets;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 619


   65:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A215 B180              ACALL    ?L?COM001E
B2:00A217 7412              MOV      A,#012H
B2:00A219 122084            LCALL    ?C?CSTOPTR
   66:         pTxBuf->ZW_VersionReport1byteV2Frame.cmdClass = COMMAND_CLASS_VERSION_V2;
   67:         pTxBuf->ZW_VersionReport1byteV2Frame.cmd = VERSION_REPORT_V2;
   68:         pTxBuf->ZW_VersionReport1byteV2Frame.zWaveLibraryType = ZW_TYPE_LIBRARY();
B2:00A21C 1232B9            LCALL    ZW_Type_Library
B2:00A21F 9039F0            MOV      DPTR,#pTxBuf
B2:00A222 12B6A3            LCALL    ?L?COM00B3
   69:         ZW_GetProtocolVersion(&protocolVersion);
B2:00A225 7E39              MOV      R6,#HIGH protocolVersion
B2:00A227 7FEA              MOV      R7,#LOW protocolVersion
B2:00A229 1232BC            LCALL    _ZW_GetProtocolVersion
   70:         pTxBuf->ZW_VersionReport1byteV2Frame.zWaveProtocolVersion = protocolVersion.protocolVersionMajor;
B2:00A22C 9039EB            MOV      DPTR,#protocolVersion+01H
B2:00A22F E0                MOVX     A,@DPTR
B2:00A230 FF                MOV      R7,A
B2:00A231 12B57C            LCALL    ?L?COM00E5
B2:00A234 EF                MOV      A,R7
B2:00A235 122084            LCALL    ?C?CSTOPTR
   71:         pTxBuf->ZW_VersionReport1byteV2Frame.zWaveProtocolSubVersion = protocolVersion.protocolVersionMinor;
B2:00A238 9039EC            MOV      DPTR,#protocolVersion+02H
B2:00A23B 12B6D9            LCALL    ?L?COM039D
   72:         CC_Version_GetFirmwareVersion_handler( 0,
   73:           (VG_VERSION_REPORT_V2_VG*)&(pTxBuf->ZW_VersionReport1byteV2Frame.firmware0Version));
B2:00A23E 12D906            LCALL    ?L?COM0121
B2:00A241 E4                CLR      A
B2:00A242 FF                MOV      R7,A
B2:00A243 12B133            LCALL    _CC_Version_GetFirmwareVersion_handler
   74:         pTxBuf->ZW_VersionReport1byteV2Frame.hardwareVersion = CC_Version_GetHardwareVersion();
B2:00A246 12CD09            LCALL    CC_Version_GetHardwareVersion
B2:00A249 12DA17            LCALL    ?L?COM03BD
B2:00A24C 900007            MOV      DPTR,#07H
B2:00A24F EF                MOV      A,R7
B2:00A250 12B12D            LCALL    ?L?COM052C
B2:00A253 9039F7            MOV      DPTR,#numberOfFirmwareTargets
B2:00A256 EF                MOV      A,R7
B2:00A257 F0                MOVX     @DPTR,A
   75:         numberOfFirmwareTargets = CC_Version_getNumberOfFirmwareTargets_handler();
   76:         pTxBuf->ZW_VersionReport1byteV2Frame.numberOfFirmwareTargets = numberOfFirmwareTargets - 1;/*-1 : Firmwar
>> e version 0*/
B2:00A258 14                DEC      A
B2:00A259 12DA16            LCALL    ?L?COM03BC
B2:00A25C EF                MOV      A,R7
B2:00A25D 12DB5A            LCALL    ?L?COM052D
   77: 
   78:         for (firmwareTargetIndex = 1; firmwareTargetIndex < numberOfFirmwareTargets; firmwareTargetIndex++)
B2:00A260 9039F6            MOV      DPTR,#firmwareTargetIndex
B2:00A263 7401              MOV      A,#01H
B2:00A265 F0                MOVX     @DPTR,A
B2:00A266         ?C0006?COMMANDCLASSVERSION:
B2:00A266 9039F7            MOV      DPTR,#numberOfFirmwareTargets
B2:00A269 E0                MOVX     A,@DPTR
B2:00A26A FF                MOV      R7,A
B2:00A26B 9039F6            MOV      DPTR,#firmwareTargetIndex
B2:00A26E E0                MOVX     A,@DPTR
B2:00A26F FE                MOV      R6,A
B2:00A270 C3                CLR      C
B2:00A271 9F                SUBB     A,R7
B2:00A272 5029              JNC      ?C0007?COMMANDCLASSVERSION
   79:         {
   80:           uint8_t * pFrame = (uint8_t *)&(pTxBuf->ZW_VersionReport1byteV2Frame.variantgroup1);
B2:00A274 12DA17            LCALL    ?L?COM03BD
B2:00A277 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 620


B2:00A278 2409              ADD      A,#09H
B2:00A27A F9                MOV      R1,A
B2:00A27B E4                CLR      A
B2:00A27C 3A                ADDC     A,R2
B2:00A27D FA                MOV      R2,A
B2:00A27E 9039F8            MOV      DPTR,#pFrame
B2:00A281 1225A9            LCALL    ?C?PSTXDATA
   81:           CC_Version_GetFirmwareVersion_handler(firmwareTargetIndex, (VG_VERSION_REPORT_V2_VG *)(pFrame + 2 * (fi
>> rmwareTargetIndex - 1)));
B2:00A284 EE                MOV      A,R6
B2:00A285 14                DEC      A
B2:00A286 75F002            MOV      B,#02H
B2:00A289 1282DD            LCALL    ?L?COM0037
B2:00A28C FA                MOV      R2,A
B2:00A28D 9039F6            MOV      DPTR,#firmwareTargetIndex
B2:00A290 E0                MOVX     A,@DPTR
B2:00A291 FF                MOV      R7,A
B2:00A292 12B133            LCALL    _CC_Version_GetFirmwareVersion_handler
   82:         }
B2:00A295 9039F6            MOV      DPTR,#firmwareTargetIndex
B2:00A298 E0                MOVX     A,@DPTR
B2:00A299 04                INC      A
B2:00A29A F0                MOVX     @DPTR,A
B2:00A29B 80C9              SJMP     ?C0006?COMMANDCLASSVERSION
B2:00A29D         ?C0007?COMMANDCLASSVERSION:
   83: 
   84:         if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
   85:             (uint8_t *)pTxBuf,
B2:00A29D 9039F7            MOV      DPTR,#numberOfFirmwareTargets
B2:00A2A0 E0                MOVX     A,@DPTR
B2:00A2A1 25E0              ADD      A,ACC
B2:00A2A3 2407              ADD      A,#07H
B2:00A2A5 FD                MOV      R5,A
B2:00A2A6 9039F3            MOV      DPTR,#pTxOptionsEx
B2:00A2A9 3147              ACALL    ?L?COM001D
B2:00A2AB 9039F0            MOV      DPTR,#pTxBuf
B2:00A2AE 313A              ACALL    ?L?COM00BC
B2:00A2B0 6002              JZ       ?C0009?COMMANDCLASSVERSION
   86:             /* comment to len calc: frame size           + size of number of firmwareversions                    
>>              -   variantgroup1 (calc in size of number of firmwareversions)*/
   87:             sizeof(pTxBuf->ZW_VersionReport1byteV2Frame) + (numberOfFirmwareTargets - 1)* sizeof(VG_VERSION_REPOR
>> T_V2_VG) - sizeof(VG_VERSION_REPORT_V2_VG) , /*-1 is Firmware version 0*/
   88:             pTxOptionsEx,
   89:             ZCB_ResponseJobStatus))
   90:         {
   91:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
   92:           FreeResponseBuffer();
B2:00A2B2 11B6              ACALL    FreeResponseBuffer
   93:         }
B2:00A2B4         ?C0009?COMMANDCLASSVERSION:
   94:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A2B4 7FFF              MOV      R7,#0FFH
B2:00A2B6 22                RET      
   95:       }
B2:00A2B7         ?C0005?COMMANDCLASSVERSION:
   96:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00A2B7 7F02              MOV      R7,#02H
B2:00A2B9 22                RET      
   97:       break;
   98: 
   99:     case VERSION_COMMAND_CLASS_GET_V2:
B2:00A2BA         ?C0010?COMMANDCLASSVERSION:
  100:       pTxBuf = GetResponseBuffer();
B2:00A2BA 12D983            LCALL    ?L?COM0299
B2:00A2BD 6041              JZ       ?C0011?COMMANDCLASSVERSION
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 621


  101:       /*Check pTxBuf is free*/
  102:       if( NON_NULL( pTxBuf ) )
  103:       {
  104:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A2BF B180              ACALL    ?L?COM001E
B2:00A2C1 7414              MOV      A,#014H
B2:00A2C3 122084            LCALL    ?C?CSTOPTR
  105:         pTxBuf->ZW_VersionCommandClassReportFrame.cmdClass = COMMAND_CLASS_VERSION_V2;
  106:         pTxBuf->ZW_VersionCommandClassReportFrame.cmd = VERSION_COMMAND_CLASS_REPORT_V2;
  107:         pTxBuf->ZW_VersionCommandClassReportFrame.requestedCommandClass = pCmd->ZW_VersionCommandClassGetFrame.re
>> questedCommandClass;
B2:00A2C6 9039E6            MOV      DPTR,#pCmd
B2:00A2C9 128F3E            LCALL    ?L?COM0029
B2:00A2CC FF                MOV      R7,A
B2:00A2CD 9039F0            MOV      DPTR,#pTxBuf
B2:00A2D0 12B6A3            LCALL    ?L?COM00B3
  108:         pTxBuf->ZW_VersionCommandClassReportFrame.commandClassVersion = CC_Version_getCommandClassVersion_handler
>> (pCmd->ZW_VersionCommandClassGetFrame.requestedCommandClass);
B2:00A2D3 9039E6            MOV      DPTR,#pCmd
B2:00A2D6 128F3E            LCALL    ?L?COM0029
B2:00A2D9 FF                MOV      R7,A
B2:00A2DA 1281AC            LCALL    _CC_Version_getCommandClassVersion_handler
B2:00A2DD 12B57C            LCALL    ?L?COM00E5
B2:00A2E0 EF                MOV      A,R7
B2:00A2E1 122084            LCALL    ?C?CSTOPTR
  109: 
  110:         if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  111:             (uint8_t *)pTxBuf,
B2:00A2E4 C003              PUSH     AR3
B2:00A2E6 C002              PUSH     AR2
B2:00A2E8 C001              PUSH     AR1
B2:00A2EA 9039F3            MOV      DPTR,#pTxOptionsEx
B2:00A2ED 3147              ACALL    ?L?COM001D
B2:00A2EF D001              POP      AR1
B2:00A2F1 D002              POP      AR2
B2:00A2F3 D003              POP      AR3
B2:00A2F5 7D04              MOV      R5,#04H
B2:00A2F7 313D              ACALL    ?L?COM00BD
B2:00A2F9 6002              JZ       ?C0012?COMMANDCLASSVERSION
  112:             sizeof(pTxBuf->ZW_VersionCommandClassReportFrame),
  113:             pTxOptionsEx,
  114:             ZCB_ResponseJobStatus))
  115:         {
  116:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  117:           FreeResponseBuffer();
B2:00A2FB 11B6              ACALL    FreeResponseBuffer
  118:         }
B2:00A2FD         ?C0012?COMMANDCLASSVERSION:
  119:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A2FD 7FFF              MOV      R7,#0FFH
B2:00A2FF 22                RET      
  120:       }
B2:00A300         ?C0011?COMMANDCLASSVERSION:
  121:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00A300 7F02              MOV      R7,#02H
B2:00A302 22                RET      
  122:       break;
  123: 
  124:     case VERSION_CAPABILITIES_GET_V3:
B2:00A303         ?C0013?COMMANDCLASSVERSION:
  125:       pTxBuf = GetResponseBuffer();
B2:00A303 12D983            LCALL    ?L?COM0299
B2:00A306 7003              JNZ      ?C0014?COMMANDCLASSVERSION
  126: 
  127:       if (IS_NULL(pTxBuf))
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 622


  128:       {
  129:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A308 7F02              MOV      R7,#02H
B2:00A30A 22                RET      
  130:       }
B2:00A30B         ?C0014?COMMANDCLASSVERSION:
  131: 
  132:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A30B B180              ACALL    ?L?COM001E
B2:00A30D 7416              MOV      A,#016H
B2:00A30F 12CD25            LCALL    ?L?COM03D8
B2:00A312 9039F6            MOV      DPTR,#pProperties
B2:00A315 1225A9            LCALL    ?C?PSTXDATA
  133: 
  134:       pTxBuf->ZW_VersionCapabilitiesReportV3Frame.cmdClass    = COMMAND_CLASS_VERSION_V3;
  135:       pTxBuf->ZW_VersionCapabilitiesReportV3Frame.cmd         = VERSION_CAPABILITIES_REPORT_V3;
  136: 
  137:       /*
  138:        * The following pointer constellation might seem unnecessary, but it's done to make the
  139:        * code more readable and to enable/disable each flags easier.
  140:        *
  141:        * Sigma Designs' Z-Wave applications support all commands, but the support can be toggled
  142:        * corresponding to the Version Command Class specification
  143:        */
  144:       {
  145:         uint8_t * pProperties = &(pTxBuf->ZW_VersionCapabilitiesReportV3Frame.properties1);
  146:         *pProperties = 0x00;
B2:00A318 E4                CLR      A
B2:00A319 12AE20            LCALL    ?L?COM0048
B2:00A31C 4401              ORL      A,#01H
B2:00A31E 12AE20            LCALL    ?L?COM0048
B2:00A321 4402              ORL      A,#02H
B2:00A323 12AE20            LCALL    ?L?COM0048
B2:00A326 4404              ORL      A,#04H
B2:00A328 122072            LCALL    ?C?CSTPTR
  147: 
  148:         *pProperties |= VERSION_CAPABILITIES_REPORT_PROPERTIES1_VERSION_BIT_MASK_V3;
  149:         *pProperties |= VERSION_CAPABILITIES_REPORT_PROPERTIES1_COMMAND_CLASS_BIT_MASK_V3;
  150:         *pProperties |= VERSION_CAPABILITIES_REPORT_PROPERTIES1_Z_WAVE_SOFTWARE_BIT_MASK_V3;
  151:       }
  152: 
  153:       if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  154:           (uint8_t *)pTxBuf,
B2:00A32B 9039F3            MOV      DPTR,#pTxOptionsEx
B2:00A32E 3147              ACALL    ?L?COM001D
B2:00A330 12DA17            LCALL    ?L?COM03BD
B2:00A333 7D03              MOV      R5,#03H
B2:00A335 313D              ACALL    ?L?COM00BD
B2:00A337 6002              JZ       ?C0015?COMMANDCLASSVERSION
  155:           sizeof(pTxBuf->ZW_VersionCapabilitiesReportV3Frame),
  156:           pTxOptionsEx,
  157:           ZCB_ResponseJobStatus))
  158:       {
  159:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  160:         FreeResponseBuffer();
B2:00A339 11B6              ACALL    FreeResponseBuffer
  161:       }
B2:00A33B         ?C0015?COMMANDCLASSVERSION:
  162:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A33B 7FFF              MOV      R7,#0FFH
B2:00A33D 22                RET      
  163:       break;
  164: 
  165:     case VERSION_ZWAVE_SOFTWARE_GET_V3:
B2:00A33E         ?C0016?COMMANDCLASSVERSION:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 623


  166:       pTxBuf = GetResponseBuffer();
B2:00A33E 12D983            LCALL    ?L?COM0299
B2:00A341 7003              JNZ      ?C0017?COMMANDCLASSVERSION
  167: 
  168:       if (IS_NULL(pTxBuf))
  169:       {
  170:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A343 7F02              MOV      R7,#02H
B2:00A345 22                RET      
  171:       }
B2:00A346         ?C0017?COMMANDCLASSVERSION:
  172: 
  173:       RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A346 B180              ACALL    ?L?COM001E
B2:00A348 7418              MOV      A,#018H
B2:00A34A 122084            LCALL    ?C?CSTOPTR
  174: 
  175:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.cmdClass    = COMMAND_CLASS_VERSION_V3;
  176:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.cmd         = VERSION_ZWAVE_SOFTWARE_REPORT_V3;
  177: 
  178:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.sdkVersion1 = SDK_VERSION_MAJOR;
B2:00A34D 900002            MOV      DPTR,#02H
B2:00A350 7406              MOV      A,#06H
B2:00A352 122084            LCALL    ?C?CSTOPTR
  179:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.sdkVersion2 = SDK_VERSION_MINOR;
B2:00A355 7454              MOV      A,#054H
B2:00A357 12CBCD            LCALL    ?L?COM03E6
B2:00A35A 122084            LCALL    ?C?CSTOPTR
  180:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.sdkVersion3 = SDK_VERSION_PATCH;
  181: 
  182:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationFrameworkApiVersion1 = ZAF_VERSION_MAJOR;
B2:00A35D 900005            MOV      DPTR,#05H
B2:00A360 7404              MOV      A,#04H
B2:00A362 122084            LCALL    ?C?CSTOPTR
  183:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationFrameworkApiVersion2 = ZAF_VERSION_MINOR;
B2:00A365 900006            MOV      DPTR,#06H
B2:00A368 7405              MOV      A,#05H
B2:00A36A 12CBF1            LCALL    ?L?COM036C
B2:00A36D E4                CLR      A
B2:00A36E 122084            LCALL    ?C?CSTOPTR
  184:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationFrameworkApiVersion3 = ZAF_VERSION_PATCH;
  185: 
  186:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationFrameworkBuildNumber1 = (uint8_t)(ZAF_BUILD_NO >> 8
>> );
B2:00A371 900008            MOV      DPTR,#08H
B2:00A374 74CC              MOV      A,#0CCH
B2:00A376 122084            LCALL    ?C?CSTOPTR
  187:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationFrameworkBuildNumber2 = (uint8_t)ZAF_BUILD_NO;
B2:00A379 74DD              MOV      A,#0DDH
B2:00A37B 317E              ACALL    ?L?COM052B
  188: 
  189:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.hostInterfaceVersion1 = hostInterfaceVersionInfo.major;
B2:00A37D 903E47            MOV      DPTR,#hostInterfaceVersionInfo
B2:00A380 E0                MOVX     A,@DPTR
B2:00A381 90000A            MOV      DPTR,#0AH
B2:00A384 122084            LCALL    ?C?CSTOPTR
  190:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.hostInterfaceVersion2 = hostInterfaceVersionInfo.minor;
B2:00A387 903E48            MOV      DPTR,#hostInterfaceVersionInfo+01H
B2:00A38A E0                MOVX     A,@DPTR
B2:00A38B 90000B            MOV      DPTR,#0BH
B2:00A38E 122084            LCALL    ?C?CSTOPTR
  191:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.hostInterfaceVersion3 = hostInterfaceVersionInfo.patch;
B2:00A391 903E49            MOV      DPTR,#hostInterfaceVersionInfo+02H
B2:00A394 E0                MOVX     A,@DPTR
B2:00A395 90000C            MOV      DPTR,#0CH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 624


B2:00A398 122084            LCALL    ?C?CSTOPTR
  192:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.hostInterfaceBuildNumber1 = (uint8_t)(hostInterfaceVersionInfo
>> .build_number >> 8);
B2:00A39B 903E4A            MOV      DPTR,#hostInterfaceVersionInfo+03H
B2:00A39E 12D911            LCALL    ?L?COM0184
B2:00A3A1 90000D            MOV      DPTR,#0DH
B2:00A3A4 122084            LCALL    ?C?CSTOPTR
  193:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.hostInterfaceBuildNumber2 = (uint8_t)hostInterfaceVersionInfo.
>> build_number;
B2:00A3A7 90000E            MOV      DPTR,#0EH
B2:00A3AA ED                MOV      A,R5
B2:00A3AB 122084            LCALL    ?C?CSTOPTR
  194: 
  195:       {
  196:         PROTOCOL_VERSION protocolVersion;
  197:         ZW_GetProtocolVersion(&protocolVersion);
B2:00A3AE 7E39              MOV      R6,#HIGH protocolVersion
B2:00A3B0 7FF6              MOV      R7,#LOW protocolVersion
B2:00A3B2 1232BC            LCALL    _ZW_GetProtocolVersion
  198:         pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.zWaveProtocolVersion1 = protocolVersion.protocolVersionMajor
>> ;
B2:00A3B5 9039F7            MOV      DPTR,#protocolVersion+01H
B2:00A3B8 E0                MOVX     A,@DPTR
B2:00A3B9 12DA16            LCALL    ?L?COM03BC
B2:00A3BC 90000F            MOV      DPTR,#0FH
B2:00A3BF EF                MOV      A,R7
B2:00A3C0 122084            LCALL    ?C?CSTOPTR
  199:         pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.zWaveProtocolVersion2 = protocolVersion.protocolVersionMinor
>> ;
B2:00A3C3 9039F8            MOV      DPTR,#protocolVersion+02H
B2:00A3C6 E0                MOVX     A,@DPTR
B2:00A3C7 900010            MOV      DPTR,#010H
B2:00A3CA 122084            LCALL    ?C?CSTOPTR
  200:         pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.zWaveProtocolVersion3 = 0;
B2:00A3CD 900011            MOV      DPTR,#011H
B2:00A3D0 E4                CLR      A
B2:00A3D1 122084            LCALL    ?C?CSTOPTR
  201:         pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.zWaveProtocolBuildNumber1 = (uint8_t)(protocolVersion.build_
>> number >> 8);
B2:00A3D4 9039FA            MOV      DPTR,#protocolVersion+04H
B2:00A3D7 12D911            LCALL    ?L?COM0184
B2:00A3DA 900012            MOV      DPTR,#012H
B2:00A3DD 122084            LCALL    ?C?CSTOPTR
  202:         pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.zWaveProtocolBuildNumber2 = (uint8_t)protocolVersion.build_n
>> umber;
B2:00A3E0 900013            MOV      DPTR,#013H
B2:00A3E3 ED                MOV      A,R5
B2:00A3E4 122084            LCALL    ?C?CSTOPTR
  203:       }
  204: 
  205:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationVersion1 = applicationVersionInfo.major;
B2:00A3E7 903E42            MOV      DPTR,#applicationVersionInfo
B2:00A3EA E0                MOVX     A,@DPTR
B2:00A3EB 900014            MOV      DPTR,#014H
B2:00A3EE 122084            LCALL    ?C?CSTOPTR
  206:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationVersion2 = applicationVersionInfo.minor;
B2:00A3F1 903E43            MOV      DPTR,#applicationVersionInfo+01H
B2:00A3F4 E0                MOVX     A,@DPTR
B2:00A3F5 900015            MOV      DPTR,#015H
B2:00A3F8 122084            LCALL    ?C?CSTOPTR
  207:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationVersion3 = applicationVersionInfo.patch;
B2:00A3FB 903E44            MOV      DPTR,#applicationVersionInfo+02H
B2:00A3FE E0                MOVX     A,@DPTR
B2:00A3FF 900016            MOV      DPTR,#016H
B2:00A402 122084            LCALL    ?C?CSTOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 625


  208:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationBuildNumber1 = (uint8_t)(applicationVersionInfo.bui
>> ld_number >> 8);
B2:00A405 903E45            MOV      DPTR,#applicationVersionInfo+03H
B2:00A408 12D911            LCALL    ?L?COM0184
B2:00A40B 900017            MOV      DPTR,#017H
B2:00A40E 122084            LCALL    ?C?CSTOPTR
  209:       pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame.applicationBuildNumber2 = (uint8_t)applicationVersionInfo.buil
>> d_number;
B2:00A411 900018            MOV      DPTR,#018H
B2:00A414 ED                MOV      A,R5
B2:00A415 122084            LCALL    ?C?CSTOPTR
  210: 
  211:       if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  212:           (uint8_t *)pTxBuf,
B2:00A418 C003              PUSH     AR3
B2:00A41A C002              PUSH     AR2
B2:00A41C C001              PUSH     AR1
B2:00A41E 9039F3            MOV      DPTR,#pTxOptionsEx
B2:00A421 3147              ACALL    ?L?COM001D
B2:00A423 D001              POP      AR1
B2:00A425 D002              POP      AR2
B2:00A427 D003              POP      AR3
B2:00A429 7D19              MOV      R5,#019H
B2:00A42B 313D              ACALL    ?L?COM00BD
B2:00A42D 6002              JZ       ?C0018?COMMANDCLASSVERSION
  213:           sizeof(pTxBuf->ZW_VersionZwaveSoftwareReportV3Frame),
  214:           pTxOptionsEx,
  215:           ZCB_ResponseJobStatus))
  216:       {
  217:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  218:         FreeResponseBuffer();
B2:00A42F 11B6              ACALL    FreeResponseBuffer
  219:       }
B2:00A431         ?C0018?COMMANDCLASSVERSION:
  220:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A431 7FFF              MOV      R7,#0FFH
B2:00A433 22                RET      
  221:       break;
  222: 
  223:     default:
  224:       // Do nothing.
  225:       break;
  226:   }
B2:00A434         ?C0003?COMMANDCLASSVERSION:
  227:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00A434 7F00              MOV      R7,#00H
  228: }
B2:00A436 22                RET      
----- FUNCTION _CC_Version_handler (END) -------


----- FUNCTION _handleCommandClassAssociation (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSASSOCIATION.C'
   54: handleCommandClassAssociation(
   55:     RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00A437 903B24            MOV      DPTR,#rxOpt
B2:00A43A 1225A9            LCALL    ?C?PSTXDATA
   56:     ZW_APPLICATION_TX_BUFFER *pCmd,
   57:     BYTE cmdLength
   58: )
   59: {
   60:   ZW_APPLICATION_TX_BUFFER * pTxBuf;
   61:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
   62:   uint8_t txResult;
   63: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 626


   64:   switch (pCmd->ZW_Common.cmd)
B2:00A43D 903B27            MOV      DPTR,#pCmd
B2:00A440 B1A3              ACALL    ?L?COM001F
B2:00A442 121FF0            LCALL    ?C?CLDOPTR
B2:00A445 14                DEC      A
B2:00A446 6070              JZ       ?C0007?COMMANDCLASSASSOCIATION
B2:00A448 24FD              ADD      A,#0FDH
B2:00A44A 7002              JNZ      $ + 4H
B2:00A44C 81D2              AJMP     ?C0009?COMMANDCLASSASSOCIATION
B2:00A44E 14                DEC      A
B2:00A44F 7002              JNZ      $ + 4H
B2:00A451 81F8              AJMP     ?C0012?COMMANDCLASSASSOCIATION
B2:00A453 24FA              ADD      A,#0FAH
B2:00A455 7002              JNZ      $ + 4H
B2:00A457 A13E              AJMP     ?C0016?COMMANDCLASSASSOCIATION
B2:00A459 2409              ADD      A,#09H
B2:00A45B 6002              JZ       $ + 4H
B2:00A45D A17D              AJMP     ?C0001?COMMANDCLASSASSOCIATION
   65:   {
   66:     case ASSOCIATION_GET_V2:
B2:00A45F         ?C0002?COMMANDCLASSASSOCIATION:
   67:       {
   68:         uint8_t outgoingFrameLength;
   69: 
   70:         if (TRUE == Check_not_legal_response_job(rxOpt))
B2:00A45F 12CB46            LCALL    ?L?COM0176
B2:00A462 5003              JNC      ?C0003?COMMANDCLASSASSOCIATION
   71:         {
   72:           // Get/Report do not support endpoint bit addressing.
   73:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A464 7F02              MOV      R7,#02H
B2:00A466 22                RET      
   74:         }
B2:00A467         ?C0003?COMMANDCLASSASSOCIATION:
   75: 
   76:         pTxBuf = GetResponseBuffer();
B2:00A467 129A8C            LCALL    GetResponseBuffer
B2:00A46A 903B2B            MOV      DPTR,#pTxBuf
B2:00A46D 1225A9            LCALL    ?C?PSTXDATA
   77:         if (IS_NULL(pTxBuf))
B2:00A470 E9                MOV      A,R1
B2:00A471 4A                ORL      A,R2
B2:00A472 7003              JNZ      ?C0005?COMMANDCLASSASSOCIATION
   78:         {
   79:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A474 7F02              MOV      R7,#02H
B2:00A476 22                RET      
   80:         }
B2:00A477         ?C0005?COMMANDCLASSASSOCIATION:
   81: 
   82:         AssociationGet(
   83:             rxOpt->destNode.endpoint,
   84:             (uint8_t *)&pCmd->ZW_AssociationGetFrame.cmdClass,
   85:             (uint8_t *)pTxBuf,
B2:00A477 903B24            MOV      DPTR,#rxOpt
B2:00A47A 12A93A            LCALL    ?L?COM0062
B2:00A47D 903B2B            MOV      DPTR,#pTxBuf
B2:00A480 12DA9F            LCALL    ?L?COM043A
B2:00A483 7A3B              MOV      R2,#HIGH outgoingFrameLength
B2:00A485 7931              MOV      R1,#LOW outgoingFrameLength
B2:00A487 903B18            MOV      DPTR,#?_AssociationGet?BYTE+07H
B2:00A48A 1225A9            LCALL    ?C?PSTXDATA
B2:00A48D 903B27            MOV      DPTR,#pCmd
B2:00A490 122589            LCALL    ?C?PLDXDATA
B2:00A493 129AE3            LCALL    _AssociationGet
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 627


   86:             &outgoingFrameLength);
   87: 
   88:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A496 7B01              MOV      R3,#01H
B2:00A498 7A3B              MOV      R2,#HIGH pTxOptionsEx
B2:00A49A 792E              MOV      R1,#LOW pTxOptionsEx
B2:00A49C 12AB54            LCALL    ?L?COM0106
   89: 
   90:         // Transmit the stuff.
   91:         txResult = Transport_SendResponseEP(
   92:             (BYTE *)pTxBuf,
B2:00A49F 903B31            MOV      DPTR,#outgoingFrameLength
B2:00A4A2 E0                MOVX     A,@DPTR
B2:00A4A3 FD                MOV      R5,A
B2:00A4A4 903B2E            MOV      DPTR,#pTxOptionsEx
B2:00A4A7 3147              ACALL    ?L?COM001D
B2:00A4A9 903B2B            MOV      DPTR,#pTxBuf
;---- Variable 'txResult' assigned to Register 'R7' ----
B2:00A4AC 313A              ACALL    ?L?COM00BC
B2:00A4AE 6005              JZ       ?C0006?COMMANDCLASSASSOCIATION
   93:             outgoingFrameLength,
   94:             pTxOptionsEx,
   95:             ZCB_ResponseJobStatus);
   96:         if (ZW_TX_IN_PROGRESS != txResult)
   97:         {
   98:           FreeResponseBuffer();
B2:00A4B0 11B6              ACALL    FreeResponseBuffer
   99:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A4B2 7F02              MOV      R7,#02H
B2:00A4B4 22                RET      
  100:         }
B2:00A4B5         ?C0006?COMMANDCLASSASSOCIATION:
  101:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A4B5 7FFF              MOV      R7,#0FFH
B2:00A4B7 22                RET      
  102:       }
  103:       break;
  104: 
  105:     case ASSOCIATION_SET_V2:
B2:00A4B8         ?C0007?COMMANDCLASSASSOCIATION:
  106:       if (TRUE != handleAssociationSet(
  107:           rxOpt->destNode.endpoint,
  108:           (ZW_MULTI_CHANNEL_ASSOCIATION_SET_1BYTE_V2_FRAME*)pCmd,
B2:00A4B8 903B24            MOV      DPTR,#rxOpt
B2:00A4BB 12A93A            LCALL    ?L?COM0062
B2:00A4BE FF                MOV      R7,A
B2:00A4BF 903B27            MOV      DPTR,#pCmd
B2:00A4C2 122589            LCALL    ?C?PLDXDATA
B2:00A4C5 903B2A            MOV      DPTR,#cmdLength
B2:00A4C8 12DB22            LCALL    ?L?COM04D3
B2:00A4CB 5002              JNC      $ + 4H
B2:00A4CD A17F              AJMP     ?C0004?COMMANDCLASSASSOCIATION
  109:           cmdLength))
  110:       {
  111:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A4CF 7F02              MOV      R7,#02H
  112:       }
  113:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A4D1 22                RET      
  114:       break;
  115: 
  116:     case ASSOCIATION_REMOVE_V2:
B2:00A4D2         ?C0009?COMMANDCLASSASSOCIATION:
  117:       if (3 > cmdLength)
B2:00A4D2 903B2A            MOV      DPTR,#cmdLength
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 628


B2:00A4D5 E0                MOVX     A,@DPTR
B2:00A4D6 FE                MOV      R6,A
B2:00A4D7 7403              MOV      A,#03H
B2:00A4D9 D3                SETB     C
B2:00A4DA 9E                SUBB     A,R6
B2:00A4DB 4003              JC       ?C0010?COMMANDCLASSASSOCIATION
  118:       {
  119:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A4DD 7F02              MOV      R7,#02H
B2:00A4DF 22                RET      
  120:       }
B2:00A4E0         ?C0010?COMMANDCLASSASSOCIATION:
  121:       if (TRUE != AssociationRemove(
  122:           pCmd->ZW_AssociationRemove1byteV2Frame.groupingIdentifier,
  123:           rxOpt->destNode.endpoint,
  124:           (ZW_MULTI_CHANNEL_ASSOCIATION_REMOVE_1BYTE_V2_FRAME*)pCmd,
B2:00A4E0 903B27            MOV      DPTR,#pCmd
B2:00A4E3 128F3E            LCALL    ?L?COM0029
B2:00A4E6 FF                MOV      R7,A
B2:00A4E7 903B24            MOV      DPTR,#rxOpt
B2:00A4EA 12A93A            LCALL    ?L?COM0062
B2:00A4ED 903B27            MOV      DPTR,#pCmd
B2:00A4F0 12DA29            LCALL    ?L?COM03D3
B2:00A4F3 4002              JC       ?C0011?COMMANDCLASSASSOCIATION
  125:           cmdLength))
  126:       {
  127:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A4F5 7F02              MOV      R7,#02H
  128:       }
B2:00A4F7         ?C0011?COMMANDCLASSASSOCIATION:
  129:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A4F7 22                RET      
  130:       break;
  131: 
  132:     case ASSOCIATION_GROUPINGS_GET_V2:
B2:00A4F8         ?C0012?COMMANDCLASSASSOCIATION:
  133:         ZW_DEBUG_CMD_ASSOCIATION_SEND_STR("ASSOCIATION_GROUPINGS_GET_V2");
  134:         ZW_DEBUG_CMD_ASSOCIATION_SEND_NL();
  135: 
  136:         if(FALSE == Check_not_legal_response_job(rxOpt))
B2:00A4F8 12CB46            LCALL    ?L?COM0176
B2:00A4FB 403E              JC       ?C0013?COMMANDCLASSASSOCIATION
  137:         {
  138:           ZW_APPLICATION_TX_BUFFER *pTxBuf = GetResponseBuffer();
B2:00A4FD 12DADD            LCALL    ?L?COM049A
B2:00A500 6039              JZ       ?C0013?COMMANDCLASSASSOCIATION
  139: 
  140:           /*Check pTxBuf is free*/
  141:           if( NON_NULL( pTxBuf ) )
  142:           {
  143:             TRANSMIT_OPTIONS_TYPE_SINGLE_EX *txOptionsEx;
  144:             RxToTxOptions(rxOpt, &txOptionsEx);
B2:00A502 12AB4E            LCALL    ?L?COM0105
  145:             pTxBuf->ZW_AssociationGroupingsReportV2Frame.cmdClass = COMMAND_CLASS_ASSOCIATION;
B2:00A505 12DA38            LCALL    ?L?COM03DE
B2:00A508 B1A3              ACALL    ?L?COM001F
B2:00A50A 7406              MOV      A,#06H
B2:00A50C 122084            LCALL    ?C?CSTOPTR
  146:             pTxBuf->ZW_AssociationGroupingsReportV2Frame.cmd = ASSOCIATION_GROUPINGS_REPORT_V2;
  147:             pTxBuf->ZW_AssociationGroupingsReportV2Frame.supportedGroupings = handleGetMaxAssociationGroups(rxOpt
>> ->destNode.endpoint);
B2:00A50F 903B24            MOV      DPTR,#rxOpt
B2:00A512 12A93A            LCALL    ?L?COM0062
B2:00A515 FF                MOV      R7,A
B2:00A516 12B5AC            LCALL    _handleGetMaxAssociationGroups
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 629


B2:00A519 903B31            MOV      DPTR,#pTxBuf
B2:00A51C 12B6A3            LCALL    ?L?COM00B3
  148:             if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP( (BYTE *)pTxBuf,
B2:00A51F C003              PUSH     AR3
B2:00A521 C002              PUSH     AR2
B2:00A523 C001              PUSH     AR1
B2:00A525 903B34            MOV      DPTR,#txOptionsEx
B2:00A528 3147              ACALL    ?L?COM001D
B2:00A52A D001              POP      AR1
B2:00A52C D002              POP      AR2
B2:00A52E D003              POP      AR3
B2:00A530 7D03              MOV      R5,#03H
B2:00A532 313D              ACALL    ?L?COM00BD
B2:00A534 6002              JZ       ?C0015?COMMANDCLASSASSOCIATION
  149:                                               sizeof(pTxBuf->ZW_AssociationGroupingsReportV2Frame),
  150:                                               txOptionsEx,
  151:                                               ZCB_ResponseJobStatus))
  152:             {
  153:               /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  154:               FreeResponseBuffer();
B2:00A536 11B6              ACALL    FreeResponseBuffer
  155:             }
B2:00A538         ?C0015?COMMANDCLASSASSOCIATION:
  156:             return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A538 7FFF              MOV      R7,#0FFH
B2:00A53A 22                RET      
  157:           }
  158:         }
B2:00A53B         ?C0013?COMMANDCLASSASSOCIATION:
  159:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A53B 7F02              MOV      R7,#02H
B2:00A53D 22                RET      
  160:         break;
  161:     case ASSOCIATION_SPECIFIC_GROUP_GET_V2:
B2:00A53E         ?C0016?COMMANDCLASSASSOCIATION:
  162:         ZW_DEBUG_CMD_ASSOCIATION_SEND_STR("ASSOCIATION_GROUPINGS_GET_V2");
  163:         ZW_DEBUG_CMD_ASSOCIATION_SEND_NL();
  164: 
  165:         if(FALSE== Check_not_legal_response_job(rxOpt))
B2:00A53E 12CB46            LCALL    ?L?COM0176
B2:00A541 4037              JC       ?C0017?COMMANDCLASSASSOCIATION
  166:         {
  167:           ZW_APPLICATION_TX_BUFFER *pTxBuf = GetResponseBuffer();
B2:00A543 12DADD            LCALL    ?L?COM049A
B2:00A546 6032              JZ       ?C0017?COMMANDCLASSASSOCIATION
  168: 
  169:           /*Check pTxBuf is free*/
  170:           if( NON_NULL( pTxBuf ) )
  171:           {
  172:             TRANSMIT_OPTIONS_TYPE_SINGLE_EX *txOptionsEx;
  173:             RxToTxOptions(rxOpt, &txOptionsEx);
B2:00A548 12AB4E            LCALL    ?L?COM0105
  174:             pTxBuf->ZW_AssociationSpecificGroupReportV2Frame.cmdClass = COMMAND_CLASS_ASSOCIATION;
B2:00A54B 12DA38            LCALL    ?L?COM03DE
B2:00A54E B1A3              ACALL    ?L?COM001F
B2:00A550 740C              MOV      A,#0CH
B2:00A552 122084            LCALL    ?C?CSTOPTR
  175:             pTxBuf->ZW_AssociationSpecificGroupReportV2Frame.cmd = ASSOCIATION_SPECIFIC_GROUP_REPORT_V2;
  176:             pTxBuf->ZW_AssociationSpecificGroupReportV2Frame.group = ApplicationGetLastActiveGroupId();
B2:00A555 12C810            LCALL    ApplicationGetLastActiveGroupId
B2:00A558 903B31            MOV      DPTR,#pTxBuf
B2:00A55B 12B6A3            LCALL    ?L?COM00B3
  177:             if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP( (BYTE *)pTxBuf,
B2:00A55E C003              PUSH     AR3
B2:00A560 C002              PUSH     AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 630


B2:00A562 C001              PUSH     AR1
B2:00A564 903B34            MOV      DPTR,#txOptionsEx
B2:00A567 3147              ACALL    ?L?COM001D
B2:00A569 D001              POP      AR1
B2:00A56B D002              POP      AR2
B2:00A56D D003              POP      AR3
B2:00A56F 7D03              MOV      R5,#03H
B2:00A571 313D              ACALL    ?L?COM00BD
B2:00A573 6002              JZ       ?C0019?COMMANDCLASSASSOCIATION
  178:                                               sizeof(pTxBuf->ZW_AssociationSpecificGroupReportV2Frame),
  179:                                               txOptionsEx,
  180:                                               ZCB_ResponseJobStatus))
  181:             {
  182:               /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  183:               FreeResponseBuffer();
B2:00A575 11B6              ACALL    FreeResponseBuffer
  184:             }
B2:00A577         ?C0019?COMMANDCLASSASSOCIATION:
  185:             return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A577 7FFF              MOV      R7,#0FFH
B2:00A579 22                RET      
  186:           }
  187:         }
B2:00A57A         ?C0017?COMMANDCLASSASSOCIATION:
  188:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A57A 7F02              MOV      R7,#02H
B2:00A57C 22                RET      
  189:         break;
  190:   }
B2:00A57D         ?C0001?COMMANDCLASSASSOCIATION:
  191:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00A57D 7F00              MOV      R7,#00H
  192: }
B2:00A57F         ?C0004?COMMANDCLASSASSOCIATION:
B2:00A57F 22                RET      
----- FUNCTION _handleCommandClassAssociation (END) -------


----- FUNCTION ?L?COM001E (BEGIN) -----
B2:00A580 7B01              MOV      R3,#01H
B2:00A582 7A39              MOV      R2,#HIGH pTxOptionsEx
B2:00A584 79F3              MOV      R1,#LOW pTxOptionsEx
B2:00A586 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00A589 1225A9            LCALL    ?C?PSTXDATA
B2:00A58C 9039E3            MOV      DPTR,#rxOpt
B2:00A58F 122589            LCALL    ?C?PLDXDATA
B2:00A592 12ACFF            LCALL    _RxToTxOptions
B2:00A595 9039F0            MOV      DPTR,#pTxBuf
B2:00A598 122589            LCALL    ?C?PLDXDATA
B2:00A59B 7486              MOV      A,#086H
B2:00A59D 122072            LCALL    ?C?CSTPTR
B2:00A5A0 9039F0            MOV      DPTR,#pTxBuf
B2:00A5A3         ?L?COM001F:
B2:00A5A3 122589            LCALL    ?C?PLDXDATA
B2:00A5A6 900001            MOV      DPTR,#01H
B2:00A5A9 22                RET      
----- FUNCTION ?L?COM001E (END) -------


----- FUNCTION _CC_AGI_handler (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSASSOCIATIONGROUPINFO.C'
  137: CC_AGI_handler(
  138:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00A5AA 903BE2            MOV      DPTR,#rxOpt
B2:00A5AD 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 631


  139:   ZW_APPLICATION_TX_BUFFER *pCmd,
  140:   uint8_t cmdLength)
  141: {
  142:   uint8_t length;
  143:   uint8_t groupID;
  144:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *txOptionsEx;
  145:   uint8_t groupNameLength;
  146:   ZW_APPLICATION_TX_BUFFER *pTxBuf = NULL;
B2:00A5B0 12B299            LCALL    ?L?COM0069
B2:00A5B3 903BEF            MOV      DPTR,#pTxBuf
B2:00A5B6 12D9ED            LCALL    ?L?COM0389
B2:00A5B9 319D              ACALL    ?L?COM01BF
B2:00A5BB 5003              JNC      ?C0010?COMMANDCLASSASSOCIATIONGROUPINFO
  147: 
  148:   UNUSED(cmdLength);
  149: 
  150:   if (TRUE == Check_not_legal_response_job(rxOpt))
  151:   {
  152:     // Get/Report do not support bit addressing.
  153:     return RECEIVED_FRAME_STATUS_FAIL;
B2:00A5BD 7F02              MOV      R7,#02H
B2:00A5BF 22                RET      
  154:   }
B2:00A5C0         ?C0010?COMMANDCLASSASSOCIATIONGROUPINFO:
  155: 
  156:   switch (pCmd->ZW_Common.cmd)
B2:00A5C0 903BE5            MOV      DPTR,#pCmd
B2:00A5C3 B1A3              ACALL    ?L?COM001F
B2:00A5C5 121FF0            LCALL    ?C?CLDOPTR
B2:00A5C8 24FD              ADD      A,#0FDH
B2:00A5CA 7002              JNZ      $ + 4H
B2:00A5CC C14D              AJMP     ?C0017?COMMANDCLASSASSOCIATIONGROUPINFO
B2:00A5CE 24FE              ADD      A,#0FEH
B2:00A5D0 7002              JNZ      $ + 4H
B2:00A5D2 C1AF              AJMP     ?C0024?COMMANDCLASSASSOCIATIONGROUPINFO
B2:00A5D4 2404              ADD      A,#04H
B2:00A5D6 6002              JZ       $ + 4H
B2:00A5D8 E13B              AJMP     ?C0028?COMMANDCLASSASSOCIATIONGROUPINFO
  157:     {
  158:       case ASSOCIATION_GROUP_NAME_GET:
B2:00A5DA         ?C0013?COMMANDCLASSASSOCIATIONGROUPINFO:
  159:         pTxBuf = GetResponseBuffer();
B2:00A5DA 12DAD1            LCALL    ?L?COM0499
B2:00A5DD 7003              JNZ      ?C0014?COMMANDCLASSASSOCIATIONGROUPINFO
  160:         if (IS_NULL(pTxBuf))
  161:         {
  162:           // The buffer is not free :(
  163:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A5DF 7F02              MOV      R7,#02H
B2:00A5E1 22                RET      
  164:         }
B2:00A5E2         ?C0014?COMMANDCLASSASSOCIATIONGROUPINFO:
  165: 
  166:         if (3 != cmdLength)
B2:00A5E2 903BE8            MOV      DPTR,#cmdLength
B2:00A5E5 E0                MOVX     A,@DPTR
B2:00A5E6 6403              XRL      A,#03H
B2:00A5E8 6002              JZ       ?C0015?COMMANDCLASSASSOCIATIONGROUPINFO
  167:         {
  168:           FreeResponseBuffer();
  169:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A5EA E136              AJMP     ?C0031?COMMANDCLASSASSOCIATIONGROUPINFO
  170:         }
B2:00A5EC         ?C0015?COMMANDCLASSASSOCIATIONGROUPINFO:
  171: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 632


  172:         pTxBuf->ZW_AssociationGroupNameReport1byteFrame.cmdClass = COMMAND_CLASS_ASSOCIATION_GRP_INFO;
B2:00A5EC 12CF9A            LCALL    ?L?COM03C2
  173:         pTxBuf->ZW_AssociationGroupNameReport1byteFrame.cmd      = ASSOCIATION_GROUP_NAME_REPORT;
B2:00A5EF 903BEF            MOV      DPTR,#pTxBuf
B2:00A5F2 B1A3              ACALL    ?L?COM001F
B2:00A5F4 7402              MOV      A,#02H
B2:00A5F6 122084            LCALL    ?C?CSTOPTR
  174: 
  175:         groupID = pCmd->ZW_AssociationGroupNameGetFrame.groupingIdentifier;
B2:00A5F9 903BE5            MOV      DPTR,#pCmd
B2:00A5FC 128F3E            LCALL    ?L?COM0029
B2:00A5FF 903BEA            MOV      DPTR,#groupID
B2:00A602 F0                MOVX     @DPTR,A
  176:         pTxBuf->ZW_AssociationGroupNameReport1byteFrame.groupingIdentifier = groupID;
B2:00A603 E0                MOVX     A,@DPTR
B2:00A604 903BEF            MOV      DPTR,#pTxBuf
B2:00A607 12D98F            LCALL    ?L?COM02AF
  177: 
  178:         groupNameLength = CC_AGI_groupNameGet_handler(
  179:             (char *)&(pTxBuf->ZW_AssociationGroupNameReport1byteFrame.name1),
B2:00A60A 125525            LCALL    ?L?COM005A
B2:00A60D C003              PUSH     AR3
B2:00A60F C002              PUSH     AR2
B2:00A611 C001              PUSH     AR1
B2:00A613 903BE2            MOV      DPTR,#rxOpt
B2:00A616 12A93A            LCALL    ?L?COM0062
B2:00A619 903A19            MOV      DPTR,#?_CC_AGI_groupNameGet_handler?BYTE+04H
B2:00A61C F0                MOVX     @DPTR,A
B2:00A61D D001              POP      AR1
B2:00A61F D002              POP      AR2
B2:00A621 D003              POP      AR3
B2:00A623 12C6A8            LCALL    _CC_AGI_groupNameGet_handler
B2:00A626 903BEE            MOV      DPTR,#groupNameLength
B2:00A629 EF                MOV      A,R7
B2:00A62A F0                MOVX     @DPTR,A
  180:             groupID,
  181:             rxOpt->destNode.endpoint);
  182: 
  183:         pTxBuf->ZW_AssociationGroupNameReport1byteFrame.lengthOfName = groupNameLength;
B2:00A62B A3                INC      DPTR
B2:00A62C 12B57F            LCALL    ?L?COM00E6
B2:00A62F EF                MOV      A,R7
B2:00A630 122084            LCALL    ?C?CSTOPTR
  184: 
  185:         RxToTxOptions(rxOpt, &txOptionsEx);
B2:00A633 12D9E4            LCALL    ?L?COM0388
B2:00A636 12AB5D            LCALL    ?L?COM0107
  186:         if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  187:             (uint8_t *)pTxBuf,
B2:00A639 903BEE            MOV      DPTR,#groupNameLength
B2:00A63C 12DBD3            LCALL    ?L?COM05F3
B2:00A63F 3147              ACALL    ?L?COM001D
B2:00A641 903BEF            MOV      DPTR,#pTxBuf
B2:00A644 313A              ACALL    ?L?COM00BC
B2:00A646 6002              JZ       ?C0016?COMMANDCLASSASSOCIATIONGROUPINFO
  188:             sizeof(ZW_ASSOCIATION_GROUP_NAME_REPORT_1BYTE_FRAME) - sizeof(uint8_t) + groupNameLength,
  189:             txOptionsEx,
  190:             ZCB_ResponseJobStatus))
  191:         {
  192:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  193:           FreeResponseBuffer();
B2:00A648 11B6              ACALL    FreeResponseBuffer
  194:         }
B2:00A64A         ?C0016?COMMANDCLASSASSOCIATIONGROUPINFO:
  195:         return RECEIVED_FRAME_STATUS_SUCCESS;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 633


B2:00A64A 7FFF              MOV      R7,#0FFH
B2:00A64C 22                RET      
  196:         break;
  197: 
  198:     case ASSOCIATION_GROUP_INFO_GET:
B2:00A64D         ?C0017?COMMANDCLASSASSOCIATIONGROUPINFO:
  199:       // Ignore command if we are already transmitting.
  200:       if (REPORT_STATUS_INACTIVE != reportStatus)
B2:00A64D 903ED5            MOV      DPTR,#reportStatus
B2:00A650 E0                MOVX     A,@DPTR
B2:00A651 6003              JZ       ?C0018?COMMANDCLASSASSOCIATIONGROUPINFO
  201:       {
  202:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A653 7F02              MOV      R7,#02H
B2:00A655 22                RET      
  203:       }
B2:00A656         ?C0018?COMMANDCLASSASSOCIATIONGROUPINFO:
  204:       if (pCmd->ZW_AssociationGroupInfoGetFrame.properties1 &
B2:00A656 903BE5            MOV      DPTR,#pCmd
B2:00A659 128F3E            LCALL    ?L?COM0029
B2:00A65C 903ED5            MOV      DPTR,#reportStatus
B2:00A65F 30E609            JNB      ACC.6,?C0019?COMMANDCLASSASSOCIATIONGROUPINFO
  205:           ASSOCIATION_GROUP_INFO_GET_PROPERTIES1_LIST_MODE_BIT_MASK)
  206:       {
  207:         /*if list mode is one then ignore groupid and report information about all the asscoication group
  208:          one group at a time*/
  209:          reportStatus = REPORT_STATUS_ALL_GROUPS;
B2:00A662 7402              MOV      A,#02H
B2:00A664 F0                MOVX     @DPTR,A
  210:          currentGroupId = 1;
B2:00A665 903ED7            MOV      DPTR,#currentGroupId
B2:00A668 14                DEC      A
  211:          associationGroupInfoGetEndpoint = rxOpt->destNode.endpoint;
  212:       }
B2:00A669 800C              SJMP     ?C0029?COMMANDCLASSASSOCIATIONGROUPINFO
B2:00A66B         ?C0019?COMMANDCLASSASSOCIATIONGROUPINFO:
  213:       else
  214:       {
  215:         /*if list mode is zero and group id is not then report the association group info for the specific group*
>> /
  216:         reportStatus = REPORT_STATUS_ONE_GROUP;
B2:00A66B 7401              MOV      A,#01H
B2:00A66D F0                MOVX     @DPTR,A
  217:         currentGroupId = pCmd->ZW_AssociationGroupInfoGetFrame.groupingIdentifier;
B2:00A66E 903BE5            MOV      DPTR,#pCmd
B2:00A671 128CA2            LCALL    ?L?COM007F
B2:00A674 903ED7            MOV      DPTR,#currentGroupId
B2:00A677         
B2:00A677 F0                MOVX     @DPTR,A
  218:         associationGroupInfoGetEndpoint = rxOpt->destNode.endpoint;
B2:00A678 903BE2            MOV      DPTR,#rxOpt
B2:00A67B 12A93A            LCALL    ?L?COM0062
B2:00A67E 903ED6            MOV      DPTR,#associationGroupInfoGetEndpoint
B2:00A681 F0                MOVX     @DPTR,A
  219:       }
B2:00A682         ?C0020?COMMANDCLASSASSOCIATIONGROUPINFO:
  220: 
  221:       if (REPORT_STATUS_INACTIVE != reportStatus)
B2:00A682 903ED5            MOV      DPTR,#reportStatus
B2:00A685 E0                MOVX     A,@DPTR
B2:00A686 6024              JZ       ?C0021?COMMANDCLASSASSOCIATIONGROUPINFO
  222:       {
  223:         memcpy((uint8_t*)&rxOptions, (uint8_t*)rxOpt, sizeof(RECEIVE_OPTIONS_TYPE_EX));
B2:00A688 903BE2            MOV      DPTR,#rxOpt
B2:00A68B 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 634


B2:00A68E 12C4EF            LCALL    ?L?COM0022
B2:00A691 7B01              MOV      R3,#01H
B2:00A693 7A3E              MOV      R2,#HIGH rxOptions
B2:00A695 79D8              MOV      R1,#LOW rxOptions
B2:00A697 7F06              MOV      R7,#06H
B2:00A699 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  224:         if (TRUE != SendAssoGroupInfoReport())
B2:00A69C 12CF0D            LCALL    SendAssoGroupInfoReport
B2:00A69F 4008              JC       ?C0022?COMMANDCLASSASSOCIATIONGROUPINFO
  225:         {
  226:           reportStatus = REPORT_STATUS_INACTIVE;
B2:00A6A1 E4                CLR      A
B2:00A6A2 903ED5            MOV      DPTR,#reportStatus
B2:00A6A5 F0                MOVX     @DPTR,A
  227:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A6A6 7F02              MOV      R7,#02H
B2:00A6A8 22                RET      
  228:         }
B2:00A6A9         ?C0022?COMMANDCLASSASSOCIATIONGROUPINFO:
  229:         else
  230:         {
  231:           return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A6A9 7FFF              MOV      R7,#0FFH
B2:00A6AB 22                RET      
  232:         }
  233:       }
B2:00A6AC         ?C0021?COMMANDCLASSASSOCIATIONGROUPINFO:
  234:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00A6AC 7F02              MOV      R7,#02H
B2:00A6AE 22                RET      
  235:       break;
  236:     case ASSOCIATION_GROUP_COMMAND_LIST_GET:
B2:00A6AF         ?C0024?COMMANDCLASSASSOCIATIONGROUPINFO:
  237:       pTxBuf = GetResponseBuffer();
B2:00A6AF 12DAD1            LCALL    ?L?COM0499
B2:00A6B2 7003              JNZ      ?C0025?COMMANDCLASSASSOCIATIONGROUPINFO
  238:       if (IS_NULL(pTxBuf))
  239:       {
  240:         // The buffer is not free :(
  241:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A6B4 7F02              MOV      R7,#02H
B2:00A6B6 22                RET      
  242:       }
B2:00A6B7         ?C0025?COMMANDCLASSASSOCIATIONGROUPINFO:
  243: 
  244:       groupID = pCmd->ZW_AssociationGroupCommandListGetFrame.groupingIdentifier;
B2:00A6B7 903BE5            MOV      DPTR,#pCmd
B2:00A6BA 128CA2            LCALL    ?L?COM007F
B2:00A6BD 903BEA            MOV      DPTR,#groupID
B2:00A6C0 F0                MOVX     @DPTR,A
  245: 
  246:       ZAF_CC_AGI_CorrectGroupIdIfInvalid(rxOpt->destNode.endpoint, &groupID);
B2:00A6C1 903BE2            MOV      DPTR,#rxOpt
B2:00A6C4 12A93A            LCALL    ?L?COM0062
B2:00A6C7 FF                MOV      R7,A
B2:00A6C8 7B01              MOV      R3,#01H
B2:00A6CA 7A3B              MOV      R2,#HIGH groupID
B2:00A6CC 79EA              MOV      R1,#LOW groupID
B2:00A6CE 12C8BE            LCALL    _ZAF_CC_AGI_CorrectGroupIdIfInvalid
  247: 
  248:       length = GetApplGroupCommandListSize(groupID, rxOpt->destNode.endpoint);
B2:00A6D1 903BEA            MOV      DPTR,#groupID
B2:00A6D4 E0                MOVX     A,@DPTR
B2:00A6D5 FF                MOV      R7,A
B2:00A6D6 903BE2            MOV      DPTR,#rxOpt
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 635


B2:00A6D9 12A93A            LCALL    ?L?COM0062
B2:00A6DC FD                MOV      R5,A
B2:00A6DD 12C7F5            LCALL    _GetApplGroupCommandListSize
B2:00A6E0 903BE9            MOV      DPTR,#length
B2:00A6E3 EF                MOV      A,R7
B2:00A6E4 F0                MOVX     @DPTR,A
  249:       if (0 == length)
B2:00A6E5 7002              JNZ      ?C0026?COMMANDCLASSASSOCIATIONGROUPINFO
  250:       {
  251:         FreeResponseBuffer();
B2:00A6E7         
  252:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A6E7 804D              SJMP     ?C0031?COMMANDCLASSASSOCIATIONGROUPINFO
  253:       }
B2:00A6E9         ?C0026?COMMANDCLASSASSOCIATIONGROUPINFO:
  254: 
  255:       RxToTxOptions(rxOpt, &txOptionsEx);
B2:00A6E9 12D9E4            LCALL    ?L?COM0388
B2:00A6EC 12AB5D            LCALL    ?L?COM0107
  256:       pTxBuf->ZW_AssociationGroupCommandListReport1byteFrame.cmdClass = COMMAND_CLASS_ASSOCIATION_GRP_INFO;
B2:00A6EF 12CF9A            LCALL    ?L?COM03C2
  257:       pTxBuf->ZW_AssociationGroupCommandListReport1byteFrame.cmd      = ASSOCIATION_GROUP_COMMAND_LIST_REPORT;
B2:00A6F2 903BEF            MOV      DPTR,#pTxBuf
B2:00A6F5 B1A3              ACALL    ?L?COM001F
B2:00A6F7 7406              MOV      A,#06H
B2:00A6F9 122084            LCALL    ?C?CSTOPTR
  258:       pTxBuf->ZW_AssociationGroupCommandListReport1byteFrame.groupingIdentifier = groupID;
B2:00A6FC 903BEA            MOV      DPTR,#groupID
B2:00A6FF E0                MOVX     A,@DPTR
B2:00A700 FD                MOV      R5,A
B2:00A701 12CFD2            LCALL    ?L?COM0369
  259:       pTxBuf->ZW_AssociationGroupCommandListReport1byteFrame.listLength = length;
B2:00A704 903BE9            MOV      DPTR,#length
B2:00A707 E0                MOVX     A,@DPTR
B2:00A708 12716F            LCALL    ?L?COM0313
  260:       GetApplGroupCommandList(&pTxBuf->ZW_AssociationGroupCommandListReport1byteFrame.command1, groupID, rxOpt->d
>> estNode.endpoint);
B2:00A70B 125525            LCALL    ?L?COM005A
B2:00A70E C003              PUSH     AR3
B2:00A710 C002              PUSH     AR2
B2:00A712 C001              PUSH     AR1
B2:00A714 903BE2            MOV      DPTR,#rxOpt
B2:00A717 12A93A            LCALL    ?L?COM0062
B2:00A71A 9041D5            MOV      DPTR,#?_GetApplGroupCommandList?BYTE+04H
B2:00A71D F0                MOVX     @DPTR,A
B2:00A71E D001              POP      AR1
B2:00A720 D002              POP      AR2
B2:00A722 D003              POP      AR3
B2:00A724 12C64F            LCALL    _GetApplGroupCommandList
  261: 
  262:       if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP( (uint8_t *)pTxBuf,
B2:00A727 903BE9            MOV      DPTR,#length
B2:00A72A 12DBD3            LCALL    ?L?COM05F3
B2:00A72D 3147              ACALL    ?L?COM001D
B2:00A72F 903BEF            MOV      DPTR,#pTxBuf
B2:00A732 313A              ACALL    ?L?COM00BC
B2:00A734 6008              JZ       ?C0012?COMMANDCLASSASSOCIATIONGROUPINFO
  263:                   sizeof(ZW_ASSOCIATION_GROUP_COMMAND_LIST_REPORT_1BYTE_FRAME)
  264:                   - sizeof(uint8_t)
  265:                   + length,
  266:                   txOptionsEx,
  267:                   ZCB_ResponseJobStatus))
  268:       {
  269:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  270:         FreeResponseBuffer();
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 636


B2:00A736         
B2:00A736 11B6              ACALL    FreeResponseBuffer
  271:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A738 7F02              MOV      R7,#02H
B2:00A73A 22                RET      
  272:       }
  273:       break;
  274:     default:
B2:00A73B         ?C0028?COMMANDCLASSASSOCIATIONGROUPINFO:
  275:       return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00A73B 7F00              MOV      R7,#00H
B2:00A73D 22                RET      
  276:       break;
  277:   }
B2:00A73E         ?C0012?COMMANDCLASSASSOCIATIONGROUPINFO:
  278:   return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A73E 7FFF              MOV      R7,#0FFH
  279: }
B2:00A740 22                RET      
----- FUNCTION _CC_AGI_handler (END) -------


----- FUNCTION _Transport_SendResponseEP (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  324: Transport_SendResponseEP(
  325:   BYTE *pData,
B2:00A741 903F0B            MOV      DPTR,#pData
B2:00A744 1225A9            LCALL    ?C?PSTXDATA
B2:00A747 903F0E            MOV      DPTR,#dataLength
B2:00A74A ED                MOV      A,R5
B2:00A74B F0                MOVX     @DPTR,A
  326:   BYTE  dataLength,
  327:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx,
  328:   VOID_CALLBACKFUNC(pCallback)(BYTE bStatus))
  329: {
  330:   static TRANSMIT_OPTIONS_TYPE sTxOptions;
  331: 
  332:   pCallbackResponse = pCallback;
B2:00A74C 903F12            MOV      DPTR,#pCallback
B2:00A74F E0                MOVX     A,@DPTR
B2:00A750 FF                MOV      R7,A
B2:00A751 A3                INC      DPTR
B2:00A752 E0                MOVX     A,@DPTR
B2:00A753 903609            MOV      DPTR,#_pCallbackResponse
B2:00A756 CF                XCH      A,R7
B2:00A757 F0                MOVX     @DPTR,A
B2:00A758 A3                INC      DPTR
B2:00A759 EF                MOV      A,R7
B2:00A75A F0                MOVX     @DPTR,A
  333: 
  334:   if (IS_NULL(pTxOptionsEx))
B2:00A75B 903F0F            MOV      DPTR,#pTxOptionsEx
B2:00A75E 122589            LCALL    ?C?PLDXDATA
B2:00A761 E9                MOV      A,R1
B2:00A762 4A                ORL      A,R2
B2:00A763 7002              JNZ      ?C0035?ZW_TRANSPORTENDPOINT
  335:   {
  336:     return ZW_TX_FAILED;
B2:00A765 FF                MOV      R7,A
B2:00A766 22                RET      
  337:   }
B2:00A767         ?C0035?ZW_TRANSPORTENDPOINT:
  338: 
  339:   /**
  340:    *  Build transmit options
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 637


  341:    */
  342:   sTxOptions.destNode = pTxOptionsEx->pDestNode->node.nodeId;
B2:00A767 903F0F            MOV      DPTR,#pTxOptionsEx
B2:00A76A 12B57F            LCALL    ?L?COM00E6
B2:00A76D 12262D            LCALL    ?C?PLDOPTR
B2:00A770 121FB3            LCALL    ?C?CLDPTR
B2:00A773 9035E4            MOV      DPTR,#sTxOptions
B2:00A776 F0                MOVX     @DPTR,A
  343:   sTxOptions.txOptions = pTxOptionsEx->txOptions;
B2:00A777 903F0F            MOV      DPTR,#pTxOptionsEx
B2:00A77A 12AE26            LCALL    ?L?COM0049
B2:00A77D 9035E6            MOV      DPTR,#sTxOptions+02H
B2:00A780 F0                MOVX     @DPTR,A
  344:   sTxOptions.txSecOptions = pTxOptionsEx->txSecOptions;
B2:00A781 12B3A2            LCALL    ?L?COM0182
B2:00A784 9035E7            MOV      DPTR,#sTxOptions+03H
B2:00A787 12B437            LCALL    ?L?COM0254
B2:00A78A 128CA5            LCALL    ?L?COM0080
B2:00A78D 9035E8            MOV      DPTR,#sTxOptions+04H
B2:00A790 F0                MOVX     @DPTR,A
  345:   sTxOptions.securityKey = pTxOptionsEx->pDestNode->nodeInfo.security;
  346: 
  347:   CmdClassMultiChannelEncapsulate(&pData,
B2:00A791 7A3F              MOV      R2,#HIGH dataLength
B2:00A793 790E              MOV      R1,#LOW dataLength
B2:00A795 12B58D            LCALL    ?L?COM0590
B2:00A798 903F0F            MOV      DPTR,#pTxOptionsEx
B2:00A79B 12DAC5            LCALL    ?L?COM0492
B2:00A79E 7A3F              MOV      R2,#HIGH pData
B2:00A7A0 790B              MOV      R1,#LOW pData
B2:00A7A2 12B472            LCALL    _CmdClassMultiChannelEncapsulate
  348:                                   &dataLength,
  349:                                   pTxOptionsEx);
  350: 
  351:   return ZW_SendDataEx(pData,
B2:00A7A5 903F0E            MOV      DPTR,#dataLength
B2:00A7A8 E0                MOVX     A,@DPTR
B2:00A7A9 FD                MOV      R5,A
B2:00A7AA 7B01              MOV      R3,#01H
B2:00A7AC 7A35              MOV      R2,#HIGH sTxOptions
B2:00A7AE 79E4              MOV      R1,#LOW sTxOptions
B2:00A7B0 12704B            LCALL    ?L?COM00AE
B2:00A7B3 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B2:00A7B6 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ResponseCompleted
B2:00A7B8 F0                MOVX     @DPTR,A
B2:00A7B9 A3                INC      DPTR
B2:00A7BA 74A3              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ResponseCompleted
B2:00A7BC F0                MOVX     @DPTR,A
B2:00A7BD 903F0B            MOV      DPTR,#pData
B2:00A7C0 122589            LCALL    ?C?PLDXDATA
B2:00A7C3 021980            LJMP     ?INTERBANK_TABLE?_ZW_SendDataEx
  352:                        dataLength,
  353:                        &sTxOptions,
  354:                        ZCB_ResponseCompleted);
----- FUNCTION _Transport_SendResponseEP (END) -------


----- FUNCTION _handleCommandClassMultiChannelAssociation (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMULTICHANASSOCIATION.C'
   44: handleCommandClassMultiChannelAssociation(
   45:     RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00A7C6 903C75            MOV      DPTR,#rxOpt
B2:00A7C9 1225A9            LCALL    ?C?PSTXDATA
   46:     ZW_APPLICATION_TX_BUFFER *pCmd,
   47:     BYTE cmdLength)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 638


   48: {
   49:   ZW_APPLICATION_TX_BUFFER * pTxBuf;
   50:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
   51:   uint8_t txResult;
   52: 
   53:   switch (pCmd->ZW_Common.cmd)
B2:00A7CC 903C78            MOV      DPTR,#pCmd
B2:00A7CF B1A3              ACALL    ?L?COM001F
B2:00A7D1 121FF0            LCALL    ?C?CLDOPTR
B2:00A7D4 14                DEC      A
B2:00A7D5 6062              JZ       ?C0007?COMMANDCLASSMULTICHANASSOCIATION
B2:00A7D7 24FD              ADD      A,#0FDH
B2:00A7D9 6073              JZ       ?C0009?COMMANDCLASSMULTICHANASSOCIATION
B2:00A7DB 14                DEC      A
B2:00A7DC 7003              JNZ      $ + 5H
B2:00A7DE 02A872            LJMP     ?C0012?COMMANDCLASSMULTICHANASSOCIATION
B2:00A7E1 2403              ADD      A,#03H
B2:00A7E3 6003              JZ       $ + 5H
B2:00A7E5 02A8D4            LJMP     ?C0001?COMMANDCLASSMULTICHANASSOCIATION
   54:   {
   55:     case MULTI_CHANNEL_ASSOCIATION_GET_V2:
B2:00A7E8         ?C0002?COMMANDCLASSMULTICHANASSOCIATION:
   56:       {
   57:         uint8_t outgoingFrameLength;
   58: 
   59:         if (TRUE == Check_not_legal_response_job(rxOpt))
B2:00A7E8 903C75            MOV      DPTR,#rxOpt
B2:00A7EB 319D              ACALL    ?L?COM01BF
B2:00A7ED 5003              JNC      ?C0003?COMMANDCLASSMULTICHANASSOCIATION
   60:         {
   61:           /*Do not support endpoint bit-addressing */
   62:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A7EF 7F02              MOV      R7,#02H
B2:00A7F1 22                RET      
   63:         }
B2:00A7F2         ?C0003?COMMANDCLASSMULTICHANASSOCIATION:
   64: 
   65:         pTxBuf = GetResponseBuffer();
B2:00A7F2 12DAB9            LCALL    ?L?COM0490
B2:00A7F5 7003              JNZ      ?C0005?COMMANDCLASSMULTICHANASSOCIATION
   66:         if (IS_NULL(pTxBuf))
   67:         {
   68:           return RECEIVED_FRAME_STATUS_FAIL;
B2:00A7F7 7F02              MOV      R7,#02H
B2:00A7F9 22                RET      
   69:         }
B2:00A7FA         ?C0005?COMMANDCLASSMULTICHANASSOCIATION:
   70: 
   71:         AssociationGet(
   72:             rxOpt->destNode.endpoint,
   73:             (uint8_t *)&pCmd->ZW_MultiChannelAssociationGetV3Frame.cmdClass,
   74:             (uint8_t *)pTxBuf,
B2:00A7FA 903C75            MOV      DPTR,#rxOpt
B2:00A7FD 12A93A            LCALL    ?L?COM0062
B2:00A800 903C7C            MOV      DPTR,#pTxBuf
B2:00A803 12DA9F            LCALL    ?L?COM043A
B2:00A806 7A3C              MOV      R2,#HIGH outgoingFrameLength
B2:00A808 7982              MOV      R1,#LOW outgoingFrameLength
B2:00A80A 903B18            MOV      DPTR,#?_AssociationGet?BYTE+07H
B2:00A80D 1225A9            LCALL    ?C?PSTXDATA
B2:00A810 3146              ACALL    ?L?COM0500
B2:00A812 129AE3            LCALL    _AssociationGet
   75:             &outgoingFrameLength);
   76: 
   77:         RxToTxOptions(rxOpt, &pTxOptionsEx);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 639


B2:00A815 12DB49            LCALL    ?L?COM0526
B2:00A818 1225A9            LCALL    ?C?PSTXDATA
B2:00A81B 903C75            MOV      DPTR,#rxOpt
B2:00A81E 715D              ACALL    ?L?COM0107
   78: 
   79:         // Transmit the stuff.
   80:         txResult = Transport_SendResponseEP(
   81:             (BYTE *)pTxBuf,
B2:00A820 903C82            MOV      DPTR,#outgoingFrameLength
B2:00A823 E0                MOVX     A,@DPTR
B2:00A824 FD                MOV      R5,A
B2:00A825 903C7F            MOV      DPTR,#pTxOptionsEx
B2:00A828 12A147            LCALL    ?L?COM001D
B2:00A82B 903C7C            MOV      DPTR,#pTxBuf
;---- Variable 'txResult' assigned to Register 'R7' ----
B2:00A82E 12A13A            LCALL    ?L?COM00BC
B2:00A831 6003              JZ       ?C0006?COMMANDCLASSMULTICHANASSOCIATION
   82:             outgoingFrameLength,
   83:             pTxOptionsEx,
   84:             ZCB_ResponseJobStatus);
   85:         if (ZW_TX_IN_PROGRESS != txResult)
   86:         {
   87:           FreeResponseBuffer();
B2:00A833 12A0B6            LCALL    FreeResponseBuffer
   88:         }
B2:00A836         ?C0006?COMMANDCLASSMULTICHANASSOCIATION:
   89:       }
   90:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A836 7FFF              MOV      R7,#0FFH
B2:00A838 22                RET      
   91:       break;
   92: 
   93:     case MULTI_CHANNEL_ASSOCIATION_SET_V2:
B2:00A839         ?C0007?COMMANDCLASSMULTICHANASSOCIATION:
   94:       if (TRUE != handleAssociationSet(
   95:           rxOpt->destNode.endpoint,
   96:           (ZW_MULTI_CHANNEL_ASSOCIATION_SET_1BYTE_V2_FRAME*)pCmd,
B2:00A839 903C75            MOV      DPTR,#rxOpt
B2:00A83C 313A              ACALL    ?L?COM0062
B2:00A83E FF                MOV      R7,A
B2:00A83F 3146              ACALL    ?L?COM0500
B2:00A841 903C7B            MOV      DPTR,#cmdLength
B2:00A844 12DB22            LCALL    ?L?COM04D3
B2:00A847 5002              JNC      $ + 4H
B2:00A849 01D6              AJMP     ?C0004?COMMANDCLASSMULTICHANASSOCIATION
   97:           cmdLength))
   98:       {
   99:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A84B 7F02              MOV      R7,#02H
  100:       }
  101:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A84D 22                RET      
  102:       break;
  103: 
  104:     case MULTI_CHANNEL_ASSOCIATION_REMOVE_V2:
B2:00A84E         ?C0009?COMMANDCLASSMULTICHANASSOCIATION:
  105:       if (2 == cmdLength)
B2:00A84E 903C7B            MOV      DPTR,#cmdLength
B2:00A851 E0                MOVX     A,@DPTR
B2:00A852 FE                MOV      R6,A
B2:00A853 B40205            CJNE     A,#02H,?C0010?COMMANDCLASSMULTICHANASSOCIATION
  106:       {
  107:         /*
  108:          * According to the CC Multi Channel spec, the remove command MAY be interpreted with only
  109:          * command class and command resulting in a command length of 2 bytes. This is interpreted as if
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 640


  110:          * the command was [Class, Command, GroupID=0] which will remove all nodes in all groups.
  111:          * Hence, set group ID to zero.
  112:          */
  113:         pCmd->ZW_MultiChannelAssociationRemove1byteV2Frame.groupingIdentifier = 0;
B2:00A856 3146              ACALL    ?L?COM0500
B2:00A858 12C9B3            LCALL    ?L?COM025B
  114:       }
B2:00A85B         ?C0010?COMMANDCLASSMULTICHANASSOCIATION:
  115:       if (TRUE != AssociationRemove(
  116:           pCmd->ZW_MultiChannelAssociationRemove1byteV2Frame.groupingIdentifier,
  117:           rxOpt->destNode.endpoint,
  118:           (ZW_MULTI_CHANNEL_ASSOCIATION_REMOVE_1BYTE_V2_FRAME*)pCmd,
B2:00A85B 903C78            MOV      DPTR,#pCmd
B2:00A85E 128F3E            LCALL    ?L?COM0029
B2:00A861 FF                MOV      R7,A
B2:00A862 903C75            MOV      DPTR,#rxOpt
B2:00A865 313A              ACALL    ?L?COM0062
B2:00A867 903C78            MOV      DPTR,#pCmd
B2:00A86A 12DA29            LCALL    ?L?COM03D3
B2:00A86D 4002              JC       ?C0011?COMMANDCLASSMULTICHANASSOCIATION
  119:           cmdLength))
  120:       {
  121:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A86F 7F02              MOV      R7,#02H
  122:       }
B2:00A871         ?C0011?COMMANDCLASSMULTICHANASSOCIATION:
  123:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A871 22                RET      
  124:       break;
  125: 
  126:     case MULTI_CHANNEL_ASSOCIATION_GROUPINGS_GET_V2:
B2:00A872         ?C0012?COMMANDCLASSMULTICHANASSOCIATION:
  127:       if (TRUE == Check_not_legal_response_job(rxOpt))
B2:00A872 903C75            MOV      DPTR,#rxOpt
B2:00A875 12A19D            LCALL    ?L?COM01BF
B2:00A878 5003              JNC      ?C0013?COMMANDCLASSMULTICHANASSOCIATION
  128:       {
  129:         /*Do not support endpoint bit-addressing */
  130:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00A87A 7F02              MOV      R7,#02H
B2:00A87C 22                RET      
  131:       }
B2:00A87D         ?C0013?COMMANDCLASSMULTICHANASSOCIATION:
  132:       pTxBuf = GetResponseBuffer();
B2:00A87D 12DAB9            LCALL    ?L?COM0490
B2:00A880 604F              JZ       ?C0014?COMMANDCLASSMULTICHANASSOCIATION
  133:       /*Check pTxBuf is free*/
  134:       if( NON_NULL( pTxBuf ) )
  135:       {
  136:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00A882 12DB49            LCALL    ?L?COM0526
B2:00A885 1225A9            LCALL    ?C?PSTXDATA
B2:00A888 903C75            MOV      DPTR,#rxOpt
B2:00A88B 715D              ACALL    ?L?COM0107
  137:         pTxBuf->ZW_MultiChannelAssociationGroupingsReportV2Frame.cmdClass = COMMAND_CLASS_MULTI_CHANNEL_ASSOCIATI
>> ON_V2;
B2:00A88D 903C7C            MOV      DPTR,#pTxBuf
B2:00A890 122589            LCALL    ?C?PLDXDATA
B2:00A893 748E              MOV      A,#08EH
B2:00A895 122072            LCALL    ?C?CSTPTR
  138:         pTxBuf->ZW_MultiChannelAssociationGroupingsReportV2Frame.cmd = MULTI_CHANNEL_ASSOCIATION_GROUPINGS_REPORT
>> _V2;
B2:00A898 903C7C            MOV      DPTR,#pTxBuf
B2:00A89B 12A5A3            LCALL    ?L?COM001F
B2:00A89E 7406              MOV      A,#06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 641


B2:00A8A0 122084            LCALL    ?C?CSTOPTR
  139:         pTxBuf->ZW_MultiChannelAssociationGroupingsReportV2Frame.supportedGroupings = handleGetMaxAssociationGrou
>> ps(rxOpt->destNode.endpoint);
B2:00A8A3 903C75            MOV      DPTR,#rxOpt
B2:00A8A6 313A              ACALL    ?L?COM0062
B2:00A8A8 FF                MOV      R7,A
B2:00A8A9 12B5AC            LCALL    _handleGetMaxAssociationGroups
B2:00A8AC 903C7C            MOV      DPTR,#pTxBuf
B2:00A8AF 12B6A3            LCALL    ?L?COM00B3
  140:         if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP( (BYTE *)pTxBuf,
B2:00A8B2 C003              PUSH     AR3
B2:00A8B4 C002              PUSH     AR2
B2:00A8B6 C001              PUSH     AR1
B2:00A8B8 903C7F            MOV      DPTR,#pTxOptionsEx
B2:00A8BB 12A147            LCALL    ?L?COM001D
B2:00A8BE D001              POP      AR1
B2:00A8C0 D002              POP      AR2
B2:00A8C2 D003              POP      AR3
B2:00A8C4 7D03              MOV      R5,#03H
B2:00A8C6 12A13D            LCALL    ?L?COM00BD
B2:00A8C9 6003              JZ       ?C0015?COMMANDCLASSMULTICHANASSOCIATION
  141:                                       sizeof(pTxBuf->ZW_MultiChannelAssociationGroupingsReportV2Frame),
  142:                                       pTxOptionsEx,
  143:                                       ZCB_ResponseJobStatus))
  144:         {
  145:           /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  146:           FreeResponseBuffer();
B2:00A8CB 12A0B6            LCALL    FreeResponseBuffer
  147:         }
B2:00A8CE         ?C0015?COMMANDCLASSMULTICHANASSOCIATION:
  148:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00A8CE 7FFF              MOV      R7,#0FFH
B2:00A8D0 22                RET      
  149:       }
B2:00A8D1         ?C0014?COMMANDCLASSMULTICHANASSOCIATION:
  150:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00A8D1 7F02              MOV      R7,#02H
B2:00A8D3 22                RET      
  151:       break;
  152:   }
B2:00A8D4         ?C0001?COMMANDCLASSMULTICHANASSOCIATION:
  153:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00A8D4 7F00              MOV      R7,#00H
  154: }
B2:00A8D6         ?C0004?COMMANDCLASSMULTICHANASSOCIATION:
B2:00A8D6 22                RET      
----- FUNCTION _handleCommandClassMultiChannelAssociation (END) -------


----- FUNCTION _ApplicationInitSW (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  309: ApplicationInitSW(ZW_NVM_STATUS nvmStatus)
  310: {
;---- Variable 'nvmStatus' assigned to Register 'R7' ----
  311:   BYTE application_node_type = DEVICE_OPTIONS_MASK;
  312: 
B2:00A8D7 90439E            MOV      DPTR,#application_node_type
B2:00A8DA 7403              MOV      A,#03H
B2:00A8DC F0                MOVX     @DPTR,A
  313:   /* Init state machine*/
  314:   currentState = STATE_APP_STARTUP;
B2:00A8DD E4                CLR      A
B2:00A8DE 903814            MOV      DPTR,#currentState
B2:00A8E1 F0                MOVX     @DPTR,A
  315:   /* Do not reinitialize the UART if already initialized for ISD51 in ApplicationInitHW() */
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 642


  316: #ifndef ZW_ISD51_DEBUG
  317:   ZW_DEBUG_INIT(1152);
  318: #endif
  319: 
  320:   ZW_DEBUG_MYPRODUCT_SEND_STR("\r\nAppInitSW ");
  321:   ZW_DEBUG_MYPRODUCT_SEND_NUM(wakeupReason);
  322:   ZW_DEBUG_MYPRODUCT_SEND_NUM(nvmStatus);
  323:   ZW_DEBUG_MYPRODUCT_SEND_NL();
  324: 
  325: #ifdef WATCHDOG_ENABLED
  326:   ZW_WatchDogEnable();
  327: #endif
  328: 
  329:   /* Signal that the sensor is awake */
  330:   LoadConfiguration(nvmStatus);
B2:00A8E2 1294D2            LCALL    _LoadConfiguration
  331: 
  332:   /* Setup AGI group lists*/
  333:   AGI_Init();
B2:00A8E5 12C59F            LCALL    CC_AGI_Init
  334:   AGI_LifeLineGroupSetup(agiTableLifeLine, (sizeof(agiTableLifeLine)/sizeof(CMD_CLASS_GRP)), GroupName, ENDPOINT_
>> ROOT);
B2:00A8E8 7B01              MOV      R3,#01H
B2:00A8EA 7A38              MOV      R2,#HIGH agiTableLifeLine
B2:00A8EC 791E              MOV      R1,#LOW agiTableLifeLine
B2:00A8EE E4                CLR      A
B2:00A8EF 9041C6            MOV      DPTR,#?_CC_AGI_LifeLineGroupSetup?BYTE+04H
B2:00A8F2 F0                MOVX     @DPTR,A
B2:00A8F3 7D01              MOV      R5,#01H
B2:00A8F5 12C5FD            LCALL    _CC_AGI_LifeLineGroupSetup
  335: 
  336: #ifdef BOOTLOADER_ENABLED
  337:   /* Initialize OTA module */
  338:     OtaInit( ZCB_OTAStart, NULL, ZCB_OTAFinish);
B2:00A8F8 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_OTAStart
B2:00A8FA 7F08              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_OTAStart
B2:00A8FC 7A1E              MOV      R2,#HIGH ?INTERBANK_TABLE?_ZCB_OTAFinish
B2:00A8FE 7B03              MOV      R3,#LOW ?INTERBANK_TABLE?_ZCB_OTAFinish
B2:00A900 E4                CLR      A
B2:00A901 FD                MOV      R5,A
B2:00A902 FC                MOV      R4,A
B2:00A903 12D0E4            LCALL    _OtaInit
  339: #endif
  340: 
  341:   CC_Version_SetApplicationVersionInfo(APP_VERSION, APP_REVISION, APP_VERSION_PATCH, APP_BUILD_NUMBER);
B2:00A906 9041DE            MOV      DPTR,#?_CC_Version_SetApplicationVersionInfo?BYTE+03H
B2:00A909 74CC              MOV      A,#0CCH
B2:00A90B F0                MOVX     @DPTR,A
B2:00A90C A3                INC      DPTR
B2:00A90D 74DD              MOV      A,#0DDH
B2:00A90F F0                MOVX     @DPTR,A
B2:00A910 E4                CLR      A
B2:00A911 FB                MOV      R3,A
B2:00A912 7D05              MOV      R5,#05H
B2:00A914 7F04              MOV      R7,#04H
B2:00A916 12CD90            LCALL    _CC_Version_SetApplicationVersionInfo
  342: 
  343:  /*
  344:    * Initialize Event Scheduler.
  345:    */
  346:   ZAF_eventSchedulerInit(AppStateManager);
B2:00A919 7EAB              MOV      R6,#HIGH _AppStateManager
B2:00A91B 7F62              MOV      R7,#LOW _AppStateManager
B2:00A91D 12C96F            LCALL    _ZAF_eventSchedulerInit
  347: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 643


  348:   Transport_OnApplicationInitSW( &m_AppNIF);
B2:00A920 7B01              MOV      R3,#01H
B2:00A922 7A38              MOV      R2,#HIGH m_AppNIF
B2:00A924 7920              MOV      R1,#LOW m_AppNIF
B2:00A926 12CD30            LCALL    _Transport_OnApplicationInitSW
  349:   ZCB_eventSchedulerEventAdd(EVENT_APP_INIT);
B2:00A929 7F71              MOV      R7,#071H
B2:00A92B 319B              ACALL    _ZCB_eventSchedulerEventAdd
  350: 
  351:   return(application_node_type);
B2:00A92D 90439E            MOV      DPTR,#application_node_type
B2:00A930 E0                MOVX     A,@DPTR
B2:00A931 FF                MOV      R7,A
  352: }
B2:00A932 22                RET      
----- FUNCTION _ApplicationInitSW (END) -------


----- FUNCTION ?L?COM005F (BEGIN) -----
B2:00A933 EF                MOV      A,R7
B2:00A934         ?L?COM0060:
B2:00A934 122084            LCALL    ?C?CSTOPTR
B2:00A937         ?L?COM0061:
B2:00A937 903C59            MOV      DPTR,#rxOpt
B2:00A93A         ?L?COM0062:
B2:00A93A 122589            LCALL    ?C?PLDXDATA
B2:00A93D 900005            MOV      DPTR,#05H
B2:00A940 121FF0            LCALL    ?C?CLDOPTR
B2:00A943 547F              ANL      A,#07FH
B2:00A945 22                RET      
----- FUNCTION ?L?COM005F (END) -------


----- FUNCTION ?L?COM0500 (BEGIN) -----
B2:00A946 903C78            MOV      DPTR,#pCmd
B2:00A949 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0500 (END) -------


----- FUNCTION ApplicationTestPoll (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  359: ApplicationTestPoll(void)
  360: {
  361: }
  362: 
B2:00A94C 22                RET      
----- FUNCTION ApplicationTestPoll (END) -------


----- FUNCTION _ApplicationPoll (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  368: E_APPLICATION_STATE ApplicationPoll(E_PROTOCOL_STATE bProtocolState)
  369: {
  370:   UNUSED(bProtocolState);
  371: 
  372: #ifdef WATCHDOG_ENABLED
  373:   ZW_WatchDogKick();
  374: #endif
  375: 
  376:   TaskApplicationPoll();
B2:00A94D 12C188            LCALL    TaskApplicationPoll
  377: 
  378:   return E_APPLICATION_STATE_ACTIVE;
B2:00A950 7F00              MOV      R7,#00H
  379: }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 644


B2:00A952 22                RET      
----- FUNCTION _ApplicationPoll (END) -------


----- FUNCTION _ApplicationNetworkLearnModeCompleted (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  532: void ApplicationNetworkLearnModeCompleted(uint8_t bNodeID)
  533: {
B2:00A953 9043A0            MOV      DPTR,#bNodeID
B2:00A956 EF                MOV      A,R7
B2:00A957 F0                MOVX     @DPTR,A
  534:   ZW_DEBUG_SEND_STR("\r\nApplicationNetworkLearnModeCompleted ");
  535:     ZW_DEBUG_SEND_NUM(bNodeID);
  536:     ZW_DEBUG_SEND_NL();
  537:   if(APPLICATION_NETWORK_LEARN_MODE_COMPLETED_SMART_START_IN_PROGRESS == bNodeID)
B2:00A958 BFFE04            CJNE     R7,#0FEH,?C0035?SWITCHONOFF
  538:   {
  539:     ZCB_eventSchedulerEventAdd(EVENT_APP_SMARTSTART_IN_PROGRESS);
B2:00A95B 7F75              MOV      R7,#075H
B2:00A95D 803C              SJMP     _ZCB_eventSchedulerEventAdd
  540:   }
B2:00A95F         ?C0035?SWITCHONOFF:
  541:   else
  542:   {
  543:     if (APPLICATION_NETWORK_LEARN_MODE_COMPLETED_FAILED == bNodeID)
B2:00A95F 9043A0            MOV      DPTR,#bNodeID
B2:00A962 E0                MOVX     A,@DPTR
B2:00A963 B4FF08            CJNE     A,#0FFH,?C0037?SWITCHONOFF
  544:     {
  545:       MemoryPutByte((WORD)&EEOFFSET_MAGIC_far, APPL_MAGIC_VALUE + 1);
B2:00A966 91C6              ACALL    ?L?COM042B
  546:       ZCB_eventSchedulerEventAdd((EVENT_APP) EVENT_SYSTEM_WATCHDOG_RESET);
B2:00A968 7F34              MOV      R7,#034H
B2:00A96A 319B              ACALL    _ZCB_eventSchedulerEventAdd
  547:     }
B2:00A96C 801E              SJMP     ?C0038?SWITCHONOFF
B2:00A96E         ?C0037?SWITCHONOFF:
  548:     else
  549:     {
  550:       if (APPLICATION_NETWORK_LEARN_MODE_COMPLETED_TIMEOUT == bNodeID)
B2:00A96E 9043A0            MOV      DPTR,#bNodeID
B2:00A971 E0                MOVX     A,@DPTR
B2:00A972 B4FD02            CJNE     A,#0FDH,?C0039?SWITCHONOFF
  551:       {
  552:         /**
  553:          * Inclusion or exclusion timed out. We need to make sure that the application triggers
  554:          * Smartstart inclusion.
  555:          */
  556:         ZCB_eventSchedulerEventAdd(EVENT_APP_INIT);
  557:         ChangeState(STATE_APP_STARTUP);
  558:       }
B2:00A975 8013              SJMP     ?C0141?SWITCHONOFF
B2:00A977         ?C0039?SWITCHONOFF:
  559:       else
  560:       {
  561:         /*Success*/
  562:         myNodeID = bNodeID;
B2:00A977 9043A0            MOV      DPTR,#bNodeID
B2:00A97A E0                MOVX     A,@DPTR
B2:00A97B 903830            MOV      DPTR,#myNodeID
B2:00A97E F0                MOVX     @DPTR,A
  563:         if (0 == myNodeID)
B2:00A97F E0                MOVX     A,@DPTR
B2:00A980 700A              JNZ      ?C0038?SWITCHONOFF
  564:         {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 645


  565:           /*Clear association*/
  566:           AssociationInit(TRUE);
B2:00A982 D244              SETB     ?AssociationInit?BIT
B2:00A984 12A103            LCALL    AssociationInit
  567:           SetDefaultConfiguration();
B2:00A987 12B6E7            LCALL    SetDefaultConfiguration
  568: 
  569:           ZCB_eventSchedulerEventAdd(EVENT_APP_INIT);
B2:00A98A         
B2:00A98A 7139              ACALL    ?L?COM04DB
  570:           ChangeState(STATE_APP_STARTUP);
  571:         }
  572:       }
  573:     }
B2:00A98C         ?C0038?SWITCHONOFF:
  574:     ZCB_eventSchedulerEventAdd((EVENT_APP) EVENT_SYSTEM_LEARNMODE_FINISH);
B2:00A98C 7F32              MOV      R7,#032H
B2:00A98E 319B              ACALL    _ZCB_eventSchedulerEventAdd
  575:     Transport_OnLearnCompleted(bNodeID);
B2:00A990 9043A0            MOV      DPTR,#bNodeID
B2:00A993 E0                MOVX     A,@DPTR
B2:00A994 FF                MOV      R7,A
B2:;----                  JMP      _Transport_OnLearnCompleted
  576:   }
----- FUNCTION _ApplicationNetworkLearnModeCompleted (END) -------


----- FUNCTION _Transport_OnLearnCompleted (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  358: uint8_t Transport_OnLearnCompleted(uint8_t nodeID)
  359: {
;---- Variable 'nodeID' assigned to Register 'R7' ----
  360:   SetupActiveNIF(nodeID);
  361: #ifndef NON_BATT
B2:00A995 128CB1            LCALL    _SetupActiveNIF
  362:   ZAF_pm_KeepAwakeAuto();
  363: #endif
  364: 
  365:   return TRUE;
B2:00A998 7F01              MOV      R7,#01H
  366: }
B2:00A99A 22                RET      
----- FUNCTION _Transport_OnLearnCompleted (END) -------


----- FUNCTION _ZCB_eventSchedulerEventAdd (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  121: PCB_BOOL(ZCB_eventSchedulerEventAdd)(BYTE event)
  122: {
B2:00A99B 9043AC            MOV      DPTR,#event
B2:00A99E EF                MOV      A,R7
B2:00A99F F0                MOVX     @DPTR,A
  123:   return ZW_util_queue_Enqueue(&eventQueue, &event);
  124: }
B2:00A9A0 7A43              MOV      R2,#HIGH event
B2:00A9A2 79AC              MOV      R1,#LOW event
B2:00A9A4 903E31            MOV      DPTR,#?_ZW_util_queue_Enqueue?BYTE+03H
B2:00A9A7 12CBAB            LCALL    ?L?COM0530
B2:;----                  JMP      _ZW_util_queue_Enqueue
----- FUNCTION _ZCB_eventSchedulerEventAdd (END) -------


----- FUNCTION _ZW_util_queue_Enqueue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_UTIL_QUEUE.C'
   47: BOOL ZW_util_queue_Enqueue(QUEUE_T * pQueue, void * pElement)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 646


   48: {
B2:00A9AA 903E2E            MOV      DPTR,#pQueue
B2:00A9AD 1225A9            LCALL    ?C?PSTXDATA
   49:   if (pQueue->count >= pQueue->queueSize)
   50:   {
B2:00A9B0 903E2E            MOV      DPTR,#pQueue
B2:00A9B3 128CA2            LCALL    ?L?COM007F
B2:00A9B6 FF                MOV      R7,A
B2:00A9B7 128F41            LCALL    ?L?COM002A
B2:00A9BA C3                CLR      C
B2:00A9BB 9F                SUBB     A,R7
B2:00A9BC 4001              JC       ?C0002?ZW_UTIL_QUEUE
   51:     return FALSE;
   52:   }
B2:00A9BE 22                RET      
   53:   else
B2:00A9BF         ?C0002?ZW_UTIL_QUEUE:
   54:   {
   55:     BYTE i;
   56:     BYTE* pEl = pElement;
B2:00A9BF 903E31            MOV      DPTR,#pElement
B2:00A9C2 122589            LCALL    ?C?PLDXDATA
B2:00A9C5 903E35            MOV      DPTR,#pEl
B2:00A9C8 1225A9            LCALL    ?C?PSTXDATA
   57: 
   58:     for (i = 0; i < pQueue->elementType; i++)
B2:00A9CB E4                CLR      A
B2:00A9CC 903E34            MOV      DPTR,#i
B2:00A9CF F0                MOVX     @DPTR,A
B2:00A9D0         ?C0005?ZW_UTIL_QUEUE:
B2:00A9D0 903E2E            MOV      DPTR,#pQueue
B2:00A9D3 122589            LCALL    ?C?PLDXDATA
B2:00A9D6 1270EB            LCALL    ?L?COM01E4
B2:00A9D9 FF                MOV      R7,A
B2:00A9DA 903E34            MOV      DPTR,#i
B2:00A9DD E0                MOVX     A,@DPTR
B2:00A9DE FE                MOV      R6,A
B2:00A9DF C3                CLR      C
B2:00A9E0 9F                SUBB     A,R7
B2:00A9E1 503F              JNC      ?C0006?ZW_UTIL_QUEUE
   59:     {
   60:       pQueue->array[ (pQueue->in)*(pQueue->elementType) + i ] = *(pEl + i);
B2:00A9E3 A3                INC      DPTR
B2:00A9E4 122589            LCALL    ?C?PLDXDATA
B2:00A9E7 8E82              MOV      DPL,R6
B2:00A9E9 126DCA            LCALL    ?L?COM01DA
B2:00A9EC FD                MOV      R5,A
B2:00A9ED 903E2E            MOV      DPTR,#pQueue
B2:00A9F0 12A5A3            LCALL    ?L?COM001F
B2:00A9F3 121FF0            LCALL    ?C?CLDOPTR
B2:00A9F6 8FF0              MOV      B,R7
B2:00A9F8 A4                MUL      AB
B2:00A9F9 FF                MOV      R7,A
B2:00A9FA 903E34            MOV      DPTR,#i
B2:00A9FD E0                MOVX     A,@DPTR
B2:00A9FE 7A00              MOV      R2,#00H
B2:00AA00 2F                ADD      A,R7
B2:00AA01 FF                MOV      R7,A
B2:00AA02 EA                MOV      A,R2
B2:00AA03 35F0              ADDC     A,B
B2:00AA05 FE                MOV      R6,A
B2:00AA06 903E2E            MOV      DPTR,#pQueue
B2:00AA09 122589            LCALL    ?C?PLDXDATA
B2:00AA0C 900005            MOV      DPTR,#05H
B2:00AA0F 12262D            LCALL    ?C?PLDOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 647


B2:00AA12 8F82              MOV      DPL,R7
B2:00AA14 8E83              MOV      DPH,R6
B2:00AA16 ED                MOV      A,R5
B2:00AA17 122084            LCALL    ?C?CSTOPTR
   61:     }
B2:00AA1A 903E34            MOV      DPTR,#i
B2:00AA1D E0                MOVX     A,@DPTR
B2:00AA1E 04                INC      A
B2:00AA1F F0                MOVX     @DPTR,A
B2:00AA20 80AE              SJMP     ?C0005?ZW_UTIL_QUEUE
B2:00AA22         ?C0006?ZW_UTIL_QUEUE:
   62: 
   63:     pQueue->in = (pQueue->in + 1) % pQueue->queueSize;
B2:00AA22 903E2E            MOV      DPTR,#pQueue
B2:00AA25 12A5A3            LCALL    ?L?COM001F
B2:00AA28 121FF0            LCALL    ?C?CLDOPTR
B2:00AA2B 04                INC      A
B2:00AA2C FF                MOV      R7,A
B2:00AA2D 128CA5            LCALL    ?L?COM0080
B2:00AA30 FE                MOV      R6,A
B2:00AA31 EF                MOV      A,R7
B2:00AA32 8EF0              MOV      B,R6
B2:00AA34 84                DIV      AB
B2:00AA35 900001            MOV      DPTR,#01H
B2:00AA38 E5F0              MOV      A,B
B2:00AA3A 122084            LCALL    ?C?CSTOPTR
   64:     pQueue->count = pQueue->count + 1;
B2:00AA3D 900002            MOV      DPTR,#02H
B2:00AA40 7401              MOV      A,#01H
B2:00AA42 12203F            LCALL    ?C?CILDOPTR
   65:   }
B2:00AA45         ?C0004?ZW_UTIL_QUEUE:
   66:   return TRUE;
B2:00AA45 D3                SETB     C
   67: }
B2:00AA46 22                RET      
----- FUNCTION _ZW_util_queue_Enqueue (END) -------


----- FUNCTION _handleCommandClassZWavePlusInfo (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSZWAVEPLUSINFO.C'
   80: handleCommandClassZWavePlusInfo(
   81:     RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00AA47 903C59            MOV      DPTR,#rxOpt
B2:00AA4A 1225A9            LCALL    ?C?PSTXDATA
   82:     ZW_APPLICATION_TX_BUFFER *pCmd,
   83:     BYTE cmdLength
   84: )
   85: {
   86:   UNUSED(cmdLength);
   87:   if (pCmd->ZW_Common.cmd == ZWAVEPLUS_INFO_GET)
B2:00AA4D 903C5C            MOV      DPTR,#pCmd
B2:00AA50 12A5A3            LCALL    ?L?COM001F
B2:00AA53 121FF0            LCALL    ?C?CLDOPTR
B2:00AA56 6401              XRL      A,#01H
B2:00AA58 6002              JZ       $ + 4H
B2:00AA5A 6124              AJMP     ?C0002?COMMANDCLASSZWAVEPLUSINFO
   88:   {
   89:     /*Check pTxBuf is free*/
   90:     if(FALSE == Check_not_legal_response_job(rxOpt))
B2:00AA5C 903C59            MOV      DPTR,#rxOpt
B2:00AA5F 12A19D            LCALL    ?L?COM01BF
B2:00AA62 5002              JNC      $ + 4H
B2:00AA64 6121              AJMP     ?C0003?COMMANDCLASSZWAVEPLUSINFO
   91:     {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 648


   92:       ZW_APPLICATION_TX_BUFFER * pTxBuf = GetResponseBuffer();
B2:00AA66 129A8C            LCALL    GetResponseBuffer
B2:00AA69 903C60            MOV      DPTR,#pTxBuf
B2:00AA6C 1225A9            LCALL    ?C?PSTXDATA
   93: 
   94:       if( NON_NULL( pTxBuf ) )
B2:00AA6F E9                MOV      A,R1
B2:00AA70 4A                ORL      A,R2
B2:00AA71 7002              JNZ      $ + 4H
B2:00AA73 6121              AJMP     ?C0003?COMMANDCLASSZWAVEPLUSINFO
   95:       {
   96:         TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
   97:         RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00AA75 7B01              MOV      R3,#01H
B2:00AA77 7A3C              MOV      R2,#HIGH pTxOptionsEx
B2:00AA79 7963              MOV      R1,#LOW pTxOptionsEx
B2:00AA7B 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00AA7E 1225A9            LCALL    ?C?PSTXDATA
B2:00AA81 903C59            MOV      DPTR,#rxOpt
B2:00AA84 715D              ACALL    ?L?COM0107
   98:         pTxBuf->ZW_ZwaveplusInfoReportV2Frame.cmdClass = COMMAND_CLASS_ZWAVEPLUS_INFO;
B2:00AA86 712D              ACALL    ?L?COM0260
B2:00AA88 745E              MOV      A,#05EH
B2:00AA8A 122072            LCALL    ?C?CSTPTR
   99:         pTxBuf->ZW_ZwaveplusInfoReportV2Frame.cmd = ZWAVEPLUS_INFO_REPORT;
B2:00AA8D 903C60            MOV      DPTR,#pTxBuf
B2:00AA90 12A5A3            LCALL    ?L?COM001F
B2:00AA93 7402              MOV      A,#02H
B2:00AA95 12CB21            LCALL    ?L?COM01DB
  100:         pTxBuf->ZW_ZwaveplusInfoReportV2Frame.zWaveVersion = ZW_PLUS_VERSION;
  101:         pTxBuf->ZW_ZwaveplusInfoReportV2Frame.roleType = APP_ROLE_TYPE;
B2:00AA98 7405              MOV      A,#05H
B2:00AA9A 12CBCD            LCALL    ?L?COM03E6
B2:00AA9D 3134              ACALL    ?L?COM0060
B2:00AA9F FF                MOV      R7,A
B2:00AAA0 90426E            MOV      DPTR,#myIcon+03H
B2:00AAA3 E0                MOVX     A,@DPTR
B2:00AAA4 C3                CLR      C
B2:00AAA5 9F                SUBB     A,R7
B2:00AAA6 404A              JC       ?C0005?COMMANDCLASSZWAVEPLUSINFO
B2:00AAA8 EF                MOV      A,R7
B2:00AAA9 6047              JZ       ?C0005?COMMANDCLASSZWAVEPLUSINFO
B2:00AAAB 90426B            MOV      DPTR,#myIcon
B2:00AAAE 122589            LCALL    ?C?PLDXDATA
B2:00AAB1 E9                MOV      A,R1
B2:00AAB2 4A                ORL      A,R2
B2:00AAB3 603D              JZ       ?C0005?COMMANDCLASSZWAVEPLUSINFO
  102:         pTxBuf->ZW_ZwaveplusInfoReportV2Frame.nodeType = APP_NODE_TYPE;
  103: 
  104: 
  105:         if((myIcon.nbrOfElements >= rxOpt->destNode.endpoint) && (0 != rxOpt->destNode.endpoint) && (NON_NULL(myI
>> con.pEpIcon)) )
  106:         {
  107:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.installerIconType1 = (myIcon.pEpIcon[rxOpt->destNode.endpoint-1].
>> installerIconType >> 8);
B2:00AAB5 3137              ACALL    ?L?COM0061
B2:00AAB7 1282A5            LCALL    ?L?COM0085
B2:00AABA 90FFFC            MOV      DPTR,#0FFFCH
B2:00AABD 7127              ACALL    ?L?COM025E
B2:00AABF 900005            MOV      DPTR,#05H
B2:00AAC2 3133              ACALL    ?L?COM005F
B2:00AAC4 1282A5            LCALL    ?L?COM0085
B2:00AAC7 90FFFC            MOV      DPTR,#0FFFCH
B2:00AACA 12219A            LCALL    ?C?ILDOPTR
B2:00AACD 712C              ACALL    ?L?COM025F
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 649


B2:00AACF 900006            MOV      DPTR,#06H
B2:00AAD2 3133              ACALL    ?L?COM005F
B2:00AAD4 1282A5            LCALL    ?L?COM0085
B2:00AAD7 90FFFE            MOV      DPTR,#0FFFEH
B2:00AADA 7127              ACALL    ?L?COM025E
B2:00AADC 900007            MOV      DPTR,#07H
B2:00AADF 3133              ACALL    ?L?COM005F
B2:00AAE1 1282A5            LCALL    ?L?COM0085
B2:00AAE4 90FFFE            MOV      DPTR,#0FFFEH
B2:00AAE7 12219A            LCALL    ?C?ILDOPTR
B2:00AAEA 712C              ACALL    ?L?COM025F
B2:00AAEC 900008            MOV      DPTR,#08H
B2:00AAEF EF                MOV      A,R7
  108:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.installerIconType2 = (myIcon.pEpIcon[rxOpt->destNode.endpoint-1].
>> installerIconType & 0xff);
  109:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.userIconType1 = (myIcon.pEpIcon[rxOpt->destNode.endpoint-1].userI
>> conType >> 8);
  110:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.userIconType2 = (myIcon.pEpIcon[rxOpt->destNode.endpoint-1].userI
>> conType & 0xff);
  111:         }
B2:00AAF0 8010              SJMP     ?C0009?COMMANDCLASSZWAVEPLUSINFO
B2:00AAF2         ?C0005?COMMANDCLASSZWAVEPLUSINFO:
  112:         else
  113:         {
  114:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.installerIconType1 = (APP_ICON_TYPE >> 8);
B2:00AAF2 712D              ACALL    ?L?COM0260
B2:00AAF4 7407              MOV      A,#07H
B2:00AAF6 12CBE7            LCALL    ?L?COM036B
B2:00AAF9 7407              MOV      A,#07H
B2:00AAFB 122084            LCALL    ?C?CSTOPTR
  115:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.installerIconType2 = (APP_ICON_TYPE & 0xff);
  116:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.userIconType1 = (APP_USER_ICON_TYPE >> 8);
  117:           pTxBuf->ZW_ZwaveplusInfoReportV2Frame.userIconType2 = (APP_USER_ICON_TYPE & 0xff);
B2:00AAFE 900008            MOV      DPTR,#08H
B2:00AB01 E4                CLR      A
B2:00AB02         
B2:00AB02 122084            LCALL    ?C?CSTOPTR
  118:         }
B2:00AB05         ?C0006?COMMANDCLASSZWAVEPLUSINFO:
  119: 
  120:         {
  121:           uint8_t txResult;
  122: 
  123:           txResult = Transport_SendResponseEP(
  124:                         (BYTE *)pTxBuf,
B2:00AB05 903C63            MOV      DPTR,#pTxOptionsEx
B2:00AB08 12A147            LCALL    ?L?COM001D
B2:00AB0B 712D              ACALL    ?L?COM0260
B2:00AB0D 7D09              MOV      R5,#09H
B2:00AB0F 12A741            LCALL    _Transport_SendResponseEP
B2:00AB12 903C66            MOV      DPTR,#txResult
B2:00AB15 EF                MOV      A,R7
B2:00AB16 F0                MOVX     @DPTR,A
  125:                         sizeof(pTxBuf->ZW_ZwaveplusInfoReportV2Frame),
  126:                         pTxOptionsEx,
  127:                         ZCB_ResponseJobStatus);
  128: 
  129:           if (ZW_TX_IN_PROGRESS != txResult)
B2:00AB17 6401              XRL      A,#01H
B2:00AB19 6003              JZ       ?C0007?COMMANDCLASSZWAVEPLUSINFO
  130:           {
  131:             FreeResponseBuffer();
B2:00AB1B 12A0B6            LCALL    FreeResponseBuffer
  132:           }
B2:00AB1E         ?C0007?COMMANDCLASSZWAVEPLUSINFO:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 650


  133:         }
  134:         return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00AB1E 7FFF              MOV      R7,#0FFH
B2:00AB20 22                RET      
  135:       }  
  136:     }
B2:00AB21         ?C0003?COMMANDCLASSZWAVEPLUSINFO:
  137:     return RECEIVED_FRAME_STATUS_FAIL;
B2:00AB21 7F02              MOV      R7,#02H
B2:00AB23 22                RET      
  138:   }
B2:00AB24         ?C0002?COMMANDCLASSZWAVEPLUSINFO:
  139:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00AB24 7F00              MOV      R7,#00H
  140: }
B2:00AB26 22                RET      
----- FUNCTION _handleCommandClassZWavePlusInfo (END) -------


----- FUNCTION ?L?COM025E (BEGIN) -----
B2:00AB27 12219A            LCALL    ?C?ILDOPTR
B2:00AB2A E5F0              MOV      A,B
B2:00AB2C         ?L?COM025F:
B2:00AB2C FF                MOV      R7,A
B2:00AB2D         ?L?COM0260:
B2:00AB2D 903C60            MOV      DPTR,#pTxBuf
B2:00AB30 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM025E (END) -------


----- FUNCTION GetMyNodeID (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  585: GetMyNodeID(void)
  586: {
  587: 	return myNodeID;
  588: }
B2:00AB33 903830            MOV      DPTR,#myNodeID
B2:00AB36 E0                MOVX     A,@DPTR
B2:00AB37 FF                MOV      R7,A
  589: 
B2:00AB38 22                RET      
----- FUNCTION GetMyNodeID (END) -------


----- FUNCTION ?L?COM04DB (BEGIN) -----
B2:00AB39 7F71              MOV      R7,#071H
B2:00AB3B 319B              ACALL    _ZCB_eventSchedulerEventAdd
B2:00AB3D E4                CLR      A
B2:00AB3E FF                MOV      R7,A
----- FUNCTION _ChangeState (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  747: ChangeState(STATE_APP newState)
  748: {
;---- Variable 'newState' assigned to Register 'R7' ----
  749:   ZW_DEBUG_MYPRODUCT_SEND_NL();
  750:   ZW_DEBUG_MYPRODUCT_SEND_STR("State changed: ");
  751:   ZW_DEBUG_MYPRODUCT_SEND_NUM(currentState);
  752:   ZW_DEBUG_MYPRODUCT_SEND_STR(" -> ");
  753:   ZW_DEBUG_MYPRODUCT_SEND_NUM(newState);
  754: 
  755:   currentState = newState;
B2:00AB3F 903814            MOV      DPTR,#currentState
B2:00AB42 EF                MOV      A,R7
B2:00AB43 F0                MOVX     @DPTR,A
  756: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 651


  757:   /**< Pre-action on new state is to refresh MMI */
  758:   ZCB_eventSchedulerEventAdd(EVENT_APP_REFRESH_MMI);
B2:00AB44 7F72              MOV      R7,#072H
B2:00AB46 219B              AJMP     _ZCB_eventSchedulerEventAdd
----- FUNCTION _ChangeState (END) -------


----- FUNCTION GetAppState (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  596: GetAppState(void)
  597: {
  598:   return currentState;
  599: }
B2:00AB48 903814            MOV      DPTR,#currentState
B2:00AB4B E0                MOVX     A,@DPTR
B2:00AB4C FF                MOV      R7,A
  600: 
B2:00AB4D 22                RET      
----- FUNCTION GetAppState (END) -------


----- FUNCTION ?L?COM0105 (BEGIN) -----
B2:00AB4E 7B01              MOV      R3,#01H
B2:00AB50 7A3B              MOV      R2,#HIGH txOptionsEx
B2:00AB52 7934              MOV      R1,#LOW txOptionsEx
B2:00AB54         ?L?COM0106:
B2:00AB54 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00AB57 1225A9            LCALL    ?C?PSTXDATA
B2:00AB5A 903B24            MOV      DPTR,#rxOpt
B2:00AB5D         ?L?COM0107:
B2:00AB5D 122589            LCALL    ?C?PLDXDATA
B2:00AB60 81FF              AJMP     _RxToTxOptions
----- FUNCTION ?L?COM0105 (END) -------


----- FUNCTION _AppStateManager (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  606: AppStateManager(EVENT_APP event)
  607: {
B2:00AB62 9043A1            MOV      DPTR,#event
B2:00AB65 EF                MOV      A,R7
B2:00AB66 F0                MOVX     @DPTR,A
  608:   ZW_DEBUG_MYPRODUCT_SEND_NL();
  609:   ZW_DEBUG_MYPRODUCT_SEND_STR("ASM e");
  610:   ZW_DEBUG_MYPRODUCT_SEND_NUM(event);
  611:   ZW_DEBUG_MYPRODUCT_SEND_STR("s");
  612:   ZW_DEBUG_MYPRODUCT_SEND_NUM(currentState);
  613: 
  614:   if(EVENT_SYSTEM_WATCHDOG_RESET == event)
B2:00AB67 BF3404            CJNE     R7,#034H,?C0045?SWITCHONOFF
  615:   {
  616:     /*Force state change to activate watchdog-reset without taking care of current
  617:       state.*/
  618:     ChangeState(STATE_APP_WATCHDOG_RESET);
B2:00AB6A 7F03              MOV      R7,#03H
B2:00AB6C 713F              ACALL    _ChangeState
  619:   }
B2:00AB6E         ?C0045?SWITCHONOFF:
  620: 
  621:   switch(currentState)
B2:00AB6E 903814            MOV      DPTR,#currentState
B2:00AB71 E0                MOVX     A,@DPTR
B2:00AB72 14                DEC      A
B2:00AB73 6026              JZ       ?C0049?SWITCHONOFF
B2:00AB75 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 652


B2:00AB76 6078              JZ       ?C0059?SWITCHONOFF
B2:00AB78 14                DEC      A
B2:00AB79 7002              JNZ      $ + 4H
B2:00AB7B 8115              AJMP     ?C0064?SWITCHONOFF
B2:00AB7D 14                DEC      A
B2:00AB7E 7002              JNZ      $ + 4H
B2:00AB80 811A              AJMP     ?C0068?SWITCHONOFF
B2:00AB82 14                DEC      A
B2:00AB83 7002              JNZ      $ + 4H
B2:00AB85 8121              AJMP     ?C0070?SWITCHONOFF
B2:00AB87 2405              ADD      A,#05H
B2:00AB89 6002              JZ       $ + 4H
B2:00AB8B 8146              AJMP     ?C0074?SWITCHONOFF
  622:   {
  623:     case STATE_APP_STARTUP:
B2:00AB8D         ?C0047?SWITCHONOFF:
  624: 
  625:       if(EVENT_APP_INIT == event)
B2:00AB8D 9043A1            MOV      DPTR,#event
B2:00AB90 E0                MOVX     A,@DPTR
B2:00AB91 B47105            CJNE     A,#071H,?C0048?SWITCHONOFF
  626:       {
  627:         ZW_NetworkLearnModeStart(E_NETWORK_LEARN_MODE_INCLUSION_SMARTSTART);
B2:00AB94 7F04              MOV      R7,#04H
B2:00AB96 124281            LCALL    _ZW_NetworkLearnModeStart
  628:       }
B2:00AB99         ?C0048?SWITCHONOFF:
  629: 
  630:       ChangeState(STATE_APP_IDLE);
  631:       break;
B2:00AB99 8076              SJMP     ?C0142?SWITCHONOFF
  632: 
  633:     case STATE_APP_IDLE:
B2:00AB9B         ?C0049?SWITCHONOFF:
  634:       if(EVENT_APP_REFRESH_MMI == event)
B2:00AB9B 9043A1            MOV      DPTR,#event
B2:00AB9E E0                MOVX     A,@DPTR
B2:00AB9F B47202            CJNE     A,#072H,?C0050?SWITCHONOFF
  635:       {
  636:         Led(ZDP03A_LED_D1,OFF);
B2:00ABA2 91CF              ACALL    ?L?COM04DA
  637:         RefreshMMI();
  638:       }
B2:00ABA4         ?C0050?SWITCHONOFF:
  639: 
  640:       if(EVENT_APP_SMARTSTART_IN_PROGRESS == event)
B2:00ABA4 9043A1            MOV      DPTR,#event
B2:00ABA7 E0                MOVX     A,@DPTR
B2:00ABA8 B47504            CJNE     A,#075H,?C0051?SWITCHONOFF
  641:       {
  642:         ChangeState(STATE_APP_LEARN_MODE);
B2:00ABAB 7F02              MOV      R7,#02H
B2:00ABAD 713F              ACALL    _ChangeState
  643:       }
B2:00ABAF         ?C0051?SWITCHONOFF:
  644: 
  645:       if((EVENT_KEY_B1_PRESS == event) ||(EVENT_SYSTEM_LEARNMODE_START == event))
B2:00ABAF 12DBE3            LCALL    ?L?COM05FA
B2:00ABB2 6004              JZ       ?C0053?SWITCHONOFF
B2:00ABB4 EF                MOV      A,R7
B2:00ABB5 B43113            CJNE     A,#031H,?C0052?SWITCHONOFF
B2:00ABB8         ?C0053?SWITCHONOFF:
  646:       {
  647:         if (myNodeID)
B2:00ABB8 903830            MOV      DPTR,#myNodeID
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 653


B2:00ABBB E0                MOVX     A,@DPTR
B2:00ABBC 6004              JZ       ?C0054?SWITCHONOFF
  648:         {
  649:           ZW_DEBUG_MYPRODUCT_SEND_STR("LEARN_MODE_EXCLUSION");
  650:           ZW_NetworkLearnModeStart(E_NETWORK_LEARN_MODE_EXCLUSION_NWE);
B2:00ABBE 7F03              MOV      R7,#03H
  651:         }
B2:00ABC0 8002              SJMP     ?C0143?SWITCHONOFF
B2:00ABC2         ?C0054?SWITCHONOFF:
  652:         else{
  653:           ZW_DEBUG_MYPRODUCT_SEND_STR("LEARN_MODE_INCLUSION");
  654:           ZW_NetworkLearnModeStart(E_NETWORK_LEARN_MODE_INCLUSION);
B2:00ABC2 7F01              MOV      R7,#01H
B2:00ABC4         
B2:00ABC4 124281            LCALL    _ZW_NetworkLearnModeStart
  655:         }
B2:00ABC7         ?C0055?SWITCHONOFF:
  656:         ChangeState(STATE_APP_LEARN_MODE);
B2:00ABC7 7F02              MOV      R7,#02H
B2:00ABC9 713F              ACALL    _ChangeState
  657:       }
B2:00ABCB         ?C0052?SWITCHONOFF:
  658: 
  659:       if((EVENT_KEY_B1_HELD_10_SEC == event) || (EVENT_SYSTEM_RESET ==event))
B2:00ABCB 9043A1            MOV      DPTR,#event
B2:00ABCE E0                MOVX     A,@DPTR
B2:00ABCF FF                MOV      R7,A
B2:00ABD0 6445              XRL      A,#045H
B2:00ABD2 6004              JZ       ?C0057?SWITCHONOFF
B2:00ABD4 EF                MOV      A,R7
B2:00ABD5 B4300D            CJNE     A,#030H,?C0056?SWITCHONOFF
B2:00ABD8         ?C0057?SWITCHONOFF:
  660:       {
  661:         /*
  662:          * Since this application is a routing slave, it'll use the internal NVM also known as the
  663:          * MTP. The MTP is getting flushed 300 ms after the latest write which means we'll have to
  664:          * wait some time before resetting the device.
  665:          */
  666:         MemoryPutByte((WORD)&EEOFFSET_MAGIC_far, 1 + APPL_MAGIC_VALUE);
B2:00ABD8 91C6              ACALL    ?L?COM042B
  667:         ZW_TIMER_START(ZCB_ResetDelay, 50, 1); // 50 * 10 = 500 ms  to be sure.
B2:00ABDA 7E1D              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_ResetDelay
B2:00ABDC 7FFE              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_ResetDelay
B2:00ABDE 7B01              MOV      R3,#01H
B2:00ABE0 7D32              MOV      R5,#032H
B2:00ABE2 124FFF            LCALL    _TimerStart
  668:       }
B2:00ABE5         ?C0056?SWITCHONOFF:
  669: 
  670:       if(EVENT_KEY_B2_PRESS == event)
B2:00ABE5 9043A1            MOV      DPTR,#event
B2:00ABE8 E0                MOVX     A,@DPTR
B2:00ABE9 6448              XRL      A,#048H
B2:00ABEB 7059              JNZ      ?C0074?SWITCHONOFF
  671:       {
  672:         ZW_DEBUG_MYPRODUCT_SEND_STR("+ToggleLed ");
  673:         ToggleLed();
B2:00ABED 02B875            LJMP     ToggleLed
  674:       }
  675:       break;
  676: 
  677:     case STATE_APP_LEARN_MODE:
B2:00ABF0         ?C0059?SWITCHONOFF:
  678:       if(EVENT_APP_REFRESH_MMI == event)
B2:00ABF0 9043A1            MOV      DPTR,#event
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 654


B2:00ABF3 E0                MOVX     A,@DPTR
B2:00ABF4 B47202            CJNE     A,#072H,?C0060?SWITCHONOFF
  679:       {
  680:         Led(ZDP03A_LED_D1,ON);
B2:00ABF7 9147              ACALL    ?L?COM05FB
  681:       }
B2:00ABF9         ?C0060?SWITCHONOFF:
  682: 
  683:       if((EVENT_KEY_B1_PRESS == event)||(EVENT_SYSTEM_LEARNMODE_END == event))
B2:00ABF9 12DBE3            LCALL    ?L?COM05FA
B2:00ABFC 6004              JZ       ?C0062?SWITCHONOFF
B2:00ABFE EF                MOV      A,R7
B2:00ABFF B43307            CJNE     A,#033H,?C0061?SWITCHONOFF
B2:00AC02         ?C0062?SWITCHONOFF:
  684:       {
  685:         ZW_NetworkLearnModeStart(E_NETWORK_LEARN_MODE_DISABLE);
B2:00AC02 E4                CLR      A
B2:00AC03 FF                MOV      R7,A
B2:00AC04 124281            LCALL    _ZW_NetworkLearnModeStart
  686:         ZCB_eventSchedulerEventAdd(EVENT_APP_INIT);
B2:00AC07 7139              ACALL    ?L?COM04DB
  687:         ChangeState(STATE_APP_STARTUP);
  688:       }
B2:00AC09         ?C0061?SWITCHONOFF:
  689: 
  690:       if(EVENT_SYSTEM_LEARNMODE_FINISH == event)
B2:00AC09 9043A1            MOV      DPTR,#event
B2:00AC0C E0                MOVX     A,@DPTR
B2:00AC0D 6432              XRL      A,#032H
B2:00AC0F 7035              JNZ      ?C0074?SWITCHONOFF
  691:       {
  692:         ZW_DEBUG_MYPRODUCT_SEND_NL();
  693:         ZW_DEBUG_MYPRODUCT_SEND_STR("learn finish");
  694:         ChangeState(STATE_APP_IDLE);
B2:00AC11         
B2:00AC11 7F01              MOV      R7,#01H
B2:00AC13 613F              AJMP     _ChangeState
  695:       }
  696:       break;
  697: 
  698:     case STATE_APP_WATCHDOG_RESET:
B2:00AC15         ?C0064?SWITCHONOFF:
  699:       if(EVENT_APP_REFRESH_MMI == event){}
B2:00AC15         ?C0065?SWITCHONOFF:
  700:       ZW_DEBUG_MYPRODUCT_SEND_NL();
  701:       ZW_DEBUG_MYPRODUCT_SEND_STR("STATE_APP_WATCHDOG_RESET");
  702:       ZW_WatchDogEnable(); /*reset asic*/
B2:00AC15 123FF9            LCALL    ZW_WatchDogEnable
  703:       for (;;) {}
B2:00AC18         ?C0066?SWITCHONOFF:
B2:00AC18 80FE              SJMP     ?C0066?SWITCHONOFF
  704:       break;
  705: 
  706:     case STATE_APP_OTA:
B2:00AC1A         ?C0068?SWITCHONOFF:
  707:       if(EVENT_APP_REFRESH_MMI == event){}
B2:00AC1A 9043A1            MOV      DPTR,#event
B2:00AC1D E0                MOVX     A,@DPTR
B2:00AC1E 6472              XRL      A,#072H
  708:       /*OTA state... do nothing until firmware update is finish*/
  709:       break;
B2:00AC20 22                RET      
  710: 
  711: #ifdef BOOTLOADER_ENABLED
  712:     case STATE_APP_OTA_HOST:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 655


B2:00AC21         ?C0070?SWITCHONOFF:
  713:       /*
  714:        * Wait here until host firmware update is finished.
  715:        */
  716:       if ( EVENT_APP_REFRESH_MMI == event)
B2:00AC21 9043A1            MOV      DPTR,#event
B2:00AC24 E0                MOVX     A,@DPTR
B2:00AC25 B47202            CJNE     A,#072H,?C0071?SWITCHONOFF
  717:       {
  718:         Led(ZDP03A_LED_D1,OFF);
B2:00AC28 91CF              ACALL    ?L?COM04DA
  719:         RefreshMMI();
  720:       }
B2:00AC2A         ?C0071?SWITCHONOFF:
  721:       if (EVENT_APP_OTA_HOST_WRITE_DONE == event)
B2:00AC2A 9043A1            MOV      DPTR,#event
B2:00AC2D E0                MOVX     A,@DPTR
B2:00AC2E B47303            CJNE     A,#073H,?C0072?SWITCHONOFF
  722:       {
  723:         ZW_DEBUG_SEND_NL();
  724:         ZW_DEBUG_SEND_STR("EVENT_APP_OTA_HOST_WRITE_DONE");
  725:         OtaHostFWU_WriteFinish();
B2:00AC31 12D148            LCALL    OtaHostFWU_WriteFinish
  726:       }
B2:00AC34         ?C0072?SWITCHONOFF:
  727:       if (EVENT_APP_OTA_HOST_STATUS == event)
B2:00AC34 9043A1            MOV      DPTR,#event
B2:00AC37 E0                MOVX     A,@DPTR
B2:00AC38 B4740B            CJNE     A,#074H,?C0074?SWITCHONOFF
  728:       {
  729:         ZW_DEBUG_SEND_NL();
  730:         ZW_DEBUG_SEND_STR("EVENT_APP_OTA_HOST_STATUS");
  731: 
  732:       // we assume we always updated successfully
  733:         userReboot = FALSE;
B2:00AC3B C23B              CLR      userReboot
  734:         OtaHostFWU_Status(userReboot, TRUE);
B2:00AC3D A23B              MOV      C,userReboot
B2:00AC3F 9223              MOV      ?OtaHostFWU_Status?BIT,C
B2:00AC41 D224              SETB     ?OtaHostFWU_Status?BIT+01H
B2:00AC43 12D116            LCALL    OtaHostFWU_Status
  735:       }
  736:       break;
  737: #endif
  738:   }
  739: }
B2:00AC46         ?C0074?SWITCHONOFF:
B2:00AC46 22                RET      
----- FUNCTION _AppStateManager (END) -------


----- FUNCTION ?L?COM05FB (BEGIN) -----
B2:00AC47 E4                CLR      A
B2:00AC48 FD                MOV      R5,A
B2:00AC49 7F07              MOV      R7,#07H
----- FUNCTION _Led (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  198: void Led( LED_OUT led,  LED_ACTION action)
  199: {
;---- Variable 'action' assigned to Register 'R5' ----
;---- Variable 'led' assigned to Register 'R7' ----
  200:   gpio_SetPin(led, action);
  201: }
B2:00AC4B ED                MOV      A,R5
B2:00AC4C 24FF              ADD      A,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 656


B2:00AC4E 9241              MOV      ?_gpio_SetPin?BIT,C
B2:;----                  JMP      _gpio_SetPin
----- FUNCTION _Led (END) -------


----- FUNCTION _gpio_SetPin (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  338: void gpio_SetPin(BYTE pin, BOOL fValue)
  339: {
B2:00AC50 9043AA            MOV      DPTR,#pin
B2:00AC53 EF                MOV      A,R7
B2:00AC54 F0                MOVX     @DPTR,A
  340:   if (TRUE == fDoPinSwap)
  341:   {
B2:00AC55 304209            JNB      fDoPinSwap,?C0065?GPIO_DRIVER
  342:     searchPinList(&pin);
  343:   }
B2:00AC58 7B01              MOV      R3,#01H
B2:00AC5A 7A43              MOV      R2,#HIGH pin
B2:00AC5C 79AA              MOV      R1,#LOW pin
B2:00AC5E 12BB20            LCALL    _searchPinList
  344:   ZW_DEBUG_GPIO_DRIVER_SEND_NL();
B2:00AC61         ?C0065?GPIO_DRIVER:
  345:   ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: SetPin ");
  346:   ZW_DEBUG_GPIO_DRIVER_SEND_NUM(pin);
  347:   ZW_DEBUG_GPIO_DRIVER_SEND_STR(" = ");
  348:   ZW_DEBUG_GPIO_DRIVER_SEND_NUM(fValue);
  349:   if (TRUE == fValue)
B2:00AC61 9043AA            MOV      DPTR,#pin
B2:00AC64 E0                MOVX     A,@DPTR
B2:00AC65 FF                MOV      R7,A
B2:00AC66 304103            JNB      fValue,?C0066?GPIO_DRIVER
  350:   {
  351:     PinOn(pin);
B2:00AC69 02BF38            LJMP     _PinOn
  352:   }
B2:00AC6C         ?C0066?GPIO_DRIVER:
B2:;----                  JMP      _PinOff
  353:   else
  354:   {
  355:     PinOff(pin);
  356:   }
----- FUNCTION _gpio_SetPin (END) -------


----- FUNCTION _PinOff (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  241: PinOff(BYTE pin)
;---- Variable 'pin' assigned to Register 'R7' ----
;---- Variable 'port' assigned to Register 'R6' ----
;---- Variable 'portPin' assigned to Register 'R7' ----
B2:00AC6C 12BCB6            LCALL    ?L?COM029A
B2:00AC6F 601C              JZ       ?C0051?GPIO_DRIVER
B2:00AC71 14                DEC      A
B2:00AC72 602B              JZ       ?C0052?GPIO_DRIVER
B2:00AC74 14                DEC      A
B2:00AC75 603A              JZ       ?C0053?GPIO_DRIVER
B2:00AC77 2403              ADD      A,#03H
B2:00AC79 7047              JNZ      ?C0054?GPIO_DRIVER
  242: {
  243:   BYTE port = pin>>4;
  244:   BYTE portPin = pin&0x0F;
  245: 
  246:   switch(port)
  247:   {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 657


  248:     case 0:
B2:00AC7B         ?C0050?GPIO_DRIVER:
  249:       P0Shadow &= ~(1 << portPin);
B2:00AC7B 7401              MOV      A,#01H
B2:00AC7D A807              MOV      R0,AR7
B2:00AC7F 08                INC      R0
B2:00AC80 8002              SJMP     ?C0112?GPIO_DRIVER
B2:00AC82         ?C0111?GPIO_DRIVER:
B2:00AC82 C3                CLR      C
B2:00AC83 33                RLC      A
B2:00AC84         ?C0112?GPIO_DRIVER:
B2:00AC84 D8FC              DJNZ     R0,?C0111?GPIO_DRIVER
B2:00AC86 F4                CPL      A
B2:00AC87 526C              ANL      P0Shadow,A
  250:       P0 = P0Shadow;
B2:00AC89 856C80            MOV      P0,P0Shadow
  251:       break;
B2:00AC8C 22                RET      
  252:     case 1:
B2:00AC8D         ?C0051?GPIO_DRIVER:
  253:       P1Shadow &= ~(1 << portPin);
B2:00AC8D 7401              MOV      A,#01H
B2:00AC8F A807              MOV      R0,AR7
B2:00AC91 08                INC      R0
B2:00AC92 8002              SJMP     ?C0114?GPIO_DRIVER
B2:00AC94         ?C0113?GPIO_DRIVER:
B2:00AC94 C3                CLR      C
B2:00AC95 33                RLC      A
B2:00AC96         ?C0114?GPIO_DRIVER:
B2:00AC96 D8FC              DJNZ     R0,?C0113?GPIO_DRIVER
B2:00AC98 F4                CPL      A
B2:00AC99 526D              ANL      P1Shadow,A
  254:       P1 = P1Shadow;
B2:00AC9B 856D90            MOV      P1,P1Shadow
  255:       break;
B2:00AC9E 22                RET      
  256:     case 2:
B2:00AC9F         ?C0052?GPIO_DRIVER:
  257:       P2Shadow &= ~(1 << portPin);
B2:00AC9F 7401              MOV      A,#01H
B2:00ACA1 A807              MOV      R0,AR7
B2:00ACA3 08                INC      R0
B2:00ACA4 8002              SJMP     ?C0116?GPIO_DRIVER
B2:00ACA6         ?C0115?GPIO_DRIVER:
B2:00ACA6 C3                CLR      C
B2:00ACA7 33                RLC      A
B2:00ACA8         ?C0116?GPIO_DRIVER:
B2:00ACA8 D8FC              DJNZ     R0,?C0115?GPIO_DRIVER
B2:00ACAA F4                CPL      A
B2:00ACAB 526E              ANL      P2Shadow,A
  258:       P2 = P2Shadow;
B2:00ACAD 856EA0            MOV      P2,P2Shadow
  259:       break;
B2:00ACB0 22                RET      
  260:     case 3:
B2:00ACB1         ?C0053?GPIO_DRIVER:
  261:       P3Shadow &= ~(1 << portPin);
B2:00ACB1 7401              MOV      A,#01H
B2:00ACB3 A807              MOV      R0,AR7
B2:00ACB5 08                INC      R0
B2:00ACB6 8002              SJMP     ?C0118?GPIO_DRIVER
B2:00ACB8         ?C0117?GPIO_DRIVER:
B2:00ACB8 C3                CLR      C
B2:00ACB9 33                RLC      A
B2:00ACBA         ?C0118?GPIO_DRIVER:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 658


B2:00ACBA D8FC              DJNZ     R0,?C0117?GPIO_DRIVER
B2:00ACBC F4                CPL      A
B2:00ACBD 526F              ANL      P3Shadow,A
  262:       P3 = P3Shadow;
B2:00ACBF 856FB0            MOV      P3,P3Shadow
  263:       break;
  264:   }
  265:   return;
  266: }
B2:00ACC2         ?C0054?GPIO_DRIVER:
B2:00ACC2 22                RET      
----- FUNCTION _PinOff (END) -------


----- FUNCTION _ApplicationSecurityEvent (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
 1133: ApplicationSecurityEvent(
 1134:   s_application_security_event_data_t *securityEvent)
;---- Variable 'securityEvent' assigned to Register 'R1/R2/R3' ----
 1135: {
 1136:   switch (securityEvent->event)
B2:00ACC3 021FB3            LJMP     ?C?CLDPTR
 1137:   {
 1138: #ifdef APP_SUPPORTS_CLIENT_SIDE_AUTHENTICATION
 1139:     case E_APPLICATION_SECURITY_EVENT_S2_INCLUSION_REQUEST_DSK_CSA:
 1140:       {
 1141:         ZW_SetSecurityS2InclusionPublicDSK_CSA(&sCSAResponse);
 1142:       }
 1143:       break;
 1144: #endif /* APP_SUPPORTS_CLIENT_SIDE_AUTHENTICATION */
 1145: 
 1146:     default:
 1147:       break;
 1148:   }
----- FUNCTION _ApplicationSecurityEvent (END) -------


----- FUNCTION ?L?COM042B (BEGIN) -----
B2:00ACC6 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_far
B2:00ACC8 7FD9              MOV      R7,#LOW EEOFFSET_MAGIC_far
B2:00ACCA 7D56              MOV      R5,#056H
B2:00ACCC 021B7E            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION ?L?COM042B (END) -------


----- FUNCTION ?L?COM04DA (BEGIN) -----
B2:00ACCF 7D01              MOV      R5,#01H
B2:00ACD1 7F07              MOV      R7,#07H
B2:00ACD3 914B              ACALL    _Led
----- FUNCTION RefreshMMI (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
 1108: RefreshMMI(void)
 1109: {
 1110:   if (CMD_CLASS_BIN_OFF == onOffState)
 1111:   {
B2:00ACD5 903813            MOV      DPTR,#onOffState
B2:00ACD8 E0                MOVX     A,@DPTR
B2:00ACD9 7004              JNZ      ?C0114?SWITCHONOFF
 1112:     Led(ZDP03A_LED_D2,OFF);
 1113:   }
B2:00ACDB 7D01              MOV      R5,#01H
 1114:   else if (CMD_CLASS_BIN_ON == onOffState)
B2:00ACDD 8009              SJMP     ?C0146?SWITCHONOFF
B2:00ACDF         ?C0114?SWITCHONOFF:
 1115:   {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 659


B2:00ACDF 903813            MOV      DPTR,#onOffState
B2:00ACE2 E0                MOVX     A,@DPTR
B2:00ACE3 B4FF06            CJNE     A,#0FFH,?C0117?SWITCHONOFF
 1116:     Led(ZDP03A_LED_D2,ON);
 1117:   }
B2:00ACE6 E4                CLR      A
B2:00ACE7 FD                MOV      R5,A
B2:00ACE8         
B2:00ACE8 7F37              MOV      R7,#037H
B2:00ACEA 914B              ACALL    _Led
 1118: }
 1119: 
B2:00ACEC         ?C0117?SWITCHONOFF:
B2:00ACEC 22                RET      
----- FUNCTION RefreshMMI (END) -------


----- FUNCTION ?L?COM00B1 (BEGIN) -----
B2:00ACED 7B01              MOV      R3,#01H
B2:00ACEF 7A3A              MOV      R2,#HIGH pTxOptionsEx
B2:00ACF1 794D              MOV      R1,#LOW pTxOptionsEx
B2:00ACF3 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00ACF6 1225A9            LCALL    ?C?PSTXDATA
B2:00ACF9 903A43            MOV      DPTR,#rxOpt
B2:00ACFC 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _RxToTxOptions (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  380: RxToTxOptions( RECEIVE_OPTIONS_TYPE_EX *rxopt,     /* IN  receive options to convert */
  381:                TRANSMIT_OPTIONS_TYPE_SINGLE_EX** txopt)   /* OUT converted transmit options */
B2:00ACFF 90415C            MOV      DPTR,#rxopt
B2:00AD02 1225A9            LCALL    ?C?PSTXDATA
  382: {
  383:   static TRANSMIT_OPTIONS_TYPE_SINGLE_EX txOptionsEx;
  384:   static MULTICHAN_NODE_ID destNode;
  385:   txOptionsEx.pDestNode = &destNode;
B2:00AD05 7B01              MOV      R3,#01H
B2:00AD07 7A35              MOV      R2,#HIGH destNode
B2:00AD09 79F0              MOV      R1,#LOW destNode
B2:00AD0B 9035ED            MOV      DPTR,#txOptionsEx+03H
B2:00AD0E 1225A9            LCALL    ?C?PSTXDATA
  386:   *txopt = &txOptionsEx;
B2:00AD11 7A35              MOV      R2,#HIGH txOptionsEx
B2:00AD13 79EA              MOV      R1,#LOW txOptionsEx
B2:00AD15 C003              PUSH     AR3
B2:00AD17 C002              PUSH     AR2
B2:00AD19 C001              PUSH     AR1
B2:00AD1B 90415F            MOV      DPTR,#txopt
B2:00AD1E 122589            LCALL    ?C?PLDXDATA
B2:00AD21 1225DE            LCALL    ?C?PSTPTR
  387: 
  388:   destNode.node.nodeId = rxopt->sourceNode.nodeId;
B2:00AD24 90415C            MOV      DPTR,#rxopt
B2:00AD27 128F3E            LCALL    ?L?COM0029
B2:00AD2A 9035F0            MOV      DPTR,#destNode
B2:00AD2D F0                MOVX     @DPTR,A
  389:   destNode.node.endpoint = rxopt->sourceNode.endpoint;
B2:00AD2E 128CA5            LCALL    ?L?COM0080
B2:00AD31 547F              ANL      A,#07FH
B2:00AD33 FD                MOV      R5,A
B2:00AD34 9035F1            MOV      DPTR,#destNode+01H
B2:00AD37 E0                MOVX     A,@DPTR
B2:00AD38 5480              ANL      A,#080H
B2:00AD3A 4D                ORL      A,R5
B2:00AD3B F0                MOVX     @DPTR,A
  390:   destNode.nodeInfo.BitMultiChannelEncap = (rxopt->sourceNode.endpoint == 0) ? 0 : 1;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 660


B2:00AD3C ED                MOV      A,R5
B2:00AD3D 7F01              MOV      R7,#01H
B2:00AD3F 7001              JNZ      ?C0040?ZW_TRANSPORTENDPOINT
B2:00AD41 FF                MOV      R7,A
B2:00AD42         ?C0040?ZW_TRANSPORTENDPOINT:
B2:00AD42         ?C0041?ZW_TRANSPORTENDPOINT:
B2:00AD42 9035F2            MOV      DPTR,#destNode+02H
B2:00AD45 EF                MOV      A,R7
B2:00AD46 F0                MOVX     @DPTR,A
  391:   destNode.nodeInfo.security = rxopt->securityKey;
B2:00AD47 90415C            MOV      DPTR,#rxopt
B2:00AD4A 12A5A3            LCALL    ?L?COM001F
B2:00AD4D 121FF0            LCALL    ?C?CLDOPTR
B2:00AD50 FD                MOV      R5,A
B2:00AD51 9035F3            MOV      DPTR,#destNode+03H
B2:00AD54 F0                MOVX     @DPTR,A
  392: 
  393: 
  394:   txOptionsEx.txOptions = TRANSMIT_OPTION_ACK | TRANSMIT_OPTION_EXPLORE | ZWAVE_PLUS_TX_OPTIONS;
B2:00AD55 9035EA            MOV      DPTR,#txOptionsEx
B2:00AD58 7425              MOV      A,#025H
B2:00AD5A F0                MOVX     @DPTR,A
  395:   if (rxopt->rxStatus & RECEIVE_STATUS_LOW_POWER)
B2:00AD5B 121FB3            LCALL    ?C?CLDPTR
B2:00AD5E 30E107            JNB      ACC.1,?C0042?ZW_TRANSPORTENDPOINT
  396:   {
  397:       txOptionsEx.txOptions |= TRANSMIT_OPTION_LOW_POWER;
B2:00AD61 9035EA            MOV      DPTR,#txOptionsEx
B2:00AD64 E0                MOVX     A,@DPTR
B2:00AD65 4402              ORL      A,#02H
B2:00AD67 F0                MOVX     @DPTR,A
  398:   }
B2:00AD68         ?C0042?ZW_TRANSPORTENDPOINT:
  399:   txOptionsEx.sourceEndpoint = rxopt->destNode.endpoint;
B2:00AD68 90415C            MOV      DPTR,#rxopt
B2:00AD6B 313A              ACALL    ?L?COM0062
B2:00AD6D 9035EC            MOV      DPTR,#txOptionsEx+02H
B2:00AD70 F0                MOVX     @DPTR,A
  400:   txOptionsEx.txSecOptions = 0;
B2:00AD71 E4                CLR      A
B2:00AD72 9035EB            MOV      DPTR,#txOptionsEx+01H
B2:00AD75 F0                MOVX     @DPTR,A
  401:   txOptionsEx.pDestNode->nodeInfo.security = rxopt->securityKey;
B2:00AD76 9035ED            MOV      DPTR,#txOptionsEx+03H
B2:00AD79 12B57F            LCALL    ?L?COM00E6
B2:00AD7C ED                MOV      A,R5
B2:00AD7D 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _RxToTxOptions (END) -------


----- FUNCTION _ZAF_CC_MultiChannel_IsCCSupported (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMULTICHAN.C'
  231: BOOL ZAF_CC_MultiChannel_IsCCSupported(
  232:   RECEIVE_OPTIONS_TYPE_EX * pRxOpt,
B2:00AD80 903D80            MOV      DPTR,#pRxOpt
B2:00AD83 1225A9            LCALL    ?C?PSTXDATA
  233:   ZW_APPLICATION_TX_BUFFER * pCmd)
  234: {
  235:   if (0 == pRxOpt->destNode.endpoint)
B2:00AD86 903D80            MOV      DPTR,#pRxOpt
B2:00AD89 313A              ACALL    ?L?COM0062
B2:00AD8B 7017              JNZ      ?C0027?COMMANDCLASSMULTICHAN
  236:   {
  237:     return (TransportCmdClassSupported(pCmd->ZW_Common.cmdClass, pCmd->ZW_Common.cmd, pRxOpt->securityKey));
B2:00AD8D 903D83            MOV      DPTR,#pCmd
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 661


B2:00AD90 D126              ACALL    ?L?COM0049
B2:00AD92 FF                MOV      R7,A
B2:00AD93 12B3A2            LCALL    ?L?COM0182
B2:00AD96 FD                MOV      R5,A
B2:00AD97 903D80            MOV      DPTR,#pRxOpt
B2:00AD9A 12A5A3            LCALL    ?L?COM001F
B2:00AD9D 121FF0            LCALL    ?C?CLDOPTR
B2:00ADA0 FB                MOV      R3,A
B2:00ADA1 02D7CC            LJMP     _TransportCmdClassSupported
  238:   }
B2:00ADA4         ?C0027?COMMANDCLASSMULTICHAN:
  239:   else
  240:   {
  241:     CMD_CLASS_LIST* pNonSec = GetEndpointcmdClassList(FALSE, pRxOpt->destNode.endpoint);
B2:00ADA4 C24D              CLR      ?GetEndpointcmdClassList?BIT
B2:00ADA6 903D80            MOV      DPTR,#pRxOpt
B2:00ADA9 313A              ACALL    ?L?COM0062
B2:00ADAB 12DBB4            LCALL    ?L?COM05DE
B2:00ADAE 903D86            MOV      DPTR,#pNonSec
B2:00ADB1 1225A9            LCALL    ?C?PSTXDATA
  242:     CMD_CLASS_LIST* pSec    = GetEndpointcmdClassList(TRUE, pRxOpt->destNode.endpoint);
B2:00ADB4 D24D              SETB     ?GetEndpointcmdClassList?BIT
B2:00ADB6 903D80            MOV      DPTR,#pRxOpt
B2:00ADB9 313A              ACALL    ?L?COM0062
B2:00ADBB 12DBB4            LCALL    ?L?COM05DE
B2:00ADBE 903D89            MOV      DPTR,#pSec
B2:00ADC1 1225A9            LCALL    ?C?PSTXDATA
  243:     if ((NULL != pNonSec) && (NULL != pSec))
B2:00ADC4 903D86            MOV      DPTR,#pNonSec
B2:00ADC7 122589            LCALL    ?C?PLDXDATA
B2:00ADCA E9                MOV      A,R1
B2:00ADCB 4A                ORL      A,R2
B2:00ADCC 6050              JZ       ?C0029?COMMANDCLASSMULTICHAN
B2:00ADCE 903D89            MOV      DPTR,#pSec
B2:00ADD1 122589            LCALL    ?C?PLDXDATA
B2:00ADD4 E9                MOV      A,R1
B2:00ADD5 4A                ORL      A,R2
B2:00ADD6 6046              JZ       ?C0029?COMMANDCLASSMULTICHAN
  244:     {
  245:       return (CmdClassSupported(pRxOpt->securityKey,
B2:00ADD8 903D80            MOV      DPTR,#pRxOpt
B2:00ADDB 12A5A3            LCALL    ?L?COM001F
B2:00ADDE 121FF0            LCALL    ?C?CLDOPTR
B2:00ADE1 FF                MOV      R7,A
B2:00ADE2 903D83            MOV      DPTR,#pCmd
B2:00ADE5 D126              ACALL    ?L?COM0049
B2:00ADE7 12B3A1            LCALL    ?L?COM0181
B2:00ADEA FB                MOV      R3,A
B2:00ADEB C003              PUSH     AR3
B2:00ADED 903D89            MOV      DPTR,#pSec
B2:00ADF0 12B441            LCALL    ?L?COM0101
B2:00ADF3 903DEA            MOV      DPTR,#?_CmdClassSupported?BYTE+03H
B2:00ADF6 1225A9            LCALL    ?C?PSTXDATA
B2:00ADF9 903D89            MOV      DPTR,#pSec
B2:00ADFC 128CA2            LCALL    ?L?COM007F
B2:00ADFF 903DED            MOV      DPTR,#?_CmdClassSupported?BYTE+06H
B2:00AE02 F0                MOVX     @DPTR,A
B2:00AE03 903D86            MOV      DPTR,#pNonSec
B2:00AE06 12B441            LCALL    ?L?COM0101
B2:00AE09 903DEE            MOV      DPTR,#?_CmdClassSupported?BYTE+07H
B2:00AE0C 1225A9            LCALL    ?C?PSTXDATA
B2:00AE0F 903D86            MOV      DPTR,#pNonSec
B2:00AE12 128CA2            LCALL    ?L?COM007F
B2:00AE15 903DF1            MOV      DPTR,#?_CmdClassSupported?BYTE+0AH
B2:00AE18 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 662


B2:00AE19 D003              POP      AR3
B2:00AE1B 028F47            LJMP     _CmdClassSupported
  246:                                 pCmd->ZW_Common.cmdClass,
  247:                                 pCmd->ZW_Common.cmd,
  248:                                 pSec->pList, pSec->size,
  249:                                 pNonSec->pList, pNonSec->size));
  250:     }
  251:   }
B2:00AE1E         ?C0029?COMMANDCLASSMULTICHAN:
  252:   return FALSE;
B2:00AE1E C3                CLR      C
  253: }
B2:00AE1F 22                RET      
----- FUNCTION _ZAF_CC_MultiChannel_IsCCSupported (END) -------


----- FUNCTION ?L?COM0048 (BEGIN) -----
B2:00AE20 122072            LCALL    ?C?CSTPTR
B2:00AE23 9039F6            MOV      DPTR,#pProperties
B2:00AE26         ?L?COM0049:
B2:00AE26 122589            LCALL    ?C?PLDXDATA
B2:00AE29 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0048 (END) -------


----- FUNCTION _CmdClassMultiChannelEncapsulateCmd (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMULTICHAN.C'
  261: static void CmdClassMultiChannelEncapsulateCmd(
  262:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00AE2C 904004            MOV      DPTR,#rxOpt
B2:00AE2F 1225A9            LCALL    ?C?PSTXDATA
  263:   ZW_MULTI_CHANNEL_CMD_ENCAP_V2_FRAME *pCmd,
  264:   BYTE cmdLength)
  265: {
  266:   BYTE bitNo;
  267: 
  268:   //Setup source node endpoint
  269:   rxOpt->sourceNode.endpoint = pCmd->properties1;
B2:00AE32 904007            MOV      DPTR,#pCmd
B2:00AE35 128F3E            LCALL    ?L?COM0029
B2:00AE38 12DB53            LCALL    ?L?COM0527
B2:00AE3B 12707E            LCALL    ?L?COM00F2
B2:00AE3E 125510            LCALL    ?L?COM000B
B2:00AE41 5480              ANL      A,#080H
B2:00AE43 4F                ORL      A,R7
B2:00AE44 122072            LCALL    ?C?CSTPTR
  270: 
  271:   if( 0x00 == (pCmd->properties2 & 0x80))
B2:00AE47 904007            MOV      DPTR,#pCmd
B2:00AE4A 128CA2            LCALL    ?L?COM007F
B2:00AE4D FF                MOV      R7,A
B2:00AE4E 20E70E            JB       ACC.7,?C0031?COMMANDCLASSMULTICHAN
  272:   {
  273:     /*Non bit addressing */
  274:     rxOpt->destNode.endpoint = pCmd->properties2 & 0x7f;
B2:00AE51 12DB53            LCALL    ?L?COM0527
B2:00AE54 12576B            LCALL    ?L?COM0323
B2:00AE57 125510            LCALL    ?L?COM000B
B2:00AE5A 5480              ANL      A,#080H
B2:00AE5C 4F                ORL      A,R7
  275:   }
B2:00AE5D 8015              SJMP     ?C0051?COMMANDCLASSMULTICHAN
B2:00AE5F         ?C0031?COMMANDCLASSMULTICHAN:
  276:   else
  277:   {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 663


  278:     /*Bit addressing. Get is not legal why adding  RECEIVE_STATUS_TYPE_MULTI to rxStatus */
  279:     rxOpt->rxStatus |= RECEIVE_STATUS_TYPE_MULTI;
B2:00AE5F 904004            MOV      DPTR,#rxOpt
B2:00AE62 D126              ACALL    ?L?COM0049
B2:00AE64 4408              ORL      A,#08H
B2:00AE66 122072            LCALL    ?C?CSTPTR
  280:     /* Need to extract endpoint bits. Just reset it*/
  281:     rxOpt->destNode.endpoint = 0;
B2:00AE69 904004            MOV      DPTR,#rxOpt
B2:00AE6C 12576B            LCALL    ?L?COM0323
B2:00AE6F 125510            LCALL    ?L?COM000B
B2:00AE72 5480              ANL      A,#080H
B2:00AE74         
B2:00AE74 122072            LCALL    ?C?CSTPTR
  282:   }
B2:00AE77         ?C0032?COMMANDCLASSMULTICHAN:
  283: 
  284:   bitNo = 0;
B2:00AE77 E4                CLR      A
B2:00AE78 90400B            MOV      DPTR,#bitNo
B2:00AE7B F0                MOVX     @DPTR,A
B2:00AE7C         ?C0035?COMMANDCLASSMULTICHAN:
  285: 
  286:   do /*BitAdress = 0 -> run only through once*/
  287:   {
  288:     /*BitAdress = 0 -> Destination address 1-127 */
  289:     /*BitAdress = 1 -> Destination address is mask for End-point 1-7 */
  290:     if(0 == (pCmd->properties2 & 0x80))/**End-point address**/
B2:00AE7C 904007            MOV      DPTR,#pCmd
B2:00AE7F 128CA2            LCALL    ?L?COM007F
B2:00AE82 20E708            JB       ACC.7,?C0038?COMMANDCLASSMULTICHAN
  291:     {
  292:       bitNo = 7;
B2:00AE85 90400B            MOV      DPTR,#bitNo
B2:00AE88 7407              MOV      A,#07H
B2:00AE8A F0                MOVX     @DPTR,A
  293:     }
B2:00AE8B 804E              SJMP     ?C0037?COMMANDCLASSMULTICHAN
  294:     else /**End-point bit mask address**/
  295:     {
B2:00AE8D         ?C0038?COMMANDCLASSMULTICHAN:
  296:       while(0 == ((pCmd->properties2 & 0x7f) & (1<<bitNo)))/* Search through bitfied endpoint*/
B2:00AE8D 904007            MOV      DPTR,#pCmd
B2:00AE90 128CA2            LCALL    ?L?COM007F
B2:00AE93 547F              ANL      A,#07FH
B2:00AE95 FD                MOV      R5,A
B2:00AE96 7C00              MOV      R4,#00H
B2:00AE98 90400B            MOV      DPTR,#bitNo
B2:00AE9B 12BD6E            LCALL    ?L?COM017D
B2:00AE9E 8005              SJMP     ?C0049?COMMANDCLASSMULTICHAN
B2:00AEA0         ?C0048?COMMANDCLASSMULTICHAN:
B2:00AEA0 C3                CLR      C
B2:00AEA1 33                RLC      A
B2:00AEA2 CE                XCH      A,R6
B2:00AEA3 33                RLC      A
B2:00AEA4 CE                XCH      A,R6
B2:00AEA5         ?C0049?COMMANDCLASSMULTICHAN:
B2:00AEA5 D8F9              DJNZ     R0,?C0048?COMMANDCLASSMULTICHAN
B2:00AEA7 1273F1            LCALL    ?L?COM05EA
B2:00AEAA 7016              JNZ      ?C0039?COMMANDCLASSMULTICHAN
  297:       {
  298:         bitNo++;
B2:00AEAC 90400B            MOV      DPTR,#bitNo
B2:00AEAF E0                MOVX     A,@DPTR
B2:00AEB0 04                INC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 664


B2:00AEB1 F0                MOVX     @DPTR,A
  299:         /*validate bitNo is legal endpoint*/
  300:         if((7 == bitNo) || NULL == GetEndpointcmdClassList(FALSE, bitNo)){
B2:00AEB2 E0                MOVX     A,@DPTR
B2:00AEB3 FF                MOV      R7,A
B2:00AEB4 6407              XRL      A,#07H
B2:00AEB6 606B              JZ       ?C0042?COMMANDCLASSMULTICHAN
B2:00AEB8 C24D              CLR      ?GetEndpointcmdClassList?BIT
B2:00AEBA 128258            LCALL    ?L?COM0386
B2:00AEBD E9                MOV      A,R1
B2:00AEBE 4A                ORL      A,R2
B2:00AEBF 70CC              JNZ      ?C0038?COMMANDCLASSMULTICHAN
B2:00AEC1 22                RET      
  301:           return;
  302:         }
  303:       }
B2:00AEC2         ?C0039?COMMANDCLASSMULTICHAN:
  304:       rxOpt->destNode.endpoint = bitNo + 1;/*endpoint = bit x + 1*/
B2:00AEC2 90400B            MOV      DPTR,#bitNo
B2:00AEC5 E0                MOVX     A,@DPTR
B2:00AEC6 04                INC      A
B2:00AEC7 12DB53            LCALL    ?L?COM0527
B2:00AECA 12576B            LCALL    ?L?COM0323
B2:00AECD 125510            LCALL    ?L?COM000B
B2:00AED0 5480              ANL      A,#080H
B2:00AED2 4F                ORL      A,R7
B2:00AED3 122072            LCALL    ?C?CSTPTR
  305:       rxOpt->destNode.BitAddress = 1; /*Tell Command Class that it is bit-addres. Get do not support bit-address!
>> !*/
B2:00AED6 4480              ORL      A,#080H
B2:00AED8 122072            LCALL    ?C?CSTPTR
  306:     }
B2:00AEDB         ?C0037?COMMANDCLASSMULTICHAN:
  307: 
  308:     if (TRUE == ZAF_CC_MultiChannel_IsCCSupported(rxOpt, (ZW_APPLICATION_TX_BUFFER*)&pCmd->encapFrame))
B2:00AEDB 904007            MOV      DPTR,#pCmd
B2:00AEDE 125522            LCALL    ?L?COM0059
B2:00AEE1 903D83            MOV      DPTR,#?_ZAF_CC_MultiChannel_IsCCSupported?BYTE+03H
B2:00AEE4 1225A9            LCALL    ?C?PSTXDATA
B2:00AEE7 904004            MOV      DPTR,#rxOpt
B2:00AEEA 122589            LCALL    ?C?PLDXDATA
B2:00AEED B180              ACALL    _ZAF_CC_MultiChannel_IsCCSupported
B2:00AEEF 501C              JNC      ?C0043?COMMANDCLASSMULTICHAN
  309:     {
  310:       /* Command class supported */
  311:       Transport_ApplicationCommandHandlerEx(rxOpt, (ZW_APPLICATION_TX_BUFFER*)&pCmd->encapFrame, cmdLength - 4);
B2:00AEF1 904007            MOV      DPTR,#pCmd
B2:00AEF4 125522            LCALL    ?L?COM0059
B2:00AEF7 12955D            LCALL    ?L?COM050A
B2:00AEFA 90400A            MOV      DPTR,#cmdLength
B2:00AEFD E0                MOVX     A,@DPTR
B2:00AEFE 24FC              ADD      A,#0FCH
B2:00AF00 903FE2            MOV      DPTR,#?_Transport_ApplicationCommandHandlerEx?BYTE+06H
B2:00AF03 F0                MOVX     @DPTR,A
B2:00AF04 904004            MOV      DPTR,#rxOpt
B2:00AF07 122589            LCALL    ?C?PLDXDATA
B2:00AF0A 129755            LCALL    _Transport_ApplicationCommandHandlerEx
  312:     }
B2:00AF0D         ?C0043?COMMANDCLASSMULTICHAN:
  313:     if (0 == rxOpt->destNode.endpoint)
B2:00AF0D 904004            MOV      DPTR,#rxOpt
B2:00AF10 313A              ACALL    ?L?COM0062
B2:00AF12 600F              JZ       ?C0042?COMMANDCLASSMULTICHAN
  314:     {
  315:       return; /* No endpoint addressing! just return */
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 665


  316:     }
B2:00AF14         ?C0044?COMMANDCLASSMULTICHAN:
  317:   }while(7 > ++bitNo);
B2:00AF14         ?C0033?COMMANDCLASSMULTICHAN:
B2:00AF14 90400B            MOV      DPTR,#bitNo
B2:00AF17 E0                MOVX     A,@DPTR
B2:00AF18 04                INC      A
B2:00AF19 FF                MOV      R7,A
B2:00AF1A F0                MOVX     @DPTR,A
B2:00AF1B 7407              MOV      A,#07H
B2:00AF1D D3                SETB     C
B2:00AF1E 9F                SUBB     A,R7
B2:00AF1F 4002              JC       $ + 4H
B2:00AF21 C17C              AJMP     ?C0035?COMMANDCLASSMULTICHAN
  318: }
B2:00AF23         ?C0042?COMMANDCLASSMULTICHAN:
B2:00AF23 22                RET      
----- FUNCTION _CmdClassMultiChannelEncapsulateCmd (END) -------


----- FUNCTION _AssociationRemove (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  232: BOOL AssociationRemove(
  233:   uint8_t groupId,
B2:00AF24 903AC3            MOV      DPTR,#groupId
B2:00AF27 124765            LCALL    ?L?COM0102
B2:00AF2A 1225A9            LCALL    ?C?PSTXDATA
  234:   uint8_t ep,
  235:   ZW_MULTI_CHANNEL_ASSOCIATION_REMOVE_1BYTE_V2_FRAME* pCmd,
  236:   uint8_t cmdLength)
  237: {
  238:   uint8_t i;
  239:   uint8_t j;
  240:   uint8_t * pCmdByteWise = (uint8_t *)pCmd;
B2:00AF2D 903ACB            MOV      DPTR,#pCmdByteWise
B2:00AF30 1225A9            LCALL    ?C?PSTXDATA
  241:   ASSOCIATION_NODE_LIST list;
  242:   uint8_t maxNumberOfGroups;
  243: 
  244:   /*Only setup lifeline for rootdevice*/
  245:   if ((NUMBER_OF_ENDPOINTS + 1) < ep || ((1 == groupId) && (0 < ep)))
B2:00AF33 903AC4            MOV      DPTR,#ep
B2:00AF36 12817D            LCALL    ?L?COM0458
B2:00AF39 400C              JC       ?C0027?ASSOCIATION_PLUS
B2:00AF3B 903AC3            MOV      DPTR,#groupId
B2:00AF3E E0                MOVX     A,@DPTR
B2:00AF3F B40107            CJNE     A,#01H,?C0026?ASSOCIATION_PLUS
B2:00AF42 E4                CLR      A
B2:00AF43 C3                CLR      C
B2:00AF44 9F                SUBB     A,R7
B2:00AF45 5002              JNC      ?C0026?ASSOCIATION_PLUS
B2:00AF47         ?C0027?ASSOCIATION_PLUS:
  246:   {
  247:     return FALSE;
B2:00AF47 C3                CLR      C
B2:00AF48 22                RET      
  248:   }
B2:00AF49         ?C0026?ASSOCIATION_PLUS:
  249: 
  250:   maxNumberOfGroups = CC_AGI_groupCount_handler(ep);
B2:00AF49 903AC4            MOV      DPTR,#ep
B2:00AF4C E0                MOVX     A,@DPTR
B2:00AF4D FF                MOV      R7,A
B2:00AF4E 12B595            LCALL    ?L?COM0598
  251: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 666


  252:   if ((0 < groupId) && (maxNumberOfGroups >= groupId))
B2:00AF51 903AC3            MOV      DPTR,#groupId
B2:00AF54 E0                MOVX     A,@DPTR
B2:00AF55 FF                MOV      R7,A
B2:00AF56 E4                CLR      A
B2:00AF57 C3                CLR      C
B2:00AF58 9F                SUBB     A,R7
B2:00AF59 4003              JC       $ + 5H
B2:00AF5B 02B00E            LJMP     ?C0029?ASSOCIATION_PLUS
B2:00AF5E 903AD6            MOV      DPTR,#maxNumberOfGroups
B2:00AF61 E0                MOVX     A,@DPTR
B2:00AF62 C3                CLR      C
B2:00AF63 9F                SUBB     A,R7
B2:00AF64 5003              JNC      $ + 5H
B2:00AF66 02B00E            LJMP     ?C0029?ASSOCIATION_PLUS
  253:   {
  254:     AssGroupMappingLookUp(&ep, &groupId);
B2:00AF69 7B01              MOV      R3,#01H
B2:00AF6B 7A3A              MOV      R2,#HIGH groupId
B2:00AF6D 79C3              MOV      R1,#LOW groupId
B2:00AF6F 12D9F6            LCALL    ?L?COM038B
B2:00AF72 7A3A              MOV      R2,#HIGH ep
B2:00AF74 09                INC      R1
B2:00AF75 12C501            LCALL    _AssGroupMappingLookUp
  255: 
  256:     if ((3 == cmdLength) || ((4 == cmdLength) && (0x00 == *(pCmdByteWise + 3))))
B2:00AF78 903AC8            MOV      DPTR,#cmdLength
B2:00AF7B E0                MOVX     A,@DPTR
B2:00AF7C FF                MOV      R7,A
B2:00AF7D 6403              XRL      A,#03H
B2:00AF7F 6010              JZ       ?C0031?ASSOCIATION_PLUS
B2:00AF81 EF                MOV      A,R7
B2:00AF82 6404              XRL      A,#04H
B2:00AF84 706A              JNZ      ?C0030?ASSOCIATION_PLUS
B2:00AF86 903ACB            MOV      DPTR,#pCmdByteWise
B2:00AF89 12707E            LCALL    ?L?COM00F2
B2:00AF8C 125510            LCALL    ?L?COM000B
B2:00AF8F 705F              JNZ      ?C0030?ASSOCIATION_PLUS
B2:00AF91         ?C0031?ASSOCIATION_PLUS:
  257:     {
  258:       /*
  259:        * The command is either [Class, Command, GroupID] or [Class, Command, GroupID, Marker].
  260:        * In either case, we delete all nodes in the given group.
  261:        */
  262:       for (i = 0; i < MAX_ASSOCIATION_IN_GROUP; i++)
B2:00AF91 E4                CLR      A
B2:00AF92 903AC9            MOV      DPTR,#i
B2:00AF95 F0                MOVX     @DPTR,A
B2:00AF96         ?C0032?ASSOCIATION_PLUS:
B2:00AF96 903AC9            MOV      DPTR,#i
B2:00AF99 E0                MOVX     A,@DPTR
B2:00AF9A FF                MOV      R7,A
B2:00AF9B C3                CLR      C
B2:00AF9C 9405              SUBB     A,#05H
B2:00AF9E 4003              JC       $ + 5H
B2:00AFA0 02B062            LJMP     ?C0145?ASSOCIATION_PLUS
  263:       {
  264:         /*
  265:          * The node can only be deleted according to the following truth table.
  266:          * CCA   = Command Class Association Remove Command
  267:          * CCMCA = Command Class Multi Channel Association Remove Command
  268:          * MC    = Multi Channel associated node
  269:          * T     = TRUE
  270:          * F     = FALSE
  271:          *      | CCA | CCMCA |
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 667


  272:          * --------------------
  273:          * MC=T |  V  |   V   |
  274:          * --------------------
  275:          * MC=F |  %  |   V   |
  276:          * --------------------
  277:          */
  278:         if (!((COMMAND_CLASS_ASSOCIATION == *pCmdByteWise) && (TRUE == groups[ep][groupId-1].subGrp[i].nodeInfo.B
>> itMultiChannelEncap)))
B2:00AFA3 903ACB            MOV      DPTR,#pCmdByteWise
B2:00AFA6 D126              ACALL    ?L?COM0049
B2:00AFA8 B4851E            CJNE     A,#085H,?C0036?ASSOCIATION_PLUS
B2:00AFAB 903AC4            MOV      DPTR,#ep
B2:00AFAE E0                MOVX     A,@DPTR
B2:00AFAF 12D94C            LCALL    ?L?COM01F7
B2:00AFB2 C083              PUSH     DPH
B2:00AFB4 C082              PUSH     DPL
B2:00AFB6 903AC3            MOV      DPTR,#groupId
B2:00AFB9 E0                MOVX     A,@DPTR
B2:00AFBA D082              POP      DPL
B2:00AFBC D083              POP      DPH
B2:00AFBE 1285D7            LCALL    ?L?COM018E
B2:00AFC1 12C636            LCALL    ?L?COM0324
B2:00AFC4 E0                MOVX     A,@DPTR
B2:00AFC5 6401              XRL      A,#01H
B2:00AFC7 601F              JZ       ?C0034?ASSOCIATION_PLUS
B2:00AFC9         ?C0036?ASSOCIATION_PLUS:
  279:         {
  280:           memset((uint8_t*)&groups[ep][groupId-1].subGrp[i], 0, sizeof(MULTICHAN_NODE_ID));
B2:00AFC9 903AC4            MOV      DPTR,#ep
B2:00AFCC 12D91B            LCALL    ?L?COM018A
B2:00AFCF 903AC3            MOV      DPTR,#groupId
B2:00AFD2 E0                MOVX     A,@DPTR
B2:00AFD3 75F014            MOV      B,#014H
B2:00AFD6 1282DD            LCALL    ?L?COM0037
B2:00AFD9 FA                MOV      R2,A
B2:00AFDA 903AC9            MOV      DPTR,#i
B2:00AFDD 1282D9            LCALL    ?L?COM0035
B2:00AFE0 FA                MOV      R2,A
B2:00AFE1 7D04              MOV      R5,#04H
B2:00AFE3 E4                CLR      A
B2:00AFE4 FF                MOV      R7,A
B2:00AFE5 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
  281:         }
  282:       }
B2:00AFE8         ?C0034?ASSOCIATION_PLUS:
B2:00AFE8 903AC9            MOV      DPTR,#i
B2:00AFEB E0                MOVX     A,@DPTR
B2:00AFEC 04                INC      A
B2:00AFED F0                MOVX     @DPTR,A
B2:00AFEE 80A6              SJMP     ?C0032?ASSOCIATION_PLUS
  283:     }
B2:00AFF0         ?C0030?ASSOCIATION_PLUS:
  284:     else
  285:     {
  286:       // If this is the case, the command must be [Class, Command, GroupID, i3, i4, i5, ...].
  287:       ExtractCmdClassNodeList(&list,(ZW_MULTI_CHANNEL_ASSOCIATION_SET_1BYTE_V2_FRAME*) pCmd, cmdLength, NULL);
B2:00AFF0 12B285            LCALL    ?L?COM0067
B2:00AFF3 12B185            LCALL    ?L?COM0452
  288:       RemoveAssociationsFromGroup(*pCmdByteWise, ep, groupId, &list);
B2:00AFF6 903ACB            MOV      DPTR,#pCmdByteWise
B2:00AFF9 D126              ACALL    ?L?COM0049
B2:00AFFB FF                MOV      R7,A
B2:00AFFC 903AC4            MOV      DPTR,#ep
B2:00AFFF E0                MOVX     A,@DPTR
B2:00B000 FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 668


B2:00B001 12B0EE            LCALL    ?L?COM045F
B2:00B004 903AC3            MOV      DPTR,#groupId
B2:00B007 E0                MOVX     A,@DPTR
B2:00B008 FB                MOV      R3,A
B2:00B009 128425            LCALL    _RemoveAssociationsFromGroup
  289:     }
B2:00B00C         ?C0037?ASSOCIATION_PLUS:
  290:     AssociationStoreAll();
  291:   }
B2:00B00C 8054              SJMP     ?C0145?ASSOCIATION_PLUS
B2:00B00E         ?C0029?ASSOCIATION_PLUS:
  292:   else if (0 == groupId)
B2:00B00E 903AC3            MOV      DPTR,#groupId
B2:00B011 E0                MOVX     A,@DPTR
B2:00B012 7052              JNZ      ?C0039?ASSOCIATION_PLUS
  293:   {
  294:     /*
  295:      * When the group ID equals zero, it is desired to remove all nodes from all groups or given
  296:      * nodes from all groups.
  297:      * If the length is larger than 3, it means that only given nodes must be removed from all
  298:      * groups.
  299:      */
  300:     ExtractCmdClassNodeList(&list,(ZW_MULTI_CHANNEL_ASSOCIATION_SET_1BYTE_V2_FRAME*) pCmd, cmdLength, NULL);
B2:00B014 5185              ACALL    ?L?COM0067
B2:00B016 3185              ACALL    ?L?COM0452
  301: 
  302:     for (ep = 0; ep < NUMBER_OF_ENDPOINTS + 1; ep++)
B2:00B018 E4                CLR      A
B2:00B019 903AC4            MOV      DPTR,#ep
B2:00B01C F0                MOVX     @DPTR,A
B2:00B01D         ?C0040?ASSOCIATION_PLUS:
B2:00B01D 903AC4            MOV      DPTR,#ep
B2:00B020 E0                MOVX     A,@DPTR
B2:00B021 FF                MOV      R7,A
B2:00B022 C3                CLR      C
B2:00B023 9401              SUBB     A,#01H
B2:00B025 503B              JNC      ?C0041?ASSOCIATION_PLUS
  303:     {
  304:       maxNumberOfGroups = CC_AGI_groupCount_handler(ep);
B2:00B027 B195              ACALL    ?L?COM0598
  305:       for (j = 1; j <= maxNumberOfGroups; j++)
B2:00B029 903ACA            MOV      DPTR,#j
B2:00B02C 7401              MOV      A,#01H
B2:00B02E F0                MOVX     @DPTR,A
B2:00B02F         ?C0043?ASSOCIATION_PLUS:
B2:00B02F 903AD6            MOV      DPTR,#maxNumberOfGroups
B2:00B032 E0                MOVX     A,@DPTR
B2:00B033 FF                MOV      R7,A
B2:00B034 903ACA            MOV      DPTR,#j
B2:00B037 E0                MOVX     A,@DPTR
B2:00B038 FE                MOV      R6,A
B2:00B039 D3                SETB     C
B2:00B03A 9F                SUBB     A,R7
B2:00B03B 501D              JNC      ?C0042?ASSOCIATION_PLUS
  306:       {
  307:         RemoveAssociationsFromGroup(*pCmdByteWise, ep, j, &list);
B2:00B03D A3                INC      DPTR
B2:00B03E 12AE26            LCALL    ?L?COM0049
B2:00B041 FF                MOV      R7,A
B2:00B042 903AC4            MOV      DPTR,#ep
B2:00B045 E0                MOVX     A,@DPTR
B2:00B046 FD                MOV      R5,A
B2:00B047 AB06              MOV      R3,AR6
B2:00B049 C003              PUSH     AR3
B2:00B04B 11EE              ACALL    ?L?COM045F
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 669


B2:00B04D D003              POP      AR3
B2:00B04F 128425            LCALL    _RemoveAssociationsFromGroup
  308:       }
B2:00B052 903ACA            MOV      DPTR,#j
B2:00B055 E0                MOVX     A,@DPTR
B2:00B056 04                INC      A
B2:00B057 F0                MOVX     @DPTR,A
B2:00B058 80D5              SJMP     ?C0043?ASSOCIATION_PLUS
  309:     }
B2:00B05A         ?C0042?ASSOCIATION_PLUS:
B2:00B05A 903AC4            MOV      DPTR,#ep
B2:00B05D E0                MOVX     A,@DPTR
B2:00B05E 04                INC      A
B2:00B05F F0                MOVX     @DPTR,A
B2:00B060 80BB              SJMP     ?C0040?ASSOCIATION_PLUS
B2:00B062         ?C0041?ASSOCIATION_PLUS:
  310:     AssociationStoreAll();
B2:00B062         
B2:00B062 3128              ACALL    AssociationStoreAll
  311:   }
B2:00B064 8002              SJMP     ?C0038?ASSOCIATION_PLUS
B2:00B066         ?C0039?ASSOCIATION_PLUS:
  312:   else
  313:   {
  314:     return FALSE;
B2:00B066 C3                CLR      C
B2:00B067 22                RET      
  315:   }
B2:00B068         ?C0038?ASSOCIATION_PLUS:
  316:   return TRUE;
B2:00B068 D3                SETB     C
  317: }
B2:00B069 22                RET      
----- FUNCTION _AssociationRemove (END) -------


----- FUNCTION _ZCB_DeviceResetLocallyDone (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  765: PCB(ZCB_DeviceResetLocallyDone)(TRANSMISSION_RESULT * pTransmissionResult)
  766: {
;---- Variable 'pTransmissionResult' assigned to Register 'R1/R2/R3' ----
  767:   if (TRANSMISSION_RESULT_FINISHED == pTransmissionResult->isFinished)
  768:   {
B2:00B06A E9                MOV      A,R1
B2:00B06B 2402              ADD      A,#02H
B2:00B06D 125510            LCALL    ?L?COM000B
B2:00B070 B40105            CJNE     A,#01H,?C0077?SWITCHONOFF
  769:     ZW_DEBUG_MYPRODUCT_SEND_NL();
  770:     ZW_DEBUG_MYPRODUCT_SEND_STR("DRLD");
  771: 
  772:     ZCB_eventSchedulerEventAdd((EVENT_APP) EVENT_SYSTEM_WATCHDOG_RESET);
B2:00B073 7F34              MOV      R7,#034H
B2:00B075 12A99B            LCALL    _ZCB_eventSchedulerEventAdd
  773:   }
  774: }
B2:00B078         ?C0077?SWITCHONOFF:
B2:00B078 22                RET      
----- FUNCTION _ZCB_DeviceResetLocallyDone (END) -------


----- FUNCTION ZCB_ResetDelay (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  779: PCB(ZCB_ResetDelay)(void)
  780: {
  781:   AGI_PROFILE lifelineProfile = {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 670


  782:       ASSOCIATION_GROUP_INFO_REPORT_PROFILE_GENERAL,
B2:00B079 7862              MOV      R0,#LOW lifelineProfile
B2:00B07B 7C43              MOV      R4,#HIGH lifelineProfile
B2:00B07D 7A31              MOV      R2,#HIGH _?ix1000
B2:00B07F 79BB              MOV      R1,#LOW _?ix1000
B2:00B081 12C487            LCALL    ?L?COM0166
  783:       ASSOCIATION_GROUP_INFO_REPORT_PROFILE_GENERAL_LIFELINE
  784:   };
  785:   ZW_DEBUG_MYPRODUCT_SEND_NL();
  786:   ZW_DEBUG_MYPRODUCT_SEND_STR("Call locally reset");
  787: 
  788:   handleCommandClassDeviceResetLocally(&lifelineProfile, ZCB_DeviceResetLocallyDone);
B2:00B084 7B01              MOV      R3,#01H
B2:00B086 7A43              MOV      R2,#HIGH lifelineProfile
B2:00B088 7962              MOV      R1,#LOW lifelineProfile
B2:00B08A 7C1D              MOV      R4,#HIGH ?INTERBANK_TABLE?_ZCB_DeviceResetLocallyDone
B2:00B08C 7DF9              MOV      R5,#LOW ?INTERBANK_TABLE?_ZCB_DeviceResetLocallyDone
B2:00B08E 0296AB            LJMP     _CC_DeviceResetLocally_notification_tx
----- FUNCTION ZCB_ResetDelay (END) -------


----- FUNCTION _ZCB_OTAFinish (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  800: PCB(ZCB_OTAFinish)(OTA_STATUS otaStatus)
  801: {
B2:00B091 9043A2            MOV      DPTR,#otaStatus
B2:00B094 EF                MOV      A,R7
B2:00B095 F0                MOVX     @DPTR,A
  802:   UNUSED(otaStatus);
  803:   if (STATE_APP_OTA_HOST == GetAppState())
  804:   {
B2:00B096 12AB48            LCALL    GetAppState
B2:00B099 BF050B            CJNE     R7,#05H,?C0079?SWITCHONOFF
  805:     ChangeState(STATE_APP_IDLE);
  806:     if (userReboot)
B2:00B09C 7F01              MOV      R7,#01H
B2:00B09E 12AB3F            LCALL    _ChangeState
  807:     {
B2:00B0A1 303B03            JNB      userReboot,?C0079?SWITCHONOFF
  808:       userReboot = FALSE;
  809:       return;
B2:00B0A4 C23B              CLR      userReboot
B2:00B0A6 22                RET      
  810:     }
  811:   }
B2:00B0A7         ?C0079?SWITCHONOFF:
  812:   if (OTA_STATUS_DONE == otaStatus)
B2:00B0A7 9043A2            MOV      DPTR,#otaStatus
B2:00B0AA E0                MOVX     A,@DPTR
B2:00B0AB 7005              JNZ      ?C0081?SWITCHONOFF
  813:   {
  814:   /*Just reboot node to cleanup and start on new FW.*/
  815:     ZW_WatchDogEnable(); /*reset asic*/
B2:00B0AD 123FF9            LCALL    ZW_WatchDogEnable
B2:00B0B0         ?C0083?SWITCHONOFF:
  816:     while(1);
B2:00B0B0 80FE              SJMP     ?C0083?SWITCHONOFF
  817:   }
  818: }
B2:00B0B2         ?C0081?SWITCHONOFF:
B2:00B0B2 22                RET      
----- FUNCTION _ZCB_OTAFinish (END) -------


----- FUNCTION ZCB_OTAStart (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 671


 FILE: 'SWITCHONOFF.C'
  831: ZCB_OTAStart(void)
  832: {
  833:   BOOL  status = FALSE;
  834:   if (STATE_APP_IDLE == GetAppState())
B2:00B0B3 C23A              CLR      status
  835:   {
B2:00B0B5 12AB48            LCALL    GetAppState
B2:00B0B8 BF0102            CJNE     R7,#01H,?C0085?SWITCHONOFF
  836:     status = TRUE;
  837:   }
B2:00B0BB D23A              SETB     status
  838:   return status;
B2:00B0BD         ?C0085?SWITCHONOFF:
  839: }
B2:00B0BD A23A              MOV      C,status
  840: 
B2:00B0BF 22                RET      
----- FUNCTION ZCB_OTAStart (END) -------


----- FUNCTION _ZCB_OTAWrite (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  847: PCB(ZCB_OTAWrite)(BYTE *pData, BYTE len)
  848: {
B2:00B0C0 9043A3            MOV      DPTR,#len
B2:00B0C3 ED                MOV      A,R5
B2:00B0C4 F0                MOVX     @DPTR,A
  849:   static WORD adr = 0;
  850:   UNUSED(pData);
  851:   if (STATE_APP_IDLE == GetAppState())
B2:00B0C5 12AB48            LCALL    GetAppState
B2:00B0C8 BF0105            CJNE     R7,#01H,?C0087?SWITCHONOFF
  852:   {
  853:     ZW_DEBUG_MYPRODUCT_SEND_NL();
  854:     ZW_DEBUG_MYPRODUCT_SEND_STR("STATE_APP_OTA_HOST");
  855: 
  856:     ChangeState(STATE_APP_OTA_HOST);
B2:00B0CB 7F05              MOV      R7,#05H
B2:00B0CD 12AB3F            LCALL    _ChangeState
  857:   }
B2:00B0D0         ?C0087?SWITCHONOFF:
  858:   if (len)
B2:00B0D0 9043A3            MOV      DPTR,#len
B2:00B0D3 E0                MOVX     A,@DPTR
B2:00B0D4 FF                MOV      R7,A
B2:00B0D5 6012              JZ       ?C0088?SWITCHONOFF
  859:   {
  860:     ZW_DEBUG_MYPRODUCT_SEND_STR("W ADR: 0x");
  861:     ZW_DEBUG_MYPRODUCT_SEND_NUM((BYTE)(adr>>8) & 0xFF);
  862:     ZW_DEBUG_MYPRODUCT_SEND_NUM((BYTE)(adr & 0x00FF));
  863:     ZW_DEBUG_MYPRODUCT_SEND_STR(" L: 0x");
  864:     ZW_DEBUG_MYPRODUCT_SEND_NUM(len);
  865:     ZW_DEBUG_MYPRODUCT_SEND_BYTE(':');
  866: 
  867:     adr += len;
B2:00B0D7 903811            MOV      DPTR,#adr
B2:00B0DA 126DED            LCALL    ?L?COM0518
B2:00B0DD         ?C0089?SWITCHONOFF:
  868:     while(--len)
B2:00B0DD 9043A3            MOV      DPTR,#len
B2:00B0E0 E0                MOVX     A,@DPTR
B2:00B0E1 14                DEC      A
B2:00B0E2 F0                MOVX     @DPTR,A
B2:00B0E3 70F8              JNZ      ?C0089?SWITCHONOFF
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 672


  869:     {
  870:       ZW_DEBUG_MYPRODUCT_SEND_NUM(*pData++);
  871:     }
B2:00B0E5         ?C0090?SWITCHONOFF:
  872:     ZW_DEBUG_MYPRODUCT_SEND_NL();
  873:     // set event write finish
  874:     ZCB_eventSchedulerEventAdd(EVENT_APP_OTA_HOST_WRITE_DONE);
B2:00B0E5 7F73              MOV      R7,#073H
  875: 
  876:   }
B2:00B0E7 8002              SJMP     ?C0144?SWITCHONOFF
B2:00B0E9         ?C0088?SWITCHONOFF:
  877:   else
  878:   {
  879:     // set event ota host status
  880:     ZCB_eventSchedulerEventAdd(EVENT_APP_OTA_HOST_STATUS);
B2:00B0E9 7F74              MOV      R7,#074H
B2:00B0EB         
B2:00B0EB 02A99B            LJMP     _ZCB_eventSchedulerEventAdd
  881:   }
  882: 
----- FUNCTION _ZCB_OTAWrite (END) -------


----- FUNCTION ?L?COM045F (BEGIN) -----
B2:00B0EE 7B01              MOV      R3,#01H
B2:00B0F0 7A3A              MOV      R2,#HIGH list
B2:00B0F2 79CE              MOV      R1,#LOW list
B2:00B0F4 903FEF            MOV      DPTR,#?_RemoveAssociationsFromGroup?BYTE+03H
B2:00B0F7 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM045F (END) -------


----- FUNCTION _handleBasicSetCommand (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  895: handleBasicSetCommand(BYTE val, BYTE endpoint )
  896: {
;---- Variable 'endpoint' assigned to Register 'R5' ----
;---- Variable 'val' assigned to Register 'R7' ----
B2:;----                  JMP      _CommandClassBinarySwitchSupportSet
  897:   CommandClassBinarySwitchSupportSet(val, endpoint);
----- FUNCTION _handleBasicSetCommand (END) -------


----- FUNCTION _CommandClassBinarySwitchSupportSet (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSBINARYSWITCH.C'
   97: void CommandClassBinarySwitchSupportSet(
   98:     BYTE val,
B2:00B0FA 90436B            MOV      DPTR,#endpoint
B2:00B0FD ED                MOV      A,R5
B2:00B0FE F0                MOVX     @DPTR,A
B2:00B0FF 90436A            MOV      DPTR,#val
B2:00B102 EF                MOV      A,R7
B2:00B103 F0                MOVX     @DPTR,A
   99:     BYTE endpoint)
  100: {
  101:   if (val == 0)
B2:00B104 7007              JNZ      ?C0009?COMMANDCLASSBINARYSWITCH
  102:   {
  103:     handleApplBinarySwitchSet(CMD_CLASS_BIN_OFF,  endpoint );
B2:00B106 A3                INC      DPTR
B2:00B107 E0                MOVX     A,@DPTR
B2:00B108 FD                MOV      R5,A
B2:00B109 E4                CLR      A
B2:00B10A FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 673


  104:   }
B2:00B10B 8015              SJMP     ?C0015?COMMANDCLASSBINARYSWITCH
B2:00B10D         ?C0009?COMMANDCLASSBINARYSWITCH:
  105: 
  106:   else if ((val < 0x64) ||
B2:00B10D 90436A            MOV      DPTR,#val
B2:00B110 E0                MOVX     A,@DPTR
B2:00B111 FF                MOV      R7,A
B2:00B112 C3                CLR      C
B2:00B113 9464              SUBB     A,#064H
B2:00B115 4004              JC       ?C0012?COMMANDCLASSBINARYSWITCH
B2:00B117 EF                MOV      A,R7
B2:00B118 B4FF09            CJNE     A,#0FFH,?C0013?COMMANDCLASSBINARYSWITCH
B2:00B11B         ?C0012?COMMANDCLASSBINARYSWITCH:
  107:            (val == 0xff))
  108:   {
  109:     handleApplBinarySwitchSet(CMD_CLASS_BIN_ON, endpoint );
B2:00B11B 90436B            MOV      DPTR,#endpoint
B2:00B11E E0                MOVX     A,@DPTR
B2:00B11F FD                MOV      R5,A
B2:00B120 7FFF              MOV      R7,#0FFH
B2:00B122         
B2:00B122 B1AE              ACALL    _handleApplBinarySwitchSet
  110:   }
  111: }
B2:00B124         ?C0013?COMMANDCLASSBINARYSWITCH:
B2:00B124 22                RET      
----- FUNCTION _CommandClassBinarySwitchSupportSet (END) -------


----- FUNCTION _getAppBasicReportDuration (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  927: getAppBasicReportDuration( BYTE endpoint )
  928: {
  929:   UNUSED(endpoint);
  930:   return 0;
  931: }
B2:00B125 7F00              MOV      R7,#00H
  932: 
B2:00B127 22                RET      
----- FUNCTION _getAppBasicReportDuration (END) -------


----- FUNCTION AssociationStoreAll (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  463: AssociationStoreAll(void)
  464: {
  465:   NVM_Action(WRITE_DATA);
  466: }
B2:00B128 7F01              MOV      R7,#01H
B2:00B12A 028689            LJMP     _NVM_Action
----- FUNCTION AssociationStoreAll (END) -------


----- FUNCTION ?L?COM052C (BEGIN) -----
B2:00B12D 122084            LCALL    ?C?CSTOPTR
----- FUNCTION CC_Version_getNumberOfFirmwareTargets_handler (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  936: uint8_t handleNbrFirmwareVersions()
  937: {
  938:   return 1; /*CHANGE THIS - firmware 0 version*/
  939: }
B2:00B130 7F01              MOV      R7,#01H
  940: 
B2:00B132 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 674


----- FUNCTION CC_Version_getNumberOfFirmwareTargets_handler (END) -------


----- FUNCTION _CC_Version_GetFirmwareVersion_handler (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  948:         VG_VERSION_REPORT_V2_VG* pVariantgroup)
  949: {
B2:00B133 904306            MOV      DPTR,#pVariantgroup
B2:00B136 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'bFirmwareNumber' assigned to Register 'R7' ----
  950:   /*firmware 0 version and sub version*/
  951:   if(bFirmwareNumber == 0)
B2:00B139 EF                MOV      A,R7
B2:00B13A 904306            MOV      DPTR,#pVariantgroup
B2:00B13D 700C              JNZ      ?C0098?SWITCHONOFF
  952:   {
  953:     pVariantgroup->firmwareVersion = APP_VERSION;
B2:00B13F 12739B            LCALL    ?L?COM0599
  954:     pVariantgroup->firmwareSubVersion = APP_REVISION;
B2:00B142 904306            MOV      DPTR,#pVariantgroup
B2:00B145 317A              ACALL    ?L?COM0054
B2:00B147 7405              MOV      A,#05H
  955:   }
B2:00B149 8009              SJMP     ?C0145?SWITCHONOFF
B2:00B14B         ?C0098?SWITCHONOFF:
  956:   else
  957:   {
  958:     /*Just set it to 0 if firmware n is not present*/
  959:     pVariantgroup->firmwareVersion = 0;
B2:00B14B 127111            LCALL    ?L?COM0287
  960:     pVariantgroup->firmwareSubVersion = 0;
B2:00B14E 904306            MOV      DPTR,#pVariantgroup
B2:00B151 317A              ACALL    ?L?COM0054
B2:00B153 E4                CLR      A
B2:00B154         
B2:00B154 022072            LJMP     ?C?CSTPTR
  961:   }
----- FUNCTION _CC_Version_GetFirmwareVersion_handler (END) -------


----- FUNCTION ?L?COM0053 (BEGIN) -----
B2:00B157 7B01              MOV      R3,#01H
B2:00B159 7A3C              MOV      R2,#HIGH pTxOptionsEx
B2:00B15B 79E8              MOV      R1,#LOW pTxOptionsEx
B2:00B15D 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00B160 1225A9            LCALL    ?C?PSTXDATA
B2:00B163 903CDE            MOV      DPTR,#rxOpt
B2:00B166 122589            LCALL    ?C?PLDXDATA
B2:00B169 12ACFF            LCALL    _RxToTxOptions
B2:00B16C 903CE5            MOV      DPTR,#pTxBuf
B2:00B16F 122589            LCALL    ?C?PLDXDATA
B2:00B172 7473              MOV      A,#073H
B2:00B174 122072            LCALL    ?C?CSTPTR
B2:00B177 903CE5            MOV      DPTR,#pTxBuf
B2:00B17A         ?L?COM0054:
B2:00B17A 122589            LCALL    ?C?PLDXDATA
B2:00B17D E9                MOV      A,R1
B2:00B17E 2401              ADD      A,#01H
B2:00B180 F9                MOV      R1,A
B2:00B181 E4                CLR      A
B2:00B182 3A                ADDC     A,R2
B2:00B183 FA                MOV      R2,A
B2:00B184 22                RET      
----- FUNCTION ?L?COM0053 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 675



----- FUNCTION ?L?COM0452 (BEGIN) -----
B2:00B185 A3                INC      DPTR
B2:00B186 1225A9            LCALL    ?C?PSTXDATA
B2:00B189 0B                INC      R3
B2:00B18A 7A3A              MOV      R2,#HIGH list
B2:00B18C 79CE              MOV      R1,#LOW list
----- FUNCTION _ExtractCmdClassNodeList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  573: ExtractCmdClassNodeList(
  574:     ASSOCIATION_NODE_LIST* plist,
B2:00B18E 903CC4            MOV      DPTR,#plist
B2:00B191 1225A9            LCALL    ?C?PSTXDATA
  575:     ZW_MULTI_CHANNEL_ASSOCIATION_SET_1BYTE_V2_FRAME* pCmd,
  576:     BYTE cmdLength,
  577:     BYTE* pMultiChannelAssociation)
  578: {
  579:   uint8_t i = 0;
;---- Variable 'i' assigned to Register 'R7' ----
B2:00B194 E4                CLR      A
B2:00B195 FF                MOV      R7,A
  580:   uint8_t * pNodeId = NULL;
B2:00B196 FB                MOV      R3,A
B2:00B197 FA                MOV      R2,A
B2:00B198 F9                MOV      R1,A
B2:00B199 903CCE            MOV      DPTR,#pNodeId
B2:00B19C 1225A9            LCALL    ?C?PSTXDATA
  581: 
  582:   plist->pNodeId = &pCmd->nodeId1;
B2:00B19F 903CC7            MOV      DPTR,#pCmd
B2:00B1A2 517A              ACALL    ?L?COM0088
B2:00B1A4 C003              PUSH     AR3
B2:00B1A6 C002              PUSH     AR2
B2:00B1A8 C001              PUSH     AR1
B2:00B1AA 903CC4            MOV      DPTR,#plist
B2:00B1AD 122589            LCALL    ?C?PLDXDATA
B2:00B1B0 1225DE            LCALL    ?C?PSTPTR
  583:   plist->noOfNodes  = 0;
B2:00B1B3 5177              ACALL    ?L?COM0087
B2:00B1B5 E4                CLR      A
B2:00B1B6 122072            LCALL    ?C?CSTPTR
  584:   plist->pMulChanNodeId = NULL;
B2:00B1B9 FB                MOV      R3,A
B2:00B1BA FA                MOV      R2,A
B2:00B1BB F9                MOV      R1,A
B2:00B1BC C003              PUSH     AR3
B2:00B1BE C002              PUSH     AR2
B2:00B1C0 C001              PUSH     AR1
B2:00B1C2 903CC4            MOV      DPTR,#plist
B2:00B1C5 125522            LCALL    ?L?COM0059
B2:00B1C8 1225DE            LCALL    ?C?PSTPTR
  585:   plist->noOfMulchanNodes = 0;
B2:00B1CB 903CC4            MOV      DPTR,#plist
B2:00B1CE 127077            LCALL    ?L?COM00E7
B2:00B1D1 F9                MOV      R1,A
B2:00B1D2 E4                CLR      A
B2:00B1D3 125765            LCALL    ?L?COM01E3
  586: 
  587:   if (3 >= cmdLength)
B2:00B1D6 903CCA            MOV      DPTR,#cmdLength
B2:00B1D9 E0                MOVX     A,@DPTR
B2:00B1DA FE                MOV      R6,A
B2:00B1DB 7403              MOV      A,#03H
B2:00B1DD C3                CLR      C
B2:00B1DE 9E                SUBB     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 676


B2:00B1DF 4012              JC       ?C0111?ASSOCIATION_PLUS
  588:   {
  589:     /*
  590:      * If the length is less than or equal to three, it means that it's a get or a remove. In the
  591:      * first case we shouldn't end up here. In the second case, we must return, since the remove
  592:      * command should remove all nodes.
  593:      */
  594:     plist->pNodeId = NULL;
B2:00B1E1 5199              ACALL    ?L?COM0069
B2:00B1E3 C003              PUSH     AR3
B2:00B1E5 C002              PUSH     AR2
B2:00B1E7 C001              PUSH     AR1
B2:00B1E9 903CC4            MOV      DPTR,#plist
B2:00B1EC 122589            LCALL    ?C?PLDXDATA
B2:00B1EF 1225DE            LCALL    ?C?PSTPTR
B2:00B1F2 22                RET      
  595:     return;
  596:   }
B2:00B1F3         ?C0111?ASSOCIATION_PLUS:
  597: 
  598:   cmdLength -= OFFSET_PARAM_2; /*calc length on node-Id's*/
B2:00B1F3 903CCA            MOV      DPTR,#cmdLength
B2:00B1F6 E0                MOVX     A,@DPTR
B2:00B1F7 24FD              ADD      A,#0FDH
B2:00B1F9 F0                MOVX     @DPTR,A
  599: 
  600:   for (i = 0; i < cmdLength; i++)
B2:00B1FA E4                CLR      A
B2:00B1FB FF                MOV      R7,A
B2:00B1FC         ?C0113?ASSOCIATION_PLUS:
B2:00B1FC 903CCA            MOV      DPTR,#cmdLength
B2:00B1FF E0                MOVX     A,@DPTR
B2:00B200 FE                MOV      R6,A
B2:00B201 EF                MOV      A,R7
B2:00B202 C3                CLR      C
B2:00B203 9E                SUBB     A,R6
B2:00B204 5070              JNC      ?C0112?ASSOCIATION_PLUS
  601:   {
  602:     pNodeId = plist->pNodeId + i;
B2:00B206 903CC4            MOV      DPTR,#plist
B2:00B209 9141              ACALL    ?L?COM0101
B2:00B20B EF                MOV      A,R7
B2:00B20C 7C00              MOV      R4,#00H
B2:00B20E 29                ADD      A,R1
B2:00B20F F9                MOV      R1,A
B2:00B210 EC                MOV      A,R4
B2:00B211 3A                ADDC     A,R2
B2:00B212 903CCE            MOV      DPTR,#pNodeId
B2:00B215 71A8              ACALL    ?L?COM0426
B2:00B217 7051              JNZ      ?C0116?ASSOCIATION_PLUS
  603:     if (MULTI_CHANNEL_ASSOCIATION_SET_MARKER_V2 == *pNodeId)
  604:     {
  605:       if (MULTI_CHANNEL_ASSOCIATION_SET_MARKER_V2 == *(pNodeId + 1))
B2:00B219 903CCE            MOV      DPTR,#pNodeId
B2:00B21C 122589            LCALL    ?C?PLDXDATA
B2:00B21F E9                MOV      A,R1
B2:00B220 2401              ADD      A,#01H
B2:00B222 125510            LCALL    ?L?COM000B
B2:00B225 604F              JZ       ?C0112?ASSOCIATION_PLUS
  606:       {
  607:         /* 2 MARKERS!! error en incomming frame!*/
  608:         return;
  609:       }
B2:00B227         ?C0117?ASSOCIATION_PLUS:
  610:       plist->noOfMulchanNodes = (cmdLength - (i + 1)) / 2;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 677


B2:00B227 EF                MOV      A,R7
B2:00B228 04                INC      A
B2:00B229 FD                MOV      R5,A
B2:00B22A C3                CLR      C
B2:00B22B EE                MOV      A,R6
B2:00B22C 9D                SUBB     A,R5
B2:00B22D C3                CLR      C
B2:00B22E 13                RRC      A
B2:00B22F FE                MOV      R6,A
B2:00B230 903CC4            MOV      DPTR,#plist
B2:00B233 127077            LCALL    ?L?COM00E7
B2:00B236 F9                MOV      R1,A
B2:00B237 E4                CLR      A
B2:00B238 3A                ADDC     A,R2
B2:00B239 FA                MOV      R2,A
B2:00B23A EE                MOV      A,R6
B2:00B23B 122072            LCALL    ?C?CSTPTR
  611:       if (0 != plist->noOfMulchanNodes)
B2:00B23E 6033              JZ       ?C0115?ASSOCIATION_PLUS
  612:       {
  613:         if (NON_NULL(pMultiChannelAssociation))
B2:00B240 903CCB            MOV      DPTR,#pMultiChannelAssociation
B2:00B243 122589            LCALL    ?C?PLDXDATA
B2:00B246 E9                MOV      A,R1
B2:00B247 4A                ORL      A,R2
B2:00B248 6005              JZ       ?C0119?ASSOCIATION_PLUS
  614:         {
  615:           *pMultiChannelAssociation = TRUE;
B2:00B24A 7401              MOV      A,#01H
B2:00B24C 122072            LCALL    ?C?CSTPTR
  616:         }
B2:00B24F         ?C0119?ASSOCIATION_PLUS:
  617:         plist->pMulChanNodeId = (MULTICHAN_DEST_NODE_ID*)(pNodeId + 1); /*Point after the marker*/
B2:00B24F 903CCE            MOV      DPTR,#pNodeId
B2:00B252 317A              ACALL    ?L?COM0054
B2:00B254 C003              PUSH     AR3
B2:00B256 C002              PUSH     AR2
B2:00B258 C001              PUSH     AR1
B2:00B25A 903CC4            MOV      DPTR,#plist
B2:00B25D 125522            LCALL    ?L?COM0059
B2:00B260 1225DE            LCALL    ?C?PSTPTR
  618:         i = cmdLength;
B2:00B263 903CCA            MOV      DPTR,#cmdLength
B2:00B266 E0                MOVX     A,@DPTR
B2:00B267 FF                MOV      R7,A
  619:       }
  620:     }
B2:00B268 8009              SJMP     ?C0115?ASSOCIATION_PLUS
B2:00B26A         ?C0116?ASSOCIATION_PLUS:
  621:     else
  622:     {
  623:       plist->noOfNodes = i + 1;
B2:00B26A EF                MOV      A,R7
B2:00B26B 04                INC      A
B2:00B26C FE                MOV      R6,A
B2:00B26D 5177              ACALL    ?L?COM0087
B2:00B26F EE                MOV      A,R6
B2:00B270 122072            LCALL    ?C?CSTPTR
  624:     }
  625:   }
B2:00B273         ?C0115?ASSOCIATION_PLUS:
B2:00B273 0F                INC      R7
B2:00B274 8086              SJMP     ?C0113?ASSOCIATION_PLUS
  626: }
B2:00B276         ?C0112?ASSOCIATION_PLUS:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 678


B2:00B276 22                RET      
----- FUNCTION _ExtractCmdClassNodeList (END) -------


----- FUNCTION ?L?COM0087 (BEGIN) -----
B2:00B277 903CC4            MOV      DPTR,#plist
B2:00B27A         ?L?COM0088:
B2:00B27A 122589            LCALL    ?C?PLDXDATA
B2:00B27D E9                MOV      A,R1
B2:00B27E 2403              ADD      A,#03H
B2:00B280 F9                MOV      R1,A
B2:00B281 E4                CLR      A
B2:00B282 3A                ADDC     A,R2
B2:00B283 FA                MOV      R2,A
B2:00B284 22                RET      
----- FUNCTION ?L?COM0087 (END) -------


----- FUNCTION ?L?COM0067 (BEGIN) -----
B2:00B285 903AC5            MOV      DPTR,#pCmd
B2:00B288 122589            LCALL    ?C?PLDXDATA
B2:00B28B 903CC7            MOV      DPTR,#?_ExtractCmdClassNodeList?BYTE+03H
B2:00B28E 1225A9            LCALL    ?C?PSTXDATA
B2:00B291 903AC8            MOV      DPTR,#cmdLength
B2:00B294 E0                MOVX     A,@DPTR
B2:00B295 903CCA            MOV      DPTR,#?_ExtractCmdClassNodeList?BYTE+06H
B2:00B298         ?L?COM0068:
B2:00B298 F0                MOVX     @DPTR,A
B2:00B299         ?L?COM0069:
B2:00B299 7B00              MOV      R3,#00H
B2:00B29B 7A00              MOV      R2,#00H
B2:00B29D 7900              MOV      R1,#00H
B2:00B29F 22                RET      
----- FUNCTION ?L?COM0067 (END) -------


----- FUNCTION _ZCB_callback_wrapper (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTMULTICAST.C'
  210: PCB(ZCB_callback_wrapper)(uint8_t status)
  211: {
  212:   UNUSED(status);
  213:   ZCB_multicast_callback(NULL);
  214: }
B2:00B2A0 5199              ACALL    ?L?COM0069
B2:;----                  JMP      _ZCB_multicast_callback
----- FUNCTION _ZCB_callback_wrapper (END) -------


----- FUNCTION _ZCB_multicast_callback (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTMULTICAST.C'
  224: PCB(ZCB_multicast_callback)(TRANSMISSION_RESULT * pTransmissionResult)
  225: {
B2:00B2A2 903EF9            MOV      DPTR,#pTransmissionResult
B2:00B2A5 1225A9            LCALL    ?C?PSTXDATA
  226:   TRANSMISSION_RESULT_FINISH_STATUS isFinished = TRANSMISSION_RESULT_NOT_FINISHED;
  227:   static TRANSMISSION_RESULT transmissionResult;
;---- Variable 'isFinished' assigned to Register 'R7' ----
B2:00B2A8 E4                CLR      A
B2:00B2A9 FF                MOV      R7,A
  228:   enum ZW_SENDDATA_EX_RETURN_CODES txResult;
  229: 
  230:   ZW_DEBUG__SEND_NL();
  231:   ZW_DEBUG__SEND_BYTE('c');
  232: 
  233:   if (singlecast_node_count > 0)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 679


B2:00B2AA 903693            MOV      DPTR,#singlecast_node_count
B2:00B2AD E0                MOVX     A,@DPTR
B2:00B2AE FE                MOV      R6,A
B2:00B2AF D3                SETB     C
B2:00B2B0 9400              SUBB     A,#00H
B2:00B2B2 402B              JC       ?C0024?ZW_TRANSPORTMULTICAST
  234:   {
  235:     /*
  236:      * When singlecast_node_count is higher than zero, it means that the call
  237:      * to this function is a callback when transmission is done or failed.
  238:      */
  239: 
  240:     // Check whether to set the finish flag.
  241:     if (singlecast_node_count == p_nodelist_hold->list_length)
B2:00B2B4 912B              ACALL    ?L?COM02EB
B2:00B2B6 FD                MOV      R5,A
B2:00B2B7 EE                MOV      A,R6
B2:00B2B8 B50503            CJNE     A,AR5,?C0025?ZW_TRANSPORTMULTICAST
  242:     {
  243:       isFinished = TRANSMISSION_RESULT_FINISHED;
B2:00B2BB 0F                INC      R7
  244:       ZW_DEBUG__SEND_NL();
  245:       ZW_DEBUG__SEND_STR("Transmission done!");
  246:     }
B2:00B2BC 8002              SJMP     ?C0026?ZW_TRANSPORTMULTICAST
B2:00B2BE         ?C0025?ZW_TRANSPORTMULTICAST:
  247:     else
  248:     {
  249:       isFinished = TRANSMISSION_RESULT_NOT_FINISHED;
B2:00B2BE E4                CLR      A
B2:00B2BF FF                MOV      R7,A
  250:     }
B2:00B2C0         ?C0026?ZW_TRANSPORTMULTICAST:
  251: 
  252:     transmissionResult.nodeId = pTransmissionResult->nodeId;
B2:00B2C0 903EF9            MOV      DPTR,#pTransmissionResult
B2:00B2C3 12AE26            LCALL    ?L?COM0049
B2:00B2C6 90366D            MOV      DPTR,#transmissionResult
B2:00B2C9 F0                MOVX     @DPTR,A
  253:     transmissionResult.isFinished = isFinished;
B2:00B2CA 90366F            MOV      DPTR,#transmissionResult+02H
B2:00B2CD EF                MOV      A,R7
B2:00B2CE F0                MOVX     @DPTR,A
  254:     transmissionResult.status = pTransmissionResult->status;
B2:00B2CF 71A2              ACALL    ?L?COM0182
B2:00B2D1 90366E            MOV      DPTR,#transmissionResult+01H
B2:00B2D4 1296A0            LCALL    ?L?COM0136
B2:00B2D7 6006              JZ       ?C0024?ZW_TRANSPORTMULTICAST
  255: 
  256:     if (NON_NULL(p_callback_hold))
  257:     {
  258:       p_callback_hold(&transmissionResult); // TODO: What about endpoints...?
B2:00B2D9 7A36              MOV      R2,#HIGH transmissionResult
B2:00B2DB 796D              MOV      R1,#LOW transmissionResult
B2:00B2DD 9147              ACALL    ?L?COM0363
  259:     }
  260:   }
B2:00B2DF         ?C0024?ZW_TRANSPORTMULTICAST:
  261: 
  262:   if (singlecast_node_count < p_nodelist_hold->list_length)
B2:00B2DF 912B              ACALL    ?L?COM02EB
B2:00B2E1 FF                MOV      R7,A
B2:00B2E2 903693            MOV      DPTR,#singlecast_node_count
B2:00B2E5 E0                MOVX     A,@DPTR
B2:00B2E6 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 680


B2:00B2E7 C3                CLR      C
B2:00B2E8 9F                SUBB     A,R7
B2:00B2E9 4002              JC       $ + 4H
B2:00B2EB 61A0              AJMP     ?C0034?ZW_TRANSPORTMULTICAST
  263:   {
  264:     TRANSMIT_OPTIONS_TYPE_SINGLE_EX txOptions;
  265: 
  266:     txOptions.txOptions = p_nodelist_hold->txOptions;
B2:00B2ED 71A2              ACALL    ?L?COM0182
B2:00B2EF 903EFC            MOV      DPTR,#txOptions
B2:00B2F2 F0                MOVX     @DPTR,A
  267:     txOptions.txSecOptions = txSecOptions;
B2:00B2F3 903699            MOV      DPTR,#txSecOptions
B2:00B2F6 E0                MOVX     A,@DPTR
B2:00B2F7 FF                MOV      R7,A
B2:00B2F8 903EFD            MOV      DPTR,#txOptions+01H
B2:00B2FB F0                MOVX     @DPTR,A
  268:     if(0 == singlecast_node_count && (txSecOptions & S2_TXOPTION_SINGLECAST_FOLLOWUP) )
B2:00B2FC EE                MOV      A,R6
B2:00B2FD 7008              JNZ      ?C0029?ZW_TRANSPORTMULTICAST
B2:00B2FF EF                MOV      A,R7
B2:00B300 30E104            JNB      ACC.1,?C0029?ZW_TRANSPORTMULTICAST
  269:     {
  270:       txOptions.txSecOptions |= S2_TXOPTION_FIRST_SINGLECAST_FOLLOWUP;
B2:00B303 E0                MOVX     A,@DPTR
B2:00B304 4404              ORL      A,#04H
B2:00B306 F0                MOVX     @DPTR,A
  271:     }
B2:00B307         ?C0029?ZW_TRANSPORTMULTICAST:
  272: 
  273:     txOptions.sourceEndpoint = p_nodelist_hold->sourceEndpoint;
B2:00B307 903690            MOV      DPTR,#p_nodelist_hold
B2:00B30A 128F3E            LCALL    ?L?COM0029
B2:00B30D 903EFE            MOV      DPTR,#txOptions+02H
B2:00B310 9137              ACALL    ?L?COM0254
B2:00B312 903693            MOV      DPTR,#singlecast_node_count
B2:00B315 1282D9            LCALL    ?L?COM0035
B2:00B318 903EFF            MOV      DPTR,#txOptions+03H
B2:00B31B 71A8              ACALL    ?L?COM0426
B2:00B31D 90366D            MOV      DPTR,#transmissionResult
B2:00B320 12DA68            LCALL    ?L?COM0425
B2:00B323 903694            MOV      DPTR,#secKeys
B2:00B326 E0                MOVX     A,@DPTR
B2:00B327 5407              ANL      A,#07H
B2:00B329 6017              JZ       ?C0031?ZW_TRANSPORTMULTICAST
B2:00B32B A3                INC      DPTR
B2:00B32C E0                MOVX     A,@DPTR
B2:00B32D 6013              JZ       ?C0031?ZW_TRANSPORTMULTICAST
B2:00B32F 903EFF            MOV      DPTR,#txOptions+03H
B2:00B332 12A5A3            LCALL    ?L?COM001F
B2:00B335 121FF0            LCALL    ?C?CLDOPTR
B2:00B338 FF                MOV      R7,A
B2:00B339 127152            LCALL    ?L?COM02C7
B2:00B33C 20E003            JB       ACC.0,?C0031?ZW_TRANSPORTMULTICAST
B2:00B33F D3                SETB     C
B2:00B340 8001              SJMP     ?C0032?ZW_TRANSPORTMULTICAST
B2:00B342         ?C0031?ZW_TRANSPORTMULTICAST:
B2:00B342 C3                CLR      C
B2:00B343         ?C0032?ZW_TRANSPORTMULTICAST:
B2:00B343 12D4D5            LCALL    ?L?COM0493
B2:00B346 4010              JC       ?C0030?ZW_TRANSPORTMULTICAST
  274:     txOptions.pDestNode = &p_nodelist_hold->pList[singlecast_node_count];
  275:     transmissionResult.nodeId = txOptions.pDestNode->node.nodeId;
  276: 
  277:     /*
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 681


  278:     ZW_DEBUG__SEND_NL();
  279:     ZW_DEBUG__SEND_NL();
  280:     ZW_DEBUG__SEND_STR("Node C/ID: ");
  281:     ZW_DEBUG__SEND_NUM(singlecast_node_count);
  282:     ZW_DEBUG__SEND_BYTE('/');
  283:     ZW_DEBUG__SEND_NUM((BYTE)(txOptions.pDestNode->node.nodeId));
  284: 
  285:     ZW_DEBUG__SEND_NL();
  286:     ZW_DEBUG__SEND_STR("Sec scheme: ");
  287:     ZW_DEBUG__SEND_NUM(txOptions.pDestNode->nodeInfo.security);
  288:     ZW_DEBUG__SEND_NUM(ZW_GetSecurityKeys());
  289:     */
  290: 
  291:     if (TRUE != RequestBufferSupervisionPayloadActivate((ZW_APPLICATION_TX_BUFFER**)&p_data_hold, &data_length_ho
>> ld, ((0 != (SECURITY_KEY_S2_MASK & secKeys)) && fSupervisionEnableHold && (0 == txOptions.pDestNode->node.BitAddress)
>> )))
  292:     {
  293:       transmissionResult.nodeId = 0;
B2:00B348 E4                CLR      A
B2:00B349 90366D            MOV      DPTR,#transmissionResult
B2:00B34C F0                MOVX     @DPTR,A
  294:       transmissionResult.status = ZW_TX_FAILED;
B2:00B34D A3                INC      DPTR
B2:00B34E F0                MOVX     @DPTR,A
  295:       transmissionResult.isFinished = TRANSMISSION_RESULT_FINISHED;
B2:00B34F A3                INC      DPTR
B2:00B350 04                INC      A
B2:00B351 1296A0            LCALL    ?L?COM0136
B2:00B354 604A              JZ       ?C0034?ZW_TRANSPORTMULTICAST
  296: 
  297:       if (NON_NULL(p_callback_hold))
  298:       {
  299:         p_callback_hold(&transmissionResult);
  300:       }
B2:00B356 8035              SJMP     ?C0038?ZW_TRANSPORTMULTICAST
  301:       return;
  302:     }
B2:00B358         ?C0030?ZW_TRANSPORTMULTICAST:
  303: 
  304:     txResult = Transport_SendRequestEP(
B2:00B358 903670            MOV      DPTR,#data_length_hold
B2:00B35B E0                MOVX     A,@DPTR
B2:00B35C FD                MOV      R5,A
B2:00B35D 7B01              MOV      R3,#01H
B2:00B35F 7A3E              MOV      R2,#HIGH txOptions
B2:00B361 79FC              MOV      R1,#LOW txOptions
B2:00B363 903F06            MOV      DPTR,#?_Transport_SendRequestEP?BYTE+04H
B2:00B366 1225A9            LCALL    ?C?PSTXDATA
B2:00B369 903F09            MOV      DPTR,#?_Transport_SendRequestEP?BYTE+07H
B2:00B36C 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_multicast_callback
B2:00B36E F0                MOVX     @DPTR,A
B2:00B36F A3                INC      DPTR
B2:00B370 7499              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_multicast_callback
B2:00B372 F0                MOVX     @DPTR,A
B2:00B373 903696            MOV      DPTR,#p_data_hold
B2:00B376 122589            LCALL    ?C?PLDXDATA
;---- Variable 'txResult' assigned to Register 'R7' ----
B2:00B379 9152              ACALL    ?L?COM03E4
B2:00B37B 601D              JZ       ?C0035?ZW_TRANSPORTMULTICAST
  305:                   p_data_hold,
  306:                   data_length_hold,
  307:                   &txOptions,
  308:                   ZCB_multicast_callback);
  309: 
  310:     if (ZW_TX_IN_PROGRESS != txResult)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 682


  311:     {
  312:       ZW_DEBUG__SEND_NL();
  313:       ZW_DEBUG__SEND_STR("Error: ");
  314:       ZW_DEBUG__SEND_NUM(txResult);
  315:       transmissionResult.nodeId = 0;
B2:00B37D E4                CLR      A
B2:00B37E 90366D            MOV      DPTR,#transmissionResult
B2:00B381 F0                MOVX     @DPTR,A
  316:       transmissionResult.status = TRANSMIT_COMPLETE_FAIL;
B2:00B382 A3                INC      DPTR
B2:00B383 7402              MOV      A,#02H
B2:00B385 F0                MOVX     @DPTR,A
  317:       transmissionResult.isFinished = TRANSMISSION_RESULT_FINISHED;
B2:00B386 A3                INC      DPTR
B2:00B387 14                DEC      A
B2:00B388 1296A0            LCALL    ?L?COM0136
B2:00B38B 6013              JZ       ?C0034?ZW_TRANSPORTMULTICAST
  318: 
  319:       if (NON_NULL(p_callback_hold))
  320:       {
  321:         p_callback_hold(&transmissionResult);
B2:00B38D         
B2:00B38D 7B01              MOV      R3,#01H
B2:00B38F 7A36              MOV      R2,#HIGH transmissionResult
B2:00B391 796D              MOV      R1,#LOW transmissionResult
B2:00B393 8F82              MOV      DPL,R7
B2:00B395 8E83              MOV      DPH,R6
B2:00B397 02271A            LJMP     ?C?ICALL2
  322:       }
  323:       return;
  324:     }
B2:00B39A         ?C0035?ZW_TRANSPORTMULTICAST:
  325:     singlecast_node_count++;
B2:00B39A 903693            MOV      DPTR,#singlecast_node_count
B2:00B39D E0                MOVX     A,@DPTR
B2:00B39E 04                INC      A
B2:00B39F F0                MOVX     @DPTR,A
  326:   }
  327: }
B2:00B3A0         ?C0034?ZW_TRANSPORTMULTICAST:
B2:00B3A0 22                RET      
----- FUNCTION _ZCB_multicast_callback (END) -------


----- FUNCTION ?L?COM0181 (BEGIN) -----
B2:00B3A1 FD                MOV      R5,A
B2:00B3A2         ?L?COM0182:
B2:00B3A2 900001            MOV      DPTR,#01H
B2:00B3A5 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0181 (END) -------


----- FUNCTION ?L?COM0426 (BEGIN) -----
B2:00B3A8 FA                MOV      R2,A
B2:00B3A9 1225A9            LCALL    ?C?PSTXDATA
B2:00B3AC 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0426 (END) -------


----- FUNCTION _ReadAggregatedEndpointGroup (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  265: ReadAggregatedEndpointGroup( BYTE aggregatedEndpoint, BYTE* pAggBitMask)
  266: {
B2:00B3AF 9041E0            MOV      DPTR,#aggregatedEndpoint
B2:00B3B2 127088            LCALL    ?L?COM00F4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 683


  267:   BYTE aggBitMaskSize = 0;
  268:   BYTE i = 0;
;---- Variable 'aggBitMaskSize' assigned to Register 'R7' ----
B2:00B3B5 E4                CLR      A
B2:00B3B6 FF                MOV      R7,A
  269:   /* Find aggregated Endpoint */
B2:00B3B7 9041E4            MOV      DPTR,#i
B2:00B3BA F0                MOVX     @DPTR,A
  270: 
  271:   for(i = 0; i < myTransportEndpoint.sizeAggGroupArray; i++)
B2:00B3BB F0                MOVX     @DPTR,A
B2:00B3BC         ?C0028?ZW_TRANSPORTENDPOINT:
B2:00B3BC 9035FF            MOV      DPTR,#myTransportEndpoint+0BH
B2:00B3BF E0                MOVX     A,@DPTR
B2:00B3C0 FE                MOV      R6,A
B2:00B3C1 9041E4            MOV      DPTR,#i
B2:00B3C4 E0                MOVX     A,@DPTR
B2:00B3C5 FD                MOV      R5,A
B2:00B3C6 C3                CLR      C
B2:00B3C7 9E                SUBB     A,R6
B2:00B3C8 504D              JNC      ?C0029?ZW_TRANSPORTENDPOINT
  272:   {
  273:     if(aggregatedEndpoint == myTransportEndpoint.pMaskArray[i].aggregatedEndpoint)
B2:00B3CA 9035FC            MOV      DPTR,#myTransportEndpoint+08H
B2:00B3CD 122589            LCALL    ?C?PLDXDATA
B2:00B3D0 75F005            MOV      B,#05H
B2:00B3D3 ED                MOV      A,R5
B2:00B3D4 127103            LCALL    ?L?COM0273
B2:00B3D7 121FF0            LCALL    ?C?CLDOPTR
B2:00B3DA FE                MOV      R6,A
B2:00B3DB 9041E0            MOV      DPTR,#aggregatedEndpoint
B2:00B3DE E0                MOVX     A,@DPTR
B2:00B3DF 6E                XRL      A,R6
B2:00B3E0 702D              JNZ      ?C0030?ZW_TRANSPORTENDPOINT
  274:     {
  275:       /* Copy data bit mask*/
  276:       memcpy(pAggBitMask, myTransportEndpoint.pMaskArray[i].pBitMask, myTransportEndpoint.pMaskArray[i].len);
B2:00B3E2 9118              ACALL    ?L?COM032B
B2:00B3E4 1282AD            LCALL    ?L?COM0086
B2:00B3E7 71A2              ACALL    ?L?COM0182
B2:00B3E9 FF                MOV      R7,A
B2:00B3EA C007              PUSH     AR7
B2:00B3EC 9118              ACALL    ?L?COM032B
B2:00B3EE 1282AD            LCALL    ?L?COM0086
B2:00B3F1 900002            MOV      DPTR,#02H
B2:00B3F4 12262D            LCALL    ?C?PLDOPTR
B2:00B3F7 12C4EF            LCALL    ?L?COM0022
B2:00B3FA 9041E1            MOV      DPTR,#pAggBitMask
B2:00B3FD 122589            LCALL    ?C?PLDXDATA
B2:00B400 D007              POP      AR7
B2:00B402 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  277:       aggBitMaskSize = myTransportEndpoint.pMaskArray[i].len;
B2:00B405 9118              ACALL    ?L?COM032B
B2:00B407 1282AD            LCALL    ?L?COM0086
B2:00B40A 71A2              ACALL    ?L?COM0182
B2:00B40C FF                MOV      R7,A
  278:       break;
B2:00B40D 8008              SJMP     ?C0029?ZW_TRANSPORTENDPOINT
  279:     }
  280:   }
B2:00B40F         ?C0030?ZW_TRANSPORTENDPOINT:
B2:00B40F 9041E4            MOV      DPTR,#i
B2:00B412 E0                MOVX     A,@DPTR
B2:00B413 04                INC      A
B2:00B414 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 684


B2:00B415 80A5              SJMP     ?C0028?ZW_TRANSPORTENDPOINT
B2:00B417         ?C0029?ZW_TRANSPORTENDPOINT:
  281:   return aggBitMaskSize;
  282: }
B2:00B417 22                RET      
----- FUNCTION _ReadAggregatedEndpointGroup (END) -------


----- FUNCTION ?L?COM032B (BEGIN) -----
B2:00B418 9041E4            MOV      DPTR,#i
B2:00B41B E0                MOVX     A,@DPTR
B2:00B41C 75F005            MOV      B,#05H
B2:00B41F A4                MUL      AB
B2:00B420 FF                MOV      R7,A
B2:00B421 9035FC            MOV      DPTR,#myTransportEndpoint+08H
B2:00B424 22                RET      
----- FUNCTION ?L?COM032B (END) -------


----- FUNCTION ZW_TransportMulticast_clearTimeout (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTMULTICAST.C'
  329: void ZW_TransportMulticast_clearTimeout(void)
  330: {
  331:   gotSupervision = TRUE;
  332:   ZCB_multicast_callback(0);
B2:00B425 D24C              SETB     gotSupervision
  333: }
B2:00B427 5199              ACALL    ?L?COM0069
B2:00B429 41A2              AJMP     _ZCB_multicast_callback
----- FUNCTION ZW_TransportMulticast_clearTimeout (END) -------


----- FUNCTION ?L?COM02EB (BEGIN) -----
B2:00B42B 903690            MOV      DPTR,#p_nodelist_hold
B2:00B42E         ?L?COM02EC:
B2:00B42E 122589            LCALL    ?C?PLDXDATA
B2:00B431         ?L?COM02ED:
B2:00B431 900006            MOV      DPTR,#06H
B2:00B434 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM02EB (END) -------


----- FUNCTION ?L?COM0254 (BEGIN) -----
B2:00B437 F0                MOVX     @DPTR,A
B2:00B438         ?L?COM0255:
B2:00B438 900003            MOV      DPTR,#03H
B2:00B43B 02262D            LJMP     ?C?PLDOPTR
----- FUNCTION ?L?COM0254 (END) -------


----- FUNCTION ?L?COM0100 (BEGIN) -----
B2:00B43E 90409C            MOV      DPTR,#pAgiTable
B2:00B441         ?L?COM0101:
B2:00B441 122589            LCALL    ?C?PLDXDATA
B2:00B444 0225BE            LJMP     ?C?PLDPTR
----- FUNCTION ?L?COM0100 (END) -------


----- FUNCTION ?L?COM0363 (BEGIN) -----
B2:00B447 7B01              MOV      R3,#01H
B2:00B449         ?L?COM0364:
B2:00B449 8F82              MOV      DPL,R7
B2:00B44B 8E83              MOV      DPH,R6
B2:00B44D 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0363 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 685




----- FUNCTION ?L?COM03E3 (BEGIN) -----
B2:00B450 7D05              MOV      R5,#05H
B2:00B452         ?L?COM03E4:
B2:00B452 91F2              ACALL    _Transport_SendRequestEP
B2:00B454 EF                MOV      A,R7
B2:00B455 6401              XRL      A,#01H
B2:00B457 22                RET      
----- FUNCTION ?L?COM03E3 (END) -------


----- FUNCTION ?L?COM0592 (BEGIN) -----
B2:00B458 903C6A            MOV      DPTR,#fwTarget
B2:00B45B E0                MOVX     A,@DPTR
B2:00B45C FF                MOV      R7,A
----- FUNCTION _handleFirmWareIdGet (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
  971: handleFirmWareIdGet( BYTE n)
  972: {
;---- Variable 'n' assigned to Register 'R7' ----
  973:   if(n == 0)
  974:   {
B2:00B45D EF                MOV      A,R7
B2:00B45E 7005              JNZ      ?C0101?SWITCHONOFF
  975:     return APP_FIRMWARE_ID;
  976:   }
B2:00B460 7E03              MOV      R6,#03H
B2:00B462 7F02              MOV      R7,#02H
B2:00B464 22                RET      
  977:   else if (n == 1)
B2:00B465         ?C0101?SWITCHONOFF:
  978:   {
B2:00B465 EF                MOV      A,R7
B2:00B466 B40105            CJNE     A,#01H,?C0103?SWITCHONOFF
  979:     return 0x1234;
  980:   }
B2:00B469 7E12              MOV      R6,#012H
B2:00B46B 7F34              MOV      R7,#034H
B2:00B46D 22                RET      
  981:   return 0;
B2:00B46E         ?C0103?SWITCHONOFF:
  982: }
B2:00B46E E4                CLR      A
B2:00B46F FE                MOV      R6,A
B2:00B470 FF                MOV      R7,A
  983: 
B2:00B471 22                RET      
----- FUNCTION _handleFirmWareIdGet (END) -------


----- FUNCTION _CmdClassMultiChannelEncapsulate (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMULTICHAN.C'
  320: void CmdClassMultiChannelEncapsulate(
B2:00B472 903D8C            MOV      DPTR,#ppData
B2:00B475 1271F8            LCALL    ?L?COM0385
B2:00B478 E9                MOV      A,R1
B2:00B479 4A                ORL      A,R2
B2:00B47A 6075              JZ       ?C0047?COMMANDCLASSMULTICHAN
B2:00B47C 903D92            MOV      DPTR,#pTxOptionsEx
B2:00B47F 128F3E            LCALL    ?L?COM0029
B2:00B482 7008              JNZ      ?C0045?COMMANDCLASSMULTICHAN
B2:00B484 9138              ACALL    ?L?COM0255
B2:00B486 71A2              ACALL    ?L?COM0182
B2:00B488 547F              ANL      A,#07FH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 686


B2:00B48A 6065              JZ       ?C0047?COMMANDCLASSMULTICHAN
  321:   BYTE **ppData,
  322:   BYTE *dataLength,
  323:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx)
  324: {
  325:   ZW_APPLICATION_TX_BUFFER *pTxBuf;
  326:   BYTE sizeCmdFrameHeader;
  327: 
  328:   if (IS_NULL(*ppData)
  329:    || ((0 == pTxOptionsEx->sourceEndpoint)
  330:    && (0 == pTxOptionsEx->pDestNode->node.endpoint)))
  331:   {
  332:     return;
  333:   }
B2:00B48C         ?C0045?COMMANDCLASSMULTICHAN:
  334: 
  335:   sizeCmdFrameHeader = sizeof(ZW_MULTI_CHANNEL_CMD_ENCAP_V2_FRAME) - sizeof(ALL_EXCEPT_ENCAP);
;---- Variable 'sizeCmdFrameHeader' assigned to Register 'R7' ----
B2:00B48C 7F04              MOV      R7,#04H
  336:   *ppData -= sizeCmdFrameHeader;
B2:00B48E C3                CLR      C
B2:00B48F E4                CLR      A
B2:00B490 9404              SUBB     A,#04H
B2:00B492 FD                MOV      R5,A
B2:00B493 E4                CLR      A
B2:00B494 9400              SUBB     A,#00H
B2:00B496 FC                MOV      R4,A
B2:00B497 903D8C            MOV      DPTR,#ppData
B2:00B49A 12A5A3            LCALL    ?L?COM001F
B2:00B49D EC                MOV      A,R4
B2:00B49E 8DF0              MOV      B,R5
B2:00B4A0 1221D2            LCALL    ?C?IILDOPTR
  337:   pTxBuf = (ZW_APPLICATION_TX_BUFFER *)*ppData;
B2:00B4A3 903D8C            MOV      DPTR,#ppData
B2:00B4A6 9141              ACALL    ?L?COM0101
B2:00B4A8 903D95            MOV      DPTR,#pTxBuf
B2:00B4AB 1225A9            LCALL    ?C?PSTXDATA
  338: 
  339: 
  340:   *dataLength += sizeCmdFrameHeader;
B2:00B4AE 903D8F            MOV      DPTR,#dataLength
B2:00B4B1 122589            LCALL    ?C?PLDXDATA
B2:00B4B4 EF                MOV      A,R7
B2:00B4B5 12201D            LCALL    ?C?CILDPTR
  341: 
  342:   pTxBuf->ZW_MultiChannelCmdEncapV2Frame.cmdClass = COMMAND_CLASS_MULTI_CHANNEL_V4;
B2:00B4B8 903D95            MOV      DPTR,#pTxBuf
B2:00B4BB 122589            LCALL    ?C?PLDXDATA
B2:00B4BE 7460              MOV      A,#060H
B2:00B4C0 122072            LCALL    ?C?CSTPTR
  343:   pTxBuf->ZW_MultiChannelCmdEncapV2Frame.cmd = MULTI_CHANNEL_CMD_ENCAP_V4;
B2:00B4C3 903D95            MOV      DPTR,#pTxBuf
B2:00B4C6 12A5A3            LCALL    ?L?COM001F
B2:00B4C9 740D              MOV      A,#0DH
B2:00B4CB 122084            LCALL    ?C?CSTOPTR
  344:   pTxBuf->ZW_MultiChannelCmdEncapV2Frame.properties1 = pTxOptionsEx->sourceEndpoint;
B2:00B4CE 903D92            MOV      DPTR,#pTxOptionsEx
B2:00B4D1 128F3E            LCALL    ?L?COM0029
B2:00B4D4 FF                MOV      R7,A
B2:00B4D5 903D95            MOV      DPTR,#pTxBuf
B2:00B4D8 D1A3              ACALL    ?L?COM00B3
  345:   pTxBuf->ZW_MultiChannelCmdEncapV2Frame.properties2 = (pTxOptionsEx->pDestNode->node.endpoint | (pTxOptionsEx->p
>> DestNode->node.BitAddress << 0x07));
B2:00B4DA 903D92            MOV      DPTR,#pTxOptionsEx
B2:00B4DD B17F              ACALL    ?L?COM00E6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 687


B2:00B4DF 12262D            LCALL    ?C?PLDOPTR
B2:00B4E2 71A2              ACALL    ?L?COM0182
B2:00B4E4 D116              ACALL    ?L?COM01A8
B2:00B4E6 B186              ACALL    ?L?COM051C
B2:00B4E8 903D95            MOV      DPTR,#pTxBuf
B2:00B4EB B17F              ACALL    ?L?COM00E6
B2:00B4ED EF                MOV      A,R7
B2:00B4EE 122084            LCALL    ?C?CSTOPTR
  346: }
B2:00B4F1         ?C0047?COMMANDCLASSMULTICHAN:
B2:00B4F1 22                RET      
----- FUNCTION _CmdClassMultiChannelEncapsulate (END) -------


----- FUNCTION _Transport_SendRequestEP (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  285: Transport_SendRequestEP(
  286:   BYTE *pData,
B2:00B4F2 903F02            MOV      DPTR,#pData
B2:00B4F5 1225A9            LCALL    ?C?PSTXDATA
B2:00B4F8 903F05            MOV      DPTR,#dataLength
B2:00B4FB ED                MOV      A,R5
B2:00B4FC F0                MOVX     @DPTR,A
  287:   BYTE  dataLength,
  288:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx,
  289:   VOID_CALLBACKFUNC(pCallback)(TRANSMISSION_RESULT * pTransmissionResult))
  290: {
  291:   static TRANSMIT_OPTIONS_TYPE sTxOptions;
  292:   // Check for multi channel
  293:   if(FALSE == pTxOptionsEx->pDestNode->nodeInfo.BitMultiChannelEncap)
B2:00B4FD A3                INC      DPTR
B2:00B4FE B17F              ACALL    ?L?COM00E6
B2:00B500 12262D            LCALL    ?C?PLDOPTR
B2:00B503 128F41            LCALL    ?L?COM002A
B2:00B506 7009              JNZ      ?C0033?ZW_TRANSPORTENDPOINT
  294:   {
  295:     pTxOptionsEx->sourceEndpoint = 0;
B2:00B508 903F06            MOV      DPTR,#pTxOptionsEx
B2:00B50B 122589            LCALL    ?C?PLDXDATA
B2:00B50E 12C9B3            LCALL    ?L?COM025B
  296:   }
B2:00B511         ?C0033?ZW_TRANSPORTENDPOINT:
  297: 
  298:   /*
  299:    * Save the function pointer to a variable in order to call it in
  300:    * ZCB_RequestCompleted.
  301:    */
  302:   pCallbackRequest = pCallback;
B2:00B511 903F09            MOV      DPTR,#pCallback
B2:00B514 E0                MOVX     A,@DPTR
B2:00B515 FF                MOV      R7,A
B2:00B516 A3                INC      DPTR
B2:00B517 E0                MOVX     A,@DPTR
B2:00B518 90360B            MOV      DPTR,#_pCallbackRequest
B2:00B51B CF                XCH      A,R7
B2:00B51C F0                MOVX     @DPTR,A
B2:00B51D A3                INC      DPTR
B2:00B51E EF                MOV      A,R7
B2:00B51F F0                MOVX     @DPTR,A
  303: 
  304:   CmdClassMultiChannelEncapsulate(&pData,
B2:00B520 7A3F              MOV      R2,#HIGH dataLength
B2:00B522 7905              MOV      R1,#LOW dataLength
B2:00B524 B18D              ACALL    ?L?COM0590
B2:00B526 903F06            MOV      DPTR,#pTxOptionsEx
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 688


B2:00B529 12DAC5            LCALL    ?L?COM0492
B2:00B52C 7A3F              MOV      R2,#HIGH pData
B2:00B52E 7902              MOV      R1,#LOW pData
B2:00B530 9172              ACALL    _CmdClassMultiChannelEncapsulate
  305:                                   &dataLength,
  306:                                   pTxOptionsEx);
  307: 
  308:   /**
  309:    *  Build transmit options
  310:    */
  311:   sTxOptions.destNode = pTxOptionsEx->pDestNode->node.nodeId;
B2:00B532 903F06            MOV      DPTR,#pTxOptionsEx
B2:00B535 B17F              ACALL    ?L?COM00E6
B2:00B537 12262D            LCALL    ?C?PLDOPTR
B2:00B53A 121FB3            LCALL    ?C?CLDPTR
B2:00B53D 9035DE            MOV      DPTR,#sTxOptions
B2:00B540 F0                MOVX     @DPTR,A
  312:   sTxOptions.txOptions = pTxOptionsEx->txOptions;
B2:00B541 903F06            MOV      DPTR,#pTxOptionsEx
B2:00B544 12AE26            LCALL    ?L?COM0049
B2:00B547 9035E0            MOV      DPTR,#sTxOptions+02H
B2:00B54A F0                MOVX     @DPTR,A
  313:   sTxOptions.txSecOptions = (pTxOptionsEx->txSecOptions | S2_TXOPTION_VERIFY_DELIVERY); /**<Always set verify opt
>> ions on request job*/
B2:00B54B 71A2              ACALL    ?L?COM0182
B2:00B54D 4401              ORL      A,#01H
B2:00B54F 9035E1            MOV      DPTR,#sTxOptions+03H
B2:00B552 9137              ACALL    ?L?COM0254
B2:00B554 128CA5            LCALL    ?L?COM0080
B2:00B557 9035E2            MOV      DPTR,#sTxOptions+04H
B2:00B55A F0                MOVX     @DPTR,A
  314:   sTxOptions.securityKey = pTxOptionsEx->pDestNode->nodeInfo.security;
  315: 
  316:   return ZW_SendDataEx(pData,
B2:00B55B 903F05            MOV      DPTR,#dataLength
B2:00B55E E0                MOVX     A,@DPTR
B2:00B55F FD                MOV      R5,A
B2:00B560 7B01              MOV      R3,#01H
B2:00B562 7A35              MOV      R2,#HIGH sTxOptions
B2:00B564 79DE              MOV      R1,#LOW sTxOptions
B2:00B566 12704B            LCALL    ?L?COM00AE
B2:00B569 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B2:00B56C 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_RequestCompleted
B2:00B56E F0                MOVX     @DPTR,A
B2:00B56F A3                INC      DPTR
B2:00B570 749E              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_RequestCompleted
B2:00B572 F0                MOVX     @DPTR,A
B2:00B573 903F02            MOV      DPTR,#pData
B2:00B576 122589            LCALL    ?C?PLDXDATA
B2:00B579 021980            LJMP     ?INTERBANK_TABLE?_ZW_SendDataEx
  317:                        dataLength,
  318:                        &sTxOptions,
  319:                        ZCB_RequestCompleted);
----- FUNCTION _Transport_SendRequestEP (END) -------


----- FUNCTION ?L?COM00E5 (BEGIN) -----
B2:00B57C 9039F0            MOV      DPTR,#pTxBuf
B2:00B57F         ?L?COM00E6:
B2:00B57F 122589            LCALL    ?C?PLDXDATA
B2:00B582 900003            MOV      DPTR,#03H
B2:00B585 22                RET      
----- FUNCTION ?L?COM00E5 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 689


----- FUNCTION ?L?COM051C (BEGIN) -----
B2:00B586 FE                MOV      R6,A
B2:00B587 EF                MOV      A,R7
B2:00B588 547F              ANL      A,#07FH
B2:00B58A 4E                ORL      A,R6
B2:00B58B FF                MOV      R7,A
B2:00B58C 22                RET      
----- FUNCTION ?L?COM051C (END) -------


----- FUNCTION ?L?COM0590 (BEGIN) -----
B2:00B58D 7B01              MOV      R3,#01H
B2:00B58F 903D8F            MOV      DPTR,#?_CmdClassMultiChannelEncapsulate?BYTE+03H
B2:00B592 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0590 (END) -------


----- FUNCTION ?L?COM0598 (BEGIN) -----
B2:00B595 B19D              ACALL    _CC_AGI_groupCount_handler
B2:00B597 903AD6            MOV      DPTR,#maxNumberOfGroups
B2:00B59A EF                MOV      A,R7
B2:00B59B F0                MOVX     @DPTR,A
B2:00B59C 22                RET      
----- FUNCTION ?L?COM0598 (END) -------


----- FUNCTION _CC_AGI_groupCount_handler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  168: uint8_t CC_AGI_groupCount_handler(uint8_t endpoint)
  169: {
;---- Variable 'endpoint' assigned to Register 'R7' ----
  170:   if (NUMBER_OF_ENDPOINTS < endpoint)
  171:   {
B2:00B59D E4                CLR      A
B2:00B59E C3                CLR      C
B2:00B59F 9F                SUBB     A,R7
B2:00B5A0 5003              JNC      ?C0018?AGI
  172:     return 0; /** Error!!*/
  173:   }
B2:00B5A2 7F00              MOV      R7,#00H
B2:00B5A4 22                RET      
  174:   return 1 + myAgi.tableEndpoint[endpoint].tableSize; /* Lifeline group + grouptable size.*/
B2:00B5A5         ?C0018?AGI:
  175: }
B2:00B5A5 12CBD8            LCALL    ?L?COM021F
B2:00B5A8 E0                MOVX     A,@DPTR
B2:00B5A9 04                INC      A
B2:00B5AA FF                MOV      R7,A
  176: 
B2:00B5AB 22                RET      
----- FUNCTION _CC_AGI_groupCount_handler (END) -------


----- FUNCTION _handleGetMaxAssociationGroups (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  201: handleGetMaxAssociationGroups(BYTE endpoint)
  202: {
;---- Variable 'endpoint' assigned to Register 'R7' ----
  203:   return CC_AGI_groupCount_handler(endpoint);
  204: }
B2:00B5AC 80EF              SJMP     _CC_AGI_groupCount_handler
----- FUNCTION _handleGetMaxAssociationGroups (END) -------


----- FUNCTION _handleApplBinarySwitchSet (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 690


 FILE: 'SWITCHONOFF.C'
 1000: handleApplBinarySwitchSet(CMD_CLASS_BIN_SW_VAL val, BYTE endpoint )
 1001: {
;---- Variable 'val' assigned to Register 'R7' ----
 1002:   UNUSED(endpoint);
 1003:   ZW_DEBUG_MYPRODUCT_SEND_NL();
 1004:   ZW_DEBUG_MYPRODUCT_SEND_STR("handleApplBinarySwitchSet");
 1005:   ZW_DEBUG_MYPRODUCT_SEND_NUM(val);
 1006: 
 1007:   onOffState = val;
B2:00B5AE 903813            MOV      DPTR,#onOffState
B2:00B5B1 EF                MOV      A,R7
B2:00B5B2 F0                MOVX     @DPTR,A
B2:00B5B3 FD                MOV      R5,A
 1008:   MemoryPutByte((WORD)&OnOffState_far, onOffState);
B2:00B5B4 7E13              MOV      R6,#HIGH OnOffState_far
B2:00B5B6 7FD8              MOV      R7,#LOW OnOffState_far
B2:00B5B8 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1009:   RefreshMMI();
B2:00B5BB 02ACD5            LJMP     RefreshMMI
----- FUNCTION _handleApplBinarySwitchSet (END) -------


----- FUNCTION _GetMultiChannelEndPointFunctionality (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  128: GetMultiChannelEndPointFunctionality(EP_FUNCTIONALITY_DATA* pFunc)
  129: {
B2:00B5BE 90431E            MOV      DPTR,#pFunc
B2:00B5C1 1225A9            LCALL    ?C?PSTXDATA
  130:   if(NON_NULL( myTransportEndpoint.pFunctionality ))
  131:   {
B2:00B5C4 9035F5            MOV      DPTR,#myTransportEndpoint+01H
B2:00B5C7 122589            LCALL    ?C?PLDXDATA
B2:00B5CA E9                MOV      A,R1
B2:00B5CB 4A                ORL      A,R2
B2:00B5CC 6047              JZ       ?C0005?ZW_TRANSPORTENDPOINT
  132:     pFunc->bDdata[0] = myTransportEndpoint.pFunctionality->bits.resZero |
  133:                      (myTransportEndpoint.pFunctionality->bits.identical << 6) |
B2:00B5CE 128F41            LCALL    ?L?COM002A
B2:00B5D1 FF                MOV      R7,A
B2:00B5D2 C4                SWAP     A
B2:00B5D3 13                RRC      A
B2:00B5D4 13                RRC      A
B2:00B5D5 5401              ANL      A,#01H
B2:00B5D7 C4                SWAP     A
B2:00B5D8 33                RLC      A
B2:00B5D9 33                RLC      A
B2:00B5DA 54C0              ANL      A,#0C0H
B2:00B5DC FE                MOV      R6,A
B2:00B5DD EF                MOV      A,R7
B2:00B5DE 543F              ANL      A,#03FH
B2:00B5E0 4E                ORL      A,R6
B2:00B5E1 FF                MOV      R7,A
B2:00B5E2 128F41            LCALL    ?L?COM002A
B2:00B5E5 D117              ACALL    ?L?COM01A9
B2:00B5E7 4F                ORL      A,R7
B2:00B5E8 FF                MOV      R7,A
B2:00B5E9 90431E            MOV      DPTR,#pFunc
B2:00B5EC 123F95            LCALL    ?L?COM00C0
  134:                      (myTransportEndpoint.pFunctionality->bits.dynamic << 7);
  135:     pFunc->bDdata[1] = (((myTransportEndpoint.pFunctionality->bits.nbrIndividualEndpoints |
B2:00B5EF 9035F5            MOV      DPTR,#myTransportEndpoint+01H
B2:00B5F2 12AE26            LCALL    ?L?COM0049
B2:00B5F5 D116              ACALL    ?L?COM01A8
B2:00B5F7 B186              ACALL    ?L?COM051C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 691


B2:00B5F9 90431E            MOV      DPTR,#pFunc
B2:00B5FC 12A5A3            LCALL    ?L?COM001F
B2:00B5FF EF                MOV      A,R7
B2:00B600 122084            LCALL    ?C?CSTOPTR
  136:                      (myTransportEndpoint.pFunctionality->bits.resIndZeorBit << 7))));
  137:     pFunc->bDdata[2] = (((myTransportEndpoint.pFunctionality->bits.nbrAggregatedEndpoints |
B2:00B603 9035F5            MOV      DPTR,#myTransportEndpoint+01H
B2:00B606 12A5A3            LCALL    ?L?COM001F
B2:00B609 121FF0            LCALL    ?C?CLDOPTR
B2:00B60C D116              ACALL    ?L?COM01A8
B2:00B60E B186              ACALL    ?L?COM051C
B2:00B610 90431E            MOV      DPTR,#pFunc
B2:00B613 D1A3              ACALL    ?L?COM00B3
  138:                      (myTransportEndpoint.pFunctionality->bits.resAggZeorBit << 7))));
  139:   }
  140: 
  141: }
B2:00B615         ?C0005?ZW_TRANSPORTENDPOINT:
B2:00B615 22                RET      
----- FUNCTION _GetMultiChannelEndPointFunctionality (END) -------


----- FUNCTION ?L?COM01A8 (BEGIN) -----
B2:00B616 FF                MOV      R7,A
B2:00B617         ?L?COM01A9:
B2:00B617 C4                SWAP     A
B2:00B618 13                RRC      A
B2:00B619 13                RRC      A
B2:00B61A 13                RRC      A
B2:00B61B         ?L?COM01AA:
B2:00B61B 5401              ANL      A,#01H
B2:00B61D         ?L?COM01AB:
B2:00B61D C4                SWAP     A
B2:00B61E 33                RLC      A
B2:00B61F 33                RLC      A
B2:00B620 33                RLC      A
B2:00B621 5480              ANL      A,#080H
B2:00B623 22                RET      
----- FUNCTION ?L?COM01A8 (END) -------


----- FUNCTION _CmdClassFirmwareUpdateMdGet (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSFIRMWAREUPDATE.C'
  341: CmdClassFirmwareUpdateMdGet(
  342:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00B624 903DDC            MOV      DPTR,#rxOpt
B2:00B627 1225A9            LCALL    ?C?PSTXDATA
B2:00B62A 903DDF            MOV      DPTR,#firmwareUpdateReportNumber
B2:00B62D EC                MOV      A,R4
B2:00B62E F0                MOVX     @DPTR,A
B2:00B62F A3                INC      DPTR
B2:00B630 ED                MOV      A,R5
B2:00B631 F0                MOVX     @DPTR,A
  343:   WORD firmwareUpdateReportNumber)
  344: {
  345:   ZW_APPLICATION_TX_BUFFER* pTxBuf = GetRequestBuffer(NULL);
B2:00B632 E4                CLR      A
B2:00B633 FF                MOV      R7,A
B2:00B634 FE                MOV      R6,A
B2:00B635 D1AD              ACALL    _GetRequestBuffer
B2:00B637 903DE1            MOV      DPTR,#pTxBuf
B2:00B63A 1225A9            LCALL    ?C?PSTXDATA
  346:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX* pTxOptionsEx = NULL;
B2:00B63D 5199              ACALL    ?L?COM0069
B2:00B63F 903DE4            MOV      DPTR,#pTxOptionsEx
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 692


B2:00B642 1225A9            LCALL    ?C?PSTXDATA
  347:   RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00B645 0B                INC      R3
B2:00B646 7A3D              MOV      R2,#HIGH pTxOptionsEx
B2:00B648 79E4              MOV      R1,#LOW pTxOptionsEx
B2:00B64A 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00B64D 1225A9            LCALL    ?C?PSTXDATA
B2:00B650 903DDC            MOV      DPTR,#rxOpt
B2:00B653 12AB5D            LCALL    ?L?COM0107
  348: 
  349:   ZW_DEBUG_FIRMWARE_UPDATE_SEND_STR("CmdClassFirmwareUpdateMdGet");
  350:   ZW_DEBUG_FIRMWARE_UPDATE_SEND_WORD_NUM(firmwareUpdateReportNumber);
  351:   if (pTxBuf != NULL)
B2:00B656 903DE1            MOV      DPTR,#pTxBuf
B2:00B659 122589            LCALL    ?C?PLDXDATA
B2:00B65C E9                MOV      A,R1
B2:00B65D 4A                ORL      A,R2
B2:00B65E 603C              JZ       ?C0026?COMMANDCLASSFIRMWAREUPDATE
  352:   {
  353:   /* Ask for the next report */
  354:     pTxBuf->ZW_FirmwareUpdateMdGetV4Frame.cmdClass = COMMAND_CLASS_FIRMWARE_UPDATE_MD_V4;
B2:00B660 903DE1            MOV      DPTR,#pTxBuf
B2:00B663 12D95D            LCALL    ?L?COM0268
  355:     pTxBuf->ZW_FirmwareUpdateMdGetV4Frame.cmd = FIRMWARE_UPDATE_MD_GET_V4;
B2:00B666 903DE1            MOV      DPTR,#pTxBuf
B2:00B669 12A5A3            LCALL    ?L?COM001F
B2:00B66C 7405              MOV      A,#05H
B2:00B66E 12CB21            LCALL    ?L?COM01DB
  356:     pTxBuf->ZW_FirmwareUpdateMdGetV4Frame.numberOfReports = 1;
  357:     pTxBuf->ZW_FirmwareUpdateMdGetV4Frame.properties1 = firmwareUpdateReportNumber >> 8;
B2:00B671 903DDF            MOV      DPTR,#firmwareUpdateReportNumber
B2:00B674 12D911            LCALL    ?L?COM0184
B2:00B677 12716F            LCALL    ?L?COM0313
  358:     pTxBuf->ZW_FirmwareUpdateMdGetV4Frame.reportNumber2 = firmwareUpdateReportNumber & 0xFF;
B2:00B67A ED                MOV      A,R5
B2:00B67B D1DA              ACALL    ?L?COM039E
  359:     if(ZW_TX_IN_PROGRESS != Transport_SendRequestEP(
  360:         (BYTE *)pTxBuf,
B2:00B67D C003              PUSH     AR3
B2:00B67F C002              PUSH     AR2
B2:00B681 C001              PUSH     AR1
B2:00B683 903DE4            MOV      DPTR,#pTxOptionsEx
B2:00B686 12CD41            LCALL    ?L?COM0213
B2:00B689 D001              POP      AR1
B2:00B68B D002              POP      AR2
B2:00B68D D003              POP      AR3
B2:00B68F 9150              ACALL    ?L?COM03E3
B2:00B691 6006              JZ       ?C0027?COMMANDCLASSFIRMWAREUPDATE
  361:         sizeof(ZW_FIRMWARE_UPDATE_MD_GET_V4_FRAME),
  362:         pTxOptionsEx,
  363:         ZCB_RequestJobStatus))
  364:     {
  365:       FreeRequestBuffer();
B2:00B693 12CCF6            LCALL    FreeRequestBuffer
  366:       return JOB_STATUS_BUSY;
B2:00B696 7F01              MOV      R7,#01H
B2:00B698 22                RET      
  367:     }
B2:00B699         ?C0027?COMMANDCLASSFIRMWAREUPDATE:
  368:     return JOB_STATUS_SUCCESS;
B2:00B699 7F00              MOV      R7,#00H
B2:00B69B 22                RET      
  369:   }
B2:00B69C         ?C0026?COMMANDCLASSFIRMWAREUPDATE:
  370:   return JOB_STATUS_BUSY;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 693


B2:00B69C 7F01              MOV      R7,#01H
  371: 
  372: 
  373: }
B2:00B69E 22                RET      
----- FUNCTION _CmdClassFirmwareUpdateMdGet (END) -------


----- FUNCTION ?L?COM00B2 (BEGIN) -----
B2:00B69F FF                MOV      R7,A
B2:00B6A0 903A4A            MOV      DPTR,#pTxBuf
B2:00B6A3         ?L?COM00B3:
B2:00B6A3 122589            LCALL    ?C?PLDXDATA
B2:00B6A6 900002            MOV      DPTR,#02H
B2:00B6A9 EF                MOV      A,R7
B2:00B6AA 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM00B2 (END) -------


----- FUNCTION _GetRequestBuffer (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
   72: GetRequestBuffer( VOID_CALLBACKFUNC(completedFunc)(TRANSMISSION_RESULT * pTransmissionResult) )
   73: {
B2:00B6AD 90436E            MOV      DPTR,#completedFunc
B2:00B6B0 EE                MOV      A,R6
B2:00B6B1 F0                MOVX     @DPTR,A
B2:00B6B2 A3                INC      DPTR
B2:00B6B3 EF                MOV      A,R7
B2:00B6B4 12CD01            LCALL    ?L?COM04D4
B2:00B6B7 12D568            LCALL    _MutexSet
B2:00B6BA 4002              JC       ?C0002?ZW_TX_MUTEX
   74:   /*Set mutex*/
   75:   if(FALSE == MutexSet(&(myMutex.mutexAppActive)))
   76:   {
   77:     /*Mutex is not free.. stop current job*/
   78:     return NULL;
B2:00B6BC 4199              AJMP     ?L?COM0069
   79:   }
B2:00B6BE         ?C0002?ZW_TX_MUTEX:
   80:   myMutex.pAppJob = completedFunc;
B2:00B6BE 90436E            MOV      DPTR,#completedFunc
B2:00B6C1 E0                MOVX     A,@DPTR
B2:00B6C2 FF                MOV      R7,A
B2:00B6C3 A3                INC      DPTR
B2:00B6C4 E0                MOVX     A,@DPTR
B2:00B6C5 902EA5            MOV      DPTR,#myMutex+02H
B2:00B6C8 CF                XCH      A,R7
B2:00B6C9 F0                MOVX     @DPTR,A
B2:00B6CA A3                INC      DPTR
B2:00B6CB EF                MOV      A,R7
B2:00B6CC F0                MOVX     @DPTR,A
   81:   CommandClassSupervisionGetAdd(&(myMutex.reqTxBuf.supervisionGet));
B2:00B6CD D1E0              ACALL    ?L?COM0459
B2:00B6CF 12D8CE            LCALL    _CommandClassSupervisionGetAdd
   82: 
   83:   return &(myMutex.reqTxBuf.appTxBuf);
B2:00B6D2 7B01              MOV      R3,#01H
B2:00B6D4 7A2E              MOV      R2,#HIGH myMutex+0EH
B2:00B6D6 79B1              MOV      R1,#LOW myMutex+0EH
   84: }
B2:00B6D8 22                RET      
----- FUNCTION _GetRequestBuffer (END) -------


----- FUNCTION ?L?COM039D (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 694


B2:00B6D9 E0                MOVX     A,@DPTR
B2:00B6DA         ?L?COM039E:
B2:00B6DA 900004            MOV      DPTR,#04H
B2:00B6DD 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM039D (END) -------


----- FUNCTION ?L?COM0459 (BEGIN) -----
B2:00B6E0 7B01              MOV      R3,#01H
B2:00B6E2 7A2E              MOV      R2,#HIGH myMutex+0AH
B2:00B6E4 79AD              MOV      R1,#LOW myMutex+0AH
B2:00B6E6 22                RET      
----- FUNCTION ?L?COM0459 (END) -------


----- FUNCTION SetDefaultConfiguration (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
 1017: SetDefaultConfiguration(void)
 1018: {
 1019:   ZW_DEBUG_MYPRODUCT_SEND_NL();
 1020:   ZW_DEBUG_MYPRODUCT_SEND_BYTE('C');
 1021:   ZW_DEBUG_MYPRODUCT_SEND_BYTE('d');
 1022:   onOffState = 0;
B2:00B6E7 E4                CLR      A
B2:00B6E8 903813            MOV      DPTR,#onOffState
B2:00B6EB F0                MOVX     @DPTR,A
 1023:   /* Mark stored configuration as OK */
 1024:   MemoryPutByte((WORD)&OnOffState_far, onOffState);
B2:00B6EC 7E13              MOV      R6,#HIGH OnOffState_far
B2:00B6EE 7FD8              MOV      R7,#LOW OnOffState_far
B2:00B6F0 FD                MOV      R5,A
B2:00B6F1 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1025:   MemoryPutByte((WORD)&EEOFFSET_MAGIC_far, APPL_MAGIC_VALUE);
B2:00B6F4 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_far
B2:00B6F6 7FD9              MOV      R7,#LOW EEOFFSET_MAGIC_far
B2:00B6F8 7D55              MOV      R5,#055H
B2:00B6FA 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1026:   MemoryPutByte( (WORD)&EEOFFSET_SWITCH_ALL_MODE_far[0],
B2:00B6FD 7E13              MOV      R6,#HIGH EEOFFSET_SWITCH_ALL_MODE_far
B2:00B6FF 7FF8              MOV      R7,#LOW EEOFFSET_SWITCH_ALL_MODE_far
B2:00B701 7DFF              MOV      R5,#0FFH
B2:00B703 021B7E            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION SetDefaultConfiguration (END) -------


----- FUNCTION _CmdClassFirmwareUpdateMdStatusReport (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSFIRMWAREUPDATE.C'
  298: CmdClassFirmwareUpdateMdStatusReport(
  299:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00B706 903BA0            MOV      DPTR,#rxOpt
B2:00B709 1225A9            LCALL    ?C?PSTXDATA
B2:00B70C 903BA3            MOV      DPTR,#status
B2:00B70F ED                MOV      A,R5
B2:00B710 F0                MOVX     @DPTR,A
  300:   BYTE status,
  301:   WORD waitTime,
  302:   VOID_CALLBACKFUNC(pCbFunc)(TRANSMISSION_RESULT * pTransmissionResult))
  303: {
  304:   ZW_APPLICATION_TX_BUFFER* pTxBuf = GetRequestBuffer(pCbFunc);
B2:00B711 12DB71            LCALL    ?L?COM0580
B2:00B714 D1AD              ACALL    _GetRequestBuffer
B2:00B716 903BA8            MOV      DPTR,#pTxBuf
B2:00B719 1225A9            LCALL    ?C?PSTXDATA
  305:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX* pTxOptionsEx = NULL;
B2:00B71C 5199              ACALL    ?L?COM0069
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 695


B2:00B71E 903BAB            MOV      DPTR,#pTxOptionsEx
B2:00B721 1225A9            LCALL    ?C?PSTXDATA
  306:   RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00B724 0B                INC      R3
B2:00B725 7A3B              MOV      R2,#HIGH pTxOptionsEx
B2:00B727 79AB              MOV      R1,#LOW pTxOptionsEx
B2:00B729 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00B72C 1225A9            LCALL    ?C?PSTXDATA
B2:00B72F 903BA0            MOV      DPTR,#rxOpt
B2:00B732 12AB5D            LCALL    ?L?COM0107
  307:   /* Send status, when finished */
  308:   if (pTxBuf != NULL)
B2:00B735 903BA8            MOV      DPTR,#pTxBuf
B2:00B738 122589            LCALL    ?C?PLDXDATA
B2:00B73B E9                MOV      A,R1
B2:00B73C 4A                ORL      A,R2
B2:00B73D 6061              JZ       ?C0023?COMMANDCLASSFIRMWAREUPDATE
  309:   {
  310:     pTxBuf->ZW_FirmwareUpdateMdStatusReportV4Frame.cmdClass = COMMAND_CLASS_FIRMWARE_UPDATE_MD_V4;
B2:00B73F 903BA8            MOV      DPTR,#pTxBuf
B2:00B742 12D95D            LCALL    ?L?COM0268
  311:     pTxBuf->ZW_FirmwareUpdateMdStatusReportV4Frame.cmd = FIRMWARE_UPDATE_MD_STATUS_REPORT_V4;
B2:00B745 903BA8            MOV      DPTR,#pTxBuf
B2:00B748 12A5A3            LCALL    ?L?COM001F
B2:00B74B 7407              MOV      A,#07H
B2:00B74D 122084            LCALL    ?C?CSTOPTR
  312:     pTxBuf->ZW_FirmwareUpdateMdStatusReportV4Frame.status = status;
B2:00B750 903BA3            MOV      DPTR,#status
B2:00B753 12CFD1            LCALL    ?L?COM0368
  313:     pTxBuf->ZW_FirmwareUpdateMdStatusReportV4Frame.waittime1 = (waitTime >> 8);
B2:00B756 903BA4            MOV      DPTR,#waitTime
B2:00B759 12D911            LCALL    ?L?COM0184
B2:00B75C 12716F            LCALL    ?L?COM0313
  314:     pTxBuf->ZW_FirmwareUpdateMdStatusReportV4Frame.waittime2 = (waitTime & 0xff);
B2:00B75F ED                MOV      A,R5
B2:00B760 D1DA              ACALL    ?L?COM039E
  315:     if(ZW_TX_IN_PROGRESS != Transport_SendRequestEP(
  316:         (BYTE *)pTxBuf,
B2:00B762 C003              PUSH     AR3
B2:00B764 C002              PUSH     AR2
B2:00B766 C001              PUSH     AR1
B2:00B768 903BAB            MOV      DPTR,#pTxOptionsEx
B2:00B76B 12CD41            LCALL    ?L?COM0213
B2:00B76E D001              POP      AR1
B2:00B770 D002              POP      AR2
B2:00B772 D003              POP      AR3
B2:00B774 9150              ACALL    ?L?COM03E3
B2:00B776 6025              JZ       ?C0024?COMMANDCLASSFIRMWAREUPDATE
  317:         sizeof(ZW_FIRMWARE_UPDATE_MD_STATUS_REPORT_V4_FRAME),
  318:         pTxOptionsEx,
  319:         ZCB_RequestJobStatus))
  320:     {
  321:       TRANSMISSION_RESULT result = {0xff, TRANSMIT_COMPLETE_FAIL, TRANSMISSION_RESULT_FINISHED};
B2:00B778 78AE              MOV      R0,#LOW result
B2:00B77A 7C3B              MOV      R4,#HIGH result
B2:00B77C 7D01              MOV      R5,#01H
B2:00B77E 7BFF              MOV      R3,#0FFH
B2:00B780 7A32              MOV      R2,#HIGH _?ix1000
B2:00B782 7992              MOV      R1,#LOW _?ix1000
B2:00B784 7F03              MOV      R7,#03H
B2:00B786 1273E9            LCALL    ?L?COM05E1
B2:00B789 7A3B              MOV      R2,#HIGH result
B2:00B78B 79AE              MOV      R1,#LOW result
B2:00B78D 12DB71            LCALL    ?L?COM0580
B2:00B790 F582              MOV      DPL,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 696


B2:00B792 8E83              MOV      DPH,R6
B2:00B794 12271A            LCALL    ?C?ICALL2
  322:       pCbFunc(&result);
  323:       FreeRequestBuffer();
B2:00B797 12CCF6            LCALL    FreeRequestBuffer
  324:       return JOB_STATUS_BUSY;
B2:00B79A 7F01              MOV      R7,#01H
B2:00B79C 22                RET      
  325:     }
B2:00B79D         ?C0024?COMMANDCLASSFIRMWAREUPDATE:
  326:      return JOB_STATUS_SUCCESS;
B2:00B79D 7F00              MOV      R7,#00H
B2:00B79F 22                RET      
  327:   }
B2:00B7A0         ?C0023?COMMANDCLASSFIRMWAREUPDATE:
  328:   return JOB_STATUS_BUSY;
B2:00B7A0 7F01              MOV      R7,#01H
  329: }
B2:00B7A2 22                RET      
----- FUNCTION _CmdClassFirmwareUpdateMdStatusReport (END) -------


----- FUNCTION _handleCommandClassBasic (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSBASIC.C'
   37: received_frame_status_t handleCommandClassBasic(
   38:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00B7A3 903CF8            MOV      DPTR,#rxOpt
B2:00B7A6 1225A9            LCALL    ?C?PSTXDATA
   39:   ZW_APPLICATION_TX_BUFFER *pCmd,
   40:   BYTE cmdLength)
   41: {
   42:   UNUSED(cmdLength);
   43:   switch (pCmd->ZW_Common.cmd)
B2:00B7A9 903CFB            MOV      DPTR,#pCmd
B2:00B7AC 12A5A3            LCALL    ?L?COM001F
B2:00B7AF 121FF0            LCALL    ?C?CLDOPTR
B2:00B7B2 24FE              ADD      A,#0FEH
B2:00B7B4 6027              JZ       ?C0005?COMMANDCLASSBASIC
B2:00B7B6 04                INC      A
B2:00B7B7 6003              JZ       $ + 5H
B2:00B7B9 02B872            LJMP     ?C0009?COMMANDCLASSBASIC
   44:   {
   45:       //Must be ignored to avoid unintentional operation. Cannot be mapped to another command class.
   46:     case BASIC_SET:
B2:00B7BC         ?C0002?COMMANDCLASSBASIC:
   47:       if ((0x63 < pCmd->ZW_BasicSetV2Frame.value) && (0xFF != pCmd->ZW_BasicSetV2Frame.value))
B2:00B7BC 128F41            LCALL    ?L?COM002A
B2:00B7BF FF                MOV      R7,A
B2:00B7C0 7463              MOV      A,#063H
B2:00B7C2 C3                CLR      C
B2:00B7C3 9F                SUBB     A,R7
B2:00B7C4 5007              JNC      ?C0003?COMMANDCLASSBASIC
B2:00B7C6 EF                MOV      A,R7
B2:00B7C7 F4                CPL      A
B2:00B7C8 6003              JZ       ?C0003?COMMANDCLASSBASIC
   48:       {
   49:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00B7CA 7F02              MOV      R7,#02H
B2:00B7CC 22                RET      
   50:       }
B2:00B7CD         ?C0003?COMMANDCLASSBASIC:
   51:       handleBasicSetCommand(pCmd->ZW_BasicSetFrame.value, rxOpt->destNode.endpoint);
B2:00B7CD 128F41            LCALL    ?L?COM002A
B2:00B7D0 FF                MOV      R7,A
B2:00B7D1 903CF8            MOV      DPTR,#rxOpt
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 697


B2:00B7D4 12A93A            LCALL    ?L?COM0062
B2:00B7D7 FD                MOV      R5,A
B2:00B7D8 11FA              ACALL    _handleBasicSetCommand
   52:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00B7DA 7FFF              MOV      R7,#0FFH
B2:00B7DC 22                RET      
   53:       break;
   54: 
   55:     case BASIC_GET:
B2:00B7DD         ?C0005?COMMANDCLASSBASIC:
   56:       if(FALSE == Check_not_legal_response_job(rxOpt))
B2:00B7DD 903CF8            MOV      DPTR,#rxOpt
B2:00B7E0 12A19D            LCALL    ?L?COM01BF
B2:00B7E3 5003              JNC      $ + 5H
B2:00B7E5 02B86F            LJMP     ?C0006?COMMANDCLASSBASIC
   57:       {
   58:         ZW_APPLICATION_TX_BUFFER *pTxBuf = GetResponseBuffer();
B2:00B7E8 129A8C            LCALL    GetResponseBuffer
B2:00B7EB 903CFF            MOV      DPTR,#pTxBuf
B2:00B7EE 1225A9            LCALL    ?C?PSTXDATA
   59: 
   60:         /*Check pTxBuf is free*/
   61:         if( NON_NULL( pTxBuf ) )
B2:00B7F1 E9                MOV      A,R1
B2:00B7F2 4A                ORL      A,R2
B2:00B7F3 607A              JZ       ?C0006?COMMANDCLASSBASIC
   62:         {
   63:           TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
   64:           RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00B7F5 7B01              MOV      R3,#01H
B2:00B7F7 7A3D              MOV      R2,#HIGH pTxOptionsEx
B2:00B7F9 7902              MOV      R1,#LOW pTxOptionsEx
B2:00B7FB 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00B7FE 1225A9            LCALL    ?C?PSTXDATA
B2:00B801 903CF8            MOV      DPTR,#rxOpt
B2:00B804 12AB5D            LCALL    ?L?COM0107
   65:           /* Controller wants the sensor level */
   66:           pTxBuf->ZW_BasicReportFrame.cmdClass = COMMAND_CLASS_BASIC;
B2:00B807 903CFF            MOV      DPTR,#pTxBuf
B2:00B80A 122589            LCALL    ?C?PLDXDATA
B2:00B80D 7420              MOV      A,#020H
B2:00B80F 122072            LCALL    ?C?CSTPTR
   67:           pTxBuf->ZW_BasicReportFrame.cmd = BASIC_REPORT;
B2:00B812 903CFF            MOV      DPTR,#pTxBuf
B2:00B815 12A5A3            LCALL    ?L?COM001F
B2:00B818 7403              MOV      A,#03H
B2:00B81A 122084            LCALL    ?C?CSTOPTR
   68: 
   69:           pTxBuf->ZW_BasicReportV2Frame.currentValue =  getAppBasicReport(pTxOptionsEx->sourceEndpoint);
B2:00B81D 903D02            MOV      DPTR,#pTxOptionsEx
B2:00B820 128F3E            LCALL    ?L?COM0029
B2:00B823 FF                MOV      R7,A
B2:00B824 12A18D            LCALL    _getAppBasicReport
B2:00B827 903CFF            MOV      DPTR,#pTxBuf
B2:00B82A 12B6A3            LCALL    ?L?COM00B3
   70:           pTxBuf->ZW_BasicReportV2Frame.targetValue =  getAppBasicReportTarget(pTxOptionsEx->sourceEndpoint);
B2:00B82D 903D02            MOV      DPTR,#pTxOptionsEx
B2:00B830 128F3E            LCALL    ?L?COM0029
B2:00B833 FF                MOV      R7,A
B2:00B834 12A18F            LCALL    _getAppBasicReportTarget
B2:00B837 903CFF            MOV      DPTR,#pTxBuf
B2:00B83A 12B57F            LCALL    ?L?COM00E6
B2:00B83D EF                MOV      A,R7
B2:00B83E 122084            LCALL    ?C?CSTOPTR
   71:           pTxBuf->ZW_BasicReportV2Frame.duration =  getAppBasicReportDuration(pTxOptionsEx->sourceEndpoint);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 698


B2:00B841 903D02            MOV      DPTR,#pTxOptionsEx
B2:00B844 128F3E            LCALL    ?L?COM0029
B2:00B847 FF                MOV      R7,A
B2:00B848 12B125            LCALL    _getAppBasicReportDuration
B2:00B84B 903CFF            MOV      DPTR,#pTxBuf
B2:00B84E F124              ACALL    ?L?COM0211
   72:           if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
   73:               (BYTE *)pTxBuf,
B2:00B850 C003              PUSH     AR3
B2:00B852 C002              PUSH     AR2
B2:00B854 C001              PUSH     AR1
B2:00B856 903D02            MOV      DPTR,#pTxOptionsEx
B2:00B859 12A147            LCALL    ?L?COM001D
B2:00B85C D001              POP      AR1
B2:00B85E D002              POP      AR2
B2:00B860 D003              POP      AR3
B2:00B862 7D05              MOV      R5,#05H
B2:00B864 12A13D            LCALL    ?L?COM00BD
B2:00B867 6003              JZ       ?C0008?COMMANDCLASSBASIC
   74:               sizeof(ZW_BASIC_REPORT_V2_FRAME),
   75:               pTxOptionsEx,
   76:               ZCB_ResponseJobStatus))
   77:           {
   78:             /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
   79:             FreeResponseBuffer();
B2:00B869 12A0B6            LCALL    FreeResponseBuffer
   80:           }
B2:00B86C         ?C0008?COMMANDCLASSBASIC:
   81:           return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00B86C 7FFF              MOV      R7,#0FFH
B2:00B86E 22                RET      
   82:         }
   83:       }
B2:00B86F         ?C0006?COMMANDCLASSBASIC:
   84:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00B86F 7F02              MOV      R7,#02H
B2:00B871 22                RET      
   85:       break;
   86:     default:
B2:00B872         ?C0009?COMMANDCLASSBASIC:
   87:       return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00B872 7F00              MOV      R7,#00H
B2:00B874 22                RET      
   88:   }
----- FUNCTION _handleCommandClassBasic (END) -------


----- FUNCTION ToggleLed (BEGIN) -----
 FILE: 'SWITCHONOFF.C'
 1089: ToggleLed(void)
 1090: {
 1091:   if (onOffState)
 1092:   {
B2:00B875 903813            MOV      DPTR,#onOffState
B2:00B878 E0                MOVX     A,@DPTR
B2:00B879 6004              JZ       ?C0111?SWITCHONOFF
 1093:     onOffState = 0;
 1094:   }
B2:00B87B E4                CLR      A
B2:00B87C F0                MOVX     @DPTR,A
 1095:   else
B2:00B87D 8006              SJMP     ?C0112?SWITCHONOFF
B2:00B87F         ?C0111?SWITCHONOFF:
 1096:   {
 1097:     onOffState = 0xff;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 699


B2:00B87F 903813            MOV      DPTR,#onOffState
B2:00B882 74FF              MOV      A,#0FFH
B2:00B884 F0                MOVX     @DPTR,A
 1098:   }
B2:00B885         ?C0112?SWITCHONOFF:
 1099:   RefreshMMI();
B2:00B885 12ACD5            LCALL    RefreshMMI
 1100:   MemoryPutByte((WORD)&OnOffState_far, onOffState);
B2:00B888 7E13              MOV      R6,#HIGH OnOffState_far
B2:00B88A 7FD8              MOV      R7,#LOW OnOffState_far
B2:00B88C 903813            MOV      DPTR,#onOffState
B2:00B88F E0                MOVX     A,@DPTR
B2:00B890 FD                MOV      R5,A
B2:00B891 021B7E            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION ToggleLed (END) -------


----- FUNCTION _gpio_GetPinSwapList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  112: gpio_GetPinSwapList(PIN_T_ARRAY xdata ** pPinList, BYTE * const pPinListSize)
  113: {
;---- Variable 'pPinList' assigned to Register 'R1/R2/R3' ----
  114:   *pPinList = (PIN_T_ARRAY xdata *)&pins;
  115:   *pPinListSize = sizeof(pins) / sizeof(PIN_T);
B2:00B894 743C              MOV      A,#HIGH pins
B2:00B896 75F019            MOV      B,#LOW pins
B2:00B899 12221F            LCALL    ?C?ISTPTR
  116: }
B2:00B89C 904135            MOV      DPTR,#pPinListSize
B2:00B89F 122589            LCALL    ?C?PLDXDATA
B2:00B8A2 7402              MOV      A,#02H
B2:00B8A4 022072            LJMP     ?C?CSTPTR
----- FUNCTION _gpio_GetPinSwapList (END) -------


----- FUNCTION _ZDP03A_InitHW (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  122: void ZDP03A_InitHW(
  123:   VOID_CALLBACKFUNC(pEventKeyQueue)(BYTE))             /*function-pointer to application event-queue or state mac
>> hine*/
B2:00B8A7 904364            MOV      DPTR,#pEventKeyQueue
B2:00B8AA EE                MOV      A,R6
B2:00B8AB F0                MOVX     @DPTR,A
B2:00B8AC A3                INC      DPTR
B2:00B8AD EF                MOV      A,R7
B2:00B8AE F0                MOVX     @DPTR,A
  124: {
  125:   ZW_DEBUG_IO_ZDP03A_SEND_STR("InitZDP03A");
  126: 
  127:   gpio_DriverInit(TRUE);
B2:00B8AF D23F              SETB     ?gpio_DriverInit?BIT
B2:00B8B1 F18A              ACALL    gpio_DriverInit
  128:   mykeyMan.pEventKeyQueue = pEventKeyQueue;
B2:00B8B3 904364            MOV      DPTR,#pEventKeyQueue
B2:00B8B6 E0                MOVX     A,@DPTR
B2:00B8B7 FF                MOV      R7,A
B2:00B8B8 A3                INC      DPTR
B2:00B8B9 E0                MOVX     A,@DPTR
B2:00B8BA 903C1D            MOV      DPTR,#mykeyMan
B2:00B8BD CF                XCH      A,R7
B2:00B8BE F0                MOVX     @DPTR,A
B2:00B8BF A3                INC      DPTR
B2:00B8C0 EF                MOV      A,R7
B2:00B8C1 F0                MOVX     @DPTR,A
  129: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 700


  130:   /*
  131:    * Initialize keys.
  132:    */
  133:   if (!KeyDriverInit())
B2:00B8C2 7100              ACALL    KeyDriverInit
  134:   {
  135:     //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  136:     //ZW_DEBUG_IO_ZDP03A_SEND_STR("Couldn't initialize Key Driver :(");
  137:   }
B2:00B8C4         ?C0002?IO_ZDP03A:
  138: 
  139:   /**
  140:    * Setup interrupt for EXT1 which is used by the key driver.
  141:    */
  142:   gpio_SetPinIn(ZDP03A_KEY_INTP, TRUE);
B2:00B8C4 D240              SETB     ?_gpio_SetPinIn?BIT
B2:00B8C6 7F11              MOV      R7,#011H
B2:00B8C8 3150              ACALL    _gpio_SetPinIn
  143:   ZW_SetExtIntLevel(ZW_INT1, FALSE);
B2:00B8CA E4                CLR      A
B2:00B8CB FD                MOV      R5,A
B2:00B8CC 7F01              MOV      R7,#01H
B2:00B8CE 125054            LCALL    _ZW_SetExtIntLevel
  144:   EX1 = 1; // Enable external interrupt 1
B2:00B8D1 D2AA              SETB     EX1
  145: 
  146: #ifdef TEST_INTERFACE_SUPPORT
  147:   if (TRUE == ZW_test_interface_allocate('a', ZCB_AppTestInterface))
B2:00B8D3 7C1E              MOV      R4,#HIGH ?INTERBANK_TABLE?_ZCB_AppTestInterface
B2:00B8D5 7D26              MOV      R5,#LOW ?INTERBANK_TABLE?_ZCB_AppTestInterface
B2:00B8D7 7F61              MOV      R7,#061H
B2:;----                  JMP      _ZW_test_interface_allocate
  148:   {
  149:     //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  150:     //ZW_DEBUG_IO_ZDP03A_SEND_STR("TI init.");
  151:   }
  152:   else
  153: #endif
  154:   {
  155:     //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  156:     //ZW_DEBUG_IO_ZDP03A_SEND_STR("No TI.");
  157:   }
----- FUNCTION _ZDP03A_InitHW (END) -------


----- FUNCTION _ZW_test_interface_allocate (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE.C'
  109: BOOL ZW_test_interface_allocate(char channel, VOID_CALLBACKFUNC(pCallback) (char channel, char * pString))
  110: {
B2:00B8D9 90426F            MOV      DPTR,#channel
B2:00B8DC 1270D0            LCALL    ?L?COM019F
  111:   uint8_t channel_index = 0;
  112: 
B2:00B8DF E4                CLR      A
B2:00B8E0 A3                INC      DPTR
B2:00B8E1 F0                MOVX     @DPTR,A
  113:   init_once();
B2:00B8E2 F1DD              ACALL    init_once
  114: 
  115:   if (INDEX_CHANNEL_NEW != get_index_from_channel(&channel_index, channel))
B2:00B8E4 7A42              MOV      R2,#HIGH channel_index
B2:00B8E6 7972              MOV      R1,#LOW channel_index
B2:00B8E8 90426F            MOV      DPTR,#channel
B2:00B8EB D1F6              ACALL    ?L?COM05E9
B2:00B8ED EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 701


B2:00B8EE 6401              XRL      A,#01H
B2:00B8F0 6002              JZ       ?C0004?ZW_TEST_INTERFACE
  116:   {
  117:     // The channel is not free.
  118:     ZW_DEBUG_TEST_INTERFACE_SEND_NL();
  119:     ZW_DEBUG_TEST_INTERFACE_SEND_STR("Can't allocate :(");
  120:     return FALSE;
B2:00B8F2 C3                CLR      C
B2:00B8F3 22                RET      
  121:   }
B2:00B8F4         ?C0004?ZW_TEST_INTERFACE:
  122: 
  123:   channels[channel_index].channel = channel;
B2:00B8F4 90426F            MOV      DPTR,#channel
B2:00B8F7 E0                MOVX     A,@DPTR
B2:00B8F8 FF                MOV      R7,A
B2:00B8F9 904272            MOV      DPTR,#channel_index
B2:00B8FC E0                MOVX     A,@DPTR
B2:00B8FD FE                MOV      R6,A
B2:00B8FE D1CF              ACALL    ?L?COM022F
B2:00B900 EF                MOV      A,R7
B2:00B901 F0                MOVX     @DPTR,A
  124:   channels[channel_index].pCallback = pCallback;
B2:00B902 904270            MOV      DPTR,#pCallback
B2:00B905 E0                MOVX     A,@DPTR
B2:00B906 FC                MOV      R4,A
B2:00B907 A3                INC      DPTR
B2:00B908 E0                MOVX     A,@DPTR
B2:00B909 FD                MOV      R5,A
B2:00B90A D10D              ACALL    ?L?COM0356
B2:00B90C 1245D0            LCALL    ?L?COM05CA
  125: 
  126:   ZW_DEBUG_TEST_INTERFACE_SEND_NL();
  127:   ZW_DEBUG_TEST_INTERFACE_SEND_STR("Allocation done!");
  128:   return TRUE;
B2:00B90F D3                SETB     C
  129: }
B2:00B910 22                RET      
----- FUNCTION _ZW_test_interface_allocate (END) -------


----- FUNCTION _SetPinIn (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  160: void SetPinIn( ZDP03A_KEY key, BOOL pullUp)
  161: {
B2:00B911 9043A5            MOV      DPTR,#key
B2:00B914 EF                MOV      A,R7
B2:00B915 F0                MOVX     @DPTR,A
  162:     //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  163:     //ZW_DEBUG_IO_ZDP03A_SEND_STR("SetPinIn key");
  164:     //ZW_DEBUG_IO_ZDP03A_SEND_NUM(key);
  165:     //ZW_DEBUG_IO_ZDP03A_SEND_NUM(pullUp);
  166:   switch(key)
B2:00B916 24DF              ADD      A,#0DFH
B2:00B918 6021              JZ       ?C0011?IO_ZDP03A
B2:00B91A 14                DEC      A
B2:00B91B 6018              JZ       ?C0010?IO_ZDP03A
B2:00B91D 24EE              ADD      A,#0EEH
B2:00B91F 6020              JZ       ?C0012?IO_ZDP03A
B2:00B921 24FE              ADD      A,#0FEH
B2:00B923 600A              JZ       ?C0008?IO_ZDP03A
B2:00B925 2412              ADD      A,#012H
B2:00B927 701E              JNZ      ?C0006?IO_ZDP03A
  167:   {
  168:     case ZDP03A_KEY_1:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 702


B2:00B929         ?C0007?IO_ZDP03A:
  169:       KeyDriverRegisterCallback(KEY01, key, BITFIELD_KEY_DOWN | BITFIELD_KEY_UP | BITFIELD_KEY_PRESS |BITFIELD_KE
>> Y_HOLD,  ZCB_KeyAction);
B2:00B929 511F              ACALL    ?L?COM0168
B2:00B92B E4                CLR      A
B2:00B92C FF                MOV      R7,A
  170:       break;
B2:00B92D 8016              SJMP     ?C0084?IO_ZDP03A
  171:     case ZDP03A_KEY_2:
B2:00B92F         ?C0008?IO_ZDP03A:
  172:       KeyDriverRegisterCallback(KEY02, key, BITFIELD_KEY_DOWN | BITFIELD_KEY_UP | BITFIELD_KEY_PRESS |BITFIELD_KE
>> Y_HOLD, ZCB_KeyAction);
B2:00B92F 511F              ACALL    ?L?COM0168
B2:00B931 7F01              MOV      R7,#01H
B2:00B933         
  173:       break;
B2:00B933 8010              SJMP     ?C0084?IO_ZDP03A
  174:     case ZDP03A_KEY_3:
  175:       // ZDP03A S3 is used for SPI/NVM.
  176:       break;
  177:     case ZDP03A_KEY_4:
B2:00B935         ?C0010?IO_ZDP03A:
  178:       KeyDriverRegisterCallback(KEY04, key, BITFIELD_KEY_DOWN | BITFIELD_KEY_UP | BITFIELD_KEY_PRESS |BITFIELD_KE
>> Y_HOLD, ZCB_KeyAction);
B2:00B935 511F              ACALL    ?L?COM0168
B2:00B937 7F03              MOV      R7,#03H
B2:00B939         
  179:       break;
B2:00B939 800A              SJMP     ?C0084?IO_ZDP03A
  180:     case ZDP03A_KEY_5:
B2:00B93B         ?C0011?IO_ZDP03A:
  181:       KeyDriverRegisterCallback(KEY05, key, BITFIELD_KEY_DOWN | BITFIELD_KEY_UP | BITFIELD_KEY_PRESS |BITFIELD_KE
>> Y_HOLD, ZCB_KeyAction);
B2:00B93B 511F              ACALL    ?L?COM0168
B2:00B93D 7F04              MOV      R7,#04H
B2:00B93F         
  182:       break;
B2:00B93F 8004              SJMP     ?C0084?IO_ZDP03A
  183:     case ZDP03A_KEY_6:
B2:00B941         ?C0012?IO_ZDP03A:
  184:       KeyDriverRegisterCallback(KEY06, key, BITFIELD_KEY_DOWN | BITFIELD_KEY_UP | BITFIELD_KEY_PRESS |BITFIELD_KE
>> Y_HOLD, ZCB_KeyAction);
B2:00B941 511F              ACALL    ?L?COM0168
B2:00B943 7F05              MOV      R7,#05H
B2:00B945         
B2:00B945 91C2              ACALL    _KeyDriverRegisterCallback
  185:       break;
  186:   }
B2:00B947         ?C0006?IO_ZDP03A:
  187:   gpio_SetPinIn(key, pullUp);
B2:00B947 9043A5            MOV      DPTR,#key
B2:00B94A E0                MOVX     A,@DPTR
B2:00B94B FF                MOV      R7,A
B2:00B94C A23C              MOV      C,pullUp
B2:00B94E 9240              MOV      ?_gpio_SetPinIn?BIT,C
B2:;----                  JMP      _gpio_SetPinIn
----- FUNCTION _SetPinIn (END) -------


----- FUNCTION _gpio_SetPinIn (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  315: gpio_SetPinIn(BYTE pin, BOOL fPullUp)
  316: {
B2:00B950 9043A8            MOV      DPTR,#pin
B2:00B953 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 703


B2:00B954 F0                MOVX     @DPTR,A
  317:   if (TRUE == fDoPinSwap)
  318:   {
B2:00B955 304208            JNB      fDoPinSwap,?C0061?GPIO_DRIVER
  319:     searchPinList(&pin);
  320:   }
B2:00B958 7B01              MOV      R3,#01H
B2:00B95A 7A43              MOV      R2,#HIGH pin
B2:00B95C 79A8              MOV      R1,#LOW pin
B2:00B95E 7120              ACALL    _searchPinList
  321:   PinIn(pin, fPullUp);
B2:00B960         ?C0061?GPIO_DRIVER:
  322: }
B2:00B960 9043A8            MOV      DPTR,#pin
B2:00B963 E0                MOVX     A,@DPTR
B2:00B964 FF                MOV      R7,A
B2:00B965 A240              MOV      C,fPullUp
B2:00B967 923E              MOV      ?_PinIn?BIT,C
B2:;----                  JMP      _PinIn
----- FUNCTION _gpio_SetPinIn (END) -------


----- FUNCTION _PinIn (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
   97: PinIn( BYTE pin, BOOL pullUp)
;---- Variable 'pin' assigned to Register 'R7' ----
;---- Variable 'port' assigned to Register 'R6' ----
;---- Variable 'portPin' assigned to Register 'R7' ----
B2:00B969 91B6              ACALL    ?L?COM029A
B2:00B96B 6036              JZ       ?C0010?GPIO_DRIVER
B2:00B96D 14                DEC      A
B2:00B96E 605B              JZ       ?C0013?GPIO_DRIVER
B2:00B970 14                DEC      A
B2:00B971 7002              JNZ      $ + 4H
B2:00B973 21F3              AJMP     ?C0016?GPIO_DRIVER
B2:00B975 2403              ADD      A,#03H
B2:00B977 6002              JZ       $ + 4H
B2:00B979 411B              AJMP     ?C0019?GPIO_DRIVER
   98: {
   99:   BYTE port = pin>>4;
  100:   BYTE portPin = pin&0x0F;
  101: 
  102:   switch(port)
  103:   {
  104:     case 0:
B2:00B97B         ?C0007?GPIO_DRIVER:
  105:       P0DIR_PAGE;
B2:00B97B 5131              ACALL    ?L?COM01F8
B2:00B97D 8002              SJMP     ?C0072?GPIO_DRIVER
B2:00B97F         ?C0071?GPIO_DRIVER:
B2:00B97F C3                CLR      C
B2:00B980 33                RLC      A
B2:00B981         ?C0072?GPIO_DRIVER:
B2:00B981 D8FC              DJNZ     R0,?C0071?GPIO_DRIVER
B2:00B983 FE                MOV      R6,A
B2:00B984 4268              ORL      P0ShadowDIR,A
  106:       (P0ShadowDIR |= (1 << portPin));
  107:       (pullUp)?(P0Shadow &=~(1 << portPin)):(P0Shadow |= (1 << portPin));
B2:00B986 303E05            JNB      pullUp,?C0008?GPIO_DRIVER
B2:00B989 F4                CPL      A
B2:00B98A 526C              ANL      P0Shadow,A
B2:00B98C 800D              SJMP     ?C0009?GPIO_DRIVER
B2:00B98E         ?C0008?GPIO_DRIVER:
B2:00B98E 7401              MOV      A,#01H
B2:00B990 A807              MOV      R0,AR7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 704


B2:00B992 08                INC      R0
B2:00B993 8002              SJMP     ?C0074?GPIO_DRIVER
B2:00B995         ?C0073?GPIO_DRIVER:
B2:00B995 C3                CLR      C
B2:00B996 33                RLC      A
B2:00B997         ?C0074?GPIO_DRIVER:
B2:00B997 D8FC              DJNZ     R0,?C0073?GPIO_DRIVER
B2:00B999 426C              ORL      P0Shadow,A
B2:00B99B         ?C0009?GPIO_DRIVER:
  108:       P0 = P0Shadow;P0DIR = P0ShadowDIR;
B2:00B99B 856C80            MOV      P0,P0Shadow
B2:00B99E 8568FD            MOV      P0DIR,P0ShadowDIR
  109:       break;
B2:00B9A1 807A              SJMP     ?C0006?GPIO_DRIVER
  110:     case 1:
B2:00B9A3         ?C0010?GPIO_DRIVER:
  111:       P1DIR_PAGE;
B2:00B9A3 5131              ACALL    ?L?COM01F8
B2:00B9A5 8002              SJMP     ?C0076?GPIO_DRIVER
B2:00B9A7         ?C0075?GPIO_DRIVER:
B2:00B9A7 C3                CLR      C
B2:00B9A8 33                RLC      A
B2:00B9A9         ?C0076?GPIO_DRIVER:
B2:00B9A9 D8FC              DJNZ     R0,?C0075?GPIO_DRIVER
B2:00B9AB FE                MOV      R6,A
B2:00B9AC 4269              ORL      P1ShadowDIR,A
  112:       (P1ShadowDIR |= (1<<portPin));
  113:       (pullUp)?(P1Shadow &=~(1 << portPin)):(P1Shadow |= (1 << portPin));
B2:00B9AE 303E05            JNB      pullUp,?C0011?GPIO_DRIVER
B2:00B9B1 F4                CPL      A
B2:00B9B2 526D              ANL      P1Shadow,A
B2:00B9B4 800D              SJMP     ?C0012?GPIO_DRIVER
B2:00B9B6         ?C0011?GPIO_DRIVER:
B2:00B9B6 7401              MOV      A,#01H
B2:00B9B8 A807              MOV      R0,AR7
B2:00B9BA 08                INC      R0
B2:00B9BB 8002              SJMP     ?C0078?GPIO_DRIVER
B2:00B9BD         ?C0077?GPIO_DRIVER:
B2:00B9BD C3                CLR      C
B2:00B9BE 33                RLC      A
B2:00B9BF         ?C0078?GPIO_DRIVER:
B2:00B9BF D8FC              DJNZ     R0,?C0077?GPIO_DRIVER
B2:00B9C1 426D              ORL      P1Shadow,A
B2:00B9C3         ?C0012?GPIO_DRIVER:
  114:       P1 = P1Shadow;P1DIR = P1ShadowDIR;
B2:00B9C3 856D90            MOV      P1,P1Shadow
B2:00B9C6 8569C9            MOV      P1DIR,P1ShadowDIR
  115:       break;
B2:00B9C9 8052              SJMP     ?C0006?GPIO_DRIVER
  116:     case 2:
B2:00B9CB         ?C0013?GPIO_DRIVER:
  117:       P2DIR_PAGE;
B2:00B9CB 5131              ACALL    ?L?COM01F8
B2:00B9CD 8002              SJMP     ?C0080?GPIO_DRIVER
B2:00B9CF         ?C0079?GPIO_DRIVER:
B2:00B9CF C3                CLR      C
B2:00B9D0 33                RLC      A
B2:00B9D1         ?C0080?GPIO_DRIVER:
B2:00B9D1 D8FC              DJNZ     R0,?C0079?GPIO_DRIVER
B2:00B9D3 FE                MOV      R6,A
B2:00B9D4 426A              ORL      P2ShadowDIR,A
  118:       (P2ShadowDIR |= (1<<portPin));
  119:       (pullUp)?(P2Shadow &=~(1 << portPin)):(P2Shadow |= (1 << portPin));
B2:00B9D6 303E05            JNB      pullUp,?C0014?GPIO_DRIVER
B2:00B9D9 F4                CPL      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 705


B2:00B9DA 526E              ANL      P2Shadow,A
B2:00B9DC 800D              SJMP     ?C0015?GPIO_DRIVER
B2:00B9DE         ?C0014?GPIO_DRIVER:
B2:00B9DE 7401              MOV      A,#01H
B2:00B9E0 A807              MOV      R0,AR7
B2:00B9E2 08                INC      R0
B2:00B9E3 8002              SJMP     ?C0082?GPIO_DRIVER
B2:00B9E5         ?C0081?GPIO_DRIVER:
B2:00B9E5 C3                CLR      C
B2:00B9E6 33                RLC      A
B2:00B9E7         ?C0082?GPIO_DRIVER:
B2:00B9E7 D8FC              DJNZ     R0,?C0081?GPIO_DRIVER
B2:00B9E9 426E              ORL      P2Shadow,A
B2:00B9EB         ?C0015?GPIO_DRIVER:
  120:       P2 = P2Shadow;P2DIR = P2ShadowDIR;
B2:00B9EB 856EA0            MOV      P2,P2Shadow
B2:00B9EE 856ACA            MOV      P2DIR,P2ShadowDIR
  121:       break;
B2:00B9F1 802A              SJMP     ?C0006?GPIO_DRIVER
  122:     case 3:
B2:00B9F3         ?C0016?GPIO_DRIVER:
  123:       P3DIR_PAGE;
B2:00B9F3 5131              ACALL    ?L?COM01F8
B2:00B9F5 8002              SJMP     ?C0084?GPIO_DRIVER
B2:00B9F7         ?C0083?GPIO_DRIVER:
B2:00B9F7 C3                CLR      C
B2:00B9F8 33                RLC      A
B2:00B9F9         ?C0084?GPIO_DRIVER:
B2:00B9F9 D8FC              DJNZ     R0,?C0083?GPIO_DRIVER
B2:00B9FB FE                MOV      R6,A
B2:00B9FC 426B              ORL      P3ShadowDIR,A
  124:       (P3ShadowDIR |= (1<<portPin));
  125:       (pullUp)?(P3Shadow &=~(1 << portPin)):(P3Shadow |= (1 << portPin));
B2:00B9FE 303E05            JNB      pullUp,?C0017?GPIO_DRIVER
B2:00BA01 F4                CPL      A
B2:00BA02 526F              ANL      P3Shadow,A
B2:00BA04 800D              SJMP     ?C0018?GPIO_DRIVER
B2:00BA06         ?C0017?GPIO_DRIVER:
B2:00BA06 7401              MOV      A,#01H
B2:00BA08 A807              MOV      R0,AR7
B2:00BA0A 08                INC      R0
B2:00BA0B 8002              SJMP     ?C0086?GPIO_DRIVER
B2:00BA0D         ?C0085?GPIO_DRIVER:
B2:00BA0D C3                CLR      C
B2:00BA0E 33                RLC      A
B2:00BA0F         ?C0086?GPIO_DRIVER:
B2:00BA0F D8FC              DJNZ     R0,?C0085?GPIO_DRIVER
B2:00BA11 426F              ORL      P3Shadow,A
B2:00BA13         ?C0018?GPIO_DRIVER:
  126:       P3 = P3Shadow;P3DIR = P3ShadowDIR;
B2:00BA13 856FB0            MOV      P3,P3Shadow
B2:00BA16 856BCB            MOV      P3DIR,P3ShadowDIR
  127:       break;
B2:00BA19 8002              SJMP     ?C0006?GPIO_DRIVER
  128:     default: return FALSE;
B2:00BA1B         ?C0019?GPIO_DRIVER:
B2:00BA1B C3                CLR      C
B2:00BA1C 22                RET      
  129:   }
B2:00BA1D         ?C0006?GPIO_DRIVER:
  130:   return TRUE;
B2:00BA1D D3                SETB     C
  131: }
B2:00BA1E 22                RET      
----- FUNCTION _PinIn (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 706




----- FUNCTION ?L?COM0168 (BEGIN) -----
B2:00BA1F 9043A5            MOV      DPTR,#key
B2:00BA22 E0                MOVX     A,@DPTR
B2:00BA23 FD                MOV      R5,A
B2:00BA24 9041BB            MOV      DPTR,#?_KeyDriverRegisterCallback?BYTE+03H
B2:00BA27 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_KeyAction
B2:00BA29 F0                MOVX     @DPTR,A
B2:00BA2A A3                INC      DPTR
B2:00BA2B 7421              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_KeyAction
B2:00BA2D F0                MOVX     @DPTR,A
B2:00BA2E 7B0F              MOV      R3,#0FH
B2:00BA30 22                RET      
----- FUNCTION ?L?COM0168 (END) -------


----- FUNCTION ?L?COM01F8 (BEGIN) -----
B2:00BA31 75FF01            MOV      SFRPAGE,#01H
B2:00BA34 7401              MOV      A,#01H
B2:00BA36 A807              MOV      R0,AR7
B2:00BA38 08                INC      R0
B2:00BA39 22                RET      
----- FUNCTION ?L?COM01F8 (END) -------


----- FUNCTION _PinOut (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  139: PinOut(BYTE pin)
  140: {
;---- Variable 'pin' assigned to Register 'R7' ----
  141:   BYTE port = pin>>4;
  142:   BYTE portPin = pin&0x0F;
;---- Variable 'port' assigned to Register 'R6' ----
;---- Variable 'portPin' assigned to Register 'R7' ----
B2:00BA3A 91B6              ACALL    ?L?COM029A
B2:00BA3C 601A              JZ       ?C0023?GPIO_DRIVER
B2:00BA3E 14                DEC      A
B2:00BA3F 6027              JZ       ?C0024?GPIO_DRIVER
B2:00BA41 14                DEC      A
B2:00BA42 6034              JZ       ?C0025?GPIO_DRIVER
B2:00BA44 2403              ADD      A,#03H
B2:00BA46 7040              JNZ      ?C0026?GPIO_DRIVER
  143: 
  144:   switch(port)
  145:   {
  146:     case 0:
B2:00BA48         ?C0022?GPIO_DRIVER:
  147:       P0DIR_PAGE;
B2:00BA48 5131              ACALL    ?L?COM01F8
B2:00BA4A 8002              SJMP     ?C0088?GPIO_DRIVER
B2:00BA4C         ?C0087?GPIO_DRIVER:
B2:00BA4C C3                CLR      C
B2:00BA4D 33                RLC      A
B2:00BA4E         ?C0088?GPIO_DRIVER:
B2:00BA4E D8FC              DJNZ     R0,?C0087?GPIO_DRIVER
B2:00BA50 F4                CPL      A
B2:00BA51 5268              ANL      P0ShadowDIR,A
  148:       P0ShadowDIR &=~(1 << portPin);
  149:       P0DIR = P0ShadowDIR;
B2:00BA53 8568FD            MOV      P0DIR,P0ShadowDIR
  150:       break;
B2:00BA56 8032              SJMP     ?C0021?GPIO_DRIVER
  151:     case 1:
B2:00BA58         ?C0023?GPIO_DRIVER:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 707


  152:       P1DIR_PAGE;
B2:00BA58 5131              ACALL    ?L?COM01F8
B2:00BA5A 8002              SJMP     ?C0090?GPIO_DRIVER
B2:00BA5C         ?C0089?GPIO_DRIVER:
B2:00BA5C C3                CLR      C
B2:00BA5D 33                RLC      A
B2:00BA5E         ?C0090?GPIO_DRIVER:
B2:00BA5E D8FC              DJNZ     R0,?C0089?GPIO_DRIVER
B2:00BA60 F4                CPL      A
B2:00BA61 5269              ANL      P1ShadowDIR,A
  153:       P1ShadowDIR &=~(1 << portPin);
  154:       P1DIR = P1ShadowDIR;
B2:00BA63 8569C9            MOV      P1DIR,P1ShadowDIR
  155:       break;
B2:00BA66 8022              SJMP     ?C0021?GPIO_DRIVER
  156:     case 2:
B2:00BA68         ?C0024?GPIO_DRIVER:
  157:       P2DIR_PAGE;
B2:00BA68 5131              ACALL    ?L?COM01F8
B2:00BA6A 8002              SJMP     ?C0092?GPIO_DRIVER
B2:00BA6C         ?C0091?GPIO_DRIVER:
B2:00BA6C C3                CLR      C
B2:00BA6D 33                RLC      A
B2:00BA6E         ?C0092?GPIO_DRIVER:
B2:00BA6E D8FC              DJNZ     R0,?C0091?GPIO_DRIVER
B2:00BA70 F4                CPL      A
B2:00BA71 526A              ANL      P2ShadowDIR,A
  158:       P2ShadowDIR &=~(1 << portPin);
  159:       P2DIR = P2ShadowDIR;
B2:00BA73 856ACA            MOV      P2DIR,P2ShadowDIR
  160:       break;
B2:00BA76 8012              SJMP     ?C0021?GPIO_DRIVER
  161:     case 3:
B2:00BA78         ?C0025?GPIO_DRIVER:
  162:       P3DIR_PAGE;
B2:00BA78 5131              ACALL    ?L?COM01F8
B2:00BA7A 8002              SJMP     ?C0094?GPIO_DRIVER
B2:00BA7C         ?C0093?GPIO_DRIVER:
B2:00BA7C C3                CLR      C
B2:00BA7D 33                RLC      A
B2:00BA7E         ?C0094?GPIO_DRIVER:
B2:00BA7E D8FC              DJNZ     R0,?C0093?GPIO_DRIVER
B2:00BA80 F4                CPL      A
B2:00BA81 526B              ANL      P3ShadowDIR,A
  163:       P3ShadowDIR &=~(1 << portPin);
  164:       P3DIR = P3ShadowDIR;
B2:00BA83 856BCB            MOV      P3DIR,P3ShadowDIR
  165:       break;
B2:00BA86 8002              SJMP     ?C0021?GPIO_DRIVER
  166:     default: return FALSE;
B2:00BA88         ?C0026?GPIO_DRIVER:
B2:00BA88 C3                CLR      C
B2:00BA89 22                RET      
  167:   }
B2:00BA8A         ?C0021?GPIO_DRIVER:
  168:   return TRUE;
B2:00BA8A D3                SETB     C
  169: }
B2:00BA8B 22                RET      
----- FUNCTION _PinOut (END) -------


----- FUNCTION _SetPinOut (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  190: void SetPinOut( LED_OUT led)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 708


  191: {
;---- Variable 'led' assigned to Register 'R7' ----
B2:;----                  JMP      _gpio_SetPinOut
  192:   gpio_SetPinOut(led);
----- FUNCTION _SetPinOut (END) -------


----- FUNCTION _gpio_SetPinOut (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  324: void gpio_SetPinOut(BYTE pin)
  325: {
B2:00BA8C 9043A9            MOV      DPTR,#pin
B2:00BA8F EF                MOV      A,R7
B2:00BA90 F0                MOVX     @DPTR,A
  326:   ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  327:   ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: SetPinOut = ");
  328:   ZW_DEBUG_GPIO_DRIVER_SEND_NUM(pin);
  329:   if (TRUE == fDoPinSwap)
B2:00BA91 304208            JNB      fDoPinSwap,?C0063?GPIO_DRIVER
  330:   {
  331:     searchPinList(&pin);
B2:00BA94 7B01              MOV      R3,#01H
B2:00BA96 7A43              MOV      R2,#HIGH pin
B2:00BA98 79A9              MOV      R1,#LOW pin
B2:00BA9A 7120              ACALL    _searchPinList
  332:   }
B2:00BA9C         ?C0063?GPIO_DRIVER:
  333:   ZW_DEBUG_GPIO_DRIVER_SEND_STR(" swapped = ");
  334:   ZW_DEBUG_GPIO_DRIVER_SEND_NUM(pin);
  335:   PinOut(pin);
B2:00BA9C 9043A9            MOV      DPTR,#pin
B2:00BA9F E0                MOVX     A,@DPTR
B2:00BAA0 FF                MOV      R7,A
B2:00BAA1 8097              SJMP     _PinOut
----- FUNCTION _gpio_SetPinOut (END) -------


----- FUNCTION _KeyGet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  206: BYTE KeyGet(ZDP03A_KEY key)
  207: {
;---- Variable 'key' assigned to Register 'R7' ----
  208:   return gpio_GetPin( key);
  209: }
B2:00BAA3 9192              ACALL    _gpio_GetPin
B2:00BAA5 E4                CLR      A
B2:00BAA6 33                RLC      A
B2:00BAA7 FF                MOV      R7,A
  210: 
B2:00BAA8 22                RET      
----- FUNCTION _KeyGet (END) -------


----- FUNCTION _ZCB_KeyAction (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\IO_ZDP03A.C'
  227: PCB(ZCB_KeyAction)(KEY_NAME_T keyName, KEY_EVENT_T keyEvent, BYTE holdCount)
  228: {
;---- Variable 'keyEvent' assigned to Register 'R5' ----
;---- Variable 'keyName' assigned to Register 'R7' ----
;---- Variable 'holdCount' assigned to Register 'R3' ----
  229:   BYTE keyCalcEvent = 0xff; /* not legal number*/
  230: 
;---- Variable 'keyCalcEvent' assigned to Register 'R6' ----
B2:00BAA9 7EFF              MOV      R6,#0FFH
  231:   //ZW_DEBUG_IO_ZDP03A_SEND_STR("ZCB_KeyAction ");
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 709


  232:   //ZW_DEBUG_IO_ZDP03A_SEND_NUM(keyName);
  233:   //ZW_DEBUG_IO_ZDP03A_SEND_NUM(keyEvent);
  234:   //ZW_DEBUG_IO_ZDP03A_SEND_NUM(holdCount);
  235:   //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  236: 
  237:   if(IS_NULL(mykeyMan.pEventKeyQueue))
B2:00BAAB 903C1D            MOV      DPTR,#mykeyMan
B2:00BAAE E0                MOVX     A,@DPTR
B2:00BAAF F8                MOV      R0,A
B2:00BAB0 A3                INC      DPTR
B2:00BAB1 E0                MOVX     A,@DPTR
B2:00BAB2 48                ORL      A,R0
B2:00BAB3 603E              JZ       ?C0018?IO_ZDP03A
  238:   {
  239:     //ZW_DEBUG_IO_ZDP03A_SEND_STR("pEventKeyQueue not initialize!!");
  240:     //ZW_DEBUG_IO_ZDP03A_SEND_NL();
  241:     return;
  242:   }
B2:00BAB5         ?C0017?IO_ZDP03A:
  243:   if((KEY01 != keyName))
B2:00BAB5 EF                MOV      A,R7
B2:00BAB6 6012              JZ       ?C0019?IO_ZDP03A
  244:   {
  245:     /* We do not handle KEY_TRIPLE_PRESS for other keys than key1*/
  246:     if((KEY_TRIPLE_PRESS != keyEvent))
B2:00BAB8 ED                MOV      A,R5
B2:00BAB9 6404              XRL      A,#04H
B2:00BABB 6027              JZ       ?C0024?IO_ZDP03A
  247:     {
  248:       if(KEY_HOLD == keyEvent)
B2:00BABD ED                MOV      A,R5
B2:00BABE B40307            CJNE     A,#03H,?C0021?IO_ZDP03A
  249:       {
  250:         if(1 == holdCount)
B2:00BAC1 EB                MOV      A,R3
B2:00BAC2 6401              XRL      A,#01H
B2:00BAC4 701E              JNZ      ?C0024?IO_ZDP03A
  251:         {
  252:           /* Only send the first hold indication. Use KEY_UP for hold is finish!*/
  253:           keyCalcEvent = keyGrpStart[keyName] + keyEvent;
  254:         }
  255:       }
B2:00BAC6 8018              SJMP     ?C0087?IO_ZDP03A
B2:00BAC8         ?C0021?IO_ZDP03A:
  256:       else /*KEY_DOWN || KEY_UP || KEY_PRESS*/
  257:       {
  258:         keyCalcEvent = keyGrpStart[keyName] + keyEvent;
B2:00BAC8         
  259:       }
  260:     }
  261:   }
B2:00BAC8 8016              SJMP     ?C0087?IO_ZDP03A
B2:00BACA         ?C0019?IO_ZDP03A:
  262:   else
  263:   {
  264:     if(KEY_HOLD == keyEvent)
B2:00BACA ED                MOV      A,R5
B2:00BACB 6403              XRL      A,#03H
B2:00BACD 7011              JNZ      ?C0025?IO_ZDP03A
  265:     {
  266:       if(1 == holdCount)
B2:00BACF EB                MOV      A,R3
B2:00BAD0 B40102            CJNE     A,#01H,?C0026?IO_ZDP03A
  267:       {
  268:         keyCalcEvent = keyGrpStart[keyName] + keyEvent;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 710


B2:00BAD3         
  269:       }
B2:00BAD3 800B              SJMP     ?C0087?IO_ZDP03A
B2:00BAD5         ?C0026?IO_ZDP03A:
  270:       else if (10 == holdCount)
B2:00BAD5 EB                MOV      A,R3
B2:00BAD6 B40A0B            CJNE     A,#0AH,?C0024?IO_ZDP03A
  271:       {
  272:         keyCalcEvent = keyGrpStart[keyName] + (EVENT_KEY_B1_HELD_10_SEC - DEFINE_EVENT_KEY_NBR);
B2:00BAD9 51F4              ACALL    ?L?COM04A1
B2:00BADB 2405              ADD      A,#05H
B2:00BADD FE                MOV      R6,A
  273:       }
  274:     }
B2:00BADE 8004              SJMP     ?C0024?IO_ZDP03A
B2:00BAE0         ?C0025?IO_ZDP03A:
  275:     else
  276:     {
  277:       keyCalcEvent = keyGrpStart[keyName] + keyEvent;
B2:00BAE0         
B2:00BAE0 51F4              ACALL    ?L?COM04A1
B2:00BAE2 2D                ADD      A,R5
B2:00BAE3 FE                MOV      R6,A
  278:     }
  279:   }
B2:00BAE4         ?C0024?IO_ZDP03A:
  280: 
  281:   if(0xff != keyCalcEvent)
B2:00BAE4 EE                MOV      A,R6
B2:00BAE5 F4                CPL      A
B2:00BAE6 600B              JZ       ?C0018?IO_ZDP03A
  282:   {
  283:     ZW_DEBUG_IO_ZDP03A_SEND_NL();
  284:     ZW_DEBUG_IO_ZDP03A_SEND_BYTE('E');
  285:     ZW_DEBUG_IO_ZDP03A_SEND_NUM(keyCalcEvent);
  286:     mykeyMan.pEventKeyQueue(keyCalcEvent);
B2:00BAE8 AF06              MOV      R7,AR6
B2:00BAEA 903C1D            MOV      DPTR,#mykeyMan
B2:00BAED 12515D            LCALL    ?L?COM0154
B2:00BAF0 12271A            LCALL    ?C?ICALL2
  287:   }
  288: }
B2:00BAF3         ?C0018?IO_ZDP03A:
B2:00BAF3 22                RET      
----- FUNCTION _ZCB_KeyAction (END) -------


----- FUNCTION ?L?COM04A1 (BEGIN) -----
B2:00BAF4 7410              MOV      A,#LOW keyGrpStart
B2:00BAF6 2F                ADD      A,R7
B2:00BAF7 F582              MOV      DPL,A
B2:00BAF9 E4                CLR      A
B2:00BAFA 343C              ADDC     A,#HIGH keyGrpStart
B2:00BAFC F583              MOV      DPH,A
B2:00BAFE E0                MOVX     A,@DPTR
B2:00BAFF 22                RET      
----- FUNCTION ?L?COM04A1 (END) -------


----- FUNCTION KeyDriverInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
   93: KeyDriverInit(void)
   94: {
   95: #ifndef __C51__
   96:   memset((BYTE *)keyList, 0, (NUMBER_OF_KEYS * sizeof(KEY_LIST_T)));
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 711


   97:   keyTriplePressTimerHandle = 0;
   98: #endif //__C51__
   99:   whichButton = WHICH_BUTTON_RESET;
B2:00BB00 903850            MOV      DPTR,#whichButton
B2:00BB03 74FF              MOV      A,#0FFH
B2:00BB05 F0                MOVX     @DPTR,A
  100:   fKeyHoldThresholdExceeded = FALSE;
B2:00BB06 C222              CLR      fKeyHoldThresholdExceeded
  101:   pressCount = 0;
B2:00BB08 E4                CLR      A
B2:00BB09 903854            MOV      DPTR,#pressCount
B2:00BB0C F0                MOVX     @DPTR,A
  102:   holdCount = 0;
B2:00BB0D 903853            MOV      DPTR,#holdCount
B2:00BB10 F0                MOVX     @DPTR,A
  103:   hold10Count = 0;
B2:00BB11 903851            MOV      DPTR,#hold10Count
B2:00BB14 F0                MOVX     @DPTR,A
  104:   m_keep_alive_timer_activated = FALSE;
B2:00BB15 C221              CLR      m_keep_alive_timer_activated
  105: 
  106: #ifndef NON_BATT
  107:   // TODO: Keep prel detection active under powering on.
  108:   ZAF_pm_KeepAwake(50);
  109: #endif
  110:   /*
  111:    * Initialize the interrupt module with a pointer to a function to call on
  112:    * every edge change.
  113:    */
  114:   return InterruptDriverInit(ZW_EXT_INT1, ZCB_EdgeCall);
B2:00BB17 7C1E              MOV      R4,#HIGH ?INTERBANK_TABLE?_ZCB_EdgeCall
B2:00BB19 7D2B              MOV      R5,#LOW ?INTERBANK_TABLE?_ZCB_EdgeCall
B2:00BB1B 7F01              MOV      R7,#01H
B2:00BB1D 025008            LJMP     _InterruptDriverInit
  115: }
----- FUNCTION KeyDriverInit (END) -------


----- FUNCTION _searchPinList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
   69: searchPinList(BYTE * pPin)
   70: {
;---- Variable 'pPin' assigned to Register 'R1/R2/R3' ----
   71:   BYTE count;
   72: 
   73:   for (count = 0; count < pinListSize; count++)
;---- Variable 'count' assigned to Register 'R7' ----
B2:00BB20 E4                CLR      A
B2:00BB21 FF                MOV      R7,A
B2:00BB22         ?C0001?GPIO_DRIVER:
B2:00BB22 904309            MOV      DPTR,#pinListSize
B2:00BB25 E0                MOVX     A,@DPTR
B2:00BB26 FE                MOV      R6,A
B2:00BB27 EF                MOV      A,R7
B2:00BB28 C3                CLR      C
B2:00BB29 9E                SUBB     A,R6
B2:00BB2A 501E              JNC      ?C0005?GPIO_DRIVER
   74:   {
   75:     ZW_DEBUG_GPIO_DRIVER_SEND_NL();
   76:     ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO.searchPinList: pPin = ");
   77:     ZW_DEBUG_GPIO_DRIVER_SEND_NUM(*pPin);
   78:     ZW_DEBUG_GPIO_DRIVER_SEND_STR(", pPinSwapList[");
   79:     ZW_DEBUG_GPIO_DRIVER_SEND_NUM(count);
   80:     ZW_DEBUG_GPIO_DRIVER_SEND_STR("].pin = ");
   81:     ZW_DEBUG_GPIO_DRIVER_SEND_NUM((*pPinSwapList)[count].pin);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 712


   82:     if ((*pPinSwapList)[count].pin == *pPin)
B2:00BB2C A3                INC      DPTR
B2:00BB2D 7158              ACALL    ?L?COM00AB
B2:00BB2F 915D              ACALL    ?L?COM05D2
B2:00BB31 E0                MOVX     A,@DPTR
B2:00BB32 FE                MOV      R6,A
B2:00BB33 121FB3            LCALL    ?C?CLDPTR
B2:00BB36 FD                MOV      R5,A
B2:00BB37 EE                MOV      A,R6
B2:00BB38 B5050C            CJNE     A,AR5,?C0003?GPIO_DRIVER
   83:     {
   84:       *pPin = (*pPinSwapList)[count].pinSwap;
B2:00BB3B 90430A            MOV      DPTR,#pPinSwapList
B2:00BB3E 715A              ACALL    ?L?COM00AC
B2:00BB40 915D              ACALL    ?L?COM05D2
B2:00BB42 A3                INC      DPTR
B2:00BB43 E0                MOVX     A,@DPTR
B2:00BB44 022072            LJMP     ?C?CSTPTR
   85:       break;
   86:     }
   87:   }
B2:00BB47         ?C0003?GPIO_DRIVER:
B2:00BB47 0F                INC      R7
B2:00BB48 80D8              SJMP     ?C0001?GPIO_DRIVER
   88: }
B2:00BB4A         ?C0005?GPIO_DRIVER:
B2:00BB4A 22                RET      
----- FUNCTION _searchPinList (END) -------


----- FUNCTION ?L?COM00AA (BEGIN) -----
B2:00BB4B 25E0              ADD      A,ACC
B2:00BB4D 25E0              ADD      A,ACC
B2:00BB4F 2457              ADD      A,#LOW keyList+02H
B2:00BB51 F582              MOV      DPL,A
B2:00BB53 E4                CLR      A
B2:00BB54 3438              ADDC     A,#HIGH keyList+02H
B2:00BB56 F583              MOV      DPH,A
B2:00BB58         ?L?COM00AB:
B2:00BB58 E0                MOVX     A,@DPTR
B2:00BB59 FC                MOV      R4,A
B2:00BB5A         ?L?COM00AC:
B2:00BB5A A3                INC      DPTR
B2:00BB5B E0                MOVX     A,@DPTR
B2:00BB5C F582              MOV      DPL,A
B2:00BB5E 8C83              MOV      DPH,R4
B2:00BB60 22                RET      
----- FUNCTION ?L?COM00AA (END) -------


----- FUNCTION _ZCB_EdgeCall (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  153: PCB(ZCB_EdgeCall)(BYTE bLevelValue)
  154: {
;---- Variable 'bLevelValue' assigned to Register 'R7' ----
  155:   static BYTE keyHeldTimerHandle = 0;
  156: 
  157:   if (0 == bLevelValue)
B2:00BB61 EF                MOV      A,R7
B2:00BB62 7064              JNZ      ?C0005?KEY_DRIVER
  158:   {
  159:     // Falling edge
  160: #ifndef NON_BATT
  161:     if(TRUE == m_keep_alive_timer_activated)
  162:     {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 713


  163:       ZAF_pm_KeepAwake(KEY_DRIVER_HOLD_TIMEOUT);
  164:     }
  165: #endif
  166: 
  167:     /*
  168:      * Detect button only on falling edge. It makes no sense to check on rising
  169:      * edge due to the hardware design.
  170:      */
  171:     GetActiveButton();
B2:00BB64 B196              ACALL    GetActiveButton
  172: 
  173:     ZW_DEBUG_KEY_DRIVER_SEND_STR("S");
  174:     ZW_DEBUG_KEY_DRIVER_SEND_NUM(whichButton);
  175: 
  176:     if (TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_DOWN))
B2:00BB66 7D01              MOV      R5,#01H
B2:00BB68 9184              ACALL    ?L?COM037E
B2:00BB6A 500D              JNC      ?C0006?KEY_DRIVER
  177:     {
  178:       keyList[whichButton].pEventCallback(whichButton, KEY_DOWN, 0);
B2:00BB6C 903850            MOV      DPTR,#whichButton
B2:00BB6F E0                MOVX     A,@DPTR
B2:00BB70 FF                MOV      R7,A
B2:00BB71 714B              ACALL    ?L?COM00AA
B2:00BB73 E4                CLR      A
B2:00BB74 FB                MOV      R3,A
B2:00BB75 FD                MOV      R5,A
B2:00BB76 12271A            LCALL    ?C?ICALL2
  179:     }
B2:00BB79         ?C0006?KEY_DRIVER:
  180:     ZW_DEBUG_KEY_DRIVER_SEND_STR("DOWN");
  181: 
  182:     // Start a timer to detect whether the key is held.
  183:     if (TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_HOLD))
B2:00BB79 7D08              MOV      R5,#08H
B2:00BB7B 9184              ACALL    ?L?COM037E
B2:00BB7D 5017              JNC      ?C0007?KEY_DRIVER
  184:     {
  185:       fKeyHoldThresholdExceeded = FALSE;
B2:00BB7F C222              CLR      fKeyHoldThresholdExceeded
  186:       hold10Count = 10;
B2:00BB81 903851            MOV      DPTR,#hold10Count
B2:00BB84 740A              MOV      A,#0AH
B2:00BB86 F0                MOVX     @DPTR,A
  187:       keyHeldTimerHandle = TimerStart(ZCB_KeyHeldTimerCallback, (KEY_HOLD_THRESHOLD), -1);
B2:00BB87 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_KeyHeldTimerCallback
B2:00BB89 7F30              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_KeyHeldTimerCallback
B2:00BB8B 7BFF              MOV      R3,#0FFH
B2:00BB8D FD                MOV      R5,A
B2:00BB8E 124FFF            LCALL    _TimerStart
B2:00BB91 90384F            MOV      DPTR,#keyHeldTimerHandle
B2:00BB94 EF                MOV      A,R7
B2:00BB95 F0                MOVX     @DPTR,A
  188:     }
B2:00BB96         ?C0007?KEY_DRIVER:
  189:     if (TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_TRIPLE_PRESS))
B2:00BB96 9164              ACALL    ?L?COM0230
B2:00BB98 5027              JNC      ?C0008?KEY_DRIVER
  190: 	  {
  191:       if (0 == keyTriplePressTimerHandle)
B2:00BB9A 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BB9D E0                MOVX     A,@DPTR
B2:00BB9E 7012              JNZ      ?C0009?KEY_DRIVER
  192:       {
  193:         keyTriplePressTimerHandle = TimerStart(ZCB_KeyTriplePressTimerCallback, (KEY_TRIPLE_PRESS_THRESHOLD), 1);
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 714


>> 
B2:00BBA0 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_KeyTriplePressTimerCallback
B2:00BBA2 7F35              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_KeyTriplePressTimerCallback
B2:00BBA4 7B01              MOV      R3,#01H
B2:00BBA6 7D1E              MOV      R5,#01EH
B2:00BBA8 124FFF            LCALL    _TimerStart
B2:00BBAB 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BBAE EF                MOV      A,R7
B2:00BBAF F0                MOVX     @DPTR,A
  194:       }
B2:00BBB0 8008              SJMP     ?C0010?KEY_DRIVER
B2:00BBB2         ?C0009?KEY_DRIVER:
  195:       else
  196:       {
  197:         // Restart the timer for timeout pressCount.
  198:         TimerRestart(keyTriplePressTimerHandle);
B2:00BBB2 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BBB5 E0                MOVX     A,@DPTR
B2:00BBB6 FF                MOV      R7,A
B2:00BBB7 1246A0            LCALL    _TimerRestart
  199:       }
B2:00BBBA         ?C0010?KEY_DRIVER:
  200:       pressCount++;
B2:00BBBA 903854            MOV      DPTR,#pressCount
B2:00BBBD E0                MOVX     A,@DPTR
B2:00BBBE 04                INC      A
B2:00BBBF F0                MOVX     @DPTR,A
  201:     }
B2:00BBC0 22                RET      
B2:00BBC1         ?C0008?KEY_DRIVER:
  202:     else{
  203:       pressCount = 1;
B2:00BBC1 903854            MOV      DPTR,#pressCount
B2:00BBC4 7401              MOV      A,#01H
B2:00BBC6 F0                MOVX     @DPTR,A
  204:     }
  205:   }
B2:00BBC7 22                RET      
B2:00BBC8         ?C0005?KEY_DRIVER:
  206:   else
  207:   {
  208:     // Rising edge
  209:     // When key goes up, cancel the held timer.
  210:     TimerCancel(keyHeldTimerHandle);
B2:00BBC8 90384F            MOV      DPTR,#keyHeldTimerHandle
B2:00BBCB E0                MOVX     A,@DPTR
B2:00BBCC FF                MOV      R7,A
B2:00BBCD 124465            LCALL    _TimerCancel
  211:     keyHeldTimerHandle = 0;
B2:00BBD0 E4                CLR      A
B2:00BBD1 90384F            MOV      DPTR,#keyHeldTimerHandle
B2:00BBD4 F0                MOVX     @DPTR,A
  212: 
  213:     if (TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_TRIPLE_PRESS))
B2:00BBD5 A3                INC      DPTR
B2:00BBD6 9167              ACALL    ?L?COM0231
B2:00BBD8 5028              JNC      ?C0013?KEY_DRIVER
  214:     {
  215: #ifndef NON_BATT
  216:       if(TRUE == m_keep_alive_timer_activated)
  217:       {
  218:         ZAF_pm_KeepAwake(KEY_TRIPLE_PRESS_TIMEOUT);
  219:       }
  220: #endif
  221:       // Key released, clear triple-press time-out
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 715


  222:       if(0 != keyTriplePressTimerHandle)
B2:00BBDA 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BBDD E0                MOVX     A,@DPTR
B2:00BBDE FF                MOV      R7,A
B2:00BBDF 6021              JZ       ?C0013?KEY_DRIVER
  223:       {
  224:         if(3 == pressCount)
B2:00BBE1 903854            MOV      DPTR,#pressCount
B2:00BBE4 E0                MOVX     A,@DPTR
B2:00BBE5 B40310            CJNE     A,#03H,?C0015?KEY_DRIVER
  225:         {
  226:           // Stop the timer, it is a triple press!
  227:           if(0 != keyTriplePressTimerHandle)
B2:00BBE8 EF                MOV      A,R7
B2:00BBE9 6017              JZ       ?C0013?KEY_DRIVER
  228:           {
  229:             TimerCancel(keyTriplePressTimerHandle);
B2:00BBEB 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BBEE 124465            LCALL    _TimerCancel
  230:             keyTriplePressTimerHandle = 0;
B2:00BBF1 E4                CLR      A
B2:00BBF2 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BBF5 F0                MOVX     @DPTR,A
  231:           }
  232:         }
B2:00BBF6 800A              SJMP     ?C0013?KEY_DRIVER
B2:00BBF8         ?C0015?KEY_DRIVER:
  233:         else
  234:         {
  235:           // Restart the timer for timeout pressCount. Timer need to be started on rising edge the check triplepr
>> ess release time.
  236:           // Only start the timer if it is not time-out. If time-out it is a KEY_PRESS
  237:           if(0 != keyTriplePressTimerHandle)
B2:00BBF8 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BBFB E0                MOVX     A,@DPTR
B2:00BBFC FF                MOV      R7,A
B2:00BBFD 6003              JZ       ?C0013?KEY_DRIVER
  238:           {
  239:             TimerRestart(keyTriplePressTimerHandle);
B2:00BBFF 1246A0            LCALL    _TimerRestart
  240:           }
  241:         }
  242:       }
  243:     }
B2:00BC02         ?C0013?KEY_DRIVER:
  244: 
  245:     if (TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_UP))
B2:00BC02 7D02              MOV      R5,#02H
B2:00BC04 918B              ACALL    ?L?COM0584
B2:00BC06 500E              JNC      ?C0019?KEY_DRIVER
  246:     {
  247:       keyList[whichButton].pEventCallback(whichButton, KEY_UP, 0);
B2:00BC08 903850            MOV      DPTR,#whichButton
B2:00BC0B E0                MOVX     A,@DPTR
B2:00BC0C FF                MOV      R7,A
B2:00BC0D 714B              ACALL    ?L?COM00AA
B2:00BC0F E4                CLR      A
B2:00BC10 FB                MOV      R3,A
B2:00BC11 7D01              MOV      R5,#01H
B2:00BC13 12271A            LCALL    ?C?ICALL2
  248:     }
B2:00BC16         ?C0019?KEY_DRIVER:
  249: 
  250: 
  251:     if (FALSE == fKeyHoldThresholdExceeded)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 716


B2:00BC16 202238            JB       fKeyHoldThresholdExceeded,?C0020?KEY_DRIVER
  252:     {
  253:       // The key was pressed.
  254:       ZW_DEBUG_KEY_DRIVER_SEND_STR("PRESS");
  255: 
  256:       //** Check timeout for triple-press (pressCount = 0). if ->send a key-press else do nothing
  257:       if ((TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_PRESS)) && (1 == pressCount))
B2:00BC19 7D04              MOV      R5,#04H
B2:00BC1B 918B              ACALL    ?L?COM0584
B2:00BC1D 5015              JNC      ?C0021?KEY_DRIVER
B2:00BC1F 903854            MOV      DPTR,#pressCount
B2:00BC22 E0                MOVX     A,@DPTR
B2:00BC23 B4010E            CJNE     A,#01H,?C0021?KEY_DRIVER
  258:       {
  259:         keyList[whichButton].pEventCallback(whichButton, KEY_PRESS, 0);
B2:00BC26 903850            MOV      DPTR,#whichButton
B2:00BC29 E0                MOVX     A,@DPTR
B2:00BC2A FF                MOV      R7,A
B2:00BC2B 714B              ACALL    ?L?COM00AA
B2:00BC2D E4                CLR      A
B2:00BC2E FB                MOV      R3,A
B2:00BC2F 7D02              MOV      R5,#02H
B2:00BC31 12271A            LCALL    ?C?ICALL2
  260:       }
B2:00BC34         ?C0021?KEY_DRIVER:
  261:       if (3 == pressCount)
B2:00BC34 903854            MOV      DPTR,#pressCount
B2:00BC37 E0                MOVX     A,@DPTR
B2:00BC38 6403              XRL      A,#03H
B2:00BC3A 701A              JNZ      ?C0024?KEY_DRIVER
  262:       {
  263:         pressCount = 0;
B2:00BC3C F0                MOVX     @DPTR,A
  264: 
  265:         ZW_DEBUG_SEND_STR("TRIPLE");
  266: 
  267:         if (TRUE == isFunctionPointerSet(whichButton, BITFIELD_KEY_TRIPLE_PRESS))
B2:00BC3D 9164              ACALL    ?L?COM0230
B2:00BC3F 5015              JNC      ?C0024?KEY_DRIVER
  268:         {
  269:           keyList[whichButton].pEventCallback(whichButton, KEY_TRIPLE_PRESS, 0);
B2:00BC41 903850            MOV      DPTR,#whichButton
B2:00BC44 E0                MOVX     A,@DPTR
B2:00BC45 FF                MOV      R7,A
B2:00BC46 714B              ACALL    ?L?COM00AA
B2:00BC48 E4                CLR      A
B2:00BC49 FB                MOV      R3,A
B2:00BC4A 7D04              MOV      R5,#04H
B2:00BC4C 12271A            LCALL    ?C?ICALL2
  270:         }
  271:       }
  272:     }
B2:00BC4F 8005              SJMP     ?C0024?KEY_DRIVER
B2:00BC51         ?C0020?KEY_DRIVER:
  273:     else
  274:     {
  275:       // The key was held.
  276:       holdCount = 0;
B2:00BC51 E4                CLR      A
B2:00BC52 903853            MOV      DPTR,#holdCount
B2:00BC55 F0                MOVX     @DPTR,A
  277:     }
B2:00BC56         ?C0024?KEY_DRIVER:
B2:;----                  JMP      ClearActiveButton
  278:     ZW_DEBUG_KEY_DRIVER_SEND_STR("UP");
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 717


  279:     ClearActiveButton();
  280:   }
----- FUNCTION _ZCB_EdgeCall (END) -------


----- FUNCTION ClearActiveButton (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  339: ClearActiveButton(void)
  340: {
  341:   whichButton = WHICH_BUTTON_RESET;
  342: }
B2:00BC56 903850            MOV      DPTR,#whichButton
B2:00BC59 74FF              MOV      A,#0FFH
B2:00BC5B F0                MOVX     @DPTR,A
  343: 
B2:00BC5C 22                RET      
----- FUNCTION ClearActiveButton (END) -------


----- FUNCTION ?L?COM05D2 (BEGIN) -----
B2:00BC5D 75F002            MOV      B,#02H
B2:00BC60 EF                MOV      A,R7
B2:00BC61 02257D            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM05D2 (END) -------


----- FUNCTION ?L?COM0230 (BEGIN) -----
B2:00BC64 903850            MOV      DPTR,#whichButton
B2:00BC67         ?L?COM0231:
B2:00BC67 E0                MOVX     A,@DPTR
B2:00BC68 FF                MOV      R7,A
B2:00BC69 7D10              MOV      R5,#010H
----- FUNCTION _isFunctionPointerSet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  284: isFunctionPointerSet(KEY_NAME_T whichButton, BITFIELD_KEY_EVENT_T keyEvent)
  285: {
;---- Variable 'whichButton' assigned to Register 'R7' ----
;---- Variable 'keyEvent' assigned to Register 'R5' ----
  286:   if (NUMBER_OF_KEYS > whichButton)
  287:   {
B2:00BC6B 7406              MOV      A,#06H
B2:00BC6D D3                SETB     C
B2:00BC6E 9F                SUBB     A,R7
B2:00BC6F 4011              JC       ?C0026?KEY_DRIVER
  288:     ZW_DEBUG_KEY_DRIVER_SEND_NL();
  289:     ZW_DEBUG_KEY_DRIVER_SEND_STR("Key exists");
  290:     if (NON_NULL(keyList[whichButton].pEventCallback) && (keyList[whichButton].keyEvents & keyEvent))
B2:00BC71 B187              ACALL    ?L?COM02E8
B2:00BC73 E0                MOVX     A,@DPTR
B2:00BC74 FA                MOV      R2,A
B2:00BC75 A3                INC      DPTR
B2:00BC76 E0                MOVX     A,@DPTR
B2:00BC77 4A                ORL      A,R2
B2:00BC78 6008              JZ       ?C0026?KEY_DRIVER
B2:00BC7A B178              ACALL    ?L?COM02CD
B2:00BC7C E0                MOVX     A,@DPTR
B2:00BC7D 5D                ANL      A,R5
B2:00BC7E 6002              JZ       ?C0026?KEY_DRIVER
  291:     {
  292:       ZW_DEBUG_KEY_DRIVER_SEND_NL();
  293:       ZW_DEBUG_KEY_DRIVER_SEND_STR("Func is set");
  294:       return TRUE;
B2:00BC80 D3                SETB     C
B2:00BC81 22                RET      
  295:     }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 718


  296:   }
B2:00BC82         ?C0026?KEY_DRIVER:
  297:   return FALSE;
B2:00BC82 C3                CLR      C
  298: }
B2:00BC83 22                RET      
----- FUNCTION _isFunctionPointerSet (END) -------


----- FUNCTION ?L?COM037E (BEGIN) -----
B2:00BC84 903850            MOV      DPTR,#whichButton
B2:00BC87 E0                MOVX     A,@DPTR
B2:00BC88 FF                MOV      R7,A
B2:00BC89 80E0              SJMP     _isFunctionPointerSet
----- FUNCTION ?L?COM037E (END) -------


----- FUNCTION ?L?COM0584 (BEGIN) -----
B2:00BC8B 903850            MOV      DPTR,#whichButton
B2:00BC8E E0                MOVX     A,@DPTR
B2:00BC8F FF                MOV      R7,A
B2:00BC90 80D9              SJMP     _isFunctionPointerSet
----- FUNCTION ?L?COM0584 (END) -------


----- FUNCTION _gpio_GetPin (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  359: BOOL gpio_GetPin(BYTE pin)
  360: {
B2:00BC92 904368            MOV      DPTR,#pin
B2:00BC95 EF                MOV      A,R7
B2:00BC96 F0                MOVX     @DPTR,A
  361:   BYTE fPinState;
  362:   if (TRUE == fDoPinSwap)
B2:00BC97 304208            JNB      fDoPinSwap,?C0069?GPIO_DRIVER
  363:   {
  364:     searchPinList(&pin);
B2:00BC9A 7B01              MOV      R3,#01H
B2:00BC9C 7A43              MOV      R2,#HIGH pin
B2:00BC9E 7968              MOV      R1,#LOW pin
B2:00BCA0 7120              ACALL    _searchPinList
  365:   }
B2:00BCA2         ?C0069?GPIO_DRIVER:
  366:   gpio_GetPinBool(pin, &fPinState);
B2:00BCA2 904368            MOV      DPTR,#pin
B2:00BCA5 E0                MOVX     A,@DPTR
B2:00BCA6 FF                MOV      R7,A
B2:00BCA7 7B01              MOV      R3,#01H
B2:00BCA9 7A43              MOV      R2,#HIGH fPinState
B2:00BCAB 7969              MOV      R1,#LOW fPinState
B2:00BCAD 91E7              ACALL    _gpio_GetPinBool
  367:   return (BOOL)fPinState;
B2:00BCAF 904369            MOV      DPTR,#fPinState
B2:00BCB2 E0                MOVX     A,@DPTR
B2:00BCB3 24FF              ADD      A,#0FFH
  368: }
B2:00BCB5 22                RET      
----- FUNCTION _gpio_GetPin (END) -------


----- FUNCTION ?L?COM029A (BEGIN) -----
B2:00BCB6 EF                MOV      A,R7
B2:00BCB7 C4                SWAP     A
B2:00BCB8 540F              ANL      A,#0FH
B2:00BCBA FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 719


B2:00BCBB EF                MOV      A,R7
B2:00BCBC 540F              ANL      A,#0FH
B2:00BCBE FF                MOV      R7,A
B2:00BCBF EE                MOV      A,R6
B2:00BCC0 14                DEC      A
B2:00BCC1 22                RET      
----- FUNCTION ?L?COM029A (END) -------


----- FUNCTION _KeyDriverRegisterCallback (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  117: void KeyDriverRegisterCallback(KEY_NAME_T keyName, BYTE keyPin, BYTE keyEvents, VOID_CALLBACKFUNC(pCallback)(KEY_
>> NAME_T keyName, KEY_EVENT_T keyEvent, BYTE holdCount))
  118: {
;---- Variable 'keyName' assigned to Register 'R7' ----
;---- Variable 'keyEvents' assigned to Register 'R3' ----
;---- Variable 'keyPin' assigned to Register 'R5' ----
  119:   ZW_DEBUG_KEY_DRIVER_SEND_STR("KeyDriverRegisterCallback");
  120:   ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyName);
  121:   ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyPin);
  122:   ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyEvents);
  123:   ZW_DEBUG_KEY_DRIVER_SEND_NL();
  124:   if (NUMBER_OF_KEYS > keyName)
B2:00BCC2 7406              MOV      A,#06H
B2:00BCC4 D3                SETB     C
B2:00BCC5 9F                SUBB     A,R7
B2:00BCC6 401E              JC       ?C0004?KEY_DRIVER
  125:   {
  126:     ZW_DEBUG_KEY_DRIVER_SEND_STR(" ->CONF ");
  127:     ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyEvents);
  128:     ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyName);
  129:     ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyPin);
  130:     ZW_DEBUG_KEY_DRIVER_SEND_NL();
  131:     keyList[keyName].keyPin = keyPin;
B2:00BCC8 D1DD              ACALL    ?L?COM03EA
B2:00BCCA ED                MOV      A,R5
B2:00BCCB F0                MOVX     @DPTR,A
  132:     keyList[keyName].keyEvents = keyEvents;
B2:00BCCC B178              ACALL    ?L?COM02CD
B2:00BCCE EB                MOV      A,R3
B2:00BCCF F0                MOVX     @DPTR,A
  133:     keyList[keyName].pEventCallback = pCallback;
B2:00BCD0 9041BB            MOV      DPTR,#pCallback
B2:00BCD3 E0                MOVX     A,@DPTR
B2:00BCD4 FC                MOV      R4,A
B2:00BCD5 A3                INC      DPTR
B2:00BCD6 E0                MOVX     A,@DPTR
B2:00BCD7 FD                MOV      R5,A
B2:00BCD8 B187              ACALL    ?L?COM02E8
B2:00BCDA EC                MOV      A,R4
B2:00BCDB F0                MOVX     @DPTR,A
B2:00BCDC A3                INC      DPTR
B2:00BCDD ED                MOV      A,R5
B2:00BCDE F0                MOVX     @DPTR,A
  134: 
  135:     /*
  136:      * Enable ZAF_pm_KeepAwake() for battery devices if specific keys are used.
  137:      */
  138:     if(keyEvents & (BITFIELD_KEY_PRESS | BITFIELD_KEY_HOLD | BITFIELD_KEY_UP | BITFIELD_KEY_TRIPLE_PRESS))
B2:00BCDF EB                MOV      A,R3
B2:00BCE0 541E              ANL      A,#01EH
B2:00BCE2 6002              JZ       ?C0004?KEY_DRIVER
  139:     {
  140:       ZW_DEBUG_KEY_DRIVER_SEND_STR("\r\nm_keep_alive_timer_activated\r\n ");
  141:       m_keep_alive_timer_activated = TRUE;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 720


B2:00BCE4 D221              SETB     m_keep_alive_timer_activated
  142:     }
  143:     ZW_DEBUG_KEY_DRIVER_SEND_NL();
  144:   }
  145: }
B2:00BCE6         ?C0004?KEY_DRIVER:
B2:00BCE6 22                RET      
----- FUNCTION _KeyDriverRegisterCallback (END) -------


----- FUNCTION _gpio_GetPinBool (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  178: gpio_GetPinBool(BYTE pin, BYTE * pfState)
  179: {
;---- Variable 'pfState' assigned to Register 'R1/R2/R3' ----
;---- Variable 'pin' assigned to Register 'R7' ----
  180:   BYTE port = pin>>4;
  181:   BYTE portPin = pin&0x0F;
B2:00BCE7 EF                MOV      A,R7
B2:00BCE8 C4                SWAP     A
B2:00BCE9 540F              ANL      A,#0FH
B2:00BCEB FE                MOV      R6,A
;---- Variable 'port' assigned to Register 'R6' ----
  182: 
B2:00BCEC EF                MOV      A,R7
B2:00BCED 540F              ANL      A,#0FH
B2:00BCEF 9043A6            MOV      DPTR,#portPin
B2:00BCF2 F0                MOVX     @DPTR,A
  183:   switch(port)
B2:00BCF3 AF06              MOV      R7,AR6
B2:00BCF5 EF                MOV      A,R7
B2:00BCF6 14                DEC      A
B2:00BCF7 6022              JZ       ?C0032?GPIO_DRIVER
B2:00BCF9 14                DEC      A
B2:00BCFA 6037              JZ       ?C0035?GPIO_DRIVER
B2:00BCFC 14                DEC      A
B2:00BCFD 604C              JZ       ?C0038?GPIO_DRIVER
B2:00BCFF 2403              ADD      A,#03H
B2:00BD01 7064              JNZ      ?C0041?GPIO_DRIVER
  184:   {
  185:     case 0:
B2:00BD03         ?C0029?GPIO_DRIVER:
  186:       *pfState = (P0 & (1 << portPin)) ? TRUE : FALSE;
B2:00BD03 B16B              ACALL    ?L?COM017C
B2:00BD05 8005              SJMP     ?C0096?GPIO_DRIVER
B2:00BD07         ?C0095?GPIO_DRIVER:
B2:00BD07 C3                CLR      C
B2:00BD08 33                RLC      A
B2:00BD09 CE                XCH      A,R6
B2:00BD0A 33                RLC      A
B2:00BD0B CE                XCH      A,R6
B2:00BD0C         ?C0096?GPIO_DRIVER:
B2:00BD0C D8F9              DJNZ     R0,?C0095?GPIO_DRIVER
B2:00BD0E FF                MOV      R7,A
B2:00BD0F AD80              MOV      R5,P0
B2:00BD11 EF                MOV      A,R7
B2:00BD12 5D                ANL      A,R5
B2:00BD13 7F00              MOV      R7,#00H
B2:00BD15 6002              JZ       ?C0030?GPIO_DRIVER
B2:00BD17 7F01              MOV      R7,#01H
B2:00BD19         ?C0030?GPIO_DRIVER:
B2:00BD19         ?C0031?GPIO_DRIVER:
  187:       break;
B2:00BD19 8046              SJMP     ?C0121?GPIO_DRIVER
  188:     case 1:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 721


B2:00BD1B         ?C0032?GPIO_DRIVER:
  189:       *pfState = (P1 & (1 << portPin)) ? TRUE : FALSE;
B2:00BD1B B16B              ACALL    ?L?COM017C
B2:00BD1D 8005              SJMP     ?C0098?GPIO_DRIVER
B2:00BD1F         ?C0097?GPIO_DRIVER:
B2:00BD1F C3                CLR      C
B2:00BD20 33                RLC      A
B2:00BD21 CE                XCH      A,R6
B2:00BD22 33                RLC      A
B2:00BD23 CE                XCH      A,R6
B2:00BD24         ?C0098?GPIO_DRIVER:
B2:00BD24 D8F9              DJNZ     R0,?C0097?GPIO_DRIVER
B2:00BD26 FF                MOV      R7,A
B2:00BD27 AD90              MOV      R5,P1
B2:00BD29 EF                MOV      A,R7
B2:00BD2A 5D                ANL      A,R5
B2:00BD2B 7F00              MOV      R7,#00H
B2:00BD2D 6002              JZ       ?C0033?GPIO_DRIVER
B2:00BD2F 7F01              MOV      R7,#01H
B2:00BD31         ?C0033?GPIO_DRIVER:
B2:00BD31         ?C0034?GPIO_DRIVER:
B2:00BD31         
  190:       break;
B2:00BD31 802E              SJMP     ?C0121?GPIO_DRIVER
  191:     case 2:
B2:00BD33         ?C0035?GPIO_DRIVER:
  192:       *pfState = (P2 & (1 << portPin)) ? TRUE : FALSE;
B2:00BD33 B16B              ACALL    ?L?COM017C
B2:00BD35 8005              SJMP     ?C0100?GPIO_DRIVER
B2:00BD37         ?C0099?GPIO_DRIVER:
B2:00BD37 C3                CLR      C
B2:00BD38 33                RLC      A
B2:00BD39 CE                XCH      A,R6
B2:00BD3A 33                RLC      A
B2:00BD3B CE                XCH      A,R6
B2:00BD3C         ?C0100?GPIO_DRIVER:
B2:00BD3C D8F9              DJNZ     R0,?C0099?GPIO_DRIVER
B2:00BD3E FF                MOV      R7,A
B2:00BD3F ADA0              MOV      R5,P2
B2:00BD41 EF                MOV      A,R7
B2:00BD42 5D                ANL      A,R5
B2:00BD43 7F00              MOV      R7,#00H
B2:00BD45 6002              JZ       ?C0036?GPIO_DRIVER
B2:00BD47 7F01              MOV      R7,#01H
B2:00BD49         ?C0036?GPIO_DRIVER:
B2:00BD49         ?C0037?GPIO_DRIVER:
B2:00BD49         
  193:       break;
B2:00BD49 8016              SJMP     ?C0121?GPIO_DRIVER
  194:     case 3:
B2:00BD4B         ?C0038?GPIO_DRIVER:
  195:       *pfState = (P3 & (1 << portPin)) ? TRUE : FALSE;
B2:00BD4B B16B              ACALL    ?L?COM017C
B2:00BD4D 8005              SJMP     ?C0102?GPIO_DRIVER
B2:00BD4F         ?C0101?GPIO_DRIVER:
B2:00BD4F C3                CLR      C
B2:00BD50 33                RLC      A
B2:00BD51 CE                XCH      A,R6
B2:00BD52 33                RLC      A
B2:00BD53 CE                XCH      A,R6
B2:00BD54         ?C0102?GPIO_DRIVER:
B2:00BD54 D8F9              DJNZ     R0,?C0101?GPIO_DRIVER
B2:00BD56 FF                MOV      R7,A
B2:00BD57 ADB0              MOV      R5,P3
B2:00BD59 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 722


B2:00BD5A 5D                ANL      A,R5
B2:00BD5B 7F00              MOV      R7,#00H
B2:00BD5D 6002              JZ       ?C0039?GPIO_DRIVER
B2:00BD5F 7F01              MOV      R7,#01H
B2:00BD61         ?C0039?GPIO_DRIVER:
B2:00BD61         ?C0040?GPIO_DRIVER:
B2:00BD61         
B2:00BD61 EF                MOV      A,R7
B2:00BD62 122072            LCALL    ?C?CSTPTR
  196:       break;
B2:00BD65 8002              SJMP     ?C0028?GPIO_DRIVER
  197:     default:
B2:00BD67         ?C0041?GPIO_DRIVER:
  198:       return FALSE;
B2:00BD67 C3                CLR      C
B2:00BD68 22                RET      
  199:       break;
  200:   }
B2:00BD69         ?C0028?GPIO_DRIVER:
  201:   return TRUE;
B2:00BD69 D3                SETB     C
  202: }
B2:00BD6A 22                RET      
----- FUNCTION _gpio_GetPinBool (END) -------


----- FUNCTION ?L?COM017C (BEGIN) -----
B2:00BD6B 9043A6            MOV      DPTR,#portPin
B2:00BD6E         ?L?COM017D:
B2:00BD6E E0                MOVX     A,@DPTR
B2:00BD6F FF                MOV      R7,A
B2:00BD70 7401              MOV      A,#01H
B2:00BD72 7E00              MOV      R6,#00H
B2:00BD74 A807              MOV      R0,AR7
B2:00BD76 08                INC      R0
B2:00BD77 22                RET      
----- FUNCTION ?L?COM017C (END) -------


----- FUNCTION ?L?COM02CD (BEGIN) -----
B2:00BD78 EF                MOV      A,R7
B2:00BD79 25E0              ADD      A,ACC
B2:00BD7B 25E0              ADD      A,ACC
B2:00BD7D 2456              ADD      A,#LOW keyList+01H
B2:00BD7F F582              MOV      DPL,A
B2:00BD81 E4                CLR      A
B2:00BD82 3438              ADDC     A,#HIGH keyList+01H
B2:00BD84 F583              MOV      DPH,A
B2:00BD86 22                RET      
----- FUNCTION ?L?COM02CD (END) -------


----- FUNCTION ?L?COM02E8 (BEGIN) -----
B2:00BD87 EF                MOV      A,R7
B2:00BD88         ?L?COM02E9:
B2:00BD88 25E0              ADD      A,ACC
B2:00BD8A 25E0              ADD      A,ACC
B2:00BD8C 2457              ADD      A,#LOW keyList+02H
B2:00BD8E F582              MOV      DPL,A
B2:00BD90 E4                CLR      A
B2:00BD91 3438              ADDC     A,#HIGH keyList+02H
B2:00BD93 F583              MOV      DPH,A
B2:00BD95 22                RET      
----- FUNCTION ?L?COM02E8 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 723



----- FUNCTION GetActiveButton (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  306: GetActiveButton(void)
  307: {
  308:   BYTE keyIndex;
  309:   BYTE pinState;
  310:   BOOL pinResult;
  311: 
  312:   for (keyIndex = 0; keyIndex < NUMBER_OF_KEYS; keyIndex++)
B2:00BD96 E4                CLR      A
B2:00BD97 904366            MOV      DPTR,#keyIndex
B2:00BD9A F0                MOVX     @DPTR,A
B2:00BD9B         ?C0029?KEY_DRIVER:
B2:00BD9B 904366            MOV      DPTR,#keyIndex
B2:00BD9E E0                MOVX     A,@DPTR
B2:00BD9F FF                MOV      R7,A
B2:00BDA0 C3                CLR      C
B2:00BDA1 9406              SUBB     A,#06H
B2:00BDA3 502A              JNC      ?C0034?KEY_DRIVER
  313:   {
  314:     ZW_DEBUG_KEY_DRIVER_SEND_NL();
  315:     ZW_DEBUG_KEY_DRIVER_SEND_STR("Key: ");
  316:     ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyIndex);
  317:     ZW_DEBUG_KEY_DRIVER_SEND_STR(" Pin: ");
  318:     ZW_DEBUG_KEY_DRIVER_SEND_NUM(keyList[keyIndex].keyPin);
  319:     if(0 != keyList[keyIndex].keyPin)
B2:00BDA5 D1DD              ACALL    ?L?COM03EA
B2:00BDA7 E0                MOVX     A,@DPTR
B2:00BDA8 FF                MOV      R7,A
B2:00BDA9 601C              JZ       ?C0031?KEY_DRIVER
  320:     {
  321:       pinResult = gpio_GetPinBool(keyList[keyIndex].keyPin, &pinState);
B2:00BDAB 7B01              MOV      R3,#01H
B2:00BDAD 7A43              MOV      R2,#HIGH pinState
B2:00BDAF 7967              MOV      R1,#LOW pinState
B2:00BDB1 91E7              ACALL    _gpio_GetPinBool
B2:00BDB3 923D              MOV      pinResult,C
  322: 
  323:       if (TRUE == pinResult && !pinState)
B2:00BDB5 303D0F            JNB      pinResult,?C0031?KEY_DRIVER
B2:00BDB8 904367            MOV      DPTR,#pinState
B2:00BDBB E0                MOVX     A,@DPTR
B2:00BDBC 7009              JNZ      ?C0031?KEY_DRIVER
  324:       {
  325:         ZW_DEBUG_KEY_DRIVER_SEND_BYTE('x');
  326:         whichButton = keyIndex;
B2:00BDBE 904366            MOV      DPTR,#keyIndex
B2:00BDC1 E0                MOVX     A,@DPTR
B2:00BDC2 903850            MOV      DPTR,#whichButton
B2:00BDC5 F0                MOVX     @DPTR,A
B2:00BDC6 22                RET      
  327:         return;
  328:       }
  329:     }
  330:   }
B2:00BDC7         ?C0031?KEY_DRIVER:
B2:00BDC7 904366            MOV      DPTR,#keyIndex
B2:00BDCA E0                MOVX     A,@DPTR
B2:00BDCB 04                INC      A
B2:00BDCC F0                MOVX     @DPTR,A
B2:00BDCD 80CC              SJMP     ?C0029?KEY_DRIVER
  331:   ZW_DEBUG_KEY_DRIVER_SEND_NL();
  332:   ZW_DEBUG_KEY_DRIVER_SEND_STR("Couldn't find pin");
  333: }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 724


B2:00BDCF         ?C0034?KEY_DRIVER:
B2:00BDCF 22                RET      
----- FUNCTION GetActiveButton (END) -------


----- FUNCTION ZCB_KeyHeldTimerCallback (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  347: PCB(ZCB_KeyHeldTimerCallback)(void)
  348: {
  349: #ifndef NON_BATT
  350:   if(TRUE == m_keep_alive_timer_activated)
  351:   {
  352:     ZAF_pm_KeepAwake(KEY_DRIVER_HOLD_TIMEOUT);
  353:   }
  354: #endif
  355: 
  356:   if(0 == hold10Count)
B2:00BDD0 903851            MOV      DPTR,#hold10Count
B2:00BDD3 E0                MOVX     A,@DPTR
B2:00BDD4 7030              JNZ      ?C0036?KEY_DRIVER
  357:   {
  358:     // The key was held.
  359:     ZW_DEBUG_KEY_DRIVER_SEND_STR("HELD");
  360:     fKeyHoldThresholdExceeded = TRUE;
B2:00BDD6 D222              SETB     fKeyHoldThresholdExceeded
  361: 
  362:     if (NON_NULL(keyList[whichButton].pEventCallback) && (keyList[whichButton].keyEvents & BITFIELD_KEY_HOLD))
B2:00BDD8 903850            MOV      DPTR,#whichButton
B2:00BDDB E0                MOVX     A,@DPTR
B2:00BDDC FF                MOV      R7,A
B2:00BDDD B188              ACALL    ?L?COM02E9
B2:00BDDF E0                MOVX     A,@DPTR
B2:00BDE0 FC                MOV      R4,A
B2:00BDE1 A3                INC      DPTR
B2:00BDE2 E0                MOVX     A,@DPTR
B2:00BDE3 4C                ORL      A,R4
B2:00BDE4 6019              JZ       ?C0037?KEY_DRIVER
B2:00BDE6 B178              ACALL    ?L?COM02CD
B2:00BDE8 E0                MOVX     A,@DPTR
B2:00BDE9 30E313            JNB      ACC.3,?C0037?KEY_DRIVER
  363:     {
  364:       holdCount++;
B2:00BDEC 903853            MOV      DPTR,#holdCount
B2:00BDEF E0                MOVX     A,@DPTR
B2:00BDF0 04                INC      A
B2:00BDF1 F0                MOVX     @DPTR,A
  365:       keyList[whichButton].pEventCallback(whichButton, KEY_HOLD, holdCount);
B2:00BDF2 903853            MOV      DPTR,#holdCount
B2:00BDF5 E0                MOVX     A,@DPTR
B2:00BDF6 FB                MOV      R3,A
B2:00BDF7 EF                MOV      A,R7
B2:00BDF8 714B              ACALL    ?L?COM00AA
B2:00BDFA 7D03              MOV      R5,#03H
B2:00BDFC 12271A            LCALL    ?C?ICALL2
  366:     }
B2:00BDFF         ?C0037?KEY_DRIVER:
  367:      hold10Count = 10;
B2:00BDFF 903851            MOV      DPTR,#hold10Count
B2:00BE02 740A              MOV      A,#0AH
B2:00BE04 F0                MOVX     @DPTR,A
  368:   }
B2:00BE05 22                RET      
B2:00BE06         ?C0036?KEY_DRIVER:
  369:   else{
  370:     hold10Count--;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 725


B2:00BE06 903851            MOV      DPTR,#hold10Count
B2:00BE09 E0                MOVX     A,@DPTR
B2:00BE0A 14                DEC      A
B2:00BE0B F0                MOVX     @DPTR,A
  371:   }
  372: }
B2:00BE0C 22                RET      
----- FUNCTION ZCB_KeyHeldTimerCallback (END) -------


----- FUNCTION ?L?COM0356 (BEGIN) -----
B2:00BE0D EE                MOV      A,R6
B2:00BE0E         ?L?COM0357:
B2:00BE0E 75F003            MOV      B,#03H
B2:00BE11 A4                MUL      AB
B2:00BE12 2466              ADD      A,#LOW channels+01H
B2:00BE14 F582              MOV      DPL,A
B2:00BE16 E4                CLR      A
B2:00BE17 3437              ADDC     A,#HIGH channels+01H
B2:00BE19 22                RET      
----- FUNCTION ?L?COM0356 (END) -------


----- FUNCTION ZCB_test_interface_poll (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE.C'
  136: PCB_BOOL(ZCB_test_interface_poll)(void)
  137: {
  138:   uint8_t channel_index;
  139:   static uint8_t buffer[DMA_BUFFER_SIZE_SINGLE];
  140:   uint8_t dataLength;
  141: 
  142: #ifdef ZW_TEST_INTERFACE_DRIVER
  143:   if (TRUE != ZW_test_interface_driver_getData(buffer, &dataLength))
B2:00BE1A 7B01              MOV      R3,#01H
B2:00BE1C 7A43              MOV      R2,#HIGH dataLength
B2:00BE1E 7931              MOV      R1,#LOW dataLength
B2:00BE20 900A85            MOV      DPTR,#?_ZW_test_interface_driver_getData?BYTE+03H
B2:00BE23 1225A9            LCALL    ?C?PSTXDATA
B2:00BE26 7A37              MOV      R2,#HIGH buffer
B2:00BE28 7944              MOV      R1,#LOW buffer
B2:00BE2A 12614F            LCALL    _ZW_test_interface_driver_getData
B2:00BE2D 4001              JC       ?C0006?ZW_TEST_INTERFACE
  144:   {
  145:     return FALSE;
B2:00BE2F 22                RET      
  146:   }
B2:00BE30         ?C0006?ZW_TEST_INTERFACE:
  147: #endif /*ZW_TEST_INTERFACE_DRIVER*/
  148:   ZW_DEBUG_TEST_INTERFACE_SEND_NL();
  149:   ZW_DEBUG_TEST_INTERFACE_SEND_STR("Data length:");
  150:   ZW_DEBUG_TEST_INTERFACE_SEND_NUM(dataLength);
  151: 
  152:   if ('\r' == buffer[dataLength - 1])
B2:00BE30 904331            MOV      DPTR,#dataLength
B2:00BE33 E0                MOVX     A,@DPTR
B2:00BE34 FF                MOV      R7,A
B2:00BE35 D1EC              ACALL    ?L?COM0525
B2:00BE37 E0                MOVX     A,@DPTR
B2:00BE38 640D              XRL      A,#0DH
B2:00BE3A 6002              JZ       $ + 4H
B2:00BE3C C1CC              AJMP     ?C0008?ZW_TEST_INTERFACE
  153:   {
  154:     BOOL channel_status = FALSE;
B2:00BE3E C252              CLR      channel_status
  155:     ZW_DEBUG_TEST_INTERFACE_SEND_NL();
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 726


  156:     ZW_DEBUG_TEST_INTERFACE_SEND_BYTE('2');
  157:     if ((dataLength > 2) && (0x20 == buffer[1])) // 0x20 == <space>
B2:00BE40 EF                MOV      A,R7
B2:00BE41 D3                SETB     C
B2:00BE42 9402              SUBB     A,#02H
B2:00BE44 4045              JC       ?C0009?ZW_TEST_INTERFACE
B2:00BE46 903745            MOV      DPTR,#buffer+01H
B2:00BE49 E0                MOVX     A,@DPTR
B2:00BE4A 6420              XRL      A,#020H
B2:00BE4C 703D              JNZ      ?C0009?ZW_TEST_INTERFACE
  158:     {
  159:       // We got minimum three characters => valid input.
  160:       INDEX_RESULT_T index_result = get_index_from_channel(&channel_index,
B2:00BE4E 7A43              MOV      R2,#HIGH channel_index
B2:00BE50 7930              MOV      R1,#LOW channel_index
B2:00BE52 903744            MOV      DPTR,#buffer
B2:00BE55 D1F6              ACALL    ?L?COM05E9
B2:00BE57 904332            MOV      DPTR,#index_result
B2:00BE5A EF                MOV      A,R7
B2:00BE5B F0                MOVX     @DPTR,A
  161:               buffer[0]);
  162:       ZW_DEBUG_TEST_INTERFACE_SEND_BYTE('3');
  163:       if ((INDEX_CHANNEL_FOUND == index_result)
B2:00BE5C 702D              JNZ      ?C0009?ZW_TEST_INTERFACE
B2:00BE5E 904330            MOV      DPTR,#channel_index
B2:00BE61 E0                MOVX     A,@DPTR
B2:00BE62 FE                MOV      R6,A
B2:00BE63 D10E              ACALL    ?L?COM0357
B2:00BE65 F583              MOV      DPH,A
B2:00BE67 E0                MOVX     A,@DPTR
B2:00BE68 FC                MOV      R4,A
B2:00BE69 A3                INC      DPTR
B2:00BE6A E0                MOVX     A,@DPTR
B2:00BE6B 4C                ORL      A,R4
B2:00BE6C 601D              JZ       ?C0009?ZW_TEST_INTERFACE
  164:               && (NULL != channels[channel_index].pCallback))
  165:       {
  166:         ZW_DEBUG_TEST_INTERFACE_SEND_BYTE('!');
  167:         buffer[dataLength - 1] = '\0';
B2:00BE6E 904331            MOV      DPTR,#dataLength
B2:00BE71 E0                MOVX     A,@DPTR
B2:00BE72 D1EC              ACALL    ?L?COM0525
B2:00BE74 E4                CLR      A
B2:00BE75 F0                MOVX     @DPTR,A
  168:         (channels[channel_index].pCallback)(buffer[0], (char *)&buffer[2]);
B2:00BE76 903744            MOV      DPTR,#buffer
B2:00BE79 E0                MOVX     A,@DPTR
B2:00BE7A FF                MOV      R7,A
B2:00BE7B 7B01              MOV      R3,#01H
B2:00BE7D 7A37              MOV      R2,#HIGH buffer+02H
B2:00BE7F 7946              MOV      R1,#LOW buffer+02H
B2:00BE81 D10D              ACALL    ?L?COM0356
B2:00BE83 12515B            LCALL    ?L?COM0153
B2:00BE86 12271A            LCALL    ?C?ICALL2
  169:         channel_status = TRUE;
B2:00BE89 D252              SETB     channel_status
  170:       }
  171:     }
B2:00BE8B         ?C0009?ZW_TEST_INTERFACE:
  172:     if(FALSE == channel_status)
B2:00BE8B 20523E            JB       channel_status,?C0008?ZW_TEST_INTERFACE
  173:     {
  174:       uint8_t i = 0;
B2:00BE8E E4                CLR      A
B2:00BE8F 904332            MOV      DPTR,#i
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 727


B2:00BE92 F0                MOVX     @DPTR,A
  175:       /* No channel defined*/
  176:       ZDB_SEND_STR((BYTE *)"\r\nChannels are:");
B2:00BE93 7BFF              MOV      R3,#0FFH
B2:00BE95 7A2F              MOV      R2,#HIGH 01002FC5H
B2:00BE97 79C5              MOV      R1,#LOW 01002FC5H
B2:00BE99 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
  177:       for(i = 0; i < NUMBER_OF_CHANNELS; i++)
B2:00BE9C E4                CLR      A
B2:00BE9D 904332            MOV      DPTR,#i
B2:00BEA0 F0                MOVX     @DPTR,A
B2:00BEA1         ?C0012?ZW_TEST_INTERFACE:
B2:00BEA1 904332            MOV      DPTR,#i
B2:00BEA4 E0                MOVX     A,@DPTR
B2:00BEA5 FF                MOV      R7,A
B2:00BEA6 C3                CLR      C
B2:00BEA7 9402              SUBB     A,#02H
B2:00BEA9 5021              JNC      ?C0008?ZW_TEST_INTERFACE
  178:       {
  179:         if(channels[i].channel != 0)
B2:00BEAB D1CE              ACALL    ?L?COM022E
B2:00BEAD E0                MOVX     A,@DPTR
B2:00BEAE 6014              JZ       ?C0014?ZW_TEST_INTERFACE
  180:         {
  181:           ZDB_SEND_STR((BYTE *)"\r\n\t >");
B2:00BEB0 7BFF              MOV      R3,#0FFH
B2:00BEB2 7A2F              MOV      R2,#HIGH 01002FD5H
B2:00BEB4 79D5              MOV      R1,#LOW 01002FD5H
B2:00BEB6 121D2C            LCALL    ?INTERBANK_TABLE?_ZW_UART0_tx_send_str
  182:           ZDB_SEND_BYTE(channels[i].channel);
B2:00BEB9 904332            MOV      DPTR,#i
B2:00BEBC E0                MOVX     A,@DPTR
B2:00BEBD D1CF              ACALL    ?L?COM022F
B2:00BEBF E0                MOVX     A,@DPTR
B2:00BEC0 FF                MOV      R7,A
B2:00BEC1 126C20            LCALL    _ZW_UART0_tx_send_byte
  183:         }
  184:       }
B2:00BEC4         ?C0014?ZW_TEST_INTERFACE:
B2:00BEC4 904332            MOV      DPTR,#i
B2:00BEC7 E0                MOVX     A,@DPTR
B2:00BEC8 04                INC      A
B2:00BEC9 F0                MOVX     @DPTR,A
B2:00BECA 80D5              SJMP     ?C0012?ZW_TEST_INTERFACE
  185:     }
  186:   }
B2:00BECC         ?C0008?ZW_TEST_INTERFACE:
  187: 
  188:   return TRUE;
B2:00BECC D3                SETB     C
  189: }
B2:00BECD 22                RET      
----- FUNCTION ZCB_test_interface_poll (END) -------


----- FUNCTION ?L?COM022E (BEGIN) -----
B2:00BECE EF                MOV      A,R7
B2:00BECF         ?L?COM022F:
B2:00BECF 75F003            MOV      B,#03H
B2:00BED2 A4                MUL      AB
B2:00BED3 2465              ADD      A,#LOW channels
B2:00BED5 F582              MOV      DPL,A
B2:00BED7 E4                CLR      A
B2:00BED8 3437              ADDC     A,#HIGH channels
B2:00BEDA F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 728


B2:00BEDC 22                RET      
----- FUNCTION ?L?COM022E (END) -------


----- FUNCTION ?L?COM03EA (BEGIN) -----
B2:00BEDD EF                MOV      A,R7
B2:00BEDE 25E0              ADD      A,ACC
B2:00BEE0 25E0              ADD      A,ACC
B2:00BEE2 2455              ADD      A,#LOW keyList
B2:00BEE4 F582              MOV      DPL,A
B2:00BEE6 E4                CLR      A
B2:00BEE7 3438              ADDC     A,#HIGH keyList
B2:00BEE9 F583              MOV      DPH,A
B2:00BEEB 22                RET      
----- FUNCTION ?L?COM03EA (END) -------


----- FUNCTION ?L?COM0525 (BEGIN) -----
B2:00BEEC 2443              ADD      A,#LOW buffer-01H
B2:00BEEE F582              MOV      DPL,A
B2:00BEF0 E4                CLR      A
B2:00BEF1 3437              ADDC     A,#HIGH buffer-01H
B2:00BEF3 F583              MOV      DPH,A
B2:00BEF5 22                RET      
----- FUNCTION ?L?COM0525 (END) -------


----- FUNCTION ?L?COM05E9 (BEGIN) -----
B2:00BEF6 7B01              MOV      R3,#01H
B2:00BEF8 E0                MOVX     A,@DPTR
B2:00BEF9 FD                MOV      R5,A
----- FUNCTION _get_index_from_channel (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE.C'
  198: static INDEX_RESULT_T get_index_from_channel(uint8_t * pIndex, char channel)
  199: {
;---- Variable 'pIndex' assigned to Register 'R1/R2/R3' ----
;---- Variable 'channel' assigned to Register 'R5' ----
  200:   uint8_t count;
  201: 
  202:   for (count = 0; count < NUMBER_OF_CHANNELS; count++)
;---- Variable 'count' assigned to Register 'R7' ----
B2:00BEFA E4                CLR      A
B2:00BEFB FF                MOV      R7,A
B2:00BEFC         ?C0016?ZW_TEST_INTERFACE:
  203:   {
  204:     if (channel == channels[count].channel)
B2:00BEFC D1CE              ACALL    ?L?COM022E
B2:00BEFE E0                MOVX     A,@DPTR
B2:00BEFF FE                MOV      R6,A
B2:00BF00 B50507            CJNE     A,AR5,?C0019?ZW_TEST_INTERFACE
  205:     {
  206:       // The channel has already been allocated => return index.
  207:       *pIndex = count;
B2:00BF03 EF                MOV      A,R7
B2:00BF04 122072            LCALL    ?C?CSTPTR
  208:       ZW_DEBUG_TEST_INTERFACE_SEND_STR("TI INDEX FOUND");
  209:       return INDEX_CHANNEL_FOUND;
B2:00BF07 7F00              MOV      R7,#00H
B2:00BF09 22                RET      
  210:     }
B2:00BF0A         ?C0019?ZW_TEST_INTERFACE:
  211:     else if (0 == channels[count].channel)
B2:00BF0A EE                MOV      A,R6
B2:00BF0B 7007              JNZ      ?C0018?ZW_TEST_INTERFACE
  212:     {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 729


  213:       *pIndex = count;
B2:00BF0D EF                MOV      A,R7
B2:00BF0E 122072            LCALL    ?C?CSTPTR
  214:       ZW_DEBUG_TEST_INTERFACE_SEND_STR("TI INDEX NEW");
  215:       return INDEX_CHANNEL_NEW;
B2:00BF11 7F01              MOV      R7,#01H
B2:00BF13 22                RET      
  216:     }
  217:   }
B2:00BF14         ?C0018?ZW_TEST_INTERFACE:
B2:00BF14 0F                INC      R7
B2:00BF15 EF                MOV      A,R7
B2:00BF16 B402E3            CJNE     A,#02H,?C0016?ZW_TEST_INTERFACE
B2:00BF19         ?C0017?ZW_TEST_INTERFACE:
  218: 
  219:   *pIndex = NUMBER_OF_CHANNELS;
B2:00BF19 7402              MOV      A,#02H
B2:00BF1B 122072            LCALL    ?C?CSTPTR
  220:   ZW_DEBUG_TEST_INTERFACE_SEND_NL(); ZW_DEBUG_TEST_INTERFACE_SEND_STR("TI INDEX FULL");
  221:   return INDEX_CHANNEL_FULL;
B2:00BF1E FF                MOV      R7,A
  222: }
B2:00BF1F 22                RET      
----- FUNCTION _get_index_from_channel (END) -------


----- FUNCTION ?L?COM0210 (BEGIN) -----
B2:00BF20 FF                MOV      R7,A
B2:00BF21 903A4A            MOV      DPTR,#pTxBuf
B2:00BF24         ?L?COM0211:
B2:00BF24 122589            LCALL    ?C?PLDXDATA
B2:00BF27 900004            MOV      DPTR,#04H
B2:00BF2A EF                MOV      A,R7
B2:00BF2B 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0210 (END) -------


----- FUNCTION ZCB_KeyTriplePressTimerCallback (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\KEY_DRIVER.C'
  377: PCB(ZCB_KeyTriplePressTimerCallback)(void)
  378: {
  379:   keyTriplePressTimerHandle = 0;
  380:   pressCount = 0;
B2:00BF2E E4                CLR      A
B2:00BF2F 903852            MOV      DPTR,#keyTriplePressTimerHandle
B2:00BF32 F0                MOVX     @DPTR,A
  381:   ZW_DEBUG_KEY_DRIVER_SEND_STR("KEY RESET");
B2:00BF33 903854            MOV      DPTR,#pressCount
B2:00BF36 F0                MOVX     @DPTR,A
  382: }
B2:00BF37 22                RET      
----- FUNCTION ZCB_KeyTriplePressTimerCallback (END) -------


----- FUNCTION _PinOn (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  209: PinOn(BYTE pin)
  210: {
;---- Variable 'pin' assigned to Register 'R7' ----
  211:   BYTE port = pin>>4;
  212:   BYTE portPin = pin&0x0F;
;---- Variable 'port' assigned to Register 'R6' ----
;---- Variable 'portPin' assigned to Register 'R7' ----
B2:00BF38 91B6              ACALL    ?L?COM029A
B2:00BF3A 601B              JZ       ?C0045?GPIO_DRIVER
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 730


B2:00BF3C 14                DEC      A
B2:00BF3D 6029              JZ       ?C0046?GPIO_DRIVER
B2:00BF3F 14                DEC      A
B2:00BF40 6037              JZ       ?C0047?GPIO_DRIVER
B2:00BF42 2403              ADD      A,#03H
B2:00BF44 7043              JNZ      ?C0048?GPIO_DRIVER
  213: 
  214:   switch(port)
  215:   {
  216:     case 0:
B2:00BF46         ?C0044?GPIO_DRIVER:
  217:       P0Shadow |= (1 << portPin);
B2:00BF46 7401              MOV      A,#01H
B2:00BF48 A807              MOV      R0,AR7
B2:00BF4A 08                INC      R0
B2:00BF4B 8002              SJMP     ?C0104?GPIO_DRIVER
B2:00BF4D         ?C0103?GPIO_DRIVER:
B2:00BF4D C3                CLR      C
B2:00BF4E 33                RLC      A
B2:00BF4F         ?C0104?GPIO_DRIVER:
B2:00BF4F D8FC              DJNZ     R0,?C0103?GPIO_DRIVER
B2:00BF51 426C              ORL      P0Shadow,A
  218:       P0 = P0Shadow;
B2:00BF53 856C80            MOV      P0,P0Shadow
  219:       break;
B2:00BF56 22                RET      
  220:     case 1:
B2:00BF57         ?C0045?GPIO_DRIVER:
  221:       P1Shadow |= (1 << portPin);
B2:00BF57 7401              MOV      A,#01H
B2:00BF59 A807              MOV      R0,AR7
B2:00BF5B 08                INC      R0
B2:00BF5C 8002              SJMP     ?C0106?GPIO_DRIVER
B2:00BF5E         ?C0105?GPIO_DRIVER:
B2:00BF5E C3                CLR      C
B2:00BF5F 33                RLC      A
B2:00BF60         ?C0106?GPIO_DRIVER:
B2:00BF60 D8FC              DJNZ     R0,?C0105?GPIO_DRIVER
B2:00BF62 426D              ORL      P1Shadow,A
  222:       P1 = P1Shadow;
B2:00BF64 856D90            MOV      P1,P1Shadow
  223:       break;
B2:00BF67 22                RET      
  224:     case 2:
B2:00BF68         ?C0046?GPIO_DRIVER:
  225:       P2Shadow |= (1 << portPin);
B2:00BF68 7401              MOV      A,#01H
B2:00BF6A A807              MOV      R0,AR7
B2:00BF6C 08                INC      R0
B2:00BF6D 8002              SJMP     ?C0108?GPIO_DRIVER
B2:00BF6F         ?C0107?GPIO_DRIVER:
B2:00BF6F C3                CLR      C
B2:00BF70 33                RLC      A
B2:00BF71         ?C0108?GPIO_DRIVER:
B2:00BF71 D8FC              DJNZ     R0,?C0107?GPIO_DRIVER
B2:00BF73 426E              ORL      P2Shadow,A
  226:       P2 = P2Shadow;
B2:00BF75 856EA0            MOV      P2,P2Shadow
  227:       break;
B2:00BF78 22                RET      
  228:     case 3:
B2:00BF79         ?C0047?GPIO_DRIVER:
  229:       P3Shadow |= (1 << portPin);
B2:00BF79 7401              MOV      A,#01H
B2:00BF7B A807              MOV      R0,AR7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 731


B2:00BF7D 08                INC      R0
B2:00BF7E 8002              SJMP     ?C0110?GPIO_DRIVER
B2:00BF80         ?C0109?GPIO_DRIVER:
B2:00BF80 C3                CLR      C
B2:00BF81 33                RLC      A
B2:00BF82         ?C0110?GPIO_DRIVER:
B2:00BF82 D8FC              DJNZ     R0,?C0109?GPIO_DRIVER
B2:00BF84 426F              ORL      P3Shadow,A
  230:       P3 = P3Shadow;
B2:00BF86 856FB0            MOV      P3,P3Shadow
  231:       break;
  232:   }
  233:   return;
  234: }
B2:00BF89         ?C0048?GPIO_DRIVER:
B2:00BF89 22                RET      
----- FUNCTION _PinOn (END) -------


----- FUNCTION gpio_DriverInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\GPIO_DRIVER.C'
  269: gpio_DriverInit(BOOL automaticPinSwap)
  270: {
  271:   BYTE nvrPinSwapValue;
  272: 
  273:   ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  274:   ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO init!");
  275: 
  276:   if (TRUE != automaticPinSwap)
B2:00BF8A 203F02            JB       automaticPinSwap,?C0055?GPIO_DRIVER
  277:   {
  278:     ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  279:     ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: Exit!");
  280:     return TRUE;
B2:00BF8D D3                SETB     C
B2:00BF8E 22                RET      
  281:   }
B2:00BF8F         ?C0055?GPIO_DRIVER:
  282: 
  283:   ZW_NVRGetValue(offsetof(NVR_FLASH_STRUCT, bPinSwap) , 1, &nvrPinSwapValue);
B2:00BF8F 7B01              MOV      R3,#01H
B2:00BF91 7A43              MOV      R2,#HIGH nvrPinSwapValue
B2:00BF93 79A7              MOV      R1,#LOW nvrPinSwapValue
B2:00BF95 7D01              MOV      R5,#01H
B2:00BF97 7F02              MOV      R7,#02H
B2:00BF99 121C0F            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
  284: 
  285:   if (1 == nvrPinSwapValue)
B2:00BF9C 9043A7            MOV      DPTR,#nvrPinSwapValue
B2:00BF9F E0                MOVX     A,@DPTR
B2:00BFA0 B40113            CJNE     A,#01H,?C0057?GPIO_DRIVER
  286:   {
  287:     // The pins are swapped.
  288:     ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  289:     ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: Pins swapped.");
  290:     gpio_GetPinSwapList(&pPinSwapList, &pinListSize);
B2:00BFA3 7B01              MOV      R3,#01H
B2:00BFA5 7A43              MOV      R2,#HIGH pinListSize
B2:00BFA7 7909              MOV      R1,#LOW pinListSize
B2:00BFA9 904135            MOV      DPTR,#?_gpio_GetPinSwapList?BYTE+03H
B2:00BFAC 1225A9            LCALL    ?C?PSTXDATA
B2:00BFAF 7A43              MOV      R2,#HIGH pPinSwapList
B2:00BFB1 09                INC      R1
B2:00BFB2 1194              ACALL    _gpio_GetPinSwapList
  291:   }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 732


B2:00BFB4 8012              SJMP     ?C0058?GPIO_DRIVER
B2:00BFB6         ?C0057?GPIO_DRIVER:
  292:   else if((0x02 <= nvrPinSwapValue) && (0xFE >= nvrPinSwapValue))
B2:00BFB6 9043A7            MOV      DPTR,#nvrPinSwapValue
B2:00BFB9 E0                MOVX     A,@DPTR
B2:00BFBA FF                MOV      R7,A
B2:00BFBB 7402              MOV      A,#02H
B2:00BFBD D3                SETB     C
B2:00BFBE 9F                SUBB     A,R7
B2:00BFBF 5007              JNC      ?C0058?GPIO_DRIVER
B2:00BFC1 74FE              MOV      A,#0FEH
B2:00BFC3 C3                CLR      C
B2:00BFC4 9F                SUBB     A,R7
B2:00BFC5 4001              JC       ?C0058?GPIO_DRIVER
  293:   {
  294:     ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  295:     ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: Invalid value!");
  296:     return FALSE;
B2:00BFC7 22                RET      
  297:   }
B2:00BFC8         ?C0058?GPIO_DRIVER:
  298: 
  299:   ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  300:   ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: pinListSize = ");
  301:   ZW_DEBUG_GPIO_DRIVER_SEND_NUM(pinListSize);
  302:   ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: pPinSwapList = ");
  303:   ZW_DEBUG_GPIO_DRIVER_SEND_WORD_NUM((WORD)pPinSwapList);
  304:   if (pinListSize > 0 && NON_NULL(pPinSwapList))
B2:00BFC8 904309            MOV      DPTR,#pinListSize
B2:00BFCB E0                MOVX     A,@DPTR
B2:00BFCC D3                SETB     C
B2:00BFCD 9400              SUBB     A,#00H
B2:00BFCF 400A              JC       ?C0060?GPIO_DRIVER
B2:00BFD1 A3                INC      DPTR
B2:00BFD2 E0                MOVX     A,@DPTR
B2:00BFD3 FE                MOV      R6,A
B2:00BFD4 A3                INC      DPTR
B2:00BFD5 E0                MOVX     A,@DPTR
B2:00BFD6 4E                ORL      A,R6
B2:00BFD7 6002              JZ       ?C0060?GPIO_DRIVER
  305:   {
  306:     ZW_DEBUG_GPIO_DRIVER_SEND_NL();
  307:     ZW_DEBUG_GPIO_DRIVER_SEND_STR("GPIO: Do pin swap.");
  308:     fDoPinSwap = TRUE;
B2:00BFD9 D242              SETB     fDoPinSwap
  309:   }
B2:00BFDB         ?C0060?GPIO_DRIVER:
  310: 
  311:   return TRUE;
B2:00BFDB D3                SETB     C
  312: }
B2:00BFDC 22                RET      
----- FUNCTION gpio_DriverInit (END) -------


----- FUNCTION init_once (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TEST_INTERFACE.C'
   88: void init_once(void)
   89: {
   90:   static BOOL fIsInitialized = FALSE;
   91:   ZW_DEBUG_TEST_INTERFACE_SEND_NL(); ZW_DEBUG_TEST_INTERFACE_SEND_STR("init_once"); ZW_DEBUG_TEST_INTERFACE_SEND_
>> NL();
   92:   if (FALSE == fIsInitialized)
B2:00BFDD 205121            JB       fIsInitialized,?C0003?ZW_TEST_INTERFACE
   93:   {
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 733


   94:     ZW_test_interface_driver_init();
B2:00BFE0 126EF6            LCALL    ZW_test_interface_driver_init
   95:     // Do this initialization only the first time this function is called.
   96:     fIsInitialized = TRUE;
B2:00BFE3 D251              SETB     fIsInitialized
   97: 
   98:     memset((uint8_t * )channels, 0x00, (NUMBER_OF_CHANNELS * sizeof(CHANNEL_T)));
B2:00BFE5 7A37              MOV      R2,#HIGH channels
B2:00BFE7 7965              MOV      R1,#LOW channels
B2:00BFE9 12719E            LCALL    ?L?COM032A
B2:00BFEC 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
   99:     if ((taskHandleId = TaskAdd(ZCB_test_interface_poll,
B2:00BFEF 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_test_interface_poll
B2:00BFF1 7FB7              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_test_interface_poll
B2:00BFF3 7BFF              MOV      R3,#0FFH
B2:00BFF5 7A2F              MOV      R2,#HIGH 01002FADH
B2:00BFF7 79AD              MOV      R1,#LOW 01002FADH
B2:00BFF9 12C002            LCALL    _TaskAdd
B2:00BFFC 903764            MOV      DPTR,#taskHandleId
B2:00BFFF EF                MOV      A,R7
B2:00C000 F0                MOVX     @DPTR,A
  100:             "ZCB_test_interface_poll")) == 0)
  101:     {
  102:       ZW_DEBUG_TEST_INTERFACE_SEND_NL(); ZW_DEBUG_TEST_INTERFACE_SEND_STR("Task pool full");
  103:     }
  104: 
  105:     ZW_DEBUG_TEST_INTERFACE_SEND_NL(); ZW_DEBUG_TEST_INTERFACE_SEND_STR("TI init.");
  106:   }
  107: }
B2:00C001         ?C0003?ZW_TEST_INTERFACE:
B2:00C001 22                RET      
----- FUNCTION init_once (END) -------


----- FUNCTION _TaskAdd (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
   97: uint8_t TaskAdd(BOOL (CODE *CBPolltask)(void), const char * pTaskName)
B2:00C002 90414A            MOV      DPTR,#pTaskName
;---- Variable 'CBPolltask' assigned to Register 'R4/R5' ----
B2:00C005 127409            LCALL    ?L?COM05F6
   98: {
   99:   uint8_t i = 0;
B2:00C008 E4                CLR      A
B2:00C009 90414D            MOV      DPTR,#i
B2:00C00C F0                MOVX     @DPTR,A
  100:   uint8_t freeSlot = 0xff;
B2:00C00D A3                INC      DPTR
B2:00C00E 74FF              MOV      A,#0FFH
B2:00C010 F0                MOVX     @DPTR,A
  101:   uint8_t nextId = 0;
B2:00C011 E4                CLR      A
B2:00C012 A3                INC      DPTR
B2:00C013 F0                MOVX     @DPTR,A
  102: 
  103:   /*Search for a free slot in pool queue*/
  104:   for(i = 0; i < TASK_POOL_SIZE; i++)
B2:00C014 90414D            MOV      DPTR,#i
B2:00C017 F0                MOVX     @DPTR,A
B2:00C018         ?C0001?ZW_TASK:
B2:00C018 90414D            MOV      DPTR,#i
B2:00C01B E0                MOVX     A,@DPTR
B2:00C01C FF                MOV      R7,A
B2:00C01D C3                CLR      C
B2:00C01E 9405              SUBB     A,#05H
B2:00C020 506C              JNC      ?C0002?ZW_TASK
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 734


  105:   {
  106:     /* find free slot*/
  107:     if((0 == myTask.myTaskPool[i].id) && (0xff == freeSlot))
B2:00C022 EF                MOV      A,R7
B2:00C023 11DE              ACALL    ?L?COM008A
B2:00C025 E0                MOVX     A,@DPTR
B2:00C026 543F              ANL      A,#03FH
B2:00C028 FF                MOV      R7,A
B2:00C029 700D              JNZ      ?C0004?ZW_TASK
B2:00C02B 90414E            MOV      DPTR,#freeSlot
B2:00C02E E0                MOVX     A,@DPTR
B2:00C02F B4FF06            CJNE     A,#0FFH,?C0004?ZW_TASK
  108:     {
  109:       freeSlot = i;
B2:00C032 90414D            MOV      DPTR,#i
B2:00C035 E0                MOVX     A,@DPTR
B2:00C036 A3                INC      DPTR
B2:00C037 F0                MOVX     @DPTR,A
  110:     }
B2:00C038         ?C0004?ZW_TASK:
  111: 
  112:     /* find next Id*/
  113:     if( nextId <= myTask.myTaskPool[i].id)
B2:00C038 90414F            MOV      DPTR,#nextId
B2:00C03B E0                MOVX     A,@DPTR
B2:00C03C D3                SETB     C
B2:00C03D 9F                SUBB     A,R7
B2:00C03E 500E              JNC      ?C0005?ZW_TASK
  114:     {
  115:       nextId = myTask.myTaskPool[i].id + 1;
B2:00C040 90414D            MOV      DPTR,#i
B2:00C043 E0                MOVX     A,@DPTR
B2:00C044 11DE              ACALL    ?L?COM008A
B2:00C046 E0                MOVX     A,@DPTR
B2:00C047 543F              ANL      A,#03FH
B2:00C049 04                INC      A
B2:00C04A 90414F            MOV      DPTR,#nextId
B2:00C04D F0                MOVX     @DPTR,A
  116:     }
B2:00C04E         ?C0005?ZW_TASK:
  117: 
  118:     /*Check if it is in pool*/
  119:     if((CBPolltask == myTask.myTaskPool[i].CBPolltask) &&
B2:00C04E 90414D            MOV      DPTR,#i
B2:00C051 E0                MOVX     A,@DPTR
B2:00C052 313D              ACALL    ?L?COM021E
B2:00C054 124699            LCALL    ?L?COM0226
B2:00C057 6D                XRL      A,R5
B2:00C058 7002              JNZ      ?C0045?ZW_TASK
B2:00C05A EE                MOV      A,R6
B2:00C05B 6C                XRL      A,R4
B2:00C05C         ?C0045?ZW_TASK:
B2:00C05C 7028              JNZ      ?C0003?ZW_TASK
B2:00C05E ED                MOV      A,R5
B2:00C05F 4C                ORL      A,R4
B2:00C060 6024              JZ       ?C0003?ZW_TASK
  120:         (NULL != CBPolltask))
  121:     {
  122:       /*Task is in pool*/
  123:       myTask.nextSlot = i;
B2:00C062 90414D            MOV      DPTR,#i
B2:00C065 E0                MOVX     A,@DPTR
B2:00C066 FF                MOV      R7,A
B2:00C067 903791            MOV      DPTR,#myTask+02H
B2:00C06A F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 735


  124:       myTask.poolJobStatus = TRUE; /*Force pool check*/
B2:00C06B 5111              ACALL    ?L?COM0531
  125:       /*Break loop and return the task id*/
  126:       freeSlot = 0xff;
B2:00C06D 90414E            MOV      DPTR,#freeSlot
B2:00C070 74FF              MOV      A,#0FFH
B2:00C072 F0                MOVX     @DPTR,A
  127:       nextId = myTask.myTaskPool[i].id;
B2:00C073 EF                MOV      A,R7
B2:00C074 11DE              ACALL    ?L?COM008A
B2:00C076 E0                MOVX     A,@DPTR
B2:00C077 543F              ANL      A,#03FH
B2:00C079 90414F            MOV      DPTR,#nextId
B2:00C07C 51A9              ACALL    ?L?COM05F5
B2:00C07E 90414D            MOV      DPTR,#i
B2:00C081 E0                MOVX     A,@DPTR
B2:00C082 3149              ACALL    ?L?COM0269
  128: 	    myTask.myTaskPool[i].pTaskName = pTaskName;
  129:       break;
B2:00C084 8008              SJMP     ?C0002?ZW_TASK
  130:     }
  131:   }
B2:00C086         ?C0003?ZW_TASK:
B2:00C086 90414D            MOV      DPTR,#i
B2:00C089 E0                MOVX     A,@DPTR
B2:00C08A 04                INC      A
B2:00C08B F0                MOVX     @DPTR,A
B2:00C08C 808A              SJMP     ?C0001?ZW_TASK
B2:00C08E         ?C0002?ZW_TASK:
  132: 
  133:   /** Add task to pool*/
  134:   if(0xff != freeSlot)
B2:00C08E 90414E            MOV      DPTR,#freeSlot
B2:00C091 E0                MOVX     A,@DPTR
B2:00C092 F4                CPL      A
B2:00C093 603D              JZ       ?C0007?ZW_TASK
  135:   {
  136:     myTask.myTaskPool[freeSlot].id = nextId;
B2:00C095 A3                INC      DPTR
B2:00C096 E0                MOVX     A,@DPTR
B2:00C097 543F              ANL      A,#03FH
B2:00C099 FF                MOV      R7,A
B2:00C09A 90414E            MOV      DPTR,#freeSlot
B2:00C09D E0                MOVX     A,@DPTR
B2:00C09E FE                MOV      R6,A
B2:00C09F 11DE              ACALL    ?L?COM008A
B2:00C0A1 E0                MOVX     A,@DPTR
B2:00C0A2 54C0              ANL      A,#0C0H
B2:00C0A4 4F                ORL      A,R7
B2:00C0A5 F0                MOVX     @DPTR,A
  137:     myTask.myTaskPool[freeSlot].active = TRUE;
B2:00C0A6 11DD              ACALL    ?L?COM0089
B2:00C0A8 E0                MOVX     A,@DPTR
B2:00C0A9 4440              ORL      A,#040H
B2:00C0AB F0                MOVX     @DPTR,A
  138:     myTask.myTaskPool[freeSlot].CBPolltask = CBPolltask;
B2:00C0AC AF05              MOV      R7,AR5
B2:00C0AE 90414E            MOV      DPTR,#freeSlot
B2:00C0B1 E0                MOVX     A,@DPTR
B2:00C0B2 FD                MOV      R5,A
B2:00C0B3 313D              ACALL    ?L?COM021E
B2:00C0B5 F583              MOV      DPH,A
B2:00C0B7 EC                MOV      A,R4
B2:00C0B8 F0                MOVX     @DPTR,A
B2:00C0B9 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 736


B2:00C0BA EF                MOV      A,R7
B2:00C0BB 51A9              ACALL    ?L?COM05F5
B2:00C0BD ED                MOV      A,R5
B2:00C0BE 3149              ACALL    ?L?COM0269
  139:     myTask.myTaskPool[freeSlot].pTaskName = pTaskName;
  140:     myTask.poolJobStatus = TRUE; /*Force pool check*/
B2:00C0C0 5111              ACALL    ?L?COM0531
  141:     myTask.nextSlot = freeSlot;
B2:00C0C2 A3                INC      DPTR
B2:00C0C3 ED                MOV      A,R5
B2:00C0C4 F0                MOVX     @DPTR,A
  142:     if(freeSlot >= myTask.usedSlots)
B2:00C0C5 A3                INC      DPTR
B2:00C0C6 E0                MOVX     A,@DPTR
B2:00C0C7 FF                MOV      R7,A
B2:00C0C8 ED                MOV      A,R5
B2:00C0C9 C3                CLR      C
B2:00C0CA 9F                SUBB     A,R7
B2:00C0CB 400A              JC       ?C0009?ZW_TASK
  143:     {
  144:       myTask.usedSlots = freeSlot + 1;
B2:00C0CD ED                MOV      A,R5
B2:00C0CE 04                INC      A
B2:00C0CF F0                MOVX     @DPTR,A
  145:     }
  146:   }
B2:00C0D0 8005              SJMP     ?C0009?ZW_TASK
B2:00C0D2         ?C0007?ZW_TASK:
  147:   else{
  148:     nextId = 0;
B2:00C0D2 E4                CLR      A
B2:00C0D3 90414F            MOV      DPTR,#nextId
B2:00C0D6 F0                MOVX     @DPTR,A
  149:   }
B2:00C0D7         ?C0009?ZW_TASK:
  150:   return nextId;
B2:00C0D7 90414F            MOV      DPTR,#nextId
B2:00C0DA E0                MOVX     A,@DPTR
B2:00C0DB FF                MOV      R7,A
  151: }
B2:00C0DC 22                RET      
----- FUNCTION _TaskAdd (END) -------


----- FUNCTION ?L?COM0089 (BEGIN) -----
B2:00C0DD EE                MOV      A,R6
B2:00C0DE         ?L?COM008A:
B2:00C0DE 75F006            MOV      B,#06H
B2:00C0E1 A4                MUL      AB
B2:00C0E2 2493              ADD      A,#LOW myTask+04H
B2:00C0E4 F582              MOV      DPL,A
B2:00C0E6 E4                CLR      A
B2:00C0E7 3437              ADDC     A,#HIGH myTask+04H
B2:00C0E9 F583              MOV      DPH,A
B2:00C0EB 22                RET      
----- FUNCTION ?L?COM0089 (END) -------


----- FUNCTION _TaskRemove (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
  209: BOOL TaskRemove(uint8_t taskhandeId)
  210: {
;---- Variable 'taskhandeId' assigned to Register 'R7' ----
  211:   uint8_t i = 0;
  212:   BOOL status = FALSE;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 737


;---- Variable 'i' assigned to Register 'R6' ----
B2:00C0EC E4                CLR      A
B2:00C0ED FE                MOV      R6,A
  213: 
B2:00C0EE C248              CLR      status
  214:   for(i = 0; i < myTask.usedSlots; i++)
B2:00C0F0         ?C0021?ZW_TASK:
B2:00C0F0 12C919            LCALL    ?L?COM0428
B2:00C0F3 5045              JNC      ?C0022?ZW_TASK
  215:   {
  216:     /* find Id*/
  217:     if( taskhandeId == myTask.myTaskPool[i].id)
B2:00C0F5 11DD              ACALL    ?L?COM0089
B2:00C0F7 E0                MOVX     A,@DPTR
B2:00C0F8 FD                MOV      R5,A
B2:00C0F9 543F              ANL      A,#03FH
B2:00C0FB 6F                XRL      A,R7
B2:00C0FC 7039              JNZ      ?C0023?ZW_TASK
  218:     {
  219:       myTask.myTaskPool[i].id = 0;
B2:00C0FE 11DD              ACALL    ?L?COM0089
B2:00C100 ED                MOV      A,R5
B2:00C101 54C0              ANL      A,#0C0H
B2:00C103 F0                MOVX     @DPTR,A
  220:       myTask.myTaskPool[i].active = FALSE;
B2:00C104 11DD              ACALL    ?L?COM0089
B2:00C106 E0                MOVX     A,@DPTR
B2:00C107 54BF              ANL      A,#0BFH
B2:00C109 F0                MOVX     @DPTR,A
  221:       myTask.myTaskPool[i].CBPolltask = NULL;
B2:00C10A EE                MOV      A,R6
B2:00C10B 313D              ACALL    ?L?COM021E
B2:00C10D F583              MOV      DPH,A
B2:00C10F E4                CLR      A
B2:00C110 12735F            LCALL    ?L?COM0532
B2:00C113 EE                MOV      A,R6
B2:00C114 3149              ACALL    ?L?COM0269
  222: 	    myTask.myTaskPool[i].pTaskName = NULL;
  223:       myTask.nextSlot = 0;
B2:00C116 E4                CLR      A
B2:00C117 903791            MOV      DPTR,#myTask+02H
B2:00C11A F0                MOVX     @DPTR,A
  224:       status = TRUE;
B2:00C11B D248              SETB     status
B2:00C11D         ?C0025?ZW_TASK:
  225: 
  226:       /* Count usedSlots down if it is last task in pool.*/
  227:       while((0 == myTask.myTaskPool[i].id) && ((i + 1) ==  myTask.usedSlots))
B2:00C11D 11DD              ACALL    ?L?COM0089
B2:00C11F E0                MOVX     A,@DPTR
B2:00C120 543F              ANL      A,#03FH
B2:00C122 7013              JNZ      ?C0023?ZW_TASK
B2:00C124 EE                MOV      A,R6
B2:00C125 04                INC      A
B2:00C126 FD                MOV      R5,A
B2:00C127 903792            MOV      DPTR,#myTask+03H
B2:00C12A E0                MOVX     A,@DPTR
B2:00C12B B50509            CJNE     A,AR5,?C0023?ZW_TASK
  228:       {
  229:         myTask.usedSlots--;
B2:00C12E E0                MOVX     A,@DPTR
B2:00C12F 14                DEC      A
B2:00C130 F0                MOVX     @DPTR,A
  230:         if(0 != i)
B2:00C131 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 738


B2:00C132 6003              JZ       ?C0023?ZW_TASK
  231:         {
  232:           /* check prev slot*/
  233:           --i;
B2:00C134 1E                DEC      R6
  234:         }
B2:00C135 80E6              SJMP     ?C0025?ZW_TASK
  235:         else
  236:         {
  237:           /*pool empty*/
  238:           break;
  239:         }
  240:       }
  241:     }
  242:   }
B2:00C137         ?C0023?ZW_TASK:
B2:00C137 0E                INC      R6
B2:00C138 80B6              SJMP     ?C0021?ZW_TASK
B2:00C13A         ?C0022?ZW_TASK:
  243:   return status;
B2:00C13A A248              MOV      C,status
  244: }
B2:00C13C 22                RET      
----- FUNCTION _TaskRemove (END) -------


----- FUNCTION ?L?COM021E (BEGIN) -----
B2:00C13D 75F006            MOV      B,#06H
B2:00C140 A4                MUL      AB
B2:00C141 2494              ADD      A,#LOW myTask+05H
B2:00C143 F582              MOV      DPL,A
B2:00C145 E4                CLR      A
B2:00C146 3437              ADDC     A,#HIGH myTask+05H
B2:00C148 22                RET      
----- FUNCTION ?L?COM021E (END) -------


----- FUNCTION ?L?COM0269 (BEGIN) -----
B2:00C149 75F006            MOV      B,#06H
B2:00C14C A4                MUL      AB
B2:00C14D 2496              ADD      A,#LOW myTask+07H
B2:00C14F F582              MOV      DPL,A
B2:00C151 E4                CLR      A
B2:00C152 3437              ADDC     A,#HIGH myTask+07H
B2:00C154 F583              MOV      DPH,A
B2:00C156 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0269 (END) -------


----- FUNCTION _ZW_strlen (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_STRING.C'
   41: ZW_strlen(BYTE* str)
   42: {
B2:00C159 904138            MOV      DPTR,#str
B2:00C15C 1225A9            LCALL    ?C?PSTXDATA
   43: 	BYTE *s;
   44: 	for (s = str; *s; ++s)
B2:00C15F 90413B            MOV      DPTR,#s
B2:00C162 1225A9            LCALL    ?C?PSTXDATA
B2:00C165         ?C0001?ZW_STRING:
B2:00C165 90413B            MOV      DPTR,#s
B2:00C168 12AE26            LCALL    ?L?COM0049
B2:00C16B 6008              JZ       ?C0002?ZW_STRING
   45: 	{
   46: 	  ;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 739


   47: 	}
B2:00C16D 90413C            MOV      DPTR,#s+01H
B2:00C170 123F7F            LCALL    ?L?COM0081
B2:00C173 80F0              SJMP     ?C0001?ZW_STRING
B2:00C175         ?C0002?ZW_STRING:
   48: 	return(s - str);
B2:00C175 904138            MOV      DPTR,#str
B2:00C178 122589            LCALL    ?C?PLDXDATA
B2:00C17B AF01              MOV      R7,AR1
B2:00C17D 90413B            MOV      DPTR,#s
B2:00C180 122589            LCALL    ?C?PLDXDATA
B2:00C183 C3                CLR      C
B2:00C184 E9                MOV      A,R1
B2:00C185 9F                SUBB     A,R7
B2:00C186 FF                MOV      R7,A
   49: }
B2:00C187 22                RET      
----- FUNCTION _ZW_strlen (END) -------


----- FUNCTION TaskApplicationPoll (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
  264: BOOL TaskApplicationPoll(void)
  265: {
  266:   uint8_t i = 0;
  267: 
B2:00C188 E4                CLR      A
B2:00C189 9043AB            MOV      DPTR,#i
B2:00C18C F0                MOVX     @DPTR,A
  268:   /* Clear Interrupt flag because we check the pool*/
  269:   myTask.intpSignal = FALSE;
B2:00C18D 90378F            MOV      DPTR,#myTask
B2:00C190 F0                MOVX     @DPTR,A
  270: 
  271:   /* Only initiate poolJobStatus to FALSE if nextId = 0. we
  272:      want to check the whole pool*/
  273:   if(0 == myTask.nextSlot)
B2:00C191 903791            MOV      DPTR,#myTask+02H
B2:00C194 E0                MOVX     A,@DPTR
B2:00C195 903790            MOV      DPTR,#myTask+01H
B2:00C198 7003              JNZ      ?C0031?ZW_TASK
  274:   {
  275:     myTask.poolJobStatus = FALSE;
B2:00C19A F0                MOVX     @DPTR,A
  276:   }
B2:00C19B 8003              SJMP     ?C0032?ZW_TASK
B2:00C19D         ?C0031?ZW_TASK:
  277:   else{
  278:     myTask.poolJobStatus = TRUE;
B2:00C19D 7401              MOV      A,#01H
B2:00C19F F0                MOVX     @DPTR,A
  279:   }
B2:00C1A0         ?C0032?ZW_TASK:
  280: 
  281:   for(i = myTask.nextSlot; i < myTask.usedSlots; i++)
B2:00C1A0 903791            MOV      DPTR,#myTask+02H
B2:00C1A3 E0                MOVX     A,@DPTR
B2:00C1A4 9043AB            MOV      DPTR,#i
B2:00C1A7 F0                MOVX     @DPTR,A
B2:00C1A8         ?C0033?ZW_TASK:
B2:00C1A8 903792            MOV      DPTR,#myTask+03H
B2:00C1AB E0                MOVX     A,@DPTR
B2:00C1AC FF                MOV      R7,A
B2:00C1AD 9043AB            MOV      DPTR,#i
B2:00C1B0 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 740


B2:00C1B1 FE                MOV      R6,A
B2:00C1B2 C3                CLR      C
B2:00C1B3 9F                SUBB     A,R7
B2:00C1B4 5047              JNC      ?C0034?ZW_TASK
  282:   {
  283:     /* check job*/
  284:     if((0 != myTask.myTaskPool[i].id) &&
B2:00C1B6 11DD              ACALL    ?L?COM0089
B2:00C1B8 E0                MOVX     A,@DPTR
B2:00C1B9 FF                MOV      R7,A
B2:00C1BA 543F              ANL      A,#03FH
B2:00C1BC 6037              JZ       ?C0035?ZW_TASK
B2:00C1BE EF                MOV      A,R7
B2:00C1BF C4                SWAP     A
B2:00C1C0 13                RRC      A
B2:00C1C1 13                RRC      A
B2:00C1C2 5403              ANL      A,#03H
B2:00C1C4 30E02E            JNB      ACC.0,?C0035?ZW_TASK
B2:00C1C7 9043AB            MOV      DPTR,#i
B2:00C1CA E0                MOVX     A,@DPTR
B2:00C1CB FF                MOV      R7,A
B2:00C1CC 313D              ACALL    ?L?COM021E
B2:00C1CE F583              MOV      DPH,A
B2:00C1D0 E0                MOVX     A,@DPTR
B2:00C1D1 FC                MOV      R4,A
B2:00C1D2 A3                INC      DPTR
B2:00C1D3 E0                MOVX     A,@DPTR
B2:00C1D4 4C                ORL      A,R4
B2:00C1D5 601E              JZ       ?C0035?ZW_TASK
  285:        (TRUE == myTask.myTaskPool[i].active) &&
  286:        (NULL != myTask.myTaskPool[i].CBPolltask)
  287:       )
  288:     {
  289:       /*Call task*/
  290:       if(TRUE == myTask.myTaskPool[i].CBPolltask())
B2:00C1D7 EF                MOV      A,R7
B2:00C1D8 313D              ACALL    ?L?COM021E
B2:00C1DA 124699            LCALL    ?L?COM0226
B2:00C1DD AA06              MOV      R2,AR6
B2:00C1DF F9                MOV      R1,A
B2:00C1E0 122716            LCALL    ?C?ICALL
B2:00C1E3 5010              JNC      ?C0035?ZW_TASK
  291:       {
  292:         /*Task was active*/
  293:         myTask.poolJobStatus = TRUE;
B2:00C1E5 5111              ACALL    ?L?COM0531
  294: 
  295:         if(TASK_POOL_SIZE <= ++myTask.nextSlot)
B2:00C1E7 A3                INC      DPTR
B2:00C1E8 E0                MOVX     A,@DPTR
B2:00C1E9 04                INC      A
B2:00C1EA FF                MOV      R7,A
B2:00C1EB F0                MOVX     @DPTR,A
B2:00C1EC 7405              MOV      A,#05H
B2:00C1EE 9F                SUBB     A,R7
B2:00C1EF 5011              JNC      ?C0046?ZW_TASK
  296:         {
  297:           myTask.nextSlot = 0;
B2:00C1F1 E4                CLR      A
B2:00C1F2 F0                MOVX     @DPTR,A
  298:         }
B2:00C1F3         ?C0038?ZW_TASK:
  299:         return TaskJobHasWork();
B2:00C1F3 800D              SJMP     ?C0046?ZW_TASK
  300:       }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 741


  301:       else{
  302:         /*No job.. check next*/
  303:       }
  304:     }
  305:   }
B2:00C1F5         ?C0035?ZW_TASK:
B2:00C1F5 9043AB            MOV      DPTR,#i
B2:00C1F8 E0                MOVX     A,@DPTR
B2:00C1F9 04                INC      A
B2:00C1FA F0                MOVX     @DPTR,A
B2:00C1FB 80AB              SJMP     ?C0033?ZW_TASK
B2:00C1FD         ?C0034?ZW_TASK:
  306:   myTask.nextSlot = 0;
B2:00C1FD E4                CLR      A
B2:00C1FE 903791            MOV      DPTR,#myTask+02H
B2:00C201 F0                MOVX     @DPTR,A
  307:   return TaskJobHasWork();
B2:00C202         
B2:;----                  JMP      TaskJobHasWork
  308: }
----- FUNCTION TaskApplicationPoll (END) -------


----- FUNCTION TaskJobHasWork (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
  317: BOOL TaskJobHasWork()
  318: {
  319:   return (myTask.intpSignal || myTask.poolJobStatus);
  320: }
B2:00C202 90378F            MOV      DPTR,#myTask
B2:00C205 E0                MOVX     A,@DPTR
B2:00C206 7004              JNZ      ?C0043?ZW_TASK
B2:00C208 A3                INC      DPTR
B2:00C209 E0                MOVX     A,@DPTR
B2:00C20A 6003              JZ       ?C0041?ZW_TASK
B2:00C20C         ?C0043?ZW_TASK:
B2:00C20C D3                SETB     C
B2:00C20D 8001              SJMP     ?C0042?ZW_TASK
B2:00C20F         ?C0041?ZW_TASK:
B2:00C20F C3                CLR      C
B2:00C210         ?C0042?ZW_TASK:
  320: 
B2:00C210 22                RET      
----- FUNCTION TaskJobHasWork (END) -------


----- FUNCTION ?L?COM0531 (BEGIN) -----
B2:00C211 903790            MOV      DPTR,#myTask+01H
B2:00C214 7401              MOV      A,#01H
B2:00C216 F0                MOVX     @DPTR,A
B2:00C217 22                RET      
----- FUNCTION ?L?COM0531 (END) -------


----- FUNCTION ?L?COM036E (BEGIN) -----
B2:00C218 903FEE            MOV      DPTR,#groupId
B2:00C21B E0                MOVX     A,@DPTR
B2:00C21C 14                DEC      A
B2:00C21D FF                MOV      R7,A
B2:00C21E 903FED            MOV      DPTR,#ep
B2:00C221 E0                MOVX     A,@DPTR
B2:00C222 FD                MOV      R5,A
B2:00C223 903994            MOV      DPTR,#indx
B2:00C226 E0                MOVX     A,@DPTR
B2:00C227 FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 742


----- FUNCTION _ReorderGroupAfterRemove (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  119: ReorderGroupAfterRemove(
  120:   BYTE groupIden,      /*the group index to reorder*/
B2:00C228 90430C            MOV      DPTR,#groupIden
B2:00C22B EF                MOV      A,R7
B2:00C22C F0                MOVX     @DPTR,A
B2:00C22D A3                INC      DPTR
B2:00C22E ED                MOV      A,R5
B2:00C22F F0                MOVX     @DPTR,A
;---- Variable 'emptyIndx' assigned to Register 'R3' ----
  121:   BYTE ep,             /* endpoint*/
  122:   BYTE emptyIndx)      /*the index of the empty field*/
  123: {
  124:   BYTE move;
  125: 
  126:   for(move = emptyIndx+1; move < MAX_ASSOCIATION_IN_GROUP; move++)
B2:00C230 EB                MOV      A,R3
B2:00C231 04                INC      A
B2:00C232 A3                INC      DPTR
B2:00C233 F0                MOVX     @DPTR,A
B2:00C234         ?C0001?ASSOCIATION_PLUS:
B2:00C234 90430E            MOV      DPTR,#move
B2:00C237 E0                MOVX     A,@DPTR
B2:00C238 C3                CLR      C
B2:00C239 9405              SUBB     A,#05H
B2:00C23B 505E              JNC      ?C0004?ASSOCIATION_PLUS
  127:   {
  128:     memcpy((BYTE*)&groups[ep][groupIden].subGrp[move-1], (BYTE*)&groups[ep][groupIden].subGrp[move], sizeof(MULTI
>> CHAN_NODE_ID));
B2:00C23D 90430D            MOV      DPTR,#ep
B2:00C240 E0                MOVX     A,@DPTR
B2:00C241 75F014            MOV      B,#014H
B2:00C244 A4                MUL      AB
B2:00C245 247B              ADD      A,#LOW groups-04H
B2:00C247 F9                MOV      R1,A
B2:00C248 7439              MOV      A,#HIGH groups-04H
B2:00C24A 519C              ACALL    ?L?COM03BA
B2:00C24C 1282DD            LCALL    ?L?COM0037
B2:00C24F FA                MOV      R2,A
B2:00C250 90430E            MOV      DPTR,#move
B2:00C253 1282D9            LCALL    ?L?COM0035
B2:00C256 FA                MOV      R2,A
B2:00C257 C002              PUSH     AR2
B2:00C259 C001              PUSH     AR1
B2:00C25B 51B0              ACALL    ?L?COM03A4
B2:00C25D F9                MOV      R1,A
B2:00C25E 7439              MOV      A,#HIGH groups
B2:00C260 35F0              ADDC     A,B
B2:00C262 FA                MOV      R2,A
B2:00C263 51A1              ACALL    ?L?COM03BB
B2:00C265 1282DD            LCALL    ?L?COM0037
B2:00C268 FA                MOV      R2,A
B2:00C269 90430E            MOV      DPTR,#move
B2:00C26C 1282D9            LCALL    ?L?COM0035
B2:00C26F 91EE              ACALL    ?L?COM0021
B2:00C271 D001              POP      AR1
B2:00C273 D002              POP      AR2
B2:00C275 7F04              MOV      R7,#04H
B2:00C277 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  129: 
  130:     memset((BYTE*)&groups[ep][groupIden].subGrp[move], 0, sizeof(MULTICHAN_NODE_ID));
B2:00C27A 51B0              ACALL    ?L?COM03A4
B2:00C27C F9                MOV      R1,A
B2:00C27D 7439              MOV      A,#HIGH groups
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 743


B2:00C27F 519C              ACALL    ?L?COM03BA
B2:00C281 1282DD            LCALL    ?L?COM0037
B2:00C284 FA                MOV      R2,A
B2:00C285 90430E            MOV      DPTR,#move
B2:00C288 1282D9            LCALL    ?L?COM0035
B2:00C28B FA                MOV      R2,A
B2:00C28C 7D04              MOV      R5,#04H
B2:00C28E E4                CLR      A
B2:00C28F FF                MOV      R7,A
B2:00C290 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
  131:   }
B2:00C293 90430E            MOV      DPTR,#move
B2:00C296 E0                MOVX     A,@DPTR
B2:00C297 04                INC      A
B2:00C298 F0                MOVX     @DPTR,A
B2:00C299 8099              SJMP     ?C0001?ASSOCIATION_PLUS
  132: }
B2:00C29B         ?C0004?ASSOCIATION_PLUS:
B2:00C29B 22                RET      
----- FUNCTION _ReorderGroupAfterRemove (END) -------


----- FUNCTION ?L?COM03BA (BEGIN) -----
B2:00C29C 35F0              ADDC     A,B
B2:00C29E FA                MOV      R2,A
B2:00C29F 7B01              MOV      R3,#01H
B2:00C2A1         ?L?COM03BB:
B2:00C2A1 90430C            MOV      DPTR,#groupIden
B2:00C2A4 E0                MOVX     A,@DPTR
B2:00C2A5 75F014            MOV      B,#014H
B2:00C2A8 22                RET      
----- FUNCTION ?L?COM03BA (END) -------


----- FUNCTION ?L?COM05F5 (BEGIN) -----
B2:00C2A9 F0                MOVX     @DPTR,A
B2:00C2AA 90414A            MOV      DPTR,#pTaskName
B2:00C2AD 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM05F5 (END) -------


----- FUNCTION ?L?COM03A4 (BEGIN) -----
B2:00C2B0 90430D            MOV      DPTR,#ep
B2:00C2B3         ?L?COM03A5:
B2:00C2B3 E0                MOVX     A,@DPTR
B2:00C2B4         ?L?COM03A6:
B2:00C2B4 75F014            MOV      B,#014H
B2:00C2B7 A4                MUL      AB
B2:00C2B8 247F              ADD      A,#LOW groups
B2:00C2BA 22                RET      
----- FUNCTION ?L?COM03A4 (END) -------


----- FUNCTION _handleAssociationGetnodeList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  135: handleAssociationGetnodeList(
  136:   BYTE groupIden,
B2:00C2BB 903FE4            MOV      DPTR,#groupIden
B2:00C2BE 124765            LCALL    ?L?COM0102
B2:00C2C1 1225A9            LCALL    ?C?PSTXDATA
  137:   BYTE ep,
  138:   MULTICHAN_NODE_ID** ppList,
  139:   BYTE* pListLen)
  140: {
  141:   BYTE indx;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 744


  142: 
  143:   if((NUMBER_OF_ENDPOINTS + 1) < ep )
B2:00C2C4 903FE5            MOV      DPTR,#ep
B2:00C2C7 E0                MOVX     A,@DPTR
B2:00C2C8 FD                MOV      R5,A
B2:00C2C9 7401              MOV      A,#01H
B2:00C2CB C3                CLR      C
B2:00C2CC 9D                SUBB     A,R5
B2:00C2CD 5003              JNC      ?C0005?ASSOCIATION_PLUS
  144:   {
  145:     return NODE_LIST_STATUS_ERR_ENDPOINT_OUT_OF_RANGE;
B2:00C2CF 7F06              MOV      R7,#06H
B2:00C2D1 22                RET      
  146:   }
B2:00C2D2         ?C0005?ASSOCIATION_PLUS:
  147:   /*Check group number*/
  148:   if(FALSE == handleCheckgroupIden(&groupIden, ep))
B2:00C2D2 7B01              MOV      R3,#01H
B2:00C2D4 7A3F              MOV      R2,#HIGH groupIden
B2:00C2D6 79E4              MOV      R1,#LOW groupIden
B2:00C2D8 7153              ACALL    _handleCheckgroupIden
B2:00C2DA 4003              JC       ?C0007?ASSOCIATION_PLUS
  149:   {
  150:     return NODE_LIST_STATUS_ERR_GROUP_NBR_NOT_LEGAL; /*not legal number*/
B2:00C2DC 7F07              MOV      R7,#07H
B2:00C2DE 22                RET      
  151:   }
B2:00C2DF         ?C0007?ASSOCIATION_PLUS:
  152:   AssGroupMappingLookUp(&ep, &groupIden);
B2:00C2DF 7A3F              MOV      R2,#HIGH groupIden
B2:00C2E1 79E4              MOV      R1,#LOW groupIden
B2:00C2E3 12D9F4            LCALL    ?L?COM038A
B2:00C2E6 7A3F              MOV      R2,#HIGH ep
B2:00C2E8 09                INC      R1
B2:00C2E9 B101              ACALL    _AssGroupMappingLookUp
  153: 
  154:   *ppList = &groups[ep][groupIden - 1].subGrp[0];
B2:00C2EB 903FE5            MOV      DPTR,#ep
B2:00C2EE 12D91B            LCALL    ?L?COM018A
B2:00C2F1 903FE4            MOV      DPTR,#groupIden
B2:00C2F4 E0                MOVX     A,@DPTR
B2:00C2F5 75F014            MOV      B,#014H
B2:00C2F8 1282DD            LCALL    ?L?COM0037
B2:00C2FB FA                MOV      R2,A
B2:00C2FC C003              PUSH     AR3
B2:00C2FE C002              PUSH     AR2
B2:00C300 C001              PUSH     AR1
B2:00C302 903FE6            MOV      DPTR,#ppList
B2:00C305 122589            LCALL    ?C?PLDXDATA
B2:00C308 1225DE            LCALL    ?C?PSTPTR
  155:   *pListLen = 0; // Assume zero associations unless finding some in the loop below.
B2:00C30B 903FE9            MOV      DPTR,#pListLen
B2:00C30E 127111            LCALL    ?L?COM0287
  156: 
  157:   for (indx = MAX_ASSOCIATION_IN_GROUP; indx > 0; indx--)
;---- Variable 'indx' assigned to Register 'R7' ----
B2:00C311 7F05              MOV      R7,#05H
B2:00C313         ?C0008?ASSOCIATION_PLUS:
  158:   {
  159:     if(0 < groups[ep][groupIden - 1].subGrp[indx - 1].node.nodeId)
B2:00C313 903FE5            MOV      DPTR,#ep
B2:00C316 E0                MOVX     A,@DPTR
B2:00C317 75F014            MOV      B,#014H
B2:00C31A A4                MUL      AB
B2:00C31B 2467              ADD      A,#LOW groups-018H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 745


B2:00C31D F582              MOV      DPL,A
B2:00C31F E4                CLR      A
B2:00C320 3439              ADDC     A,#HIGH groups-018H
B2:00C322 F583              MOV      DPH,A
B2:00C324 C083              PUSH     DPH
B2:00C326 C082              PUSH     DPL
B2:00C328 903FE4            MOV      DPTR,#groupIden
B2:00C32B E0                MOVX     A,@DPTR
B2:00C32C D082              POP      DPL
B2:00C32E D083              POP      DPH
B2:00C330 1285D7            LCALL    ?L?COM018E
B2:00C333 D136              ACALL    ?L?COM0324
B2:00C335 E0                MOVX     A,@DPTR
B2:00C336 FE                MOV      R6,A
B2:00C337 E4                CLR      A
B2:00C338 C3                CLR      C
B2:00C339 9E                SUBB     A,R6
B2:00C33A 5008              JNC      ?C0010?ASSOCIATION_PLUS
  160:     {
  161:       *pListLen = indx; /*number of nodes in list*/
B2:00C33C 903FE9            MOV      DPTR,#pListLen
B2:00C33F 123F95            LCALL    ?L?COM00C0
  162:       break;  /* break out of loop*/
B2:00C342 8002              SJMP     ?C0009?ASSOCIATION_PLUS
  163:     }
  164:   }
B2:00C344         ?C0010?ASSOCIATION_PLUS:
B2:00C344 DFCD              DJNZ     R7,?C0008?ASSOCIATION_PLUS
B2:00C346         ?C0009?ASSOCIATION_PLUS:
  165:   if(0 == *pListLen)
B2:00C346 903FE9            MOV      DPTR,#pListLen
B2:00C349 12AE26            LCALL    ?L?COM0049
B2:00C34C 7F00              MOV      R7,#00H
B2:00C34E 7002              JNZ      ?C0012?ASSOCIATION_PLUS
  166:   {
  167:     return NODE_LIST_STATUS_ASSOCIATION_LIST_EMPTY;
B2:00C350 7F02              MOV      R7,#02H
  168:   }
B2:00C352         ?C0012?ASSOCIATION_PLUS:
  169:   return NODE_LIST_STATUS_SUCCESS;
  170: }
B2:00C352 22                RET      
----- FUNCTION _handleAssociationGetnodeList (END) -------


----- FUNCTION _handleCheckgroupIden (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  179: handleCheckgroupIden(BYTE* pGroupIden, BYTE endpoint)
  180: {
B2:00C353 90430F            MOV      DPTR,#pGroupIden
B2:00C356 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'endpoint' assigned to Register 'R5' ----
  181:   if ((CC_AGI_groupCount_handler(endpoint) <= (*pGroupIden - 1)) || (0 == *pGroupIden))
  182:   {
B2:00C359 AF05              MOV      R7,AR5
B2:00C35B 12B59D            LCALL    _CC_AGI_groupCount_handler
B2:00C35E 90430F            MOV      DPTR,#pGroupIden
B2:00C361 12AE26            LCALL    ?L?COM0049
B2:00C364 FE                MOV      R6,A
B2:00C365 14                DEC      A
B2:00C366 FD                MOV      R5,A
B2:00C367 EF                MOV      A,R7
B2:00C368 D3                SETB     C
B2:00C369 9D                SUBB     A,R5
B2:00C36A 4003              JC       ?C0014?ASSOCIATION_PLUS
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 746


B2:00C36C EE                MOV      A,R6
B2:00C36D 7002              JNZ      ?C0013?ASSOCIATION_PLUS
B2:00C36F         ?C0014?ASSOCIATION_PLUS:
  183:     return FALSE; /*not legal number*/
  184:   }
B2:00C36F C3                CLR      C
B2:00C370 22                RET      
  185:   return TRUE;
B2:00C371         ?C0013?ASSOCIATION_PLUS:
  186: }
B2:00C371 D3                SETB     C
  187: 
B2:00C372 22                RET      
----- FUNCTION _handleCheckgroupIden (END) -------


----- FUNCTION _ReqNodeList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  282: TRANSMIT_OPTIONS_TYPE_EX * ReqNodeList(
  283:                                        AGI_PROFILE* pProfile,
B2:00C373 903C1F            MOV      DPTR,#pProfile
B2:00C376 1225A9            LCALL    ?C?PSTXDATA
  284:                                        CMD_CLASS_GRP* pCurrentCmdGrp,
  285:                                        uint8_t sourceEndpoint)
  286: {
  287:   static MULTICHAN_NODE_ID nodeListCombined[MAX_ASSOCIATION_IN_GROUP * 2]; /**< handle 2 node lists: lifeline + o
>> ne list more */
  288:   MULTICHAN_NODE_ID * pNodeList = &nodeListCombined[0];
B2:00C379 7B01              MOV      R3,#01H
B2:00C37B 7A32              MOV      R2,#HIGH nodeListCombined
B2:00C37D 7906              MOV      R1,#LOW nodeListCombined
B2:00C37F 903C26            MOV      DPTR,#pNodeList
B2:00C382 129568            LCALL    ?L?COM0295
B2:00C385 903C29            MOV      DPTR,#pAssociationData
B2:00C388 1225A9            LCALL    ?C?PSTXDATA
  289:   MULTICHAN_NODE_ID * pAssociationData = NULL;
  290:   uint8_t associationLength;
  291:   uint8_t grpId = 0;
B2:00C38B E4                CLR      A
B2:00C38C 903C2D            MOV      DPTR,#grpId
B2:00C38F F0                MOVX     @DPTR,A
  292:   static TRANSMIT_OPTIONS_TYPE_EX reqTxOpt;
  293:   reqTxOpt.sourceEndpoint = sourceEndpoint;
B2:00C390 903C25            MOV      DPTR,#sourceEndpoint
B2:00C393 E0                MOVX     A,@DPTR
B2:00C394 FF                MOV      R7,A
B2:00C395 903230            MOV      DPTR,#reqTxOpt+02H
B2:00C398 F0                MOVX     @DPTR,A
  294:   reqTxOpt.txOptions = ZWAVE_PLUS_TX_OPTIONS;
B2:00C399 90322F            MOV      DPTR,#reqTxOpt+01H
B2:00C39C 7425              MOV      A,#025H
B2:00C39E F0                MOVX     @DPTR,A
  295:   reqTxOpt.pList = &nodeListCombined[0];
B2:00C39F 0B                INC      R3
B2:00C3A0 7A32              MOV      R2,#HIGH nodeListCombined
B2:00C3A2 7906              MOV      R1,#LOW nodeListCombined
B2:00C3A4 903231            MOV      DPTR,#reqTxOpt+03H
B2:00C3A7 1225A9            LCALL    ?C?PSTXDATA
  296:   reqTxOpt.list_length = 0;
B2:00C3AA E4                CLR      A
B2:00C3AB 903234            MOV      DPTR,#reqTxOpt+06H
B2:00C3AE F0                MOVX     @DPTR,A
  297: 
  298:   if (NUMBER_OF_ENDPOINTS < sourceEndpoint)
B2:00C3AF C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 747


B2:00C3B0 9F                SUBB     A,R7
B2:00C3B1 5003              JNC      ?C0043?AGI
  299:   {
  300:     return NULL; /** Error!!*/
B2:00C3B3 1B                DEC      R3
B2:00C3B4 8182              AJMP     ?C0058?AGI
  301:   }
B2:00C3B6         ?C0043?AGI:
  302: 
  303:   // Try to find the command class and command pair in the Lifeline AGI
  304:   if (TRUE == SearchCmdClass(*pCurrentCmdGrp,
B2:00C3B6 7844              MOV      R0,#LOW ?SearchCmdClass?BYTE
B2:00C3B8 7C41              MOV      R4,#HIGH ?SearchCmdClass?BYTE
B2:00C3BA 919D              ACALL    ?L?COM0595
B2:00C3BC 918B              ACALL    ?L?COM0167
B2:00C3BE 903C25            MOV      DPTR,#sourceEndpoint
B2:00C3C1 D126              ACALL    ?L?COM02CB
B2:00C3C3 122589            LCALL    ?C?PLDXDATA
B2:00C3C6 904146            MOV      DPTR,#?SearchCmdClass?BYTE+02H
B2:00C3C9 D13D              ACALL    ?L?COM0201
B2:00C3CB E0                MOVX     A,@DPTR
B2:00C3CC 904149            MOV      DPTR,#?SearchCmdClass?BYTE+05H
B2:00C3CF F0                MOVX     @DPTR,A
B2:00C3D0 12C816            LCALL    SearchCmdClass
B2:00C3D3 502B              JNC      ?C0045?AGI
  305:                              myAgi.lifeLineEndpoint[sourceEndpoint].pCmdGrpList,
  306:                              myAgi.lifeLineEndpoint[sourceEndpoint].listSize))
  307:   {
  308:     // If we found the pair, get a pointer to the association data and a length.
  309: 
  310:     // Lifeline is group 1 and endpoints have no lifeline. Hence, always fetch from endpoint 0.
  311:     associationLength = 0;
B2:00C3D5 E4                CLR      A
B2:00C3D6 903C2C            MOV      DPTR,#associationLength
B2:00C3D9 F0                MOVX     @DPTR,A
  312:     handleAssociationGetnodeList(1, 0, &pAssociationData, &associationLength);
B2:00C3DA B18E              ACALL    ?L?COM03C5
B2:00C3DC E4                CLR      A
B2:00C3DD FD                MOV      R5,A
B2:00C3DE 7F01              MOV      R7,#01H
B2:00C3E0 9192              ACALL    ?L?COM049E
B2:00C3E2 501C              JNC      ?C0045?AGI
  313:     if (0 < associationLength) {
  314:       // More than one association. Copy to the combined list.
  315:       memcpy((uint8_t *)pNodeList, (uint8_t *)pAssociationData, associationLength * sizeof(MULTICHAN_NODE_ID));
B2:00C3E4 91F5              ACALL    ?L?COM045D
B2:00C3E6 91EF              ACALL    ?L?COM0022
B2:00C3E8 D111              ACALL    ?L?COM0354
  316: 
  317:       // Update the TX options
  318:       reqTxOpt.list_length += associationLength;
  319: 
  320:       // Update the combined list pointer
  321:       pNodeList += associationLength; // Increase by <associationLength> x items
B2:00C3EA EF                MOV      A,R7
B2:00C3EB 75F004            MOV      B,#04H
B2:00C3EE A4                MUL      AB
B2:00C3EF FF                MOV      R7,A
B2:00C3F0 903C27            MOV      DPTR,#pNodeList+01H
B2:00C3F3 E5F0              MOV      A,B
B2:00C3F5 8FF0              MOV      B,R7
B2:00C3F7 122143            LCALL    ?C?IILDX
  322: 
  323:       m_lastActiveGroupId = 1;
B2:00C3FA 903235            MOV      DPTR,#m_lastActiveGroupId
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 748


B2:00C3FD 7401              MOV      A,#01H
B2:00C3FF F0                MOVX     @DPTR,A
  324:     }
  325:   }
B2:00C400         ?C0045?AGI:
  326: 
  327:   grpId = SearchProfile(*pProfile, *pCurrentCmdGrp, &myAgi.tableEndpoint[sourceEndpoint]);
B2:00C400 7898              MOV      R0,#LOW ?SearchProfile?BYTE
B2:00C402 7C40              MOV      R4,#HIGH ?SearchProfile?BYTE
B2:00C404 7D01              MOV      R5,#01H
B2:00C406 903C1F            MOV      DPTR,#pProfile
B2:00C409 122589            LCALL    ?C?PLDXDATA
B2:00C40C 918B              ACALL    ?L?COM0167
B2:00C40E 789A              MOV      R0,#LOW ?SearchProfile?BYTE+02H
B2:00C410 7C40              MOV      R4,#HIGH ?SearchProfile?BYTE+02H
B2:00C412 919D              ACALL    ?L?COM0595
B2:00C414 918B              ACALL    ?L?COM0167
B2:00C416 903C25            MOV      DPTR,#sourceEndpoint
B2:00C419 E0                MOVX     A,@DPTR
B2:00C41A 75F004            MOV      B,#04H
B2:00C41D A4                MUL      AB
B2:00C41E 2465              ADD      A,#LOW myAgi+02EH
B2:00C420 F9                MOV      R1,A
B2:00C421 7432              MOV      A,#HIGH myAgi+02EH
B2:00C423 35F0              ADDC     A,B
B2:00C425 FA                MOV      R2,A
B2:00C426 7B01              MOV      R3,#01H
B2:00C428 90409C            MOV      DPTR,#?SearchProfile?BYTE+04H
B2:00C42B 1225A9            LCALL    ?C?PSTXDATA
B2:00C42E 12C846            LCALL    SearchProfile
B2:00C431 903C2D            MOV      DPTR,#grpId
B2:00C434 EF                MOV      A,R7
B2:00C435 F0                MOVX     @DPTR,A
  328: 
  329:   if (0xFF != grpId)
B2:00C436 F4                CPL      A
B2:00C437 6025              JZ       ?C0047?AGI
  330:   {
  331:     // Found the group that matches profile and the command class/command pair.
  332: 
  333:     // Fetch associations from that group. Re-use pAssociationData & associationLength.
  334:     associationLength = 0;
B2:00C439 E4                CLR      A
B2:00C43A 903C2C            MOV      DPTR,#associationLength
B2:00C43D F0                MOVX     @DPTR,A
  335:     handleAssociationGetnodeList(grpId + 2,
B2:00C43E A3                INC      DPTR
B2:00C43F E0                MOVX     A,@DPTR
B2:00C440 2402              ADD      A,#02H
B2:00C442 FF                MOV      R7,A
B2:00C443 903C25            MOV      DPTR,#sourceEndpoint
B2:00C446 E0                MOVX     A,@DPTR
B2:00C447 FD                MOV      R5,A
B2:00C448 B18E              ACALL    ?L?COM03C5
B2:00C44A 9192              ACALL    ?L?COM049E
B2:00C44C 5010              JNC      ?C0047?AGI
  336:                                  sourceEndpoint,
  337:                                  &pAssociationData,
  338:                                  &associationLength);
  339:     if (0 < associationLength) {
  340:       // More than one association. Copy to the combined list.
  341:       memcpy((uint8_t *)pNodeList, (uint8_t *)pAssociationData, associationLength * sizeof(MULTICHAN_NODE_ID));
B2:00C44E 91F5              ACALL    ?L?COM045D
B2:00C450 91EF              ACALL    ?L?COM0022
B2:00C452 D111              ACALL    ?L?COM0354
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 749


  342: 
  343:       // Update the TX options
  344:       reqTxOpt.list_length += associationLength;
  345: 
  346:       m_lastActiveGroupId = grpId + 2;
B2:00C454 903C2D            MOV      DPTR,#grpId
B2:00C457 E0                MOVX     A,@DPTR
B2:00C458 2402              ADD      A,#02H
B2:00C45A 903235            MOV      DPTR,#m_lastActiveGroupId
B2:00C45D F0                MOVX     @DPTR,A
  347:     }
  348:   }
B2:00C45E         ?C0047?AGI:
  349: 
  350:   if (0 < reqTxOpt.list_length) {
B2:00C45E 903234            MOV      DPTR,#reqTxOpt+06H
B2:00C461 E0                MOVX     A,@DPTR
B2:00C462 FF                MOV      R7,A
B2:00C463 E4                CLR      A
B2:00C464 C3                CLR      C
B2:00C465 9F                SUBB     A,R7
B2:00C466 5018              JNC      ?C0049?AGI
  351:     reqTxOpt.S2_groupID = m_lastActiveGroupId + (sourceEndpoint << 4);
B2:00C468 903C25            MOV      DPTR,#sourceEndpoint
B2:00C46B E0                MOVX     A,@DPTR
B2:00C46C C4                SWAP     A
B2:00C46D 54F0              ANL      A,#0F0H
B2:00C46F FF                MOV      R7,A
B2:00C470 903235            MOV      DPTR,#m_lastActiveGroupId
B2:00C473 E0                MOVX     A,@DPTR
B2:00C474 2F                ADD      A,R7
B2:00C475 90322E            MOV      DPTR,#reqTxOpt
B2:00C478 F0                MOVX     @DPTR,A
  352:     return &reqTxOpt;
B2:00C479 7B01              MOV      R3,#01H
B2:00C47B 7A32              MOV      R2,#HIGH reqTxOpt
B2:00C47D 792E              MOV      R1,#LOW reqTxOpt
B2:00C47F 22                RET      
  353:   }
B2:00C480         ?C0049?AGI:
  354:   return NULL;
B2:00C480 7B00              MOV      R3,#00H
B2:00C482         
B2:00C482 7A00              MOV      R2,#00H
B2:00C484 7900              MOV      R1,#00H
  355: }
B2:00C486 22                RET      
----- FUNCTION _ReqNodeList (END) -------


----- FUNCTION ?L?COM0166 (BEGIN) -----
B2:00C487 7D01              MOV      R5,#01H
B2:00C489 7BFF              MOV      R3,#0FFH
B2:00C48B         ?L?COM0167:
B2:00C48B 7E00              MOV      R6,#00H
B2:00C48D 7F02              MOV      R7,#02H
B2:00C48F 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM0166 (END) -------


----- FUNCTION ?L?COM049E (BEGIN) -----
B2:00C492 51BB              ACALL    _handleAssociationGetnodeList
B2:00C494 903C2C            MOV      DPTR,#associationLength
B2:00C497 E0                MOVX     A,@DPTR
B2:00C498 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 750


B2:00C499 E4                CLR      A
B2:00C49A C3                CLR      C
B2:00C49B 9F                SUBB     A,R7
B2:00C49C 22                RET      
----- FUNCTION ?L?COM049E (END) -------


----- FUNCTION ?L?COM0595 (BEGIN) -----
B2:00C49D 7D01              MOV      R5,#01H
B2:00C49F 903C22            MOV      DPTR,#pCurrentCmdGrp
B2:00C4A2 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0595 (END) -------


----- FUNCTION ?L?COM0533 (BEGIN) -----
B2:00C4A5 FF                MOV      R7,A
B2:00C4A6 E0                MOVX     A,@DPTR
B2:00C4A7 FD                MOV      R5,A
----- FUNCTION _handleGetMaxNodesInGroup (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  189: handleGetMaxNodesInGroup(
  190:   BYTE groupIden,
;---- Variable 'ep' assigned to Register 'R5' ----
;---- Variable 'groupIden' assigned to Register 'R7' ----
  191:   BYTE ep)
  192: {
  193:   if ((1 == groupIden) && (0 != ep))
B2:00C4A8 EF                MOV      A,R7
B2:00C4A9 B40106            CJNE     A,#01H,?C0016?ASSOCIATION_PLUS
B2:00C4AC ED                MOV      A,R5
B2:00C4AD 6003              JZ       ?C0016?ASSOCIATION_PLUS
  194:   {
  195:     return 0;
B2:00C4AF 7F00              MOV      R7,#00H
B2:00C4B1 22                RET      
  196:   }
B2:00C4B2         ?C0016?ASSOCIATION_PLUS:
  197:   return MAX_ASSOCIATION_IN_GROUP;
B2:00C4B2 7F05              MOV      R7,#05H
  198: }
B2:00C4B4 22                RET      
----- FUNCTION _handleGetMaxNodesInGroup (END) -------


----- FUNCTION AssociationInitEndpointSupport (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  629: AssociationInitEndpointSupport(
  630:   BOOL forceClearMem,
  631:   ASSOCIATION_ROOT_GROUP_MAPPING* pMapping,
  632:   BYTE nbrGrp)
  633: {
  634:   pGroupMappingTable = pMapping;
B2:00C4B5 904267            MOV      DPTR,#pMapping
B2:00C4B8 122589            LCALL    ?C?PLDXDATA
B2:00C4BB 903995            MOV      DPTR,#pGroupMappingTable
B2:00C4BE 1225A9            LCALL    ?C?PSTXDATA
  635:   numberOfGroupMappingEntries = nbrGrp;
B2:00C4C1 90426A            MOV      DPTR,#nbrGrp
B2:00C4C4 E0                MOVX     A,@DPTR
B2:00C4C5 90397E            MOV      DPTR,#numberOfGroupMappingEntries
B2:00C4C8 F0                MOVX     @DPTR,A
  636:   AssociationInit(forceClearMem);
B2:00C4C9 A245              MOV      C,forceClearMem
B2:00C4CB 9244              MOV      ?AssociationInit?BIT,C
B2:00C4CD 02A103            LJMP     AssociationInit
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 751


----- FUNCTION AssociationInitEndpointSupport (END) -------


----- FUNCTION ?L?COM0020 (BEGIN) -----
B2:00C4D0 903ADA            MOV      DPTR,#pCmd
B2:00C4D3 122589            LCALL    ?C?PLDXDATA
B2:00C4D6 900002            MOV      DPTR,#02H
B2:00C4D9 121FF0            LCALL    ?C?CLDOPTR
B2:00C4DC 543F              ANL      A,#03FH
B2:00C4DE 903D9F            MOV      DPTR,#previously_receive_session_id
B2:00C4E1 F0                MOVX     @DPTR,A
B2:00C4E2 903AD7            MOV      DPTR,#rxOpt
B2:00C4E5 122589            LCALL    ?C?PLDXDATA
B2:00C4E8 E9                MOV      A,R1
B2:00C4E9 2404              ADD      A,#04H
B2:00C4EB F9                MOV      R1,A
B2:00C4EC E4                CLR      A
B2:00C4ED 3A                ADDC     A,R2
B2:00C4EE         ?L?COM0021:
B2:00C4EE FA                MOV      R2,A
B2:00C4EF         ?L?COM0022:
B2:00C4EF 90405D            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
B2:00C4F2 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0020 (END) -------


----- FUNCTION ?L?COM045D (BEGIN) -----
B2:00C4F5 EF                MOV      A,R7
B2:00C4F6 25E0              ADD      A,ACC
B2:00C4F8 25E0              ADD      A,ACC
B2:00C4FA FF                MOV      R7,A
B2:00C4FB 903C29            MOV      DPTR,#pAssociationData
B2:00C4FE 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM045D (END) -------


----- FUNCTION _AssGroupMappingLookUp (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ASSOCIATION_PLUS.C'
  646: AssGroupMappingLookUp(
  647:     BYTE* pEndpoint,
B2:00C501 904091            MOV      DPTR,#pEndpoint
B2:00C504 1225A9            LCALL    ?C?PSTXDATA
  648:     BYTE* pGroupID)
  649: {
  650:   if ((0 == *pEndpoint) && (1 != *pGroupID) && NON_NULL(pGroupMappingTable))
B2:00C507 904091            MOV      DPTR,#pEndpoint
B2:00C50A 12AE26            LCALL    ?L?COM0049
B2:00C50D 7070              JNZ      ?C0122?ASSOCIATION_PLUS
B2:00C50F 904094            MOV      DPTR,#pGroupID
B2:00C512 12AE26            LCALL    ?L?COM0049
B2:00C515 6401              XRL      A,#01H
B2:00C517 6066              JZ       ?C0122?ASSOCIATION_PLUS
B2:00C519 903995            MOV      DPTR,#pGroupMappingTable
B2:00C51C 122589            LCALL    ?C?PLDXDATA
B2:00C51F E9                MOV      A,R1
B2:00C520 4A                ORL      A,R2
B2:00C521 605C              JZ       ?C0122?ASSOCIATION_PLUS
  651:   {
  652:     /*Use Group mapping to get endpoint proupIden*/
  653:     BYTE i;
  654:     for (i = 0; i < numberOfGroupMappingEntries; i++)
B2:00C523 E4                CLR      A
B2:00C524 904097            MOV      DPTR,#i
B2:00C527 F0                MOVX     @DPTR,A
B2:00C528         ?C0123?ASSOCIATION_PLUS:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 752


B2:00C528 90397E            MOV      DPTR,#numberOfGroupMappingEntries
B2:00C52B E0                MOVX     A,@DPTR
B2:00C52C FF                MOV      R7,A
B2:00C52D 904097            MOV      DPTR,#i
B2:00C530 E0                MOVX     A,@DPTR
B2:00C531 FE                MOV      R6,A
B2:00C532 C3                CLR      C
B2:00C533 9F                SUBB     A,R7
B2:00C534 5049              JNC      ?C0122?ASSOCIATION_PLUS
  655:     {
  656:       if (*pGroupID == pGroupMappingTable[i].rootGrpId)
B2:00C536 903995            MOV      DPTR,#pGroupMappingTable
B2:00C539 122589            LCALL    ?C?PLDXDATA
B2:00C53C 75F003            MOV      B,#03H
B2:00C53F EE                MOV      A,R6
B2:00C540 1282DD            LCALL    ?L?COM0037
B2:00C543 FA                MOV      R2,A
B2:00C544 121FB3            LCALL    ?C?CLDPTR
B2:00C547 FF                MOV      R7,A
B2:00C548 904094            MOV      DPTR,#pGroupID
B2:00C54B 12AE26            LCALL    ?L?COM0049
B2:00C54E 6F                XRL      A,R7
B2:00C54F 7026              JNZ      ?C0125?ASSOCIATION_PLUS
  657:       {
  658:         *pEndpoint = pGroupMappingTable[i].endpoint;
B2:00C551 B181              ACALL    ?L?COM045E
B2:00C553 1282AD            LCALL    ?L?COM0086
B2:00C556 E9                MOV      A,R1
B2:00C557 2401              ADD      A,#01H
B2:00C559 125510            LCALL    ?L?COM000B
B2:00C55C FF                MOV      R7,A
B2:00C55D 904091            MOV      DPTR,#pEndpoint
B2:00C560 123F95            LCALL    ?L?COM00C0
  659:         *pGroupID = pGroupMappingTable[i].endpointGrpId;
B2:00C563 B181              ACALL    ?L?COM045E
B2:00C565 1282AD            LCALL    ?L?COM0086
B2:00C568 E9                MOV      A,R1
B2:00C569 2402              ADD      A,#02H
B2:00C56B 125510            LCALL    ?L?COM000B
B2:00C56E FF                MOV      R7,A
B2:00C56F 904094            MOV      DPTR,#pGroupID
B2:00C572 123F95            LCALL    ?L?COM00C0
  660:         return TRUE;
B2:00C575 D3                SETB     C
B2:00C576 22                RET      
  661:       }
  662:     }
B2:00C577         ?C0125?ASSOCIATION_PLUS:
B2:00C577 904097            MOV      DPTR,#i
B2:00C57A E0                MOVX     A,@DPTR
B2:00C57B 04                INC      A
B2:00C57C F0                MOVX     @DPTR,A
B2:00C57D 80A9              SJMP     ?C0123?ASSOCIATION_PLUS
  663:   }
B2:00C57F         ?C0122?ASSOCIATION_PLUS:
  664:   return FALSE;
B2:00C57F C3                CLR      C
  665: }
B2:00C580 22                RET      
----- FUNCTION _AssGroupMappingLookUp (END) -------


----- FUNCTION ?L?COM045E (BEGIN) -----
B2:00C581 904097            MOV      DPTR,#i
B2:00C584 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 753


B2:00C585 75F003            MOV      B,#03H
B2:00C588 A4                MUL      AB
B2:00C589 FF                MOV      R7,A
B2:00C58A 903995            MOV      DPTR,#pGroupMappingTable
B2:00C58D 22                RET      
----- FUNCTION ?L?COM045E (END) -------


----- FUNCTION ?L?COM03C5 (BEGIN) -----
B2:00C58E 7B01              MOV      R3,#01H
B2:00C590 7A3C              MOV      R2,#HIGH associationLength
B2:00C592 792C              MOV      R1,#LOW associationLength
B2:00C594 903FE9            MOV      DPTR,#?_handleAssociationGetnodeList?BYTE+05H
B2:00C597 1225A9            LCALL    ?C?PSTXDATA
B2:00C59A 7A3C              MOV      R2,#HIGH pAssociationData
B2:00C59C 7929              MOV      R1,#LOW pAssociationData
B2:00C59E 22                RET      
----- FUNCTION ?L?COM03C5 (END) -------


----- FUNCTION CC_AGI_Init (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
   79: CC_AGI_Init(void)
   80: {
   81:   const char lifelineText[] = "Lifeline";
   82: 
B2:00C59F 78CC              MOV      R0,#LOW lifelineText
B2:00C5A1 7C3E              MOV      R4,#HIGH lifelineText
B2:00C5A3 7A32              MOV      R2,#HIGH _?ix1000
B2:00C5A5 791F              MOV      R1,#LOW _?ix1000
B2:00C5A7 7E00              MOV      R6,#00H
B2:00C5A9 7F09              MOV      R7,#09H
B2:00C5AB F160              ACALL    ?L?COM03A0
   83:   m_lastActiveGroupId = 1;
B2:00C5AD 903235            MOV      DPTR,#m_lastActiveGroupId
B2:00C5B0 7401              MOV      A,#01H
B2:00C5B2 F0                MOVX     @DPTR,A
   84: 
   85:   memset((uint8_t *)&myAgi, 0x00, sizeof(myAgi));
B2:00C5B3 FB                MOV      R3,A
B2:00C5B4 7A32              MOV      R2,#HIGH myAgi
B2:00C5B6 7937              MOV      R1,#LOW myAgi
B2:00C5B8 7D32              MOV      R5,#032H
B2:00C5BA E4                CLR      A
B2:00C5BB FF                MOV      R7,A
B2:00C5BC 121B65            LCALL    ?INTERBANK_TABLE?___ZW_memset
   86:   for (i = NUMBER_OF_ENDPOINTS + 1; i > 0; i--)
B2:00C5BF 903236            MOV      DPTR,#i
B2:00C5C2 7401              MOV      A,#01H
B2:00C5C4 F0                MOVX     @DPTR,A
B2:00C5C5         ?C0001?AGI:
   87:   {
   88:     memcpy(
   89:            (uint8_t *)myAgi.lifeLineEndpoint[i - 1].grpName,
   90:            (uint8_t *)lifelineText,
   91:            ZW_strlen((uint8_t *)lifelineText));
B2:00C5C5 7B01              MOV      R3,#01H
B2:00C5C7 7A3E              MOV      R2,#HIGH lifelineText
B2:00C5C9 79CC              MOV      R1,#LOW lifelineText
B2:00C5CB 3159              ACALL    _ZW_strlen
B2:00C5CD AD07              MOV      R5,AR7
B2:00C5CF 12C922            LCALL    ?L?COM05F7
B2:00C5D2 A4                MUL      AB
B2:00C5D3 2409              ADD      A,#LOW myAgi-02EH
B2:00C5D5 F9                MOV      R1,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 754


B2:00C5D6 7432              MOV      A,#HIGH myAgi-02EH
B2:00C5D8 35F0              ADDC     A,B
B2:00C5DA FA                MOV      R2,A
B2:00C5DB 7B01              MOV      R3,#01H
B2:00C5DD C002              PUSH     AR2
B2:00C5DF C001              PUSH     AR1
B2:00C5E1 7A3E              MOV      R2,#HIGH lifelineText
B2:00C5E3 79CC              MOV      R1,#LOW lifelineText
B2:00C5E5 91EF              ACALL    ?L?COM0022
B2:00C5E7 AF05              MOV      R7,AR5
B2:00C5E9 D001              POP      AR1
B2:00C5EB D002              POP      AR2
B2:00C5ED 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
   92:   }
B2:00C5F0 903236            MOV      DPTR,#i
B2:00C5F3 E0                MOVX     A,@DPTR
B2:00C5F4 14                DEC      A
B2:00C5F5 F0                MOVX     @DPTR,A
B2:00C5F6 E0                MOVX     A,@DPTR
B2:00C5F7 D3                SETB     C
B2:00C5F8 9400              SUBB     A,#00H
B2:00C5FA 50C9              JNC      ?C0001?AGI
   93: }
B2:00C5FC 22                RET      
----- FUNCTION CC_AGI_Init (END) -------


----- FUNCTION _CC_AGI_LifeLineGroupSetup (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
   95: void CC_AGI_LifeLineGroupSetup(
   96:     cc_group_t const * const pCmdGrpList,
;---- Variable 'listSize' assigned to Register 'R5' ----
;---- Variable 'pCmdGrpList' assigned to Register 'R1/R2/R3' ----
   97:     uint8_t listSize,
   98:     uint8_t endpoint)
   99: {
  100:   if (NUMBER_OF_ENDPOINTS < endpoint)
B2:00C5FD 9041C6            MOV      DPTR,#endpoint
B2:00C600 E0                MOVX     A,@DPTR
B2:00C601 FF                MOV      R7,A
B2:00C602 E4                CLR      A
B2:00C603 C3                CLR      C
B2:00C604 9F                SUBB     A,R7
B2:00C605 4009              JC       ?C0006?AGI
  101:   {
  102:     return; // Invalid endpoint => return.
  103:   }
B2:00C607         ?C0005?AGI:
  104: 
  105:   myAgi.lifeLineEndpoint[endpoint].pCmdGrpList = (cc_group_t *)pCmdGrpList;
B2:00C607 9041C6            MOV      DPTR,#endpoint
B2:00C60A D126              ACALL    ?L?COM02CB
B2:00C60C D13D              ACALL    ?L?COM0201
B2:00C60E ED                MOV      A,R5
B2:00C60F F0                MOVX     @DPTR,A
  106:   myAgi.lifeLineEndpoint[endpoint].listSize = listSize;
  107: }
B2:00C610         ?C0006?AGI:
B2:00C610 22                RET      
----- FUNCTION _CC_AGI_LifeLineGroupSetup (END) -------


----- FUNCTION ?L?COM0354 (BEGIN) -----
B2:00C611 903C26            MOV      DPTR,#pNodeList
B2:00C614 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 755


B2:00C617 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B2:00C61A 903C2C            MOV      DPTR,#associationLength
B2:00C61D E0                MOVX     A,@DPTR
B2:00C61E FF                MOV      R7,A
B2:00C61F 903234            MOV      DPTR,#reqTxOpt+06H
B2:00C622 E0                MOVX     A,@DPTR
B2:00C623 2F                ADD      A,R7
B2:00C624 F0                MOVX     @DPTR,A
B2:00C625 22                RET      
----- FUNCTION ?L?COM0354 (END) -------


----- FUNCTION ?L?COM02CB (BEGIN) -----
B2:00C626 E0                MOVX     A,@DPTR
B2:00C627 FF                MOV      R7,A
B2:00C628         ?L?COM02CC:
B2:00C628 75F02E            MOV      B,#02EH
B2:00C62B A4                MUL      AB
B2:00C62C 2461              ADD      A,#LOW myAgi+02AH
B2:00C62E F582              MOV      DPL,A
B2:00C630 E4                CLR      A
B2:00C631 3432              ADDC     A,#HIGH myAgi+02AH
B2:00C633 F583              MOV      DPH,A
B2:00C635 22                RET      
----- FUNCTION ?L?COM02CB (END) -------


----- FUNCTION ?L?COM0324 (BEGIN) -----
B2:00C636 75F004            MOV      B,#04H
B2:00C639 EF                MOV      A,R7
B2:00C63A 02257D            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM0324 (END) -------


----- FUNCTION ?L?COM0201 (BEGIN) -----
B2:00C63D 1225A9            LCALL    ?C?PSTXDATA
B2:00C640 EF                MOV      A,R7
B2:00C641         ?L?COM0202:
B2:00C641 75F02E            MOV      B,#02EH
B2:00C644 A4                MUL      AB
B2:00C645 2464              ADD      A,#LOW myAgi+02DH
B2:00C647 F582              MOV      DPL,A
B2:00C649 E4                CLR      A
B2:00C64A 3432              ADDC     A,#HIGH myAgi+02DH
B2:00C64C F583              MOV      DPH,A
B2:00C64E 22                RET      
----- FUNCTION ?L?COM0201 (END) -------


----- FUNCTION _GetApplGroupCommandList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  195: void GetApplGroupCommandList(
  196:                              uint8_t * pGroupList,
B2:00C64F 9041D1            MOV      DPTR,#pGroupList
B2:00C652 1225A9            LCALL    ?C?PSTXDATA
B2:00C655 9041D4            MOV      DPTR,#groupId
B2:00C658 ED                MOV      A,R5
B2:00C659 F0                MOVX     @DPTR,A
  197:                              uint8_t groupId,
  198:                              uint8_t endpoint)
  199: {
  200:   if (NUMBER_OF_ENDPOINTS < endpoint)
B2:00C65A A3                INC      DPTR
B2:00C65B E0                MOVX     A,@DPTR
B2:00C65C FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 756


B2:00C65D E4                CLR      A
B2:00C65E C3                CLR      C
B2:00C65F 9E                SUBB     A,R6
B2:00C660 4045              JC       ?C0024?AGI
  201:   {
  202:     return; /** Error!!*/
  203:   }
B2:00C662         ?C0023?AGI:
  204: 
  205:   if (1 == groupId)
B2:00C662 9041D4            MOV      DPTR,#groupId
B2:00C665 E0                MOVX     A,@DPTR
B2:00C666 B40117            CJNE     A,#01H,?C0025?AGI
  206:   {
  207:     memcpy(pGroupList, (BYTE_P )myAgi.lifeLineEndpoint[endpoint].pCmdGrpList,
  208:            myAgi.lifeLineEndpoint[endpoint].listSize * sizeof(CMD_CLASS_GRP));
B2:00C669 EE                MOV      A,R6
B2:00C66A D141              ACALL    ?L?COM0202
B2:00C66C E0                MOVX     A,@DPTR
B2:00C66D 25E0              ADD      A,ACC
B2:00C66F FF                MOV      R7,A
B2:00C670 EE                MOV      A,R6
B2:00C671 D128              ACALL    ?L?COM02CC
B2:00C673 122589            LCALL    ?C?PLDXDATA
B2:00C676 91EF              ACALL    ?L?COM0022
B2:00C678 9041D1            MOV      DPTR,#pGroupList
B2:00C67B 122589            LCALL    ?C?PLDXDATA
  209:   }
B2:00C67E 8024              SJMP     ?C0057?AGI
B2:00C680         ?C0025?AGI:
  210:   else
  211:   {
  212:     memcpy(pGroupList, (BYTE_P )&myAgi.tableEndpoint[endpoint].pTable[groupId - 2].cmdGrp,
  213:            sizeof(CMD_CLASS_GRP));
B2:00C680 9041D5            MOV      DPTR,#endpoint
B2:00C683 F151              ACALL    ?L?COM01AD
B2:00C685 122589            LCALL    ?C?PLDXDATA
B2:00C688 9041D4            MOV      DPTR,#groupId
B2:00C68B E0                MOVX     A,@DPTR
B2:00C68C 75F02E            MOV      B,#02EH
B2:00C68F 1282DD            LCALL    ?L?COM0037
B2:00C692 FA                MOV      R2,A
B2:00C693 E9                MOV      A,R1
B2:00C694 24A6              ADD      A,#0A6H
B2:00C696 F9                MOV      R1,A
B2:00C697 EA                MOV      A,R2
B2:00C698 34FF              ADDC     A,#0FFH
B2:00C69A 91EE              ACALL    ?L?COM0021
B2:00C69C 9041D1            MOV      DPTR,#pGroupList
B2:00C69F 122589            LCALL    ?C?PLDXDATA
B2:00C6A2 7F02              MOV      R7,#02H
B2:00C6A4         
B2:00C6A4 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  214:   }
  215: }
B2:00C6A7         ?C0024?AGI:
B2:00C6A7 22                RET      
----- FUNCTION _GetApplGroupCommandList (END) -------


----- FUNCTION _CC_AGI_groupNameGet_handler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  124: CC_AGI_groupNameGet_handler(
  125:                  char * pGroupName,
B2:00C6A8 903A15            MOV      DPTR,#pGroupName
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 757


B2:00C6AB 1225A9            LCALL    ?C?PSTXDATA
B2:00C6AE 903A18            MOV      DPTR,#groupId
B2:00C6B1 ED                MOV      A,R5
B2:00C6B2 F0                MOVX     @DPTR,A
  126:                  uint8_t groupId,
  127:                  uint8_t endpoint)
  128: {
  129:   uint8_t nameLength = 0;
B2:00C6B3 E4                CLR      A
B2:00C6B4 903A1A            MOV      DPTR,#nameLength
B2:00C6B7 F0                MOVX     @DPTR,A
  130:   char * pSourceGroupName;
  131:   const char errorText[] = "Invalid group";
B2:00C6B8 781E              MOV      R0,#LOW errorText
B2:00C6BA 7C3A              MOV      R4,#HIGH errorText
B2:00C6BC 7A32              MOV      R2,#HIGH _?ix1001
B2:00C6BE 7928              MOV      R1,#LOW _?ix1001
B2:00C6C0 FE                MOV      R6,A
B2:00C6C1 7F0E              MOV      R7,#0EH
B2:00C6C3 F160              ACALL    ?L?COM03A0
  132: 
  133:   if ((IS_NULL(pGroupName)) || (NUMBER_OF_ENDPOINTS < endpoint))
B2:00C6C5 903A15            MOV      DPTR,#pGroupName
B2:00C6C8 122589            LCALL    ?C?PLDXDATA
B2:00C6CB E9                MOV      A,R1
B2:00C6CC 4A                ORL      A,R2
B2:00C6CD 6079              JZ       ?C0054?AGI
B2:00C6CF 903A19            MOV      DPTR,#endpoint
B2:00C6D2 E0                MOVX     A,@DPTR
B2:00C6D3 FE                MOV      R6,A
B2:00C6D4 E4                CLR      A
B2:00C6D5 C3                CLR      C
B2:00C6D6 9E                SUBB     A,R6
B2:00C6D7 5002              JNC      ?C0010?AGI
B2:00C6D9         ?C0011?AGI:
  134:   {
  135:     return nameLength;
B2:00C6D9 806D              SJMP     ?C0054?AGI
  136:   }
B2:00C6DB         ?C0010?AGI:
  137: 
  138:   // tableSize does not include Lifeline. Hence, +1.
  139:   if ((groupId > (myAgi.tableEndpoint[endpoint].tableSize + 1)) || (0 == groupId))
B2:00C6DB EE                MOV      A,R6
B2:00C6DC 12CBD9            LCALL    ?L?COM0220
B2:00C6DF E0                MOVX     A,@DPTR
B2:00C6E0 04                INC      A
B2:00C6E1 FF                MOV      R7,A
B2:00C6E2 903A18            MOV      DPTR,#groupId
B2:00C6E5 E0                MOVX     A,@DPTR
B2:00C6E6 FE                MOV      R6,A
B2:00C6E7 D3                SETB     C
B2:00C6E8 9F                SUBB     A,R7
B2:00C6E9 5003              JNC      ?C0014?AGI
B2:00C6EB EE                MOV      A,R6
B2:00C6EC 7008              JNZ      ?C0013?AGI
B2:00C6EE         ?C0014?AGI:
  140:   {
  141:     pSourceGroupName = (char *)errorText;
B2:00C6EE 7B01              MOV      R3,#01H
B2:00C6F0 7A3A              MOV      R2,#HIGH errorText
B2:00C6F2 791E              MOV      R1,#LOW errorText
  142:   }
B2:00C6F4 8030              SJMP     ?C0055?AGI
B2:00C6F6         ?C0013?AGI:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 758


  143:   else
  144:   {
  145:     if (1 == groupId)
B2:00C6F6 EE                MOV      A,R6
B2:00C6F7 903A19            MOV      DPTR,#endpoint
B2:00C6FA B40111            CJNE     A,#01H,?C0016?AGI
  146:     {
  147:       pSourceGroupName = myAgi.lifeLineEndpoint[endpoint].grpName;
B2:00C6FD E0                MOVX     A,@DPTR
B2:00C6FE 75F02E            MOV      B,#02EH
B2:00C701 A4                MUL      AB
B2:00C702 2437              ADD      A,#LOW myAgi
B2:00C704 F9                MOV      R1,A
B2:00C705 7432              MOV      A,#HIGH myAgi
B2:00C707 35F0              ADDC     A,B
B2:00C709 FA                MOV      R2,A
B2:00C70A 7B01              MOV      R3,#01H
  148:     }
B2:00C70C 8018              SJMP     ?C0053?AGI
B2:00C70E         ?C0016?AGI:
  149:     else
  150:     {
  151:       /*
  152:        * myAgi.tableEndpoint[endpoint].pTable represents all groups not being lifeline groups.
  153:        * Hence, the lowest possible group is 2 since lifeline is group 1.
  154:        * the first index in array = given group - 2.
  155:        */
  156:       pSourceGroupName = myAgi.tableEndpoint[endpoint].pTable[groupId - 2].groupName;
B2:00C70E F151              ACALL    ?L?COM01AD
B2:00C710 122589            LCALL    ?C?PLDXDATA
B2:00C713 903A18            MOV      DPTR,#groupId
B2:00C716 E0                MOVX     A,@DPTR
B2:00C717 75F02E            MOV      B,#02EH
B2:00C71A 1282DD            LCALL    ?L?COM0037
B2:00C71D FA                MOV      R2,A
B2:00C71E E9                MOV      A,R1
B2:00C71F 24A8              ADD      A,#0A8H
B2:00C721 F9                MOV      R1,A
B2:00C722 EA                MOV      A,R2
B2:00C723 34FF              ADDC     A,#0FFH
B2:00C725 FA                MOV      R2,A
B2:00C726         
B2:00C726         
B2:00C726 903A1B            MOV      DPTR,#pSourceGroupName
B2:00C729 1225A9            LCALL    ?C?PSTXDATA
  157:     }
  158:   }
B2:00C72C         ?C0015?AGI:
  159:   nameLength = ZW_strlen((uint8_t *)pSourceGroupName);
B2:00C72C 903A1B            MOV      DPTR,#pSourceGroupName
B2:00C72F 122589            LCALL    ?C?PLDXDATA
B2:00C732 3159              ACALL    _ZW_strlen
B2:00C734 903A1A            MOV      DPTR,#nameLength
B2:00C737 EF                MOV      A,R7
B2:00C738 F0                MOVX     @DPTR,A
  160:   memcpy(
  161:          (uint8_t * )pGroupName,
  162:          (uint8_t * )pSourceGroupName,
  163:          nameLength);
B2:00C739 A3                INC      DPTR
B2:00C73A 122589            LCALL    ?C?PLDXDATA
B2:00C73D 91EF              ACALL    ?L?COM0022
B2:00C73F 903A15            MOV      DPTR,#pGroupName
B2:00C742 122589            LCALL    ?C?PLDXDATA
B2:00C745 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 759


  164: 
  165:   return nameLength;
B2:00C748         
B2:00C748 903A1A            MOV      DPTR,#nameLength
B2:00C74B E0                MOVX     A,@DPTR
B2:00C74C FF                MOV      R7,A
  166: }
B2:00C74D 22                RET      
----- FUNCTION _CC_AGI_groupNameGet_handler (END) -------


----- FUNCTION ?L?COM01AC (BEGIN) -----
B2:00C74E 9041CD            MOV      DPTR,#endpoint
B2:00C751         ?L?COM01AD:
B2:00C751 E0                MOVX     A,@DPTR
B2:00C752         ?L?COM01AE:
B2:00C752 25E0              ADD      A,ACC
B2:00C754 25E0              ADD      A,ACC
B2:00C756 2465              ADD      A,#LOW myAgi+02EH
B2:00C758 F582              MOV      DPL,A
B2:00C75A E4                CLR      A
B2:00C75B 3432              ADDC     A,#HIGH myAgi+02EH
B2:00C75D F583              MOV      DPH,A
B2:00C75F 22                RET      
----- FUNCTION ?L?COM01AC (END) -------


----- FUNCTION ?L?COM03A0 (BEGIN) -----
B2:00C760 7D01              MOV      R5,#01H
B2:00C762 7BFF              MOV      R3,#0FFH
B2:00C764 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM03A0 (END) -------


----- FUNCTION _CC_AGI_ResourceGroupSetup (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  109: void CC_AGI_ResourceGroupSetup(AGI_GROUP const * const pTable, uint8_t tableSize, uint8_t endpoint)
  110: {
;---- Variable 'tableSize' assigned to Register 'R5' ----
;---- Variable 'pTable' assigned to Register 'R1/R2/R3' ----
  111:   if (IS_NULL(pTable))
  112:   {
B2:00C767 E9                MOV      A,R1
B2:00C768 4A                ORL      A,R2
B2:00C769 7001              JNZ      ?C0007?AGI
  113:     tableSize = 0;
  114:   }
B2:00C76B FD                MOV      R5,A
  115: 
B2:00C76C         ?C0007?AGI:
  116:   if (NUMBER_OF_ENDPOINTS >= endpoint)
B2:00C76C 9041CB            MOV      DPTR,#endpoint
B2:00C76F E0                MOVX     A,@DPTR
B2:00C770 FF                MOV      R7,A
B2:00C771 E4                CLR      A
B2:00C772 C3                CLR      C
B2:00C773 9F                SUBB     A,R7
B2:00C774 400B              JC       ?C0009?AGI
  117:   {
  118:     myAgi.tableEndpoint[endpoint].tableSize = tableSize;
B2:00C776 12CBD8            LCALL    ?L?COM021F
B2:00C779 ED                MOV      A,R5
B2:00C77A F0                MOVX     @DPTR,A
  119:     myAgi.tableEndpoint[endpoint].pTable = (AGI_GROUP *)pTable;
B2:00C77B EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 760


B2:00C77C F152              ACALL    ?L?COM01AE
B2:00C77E 1225A9            LCALL    ?C?PSTXDATA
  120:   }
  121: }
B2:00C781         ?C0009?AGI:
B2:00C781 22                RET      
----- FUNCTION _CC_AGI_ResourceGroupSetup (END) -------


----- FUNCTION _CC_AGI_groupInfoGet_handler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  177: void CC_AGI_groupInfoGet_handler(
  178:     uint8_t groupId,
B2:00C782 9041CC            MOV      DPTR,#groupId
B2:00C785 EF                MOV      A,R7
B2:00C786 F0                MOVX     @DPTR,A
B2:00C787 9041CE            MOV      DPTR,#report
B2:00C78A 1225A9            LCALL    ?C?PSTXDATA
B2:00C78D 9041CD            MOV      DPTR,#endpoint
B2:00C790 ED                MOV      A,R5
B2:00C791 F0                MOVX     @DPTR,A
B2:00C792 FF                MOV      R7,A
  179:     uint8_t endpoint,
  180:     VG_ASSOCIATION_GROUP_INFO_REPORT_VG* report)
  181: {
  182:   ZAF_CC_AGI_CorrectGroupIdIfInvalid(endpoint, &groupId);
B2:00C793 7B01              MOV      R3,#01H
B2:00C795 7A41              MOV      R2,#HIGH groupId
B2:00C797 79CC              MOV      R1,#LOW groupId
B2:00C799 12C8BE            LCALL    _ZAF_CC_AGI_CorrectGroupIdIfInvalid
  183: 
  184:   report->groupingIdentifier = groupId;
B2:00C79C 9041CC            MOV      DPTR,#groupId
B2:00C79F E0                MOVX     A,@DPTR
B2:00C7A0 FF                MOV      R7,A
B2:00C7A1 9041CE            MOV      DPTR,#report
B2:00C7A4 123F95            LCALL    ?L?COM00C0
  185: 
  186:   if (1 == groupId) {
B2:00C7A7 9041CC            MOV      DPTR,#groupId
B2:00C7AA E0                MOVX     A,@DPTR
B2:00C7AB B40110            CJNE     A,#01H,?C0020?AGI
  187:     report->profile1 = ASSOCIATION_GROUP_INFO_REPORT_PROFILE_GENERAL; /* MSB */
B2:00C7AE 9041CE            MOV      DPTR,#report
B2:00C7B1 122589            LCALL    ?C?PLDXDATA
B2:00C7B4 12C9B3            LCALL    ?L?COM025B
  188:     report->profile2 = ASSOCIATION_GROUP_INFO_REPORT_PROFILE_GENERAL_LIFELINE; /* LSB */
B2:00C7B7 900003            MOV      DPTR,#03H
B2:00C7BA 7401              MOV      A,#01H
  189:   } else {
B2:00C7BC 8034              SJMP     ?C0056?AGI
B2:00C7BE         ?C0020?AGI:
  190:     report->profile1 = myAgi.tableEndpoint[endpoint].pTable[groupId - 2].profile.profile_MS;
B2:00C7BE F14E              ACALL    ?L?COM01AC
B2:00C7C0 122589            LCALL    ?C?PLDXDATA
B2:00C7C3 9041CC            MOV      DPTR,#groupId
B2:00C7C6 E0                MOVX     A,@DPTR
B2:00C7C7 75F02E            MOV      B,#02EH
B2:00C7CA A4                MUL      AB
B2:00C7CB FF                MOV      R7,A
B2:00C7CC AEF0              MOV      R6,B
B2:00C7CE 29                ADD      A,R1
B2:00C7CF F9                MOV      R1,A
B2:00C7D0 EA                MOV      A,R2
B2:00C7D1 3E                ADDC     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 761


B2:00C7D2 FA                MOV      R2,A
B2:00C7D3 90FFA4            MOV      DPTR,#0FFA4H
B2:00C7D6 121FF0            LCALL    ?C?CLDOPTR
B2:00C7D9 9041CE            MOV      DPTR,#report
B2:00C7DC 12D98F            LCALL    ?L?COM02AF
  191:     report->profile2 = myAgi.tableEndpoint[endpoint].pTable[groupId - 2].profile.profile_LS;
B2:00C7DF F14E              ACALL    ?L?COM01AC
B2:00C7E1 1271EE            LCALL    ?L?COM0382
B2:00C7E4 90FFA5            MOV      DPTR,#0FFA5H
B2:00C7E7 121FF0            LCALL    ?C?CLDOPTR
B2:00C7EA FF                MOV      R7,A
B2:00C7EB 9041CE            MOV      DPTR,#report
B2:00C7EE 12B57F            LCALL    ?L?COM00E6
B2:00C7F1 EF                MOV      A,R7
B2:00C7F2         
B2:00C7F2 022084            LJMP     ?C?CSTOPTR
  192:   }
----- FUNCTION _CC_AGI_groupInfoGet_handler (END) -------


----- FUNCTION _GetApplGroupCommandListSize (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  217: uint8_t GetApplGroupCommandListSize(
  218:                                     uint8_t groupId,
;---- Variable 'endpoint' assigned to Register 'R5' ----
;---- Variable 'groupId' assigned to Register 'R7' ----
  219:                                     uint8_t endpoint)
  220: {
  221:   uint8_t size = 0;
;---- Variable 'size' assigned to Register 'R6' ----
B2:00C7F5 E4                CLR      A
  222: 
  223:   if (NUMBER_OF_ENDPOINTS < endpoint)
B2:00C7F6 C3                CLR      C
B2:00C7F7 9D                SUBB     A,R5
B2:00C7F8 5003              JNC      ?C0027?AGI
  224:   {
  225:     return 0; /** Error!!*/
B2:00C7FA 7F00              MOV      R7,#00H
B2:00C7FC 22                RET      
  226:   }
B2:00C7FD         ?C0027?AGI:
  227: 
  228:   if (1 == groupId)
B2:00C7FD EF                MOV      A,R7
B2:00C7FE B4010A            CJNE     A,#01H,?C0029?AGI
  229:   {
  230:     size = myAgi.lifeLineEndpoint[endpoint].listSize * sizeof(CMD_CLASS_GRP);
B2:00C801 ED                MOV      A,R5
B2:00C802 12C641            LCALL    ?L?COM0202
B2:00C805 E0                MOVX     A,@DPTR
B2:00C806 25E0              ADD      A,ACC
B2:00C808 FE                MOV      R6,A
  231:   }
B2:00C809 8002              SJMP     ?C0030?AGI
B2:00C80B         ?C0029?AGI:
  232:   else
  233:   {
  234:     size = sizeof(CMD_CLASS_GRP);
B2:00C80B 7E02              MOV      R6,#02H
  235:   }
B2:00C80D         ?C0030?AGI:
  236:   return size;
B2:00C80D AF06              MOV      R7,AR6
  237: }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 762


B2:00C80F 22                RET      
----- FUNCTION _GetApplGroupCommandListSize (END) -------


----- FUNCTION ApplicationGetLastActiveGroupId (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  240: ApplicationGetLastActiveGroupId(void)
  241: {
  242:   return m_lastActiveGroupId;
  243: }
B2:00C810 903235            MOV      DPTR,#m_lastActiveGroupId
B2:00C813 E0                MOVX     A,@DPTR
B2:00C814 FF                MOV      R7,A
  244: 
B2:00C815 22                RET      
----- FUNCTION ApplicationGetLastActiveGroupId (END) -------


----- FUNCTION SearchCmdClass (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  249: SearchCmdClass(CMD_CLASS_GRP cmdGrp, CMD_CLASS_GRP* pCmdGrpList, uint8_t listSize)
  250: {
  251:   for (; listSize > 0; listSize--) {
  252:     if (cmdGrp.cmdClass == pCmdGrpList[listSize - 1].cmdClass) {
B2:00C816         ?C0032?AGI:
B2:00C816 904149            MOV      DPTR,#listSize
B2:00C819 E0                MOVX     A,@DPTR
B2:00C81A FF                MOV      R7,A
B2:00C81B D3                SETB     C
B2:00C81C 9400              SUBB     A,#00H
B2:00C81E 4024              JC       ?C0033?AGI
  253:       return TRUE;
B2:00C820 EF                MOV      A,R7
B2:00C821 75F002            MOV      B,#02H
B2:00C824 A4                MUL      AB
B2:00C825 FF                MOV      R7,A
B2:00C826 904146            MOV      DPTR,#pCmdGrpList
B2:00C829 1282AD            LCALL    ?L?COM0086
B2:00C82C 90FFFE            MOV      DPTR,#0FFFEH
B2:00C82F 121FF0            LCALL    ?C?CLDOPTR
B2:00C832 FF                MOV      R7,A
B2:00C833 904144            MOV      DPTR,#cmdGrp
B2:00C836 E0                MOVX     A,@DPTR
B2:00C837 B50702            CJNE     A,AR7,?C0034?AGI
  254:     }
B2:00C83A D3                SETB     C
B2:00C83B 22                RET      
  255:   }
  256:   return FALSE;
B2:00C83C         ?C0034?AGI:
B2:00C83C 904149            MOV      DPTR,#listSize
B2:00C83F E0                MOVX     A,@DPTR
B2:00C840 14                DEC      A
B2:00C841 F0                MOVX     @DPTR,A
B2:00C842 80D2              SJMP     ?C0032?AGI
B2:00C844         ?C0033?AGI:
  257: }
B2:00C844 C3                CLR      C
  258: 
B2:00C845 22                RET      
----- FUNCTION SearchCmdClass (END) -------


----- FUNCTION SearchProfile (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 763


  263: SearchProfile(AGI_PROFILE profile, CMD_CLASS_GRP cmdGrp, AGI_TABLE_EP* pAgiTable)
  264: {
  265: #define grpId i
  266:   for (grpId = pAgiTable->tableSize; grpId > 0; grpId--)
B2:00C846 90409C            MOV      DPTR,#pAgiTable
B2:00C849 128CA2            LCALL    ?L?COM007F
B2:00C84C 903236            MOV      DPTR,#i
B2:00C84F F0                MOVX     @DPTR,A
B2:00C850         ?C0037?AGI:
B2:00C850 903236            MOV      DPTR,#i
B2:00C853 E0                MOVX     A,@DPTR
B2:00C854 FF                MOV      R7,A
B2:00C855 D3                SETB     C
B2:00C856 9400              SUBB     A,#00H
B2:00C858 4061              JC       ?C0038?AGI
  267:   {
  268:     /*Find profile*/
  269:     if ((profile.profile_MS == pAgiTable->pTable[grpId - 1].profile.profile_MS) &&
B2:00C85A 12B43E            LCALL    ?L?COM0100
B2:00C85D EF                MOV      A,R7
B2:00C85E 75F02E            MOV      B,#02EH
B2:00C861 1282DD            LCALL    ?L?COM0037
B2:00C864 FA                MOV      R2,A
B2:00C865 90FFD2            MOV      DPTR,#0FFD2H
B2:00C868 121FF0            LCALL    ?C?CLDOPTR
B2:00C86B FF                MOV      R7,A
B2:00C86C 904098            MOV      DPTR,#profile
B2:00C86F E0                MOVX     A,@DPTR
B2:00C870 6F                XRL      A,R7
B2:00C871 7040              JNZ      ?C0039?AGI
B2:00C873 90FFD3            MOV      DPTR,#0FFD3H
B2:00C876 121FF0            LCALL    ?C?CLDOPTR
B2:00C879 FF                MOV      R7,A
B2:00C87A 904099            MOV      DPTR,#profile+01H
B2:00C87D E0                MOVX     A,@DPTR
B2:00C87E 6F                XRL      A,R7
B2:00C87F 7032              JNZ      ?C0039?AGI
  270:         (profile.profile_LS == pAgiTable->pTable[grpId - 1].profile.profile_LS))
  271:     {
  272:       if ( TRUE == SearchCmdClass(cmdGrp, &pAgiTable->pTable[grpId - 1].cmdGrp, 1))
B2:00C881 7844              MOV      R0,#LOW ?SearchCmdClass?BYTE
B2:00C883 7C41              MOV      R4,#HIGH ?SearchCmdClass?BYTE
B2:00C885 7A40              MOV      R2,#HIGH cmdGrp
B2:00C887 799A              MOV      R1,#LOW cmdGrp
B2:00C889 7F02              MOV      R7,#02H
B2:00C88B 12737A            LCALL    ?L?COM0578
B2:00C88E 12B43E            LCALL    ?L?COM0100
B2:00C891 3122              ACALL    ?L?COM05F7
B2:00C893 1282DD            LCALL    ?L?COM0037
B2:00C896 FA                MOV      R2,A
B2:00C897 E9                MOV      A,R1
B2:00C898 24D4              ADD      A,#0D4H
B2:00C89A 904146            MOV      DPTR,#?SearchCmdClass?BYTE+02H
B2:00C89D 1272DD            LCALL    ?L?COM048B
B2:00C8A0 904149            MOV      DPTR,#?SearchCmdClass?BYTE+05H
B2:00C8A3 7401              MOV      A,#01H
B2:00C8A5 F0                MOVX     @DPTR,A
B2:00C8A6 1116              ACALL    SearchCmdClass
B2:00C8A8 5009              JNC      ?C0039?AGI
  273:       {
  274:         return grpId - 1;
B2:00C8AA 903236            MOV      DPTR,#i
B2:00C8AD E0                MOVX     A,@DPTR
B2:00C8AE C3                CLR      C
B2:00C8AF 9401              SUBB     A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 764


B2:00C8B1 FF                MOV      R7,A
B2:00C8B2 22                RET      
  275:       }
  276:     }
  277:   }
B2:00C8B3         ?C0039?AGI:
B2:00C8B3 903236            MOV      DPTR,#i
B2:00C8B6 E0                MOVX     A,@DPTR
B2:00C8B7 14                DEC      A
B2:00C8B8 F0                MOVX     @DPTR,A
B2:00C8B9 8095              SJMP     ?C0037?AGI
B2:00C8BB         ?C0038?AGI:
  278:   return 0xFF;
B2:00C8BB 7FFF              MOV      R7,#0FFH
  279: #undef grpId
  280: }
B2:00C8BD 22                RET      
----- FUNCTION SearchProfile (END) -------


----- FUNCTION _ZAF_CC_AGI_CorrectGroupIdIfInvalid (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\AGI.C'
  357: void ZAF_CC_AGI_CorrectGroupIdIfInvalid(uint8_t endpoint, uint8_t * pGroupId)
  358: {
;---- Variable 'pGroupId' assigned to Register 'R1/R2/R3' ----
;---- Variable 'endpoint' assigned to Register 'R7' ----
  359:   if ((0 == *pGroupId) || (*pGroupId >= myAgi.tableEndpoint[endpoint].tableSize + 2))
  360:   {
B2:00C8BE 121FB3            LCALL    ?C?CLDPTR
B2:00C8C1 FE                MOV      R6,A
B2:00C8C2 600B              JZ       ?C0051?AGI
B2:00C8C4 71D8              ACALL    ?L?COM021F
B2:00C8C6 E0                MOVX     A,@DPTR
B2:00C8C7 2402              ADD      A,#02H
B2:00C8C9 FD                MOV      R5,A
B2:00C8CA EE                MOV      A,R6
B2:00C8CB C3                CLR      C
B2:00C8CC 9D                SUBB     A,R5
B2:00C8CD 4005              JC       ?C0052?AGI
B2:00C8CF         ?C0051?AGI:
  361:     *pGroupId = 1;
  362:   }
B2:00C8CF 7401              MOV      A,#01H
B2:00C8D1 122072            LCALL    ?C?CSTPTR
  363: }
  363: 
B2:00C8D4         ?C0052?AGI:
B2:00C8D4 22                RET      
----- FUNCTION _ZAF_CC_AGI_CorrectGroupIdIfInvalid (END) -------


----- FUNCTION _TaskPause (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
  160: BOOL TaskPause(uint8_t taskhandeId)
  161: {
;---- Variable 'taskhandeId' assigned to Register 'R7' ----
  162:   uint8_t i = 0;
  163:   BOOL status = FALSE;
;---- Variable 'i' assigned to Register 'R6' ----
B2:00C8D5 E4                CLR      A
B2:00C8D6 FE                MOV      R6,A
  164: 
B2:00C8D7 C246              CLR      status
  165:   for(i = 0; i < myTask.usedSlots; i++)
B2:00C8D9         ?C0011?ZW_TASK:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 765


B2:00C8D9 3119              ACALL    ?L?COM0428
B2:00C8DB 5018              JNC      ?C0012?ZW_TASK
  166:   {
  167:     /* find Id*/
  168:     if( taskhandeId == myTask.myTaskPool[i].id)
B2:00C8DD 12C0DD            LCALL    ?L?COM0089
B2:00C8E0 E0                MOVX     A,@DPTR
B2:00C8E1 FD                MOV      R5,A
B2:00C8E2 543F              ANL      A,#03FH
B2:00C8E4 B5070B            CJNE     A,AR7,?C0013?ZW_TASK
  169:     {
  170:       myTask.myTaskPool[i].active = FALSE;
B2:00C8E7 12C0DD            LCALL    ?L?COM0089
B2:00C8EA ED                MOV      A,R5
B2:00C8EB 54BF              ANL      A,#0BFH
B2:00C8ED F0                MOVX     @DPTR,A
  171:       status = TRUE;
B2:00C8EE D246              SETB     status
  172:       break;
B2:00C8F0 8003              SJMP     ?C0012?ZW_TASK
  173:     }
  174:   }
B2:00C8F2         ?C0013?ZW_TASK:
B2:00C8F2 0E                INC      R6
B2:00C8F3 80E4              SJMP     ?C0011?ZW_TASK
B2:00C8F5         ?C0012?ZW_TASK:
  175:   return status;
B2:00C8F5 A246              MOV      C,status
  176: }
B2:00C8F7 22                RET      
----- FUNCTION _TaskPause (END) -------


----- FUNCTION _TaskRun (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
  185: BOOL TaskRun(uint8_t taskhandeId)
  186: {
;---- Variable 'taskhandeId' assigned to Register 'R7' ----
  187:   uint8_t i = 0;
  188:   BOOL status = FALSE;
;---- Variable 'i' assigned to Register 'R6' ----
B2:00C8F8 E4                CLR      A
B2:00C8F9 FE                MOV      R6,A
  189: 
B2:00C8FA C247              CLR      status
  190:   for(i = 0; i < myTask.usedSlots; i++)
B2:00C8FC         ?C0016?ZW_TASK:
B2:00C8FC 3119              ACALL    ?L?COM0428
B2:00C8FE 5016              JNC      ?C0017?ZW_TASK
  191:   {
  192:     /* find Id*/
  193:     if( taskhandeId == myTask.myTaskPool[i].id)
B2:00C900 12C0DD            LCALL    ?L?COM0089
B2:00C903 E0                MOVX     A,@DPTR
B2:00C904 FD                MOV      R5,A
B2:00C905 543F              ANL      A,#03FH
B2:00C907 B50709            CJNE     A,AR7,?C0018?ZW_TASK
  194:     {
  195:       myTask.myTaskPool[i].active = TRUE;
B2:00C90A 12C0DD            LCALL    ?L?COM0089
B2:00C90D ED                MOV      A,R5
B2:00C90E 4440              ORL      A,#040H
B2:00C910 F0                MOVX     @DPTR,A
  196:       status = TRUE;
B2:00C911 D247              SETB     status
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 766


  197:     }
  198:   }
B2:00C913         ?C0018?ZW_TASK:
B2:00C913 0E                INC      R6
B2:00C914 80E6              SJMP     ?C0016?ZW_TASK
B2:00C916         ?C0017?ZW_TASK:
  199:   return status;
B2:00C916 A247              MOV      C,status
  200: }
B2:00C918 22                RET      
----- FUNCTION _TaskRun (END) -------


----- FUNCTION ?L?COM0428 (BEGIN) -----
B2:00C919 903792            MOV      DPTR,#myTask+03H
B2:00C91C E0                MOVX     A,@DPTR
B2:00C91D FD                MOV      R5,A
B2:00C91E EE                MOV      A,R6
B2:00C91F C3                CLR      C
B2:00C920 9D                SUBB     A,R5
B2:00C921 22                RET      
----- FUNCTION ?L?COM0428 (END) -------


----- FUNCTION ?L?COM05F7 (BEGIN) -----
B2:00C922 903236            MOV      DPTR,#i
B2:00C925 E0                MOVX     A,@DPTR
B2:00C926 75F02E            MOV      B,#02EH
B2:00C929 22                RET      
----- FUNCTION ?L?COM05F7 (END) -------


----- FUNCTION TaskInterruptSignal (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TASK.C'
  252: void TaskInterruptSignal(void)
  253: {
  254:   myTask.intpSignal = TRUE;
  255: }
B2:00C92A 90378F            MOV      DPTR,#myTask
B2:00C92D 7401              MOV      A,#01H
B2:00C92F F0                MOVX     @DPTR,A
  256: 
B2:00C930 22                RET      
----- FUNCTION TaskInterruptSignal (END) -------


----- FUNCTION _ZW_util_queue_Init (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_UTIL_QUEUE.C'
   37: void ZW_util_queue_Init(QUEUE_T * pQueue, void * pBuffer, BYTE sizeOfElements, BYTE numberOfElements)
   38: {
B2:00C931 903FF4            MOV      DPTR,#pQueue
B2:00C934 1225A9            LCALL    ?C?PSTXDATA
   39:   pQueue->out = 0;
   40:   pQueue->in = 0;
B2:00C937 903FF4            MOV      DPTR,#pQueue
B2:00C93A 127111            LCALL    ?L?COM0287
   41:   pQueue->queueSize = numberOfElements;
B2:00C93D 903FF4            MOV      DPTR,#pQueue
B2:00C940 12A5A3            LCALL    ?L?COM001F
B2:00C943 E4                CLR      A
B2:00C944 122084            LCALL    ?C?CSTOPTR
   42:   pQueue->count = 0;
B2:00C947 903FFB            MOV      DPTR,#numberOfElements
B2:00C94A E0                MOVX     A,@DPTR
B2:00C94B 900003            MOV      DPTR,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 767


B2:00C94E 31B0              ACALL    ?L?COM025A
   43:   pQueue->elementType = sizeOfElements;
B2:00C950 903FFA            MOV      DPTR,#sizeOfElements
B2:00C953 12B6D9            LCALL    ?L?COM039D
   44:   pQueue->array = (BYTE*)pBuffer;
B2:00C956 903FF7            MOV      DPTR,#pBuffer
B2:00C959 122589            LCALL    ?C?PLDXDATA
B2:00C95C C003              PUSH     AR3
B2:00C95E C002              PUSH     AR2
B2:00C960 C001              PUSH     AR1
B2:00C962 903FF4            MOV      DPTR,#pQueue
B2:00C965 122589            LCALL    ?C?PLDXDATA
B2:00C968 900005            MOV      DPTR,#05H
B2:00C96B 12265D            LCALL    ?C?PSTOPTR
   45: }
B2:00C96E 22                RET      
----- FUNCTION _ZW_util_queue_Init (END) -------


----- FUNCTION _ZAF_eventSchedulerInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  105: void ZAF_eventSchedulerInit(VOID_CALLBACKFUNC(pApplicationStateMachine)(BYTE))
  106: {
;---- Variable 'pApplicationStateMachine' assigned to Register 'R6/R7' ----
  107:   if(NON_NULL( pApplicationStateMachine ))
  108:   {
B2:00C96F EF                MOV      A,R7
B2:00C970 4E                ORL      A,R6
B2:00C971 603C              JZ       ?C0003?EV_MAN
  109:     m_pApplicationStateMachine = pApplicationStateMachine;
  110:     ZW_util_queue_Init(&eventQueue, eventQueueBuffer, sizeof(eventQueueBuffer[0]), EVENT_QUEUE_BUFFER_SIZE);
B2:00C973 90392E            MOV      DPTR,#_m_pApplicationStateMachine
B2:00C976 EE                MOV      A,R6
B2:00C977 F0                MOVX     @DPTR,A
B2:00C978 A3                INC      DPTR
B2:00C979 EF                MOV      A,R7
B2:00C97A F0                MOVX     @DPTR,A
  111:     ZW_util_queue_Init(&jobQueue, jobQueueBuffer, sizeof(jobQueueBuffer[0]), JOB_QUEUE_BUFFER_SIZE);
B2:00C97B 7A39              MOV      R2,#HIGH eventQueueBuffer
B2:00C97D 7915              MOV      R1,#LOW eventQueueBuffer
B2:00C97F 126F2F            LCALL    ?L?COM0291
B2:00C982 7405              MOV      A,#05H
B2:00C984 F0                MOVX     @DPTR,A
B2:00C985 7A39              MOV      R2,#HIGH eventQueue
B2:00C987 791D              MOV      R1,#LOW eventQueue
B2:00C989 3131              ACALL    _ZW_util_queue_Init
  112: 
B2:00C98B 7B01              MOV      R3,#01H
B2:00C98D 7A39              MOV      R2,#HIGH jobQueueBuffer
B2:00C98F 791A              MOV      R1,#LOW jobQueueBuffer
B2:00C991 126F31            LCALL    ?L?COM0292
B2:00C994 7403              MOV      A,#03H
B2:00C996 F0                MOVX     @DPTR,A
B2:00C997 7A39              MOV      R2,#HIGH jobQueue
B2:00C999 7926              MOV      R1,#LOW jobQueue
B2:00C99B 3131              ACALL    _ZW_util_queue_Init
  113:     if((taskHandleId = TaskAdd(ZCB_eventScheduler, (const char*)"AppEvScheduler")) == 0)
B2:00C99D 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_eventScheduler
B2:00C99F 7F53              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_eventScheduler
B2:00C9A1 7BFF              MOV      R3,#0FFH
B2:00C9A3 7A2F              MOV      R2,#HIGH 01002FDDH
B2:00C9A5 79DD              MOV      R1,#LOW 01002FDDH
B2:00C9A7 12C002            LCALL    _TaskAdd
B2:00C9AA 903925            MOV      DPTR,#taskHandleId
B2:00C9AD EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 768


B2:00C9AE F0                MOVX     @DPTR,A
  114:     {
  115:       ZW_DEBUG_EV_MAN_SEND_NL();
  116:       ZW_DEBUG_EV_MAN_SEND_STR("Task pool full");
  117:     }
  118:   }
  119: }
B2:00C9AF         ?C0003?EV_MAN:
B2:00C9AF 22                RET      
----- FUNCTION _ZAF_eventSchedulerInit (END) -------


----- FUNCTION ?L?COM025A (BEGIN) -----
B2:00C9B0 122084            LCALL    ?C?CSTOPTR
B2:00C9B3         ?L?COM025B:
B2:00C9B3 900002            MOV      DPTR,#02H
B2:00C9B6 E4                CLR      A
B2:00C9B7 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM025A (END) -------


----- FUNCTION _handleCommandClassManufacturerSpecific (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMANUFACTURERSPECIFIC.C'
   36: handleCommandClassManufacturerSpecific(
   37:     RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00C9BA 903CEB            MOV      DPTR,#rxOpt
B2:00C9BD 1225A9            LCALL    ?C?PSTXDATA
   38:     ZW_APPLICATION_TX_BUFFER *pCmd,
   39:     BYTE cmdLength
   40: )
   41: {
   42:   ZW_APPLICATION_TX_BUFFER *pTxBuf;
   43:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *txOptionsEx;
   44:   UNUSED(cmdLength);
   45: 
   46:   if (TRUE == Check_not_legal_response_job(rxOpt))
B2:00C9C0 714C              ACALL    _Check_not_legal_response_job
B2:00C9C2 5003              JNC      ?C0001?COMMANDCLASSMANUFACTURERSPECIFIC
   47:   {
   48:     // None of the following commands support endpoint bit addressing.
   49:     return RECEIVED_FRAME_STATUS_FAIL;
B2:00C9C4 7F02              MOV      R7,#02H
B2:00C9C6 22                RET      
   50:   }
B2:00C9C7         ?C0001?COMMANDCLASSMANUFACTURERSPECIFIC:
   51: 
   52:   switch(pCmd->ZW_Common.cmd)
B2:00C9C7 903CEE            MOV      DPTR,#pCmd
B2:00C9CA 12A5A3            LCALL    ?L?COM001F
B2:00C9CD 121FF0            LCALL    ?C?CLDOPTR
B2:00C9D0 24FA              ADD      A,#0FAH
B2:00C9D2 6052              JZ       ?C0007?COMMANDCLASSMANUFACTURERSPECIFIC
B2:00C9D4 2402              ADD      A,#02H
B2:00C9D6 6002              JZ       $ + 4H
B2:00C9D8 4185              AJMP     ?C0003?COMMANDCLASSMANUFACTURERSPECIFIC
   53:   {
   54:     case MANUFACTURER_SPECIFIC_GET_V2:
B2:00C9DA         ?C0004?COMMANDCLASSMANUFACTURERSPECIFIC:
   55:       pTxBuf = GetResponseBuffer();
B2:00C9DA 7115              ACALL    ?L?COM0498
B2:00C9DC 7003              JNZ      ?C0005?COMMANDCLASSMANUFACTURERSPECIFIC
   56:       if (IS_NULL(pTxBuf))
   57:       {
   58:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00C9DE 7F02              MOV      R7,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 769


B2:00C9E0 22                RET      
   59:       }
B2:00C9E1         ?C0005?COMMANDCLASSMANUFACTURERSPECIFIC:
   60:       RxToTxOptions(rxOpt, &txOptionsEx);
B2:00C9E1 5188              ACALL    ?L?COM052E
B2:00C9E3 1225A9            LCALL    ?C?PSTXDATA
B2:00C9E6 903CEB            MOV      DPTR,#rxOpt
B2:00C9E9 12AB5D            LCALL    ?L?COM0107
   61:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.cmdClass = COMMAND_CLASS_MANUFACTURER_SPECIFIC_V2;
B2:00C9EC 7137              ACALL    ?L?COM03DF
B2:00C9EE 12A5A3            LCALL    ?L?COM001F
B2:00C9F1 7405              MOV      A,#05H
B2:00C9F3 31B0              ACALL    ?L?COM025A
   62:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.cmd = MANUFACTURER_SPECIFIC_REPORT_V2;
   63:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.manufacturerId1 = (APP_MANUFACTURER_ID >> 8);
   64:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.manufacturerId2 = (APP_MANUFACTURER_ID & 0xFF);
B2:00C9F5 900003            MOV      DPTR,#03H
B2:00C9F8 E4                CLR      A
B2:00C9F9 71D0              ACALL    ?L?COM03E7
B2:00C9FB 122084            LCALL    ?C?CSTOPTR
   65:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.productTypeId1 = (APP_PRODUCT_TYPE_ID >> 8);
   66:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.productTypeId2 = (APP_PRODUCT_TYPE_ID & 0xFF);
B2:00C9FE 7403              MOV      A,#03H
B2:00CA00 71E7              ACALL    ?L?COM036B
B2:00CA02 7402              MOV      A,#02H
B2:00CA04 122084            LCALL    ?C?CSTOPTR
   67:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.productId1 = (APP_PRODUCT_ID>>8);
   68:       pTxBuf->ZW_ManufacturerSpecificReportV2Frame.productId2 = (APP_PRODUCT_ID & 0xFF);
   69: 
   70:       if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
   71:           (BYTE *)pTxBuf,
B2:00CA07 C003              PUSH     AR3
B2:00CA09 C002              PUSH     AR2
B2:00CA0B C001              PUSH     AR1
B2:00CA0D 903CF5            MOV      DPTR,#txOptionsEx
B2:00CA10 12A147            LCALL    ?L?COM001D
B2:00CA13 D001              POP      AR1
B2:00CA15 D002              POP      AR2
B2:00CA17 D003              POP      AR3
B2:00CA19 7D08              MOV      R5,#08H
B2:00CA1B 12A13D            LCALL    ?L?COM00BD
B2:00CA1E 6003              JZ       ?C0006?COMMANDCLASSMANUFACTURERSPECIFIC
   72:           sizeof(ZW_MANUFACTURER_SPECIFIC_REPORT_V2_FRAME),
   73:           txOptionsEx,
   74:           ZCB_ResponseJobStatus))
   75:       {
   76:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
   77:         FreeResponseBuffer();
B2:00CA20 12A0B6            LCALL    FreeResponseBuffer
   78:       }
B2:00CA23         ?C0006?COMMANDCLASSMANUFACTURERSPECIFIC:
   79:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00CA23 7FFF              MOV      R7,#0FFH
B2:00CA25 22                RET      
   80:       break;
   81:     case DEVICE_SPECIFIC_GET_V2:
B2:00CA26         ?C0007?COMMANDCLASSMANUFACTURERSPECIFIC:
   82:       pTxBuf = GetResponseBuffer();
B2:00CA26 7115              ACALL    ?L?COM0498
B2:00CA28 7003              JNZ      ?C0008?COMMANDCLASSMANUFACTURERSPECIFIC
   83:       /*Check pTxBuf is free*/
   84:       if (IS_NULL(pTxBuf))
   85:       {
   86:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00CA2A 7F02              MOV      R7,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 770


B2:00CA2C 22                RET      
   87:       }
B2:00CA2D         ?C0008?COMMANDCLASSMANUFACTURERSPECIFIC:
   88: 
   89:       RxToTxOptions(rxOpt, &txOptionsEx);
B2:00CA2D 5188              ACALL    ?L?COM052E
B2:00CA2F 1225A9            LCALL    ?C?PSTXDATA
B2:00CA32 903CEB            MOV      DPTR,#rxOpt
B2:00CA35 12AB5D            LCALL    ?L?COM0107
   90:       pTxBuf->ZW_DeviceSpecificReport1byteV2Frame.cmdClass = COMMAND_CLASS_MANUFACTURER_SPECIFIC_V2;
B2:00CA38 7137              ACALL    ?L?COM03DF
B2:00CA3A 12A5A3            LCALL    ?L?COM001F
B2:00CA3D 7407              MOV      A,#07H
B2:00CA3F 7121              ACALL    ?L?COM01DB
   91:       pTxBuf->ZW_DeviceSpecificReport1byteV2Frame.cmd = DEVICE_SPECIFIC_REPORT_V2;
   92:       pTxBuf->ZW_DeviceSpecificReport1byteV2Frame.properties1 = APP_DEVICE_ID_TYPE;
   93:       pTxBuf->ZW_DeviceSpecificReport1byteV2Frame.properties2 = (APP_DEVICE_ID_FORMAT << 5) | (MAN_DEVICE_ID_SIZE
>>  & 0x1F);
B2:00CA41 900003            MOV      DPTR,#03H
B2:00CA44 7428              MOV      A,#028H
B2:00CA46 122084            LCALL    ?C?CSTOPTR
   94:       memcpy(&(pTxBuf->ZW_DeviceSpecificReport1byteV2Frame.deviceIdData1), manSpecificDeviceID, MAN_DEVICE_ID_SIZ
>> E);
B2:00CA49 125525            LCALL    ?L?COM005A
B2:00CA4C C003              PUSH     AR3
B2:00CA4E C002              PUSH     AR2
B2:00CA50 C001              PUSH     AR1
B2:00CA52 7B01              MOV      R3,#01H
B2:00CA54 7A3F              MOV      R2,#HIGH manSpecificDeviceID
B2:00CA56 79FC              MOV      R1,#LOW manSpecificDeviceID
B2:00CA58 12C4EF            LCALL    ?L?COM0022
B2:00CA5B D001              POP      AR1
B2:00CA5D D002              POP      AR2
B2:00CA5F D003              POP      AR3
B2:00CA61 7F08              MOV      R7,#08H
B2:00CA63 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
   95: 
   96:       if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
   97:           (BYTE *)pTxBuf,
B2:00CA66 903CF2            MOV      DPTR,#pTxBuf
B2:00CA69 128CA2            LCALL    ?L?COM007F
B2:00CA6C 541F              ANL      A,#01FH
B2:00CA6E 2404              ADD      A,#04H
B2:00CA70 FD                MOV      R5,A
B2:00CA71 903CF5            MOV      DPTR,#txOptionsEx
B2:00CA74 12A147            LCALL    ?L?COM001D
B2:00CA77 903CF2            MOV      DPTR,#pTxBuf
B2:00CA7A 12A13A            LCALL    ?L?COM00BC
B2:00CA7D 6003              JZ       ?C0009?COMMANDCLASSMANUFACTURERSPECIFIC
   98:           sizeof(ZW_DEVICE_SPECIFIC_REPORT_1BYTE_V2_FRAME) +
   99:             (pTxBuf->ZW_DeviceSpecificReport1byteV2Frame.properties2 & 0x1F) - 1, /*Drag out length field 0x1F*/
  100:           txOptionsEx,
  101:           ZCB_ResponseJobStatus))
  102:       {
  103:         /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  104:         FreeResponseBuffer();
B2:00CA7F 12A0B6            LCALL    FreeResponseBuffer
  105:       }
B2:00CA82         ?C0009?COMMANDCLASSMANUFACTURERSPECIFIC:
  106:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00CA82 7FFF              MOV      R7,#0FFH
B2:00CA84 22                RET      
  107:       break;
  108:   }
B2:00CA85         ?C0003?COMMANDCLASSMANUFACTURERSPECIFIC:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 771


  109:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00CA85 7F00              MOV      R7,#00H
  110: }
B2:00CA87 22                RET      
----- FUNCTION _handleCommandClassManufacturerSpecific (END) -------


----- FUNCTION ?L?COM052E (BEGIN) -----
B2:00CA88 7B01              MOV      R3,#01H
B2:00CA8A 7A3C              MOV      R2,#HIGH txOptionsEx
B2:00CA8C 79F5              MOV      R1,#LOW txOptionsEx
B2:00CA8E 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00CA91 22                RET      
----- FUNCTION ?L?COM052E (END) -------


----- FUNCTION _ZW_util_queue_Dequeue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_UTIL_QUEUE.C'
   69: BOOL ZW_util_queue_Dequeue(QUEUE_T * pQueue, void * pElement)
   70: {
B2:00CA92 903E38            MOV      DPTR,#pQueue
B2:00CA95 1225A9            LCALL    ?C?PSTXDATA
   71:   if (pQueue->count <= 0)
   72:   {
B2:00CA98 903E38            MOV      DPTR,#pQueue
B2:00CA9B 128F3E            LCALL    ?L?COM0029
B2:00CA9E D3                SETB     C
B2:00CA9F 9400              SUBB     A,#00H
B2:00CAA1 5002              JNC      ?C0008?ZW_UTIL_QUEUE
   73:     return FALSE;
   74:   }
B2:00CAA3 C3                CLR      C
B2:00CAA4 22                RET      
   75:   else
B2:00CAA5         ?C0008?ZW_UTIL_QUEUE:
   76:   {
   77:     BYTE i;
   78:     BYTE* pEl = pElement;
B2:00CAA5 903E3B            MOV      DPTR,#pElement
B2:00CAA8 122589            LCALL    ?C?PLDXDATA
B2:00CAAB 903E3F            MOV      DPTR,#pEl
B2:00CAAE 1225A9            LCALL    ?C?PSTXDATA
   79: 
   80:     for (i = 0; i < pQueue->elementType; i++)
B2:00CAB1 E4                CLR      A
B2:00CAB2 903E3E            MOV      DPTR,#i
B2:00CAB5 F0                MOVX     @DPTR,A
B2:00CAB6         ?C0011?ZW_UTIL_QUEUE:
B2:00CAB6 903E38            MOV      DPTR,#pQueue
B2:00CAB9 122589            LCALL    ?C?PLDXDATA
B2:00CABC 1270EB            LCALL    ?L?COM01E4
B2:00CABF FF                MOV      R7,A
B2:00CAC0 903E3E            MOV      DPTR,#i
B2:00CAC3 E0                MOVX     A,@DPTR
B2:00CAC4 C3                CLR      C
B2:00CAC5 9F                SUBB     A,R7
B2:00CAC6 502D              JNC      ?C0012?ZW_UTIL_QUEUE
   81:     {
   82:       *(pEl + i) = pQueue->array[(pQueue->out) * (pQueue->elementType) + i];
B2:00CAC8 121FB3            LCALL    ?C?CLDPTR
B2:00CACB 8FF0              MOV      B,R7
B2:00CACD A4                MUL      AB
B2:00CACE FF                MOV      R7,A
B2:00CACF 903E3E            MOV      DPTR,#i
B2:00CAD2 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 772


B2:00CAD3 2F                ADD      A,R7
B2:00CAD4 127401            LCALL    ?L?COM05F4
B2:00CAD7 900005            MOV      DPTR,#05H
B2:00CADA 12262D            LCALL    ?C?PLDOPTR
B2:00CADD 1272E5            LCALL    ?L?COM048E
B2:00CAE0 FF                MOV      R7,A
B2:00CAE1 903E3F            MOV      DPTR,#pEl
B2:00CAE4 122589            LCALL    ?C?PLDXDATA
B2:00CAE7 903E3E            MOV      DPTR,#i
B2:00CAEA 1271E4            LCALL    ?L?COM037B
   83:     }
B2:00CAED 903E3E            MOV      DPTR,#i
B2:00CAF0 E0                MOVX     A,@DPTR
B2:00CAF1 04                INC      A
B2:00CAF2 F0                MOVX     @DPTR,A
B2:00CAF3 80C1              SJMP     ?C0011?ZW_UTIL_QUEUE
B2:00CAF5         ?C0012?ZW_UTIL_QUEUE:
   84: 
   85:     pQueue->out = (pQueue->out + 1) % pQueue->queueSize;
B2:00CAF5 903E38            MOV      DPTR,#pQueue
B2:00CAF8 128CA2            LCALL    ?L?COM007F
B2:00CAFB FF                MOV      R7,A
B2:00CAFC 121FB3            LCALL    ?C?CLDPTR
B2:00CAFF 04                INC      A
B2:00CB00 8FF0              MOV      B,R7
B2:00CB02 84                DIV      AB
B2:00CB03 E5F0              MOV      A,B
B2:00CB05 122072            LCALL    ?C?CSTPTR
   86:     pQueue->count = pQueue->count - 1;
B2:00CB08 903E38            MOV      DPTR,#pQueue
B2:00CB0B 127358            LCALL    ?L?COM0515
B2:00CB0E 74FF              MOV      A,#0FFH
B2:00CB10 12203F            LCALL    ?C?CILDOPTR
   87:   }
B2:00CB13         ?C0010?ZW_UTIL_QUEUE:
   88:   return TRUE;
B2:00CB13 D3                SETB     C
   89: }
B2:00CB14 22                RET      
----- FUNCTION _ZW_util_queue_Dequeue (END) -------


----- FUNCTION ?L?COM0498 (BEGIN) -----
B2:00CB15 129A8C            LCALL    GetResponseBuffer
B2:00CB18 903CF2            MOV      DPTR,#pTxBuf
B2:00CB1B 1225A9            LCALL    ?C?PSTXDATA
B2:00CB1E E9                MOV      A,R1
B2:00CB1F 4A                ORL      A,R2
B2:00CB20 22                RET      
----- FUNCTION ?L?COM0498 (END) -------


----- FUNCTION ?L?COM01DB (BEGIN) -----
B2:00CB21 122084            LCALL    ?C?CSTOPTR
B2:00CB24 900002            MOV      DPTR,#02H
B2:00CB27 7401              MOV      A,#01H
B2:00CB29 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM01DB (END) -------


----- FUNCTION ?L?COM052F (BEGIN) -----
B2:00CB2C 7B01              MOV      R3,#01H
B2:00CB2E 7A39              MOV      R2,#HIGH eventQueue
B2:00CB30 791D              MOV      R1,#LOW eventQueue
----- FUNCTION _ZW_util_queue_GetItemCount (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 773


 FILE: '..\APPLICATIONUTILITIES\ZW_UTIL_QUEUE.C'
   91: uint8_t ZW_util_queue_GetItemCount(QUEUE_T * pQueue)
   92: {
;---- Variable 'pQueue' assigned to Register 'R1/R2/R3' ----
   93:   return pQueue->count;
   94: }
B2:00CB32 128F41            LCALL    ?L?COM002A
B2:00CB35 FF                MOV      R7,A
   94: 
B2:00CB36 22                RET      
----- FUNCTION _ZW_util_queue_GetItemCount (END) -------


----- FUNCTION ?L?COM03DF (BEGIN) -----
B2:00CB37 903CF2            MOV      DPTR,#pTxBuf
B2:00CB3A 122589            LCALL    ?C?PLDXDATA
B2:00CB3D 7472              MOV      A,#072H
B2:00CB3F 122072            LCALL    ?C?CSTPTR
B2:00CB42 903CF2            MOV      DPTR,#pTxBuf
B2:00CB45 22                RET      
----- FUNCTION ?L?COM03DF (END) -------


----- FUNCTION ?L?COM0176 (BEGIN) -----
B2:00CB46 903B24            MOV      DPTR,#rxOpt
B2:00CB49 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _Check_not_legal_response_job (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  405: Check_not_legal_response_job(RECEIVE_OPTIONS_TYPE_EX *rxOpt) /*rxOpt pointer of type RECEIVE_OPTIONS_TYPE_EX */
  406: {
;---- Variable 'rxOpt' assigned to Register 'R1/R2/R3' ----
  407:   BOOL status = FALSE;
  408: 
B2:00CB4C C24E              CLR      status
  409:   /*
  410:    * Check
  411:    * 1: Get/Report do not support endpoint bit-addressing
  412:    * 2: This check is to avoid that a response to a request is sent if the
  413:    * request is not singlecast.
  414:    * 3: Get command must no support Supervision encapsulation (CC:006C.01.00.13.002)
  415:    */
  416:   if((0 != rxOpt->destNode.BitAddress) ||
B2:00CB4E 719D              ACALL    ?L?COM0514
B2:00CB50 127152            LCALL    ?L?COM02C7
B2:00CB53 20E00E            JB       ACC.0,?C0045?ZW_TRANSPORTENDPOINT
B2:00CB56 121FB3            LCALL    ?C?CLDPTR
B2:00CB59 540C              ANL      A,#0CH
B2:00CB5B 7007              JNZ      ?C0045?ZW_TRANSPORTENDPOINT
B2:00CB5D 9035F4            MOV      DPTR,#myTransportEndpoint
B2:00CB60 E0                MOVX     A,@DPTR
B2:00CB61 B40102            CJNE     A,#01H,?C0044?ZW_TRANSPORTENDPOINT
B2:00CB64         ?C0045?ZW_TRANSPORTENDPOINT:
  417:      (0 != (rxOpt->rxStatus & (RECEIVE_STATUS_TYPE_BROAD | RECEIVE_STATUS_TYPE_MULTI))) ||
  418:      (TRUE == myTransportEndpoint.flag_supervision_encap))
  419:   {
  420: 
  421:     status = TRUE;
B2:00CB64 D24E              SETB     status
  422:   }
B2:00CB66         ?C0044?ZW_TRANSPORTENDPOINT:
  423:   myTransportEndpoint.flag_supervision_encap = FALSE;
B2:00CB66 E4                CLR      A
B2:00CB67 9035F4            MOV      DPTR,#myTransportEndpoint
B2:00CB6A F0                MOVX     @DPTR,A
  424:   return status;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 774


B2:00CB6B A24E              MOV      C,status
  425: }
B2:00CB6D 22                RET      
----- FUNCTION _Check_not_legal_response_job (END) -------


----- FUNCTION ZCB_eventScheduler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  130: PCB_BOOL(ZCB_eventScheduler)(void)
  131: {
  132:   if(NON_NULL( m_pApplicationStateMachine ))
  133:   {
B2:00CB6E 90392E            MOV      DPTR,#_m_pApplicationStateMachine
B2:00CB71 E0                MOVX     A,@DPTR
B2:00CB72 FE                MOV      R6,A
B2:00CB73 A3                INC      DPTR
B2:00CB74 E0                MOVX     A,@DPTR
B2:00CB75 4E                ORL      A,R6
B2:00CB76 601B              JZ       ?C0005?EV_MAN
  134:     BYTE event;
  135:     if(TRUE == ZW_util_queue_Dequeue(&eventQueue, &event))
B2:00CB78 7A43              MOV      R2,#HIGH event
B2:00CB7A 79AD              MOV      R1,#LOW event
B2:00CB7C 903E3B            MOV      DPTR,#?_ZW_util_queue_Dequeue?BYTE+03H
B2:00CB7F 71AB              ACALL    ?L?COM0530
B2:00CB81 5192              ACALL    _ZW_util_queue_Dequeue
B2:00CB83 500E              JNC      ?C0005?EV_MAN
  136:     {
  137:       m_pApplicationStateMachine(event);
B2:00CB85 9043AD            MOV      DPTR,#event
B2:00CB88 E0                MOVX     A,@DPTR
B2:00CB89 FF                MOV      R7,A
B2:00CB8A 90392E            MOV      DPTR,#_m_pApplicationStateMachine
B2:00CB8D 12515D            LCALL    ?L?COM0154
B2:00CB90 12271A            LCALL    ?C?ICALL2
  138:     }
  139:   }
B2:00CB93         ?C0005?EV_MAN:
  140: 
  141:   return ZW_util_queue_GetItemCount(&eventQueue) != 0;
B2:00CB93 712C              ACALL    ?L?COM052F
B2:00CB95 EF                MOV      A,R7
B2:00CB96 C3                CLR      C
B2:00CB97 6001              JZ       ?C0007?EV_MAN
B2:00CB99 D3                SETB     C
B2:00CB9A         ?C0007?EV_MAN:
  142: }
B2:00CB9A 22                RET      
----- FUNCTION ZCB_eventScheduler (END) -------


----- FUNCTION ZAF_EventScheduler_GetNumberOfEventsInQueue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  144: uint8_t ZAF_EventScheduler_GetNumberOfEventsInQueue(void)
  145: {
  146:   return ZW_util_queue_GetItemCount(&eventQueue);
  147: }
B2:00CB9B 808F              SJMP     ?L?COM052F
----- FUNCTION ZAF_EventScheduler_GetNumberOfEventsInQueue (END) -------


----- FUNCTION ?L?COM0514 (BEGIN) -----
B2:00CB9D 900005            MOV      DPTR,#05H
B2:00CBA0 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0514 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 775




----- FUNCTION ZAF_jobQueueCount (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  167: uint8_t ZAF_jobQueueCount(void)
  168: {
  169:   return ZW_util_queue_GetItemCount(&jobQueue);
  170: }
B2:00CBA3 7B01              MOV      R3,#01H
B2:00CBA5 7A39              MOV      R2,#HIGH jobQueue
B2:00CBA7 7926              MOV      R1,#LOW jobQueue
B2:00CBA9 8087              SJMP     _ZW_util_queue_GetItemCount
----- FUNCTION ZAF_jobQueueCount (END) -------


----- FUNCTION ?L?COM0530 (BEGIN) -----
B2:00CBAB 7B01              MOV      R3,#01H
B2:00CBAD 1225A9            LCALL    ?C?PSTXDATA
B2:00CBB0 7A39              MOV      R2,#HIGH eventQueue
B2:00CBB2 791D              MOV      R1,#LOW eventQueue
B2:00CBB4 22                RET      
----- FUNCTION ?L?COM0530 (END) -------


----- FUNCTION _ZAF_jobEnqueue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  149: BOOL ZAF_jobEnqueue(BYTE event)
  150: {
B2:00CBB5 9043AE            MOV      DPTR,#event
B2:00CBB8 EF                MOV      A,R7
B2:00CBB9 F0                MOVX     @DPTR,A
  151:   ZW_DEBUG_EV_MAN_SEND_STR("\r\nZAF_jobEnqueue");
  152:   ZW_DEBUG_EV_MAN_SEND_NUM(event);
  153:   ZW_DEBUG_EV_MAN_SEND_NL();
  154:   return ZW_util_queue_Enqueue(&jobQueue, &event);
B2:00CBBA 7B01              MOV      R3,#01H
B2:00CBBC 7A43              MOV      R2,#HIGH event
B2:00CBBE 79AE              MOV      R1,#LOW event
B2:00CBC0 903E31            MOV      DPTR,#?_ZW_util_queue_Enqueue?BYTE+03H
B2:00CBC3 1225A9            LCALL    ?C?PSTXDATA
B2:00CBC6 7A39              MOV      R2,#HIGH jobQueue
B2:00CBC8 7926              MOV      R1,#LOW jobQueue
B2:00CBCA 02A9AA            LJMP     _ZW_util_queue_Enqueue
  155: }
----- FUNCTION _ZAF_jobEnqueue (END) -------


----- FUNCTION ?L?COM03E6 (BEGIN) -----
B2:00CBCD 900003            MOV      DPTR,#03H
B2:00CBD0         ?L?COM03E7:
B2:00CBD0 122084            LCALL    ?C?CSTOPTR
B2:00CBD3 900004            MOV      DPTR,#04H
B2:00CBD6 E4                CLR      A
B2:00CBD7 22                RET      
----- FUNCTION ?L?COM03E6 (END) -------


----- FUNCTION ?L?COM021F (BEGIN) -----
B2:00CBD8 EF                MOV      A,R7
B2:00CBD9         ?L?COM0220:
B2:00CBD9 25E0              ADD      A,ACC
B2:00CBDB 25E0              ADD      A,ACC
B2:00CBDD 2468              ADD      A,#LOW myAgi+031H
B2:00CBDF F582              MOV      DPL,A
B2:00CBE1 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 776


B2:00CBE2 3432              ADDC     A,#HIGH myAgi+031H
B2:00CBE4 F583              MOV      DPH,A
B2:00CBE6 22                RET      
----- FUNCTION ?L?COM021F (END) -------


----- FUNCTION ?L?COM036B (BEGIN) -----
B2:00CBE7 900005            MOV      DPTR,#05H
B2:00CBEA 122084            LCALL    ?C?CSTOPTR
B2:00CBED 900006            MOV      DPTR,#06H
B2:00CBF0 E4                CLR      A
B2:00CBF1         ?L?COM036C:
B2:00CBF1 122084            LCALL    ?C?CSTOPTR
B2:00CBF4 900007            MOV      DPTR,#07H
B2:00CBF7 22                RET      
----- FUNCTION ?L?COM036B (END) -------


----- FUNCTION _ZAF_jobDequeue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\EV_MAN.C'
  157: BOOL ZAF_jobDequeue(BYTE* pEvent)
  158: {
B2:00CBF8 904312            MOV      DPTR,#pEvent
B2:00CBFB 1225A9            LCALL    ?C?PSTXDATA
  159:   BOOL x = ZW_util_queue_Dequeue(&jobQueue, pEvent);
  160:   ZW_DEBUG_EV_MAN_SEND_STR("\r\nZAF_jobDequeue");
B2:00CBFE 904312            MOV      DPTR,#pEvent
B2:00CC01 122589            LCALL    ?C?PLDXDATA
B2:00CC04 903E3B            MOV      DPTR,#?_ZW_util_queue_Dequeue?BYTE+03H
B2:00CC07 1225A9            LCALL    ?C?PSTXDATA
B2:00CC0A 7B01              MOV      R3,#01H
B2:00CC0C 7A39              MOV      R2,#HIGH jobQueue
B2:00CC0E 7926              MOV      R1,#LOW jobQueue
B2:00CC10 5192              ACALL    _ZW_util_queue_Dequeue
B2:00CC12 9249              MOV      x,C
  161:   ZW_DEBUG_EV_MAN_SEND_NUM(*pEvent);
  162:   ZW_DEBUG_EV_MAN_SEND_NUM(x);
  163:   ZW_DEBUG_EV_MAN_SEND_NL();
  164:   return x;
B2:00CC14 A249              MOV      C,x
  165: }
B2:00CC16 22                RET      
----- FUNCTION _ZAF_jobDequeue (END) -------


----- FUNCTION _cc_engine_multicast_request (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASS.C'
   23: JOB_STATUS cc_engine_multicast_request(
   24:     AGI_PROFILE* pProfile,
B2:00CC17 903A9A            MOV      DPTR,#pProfile
B2:00CC1A 1225A9            LCALL    ?C?PSTXDATA
B2:00CC1D 903A9D            MOV      DPTR,#endpoint
B2:00CC20 ED                MOV      A,R5
B2:00CC21 F0                MOVX     @DPTR,A
   25:     uint8_t endpoint,
   26:     CMD_CLASS_GRP *pcmdGrp,
   27:     uint8_t* pPayload,
   28:     uint8_t size,
   29:     uint8_t fSupervisionEnable,
   30:     VOID_CALLBACKFUNC(pCbFunc)(TRANSMISSION_RESULT * pTransmissionResult))
   31: {
   32:   uint8_t frame_len = sizeof(CMD_CLASS_GRP);
B2:00CC22 903AA8            MOV      DPTR,#frame_len
B2:00CC25 7402              MOV      A,#02H
B2:00CC27 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 777


   33:   ZW_ENGINE_FRAME * pTxBuf = (ZW_ENGINE_FRAME *)GetRequestBuffer(pCbFunc);
B2:00CC28 903AA6            MOV      DPTR,#pCbFunc
B2:00CC2B E0                MOVX     A,@DPTR
B2:00CC2C FE                MOV      R6,A
B2:00CC2D A3                INC      DPTR
B2:00CC2E E0                MOVX     A,@DPTR
B2:00CC2F FF                MOV      R7,A
B2:00CC30 12B6AD            LCALL    _GetRequestBuffer
B2:00CC33 903AA9            MOV      DPTR,#pTxBuf
B2:00CC36 1225A9            LCALL    ?C?PSTXDATA
   34:  if( IS_NULL( pTxBuf ) )
B2:00CC39 E9                MOV      A,R1
B2:00CC3A 4A                ORL      A,R2
B2:00CC3B 7003              JNZ      ?C0001?COMMANDCLASS
   35:   {
   36:     /*Ongoing job is active.. just stop current job*/
   37:     return JOB_STATUS_BUSY;
B2:00CC3D 7F01              MOV      R7,#01H
B2:00CC3F 22                RET      
   38:   }
B2:00CC40         ?C0001?COMMANDCLASS:
   39:   else
   40:   {
   41:     TRANSMIT_OPTIONS_TYPE_EX* pTxOptionsEx = NULL;
B2:00CC40 12B299            LCALL    ?L?COM0069
B2:00CC43 903AAC            MOV      DPTR,#pTxOptionsEx
B2:00CC46 1225A9            LCALL    ?C?PSTXDATA
   42: 
   43:     pTxBuf->grp.cmdClass = pcmdGrp->cmdClass;
B2:00CC49 903A9E            MOV      DPTR,#pcmdGrp
B2:00CC4C 12AE26            LCALL    ?L?COM0049
B2:00CC4F FF                MOV      R7,A
B2:00CC50 903AA9            MOV      DPTR,#pTxBuf
B2:00CC53 123F95            LCALL    ?L?COM00C0
   44:     pTxBuf->grp.cmd = pcmdGrp->cmd;
B2:00CC56 903A9E            MOV      DPTR,#pcmdGrp
B2:00CC59 12A5A3            LCALL    ?L?COM001F
B2:00CC5C 121FF0            LCALL    ?C?CLDOPTR
B2:00CC5F FF                MOV      R7,A
B2:00CC60 903AA9            MOV      DPTR,#pTxBuf
B2:00CC63 12A5A3            LCALL    ?L?COM001F
B2:00CC66 EF                MOV      A,R7
B2:00CC67 122084            LCALL    ?C?CSTOPTR
   45: 
   46:     if( 0 != size )
B2:00CC6A 903AA4            MOV      DPTR,#size
B2:00CC6D E0                MOVX     A,@DPTR
B2:00CC6E FF                MOV      R7,A
B2:00CC6F 6025              JZ       ?C0004?COMMANDCLASS
   47:     {
   48:       memcpy(pTxBuf->payload, pPayload, size);
B2:00CC71 B128              ACALL    ?L?COM03D9
B2:00CC73 C003              PUSH     AR3
B2:00CC75 C002              PUSH     AR2
B2:00CC77 C001              PUSH     AR1
B2:00CC79 903AA1            MOV      DPTR,#pPayload
B2:00CC7C 122589            LCALL    ?C?PLDXDATA
B2:00CC7F 12C4EF            LCALL    ?L?COM0022
B2:00CC82 D001              POP      AR1
B2:00CC84 D002              POP      AR2
B2:00CC86 D003              POP      AR3
B2:00CC88 121B8D            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
   49:       frame_len += size;
B2:00CC8B 903AA4            MOV      DPTR,#size
B2:00CC8E E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 778


B2:00CC8F FF                MOV      R7,A
B2:00CC90 903AA8            MOV      DPTR,#frame_len
B2:00CC93 E0                MOVX     A,@DPTR
B2:00CC94 2F                ADD      A,R7
B2:00CC95 F0                MOVX     @DPTR,A
   50:     }
B2:00CC96         ?C0004?COMMANDCLASS:
   51: 
   52:     /*Get transmit options (node list)*/
   53:     pTxOptionsEx = ReqNodeList( pProfile,
B2:00CC96 903AA9            MOV      DPTR,#pTxBuf
B2:00CC99 122589            LCALL    ?C?PLDXDATA
B2:00CC9C 903C22            MOV      DPTR,#?_ReqNodeList?BYTE+03H
B2:00CC9F 1225A9            LCALL    ?C?PSTXDATA
B2:00CCA2 903A9D            MOV      DPTR,#endpoint
B2:00CCA5 E0                MOVX     A,@DPTR
B2:00CCA6 903C25            MOV      DPTR,#?_ReqNodeList?BYTE+06H
B2:00CCA9 F0                MOVX     @DPTR,A
B2:00CCAA 903A9A            MOV      DPTR,#pProfile
B2:00CCAD 122589            LCALL    ?C?PLDXDATA
B2:00CCB0 12C373            LCALL    _ReqNodeList
B2:00CCB3 903AAC            MOV      DPTR,#pTxOptionsEx
B2:00CCB6 1225A9            LCALL    ?C?PSTXDATA
   54:                           &(pTxBuf->grp),
   55:                           endpoint);
   56: 
   57:     if( IS_NULL( pTxOptionsEx ) )
B2:00CCB9 E9                MOV      A,R1
B2:00CCBA 4A                ORL      A,R2
B2:00CCBB 7005              JNZ      ?C0005?COMMANDCLASS
   58:     {
   59:       /*Job failed, free transmit-buffer pTxBuf by cleaning mutex */
   60:       FreeRequestBuffer();
B2:00CCBD 91F6              ACALL    FreeRequestBuffer
   61:       return JOB_STATUS_NO_DESTINATIONS;
B2:00CCBF 7F02              MOV      R7,#02H
B2:00CCC1 22                RET      
   62:     }
B2:00CCC2         ?C0005?COMMANDCLASS:
   63: 
   64:     if(ZW_TX_IN_PROGRESS != ZW_TransportMulticast_SendRequest(
   65:       (BYTE *)pTxBuf,
B2:00CCC2 903AA8            MOV      DPTR,#frame_len
B2:00CCC5 E0                MOVX     A,@DPTR
B2:00CCC6 FD                MOV      R5,A
B2:00CCC7 903AA5            MOV      DPTR,#fSupervisionEnable
B2:00CCCA E0                MOVX     A,@DPTR
B2:00CCCB 903BB5            MOV      DPTR,#?_ZW_TransportMulticast_SendRequest?BYTE+04H
B2:00CCCE F0                MOVX     @DPTR,A
B2:00CCCF 903AAC            MOV      DPTR,#pTxOptionsEx
B2:00CCD2 122589            LCALL    ?C?PLDXDATA
B2:00CCD5 903BB6            MOV      DPTR,#?_ZW_TransportMulticast_SendRequest?BYTE+05H
B2:00CCD8 1225A9            LCALL    ?C?PSTXDATA
B2:00CCDB 903BB9            MOV      DPTR,#?_ZW_TransportMulticast_SendRequest?BYTE+08H
B2:00CCDE B14D              ACALL    ?L?COM0215
B2:00CCE0 903AA9            MOV      DPTR,#pTxBuf
B2:00CCE3 122589            LCALL    ?C?PLDXDATA
B2:00CCE6 128001            LCALL    _ZW_TransportMulticast_SendRequest
B2:00CCE9 EF                MOV      A,R7
B2:00CCEA 6401              XRL      A,#01H
B2:00CCEC 6005              JZ       ?C0003?COMMANDCLASS
   66:       frame_len,
   67:       fSupervisionEnable,
   68:       pTxOptionsEx,
   69:       ZCB_RequestJobStatus))
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 779


   70:     {
   71:       /*Job failed, free transmit-buffer pTxBuf by cleaning mutex */
   72:       FreeRequestBuffer();
B2:00CCEE 91F6              ACALL    FreeRequestBuffer
   73:      return JOB_STATUS_BUSY;
B2:00CCF0 7F01              MOV      R7,#01H
B2:00CCF2 22                RET      
   74:     }
   75:   }
B2:00CCF3         ?C0003?COMMANDCLASS:
   76:   return JOB_STATUS_SUCCESS;
B2:00CCF3 7F00              MOV      R7,#00H
   77: }
B2:00CCF5 22                RET      
----- FUNCTION _cc_engine_multicast_request (END) -------


----- FUNCTION FreeRequestBuffer (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  139: FreeRequestBuffer(void)
  140: {
  141:   ZW_DEBUG_MUTEX_SEND_NL();
  142:   ZW_DEBUG_MUTEX_SEND_STR("FreeRequestBuffer");
  143:   /*Remove application func-callback. User should not be called any more*/
  144:   myMutex.pAppJob = NULL;
B2:00CCF6 E4                CLR      A
B2:00CCF7 902EA5            MOV      DPTR,#myMutex+02H
B2:00CCFA F0                MOVX     @DPTR,A
B2:00CCFB A3                INC      DPTR
B2:00CCFC B101              ACALL    ?L?COM04D4
B2:00CCFE 02A0BE            LJMP     _MutexFree
  145:   /*Free Mutex*/
----- FUNCTION FreeRequestBuffer (END) -------


----- FUNCTION ?L?COM04D4 (BEGIN) -----
B2:00CD01 F0                MOVX     @DPTR,A
B2:00CD02         ?L?COM04D5:
B2:00CD02 7B01              MOV      R3,#01H
B2:00CD04 7A2E              MOV      R2,#HIGH myMutex
B2:00CD06 79A3              MOV      R1,#LOW myMutex
B2:00CD08 22                RET      
----- FUNCTION ?L?COM04D4 (END) -------


----- FUNCTION CC_Version_GetHardwareVersion (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSVERSION.C'
  230: uint8_t CC_Version_GetHardwareVersion(void)
  231: {
  232:   uint8_t hwVersion;
  233:   /* Read hwVersion from NVR.*/
  234:   ZW_NVRGetAppValue(offsetof(NVR_APP_FLASH_STRUCT, hwVersion), 1, &hwVersion );
B2:00CD09 7B01              MOV      R3,#01H
B2:00CD0B 7A43              MOV      R2,#HIGH hwVersion
B2:00CD0D 79AF              MOV      R1,#LOW hwVersion
B2:00CD0F 7D01              MOV      R5,#01H
B2:00CD11 E4                CLR      A
B2:00CD12 FF                MOV      R7,A
B2:00CD13 129405            LCALL    _ZW_NVRGetAppValue
  235:   return hwVersion; /*HW version*/
B2:00CD16 9043AF            MOV      DPTR,#hwVersion
B2:00CD19 E0                MOVX     A,@DPTR
B2:00CD1A FF                MOV      R7,A
  236: }
B2:00CD1B 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 780


----- FUNCTION CC_Version_GetHardwareVersion (END) -------


----- FUNCTION mutex_init (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
   66: mutex_init(void)
   67: {
   68:   memset((BYTE *)&myMutex, 0x00, sizeof(myMutex));
   69: }
B2:00CD1C B102              ACALL    ?L?COM04D5
B2:00CD1E 7D9E              MOV      R5,#09EH
B2:00CD20 E4                CLR      A
B2:00CD21 FF                MOV      R7,A
B2:00CD22 021B65            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION mutex_init (END) -------


----- FUNCTION ?L?COM03D8 (BEGIN) -----
B2:00CD25 122084            LCALL    ?C?CSTOPTR
B2:00CD28         ?L?COM03D9:
B2:00CD28 E9                MOV      A,R1
B2:00CD29 2402              ADD      A,#02H
B2:00CD2B F9                MOV      R1,A
B2:00CD2C E4                CLR      A
B2:00CD2D 3A                ADDC     A,R2
B2:00CD2E FA                MOV      R2,A
B2:00CD2F 22                RET      
----- FUNCTION ?L?COM03D8 (END) -------


----- FUNCTION _Transport_OnApplicationInitSW (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  152: Transport_OnApplicationInitSW(
  153:   APP_NODE_INFORMATION* pAppNode)
;---- Variable 'pAppNode' assigned to Register 'R1/R2/R3' ----
  154: {
  155:   m_AppInfo.u.pNifs = pAppNode;
B2:00CD30 903614            MOV      DPTR,#m_AppInfo
B2:00CD33 1225A9            LCALL    ?C?PSTXDATA
  156: 
  157:   SetupActiveNIF(GetNodeId());
B2:00CD36 1294C3            LCALL    GetNodeId
B2:00CD39 128CB1            LCALL    _SetupActiveNIF
  158: 
  159:   ZW_DEBUG_SECURITY_SEND_STR("SecAppInit ");
  160:   ZW_DEBUG_SECURITY_SEND_NL();
  161: 
  162: #ifndef SERIAL_API_APP
  163:   mutex_init();
B2:00CD3C B11C              ACALL    mutex_init
  164: #endif
  165: 
  166:   return TRUE;
B2:00CD3E 7F01              MOV      R7,#01H
  167: }
B2:00CD40 22                RET      
----- FUNCTION _Transport_OnApplicationInitSW (END) -------


----- FUNCTION ?L?COM0213 (BEGIN) -----
B2:00CD41 122589            LCALL    ?C?PLDXDATA
B2:00CD44         ?L?COM0214:
B2:00CD44 903F06            MOV      DPTR,#?_Transport_SendRequestEP?BYTE+04H
B2:00CD47 1225A9            LCALL    ?C?PSTXDATA
B2:00CD4A 903F09            MOV      DPTR,#?_Transport_SendRequestEP?BYTE+07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 781


B2:00CD4D         ?L?COM0215:
B2:00CD4D 741E              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_RequestJobStatus
B2:00CD4F F0                MOVX     @DPTR,A
B2:00CD50 A3                INC      DPTR
B2:00CD51 748A              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_RequestJobStatus
B2:00CD53 F0                MOVX     @DPTR,A
B2:00CD54 22                RET      
----- FUNCTION ?L?COM0213 (END) -------


----- FUNCTION _CC_Version_SetHostInterfaceVersionInfo (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSVERSION.C'
  238: void CC_Version_SetHostInterfaceVersionInfo(
  239:     uint8_t major,
;---- Variable 'major' assigned to Register 'R7' ----
;---- Variable 'patch' assigned to Register 'R3' ----
;---- Variable 'minor' assigned to Register 'R5' ----
  240:     uint8_t minor,
  241:     uint8_t patch,
  242:     uint16_t build_number)
  243: {
  244:   hostInterfaceVersionInfo.major = major;
B2:00CD55 903E47            MOV      DPTR,#hostInterfaceVersionInfo
B2:00CD58 124765            LCALL    ?L?COM0102
B2:00CD5B EB                MOV      A,R3
B2:00CD5C F0                MOVX     @DPTR,A
  245:   hostInterfaceVersionInfo.minor = minor;
  246:   hostInterfaceVersionInfo.patch = patch;
  247:   hostInterfaceVersionInfo.build_number = build_number;
B2:00CD5D 9041D9            MOV      DPTR,#build_number
B2:00CD60 E0                MOVX     A,@DPTR
B2:00CD61 FF                MOV      R7,A
B2:00CD62 A3                INC      DPTR
B2:00CD63 E0                MOVX     A,@DPTR
B2:00CD64 903E4A            MOV      DPTR,#hostInterfaceVersionInfo+03H
B2:00CD67 CF                XCH      A,R7
B2:00CD68 F0                MOVX     @DPTR,A
B2:00CD69 A3                INC      DPTR
B2:00CD6A EF                MOV      A,R7
B2:00CD6B F0                MOVX     @DPTR,A
  248: }
B2:00CD6C 22                RET      
----- FUNCTION _CC_Version_SetHostInterfaceVersionInfo (END) -------


----- FUNCTION _ZCB_RequestJobStatus (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  122: PCB(ZCB_RequestJobStatus)(TRANSMISSION_RESULT * pTransmissionResult)
  123: {
B2:00CD6D 904315            MOV      DPTR,#pTransmissionResult
B2:00CD70 1225A9            LCALL    ?C?PSTXDATA
  124:   ZW_DEBUG_MUTEX_SEND_NL();
  125:   ZW_DEBUG_MUTEX_SEND_STR("ZCB_RequestJobStatus");
  126:   if(NON_NULL( myMutex.pAppJob ))
B2:00CD73 902EA5            MOV      DPTR,#myMutex+02H
B2:00CD76 1296A4            LCALL    ?L?COM0137
B2:00CD79 6009              JZ       ?C0010?ZW_TX_MUTEX
  127:   {
  128:     myMutex.pAppJob(pTransmissionResult);
B2:00CD7B 904315            MOV      DPTR,#pTransmissionResult
B2:00CD7E 122589            LCALL    ?C?PLDXDATA
B2:00CD81 12B449            LCALL    ?L?COM0364
  129:   }
B2:00CD84         ?C0010?ZW_TX_MUTEX:
  130: 
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 782


  131:   if (TRANSMISSION_RESULT_FINISHED == pTransmissionResult->isFinished)
B2:00CD84 904315            MOV      DPTR,#pTransmissionResult
B2:00CD87 128F3E            LCALL    ?L?COM0029
B2:00CD8A B40102            CJNE     A,#01H,?C0012?ZW_TX_MUTEX
  132:   {
  133:     ZW_DEBUG_MUTEX_SEND_STR(" _FREE!_");
  134:     FreeRequestBuffer();
B2:00CD8D 91F6              ACALL    FreeRequestBuffer
  135:   }
  136: }
B2:00CD8F         ?C0012?ZW_TX_MUTEX:
B2:00CD8F 22                RET      
----- FUNCTION _ZCB_RequestJobStatus (END) -------


----- FUNCTION _CC_Version_SetApplicationVersionInfo (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSVERSION.C'
  250: void CC_Version_SetApplicationVersionInfo(
  251:     uint8_t major,
;---- Variable 'major' assigned to Register 'R7' ----
;---- Variable 'patch' assigned to Register 'R3' ----
;---- Variable 'minor' assigned to Register 'R5' ----
  252:     uint8_t minor,
  253:     uint8_t patch,
  254:     uint16_t build_number)
  255: {
  256:   applicationVersionInfo.major = major;
B2:00CD90 903E42            MOV      DPTR,#applicationVersionInfo
B2:00CD93 124765            LCALL    ?L?COM0102
B2:00CD96 EB                MOV      A,R3
B2:00CD97 F0                MOVX     @DPTR,A
  257:   applicationVersionInfo.minor = minor;
  258:   applicationVersionInfo.patch = patch;
  259:   applicationVersionInfo.build_number = build_number;
B2:00CD98 9041DE            MOV      DPTR,#build_number
B2:00CD9B E0                MOVX     A,@DPTR
B2:00CD9C FF                MOV      R7,A
B2:00CD9D A3                INC      DPTR
B2:00CD9E E0                MOVX     A,@DPTR
B2:00CD9F 903E45            MOV      DPTR,#applicationVersionInfo+03H
B2:00CDA2 CF                XCH      A,R7
B2:00CDA3 F0                MOVX     @DPTR,A
B2:00CDA4 A3                INC      DPTR
B2:00CDA5 EF                MOV      A,R7
B2:00CDA6 F0                MOVX     @DPTR,A
  260: }
B2:00CDA7 22                RET      
----- FUNCTION _CC_Version_SetApplicationVersionInfo (END) -------


----- FUNCTION _ZCB_SendTestDone (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  133: PCB(ZCB_SendTestDone) (uint8_t bStatus, TX_STATUS_TYPE *txStatusReport)
  134: {
;---- Variable 'bStatus' assigned to Register 'R7' ----
  135:   UNUSED(txStatusReport);
  136: 
  137:   if (bStatus == TRANSMIT_COMPLETE_OK)
B2:00CDA8 EF                MOV      A,R7
B2:00CDA9 7006              JNZ      ?C0004?COMMANDCLASSPOWERLEVEL
  138:   {
  139:     testFrameSuccessCount++;
B2:00CDAB 903DD3            MOV      DPTR,#testFrameSuccessCount
B2:00CDAE 123F80            LCALL    ?L?COM0082
  140:   }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 783


B2:00CDB1         ?C0004?COMMANDCLASSPOWERLEVEL:
  141: 
  142:   if (0 != DelayTestFrameHandle)
B2:00CDB1 903DDA            MOV      DPTR,#DelayTestFrameHandle
B2:00CDB4 E0                MOVX     A,@DPTR
B2:00CDB5 FF                MOV      R7,A
B2:00CDB6 6003              JZ       ?C0005?COMMANDCLASSPOWERLEVEL
  143:   {
  144:     TimerCancel(DelayTestFrameHandle);
B2:00CDB8 124465            LCALL    _TimerCancel
  145:   }
B2:00CDBB         ?C0005?COMMANDCLASSPOWERLEVEL:
  146: 
  147:   if (testFrameCount && (--testFrameCount))
B2:00CDBB 903DD5            MOV      DPTR,#testFrameCount
B2:00CDBE E0                MOVX     A,@DPTR
B2:00CDBF 7002              JNZ      ?C0048?COMMANDCLASSPOWERLEVEL
B2:00CDC1 A3                INC      DPTR
B2:00CDC2 E0                MOVX     A,@DPTR
B2:00CDC3         ?C0048?COMMANDCLASSPOWERLEVEL:
B2:00CDC3 6010              JZ       ?C0006?COMMANDCLASSPOWERLEVEL
B2:00CDC5 903DD5            MOV      DPTR,#testFrameCount
B2:00CDC8 1272FA            LCALL    ?L?COM049B
B2:00CDCB 45F0              ORL      A,B
B2:00CDCD 6006              JZ       ?C0006?COMMANDCLASSPOWERLEVEL
  148:   {
  149:     DelayTestFrameHandle = TimerStart(ZCB_DelayTestFrame, 4, TIMER_ONE_TIME);
B2:00CDCF B1F8              ACALL    ?L?COM03C4
  150:     if ((uint8_t)-1 == DelayTestFrameHandle)
B2:00CDD1 BFFF23            CJNE     R7,#0FFH,?C0011?COMMANDCLASSPOWERLEVEL
  151:     {
  152:     }
  153:   }
B2:00CDD4 22                RET      
B2:00CDD5         ?C0006?COMMANDCLASSPOWERLEVEL:
  154:   else
  155:   {
  156:     if (testFrameSuccessCount)
B2:00CDD5 903DD3            MOV      DPTR,#testFrameSuccessCount
B2:00CDD8 E0                MOVX     A,@DPTR
B2:00CDD9 7002              JNZ      ?C0049?COMMANDCLASSPOWERLEVEL
B2:00CDDB A3                INC      DPTR
B2:00CDDC E0                MOVX     A,@DPTR
B2:00CDDD         ?C0049?COMMANDCLASSPOWERLEVEL:
B2:00CDDD 6008              JZ       ?C0009?COMMANDCLASSPOWERLEVEL
  157:     {
  158:       testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_SUCCES;
B2:00CDDF 903DD7            MOV      DPTR,#testState
B2:00CDE2 7401              MOV      A,#01H
B2:00CDE4 F0                MOVX     @DPTR,A
  159:     }
B2:00CDE5 8005              SJMP     ?C0010?COMMANDCLASSPOWERLEVEL
B2:00CDE7         ?C0009?COMMANDCLASSPOWERLEVEL:
  160:     else
  161:     {
  162:       testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_FAILED;
B2:00CDE7 E4                CLR      A
B2:00CDE8 903DD7            MOV      DPTR,#testState
B2:00CDEB F0                MOVX     @DPTR,A
  163:     }
B2:00CDEC         ?C0010?COMMANDCLASSPOWERLEVEL:
  164:     ZW_RFPowerLevelSet(currentPower); /* Back to previous setting */
B2:00CDEC 903DD2            MOV      DPTR,#currentPower
B2:00CDEF E0                MOVX     A,@DPTR
B2:00CDF0 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 784


B2:00CDF1 12582A            LCALL    _ZW_RFPowerLevelSet
  165:     SendTestReport();
B2:00CDF4 128601            LCALL    SendTestReport
  166:   }
  167: }
B2:00CDF7         ?C0011?COMMANDCLASSPOWERLEVEL:
B2:00CDF7 22                RET      
----- FUNCTION _ZCB_SendTestDone (END) -------


----- FUNCTION ?L?COM03C4 (BEGIN) -----
B2:00CDF8 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_DelayTestFrame
B2:00CDFA 7F62              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_DelayTestFrame
B2:00CDFC E4                CLR      A
B2:00CDFD FB                MOV      R3,A
B2:00CDFE 7D04              MOV      R5,#04H
B2:00CE00 124FFF            LCALL    _TimerStart
B2:00CE03 903DDA            MOV      DPTR,#DelayTestFrameHandle
B2:00CE06 EF                MOV      A,R7
B2:00CE07 F0                MOVX     @DPTR,A
B2:00CE08 22                RET      
----- FUNCTION ?L?COM03C4 (END) -------


----- FUNCTION PowerLevelTimerCancel (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  172: void PowerLevelTimerCancel(void)
  173: {
  174:   ZW_TimerLongCancel(timerPowerLevelHandle);
  175:   timerPowerLevelHandle = 0;
B2:00CE09 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:00CE0C E0                MOVX     A,@DPTR
B2:00CE0D FF                MOV      R7,A
B2:00CE0E 1247B1            LCALL    _ZW_TimerLongCancel
  176: }
B2:00CE11 E4                CLR      A
B2:00CE12 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:00CE15 F0                MOVX     @DPTR,A
  177: 
B2:00CE16 22                RET      
----- FUNCTION PowerLevelTimerCancel (END) -------


----- FUNCTION ZCB_PowerLevelTimeout (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  182: PCB(ZCB_PowerLevelTimeout) (void)
  183: {
  184:   ZW_RFPowerLevelSet(normalPower); /* Reset powerlevel to normalPower */
  185:   PowerLevelTimerCancel();
B2:00CE17 E4                CLR      A
B2:00CE18 FF                MOV      R7,A
B2:00CE19 12582A            LCALL    _ZW_RFPowerLevelSet
  186: }
B2:00CE1C 80EB              SJMP     PowerLevelTimerCancel
----- FUNCTION ZCB_PowerLevelTimeout (END) -------


----- FUNCTION StartTest (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  194: static void StartTest(void)
  195: {
  196:   testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_INPROGRESS;
  197:   currentPower = ZW_RFPowerLevelGet();
B2:00CE1E 903DD7            MOV      DPTR,#testState
B2:00CE21 7402              MOV      A,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 785


B2:00CE23 F0                MOVX     @DPTR,A
  198:   ZW_RFPowerLevelSet(testPowerLevel);
B2:00CE24 125824            LCALL    ZW_RFPowerLevelGet
B2:00CE27 903DD2            MOV      DPTR,#currentPower
B2:00CE2A EF                MOV      A,R7
B2:00CE2B F0                MOVX     @DPTR,A
  199:   DelayTestFrameHandle = TimerStart(ZCB_DelayTestFrame, 4, TIMER_ONE_TIME);
B2:00CE2C 903DD9            MOV      DPTR,#testPowerLevel
B2:00CE2F E0                MOVX     A,@DPTR
B2:00CE30 FF                MOV      R7,A
B2:00CE31 12582A            LCALL    _ZW_RFPowerLevelSet
  200: }
B2:00CE34 80C2              SJMP     ?L?COM03C4
----- FUNCTION StartTest (END) -------


----- FUNCTION IsPowerLevelTimerActive (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  202: static BOOL IsPowerLevelTimerActive(void)
  203: {
  204:   if ((0 != timerPowerLevelHandle) && (0xFF != timerPowerLevelHandle))
  205:   {
B2:00CE36 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:00CE39 E0                MOVX     A,@DPTR
B2:00CE3A 6005              JZ       ?C0015?COMMANDCLASSPOWERLEVEL
B2:00CE3C F4                CPL      A
B2:00CE3D 6002              JZ       ?C0015?COMMANDCLASSPOWERLEVEL
  206:     return TRUE;
  207:   }
B2:00CE3F D3                SETB     C
B2:00CE40 22                RET      
  208:   return FALSE;
B2:00CE41         ?C0015?COMMANDCLASSPOWERLEVEL:
  209: }
B2:00CE41 C3                CLR      C
  210: 
B2:00CE42 22                RET      
----- FUNCTION IsPowerLevelTimerActive (END) -------


----- FUNCTION _CmdClassBasicReportSend (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSBASIC.C'
   93: CmdClassBasicReportSend(
   94:   AGI_PROFILE* pProfile,
B2:00CE43 903EDE            MOV      DPTR,#pProfile
B2:00CE46 1225A9            LCALL    ?C?PSTXDATA
B2:00CE49 903EE1            MOV      DPTR,#sourceEndpoint
B2:00CE4C ED                MOV      A,R5
B2:00CE4D F0                MOVX     @DPTR,A
   95:   BYTE sourceEndpoint,
   96:   BYTE bValue,
   97:   VOID_CALLBACKFUNC(pCbFunc)(TRANSMISSION_RESULT * pTransmissionResult))
   98: {
   99:   CMD_CLASS_GRP cmdGrp = {COMMAND_CLASS_BASIC, BASIC_REPORT};
B2:00CE4E 78E5              MOV      R0,#LOW cmdGrp
B2:00CE50 7C3E              MOV      R4,#HIGH cmdGrp
B2:00CE52 7D01              MOV      R5,#01H
B2:00CE54 7BFF              MOV      R3,#0FFH
B2:00CE56 7A32              MOV      R2,#HIGH _?ix1000
B2:00CE58 799B              MOV      R1,#LOW _?ix1000
B2:00CE5A 12C48B            LCALL    ?L?COM0167
  100: 
  101:   return cc_engine_multicast_request(
B2:00CE5D 903EE1            MOV      DPTR,#sourceEndpoint
B2:00CE60 7A3E              MOV      R2,#HIGH cmdGrp
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 786


B2:00CE62 79E5              MOV      R1,#LOW cmdGrp
B2:00CE64 D194              ACALL    ?L?COM05F2
B2:00CE66 1225A9            LCALL    ?C?PSTXDATA
B2:00CE69 7A3E              MOV      R2,#HIGH bValue
B2:00CE6B 79E2              MOV      R1,#LOW bValue
B2:00CE6D D1E2              ACALL    ?L?COM03E5
B2:00CE6F 903EE3            MOV      DPTR,#pCbFunc
B2:00CE72 D1D5              ACALL    ?L?COM032E
B2:00CE74 903EDE            MOV      DPTR,#pProfile
B2:00CE77 122589            LCALL    ?C?PLDXDATA
B2:00CE7A 8117              AJMP     _cc_engine_multicast_request
  102:       pProfile,
  103:       sourceEndpoint,
  104:       &cmdGrp,
  105:       &bValue,
  106:       1,
  107:       TRUE,
  108:       pCbFunc);
----- FUNCTION _CmdClassBasicReportSend (END) -------


----- FUNCTION loadInitStatusPowerLevel (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  228: void loadInitStatusPowerLevel(void)
  229: {
  230: 
  231:   testNodeID = 0;
B2:00CE7C E4                CLR      A
B2:00CE7D 903DDB            MOV      DPTR,#testNodeID
B2:00CE80 F0                MOVX     @DPTR,A
  232:   testPowerLevel = 0;
B2:00CE81 903DD9            MOV      DPTR,#testPowerLevel
B2:00CE84 F0                MOVX     @DPTR,A
  233:   testFrameCount = 0;
B2:00CE85 903DD5            MOV      DPTR,#testFrameCount
B2:00CE88 F0                MOVX     @DPTR,A
B2:00CE89 A3                INC      DPTR
B2:00CE8A F0                MOVX     @DPTR,A
  234:   testSourceNodeID = 0;
B2:00CE8B 903DD8            MOV      DPTR,#testSourceNodeID
B2:00CE8E F0                MOVX     @DPTR,A
  235:   testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_FAILED;
B2:00CE8F 903DD7            MOV      DPTR,#testState
B2:00CE92 F0                MOVX     @DPTR,A
  236: }
B2:00CE93 22                RET      
----- FUNCTION loadInitStatusPowerLevel (END) -------


----- FUNCTION ?L?COM05F2 (BEGIN) -----
B2:00CE94 E0                MOVX     A,@DPTR
B2:00CE95 FD                MOV      R5,A
B2:00CE96 7B01              MOV      R3,#01H
B2:00CE98 903A9E            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+04H
B2:00CE9B 22                RET      
----- FUNCTION ?L?COM05F2 (END) -------


----- FUNCTION _CmdClassBinarySwitchReportSendUnsolicited (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSBINARYSWITCH.C'
  113: JOB_STATUS CmdClassBinarySwitchReportSendUnsolicited(
  114:   AGI_PROFILE* pProfile,
B2:00CE9C 903EE7            MOV      DPTR,#pProfile
B2:00CE9F 1225A9            LCALL    ?C?PSTXDATA
B2:00CEA2 903EEA            MOV      DPTR,#sourceEndpoint
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 787


B2:00CEA5 ED                MOV      A,R5
B2:00CEA6 F0                MOVX     @DPTR,A
  115:   BYTE sourceEndpoint,
  116:   CMD_CLASS_BIN_SW_VAL bValue,
  117:   VOID_CALLBACKFUNC(pCbFunc)(TRANSMISSION_RESULT * pTransmissionResult))
  118: {
  119:   CMD_CLASS_GRP cmdGrp = {COMMAND_CLASS_SWITCH_BINARY, SWITCH_BINARY_REPORT};
B2:00CEA7 78EE              MOV      R0,#LOW cmdGrp
B2:00CEA9 7C3E              MOV      R4,#HIGH cmdGrp
B2:00CEAB 7D01              MOV      R5,#01H
B2:00CEAD 7BFF              MOV      R3,#0FFH
B2:00CEAF 7A32              MOV      R2,#HIGH _?ix1000
B2:00CEB1 799D              MOV      R1,#LOW _?ix1000
B2:00CEB3 12C48B            LCALL    ?L?COM0167
  120: 
  121:   return cc_engine_multicast_request(
  122:       pProfile,
  123:       sourceEndpoint,
  124:       &cmdGrp,
  125:       (uint8_t *)&bValue,
B2:00CEB6 903EEA            MOV      DPTR,#sourceEndpoint
B2:00CEB9 7A3E              MOV      R2,#HIGH cmdGrp
B2:00CEBB 79EE              MOV      R1,#LOW cmdGrp
B2:00CEBD D194              ACALL    ?L?COM05F2
B2:00CEBF 1225A9            LCALL    ?C?PSTXDATA
B2:00CEC2 7A3E              MOV      R2,#HIGH bValue
B2:00CEC4 79EB              MOV      R1,#LOW bValue
B2:00CEC6 D1E2              ACALL    ?L?COM03E5
B2:00CEC8 903EEC            MOV      DPTR,#pCbFunc
B2:00CECB D1D5              ACALL    ?L?COM032E
B2:00CECD 903EE7            MOV      DPTR,#pProfile
B2:00CED0 122589            LCALL    ?C?PLDXDATA
B2:00CED3 8117              AJMP     _cc_engine_multicast_request
  126:       1,
  127:       TRUE,
  128:       pCbFunc);
----- FUNCTION _CmdClassBinarySwitchReportSendUnsolicited (END) -------


----- FUNCTION ?L?COM032E (BEGIN) -----
B2:00CED5 E0                MOVX     A,@DPTR
B2:00CED6 FF                MOV      R7,A
B2:00CED7 A3                INC      DPTR
B2:00CED8 E0                MOVX     A,@DPTR
B2:00CED9 903AA6            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+0CH
B2:00CEDC CF                XCH      A,R7
B2:00CEDD F0                MOVX     @DPTR,A
B2:00CEDE A3                INC      DPTR
B2:00CEDF EF                MOV      A,R7
B2:00CEE0 F0                MOVX     @DPTR,A
B2:00CEE1 22                RET      
----- FUNCTION ?L?COM032E (END) -------


----- FUNCTION ?L?COM03E5 (BEGIN) -----
B2:00CEE2 903AA1            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+07H
B2:00CEE5 1225A9            LCALL    ?C?PSTXDATA
B2:00CEE8 903AA4            MOV      DPTR,#?_cc_engine_multicast_request?BYTE+0AH
B2:00CEEB 7401              MOV      A,#01H
B2:00CEED F0                MOVX     @DPTR,A
B2:00CEEE A3                INC      DPTR
B2:00CEEF F0                MOVX     @DPTR,A
B2:00CEF0 22                RET      
----- FUNCTION ?L?COM03E5 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 788



----- FUNCTION CC_Powerlevel_isInProgress (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSPOWERLEVEL.C'
  395: CC_Powerlevel_isInProgress(void)
  396: {
  397:   return (((POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_INPROGRESS == testState) ||
  398:       ((0xFF > timerPowerLevelHandle) && (0 < timerPowerLevelHandle))) ? TRUE : FALSE);
B2:00CEF1 903DD7            MOV      DPTR,#testState
B2:00CEF4 E0                MOVX     A,@DPTR
B2:00CEF5 6402              XRL      A,#02H
B2:00CEF7 600F              JZ       ?C0046?COMMANDCLASSPOWERLEVEL
B2:00CEF9 903DD1            MOV      DPTR,#timerPowerLevelHandle
B2:00CEFC E0                MOVX     A,@DPTR
B2:00CEFD FF                MOV      R7,A
B2:00CEFE 74FF              MOV      A,#0FFH
B2:00CF00 D3                SETB     C
B2:00CF01 9F                SUBB     A,R7
B2:00CF02 4007              JC       ?C0044?COMMANDCLASSPOWERLEVEL
B2:00CF04 E4                CLR      A
B2:00CF05 9F                SUBB     A,R7
B2:00CF06 5003              JNC      ?C0044?COMMANDCLASSPOWERLEVEL
B2:00CF08         ?C0046?COMMANDCLASSPOWERLEVEL:
B2:00CF08 D3                SETB     C
B2:00CF09 8001              SJMP     ?C0045?COMMANDCLASSPOWERLEVEL
B2:00CF0B         ?C0044?COMMANDCLASSPOWERLEVEL:
B2:00CF0B C3                CLR      C
B2:00CF0C         ?C0045?COMMANDCLASSPOWERLEVEL:
  399: }
B2:00CF0C 22                RET      
----- FUNCTION CC_Powerlevel_isInProgress (END) -------


----- FUNCTION SendAssoGroupInfoReport (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSASSOCIATIONGROUPINFO.C'
   69: static BOOL SendAssoGroupInfoReport(void)
   70: {
   71:   ZW_APPLICATION_TX_BUFFER *pTxBuf = NULL;
   72:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX *txOptionsEx;
B2:00CF0D 12B299            LCALL    ?L?COM0069
B2:00CF10 904150            MOV      DPTR,#pTxBuf
B2:00CF13 1225A9            LCALL    ?C?PSTXDATA
   73: 
   74:   pTxBuf = GetResponseBufferCb(ZCB_AGIReport);
B2:00CF16 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_AGIReport
B2:00CF18 7F6C              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_AGIReport
B2:00CF1A 129A8F            LCALL    _GetResponseBufferCb
B2:00CF1D 904150            MOV      DPTR,#pTxBuf
B2:00CF20 1225A9            LCALL    ?C?PSTXDATA
   75: 
   76:   /*Check pTxBuf is free*/
   77:   if (IS_NULL( pTxBuf ))
B2:00CF23 E9                MOV      A,R1
B2:00CF24 4A                ORL      A,R2
B2:00CF25 7002              JNZ      ?C0001?COMMANDCLASSASSOCIATIONGROUPINFO
   78:   {
   79:     return FALSE;
B2:00CF27 C3                CLR      C
B2:00CF28 22                RET      
   80:   }
B2:00CF29         ?C0001?COMMANDCLASSASSOCIATIONGROUPINFO:
   81: 
   82:   memset((uint8_t *)pTxBuf, 0, sizeof(ZW_ASSOCIATION_GROUP_INFO_REPORT_1BYTE_FRAME));
B2:00CF29 F191              ACALL    ?L?COM0594
B2:00CF2B 1271C2            LCALL    ?L?COM036D
B2:00CF2E 7A41              MOV      R2,#HIGH txOptionsEx
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 789


B2:00CF30 7953              MOV      R1,#LOW txOptionsEx
B2:00CF32 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00CF35 1225A9            LCALL    ?C?PSTXDATA
B2:00CF38 7A3E              MOV      R2,#HIGH rxOptions
B2:00CF3A 79D8              MOV      R1,#LOW rxOptions
B2:00CF3C 12ACFF            LCALL    _RxToTxOptions
   83: 
   84:   RxToTxOptions(&rxOptions, &txOptionsEx);
   85: 
   86:   pTxBuf->ZW_AssociationGroupInfoReport1byteFrame.cmdClass = COMMAND_CLASS_ASSOCIATION_GRP_INFO;
B2:00CF3F 904150            MOV      DPTR,#pTxBuf
B2:00CF42 F19D              ACALL    ?L?COM03C3
   87:   pTxBuf->ZW_AssociationGroupInfoReport1byteFrame.cmd      = ASSOCIATION_GROUP_INFO_REPORT;
B2:00CF44 904150            MOV      DPTR,#pTxBuf
B2:00CF47 12A5A3            LCALL    ?L?COM001F
B2:00CF4A 7404              MOV      A,#04H
B2:00CF4C 122084            LCALL    ?C?CSTOPTR
   88:   // If thelist mode bit is set in the get frame it should be also set in the report frame.
   89:   pTxBuf->ZW_AssociationGroupInfoReport1byteFrame.properties1 = ((REPORT_STATUS_ALL_GROUPS == reportStatus) ? ASS
>> OCIATION_GROUP_INFO_REPORT_PROPERTIES1_LIST_MODE_BIT_MASK : 0x00) & 0xFF; // we send one report per group
B2:00CF4F 903ED5            MOV      DPTR,#reportStatus
B2:00CF52 E0                MOVX     A,@DPTR
B2:00CF53 7F00              MOV      R7,#00H
B2:00CF55 B40202            CJNE     A,#02H,?C0003?COMMANDCLASSASSOCIATIONGROUPINFO
B2:00CF58 7F80              MOV      R7,#080H
B2:00CF5A         ?C0003?COMMANDCLASSASSOCIATIONGROUPINFO:
B2:00CF5A         ?C0004?COMMANDCLASSASSOCIATIONGROUPINFO:
B2:00CF5A EF                MOV      A,R7
B2:00CF5B F1D2              ACALL    ?L?COM0369
   90:   pTxBuf->ZW_AssociationGroupInfoReport1byteFrame.properties1 |= 0x01; // One report pr. group.
B2:00CF5D E9                MOV      A,R1
B2:00CF5E 2402              ADD      A,#02H
B2:00CF60 125510            LCALL    ?L?COM000B
B2:00CF63 4401              ORL      A,#01H
B2:00CF65 122072            LCALL    ?C?CSTPTR
   91: 
   92:   CC_AGI_groupInfoGet_handler(
B2:00CF68 903ED7            MOV      DPTR,#currentGroupId
B2:00CF6B E0                MOVX     A,@DPTR
B2:00CF6C FF                MOV      R7,A
B2:00CF6D 903EDD            MOV      DPTR,#rxOptions+05H
B2:00CF70 E0                MOVX     A,@DPTR
B2:00CF71 547F              ANL      A,#07FH
B2:00CF73 FD                MOV      R5,A
B2:00CF74 904150            MOV      DPTR,#pTxBuf
B2:00CF77 12B27A            LCALL    ?L?COM0088
B2:00CF7A 12C782            LCALL    _CC_AGI_groupInfoGet_handler
   93:       currentGroupId,
   94:       rxOptions.destNode.endpoint,
   95:       &pTxBuf->ZW_AssociationGroupInfoReport1byteFrame.variantgroup1);
   96: 
   97:   if (ZW_TX_IN_PROGRESS != Transport_SendResponseEP( (uint8_t *)pTxBuf,
B2:00CF7D 904153            MOV      DPTR,#txOptionsEx
B2:00CF80 12A147            LCALL    ?L?COM001D
B2:00CF83 F191              ACALL    ?L?COM0594
B2:00CF85 12A13D            LCALL    ?L?COM00BD
B2:00CF88 6005              JZ       ?C0005?COMMANDCLASSASSOCIATIONGROUPINFO
   98:               sizeof(ZW_ASSOCIATION_GROUP_INFO_REPORT_1BYTE_FRAME),
   99:               txOptionsEx,
  100:               ZCB_ResponseJobStatus))
  101:   {
  102:     /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  103:     FreeResponseBuffer();
B2:00CF8A 12A0B6            LCALL    FreeResponseBuffer
  104:     return FALSE;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 790


B2:00CF8D C3                CLR      C
B2:00CF8E 22                RET      
  105:   }
B2:00CF8F         ?C0005?COMMANDCLASSASSOCIATIONGROUPINFO:
  106:   return TRUE;
B2:00CF8F D3                SETB     C
  107: }
B2:00CF90 22                RET      
----- FUNCTION SendAssoGroupInfoReport (END) -------


----- FUNCTION ?L?COM0594 (BEGIN) -----
B2:00CF91 904150            MOV      DPTR,#pTxBuf
B2:00CF94 122589            LCALL    ?C?PLDXDATA
B2:00CF97 7D0A              MOV      R5,#0AH
B2:00CF99 22                RET      
----- FUNCTION ?L?COM0594 (END) -------


----- FUNCTION ?L?COM03C2 (BEGIN) -----
B2:00CF9A 903BEF            MOV      DPTR,#pTxBuf
B2:00CF9D         ?L?COM03C3:
B2:00CF9D 122589            LCALL    ?C?PLDXDATA
B2:00CFA0 7459              MOV      A,#059H
B2:00CFA2 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM03C2 (END) -------


----- FUNCTION ZCB_AGIReportSendTimer (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSASSOCIATIONGROUPINFO.C'
  114: PCB(ZCB_AGIReportSendTimer)(void)
  115: {
  116:   SendAssoGroupInfoReport();
  117: }
B2:00CFA5 E10D              AJMP     SendAssoGroupInfoReport
----- FUNCTION ZCB_AGIReportSendTimer (END) -------


----- FUNCTION _ZCB_AGIReport (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSASSOCIATIONGROUPINFO.C'
  122: PCB(ZCB_AGIReport)(uint8_t txStatus)
  123: {
  124:   UNUSED(txStatus);
  125:   if (reportStatus == REPORT_STATUS_ALL_GROUPS)
  126:   {
B2:00CFA7 903ED5            MOV      DPTR,#reportStatus
B2:00CFAA E0                MOVX     A,@DPTR
B2:00CFAB B4021D            CJNE     A,#02H,?C0007?COMMANDCLASSASSOCIATIONGROUPINFO
  127:     if (currentGroupId++ < CC_AGI_groupCount_handler(associationGroupInfoGetEndpoint))
  128:     {
B2:00CFAE A3                INC      DPTR
B2:00CFAF E0                MOVX     A,@DPTR
B2:00CFB0 FF                MOV      R7,A
B2:00CFB1 12B59D            LCALL    _CC_AGI_groupCount_handler
B2:00CFB4 903ED7            MOV      DPTR,#currentGroupId
B2:00CFB7 E0                MOVX     A,@DPTR
B2:00CFB8 FE                MOV      R6,A
B2:00CFB9 04                INC      A
B2:00CFBA F0                MOVX     @DPTR,A
B2:00CFBB EE                MOV      A,R6
B2:00CFBC C3                CLR      C
B2:00CFBD 9F                SUBB     A,R7
B2:00CFBE 500B              JNC      ?C0007?COMMANDCLASSASSOCIATIONGROUPINFO
  129:       TimerStart(ZCB_AGIReportSendTimer, 1, TIMER_ONE_TIME);
  130:       return;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 791


B2:00CFC0 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_AGIReportSendTimer
B2:00CFC2 7F67              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_AGIReportSendTimer
B2:00CFC4 E4                CLR      A
B2:00CFC5 FB                MOV      R3,A
B2:00CFC6 7D01              MOV      R5,#01H
B2:00CFC8 024FFF            LJMP     _TimerStart
  131:     }
  132:   }
B2:00CFCB         ?C0007?COMMANDCLASSASSOCIATIONGROUPINFO:
  133:   reportStatus = REPORT_STATUS_INACTIVE;
B2:00CFCB E4                CLR      A
B2:00CFCC 903ED5            MOV      DPTR,#reportStatus
B2:00CFCF F0                MOVX     @DPTR,A
  134: }
B2:00CFD0 22                RET      
----- FUNCTION _ZCB_AGIReport (END) -------


----- FUNCTION ?L?COM0368 (BEGIN) -----
B2:00CFD1 E0                MOVX     A,@DPTR
B2:00CFD2         ?L?COM0369:
B2:00CFD2 900002            MOV      DPTR,#02H
B2:00CFD5 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0368 (END) -------


----- FUNCTION _CommandClassSupervisionGetWrite (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
  313: void CommandClassSupervisionGetWrite(ZW_SUPERVISION_GET_FRAME* pbuf)
  314: {
B2:00CFD8 90432D            MOV      DPTR,#pbuf
B2:00CFDB 1225A9            LCALL    ?C?PSTXDATA
  315:   pbuf->cmdClass =  COMMAND_CLASS_SUPERVISION;
  316:   pbuf->cmd = SUPERVISION_GET;
B2:00CFDE 90432D            MOV      DPTR,#pbuf
B2:00CFE1 122589            LCALL    ?C?PLDXDATA
B2:00CFE4 746C              MOV      A,#06CH
B2:00CFE6 122072            LCALL    ?C?CSTPTR
  317:   pbuf->properties1 = CC_SUPERVISION_ADD_SESSION_ID(m_sessionId);
B2:00CFE9 90432D            MOV      DPTR,#pbuf
B2:00CFEC 12A5A3            LCALL    ?L?COM001F
B2:00CFEF 7401              MOV      A,#01H
B2:00CFF1 122084            LCALL    ?C?CSTOPTR
  318:   pbuf->properties1 |= CC_SUPERVISION_ADD_STATUS_UPDATE(m_status_updates);
B2:00CFF4 903D99            MOV      DPTR,#m_sessionId
B2:00CFF7 E0                MOVX     A,@DPTR
B2:00CFF8 543F              ANL      A,#03FH
B2:00CFFA F1D2              ACALL    ?L?COM0369
  319:   pbuf->encapsulatedCommandLength = m_CommandLength;
B2:00CFFC E9                MOV      A,R1
B2:00CFFD 2402              ADD      A,#02H
B2:00CFFF 125510            LCALL    ?L?COM000B
B2:00D002 FF                MOV      R7,A
B2:00D003 903DA2            MOV      DPTR,#m_status_updates
B2:00D006 E0                MOVX     A,@DPTR
B2:00D007 12B61D            LCALL    ?L?COM01AB
B2:00D00A 4F                ORL      A,R7
B2:00D00B 122072            LCALL    ?C?CSTPTR
  320: }
B2:00D00E 903DA3            MOV      DPTR,#m_CommandLength
B2:00D011 E0                MOVX     A,@DPTR
B2:00D012 FF                MOV      R7,A
B2:00D013 90432D            MOV      DPTR,#pbuf
B2:00D016 12B57F            LCALL    ?L?COM00E6
B2:00D019 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 792


B2:00D01A 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _CommandClassSupervisionGetWrite (END) -------


----- FUNCTION ManufacturerSpecificDeviceIDInit (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSMANUFACTURERSPECIFIC.C'
  113: ManufacturerSpecificDeviceIDInit(void)
  114: {
  115:  /*Read UUID from NVR*/
  116:   ZW_NVRGetValue(offsetof(NVR_FLASH_STRUCT, abUUID), MAN_DEVICE_ID_SIZE, manSpecificDeviceID);
B2:00D01D 7B01              MOV      R3,#01H
B2:00D01F 7A3F              MOV      R2,#HIGH manSpecificDeviceID
B2:00D021 79FC              MOV      R1,#LOW manSpecificDeviceID
B2:00D023 7D08              MOV      R5,#08H
B2:00D025 7F0D              MOV      R7,#0DH
B2:00D027 021C0F            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION ManufacturerSpecificDeviceIDInit (END) -------


----- FUNCTION _CommandClassZWavePlusInfoInit (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSZWAVEPLUSINFO.C'
   73: CommandClassZWavePlusInfoInit(ST_ENDPOINT_ICONS* pEpIcon, BYTE nbrOfElements)
   74: {
;---- Variable 'nbrOfElements' assigned to Register 'R5' ----
;---- Variable 'pEpIcon' assigned to Register 'R1/R2/R3' ----
   75:   myIcon.pEpIcon = pEpIcon;
   76:   myIcon.nbrOfElements = nbrOfElements;
B2:00D02A 90426B            MOV      DPTR,#myIcon
B2:00D02D 1225A9            LCALL    ?C?PSTXDATA
   77: }
B2:00D030 90426E            MOV      DPTR,#myIcon+03H
B2:00D033 ED                MOV      A,R5
B2:00D034 F0                MOVX     @DPTR,A
   78: 
B2:00D035 22                RET      
----- FUNCTION _CommandClassZWavePlusInfoInit (END) -------


----- FUNCTION _handleCommandClassBinarySwitch (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSBINARYSWITCH.C'
   47: handleCommandClassBinarySwitch(
   48:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00D036 903D05            MOV      DPTR,#rxOpt
B2:00D039 1225A9            LCALL    ?C?PSTXDATA
   49:   ZW_APPLICATION_TX_BUFFER *pCmd,
   50:   BYTE cmdLength)
   51: {
   52:   UNUSED(cmdLength);
   53: 
   54:   switch (pCmd->ZW_Common.cmd)
B2:00D03C 903D08            MOV      DPTR,#pCmd
B2:00D03F 12A5A3            LCALL    ?L?COM001F
B2:00D042 121FF0            LCALL    ?C?CLDOPTR
B2:00D045 14                DEC      A
B2:00D046 6074              JZ       ?C0007?COMMANDCLASSBINARYSWITCH
B2:00D048 14                DEC      A
B2:00D049 6002              JZ       $ + 4H
B2:00D04B 01E1              AJMP     ?C0001?COMMANDCLASSBINARYSWITCH
   55:   {
   56:     case SWITCH_BINARY_GET:
B2:00D04D         ?C0002?COMMANDCLASSBINARYSWITCH:
   57:       if(FALSE == Check_not_legal_response_job(rxOpt))
B2:00D04D 903D05            MOV      DPTR,#rxOpt
B2:00D050 12A19D            LCALL    ?L?COM01BF
B2:00D053 4064              JC       ?C0003?COMMANDCLASSBINARYSWITCH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 793


   58:       {
   59:         ZW_APPLICATION_TX_BUFFER *pTxBuf = GetResponseBuffer();
B2:00D055 129A8C            LCALL    GetResponseBuffer
B2:00D058 903D0C            MOV      DPTR,#pTxBuf
B2:00D05B 1225A9            LCALL    ?C?PSTXDATA
   60:         /*Check pTxBuf is free*/
   61:         if( NON_NULL( pTxBuf ) )
B2:00D05E E9                MOV      A,R1
B2:00D05F 4A                ORL      A,R2
B2:00D060 6057              JZ       ?C0003?COMMANDCLASSBINARYSWITCH
   62:         {
   63:           TRANSMIT_OPTIONS_TYPE_SINGLE_EX *pTxOptionsEx;
   64:           RxToTxOptions(rxOpt, &pTxOptionsEx);
B2:00D062 7B01              MOV      R3,#01H
B2:00D064 7A3D              MOV      R2,#HIGH pTxOptionsEx
B2:00D066 790F              MOV      R1,#LOW pTxOptionsEx
B2:00D068 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00D06B 1225A9            LCALL    ?C?PSTXDATA
B2:00D06E 903D05            MOV      DPTR,#rxOpt
B2:00D071 12AB5D            LCALL    ?L?COM0107
   65:           pTxBuf->ZW_SwitchBinaryReportFrame.cmdClass = COMMAND_CLASS_SWITCH_BINARY;
B2:00D074 903D0C            MOV      DPTR,#pTxBuf
B2:00D077 122589            LCALL    ?C?PLDXDATA
B2:00D07A 7425              MOV      A,#025H
B2:00D07C 122072            LCALL    ?C?CSTPTR
   66:           pTxBuf->ZW_SwitchBinaryReportFrame.cmd = SWITCH_BINARY_REPORT;
B2:00D07F 903D0C            MOV      DPTR,#pTxBuf
B2:00D082 12A5A3            LCALL    ?L?COM001F
B2:00D085 7403              MOV      A,#03H
B2:00D087 122084            LCALL    ?C?CSTOPTR
   67:           pTxBuf->ZW_SwitchBinaryReportFrame.value = handleAppltBinarySwitchGet(rxOpt->destNode.endpoint);
B2:00D08A 903D05            MOV      DPTR,#rxOpt
B2:00D08D 12A93A            LCALL    ?L?COM0062
B2:00D090 FF                MOV      R7,A
B2:00D091 12A18B            LCALL    _handleAppltBinarySwitchGet
B2:00D094 903D0C            MOV      DPTR,#pTxBuf
B2:00D097 12B6A3            LCALL    ?L?COM00B3
   68: 
   69:           if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
   70:               (BYTE *)pTxBuf,
B2:00D09A C003              PUSH     AR3
B2:00D09C C002              PUSH     AR2
B2:00D09E C001              PUSH     AR1
B2:00D0A0 903D0F            MOV      DPTR,#pTxOptionsEx
B2:00D0A3 12A147            LCALL    ?L?COM001D
B2:00D0A6 D001              POP      AR1
B2:00D0A8 D002              POP      AR2
B2:00D0AA D003              POP      AR3
B2:00D0AC 7D03              MOV      R5,#03H
B2:00D0AE 12A13D            LCALL    ?L?COM00BD
B2:00D0B1 6003              JZ       ?C0005?COMMANDCLASSBINARYSWITCH
   71:               sizeof(ZW_SWITCH_BINARY_REPORT_FRAME),
   72:               pTxOptionsEx,
   73:               ZCB_ResponseJobStatus))
   74:           {
   75:             /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
   76:             FreeResponseBuffer();
B2:00D0B3 12A0B6            LCALL    FreeResponseBuffer
   77:           }
B2:00D0B6         ?C0005?COMMANDCLASSBINARYSWITCH:
   78:           return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00D0B6 7FFF              MOV      R7,#0FFH
B2:00D0B8 22                RET      
   79:         }
   80:       }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 794


B2:00D0B9         ?C0003?COMMANDCLASSBINARYSWITCH:
   81:       return RECEIVED_FRAME_STATUS_FAIL;
B2:00D0B9 7F02              MOV      R7,#02H
B2:00D0BB 22                RET      
   82:       break;
   83: 
   84:     case SWITCH_BINARY_SET:
B2:00D0BC         ?C0007?COMMANDCLASSBINARYSWITCH:
   85:       if ((0x63 < pCmd->ZW_SwitchBinarySetFrame.switchValue) &&
B2:00D0BC 903D08            MOV      DPTR,#pCmd
B2:00D0BF 128F3E            LCALL    ?L?COM0029
B2:00D0C2 FF                MOV      R7,A
B2:00D0C3 7463              MOV      A,#063H
B2:00D0C5 C3                CLR      C
B2:00D0C6 9F                SUBB     A,R7
B2:00D0C7 5007              JNC      ?C0008?COMMANDCLASSBINARYSWITCH
B2:00D0C9 EF                MOV      A,R7
B2:00D0CA F4                CPL      A
B2:00D0CB 6003              JZ       ?C0008?COMMANDCLASSBINARYSWITCH
   86:           (0xFF != pCmd->ZW_SwitchBinarySetFrame.switchValue))
   87:       {
   88:         return RECEIVED_FRAME_STATUS_FAIL;
B2:00D0CD 7F02              MOV      R7,#02H
B2:00D0CF 22                RET      
   89:       }
B2:00D0D0         ?C0008?COMMANDCLASSBINARYSWITCH:
   90:       CommandClassBinarySwitchSupportSet(pCmd->ZW_SwitchBinarySetFrame.switchValue, rxOpt->destNode.endpoint );
B2:00D0D0 128F41            LCALL    ?L?COM002A
B2:00D0D3 FF                MOV      R7,A
B2:00D0D4 903D05            MOV      DPTR,#rxOpt
B2:00D0D7 12A93A            LCALL    ?L?COM0062
B2:00D0DA FD                MOV      R5,A
B2:00D0DB 12B0FA            LCALL    _CommandClassBinarySwitchSupportSet
   91:       return RECEIVED_FRAME_STATUS_SUCCESS;
B2:00D0DE 7FFF              MOV      R7,#0FFH
B2:00D0E0 22                RET      
   92:       break;
   93:   }
B2:00D0E1         ?C0001?COMMANDCLASSBINARYSWITCH:
   94:   return RECEIVED_FRAME_STATUS_NO_SUPPORT;
B2:00D0E1 7F00              MOV      R7,#00H
   95: }
B2:00D0E3 22                RET      
----- FUNCTION _handleCommandClassBinarySwitch (END) -------


----- FUNCTION _OtaInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  235: OtaInit(
  236:   BOOL (CODE *pOtaStart)(WORD fwId, WORD CRC),
;---- Variable 'pOtaStart' assigned to Register 'R6/R7' ----
;---- Variable 'pOtaFinish' assigned to Register 'R2/R3' ----
;---- Variable 'pOtaExtWrite' assigned to Register 'R4/R5' ----
  237:   VOID_CALLBACKFUNC(pOtaExtWrite)(   BYTE *pData, BYTE dataLen),
  238:   VOID_CALLBACKFUNC(pOtaFinish)(BYTE val))
  239: {
  240:   myOta.pOtaStart = pOtaStart;
B2:00D0E4 90386E            MOV      DPTR,#myOta
B2:00D0E7 EE                MOV      A,R6
B2:00D0E8 F0                MOVX     @DPTR,A
B2:00D0E9 A3                INC      DPTR
B2:00D0EA EF                MOV      A,R7
B2:00D0EB F0                MOVX     @DPTR,A
  241:   myOta.pOtaExtWrite = pOtaExtWrite;
B2:00D0EC A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 795


B2:00D0ED 1272D5            LCALL    ?L?COM0489
  242:   myOta.pOtaFinish = pOtaFinish;
B2:00D0F0 127211            LCALL    ?L?COM03B0
  243:   myOta.handleHostResponse = 0;
B2:00D0F3 E4                CLR      A
B2:00D0F4 903880            MOV      DPTR,#myOta+012H
B2:00D0F7 F0                MOVX     @DPTR,A
  244:   myOta.NVM_valid = ZW_FirmwareUpdate_NVM_Init();
B2:00D0F8 121D36            LCALL    ?INTERBANK_TABLE?ZW_FirmwareUpdate_NVM_Init
B2:00D0FB 903888            MOV      DPTR,#myOta+01AH
B2:00D0FE EF                MOV      A,R7
B2:00D0FF F0                MOVX     @DPTR,A
  245:   return myOta.NVM_valid;
  246: }
B2:00D100 22                RET      
----- FUNCTION _OtaInit (END) -------


----- FUNCTION ZCB_UpdateStatusSuccess (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  284: PCB(ZCB_UpdateStatusSuccess)(void)
  285: {
  286:   ZW_DEBUG_SECURITY_SEND_STR("OTA_SUCCESS_CB");
  287:   if( FALSE == myOta.userReboot)
B2:00D101 903881            MOV      DPTR,#myOta+013H
B2:00D104 E0                MOVX     A,@DPTR
B2:00D105 7004              JNZ      ?C0007?OTA_UTIL
  288:   {
  289:     /* send FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_V4 to controller.
  290:        Device reboot itself*/
  291:     SetEvState(FW_EV_UPDATE_STATUS_SUCCESS);
B2:00D107 7F06              MOV      R7,#06H
  292:   }
B2:00D109 8002              SJMP     ?C0138?OTA_UTIL
B2:00D10B         ?C0007?OTA_UTIL:
  293:   else
  294:   {
  295:     /* send FIRMWARE_UPDATE_MD_STATUS_REPORT_SUCCESSFULLY_STORED_V4 to controller.
  296:        User need to reboot device*/
  297:     SetEvState(FW_EV_UPDATE_STATUS_SUCCESS_USER_REBOOT);
B2:00D10B 7F07              MOV      R7,#07H
B2:00D10D         
B2:00D10D 129571            LCALL    _SetEvState
  298:   }
B2:00D110         ?C0008?OTA_UTIL:
  299:   myOta.userReboot = FALSE;
B2:00D110 E4                CLR      A
B2:00D111 903881            MOV      DPTR,#myOta+013H
B2:00D114 F0                MOVX     @DPTR,A
  300: }
B2:00D115 22                RET      
----- FUNCTION ZCB_UpdateStatusSuccess (END) -------


----- FUNCTION OtaHostFWU_Status (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  969: OtaHostFWU_Status( BOOL userReboot, BOOL status )
  970: {
  971:   ZW_DEBUG_SEND_STR("OtaHostFWU_Status B:");
  972:   ZW_DEBUG_SEND_NUM(userReboot);
  973:   ZW_DEBUG_SEND_BYTE('_');
  974:   ZW_DEBUG_SEND_NUM(status);
  975:   ZW_DEBUG_SEND_NL();
  976:   TimerCancelHostResponse();
B2:00D116 3140              ACALL    TimerCancelHostResponse
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 796


  977: 
  978:   if( TRUE == status )
B2:00D118 30241F            JNB      status,?C0119?OTA_UTIL
  979:   {
  980:     /*Check state machine is finish geting data. We both states: ST_DATA_WRITE_LAST
  981:       and ST_DATA_WRITE_WAIT_HOST_STATUS*/
  982:     if((ST_DATA_WRITE_WAIT_HOST_STATUS == st_data_write_to_host) ||
B2:00D11B 903889            MOV      DPTR,#st_data_write_to_host
B2:00D11E E0                MOVX     A,@DPTR
B2:00D11F FF                MOV      R7,A
B2:00D120 6402              XRL      A,#02H
B2:00D122 6004              JZ       ?C0121?OTA_UTIL
B2:00D124 EF                MOV      A,R7
B2:00D125 B40110            CJNE     A,#01H,?C0120?OTA_UTIL
B2:00D128         ?C0121?OTA_UTIL:
  983:        (ST_DATA_WRITE_LAST == st_data_write_to_host))
  984:     {
  985:       myOta.userReboot = userReboot;
B2:00D128 A223              MOV      C,userReboot
B2:00D12A E4                CLR      A
B2:00D12B 33                RLC      A
B2:00D12C 903881            MOV      DPTR,#myOta+013H
B2:00D12F F0                MOVX     @DPTR,A
  986:       /* Delay starting the CRC calculation so we can transmit
  987:        * the ack or routed ack first */
  988:       if(0xFF == ZW_TIMER_START(ZCB_UpdateStatusSuccess, 10, 1))
B2:00D130 124FF7            LCALL    ?L?COM0495
B2:00D133 BFFF09            CJNE     R7,#0FFH,?C0125?OTA_UTIL
  989:       {
  990:         ZW_DEBUG_SEND_STR("OTA_SUCCESS_NOTIMER");
  991:         ZCB_UpdateStatusSuccess();
B2:00D136 80C9              SJMP     ZCB_UpdateStatusSuccess
  992:       }
  993:     }
B2:00D138         ?C0120?OTA_UTIL:
  994:     else{
  995:       /* We are not finish getting data!!!*/
  996:       SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
  997:     }
  998:   }
B2:00D138 8000              SJMP     ?C0160?OTA_UTIL
B2:00D13A         ?C0119?OTA_UTIL:
  999:   else
 1000:   {
 1001:     /*host failed.. something is wrong.. stop process*/
 1002:     SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
B2:00D13A         
B2:00D13A 7F08              MOV      R7,#08H
B2:00D13C 129571            LCALL    _SetEvState
 1003:   }
 1004: }
B2:00D13F         ?C0125?OTA_UTIL:
B2:00D13F 22                RET      
----- FUNCTION OtaHostFWU_Status (END) -------


----- FUNCTION TimerCancelHostResponse (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  890: TimerCancelHostResponse(void)
  891: {
  892:   ZW_TIMER_CANCEL(myOta.handleHostResponse);
  893: }
B2:00D140 903880            MOV      DPTR,#myOta+012H
B2:00D143 E0                MOVX     A,@DPTR
B2:00D144 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 797


B2:00D145 024465            LJMP     _TimerCancel
----- FUNCTION TimerCancelHostResponse (END) -------


----- FUNCTION OtaHostFWU_WriteFinish (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  937: OtaHostFWU_WriteFinish(void)
  938: {
  939: //  ZW_DEBUG_SEND_STR("OtaHostFWU_WriteFinish");
  940: //  ZW_DEBUG_SEND_NL();
  941:   /* cancel timer*/
  942:   TimerCancelHostResponse();
B2:00D148 3140              ACALL    TimerCancelHostResponse
  943:   if( ST_DATA_WRITE_PROGRESS == st_data_write_to_host)
B2:00D14A 903889            MOV      DPTR,#st_data_write_to_host
B2:00D14D E0                MOVX     A,@DPTR
B2:00D14E 7005              JNZ      ?C0114?OTA_UTIL
  944:   {
  945:     //ZW_DEBUG_SEND_STR("next F");
  946:     /* get next frame*/
  947:     SetEvState(FW_EV_GET_NEXT_FW_FRAME);
B2:00D150 7F04              MOV      R7,#04H
B2:00D152 029571            LJMP     _SetEvState
  948:   }
B2:00D155         ?C0114?OTA_UTIL:
  949:   else if(ST_DATA_WRITE_LAST == st_data_write_to_host)
B2:00D155 903889            MOV      DPTR,#st_data_write_to_host
B2:00D158 E0                MOVX     A,@DPTR
B2:00D159 B40119            CJNE     A,#01H,?C0118?OTA_UTIL
  950:   {
  951:     ZW_DEBUG_SEND_STR("last F");
  952:     /*Wait on host status.*/
  953:     st_data_write_to_host = ST_DATA_WRITE_WAIT_HOST_STATUS;
B2:00D15C 7402              MOV      A,#02H
B2:00D15E F0                MOVX     @DPTR,A
  954:     /* Tell host it was last frame*/
  955:     if (NON_NULL( myOta.pOtaExtWrite ))
B2:00D15F 3176              ACALL    ?L?COM0496
B2:00D161 4E                ORL      A,R6
B2:00D162 6011              JZ       ?C0118?OTA_UTIL
  956:       myOta.pOtaExtWrite( NULL, 0);
B2:00D164 12B299            LCALL    ?L?COM0069
B2:00D167 903870            MOV      DPTR,#myOta+02H
B2:00D16A A3                INC      DPTR
B2:00D16B E0                MOVX     A,@DPTR
B2:00D16C F582              MOV      DPL,A
B2:00D16E 8E83              MOV      DPH,R6
B2:00D170 E4                CLR      A
B2:00D171 FD                MOV      R5,A
B2:00D172 12271A            LCALL    ?C?ICALL2
  957:   }
  958: }
B2:00D175         ?C0118?OTA_UTIL:
B2:00D175 22                RET      
----- FUNCTION OtaHostFWU_WriteFinish (END) -------


----- FUNCTION ?L?COM0496 (BEGIN) -----
B2:00D176 903870            MOV      DPTR,#myOta+02H
B2:00D179 E0                MOVX     A,@DPTR
B2:00D17A FE                MOV      R6,A
B2:00D17B A3                INC      DPTR
B2:00D17C E0                MOVX     A,@DPTR
B2:00D17D 22                RET      
----- FUNCTION ?L?COM0496 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 798




----- FUNCTION _handleCmdClassFirmwareUpdateMdReport (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  311: handleCmdClassFirmwareUpdateMdReport( WORD crc16Result,
B2:00D17E 903D12            MOV      DPTR,#crc16Result
B2:00D181 1270CD            LCALL    ?L?COM019E
B2:00D184 A3                INC      DPTR
B2:00D185 EB                MOV      A,R3
B2:00D186 F0                MOVX     @DPTR,A
  312:                                       WORD firmwareUpdateReportNumber,
  313:                                       BYTE properties,
  314:                                       BYTE* pData,
  315:                                       BYTE fw_actualFrameSize)
  316: {
  317: 
  318: /*  ZW_DEBUG_CMD_OTA_SEND_STR("UpdateMdReport");
  319:   ZW_DEBUG_CMD_OTA_SEND_NUM( crc16Result);
  320:   ZW_DEBUG_CMD_OTA_SEND_NUM( firmwareUpdateReportNumber);
  321:   ZW_DEBUG_CMD_OTA_SEND_NUM( properties);
  322:   ZW_DEBUG_CMD_OTA_SEND_NUM( fw_actualFrameSize);
  323:   ZW_DEBUG_CMD_OTA_SEND_NL();
  324: */
  325:   /*Check correct state*/
  326:   if( FW_STATE_ACTIVE != myOta.fwState)
B2:00D187 903874            MOV      DPTR,#myOta+06H
B2:00D18A E0                MOVX     A,@DPTR
B2:00D18B 6402              XRL      A,#02H
B2:00D18D 6002              JZ       $ + 4H
B2:00D18F 41BA              AJMP     ?C0011?OTA_UTIL
  327:   {
  328:     /*Not correct state.. just stop*/
  329:     return;
  330:   }
B2:00D191         ?C0010?OTA_UTIL:
  331: 
  332:   /*Check checksum*/
  333:   if (0 == crc16Result)
B2:00D191 903D12            MOV      DPTR,#crc16Result
B2:00D194 E0                MOVX     A,@DPTR
B2:00D195 7002              JNZ      ?C0132?OTA_UTIL
B2:00D197 A3                INC      DPTR
B2:00D198 E0                MOVX     A,@DPTR
B2:00D199         ?C0132?OTA_UTIL:
B2:00D199 6002              JZ       $ + 4H
B2:00D19B 419F              AJMP     ?C0012?OTA_UTIL
  334:   {
  335:     //ZW_DEBUG_CMD_OTA_SEND_BYTE('C');
  336:     myOta.fw_numOfRetries = 0;
B2:00D19D 903878            MOV      DPTR,#myOta+0AH
B2:00D1A0 F0                MOVX     @DPTR,A
  337:     /* Check report number */
  338:     if (firmwareUpdateReportNumber == myOta.firmwareUpdateReportNumberPrevious + 1)
B2:00D1A1 90387A            MOV      DPTR,#myOta+0CH
B2:00D1A4 E0                MOVX     A,@DPTR
B2:00D1A5 FA                MOV      R2,A
B2:00D1A6 A3                INC      DPTR
B2:00D1A7 E0                MOVX     A,@DPTR
B2:00D1A8 FB                MOV      R3,A
B2:00D1A9 2401              ADD      A,#01H
B2:00D1AB FF                MOV      R7,A
B2:00D1AC E4                CLR      A
B2:00D1AD 3A                ADDC     A,R2
B2:00D1AE FE                MOV      R6,A
B2:00D1AF 903D14            MOV      DPTR,#firmwareUpdateReportNumber
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 799


B2:00D1B2 E0                MOVX     A,@DPTR
B2:00D1B3 6E                XRL      A,R6
B2:00D1B4 7003              JNZ      ?C0133?OTA_UTIL
B2:00D1B6 A3                INC      DPTR
B2:00D1B7 E0                MOVX     A,@DPTR
B2:00D1B8 6F                XRL      A,R7
B2:00D1B9         ?C0133?OTA_UTIL:
B2:00D1B9 6002              JZ       $ + 4H
B2:00D1BB 41BA              AJMP     ?C0011?OTA_UTIL
  339:     {
  340:       /* Right number*/
  341:       DWORD firstAddr = 0;
B2:00D1BD FF                MOV      R7,A
B2:00D1BE FE                MOV      R6,A
B2:00D1BF FD                MOV      R5,A
B2:00D1C0 FC                MOV      R4,A
B2:00D1C1 903D1B            MOV      DPTR,#firstAddr
B2:00D1C4 1224F1            LCALL    ?C?LSTXDATA
  342:       if (0 == myOta.firmwareUpdateReportNumberPrevious)
B2:00D1C7 EB                MOV      A,R3
B2:00D1C8 4A                ORL      A,R2
B2:00D1C9 6015              JZ       ?C0015?OTA_UTIL
  343:       {
  344:         /* First packet sets the packetsize for the whole firmware update transaction */
  345:         /* TODO: Make negativ response if packetsize too big... */
  346:         //firmware_update_packetsize = fw_actualFrameSize;
  347:       }
B2:00D1CB         ?C0014?OTA_UTIL:
  348:       else
  349:       {
  350:         if ((firmware_update_packetsize != fw_actualFrameSize) && (!(properties & FIRMWARE_UPDATE_MD_REPORT_PROPE
>> RTIES1_LAST_BIT_MASK)))
B2:00D1CB 903D1A            MOV      DPTR,#fw_actualFrameSize
B2:00D1CE E0                MOVX     A,@DPTR
B2:00D1CF FF                MOV      R7,A
B2:00D1D0 90388A            MOV      DPTR,#firmware_update_packetsize
B2:00D1D3 E0                MOVX     A,@DPTR
B2:00D1D4 6F                XRL      A,R7
B2:00D1D5 6009              JZ       ?C0015?OTA_UTIL
B2:00D1D7 903D16            MOV      DPTR,#properties
B2:00D1DA E0                MOVX     A,@DPTR
B2:00D1DB 20E702            JB       ACC.7,$ + 5H
B2:00D1DE 41BA              AJMP     ?C0011?OTA_UTIL
  351:         {
  352:           ZW_DEBUG_SEND_BYTE('%');
  353:           ZW_DEBUG_SEND_WORD_NUM(firmware_update_packetsize);
  354:           ZW_DEBUG_SEND_BYTE('-');
  355:           ZW_DEBUG_SEND_WORD_NUM(fw_actualFrameSize);
  356:           /* (firmware_update_packetsize != fw_actualFrameSize) and not last packet - do not match.. do nothing. 
>> */
  357:           /* Let the timer handle retries */
  358:           return;
  359:         }
B2:00D1E0         ?C0016?OTA_UTIL:
  360:       }
B2:00D1E0         ?C0015?OTA_UTIL:
  361:       //ZW_DEBUG_CMD_OTA_SEND_BYTE('N');
  362:       myOta.firmwareUpdateReportNumberPrevious = firmwareUpdateReportNumber;
B2:00D1E0 903D14            MOV      DPTR,#firmwareUpdateReportNumber
B2:00D1E3 E0                MOVX     A,@DPTR
B2:00D1E4 FE                MOV      R6,A
B2:00D1E5 A3                INC      DPTR
B2:00D1E6 E0                MOVX     A,@DPTR
B2:00D1E7 FF                MOV      R7,A
B2:00D1E8 90387A            MOV      DPTR,#myOta+0CH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 800


B2:00D1EB EE                MOV      A,R6
B2:00D1EC F0                MOVX     @DPTR,A
B2:00D1ED A3                INC      DPTR
B2:00D1EE EF                MOV      A,R7
B2:00D1EF F0                MOVX     @DPTR,A
  363: 
  364:       firstAddr = ((DWORD)(firmwareUpdateReportNumber - 1) * firmware_update_packetsize);
B2:00D1F0 24FF              ADD      A,#0FFH
B2:00D1F2 FF                MOV      R7,A
B2:00D1F3 EE                MOV      A,R6
B2:00D1F4 34FF              ADDC     A,#0FFH
B2:00D1F6 FE                MOV      R6,A
B2:00D1F7 90388A            MOV      DPTR,#firmware_update_packetsize
B2:00D1FA E0                MOVX     A,@DPTR
B2:00D1FB FD                MOV      R5,A
B2:00D1FC 7C00              MOV      R4,#00H
B2:00D1FE 122740            LCALL    ?C?LIMUL
B2:00D201 903D1B            MOV      DPTR,#firstAddr
B2:00D204 1224F1            LCALL    ?C?LSTXDATA
  365:       myOta.fw_crcrunning = ZW_CheckCrc16(myOta.fw_crcrunning, pData, fw_actualFrameSize);
B2:00D207 90387C            MOV      DPTR,#myOta+0EH
B2:00D20A E0                MOVX     A,@DPTR
B2:00D20B FE                MOV      R6,A
B2:00D20C A3                INC      DPTR
B2:00D20D E0                MOVX     A,@DPTR
B2:00D20E FF                MOV      R7,A
B2:00D20F 51BB              ACALL    ?L?COM03A3
B2:00D211 FD                MOV      R5,A
B2:00D212 903F79            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B2:00D215 E4                CLR      A
B2:00D216 F0                MOVX     @DPTR,A
B2:00D217 A3                INC      DPTR
B2:00D218 ED                MOV      A,R5
B2:00D219 F0                MOVX     @DPTR,A
B2:00D21A 121B60            LCALL    ?INTERBANK_TABLE?_ZW_CheckCrc16
B2:00D21D 90387C            MOV      DPTR,#myOta+0EH
B2:00D220 EE                MOV      A,R6
B2:00D221 F0                MOVX     @DPTR,A
B2:00D222 A3                INC      DPTR
B2:00D223 EF                MOV      A,R7
B2:00D224 F0                MOVX     @DPTR,A
  366: 
  367:       /** Check: intern or extern Firmware update **/
  368:       if( FALSE == myOta.fwExtern)
B2:00D225 90387F            MOV      DPTR,#myOta+011H
B2:00D228 E0                MOVX     A,@DPTR
B2:00D229 7038              JNZ      ?C0017?OTA_UTIL
  369:       {
  370:         /** Intern firmware to update **/
  371:         OTA_WriteData(firstAddr, pData, fw_actualFrameSize);
B2:00D22B 51BB              ACALL    ?L?COM03A3
B2:00D22D FF                MOV      R7,A
B2:00D22E 903EF7            MOV      DPTR,#?_OTA_WriteData?BYTE+07H
B2:00D231 E4                CLR      A
B2:00D232 F0                MOVX     @DPTR,A
B2:00D233 A3                INC      DPTR
B2:00D234 EF                MOV      A,R7
B2:00D235 F0                MOVX     @DPTR,A
B2:00D236 903D1B            MOV      DPTR,#firstAddr
B2:00D239 122499            LCALL    ?C?LLDXDATA
B2:00D23C 12A15B            LCALL    _OTA_WriteData
  372: 
  373:         /* Is this the last report ? */
  374:         if (properties & FIRMWARE_UPDATE_MD_REPORT_PROPERTIES1_LAST_BIT_MASK)
B2:00D23F 903D16            MOV      DPTR,#properties
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 801


B2:00D242 E0                MOVX     A,@DPTR
B2:00D243 30E719            JNB      ACC.7,?C0018?OTA_UTIL
  375:         {
  376:           /*check CRC for received dataBuffer*/
  377:           if (myOta.fw_crcrunning == myOta.firmwareCrc)
B2:00D246 71DA              ACALL    ?L?COM045A
B2:00D248 B50610            CJNE     A,AR6,?C0019?OTA_UTIL
B2:00D24B A3                INC      DPTR
B2:00D24C E0                MOVX     A,@DPTR
B2:00D24D B5070B            CJNE     A,AR7,?C0019?OTA_UTIL
  378:           {
  379:              ZW_DEBUG_SEND_STR("**OTA_SUCCESS_CRC**");
  380:             /* Delay starting the CRC calculation so we can transmit
  381:              * the ack or routed ack first */
  382:             if(0xFF == ZW_TIMER_START(ZCB_UpdateStatusSuccess, 10, 1))
B2:00D250 124FF7            LCALL    ?L?COM0495
B2:00D253 EF                MOV      A,R7
B2:00D254 F4                CPL      A
B2:00D255 7063              JNZ      ?C0011?OTA_UTIL
  383:             {
  384:               ZW_DEBUG_SEND_STR("OTA_SUCCESS_NOTIMER");
  385:               SetEvState(FW_EV_UPDATE_STATUS_SUCCESS);
B2:00D257 7F06              MOV      R7,#06H
  386:             }
  387:           }
B2:00D259 805C              SJMP     ?C0143?OTA_UTIL
B2:00D25B         ?C0019?OTA_UTIL:
  388:           else
  389:           {
  390:             ZW_DEBUG_SEND_STR("**OTA_FAIL CRC!!**");
  391:             ZW_DEBUG_SEND_WORD_NUM(myOta.fw_crcrunning);
  392:             ZW_DEBUG_SEND_BYTE('-');
  393:             ZW_DEBUG_SEND_WORD_NUM(myOta.firmwareCrc);
  394:             ZW_DEBUG_SEND_NL();
  395:             SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
B2:00D25B 7F08              MOV      R7,#08H
B2:00D25D         
  396:           }
  397:         }
B2:00D25D 8058              SJMP     ?C0143?OTA_UTIL
B2:00D25F         ?C0018?OTA_UTIL:
  398:         else
  399:         {
  400:           SetEvState(FW_EV_GET_NEXT_FW_FRAME);
B2:00D25F 7F04              MOV      R7,#04H
B2:00D261         
  401:         }
  402:       }
B2:00D261 8054              SJMP     ?C0143?OTA_UTIL
B2:00D263         ?C0017?OTA_UTIL:
  403:       else
  404:       {
  405:         /** Extern firmware to update **/
  406:         if(NON_NULL( myOta.pOtaExtWrite ))
B2:00D263 3176              ACALL    ?L?COM0496
B2:00D265 4E                ORL      A,R6
B2:00D266 6033              JZ       ?C0024?OTA_UTIL
  407:         {
  408:           /* Is this the last report ? */
  409:           if(properties & FIRMWARE_UPDATE_MD_REPORT_PROPERTIES1_LAST_BIT_MASK)
B2:00D268 903D16            MOV      DPTR,#properties
B2:00D26B E0                MOVX     A,@DPTR
B2:00D26C 30E718            JNB      ACC.7,?C0025?OTA_UTIL
  410:           {
  411:             /*check CRC for received dataBuffer*/
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 802


  412:             if (myOta.fw_crcrunning == myOta.firmwareCrc)
B2:00D26F 71DA              ACALL    ?L?COM045A
B2:00D271 B5060C            CJNE     A,AR6,?C0026?OTA_UTIL
B2:00D274 A3                INC      DPTR
B2:00D275 E0                MOVX     A,@DPTR
B2:00D276 B50707            CJNE     A,AR7,?C0026?OTA_UTIL
  413:             {
  414:               ZW_DEBUG_SEND_STR("**OTA_SUCCESS_CRC**");
  415:               st_data_write_to_host = ST_DATA_WRITE_LAST;
B2:00D279 903889            MOV      DPTR,#st_data_write_to_host
B2:00D27C 7401              MOV      A,#01H
  416:               /* Start timeout on host to response on OtaWriteFinish() */
  417:               TimerStartHostResponse();
  418:             }
B2:00D27E 800B              SJMP     ?C0142?OTA_UTIL
B2:00D280         ?C0026?OTA_UTIL:
  419:             else
  420:             {
  421:               ZW_DEBUG_SEND_STR("**OTA_FAIL CRC!!**");
  422:               ZW_DEBUG_SEND_WORD_NUM(myOta.fw_crcrunning);
  423:               ZW_DEBUG_SEND_BYTE('-');
  424:               ZW_DEBUG_SEND_WORD_NUM(myOta.firmwareCrc);
  425:               ZW_DEBUG_SEND_NL();
  426:               SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
B2:00D280 7F08              MOV      R7,#08H
B2:00D282 129571            LCALL    _SetEvState
  427:             }
  428:           }
B2:00D285 8007              SJMP     ?C0028?OTA_UTIL
B2:00D287         ?C0025?OTA_UTIL:
  429:           else
  430:           {
  431:             st_data_write_to_host = ST_DATA_WRITE_PROGRESS;
B2:00D287 E4                CLR      A
B2:00D288 903889            MOV      DPTR,#st_data_write_to_host
B2:00D28B         
B2:00D28B F0                MOVX     @DPTR,A
  432:             /* Start timeout on host to response on OtaWriteFinish() */
  433:             TimerStartHostResponse();
B2:00D28C 9127              ACALL    TimerStartHostResponse
  434:           }
B2:00D28E         ?C0028?OTA_UTIL:
  435: 
  436: 
  437:           myOta.pOtaExtWrite( pData, fw_actualFrameSize);
B2:00D28E 51BB              ACALL    ?L?COM03A3
B2:00D290 FD                MOV      R5,A
B2:00D291 3176              ACALL    ?L?COM0496
B2:00D293 FF                MOV      R7,A
B2:00D294 F582              MOV      DPL,A
B2:00D296 8E83              MOV      DPH,R6
B2:00D298 02271A            LJMP     ?C?ICALL2
  438: 
  439:         }
B2:00D29B         ?C0024?OTA_UTIL:
  440:         else{
  441:           /* fail to send data to host*/
  442:           SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
B2:00D29B 7F08              MOV      R7,#08H
B2:00D29D         
  443:         }
  444:       }
  445:     }
B2:00D29D 8018              SJMP     ?C0143?OTA_UTIL
  446:     else{
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 803


  447:       ZW_DEBUG_CMD_OTA_SEND_BYTE('n');
  448:       /* (firmwareUpdateReportNumber == myOta.firmwareUpdateReportNumberPrevious + 1) do noth match.. do nothing.
>> 
  449:          Let the timer hande retries*/
  450:     }
  451: 
  452:   }
B2:00D29F         ?C0012?OTA_UTIL:
  453:   else
  454:   {
  455:     ZW_DEBUG_CMD_OTA_SEND_BYTE('c');
  456:     // TODO: else we have no indication if the checksum check fails ?????
  457:     if (FIRMWARE_UPDATE_REQUEST_TIMEOUTS < myOta.timerFWUpdateCount)
B2:00D29F 90387E            MOV      DPTR,#myOta+010H
B2:00D2A2 E0                MOVX     A,@DPTR
B2:00D2A3 FF                MOV      R7,A
B2:00D2A4 7405              MOV      A,#05H
B2:00D2A6 C3                CLR      C
B2:00D2A7 9F                SUBB     A,R7
B2:00D2A8 5010              JNC      ?C0011?OTA_UTIL
  458:     {
  459:       if (FIRMWARE_UPDATE_MAX_RETRY < myOta.fw_numOfRetries)
B2:00D2AA 903878            MOV      DPTR,#myOta+0AH
B2:00D2AD E0                MOVX     A,@DPTR
B2:00D2AE FF                MOV      R7,A
B2:00D2AF 740A              MOV      A,#0AH
B2:00D2B1 C3                CLR      C
B2:00D2B2 9F                SUBB     A,R7
B2:00D2B3 5005              JNC      ?C0011?OTA_UTIL
  460:       {
  461:         ZW_DEBUG_CMD_OTA_SEND_STR("FAILED!");
  462:         /* Send invalid status*/
  463:         SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
B2:00D2B5 7F08              MOV      R7,#08H
B2:00D2B7         
B2:00D2B7 129571            LCALL    _SetEvState
  464:       }
  465:     }
  466:   }
  467: }
B2:00D2BA         ?C0011?OTA_UTIL:
B2:00D2BA 22                RET      
----- FUNCTION _handleCmdClassFirmwareUpdateMdReport (END) -------


----- FUNCTION ?L?COM03A3 (BEGIN) -----
B2:00D2BB 903D17            MOV      DPTR,#pData
B2:00D2BE 122589            LCALL    ?C?PLDXDATA
B2:00D2C1 903D1A            MOV      DPTR,#fw_actualFrameSize
B2:00D2C4 E0                MOVX     A,@DPTR
B2:00D2C5 22                RET      
----- FUNCTION ?L?COM03A3 (END) -------


----- FUNCTION _handleCmdClassFirmwareUpdateMdReqGet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  469: void handleCmdClassFirmwareUpdateMdReqGet(
  470:   RECEIVE_OPTIONS_TYPE_EX *rxOpt,
B2:00D2C6 903C67            MOV      DPTR,#rxOpt
B2:00D2C9 1225A9            LCALL    ?C?PSTXDATA
B2:00D2CC 903C6A            MOV      DPTR,#fwTarget
B2:00D2CF ED                MOV      A,R5
B2:00D2D0 F0                MOVX     @DPTR,A
  471:   BYTE fwTarget,
  472:   WORD fragmentSize,
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 804


  473:   FW_UPDATE_GET* pData,
  474:   BYTE* pStatus)
  475: {
  476:   BYTE i = 0;
;---- Variable 'i' assigned to Register 'R7' ----
B2:00D2D1 E4                CLR      A
B2:00D2D2 FF                MOV      R7,A
  477:   uint16_t firmwareId;
  478:   uint16_t max_fragment_size = handleCommandClassFirmwareUpdateMaxFragmentSize();
B2:00D2D3 12821B            LCALL    handleCommandClassFirmwareUpdateMaxFragmentSize
;---- Variable 'max_fragment_size' assigned to Register 'R4/R5' ----
B2:00D2D6 AD07              MOV      R5,AR7
B2:00D2D8 AC06              MOV      R4,AR6
  479: 
  480:   i = FIRMWARE_UPGRADABLE;
B2:00D2DA 7FFF              MOV      R7,#0FFH
  481:   if((0 == fwTarget) && (0 == i))
B2:00D2DC 903C6A            MOV      DPTR,#fwTarget
B2:00D2DF E0                MOVX     A,@DPTR
B2:00D2E0 7005              JNZ      ?C0034?OTA_UTIL
B2:00D2E2 EF                MOV      A,R7
B2:00D2E3 7002              JNZ      ?C0034?OTA_UTIL
  482:   {
  483:     *pStatus = FIRMWARE_UPDATE_MD_REQUEST_REPORT_NOT_UPGRADABLE_V4;
  484:     m_requestGetStatus = *pStatus;
B2:00D2E5 8063              SJMP     ?C0144?OTA_UTIL
  485:     return;
  486:   }
B2:00D2E7         ?C0034?OTA_UTIL:
  487: 
  488:   if (!(fragmentSize > 0 && fragmentSize <= max_fragment_size))
B2:00D2E7 903C6B            MOV      DPTR,#fragmentSize
B2:00D2EA E0                MOVX     A,@DPTR
B2:00D2EB FE                MOV      R6,A
B2:00D2EC A3                INC      DPTR
B2:00D2ED E0                MOVX     A,@DPTR
B2:00D2EE FF                MOV      R7,A
B2:00D2EF D3                SETB     C
B2:00D2F0 9400              SUBB     A,#00H
B2:00D2F2 EE                MOV      A,R6
B2:00D2F3 9400              SUBB     A,#00H
B2:00D2F5 4007              JC       ?C0037?OTA_UTIL
B2:00D2F7 D3                SETB     C
B2:00D2F8 EF                MOV      A,R7
B2:00D2F9 9D                SUBB     A,R5
B2:00D2FA EE                MOV      A,R6
B2:00D2FB 9C                SUBB     A,R4
B2:00D2FC 400A              JC       ?C0036?OTA_UTIL
B2:00D2FE         ?C0037?OTA_UTIL:
  489:   {
  490:     *pStatus = FIRMWARE_UPDATE_MD_REQUEST_REPORT_INVALID_FRAGMENT_SIZE_V4;
B2:00D2FE 903C70            MOV      DPTR,#pStatus
B2:00D301 122589            LCALL    ?C?PLDXDATA
B2:00D304 7402              MOV      A,#02H
  491:     m_requestGetStatus = *pStatus;
B2:00D306 61CC              AJMP     ?C0148?OTA_UTIL
  492:     return;
  493:   }
B2:00D308         ?C0036?OTA_UTIL:
  494: 
  495:   firmwareId = handleFirmWareIdGet(fwTarget);
B2:00D308 12B458            LCALL    ?L?COM0592
B2:00D30B 903C73            MOV      DPTR,#firmwareId
B2:00D30E EE                MOV      A,R6
B2:00D30F F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 805


B2:00D310 A3                INC      DPTR
B2:00D311 EF                MOV      A,R7
B2:00D312 F0                MOVX     @DPTR,A
  496:   if ((pData->manufacturerId != firmwareDescriptor.manufacturerID) ||
B2:00D313 903C6D            MOV      DPTR,#pData
B2:00D316 122589            LCALL    ?C?PLDXDATA
B2:00D319 12216F            LCALL    ?C?ILDPTR
B2:00D31C 1273F9            LCALL    ?L?COM05F1
B2:00D31F B50719            CJNE     A,AR7,?C0039?OTA_UTIL
B2:00D322 E4                CLR      A
B2:00D323 93                MOVC     A,@A+DPTR
B2:00D324 B5F014            CJNE     A,B,?C0039?OTA_UTIL
B2:00D327 E9                MOV      A,R1
B2:00D328 2402              ADD      A,#02H
B2:00D32A 127060            LCALL    ?L?COM00DC
B2:00D32D FF                MOV      R7,A
B2:00D32E 903C73            MOV      DPTR,#firmwareId
B2:00D331 E0                MOVX     A,@DPTR
B2:00D332 65F0              XRL      A,B
B2:00D334 7003              JNZ      ?C0137?OTA_UTIL
B2:00D336 A3                INC      DPTR
B2:00D337 E0                MOVX     A,@DPTR
B2:00D338 6F                XRL      A,R7
B2:00D339         ?C0137?OTA_UTIL:
B2:00D339 6009              JZ       ?C0038?OTA_UTIL
B2:00D33B         ?C0039?OTA_UTIL:
  497:       (pData->firmwareId != firmwareId))
  498:   {
  499:     *pStatus = FIRMWARE_UPDATE_MD_REQUEST_REPORT_INVALID_COMBINATION_V4;
B2:00D33B 903C70            MOV      DPTR,#pStatus
B2:00D33E 122589            LCALL    ?C?PLDXDATA
B2:00D341 E4                CLR      A
B2:00D342         
  500:     m_requestGetStatus = *pStatus;
B2:00D342 61CC              AJMP     ?C0148?OTA_UTIL
  501:     return;
  502:   }
B2:00D344         ?C0038?OTA_UTIL:
  503: 
  504:   if (0 == myOta.NVM_valid)
B2:00D344 903888            MOV      DPTR,#myOta+01AH
B2:00D347 E0                MOVX     A,@DPTR
B2:00D348 700A              JNZ      ?C0040?OTA_UTIL
  505:   {
  506:     *pStatus = FIRMWARE_UPDATE_MD_REQUEST_REPORT_NOT_UPGRADABLE_V4;
B2:00D34A         
B2:00D34A 903C70            MOV      DPTR,#pStatus
B2:00D34D 122589            LCALL    ?C?PLDXDATA
B2:00D350 7403              MOV      A,#03H
B2:00D352         
  507:     m_requestGetStatus = *pStatus;
B2:00D352 8078              SJMP     ?C0148?OTA_UTIL
  508:     return;
  509:   }
B2:00D354         ?C0040?OTA_UTIL:
  510: 
  511:   /*Firmware valid.. ask OtaStart to start update*/
  512:   if(NON_NULL( myOta.pOtaStart ))
B2:00D354 90386E            MOV      DPTR,#myOta
B2:00D357 E0                MOVX     A,@DPTR
B2:00D358 FE                MOV      R6,A
B2:00D359 A3                INC      DPTR
B2:00D35A E0                MOVX     A,@DPTR
B2:00D35B 4E                ORL      A,R6
B2:00D35C 6020              JZ       ?C0041?OTA_UTIL
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 806


  513:   {
  514: 
  515:     if(FALSE == myOta.pOtaStart(handleFirmWareIdGet(fwTarget), pData->checksum))
B2:00D35E 12B458            LCALL    ?L?COM0592
B2:00D361 903C6D            MOV      DPTR,#pData
B2:00D364 125522            LCALL    ?L?COM0059
B2:00D367 12216F            LCALL    ?C?ILDPTR
B2:00D36A FD                MOV      R5,A
B2:00D36B ACF0              MOV      R4,B
B2:00D36D 90386E            MOV      DPTR,#myOta
B2:00D370 71E7              ACALL    ?L?COM0457
B2:00D372 400A              JC       ?C0041?OTA_UTIL
  516:     {
  517:       ZW_DEBUG_CMD_OTA_SEND_BYTE('&');
  518:       //SetEvState(FW_EV_FORCE_DISABLE);
  519:       *pStatus = FIRMWARE_UPDATE_MD_REQUEST_REPORT_REQUIRES_AUTHENTICATION_V4;
B2:00D374 903C70            MOV      DPTR,#pStatus
B2:00D377 122589            LCALL    ?C?PLDXDATA
B2:00D37A 7401              MOV      A,#01H
B2:00D37C         
  520:       m_requestGetStatus = *pStatus;
B2:00D37C 804E              SJMP     ?C0148?OTA_UTIL
  521:       return;
  522:     }
  523:   }
B2:00D37E         ?C0041?OTA_UTIL:
  524:   InitEvState();
B2:00D37E 71F3              ACALL    InitEvState
  525:   memcpy( (BYTE*) &myOta.rxOpt, (BYTE*)rxOpt, sizeof(RECEIVE_OPTIONS_TYPE_EX));
B2:00D380 903C67            MOV      DPTR,#rxOpt
B2:00D383 122589            LCALL    ?C?PLDXDATA
B2:00D386 12C4EF            LCALL    ?L?COM0022
B2:00D389 7A38              MOV      R2,#HIGH myOta+014H
B2:00D38B 7982              MOV      R1,#LOW myOta+014H
B2:00D38D 1272F3            LCALL    ?L?COM0497
  526:   SetEvState(FW_EV_VALID_COMBINATION);
B2:00D390 7F01              MOV      R7,#01H
B2:00D392 129571            LCALL    _SetEvState
  527:   myOta.firmwareCrc = pData->checksum;
B2:00D395 903C6D            MOV      DPTR,#pData
B2:00D398 125522            LCALL    ?L?COM0059
B2:00D39B 12216F            LCALL    ?C?ILDPTR
B2:00D39E FF                MOV      R7,A
B2:00D39F 903876            MOV      DPTR,#myOta+08H
B2:00D3A2 E5F0              MOV      A,B
B2:00D3A4 F0                MOVX     @DPTR,A
B2:00D3A5 A3                INC      DPTR
B2:00D3A6 EF                MOV      A,R7
B2:00D3A7 F0                MOVX     @DPTR,A
  528: 
  529:   if(0 != fwTarget)
B2:00D3A8 903C6A            MOV      DPTR,#fwTarget
B2:00D3AB E0                MOVX     A,@DPTR
B2:00D3AC 6008              JZ       ?C0043?OTA_UTIL
  530:   {
  531:      myOta.fwExtern = TRUE;
B2:00D3AE 90387F            MOV      DPTR,#myOta+011H
B2:00D3B1 7401              MOV      A,#01H
B2:00D3B3 F0                MOVX     @DPTR,A
  532:   }
B2:00D3B4 8005              SJMP     ?C0044?OTA_UTIL
B2:00D3B6         ?C0043?OTA_UTIL:
  533:   else
  534:   {
  535:     myOta.fwExtern = FALSE;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 807


B2:00D3B6 E4                CLR      A
B2:00D3B7 90387F            MOV      DPTR,#myOta+011H
B2:00D3BA F0                MOVX     @DPTR,A
  536:   }
B2:00D3BB         ?C0044?OTA_UTIL:
  537: 
  538:   firmware_update_packetsize = fragmentSize;
B2:00D3BB 903C6B            MOV      DPTR,#fragmentSize
B2:00D3BE A3                INC      DPTR
B2:00D3BF E0                MOVX     A,@DPTR
B2:00D3C0 90388A            MOV      DPTR,#firmware_update_packetsize
B2:00D3C3 F0                MOVX     @DPTR,A
  539:   *pStatus = FIRMWARE_UPDATE_MD_REQUEST_REPORT_VALID_COMBINATION_V4;
B2:00D3C4 903C70            MOV      DPTR,#pStatus
B2:00D3C7 122589            LCALL    ?C?PLDXDATA
B2:00D3CA 74FF              MOV      A,#0FFH
B2:00D3CC         
B2:00D3CC 122072            LCALL    ?C?CSTPTR
  540:   m_requestGetStatus = *pStatus;
B2:00D3CF 903C70            MOV      DPTR,#pStatus
B2:00D3D2 12AE26            LCALL    ?L?COM0049
B2:00D3D5 90386D            MOV      DPTR,#m_requestGetStatus
B2:00D3D8 F0                MOVX     @DPTR,A
  541: }
B2:00D3D9 22                RET      
----- FUNCTION _handleCmdClassFirmwareUpdateMdReqGet (END) -------


----- FUNCTION ?L?COM045A (BEGIN) -----
B2:00D3DA 903876            MOV      DPTR,#myOta+08H
B2:00D3DD E0                MOVX     A,@DPTR
B2:00D3DE FE                MOV      R6,A
B2:00D3DF A3                INC      DPTR
B2:00D3E0 E0                MOVX     A,@DPTR
B2:00D3E1 FF                MOV      R7,A
B2:00D3E2 90387C            MOV      DPTR,#myOta+0EH
B2:00D3E5 E0                MOVX     A,@DPTR
B2:00D3E6 22                RET      
----- FUNCTION ?L?COM045A (END) -------


----- FUNCTION ?L?COM0457 (BEGIN) -----
B2:00D3E7 E0                MOVX     A,@DPTR
B2:00D3E8 FA                MOV      R2,A
B2:00D3E9 A3                INC      DPTR
B2:00D3EA E0                MOVX     A,@DPTR
B2:00D3EB FB                MOV      R3,A
B2:00D3EC F582              MOV      DPL,A
B2:00D3EE 8A83              MOV      DPH,R2
B2:00D3F0 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0457 (END) -------


----- FUNCTION InitEvState (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  573: InitEvState()
  574: {
  575:   myOta.fwState = FW_STATE_DISABLE;
  576:   myOta.fw_crcrunning = 0x1D0F;
B2:00D3F3 E4                CLR      A
B2:00D3F4 903874            MOV      DPTR,#myOta+06H
B2:00D3F7 F0                MOVX     @DPTR,A
  577:   myOta.firmwareUpdateReportNumberPrevious = 0;
B2:00D3F8 9109              ACALL    ?L?COM03A2
  578:   myOta.fw_numOfRetries = 0;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 808


B2:00D3FA 903878            MOV      DPTR,#myOta+0AH
B2:00D3FD F0                MOVX     @DPTR,A
  579:   myOta.firmwareCrc = 0;
B2:00D3FE 903876            MOV      DPTR,#myOta+08H
B2:00D401 F0                MOVX     @DPTR,A
B2:00D402 A3                INC      DPTR
B2:00D403 F0                MOVX     @DPTR,A
  580:   myOta.timerFWUpdateCount = 0;
B2:00D404 90387E            MOV      DPTR,#myOta+010H
B2:00D407 F0                MOVX     @DPTR,A
  581: }
B2:00D408 22                RET      
----- FUNCTION InitEvState (END) -------


----- FUNCTION ?L?COM03A2 (BEGIN) -----
B2:00D409 90387C            MOV      DPTR,#myOta+0EH
B2:00D40C 741D              MOV      A,#01DH
B2:00D40E F0                MOVX     @DPTR,A
B2:00D40F A3                INC      DPTR
B2:00D410 740F              MOV      A,#0FH
B2:00D412 F0                MOVX     @DPTR,A
B2:00D413 E4                CLR      A
B2:00D414 90387A            MOV      DPTR,#myOta+0CH
B2:00D417 F0                MOVX     @DPTR,A
B2:00D418 A3                INC      DPTR
B2:00D419 F0                MOVX     @DPTR,A
B2:00D41A 22                RET      
----- FUNCTION ?L?COM03A2 (END) -------


----- FUNCTION Ota_UpdateIsInProgress (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  543: BOOL Ota_UpdateIsInProgress(void)
  544: {
  545:   return (myOta.fwState == FW_STATE_ACTIVE) ? TRUE : FALSE;
  546: }
B2:00D41B 903874            MOV      DPTR,#myOta+06H
B2:00D41E E0                MOVX     A,@DPTR
B2:00D41F B40203            CJNE     A,#02H,?C0045?OTA_UTIL
B2:00D422 D3                SETB     C
B2:00D423 8001              SJMP     ?C0046?OTA_UTIL
B2:00D425         ?C0045?OTA_UTIL:
B2:00D425 C3                CLR      C
B2:00D426         ?C0046?OTA_UTIL:
  547: 
B2:00D426 22                RET      
----- FUNCTION Ota_UpdateIsInProgress (END) -------


----- FUNCTION TimerStartHostResponse (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  903: TimerStartHostResponse(void)
  904: {
  905:   if( 0 == myOta.handleHostResponse )
  906:   {
B2:00D427 903880            MOV      DPTR,#myOta+012H
B2:00D42A E0                MOVX     A,@DPTR
B2:00D42B 7010              JNZ      ?C0110?OTA_UTIL
  907:     myOta.handleHostResponse = ZW_TIMER_START(ZCB_TimerTimeoutHostResponse, HOST_REPONSE_TIMEOUT, TIMER_ONE_TIME)
>> ;
  908:   }
B2:00D42D 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_TimerTimeoutHostResponse
B2:00D42F 7F85              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_TimerTimeoutHostResponse
B2:00D431 FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 809


B2:00D432 7DC8              MOV      R5,#0C8H
B2:00D434 124FFF            LCALL    _TimerStart
B2:00D437 903880            MOV      DPTR,#myOta+012H
B2:00D43A EF                MOV      A,R7
B2:00D43B F0                MOVX     @DPTR,A
  909:   else
B2:00D43C 22                RET      
B2:00D43D         ?C0110?OTA_UTIL:
  910:   {
  911:     ZW_TIMER_RESTART(myOta.handleHostResponse);
B2:00D43D 903880            MOV      DPTR,#myOta+012H
B2:00D440 E0                MOVX     A,@DPTR
B2:00D441 FF                MOV      R7,A
B2:00D442 0246A0            LJMP     _TimerRestart
  912:   }
----- FUNCTION TimerStartHostResponse (END) -------


----- FUNCTION _ZCB_CmdClassFwUpdateMdReqReport (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  548: PCB(ZCB_CmdClassFwUpdateMdReqReport)(BYTE txStatus)
  549: {
;---- Variable 'txStatus' assigned to Register 'R7' ----
  550:   if (FIRMWARE_UPDATE_MD_REQUEST_REPORT_VALID_COMBINATION_V4 != m_requestGetStatus)
  551:   {
B2:00D445 90386D            MOV      DPTR,#m_requestGetStatus
B2:00D448 E0                MOVX     A,@DPTR
B2:00D449 B4FF0C            CJNE     A,#0FFH,?C0049?OTA_UTIL
  552:     // If the request get command failed, nothing was initiated. Hence, don't restart.
  553:     return;
  554:   }
B2:00D44C         ?C0048?OTA_UTIL:
  555:   if(txStatus == TRANSMIT_COMPLETE_OK)
B2:00D44C EF                MOV      A,R7
B2:00D44D 7004              JNZ      ?C0050?OTA_UTIL
  556:   {
  557:     SetEvState(FW_EV_MD_REQUEST_REPORT_SUCCESS);
B2:00D44F 7F02              MOV      R7,#02H
  558:   }
B2:00D451 8002              SJMP     ?C0149?OTA_UTIL
B2:00D453         ?C0050?OTA_UTIL:
  559:   else{
  560:     SetEvState(FW_EV_MD_REQUEST_REPORT_FAILED);
B2:00D453 7F03              MOV      R7,#03H
B2:00D455         
B2:00D455 129571            LCALL    _SetEvState
  561:   }
  562: }
B2:00D458         ?C0049?OTA_UTIL:
B2:00D458 22                RET      
----- FUNCTION _ZCB_CmdClassFwUpdateMdReqReport (END) -------


----- FUNCTION _ZCB_FinishFwUpdate (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  805: PCB(ZCB_FinishFwUpdate)(TRANSMISSION_RESULT * pTransmissionResult)
  806: {
  807:   UNUSED(pTransmissionResult);
  808:   if( NON_NULL( myOta.pOtaFinish ) )
  809:   {
B2:00D459 903872            MOV      DPTR,#myOta+04H
B2:00D45C E0                MOVX     A,@DPTR
B2:00D45D FC                MOV      R4,A
B2:00D45E A3                INC      DPTR
B2:00D45F E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 810


B2:00D460 FD                MOV      R5,A
B2:00D461 4C                ORL      A,R4
B2:00D462 600C              JZ       ?C0098?OTA_UTIL
  810:     myOta.pOtaFinish(myOta.finishStatus);
  811:   }
B2:00D464 903875            MOV      DPTR,#myOta+07H
B2:00D467 E0                MOVX     A,@DPTR
B2:00D468 FF                MOV      R7,A
B2:00D469 8D82              MOV      DPL,R5
B2:00D46B 8C83              MOV      DPH,R4
B2:00D46D 02271A            LJMP     ?C?ICALL2
  812:   else
B2:00D470         ?C0098?OTA_UTIL:
  813:   {
  814:     /*Reoot device only if ota has succeeded*/
  815:     if (OTA_STATUS_DONE == myOta.finishStatus)
B2:00D470 903875            MOV      DPTR,#myOta+07H
B2:00D473 E0                MOVX     A,@DPTR
B2:00D474 7003              JNZ      ?C0101?OTA_UTIL
  816:       Reboot();
B2:00D476 129721            LCALL    Reboot
  817:   }
  818: }
B2:00D479         ?C0101?OTA_UTIL:
B2:00D479 22                RET      
----- FUNCTION _ZCB_FinishFwUpdate (END) -------


----- FUNCTION TimerStartFwUpdateFrameGet (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  862: TimerStartFwUpdateFrameGet(void)
  863: {
  864:   myOta.fw_numOfRetries = 0;
  865:   myOta.timerFWUpdateCount = 0;
B2:00D47A E4                CLR      A
B2:00D47B 903878            MOV      DPTR,#myOta+0AH
B2:00D47E F0                MOVX     @DPTR,A
  866:   if (0 == myOta.timerFwUpdateFrameGetHandle)
B2:00D47F 90387E            MOV      DPTR,#myOta+010H
B2:00D482 F0                MOVX     @DPTR,A
  867:   {
B2:00D483 903879            MOV      DPTR,#myOta+0BH
B2:00D486 E0                MOVX     A,@DPTR
B2:00D487 7016              JNZ      ?C0105?OTA_UTIL
  868:     /* Allocate timer for calling ZCB_TimerOutFwUpdateFrameGet every DIM_TIMER_FREQ, forever */
  869:     myOta.timerFwUpdateFrameGetHandle = ZW_TIMER_START(ZCB_TimerOutFwUpdateFrameGet, FIRMWARE_UPDATE_REQEUST_TIME
>> OUT_UNIT, TIMER_FOREVER);
B2:00D489 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_TimerOutFwUpdateFrameGet
B2:00D48B 7F80              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_TimerOutFwUpdateFrameGet
B2:00D48D 7BFF              MOV      R3,#0FFH
B2:00D48F 7DC8              MOV      R5,#0C8H
B2:00D491 124FFF            LCALL    _TimerStart
B2:00D494 903879            MOV      DPTR,#myOta+0BH
B2:00D497 EF                MOV      A,R7
B2:00D498 F0                MOVX     @DPTR,A
  870:     if (0xFF == myOta.timerFwUpdateFrameGetHandle)
B2:00D499 BFFF0B            CJNE     R7,#0FFH,?C0108?OTA_UTIL
  871:     {
  872:       /* No timer! we update without a timer for retries */
  873:       myOta.timerFwUpdateFrameGetHandle = 0;
B2:00D49C E4                CLR      A
B2:00D49D F0                MOVX     @DPTR,A
  874:     }
  875:   }
B2:00D49E 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 811


B2:00D49F         ?C0105?OTA_UTIL:
  876:   else
  877:   {
  878:     ZW_TIMER_RESTART(myOta.timerFwUpdateFrameGetHandle);
B2:00D49F 903879            MOV      DPTR,#myOta+0BH
B2:00D4A2 E0                MOVX     A,@DPTR
B2:00D4A3 FF                MOV      R7,A
B2:00D4A4 1246A0            LCALL    _TimerRestart
  879:   }
  880: }
B2:00D4A7         ?C0108?OTA_UTIL:
B2:00D4A7 22                RET      
----- FUNCTION TimerStartFwUpdateFrameGet (END) -------


----- FUNCTION ZCB_TimerTimeoutHostResponse (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\OTA_UTIL.C'
  922: PCB(ZCB_TimerTimeoutHostResponse)(void)
  923: {
  924:   SetEvState(FW_EV_UPDATE_STATUS_UNABLE_TO_RECEIVE);
  925: }
B2:00D4A8 7F08              MOV      R7,#08H
B2:00D4AA 029571            LJMP     _SetEvState
----- FUNCTION ZCB_TimerTimeoutHostResponse (END) -------


----- FUNCTION _RequestBufferSetPayloadLength (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
   87: RequestBufferSetPayloadLength(ZW_APPLICATION_TX_BUFFER* pPayload,  BYTE payLoadlen)
   88: {
;---- Variable 'payLoadlen' assigned to Register 'R5' ----
;---- Variable 'pPayload' assigned to Register 'R1/R2/R3' ----
   89:   if(pPayload == &(myMutex.reqTxBuf.appTxBuf))
   90:   {
B2:00D4AD EB                MOV      A,R3
B2:00D4AE 8A83              MOV      DPH,R2
B2:00D4B0 8982              MOV      DPL,R1
B2:00D4B2 6401              XRL      A,#01H
B2:00D4B4 700A              JNZ      ?C0026?ZW_TX_MUTEX
B2:00D4B6 74B1              MOV      A,#LOW myMutex+0EH
B2:00D4B8 6582              XRL      A,DPL
B2:00D4BA 7004              JNZ      ?C0026?ZW_TX_MUTEX
B2:00D4BC 742E              MOV      A,#HIGH myMutex+0EH
B2:00D4BE 6583              XRL      A,DPH
B2:00D4C0         ?C0026?ZW_TX_MUTEX:
B2:00D4C0 7007              JNZ      ?C0004?ZW_TX_MUTEX
   91:     CommandClassSupervisionGetSetPayloadLength(&myMutex.reqTxBuf.supervisionGet, payLoadlen);
   92:     return TRUE;
B2:00D4C2 12B6E0            LCALL    ?L?COM0459
B2:00D4C5 91CB              ACALL    _CommandClassSupervisionGetSetPayloadLength
   93:   }
B2:00D4C7 D3                SETB     C
B2:00D4C8 22                RET      
   94:   return FALSE;
B2:00D4C9         ?C0004?ZW_TX_MUTEX:
   95: }
B2:00D4C9 C3                CLR      C
   96: 
B2:00D4CA 22                RET      
----- FUNCTION _RequestBufferSetPayloadLength (END) -------


----- FUNCTION _CommandClassSupervisionGetSetPayloadLength (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
  322: void CommandClassSupervisionGetSetPayloadLength(ZW_SUPERVISION_GET_FRAME* pbuf, uint8_t payLoadlen)
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 812


  323: {
;---- Variable 'payLoadlen' assigned to Register 'R5' ----
;---- Variable 'pbuf' assigned to Register 'R1/R2/R3' ----
  324:   pbuf->encapsulatedCommandLength = payLoadlen;
  325:   m_CommandLength = payLoadlen;
B2:00D4CB ED                MOV      A,R5
B2:00D4CC 1271DE            LCALL    ?L?COM0378
  326: }
B2:00D4CF 903DA3            MOV      DPTR,#m_CommandLength
B2:00D4D2 ED                MOV      A,R5
B2:00D4D3 F0                MOVX     @DPTR,A
  327: 
B2:00D4D4 22                RET      
----- FUNCTION _CommandClassSupervisionGetSetPayloadLength (END) -------


----- FUNCTION ?L?COM0493 (BEGIN) -----
B2:00D4D5 924B              MOV      ?_RequestBufferSupervisionPayloadActivate?BIT,C
B2:00D4D7 7B01              MOV      R3,#01H
B2:00D4D9 7A36              MOV      R2,#HIGH p_data_hold
B2:00D4DB 7996              MOV      R1,#LOW p_data_hold
----- FUNCTION _RequestBufferSupervisionPayloadActivate (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
   98: RequestBufferSupervisionPayloadActivate(
   99:     ZW_APPLICATION_TX_BUFFER** ppPayload,
B2:00D4DD 904156            MOV      DPTR,#ppPayload
B2:00D4E0 1225A9            LCALL    ?C?PSTXDATA
  100:     BYTE* pPayLoadlen,
  101:     BOOL supervision)
  102: {
  103:   if(TRUE == myMutex.mutexAppActive)
B2:00D4E3 902EA3            MOV      DPTR,#myMutex
B2:00D4E6 E0                MOVX     A,@DPTR
B2:00D4E7 6401              XRL      A,#01H
B2:00D4E9 704B              JNZ      ?C0006?ZW_TX_MUTEX
  104:   {
  105:     /*Rewrite SV-cmd if CCmultichannel has written in payload*/
  106:     CommandClassSupervisionGetWrite(&(myMutex.reqTxBuf.supervisionGet));
B2:00D4EB 12B6E0            LCALL    ?L?COM0459
B2:00D4EE 12CFD8            LCALL    _CommandClassSupervisionGetWrite
  107:     *pPayLoadlen = CommandClassSupervisionGetGetPayloadLength(&(myMutex.reqTxBuf.supervisionGet));
B2:00D4F1 12B6E0            LCALL    ?L?COM0459
B2:00D4F4 B138              ACALL    _CommandClassSupervisionGetGetPayloadLength
B2:00D4F6 904159            MOV      DPTR,#pPayLoadlen
B2:00D4F9 123F95            LCALL    ?L?COM00C0
  108:     if(TRUE == supervision)
B2:00D4FC 7B01              MOV      R3,#01H
B2:00D4FE 304B20            JNB      supervision,?C0007?ZW_TX_MUTEX
  109:     {
  110:       *ppPayload = (ZW_APPLICATION_TX_BUFFER*)&(myMutex.reqTxBuf.supervisionGet);
B2:00D501 7A2E              MOV      R2,#HIGH myMutex+0AH
B2:00D503 79AD              MOV      R1,#LOW myMutex+0AH
B2:00D505 C003              PUSH     AR3
B2:00D507 C002              PUSH     AR2
B2:00D509 C001              PUSH     AR1
B2:00D50B 904156            MOV      DPTR,#ppPayload
B2:00D50E 122589            LCALL    ?C?PLDXDATA
B2:00D511 1225DE            LCALL    ?C?PSTPTR
  111:       *pPayLoadlen += sizeof(ZW_SUPERVISION_GET_FRAME);
B2:00D514 904159            MOV      DPTR,#pPayLoadlen
B2:00D517 122589            LCALL    ?C?PLDXDATA
B2:00D51A 7404              MOV      A,#04H
B2:00D51C 12201D            LCALL    ?C?CILDPTR
  112:     }
B2:00D51F 8013              SJMP     ?C0008?ZW_TX_MUTEX
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 813


B2:00D521         ?C0007?ZW_TX_MUTEX:
  113:     else
  114:     {
  115:       *ppPayload = &(myMutex.reqTxBuf.appTxBuf);
B2:00D521 7A2E              MOV      R2,#HIGH myMutex+0EH
B2:00D523 79B1              MOV      R1,#LOW myMutex+0EH
B2:00D525 C003              PUSH     AR3
B2:00D527 C002              PUSH     AR2
B2:00D529 C001              PUSH     AR1
B2:00D52B 904156            MOV      DPTR,#ppPayload
B2:00D52E 122589            LCALL    ?C?PLDXDATA
B2:00D531 1225DE            LCALL    ?C?PSTPTR
  116:     }
B2:00D534         ?C0008?ZW_TX_MUTEX:
  117:     return TRUE;
B2:00D534 D3                SETB     C
B2:00D535 22                RET      
  118:   }
B2:00D536         ?C0006?ZW_TX_MUTEX:
  119:   return FALSE;
B2:00D536 C3                CLR      C
  120: }
B2:00D537 22                RET      
----- FUNCTION _RequestBufferSupervisionPayloadActivate (END) -------


----- FUNCTION _CommandClassSupervisionGetGetPayloadLength (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
  328: uint8_t CommandClassSupervisionGetGetPayloadLength(ZW_SUPERVISION_GET_FRAME* pbuf)
  329: {
;---- Variable 'pbuf' assigned to Register 'R1/R2/R3' ----
  330:   return pbuf->encapsulatedCommandLength;
  331: }
B2:00D538 128CA5            LCALL    ?L?COM0080
B2:00D53B FF                MOV      R7,A
  331: 
B2:00D53C 22                RET      
----- FUNCTION _CommandClassSupervisionGetGetPayloadLength (END) -------


----- FUNCTION _ZCB_ResponseJobStatus (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  177: PCB(ZCB_ResponseJobStatus)(BYTE txStatus)
  178: {
B2:00D53D 904318            MOV      DPTR,#txStatus
B2:00D540 EF                MOV      A,R7
B2:00D541 F0                MOVX     @DPTR,A
  179:   VOID_CALLBACKFUNC(tmpfunc)(BYTE);
  180:   ZW_DEBUG_MUTEX_SEND_STR("rMCB ");
  181:   ZW_DEBUG_MUTEX_SEND_NL();
  182:   /*Free Mutex*/
  183:   tmpfunc = myMutex.pResponseJob;
B2:00D542 902EA7            MOV      DPTR,#myMutex+04H
B2:00D545 E0                MOVX     A,@DPTR
B2:00D546 FF                MOV      R7,A
B2:00D547 A3                INC      DPTR
B2:00D548 E0                MOVX     A,@DPTR
B2:00D549 904319            MOV      DPTR,#_tmpfunc
B2:00D54C CF                XCH      A,R7
B2:00D54D F0                MOVX     @DPTR,A
B2:00D54E A3                INC      DPTR
B2:00D54F EF                MOV      A,R7
B2:00D550 F0                MOVX     @DPTR,A
  184:   FreeResponseBuffer();
B2:00D551 12A0B6            LCALL    FreeResponseBuffer
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 814


  185:   if(NON_NULL(tmpfunc))
B2:00D554 904319            MOV      DPTR,#_tmpfunc
B2:00D557 E0                MOVX     A,@DPTR
B2:00D558 FC                MOV      R4,A
B2:00D559 A3                INC      DPTR
B2:00D55A E0                MOVX     A,@DPTR
B2:00D55B FD                MOV      R5,A
B2:00D55C 4C                ORL      A,R4
B2:00D55D 6008              JZ       ?C0018?ZW_TX_MUTEX
  186:   {
  187:     tmpfunc(txStatus);
B2:00D55F 904318            MOV      DPTR,#txStatus
B2:00D562 E0                MOVX     A,@DPTR
B2:00D563 FF                MOV      R7,A
B2:00D564 1272EC            LCALL    ?L?COM0491
  188:   }
  189: }
B2:00D567         ?C0018?ZW_TX_MUTEX:
B2:00D567 22                RET      
----- FUNCTION _ZCB_ResponseJobStatus (END) -------


----- FUNCTION _MutexSet (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  208: MutexSet(BYTE* pMutex)
  209: {
;---- Variable 'pMutex' assigned to Register 'R1/R2/R3' ----
  210:   if( FALSE == *pMutex)
  211:   {
B2:00D568 121FB3            LCALL    ?C?CLDPTR
B2:00D56B 7006              JNZ      ?C0020?ZW_TX_MUTEX
  212:     *pMutex = TRUE;
  213:     return TRUE;
B2:00D56D 04                INC      A
B2:00D56E 122072            LCALL    ?C?CSTPTR
  214:   }
B2:00D571 D3                SETB     C
B2:00D572 22                RET      
  215:   return FALSE;
B2:00D573         ?C0020?ZW_TX_MUTEX:
  216: }
B2:00D573 C3                CLR      C
  217: 
B2:00D574 22                RET      
----- FUNCTION _MutexSet (END) -------


----- FUNCTION ZAF_mutex_isActive (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\ZW_TX_MUTEX.C'
  233: ZAF_mutex_isActive(void)
  234: {
  235:   if((TRUE == myMutex.mutexAppActive) || (TRUE == myMutex.mutexResponseActive))
  236:   {
B2:00D575 902EA3            MOV      DPTR,#myMutex
B2:00D578 E0                MOVX     A,@DPTR
B2:00D579 6401              XRL      A,#01H
B2:00D57B 6005              JZ       ?C0024?ZW_TX_MUTEX
B2:00D57D A3                INC      DPTR
B2:00D57E E0                MOVX     A,@DPTR
B2:00D57F B40102            CJNE     A,#01H,?C0023?ZW_TX_MUTEX
B2:00D582         ?C0024?ZW_TX_MUTEX:
  237:     ZW_DEBUG_MUTEX_SEND_STR("Mux");
  238:     return TRUE;
B2:00D582 D3                SETB     C
B2:00D583 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 815


  239:   }
B2:00D584         ?C0023?ZW_TX_MUTEX:
  240:   return FALSE;
B2:00D584 C3                CLR      C
  241: }
B2:00D585 22                RET      
----- FUNCTION ZAF_mutex_isActive (END) -------


----- FUNCTION _Transport_AddEndpointSupport (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
   92: Transport_AddEndpointSupport( EP_FUNCTIONALITY_DATA* pFunctionality, EP_NIF* pList, BYTE sizeList)
   93: {
;---- Variable 'pFunctionality' assigned to Register 'R1/R2/R3' ----
   94:   myTransportEndpoint.pFunctionality = pFunctionality;
   95:   myTransportEndpoint.pList = pList;
B2:00D586 9035F5            MOV      DPTR,#myTransportEndpoint+01H
B2:00D589 1225A9            LCALL    ?C?PSTXDATA
   96:   myTransportEndpoint.sizeList = sizeList;
B2:00D58C 9040A2            MOV      DPTR,#pList
B2:00D58F 122589            LCALL    ?C?PLDXDATA
B2:00D592 9035F9            MOV      DPTR,#myTransportEndpoint+05H
B2:00D595 1225A9            LCALL    ?C?PSTXDATA
   97:   myTransportEndpoint.pMaskArray = NULL;
B2:00D598 9040A5            MOV      DPTR,#sizeList
B2:00D59B E0                MOVX     A,@DPTR
B2:00D59C 9035F8            MOV      DPTR,#myTransportEndpoint+04H
B2:00D59F 12B298            LCALL    ?L?COM0068
B2:00D5A2 9035FC            MOV      DPTR,#myTransportEndpoint+08H
B2:00D5A5 1225A9            LCALL    ?C?PSTXDATA
   98:   myTransportEndpoint.sizeAggGroupArray = 0;
B2:00D5A8 E4                CLR      A
B2:00D5A9 9035FF            MOV      DPTR,#myTransportEndpoint+0BH
B2:00D5AC F0                MOVX     @DPTR,A
   99:   myTransportEndpoint.flag_supervision_encap = FALSE;
B2:00D5AD 9035F4            MOV      DPTR,#myTransportEndpoint
B2:00D5B0 F0                MOVX     @DPTR,A
  100: }
B2:00D5B1 22                RET      
----- FUNCTION _Transport_AddEndpointSupport (END) -------


----- FUNCTION _Transport_SetupAggregationGroups (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  111: Transport_SetupAggregationGroups(AGGREGATED_GROUP_BIT_MASK* pMaskArray, BYTE sizeArray)
  112: {
B2:00D5B2 90431B            MOV      DPTR,#pMaskArray
B2:00D5B5 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'sizeArray' assigned to Register 'R5' ----
  113:   if(myTransportEndpoint.pFunctionality->bits.nbrAggregatedEndpoints == sizeArray)
  114:   {
B2:00D5B8 9035F5            MOV      DPTR,#myTransportEndpoint+01H
B2:00D5BB 12A5A3            LCALL    ?L?COM001F
B2:00D5BE 121FF0            LCALL    ?C?CLDOPTR
B2:00D5C1 547F              ANL      A,#07FH
B2:00D5C3 B50511            CJNE     A,AR5,?C0003?ZW_TRANSPORTENDPOINT
  115:     myTransportEndpoint.pMaskArray = pMaskArray;
  116:     myTransportEndpoint.sizeAggGroupArray = sizeArray;
B2:00D5C6 90431B            MOV      DPTR,#pMaskArray
B2:00D5C9 122589            LCALL    ?C?PLDXDATA
B2:00D5CC 9035FC            MOV      DPTR,#myTransportEndpoint+08H
B2:00D5CF 1225A9            LCALL    ?C?PSTXDATA
  117:   }
B2:00D5D2 9035FF            MOV      DPTR,#myTransportEndpoint+0BH
B2:00D5D5 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 816


B2:00D5D6 F0                MOVX     @DPTR,A
  118: }
  119: 
B2:00D5D7         ?C0003?ZW_TRANSPORTENDPOINT:
B2:00D5D7 22                RET      
----- FUNCTION _Transport_SetupAggregationGroups (END) -------


----- FUNCTION _ConvertEnumKeytoBitKey (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  149: BYTE ConvertEnumKeytoBitKey(enum SECURITY_KEY eKey)
  150: {
;---- Variable 'eKey' assigned to Register 'R7' ----
  151:   return eKeyToBitKey[eKey];
  152: }
B2:00D5D8 7404              MOV      A,#LOW eKeyToBitKey
B2:00D5DA 2F                ADD      A,R7
B2:00D5DB F582              MOV      DPL,A
B2:00D5DD E4                CLR      A
B2:00D5DE 3436              ADDC     A,#HIGH eKeyToBitKey
B2:00D5E0 F583              MOV      DPH,A
B2:00D5E2 E0                MOVX     A,@DPTR
B2:00D5E3 FF                MOV      R7,A
  153: 
B2:00D5E4 22                RET      
----- FUNCTION _ConvertEnumKeytoBitKey (END) -------


----- FUNCTION _GetEndpointDeviceClass (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  160: GetEndpointDeviceClass( BYTE endpoint)
  161: {
B2:00D5E5 9043B2            MOV      DPTR,#endpoint
B2:00D5E8 EF                MOV      A,R7
B2:00D5E9 F0                MOVX     @DPTR,A
  162:   static DEVICE_CLASS devClass;
  163:   ZW_DEBUG_SEND_NL();
  164:   ZW_DEBUG_SEND_STR("GetEndpointDeviceClass ");
  165:   ZW_DEBUG_SEND_NUM(endpoint);
  166: 
  167:   if( (endpoint > myTransportEndpoint.sizeList) || (0 == endpoint) )
B2:00D5EA 9035F8            MOV      DPTR,#myTransportEndpoint+04H
B2:00D5ED E0                MOVX     A,@DPTR
B2:00D5EE FE                MOV      R6,A
B2:00D5EF EF                MOV      A,R7
B2:00D5F0 D3                SETB     C
B2:00D5F1 9E                SUBB     A,R6
B2:00D5F2 5007              JNC      ?C0008?ZW_TRANSPORTENDPOINT
B2:00D5F4 9043B2            MOV      DPTR,#endpoint
B2:00D5F7 E0                MOVX     A,@DPTR
B2:00D5F8 FF                MOV      R7,A
B2:00D5F9 7003              JNZ      ?C0007?ZW_TRANSPORTENDPOINT
B2:00D5FB         ?C0008?ZW_TRANSPORTENDPOINT:
  168:   {
  169:     return NULL;
B2:00D5FB 02B299            LJMP     ?L?COM0069
  170:   }
B2:00D5FE         ?C0007?ZW_TRANSPORTENDPOINT:
  171: 
  172:   devClass.genericDeviceClass = myTransportEndpoint.pList[endpoint - 1].genericDeviceClass;
B2:00D5FE EF                MOV      A,R7
B2:00D5FF D123              ACALL    ?L?COM0300
B2:00D601 1282AD            LCALL    ?L?COM0086
B2:00D604 90FFF2            MOV      DPTR,#0FFF2H
B2:00D607 121FF0            LCALL    ?C?CLDOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 817


B2:00D60A 9035DC            MOV      DPTR,#devClass
B2:00D60D F0                MOVX     @DPTR,A
  173:   devClass.specificDeviceClass = myTransportEndpoint.pList[endpoint - 1].specificDeviceClass;
B2:00D60E 90FFF3            MOV      DPTR,#0FFF3H
B2:00D611 121FF0            LCALL    ?C?CLDOPTR
B2:00D614 9035DD            MOV      DPTR,#devClass+01H
B2:00D617 F0                MOVX     @DPTR,A
  174: 
  175:   return &devClass;
B2:00D618 7B01              MOV      R3,#01H
B2:00D61A 7A35              MOV      R2,#HIGH devClass
B2:00D61C 79DC              MOV      R1,#LOW devClass
  176: }
B2:00D61E 22                RET      
----- FUNCTION _GetEndpointDeviceClass (END) -------


----- FUNCTION ?L?COM02FE (BEGIN) -----
B2:00D61F 9043B3            MOV      DPTR,#endpoint
B2:00D622         ?L?COM02FF:
B2:00D622 E0                MOVX     A,@DPTR
B2:00D623         ?L?COM0300:
B2:00D623 75F00E            MOV      B,#0EH
B2:00D626 A4                MUL      AB
B2:00D627 FF                MOV      R7,A
B2:00D628 9035F9            MOV      DPTR,#myTransportEndpoint+05H
B2:00D62B 22                RET      
----- FUNCTION ?L?COM02FE (END) -------


----- FUNCTION _FindEndPoints (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  221: FindEndPoints( BYTE genDeviceClass, BYTE specDeviceClass, BYTE* pEp)
  222: {
B2:00D62C 9040A6            MOV      DPTR,#genDeviceClass
B2:00D62F 124765            LCALL    ?L?COM0102
B2:00D632 1225A9            LCALL    ?C?PSTXDATA
  223:   BYTE i;
  224:   BYTE len =0;
B2:00D635 E4                CLR      A
B2:00D636 9040AC            MOV      DPTR,#len
B2:00D639 F0                MOVX     @DPTR,A
  225:   TED_( ZW_DEBUG_SEND_NL();)
  226:   TED_( ZW_DEBUG_SEND_STR("TED: FindNextEndPoint ");)
  227:   TED_( ZW_DEBUG_SEND_NUM(genDeviceClass);)
  228:   TED_( ZW_DEBUG_SEND_NUM(specDeviceClass);)
  229: 
  230:   for(i = 0; i < myTransportEndpoint.sizeList; i++)
B2:00D63A 9040AB            MOV      DPTR,#i
B2:00D63D F0                MOVX     @DPTR,A
B2:00D63E         ?C0019?ZW_TRANSPORTENDPOINT:
B2:00D63E 9035F8            MOV      DPTR,#myTransportEndpoint+04H
B2:00D641 E0                MOVX     A,@DPTR
B2:00D642 FF                MOV      R7,A
B2:00D643 9040AB            MOV      DPTR,#i
B2:00D646 E0                MOVX     A,@DPTR
B2:00D647 FE                MOV      R6,A
B2:00D648 C3                CLR      C
B2:00D649 9F                SUBB     A,R7
B2:00D64A 5058              JNC      ?C0020?ZW_TRANSPORTENDPOINT
  231:   {
  232:     if( ((0xFF == genDeviceClass) && (0xFF == specDeviceClass) ) ||
B2:00D64C 9040A6            MOV      DPTR,#genDeviceClass
B2:00D64F E0                MOVX     A,@DPTR
B2:00D650 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 818


B2:00D651 B4FF05            CJNE     A,#0FFH,?C0024?ZW_TRANSPORTENDPOINT
B2:00D654 A3                INC      DPTR
B2:00D655 E0                MOVX     A,@DPTR
B2:00D656 F4                CPL      A
B2:00D657 602B              JZ       ?C0023?ZW_TRANSPORTENDPOINT
B2:00D659         ?C0024?ZW_TRANSPORTENDPOINT:
B2:00D659 9035F9            MOV      DPTR,#myTransportEndpoint+05H
B2:00D65C 122589            LCALL    ?C?PLDXDATA
B2:00D65F 75F00E            MOV      B,#0EH
B2:00D662 EE                MOV      A,R6
B2:00D663 127103            LCALL    ?L?COM0273
B2:00D666 121FF0            LCALL    ?C?CLDOPTR
B2:00D669 6F                XRL      A,R7
B2:00D66A 7030              JNZ      ?C0021?ZW_TRANSPORTENDPOINT
B2:00D66C 9040AB            MOV      DPTR,#i
B2:00D66F D122              ACALL    ?L?COM02FF
B2:00D671 1282AD            LCALL    ?L?COM0086
B2:00D674 12B3A2            LCALL    ?L?COM0182
B2:00D677 FF                MOV      R7,A
B2:00D678 9040A7            MOV      DPTR,#specDeviceClass
B2:00D67B E0                MOVX     A,@DPTR
B2:00D67C FE                MOV      R6,A
B2:00D67D 6F                XRL      A,R7
B2:00D67E 6004              JZ       ?C0023?ZW_TRANSPORTENDPOINT
B2:00D680 EE                MOV      A,R6
B2:00D681 B4FF18            CJNE     A,#0FFH,?C0021?ZW_TRANSPORTENDPOINT
B2:00D684         ?C0023?ZW_TRANSPORTENDPOINT:
  233:         ((genDeviceClass == myTransportEndpoint.pList[i].genericDeviceClass) &&
  234:          ((specDeviceClass == myTransportEndpoint.pList[i].specificDeviceClass) ||
  235:          (specDeviceClass == 0xFF)))
  236:       )
  237:     {
  238:       pEp[len++] = i + 1; /* Add one endpoint is from 1 to 127*/
B2:00D684 9040AB            MOV      DPTR,#i
B2:00D687 E0                MOVX     A,@DPTR
B2:00D688 04                INC      A
B2:00D689 FF                MOV      R7,A
B2:00D68A 9040A8            MOV      DPTR,#pEp
B2:00D68D 122589            LCALL    ?C?PLDXDATA
B2:00D690 9040AC            MOV      DPTR,#len
B2:00D693 E0                MOVX     A,@DPTR
B2:00D694 FE                MOV      R6,A
B2:00D695 04                INC      A
B2:00D696 F0                MOVX     @DPTR,A
B2:00D697 8E82              MOV      DPL,R6
B2:00D699 1271E7            LCALL    ?L?COM037C
  239:       TED_( ZW_DEBUG_SEND_STR("ep ");)
  240:       TED_( ZW_DEBUG_SEND_NUM(*(pEp + len - 1));)
  241:     }
  242:     TED_( ZW_DEBUG_SEND_BYTE('.');)
  243:   }
B2:00D69C         ?C0021?ZW_TRANSPORTENDPOINT:
B2:00D69C 9040AB            MOV      DPTR,#i
B2:00D69F E0                MOVX     A,@DPTR
B2:00D6A0 04                INC      A
B2:00D6A1 F0                MOVX     @DPTR,A
B2:00D6A2 809A              SJMP     ?C0019?ZW_TRANSPORTENDPOINT
B2:00D6A4         ?C0020?ZW_TRANSPORTENDPOINT:
  244:   if( 0 == len)
B2:00D6A4 9040AC            MOV      DPTR,#len
B2:00D6A7 E0                MOVX     A,@DPTR
B2:00D6A8 7008              JNZ      ?C0026?ZW_TRANSPORTENDPOINT
  245:   {
  246:     /* deliver an endpoint list with EP1 = 0 */
  247:     len = 1;
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 819


B2:00D6AA 04                INC      A
B2:00D6AB F0                MOVX     @DPTR,A
  248:     pEp[0] = 0;
B2:00D6AC 9040A8            MOV      DPTR,#pEp
B2:00D6AF 127111            LCALL    ?L?COM0287
  249:   }
B2:00D6B2         ?C0026?ZW_TRANSPORTENDPOINT:
  250:   TED_( ZW_DEBUG_SEND_STR(" len=");)
  251:   TED_( ZW_DEBUG_SEND_NUM(len);)
  252:   TED_( ZW_DEBUG_SEND_NL();)
  253:   return len;
B2:00D6B2 9040AC            MOV      DPTR,#len
B2:00D6B5 E0                MOVX     A,@DPTR
B2:00D6B6 FF                MOV      R7,A
  254: }
B2:00D6B7 22                RET      
----- FUNCTION _FindEndPoints (END) -------


----- FUNCTION _Transport_ApplicationCommandHandler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  357: void Transport_ApplicationCommandHandler(
  358:     ZW_APPLICATION_TX_BUFFER * pCmd,
B2:00D6B8 903D1F            MOV      DPTR,#pCmd
B2:00D6BB 1225A9            LCALL    ?C?PSTXDATA
B2:00D6BE 903D22            MOV      DPTR,#cmdLength
B2:00D6C1 ED                MOV      A,R5
B2:00D6C2 F0                MOVX     @DPTR,A
  359:     BYTE cmdLength,
  360:     RECEIVE_OPTIONS_TYPE * rxOpt)
  361: {
  362:   RECEIVE_OPTIONS_TYPE_EX rxOptEx;
  363:   rxOptEx.rxStatus = rxOpt->rxStatus;
B2:00D6C3 A3                INC      DPTR
B2:00D6C4 12AE26            LCALL    ?L?COM0049
B2:00D6C7 903D26            MOV      DPTR,#rxOptEx
B2:00D6CA F0                MOVX     @DPTR,A
  364:   rxOptEx.securityKey = rxOpt->securityKey;
B2:00D6CB 1270EB            LCALL    ?L?COM01E4
B2:00D6CE 903D27            MOV      DPTR,#rxOptEx+01H
B2:00D6D1 F0                MOVX     @DPTR,A
  365:   rxOptEx.sourceNode.nodeId = rxOpt->sourceNode;
B2:00D6D2 12B3A2            LCALL    ?L?COM0182
B2:00D6D5 903D28            MOV      DPTR,#rxOptEx+02H
B2:00D6D8 F0                MOVX     @DPTR,A
  366:   rxOptEx.sourceNode.endpoint = 0;
B2:00D6D9 A3                INC      DPTR
B2:00D6DA E0                MOVX     A,@DPTR
B2:00D6DB 5480              ANL      A,#080H
B2:00D6DD F0                MOVX     @DPTR,A
  367:   rxOptEx.destNode.endpoint = 0;
B2:00D6DE 903D2B            MOV      DPTR,#rxOptEx+05H
B2:00D6E1 F17F              ACALL    ?L?COM049D
B2:00D6E3 F0                MOVX     @DPTR,A
  368:   rxOptEx.destNode.BitAddress = 0;
  369:   if( COMMAND_CLASS_MULTI_CHANNEL_V3 == pCmd->ZW_Common.cmdClass)
B2:00D6E4 903D1F            MOV      DPTR,#pCmd
B2:00D6E7 12AE26            LCALL    ?L?COM0049
B2:00D6EA 903D1F            MOV      DPTR,#pCmd
B2:00D6ED B46015            CJNE     A,#060H,?C0037?ZW_TRANSPORTENDPOINT
  370:   {
  371:     MultiChanCommandHandler(&rxOptEx, pCmd, cmdLength);
B2:00D6F0 122589            LCALL    ?C?PLDXDATA
B2:00D6F3 903A46            MOV      DPTR,#?_MultiChanCommandHandler?BYTE+03H
B2:00D6F6 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 820


B2:00D6F9 903D22            MOV      DPTR,#cmdLength
B2:00D6FC E0                MOVX     A,@DPTR
B2:00D6FD 903A49            MOV      DPTR,#?_MultiChanCommandHandler?BYTE+06H
B2:00D700 F117              ACALL    ?L?COM05ED
B2:00D702 028CD7            LJMP     _MultiChanCommandHandler
  372:   }
B2:00D705         ?C0037?ZW_TRANSPORTENDPOINT:
  373:   else
  374:   {
  375:     Transport_ApplicationCommandHandlerEx(&rxOptEx, pCmd, cmdLength);
B2:00D705 122589            LCALL    ?C?PLDXDATA
B2:00D708 12955D            LCALL    ?L?COM050A
B2:00D70B 903D22            MOV      DPTR,#cmdLength
B2:00D70E E0                MOVX     A,@DPTR
B2:00D70F 903FE2            MOV      DPTR,#?_Transport_ApplicationCommandHandlerEx?BYTE+06H
B2:00D712 F117              ACALL    ?L?COM05ED
B2:00D714 029755            LJMP     _Transport_ApplicationCommandHandlerEx
  376:   }
----- FUNCTION _Transport_ApplicationCommandHandler (END) -------


----- FUNCTION ?L?COM05ED (BEGIN) -----
B2:00D717 F0                MOVX     @DPTR,A
B2:00D718 7B01              MOV      R3,#01H
B2:00D71A 7A3D              MOV      R2,#HIGH rxOptEx
B2:00D71C 7926              MOV      R1,#LOW rxOptEx
B2:00D71E 22                RET      
----- FUNCTION ?L?COM05ED (END) -------


----- FUNCTION _ZCB_RequestCompleted (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  432: PCB(ZCB_RequestCompleted)(BYTE txStatus, TX_STATUS_TYPE* extendedTxStatus)
  433: {
;---- Variable 'txStatus' assigned to Register 'R7' ----
  434:   TRANSMISSION_RESULT transmissionResult;
  435:   UNUSED(extendedTxStatus);
  436: 
  437:   transmissionResult.nodeId = 0;
B2:00D71F E4                CLR      A
B2:00D720 904321            MOV      DPTR,#transmissionResult
B2:00D723 F0                MOVX     @DPTR,A
  438:   transmissionResult.status = txStatus;
B2:00D724 A3                INC      DPTR
B2:00D725 EF                MOV      A,R7
B2:00D726 F0                MOVX     @DPTR,A
  439:   transmissionResult.isFinished = TRANSMISSION_RESULT_FINISHED;
B2:00D727 A3                INC      DPTR
B2:00D728 7401              MOV      A,#01H
B2:00D72A F0                MOVX     @DPTR,A
  440:   if (NON_NULL(pCallbackRequest))
B2:00D72B 90360B            MOV      DPTR,#_pCallbackRequest
B2:00D72E 1296A4            LCALL    ?L?COM0137
B2:00D731 6009              JZ       ?C0048?ZW_TRANSPORTENDPOINT
  441:   {
  442:     pCallbackRequest(&transmissionResult);
B2:00D733 7B01              MOV      R3,#01H
B2:00D735 7A43              MOV      R2,#HIGH transmissionResult
B2:00D737 7921              MOV      R1,#LOW transmissionResult
B2:00D739 12B449            LCALL    ?L?COM0364
  443:   }
  444: #ifndef NON_BATT
  445:   ZAF_pm_KeepAwakeAuto();
  446: #endif
  447: }
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 821


B2:00D73C         ?C0048?ZW_TRANSPORTENDPOINT:
B2:00D73C 22                RET      
----- FUNCTION _ZCB_RequestCompleted (END) -------


----- FUNCTION _ApplicationCommandHandler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  370: ApplicationCommandHandler(
  371:   ZW_APPLICATION_TX_BUFFER *pCmd, /* IN Payload from the received frame, */
B2:00D73D 9040AD            MOV      DPTR,#pCmd
B2:00D740 1225A9            LCALL    ?C?PSTXDATA
B2:00D743 9040B0            MOV      DPTR,#cmdLength
B2:00D746 ED                MOV      A,R5
B2:00D747 F0                MOVX     @DPTR,A
  372:                                   /*    the command is the very first byte */
  373:   BYTE cmdLength,                 /* IN Number of command bytes including the command */
  374:   RECEIVE_OPTIONS_TYPE *rxOpt)    /* rxOpt struct to use (may be partially filled out if
  375:                                      parsing encapsulated command */
  376: {
  377:   ZW_DEBUG_SECURITY_SEND_STR("\r\nAppCmdH ");
  378:   ZW_DEBUG_SECURITY_SEND_BYTE(' ');
  379:   ZW_DEBUG_SECURITY_SEND_NUM(rxOpt->securityKey);
  380:   ZW_DEBUG_SECURITY_SEND_BYTE(' ');
  381:   ZW_DEBUG_SECURITY_SEND_NUM(pCmd->ZW_Common.cmdClass);
  382:   ZW_DEBUG_SECURITY_SEND_NUM(pCmd->ZW_Common.cmd);
  383:   ZW_DEBUG_SECURITY_SEND_STR("\r\nm_AppInfo size");
  384:   ZW_DEBUG_SECURITY_SEND_NUM(m_AppInfo.u.pNifs->cmdClassListSecureCount);
  385:   ZW_DEBUG_SECURITY_SEND_NUM(m_AppInfo.activeNonsecureList.size);
  386:   ZW_DEBUG_SECURITY_SEND_NL();
  387: 
  388: #ifndef ACCEPT_ALL_CMD_CLASSES
  389:   /* Check if cmd Class are supported in current mode (unsecure or secure) */
  390:   if (TRUE == CmdClassSupported(rxOpt->securityKey,
B2:00D748 A3                INC      DPTR
B2:00D749 122589            LCALL    ?C?PLDXDATA
B2:00D74C 1270EB            LCALL    ?L?COM01E4
B2:00D74F FF                MOV      R7,A
B2:00D750 9040AD            MOV      DPTR,#pCmd
B2:00D753 12AE26            LCALL    ?L?COM0049
B2:00D756 12B3A1            LCALL    ?L?COM0181
B2:00D759 FB                MOV      R3,A
B2:00D75A C003              PUSH     AR3
B2:00D75C F195              ACALL    ?L?COM018D
B2:00D75E D003              POP      AR3
B2:00D760 128F47            LCALL    _CmdClassSupported
B2:00D763 5017              JNC      ?C0043?ZW_TRANSPORTSECPROTOCOL
  391:                                 pCmd->ZW_Common.cmdClass,
  392:                                 pCmd->ZW_Common.cmd,
  393:                                 m_AppInfo.u.pNifs->cmdClassListSecure,
  394:                                 m_AppInfo.u.pNifs->cmdClassListSecureCount,
  395:                                 m_AppInfo.activeNonsecureList.pList,
  396:                                 m_AppInfo.activeNonsecureList.size))
  397: #endif /* ACCEPT_ALL_CMD_CLASSES */
  398:   {
  399: 		Transport_ApplicationCommandHandler(pCmd, cmdLength, rxOpt);
B2:00D765 9040B0            MOV      DPTR,#cmdLength
B2:00D768 E0                MOVX     A,@DPTR
B2:00D769 FD                MOV      R5,A
B2:00D76A A3                INC      DPTR
B2:00D76B 122589            LCALL    ?C?PLDXDATA
B2:00D76E 903D23            MOV      DPTR,#?_Transport_ApplicationCommandHandler?BYTE+04H
B2:00D771 1225A9            LCALL    ?C?PSTXDATA
B2:00D774 9040AD            MOV      DPTR,#pCmd
B2:00D777 122589            LCALL    ?C?PLDXDATA
B2:00D77A D1B8              ACALL    _Transport_ApplicationCommandHandler
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 822


  400: #ifndef NON_BATT
  401: 		ZAF_pm_KeepAwakeAuto();
  402: #endif
  403:   }
  404: #ifndef ACCEPT_ALL_CMD_CLASSES
  405:   else
  406:   {
  407:     ZW_DEBUG_SECURITY_SEND_NL();
  408:     ZW_DEBUG_SECURITY_SEND_STR("CmdCl not supported :(");
  409:     ZW_DEBUG_SECURITY_SEND_NL();
  410:   }
  411: #endif /* ACCEPT_ALL_CMD_CLASSES */
  412: }
B2:00D77C         ?C0043?ZW_TRANSPORTSECPROTOCOL:
B2:00D77C 22                RET      
----- FUNCTION _ApplicationCommandHandler (END) -------


----- FUNCTION ?L?COM049C (BEGIN) -----
B2:00D77D F0                MOVX     @DPTR,A
B2:00D77E A3                INC      DPTR
B2:00D77F         ?L?COM049D:
B2:00D77F E0                MOVX     A,@DPTR
B2:00D780 5480              ANL      A,#080H
B2:00D782 F0                MOVX     @DPTR,A
B2:00D783 547F              ANL      A,#07FH
B2:00D785 22                RET      
----- FUNCTION ?L?COM049C (END) -------


----- FUNCTION _ZCB_ResponseCompleted (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  449: PCB(ZCB_ResponseCompleted)(BYTE txStatus, TX_STATUS_TYPE* extendedTxStatus)
  450: {
;---- Variable 'txStatus' assigned to Register 'R7' ----
  451:   UNUSED(extendedTxStatus);
  452:   if (NON_NULL(pCallbackResponse))
  453:   {
B2:00D786 903609            MOV      DPTR,#_pCallbackResponse
B2:00D789 E0                MOVX     A,@DPTR
B2:00D78A FC                MOV      R4,A
B2:00D78B A3                INC      DPTR
B2:00D78C E0                MOVX     A,@DPTR
B2:00D78D FD                MOV      R5,A
B2:00D78E 4C                ORL      A,R4
B2:00D78F 6003              JZ       ?C0050?ZW_TRANSPORTENDPOINT
  454:     pCallbackResponse(txStatus);
  455:   }
B2:00D791 1272EC            LCALL    ?L?COM0491
  456: #ifndef NON_BATT
  457:   ZAF_pm_KeepAwakeAuto();
  458: #endif
  459: }
B2:00D794         ?C0050?ZW_TRANSPORTENDPOINT:
B2:00D794 22                RET      
----- FUNCTION _ZCB_ResponseCompleted (END) -------


----- FUNCTION ?L?COM018D (BEGIN) -----
B2:00D795 903614            MOV      DPTR,#m_AppInfo
B2:00D798 122589            LCALL    ?C?PLDXDATA
B2:00D79B 900008            MOV      DPTR,#08H
B2:00D79E 12262D            LCALL    ?C?PLDOPTR
B2:00D7A1 903DEA            MOV      DPTR,#?_CmdClassSupported?BYTE+03H
B2:00D7A4 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 823


B2:00D7A7 903614            MOV      DPTR,#m_AppInfo
B2:00D7AA 122589            LCALL    ?C?PLDXDATA
B2:00D7AD 90000B            MOV      DPTR,#0BH
B2:00D7B0 121FF0            LCALL    ?C?CLDOPTR
B2:00D7B3 903DED            MOV      DPTR,#?_CmdClassSupported?BYTE+06H
B2:00D7B6 F0                MOVX     @DPTR,A
B2:00D7B7 903617            MOV      DPTR,#m_AppInfo+03H
B2:00D7BA 122589            LCALL    ?C?PLDXDATA
B2:00D7BD 903DEE            MOV      DPTR,#?_CmdClassSupported?BYTE+07H
B2:00D7C0 1225A9            LCALL    ?C?PSTXDATA
B2:00D7C3 90361A            MOV      DPTR,#m_AppInfo+06H
B2:00D7C6 E0                MOVX     A,@DPTR
B2:00D7C7 903DF1            MOV      DPTR,#?_CmdClassSupported?BYTE+0AH
B2:00D7CA F0                MOVX     @DPTR,A
B2:00D7CB 22                RET      
----- FUNCTION ?L?COM018D (END) -------


----- FUNCTION _TransportCmdClassSupported (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  416: TransportCmdClassSupported(uint8_t commandClass,
  417:                            uint8_t command,
;---- Variable 'commandClass' assigned to Register 'R6' ----
B2:00D7CC AE07              MOV      R6,AR7
;---- Variable 'eKey' assigned to Register 'R3' ----
;---- Variable 'command' assigned to Register 'R4' ----
B2:00D7CE AC05              MOV      R4,AR5
  418:                            enum SECURITY_KEY eKey)
  419: {
  420:   return CmdClassSupported(eKey,
B2:00D7D0 AF03              MOV      R7,AR3
B2:00D7D2 AD06              MOV      R5,AR6
B2:00D7D4 AE04              MOV      R6,AR4
B2:00D7D6 AB06              MOV      R3,AR6
B2:00D7D8 C003              PUSH     AR3
B2:00D7DA F195              ACALL    ?L?COM018D
B2:00D7DC D003              POP      AR3
B2:00D7DE 028F47            LJMP     _CmdClassSupported
  421:                            commandClass,
  422:                            command,
  423:                            m_AppInfo.u.pNifs->cmdClassListSecure,
  424:                            m_AppInfo.u.pNifs->cmdClassListSecureCount,
  425:                            m_AppInfo.activeNonsecureList.pList,
  426:                            m_AppInfo.activeNonsecureList.size);
----- FUNCTION _TransportCmdClassSupported (END) -------


----- FUNCTION SetFlagSupervisionEncap (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTENDPOINT.C'
  463: SetFlagSupervisionEncap(BOOL flag)
  464: {
  465:   myTransportEndpoint.flag_supervision_encap = flag;
  466: }
B2:00D7E1 A24F              MOV      C,flag
B2:00D7E3 E4                CLR      A
B2:00D7E4 33                RLC      A
B2:00D7E5 9035F4            MOV      DPTR,#myTransportEndpoint
B2:00D7E8 F0                MOVX     @DPTR,A
  467: 
B2:00D7E9 22                RET      
----- FUNCTION SetFlagSupervisionEncap (END) -------


----- FUNCTION _Transport_OnApplicationInitHW (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 824


  145: BOOL Transport_OnApplicationInitHW(uint8_t bStatus)
  146: {
  147:   UNUSED(bStatus);
  148:   return TRUE;
  149: }
B2:00D7EA D3                SETB     C
  150: 
B2:00D7EB 22                RET      
----- FUNCTION _Transport_OnApplicationInitHW (END) -------


----- FUNCTION _CheckCmdClass (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_CMD_CLASS_LIST.C'
   61: CheckCmdClass(BYTE cmdClass,
   62:               BYTE *pList,
B2:00D7EC 9041E6            MOV      DPTR,#pList
B2:00D7EF 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'cmdClass' assigned to Register 'R7' ----
   63:               BYTE len)
   64: {
   65:   BYTE i;
   66:   for( i = 0; i < len; i++)
;---- Variable 'i' assigned to Register 'R6' ----
B2:00D7F2 E4                CLR      A
B2:00D7F3 FE                MOV      R6,A
B2:00D7F4         ?C0001?ZW_CMD_CLASS_LIST:
B2:00D7F4 9041E9            MOV      DPTR,#len
B2:00D7F7 E0                MOVX     A,@DPTR
B2:00D7F8 FD                MOV      R5,A
B2:00D7F9 EE                MOV      A,R6
B2:00D7FA C3                CLR      C
B2:00D7FB 9D                SUBB     A,R5
B2:00D7FC 5013              JNC      ?C0002?ZW_CMD_CLASS_LIST
   67:   {
   68:     if(*(pList+i) == cmdClass)
B2:00D7FE 9041E6            MOV      DPTR,#pList
B2:00D801 122589            LCALL    ?C?PLDXDATA
B2:00D804 8E82              MOV      DPL,R6
B2:00D806 126DCA            LCALL    ?L?COM01DA
B2:00D809 B50702            CJNE     A,AR7,?C0003?ZW_CMD_CLASS_LIST
   69:     {
   70:       ZW_DEBUG_CMDCLIST_SEND_STR("CheckCmdC success ");
   71:       ZW_DEBUG_CMDCLIST_SEND_NUM(cmdClass);
   72:       ZW_DEBUG_CMDCLIST_SEND_NL();
   73:       return TRUE;
B2:00D80C D3                SETB     C
B2:00D80D 22                RET      
   74:     }
   75:   }
B2:00D80E         ?C0003?ZW_CMD_CLASS_LIST:
B2:00D80E 0E                INC      R6
B2:00D80F 80E3              SJMP     ?C0001?ZW_CMD_CLASS_LIST
B2:00D811         ?C0002?ZW_CMD_CLASS_LIST:
   76:   ZW_DEBUG_CMDCLIST_SEND_STR("CheckCmdClass fail cmd: ");
   77:   ZW_DEBUG_CMDCLIST_SEND_NUM(cmdClass);
   78:   ZW_DEBUG_CMDCLIST_SEND_NUM(len);
   79:   ZW_DEBUG_CMDCLIST_SEND_NL();
   80:   return FALSE;
B2:00D811 C3                CLR      C
   81: }
B2:00D812 22                RET      
----- FUNCTION _CheckCmdClass (END) -------


----- FUNCTION _FindEndPointID (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 825


 FILE: '..\APPLICATIONUTILITIES\ENDPOINT_LOOKUP.C'
   59: FindEndPointID(ENDPOINT_LOOKUP *pEPLookup, BYTE endpointindex)
   60: {
;---- Variable 'endpointindex' assigned to Register 'R5' ----
;---- Variable 'pEPLookup' assigned to Register 'R1/R2/R3' ----
   61:   if (endpointindex < pEPLookup->bEndPointsCount)
   62:   {
B2:00D813 121FB3            LCALL    ?C?CLDPTR
B2:00D816 FF                MOV      R7,A
B2:00D817 ED                MOV      A,R5
B2:00D818 C3                CLR      C
B2:00D819 9F                SUBB     A,R7
B2:00D81A 500F              JNC      ?C0001?ENDPOINT_LOOKUP
   63:     return pEPLookup->pEndPointList[endpointindex];
   64:   }
B2:00D81C 900001            MOV      DPTR,#01H
B2:00D81F 12262D            LCALL    ?C?PLDOPTR
B2:00D822 AF05              MOV      R7,AR5
B2:00D824 8F82              MOV      DPL,R7
B2:00D826 126DCA            LCALL    ?L?COM01DA
B2:00D829 FF                MOV      R7,A
B2:00D82A 22                RET      
   65:   return 0xFF;
B2:00D82B         ?C0001?ENDPOINT_LOOKUP:
   66: }
B2:00D82B 7FFF              MOV      R7,#0FFH
   67: 
B2:00D82D 22                RET      
----- FUNCTION _FindEndPointID (END) -------


----- FUNCTION _GetEndPointCount (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ENDPOINT_LOOKUP.C'
   68: BYTE GetEndPointCount(ENDPOINT_LOOKUP *pEPLookup)
   69: {
;---- Variable 'pEPLookup' assigned to Register 'R1/R2/R3' ----
   70:   return  pEPLookup->bEndPointsCount;
   71: }
B2:00D82E 121FB3            LCALL    ?C?CLDPTR
B2:00D831 FF                MOV      R7,A
   72: 
B2:00D832 22                RET      
----- FUNCTION _GetEndPointCount (END) -------


----- FUNCTION _FindEndPointIndex (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ENDPOINT_LOOKUP.C'
   74: FindEndPointIndex(ENDPOINT_LOOKUP *pEPLookup, BYTE endpoint)
   75: {
B2:00D833 904327            MOV      DPTR,#pEPLookup
B2:00D836 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'endpoint' assigned to Register 'R5' ----
   76:   BYTE i;
   77:   if (endpoint) /*0 endpoint is mapped for the first end point*/
B2:00D839 ED                MOV      A,R5
B2:00D83A 6023              JZ       ?C0004?ENDPOINT_LOOKUP
   78:   {
   79:     for (i = 0; i < pEPLookup->bEndPointsCount; i++)
;---- Variable 'i' assigned to Register 'R7' ----
B2:00D83C E4                CLR      A
B2:00D83D FF                MOV      R7,A
B2:00D83E         ?C0005?ENDPOINT_LOOKUP:
B2:00D83E 904327            MOV      DPTR,#pEPLookup
B2:00D841 12AE26            LCALL    ?L?COM0049
B2:00D844 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 826


B2:00D845 EF                MOV      A,R7
B2:00D846 C3                CLR      C
B2:00D847 9E                SUBB     A,R6
B2:00D848 5012              JNC      ?C0006?ENDPOINT_LOOKUP
   80:     {
   81:       if (pEPLookup->pEndPointList[i] == endpoint)
B2:00D84A 900001            MOV      DPTR,#01H
B2:00D84D 12262D            LCALL    ?C?PLDOPTR
B2:00D850 8F82              MOV      DPL,R7
B2:00D852 126DCA            LCALL    ?L?COM01DA
B2:00D855 B50501            CJNE     A,AR5,?C0007?ENDPOINT_LOOKUP
   82:         return i;
B2:00D858 22                RET      
   83:     }
B2:00D859         ?C0007?ENDPOINT_LOOKUP:
B2:00D859 0F                INC      R7
B2:00D85A 80E2              SJMP     ?C0005?ENDPOINT_LOOKUP
B2:00D85C         ?C0006?ENDPOINT_LOOKUP:
   84:     return 0xFF;
B2:00D85C 7FFF              MOV      R7,#0FFH
B2:00D85E 22                RET      
   85:   }
B2:00D85F         ?C0004?ENDPOINT_LOOKUP:
   86:   return 0;
B2:00D85F 7F00              MOV      R7,#00H
   87: }
B2:00D861 22                RET      
----- FUNCTION _FindEndPointIndex (END) -------


----- FUNCTION _CommandClassSupervisionInit (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
   72: CommandClassSupervisionInit( cc_supervision_status_updates_t status_updates,
   73:         VOID_CALLBACKFUNC(pGetReceivedHandler)(SUPERVISION_GET_RECEIVED_HANDLER_ARGS * pArgs),
;---- Variable 'status_updates' assigned to Register 'R7' ----
;---- Variable 'pReportReceivedHandler' assigned to Register 'R2/R3' ----
;---- Variable 'pGetReceivedHandler' assigned to Register 'R4/R5' ----
   74:         VOID_CALLBACKFUNC(pReportReceivedHandler)(cc_supervision_status_t status, uint8_t duration))
   75: {
   76:   m_status_updates = status_updates;
B2:00D862 903DA2            MOV      DPTR,#m_status_updates
B2:00D865 EF                MOV      A,R7
B2:00D866 F0                MOVX     @DPTR,A
   77:   m_pGetReceivedHandler = pGetReceivedHandler;
B2:00D867 AF05              MOV      R7,AR5
B2:00D869 903DA0            MOV      DPTR,#_m_pGetReceivedHandler
B2:00D86C EC                MOV      A,R4
B2:00D86D F0                MOVX     @DPTR,A
B2:00D86E A3                INC      DPTR
B2:00D86F EF                MOV      A,R7
B2:00D870 F0                MOVX     @DPTR,A
   78:   m_pReportReceivedHandler = pReportReceivedHandler;
B2:00D871 AF03              MOV      R7,AR3
B2:00D873 903D9C            MOV      DPTR,#_m_pReportReceivedHandler
B2:00D876 EA                MOV      A,R2
B2:00D877 F0                MOVX     @DPTR,A
B2:00D878 A3                INC      DPTR
B2:00D879 EF                MOV      A,R7
B2:00D87A F0                MOVX     @DPTR,A
   79: }
B2:00D87B 22                RET      
----- FUNCTION _CommandClassSupervisionInit (END) -------


----- FUNCTION _CmdClassSupervisionReportSend (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 827


 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
  274: JOB_STATUS CmdClassSupervisionReportSend(
  275:   TRANSMIT_OPTIONS_TYPE_SINGLE_EX* pTxOptionsEx,
B2:00D87C 904162            MOV      DPTR,#pTxOptionsEx
B2:00D87F 1225A9            LCALL    ?C?PSTXDATA
B2:00D882 904165            MOV      DPTR,#properties
B2:00D885 ED                MOV      A,R5
B2:00D886 F0                MOVX     @DPTR,A
  276:   uint8_t properties,
  277:   cc_supervision_status_t status,
  278:   uint8_t duration)
  279: {
  280:   ZW_APPLICATION_TX_BUFFER *pTxBuf = GetResponseBuffer();
B2:00D887 129A8C            LCALL    GetResponseBuffer
;---- Variable 'pTxBuf' assigned to Register 'R1/R2/R3' ----
  281:   if (IS_NULL( pTxBuf ))
B2:00D88A E9                MOV      A,R1
B2:00D88B 4A                ORL      A,R2
B2:00D88C 7003              JNZ      ?C0021?COMMANDCLASSSUPERVISION
  282:   {
  283:     /*Ongoing job is active.. just stop current job*/
  284:     return JOB_STATUS_BUSY;
B2:00D88E 7F01              MOV      R7,#01H
B2:00D890 22                RET      
  285:   }
B2:00D891         ?C0021?COMMANDCLASSSUPERVISION:
  286: 
  287:   pTxBuf->ZW_SupervisionReportFrame.cmdClass = COMMAND_CLASS_SUPERVISION;
B2:00D891 746C              MOV      A,#06CH
B2:00D893 122072            LCALL    ?C?CSTPTR
  288:   pTxBuf->ZW_SupervisionReportFrame.cmd = SUPERVISION_REPORT;
B2:00D896 1271FE            LCALL    ?L?COM039A
  289:   pTxBuf->ZW_SupervisionReportFrame.properties1 = properties;
B2:00D899 904165            MOV      DPTR,#properties
B2:00D89C 12CFD1            LCALL    ?L?COM0368
  290:   pTxBuf->ZW_SupervisionReportFrame.status = status;
B2:00D89F 904166            MOV      DPTR,#status
B2:00D8A2 E0                MOVX     A,@DPTR
B2:00D8A3 12716F            LCALL    ?L?COM0313
  291:   pTxBuf->ZW_SupervisionReportFrame.duration = duration;
B2:00D8A6 904167            MOV      DPTR,#duration
B2:00D8A9 12B6D9            LCALL    ?L?COM039D
  292: 
  293:   if(ZW_TX_IN_PROGRESS != Transport_SendResponseEP(
  294:       (uint8_t *)pTxBuf,
B2:00D8AC C003              PUSH     AR3
B2:00D8AE C002              PUSH     AR2
B2:00D8B0 C001              PUSH     AR1
B2:00D8B2 904162            MOV      DPTR,#pTxOptionsEx
B2:00D8B5 12A147            LCALL    ?L?COM001D
B2:00D8B8 D001              POP      AR1
B2:00D8BA D002              POP      AR2
B2:00D8BC D003              POP      AR3
B2:00D8BE 7D05              MOV      R5,#05H
B2:00D8C0 12A13D            LCALL    ?L?COM00BD
B2:00D8C3 6006              JZ       ?C0023?COMMANDCLASSSUPERVISION
  295:       sizeof(ZW_SUPERVISION_REPORT_FRAME),
  296:       pTxOptionsEx,
  297:       ZCB_ResponseJobStatus))
  298:   {
  299:     /*Job failed, free transmit-buffer pTxBuf by cleaing mutex */
  300:      FreeResponseBuffer();
B2:00D8C5 12A0B6            LCALL    FreeResponseBuffer
  301:      return JOB_STATUS_BUSY;
B2:00D8C8 7F01              MOV      R7,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 828


B2:00D8CA 22                RET      
  302:   }
B2:00D8CB         ?C0023?COMMANDCLASSSUPERVISION:
  303:   return JOB_STATUS_SUCCESS;
B2:00D8CB 7F00              MOV      R7,#00H
  304: }
B2:00D8CD 22                RET      
----- FUNCTION _CmdClassSupervisionReportSend (END) -------


----- FUNCTION _CommandClassSupervisionGetAdd (BEGIN) -----
 FILE: '..\APPLICATIONCOMMANDHANDLERS\COMMANDCLASSSUPERVISION.C'
  306: void CommandClassSupervisionGetAdd(ZW_SUPERVISION_GET_FRAME* pbuf)
  307: {
;---- Variable 'pbuf' assigned to Register 'R1/R2/R3' ----
  308:   m_CommandLength = 0;
  309:   CommandClassSupervisionGetWrite(pbuf);
B2:00D8CE E4                CLR      A
B2:00D8CF 903DA3            MOV      DPTR,#m_CommandLength
B2:00D8D2 F0                MOVX     @DPTR,A
  310:   m_sessionId = (m_sessionId + 1) & 0x3F; /* increment m_sessionId, wrap around in range 0..0x3F */
B2:00D8D3 12CFD8            LCALL    _CommandClassSupervisionGetWrite
  311: }
B2:00D8D6 903D99            MOV      DPTR,#m_sessionId
B2:00D8D9 E0                MOVX     A,@DPTR
B2:00D8DA 04                INC      A
B2:00D8DB 543F              ANL      A,#03FH
B2:00D8DD F0                MOVX     @DPTR,A
  312: 
B2:00D8DE 22                RET      
----- FUNCTION _CommandClassSupervisionGetAdd (END) -------


----- FUNCTION ?L?COM00A7 (BEGIN) -----
B2:00D8DF 904140            MOV      DPTR,#j
B2:00D8E2 E0                MOVX     A,@DPTR
B2:00D8E3         ?L?COM00A8:
B2:00D8E3 75F005            MOV      B,#05H
B2:00D8E6 A4                MUL      AB
B2:00D8E7 FB                MOV      R3,A
B2:00D8E8 AAF0              MOV      R2,B
B2:00D8EA 90413F            MOV      DPTR,#i
B2:00D8ED E0                MOVX     A,@DPTR
B2:00D8EE 75F005            MOV      B,#05H
B2:00D8F1 A4                MUL      AB
B2:00D8F2 2B                ADD      A,R3
B2:00D8F3 FF                MOV      R7,A
B2:00D8F4 E5F0              MOV      A,B
B2:00D8F6 3A                ADDC     A,R2
B2:00D8F7         ?L?COM00A9:
B2:00D8F7 FE                MOV      R6,A
B2:00D8F8 7C00              MOV      R4,#00H
B2:00D8FA EF                MOV      A,R7
B2:00D8FB 2D                ADD      A,R5
B2:00D8FC FF                MOV      R7,A
B2:00D8FD EC                MOV      A,R4
B2:00D8FE 3E                ADDC     A,R6
B2:00D8FF 22                RET      
----- FUNCTION ?L?COM00A7 (END) -------


----- FUNCTION ?L?COM011F (BEGIN) -----
B2:00D900 903A4A            MOV      DPTR,#pTxBuf
B2:00D903         ?L?COM0120:
B2:00D903 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 829


B2:00D906         ?L?COM0121:
B2:00D906 E9                MOV      A,R1
B2:00D907 2405              ADD      A,#05H
B2:00D909 F9                MOV      R1,A
B2:00D90A E4                CLR      A
B2:00D90B 3A                ADDC     A,R2
B2:00D90C FA                MOV      R2,A
B2:00D90D 22                RET      
----- FUNCTION ?L?COM011F (END) -------


----- FUNCTION ?L?COM0183 (BEGIN) -----
B2:00D90E 903DD3            MOV      DPTR,#testFrameSuccessCount
B2:00D911         ?L?COM0184:
B2:00D911 E0                MOVX     A,@DPTR
B2:00D912 FC                MOV      R4,A
B2:00D913 A3                INC      DPTR
B2:00D914 E0                MOVX     A,@DPTR
B2:00D915 FD                MOV      R5,A
B2:00D916 EC                MOV      A,R4
B2:00D917 22                RET      
----- FUNCTION ?L?COM0183 (END) -------


----- FUNCTION ?L?COM0189 (BEGIN) -----
B2:00D918 903B1F            MOV      DPTR,#mappedEndpoint
B2:00D91B         ?L?COM018A:
B2:00D91B E0                MOVX     A,@DPTR
B2:00D91C 75F014            MOV      B,#014H
B2:00D91F A4                MUL      AB
B2:00D920 246B              ADD      A,#LOW groups-014H
B2:00D922 F9                MOV      R1,A
B2:00D923 7439              MOV      A,#HIGH groups-014H
B2:00D925 35F0              ADDC     A,B
B2:00D927 FA                MOV      R2,A
B2:00D928 7B01              MOV      R3,#01H
B2:00D92A 22                RET      
----- FUNCTION ?L?COM0189 (END) -------


----- FUNCTION ?L?COM01E2 (BEGIN) -----
B2:00D92B 903C1D            MOV      DPTR,#mykeyMan
B2:00D92E E0                MOVX     A,@DPTR
B2:00D92F FE                MOV      R6,A
B2:00D930 A3                INC      DPTR
B2:00D931 E0                MOVX     A,@DPTR
B2:00D932 F582              MOV      DPL,A
B2:00D934 22                RET      
----- FUNCTION ?L?COM01E2 (END) -------


----- FUNCTION ?L?COM01E5 (BEGIN) -----
B2:00D935 1225A9            LCALL    ?C?PSTXDATA
B2:00D938         ?L?COM01E6:
B2:00D938 903A4A            MOV      DPTR,#pTxBuf
B2:00D93B 122589            LCALL    ?C?PLDXDATA
B2:00D93E 7460              MOV      A,#060H
B2:00D940 122072            LCALL    ?C?CSTPTR
B2:00D943 903A4A            MOV      DPTR,#pTxBuf
B2:00D946 22                RET      
----- FUNCTION ?L?COM01E5 (END) -------


----- FUNCTION ?L?COM01F6 (BEGIN) -----
B2:00D947 903FED            MOV      DPTR,#ep
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 830


B2:00D94A E0                MOVX     A,@DPTR
B2:00D94B FE                MOV      R6,A
B2:00D94C         ?L?COM01F7:
B2:00D94C 75F014            MOV      B,#014H
B2:00D94F A4                MUL      AB
B2:00D950 246D              ADD      A,#LOW groups-012H
B2:00D952 F582              MOV      DPL,A
B2:00D954 E4                CLR      A
B2:00D955 3439              ADDC     A,#HIGH groups-012H
B2:00D957 F583              MOV      DPH,A
B2:00D959 22                RET      
----- FUNCTION ?L?COM01F6 (END) -------


----- FUNCTION ?L?COM0267 (BEGIN) -----
B2:00D95A 903A03            MOV      DPTR,#pTxBuf
B2:00D95D         ?L?COM0268:
B2:00D95D 122589            LCALL    ?C?PLDXDATA
B2:00D960 747A              MOV      A,#07AH
B2:00D962 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0267 (END) -------


----- FUNCTION ?L?COM026A (BEGIN) -----
B2:00D965 903FED            MOV      DPTR,#ep
B2:00D968         ?L?COM026B:
B2:00D968 E0                MOVX     A,@DPTR
B2:00D969 75F014            MOV      B,#014H
B2:00D96C A4                MUL      AB
B2:00D96D 246C              ADD      A,#LOW groups-013H
B2:00D96F F582              MOV      DPL,A
B2:00D971 E4                CLR      A
B2:00D972 3439              ADDC     A,#HIGH groups-013H
B2:00D974 F583              MOV      DPH,A
B2:00D976 22                RET      
----- FUNCTION ?L?COM026A (END) -------


----- FUNCTION ?L?COM0293 (BEGIN) -----
B2:00D977 129A8C            LCALL    GetResponseBuffer
B2:00D97A 903A4A            MOV      DPTR,#pTxBuf
B2:00D97D 1225A9            LCALL    ?C?PSTXDATA
B2:00D980 E9                MOV      A,R1
B2:00D981 4A                ORL      A,R2
B2:00D982 22                RET      
----- FUNCTION ?L?COM0293 (END) -------


----- FUNCTION ?L?COM0299 (BEGIN) -----
B2:00D983 129A8C            LCALL    GetResponseBuffer
B2:00D986 9039F0            MOV      DPTR,#pTxBuf
B2:00D989 1225A9            LCALL    ?C?PSTXDATA
B2:00D98C E9                MOV      A,R1
B2:00D98D 4A                ORL      A,R2
B2:00D98E 22                RET      
----- FUNCTION ?L?COM0299 (END) -------


----- FUNCTION ?L?COM02AF (BEGIN) -----
B2:00D98F FD                MOV      R5,A
B2:00D990 122589            LCALL    ?C?PLDXDATA
B2:00D993 900002            MOV      DPTR,#02H
B2:00D996 ED                MOV      A,R5
B2:00D997 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM02AF (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 831




----- FUNCTION ?L?COM0302 (BEGIN) -----
B2:00D99A 75F014            MOV      B,#014H
B2:00D99D A4                MUL      AB
B2:00D99E 2480              ADD      A,#LOW groups+01H
B2:00D9A0 F582              MOV      DPL,A
B2:00D9A2 E4                CLR      A
B2:00D9A3 3439              ADDC     A,#HIGH groups+01H
B2:00D9A5 F583              MOV      DPH,A
B2:00D9A7 22                RET      
----- FUNCTION ?L?COM0302 (END) -------


----- FUNCTION ?L?COM032C (BEGIN) -----
B2:00D9A8 74F2              MOV      A,#LOW EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:00D9AA 2F                ADD      A,R7
B2:00D9AB F9                MOV      R1,A
B2:00D9AC 7413              MOV      A,#HIGH EEOFFSET_TRANSPORT_CAPABILITIES_START_far
B2:00D9AE         ?L?COM032D:
B2:00D9AE 3E                ADDC     A,R6
B2:00D9AF FE                MOV      R6,A
B2:00D9B0 AF01              MOV      R7,AR1
B2:00D9B2 021B79            LJMP     ?INTERBANK_TABLE?_MemoryGetByte
----- FUNCTION ?L?COM032C (END) -------


----- FUNCTION ?L?COM032F (BEGIN) -----
B2:00D9B5 E0                MOVX     A,@DPTR
B2:00D9B6 FF                MOV      R7,A
B2:00D9B7 903B6A            MOV      DPTR,#byteCount
B2:00D9BA E0                MOVX     A,@DPTR
B2:00D9BB FE                MOV      R6,A
B2:00D9BC 04                INC      A
B2:00D9BD F0                MOVX     @DPTR,A
B2:00D9BE 7466              MOV      A,#LOW response
B2:00D9C0 2E                ADD      A,R6
B2:00D9C1 F582              MOV      DPL,A
B2:00D9C3 E4                CLR      A
B2:00D9C4 343B              ADDC     A,#HIGH response
B2:00D9C6 F583              MOV      DPH,A
B2:00D9C8 EF                MOV      A,R7
B2:00D9C9 F0                MOVX     @DPTR,A
B2:00D9CA 22                RET      
----- FUNCTION ?L?COM032F (END) -------


----- FUNCTION ?L?COM037A (BEGIN) -----
B2:00D9CB 75F014            MOV      B,#014H
B2:00D9CE ED                MOV      A,R5
B2:00D9CF 02257D            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM037A (END) -------


----- FUNCTION ?L?COM0387 (BEGIN) -----
B2:00D9D2 7E13              MOV      R6,#HIGH EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:00D9D4 7FF7              MOV      R7,#LOW EEOFFSET_ASSOCIATION_ENDPOINT_MAGIC_far
B2:00D9D6 7D42              MOV      R5,#042H
B2:00D9D8 121B7E            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B2:00D9DB 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far
B2:00D9DD 7FF9              MOV      R7,#LOW EEOFFSET_MAGIC_SDK_6_70_ASSOCIATION_SECURE_far
B2:00D9DF 7D42              MOV      R5,#042H
B2:00D9E1 021B7E            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION ?L?COM0387 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 832



----- FUNCTION ?L?COM0388 (BEGIN) -----
B2:00D9E4 7B01              MOV      R3,#01H
B2:00D9E6 7A3B              MOV      R2,#HIGH txOptionsEx
B2:00D9E8 79EB              MOV      R1,#LOW txOptionsEx
B2:00D9EA 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00D9ED         ?L?COM0389:
B2:00D9ED 1225A9            LCALL    ?C?PSTXDATA
B2:00D9F0 903BE2            MOV      DPTR,#rxOpt
B2:00D9F3 22                RET      
----- FUNCTION ?L?COM0388 (END) -------


----- FUNCTION ?L?COM038A (BEGIN) -----
B2:00D9F4 7B01              MOV      R3,#01H
B2:00D9F6         ?L?COM038B:
B2:00D9F6 904094            MOV      DPTR,#?_AssGroupMappingLookUp?BYTE+03H
B2:00D9F9 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM038A (END) -------


----- FUNCTION ?L?COM039F (BEGIN) -----
B2:00D9FC 903B15            MOV      DPTR,#outgoingFrame
B2:00D9FF 122589            LCALL    ?C?PLDXDATA
B2:00DA02 E9                MOV      A,R1
B2:00DA03 2406              ADD      A,#06H
B2:00DA05 F9                MOV      R1,A
B2:00DA06 E4                CLR      A
B2:00DA07 3A                ADDC     A,R2
B2:00DA08 FA                MOV      R2,A
B2:00DA09 903B1D            MOV      DPTR,#nodeCountNoEndpoint
B2:00DA0C E0                MOVX     A,@DPTR
B2:00DA0D 22                RET      
----- FUNCTION ?L?COM039F (END) -------


----- FUNCTION ?L?COM03B7 (BEGIN) -----
B2:00DA0E 90360D            MOV      DPTR,#cmd_class_list
B2:00DA11 1225A9            LCALL    ?C?PSTXDATA
B2:00DA14 E4                CLR      A
B2:00DA15 22                RET      
----- FUNCTION ?L?COM03B7 (END) -------


----- FUNCTION ?L?COM03BC (BEGIN) -----
B2:00DA16 FF                MOV      R7,A
B2:00DA17         ?L?COM03BD:
B2:00DA17 9039F0            MOV      DPTR,#pTxBuf
B2:00DA1A 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03BC (END) -------


----- FUNCTION ?L?COM03C0 (BEGIN) -----
B2:00DA1D 129A8C            LCALL    GetResponseBuffer
B2:00DA20         ?L?COM03C1:
B2:00DA20 903A03            MOV      DPTR,#pTxBuf
B2:00DA23 1225A9            LCALL    ?C?PSTXDATA
B2:00DA26 E9                MOV      A,R1
B2:00DA27 4A                ORL      A,R2
B2:00DA28 22                RET      
----- FUNCTION ?L?COM03C0 (END) -------


----- FUNCTION ?L?COM03D3 (BEGIN) -----
B2:00DA29 FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 833


B2:00DA2A 122589            LCALL    ?C?PLDXDATA
B2:00DA2D 903AC8            MOV      DPTR,#?_AssociationRemove?BYTE+05H
B2:00DA30 EE                MOV      A,R6
B2:00DA31 F0                MOVX     @DPTR,A
B2:00DA32 12AF24            LCALL    _AssociationRemove
B2:00DA35 7FFF              MOV      R7,#0FFH
B2:00DA37 22                RET      
----- FUNCTION ?L?COM03D3 (END) -------


----- FUNCTION ?L?COM03DE (BEGIN) -----
B2:00DA38 903B31            MOV      DPTR,#pTxBuf
B2:00DA3B 122589            LCALL    ?C?PLDXDATA
B2:00DA3E 7485              MOV      A,#085H
B2:00DA40 122072            LCALL    ?C?CSTPTR
B2:00DA43 903B31            MOV      DPTR,#pTxBuf
B2:00DA46 22                RET      
----- FUNCTION ?L?COM03DE (END) -------


----- FUNCTION ?L?COM03E8 (BEGIN) -----
B2:00DA47 29                ADD      A,R1
B2:00DA48 F9                MOV      R1,A
B2:00DA49 EC                MOV      A,R4
B2:00DA4A 3A                ADDC     A,R2
B2:00DA4B FA                MOV      R2,A
B2:00DA4C A3                INC      DPTR
B2:00DA4D E0                MOVX     A,@DPTR
B2:00DA4E FE                MOV      R6,A
B2:00DA4F 04                INC      A
B2:00DA50 F0                MOVX     @DPTR,A
B2:00DA51 EE                MOV      A,R6
B2:00DA52 29                ADD      A,R1
B2:00DA53 F9                MOV      R1,A
B2:00DA54 EC                MOV      A,R4
B2:00DA55 22                RET      
----- FUNCTION ?L?COM03E8 (END) -------


----- FUNCTION ?L?COM03E9 (BEGIN) -----
B2:00DA56 3E                ADDC     A,R6
B2:00DA57 FE                MOV      R6,A
B2:00DA58 AF01              MOV      R7,AR1
B2:00DA5A E0                MOVX     A,@DPTR
B2:00DA5B FD                MOV      R5,A
B2:00DA5C 021B7E            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION ?L?COM03E9 (END) -------


----- FUNCTION ?L?COM040D (BEGIN) -----
B2:00DA5F 75F004            MOV      B,#04H
B2:00DA62 12257D            LCALL    ?C?OFFXADD
B2:00DA65 EF                MOV      A,R7
B2:00DA66 F0                MOVX     @DPTR,A
B2:00DA67 22                RET      
----- FUNCTION ?L?COM040D (END) -------


----- FUNCTION ?L?COM0425 (BEGIN) -----
B2:00DA68 F0                MOVX     @DPTR,A
B2:00DA69 7B01              MOV      R3,#01H
B2:00DA6B 7A36              MOV      R2,#HIGH data_length_hold
B2:00DA6D 7970              MOV      R1,#LOW data_length_hold
B2:00DA6F 904159            MOV      DPTR,#?_RequestBufferSupervisionPayloadActivate?BYTE+03H
B2:00DA72 0225A9            LJMP     ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 834


----- FUNCTION ?L?COM0425 (END) -------


----- FUNCTION ?L?COM0427 (BEGIN) -----
B2:00DA75 F0                MOVX     @DPTR,A
B2:00DA76 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetBuffer
B2:00DA79 74DA              MOV      A,#LOW EEOFFS_SECURITY_RESERVED
B2:00DA7B 2413              ADD      A,#013H
B2:00DA7D FF                MOV      R7,A
B2:00DA7E E4                CLR      A
B2:00DA7F 3413              ADDC     A,#HIGH EEOFFS_SECURITY_RESERVED
B2:00DA81 FE                MOV      R6,A
B2:00DA82 22                RET      
----- FUNCTION ?L?COM0427 (END) -------


----- FUNCTION ?L?COM0429 (BEGIN) -----
B2:00DA83 75F014            MOV      B,#014H
B2:00DA86 A4                MUL      AB
B2:00DA87 2482              ADD      A,#LOW groups+03H
B2:00DA89 F582              MOV      DPL,A
B2:00DA8B E4                CLR      A
B2:00DA8C 3439              ADDC     A,#HIGH groups+03H
B2:00DA8E F583              MOV      DPH,A
B2:00DA90 22                RET      
----- FUNCTION ?L?COM0429 (END) -------


----- FUNCTION ?L?COM042A (BEGIN) -----
B2:00DA91 75F014            MOV      B,#014H
B2:00DA94 A4                MUL      AB
B2:00DA95 2481              ADD      A,#LOW groups+02H
B2:00DA97 F582              MOV      DPL,A
B2:00DA99 E4                CLR      A
B2:00DA9A 3439              ADDC     A,#HIGH groups+02H
B2:00DA9C F583              MOV      DPH,A
B2:00DA9E 22                RET      
----- FUNCTION ?L?COM042A (END) -------


----- FUNCTION ?L?COM043A (BEGIN) -----
B2:00DA9F FF                MOV      R7,A
B2:00DAA0 122589            LCALL    ?C?PLDXDATA
B2:00DAA3 903B15            MOV      DPTR,#?_AssociationGet?BYTE+04H
B2:00DAA6 1225A9            LCALL    ?C?PSTXDATA
B2:00DAA9 7B01              MOV      R3,#01H
B2:00DAAB 22                RET      
----- FUNCTION ?L?COM043A (END) -------


----- FUNCTION ?L?COM0445 (BEGIN) -----
B2:00DAAC 903A46            MOV      DPTR,#pCmd
B2:00DAAF 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0445 (END) -------


----- FUNCTION ?L?COM0453 (BEGIN) -----
B2:00DAB2 7F03              MOV      R7,#03H
B2:00DAB4 121B92            LCALL    ?INTERBANK_TABLE?___ZW_memcmp
B2:00DAB7 EF                MOV      A,R7
B2:00DAB8 22                RET      
----- FUNCTION ?L?COM0453 (END) -------


----- FUNCTION ?L?COM0490 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 835


B2:00DAB9 129A8C            LCALL    GetResponseBuffer
B2:00DABC 903C7C            MOV      DPTR,#pTxBuf
B2:00DABF 1225A9            LCALL    ?C?PSTXDATA
B2:00DAC2 E9                MOV      A,R1
B2:00DAC3 4A                ORL      A,R2
B2:00DAC4 22                RET      
----- FUNCTION ?L?COM0490 (END) -------


----- FUNCTION ?L?COM0492 (BEGIN) -----
B2:00DAC5 122589            LCALL    ?C?PLDXDATA
B2:00DAC8 903D92            MOV      DPTR,#?_CmdClassMultiChannelEncapsulate?BYTE+06H
B2:00DACB 1225A9            LCALL    ?C?PSTXDATA
B2:00DACE 7B01              MOV      R3,#01H
B2:00DAD0 22                RET      
----- FUNCTION ?L?COM0492 (END) -------


----- FUNCTION ?L?COM0499 (BEGIN) -----
B2:00DAD1 129A8C            LCALL    GetResponseBuffer
B2:00DAD4 903BEF            MOV      DPTR,#pTxBuf
B2:00DAD7 1225A9            LCALL    ?C?PSTXDATA
B2:00DADA E9                MOV      A,R1
B2:00DADB 4A                ORL      A,R2
B2:00DADC 22                RET      
----- FUNCTION ?L?COM0499 (END) -------


----- FUNCTION ?L?COM049A (BEGIN) -----
B2:00DADD 129A8C            LCALL    GetResponseBuffer
B2:00DAE0 903B31            MOV      DPTR,#pTxBuf
B2:00DAE3 1225A9            LCALL    ?C?PSTXDATA
B2:00DAE6 E9                MOV      A,R1
B2:00DAE7 4A                ORL      A,R2
B2:00DAE8 22                RET      
----- FUNCTION ?L?COM049A (END) -------


----- FUNCTION ?L?COM049F (BEGIN) -----
B2:00DAE9 903B1C            MOV      DPTR,#nodeCountMax
B2:00DAEC E0                MOVX     A,@DPTR
B2:00DAED FF                MOV      R7,A
B2:00DAEE 903B1B            MOV      DPTR,#nodeCount
B2:00DAF1 E0                MOVX     A,@DPTR
B2:00DAF2 C3                CLR      C
B2:00DAF3 9F                SUBB     A,R7
B2:00DAF4 22                RET      
----- FUNCTION ?L?COM049F (END) -------


----- FUNCTION ?L?COM04A0 (BEGIN) -----
B2:00DAF5 903FF3            MOV      DPTR,#numberOfNodes
B2:00DAF8 E0                MOVX     A,@DPTR
B2:00DAF9 FF                MOV      R7,A
B2:00DAFA 903FF2            MOV      DPTR,#i
B2:00DAFD E0                MOVX     A,@DPTR
B2:00DAFE C3                CLR      C
B2:00DAFF 9F                SUBB     A,R7
B2:00DB00 22                RET      
----- FUNCTION ?L?COM04A0 (END) -------


----- FUNCTION ?L?COM04C9 (BEGIN) -----
B2:00DB01 7406              MOV      A,#06H
B2:00DB03 122072            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 836


B2:00DB06 903DDB            MOV      DPTR,#testNodeID
B2:00DB09 E0                MOVX     A,@DPTR
B2:00DB0A FF                MOV      R7,A
B2:00DB0B 22                RET      
----- FUNCTION ?L?COM04C9 (END) -------


----- FUNCTION ?L?COM04CB (BEGIN) -----
B2:00DB0C 1225BE            LCALL    ?C?PLDPTR
B2:00DB0F 903FF2            MOV      DPTR,#i
B2:00DB12 E0                MOVX     A,@DPTR
B2:00DB13 75F002            MOV      B,#02H
B2:00DB16 22                RET      
----- FUNCTION ?L?COM04CB (END) -------


----- FUNCTION ?L?COM04D1 (BEGIN) -----
B2:00DB17 FA                MOV      R2,A
B2:00DB18 903B21            MOV      DPTR,#pCurrentNode
B2:00DB1B 1225A9            LCALL    ?C?PSTXDATA
B2:00DB1E E9                MOV      A,R1
B2:00DB1F 2402              ADD      A,#02H
B2:00DB21 22                RET      
----- FUNCTION ?L?COM04D1 (END) -------


----- FUNCTION ?L?COM04D3 (BEGIN) -----
B2:00DB22 E0                MOVX     A,@DPTR
B2:00DB23 903B93            MOV      DPTR,#?_handleAssociationSet?BYTE+04H
B2:00DB26 F0                MOVX     @DPTR,A
B2:00DB27 129C9B            LCALL    _handleAssociationSet
B2:00DB2A 7FFF              MOV      R7,#0FFH
B2:00DB2C 22                RET      
----- FUNCTION ?L?COM04D3 (END) -------


----- FUNCTION ?L?COM04D6 (BEGIN) -----
B2:00DB2D E0                MOVX     A,@DPTR
B2:00DB2E FE                MOV      R6,A
B2:00DB2F A3                INC      DPTR
B2:00DB30 E0                MOVX     A,@DPTR
B2:00DB31 FF                MOV      R7,A
B2:00DB32 121B79            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00DB35 7E00              MOV      R6,#00H
B2:00DB37 22                RET      
----- FUNCTION ?L?COM04D6 (END) -------


----- FUNCTION ?L?COM04D9 (BEGIN) -----
B2:00DB38 903FF3            MOV      DPTR,#numberOfNodes
B2:00DB3B EF                MOV      A,R7
B2:00DB3C F0                MOVX     @DPTR,A
B2:00DB3D E4                CLR      A
B2:00DB3E 903FF2            MOV      DPTR,#i
B2:00DB41 F0                MOVX     @DPTR,A
B2:00DB42 22                RET      
----- FUNCTION ?L?COM04D9 (END) -------


----- FUNCTION ?L?COM050E (BEGIN) -----
B2:00DB43 903CD1            MOV      DPTR,#pTxBuf
B2:00DB46 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM050E (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 837


----- FUNCTION ?L?COM0526 (BEGIN) -----
B2:00DB49 7B01              MOV      R3,#01H
B2:00DB4B 7A3C              MOV      R2,#HIGH pTxOptionsEx
B2:00DB4D 797F              MOV      R1,#LOW pTxOptionsEx
B2:00DB4F 90415F            MOV      DPTR,#?_RxToTxOptions?BYTE+03H
B2:00DB52 22                RET      
----- FUNCTION ?L?COM0526 (END) -------


----- FUNCTION ?L?COM0527 (BEGIN) -----
B2:00DB53 547F              ANL      A,#07FH
B2:00DB55 FF                MOV      R7,A
B2:00DB56 904004            MOV      DPTR,#rxOpt
B2:00DB59 22                RET      
----- FUNCTION ?L?COM0527 (END) -------


----- FUNCTION ?L?COM052D (BEGIN) -----
B2:00DB5A 900008            MOV      DPTR,#08H
B2:00DB5D 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM052D (END) -------


----- FUNCTION ?L?COM0534 (BEGIN) -----
B2:00DB60 E0                MOVX     A,@DPTR
B2:00DB61 FF                MOV      R7,A
B2:00DB62 903B94            MOV      DPTR,#i
B2:00DB65 E0                MOVX     A,@DPTR
B2:00DB66 FE                MOV      R6,A
B2:00DB67 C3                CLR      C
B2:00DB68 9F                SUBB     A,R7
B2:00DB69 22                RET      
----- FUNCTION ?L?COM0534 (END) -------


----- FUNCTION ?L?COM0535 (BEGIN) -----
B2:00DB6A 903994            MOV      DPTR,#indx
B2:00DB6D E0                MOVX     A,@DPTR
B2:00DB6E 04                INC      A
B2:00DB6F F0                MOVX     @DPTR,A
B2:00DB70 22                RET      
----- FUNCTION ?L?COM0535 (END) -------


----- FUNCTION ?L?COM0580 (BEGIN) -----
B2:00DB71 903BA6            MOV      DPTR,#pCbFunc
B2:00DB74 E0                MOVX     A,@DPTR
B2:00DB75 FE                MOV      R6,A
B2:00DB76 A3                INC      DPTR
B2:00DB77 E0                MOVX     A,@DPTR
B2:00DB78 FF                MOV      R7,A
B2:00DB79 22                RET      
----- FUNCTION ?L?COM0580 (END) -------


----- FUNCTION ?L?COM058B (BEGIN) -----
B2:00DB7A 24D0              ADD      A,#0D0H
B2:00DB7C 2F                ADD      A,R7
B2:00DB7D FF                MOV      R7,A
B2:00DB7E 903B62            MOV      DPTR,#pin
B2:00DB81 F0                MOVX     @DPTR,A
B2:00DB82 22                RET      
----- FUNCTION ?L?COM058B (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 838


----- FUNCTION ?L?COM0593 (BEGIN) -----
B2:00DB83 E4                CLR      A
B2:00DB84 93                MOVC     A,@A+DPTR
B2:00DB85 FC                MOV      R4,A
B2:00DB86 7401              MOV      A,#01H
B2:00DB88 93                MOVC     A,@A+DPTR
B2:00DB89 FD                MOV      R5,A
B2:00DB8A EC                MOV      A,R4
B2:00DB8B 22                RET      
----- FUNCTION ?L?COM0593 (END) -------


----- FUNCTION ?L?COM0597 (BEGIN) -----
B2:00DB8C 903994            MOV      DPTR,#indx
B2:00DB8F E0                MOVX     A,@DPTR
B2:00DB90 FF                MOV      R7,A
B2:00DB91 C3                CLR      C
B2:00DB92 9405              SUBB     A,#05H
B2:00DB94 22                RET      
----- FUNCTION ?L?COM0597 (END) -------


----- FUNCTION ?L?COM05C9 (BEGIN) -----
B2:00DB95 FE                MOV      R6,A
B2:00DB96 74C3              MOV      A,#LOW EEOFFSET_ASSOCIATION_START_far
B2:00DB98 2F                ADD      A,R7
B2:00DB99 F9                MOV      R1,A
B2:00DB9A 7413              MOV      A,#HIGH EEOFFSET_ASSOCIATION_START_far
B2:00DB9C 22                RET      
----- FUNCTION ?L?COM05C9 (END) -------


----- FUNCTION ?L?COM05CF (BEGIN) -----
B2:00DB9D 903CE1            MOV      DPTR,#pCmd
B2:00DBA0 122589            LCALL    ?C?PLDXDATA
B2:00DBA3 E9                MOV      A,R1
B2:00DBA4 22                RET      
----- FUNCTION ?L?COM05CF (END) -------


----- FUNCTION ?L?COM05D3 (BEGIN) -----
B2:00DBA5 F582              MOV      DPL,A
B2:00DBA7 E4                CLR      A
B2:00DBA8 3439              ADDC     A,#HIGH groups
B2:00DBAA F583              MOV      DPH,A
B2:00DBAC 22                RET      
----- FUNCTION ?L?COM05D3 (END) -------


----- FUNCTION ?L?COM05D9 (BEGIN) -----
B2:00DBAD F0                MOVX     @DPTR,A
B2:00DBAE 903BB6            MOV      DPTR,#p_nodelist
B2:00DBB1 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM05D9 (END) -------


----- FUNCTION ?L?COM05DE (BEGIN) -----
B2:00DBB4 9043B3            MOV      DPTR,#?GetEndpointcmdClassList?BYTE
B2:00DBB7 F0                MOVX     @DPTR,A
B2:00DBB8 02825D            LJMP     GetEndpointcmdClassList
----- FUNCTION ?L?COM05DE (END) -------


----- FUNCTION ?L?COM05E5 (BEGIN) -----
B2:00DBBB FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 839


B2:00DBBC 74ED              MOV      A,#LOW EEOFFSET_ASSOCIATION_ENDPOINT_START_far
B2:00DBBE 2F                ADD      A,R7
B2:00DBBF F9                MOV      R1,A
B2:00DBC0 7413              MOV      A,#HIGH EEOFFSET_ASSOCIATION_ENDPOINT_START_far
B2:00DBC2 22                RET      
----- FUNCTION ?L?COM05E5 (END) -------


----- FUNCTION ?L?COM05EB (BEGIN) -----
B2:00DBC3 9250              MOV      ?GetCommandClassList?BIT,C
B2:00DBC5 E4                CLR      A
B2:00DBC6 904324            MOV      DPTR,#?GetCommandClassList?BYTE
B2:00DBC9 F0                MOVX     @DPTR,A
B2:00DBCA 22                RET      
----- FUNCTION ?L?COM05EB (END) -------


----- FUNCTION ?L?COM05EC (BEGIN) -----
B2:00DBCB 121FF0            LCALL    ?C?CLDOPTR
B2:00DBCE FF                MOV      R7,A
B2:00DBCF 903C31            MOV      DPTR,#nodeType
B2:00DBD2 22                RET      
----- FUNCTION ?L?COM05EC (END) -------


----- FUNCTION ?L?COM05F3 (BEGIN) -----
B2:00DBD3 E0                MOVX     A,@DPTR
B2:00DBD4 2404              ADD      A,#04H
B2:00DBD6 FD                MOV      R5,A
B2:00DBD7 903BEB            MOV      DPTR,#txOptionsEx
B2:00DBDA 22                RET      
----- FUNCTION ?L?COM05F3 (END) -------


----- FUNCTION ?L?COM05F8 (BEGIN) -----
B2:00DBDB E0                MOVX     A,@DPTR
B2:00DBDC 04                INC      A
B2:00DBDD F0                MOVX     @DPTR,A
B2:00DBDE E0                MOVX     A,@DPTR
B2:00DBDF C3                CLR      C
B2:00DBE0 9401              SUBB     A,#01H
B2:00DBE2 22                RET      
----- FUNCTION ?L?COM05F8 (END) -------


----- FUNCTION ?L?COM05FA (BEGIN) -----
B2:00DBE3 9043A1            MOV      DPTR,#event
B2:00DBE6 E0                MOVX     A,@DPTR
B2:00DBE7 FF                MOV      R7,A
B2:00DBE8 6442              XRL      A,#042H
B2:00DBEA 22                RET      
----- FUNCTION ?L?COM05FA (END) -------


----- FUNCTION _TransportTimerStart (BEGIN) -----
;---- Variable 'wtimerTicks' assigned to Register 'R4/R5' ----
;---- Variable 'func' assigned to Register 'R2/R3' ----
B3:008000 AB07              MOV      R3,AR7
B3:008002 AA06              MOV      R2,AR6
B3:008004 128BF0            LCALL    ?L?COM02EF
B3:008007 ED                MOV      A,R5
B3:008008 4C                ORL      A,R4
B3:008009 7005              JNZ      ?C0001?ZW_TRANSPORT_TIMER
B3:00800B 0D                INC      R5
B3:00800C BD0001            CJNE     R5,#00H,?C0017?ZW_TRANSPORT_TIMER
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 840


B3:00800F 0C                INC      R4
B3:008010         ?C0017?ZW_TRANSPORT_TIMER:
B3:008010         ?C0001?ZW_TRANSPORT_TIMER:
B3:008010 D3                SETB     C
B3:008011 ED                MOV      A,R5
B3:008012 94FF              SUBB     A,#0FFH
B3:008014 EC                MOV      A,R4
B3:008015 9403              SUBB     A,#03H
B3:008017 500D              JNC      ?C0002?ZW_TRANSPORT_TIMER
B3:008019 75FF02            MOV      SFRPAGE,#02H
B3:00801C ED                MOV      A,R5
B3:00801D F586              MOV      SLTCON2,A
B3:00801F EC                MOV      A,R4
B3:008020 4430              ORL      A,#030H
B3:008022 F585              MOV      SLTCON1,A
B3:008024 8058              SJMP     ?C0003?ZW_TRANSPORT_TIMER
B3:008026         ?C0002?ZW_TRANSPORT_TIMER:
B3:008026 D3                SETB     C
B3:008027 ED                MOV      A,R5
B3:008028 94FC              SUBB     A,#0FCH
B3:00802A EC                MOV      A,R4
B3:00802B 940F              SUBB     A,#0FH
B3:00802D 501A              JNC      ?C0004?ZW_TRANSPORT_TIMER
B3:00802F ED                MOV      A,R5
B3:008030 AE04              MOV      R6,AR4
B3:008032 7802              MOV      R0,#02H
B3:008034         ?C0018?ZW_TRANSPORT_TIMER:
B3:008034 CE                XCH      A,R6
B3:008035 C3                CLR      C
B3:008036 13                RRC      A
B3:008037 CE                XCH      A,R6
B3:008038 13                RRC      A
B3:008039 D8F9              DJNZ     R0,?C0018?ZW_TRANSPORT_TIMER
B3:00803B AC06              MOV      R4,AR6
B3:00803D 75FF02            MOV      SFRPAGE,#02H
B3:008040 F586              MOV      SLTCON2,A
B3:008042 EC                MOV      A,R4
B3:008043 4434              ORL      A,#034H
B3:008045 F585              MOV      SLTCON1,A
B3:008047 8035              SJMP     ?C0003?ZW_TRANSPORT_TIMER
B3:008049         ?C0004?ZW_TRANSPORT_TIMER:
B3:008049 D3                SETB     C
B3:00804A ED                MOV      A,R5
B3:00804B 94F0              SUBB     A,#0F0H
B3:00804D EC                MOV      A,R4
B3:00804E 943F              SUBB     A,#03FH
B3:008050 5016              JNC      ?C0006?ZW_TRANSPORT_TIMER
B3:008052 EC                MOV      A,R4
B3:008053 12733D            LCALL    ?L?COM04ED
B3:008056 FC                MOV      R4,A
B3:008057 ED                MOV      A,R5
B3:008058 C4                SWAP     A
B3:008059 540F              ANL      A,#0FH
B3:00805B 48                ORL      A,R0
B3:00805C 75FF02            MOV      SFRPAGE,#02H
B3:00805F F586              MOV      SLTCON2,A
B3:008061 EC                MOV      A,R4
B3:008062 4438              ORL      A,#038H
B3:008064 F585              MOV      SLTCON1,A
B3:008066 8016              SJMP     ?C0003?ZW_TRANSPORT_TIMER
B3:008068         ?C0006?ZW_TRANSPORT_TIMER:
B3:008068 ED                MOV      A,R5
B3:008069 AE04              MOV      R6,AR4
B3:00806B 7806              MOV      R0,#06H
B3:00806D         ?C0019?ZW_TRANSPORT_TIMER:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 841


B3:00806D CE                XCH      A,R6
B3:00806E C3                CLR      C
B3:00806F 13                RRC      A
B3:008070 CE                XCH      A,R6
B3:008071 13                RRC      A
B3:008072 D8F9              DJNZ     R0,?C0019?ZW_TRANSPORT_TIMER
B3:008074 75FF02            MOV      SFRPAGE,#02H
B3:008077 F586              MOV      SLTCON2,A
B3:008079 EE                MOV      A,R6
B3:00807A 443C              ORL      A,#03CH
B3:00807C F585              MOV      SLTCON1,A
B3:00807E         ?C0003?ZW_TRANSPORT_TIMER:
B3:00807E AF03              MOV      R7,AR3
B3:008080 904352            MOV      DPTR,#Func
B3:008083 EA                MOV      A,R2
B3:008084 F0                MOVX     @DPTR,A
B3:008085 A3                INC      DPTR
B3:008086 EF                MOV      A,R7
B3:008087 F0                MOVX     @DPTR,A
B3:008088 D220              SETB     slow_timer_running
B3:00808A E4                CLR      A
B3:00808B F576              MOV      slow_timer_count,A
B3:00808D 75FF02            MOV      SFRPAGE,#02H
B3:008090 438540            ORL      SLTCON1,#040H
B3:008093 75FF02            MOV      SFRPAGE,#02H
B3:008096 438580            ORL      SLTCON1,#080H
B3:008099 D21F              SETB     canRestart
B3:00809B 22                RET      
----- FUNCTION _TransportTimerStart (END) -------


----- FUNCTION ?L?COM02E2 (BEGIN) -----
B3:00809C 90357C            MOV      DPTR,#dec_message
B3:00809F 122589            LCALL    ?C?PLDXDATA
----- FUNCTION ___ZW_memcpy (BEGIN) -----
B3:0080A2 90405A            MOV      DPTR,#dst
B3:0080A5 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'length' assigned to Register 'R7' ----
B3:0080A8         ?C0020?ZW_MEM:
B3:0080A8 AE07              MOV      R6,AR7
B3:0080AA 1F                DEC      R7
B3:0080AB EE                MOV      A,R6
B3:0080AC 601D              JZ       ?C0022?ZW_MEM
B3:0080AE 90405D            MOV      DPTR,#src
B3:0080B1 122589            LCALL    ?C?PLDXDATA
B3:0080B4 121FB3            LCALL    ?C?CLDPTR
B3:0080B7 90405A            MOV      DPTR,#dst
B3:0080BA 127393            LCALL    ?L?COM0596
B3:0080BD 90405B            MOV      DPTR,#dst+01H
B3:0080C0 123F7F            LCALL    ?L?COM0081
B3:0080C3 90405E            MOV      DPTR,#src+01H
B3:0080C6 123F7F            LCALL    ?L?COM0081
B3:0080C9 80DD              SJMP     ?C0020?ZW_MEM
B3:0080CB         ?C0022?ZW_MEM:
B3:0080CB 22                RET      
----- FUNCTION ___ZW_memcpy (END) -------


----- FUNCTION TransportTimerCancel (BEGIN) -----
B3:0080CC 128BF0            LCALL    ?L?COM02EF
B3:0080CF C21F              CLR      canRestart
B3:0080D1 E4                CLR      A
B3:0080D2 F576              MOV      slow_timer_count,A
B3:0080D4 C220              CLR      slow_timer_running
B3:0080D6 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 842


----- FUNCTION TransportTimerCancel (END) -------


----- FUNCTION _?tx_session_state_set (BEGIN) -----
B3:0080D7 90FFFF            MOV      DPTR,#0FFFFH
B3:0080DA 12271C            LCALL    ?C?ADDXBP
B3:0080DD EF                MOV      A,R7
B3:0080DE F0                MOVX     @DPTR,A
B3:0080DF 90FFFF            MOV      DPTR,#0FFFFH
B3:0080E2 12271C            LCALL    ?C?ADDXBP
B3:0080E5 91B2              ACALL    ?L?COM01E8
B3:0080E7 A3                INC      DPTR
B3:0080E8 E0                MOVX     A,@DPTR
B3:0080E9 9025A7            MOV      DPTR,#the_tx_session+0AH
B3:0080EC F0                MOVX     @DPTR,A
B3:0080ED 1226B6            LCALL    ?C?CCASE
B3:0080F0 8109              DW       ?C0072?ZW_SECURITY_SCHEME0
B3:0080F2 00                DB       00H
B3:0080F3 8131              DW       ?C0075?ZW_SECURITY_SCHEME0
B3:0080F5 02                DB       02H
B3:0080F6 8167              DW       ?C0080?ZW_SECURITY_SCHEME0
B3:0080F8 03                DB       03H
B3:0080F9 816F              DW       ?C0082?ZW_SECURITY_SCHEME0
B3:0080FB 04                DB       04H
B3:0080FC 8196              DW       ?C0085?ZW_SECURITY_SCHEME0
B3:0080FE 05                DB       05H
B3:0080FF 819C              DW       ?C0086?ZW_SECURITY_SCHEME0
B3:008101 06                DB       06H
B3:008102 81A8              DW       ?C0088?ZW_SECURITY_SCHEME0
B3:008104 07                DB       07H
B3:008105 0000              DW       00H
B3:008107 81B5              DW       ?C0090?ZW_SECURITY_SCHEME0
B3:008109         ?C0072?ZW_SECURITY_SCHEME0:
B3:008109 12EF88            LCALL    ?L?COM03C9
B3:00810C 12BDF7            LCALL    ?L?COM0031
B3:00810F 12D1E3            LCALL    ?L?COM0450
B3:008112 9194              ACALL    ?L?COM046C
B3:008114 12704B            LCALL    ?L?COM00AE
B3:008117 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00811A 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_noce_get_callback
B3:00811C F0                MOVX     @DPTR,A
B3:00811D A3                INC      DPTR
B3:00811E 7450              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_noce_get_callback
B3:008120 F0                MOVX     @DPTR,A
B3:008121 7A23              MOV      R2,#HIGH nonce_get
B3:008123 798C              MOV      R1,#LOW nonce_get
B3:008125 7D02              MOV      R5,#02H
B3:008127 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00812A EF                MOV      A,R7
B3:00812B 6002              JZ       $ + 4H
B3:00812D 21B5              AJMP     ?C0090?ZW_SECURITY_SCHEME0
B3:00812F 8061              SJMP     ?C0177?ZW_SECURITY_SCHEME0
B3:008131         ?C0075?ZW_SECURITY_SCHEME0:
B3:008131 7B01              MOV      R3,#01H
B3:008133 7A25              MOV      R2,#HIGH the_tx_session+0BH
B3:008135 79A8              MOV      R1,#LOW the_tx_session+0BH
B3:008137 121B15            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00813A E4                CLR      A
B3:00813B FF                MOV      R7,A
B3:00813C 919B              ACALL    ?L?COM01E7
B3:00813E E0                MOVX     A,@DPTR
B3:00813F FD                MOV      R5,A
B3:008140 6012              JZ       ?C0077?ZW_SECURITY_SCHEME0
B3:008142 9194              ACALL    ?L?COM046C
B3:008144 12704B            LCALL    ?L?COM00AE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 843


B3:008147 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00814A 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_msg1_callback
B3:00814C F0                MOVX     @DPTR,A
B3:00814D 7455              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_msg1_callback
B3:00814F 12EFE8            LCALL    ?L?COM04E3
B3:008152 7002              JNZ      ?C0076?ZW_SECURITY_SCHEME0
B3:008154         ?C0077?ZW_SECURITY_SCHEME0:
B3:008154         
B3:008154 803C              SJMP     ?C0177?ZW_SECURITY_SCHEME0
B3:008156         ?C0076?ZW_SECURITY_SCHEME0:
B3:008156 9025A6            MOV      DPTR,#the_tx_session+09H
B3:008159 E0                MOVX     A,@DPTR
B3:00815A 6059              JZ       ?C0090?ZW_SECURITY_SCHEME0
B3:00815C 12EF88            LCALL    ?L?COM03C9
B3:00815F 12BDF7            LCALL    ?L?COM0031
B3:008162 12D1E3            LCALL    ?L?COM0450
B3:008165 804E              SJMP     ?C0090?ZW_SECURITY_SCHEME0
B3:008167         ?C0080?ZW_SECURITY_SCHEME0:
B3:008167 9025A6            MOV      DPTR,#the_tx_session+09H
B3:00816A E0                MOVX     A,@DPTR
B3:00816B 7048              JNZ      ?C0090?ZW_SECURITY_SCHEME0
B3:00816D 8027              SJMP     ?C0178?ZW_SECURITY_SCHEME0
B3:00816F         ?C0082?ZW_SECURITY_SCHEME0:
B3:00816F 7B01              MOV      R3,#01H
B3:008171 7A25              MOV      R2,#HIGH the_tx_session+0BH
B3:008173 79A8              MOV      R1,#LOW the_tx_session+0BH
B3:008175 121B15            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:008178 7F01              MOV      R7,#01H
B3:00817A 919B              ACALL    ?L?COM01E7
B3:00817C E0                MOVX     A,@DPTR
B3:00817D FD                MOV      R5,A
B3:00817E 6012              JZ       ?C0084?ZW_SECURITY_SCHEME0
B3:008180 9194              ACALL    ?L?COM046C
B3:008182 12704B            LCALL    ?L?COM00AE
B3:008185 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:008188 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_msg2_callback
B3:00818A F0                MOVX     @DPTR,A
B3:00818B 745A              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_msg2_callback
B3:00818D 12EFE8            LCALL    ?L?COM04E3
B3:008190 7023              JNZ      ?C0090?ZW_SECURITY_SCHEME0
B3:008192         ?C0084?ZW_SECURITY_SCHEME0:
B3:008192         
B3:008192 7F07              MOV      R7,#07H
B3:008194 8002              SJMP     ?C0179?ZW_SECURITY_SCHEME0
B3:008196         ?C0085?ZW_SECURITY_SCHEME0:
B3:008196         
B3:008196 7F06              MOV      R7,#06H
B3:008198         
B3:008198 11D7              ACALL    _?tx_session_state_set
B3:00819A 8019              SJMP     ?C0090?ZW_SECURITY_SCHEME0
B3:00819C         ?C0086?ZW_SECURITY_SCHEME0:
B3:00819C 12A77F            LCALL    ?L?COM0097
B3:00819F 6014              JZ       ?C0090?ZW_SECURITY_SCHEME0
B3:0081A1 12EF1B            LCALL    ?L?COM0200
B3:0081A4 E4                CLR      A
B3:0081A5 FF                MOV      R7,A
B3:0081A6 800A              SJMP     ?C0180?ZW_SECURITY_SCHEME0
B3:0081A8         ?C0088?ZW_SECURITY_SCHEME0:
B3:0081A8 12A77F            LCALL    ?L?COM0097
B3:0081AB 6008              JZ       ?C0090?ZW_SECURITY_SCHEME0
B3:0081AD 12EF1B            LCALL    ?L?COM0200
B3:0081B0 7F02              MOV      R7,#02H
B3:0081B2         
B3:0081B2 12271A            LCALL    ?C?ICALL2
B3:0081B5         ?C0090?ZW_SECURITY_SCHEME0:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 844


B3:0081B5 900002            MOV      DPTR,#02H
B3:0081B8 02271C            LJMP     ?C?ADDXBP
----- FUNCTION _?tx_session_state_set (END) -------


----- FUNCTION ___ZW_memcmp (BEGIN) -----
B3:0081BB 904061            MOV      DPTR,#dst
B3:0081BE 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'length' assigned to Register 'R7' ----
B3:0081C1         ?C0023?ZW_MEM:
B3:0081C1 AE07              MOV      R6,AR7
B3:0081C3 1F                DEC      R7
B3:0081C4 EE                MOV      A,R6
B3:0081C5 6027              JZ       ?C0024?ZW_MEM
B3:0081C7 904064            MOV      DPTR,#src
B3:0081CA 122589            LCALL    ?C?PLDXDATA
B3:0081CD 121FB3            LCALL    ?C?CLDPTR
B3:0081D0 FE                MOV      R6,A
B3:0081D1 904061            MOV      DPTR,#dst
B3:0081D4 122589            LCALL    ?C?PLDXDATA
B3:0081D7 121FB3            LCALL    ?C?CLDPTR
B3:0081DA 6E                XRL      A,R6
B3:0081DB 6003              JZ       ?C0025?ZW_MEM
B3:0081DD 7F01              MOV      R7,#01H
B3:0081DF 22                RET      
B3:0081E0         ?C0025?ZW_MEM:
B3:0081E0 904062            MOV      DPTR,#dst+01H
B3:0081E3 123F7F            LCALL    ?L?COM0081
B3:0081E6 904065            MOV      DPTR,#src+01H
B3:0081E9 123F7F            LCALL    ?L?COM0081
B3:0081EC 80D3              SJMP     ?C0023?ZW_MEM
B3:0081EE         ?C0024?ZW_MEM:
B3:0081EE 7F00              MOV      R7,#00H
B3:0081F0 22                RET      
----- FUNCTION ___ZW_memcmp (END) -------


----- FUNCTION _sec0_decrypt_message (BEGIN) -----
B3:0081F1 903576            MOV      DPTR,#snode
B3:0081F4 124765            LCALL    ?L?COM0102
B3:0081F7 1225A9            LCALL    ?C?PSTXDATA
B3:0081FA E4                CLR      A
B3:0081FB 9035AA            MOV      DPTR,#i
B3:0081FE F0                MOVX     @DPTR,A
B3:0081FF 90357B            MOV      DPTR,#enc_data_length
B3:008202 E0                MOVX     A,@DPTR
B3:008203 FE                MOV      R6,A
B3:008204 C3                CLR      C
B3:008205 9413              SUBB     A,#013H
B3:008207 5003              JNC      ?C0144?ZW_SECURITY_SCHEME0
B3:008209 7F00              MOV      R7,#00H
B3:00820B 22                RET      
B3:00820C         ?C0144?ZW_SECURITY_SCHEME0:
B3:00820C EE                MOV      A,R6
B3:00820D 24F7              ADD      A,#0F7H
B3:00820F FF                MOV      R7,A
B3:008210 E4                CLR      A
B3:008211 34FF              ADDC     A,#0FFH
B3:008213 FE                MOV      R6,A
B3:008214 903578            MOV      DPTR,#enc_data
B3:008217 1271EE            LCALL    ?L?COM0382
B3:00821A 121FB3            LCALL    ?C?CLDPTR
B3:00821D 9035A5            MOV      DPTR,#ri
B3:008220 F0                MOVX     @DPTR,A
B3:008221 903578            MOV      DPTR,#enc_data
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 845


B3:008224 122589            LCALL    ?C?PLDXDATA
B3:008227 E9                MOV      A,R1
B3:008228 2402              ADD      A,#02H
B3:00822A 126145            LCALL    ?L?COM0045
B3:00822D B106              ACALL    ?L?COM054A
B3:00822F 7F08              MOV      R7,#08H
B3:008231 11A2              ACALL    ___ZW_memcpy
B3:008233 12EFDD            LCALL    ?L?COM04E2
B3:008236 7B01              MOV      R3,#01H
B3:008238 7A35              MOV      R2,#HIGH iv+08H
B3:00823A 7987              MOV      R1,#LOW iv+08H
B3:00823C 12ED3A            LCALL    ?L?COM0150
B3:00823F E4                CLR      A
B3:008240 903F92            MOV      DPTR,#?_get_nonce?BYTE+06H
B3:008243 F0                MOVX     @DPTR,A
B3:008244 9035A5            MOV      DPTR,#ri
B3:008247 12B533            LCALL    ?L?COM054B
B3:00824A 7002              JNZ      ?C0146?ZW_SECURITY_SCHEME0
B3:00824C FF                MOV      R7,A
B3:00824D 22                RET      
B3:00824E         ?C0146?ZW_SECURITY_SCHEME0:
B3:00824E 12EFDD            LCALL    ?L?COM04E2
B3:008251 91B9              ACALL    _nonce_clear
B3:008253         ?C0147?ZW_SECURITY_SCHEME0:
B3:008253 12F01D            LCALL    ?L?COM05A9
B3:008256 12DC93            LCALL    _get_rx_session_by_nodes
B3:008259 12EF26            LCALL    ?L?COM0216
B3:00825C 7017              JNZ      ?C0148?ZW_SECURITY_SCHEME0
B3:00825E 12F01D            LCALL    ?L?COM05A9
B3:008261 12DC41            LCALL    _new_rx_session
B3:008264 12EF26            LCALL    ?L?COM0216
B3:008267 6009              JZ       ?C0149?ZW_SECURITY_SCHEME0
B3:008269 B115              ACALL    ?L?COM00FD
B3:00826B FA                MOV      R2,A
B3:00826C E4                CLR      A
B3:00826D 122072            LCALL    ?C?CSTPTR
B3:008270 8003              SJMP     ?C0148?ZW_SECURITY_SCHEME0
B3:008272         ?C0149?ZW_SECURITY_SCHEME0:
B3:008272 7F00              MOV      R7,#00H
B3:008274 22                RET      
B3:008275         ?C0148?ZW_SECURITY_SCHEME0:
B3:008275 903578            MOV      DPTR,#enc_data
B3:008278 12731F            LCALL    ?L?COM04D2
B3:00827B 9035A2            MOV      DPTR,#enc_payload
B3:00827E 1225A9            LCALL    ?C?PSTXDATA
B3:008281 90357C            MOV      DPTR,#dec_message
B3:008284 122589            LCALL    ?C?PLDXDATA
B3:008287 9035A6            MOV      DPTR,#auth
B3:00828A 1225A9            LCALL    ?C?PSTXDATA
B3:00828D 903578            MOV      DPTR,#enc_data
B3:008290 122589            LCALL    ?C?PLDXDATA
B3:008293 E9                MOV      A,R1
B3:008294 2401              ADD      A,#01H
B3:008296 125510            LCALL    ?L?COM000B
B3:008299 FF                MOV      R7,A
B3:00829A 9035A6            MOV      DPTR,#auth
B3:00829D 123F95            LCALL    ?L?COM00C0
B3:0082A0 903576            MOV      DPTR,#snode
B3:0082A3 E0                MOVX     A,@DPTR
B3:0082A4 9035A6            MOV      DPTR,#auth
B3:0082A7 12EEE5            LCALL    ?L?COM007C
B3:0082AA EF                MOV      A,R7
B3:0082AB 122072            LCALL    ?C?CSTPTR
B3:0082AE 903577            MOV      DPTR,#dnode
B3:0082B1 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 846


B3:0082B2 9035A6            MOV      DPTR,#auth
B3:0082B5 917C              ACALL    ?L?COM00C6
B3:0082B7 90357B            MOV      DPTR,#enc_data_length
B3:0082BA E0                MOVX     A,@DPTR
B3:0082BB 24ED              ADD      A,#0EDH
B3:0082BD FF                MOV      R7,A
B3:0082BE 9035A6            MOV      DPTR,#auth
B3:0082C1 12707E            LCALL    ?L?COM00F2
B3:0082C4 9183              ACALL    ?L?COM00C8
B3:0082C6 9035A6            MOV      DPTR,#auth
B3:0082C9 125522            LCALL    ?L?COM0059
B3:0082CC C003              PUSH     AR3
B3:0082CE C002              PUSH     AR2
B3:0082D0 C001              PUSH     AR1
B3:0082D2 9176              ACALL    ?L?COM0379
B3:0082D4 126149            LCALL    ?L?COM0047
B3:0082D7 D001              POP      AR1
B3:0082D9 D002              POP      AR2
B3:0082DB D003              POP      AR3
B3:0082DD 11A2              ACALL    ___ZW_memcpy
B3:0082DF B106              ACALL    ?L?COM054A
B3:0082E1 12EF4A            LCALL    ?L?COM026F
B3:0082E4 7A23              MOV      R2,#HIGH authkey
B3:0082E6 799F              MOV      R1,#LOW authkey
B3:0082E8 91DD              ACALL    _aes_set_key
B3:0082EA E4                CLR      A
B3:0082EB 9035AA            MOV      DPTR,#i
B3:0082EE F0                MOVX     @DPTR,A
B3:0082EF         ?C0151?ZW_SECURITY_SCHEME0:
B3:0082EF B10D              ACALL    ?L?COM04AC
B3:0082F1 B410FB            CJNE     A,#010H,?C0151?ZW_SECURITY_SCHEME0
B3:0082F4         ?C0152?ZW_SECURITY_SCHEME0:
B3:0082F4 9035A6            MOV      DPTR,#auth
B3:0082F7 12707E            LCALL    ?L?COM00F2
B3:0082FA 125510            LCALL    ?L?COM000B
B3:0082FD 2404              ADD      A,#04H
B3:0082FF 7A35              MOV      R2,#HIGH mac
B3:008301 798F              MOV      R1,#LOW mac
B3:008303 12EF09            LCALL    ?L?COM01CF
B3:008306 9035A6            MOV      DPTR,#auth
B3:008309 122589            LCALL    ?C?PLDXDATA
B3:00830C 129DB5            LCALL    _aes_cbc_mac
B3:00830F E4                CLR      A
B3:008310 9035AA            MOV      DPTR,#i
B3:008313 F0                MOVX     @DPTR,A
B3:008314         ?C0154?ZW_SECURITY_SCHEME0:
B3:008314 9035A6            MOV      DPTR,#auth
B3:008317 12707E            LCALL    ?L?COM00F2
B3:00831A 125510            LCALL    ?L?COM000B
B3:00831D 2404              ADD      A,#04H
B3:00831F FF                MOV      R7,A
B3:008320 E4                CLR      A
B3:008321 9035AA            MOV      DPTR,#i
B3:008324 125566            LCALL    ?L?COM016D
B3:008327 5005              JNC      ?C0155?ZW_SECURITY_SCHEME0
B3:008329 E0                MOVX     A,@DPTR
B3:00832A 04                INC      A
B3:00832B F0                MOVX     @DPTR,A
B3:00832C 80E6              SJMP     ?C0154?ZW_SECURITY_SCHEME0
B3:00832E         ?C0155?ZW_SECURITY_SCHEME0:
B3:00832E 903578            MOV      DPTR,#enc_data
B3:008331 122589            LCALL    ?C?PLDXDATA
B3:008334 90357B            MOV      DPTR,#enc_data_length
B3:008337 E0                MOVX     A,@DPTR
B3:008338 7E00              MOV      R6,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 847


B3:00833A 29                ADD      A,R1
B3:00833B F9                MOV      R1,A
B3:00833C EE                MOV      A,R6
B3:00833D 3A                ADDC     A,R2
B3:00833E FA                MOV      R2,A
B3:00833F E9                MOV      A,R1
B3:008340 24F8              ADD      A,#0F8H
B3:008342 904064            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B3:008345 127159            LCALL    ?L?COM02E7
B3:008348 7B01              MOV      R3,#01H
B3:00834A 7A35              MOV      R2,#HIGH mac
B3:00834C 798F              MOV      R1,#LOW mac
B3:00834E 7F08              MOV      R7,#08H
B3:008350 31BB              ACALL    ___ZW_memcmp
B3:008352 EF                MOV      A,R7
B3:008353 6017              JZ       ?C0157?ZW_SECURITY_SCHEME0
B3:008355 E4                CLR      A
B3:008356 9035AA            MOV      DPTR,#i
B3:008359 F0                MOVX     @DPTR,A
B3:00835A         ?C0158?ZW_SECURITY_SCHEME0:
B3:00835A B10D              ACALL    ?L?COM04AC
B3:00835C B410FB            CJNE     A,#010H,?C0158?ZW_SECURITY_SCHEME0
B3:00835F         ?C0159?ZW_SECURITY_SCHEME0:
B3:00835F E4                CLR      A
B3:008360 9035AA            MOV      DPTR,#i
B3:008363 F0                MOVX     @DPTR,A
B3:008364         ?C0161?ZW_SECURITY_SCHEME0:
B3:008364 B10D              ACALL    ?L?COM04AC
B3:008366 B410FB            CJNE     A,#010H,?C0161?ZW_SECURITY_SCHEME0
B3:008369         ?C0162?ZW_SECURITY_SCHEME0:
B3:008369 7F00              MOV      R7,#00H
B3:00836B 22                RET      
B3:00836C         ?C0157?ZW_SECURITY_SCHEME0:
B3:00836C B106              ACALL    ?L?COM054A
B3:00836E 12EF4A            LCALL    ?L?COM026F
B3:008371 7A24              MOV      R2,#HIGH enckey
B3:008373 7963              MOV      R1,#LOW enckey
B3:008375 91DD              ACALL    _aes_set_key
B3:008377 9035A6            MOV      DPTR,#auth
B3:00837A 12707E            LCALL    ?L?COM00F2
B3:00837D 125510            LCALL    ?L?COM000B
B3:008380 FD                MOV      R5,A
B3:008381 9176              ACALL    ?L?COM0379
B3:008383 12D9C6            LCALL    _aes_ofb
B3:008386 9176              ACALL    ?L?COM0379
B3:008388 121FB3            LCALL    ?C?CLDPTR
B3:00838B 9035A9            MOV      DPTR,#flags
B3:00838E F0                MOVX     @DPTR,A
B3:00838F 20E402            JB       ACC.4,$ + 5H
B3:008392 8143              AJMP     ?C0164?ZW_SECURITY_SCHEME0
B3:008394 E0                MOVX     A,@DPTR
B3:008395 20E53D            JB       ACC.5,?C0165?ZW_SECURITY_SCHEME0
B3:008398 540F              ANL      A,#0FH
B3:00839A FF                MOV      R7,A
B3:00839B 90359F            MOV      DPTR,#s
B3:00839E 12707E            LCALL    ?L?COM00F2
B3:0083A1 9183              ACALL    ?L?COM00C8
B3:0083A3 9167              ACALL    ?L?COM021B
B3:0083A5 2484              ADD      A,#084H
B3:0083A7 9183              ACALL    ?L?COM00C8
B3:0083A9 B115              ACALL    ?L?COM00FD
B3:0083AB FA                MOV      R2,A
B3:0083AC 7401              MOV      A,#01H
B3:0083AE 122072            LCALL    ?C?CSTPTR
B3:0083B1 916E              ACALL    ?L?COM021D
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 848


B3:0083B3 2484              ADD      A,#084H
B3:0083B5 125510            LCALL    ?L?COM000B
B3:0083B8 FF                MOV      R7,A
B3:0083B9 90359F            MOV      DPTR,#s
B3:0083BC 125522            LCALL    ?L?COM0059
B3:0083BF C003              PUSH     AR3
B3:0083C1 C002              PUSH     AR2
B3:0083C3 C001              PUSH     AR1
B3:0083C5 9176              ACALL    ?L?COM0379
B3:0083C7 126142            LCALL    ?L?COM0044
B3:0083CA D001              POP      AR1
B3:0083CC D002              POP      AR2
B3:0083CE D003              POP      AR3
B3:0083D0 11A2              ACALL    ___ZW_memcpy
B3:0083D2 7F00              MOV      R7,#00H
B3:0083D4 22                RET      
B3:0083D5         ?C0165?ZW_SECURITY_SCHEME0:
B3:0083D5 916E              ACALL    ?L?COM021D
B3:0083D7 2402              ADD      A,#02H
B3:0083D9 125510            LCALL    ?L?COM000B
B3:0083DC 6401              XRL      A,#01H
B3:0083DE 707D              JNZ      state_error?ZW_SECURITY_SCHEME0
B3:0083E0 90359F            MOV      DPTR,#s
B3:0083E3 12707E            LCALL    ?L?COM00F2
B3:0083E6 125510            LCALL    ?L?COM000B
B3:0083E9 FF                MOV      R7,A
B3:0083EA 9035A9            MOV      DPTR,#flags
B3:0083ED E0                MOVX     A,@DPTR
B3:0083EE 540F              ANL      A,#0FH
B3:0083F0 6F                XRL      A,R7
B3:0083F1 706A              JNZ      state_error?ZW_SECURITY_SCHEME0
B3:0083F3         ?C0167?ZW_SECURITY_SCHEME0:
B3:0083F3 B115              ACALL    ?L?COM00FD
B3:0083F5 FA                MOV      R2,A
B3:0083F6 7402              MOV      A,#02H
B3:0083F8 122072            LCALL    ?C?CSTPTR
B3:0083FB         ?C0170?ZW_SECURITY_SCHEME0:
B3:0083FB 916E              ACALL    ?L?COM021D
B3:0083FD 2484              ADD      A,#084H
B3:0083FF 125510            LCALL    ?L?COM000B
B3:008402 916D              ACALL    ?L?COM021C
B3:008404 2404              ADD      A,#04H
B3:008406 126145            LCALL    ?L?COM0045
B3:008409 119C              ACALL    ?L?COM02E2
B3:00840B 9167              ACALL    ?L?COM021B
B3:00840D 2484              ADD      A,#084H
B3:00840F 125510            LCALL    ?L?COM000B
B3:008412 90357C            MOV      DPTR,#dec_message
B3:008415 127352            LCALL    ?L?COM0512
B3:008418 E9                MOV      A,R1
B3:008419 2D                ADD      A,R5
B3:00841A F9                MOV      R1,A
B3:00841B EC                MOV      A,R4
B3:00841C 3A                ADDC     A,R2
B3:00841D FA                MOV      R2,A
B3:00841E C003              PUSH     AR3
B3:008420 C002              PUSH     AR2
B3:008422 C001              PUSH     AR1
B3:008424 9176              ACALL    ?L?COM0379
B3:008426 126142            LCALL    ?L?COM0044
B3:008429 D001              POP      AR1
B3:00842B D002              POP      AR2
B3:00842D D003              POP      AR3
B3:00842F 11A2              ACALL    ___ZW_memcpy
B3:008431 1289E0            LCALL    ?L?COM04F9
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 849


B3:008434 916E              ACALL    ?L?COM021D
B3:008436 2484              ADD      A,#084H
B3:008438 125510            LCALL    ?L?COM000B
B3:00843B FF                MOV      R7,A
B3:00843C 90357B            MOV      DPTR,#enc_data_length
B3:00843F E0                MOVX     A,@DPTR
B3:008440 2F                ADD      A,R7
B3:008441 8015              SJMP     ?C0182?ZW_SECURITY_SCHEME0
B3:008443         ?C0164?ZW_SECURITY_SCHEME0:
B3:008443 90357B            MOV      DPTR,#enc_data_length
B3:008446 E0                MOVX     A,@DPTR
B3:008447 24EC              ADD      A,#0ECH
B3:008449 FF                MOV      R7,A
B3:00844A 9176              ACALL    ?L?COM0379
B3:00844C 126142            LCALL    ?L?COM0044
B3:00844F 119C              ACALL    ?L?COM02E2
B3:008451 1289E0            LCALL    ?L?COM04F9
B3:008454 90357B            MOV      DPTR,#enc_data_length
B3:008457 E0                MOVX     A,@DPTR
B3:008458         
B3:008458 C3                CLR      C
B3:008459 9414              SUBB     A,#014H
B3:00845B FF                MOV      R7,A
B3:00845C 22                RET      
B3:00845D         state_error:
B3:00845D 7F00              MOV      R7,#00H
B3:00845F 22                RET      
----- FUNCTION _sec0_decrypt_message (END) -------


----- FUNCTION _MemoryPutByte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R5' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:008460 123FC4            LCALL    _NVM_ext_write_byte
B3:008463 E4                CLR      A
B3:008464 33                RLC      A
B3:008465 FF                MOV      R7,A
B3:008466 22                RET      
----- FUNCTION _MemoryPutByte (END) -------


----- FUNCTION ?L?COM021B (BEGIN) -----
B3:008467 90357B            MOV      DPTR,#enc_data_length
B3:00846A E0                MOVX     A,@DPTR
B3:00846B 24EC              ADD      A,#0ECH
B3:00846D         ?L?COM021C:
B3:00846D FF                MOV      R7,A
B3:00846E         ?L?COM021D:
B3:00846E 90359F            MOV      DPTR,#s
B3:008471 122589            LCALL    ?C?PLDXDATA
B3:008474 E9                MOV      A,R1
B3:008475 22                RET      
----- FUNCTION ?L?COM021B (END) -------


----- FUNCTION ?L?COM0379 (BEGIN) -----
B3:008476 9035A2            MOV      DPTR,#enc_payload
B3:008479 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0379 (END) -------


----- FUNCTION ?L?COM00C6 (BEGIN) -----
B3:00847C FF                MOV      R7,A
B3:00847D 122589            LCALL    ?C?PLDXDATA
B3:008480 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 850


B3:008481         ?L?COM00C7:
B3:008481 2402              ADD      A,#02H
B3:008483         ?L?COM00C8:
B3:008483 F9                MOV      R1,A
B3:008484 E4                CLR      A
B3:008485 3A                ADDC     A,R2
B3:008486 FA                MOV      R2,A
B3:008487 EF                MOV      A,R7
B3:008488 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM00C6 (END) -------


----- FUNCTION _fe25519_cmov (BEGIN) -----
;---- Variable 'r' assigned to Register 'R6/R7' ----
;---- Variable 'b' assigned to Register 'R3' ----
;---- Variable 'x' assigned to Register 'R4/R5' ----
B3:00848B 903F71            MOV      DPTR,#?_bigint_cmov?BYTE+05H
B3:00848E 7420              MOV      A,#020H
B3:008490 F0                MOVX     @DPTR,A
B3:008491 021B5B            LJMP     ?INTERBANK_TABLE?_bigint_cmov
----- FUNCTION _fe25519_cmov (END) -------


----- FUNCTION ?L?COM046C (BEGIN) -----
B3:008494 7B01              MOV      R3,#01H
B3:008496 7A25              MOV      R2,#HIGH the_tx_session
B3:008498 799D              MOV      R1,#LOW the_tx_session
B3:00849A 22                RET      
----- FUNCTION ?L?COM046C (END) -------


----- FUNCTION ?L?COM01E7 (BEGIN) -----
B3:00849B 128C9A            LCALL    _encrypt_msg
B3:00849E 857283            MOV      DPH,?C_XBP
B3:0084A1 857382            MOV      DPL,?C_XBP+01H
B3:0084A4 EF                MOV      A,R7
B3:0084A5 F0                MOVX     @DPTR,A
B3:0084A6 90259E            MOV      DPTR,#the_tx_session+01H
B3:0084A9 E0                MOVX     A,@DPTR
B3:0084AA FF                MOV      R7,A
B3:0084AB 90259D            MOV      DPTR,#the_tx_session
B3:0084AE E0                MOVX     A,@DPTR
B3:0084AF FD                MOV      R5,A
B3:0084B0 91B9              ACALL    _nonce_clear
B3:0084B2         ?L?COM01E8:
B3:0084B2 857283            MOV      DPH,?C_XBP
B3:0084B5 857382            MOV      DPL,?C_XBP+01H
B3:0084B8 22                RET      
----- FUNCTION ?L?COM01E7 (END) -------


----- FUNCTION _nonce_clear (BEGIN) -----
;---- Variable 'dst' assigned to Register 'R5' ----
;---- Variable 'src' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
B3:0084B9 E4                CLR      A
B3:0084BA FE                MOV      R6,A
B3:0084BB         ?C0032?ZW_SECURITY_SCHEME0:
B3:0084BB EE                MOV      A,R6
B3:0084BC 129E53            LCALL    ?L?COM00D7
B3:0084BF E0                MOVX     A,@DPTR
B3:0084C0 6015              JZ       ?C0034?ZW_SECURITY_SCHEME0
B3:0084C2 EE                MOV      A,R6
B3:0084C3 12DAFD            LCALL    ?L?COM024E
B3:0084C6 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 851


B3:0084C7 B5070D            CJNE     A,AR7,?C0034?ZW_SECURITY_SCHEME0
B3:0084CA 12DB19            LCALL    ?L?COM0234
B3:0084CD E0                MOVX     A,@DPTR
B3:0084CE B50506            CJNE     A,AR5,?C0034?ZW_SECURITY_SCHEME0
B3:0084D1 EE                MOV      A,R6
B3:0084D2 129E53            LCALL    ?L?COM00D7
B3:0084D5 E4                CLR      A
B3:0084D6 F0                MOVX     @DPTR,A
B3:0084D7         ?C0034?ZW_SECURITY_SCHEME0:
B3:0084D7 0E                INC      R6
B3:0084D8 EE                MOV      A,R6
B3:0084D9 B40FDF            CJNE     A,#0FH,?C0032?ZW_SECURITY_SCHEME0
B3:0084DC 22                RET      
----- FUNCTION _nonce_clear (END) -------


----- FUNCTION _aes_set_key (BEGIN) -----
B3:0084DD 904108            MOV      DPTR,#key
B3:0084E0 1225A9            LCALL    ?C?PSTXDATA
B3:0084E3 904108            MOV      DPTR,#key
B3:0084E6 122589            LCALL    ?C?PLDXDATA
B3:0084E9 126149            LCALL    ?L?COM0047
B3:0084EC 7B01              MOV      R3,#01H
B3:0084EE 7A24              MOV      R2,#HIGH aes_key
B3:0084F0 7983              MOV      R1,#LOW aes_key
B3:0084F2 7F10              MOV      R7,#010H
B3:0084F4 11A2              ACALL    ___ZW_memcpy
B3:0084F6 90410B            MOV      DPTR,#iv
B3:0084F9 122589            LCALL    ?C?PLDXDATA
B3:0084FC 126149            LCALL    ?L?COM0047
B3:0084FF 12DA13            LCALL    ?L?COM04F6
B3:008502 7F10              MOV      R7,#010H
B3:008504 01A2              AJMP     ___ZW_memcpy
----- FUNCTION _aes_set_key (END) -------


----- FUNCTION ?L?COM054A (BEGIN) -----
B3:008506 7B01              MOV      R3,#01H
B3:008508 7A35              MOV      R2,#HIGH iv
B3:00850A 797F              MOV      R1,#LOW iv
B3:00850C 22                RET      
----- FUNCTION ?L?COM054A (END) -------


----- FUNCTION ?L?COM04AC (BEGIN) -----
B3:00850D 9035AA            MOV      DPTR,#i
B3:008510 E0                MOVX     A,@DPTR
B3:008511 04                INC      A
B3:008512 F0                MOVX     @DPTR,A
B3:008513 E0                MOVX     A,@DPTR
B3:008514 22                RET      
----- FUNCTION ?L?COM04AC (END) -------


----- FUNCTION ?L?COM00FD (BEGIN) -----
B3:008515 90359F            MOV      DPTR,#s
B3:008518         ?L?COM00FE:
B3:008518 122589            LCALL    ?C?PLDXDATA
B3:00851B         ?L?COM00FF:
B3:00851B E9                MOV      A,R1
B3:00851C 2402              ADD      A,#02H
B3:00851E F9                MOV      R1,A
B3:00851F E4                CLR      A
B3:008520 3A                ADDC     A,R2
B3:008521 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 852


----- FUNCTION ?L?COM00FD (END) -------


----- FUNCTION ?L?COM038E (BEGIN) -----
B3:008522 F9                MOV      R1,A
B3:008523 E4                CLR      A
B3:008524 3A                ADDC     A,R2
B3:008525 AD01              MOV      R5,AR1
B3:008527 90427D            MOV      DPTR,#?_StoreRouteExplore?BYTE+01H
B3:00852A F0                MOVX     @DPTR,A
B3:00852B A3                INC      DPTR
B3:00852C ED                MOV      A,R5
B3:00852D F0                MOVX     @DPTR,A
B3:00852E 1219B2            LCALL    ?INTERBANK_TABLE?_StoreRouteExplore
B3:008531 021A02            LJMP     ?INTERBANK_TABLE?_UpdateResponseRouteLastReturnRoute
----- FUNCTION ?L?COM038E (END) -------


----- FUNCTION _IsMyExploreFrame (BEGIN) -----
B3:008534 900A7B            MOV      DPTR,#pRxFrame
B3:008537 1225A9            LCALL    ?C?PSTXDATA
B3:00853A 128914            LCALL    ?L?COM0024
B3:00853D E9                MOV      A,R1
B3:00853E 2409              ADD      A,#09H
B3:008540 125510            LCALL    ?L?COM000B
B3:008543 541F              ANL      A,#01FH
B3:008545 F555              MOV      bCurrentCmd,A
B3:008547 128914            LCALL    ?L?COM0024
B3:00854A 12550D            LCALL    ?L?COM000A
B3:00854D FF                MOV      R7,A
;---- Variable 'bExploreFrameLength' assigned to Register 'R7' ----
B3:00854E E550              MOV      A,bNetworkWideInclusion
B3:008550 6401              XRL      A,#01H
B3:008552 6022              JZ       ?C0110?ZW_EXPLORE
B3:008554 E550              MOV      A,bNetworkWideInclusion
B3:008556 6402              XRL      A,#02H
B3:008558 601C              JZ       ?C0110?ZW_EXPLORE
B3:00855A 7412              MOV      A,#012H
B3:00855C D3                SETB     C
B3:00855D 9F                SUBB     A,R7
B3:00855E 5016              JNC      ?C0110?ZW_EXPLORE
B3:008560 E555              MOV      A,bCurrentCmd
B3:008562 B40206            CJNE     A,#02H,?C0111?ZW_EXPLORE
B3:008565 7419              MOV      A,#019H
B3:008567 D3                SETB     C
B3:008568 9F                SUBB     A,R7
B3:008569 500B              JNC      ?C0110?ZW_EXPLORE
B3:00856B         ?C0111?ZW_EXPLORE:
B3:00856B E555              MOV      A,bCurrentCmd
B3:00856D B40108            CJNE     A,#01H,?C0109?ZW_EXPLORE
B3:008570 741B              MOV      A,#01BH
B3:008572 D3                SETB     C
B3:008573 9F                SUBB     A,R7
B3:008574 4002              JC       ?C0109?ZW_EXPLORE
B3:008576         ?C0110?ZW_EXPLORE:
B3:008576 C3                CLR      C
B3:008577 22                RET      
B3:008578         ?C0109?ZW_EXPLORE:
B3:008578 128914            LCALL    ?L?COM0024
B3:00857B E9                MOV      A,R1
B3:00857C 240A              ADD      A,#0AH
B3:00857E 125510            LCALL    ?L?COM000B
B3:008581 30E21E            JNB      ACC.2,?C0113?ZW_EXPLORE
B3:008584 128914            LCALL    ?L?COM0024
B3:008587 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 853


B3:008588 2408              ADD      A,#08H
B3:00858A 125510            LCALL    ?L?COM000B
B3:00858D FF                MOV      R7,A
B3:00858E 901221            MOV      DPTR,#nodeID
B3:008591 E0                MOVX     A,@DPTR
B3:008592 6F                XRL      A,R7
B3:008593 600D              JZ       ?C0113?ZW_EXPLORE
B3:008595 128914            LCALL    ?L?COM0024
B3:008598 E9                MOV      A,R1
B3:008599 2404              ADD      A,#04H
B3:00859B 125510            LCALL    ?L?COM000B
B3:00859E FF                MOV      R7,A
B3:00859F 12D2DA            LCALL    _ExplorePurgeQueue
B3:0085A2         ?C0113?ZW_EXPLORE:
B3:0085A2 E555              MOV      A,bCurrentCmd
B3:0085A4 6402              XRL      A,#02H
B3:0085A6 6002              JZ       $ + 4H
B3:0085A8 C16F              AJMP     ?C0114?ZW_EXPLORE
B3:0085AA 900A7B            MOV      DPTR,#pRxFrame
B3:0085AD 122589            LCALL    ?C?PLDXDATA
B3:0085B0 12550D            LCALL    ?L?COM000A
B3:0085B3 30E702            JNB      ACC.7,$ + 5H
B3:0085B6 C16D              AJMP     ?C0115?ZW_EXPLORE
B3:0085B8 128914            LCALL    ?L?COM0024
B3:0085BB E9                MOV      A,R1
B3:0085BC 2408              ADD      A,#08H
B3:0085BE 125510            LCALL    ?L?COM000B
B3:0085C1 FF                MOV      R7,A
B3:0085C2 901221            MOV      DPTR,#nodeID
B3:0085C5 E0                MOVX     A,@DPTR
B3:0085C6 6F                XRL      A,R7
B3:0085C7 702C              JNZ      ?C0116?ZW_EXPLORE
B3:0085C9 200D02            JB       searchResultNeeded,$ + 5H
B3:0085CC C16D              AJMP     ?C0115?ZW_EXPLORE
B3:0085CE C20D              CLR      searchResultNeeded
B3:0085D0 128914            LCALL    ?L?COM0024
B3:0085D3 E9                MOV      A,R1
B3:0085D4 2404              ADD      A,#04H
B3:0085D6 125510            LCALL    ?L?COM000B
B3:0085D9 FD                MOV      R5,A
B3:0085DA 7F03              MOV      R7,#03H
B3:0085DC 12D11D            LCALL    _EventPush
B3:0085DF         ?C0118?ZW_EXPLORE:
B3:0085DF         ?C0119?ZW_EXPLORE:
B3:0085DF 128914            LCALL    ?L?COM0024
B3:0085E2 E9                MOV      A,R1
B3:0085E3 2404              ADD      A,#04H
B3:0085E5 125510            LCALL    ?L?COM000B
B3:0085E8 FF                MOV      R7,A
B3:0085E9 D236              SETB     ?_StoreRouteExplore?BIT
B3:0085EB 128914            LCALL    ?L?COM0024
B3:0085EE E9                MOV      A,R1
B3:0085EF 2413              ADD      A,#013H
B3:0085F1 B122              ACALL    ?L?COM038E
B3:0085F3 8078              SJMP     ?C0115?ZW_EXPLORE
B3:0085F5         ?C0116?ZW_EXPLORE:
B3:0085F5 128914            LCALL    ?L?COM0024
B3:0085F8 E9                MOV      A,R1
B3:0085F9 240C              ADD      A,#0CH
B3:0085FB 125510            LCALL    ?L?COM000B
B3:0085FE FF                MOV      R7,A
B3:0085FF 540F              ANL      A,#0FH
B3:008601 FE                MOV      R6,A
;---- Variable 'bTemp7' assigned to Register 'R6' ----
B3:008602 6069              JZ       ?C0115?ZW_EXPLORE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 854


B3:008604 128914            LCALL    ?L?COM0024
B3:008607 E9                MOV      A,R1
B3:008608 240D              ADD      A,#0DH
B3:00860A F9                MOV      R1,A
B3:00860B E4                CLR      A
B3:00860C 3A                ADDC     A,R2
B3:00860D FA                MOV      R2,A
B3:00860E 1E                DEC      R6
B3:00860F 7C00              MOV      R4,#00H
B3:008611 E9                MOV      A,R1
B3:008612 2E                ADD      A,R6
B3:008613 F9                MOV      R1,A
B3:008614 EC                MOV      A,R4
B3:008615 3A                ADDC     A,R2
B3:008616 FA                MOV      R2,A
B3:008617 121FB3            LCALL    ?C?CLDPTR
B3:00861A FD                MOV      R5,A
B3:00861B 901221            MOV      DPTR,#nodeID
B3:00861E E0                MOVX     A,@DPTR
B3:00861F 6D                XRL      A,R5
B3:008620 704B              JNZ      ?C0115?ZW_EXPLORE
B3:008622 128914            LCALL    ?L?COM0024
B3:008625 12550D            LCALL    ?L?COM000A
B3:008628 6419              XRL      A,#019H
B3:00862A 7041              JNZ      ?C0115?ZW_EXPLORE
B3:00862C 128914            LCALL    ?L?COM0024
B3:00862F 1272CD            LCALL    ?L?COM0486
B3:008632 EF                MOV      A,R7
B3:008633 54F0              ANL      A,#0F0H
B3:008635 2410              ADD      A,#010H
B3:008637 2E                ADD      A,R6
B3:008638 122072            LCALL    ?C?CSTPTR
B3:00863B 128914            LCALL    ?L?COM0024
B3:00863E E9                MOV      A,R1
B3:00863F 240B              ADD      A,#0BH
B3:008641 F9                MOV      R1,A
B3:008642 E4                CLR      A
B3:008643 125765            LCALL    ?L?COM01E3
B3:008646 128914            LCALL    ?L?COM0024
B3:008649 126149            LCALL    ?L?COM0047
B3:00864C 7F18              MOV      R7,#018H
B3:00864E 12EFF9            LCALL    ?L?COM0550
B3:008651 C208              CLR      currentSeqNoUseTX
B3:008653 128914            LCALL    ?L?COM0024
B3:008656 E9                MOV      A,R1
B3:008657 2404              ADD      A,#04H
B3:008659 125510            LCALL    ?L?COM000B
B3:00865C FF                MOV      R7,A
B3:00865D 128914            LCALL    ?L?COM0024
B3:008660 E9                MOV      A,R1
B3:008661 2408              ADD      A,#08H
B3:008663 125510            LCALL    ?L?COM000B
B3:008666 FD                MOV      R5,A
B3:008667 12A568            LCALL    ?L?COM01B5
B3:00866A 121967            LCALL    ?INTERBANK_TABLE?_TransportEnQueueExploreFrame
B3:00866D         ?C0115?ZW_EXPLORE:
B3:00866D C3                CLR      C
B3:00866E 22                RET      
B3:00866F         ?C0114?ZW_EXPLORE:
;---- Variable 'bTemp3' assigned to Register 'R7' ----
B3:00866F E4                CLR      A
B3:008670 FF                MOV      R7,A
B3:008671         ?C0123?ZW_EXPLORE:
B3:008671 128914            LCALL    ?L?COM0024
B3:008674 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 855


B3:008675 240D              ADD      A,#0DH
B3:008677 12E05F            LCALL    ?L?COM02C2
B3:00867A 121FB3            LCALL    ?C?CLDPTR
B3:00867D FE                MOV      R6,A
B3:00867E 901221            MOV      DPTR,#nodeID
B3:008681 E0                MOVX     A,@DPTR
B3:008682 B50602            CJNE     A,AR6,?C0125?ZW_EXPLORE
B3:008685 C3                CLR      C
B3:008686 22                RET      
B3:008687         ?C0125?ZW_EXPLORE:
B3:008687 0F                INC      R7
B3:008688 EF                MOV      A,R7
B3:008689 B404E5            CJNE     A,#04H,?C0123?ZW_EXPLORE
B3:00868C         ?C0122?ZW_EXPLORE:
B3:00868C 128914            LCALL    ?L?COM0024
B3:00868F E9                MOV      A,R1
B3:008690 2404              ADD      A,#04H
B3:008692 125510            LCALL    ?L?COM000B
B3:008695 FF                MOV      R7,A
B3:008696 128914            LCALL    ?L?COM0024
B3:008699 E9                MOV      A,R1
B3:00869A 2406              ADD      A,#06H
B3:00869C 125510            LCALL    ?L?COM000B
B3:00869F 540F              ANL      A,#0FH
B3:0086A1 FD                MOV      R5,A
B3:0086A2 12D29B            LCALL    _ExploreFrameIgnoreCheck
B3:0086A5 5002              JNC      ?C0127?ZW_EXPLORE
B3:0086A7 C3                CLR      C
B3:0086A8 22                RET      
B3:0086A9         ?C0127?ZW_EXPLORE:
B3:0086A9 128914            LCALL    ?L?COM0024
B3:0086AC E9                MOV      A,R1
B3:0086AD 2408              ADD      A,#08H
B3:0086AF 125510            LCALL    ?L?COM000B
B3:0086B2 FF                MOV      R7,A
B3:0086B3 901221            MOV      DPTR,#nodeID
B3:0086B6 E0                MOVX     A,@DPTR
B3:0086B7 6F                XRL      A,R7
B3:0086B8 7003              JNZ      $ + 5H
B3:0086BA 028823            LJMP     ?C0128?ZW_EXPLORE
B3:0086BD 90122A            MOV      DPTR,#bldeviceOptionsMask
B3:0086C0 E0                MOVX     A,@DPTR
B3:0086C1 FF                MOV      R7,A
B3:0086C2 5430              ANL      A,#030H
B3:0086C4 6003              JZ       $ + 5H
B3:0086C6 028823            LJMP     ?C0128?ZW_EXPLORE
B3:0086C9 EF                MOV      A,R7
B3:0086CA 20E003            JB       ACC.0,$ + 6H
B3:0086CD 028823            LJMP     ?C0128?ZW_EXPLORE
B3:0086D0 E555              MOV      A,bCurrentCmd
B3:0086D2 6401              XRL      A,#01H
B3:0086D4 600C              JZ       ?C0130?ZW_EXPLORE
B3:0086D6 900A7B            MOV      DPTR,#pRxFrame
B3:0086D9 122589            LCALL    ?C?PLDXDATA
B3:0086DC 12550D            LCALL    ?L?COM000A
B3:0086DF 30E723            JNB      ACC.7,?C0129?ZW_EXPLORE
B3:0086E2         ?C0130?ZW_EXPLORE:
B3:0086E2 200C03            JB       exploreInclusionModeRepeat,$ + 6H
B3:0086E5 028823            LJMP     ?C0128?ZW_EXPLORE
B3:0086E8 E555              MOV      A,bCurrentCmd
B3:0086EA 6401              XRL      A,#01H
B3:0086EC 6003              JZ       $ + 5H
B3:0086EE 028823            LJMP     ?C0128?ZW_EXPLORE
B3:0086F1 128914            LCALL    ?L?COM0024
B3:0086F4 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 856


B3:0086F5 2411              ADD      A,#011H
B3:0086F7 F9                MOV      R1,A
B3:0086F8 E4                CLR      A
B3:0086F9 3A                ADDC     A,R2
B3:0086FA FE                MOV      R6,A
B3:0086FB AF01              MOV      R7,AR1
B3:0086FD 12D4E2            LCALL    _IsNetworkHomeIDValid
B3:008700 4003              JC       $ + 5H
B3:008702 028823            LJMP     ?C0128?ZW_EXPLORE
B3:008705         ?C0129?ZW_EXPLORE:
B3:008705 12D28D            LCALL    ExploreQueueIndex
B3:008708 8F52              MOV      bExploreQueueIndex,R7
B3:00870A BF0202            CJNE     R7,#02H,?C0131?ZW_EXPLORE
B3:00870D C3                CLR      C
B3:00870E 22                RET      
B3:00870F         ?C0131?ZW_EXPLORE:
B3:00870F 128914            LCALL    ?L?COM0024
B3:008712 12550D            LCALL    ?L?COM000A
B3:008715 FF                MOV      R7,A
B3:008716 7440              MOV      A,#040H
B3:008718 C3                CLR      C
B3:008719 9F                SUBB     A,R7
B3:00871A 5002              JNC      ?C0132?ZW_EXPLORE
B3:00871C C3                CLR      C
B3:00871D 22                RET      
B3:00871E         ?C0132?ZW_EXPLORE:
B3:00871E E555              MOV      A,bCurrentCmd
B3:008720 B4011B            CJNE     A,#01H,?C0133?ZW_EXPLORE
B3:008723 128914            LCALL    ?L?COM0024
B3:008726 12EFB3            LCALL    ?L?COM041B
B3:008729 7B01              MOV      R3,#01H
B3:00872B C002              PUSH     AR2
B3:00872D C001              PUSH     AR1
B3:00872F 7A12              MOV      R2,#HIGH homeID
B3:008731 7923              MOV      R1,#LOW homeID
B3:008733 126149            LCALL    ?L?COM0047
B3:008736 D001              POP      AR1
B3:008738 D002              POP      AR2
B3:00873A 7F04              MOV      R7,#04H
B3:00873C 11A2              ACALL    ___ZW_memcpy
B3:00873E         ?C0133?ZW_EXPLORE:
B3:00873E 12EF5E            LCALL    ?L?COM02A4
B3:008741 90095B            MOV      DPTR,#pExploreQueueElement
B3:008744 1225A9            LCALL    ?C?PSTXDATA
B3:008747 128914            LCALL    ?L?COM0024
B3:00874A 12550D            LCALL    ?L?COM000A
B3:00874D 12703E            LCALL    ?L?COM009E
B3:008750 1272B2            LCALL    ?L?COM0448
B3:008753 C003              PUSH     AR3
B3:008755 C002              PUSH     AR2
B3:008757 C001              PUSH     AR1
B3:008759 128914            LCALL    ?L?COM0024
B3:00875C 126149            LCALL    ?L?COM0047
B3:00875F D001              POP      AR1
B3:008761 D002              POP      AR2
B3:008763 D003              POP      AR3
B3:008765 11A2              ACALL    ___ZW_memcpy
B3:008767 128914            LCALL    ?L?COM0024
B3:00876A E9                MOV      A,R1
B3:00876B 2404              ADD      A,#04H
B3:00876D 125510            LCALL    ?L?COM000B
B3:008770 FF                MOV      R7,A
B3:008771 12D223            LCALL    _ExploreFrameIgnoreQueueIndex
;---- Variable 'bTemp1' assigned to Register 'R7' ----
B3:008774 128914            LCALL    ?L?COM0024
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 857


B3:008777 E9                MOV      A,R1
B3:008778 2406              ADD      A,#06H
B3:00877A 125510            LCALL    ?L?COM000B
B3:00877D 540F              ANL      A,#0FH
B3:00877F FE                MOV      R6,A
B3:008780 12D284            LCALL    ?L?COM046E
B3:008783 A606              MOV      @R0,AR6
B3:008785 EF                MOV      A,R7
B3:008786 12D21B            LCALL    ?L?COM026D
B3:008789 7607              MOV      @R0,#07H
B3:00878B 08                INC      R0
B3:00878C 76D0              MOV      @R0,#0D0H
B3:00878E 128914            LCALL    ?L?COM0024
B3:008791 E9                MOV      A,R1
B3:008792 240C              ADD      A,#0CH
B3:008794 125510            LCALL    ?L?COM000B
B3:008797 54F0              ANL      A,#0F0H
B3:008799 900A81            MOV      DPTR,#bTemp
B3:00879C F0                MOVX     @DPTR,A
B3:00879D 7003              JNZ      $ + 5H
B3:00879F 028823            LJMP     ?C0128?ZW_EXPLORE
B3:0087A2 E0                MOVX     A,@DPTR
B3:0087A3 FF                MOV      R7,A
B3:0087A4 7440              MOV      A,#040H
B3:0087A6 C3                CLR      C
B3:0087A7 9F                SUBB     A,R7
B3:0087A8 4079              JC       ?C0128?ZW_EXPLORE
B3:0087AA E0                MOVX     A,@DPTR
B3:0087AB 24F0              ADD      A,#0F0H
B3:0087AD F0                MOVX     @DPTR,A
B3:0087AE 12703F            LCALL    ?L?COM009F
B3:0087B1 242C              ADD      A,#02CH
B3:0087B3 125510            LCALL    ?L?COM000B
B3:0087B6 540F              ANL      A,#0FH
B3:0087B8 FF                MOV      R7,A
;---- Variable 'bTemp2' assigned to Register 'R7' ----
B3:0087B9 7404              MOV      A,#04H
B3:0087BB D3                SETB     C
B3:0087BC 9F                SUBB     A,R7
B3:0087BD 4064              JC       ?C0128?ZW_EXPLORE
B3:0087BF 901221            MOV      DPTR,#nodeID
B3:0087C2 E0                MOVX     A,@DPTR
B3:0087C3 FE                MOV      R6,A
B3:0087C4 12703F            LCALL    ?L?COM009F
B3:0087C7 242D              ADD      A,#02DH
B3:0087C9 12E05F            LCALL    ?L?COM02C2
B3:0087CC EE                MOV      A,R6
B3:0087CD 122072            LCALL    ?C?CSTPTR
B3:0087D0 900A81            MOV      DPTR,#bTemp
B3:0087D3 E0                MOVX     A,@DPTR
B3:0087D4 2F                ADD      A,R7
B3:0087D5 04                INC      A
B3:0087D6 12703E            LCALL    ?L?COM009E
B3:0087D9 242C              ADD      A,#02CH
B3:0087DB 9183              ACALL    ?L?COM00C8
B3:0087DD 128914            LCALL    ?L?COM0024
B3:0087E0 E9                MOV      A,R1
B3:0087E1 2404              ADD      A,#04H
B3:0087E3 125510            LCALL    ?L?COM000B
B3:0087E6 12703E            LCALL    ?L?COM009E
B3:0087E9 9181              ACALL    ?L?COM00C7
B3:0087EB 128914            LCALL    ?L?COM0024
B3:0087EE E9                MOV      A,R1
B3:0087EF 2408              ADD      A,#08H
B3:0087F1 125510            LCALL    ?L?COM000B
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 858


B3:0087F4 12703E            LCALL    ?L?COM009E
B3:0087F7 2403              ADD      A,#03H
B3:0087F9 9183              ACALL    ?L?COM00C8
B3:0087FB 90095B            MOV      DPTR,#pExploreQueueElement
B3:0087FE 12727A            LCALL    ?L?COM0432
B3:008801 90095B            MOV      DPTR,#pExploreQueueElement
B3:008804 125522            LCALL    ?L?COM0059
B3:008807 7440              MOV      A,#040H
B3:008809 122072            LCALL    ?C?CSTPTR
B3:00880C 128914            LCALL    ?L?COM0024
B3:00880F 12550D            LCALL    ?L?COM000A
B3:008812 12703E            LCALL    ?L?COM009E
B3:008815 2406              ADD      A,#06H
B3:008817 128483            LCALL    ?L?COM00C8
B3:00881A 12703F            LCALL    ?L?COM009F
B3:00881D 12C909            LCALL    ?L?COM040B
B3:008820 12221F            LCALL    ?C?ISTPTR
B3:008823         ?C0128?ZW_EXPLORE:
B3:008823 3114              ACALL    ?L?COM0024
B3:008825 E9                MOV      A,R1
B3:008826 2408              ADD      A,#08H
B3:008828 125510            LCALL    ?L?COM000B
B3:00882B FF                MOV      R7,A
B3:00882C 901221            MOV      DPTR,#nodeID
B3:00882F E0                MOVX     A,@DPTR
B3:008830 6F                XRL      A,R7
B3:008831 6006              JZ       ?C0137?ZW_EXPLORE
B3:008833 EF                MOV      A,R7
B3:008834 F4                CPL      A
B3:008835 6002              JZ       $ + 4H
B3:008837 210F              AJMP     ?C0136?ZW_EXPLORE
B3:008839         ?C0137?ZW_EXPLORE:
B3:008839 900A7B            MOV      DPTR,#pRxFrame
B3:00883C 122589            LCALL    ?C?PLDXDATA
B3:00883F 12550D            LCALL    ?L?COM000A
B3:008842 30E702            JNB      ACC.7,$ + 5H
B3:008845 210F              AJMP     ?C0136?ZW_EXPLORE
B3:008847 E555              MOV      A,bCurrentCmd
B3:008849 6002              JZ       $ + 4H
B3:00884B 210F              AJMP     ?C0136?ZW_EXPLORE
B3:00884D 3114              ACALL    ?L?COM0024
B3:00884F 12EFB3            LCALL    ?L?COM041B
B3:008852 C003              PUSH     AR3
B3:008854 C002              PUSH     AR2
B3:008856 C001              PUSH     AR1
B3:008858 900A7B            MOV      DPTR,#pRxFrame
B3:00885B 12707E            LCALL    ?L?COM00F2
B3:00885E F9                MOV      R1,A
B3:00885F E4                CLR      A
B3:008860 3A                ADDC     A,R2
B3:008861 FA                MOV      R2,A
B3:008862 1225DE            LCALL    ?C?PSTPTR
B3:008865 3114              ACALL    ?L?COM0024
B3:008867 12550D            LCALL    ?L?COM000A
B3:00886A 24EE              ADD      A,#0EEH
B3:00886C FF                MOV      R7,A
B3:00886D 900A7B            MOV      DPTR,#pRxFrame
B3:008870 122589            LCALL    ?C?PLDXDATA
B3:008873 E9                MOV      A,R1
B3:008874 2406              ADD      A,#06H
B3:008876 128483            LCALL    ?L?COM00C8
B3:008879 900A7B            MOV      DPTR,#pRxFrame
B3:00887C 122589            LCALL    ?C?PLDXDATA
B3:00887F 12550D            LCALL    ?L?COM000A
B3:008882 4401              ORL      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 859


B3:008884 122072            LCALL    ?C?CSTPTR
B3:008887 3114              ACALL    ?L?COM0024
B3:008889 E9                MOV      A,R1
B3:00888A 2405              ADD      A,#05H
B3:00888C 125510            LCALL    ?L?COM000B
B3:00888F 30E676            JNB      ACC.6,?C0138?ZW_EXPLORE
B3:008892 3114              ACALL    ?L?COM0024
B3:008894 E9                MOV      A,R1
B3:008895 2404              ADD      A,#04H
B3:008897 125510            LCALL    ?L?COM000B
B3:00889A FF                MOV      R7,A
B3:00889B C236              CLR      ?_StoreRouteExplore?BIT
B3:00889D 3114              ACALL    ?L?COM0024
B3:00889F E9                MOV      A,R1
B3:0088A0 240C              ADD      A,#0CH
B3:0088A2 128522            LCALL    ?L?COM038E
B3:0088A5 3114              ACALL    ?L?COM0024
B3:0088A7 126149            LCALL    ?L?COM0047
B3:0088AA 7F11              MOV      R7,#011H
B3:0088AC 12EFF9            LCALL    ?L?COM0550
B3:0088AF 900963            MOV      DPTR,#exploreSearchResultBuffer+05H
B3:0088B2 E0                MOVX     A,@DPTR
B3:0088B3 54BF              ANL      A,#0BFH
B3:0088B5 3113              ACALL    ?L?COM0023
B3:0088B7 E9                MOV      A,R1
B3:0088B8 2404              ADD      A,#04H
B3:0088BA 125510            LCALL    ?L?COM000B
B3:0088BD 90096F            MOV      DPTR,#exploreSearchResultBuffer+011H
B3:0088C0 3113              ACALL    ?L?COM0023
B3:0088C2 E9                MOV      A,R1
B3:0088C3 2406              ADD      A,#06H
B3:0088C5 125510            LCALL    ?L?COM000B
B3:0088C8 540F              ANL      A,#0FH
B3:0088CA 900970            MOV      DPTR,#exploreSearchResultBuffer+012H
B3:0088CD 3113              ACALL    ?L?COM0023
B3:0088CF E9                MOV      A,R1
B3:0088D0 240C              ADD      A,#0CH
B3:0088D2 126145            LCALL    ?L?COM0045
B3:0088D5 7B01              MOV      R3,#01H
B3:0088D7 7A09              MOV      R2,#HIGH exploreSearchResultBuffer+013H
B3:0088D9 7971              MOV      R1,#LOW exploreSearchResultBuffer+013H
B3:0088DB 7F05              MOV      R7,#05H
B3:0088DD 127382            LCALL    ?L?COM057C
B3:0088E0 900962            MOV      DPTR,#exploreSearchResultBuffer+04H
B3:0088E3 F0                MOVX     @DPTR,A
B3:0088E4 900965            MOV      DPTR,#exploreSearchResultBuffer+07H
B3:0088E7 7419              MOV      A,#019H
B3:0088E9 3113              ACALL    ?L?COM0023
B3:0088EB E9                MOV      A,R1
B3:0088EC 2404              ADD      A,#04H
B3:0088EE 125510            LCALL    ?L?COM000B
B3:0088F1 FD                MOV      R5,A
B3:0088F2 900966            MOV      DPTR,#exploreSearchResultBuffer+08H
B3:0088F5 F0                MOVX     @DPTR,A
B3:0088F6 A3                INC      DPTR
B3:0088F7 7422              MOV      A,#022H
B3:0088F9 F0                MOVX     @DPTR,A
B3:0088FA A3                INC      DPTR
B3:0088FB 7407              MOV      A,#07H
B3:0088FD F0                MOVX     @DPTR,A
B3:0088FE C208              CLR      currentSeqNoUseTX
B3:008900 12A568            LCALL    ?L?COM01B5
B3:008903 121967            LCALL    ?INTERBANK_TABLE?_TransportEnQueueExploreFrame
B3:008906 8009              SJMP     ?C0142?ZW_EXPLORE
B3:008908         ?C0138?ZW_EXPLORE:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 860


B3:008908 E555              MOV      A,bCurrentCmd
B3:00890A C3                CLR      C
B3:00890B 7001              JNZ      ?C0140?ZW_EXPLORE
B3:00890D D3                SETB     C
B3:00890E         ?C0140?ZW_EXPLORE:
B3:00890E 22                RET      
B3:00890F         ?C0136?ZW_EXPLORE:
B3:00890F C3                CLR      C
B3:008910 22                RET      
B3:008911         ?C0142?ZW_EXPLORE:
B3:008911 D3                SETB     C
B3:008912 22                RET      
----- FUNCTION _IsMyExploreFrame (END) -------


----- FUNCTION ?L?COM0023 (BEGIN) -----
B3:008913 F0                MOVX     @DPTR,A
B3:008914         ?L?COM0024:
B3:008914 900A7B            MOV      DPTR,#pRxFrame
B3:008917         ?L?COM0025:
B3:008917 122589            LCALL    ?C?PLDXDATA
B3:00891A 0225BE            LJMP     ?C?PLDPTR
----- FUNCTION ?L?COM0023 (END) -------


----- FUNCTION NoiseDetectSetDefault (BEGIN) -----
B3:00891D 22                RET      
----- FUNCTION NoiseDetectSetDefault (END) -------


----- FUNCTION _s2_inclusion_init (BEGIN) -----
;---- Variable 'schemes' assigned to Register 'R7' ----
;---- Variable 'keys' assigned to Register 'R3' ----
;---- Variable 'curves' assigned to Register 'R5' ----
B3:00891E EF                MOV      A,R7
B3:00891F 6402              XRL      A,#02H
B3:008921 6003              JZ       ?C0088?S2_INCLUSION
B3:008923 7F02              MOV      R7,#02H
B3:008925 22                RET      
B3:008926         ?C0088?S2_INCLUSION:
B3:008926 ED                MOV      A,R5
B3:008927 6401              XRL      A,#01H
B3:008929 6003              JZ       ?C0090?S2_INCLUSION
B3:00892B 7F03              MOV      R7,#03H
B3:00892D 22                RET      
B3:00892E         ?C0090?S2_INCLUSION:
B3:00892E EB                MOV      A,R3
B3:00892F 5478              ANL      A,#078H
B3:008931 7005              JNZ      ?C0092?S2_INCLUSION
B3:008933 EB                MOV      A,R3
B3:008934 5487              ANL      A,#087H
B3:008936 7003              JNZ      ?C0091?S2_INCLUSION
B3:008938         ?C0092?S2_INCLUSION:
B3:008938 7F01              MOV      R7,#01H
B3:00893A 22                RET      
B3:00893B         ?C0091?S2_INCLUSION:
B3:00893B 90260D            MOV      DPTR,#m_schemes
B3:00893E EF                MOV      A,R7
B3:00893F F0                MOVX     @DPTR,A
B3:008940 90281D            MOV      DPTR,#m_curves
B3:008943 ED                MOV      A,R5
B3:008944 F0                MOVX     @DPTR,A
B3:008945 90260C            MOV      DPTR,#m_keys
B3:008948 EB                MOV      A,R3
B3:008949 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 861


B3:00894A 7F00              MOV      R7,#00H
B3:00894C 22                RET      
----- FUNCTION _s2_inclusion_init (END) -------


----- FUNCTION _secure_learn_enter (BEGIN) -----
B3:00894D 9042C7            MOV      DPTR,#handle
B3:008950 1225A9            LCALL    ?C?PSTXDATA
B3:008953 3167              ACALL    ?L?COM0547
B3:008955 1298C9            LCALL    _secure_learn_entryaction
B3:008958 3167              ACALL    ?L?COM0547
B3:00895A 7409              MOV      A,#09H
B3:00895C 122072            LCALL    ?C?CSTPTR
B3:00895F 3167              ACALL    ?L?COM0547
B3:008961 12E2C3            LCALL    ?L?COM02FC
B3:008964 02223E            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_enter (END) -------


----- FUNCTION ?L?COM0547 (BEGIN) -----
B3:008967 9042C7            MOV      DPTR,#handle
B3:00896A 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0547 (END) -------


----- FUNCTION _ZW_MemoryPutBuffer (BEGIN) -----
;---- Variable 'buffer' assigned to Register 'R1/R2/R3' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:00896D 904057            MOV      DPTR,#length
B3:008970 E0                MOVX     A,@DPTR
B3:008971 FD                MOV      R5,A
B3:008972 A3                INC      DPTR
B3:008973 E0                MOVX     A,@DPTR
B3:008974 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B3:008977 CD                XCH      A,R5
B3:008978 F0                MOVX     @DPTR,A
B3:008979 A3                INC      DPTR
B3:00897A ED                MOV      A,R5
B3:00897B F0                MOVX     @DPTR,A
B3:00897C 126C78            LCALL    _NVM_ext_write_buffer
B3:00897F 5009              JNC      ?C0015?ZW_MEM
B3:008981 904058            MOV      DPTR,#length+01H
B3:008984 E0                MOVX     A,@DPTR
B3:008985 2401              ADD      A,#01H
B3:008987 FF                MOV      R7,A
B3:008988 8002              SJMP     ?C0016?ZW_MEM
B3:00898A         ?C0015?ZW_MEM:
B3:00898A 7F01              MOV      R7,#01H
B3:00898C         ?C0016?ZW_MEM:
B3:00898C 22                RET      
----- FUNCTION _ZW_MemoryPutBuffer (END) -------


----- FUNCTION _ZW_AES_ecb (BEGIN) -----
B3:00898D 903EC3            MOV      DPTR,#bKey
B3:008990 12E6C4            LCALL    ?L?COM0540
B3:008993         ?C0026?ZW_PHY_AES_050X:
B3:008993 E58F              MOV      A,AESCON1
B3:008995 20E0FB            JB       ACC.0,?C0026?ZW_PHY_AES_050X
B3:008998         ?C0027?ZW_PHY_AES_050X:
B3:008998 12E6CB            LCALL    ?L?COM0465
B3:00899B 75FF01            MOV      SFRPAGE,#01H
;---- Variable 'i' assigned to Register 'R6' ----
B3:00899E 7E10              MOV      R6,#010H
B3:0089A0         ?C0030?ZW_PHY_AES_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 862


B3:0089A0 903EC6            MOV      DPTR,#bInput
B3:0089A3 122589            LCALL    ?C?PLDXDATA
B3:0089A6 1E                DEC      R6
B3:0089A7 31F2              ACALL    ?L?COM00E3
B3:0089A9 F593              MOV      AESDATA,A
B3:0089AB EE                MOV      A,R6
B3:0089AC 70F2              JNZ      ?C0030?ZW_PHY_AES_050X
B3:0089AE 7E10              MOV      R6,#010H
B3:0089B0         ?C0033?ZW_PHY_AES_050X:
B3:0089B0 903EC3            MOV      DPTR,#bKey
B3:0089B3 122589            LCALL    ?C?PLDXDATA
B3:0089B6 1E                DEC      R6
B3:0089B7 31F2              ACALL    ?L?COM00E3
B3:0089B9 F594              MOV      AESKEY,A
B3:0089BB EE                MOV      A,R6
B3:0089BC 70F2              JNZ      ?C0033?ZW_PHY_AES_050X
B3:0089BE 7F01              MOV      R7,#01H
B3:0089C0 12E6F0            LCALL    _ZW_AES_enable
B3:0089C3         ?C0034?ZW_PHY_AES_050X:
B3:0089C3 12E731            LCALL    ZW_AES_active_get
B3:0089C6 EF                MOV      A,R7
B3:0089C7 70FA              JNZ      ?C0034?ZW_PHY_AES_050X
B3:0089C9         ?C0035?ZW_PHY_AES_050X:
B3:0089C9 7E10              MOV      R6,#010H
B3:0089CB         ?C0038?ZW_PHY_AES_050X:
B3:0089CB 903EC9            MOV      DPTR,#bOutput
B3:0089CE 122589            LCALL    ?C?PLDXDATA
B3:0089D1 1E                DEC      R6
B3:0089D2 8E82              MOV      DPL,R6
B3:0089D4 758300            MOV      DPH,#00H
B3:0089D7 E593              MOV      A,AESDATA
B3:0089D9 122084            LCALL    ?C?CSTOPTR
B3:0089DC EE                MOV      A,R6
B3:0089DD 70EC              JNZ      ?C0038?ZW_PHY_AES_050X
B3:0089DF 22                RET      
----- FUNCTION _ZW_AES_ecb (END) -------


----- FUNCTION ?L?COM04F9 (BEGIN) -----
B3:0089E0 90359F            MOV      DPTR,#s
B3:0089E3 122589            LCALL    ?C?PLDXDATA
----- FUNCTION _free_rx_session (BEGIN) -----
;---- Variable 's' assigned to Register 'R1/R2/R3' ----
B3:0089E6 12851B            LCALL    ?L?COM00FF
B3:0089E9 FA                MOV      R2,A
B3:0089EA 7403              MOV      A,#03H
B3:0089EC 022072            LJMP     ?C?CSTPTR
----- FUNCTION _free_rx_session (END) -------


----- FUNCTION ?L?COM00E2 (BEGIN) -----
B3:0089EF 122589            LCALL    ?C?PLDXDATA
B3:0089F2         ?L?COM00E3:
B3:0089F2 8E82              MOV      DPL,R6
B3:0089F4         ?L?COM00E4:
B3:0089F4 758300            MOV      DPH,#00H
B3:0089F7 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM00E2 (END) -------


----- FUNCTION _ZW_UART_send_buf (BEGIN) -----
B3:0089FA 903FAC            MOV      DPTR,#z
B3:0089FD 12E374            LCALL    ?L?COM060C
B3:008A00 6401              XRL      A,#01H
B3:008A02 7035              JNZ      ?C0020?ZW_UART_SUPPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 863


B3:008A04 903FAC            MOV      DPTR,#z
B3:008A07 122589            LCALL    ?C?PLDXDATA
B3:008A0A 7140              ACALL    ?L?COM060B
B3:008A0C 903FB3            MOV      DPTR,#i
B3:008A0F F0                MOVX     @DPTR,A
B3:008A10         ?C0021?ZW_UART_SUPPORT:
B3:008A10 51FA              ACALL    ?L?COM027A
B3:008A12 501F              JNC      ?C0022?ZW_UART_SUPPORT
B3:008A14 903FAF            MOV      DPTR,#b
B3:008A17 31EF              ACALL    ?L?COM00E2
B3:008A19 FF                MOV      R7,A
B3:008A1A 719A              ACALL    _ZW_UART0_tx_send_hex
B3:008A1C 516E              ACALL    ?L?COM0468
B3:008A1E FF                MOV      R7,A
B3:008A1F BF0F04            CJNE     R7,#0FH,?C0024?ZW_UART_SUPPORT
B3:008A22 5175              ACALL    ZW_UART0_tx_send_nl
B3:008A24 8005              SJMP     ?C0023?ZW_UART_SUPPORT
B3:008A26         ?C0024?ZW_UART_SUPPORT:
B3:008A26 7F20              MOV      R7,#020H
B3:008A28 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008A2B         ?C0023?ZW_UART_SUPPORT:
B3:008A2B 903FB3            MOV      DPTR,#i
B3:008A2E E0                MOVX     A,@DPTR
B3:008A2F 04                INC      A
B3:008A30 F0                MOVX     @DPTR,A
B3:008A31 80DD              SJMP     ?C0021?ZW_UART_SUPPORT
B3:008A33         ?C0022?ZW_UART_SUPPORT:
B3:008A33 516E              ACALL    ?L?COM0468
B3:008A35 6036              JZ       ?C0034?ZW_UART_SUPPORT
B3:008A37 803C              SJMP     ZW_UART0_tx_send_nl
B3:008A39         ?C0020?ZW_UART_SUPPORT:
B3:008A39 903FAC            MOV      DPTR,#z
B3:008A3C 122589            LCALL    ?C?PLDXDATA
B3:008A3F 51D7              ACALL    ?L?COM060A
B3:008A41 903FB3            MOV      DPTR,#i
B3:008A44 F0                MOVX     @DPTR,A
B3:008A45         ?C0028?ZW_UART_SUPPORT:
B3:008A45 51FA              ACALL    ?L?COM027A
B3:008A47 501E              JNC      ?C0029?ZW_UART_SUPPORT
B3:008A49 903FAF            MOV      DPTR,#b
B3:008A4C 31EF              ACALL    ?L?COM00E2
B3:008A4E FF                MOV      R7,A
B3:008A4F 518D              ACALL    _ZW_UART1_tx_send_hex
B3:008A51 516E              ACALL    ?L?COM0468
B3:008A53 FF                MOV      R7,A
B3:008A54 BF0F04            CJNE     R7,#0FH,?C0031?ZW_UART_SUPPORT
B3:008A57 517F              ACALL    ZW_UART1_tx_send_nl
B3:008A59 8004              SJMP     ?C0030?ZW_UART_SUPPORT
B3:008A5B         ?C0031?ZW_UART_SUPPORT:
B3:008A5B 7F20              MOV      R7,#020H
B3:008A5D 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008A5F         ?C0030?ZW_UART_SUPPORT:
B3:008A5F 903FB3            MOV      DPTR,#i
B3:008A62 E0                MOVX     A,@DPTR
B3:008A63 04                INC      A
B3:008A64 F0                MOVX     @DPTR,A
B3:008A65 80DE              SJMP     ?C0028?ZW_UART_SUPPORT
B3:008A67         ?C0029?ZW_UART_SUPPORT:
B3:008A67 516E              ACALL    ?L?COM0468
B3:008A69 6002              JZ       ?C0034?ZW_UART_SUPPORT
B3:008A6B 517F              ACALL    ZW_UART1_tx_send_nl
B3:008A6D         ?C0034?ZW_UART_SUPPORT:
B3:008A6D 22                RET      
----- FUNCTION _ZW_UART_send_buf (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 864



----- FUNCTION ?L?COM0468 (BEGIN) -----
B3:008A6E 903FB3            MOV      DPTR,#i
B3:008A71 E0                MOVX     A,@DPTR
B3:008A72 540F              ANL      A,#0FH
B3:008A74 22                RET      
----- FUNCTION ?L?COM0468 (END) -------


----- FUNCTION ZW_UART0_tx_send_nl (BEGIN) -----
B3:008A75 7F0D              MOV      R7,#0DH
B3:008A77 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008A7A 7F0A              MOV      R7,#0AH
B3:008A7C 026C20            LJMP     _ZW_UART0_tx_send_byte
----- FUNCTION ZW_UART0_tx_send_nl (END) -------


----- FUNCTION ZW_UART1_tx_send_nl (BEGIN) -----
B3:008A7F 7F0D              MOV      R7,#0DH
B3:008A81 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008A83 7F0A              MOV      R7,#0AH
B3:;----                  JMP      _ZW_UART1_tx_send_byte
----- FUNCTION ZW_UART1_tx_send_nl (END) -------


----- FUNCTION _ZW_UART1_tx_send_byte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
B3:008A85         ?C0015?ZW_PHY_UART1_050X:
B3:008A85 E5ED              MOV      A,UARTSTAT
B3:008A87 20E4FB            JB       ACC.4,?C0015?ZW_PHY_UART1_050X
B3:008A8A         ?C0016?ZW_PHY_UART1_050X:
B3:008A8A 8FEE              MOV      UART1BUF,R7
B3:008A8C 22                RET      
----- FUNCTION _ZW_UART1_tx_send_byte (END) -------


----- FUNCTION _ZW_UART1_tx_send_hex (BEGIN) -----
B3:008A8D 904391            MOV      DPTR,#bData
B3:008A90 715D              ACALL    ?L?COM034E
B3:008A92 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008A94 904391            MOV      DPTR,#bData
B3:008A97 E0                MOVX     A,@DPTR
B3:008A98 FF                MOV      R7,A
B3:008A99 7164              ACALL    _nibble2hex
B3:008A9B 80E8              SJMP     _ZW_UART1_tx_send_byte
----- FUNCTION _ZW_UART1_tx_send_hex (END) -------


----- FUNCTION _ZW_UART1_send_buf (BEGIN) -----
;---- Variable 'z' assigned to Register 'R1/R2/R3' ----
B3:008A9D 51D7              ACALL    ?L?COM060A
B3:008A9F 903FC3            MOV      DPTR,#i
B3:008AA2 F0                MOVX     @DPTR,A
B3:008AA3         ?C0007?ZW_UART1_SUPPORT:
B3:008AA3 903FC2            MOV      DPTR,#len
B3:008AA6 51FD              ACALL    ?L?COM027B
B3:008AA8 5022              JNC      ?C0008?ZW_UART1_SUPPORT
B3:008AAA 903FBF            MOV      DPTR,#b
B3:008AAD 31EF              ACALL    ?L?COM00E2
B3:008AAF FF                MOV      R7,A
B3:008AB0 518D              ACALL    _ZW_UART1_tx_send_hex
B3:008AB2 903FC3            MOV      DPTR,#i
B3:008AB5 E0                MOVX     A,@DPTR
B3:008AB6 540F              ANL      A,#0FH
B3:008AB8 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 865


B3:008AB9 BF0F04            CJNE     R7,#0FH,?C0010?ZW_UART1_SUPPORT
B3:008ABC 517F              ACALL    ZW_UART1_tx_send_nl
B3:008ABE 8004              SJMP     ?C0009?ZW_UART1_SUPPORT
B3:008AC0         ?C0010?ZW_UART1_SUPPORT:
B3:008AC0 7F20              MOV      R7,#020H
B3:008AC2 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008AC4         ?C0009?ZW_UART1_SUPPORT:
B3:008AC4 903FC3            MOV      DPTR,#i
B3:008AC7 E0                MOVX     A,@DPTR
B3:008AC8 04                INC      A
B3:008AC9 F0                MOVX     @DPTR,A
B3:008ACA 80D7              SJMP     ?C0007?ZW_UART1_SUPPORT
B3:008ACC         ?C0008?ZW_UART1_SUPPORT:
B3:008ACC 903FC3            MOV      DPTR,#i
B3:008ACF E0                MOVX     A,@DPTR
B3:008AD0 540F              ANL      A,#0FH
B3:008AD2 6002              JZ       ?C0013?ZW_UART1_SUPPORT
B3:008AD4 517F              ACALL    ZW_UART1_tx_send_nl
B3:008AD6         ?C0013?ZW_UART1_SUPPORT:
B3:008AD6 22                RET      
----- FUNCTION _ZW_UART1_send_buf (END) -------


----- FUNCTION ?L?COM060A (BEGIN) -----
B3:008AD7 51DD              ACALL    _ZW_UART1_tx_send_str
B3:008AD9 517F              ACALL    ZW_UART1_tx_send_nl
B3:008ADB E4                CLR      A
B3:008ADC 22                RET      
----- FUNCTION ?L?COM060A (END) -------


----- FUNCTION _ZW_UART1_tx_send_str (BEGIN) -----
B3:008ADD 9042E8            MOV      DPTR,#str
B3:008AE0 1225A9            LCALL    ?C?PSTXDATA
B3:008AE3         ?C0003?ZW_UART1_SUPPORT:
B3:008AE3 9042E8            MOV      DPTR,#str
B3:008AE6 122589            LCALL    ?C?PLDXDATA
B3:008AE9 121FB3            LCALL    ?C?CLDPTR
B3:008AEC FF                MOV      R7,A
B3:008AED 600A              JZ       ?C0005?ZW_UART1_SUPPORT
B3:008AEF 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008AF1 9042E9            MOV      DPTR,#str+01H
B3:008AF4 123F7F            LCALL    ?L?COM0081
B3:008AF7 80EA              SJMP     ?C0003?ZW_UART1_SUPPORT
B3:008AF9         ?C0005?ZW_UART1_SUPPORT:
B3:008AF9 22                RET      
----- FUNCTION _ZW_UART1_tx_send_str (END) -------


----- FUNCTION ?L?COM027A (BEGIN) -----
B3:008AFA 903FB2            MOV      DPTR,#len
B3:008AFD         ?L?COM027B:
B3:008AFD E0                MOVX     A,@DPTR
B3:008AFE FF                MOV      R7,A
B3:008AFF A3                INC      DPTR
B3:008B00 E0                MOVX     A,@DPTR
B3:008B01 FE                MOV      R6,A
B3:008B02 C3                CLR      C
B3:008B03 9F                SUBB     A,R7
B3:008B04 22                RET      
----- FUNCTION ?L?COM027A (END) -------


----- FUNCTION _ZW_UART0_send_buf (BEGIN) -----
;---- Variable 'z' assigned to Register 'R1/R2/R3' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 866


B3:008B05 7140              ACALL    ?L?COM060B
B3:008B07 903FBB            MOV      DPTR,#i
B3:008B0A F0                MOVX     @DPTR,A
B3:008B0B         ?C0008?ZW_UART0_SUPPORT:
B3:008B0B 903FBA            MOV      DPTR,#len
B3:008B0E 51FD              ACALL    ?L?COM027B
B3:008B10 5023              JNC      ?C0009?ZW_UART0_SUPPORT
B3:008B12 903FB7            MOV      DPTR,#b
B3:008B15 31EF              ACALL    ?L?COM00E2
B3:008B17 FF                MOV      R7,A
B3:008B18 719A              ACALL    _ZW_UART0_tx_send_hex
B3:008B1A 903FBB            MOV      DPTR,#i
B3:008B1D E0                MOVX     A,@DPTR
B3:008B1E 540F              ANL      A,#0FH
B3:008B20 FF                MOV      R7,A
B3:008B21 BF0F04            CJNE     R7,#0FH,?C0011?ZW_UART0_SUPPORT
B3:008B24 5175              ACALL    ZW_UART0_tx_send_nl
B3:008B26 8005              SJMP     ?C0010?ZW_UART0_SUPPORT
B3:008B28         ?C0011?ZW_UART0_SUPPORT:
B3:008B28 7F20              MOV      R7,#020H
B3:008B2A 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008B2D         ?C0010?ZW_UART0_SUPPORT:
B3:008B2D 903FBB            MOV      DPTR,#i
B3:008B30 E0                MOVX     A,@DPTR
B3:008B31 04                INC      A
B3:008B32 F0                MOVX     @DPTR,A
B3:008B33 80D6              SJMP     ?C0008?ZW_UART0_SUPPORT
B3:008B35         ?C0009?ZW_UART0_SUPPORT:
B3:008B35 903FBB            MOV      DPTR,#i
B3:008B38 E0                MOVX     A,@DPTR
B3:008B39 540F              ANL      A,#0FH
B3:008B3B 6002              JZ       ?C0014?ZW_UART0_SUPPORT
B3:008B3D 5175              ACALL    ZW_UART0_tx_send_nl
B3:008B3F         ?C0014?ZW_UART0_SUPPORT:
B3:008B3F 22                RET      
----- FUNCTION _ZW_UART0_send_buf (END) -------


----- FUNCTION ?L?COM060B (BEGIN) -----
B3:008B40 71D2              ACALL    _ZW_UART0_tx_send_str
B3:008B42 5175              ACALL    ZW_UART0_tx_send_nl
B3:008B44 E4                CLR      A
B3:008B45 22                RET      
----- FUNCTION ?L?COM060B (END) -------


----- FUNCTION ZW_UART_tx_send_nl (BEGIN) -----
B3:008B46 901229            MOV      DPTR,#bNVRUartPinSwap
B3:008B49 E0                MOVX     A,@DPTR
B3:008B4A 7F0D              MOV      R7,#0DH
B3:008B4C B40108            CJNE     A,#01H,?C0017?ZW_UART_SUPPORT
B3:008B4F 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008B52 7F0A              MOV      R7,#0AH
B3:008B54 026C20            LJMP     _ZW_UART0_tx_send_byte
B3:008B57         ?C0017?ZW_UART_SUPPORT:
B3:008B57 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008B59 7F0A              MOV      R7,#0AH
B3:008B5B 4185              AJMP     _ZW_UART1_tx_send_byte
----- FUNCTION ZW_UART_tx_send_nl (END) -------


----- FUNCTION ?L?COM034E (BEGIN) -----
B3:008B5D EF                MOV      A,R7
B3:008B5E F0                MOVX     @DPTR,A
B3:008B5F         ?L?COM034F:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 867


B3:008B5F E0                MOVX     A,@DPTR
B3:008B60 C4                SWAP     A
B3:008B61 540F              ANL      A,#0FH
B3:008B63 FF                MOV      R7,A
----- FUNCTION _nibble2hex (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
B3:008B64 EF                MOV      A,R7
B3:008B65 540F              ANL      A,#0FH
B3:008B67 FF                MOV      R7,A
;---- Variable 'nibData' assigned to Register 'R7' ----
B3:008B68 D3                SETB     C
B3:008B69 9409              SUBB     A,#09H
B3:008B6B EF                MOV      A,R7
B3:008B6C 5004              JNC      ?C0001?ZW_CONVERT
B3:008B6E 2430              ADD      A,#030H
B3:008B70 FF                MOV      R7,A
B3:008B71 22                RET      
B3:008B72         ?C0001?ZW_CONVERT:
B3:008B72 2437              ADD      A,#037H
B3:008B74 FF                MOV      R7,A
B3:008B75 22                RET      
----- FUNCTION _nibble2hex (END) -------


----- FUNCTION _ZW_UART_tx_send_hex (BEGIN) -----
B3:008B76 90438E            MOV      DPTR,#bData
B3:008B79 9181              ACALL    ?L?COM0544
B3:008B7B 90438E            MOV      DPTR,#bData
B3:008B7E B4010A            CJNE     A,#01H,?C0004?ZW_UART_SUPPORT
B3:008B81 715F              ACALL    ?L?COM034F
B3:008B83 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008B86 7193              ACALL    ?L?COM05A6
B3:008B88 026C20            LJMP     _ZW_UART0_tx_send_byte
B3:008B8B         ?C0004?ZW_UART_SUPPORT:
B3:008B8B 715F              ACALL    ?L?COM034F
B3:008B8D 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008B8F 7193              ACALL    ?L?COM05A6
B3:008B91 4185              AJMP     _ZW_UART1_tx_send_byte
----- FUNCTION _ZW_UART_tx_send_hex (END) -------


----- FUNCTION ?L?COM05A6 (BEGIN) -----
B3:008B93 90438E            MOV      DPTR,#bData
B3:008B96 E0                MOVX     A,@DPTR
B3:008B97 FF                MOV      R7,A
B3:008B98 80CA              SJMP     _nibble2hex
----- FUNCTION ?L?COM05A6 (END) -------


----- FUNCTION _ZW_UART0_tx_send_hex (BEGIN) -----
B3:008B9A 904390            MOV      DPTR,#bData
B3:008B9D 715D              ACALL    ?L?COM034E
B3:008B9F 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008BA2 904390            MOV      DPTR,#bData
B3:008BA5 E0                MOVX     A,@DPTR
B3:008BA6 FF                MOV      R7,A
B3:008BA7 7164              ACALL    _nibble2hex
B3:008BA9 026C20            LJMP     _ZW_UART0_tx_send_byte
----- FUNCTION _ZW_UART0_tx_send_hex (END) -------


----- FUNCTION _ZW_UART_tx_send_w_num (BEGIN) -----
B3:008BAC 904356            MOV      DPTR,#bData
B3:008BAF EE                MOV      A,R6
B3:008BB0 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 868


B3:008BB1 A3                INC      DPTR
B3:008BB2 9181              ACALL    ?L?COM0544
B3:008BB4 904356            MOV      DPTR,#bData
B3:008BB7 B4010C            CJNE     A,#01H,?C0007?ZW_UART_SUPPORT
B3:008BBA E0                MOVX     A,@DPTR
B3:008BBB FF                MOV      R7,A
B3:008BBC 719A              ACALL    _ZW_UART0_tx_send_hex
B3:008BBE 904356            MOV      DPTR,#bData
B3:008BC1 A3                INC      DPTR
B3:008BC2 E0                MOVX     A,@DPTR
B3:008BC3 FF                MOV      R7,A
B3:008BC4 80D4              SJMP     _ZW_UART0_tx_send_hex
B3:008BC6         ?C0007?ZW_UART_SUPPORT:
B3:008BC6 E0                MOVX     A,@DPTR
B3:008BC7 FF                MOV      R7,A
B3:008BC8 518D              ACALL    _ZW_UART1_tx_send_hex
B3:008BCA 904356            MOV      DPTR,#bData
B3:008BCD A3                INC      DPTR
B3:008BCE E0                MOVX     A,@DPTR
B3:008BCF FF                MOV      R7,A
B3:008BD0 418D              AJMP     _ZW_UART1_tx_send_hex
----- FUNCTION _ZW_UART_tx_send_w_num (END) -------


----- FUNCTION _ZW_UART0_tx_send_str (BEGIN) -----
B3:008BD2 9042E5            MOV      DPTR,#str
B3:008BD5 1225A9            LCALL    ?C?PSTXDATA
B3:008BD8         ?C0004?ZW_UART0_SUPPORT:
B3:008BD8 9042E5            MOV      DPTR,#str
B3:008BDB 122589            LCALL    ?C?PLDXDATA
B3:008BDE 121FB3            LCALL    ?C?CLDPTR
B3:008BE1 FF                MOV      R7,A
B3:008BE2 600B              JZ       ?C0006?ZW_UART0_SUPPORT
B3:008BE4 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008BE7 9042E6            MOV      DPTR,#str+01H
B3:008BEA 123F7F            LCALL    ?L?COM0081
B3:008BED 80E9              SJMP     ?C0004?ZW_UART0_SUPPORT
B3:008BEF         ?C0006?ZW_UART0_SUPPORT:
B3:008BEF 22                RET      
----- FUNCTION _ZW_UART0_tx_send_str (END) -------


----- FUNCTION ?L?COM02EF (BEGIN) -----
B3:008BF0 75FF02            MOV      SFRPAGE,#02H
B3:008BF3 53857F            ANL      SLTCON1,#07FH
B3:008BF6 75FF02            MOV      SFRPAGE,#02H
B3:008BF9 438510            ORL      SLTCON1,#010H
B3:008BFC 22                RET      
----- FUNCTION ?L?COM02EF (END) -------


----- FUNCTION _num2UniAsciiHex (BEGIN) -----
B3:008BFD 904075            MOV      DPTR,#outBuf
B3:008C00 1225A9            LCALL    ?C?PSTXDATA
B3:008C03 90407B            MOV      DPTR,#bData
B3:008C06 E0                MOVX     A,@DPTR
B3:008C07 C4                SWAP     A
B3:008C08 540F              ANL      A,#0FH
B3:008C0A 911A              ACALL    ?L?COM00B4
B3:008C0C E4                CLR      A
B3:008C0D 122084            LCALL    ?C?CSTOPTR
B3:008C10 90407B            MOV      DPTR,#bData
B3:008C13 E0                MOVX     A,@DPTR
B3:008C14 911A              ACALL    ?L?COM00B4
B3:008C16 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 869


B3:008C17 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _num2UniAsciiHex (END) -------


----- FUNCTION ?L?COM00B4 (BEGIN) -----
B3:008C1A FF                MOV      R7,A
B3:008C1B 7164              ACALL    _nibble2hex
B3:008C1D 904078            MOV      DPTR,#pPos
B3:008C20 122589            LCALL    ?C?PLDXDATA
B3:008C23 7401              MOV      A,#01H
B3:008C25 121FCC            LCALL    ?C?CLDIPTR
B3:008C28 FE                MOV      R6,A
B3:008C29 904075            MOV      DPTR,#outBuf
B3:008C2C 122589            LCALL    ?C?PLDXDATA
B3:008C2F 8E82              MOV      DPL,R6
B3:008C31 758300            MOV      DPH,#00H
B3:008C34 EF                MOV      A,R7
B3:008C35 122084            LCALL    ?C?CSTOPTR
B3:008C38 904078            MOV      DPTR,#pPos
B3:008C3B 122589            LCALL    ?C?PLDXDATA
B3:008C3E 7401              MOV      A,#01H
B3:008C40 121FCC            LCALL    ?C?CLDIPTR
B3:008C43 FF                MOV      R7,A
B3:008C44 904075            MOV      DPTR,#outBuf
B3:008C47         ?L?COM00B5:
B3:008C47 122589            LCALL    ?C?PLDXDATA
B3:008C4A 8F82              MOV      DPL,R7
B3:008C4C 758300            MOV      DPH,#00H
B3:008C4F 22                RET      
----- FUNCTION ?L?COM00B4 (END) -------


----- FUNCTION _ZW_UART_tx_send_dec (BEGIN) -----
B3:008C50 90438D            MOV      DPTR,#bData
B3:008C53 9181              ACALL    ?L?COM0544
B3:008C55 90438D            MOV      DPTR,#bData
B3:008C58 B4010A            CJNE     A,#01H,?C0001?ZW_UART_SUPPORT
B3:008C5B 916D              ACALL    ?L?COM03F2
B3:008C5D 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008C60 9175              ACALL    ?L?COM0358
B3:008C62 026C20            LJMP     _ZW_UART0_tx_send_byte
B3:008C65         ?C0001?ZW_UART_SUPPORT:
B3:008C65 916D              ACALL    ?L?COM03F2
B3:008C67 5185              ACALL    _ZW_UART1_tx_send_byte
B3:008C69 9175              ACALL    ?L?COM0358
B3:008C6B 4185              AJMP     _ZW_UART1_tx_send_byte
----- FUNCTION _ZW_UART_tx_send_dec (END) -------


----- FUNCTION ?L?COM03F2 (BEGIN) -----
B3:008C6D E0                MOVX     A,@DPTR
B3:008C6E         ?L?COM03F3:
B3:008C6E 75F00A            MOV      B,#0AH
B3:008C71 84                DIV      AB
B3:008C72 FF                MOV      R7,A
B3:008C73 6164              AJMP     _nibble2hex
----- FUNCTION ?L?COM03F2 (END) -------


----- FUNCTION ?L?COM0358 (BEGIN) -----
B3:008C75 90438D            MOV      DPTR,#bData
B3:008C78         ?L?COM0359:
B3:008C78 E0                MOVX     A,@DPTR
B3:008C79 75F00A            MOV      B,#0AH
B3:008C7C 84                DIV      AB
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 870


B3:008C7D AFF0              MOV      R7,B
B3:008C7F 6164              AJMP     _nibble2hex
----- FUNCTION ?L?COM0358 (END) -------


----- FUNCTION ?L?COM0544 (BEGIN) -----
B3:008C81 EF                MOV      A,R7
B3:008C82 F0                MOVX     @DPTR,A
B3:008C83 901229            MOV      DPTR,#bNVRUartPinSwap
B3:008C86 E0                MOVX     A,@DPTR
B3:008C87 22                RET      
----- FUNCTION ?L?COM0544 (END) -------


----- FUNCTION _ZW_UART0_tx_send_dec (BEGIN) -----
B3:008C88 90438F            MOV      DPTR,#bData
B3:008C8B EF                MOV      A,R7
B3:008C8C F0                MOVX     @DPTR,A
B3:008C8D 916E              ACALL    ?L?COM03F3
B3:008C8F 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:008C92 90438F            MOV      DPTR,#bData
B3:008C95 9178              ACALL    ?L?COM0359
B3:008C97 026C20            LJMP     _ZW_UART0_tx_send_byte
----- FUNCTION _ZW_UART0_tx_send_dec (END) -------


----- FUNCTION _encrypt_msg (BEGIN) -----
B3:008C9A 9035AB            MOV      DPTR,#pass2
B3:008C9D EF                MOV      A,R7
B3:008C9E F0                MOVX     @DPTR,A
;---- Variable 'maxlen' assigned to Register 'R7' ----
B3:008C9F 7F2E              MOV      R7,#02EH
B3:008CA1 9025A6            MOV      DPTR,#the_tx_session+09H
B3:008CA4 E0                MOVX     A,@DPTR
B3:008CA5 FE                MOV      R6,A
B3:008CA6 9035D4            MOV      DPTR,#len
B3:008CA9 F0                MOVX     @DPTR,A
B3:008CAA E4                CLR      A
B3:008CAB A3                INC      DPTR
B3:008CAC F0                MOVX     @DPTR,A
B3:008CAD EE                MOV      A,R6
B3:008CAE 2414              ADD      A,#014H
B3:008CB0 FD                MOV      R5,A
B3:008CB1 E4                CLR      A
B3:008CB2 33                RLC      A
B3:008CB3 FC                MOV      R4,A
B3:008CB4 D3                SETB     C
B3:008CB5 ED                MOV      A,R5
B3:008CB6 942E              SUBB     A,#02EH
B3:008CB8 7480              MOV      A,#080H
B3:008CBA F8                MOV      R0,A
B3:008CBB 6C                XRL      A,R4
B3:008CBC 98                SUBB     A,R0
B3:008CBD 400B              JC       ?C0049?ZW_SECURITY_SCHEME0
B3:008CBF EF                MOV      A,R7
B3:008CC0 24EC              ADD      A,#0ECH
B3:008CC2 9035D4            MOV      DPTR,#len
B3:008CC5 F0                MOVX     @DPTR,A
B3:008CC6 A3                INC      DPTR
B3:008CC7 7401              MOV      A,#01H
B3:008CC9 F0                MOVX     @DPTR,A
B3:008CCA         ?C0049?ZW_SECURITY_SCHEME0:
B3:008CCA 7B01              MOV      R3,#01H
B3:008CCC 7A35              MOV      R2,#HIGH iv
B3:008CCE 79AC              MOV      R1,#LOW iv
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 871


B3:008CD0 12DA1A            LCALL    _aes_random8
B3:008CD3 12F002            LCALL    ?L?COM0582
B3:008CD6 7A35              MOV      R2,#HIGH tmpnonce
B3:008CD8 79CC              MOV      R1,#LOW tmpnonce
B3:008CDA 12ED36            LCALL    ?L?COM014F
B3:008CDD E4                CLR      A
B3:008CDE 903F92            MOV      DPTR,#?_get_nonce?BYTE+06H
B3:008CE1 F0                MOVX     @DPTR,A
B3:008CE2 9035AC            MOV      DPTR,#iv
B3:008CE5 12B533            LCALL    ?L?COM054B
B3:008CE8 70E0              JNZ      ?C0049?ZW_SECURITY_SCHEME0
B3:008CEA 90259D            MOV      DPTR,#the_tx_session
B3:008CED E0                MOVX     A,@DPTR
B3:008CEE FF                MOV      R7,A
B3:008CEF A3                INC      DPTR
B3:008CF0 7A35              MOV      R2,#HIGH iv+08H
B3:008CF2 79B4              MOV      R1,#LOW iv+08H
B3:008CF4 12ED36            LCALL    ?L?COM014F
B3:008CF7 903F92            MOV      DPTR,#?_get_nonce?BYTE+06H
B3:008CFA 7401              MOV      A,#01H
B3:008CFC F0                MOVX     @DPTR,A
B3:008CFD 1B                DEC      R3
B3:008CFE 12B539            LCALL    _get_nonce
B3:008D01 EF                MOV      A,R7
B3:008D02 7002              JNZ      ?C0050?ZW_SECURITY_SCHEME0
B3:008D04 FF                MOV      R7,A
B3:008D05 22                RET      
B3:008D06         ?C0050?ZW_SECURITY_SCHEME0:
B3:008D06 90259D            MOV      DPTR,#the_tx_session
B3:008D09 E0                MOVX     A,@DPTR
B3:008D0A FF                MOV      R7,A
B3:008D0B A3                INC      DPTR
B3:008D0C E0                MOVX     A,@DPTR
B3:008D0D FD                MOV      R5,A
B3:008D0E 1284B9            LCALL    _nonce_clear
B3:008D11         ?C0052?ZW_SECURITY_SCHEME0:
B3:008D11 12F002            LCALL    ?L?COM0582
B3:008D14 E0                MOVX     A,@DPTR
B3:008D15 FD                MOV      R5,A
B3:008D16 7B01              MOV      R3,#01H
B3:008D18 7A35              MOV      R2,#HIGH iv
B3:008D1A 79AC              MOV      R1,#LOW iv
B3:008D1C 12DB97            LCALL    ?L?COM054D
B3:008D1F 12DA3B            LCALL    _register_nonce
B3:008D22 7B01              MOV      R3,#01H
B3:008D24 7A25              MOV      R2,#HIGH the_tx_session+025H
B3:008D26 79C2              MOV      R1,#LOW the_tx_session+025H
B3:008D28 9035D6            MOV      DPTR,#enc_data
B3:008D2B 1225A9            LCALL    ?C?PSTXDATA
B3:008D2E 7A25              MOV      R2,#HIGH the_tx_session+021H
B3:008D30 79BE              MOV      R1,#LOW the_tx_session+021H
B3:008D32 9035D9            MOV      DPTR,#auth
B3:008D35 1225A9            LCALL    ?C?PSTXDATA
B3:008D38 9035AB            MOV      DPTR,#pass2
B3:008D3B E0                MOVX     A,@DPTR
B3:008D3C 600A              JZ       ?C0053?ZW_SECURITY_SCHEME0
B3:008D3E 9025E6            MOV      DPTR,#the_tx_session+049H
B3:008D41 E0                MOVX     A,@DPTR
B3:008D42 540F              ANL      A,#0FH
B3:008D44 4430              ORL      A,#030H
B3:008D46 800E              SJMP     ?C0174?ZW_SECURITY_SCHEME0
B3:008D48         ?C0053?ZW_SECURITY_SCHEME0:
B3:008D48 9035D5            MOV      DPTR,#more_to_send
B3:008D4B E0                MOVX     A,@DPTR
B3:008D4C 600F              JZ       ?C0055?ZW_SECURITY_SCHEME0
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 872


B3:008D4E 9025E6            MOV      DPTR,#the_tx_session+049H
B3:008D51 E0                MOVX     A,@DPTR
B3:008D52 540F              ANL      A,#0FH
B3:008D54 4410              ORL      A,#010H
B3:008D56         
B3:008D56 FF                MOV      R7,A
B3:008D57 12EFF3            LCALL    ?L?COM04F8
B3:008D5A EF                MOV      A,R7
B3:008D5B 8004              SJMP     ?C0175?ZW_SECURITY_SCHEME0
B3:008D5D         ?C0055?ZW_SECURITY_SCHEME0:
B3:008D5D 12EFF3            LCALL    ?L?COM04F8
B3:008D60 E4                CLR      A
B3:008D61         
B3:008D61 122072            LCALL    ?C?CSTPTR
B3:008D64         ?C0054?ZW_SECURITY_SCHEME0:
B3:008D64 9035D4            MOV      DPTR,#len
B3:008D67 E0                MOVX     A,@DPTR
B3:008D68 9035D6            MOV      DPTR,#enc_data
B3:008D6B 12EEE5            LCALL    ?L?COM007C
B3:008D6E C003              PUSH     AR3
B3:008D70 C002              PUSH     AR2
B3:008D72 C001              PUSH     AR1
B3:008D74 9025A3            MOV      DPTR,#the_tx_session+06H
B3:008D77 122589            LCALL    ?C?PLDXDATA
B3:008D7A 126149            LCALL    ?L?COM0047
B3:008D7D D001              POP      AR1
B3:008D7F D002              POP      AR2
B3:008D81 D003              POP      AR3
B3:008D83 1280A2            LCALL    ___ZW_memcpy
B3:008D86 12EF44            LCALL    ?L?COM026E
B3:008D89 7A24              MOV      R2,#HIGH enckey
B3:008D8B 7963              MOV      R1,#LOW enckey
B3:008D8D 1284DD            LCALL    _aes_set_key
B3:008D90 12EFF3            LCALL    ?L?COM04F8
B3:008D93 9035D4            MOV      DPTR,#len
B3:008D96 E0                MOVX     A,@DPTR
B3:008D97 04                INC      A
B3:008D98 FD                MOV      R5,A
B3:008D99 12D9C6            LCALL    _aes_ofb
B3:008D9C 9035D5            MOV      DPTR,#more_to_send
B3:008D9F E0                MOVX     A,@DPTR
B3:008DA0 7F81              MOV      R7,#081H
B3:008DA2 6002              JZ       ?C0057?ZW_SECURITY_SCHEME0
B3:008DA4 7FC1              MOV      R7,#0C1H
B3:008DA6         ?C0057?ZW_SECURITY_SCHEME0:
B3:008DA6         ?C0058?ZW_SECURITY_SCHEME0:
B3:008DA6 9035D9            MOV      DPTR,#auth
B3:008DA9 123F95            LCALL    ?L?COM00C0
B3:008DAC 90259E            MOV      DPTR,#the_tx_session+01H
B3:008DAF E0                MOVX     A,@DPTR
B3:008DB0 FF                MOV      R7,A
B3:008DB1 9035D9            MOV      DPTR,#auth
B3:008DB4 12EEE6            LCALL    ?L?COM007D
B3:008DB7 EF                MOV      A,R7
B3:008DB8 122072            LCALL    ?C?CSTPTR
B3:008DBB 90259D            MOV      DPTR,#the_tx_session
B3:008DBE E0                MOVX     A,@DPTR
B3:008DBF 9035D9            MOV      DPTR,#auth
B3:008DC2 12847C            LCALL    ?L?COM00C6
B3:008DC5 9035D4            MOV      DPTR,#len
B3:008DC8 E0                MOVX     A,@DPTR
B3:008DC9 04                INC      A
B3:008DCA FF                MOV      R7,A
B3:008DCB 9035D9            MOV      DPTR,#auth
B3:008DCE 12707E            LCALL    ?L?COM00F2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 873


B3:008DD1 128483            LCALL    ?L?COM00C8
B3:008DD4 12EF44            LCALL    ?L?COM026E
B3:008DD7 7A23              MOV      R2,#HIGH authkey
B3:008DD9 799F              MOV      R1,#LOW authkey
B3:008DDB 1284DD            LCALL    _aes_set_key
B3:008DDE 9035D4            MOV      DPTR,#len
B3:008DE1 E0                MOVX     A,@DPTR
B3:008DE2 2405              ADD      A,#05H
B3:008DE4 7A35              MOV      R2,#HIGH mac
B3:008DE6 79BC              MOV      R1,#LOW mac
B3:008DE8 12EF09            LCALL    ?L?COM01CF
B3:008DEB 9035D9            MOV      DPTR,#auth
B3:008DEE 122589            LCALL    ?C?PLDXDATA
B3:008DF1 129DB5            LCALL    _aes_cbc_mac
B3:008DF4 9025B8            MOV      DPTR,#the_tx_session+01BH
B3:008DF7 7498              MOV      A,#098H
B3:008DF9 F0                MOVX     @DPTR,A
B3:008DFA 9035D9            MOV      DPTR,#auth
B3:008DFD 122589            LCALL    ?C?PLDXDATA
B3:008E00 121FB3            LCALL    ?C?CLDPTR
B3:008E03 9025B9            MOV      DPTR,#the_tx_session+01CH
B3:008E06 F0                MOVX     @DPTR,A
B3:008E07 7B01              MOV      R3,#01H
B3:008E09 7A35              MOV      R2,#HIGH iv
B3:008E0B 79AC              MOV      R1,#LOW iv
B3:008E0D 126149            LCALL    ?L?COM0047
B3:008E10 7A25              MOV      R2,#HIGH the_tx_session+01DH
B3:008E12 79BA              MOV      R1,#LOW the_tx_session+01DH
B3:008E14 7F08              MOV      R7,#08H
B3:008E16 1280A2            LCALL    ___ZW_memcpy
B3:008E19 9035B4            MOV      DPTR,#iv+08H
B3:008E1C E0                MOVX     A,@DPTR
B3:008E1D FF                MOV      R7,A
B3:008E1E 9035D4            MOV      DPTR,#len
B3:008E21 E0                MOVX     A,@DPTR
B3:008E22 FE                MOV      R6,A
B3:008E23 24C3              ADD      A,#LOW the_tx_session+026H
B3:008E25 F582              MOV      DPL,A
B3:008E27 E4                CLR      A
B3:008E28 3425              ADDC     A,#HIGH the_tx_session+026H
B3:008E2A F583              MOV      DPH,A
B3:008E2C EF                MOV      A,R7
B3:008E2D F0                MOVX     @DPTR,A
B3:008E2E 74C4              MOV      A,#LOW the_tx_session+027H
B3:008E30 2E                ADD      A,R6
B3:008E31 F9                MOV      R1,A
B3:008E32 E4                CLR      A
B3:008E33 3425              ADDC     A,#HIGH the_tx_session+027H
B3:008E35 FA                MOV      R2,A
B3:008E36 7B01              MOV      R3,#01H
B3:008E38 C002              PUSH     AR2
B3:008E3A C001              PUSH     AR1
B3:008E3C 7A35              MOV      R2,#HIGH mac
B3:008E3E 79BC              MOV      R1,#LOW mac
B3:008E40 126149            LCALL    ?L?COM0047
B3:008E43 D001              POP      AR1
B3:008E45 D002              POP      AR2
B3:008E47 7F08              MOV      R7,#08H
B3:008E49 1280A2            LCALL    ___ZW_memcpy
B3:008E4C 9035D4            MOV      DPTR,#len
B3:008E4F E0                MOVX     A,@DPTR
B3:008E50 FF                MOV      R7,A
B3:008E51 FD                MOV      R5,A
B3:008E52 9025A4            MOV      DPTR,#the_tx_session+07H
B3:008E55 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 874


B3:008E56 8DF0              MOV      B,R5
B3:008E58 122143            LCALL    ?C?IILDX
B3:008E5B 9025A6            MOV      DPTR,#the_tx_session+09H
B3:008E5E E0                MOVX     A,@DPTR
B3:008E5F C3                CLR      C
B3:008E60 9F                SUBB     A,R7
B3:008E61 F0                MOVX     @DPTR,A
B3:008E62 9035D4            MOV      DPTR,#len
B3:008E65 E0                MOVX     A,@DPTR
B3:008E66 2414              ADD      A,#014H
B3:008E68 FF                MOV      R7,A
B3:008E69 22                RET      
----- FUNCTION _encrypt_msg (END) -------


----- FUNCTION ___S2_fsm_post_event (BEGIN) -----
B3:008E6A 90423B            MOV      DPTR,#e
B3:008E6D 127088            LCALL    ?L?COM00F4
B3:008E70 902220            MOV      DPTR,#the_context+020DH
B3:008E73 E0                MOVX     A,@DPTR
B3:008E74 14                DEC      A
B3:008E75 7003              JNZ      $ + 5H
B3:008E77 029042            LJMP     ?C0222?S2
B3:008E7A 14                DEC      A
B3:008E7B 7003              JNZ      $ + 5H
B3:008E7D 0290A5            LJMP     ?C0232?S2
B3:008E80 24FE              ADD      A,#0FEH
B3:008E82 7003              JNZ      $ + 5H
B3:008E84 0290B5            LJMP     ?C0235?S2
B3:008E87 14                DEC      A
B3:008E88 6007              JZ       ?C0203?S2
B3:008E8A 2405              ADD      A,#05H
B3:008E8C 6003              JZ       $ + 5H
B3:008E8E 02919D            LJMP     ?C0250?S2
B3:008E91         ?C0203?S2:
B3:008E91 90423B            MOV      DPTR,#e
B3:008E94 E0                MOVX     A,@DPTR
B3:008E95 7031              JNZ      ?C0204?S2
B3:008E97 A3                INC      DPTR
B3:008E98 3117              ACALL    ?L?COM0025
B3:008E9A 12D901            LCALL    ___S2_span_ok
B3:008E9D EF                MOV      A,R7
B3:008E9E 4E                ORL      A,R6
B3:008E9F 6027              JZ       ?C0204?S2
B3:008EA1 90423C            MOV      DPTR,#d
B3:008EA4 3117              ACALL    ?L?COM0025
B3:008EA6 C003              PUSH     AR3
B3:008EA8 C002              PUSH     AR2
B3:008EAA C001              PUSH     AR1
B3:008EAC 1298AB            LCALL    ?L?COM00A0
B3:008EAF FF                MOV      R7,A
B3:008EB0 903FD2            MOV      DPTR,#?___S2_set_peer?BYTE+06H
B3:008EB3 12ED14            LCALL    ?L?COM01F0
B3:008EB6 D001              POP      AR1
B3:008EB8 D002              POP      AR2
B3:008EBA D003              POP      AR3
B3:008EBC 12D5A0            LCALL    ___S2_set_peer
B3:008EBF 902221            MOV      DPTR,#the_context+020EH
B3:008EC2 7402              MOV      A,#02H
B3:008EC4 F0                MOVX     @DPTR,A
B3:008EC5 02917C            LJMP     send_msg_state_enter?S2
B3:008EC8         ?C0204?S2:
B3:008EC8 90423B            MOV      DPTR,#e
B3:008ECB E0                MOVX     A,@DPTR
B3:008ECC 702F              JNZ      ?C0207?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 875


B3:008ECE 902220            MOV      DPTR,#the_context+020DH
B3:008ED1 04                INC      A
B3:008ED2 F0                MOVX     @DPTR,A
B3:008ED3 A3                INC      DPTR
B3:008ED4 04                INC      A
B3:008ED5 F0                MOVX     @DPTR,A
B3:008ED6 90423C            MOV      DPTR,#d
B3:008ED9 3117              ACALL    ?L?COM0025
B3:008EDB C003              PUSH     AR3
B3:008EDD C002              PUSH     AR2
B3:008EDF C001              PUSH     AR1
B3:008EE1 1298AB            LCALL    ?L?COM00A0
B3:008EE4 FF                MOV      R7,A
B3:008EE5 903FD2            MOV      DPTR,#?___S2_set_peer?BYTE+06H
B3:008EE8 12ED14            LCALL    ?L?COM01F0
B3:008EEB D001              POP      AR1
B3:008EED D002              POP      AR2
B3:008EEF D003              POP      AR3
B3:008EF1 12D5A0            LCALL    ___S2_set_peer
B3:008EF4 12E74C            LCALL    __S2_send_nonce_get
B3:008EF7 12F00B            LCALL    ?L?COM059E
B3:008EFA 0290C4            LJMP     ?C0281?S2
B3:008EFD         ?C0207?S2:
B3:008EFD 90423B            MOV      DPTR,#e
B3:008F00 E0                MOVX     A,@DPTR
B3:008F01 6403              XRL      A,#03H
B3:008F03 703A              JNZ      ?C0209?S2
B3:008F05 A3                INC      DPTR
B3:008F06 1298C0            LCALL    ?L?COM00A2
B3:008F09 C3                CLR      C
B3:008F0A 9403              SUBB     A,#03H
B3:008F0C E5F0              MOV      A,B
B3:008F0E 9400              SUBB     A,#00H
B3:008F10 402D              JC       ?C0209?S2
B3:008F12 1225BE            LCALL    ?C?PLDPTR
B3:008F15 C003              PUSH     AR3
B3:008F17 C002              PUSH     AR2
B3:008F19 C001              PUSH     AR1
B3:008F1B 12925E            LCALL    ?L?COM0454
B3:008F1E 900003            MOV      DPTR,#03H
B3:008F21 12262D            LCALL    ?C?PLDOPTR
B3:008F24 12AB1D            LCALL    ?L?COM0110
B3:008F27 FD                MOV      R5,A
B3:008F28 D001              POP      AR1
B3:008F2A D002              POP      AR2
B3:008F2C D003              POP      AR3
B3:008F2E 12B5BD            LCALL    ___S2_verify_seq
B3:008F31 EF                MOV      A,R7
B3:008F32 4E                ORL      A,R6
B3:008F33 600A              JZ       ?C0209?S2
B3:008F35 90423C            MOV      DPTR,#d
B3:008F38 3117              ACALL    ?L?COM0025
B3:008F3A 7D01              MOV      R5,#01H
B3:008F3C 02903F            LJMP     ?C0280?S2
B3:008F3F         ?C0209?S2:
B3:008F3F 129264            LCALL    ?L?COM053B
B3:008F42 703A              JNZ      ?C0211?S2
B3:008F44 A3                INC      DPTR
B3:008F45 3117              ACALL    ?L?COM0025
B3:008F47 C003              PUSH     AR3
B3:008F49 C002              PUSH     AR2
B3:008F4B C001              PUSH     AR1
B3:008F4D 1298AB            LCALL    ?L?COM00A0
B3:008F50 FF                MOV      R7,A
B3:008F51 903FD2            MOV      DPTR,#?___S2_set_peer?BYTE+06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 876


B3:008F54 12ED14            LCALL    ?L?COM01F0
B3:008F57 D001              POP      AR1
B3:008F59 D002              POP      AR2
B3:008F5B D003              POP      AR3
B3:008F5D 12D5A0            LCALL    ___S2_set_peer
B3:008F60 12925E            LCALL    ?L?COM0454
B3:008F63 900003            MOV      DPTR,#03H
B3:008F66 12262D            LCALL    ?C?PLDOPTR
B3:008F69 C003              PUSH     AR3
B3:008F6B C002              PUSH     AR2
B3:008F6D C001              PUSH     AR1
B3:008F6F 1298BD            LCALL    ?L?COM00A1
B3:008F72 FD                MOV      R5,A
B3:008F73 ACF0              MOV      R4,B
B3:008F75 D001              POP      AR1
B3:008F77 D002              POP      AR2
B3:008F79 D003              POP      AR3
B3:008F7B 0291AA            LJMP     ___S2_register_nonce
B3:008F7E         ?C0211?S2:
B3:008F7E 90423B            MOV      DPTR,#e
B3:008F81 E0                MOVX     A,@DPTR
B3:008F82 6401              XRL      A,#01H
B3:008F84 703F              JNZ      ?C0213?S2
B3:008F86 A3                INC      DPTR
B3:008F87 3117              ACALL    ?L?COM0025
B3:008F89 C003              PUSH     AR3
B3:008F8B C002              PUSH     AR2
B3:008F8D C001              PUSH     AR1
B3:008F8F 1298AB            LCALL    ?L?COM00A0
B3:008F92 FF                MOV      R7,A
B3:008F93 903FD2            MOV      DPTR,#?___S2_set_peer?BYTE+06H
B3:008F96 12ED14            LCALL    ?L?COM01F0
B3:008F99 D001              POP      AR1
B3:008F9B D002              POP      AR2
B3:008F9D D003              POP      AR3
B3:008F9F 12D5A0            LCALL    ___S2_set_peer
B3:008FA2 90423C            MOV      DPTR,#d
B3:008FA5 3117              ACALL    ?L?COM0025
B3:008FA7 129279            LCALL    ?L?COM0066
B3:008FAA FD                MOV      R5,A
B3:008FAB 7B01              MOV      R3,#01H
B3:008FAD E4                CLR      A
B3:008FAE FF                MOV      R7,A
B3:008FAF 12C7B8            LCALL    ___find_mpan_by_group_id
B3:008FB2 AF01              MOV      R7,AR1
B3:008FB4 9020F1            MOV      DPTR,#the_context+0DEH
B3:008FB7 EA                MOV      A,R2
B3:008FB8 F0                MOVX     @DPTR,A
B3:008FB9 A3                INC      DPTR
B3:008FBA EF                MOV      A,R7
B3:008FBB F0                MOVX     @DPTR,A
B3:008FBC 902220            MOV      DPTR,#the_context+020DH
B3:008FBF 7402              MOV      A,#02H
B3:008FC1 F0                MOVX     @DPTR,A
B3:008FC2 02C4D5            LJMP     __S2_encrypt_and_send_multi
B3:008FC5         ?C0213?S2:
B3:008FC5 90423B            MOV      DPTR,#e
B3:008FC8 E0                MOVX     A,@DPTR
B3:008FC9 B40210            CJNE     A,#02H,?C0215?S2
B3:008FCC A3                INC      DPTR
B3:008FCD 1291A1            LCALL    ?L?COM004B
B3:008FD0 7D00              MOV      R5,#00H
B3:008FD2 7002              JNZ      ?C0216?S2
B3:008FD4 7D01              MOV      R5,#01H
B3:008FD6         ?C0216?S2:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 877


B3:008FD6         ?C0217?S2:
B3:008FD6 12A7BA            LCALL    ?L?COM0333
B3:008FD9 02DE2C            LJMP     _s2_inclusion_send_done
B3:008FDC         ?C0215?S2:
B3:008FDC 90423B            MOV      DPTR,#e
B3:008FDF E0                MOVX     A,@DPTR
B3:008FE0 B40736            CJNE     A,#07H,?C0219?S2
B3:008FE3 7F0A              MOV      R7,#0AH
B3:008FE5 7E00              MOV      R6,#00H
B3:008FE7 7D00              MOV      R5,#00H
B3:008FE9 7C00              MOV      R4,#00H
B3:008FEB 12928C            LCALL    ___S2_set_timeout
B3:008FEE 90423C            MOV      DPTR,#d
B3:008FF1 3117              ACALL    ?L?COM0025
B3:008FF3 C003              PUSH     AR3
B3:008FF5 C002              PUSH     AR2
B3:008FF7 C001              PUSH     AR1
B3:008FF9 12BDF8            LCALL    ?L?COM0032
B3:008FFC 903FCF            MOV      DPTR,#?___S2_set_peer?BYTE+03H
B3:008FFF 1225A9            LCALL    ?C?PSTXDATA
B3:009002 E4                CLR      A
B3:009003 903FD2            MOV      DPTR,#?___S2_set_peer?BYTE+06H
B3:009006 F0                MOVX     @DPTR,A
B3:009007 A3                INC      DPTR
B3:009008 F0                MOVX     @DPTR,A
B3:009009 D001              POP      AR1
B3:00900B D002              POP      AR2
B3:00900D D003              POP      AR3
B3:00900F 12D5A0            LCALL    ___S2_set_peer
B3:009012 902220            MOV      DPTR,#the_context+020DH
B3:009015 7405              MOV      A,#05H
B3:009017 F0                MOVX     @DPTR,A
B3:009018 22                RET      
B3:009019         ?C0219?S2:
B3:009019 90423B            MOV      DPTR,#e
B3:00901C E0                MOVX     A,@DPTR
B3:00901D 6408              XRL      A,#08H
B3:00901F 6002              JZ       $ + 4H
B3:009021 219D              AJMP     ?C0250?S2
B3:009023 902220            MOV      DPTR,#the_context+020DH
B3:009026 E0                MOVX     A,@DPTR
B3:009027 6405              XRL      A,#05H
B3:009029 6002              JZ       $ + 4H
B3:00902B 219D              AJMP     ?C0250?S2
B3:00902D 9020F1            MOV      DPTR,#the_context+0DEH
B3:009030 F0                MOVX     @DPTR,A
B3:009031 A3                INC      DPTR
B3:009032 F0                MOVX     @DPTR,A
B3:009033 902220            MOV      DPTR,#the_context+020DH
B3:009036 F0                MOVX     @DPTR,A
B3:009037 7B01              MOV      R3,#01H
B3:009039 7A20              MOV      R2,#HIGH the_context+0CFH
B3:00903B 79E2              MOV      R1,#LOW the_context+0CFH
B3:00903D 7D02              MOV      R5,#02H
B3:00903F         
B3:00903F 02CA27            LJMP     ___S2_send_nonce_report
B3:009042         ?C0222?S2:
B3:009042 90423B            MOV      DPTR,#e
B3:009045 E0                MOVX     A,@DPTR
B3:009046 B40209            CJNE     A,#02H,?C0223?S2
B3:009049 A3                INC      DPTR
B3:00904A 31A1              ACALL    ?L?COM004B
B3:00904C 7004              JNZ      ?C0223?S2
B3:00904E 517F              ACALL    ?L?COM0444
B3:009050         
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 878


B3:009050 8072              SJMP     ?C0281?S2
B3:009052         ?C0223?S2:
B3:009052 90423B            MOV      DPTR,#e
B3:009055 E0                MOVX     A,@DPTR
B3:009056 FF                MOV      R7,A
B3:009057 6402              XRL      A,#02H
B3:009059 6004              JZ       ?C0226?S2
B3:00905B EF                MOV      A,R7
B3:00905C B40810            CJNE     A,#08H,?C0225?S2
B3:00905F         ?C0226?S2:
B3:00905F E4                CLR      A
B3:009060 902220            MOV      DPTR,#the_context+020DH
B3:009063 F0                MOVX     @DPTR,A
B3:009064 90423B            MOV      DPTR,#e
B3:009067 E0                MOVX     A,@DPTR
B3:009068 B40802            CJNE     A,#08H,?C0227?S2
B3:00906B 2126              AJMP     ?C0282?S2
B3:00906D         ?C0227?S2:
B3:00906D 805C              SJMP     ?C0285?S2
B3:00906F         ?C0225?S2:
B3:00906F 5164              ACALL    ?L?COM053B
B3:009071 6002              JZ       $ + 4H
B3:009073 219D              AJMP     ?C0250?S2
B3:009075 A3                INC      DPTR
B3:009076 128917            LCALL    ?L?COM0025
B3:009079 5136              ACALL    ___S2_is_peernode
B3:00907B EF                MOV      A,R7
B3:00907C 4E                ORL      A,R6
B3:00907D 7002              JNZ      $ + 4H
B3:00907F 219D              AJMP     ?C0250?S2
B3:009081 515E              ACALL    ?L?COM0454
B3:009083 900003            MOV      DPTR,#03H
B3:009086 12262D            LCALL    ?C?PLDOPTR
B3:009089 C003              PUSH     AR3
B3:00908B C002              PUSH     AR2
B3:00908D C001              PUSH     AR1
B3:00908F 1298BD            LCALL    ?L?COM00A1
B3:009092 FD                MOV      R5,A
B3:009093 ACF0              MOV      R4,B
B3:009095 D001              POP      AR1
B3:009097 D002              POP      AR2
B3:009099 D003              POP      AR3
B3:00909B 31AA              ACALL    ___S2_register_nonce
B3:00909D EF                MOV      A,R7
B3:00909E 20E002            JB       ACC.0,$ + 5H
B3:0090A1 219D              AJMP     ?C0250?S2
B3:0090A3 217C              AJMP     send_msg_state_enter?S2
B3:0090A5         ?C0232?S2:
B3:0090A5 90423B            MOV      DPTR,#e
B3:0090A8 E0                MOVX     A,@DPTR
B3:0090A9 6402              XRL      A,#02H
B3:0090AB 6002              JZ       $ + 4H
B3:0090AD 219D              AJMP     ?C0250?S2
B3:0090AF 902220            MOV      DPTR,#the_context+020DH
B3:0090B2 F0                MOVX     @DPTR,A
B3:0090B3         
B3:0090B3 8016              SJMP     ?C0285?S2
B3:0090B5         ?C0235?S2:
B3:0090B5 90423B            MOV      DPTR,#e
B3:0090B8 E0                MOVX     A,@DPTR
B3:0090B9 6402              XRL      A,#02H
B3:0090BB 7015              JNZ      ?C0236?S2
B3:0090BD A3                INC      DPTR
B3:0090BE 31A1              ACALL    ?L?COM004B
B3:0090C0 7004              JNZ      ?C0237?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 879


B3:0090C2 517F              ACALL    ?L?COM0444
B3:0090C4         
B3:0090C4 418C              AJMP     ___S2_set_timeout
B3:0090C6         ?C0237?S2:
B3:0090C6 E4                CLR      A
B3:0090C7 902220            MOV      DPTR,#the_context+020DH
B3:0090CA F0                MOVX     @DPTR,A
B3:0090CB         
B3:0090CB 90423C            MOV      DPTR,#d
B3:0090CE 31A1              ACALL    ?L?COM004B
B3:0090D0 8064              SJMP     ?C0286?S2
B3:0090D2         ?C0236?S2:
B3:0090D2 90423B            MOV      DPTR,#e
B3:0090D5 E0                MOVX     A,@DPTR
B3:0090D6 6405              XRL      A,#05H
B3:0090D8 7036              JNZ      ?C0240?S2
B3:0090DA A3                INC      DPTR
B3:0090DB 128917            LCALL    ?L?COM0025
B3:0090DE 5136              ACALL    ___S2_is_peernode
B3:0090E0 EF                MOV      A,R7
B3:0090E1 4E                ORL      A,R6
B3:0090E2 602C              JZ       ?C0240?S2
B3:0090E4 90423C            MOV      DPTR,#d
B3:0090E7 128917            LCALL    ?L?COM0025
B3:0090EA 5179              ACALL    ?L?COM0066
B3:0090EC FF                MOV      R7,A
B3:0090ED 12E767            LCALL    ___S2_is_node_mos
B3:0090F0 EF                MOV      A,R7
B3:0090F1 6014              JZ       ?C0241?S2
B3:0090F3 902221            MOV      DPTR,#the_context+020EH
B3:0090F6 E0                MOVX     A,@DPTR
B3:0090F7 D3                SETB     C
B3:0090F8 9400              SUBB     A,#00H
B3:0090FA 400B              JC       ?C0241?S2
B3:0090FC 516B              ACALL    ?L?COM0600
B3:0090FE 9020E4            MOV      DPTR,#the_context+0D1H
B3:009101 E0                MOVX     A,@DPTR
B3:009102 54FE              ANL      A,#0FEH
B3:009104 F0                MOVX     @DPTR,A
B3:009105 8075              SJMP     send_msg_state_enter?S2
B3:009107         ?C0241?S2:
B3:009107 E4                CLR      A
B3:009108 902220            MOV      DPTR,#the_context+020DH
B3:00910B F0                MOVX     @DPTR,A
B3:00910C 7F05              MOV      R7,#05H
B3:00910E 8069              SJMP     ?C0289?S2
B3:009110         ?C0240?S2:
B3:009110 90423B            MOV      DPTR,#e
B3:009113 E0                MOVX     A,@DPTR
B3:009114 B40613            CJNE     A,#06H,?C0244?S2
B3:009117 A3                INC      DPTR
B3:009118 128917            LCALL    ?L?COM0025
B3:00911B 5136              ACALL    ___S2_is_peernode
B3:00911D EF                MOV      A,R7
B3:00911E 4E                ORL      A,R6
B3:00911F 6009              JZ       ?C0244?S2
B3:009121 E4                CLR      A
B3:009122 902220            MOV      DPTR,#the_context+020DH
B3:009125 F0                MOVX     @DPTR,A
B3:009126         
B3:009126 7F02              MOV      R7,#02H
B3:009128         
B3:009128 804F              SJMP     ?C0289?S2
B3:00912A         ?C0244?S2:
B3:00912A 90423B            MOV      DPTR,#e
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 880


B3:00912D E0                MOVX     A,@DPTR
B3:00912E B40808            CJNE     A,#08H,?C0246?S2
B3:009131 E4                CLR      A
B3:009132 902220            MOV      DPTR,#the_context+020DH
B3:009135 F0                MOVX     @DPTR,A
B3:009136         
B3:009136 FF                MOV      R7,A
B3:009137         
B3:009137 8040              SJMP     ?C0289?S2
B3:009139         ?C0246?S2:
B3:009139 5164              ACALL    ?L?COM053B
B3:00913B 7060              JNZ      ?C0250?S2
B3:00913D A3                INC      DPTR
B3:00913E 128917            LCALL    ?L?COM0025
B3:009141 5136              ACALL    ___S2_is_peernode
B3:009143 EF                MOV      A,R7
B3:009144 4E                ORL      A,R6
B3:009145 6056              JZ       ?C0250?S2
B3:009147 515E              ACALL    ?L?COM0454
B3:009149 900003            MOV      DPTR,#03H
B3:00914C 12262D            LCALL    ?C?PLDOPTR
B3:00914F C003              PUSH     AR3
B3:009151 C002              PUSH     AR2
B3:009153 C001              PUSH     AR1
B3:009155 1298BD            LCALL    ?L?COM00A1
B3:009158 FD                MOV      R5,A
B3:009159 ACF0              MOV      R4,B
B3:00915B D001              POP      AR1
B3:00915D D002              POP      AR2
B3:00915F D003              POP      AR3
B3:009161 31AA              ACALL    ___S2_register_nonce
;---- Variable 'nr_flag' assigned to Register 'R7' ----
B3:009163 EF                MOV      A,R7
B3:009164 7001              JNZ      ?C0249?S2
B3:009166 22                RET      
B3:009167         ?C0249?S2:
B3:009167 EF                MOV      A,R7
B3:009168 B40202            CJNE     A,#02H,?C0251?S2
B3:00916B 516B              ACALL    ?L?COM0600
B3:00916D         ?C0251?S2:
B3:00916D 902221            MOV      DPTR,#the_context+020EH
B3:009170 E0                MOVX     A,@DPTR
B3:009171 7009              JNZ      send_msg_state_enter?S2
B3:009173 902220            MOV      DPTR,#the_context+020DH
B3:009176 F0                MOVX     @DPTR,A
B3:009177 7F02              MOV      R7,#02H
B3:009179         
B3:009179 02DE0F            LJMP     ___S2_post_send_done_event
B3:00917C         send_msg_state_enter:
B3:00917C 902220            MOV      DPTR,#the_context+020DH
B3:00917F 7402              MOV      A,#02H
B3:009181 F0                MOVX     @DPTR,A
B3:009182 9020E4            MOV      DPTR,#the_context+0D1H
B3:009185 E0                MOVX     A,@DPTR
B3:009186 30E00B            JNB      ACC.0,?C0257?S2
B3:009189 902220            MOV      DPTR,#the_context+020DH
B3:00918C 7404              MOV      A,#04H
B3:00918E F0                MOVX     @DPTR,A
B3:00918F 12F00B            LCALL    ?L?COM059E
B3:009192 518C              ACALL    ___S2_set_timeout
B3:009194         ?C0257?S2:
B3:009194 12C0E5            LCALL    __S2_encrypt_and_send
B3:009197 902221            MOV      DPTR,#the_context+020EH
B3:00919A E0                MOVX     A,@DPTR
B3:00919B 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 881


B3:00919C F0                MOVX     @DPTR,A
B3:00919D         ?C0250?S2:
B3:00919D 22                RET      
----- FUNCTION ___S2_fsm_post_event (END) -------


----- FUNCTION ?L?COM004A (BEGIN) -----
B3:00919E 902E03            MOV      DPTR,#conn
B3:0091A1         ?L?COM004B:
B3:0091A1 122589            LCALL    ?C?PLDXDATA
B3:0091A4         ?L?COM004C:
B3:0091A4 900003            MOV      DPTR,#03H
B3:0091A7 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM004A (END) -------


----- FUNCTION ___S2_register_nonce (BEGIN) -----
B3:0091AA 904083            MOV      DPTR,#buf
B3:0091AD 1225A9            LCALL    ?C?PSTXDATA
B3:0091B0 904086            MOV      DPTR,#len
B3:0091B3 EC                MOV      A,R4
B3:0091B4 F0                MOVX     @DPTR,A
B3:0091B5 A3                INC      DPTR
B3:0091B6 ED                MOV      A,R5
B3:0091B7 F0                MOVX     @DPTR,A
B3:0091B8 904083            MOV      DPTR,#buf
B3:0091BB 12AB1A            LCALL    ?L?COM010F
B3:0091BE FD                MOV      R5,A
B3:0091BF 7B01              MOV      R3,#01H
B3:0091C1 7A20              MOV      R2,#HIGH the_context+0CFH
B3:0091C3 79E2              MOV      R1,#LOW the_context+0CFH
B3:0091C5 12B5BD            LCALL    ___S2_verify_seq
B3:0091C8 EF                MOV      A,R7
B3:0091C9 4E                ORL      A,R6
B3:0091CA 7002              JNZ      ?C0086?S2
B3:0091CC FF                MOV      R7,A
B3:0091CD 22                RET      
B3:0091CE         ?C0086?S2:
B3:0091CE 12A59A            LCALL    ?L?COM0335
B3:0091D1 904088            MOV      DPTR,#span
B3:0091D4 EE                MOV      A,R6
B3:0091D5 F0                MOVX     @DPTR,A
B3:0091D6 A3                INC      DPTR
B3:0091D7 EF                MOV      A,R7
B3:0091D8 F0                MOVX     @DPTR,A
B3:0091D9 C3                CLR      C
B3:0091DA 904087            MOV      DPTR,#len+01H
B3:0091DD E0                MOVX     A,@DPTR
B3:0091DE 9414              SUBB     A,#014H
B3:0091E0 904086            MOV      DPTR,#len
B3:0091E3 E0                MOVX     A,@DPTR
B3:0091E4 9400              SUBB     A,#00H
B3:0091E6 4025              JC       ?C0088?S2
B3:0091E8 904083            MOV      DPTR,#buf
B3:0091EB 31A1              ACALL    ?L?COM004B
B3:0091ED 30E01D            JNB      ACC.0,?C0088?S2
B3:0091F0 125525            LCALL    ?L?COM005A
B3:0091F3 C002              PUSH     AR2
B3:0091F5 5156              ACALL    ?L?COM0602
B3:0091F7 AA06              MOV      R2,AR6
B3:0091F9 F8                MOV      R0,A
B3:0091FA AC02              MOV      R4,AR2
B3:0091FC 7D01              MOV      R5,#01H
B3:0091FE D002              POP      AR2
B3:009200 12A7B3            LCALL    ?L?COM01B4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 882


B3:009203 5156              ACALL    ?L?COM0602
B3:009205 2426              ADD      A,#026H
B3:009207 12B617            LCALL    ?L?COM0096
B3:00920A 7404              MOV      A,#04H
B3:00920C F0                MOVX     @DPTR,A
B3:00920D         ?C0088?S2:
B3:00920D 904083            MOV      DPTR,#buf
B3:009210 31A1              ACALL    ?L?COM004B
B3:009212 30E11A            JNB      ACC.1,?C0089?S2
B3:009215 C3                CLR      C
B3:009216 904087            MOV      DPTR,#len+01H
B3:009219 E0                MOVX     A,@DPTR
B3:00921A 9403              SUBB     A,#03H
B3:00921C 904086            MOV      DPTR,#len
B3:00921F E0                MOVX     A,@DPTR
B3:009220 9400              SUBB     A,#00H
B3:009222 400B              JC       ?C0089?S2
B3:009224 12A7BA            LCALL    ?L?COM0333
B3:009227 9020E3            MOV      DPTR,#the_context+0D0H
B3:00922A E0                MOVX     A,@DPTR
B3:00922B FD                MOV      R5,A
B3:00922C 12E7E2            LCALL    _S2_set_node_mos
B3:00922F         ?C0089?S2:
B3:00922F 904083            MOV      DPTR,#buf
B3:009232 31A1              ACALL    ?L?COM004B
B3:009234 FF                MOV      R7,A
B3:009235 22                RET      
----- FUNCTION ___S2_register_nonce (END) -------


----- FUNCTION ___S2_is_peernode (BEGIN) -----
;---- Variable 'peer' assigned to Register 'R1/R2/R3' ----
B3:009236 121FB3            LCALL    ?C?CLDPTR
B3:009239 FF                MOV      R7,A
B3:00923A 9020E2            MOV      DPTR,#the_context+0CFH
B3:00923D E0                MOVX     A,@DPTR
B3:00923E B50710            CJNE     A,AR7,?C0158?S2
B3:009241 5179              ACALL    ?L?COM0066
B3:009243 FF                MOV      R7,A
B3:009244 9020E3            MOV      DPTR,#the_context+0D0H
B3:009247 E0                MOVX     A,@DPTR
B3:009248 B50706            CJNE     A,AR7,?C0158?S2
B3:00924B 7E00              MOV      R6,#00H
B3:00924D 7F01              MOV      R7,#01H
B3:00924F 8004              SJMP     ?C0159?S2
B3:009251         ?C0158?S2:
B3:009251 7E00              MOV      R6,#00H
B3:009253 7F00              MOV      R7,#00H
B3:009255         ?C0159?S2:
B3:009255 22                RET      
----- FUNCTION ___S2_is_peernode (END) -------


----- FUNCTION ?L?COM0602 (BEGIN) -----
B3:009256 904088            MOV      DPTR,#span
B3:009259 E0                MOVX     A,@DPTR
B3:00925A FE                MOV      R6,A
B3:00925B A3                INC      DPTR
B3:00925C E0                MOVX     A,@DPTR
B3:00925D 22                RET      
----- FUNCTION ?L?COM0602 (END) -------


----- FUNCTION ?L?COM0454 (BEGIN) -----
B3:00925E 90423C            MOV      DPTR,#d
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 883


B3:009261 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0454 (END) -------


----- FUNCTION ?L?COM053B (BEGIN) -----
B3:009264 90423B            MOV      DPTR,#e
B3:009267 E0                MOVX     A,@DPTR
B3:009268 6404              XRL      A,#04H
B3:00926A 22                RET      
----- FUNCTION ?L?COM053B (END) -------


----- FUNCTION ?L?COM0600 (BEGIN) -----
B3:00926B E4                CLR      A
B3:00926C 9020ED            MOV      DPTR,#the_context+0DAH
B3:00926F F0                MOVX     @DPTR,A
B3:009270 A3                INC      DPTR
B3:009271 F0                MOVX     @DPTR,A
B3:009272 22                RET      
----- FUNCTION ?L?COM0600 (END) -------


----- FUNCTION ?L?COM0064 (BEGIN) -----
B3:009273 9020EA            MOV      DPTR,#the_context+0D7H
B3:009276         ?L?COM0065:
B3:009276 122589            LCALL    ?C?PLDXDATA
B3:009279         ?L?COM0066:
B3:009279 900001            MOV      DPTR,#01H
B3:00927C 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0064 (END) -------


----- FUNCTION ?L?COM0444 (BEGIN) -----
B3:00927F 900004            MOV      DPTR,#04H
B3:009282 12219A            LCALL    ?C?ILDOPTR
B3:009285 FF                MOV      R7,A
B3:009286 AEF0              MOV      R6,B
B3:009288 E4                CLR      A
B3:009289 FC                MOV      R4,A
B3:00928A FD                MOV      R5,A
B3:00928B 22                RET      
----- FUNCTION ?L?COM0444 (END) -------


----- FUNCTION ___S2_set_timeout (BEGIN) -----
;---- Variable 'interval' assigned to Register 'R4/R5/R6/R7' ----
B3:00928C 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00928F 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_timeout2
B3:009291 F0                MOVX     @DPTR,A
B3:009292 A3                INC      DPTR
B3:009293 7496              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_timeout2
B3:009295 F0                MOVX     @DPTR,A
B3:009296 12A541            LCALL    ?L?COM02C0
B3:009299 12725F            LCALL    ?L?COM0410
B3:00929C 7A34              MOV      R2,#HIGH s2_timer
B3:00929E 79ED              MOV      R1,#LOW s2_timer
B3:0092A0 021B10            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION ___S2_set_timeout (END) -------


----- FUNCTION _ExploreQueueFrame (BEGIN) -----
B3:0092A3 900A6A            MOV      DPTR,#bSrcNodeID
B3:0092A6 124765            LCALL    ?L?COM0102
B3:0092A9 1225A9            LCALL    ?C?PSTXDATA
B3:0092AC 900A6F            MOV      DPTR,#bDataLength
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 884


B3:0092AF E0                MOVX     A,@DPTR
B3:0092B0 D3                SETB     C
B3:0092B1 942F              SUBB     A,#02FH
B3:0092B3 4002              JC       $ + 4H
B3:0092B5 618E              AJMP     ?C0001?ZW_EXPLORE
B3:0092B7 12D28D            LCALL    ExploreQueueIndex
B3:0092BA 8F52              MOV      bExploreQueueIndex,R7
B3:0092BC EF                MOV      A,R7
B3:0092BD C3                CLR      C
B3:0092BE 9402              SUBB     A,#02H
B3:0092C0 4002              JC       $ + 4H
B3:0092C2 618E              AJMP     ?C0001?ZW_EXPLORE
B3:0092C4 EF                MOV      A,R7
B3:0092C5 12EF60            LCALL    ?L?COM02A5
B3:0092C8 90095B            MOV      DPTR,#pExploreQueueElement
B3:0092CB 1225A9            LCALL    ?C?PSTXDATA
B3:0092CE 7401              MOV      A,#01H
B3:0092D0 122072            LCALL    ?C?CSTPTR
B3:0092D3 90095B            MOV      DPTR,#pExploreQueueElement
B3:0092D6 12EEE6            LCALL    ?L?COM007D
B3:0092D9 E4                CLR      A
B3:0092DA 122072            LCALL    ?C?CSTPTR
B3:0092DD 900A6A            MOV      DPTR,#bSrcNodeID
B3:0092E0 E0                MOVX     A,@DPTR
B3:0092E1 12703E            LCALL    ?L?COM009E
B3:0092E4 2424              ADD      A,#024H
B3:0092E6 128483            LCALL    ?L?COM00C8
B3:0092E9 12703E            LCALL    ?L?COM009E
B3:0092EC 128481            LCALL    ?L?COM00C7
B3:0092EF 900A6B            MOV      DPTR,#bDstNodeID
B3:0092F2 E0                MOVX     A,@DPTR
B3:0092F3 12703E            LCALL    ?L?COM009E
B3:0092F6 2428              ADD      A,#028H
B3:0092F8 128483            LCALL    ?L?COM00C8
B3:0092FB 12703E            LCALL    ?L?COM009E
B3:0092FE 2403              ADD      A,#03H
B3:009300 128483            LCALL    ?L?COM00C8
B3:009303 900A70            MOV      DPTR,#bExploreFlag
B3:009306 E0                MOVX     A,@DPTR
B3:009307 127411            LCALL    ?L?COM0613
B3:00930A 12703F            LCALL    ?L?COM009F
B3:00930D 2405              ADD      A,#05H
B3:00930F F9                MOV      R1,A
B3:009310 E4                CLR      A
B3:009311 3A                ADDC     A,R2
B3:009312 FA                MOV      R2,A
B3:009313 EE                MOV      A,R6
B3:009314 122072            LCALL    ?C?CSTPTR
B3:009317 EF                MOV      A,R7
B3:009318 540F              ANL      A,#0FH
B3:00931A FF                MOV      R7,A
B3:00931B 90095B            MOV      DPTR,#pExploreQueueElement
B3:00931E 125522            LCALL    ?L?COM0059
B3:009321 EF                MOV      A,R7
B3:009322 12F02D            LCALL    ?L?COM0612
B3:009325 FF                MOV      R7,A
B3:009326 6029              JZ       ?C0002?ZW_EXPLORE
B3:009328 900A6C            MOV      DPTR,#pData
B3:00932B 12996C            LCALL    ?L?COM029F
B3:00932E 6021              JZ       ?C0002?ZW_EXPLORE
B3:009330 12703F            LCALL    ?L?COM009F
B3:009333 2431              ADD      A,#031H
B3:009335 F9                MOV      R1,A
B3:009336 E4                CLR      A
B3:009337 3A                ADDC     A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 885


B3:009338 FA                MOV      R2,A
B3:009339 C003              PUSH     AR3
B3:00933B C002              PUSH     AR2
B3:00933D C001              PUSH     AR1
B3:00933F 900A6C            MOV      DPTR,#pData
B3:009342 122589            LCALL    ?C?PLDXDATA
B3:009345 126149            LCALL    ?L?COM0047
B3:009348 D001              POP      AR1
B3:00934A D002              POP      AR2
B3:00934C D003              POP      AR3
B3:00934E 1280A2            LCALL    ___ZW_memcpy
B3:009351         ?C0002?ZW_EXPLORE:
B3:009351 12703F            LCALL    ?L?COM009F
B3:009354 242B              ADD      A,#02BH
B3:009356 F9                MOV      R1,A
B3:009357 E4                CLR      A
B3:009358 3A                ADDC     A,R2
B3:009359 FA                MOV      R2,A
B3:00935A 74FA              MOV      A,#0FAH
B3:00935C 12F02D            LCALL    ?L?COM0612
B3:00935F 2411              ADD      A,#011H
B3:009361 12703E            LCALL    ?L?COM009E
B3:009364 2406              ADD      A,#06H
B3:009366 128483            LCALL    ?L?COM00C8
B3:009369 900A71            MOV      DPTR,#completedFunc
B3:00936C E0                MOVX     A,@DPTR
B3:00936D FE                MOV      R6,A
B3:00936E A3                INC      DPTR
B3:00936F E0                MOVX     A,@DPTR
B3:009370 12703E            LCALL    ?L?COM009E
B3:009373 241E              ADD      A,#01EH
B3:009375 129C73            LCALL    ?L?COM0328
B3:009378 12221F            LCALL    ?C?ISTPTR
B3:00937B 1251E9            LCALL    getTickTime
B3:00937E 12703F            LCALL    ?L?COM009F
B3:009381 2409              ADD      A,#09H
B3:009383 129C73            LCALL    ?L?COM0328
B3:009386 12221F            LCALL    ?C?ISTPTR
B3:009389 E552              MOV      A,bExploreQueueIndex
B3:00938B 04                INC      A
B3:00938C FF                MOV      R7,A
B3:00938D 22                RET      
B3:00938E         ?C0001?ZW_EXPLORE:
B3:00938E 7F00              MOV      R7,#00H
B3:009390 22                RET      
----- FUNCTION _ExploreQueueFrame (END) -------


----- FUNCTION ___S2_decrypt_msg (BEGIN) -----
B3:009391 902E03            MOV      DPTR,#conn
B3:009394 1225A9            LCALL    ?C?PSTXDATA
B3:009397 902E72            MOV      DPTR,#hdr_len
B3:00939A 12C083            LCALL    ?L?COM053D
B3:00939D E4                CLR      A
B3:00939E 902E6C            MOV      DPTR,#decrypt_len
B3:0093A1 12735F            LCALL    ?L?COM0532
B3:0093A4 C003              PUSH     AR3
B3:0093A6 C002              PUSH     AR2
B3:0093A8 C001              PUSH     AR1
B3:0093AA 902E0B            MOV      DPTR,#plain_text
B3:0093AD 122589            LCALL    ?C?PLDXDATA
B3:0093B0 1225DE            LCALL    ?C?PSTPTR
B3:0093B3 902E0E            MOV      DPTR,#plain_text_len
B3:0093B6 122589            LCALL    ?C?PLDXDATA
B3:0093B9 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 886


B3:0093BA F5F0              MOV      B,A
B3:0093BC 12221F            LCALL    ?C?ISTPTR
B3:0093BF 902E06            MOV      DPTR,#msg
B3:0093C2 31A1              ACALL    ?L?COM004B
B3:0093C4 902E66            MOV      DPTR,#flags
B3:0093C7 F0                MOVX     @DPTR,A
B3:0093C8 7404              MOV      A,#04H
B3:0093CA 2408              ADD      A,#08H
B3:0093CC FF                MOV      R7,A
B3:0093CD E4                CLR      A
B3:0093CE 33                RLC      A
B3:0093CF 12EFC4            LCALL    ?L?COM0464
B3:0093D2 5003              JNC      $ + 5H
B3:0093D4 029868            LJMP     parse_fail?S2
B3:0093D7         ?C0092?S2:
B3:0093D7 12BDF8            LCALL    ?L?COM0032
B3:0093DA 12C08C            LCALL    ?L?COM0463
B3:0093DD 319E              ACALL    ?L?COM004A
B3:0093DF 30E005            JNB      ACC.0,?C0094?S2
B3:0093E2 12BDF8            LCALL    ?L?COM0032
B3:0093E5 801F              SJMP     ?C0276?S2
B3:0093E7         ?C0094?S2:
B3:0093E7 902E06            MOV      DPTR,#msg
B3:0093EA 12AB1A            LCALL    ?L?COM010F
B3:0093ED FD                MOV      R5,A
B3:0093EE 902E03            MOV      DPTR,#conn
B3:0093F1 122589            LCALL    ?C?PLDXDATA
B3:0093F4 12B5BD            LCALL    ___S2_verify_seq
B3:0093F7 EF                MOV      A,R7
B3:0093F8 4E                ORL      A,R6
B3:0093F9 7003              JNZ      ?C0096?S2
B3:0093FB 7F03              MOV      R7,#03H
B3:0093FD 22                RET      
B3:0093FE         ?C0096?S2:
B3:0093FE 902E03            MOV      DPTR,#conn
B3:009401 12EEDA            LCALL    ?L?COM04DF
B3:009404 7B01              MOV      R3,#01H
B3:009406         
B3:009406 902E74            MOV      DPTR,#span
B3:009409 1225A9            LCALL    ?C?PSTXDATA
B3:00940C         ?C0095?S2:
B3:00940C 902E66            MOV      DPTR,#flags
B3:00940F E0                MOVX     A,@DPTR
B3:009410 20E002            JB       ACC.0,$ + 5H
B3:009413 A102              AJMP     ?C0098?S2
B3:009415 902E06            MOV      DPTR,#msg
B3:009418 125522            LCALL    ?L?COM0059
B3:00941B 902E6E            MOV      DPTR,#ext_data
B3:00941E 1225A9            LCALL    ?C?PSTXDATA
B3:009421         ?C0101?S2:
B3:009421 12D1B4            LCALL    ?L?COM01D1
B3:009424 902E73            MOV      DPTR,#hdr_len+01H
B3:009427 E0                MOVX     A,@DPTR
B3:009428 2408              ADD      A,#08H
B3:00942A FF                MOV      R7,A
B3:00942B 902E72            MOV      DPTR,#hdr_len
B3:00942E E0                MOVX     A,@DPTR
B3:00942F 3400              ADDC     A,#00H
B3:009431 12EFC4            LCALL    ?L?COM0464
B3:009434 5003              JNC      $ + 5H
B3:009436 029868            LJMP     parse_fail?S2
B3:009439 902E71            MOV      DPTR,#ext_len
B3:00943C E0                MOVX     A,@DPTR
B3:00943D FF                MOV      R7,A
B3:00943E 7003              JNZ      $ + 5H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 887


B3:009440 029868            LJMP     parse_fail?S2
B3:009443         ?C0102?S2:
B3:009443 5179              ACALL    ?L?COM0066
B3:009445 543F              ANL      A,#03FH
B3:009447 24FD              ADD      A,#0FDH
B3:009449 6061              JZ       ?C0107?S2
B3:00944B 14                DEC      A
B3:00944C 7002              JNZ      $ + 4H
B3:00944E 81CE              AJMP     ?C0111?S2
B3:009450 2403              ADD      A,#03H
B3:009452 6002              JZ       $ + 4H
B3:009454 81E7              AJMP     ?C0113?S2
B3:009456         ?C0105?S2:
B3:009456 902E74            MOV      DPTR,#span
B3:009459 12996C            LCALL    ?L?COM029F
B3:00945C 7002              JNZ      $ + 4H
B3:00945E 81F2              AJMP     ?C0104?S2
B3:009460 129C67            LCALL    ?L?COM01CC
B3:009463 121FF0            LCALL    ?C?CLDOPTR
B3:009466 6403              XRL      A,#03H
B3:009468 6002              JZ       $ + 4H
B3:00946A 81F2              AJMP     ?C0104?S2
B3:00946C EF                MOV      A,R7
B3:00946D 6412              XRL      A,#012H
B3:00946F 6002              JZ       $ + 4H
B3:009471 81F2              AJMP     ?C0104?S2
B3:009473 902E6E            MOV      DPTR,#ext_data
B3:009476 128518            LCALL    ?L?COM00FE
B3:009479 FA                MOV      R2,A
B3:00947A 788A              MOV      R0,#LOW s_nonce
B3:00947C 7C2E              MOV      R4,#HIGH s_nonce
B3:00947E 12A7B1            LCALL    ?L?COM01B3
B3:009481 787A              MOV      R0,#LOW r_nonce
B3:009483 7C2E              MOV      R4,#HIGH r_nonce
B3:009485 7D01              MOV      R5,#01H
B3:009487 12C059            LCALL    ?L?COM0508
B3:00948A 12A7B3            LCALL    ?L?COM01B4
B3:00948D 129C67            LCALL    ?L?COM01CC
B3:009490 7405              MOV      A,#05H
B3:009492 122084            LCALL    ?C?CSTOPTR
B3:009495 C003              PUSH     AR3
B3:009497 C002              PUSH     AR2
B3:009499 C001              PUSH     AR1
B3:00949B 1299C9            LCALL    ?L?COM0111
B3:00949E 12EF30            LCALL    ?L?COM022C
B3:0094A1 D001              POP      AR1
B3:0094A3 D002              POP      AR2
B3:0094A5 D003              POP      AR3
B3:0094A7 121B3D            LCALL    ?INTERBANK_TABLE?_next_nonce_instantiate
B3:0094AA 8046              SJMP     ?C0104?S2
B3:0094AC         ?C0107?S2:
B3:0094AC 902E71            MOV      DPTR,#ext_len
B3:0094AF E0                MOVX     A,@DPTR
B3:0094B0 6403              XRL      A,#03H
B3:0094B2 6003              JZ       $ + 5H
B3:0094B4 029868            LJMP     parse_fail?S2
B3:0094B7         ?C0108?S2:
B3:0094B7 902E03            MOV      DPTR,#conn
B3:0094BA 5176              ACALL    ?L?COM0065
B3:0094BC 12AB16            LCALL    ?L?COM010E
B3:0094BF FD                MOV      R5,A
B3:0094C0 319E              ACALL    ?L?COM004A
B3:0094C2 7B00              MOV      R3,#00H
B3:0094C4 20E002            JB       ACC.0,?C0109?S2
B3:0094C7 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 888


B3:0094C9         ?C0109?S2:
B3:0094C9         ?C0110?S2:
B3:0094C9 12C08A            LCALL    ?L?COM0462
B3:0094CC 8024              SJMP     ?C0104?S2
B3:0094CE         ?C0111?S2:
B3:0094CE 902E71            MOV      DPTR,#ext_len
B3:0094D1 E0                MOVX     A,@DPTR
B3:0094D2 6402              XRL      A,#02H
B3:0094D4 6003              JZ       $ + 5H
B3:0094D6 029868            LJMP     parse_fail?S2
B3:0094D9         ?C0112?S2:
B3:0094D9 902E03            MOV      DPTR,#conn
B3:0094DC 5176              ACALL    ?L?COM0065
B3:0094DE FD                MOV      R5,A
B3:0094DF 12A7BA            LCALL    ?L?COM0333
B3:0094E2 12E7E2            LCALL    _S2_set_node_mos
B3:0094E5 800B              SJMP     ?C0104?S2
B3:0094E7         ?C0113?S2:
B3:0094E7 902E6E            MOV      DPTR,#ext_data
B3:0094EA 5176              ACALL    ?L?COM0065
B3:0094EC 30E603            JNB      ACC.6,$ + 6H
B3:0094EF 029868            LJMP     parse_fail?S2
B3:0094F2         ?C0114?S2:
B3:0094F2         ?C0104?S2:
B3:0094F2 902E6E            MOV      DPTR,#ext_data
B3:0094F5 5176              ACALL    ?L?COM0065
B3:0094F7 30E708            JNB      ACC.7,?C0098?S2
B3:0094FA 12F014            LCALL    ?L?COM059F
B3:0094FD 12D1C3            LCALL    ?L?COM01D2
B3:009500 8121              AJMP     ?C0101?S2
B3:009502         ?C0098?S2:
B3:009502 319E              ACALL    ?L?COM004A
B3:009504 30E025            JNB      ACC.0,?C0117?S2
B3:009507 902E77            MOV      DPTR,#mpan
B3:00950A 122589            LCALL    ?C?PLDXDATA
B3:00950D E9                MOV      A,R1
B3:00950E 4A                ORL      A,R2
B3:00950F 7003              JNZ      $ + 5H
B3:009511 02986B            LJMP     auth_fail?S2
B3:009514 900013            MOV      DPTR,#013H
B3:009517 121FF0            LCALL    ?C?CLDOPTR
B3:00951A 6401              XRL      A,#01H
B3:00951C 6003              JZ       $ + 5H
B3:00951E 02986B            LJMP     auth_fail?S2
B3:009521         ?C0118?S2:
B3:009521 5179              ACALL    ?L?COM0066
B3:009523 FF                MOV      R7,A
B3:009524 902E03            MOV      DPTR,#conn
B3:009527 123F95            LCALL    ?L?COM00C0
B3:00952A 8013              SJMP     ?C0121?S2
B3:00952C         ?C0117?S2:
B3:00952C 129C67            LCALL    ?L?COM01CC
B3:00952F 121FF0            LCALL    ?C?CLDOPTR
B3:009532 FF                MOV      R7,A
B3:009533 6406              XRL      A,#06H
B3:009535 6008              JZ       ?C0121?S2
B3:009537 EF                MOV      A,R7
B3:009538 6405              XRL      A,#05H
B3:00953A 6003              JZ       $ + 5H
B3:00953C 02986B            LJMP     auth_fail?S2
B3:00953F         ?C0122?S2:
B3:00953F         ?C0121?S2:
B3:00953F 902E06            MOV      DPTR,#msg
B3:009542 122589            LCALL    ?C?PLDXDATA
B3:009545 902E72            MOV      DPTR,#hdr_len
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 889


B3:009548 E0                MOVX     A,@DPTR
B3:009549 FE                MOV      R6,A
B3:00954A A3                INC      DPTR
B3:00954B E0                MOVX     A,@DPTR
B3:00954C FF                MOV      R7,A
B3:00954D 29                ADD      A,R1
B3:00954E F9                MOV      R1,A
B3:00954F EA                MOV      A,R2
B3:009550 3E                ADDC     A,R6
B3:009551 FA                MOV      R2,A
B3:009552 902E67            MOV      DPTR,#ciphertext
B3:009555 1225A9            LCALL    ?C?PSTXDATA
B3:009558 C3                CLR      C
B3:009559 902E0A            MOV      DPTR,#msg_len+01H
B3:00955C E0                MOVX     A,@DPTR
B3:00955D 9F                SUBB     A,R7
B3:00955E FF                MOV      R7,A
B3:00955F 902E09            MOV      DPTR,#msg_len
B3:009562 E0                MOVX     A,@DPTR
B3:009563 9E                SUBB     A,R6
B3:009564 902E6A            MOV      DPTR,#ciphertext_len
B3:009567 12C404            LCALL    ?L?COM0127
B3:00956A 7A2E              MOV      R2,#HIGH aad_buf
B3:00956C 7911              MOV      R1,#LOW aad_buf
B3:00956E 902E61            MOV      DPTR,#aad
B3:009571 1225A9            LCALL    ?C?PSTXDATA
B3:009574 902E03            MOV      DPTR,#conn
B3:009577 5176              ACALL    ?L?COM0065
B3:009579 FF                MOV      R7,A
B3:00957A 121FB3            LCALL    ?C?CLDPTR
B3:00957D 902E72            MOV      DPTR,#hdr_len
B3:009580 12EF7A            LCALL    ?L?COM03AA
B3:009583 902E09            MOV      DPTR,#msg_len
B3:009586 E0                MOVX     A,@DPTR
B3:009587 FB                MOV      R3,A
B3:009588 A3                INC      DPTR
B3:009589 E0                MOVX     A,@DPTR
B3:00958A 903C52            MOV      DPTR,#?___S2_make_aad?BYTE+07H
B3:00958D CB                XCH      A,R3
B3:00958E F0                MOVX     @DPTR,A
B3:00958F A3                INC      DPTR
B3:009590 EB                MOV      A,R3
B3:009591 F0                MOVX     @DPTR,A
B3:009592 902E61            MOV      DPTR,#aad
B3:009595 122589            LCALL    ?C?PLDXDATA
B3:009598 903C54            MOV      DPTR,#?___S2_make_aad?BYTE+09H
B3:00959B 12EE3E            LCALL    ?L?COM02A2
B3:00959E 902E06            MOV      DPTR,#msg
B3:0095A1 122589            LCALL    ?C?PLDXDATA
B3:0095A4 12C706            LCALL    ___S2_make_aad
B3:0095A7 902E64            MOV      DPTR,#aad_len
B3:0095AA EE                MOV      A,R6
B3:0095AB F0                MOVX     @DPTR,A
B3:0095AC A3                INC      DPTR
B3:0095AD EF                MOV      A,R7
B3:0095AE F0                MOVX     @DPTR,A
B3:0095AF 902E74            MOV      DPTR,#span
B3:0095B2 12996C            LCALL    ?L?COM029F
B3:0095B5 7002              JNZ      $ + 4H
B3:0095B7 C1EE              AJMP     ?C0123?S2
B3:0095B9 902220            MOV      DPTR,#the_context+020DH
B3:0095BC E0                MOVX     A,@DPTR
B3:0095BD 701D              JNZ      ?C0124?S2
B3:0095BF 129C67            LCALL    ?L?COM01CC
B3:0095C2 121FF0            LCALL    ?C?CLDOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 890


B3:0095C5 B40514            CJNE     A,#05H,?C0124?S2
B3:0095C8 902E6A            MOV      DPTR,#ciphertext_len
B3:0095CB E0                MOVX     A,@DPTR
B3:0095CC FE                MOV      R6,A
B3:0095CD A3                INC      DPTR
B3:0095CE E0                MOVX     A,@DPTR
B3:0095CF FF                MOV      R7,A
B3:0095D0 7824              MOV      R0,#LOW the_context+0211H
B3:0095D2 7C22              MOV      R4,#HIGH the_context+0211H
B3:0095D4 7D01              MOV      R5,#01H
B3:0095D6 902E67            MOV      DPTR,#ciphertext
B3:0095D9 1270FA            LCALL    ?L?COM0233
B3:0095DC         ?C0124?S2:
B3:0095DC E4                CLR      A
B3:0095DD 902E9A            MOV      DPTR,#i
B3:0095E0 F0                MOVX     @DPTR,A
B3:0095E1         ?C0125?S2:
B3:0095E1 1299DF            LCALL    ?L?COM0112
B3:0095E4 12C8EB            LCALL    ?L?COM0583
B3:0095E7 8005              SJMP     ?C0268?S2
B3:0095E9         ?C0267?S2:
B3:0095E9 C3                CLR      C
B3:0095EA 33                RLC      A
B3:0095EB CE                XCH      A,R6
B3:0095EC 33                RLC      A
B3:0095ED CE                XCH      A,R6
B3:0095EE         ?C0268?S2:
B3:0095EE D8F9              DJNZ     R0,?C0267?S2
B3:0095F0 12C8F4            LCALL    ?L?COM05A0
B3:0095F3 7002              JNZ      $ + 4H
B3:0095F5 C192              AJMP     ?C0128?S2
B3:0095F7 C003              PUSH     AR3
B3:0095F9 C002              PUSH     AR2
B3:0095FB C001              PUSH     AR1
B3:0095FD 9040ED            MOV      DPTR,#?_next_nonce_generate?BYTE+03H
B3:009600 12EF12            LCALL    ?L?COM01F1
B3:009603 D001              POP      AR1
B3:009605 D002              POP      AR2
B3:009607 D003              POP      AR3
B3:009609 121B42            LCALL    ?INTERBANK_TABLE?_next_nonce_generate
B3:00960C 1299DF            LCALL    ?L?COM0112
B3:00960F 12EE2C            LCALL    ?L?COM0206
B3:009612 C003              PUSH     AR3
B3:009614 C002              PUSH     AR2
B3:009616 C001              PUSH     AR1
B3:009618 12E4D4            LCALL    ?L?COM00AF
B3:00961B 903415            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+010H
B3:00961E 1224F1            LCALL    ?C?LSTXDATA
B3:009621 D001              POP      AR1
B3:009623 D002              POP      AR2
B3:009625 D003              POP      AR3
B3:009627 121B1F            LCALL    ?INTERBANK_TABLE?_CCM_decrypt_and_auth
B3:00962A 902E6C            MOV      DPTR,#decrypt_len
B3:00962D 1267E1            LCALL    ?L?COM0460
B3:009630 6060              JZ       ?C0128?S2
B3:009632 129C67            LCALL    ?L?COM01CC
B3:009635 7406              MOV      A,#06H
B3:009637 122084            LCALL    ?C?CSTOPTR
B3:00963A 1299E5            LCALL    ?L?COM0114
B3:00963D 12EF50            LCALL    ?L?COM0288
B3:009640 129969            LCALL    ?L?COM029E
B3:009643 7002              JNZ      $ + 4H
B3:009645 E14E              AJMP     ?C0136?S2
B3:009647 902E03            MOV      DPTR,#conn
B3:00964A 12707E            LCALL    ?L?COM00F2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 891


B3:00964D 125510            LCALL    ?L?COM000B
B3:009650 4402              ORL      A,#02H
B3:009652 122072            LCALL    ?C?CSTPTR
B3:009655 902E77            MOV      DPTR,#mpan
B3:009658 122589            LCALL    ?C?PLDXDATA
B3:00965B 900013            MOV      DPTR,#013H
B3:00965E 121FF0            LCALL    ?C?CLDOPTR
B3:009661 B40226            CJNE     A,#02H,?C0131?S2
B3:009664 902E03            MOV      DPTR,#conn
B3:009667 122589            LCALL    ?C?PLDXDATA
B3:00966A 902E9B            MOV      DPTR,#e
B3:00966D 1225A9            LCALL    ?C?PSTXDATA
B3:009670 902E77            MOV      DPTR,#mpan
B3:009673 122589            LCALL    ?C?PLDXDATA
B3:009676 AF01              MOV      R7,AR1
B3:009678 9020F1            MOV      DPTR,#the_context+0DEH
B3:00967B EA                MOV      A,R2
B3:00967C 12C404            LCALL    ?L?COM0127
B3:00967F 7A2E              MOV      R2,#HIGH e
B3:009681 799B              MOV      R1,#LOW e
B3:009683 7F07              MOV      R7,#07H
B3:009685 128E6A            LCALL    ___S2_fsm_post_event
B3:009688 E14E              AJMP     ?C0136?S2
B3:00968A         ?C0131?S2:
B3:00968A 12EF6F            LCALL    ?L?COM0380
B3:00968D 12E77B            LCALL    _next_mpan_state
B3:009690 E14E              AJMP     ?C0136?S2
B3:009692         ?C0128?S2:
B3:009692 902220            MOV      DPTR,#the_context+020DH
B3:009695 E0                MOVX     A,@DPTR
B3:009696 6003              JZ       $ + 5H
B3:009698 02986B            LJMP     auth_fail?S2
B3:00969B 129C67            LCALL    ?L?COM01CC
B3:00969E 121FF0            LCALL    ?C?CLDOPTR
B3:0096A1 6406              XRL      A,#06H
B3:0096A3 7003              JNZ      $ + 5H
B3:0096A5 02986B            LJMP     auth_fail?S2
B3:0096A8         ?C0133?S2:
B3:0096A8 900025            MOV      DPTR,#025H
B3:0096AB 7401              MOV      A,#01H
B3:0096AD 12203F            LCALL    ?C?CILDOPTR
B3:0096B0 1299E5            LCALL    ?L?COM0114
B3:0096B3 C3                CLR      C
B3:0096B4 9403              SUBB     A,#03H
B3:0096B6 4006              JC       ?C0135?S2
B3:0096B8 12C059            LCALL    ?L?COM0508
B3:0096BB 12F026            LCALL    ?L?COM0601
B3:0096BE         ?C0135?S2:
B3:0096BE 902E6A            MOV      DPTR,#ciphertext_len
B3:0096C1 E0                MOVX     A,@DPTR
B3:0096C2 FE                MOV      R6,A
B3:0096C3 A3                INC      DPTR
B3:0096C4 E0                MOVX     A,@DPTR
B3:0096C5 902E67            MOV      DPTR,#ciphertext
B3:0096C8 12708E            LCALL    ?L?COM0148
B3:0096CB 7A22              MOV      R2,#HIGH the_context+0211H
B3:0096CD 7924              MOV      R1,#LOW the_context+0211H
B3:0096CF 121F8D            LCALL    ?C?COPY
B3:0096D2 1299C9            LCALL    ?L?COM0111
B3:0096D5 12EF30            LCALL    ?L?COM022C
B3:0096D8 12C059            LCALL    ?L?COM0508
B3:0096DB 121B3D            LCALL    ?INTERBANK_TABLE?_next_nonce_instantiate
B3:0096DE 902E9A            MOV      DPTR,#i
B3:0096E1 E0                MOVX     A,@DPTR
B3:0096E2 04                INC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 892


B3:0096E3 F0                MOVX     @DPTR,A
B3:0096E4 E0                MOVX     A,@DPTR
B3:0096E5 C3                CLR      C
B3:0096E6 9403              SUBB     A,#03H
B3:0096E8 5002              JNC      $ + 4H
B3:0096EA A1E1              AJMP     ?C0125?S2
B3:0096EC 8060              SJMP     ?C0136?S2
B3:0096EE         ?C0123?S2:
B3:0096EE 12B529            LCALL    ?L?COM0334
B3:0096F1 121FF0            LCALL    ?C?CLDOPTR
B3:0096F4 12EF99            LCALL    ?L?COM03F0
B3:0096F7 C003              PUSH     AR3
B3:0096F9 C002              PUSH     AR2
B3:0096FB C001              PUSH     AR1
B3:0096FD 902E77            MOV      DPTR,#mpan
B3:009700 128518            LCALL    ?L?COM00FE
B3:009703 FA                MOV      R2,A
B3:009704 12EE4B            LCALL    ?L?COM051B
B3:009707 903EC9            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B3:00970A 12EF12            LCALL    ?L?COM01F1
B3:00970D D001              POP      AR1
B3:00970F D002              POP      AR2
B3:009711 D003              POP      AR3
B3:009713 12898D            LCALL    _ZW_AES_ecb
B3:009716 12EF6F            LCALL    ?L?COM0380
B3:009719 12E77B            LCALL    _next_mpan_state
B3:00971C 12B529            LCALL    ?L?COM0334
B3:00971F 121FF0            LCALL    ?C?CLDOPTR
B3:009722 12EE2C            LCALL    ?L?COM0206
B3:009725 C003              PUSH     AR3
B3:009727 C002              PUSH     AR2
B3:009729 C001              PUSH     AR1
B3:00972B 12E4D4            LCALL    ?L?COM00AF
B3:00972E 903415            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+010H
B3:009731 1224F1            LCALL    ?C?LSTXDATA
B3:009734 D001              POP      AR1
B3:009736 D002              POP      AR2
B3:009738 D003              POP      AR3
B3:00973A 121B1F            LCALL    ?INTERBANK_TABLE?_CCM_decrypt_and_auth
B3:00973D 902E6C            MOV      DPTR,#decrypt_len
B3:009740 EE                MOV      A,R6
B3:009741 F0                MOVX     @DPTR,A
B3:009742 A3                INC      DPTR
B3:009743 EF                MOV      A,R7
B3:009744 F0                MOVX     @DPTR,A
B3:009745 12B529            LCALL    ?L?COM0334
B3:009748 121FF0            LCALL    ?C?CLDOPTR
B3:00974B 12EF50            LCALL    ?L?COM0288
B3:00974E         ?C0136?S2:
B3:00974E 902E6C            MOV      DPTR,#decrypt_len
B3:009751 E0                MOVX     A,@DPTR
B3:009752 7002              JNZ      ?C0269?S2
B3:009754 A3                INC      DPTR
B3:009755 E0                MOVX     A,@DPTR
B3:009756         ?C0269?S2:
B3:009756 7003              JNZ      $ + 5H
B3:009758 02986B            LJMP     auth_fail?S2
B3:00975B 902E64            MOV      DPTR,#aad_len
B3:00975E E0                MOVX     A,@DPTR
B3:00975F 7002              JNZ      ?C0270?S2
B3:009761 A3                INC      DPTR
B3:009762 E0                MOVX     A,@DPTR
B3:009763         ?C0270?S2:
B3:009763 7003              JNZ      $ + 5H
B3:009765 02986B            LJMP     auth_fail?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 893


B3:009768         ?C0137?S2:
B3:009768 E4                CLR      A
B3:009769 902E72            MOV      DPTR,#hdr_len
B3:00976C F0                MOVX     @DPTR,A
B3:00976D A3                INC      DPTR
B3:00976E F0                MOVX     @DPTR,A
B3:00976F 902E66            MOV      DPTR,#flags
B3:009772 E0                MOVX     A,@DPTR
B3:009773 20E103            JB       ACC.1,$ + 6H
B3:009776 02982C            LJMP     ?C0139?S2
B3:009779 A3                INC      DPTR
B3:00977A 122589            LCALL    ?C?PLDXDATA
B3:00977D 902E6E            MOV      DPTR,#ext_data
B3:009780 1225A9            LCALL    ?C?PSTXDATA
B3:009783         ?C0142?S2:
B3:009783 12D1B4            LCALL    ?L?COM01D1
B3:009786 902E6C            MOV      DPTR,#decrypt_len
B3:009789 E0                MOVX     A,@DPTR
B3:00978A FE                MOV      R6,A
B3:00978B A3                INC      DPTR
B3:00978C E0                MOVX     A,@DPTR
B3:00978D FF                MOV      R7,A
B3:00978E D3                SETB     C
B3:00978F 902E73            MOV      DPTR,#hdr_len+01H
B3:009792 E0                MOVX     A,@DPTR
B3:009793 9F                SUBB     A,R7
B3:009794 902E72            MOV      DPTR,#hdr_len
B3:009797 E0                MOVX     A,@DPTR
B3:009798 9E                SUBB     A,R6
B3:009799 4003              JC       $ + 5H
B3:00979B 029868            LJMP     parse_fail?S2
B3:00979E 902E71            MOV      DPTR,#ext_len
B3:0097A1 E0                MOVX     A,@DPTR
B3:0097A2 FF                MOV      R7,A
B3:0097A3 7003              JNZ      $ + 5H
B3:0097A5 029868            LJMP     parse_fail?S2
B3:0097A8         ?C0143?S2:
B3:0097A8 5179              ACALL    ?L?COM0066
B3:0097AA 543F              ANL      A,#03FH
B3:0097AC 24FE              ADD      A,#0FEH
B3:0097AE 7061              JNZ      ?C0149?S2
B3:0097B0         ?C0146?S2:
B3:0097B0 EF                MOV      A,R7
B3:0097B1 6413              XRL      A,#013H
B3:0097B3 6003              JZ       $ + 5H
B3:0097B5 029868            LJMP     parse_fail?S2
B3:0097B8         ?C0147?S2:
B3:0097B8 902E03            MOV      DPTR,#conn
B3:0097BB 5176              ACALL    ?L?COM0065
B3:0097BD 12AB16            LCALL    ?L?COM010E
B3:0097C0 FD                MOV      R5,A
B3:0097C1 7B01              MOV      R3,#01H
B3:0097C3 12C08A            LCALL    ?L?COM0462
B3:0097C6 902E6E            MOV      DPTR,#ext_data
B3:0097C9 12707E            LCALL    ?L?COM00F2
B3:0097CC F9                MOV      R1,A
B3:0097CD E4                CLR      A
B3:0097CE 3A                ADDC     A,R2
B3:0097CF FA                MOV      R2,A
B3:0097D0 C003              PUSH     AR3
B3:0097D2 C002              PUSH     AR2
B3:0097D4 C001              PUSH     AR1
B3:0097D6 902E77            MOV      DPTR,#mpan
B3:0097D9 128518            LCALL    ?L?COM00FE
B3:0097DC A801              MOV      R0,AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 894


B3:0097DE FC                MOV      R4,A
B3:0097DF AD03              MOV      R5,AR3
B3:0097E1 D001              POP      AR1
B3:0097E3 D002              POP      AR2
B3:0097E5 D003              POP      AR3
B3:0097E7 12A7B3            LCALL    ?L?COM01B4
B3:0097EA 902E77            MOV      DPTR,#mpan
B3:0097ED 122589            LCALL    ?C?PLDXDATA
B3:0097F0 127223            LCALL    ?L?COM03EF
B3:0097F3 1299DF            LCALL    ?L?COM0112
B3:0097F6 FF                MOV      R7,A
B3:0097F7 12B529            LCALL    ?L?COM0334
B3:0097FA EF                MOV      A,R7
B3:0097FB 122084            LCALL    ?C?CSTOPTR
B3:0097FE 12919E            LCALL    ?L?COM004A
B3:009801 20E016            JB       ACC.0,?C0145?S2
B3:009804 E9                MOV      A,R1
B3:009805 2403              ADD      A,#03H
B3:009807 125510            LCALL    ?L?COM000B
B3:00980A 4402              ORL      A,#02H
B3:00980C 122072            LCALL    ?C?CSTPTR
B3:00980F 8009              SJMP     ?C0145?S2
B3:009811         ?C0149?S2:
B3:009811 902E6E            MOV      DPTR,#ext_data
B3:009814 129276            LCALL    ?L?COM0065
B3:009817 20E64E            JB       ACC.6,parse_fail?S2
B3:00981A         ?C0150?S2:
B3:00981A         ?C0145?S2:
B3:00981A 902E6E            MOV      DPTR,#ext_data
B3:00981D 129276            LCALL    ?L?COM0065
B3:009820 30E709            JNB      ACC.7,?C0139?S2
B3:009823 12F014            LCALL    ?L?COM059F
B3:009826 12D1C3            LCALL    ?L?COM01D2
B3:009829 029783            LJMP     ?C0142?S2
B3:00982C         ?C0139?S2:
B3:00982C 902E67            MOV      DPTR,#ciphertext
B3:00982F 122589            LCALL    ?C?PLDXDATA
B3:009832 902E72            MOV      DPTR,#hdr_len
B3:009835 127138            LCALL    ?L?COM02A0
B3:009838 C003              PUSH     AR3
B3:00983A C002              PUSH     AR2
B3:00983C C001              PUSH     AR1
B3:00983E 902E0B            MOV      DPTR,#plain_text
B3:009841 122589            LCALL    ?C?PLDXDATA
B3:009844 1225DE            LCALL    ?C?PSTPTR
B3:009847 902E72            MOV      DPTR,#hdr_len
B3:00984A 1265F9            LCALL    ?L?COM0199
B3:00984D 902E6D            MOV      DPTR,#decrypt_len+01H
B3:009850 E0                MOVX     A,@DPTR
B3:009851 9F                SUBB     A,R7
B3:009852 FF                MOV      R7,A
B3:009853 902E6C            MOV      DPTR,#decrypt_len
B3:009856 E0                MOVX     A,@DPTR
B3:009857 9E                SUBB     A,R6
B3:009858 FE                MOV      R6,A
B3:009859 902E0E            MOV      DPTR,#plain_text_len
B3:00985C 122589            LCALL    ?C?PLDXDATA
B3:00985F EE                MOV      A,R6
B3:009860 8FF0              MOV      B,R7
B3:009862 12221F            LCALL    ?C?ISTPTR
B3:009865 7F00              MOV      R7,#00H
B3:009867 22                RET      
B3:009868         parse_fail:
B3:009868 7F01              MOV      R7,#01H
B3:00986A 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 895


B3:00986B         auth_fail:
B3:00986B 3169              ACALL    ?L?COM029E
B3:00986D 600E              JZ       ?C0153?S2
B3:00986F 902E77            MOV      DPTR,#mpan
B3:009872 122589            LCALL    ?C?PLDXDATA
B3:009875 900013            MOV      DPTR,#013H
B3:009878 7402              MOV      A,#02H
B3:00987A 122084            LCALL    ?C?CSTOPTR
B3:00987D         ?C0153?S2:
B3:00987D 902E74            MOV      DPTR,#span
B3:009880 316C              ACALL    ?L?COM029F
B3:009882 6007              JZ       ?C0154?S2
B3:009884 9167              ACALL    ?L?COM01CC
B3:009886 7402              MOV      A,#02H
B3:009888 122084            LCALL    ?C?CSTOPTR
B3:00988B         ?C0154?S2:
B3:00988B 12919E            LCALL    ?L?COM004A
B3:00988E 20E017            JB       ACC.0,?C0155?S2
B3:009891 C003              PUSH     AR3
B3:009893 C002              PUSH     AR2
B3:009895 C001              PUSH     AR1
B3:009897 3169              ACALL    ?L?COM029E
B3:009899 7D01              MOV      R5,#01H
B3:00989B 6002              JZ       ?C0156?S2
B3:00989D 7D03              MOV      R5,#03H
B3:00989F         ?C0156?S2:
B3:00989F         ?C0157?S2:
B3:00989F D001              POP      AR1
B3:0098A1 D002              POP      AR2
B3:0098A3 D003              POP      AR3
B3:0098A5 12CA27            LCALL    ___S2_send_nonce_report
B3:0098A8         ?C0155?S2:
B3:0098A8 7F02              MOV      R7,#02H
B3:0098AA 22                RET      
----- FUNCTION ___S2_decrypt_msg (END) -------


----- FUNCTION ?L?COM00A0 (BEGIN) -----
B3:0098AB 90423C            MOV      DPTR,#d
B3:0098AE 122589            LCALL    ?C?PLDXDATA
B3:0098B1 900003            MOV      DPTR,#03H
B3:0098B4 12262D            LCALL    ?C?PLDOPTR
B3:0098B7 903FCF            MOV      DPTR,#?___S2_set_peer?BYTE+03H
B3:0098BA 1225A9            LCALL    ?C?PSTXDATA
B3:0098BD         ?L?COM00A1:
B3:0098BD 90423C            MOV      DPTR,#d
B3:0098C0         ?L?COM00A2:
B3:0098C0 122589            LCALL    ?C?PLDXDATA
B3:0098C3 900006            MOV      DPTR,#06H
B3:0098C6 02219A            LJMP     ?C?ILDOPTR
----- FUNCTION ?L?COM00A0 (END) -------


----- FUNCTION _secure_learn_entryaction (BEGIN) -----
B3:0098C9 22                RET      
----- FUNCTION _secure_learn_entryaction (END) -------


----- FUNCTION _sec2_send_data_multi (BEGIN) -----
B3:0098CA 903B49            MOV      DPTR,#vdata
B3:0098CD 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R4/R5' ----
B3:0098D0 903B4E            MOV      DPTR,#txOptionsMultiEx
B3:0098D3 122589            LCALL    ?C?PLDXDATA
B3:0098D6 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 896


B3:0098D7 2401              ADD      A,#01H
B3:0098D9 125510            LCALL    ?L?COM000B
B3:0098DC 903B53            MOV      DPTR,#s2_con
B3:0098DF F0                MOVX     @DPTR,A
B3:0098E0 903B4E            MOV      DPTR,#txOptionsMultiEx
B3:0098E3 122589            LCALL    ?C?PLDXDATA
B3:0098E6 121FB3            LCALL    ?C?CLDPTR
B3:0098E9 903B54            MOV      DPTR,#s2_con+01H
B3:0098EC F0                MOVX     @DPTR,A
B3:0098ED E4                CLR      A
B3:0098EE A3                INC      DPTR
B3:0098EF F0                MOVX     @DPTR,A
B3:0098F0 E9                MOV      A,R1
B3:0098F1 2402              ADD      A,#02H
B3:0098F3 125510            LCALL    ?L?COM000B
B3:0098F6 903B57            MOV      DPTR,#s2_con+04H
B3:0098F9 F0                MOVX     @DPTR,A
B3:0098FA 903B4E            MOV      DPTR,#txOptionsMultiEx
B3:0098FD 12707E            LCALL    ?L?COM00F2
B3:009900 125510            LCALL    ?L?COM000B
B3:009903 14                DEC      A
B3:009904 903B5A            MOV      DPTR,#s2_con+07H
B3:009907 F0                MOVX     @DPTR,A
B3:009908 9034FF            MOV      DPTR,#s2_send_multi_callback
B3:00990B E0                MOVX     A,@DPTR
B3:00990C FF                MOV      R7,A
B3:00990D A3                INC      DPTR
B3:00990E E0                MOVX     A,@DPTR
B3:00990F 903504            MOV      DPTR,#cb_multi_save
B3:009912 CF                XCH      A,R7
B3:009913 F0                MOVX     @DPTR,A
B3:009914 A3                INC      DPTR
B3:009915 EF                MOV      A,R7
B3:009916 F0                MOVX     @DPTR,A
B3:009917 903B51            MOV      DPTR,#callback
B3:00991A D137              ACALL    ?L?COM046A
B3:00991C 903B49            MOV      DPTR,#vdata
B3:00991F 122589            LCALL    ?C?PLDXDATA
B3:009922 903BD5            MOV      DPTR,#?___S2_send_data_multicast?BYTE+03H
B3:009925 1225A9            LCALL    ?C?PSTXDATA
B3:009928 903BD8            MOV      DPTR,#?___S2_send_data_multicast?BYTE+06H
B3:00992B 12C401            LCALL    ?L?COM0125
B3:00992E 7A3B              MOV      R2,#HIGH s2_con
B3:009930 7953              MOV      R1,#LOW s2_con
B3:009932 12E862            LCALL    ___S2_send_data_multicast
B3:009935 EF                MOV      A,R7
B3:009936 6003              JZ       ?C0023?ZW_SECURITY_SCHEME2
B3:009938 7F01              MOV      R7,#01H
B3:00993A 22                RET      
B3:00993B         ?C0023?ZW_SECURITY_SCHEME2:
B3:00993B 903504            MOV      DPTR,#cb_multi_save
B3:00993E D137              ACALL    ?L?COM046A
B3:009940         ?C0025?ZW_SECURITY_SCHEME2:
B3:009940 7F00              MOV      R7,#00H
B3:009942 22                RET      
----- FUNCTION _sec2_send_data_multi (END) -------


----- FUNCTION sec2_init (BEGIN) -----
B3:009943 12A740            LCALL    S2_init_prng
B3:009946 901223            MOV      DPTR,#homeID
B3:009949 122499            LCALL    ?C?LLDXDATA
B3:00994C D1A7              ACALL    _S2_init_ctx
B3:00994E 903501            MOV      DPTR,#s2_ctx
B3:009951 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 897


B3:009954 12A797            LCALL    s2_restore_spans_and_mpans
B3:009957 7E1C              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_s2_evt_handler
B3:009959 7FB9              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_s2_evt_handler
B3:00995B 12E8B1            LCALL    _s2_inclusion_set_event_handler
B3:00995E 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B3:009961 EF                MOV      A,R7
B3:009962 5407              ANL      A,#07H
B3:009964 C3                CLR      C
B3:009965 6001              JZ       ?C0001?ZW_SECURITY_SCHEME2
B3:009967 D3                SETB     C
B3:009968         ?C0001?ZW_SECURITY_SCHEME2:
B3:009968 22                RET      
----- FUNCTION sec2_init (END) -------


----- FUNCTION ?L?COM029E (BEGIN) -----
B3:009969 902E77            MOV      DPTR,#mpan
B3:00996C         ?L?COM029F:
B3:00996C 122589            LCALL    ?C?PLDXDATA
B3:00996F EA                MOV      A,R2
B3:009970 49                ORL      A,R1
B3:009971 4B                ORL      A,R3
B3:009972 22                RET      
----- FUNCTION ?L?COM029E (END) -------


----- FUNCTION sec0_state (BEGIN) -----
B3:009973 121AFC            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B3:009976 EF                MOV      A,R7
B3:009977 30E74C            JNB      ACC.7,?C0123?ZW_SECURITY_SCHEME0
B3:00997A E4                CLR      A
B3:00997B 90438A            MOV      DPTR,#i
B3:00997E F0                MOVX     @DPTR,A
B3:00997F         ?C0124?ZW_SECURITY_SCHEME0:
B3:00997F 90438A            MOV      DPTR,#i
B3:009982 E0                MOVX     A,@DPTR
B3:009983 FF                MOV      R7,A
B3:009984 C3                CLR      C
B3:009985 9402              SUBB     A,#02H
B3:009987 5015              JNC      ?C0125?ZW_SECURITY_SCHEME0
B3:009989 D144              ACALL    ?L?COM01D3
B3:00998B 7B01              MOV      R3,#01H
;---- Variable 'e' assigned to Register 'R1/R2/R3' ----
B3:00998D 12DC33            LCALL    _is_free
B3:009990 EF                MOV      A,R7
B3:009991 7003              JNZ      ?C0126?ZW_SECURITY_SCHEME0
B3:009993 7F02              MOV      R7,#02H
B3:009995 22                RET      
B3:009996         ?C0126?ZW_SECURITY_SCHEME0:
B3:009996 90438A            MOV      DPTR,#i
B3:009999 E0                MOVX     A,@DPTR
B3:00999A 04                INC      A
B3:00999B F0                MOVX     @DPTR,A
B3:00999C 80E1              SJMP     ?C0124?ZW_SECURITY_SCHEME0
B3:00999E         ?C0125?ZW_SECURITY_SCHEME0:
B3:00999E 90259D            MOV      DPTR,#the_tx_session
B3:0099A1 E0                MOVX     A,@DPTR
B3:0099A2 6003              JZ       ?C0129?ZW_SECURITY_SCHEME0
B3:0099A4 7F03              MOV      R7,#03H
B3:0099A6 22                RET      
B3:0099A7         ?C0129?ZW_SECURITY_SCHEME0:
B3:0099A7 E4                CLR      A
B3:0099A8 90438A            MOV      DPTR,#i
B3:0099AB F0                MOVX     @DPTR,A
B3:0099AC         ?C0130?ZW_SECURITY_SCHEME0:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 898


B3:0099AC 90438A            MOV      DPTR,#i
B3:0099AF E0                MOVX     A,@DPTR
B3:0099B0 FF                MOV      R7,A
B3:0099B1 C3                CLR      C
B3:0099B2 940F              SUBB     A,#0FH
B3:0099B4 5010              JNC      ?C0123?ZW_SECURITY_SCHEME0
B3:0099B6 D152              ACALL    ?L?COM00D6
B3:0099B8 E0                MOVX     A,@DPTR
B3:0099B9 6003              JZ       ?C0132?ZW_SECURITY_SCHEME0
B3:0099BB 7F01              MOV      R7,#01H
B3:0099BD 22                RET      
B3:0099BE         ?C0132?ZW_SECURITY_SCHEME0:
B3:0099BE 90438A            MOV      DPTR,#i
B3:0099C1 E0                MOVX     A,@DPTR
B3:0099C2 04                INC      A
B3:0099C3 F0                MOVX     @DPTR,A
B3:0099C4 80E6              SJMP     ?C0130?ZW_SECURITY_SCHEME0
B3:0099C6         ?C0123?ZW_SECURITY_SCHEME0:
B3:0099C6 7F00              MOV      R7,#00H
B3:0099C8 22                RET      
----- FUNCTION sec0_state (END) -------


----- FUNCTION ?L?COM0111 (BEGIN) -----
B3:0099C9 7B01              MOV      R3,#01H
B3:0099CB 7A2E              MOV      R2,#HIGH s_nonce
B3:0099CD 798A              MOV      R1,#LOW s_nonce
B3:0099CF 903134            MOV      DPTR,#?_next_nonce_instantiate?BYTE+03H
B3:0099D2 1225A9            LCALL    ?C?PSTXDATA
B3:0099D5 7A2E              MOV      R2,#HIGH r_nonce
B3:0099D7 797A              MOV      R1,#LOW r_nonce
B3:0099D9 903137            MOV      DPTR,#?_next_nonce_instantiate?BYTE+06H
B3:0099DC 1225A9            LCALL    ?C?PSTXDATA
B3:0099DF         ?L?COM0112:
B3:0099DF 902E74            MOV      DPTR,#span
B3:0099E2         ?L?COM0113:
B3:0099E2 122589            LCALL    ?C?PLDXDATA
B3:0099E5         ?L?COM0114:
B3:0099E5 900025            MOV      DPTR,#025H
B3:0099E8 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0111 (END) -------


----- FUNCTION ?L?COM0305 (BEGIN) -----
B3:0099EB 7B01              MOV      R3,#01H
B3:0099ED 7D10              MOV      R5,#010H
----- FUNCTION ___ZW_memset (BEGIN) -----
;---- Variable 'val' assigned to Register 'R7' ----
;---- Variable 'dst' assigned to Register 'R1/R2/R3' ----
;---- Variable 'length' assigned to Register 'R5' ----
B3:0099EF         ?C0001?ZW_MEM:
B3:0099EF AE05              MOV      R6,AR5
B3:0099F1 1D                DEC      R5
B3:0099F2 EE                MOV      A,R6
B3:0099F3 6009              JZ       ?C0003?ZW_MEM
B3:0099F5 EF                MOV      A,R7
B3:0099F6 122072            LCALL    ?C?CSTPTR
B3:0099F9 12D1DB            LCALL    ?L?COM0614
B3:0099FC 80F1              SJMP     ?C0001?ZW_MEM
B3:0099FE         ?C0003?ZW_MEM:
B3:0099FE 22                RET      
----- FUNCTION ___ZW_memset (END) -------


----- FUNCTION ExploreStateTransmit (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 899


B3:0099FF E553              MOV      A,bExploreEvent
B3:009A01 6002              JZ       $ + 4H
B3:009A03 41BF              AJMP     ?C0029?ZW_EXPLORE
B3:009A05         ?C0022?ZW_EXPLORE:
B3:009A05 51C3              ACALL    ?L?COM009A
B3:009A07 2404              ADD      A,#04H
B3:009A09 125510            LCALL    ?L?COM000B
B3:009A0C 30E61E            JNB      ACC.6,?C0023?ZW_EXPLORE
B3:009A0F 51C3              ACALL    ?L?COM009A
B3:009A11 2407              ADD      A,#07H
B3:009A13 F9                MOV      R1,A
B3:009A14 E4                CLR      A
B3:009A15 3A                ADDC     A,R2
B3:009A16 FA                MOV      R2,A
B3:009A17 E4                CLR      A
B3:009A18 75F064            MOV      B,#064H
B3:009A1B 12221F            LCALL    ?C?ISTPTR
B3:009A1E 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009A21 122589            LCALL    ?C?PLDXDATA
B3:009A24 7406              MOV      A,#06H
B3:009A26 122072            LCALL    ?C?CSTPTR
B3:009A29 C208              CLR      currentSeqNoUseTX
B3:009A2B 8049              SJMP     ?C0024?ZW_EXPLORE
B3:009A2D         ?C0023?ZW_EXPLORE:
B3:009A2D 51C3              ACALL    ?L?COM009A
B3:009A2F 2405              ADD      A,#05H
B3:009A31 125510            LCALL    ?L?COM000B
B3:009A34 4420              ORL      A,#020H
B3:009A36 FF                MOV      R7,A
B3:009A37 51C3              ACALL    ?L?COM009A
B3:009A39 2429              ADD      A,#029H
B3:009A3B F9                MOV      R1,A
B3:009A3C E4                CLR      A
B3:009A3D 3A                ADDC     A,R2
B3:009A3E FA                MOV      R2,A
B3:009A3F EF                MOV      A,R7
B3:009A40 51C0              ACALL    ?L?COM0099
B3:009A42 242C              ADD      A,#02CH
B3:009A44 F9                MOV      R1,A
B3:009A45 E4                CLR      A
B3:009A46 3A                ADDC     A,R2
B3:009A47 FA                MOV      R2,A
B3:009A48 7440              MOV      A,#040H
B3:009A4A 51C0              ACALL    ?L?COM0099
B3:009A4C 12730C            LCALL    ?L?COM04C1
B3:009A4F 31EF              ACALL    ___ZW_memset
B3:009A51 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009A54 122589            LCALL    ?C?PLDXDATA
B3:009A57 7405              MOV      A,#05H
B3:009A59 51C0              ACALL    ?L?COM0099
B3:009A5B 2404              ADD      A,#04H
B3:009A5D 125510            LCALL    ?L?COM000B
B3:009A60 30E306            JNB      ACC.3,?C0025?ZW_EXPLORE
B3:009A63 7E03              MOV      R6,#03H
B3:009A65 7FE8              MOV      R7,#0E8H
B3:009A67 8004              SJMP     ?C0026?ZW_EXPLORE
B3:009A69         ?C0025?ZW_EXPLORE:
B3:009A69 7E07              MOV      R6,#07H
B3:009A6B 7FD0              MOV      R7,#0D0H
B3:009A6D         ?C0026?ZW_EXPLORE:
B3:009A6D 51C3              ACALL    ?L?COM009A
B3:009A6F 9171              ACALL    ?L?COM0327
B3:009A71 12221F            LCALL    ?C?ISTPTR
B3:009A74 D208              SETB     currentSeqNoUseTX
B3:009A76         ?C0024?ZW_EXPLORE:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 900


B3:009A76 51C3              ACALL    ?L?COM009A
B3:009A78 2402              ADD      A,#02H
B3:009A7A 125510            LCALL    ?L?COM000B
B3:009A7D FF                MOV      R7,A
B3:009A7E 51C3              ACALL    ?L?COM009A
B3:009A80 2403              ADD      A,#03H
B3:009A82 125510            LCALL    ?L?COM000B
B3:009A85 FD                MOV      R5,A
B3:009A86 51C3              ACALL    ?L?COM009A
B3:009A88 1272B2            LCALL    ?L?COM0448
B3:009A8B C003              PUSH     AR3
B3:009A8D C002              PUSH     AR2
B3:009A8F C001              PUSH     AR1
B3:009A91 51C3              ACALL    ?L?COM009A
B3:009A93 2406              ADD      A,#06H
B3:009A95 125510            LCALL    ?L?COM000B
B3:009A98 900A1F            MOV      DPTR,#?_TransportEnQueueExploreFrame?BYTE+05H
B3:009A9B F0                MOVX     @DPTR,A
B3:009A9C 51C3              ACALL    ?L?COM009A
B3:009A9E 2404              ADD      A,#04H
B3:009AA0 125510            LCALL    ?L?COM000B
B3:009AA3 54F7              ANL      A,#0F7H
B3:009AA5 900A20            MOV      DPTR,#?_TransportEnQueueExploreFrame?BYTE+06H
B3:009AA8 F0                MOVX     @DPTR,A
B3:009AA9 A3                INC      DPTR
B3:009AAA 741B              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ExploreComplete
B3:009AAC F0                MOVX     @DPTR,A
B3:009AAD A3                INC      DPTR
B3:009AAE 74B5              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ExploreComplete
B3:009AB0 F0                MOVX     @DPTR,A
B3:009AB1 D001              POP      AR1
B3:009AB3 D002              POP      AR2
B3:009AB5 D003              POP      AR3
B3:009AB7 121967            LCALL    ?INTERBANK_TABLE?_TransportEnQueueExploreFrame
B3:009ABA EF                MOV      A,R7
B3:009ABB 7002              JNZ      ?C0029?ZW_EXPLORE
B3:009ABD D19C              ACALL    ?L?COM0370
B3:009ABF         ?C0029?ZW_EXPLORE:
B3:009ABF 22                RET      
----- FUNCTION ExploreStateTransmit (END) -------


----- FUNCTION ?L?COM0099 (BEGIN) -----
B3:009AC0 122072            LCALL    ?C?CSTPTR
B3:009AC3         ?L?COM009A:
B3:009AC3 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009AC6 122589            LCALL    ?C?PLDXDATA
B3:009AC9 E9                MOV      A,R1
B3:009ACA 22                RET      
----- FUNCTION ?L?COM0099 (END) -------


----- FUNCTION ExploreMachine (BEGIN) -----
B3:009ACB 7F53              MOV      R7,#LOW bExploreEvent
B3:009ACD 7D54              MOV      R5,#LOW bExploreStatus
B3:009ACF 12D150            LCALL    _EventPop
B3:009AD2 E553              MOV      A,bExploreEvent
B3:009AD4 14                DEC      A
B3:009AD5 7003              JNZ      ?C0053?ZW_EXPLORE
B3:009AD7         ?C0054?ZW_EXPLORE:
B3:009AD7 12D1EF            LCALL    ExploreFrameIgnoreTick
B3:009ADA         ?C0053?ZW_EXPLORE:
B3:009ADA E4                CLR      A
B3:009ADB F552              MOV      bExploreQueueIndex,A
B3:009ADD         ?C0056?ZW_EXPLORE:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 901


B3:009ADD 12EF5E            LCALL    ?L?COM02A4
B3:009AE0 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009AE3 1225A9            LCALL    ?C?PSTXDATA
B3:009AE6 121FB3            LCALL    ?C?CLDPTR
B3:009AE9 24FE              ADD      A,#0FEH
B3:009AEB 6015              JZ       ?C0061?ZW_EXPLORE
B3:009AED 24FE              ADD      A,#0FEH
B3:009AEF 6015              JZ       ?C0062?ZW_EXPLORE
B3:009AF1 14                DEC      A
B3:009AF2 6016              JZ       ?C0063?ZW_EXPLORE
B3:009AF4 14                DEC      A
B3:009AF5 6017              JZ       ?C0064?ZW_EXPLORE
B3:009AF7 14                DEC      A
B3:009AF8 6018              JZ       ?C0065?ZW_EXPLORE
B3:009AFA 2406              ADD      A,#06H
B3:009AFC 7071              JNZ      ?C0058?ZW_EXPLORE
B3:009AFE         ?C0060?ZW_EXPLORE:
B3:009AFE 9101              ACALL    ExploreStateNew
B3:009B00 806D              SJMP     ?C0058?ZW_EXPLORE
B3:009B02         ?C0061?ZW_EXPLORE:
B3:009B02 D171              ACALL    ExploreStateDelayed
B3:009B04 8069              SJMP     ?C0058?ZW_EXPLORE
B3:009B06         ?C0062?ZW_EXPLORE:
B3:009B06 31FF              ACALL    ExploreStateTransmit
B3:009B08 8065              SJMP     ?C0058?ZW_EXPLORE
B3:009B0A         ?C0063?ZW_EXPLORE:
B3:009B0A 7188              ACALL    ExploreStateSearch
B3:009B0C 8061              SJMP     ?C0058?ZW_EXPLORE
B3:009B0E         ?C0064?ZW_EXPLORE:
B3:009B0E D186              ACALL    ExploreStateRepeat
B3:009B10 805D              SJMP     ?C0058?ZW_EXPLORE
B3:009B12         ?C0065?ZW_EXPLORE:
B3:009B12 51C3              ACALL    ?L?COM009A
B3:009B14 241E              ADD      A,#01EH
B3:009B16 127060            LCALL    ?L?COM00DC
B3:009B19 45F0              ORL      A,B
B3:009B1B 604A              JZ       ?C0066?ZW_EXPLORE
B3:009B1D E553              MOV      A,bExploreEvent
B3:009B1F 6404              XRL      A,#04H
B3:009B21 6009              JZ       ?C0067?ZW_EXPLORE
B3:009B23 51C3              ACALL    ?L?COM009A
B3:009B25 2401              ADD      A,#01H
B3:009B27 125510            LCALL    ?L?COM000B
B3:009B2A F554              MOV      bExploreStatus,A
B3:009B2C         ?C0067?ZW_EXPLORE:
B3:009B2C 51C3              ACALL    ?L?COM009A
B3:009B2E 2409              ADD      A,#09H
B3:009B30 127060            LCALL    ?L?COM00DC
B3:009B33 FF                MOV      R7,A
B3:009B34 AEF0              MOV      R6,B
B3:009B36 1251F8            LCALL    _getTickTimePassed
B3:009B39 51C3              ACALL    ?L?COM009A
B3:009B3B 240B              ADD      A,#0BH
B3:009B3D 9173              ACALL    ?L?COM0328
B3:009B3F 12221F            LCALL    ?C?ISTPTR
B3:009B42 C003              PUSH     AR3
B3:009B44 C002              PUSH     AR2
B3:009B46 C001              PUSH     AR1
B3:009B48 51C3              ACALL    ?L?COM009A
B3:009B4A 241E              ADD      A,#01EH
B3:009B4C 127060            LCALL    ?L?COM00DC
B3:009B4F F582              MOV      DPL,A
B3:009B51 85F083            MOV      DPH,B
B3:009B54 D001              POP      AR1
B3:009B56 D002              POP      AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 902


B3:009B58 D003              POP      AR3
B3:009B5A AF54              MOV      R7,bExploreStatus
B3:009B5C 12271A            LCALL    ?C?ICALL2
B3:009B5F 51C3              ACALL    ?L?COM009A
B3:009B61 12C909            LCALL    ?L?COM040B
B3:009B64 12221F            LCALL    ?C?ISTPTR
B3:009B67         ?C0066?ZW_EXPLORE:
B3:009B67 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009B6A 127111            LCALL    ?L?COM0287
B3:009B6D C20E              CLR      bExploreSlotTaken
B3:009B6F         ?C0058?ZW_EXPLORE:
B3:009B6F 0552              INC      bExploreQueueIndex
B3:009B71 E552              MOV      A,bExploreQueueIndex
B3:009B73 C3                CLR      C
B3:009B74 9402              SUBB     A,#02H
B3:009B76 5002              JNC      $ + 4H
B3:009B78 41DD              AJMP     ?C0056?ZW_EXPLORE
B3:009B7A         ?C0057?ZW_EXPLORE:
B3:009B7A E551              MOV      A,bCurrentExploreTimerTicks
B3:009B7C 6009              JZ       ?C0070?ZW_EXPLORE
B3:009B7E FD                MOV      R5,A
B3:009B7F 7F01              MOV      R7,#01H
B3:009B81 12D11D            LCALL    _EventPush
B3:009B84 E4                CLR      A
B3:009B85 F551              MOV      bCurrentExploreTimerTicks,A
B3:009B87         ?C0070?ZW_EXPLORE:
B3:009B87 22                RET      
----- FUNCTION ExploreMachine (END) -------


----- FUNCTION ExploreStateSearch (BEGIN) -----
B3:009B88 E553              MOV      A,bExploreEvent
B3:009B8A 24FD              ADD      A,#0FDH
B3:009B8C 6055              JZ       ?C0036?ZW_EXPLORE
B3:009B8E 14                DEC      A
B3:009B8F 6014              JZ       ?C0033?ZW_EXPLORE
B3:009B91 2403              ADD      A,#03H
B3:009B93 706B              JNZ      ?C0039?ZW_EXPLORE
B3:009B95         ?C0031?ZW_EXPLORE:
B3:009B95 919B              ACALL    ExploreCheckDelayCountTimeout
B3:009B97 5067              JNC      ?C0039?ZW_EXPLORE
B3:009B99 C20D              CLR      searchResultNeeded
B3:009B9B 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009B9E 12EEE6            LCALL    ?L?COM007D
B3:009BA1 7401              MOV      A,#01H
B3:009BA3 8056              SJMP     ?C0146?ZW_EXPLORE
B3:009BA5         ?C0033?ZW_EXPLORE:
B3:009BA5 51C3              ACALL    ?L?COM009A
B3:009BA7 240B              ADD      A,#0BH
B3:009BA9 F9                MOV      R1,A
B3:009BAA E4                CLR      A
B3:009BAB 3A                ADDC     A,R2
B3:009BAC FA                MOV      R2,A
B3:009BAD C003              PUSH     AR3
B3:009BAF C002              PUSH     AR2
B3:009BB1 C001              PUSH     AR1
B3:009BB3 7B01              MOV      R3,#01H
B3:009BB5 7A09              MOV      R2,#HIGH currentTxStatusReport
B3:009BB7 79A4              MOV      R1,#LOW currentTxStatusReport
B3:009BB9 126149            LCALL    ?L?COM0047
B3:009BBC D001              POP      AR1
B3:009BBE D002              POP      AR2
B3:009BC0 D003              POP      AR3
B3:009BC2 7F13              MOV      R7,#013H
B3:009BC4 1280A2            LCALL    ___ZW_memcpy
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 903


B3:009BC7 51C3              ACALL    ?L?COM009A
B3:009BC9 2404              ADD      A,#04H
B3:009BCB 125510            LCALL    ?L?COM000B
B3:009BCE 5409              ANL      A,#09H
B3:009BD0 7002              JNZ      ?C0034?ZW_EXPLORE
B3:009BD2 802A              SJMP     ?C0147?ZW_EXPLORE
B3:009BD4         ?C0034?ZW_EXPLORE:
B3:009BD4 901222            MOV      DPTR,#rfRxCurrentCh
B3:009BD7 E0                MOVX     A,@DPTR
B3:009BD8 FF                MOV      R7,A
B3:009BD9 51C3              ACALL    ?L?COM009A
B3:009BDB 2413              ADD      A,#013H
B3:009BDD 128483            LCALL    ?L?COM00C8
B3:009BE0 D20D              SETB     searchResultNeeded
B3:009BE2 22                RET      
B3:009BE3         ?C0036?ZW_EXPLORE:
B3:009BE3 51C3              ACALL    ?L?COM009A
B3:009BE5 2403              ADD      A,#03H
B3:009BE7 125510            LCALL    ?L?COM000B
B3:009BEA B55413            CJNE     A,bExploreStatus,?C0039?ZW_EXPLORE
B3:009BED 901222            MOV      DPTR,#rfRxCurrentCh
B3:009BF0 E0                MOVX     A,@DPTR
B3:009BF1 FF                MOV      R7,A
B3:009BF2 51C3              ACALL    ?L?COM009A
B3:009BF4 2413              ADD      A,#013H
B3:009BF6 F9                MOV      R1,A
B3:009BF7 E4                CLR      A
B3:009BF8 3A                ADDC     A,R2
B3:009BF9 FA                MOV      R2,A
B3:009BFA EF                MOV      A,R7
B3:009BFB         
B3:009BFB 122072            LCALL    ?C?CSTPTR
B3:009BFE         
B3:009BFE D19C              ACALL    ?L?COM0370
B3:009C00         ?C0039?ZW_EXPLORE:
B3:009C00 22                RET      
----- FUNCTION ExploreStateSearch (END) -------


----- FUNCTION ExploreStateNew (BEGIN) -----
B3:009C01 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009C04 122589            LCALL    ?C?PLDXDATA
B3:009C07 E4                CLR      A
B3:009C08 51C0              ACALL    ?L?COM0099
B3:009C0A 2405              ADD      A,#05H
B3:009C0C 125510            LCALL    ?L?COM000B
B3:009C0F 14                DEC      A
B3:009C10 6003              JZ       ?C0007?ZW_EXPLORE
B3:009C12 04                INC      A
B3:009C13 7051              JNZ      ?C0011?ZW_EXPLORE
B3:009C15         ?C0007?ZW_EXPLORE:
B3:009C15 51C3              ACALL    ?L?COM009A
B3:009C17 242C              ADD      A,#02CH
B3:009C19 125510            LCALL    ?L?COM000B
B3:009C1C 540F              ANL      A,#0FH
B3:009C1E 900B0D            MOV      DPTR,#bHops
B3:009C21 F0                MOVX     @DPTR,A
B3:009C22 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009C25 602B              JZ       ?C0008?ZW_EXPLORE
B3:009C27 122589            LCALL    ?C?PLDXDATA
B3:009C2A E9                MOV      A,R1
B3:009C2B 242B              ADD      A,#02BH
B3:009C2D 125510            LCALL    ?L?COM000B
B3:009C30 FF                MOV      R7,A
B3:009C31 1248BE            LCALL    _GetRandom
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 904


B3:009C34 EF                MOV      A,R7
B3:009C35 FD                MOV      R5,A
B3:009C36 900B0D            MOV      DPTR,#bHops
B3:009C39 E0                MOVX     A,@DPTR
B3:009C3A 14                DEC      A
B3:009C3B F0                MOVX     @DPTR,A
B3:009C3C 75F064            MOV      B,#064H
B3:009C3F A4                MUL      AB
B3:009C40 2419              ADD      A,#019H
B3:009C42 FF                MOV      R7,A
B3:009C43 E4                CLR      A
B3:009C44 35F0              ADDC     A,B
B3:009C46 CF                XCH      A,R7
B3:009C47 2D                ADD      A,R5
B3:009C48 CF                XCH      A,R7
B3:009C49 3400              ADDC     A,#00H
B3:009C4B FE                MOV      R6,A
B3:009C4C 51C3              ACALL    ?L?COM009A
B3:009C4E 9171              ACALL    ?L?COM0327
B3:009C50 8006              SJMP     ?C0144?ZW_EXPLORE
B3:009C52         ?C0008?ZW_EXPLORE:
B3:009C52 127077            LCALL    ?L?COM00E7
B3:009C55 12C90B            LCALL    ?L?COM040C
B3:009C58         
B3:009C58 12221F            LCALL    ?C?ISTPTR
B3:009C5B         ?C0009?ZW_EXPLORE:
B3:009C5B 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009C5E 122589            LCALL    ?C?PLDXDATA
B3:009C61 7402              MOV      A,#02H
B3:009C63 122072            LCALL    ?C?CSTPTR
B3:009C66         ?C0011?ZW_EXPLORE:
B3:009C66 22                RET      
----- FUNCTION ExploreStateNew (END) -------


----- FUNCTION ?L?COM01CC (BEGIN) -----
B3:009C67 902E74            MOV      DPTR,#span
B3:009C6A         ?L?COM01CD:
B3:009C6A 122589            LCALL    ?C?PLDXDATA
B3:009C6D 900026            MOV      DPTR,#026H
B3:009C70 22                RET      
----- FUNCTION ?L?COM01CC (END) -------


----- FUNCTION ?L?COM0327 (BEGIN) -----
B3:009C71 2407              ADD      A,#07H
B3:009C73         ?L?COM0328:
B3:009C73 F9                MOV      R1,A
B3:009C74 E4                CLR      A
B3:009C75 3A                ADDC     A,R2
B3:009C76 FA                MOV      R2,A
B3:009C77 EE                MOV      A,R6
B3:009C78 8FF0              MOV      B,R7
B3:009C7A 22                RET      
----- FUNCTION ?L?COM0327 (END) -------


----- FUNCTION discard_all_received_fragments (BEGIN) -----
B3:009C7B 12BA26            LCALL    ?L?COM043E
B3:009C7E 7DC8              MOV      R5,#0C8H
B3:009C80 1271C2            LCALL    ?L?COM036D
B3:009C83 7A28              MOV      R2,#HIGH rcb
B3:009C85 7989              MOV      R1,#LOW rcb
B3:009C87 7D1E              MOV      R5,#01EH
B3:009C89 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 905


B3:009C8A 12ED92            LCALL    ?L?COM042C
B3:009C8D 12EDCD            LCALL    ?L?COM0576
B3:009C90 E4                CLR      A
B3:009C91 FF                MOV      R7,A
B3:009C92 31EF              ACALL    ___ZW_memset
B3:009C94 E4                CLR      A
B3:009C95 9029A7            MOV      DPTR,#rcb+011EH
B3:009C98 F0                MOVX     @DPTR,A
B3:009C99 FF                MOV      R7,A
B3:009C9A 22                RET      
----- FUNCTION discard_all_received_fragments (END) -------


----- FUNCTION ExploreCheckDelayCountTimeout (BEGIN) -----
B3:009C9B 51C3              ACALL    ?L?COM009A
B3:009C9D 2407              ADD      A,#07H
B3:009C9F 127060            LCALL    ?L?COM00DC
B3:009CA2 FF                MOV      R7,A
B3:009CA3 AEF0              MOV      R6,B
B3:009CA5 AD54              MOV      R5,bExploreStatus
B3:009CA7 7C00              MOV      R4,#00H
B3:009CA9 D3                SETB     C
B3:009CAA 9D                SUBB     A,R5
B3:009CAB EE                MOV      A,R6
B3:009CAC 9C                SUBB     A,R4
B3:009CAD 4009              JC       ?C0012?ZW_EXPLORE
B3:009CAF EF                MOV      A,R7
B3:009CB0 9D                SUBB     A,R5
B3:009CB1 FF                MOV      R7,A
B3:009CB2 EE                MOV      A,R6
B3:009CB3 9C                SUBB     A,R4
B3:009CB4 8FF0              MOV      B,R7
B3:009CB6 8003              SJMP     ?C0145?ZW_EXPLORE
B3:009CB8         ?C0012?ZW_EXPLORE:
B3:009CB8 E4                CLR      A
B3:009CB9 F5F0              MOV      B,A
B3:009CBB         
B3:009CBB 12221F            LCALL    ?C?ISTPTR
B3:009CBE         ?C0013?ZW_EXPLORE:
B3:009CBE 51C3              ACALL    ?L?COM009A
B3:009CC0 2407              ADD      A,#07H
B3:009CC2 127060            LCALL    ?L?COM00DC
B3:009CC5 45F0              ORL      A,B
B3:009CC7 24FF              ADD      A,#0FFH
B3:009CC9 B3                CPL      C
B3:009CCA 22                RET      
----- FUNCTION ExploreCheckDelayCountTimeout (END) -------


----- FUNCTION sec0_unpersist_netkey (BEGIN) -----
B3:009CCB 903B8E            MOV      DPTR,#retVal
B3:009CCE 7401              MOV      A,#01H
B3:009CD0 F0                MOVX     @DPTR,A
B3:009CD1 FB                MOV      R3,A
B3:009CD2 7A24              MOV      R2,#HIGH aes_key
B3:009CD4 7983              MOV      R1,#LOW aes_key
B3:009CD6 7F80              MOV      R7,#080H
B3:009CD8 121AE8            LCALL    ?INTERBANK_TABLE?_keystore_network_key_read
B3:009CDB EF                MOV      A,R7
B3:009CDC 700C              JNZ      ?C0042?ZW_SECURITY_SCHEME0
B3:009CDE 7A24              MOV      R2,#HIGH aes_key
B3:009CE0 7983              MOV      R1,#LOW aes_key
B3:009CE2 FF                MOV      R7,A
B3:009CE3 31EB              ACALL    ?L?COM0305
B3:009CE5 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 906


B3:009CE6 903B8E            MOV      DPTR,#retVal
B3:009CE9 F0                MOVX     @DPTR,A
B3:009CEA         ?C0042?ZW_SECURITY_SCHEME0:
B3:009CEA 7A3B              MOV      R2,#HIGH p
B3:009CEC 797E              MOV      R1,#LOW p
B3:009CEE 7F55              MOV      R7,#055H
B3:009CF0 31EB              ACALL    ?L?COM0305
B3:009CF2 7B01              MOV      R3,#01H
B3:009CF4 7A23              MOV      R2,#HIGH authkey
B3:009CF6 799F              MOV      R1,#LOW authkey
B3:009CF8 D12B              ACALL    ?L?COM02D7
B3:009CFA 7A3B              MOV      R2,#HIGH p
B3:009CFC 797E              MOV      R1,#LOW p
B3:009CFE B191              ACALL    _aes_encrypt
B3:009D00 7B01              MOV      R3,#01H
B3:009D02 7A3B              MOV      R2,#HIGH p
B3:009D04 797E              MOV      R1,#LOW p
B3:009D06 7D10              MOV      R5,#010H
B3:009D08 7FAA              MOV      R7,#0AAH
B3:009D0A 31EF              ACALL    ___ZW_memset
B3:009D0C 7B01              MOV      R3,#01H
B3:009D0E 7A24              MOV      R2,#HIGH enckey
B3:009D10 7963              MOV      R1,#LOW enckey
B3:009D12 D12B              ACALL    ?L?COM02D7
B3:009D14 7A3B              MOV      R2,#HIGH p
B3:009D16 797E              MOV      R1,#LOW p
B3:009D18 B191              ACALL    _aes_encrypt
B3:009D1A 903B8E            MOV      DPTR,#retVal
B3:009D1D E0                MOVX     A,@DPTR
B3:009D1E FF                MOV      R7,A
B3:009D1F 22                RET      
----- FUNCTION sec0_unpersist_netkey (END) -------


----- FUNCTION sec0_init (BEGIN) -----
B3:009D20 91CB              ACALL    sec0_unpersist_netkey
B3:009D22 904355            MOV      DPTR,#sec0_isActivated
B3:009D25 EF                MOV      A,R7
B3:009D26 F0                MOVX     @DPTR,A
B3:009D27 E4                CLR      A
B3:009D28 904354            MOV      DPTR,#i
B3:009D2B F0                MOVX     @DPTR,A
B3:009D2C         ?C0111?ZW_SECURITY_SCHEME0:
B3:009D2C 904354            MOV      DPTR,#i
B3:009D2F E0                MOVX     A,@DPTR
B3:009D30 FF                MOV      R7,A
B3:009D31 C3                CLR      C
B3:009D32 9402              SUBB     A,#02H
B3:009D34 500B              JNC      ?C0112?ZW_SECURITY_SCHEME0
B3:009D36 D144              ACALL    ?L?COM01D3
B3:009D38 7B01              MOV      R3,#01H
B3:009D3A 1289E6            LCALL    _free_rx_session
B3:009D3D B18A              ACALL    ?L?COM054C
B3:009D3F 80EB              SJMP     ?C0111?ZW_SECURITY_SCHEME0
B3:009D41         ?C0112?ZW_SECURITY_SCHEME0:
B3:009D41 E4                CLR      A
B3:009D42 904354            MOV      DPTR,#i
B3:009D45 F0                MOVX     @DPTR,A
B3:009D46         ?C0114?ZW_SECURITY_SCHEME0:
B3:009D46 7B01              MOV      R3,#01H
B3:009D48 7A25              MOV      R2,#HIGH the_tx_session+0BH
B3:009D4A 79A8              MOV      R1,#LOW the_tx_session+0BH
B3:009D4C 121B15            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:009D4F 128494            LCALL    ?L?COM046C
B3:009D52 7D5F              MOV      R5,#05FH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 907


B3:009D54 E4                CLR      A
B3:009D55 FF                MOV      R7,A
B3:009D56 31EF              ACALL    ___ZW_memset
B3:009D58 B18A              ACALL    ?L?COM054C
B3:009D5A E0                MOVX     A,@DPTR
B3:009D5B C3                CLR      C
B3:009D5C 9402              SUBB     A,#02H
B3:009D5E 40E6              JC       ?C0114?ZW_SECURITY_SCHEME0
B3:009D60         ?C0115?ZW_SECURITY_SCHEME0:
B3:009D60 E4                CLR      A
B3:009D61 904354            MOV      DPTR,#i
B3:009D64 F0                MOVX     @DPTR,A
B3:009D65         ?C0117?ZW_SECURITY_SCHEME0:
B3:009D65 904354            MOV      DPTR,#i
B3:009D68 E0                MOVX     A,@DPTR
B3:009D69 FF                MOV      R7,A
B3:009D6A C3                CLR      C
B3:009D6B 940F              SUBB     A,#0FH
B3:009D6D 5008              JNC      ?C0118?ZW_SECURITY_SCHEME0
B3:009D6F D152              ACALL    ?L?COM00D6
B3:009D71 E4                CLR      A
B3:009D72 F0                MOVX     @DPTR,A
B3:009D73 B18A              ACALL    ?L?COM054C
B3:009D75 80EE              SJMP     ?C0117?ZW_SECURITY_SCHEME0
B3:009D77         ?C0118?ZW_SECURITY_SCHEME0:
B3:009D77 12D49B            LCALL    ?L?COM03C8
B3:009D7A 12BDF7            LCALL    ?L?COM0031
B3:009D7D 12D491            LCALL    ?L?COM051A
B3:009D80 121B10            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:009D83 904355            MOV      DPTR,#sec0_isActivated
B3:009D86 E0                MOVX     A,@DPTR
B3:009D87 24FF              ADD      A,#0FFH
B3:009D89 22                RET      
----- FUNCTION sec0_init (END) -------


----- FUNCTION ?L?COM054C (BEGIN) -----
B3:009D8A 904354            MOV      DPTR,#i
B3:009D8D E0                MOVX     A,@DPTR
B3:009D8E 04                INC      A
B3:009D8F F0                MOVX     @DPTR,A
B3:009D90 22                RET      
----- FUNCTION ?L?COM054C (END) -------


----- FUNCTION _aes_encrypt (BEGIN) -----
B3:009D91 904102            MOV      DPTR,#in
B3:009D94 1225A9            LCALL    ?C?PSTXDATA
B3:009D97 904102            MOV      DPTR,#in
B3:009D9A 122589            LCALL    ?C?PLDXDATA
B3:009D9D 12EE4B            LCALL    ?L?COM051B
B3:009DA0 904105            MOV      DPTR,#out
B3:009DA3 122589            LCALL    ?C?PLDXDATA
B3:009DA6 903EC9            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B3:009DA9 1225A9            LCALL    ?C?PSTXDATA
B3:009DAC 7B01              MOV      R3,#01H
B3:009DAE 7A24              MOV      R2,#HIGH aes_key
B3:009DB0 7983              MOV      R1,#LOW aes_key
B3:009DB2 02898D            LJMP     _ZW_AES_ecb
----- FUNCTION _aes_encrypt (END) -------


----- FUNCTION _aes_cbc_mac (BEGIN) -----
B3:009DB5 903F84            MOV      DPTR,#pData
B3:009DB8 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 908


B3:009DBB 903F87            MOV      DPTR,#len
B3:009DBE ED                MOV      A,R5
B3:009DBF F0                MOVX     @DPTR,A
B3:009DC0 D127              ACALL    ?L?COM02D5
B3:009DC2 12DA13            LCALL    ?L?COM04F6
B3:009DC5 B191              ACALL    _aes_encrypt
B3:009DC7 E4                CLR      A
B3:009DC8 903F8B            MOV      DPTR,#i
B3:009DCB F0                MOVX     @DPTR,A
B3:009DCC         ?C0008?ZW_SECURITY_SCHEME0:
B3:009DCC 903F87            MOV      DPTR,#len
B3:009DCF E0                MOVX     A,@DPTR
B3:009DD0 FF                MOV      R7,A
B3:009DD1 903F8B            MOV      DPTR,#i
B3:009DD4 E0                MOVX     A,@DPTR
B3:009DD5 FE                MOV      R6,A
B3:009DD6 C3                CLR      C
B3:009DD7 9F                SUBB     A,R7
B3:009DD8 503E              JNC      ?C0009?ZW_SECURITY_SCHEME0
B3:009DDA D131              ACALL    ?L?COM04F7
B3:009DDC EE                MOV      A,R6
B3:009DDD 540F              ANL      A,#0FH
B3:009DDF FF                MOV      R7,A
B3:009DE0 29                ADD      A,R1
B3:009DE1 F9                MOV      R1,A
B3:009DE2 E4                CLR      A
B3:009DE3 3A                ADDC     A,R2
B3:009DE4 FA                MOV      R2,A
B3:009DE5 C003              PUSH     AR3
B3:009DE7 C002              PUSH     AR2
B3:009DE9 C001              PUSH     AR1
B3:009DEB 121FB3            LCALL    ?C?CLDPTR
B3:009DEE FD                MOV      R5,A
B3:009DEF 903F84            MOV      DPTR,#pData
B3:009DF2 122589            LCALL    ?C?PLDXDATA
B3:009DF5 E9                MOV      A,R1
B3:009DF6 2E                ADD      A,R6
B3:009DF7 125510            LCALL    ?L?COM000B
B3:009DFA 6D                XRL      A,R5
B3:009DFB D001              POP      AR1
B3:009DFD D002              POP      AR2
B3:009DFF D003              POP      AR3
B3:009E01 122072            LCALL    ?C?CSTPTR
B3:009E04 BF0F09            CJNE     R7,#0FH,?C0010?ZW_SECURITY_SCHEME0
B3:009E07 903F88            MOV      DPTR,#mac
B3:009E0A D128              ACALL    ?L?COM02D6
B3:009E0C D131              ACALL    ?L?COM04F7
B3:009E0E B191              ACALL    _aes_encrypt
B3:009E10         ?C0010?ZW_SECURITY_SCHEME0:
B3:009E10 903F8B            MOV      DPTR,#i
B3:009E13 E0                MOVX     A,@DPTR
B3:009E14 04                INC      A
B3:009E15 F0                MOVX     @DPTR,A
B3:009E16 80B4              SJMP     ?C0008?ZW_SECURITY_SCHEME0
B3:009E18         ?C0009?ZW_SECURITY_SCHEME0:
B3:009E18 903F87            MOV      DPTR,#len
B3:009E1B E0                MOVX     A,@DPTR
B3:009E1C 540F              ANL      A,#0FH
B3:009E1E 6006              JZ       ?C0013?ZW_SECURITY_SCHEME0
B3:009E20 D127              ACALL    ?L?COM02D5
B3:009E22 D131              ACALL    ?L?COM04F7
B3:009E24 B191              ACALL    _aes_encrypt
B3:009E26         ?C0013?ZW_SECURITY_SCHEME0:
B3:009E26 22                RET      
----- FUNCTION _aes_cbc_mac (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 909




----- FUNCTION ?L?COM02D5 (BEGIN) -----
B3:009E27 A3                INC      DPTR
B3:009E28         ?L?COM02D6:
B3:009E28 122589            LCALL    ?C?PLDXDATA
B3:009E2B         ?L?COM02D7:
B3:009E2B 904105            MOV      DPTR,#?_aes_encrypt?BYTE+03H
B3:009E2E 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM02D5 (END) -------


----- FUNCTION ?L?COM04F7 (BEGIN) -----
B3:009E31 903F88            MOV      DPTR,#mac
B3:009E34 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04F7 (END) -------


----- FUNCTION ?L?COM046A (BEGIN) -----
B3:009E37 E0                MOVX     A,@DPTR
B3:009E38 FF                MOV      R7,A
B3:009E39 A3                INC      DPTR
B3:009E3A E0                MOVX     A,@DPTR
B3:009E3B 9034FF            MOV      DPTR,#s2_send_multi_callback
B3:009E3E CF                XCH      A,R7
B3:009E3F F0                MOVX     @DPTR,A
B3:009E40 A3                INC      DPTR
B3:009E41 EF                MOV      A,R7
B3:009E42 F0                MOVX     @DPTR,A
B3:009E43 22                RET      
----- FUNCTION ?L?COM046A (END) -------


----- FUNCTION ?L?COM01D3 (BEGIN) -----
B3:009E44 EF                MOV      A,R7
B3:009E45         ?L?COM01D4:
B3:009E45 75F085            MOV      B,#085H
B3:009E48 A4                MUL      AB
B3:009E49 2493              ADD      A,#LOW rxsessions
B3:009E4B F9                MOV      R1,A
B3:009E4C 7424              MOV      A,#HIGH rxsessions
B3:009E4E 35F0              ADDC     A,B
B3:009E50 FA                MOV      R2,A
B3:009E51 22                RET      
----- FUNCTION ?L?COM01D3 (END) -------


----- FUNCTION ?L?COM00D6 (BEGIN) -----
B3:009E52 EF                MOV      A,R7
B3:009E53         ?L?COM00D7:
B3:009E53 75F00C            MOV      B,#0CH
B3:009E56 A4                MUL      AB
B3:009E57 24B1              ADD      A,#LOW nonce_table+02H
B3:009E59 F582              MOV      DPL,A
B3:009E5B E4                CLR      A
B3:009E5C 3423              ADDC     A,#HIGH nonce_table+02H
B3:009E5E F583              MOV      DPH,A
B3:009E60 22                RET      
----- FUNCTION ?L?COM00D6 (END) -------


----- FUNCTION GenerateNIF (BEGIN) -----
B3:009E61 7B01              MOV      R3,#01H
B3:009E63 7A09              MOV      R2,#HIGH exploreRequestBuffer+04H
B3:009E65 797A              MOV      R1,#LOW exploreRequestBuffer+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 910


B3:009E67 1219DF            LCALL    ?INTERBANK_TABLE?_GenerateNodeInformation
B3:009E6A E4                CLR      A
B3:009E6B 900976            MOV      DPTR,#exploreRequestBuffer
B3:009E6E 0273D9            LJMP     ?L?COM05D4
----- FUNCTION GenerateNIF (END) -------


----- FUNCTION ExploreStateDelayed (BEGIN) -----
B3:009E71 E553              MOV      A,bExploreEvent
B3:009E73 14                DEC      A
B3:009E74 700F              JNZ      ?C0020?ZW_EXPLORE
B3:009E76         ?C0016?ZW_EXPLORE:
B3:009E76 919B              ACALL    ExploreCheckDelayCountTimeout
B3:009E78 500B              JNC      ?C0020?ZW_EXPLORE
B3:009E7A 200E08            JB       bExploreSlotTaken,?C0020?ZW_EXPLORE
B3:009E7D D20E              SETB     bExploreSlotTaken
B3:009E7F 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009E82 12739B            LCALL    ?L?COM0599
B3:009E85         ?C0020?ZW_EXPLORE:
B3:009E85 22                RET      
----- FUNCTION ExploreStateDelayed (END) -------


----- FUNCTION ExploreStateRepeat (BEGIN) -----
B3:009E86 E553              MOV      A,bExploreEvent
B3:009E88 24FD              ADD      A,#0FDH
B3:009E8A 600D              JZ       ?C0044?ZW_EXPLORE
B3:009E8C 14                DEC      A
B3:009E8D 600A              JZ       ?C0044?ZW_EXPLORE
B3:009E8F 2403              ADD      A,#03H
B3:009E91 7008              JNZ      ?C0046?ZW_EXPLORE
B3:009E93         ?C0041?ZW_EXPLORE:
B3:009E93 919B              ACALL    ExploreCheckDelayCountTimeout
B3:009E95 5004              JNC      ?C0046?ZW_EXPLORE
B3:009E97 8000              SJMP     ?C0148?ZW_EXPLORE
B3:009E99         ?C0044?ZW_EXPLORE:
B3:009E99         
B3:009E99 D19C              ACALL    ?L?COM0370
B3:009E9B         ?C0046?ZW_EXPLORE:
B3:009E9B 22                RET      
----- FUNCTION ExploreStateRepeat (END) -------


----- FUNCTION ?L?COM0370 (BEGIN) -----
B3:009E9C 900958            MOV      DPTR,#pCurrentExploreQueueElement
B3:009E9F 122589            LCALL    ?C?PLDXDATA
B3:009EA2 7407              MOV      A,#07H
B3:009EA4 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0370 (END) -------


----- FUNCTION _S2_init_ctx (BEGIN) -----
B3:009EA7 90408A            MOV      DPTR,#home
B3:009EAA 1224F1            LCALL    ?C?LSTXDATA
B3:009EAD 12A7BA            LCALL    ?L?COM0333
B3:009EB0 90408E            MOV      DPTR,#ctx
B3:009EB3 1225A9            LCALL    ?C?PSTXDATA
B3:009EB6 7E03              MOV      R6,#03H
B3:009EB8 7F38              MOV      R7,#038H
B3:009EBA 7D00              MOV      R5,#00H
B3:009EBC D1DF              ACALL    ?L?COM053C
B3:009EBE 122917            LCALL    ?C?MEMSET
B3:009EC1 90408A            MOV      DPTR,#home
B3:009EC4 122499            LCALL    ?C?LLDXDATA
B3:009EC7 D1DF              ACALL    ?L?COM053C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 911


B3:009EC9 9000C7            MOV      DPTR,#0C7H
B3:009ECC 122475            LCALL    ?C?LSTOPTR
B3:009ECF 9000C6            MOV      DPTR,#0C6H
B3:009ED2 E4                CLR      A
B3:009ED3 122084            LCALL    ?C?CSTOPTR
B3:009ED6 90020D            MOV      DPTR,#020DH
B3:009ED9 E4                CLR      A
B3:009EDA 122084            LCALL    ?C?CSTOPTR
B3:009EDD D1E9              ACALL    _s2_restore_keys
B3:;----                  JMP      ?L?COM053C
----- FUNCTION _S2_init_ctx (END) -------


----- FUNCTION ?L?COM053C (BEGIN) -----
B3:009EDF 90408E            MOV      DPTR,#ctx
B3:009EE2 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM053C (END) -------


----- FUNCTION ?L?COM05D5 (BEGIN) -----
B3:009EE5 7A20              MOV      R2,#HIGH the_context
B3:009EE7 7913              MOV      R1,#LOW the_context
----- FUNCTION _s2_restore_keys (BEGIN) -----
B3:009EE9 90423F            MOV      DPTR,#p_context
B3:009EEC 1225A9            LCALL    ?C?PSTXDATA
B3:009EEF E4                CLR      A
B3:009EF0 9020D9            MOV      DPTR,#the_context+0C6H
B3:009EF3 F0                MOVX     @DPTR,A
B3:009EF4 904242            MOV      DPTR,#i
B3:009EF7 F0                MOVX     @DPTR,A
B3:009EF8         ?C0029?S2_INCLUSION:
B3:009EF8 904242            MOV      DPTR,#i
B3:009EFB E0                MOVX     A,@DPTR
B3:009EFC FF                MOV      R7,A
B3:009EFD C3                CLR      C
B3:009EFE 9403              SUBB     A,#03H
B3:009F00 503A              JNC      ?C0030?S2_INCLUSION
B3:009F02 EF                MOV      A,R7
B3:009F03 25E0              ADD      A,ACC
B3:009F05 2475              ADD      A,#LOW m_key_slot_pair
B3:009F07 F582              MOV      DPL,A
B3:009F09 E4                CLR      A
B3:009F0A 3427              ADDC     A,#HIGH m_key_slot_pair
B3:009F0C F583              MOV      DPH,A
B3:009F0E E0                MOVX     A,@DPTR
B3:009F0F FF                MOV      R7,A
B3:009F10 F147              ACALL    ?L?COM038D
B3:009F12 121AE8            LCALL    ?INTERBANK_TABLE?_keystore_network_key_read
;---- Variable 'ret_val' assigned to Register 'R7' ----
B3:009F15 EF                MOV      A,R7
B3:009F16 B4011B            CJNE     A,#01H,?C0031?S2_INCLUSION
B3:009F19 904242            MOV      DPTR,#i
B3:009F1C E0                MOVX     A,@DPTR
B3:009F1D 25E0              ADD      A,ACC
B3:009F1F 2476              ADD      A,#LOW m_key_slot_pair+01H
B3:009F21 F582              MOV      DPL,A
B3:009F23 E4                CLR      A
B3:009F24 3427              ADDC     A,#HIGH m_key_slot_pair+01H
B3:009F26 F583              MOV      DPH,A
B3:009F28 E0                MOVX     A,@DPTR
B3:009F29 FF                MOV      R7,A
B3:009F2A F147              ACALL    ?L?COM038D
B3:009F2C E4                CLR      A
B3:009F2D 9041AD            MOV      DPTR,#?___S2_network_key_update?BYTE+04H
B3:009F30 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 912


B3:009F31 12D00D            LCALL    ___S2_network_key_update
B3:009F34         ?C0031?S2_INCLUSION:
B3:009F34 904242            MOV      DPTR,#i
B3:009F37 E0                MOVX     A,@DPTR
B3:009F38 04                INC      A
B3:009F39 F0                MOVX     @DPTR,A
B3:009F3A 80BC              SJMP     ?C0029?S2_INCLUSION
B3:009F3C         ?C0030?S2_INCLUSION:
B3:009F3C 7E00              MOV      R6,#00H
B3:009F3E 7F02              MOV      R7,#02H
B3:009F40 7D00              MOV      R5,#00H
B3:009F42 F147              ACALL    ?L?COM038D
B3:009F44 022917            LJMP     ?C?MEMSET
----- FUNCTION _s2_restore_keys (END) -------


----- FUNCTION ?L?COM038D (BEGIN) -----
B3:009F47 7B01              MOV      R3,#01H
B3:009F49 7A27              MOV      R2,#HIGH shared_key_mem
B3:009F4B 7935              MOV      R1,#LOW shared_key_mem
B3:009F4D 22                RET      
----- FUNCTION ?L?COM038D (END) -------


----- FUNCTION _MemoryGetBuffer (BEGIN) -----
;---- Variable 'buffer' assigned to Register 'R1/R2/R3' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:009F4E 904101            MOV      DPTR,#length
B3:009F51 E0                MOVX     A,@DPTR
B3:009F52 9040B9            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B3:009F55 F0                MOVX     @DPTR,A
B3:009F56 023F61            LJMP     _NVM_ext_read_buffer
----- FUNCTION _MemoryGetBuffer (END) -------


----- FUNCTION s2_do_ecdh_calc_b (BEGIN) -----
B3:009F59 F147              ACALL    ?L?COM038D
B3:009F5B 121ADE            LCALL    ?INTERBANK_TABLE?_keystore_private_key_read
B3:009F5E F147              ACALL    ?L?COM038D
B3:009F60 9031A0            MOV      DPTR,#?_crypto_scalarmult_curve25519?BYTE+03H
B3:009F63 1225A9            LCALL    ?C?PSTXDATA
B3:009F66 9031A3            MOV      DPTR,#?_crypto_scalarmult_curve25519?BYTE+06H
B3:009F69 12EFD1            LCALL    ?L?COM04A7
B3:009F6C 121B47            LCALL    ?INTERBANK_TABLE?_crypto_scalarmult_curve25519
B3:009F6F 7835              MOV      R0,#LOW shared_key_mem
B3:009F71 7C27              MOV      R4,#HIGH shared_key_mem
B3:009F73 7A23              MOV      R2,#HIGH the_context+0318H
B3:009F75 792B              MOV      R1,#LOW the_context+0318H
B3:009F77 7F20              MOV      R7,#020H
B3:009F79 127051            LCALL    ?L?COM00BE
B3:009F7C 7B01              MOV      R3,#01H
B3:009F7E 7A27              MOV      R2,#HIGH shared_key_mem+020H
B3:009F80 7955              MOV      R1,#LOW shared_key_mem+020H
B3:009F82 121AD9            LCALL    ?INTERBANK_TABLE?_keystore_public_key_read
B3:009F85 F147              ACALL    ?L?COM038D
B3:009F87 90304D            MOV      DPTR,#?_tempkey_extract?BYTE+03H
B3:009F8A 1225A9            LCALL    ?C?PSTXDATA
B3:009F8D 903050            MOV      DPTR,#?_tempkey_extract?BYTE+06H
B3:009F90 12EFD1            LCALL    ?L?COM04A7
B3:009F93 121B33            LCALL    ?INTERBANK_TABLE?_tempkey_extract
B3:009F96 7B01              MOV      R3,#01H
B3:009F98 7A23              MOV      R2,#HIGH the_context+0318H
B3:009F9A 792B              MOV      R1,#LOW the_context+0318H
B3:009F9C 9041AD            MOV      DPTR,#?___S2_network_key_update?BYTE+04H
B3:009F9F 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 913


B3:009FA1 F0                MOVX     @DPTR,A
B3:009FA2 E4                CLR      A
B3:009FA3 FF                MOV      R7,A
B3:009FA4 12D00D            LCALL    ___S2_network_key_update
B3:009FA7 902842            MOV      DPTR,#m_retry_counter
B3:009FAA 7418              MOV      A,#018H
B3:009FAC F0                MOVX     @DPTR,A
B3:;----                  JMP      s2_send_echo_kex_set
----- FUNCTION s2_do_ecdh_calc_b (END) -------


----- FUNCTION s2_send_echo_kex_set (BEGIN) -----
B3:009FAD 902842            MOV      DPTR,#m_retry_counter
B3:009FB0 E0                MOVX     A,@DPTR
B3:009FB1 14                DEC      A
B3:009FB2 12AB0D            LCALL    ?L?COM024A
B3:009FB5 7406              MOV      A,#06H
B3:009FB7 F0                MOVX     @DPTR,A
B3:009FB8 9020D4            MOV      DPTR,#the_context+0C1H
B3:009FBB E0                MOVX     A,@DPTR
B3:009FBC 4401              ORL      A,#01H
B3:009FBE 902304            MOV      DPTR,#the_context+02F1H
B3:009FC1 F0                MOVX     @DPTR,A
B3:009FC2 9020D5            MOV      DPTR,#the_context+0C2H
B3:009FC5 E0                MOVX     A,@DPTR
B3:009FC6 902305            MOV      DPTR,#the_context+02F2H
B3:009FC9 F0                MOVX     @DPTR,A
B3:009FCA 9020D6            MOV      DPTR,#the_context+0C3H
B3:009FCD E0                MOVX     A,@DPTR
B3:009FCE 902306            MOV      DPTR,#the_context+02F3H
B3:009FD1 F0                MOVX     @DPTR,A
B3:009FD2 9020D7            MOV      DPTR,#the_context+0C4H
B3:009FD5 E0                MOVX     A,@DPTR
B3:009FD6 902307            MOV      DPTR,#the_context+02F4H
B3:009FD9 F0                MOVX     @DPTR,A
B3:009FDA 90232A            MOV      DPTR,#the_context+0317H
B3:009FDD 7406              MOV      A,#06H
B3:009FDF 12ABBC            LCALL    ?L?COM0278
B3:009FE2 04                INC      A
B3:009FE3 F0                MOVX     @DPTR,A
B3:009FE4 FB                MOV      R3,A
B3:009FE5 12EEF1            LCALL    ?L?COM0147
B3:009FE8 7A20              MOV      R2,#HIGH the_context+0CFH
B3:009FEA 79E2              MOV      R1,#LOW the_context+0CFH
B3:009FEC 12DEF3            LCALL    ___S2_send_data
B3:009FEF 12AB2C            LCALL    ?L?COM0271
B3:;----                  JMP      _s2_inclusion_set_timeout
----- FUNCTION s2_send_echo_kex_set (END) -------


----- FUNCTION _s2_inclusion_set_timeout (BEGIN) -----
B3:009FF2 90422F            MOV      DPTR,#interval
B3:009FF5 1224F1            LCALL    ?C?LSTXDATA
B3:009FF8 E4                CLR      A
B3:009FF9 7F0A              MOV      R7,#0AH
B3:009FFB FE                MOV      R6,A
B3:009FFC FD                MOV      R5,A
B3:009FFD FC                MOV      R4,A
B3:009FFE 90422F            MOV      DPTR,#interval
B3:00A001 1224B5            LCALL    ?C?LLDXDATA0
B3:00A004 122286            LCALL    ?C?LMUL
B3:00A007 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00A00A 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_s2_inclusion_notify_timeout
B3:00A00C F0                MOVX     @DPTR,A
B3:00A00D A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 914


B3:00A00E 7468              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_s2_inclusion_notify_timeout
B3:00A010 F0                MOVX     @DPTR,A
B3:00A011 B141              ACALL    ?L?COM02C0
B3:00A013 12725F            LCALL    ?L?COM0410
B3:00A016 7A38              MOV      R2,#HIGH s2_itimer
B3:00A018 793A              MOV      R1,#LOW s2_itimer
B3:00A01A 121B10            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:00A01D 7F01              MOV      R7,#01H
B3:00A01F 22                RET      
----- FUNCTION _s2_inclusion_set_timeout (END) -------


----- FUNCTION ___S2_application_command_handler (BEGIN) -----
B3:00A020 903964            MOV      DPTR,#src
B3:00A023 1225A9            LCALL    ?C?PSTXDATA
B3:00A026 31B7              ACALL    ?L?COM04FD
B3:00A028 903979            MOV      DPTR,#d+03H
B3:00A02B 5104              ACALL    ?L?COM04C7
B3:00A02D 90397C            MOV      DPTR,#d+06H
B3:00A030 CF                XCH      A,R7
B3:00A031 F0                MOVX     @DPTR,A
B3:00A032 EF                MOV      A,R7
B3:00A033 31A8              ACALL    ?L?COM02BC
B3:00A035 903976            MOV      DPTR,#d
B3:00A038 1225A9            LCALL    ?C?PSTXDATA
B3:00A03B 903967            MOV      DPTR,#buf
B3:00A03E 31FB              ACALL    ?L?COM0430
B3:00A040 6002              JZ       $ + 4H
B3:00A042 21A7              AJMP     ?C0177?S2
B3:00A044         ?C0176?S2:
B3:00A044 129279            LCALL    ?L?COM0066
B3:00A047 24FE              ADD      A,#0FEH
B3:00A049 601A              JZ       ?C0181?S2
B3:00A04B 14                DEC      A
B3:00A04C 601E              JZ       ?C0182?S2
B3:00A04E 2402              ADD      A,#02H
B3:00A050 6002              JZ       $ + 4H
B3:00A052 2187              AJMP     ?C0194?S2
B3:00A054         ?C0179?S2:
B3:00A054 903964            MOV      DPTR,#src
B3:00A057 1291A1            LCALL    ?L?COM004B
B3:00A05A 30E002            JNB      ACC.0,$ + 5H
B3:00A05D 21A7              AJMP     ?C0177?S2
B3:00A05F 31B0              ACALL    ?L?COM0461
B3:00A061 7F03              MOV      R7,#03H
B3:00A063 8004              SJMP     ?C0277?S2
B3:00A065         ?C0181?S2:
B3:00A065 31B0              ACALL    ?L?COM0461
B3:00A067 7F04              MOV      R7,#04H
B3:00A069         
B3:00A069 028E6A            LJMP     ___S2_fsm_post_event
B3:00A06C         ?C0182?S2:
B3:00A06C 31B7              ACALL    ?L?COM04FD
B3:00A06E 902E06            MOV      DPTR,#?___S2_decrypt_msg?BYTE+03H
B3:00A071 5104              ACALL    ?L?COM04C7
B3:00A073 902E09            MOV      DPTR,#?___S2_decrypt_msg?BYTE+06H
B3:00A076 CF                XCH      A,R7
B3:00A077 12C404            LCALL    ?L?COM0127
B3:00A07A 7A39              MOV      R2,#HIGH plain_text
B3:00A07C 796C              MOV      R1,#LOW plain_text
B3:00A07E A3                INC      DPTR
B3:00A07F 1225A9            LCALL    ?C?PSTXDATA
B3:00A082 7A39              MOV      R2,#HIGH plain_text_len
B3:00A084 796F              MOV      R1,#LOW plain_text_len
B3:00A086 902E0E            MOV      DPTR,#?___S2_decrypt_msg?BYTE+0BH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 915


B3:00A089 1225A9            LCALL    ?C?PSTXDATA
B3:00A08C 31AA              ACALL    ?L?COM02BE
B3:00A08E 129391            LCALL    ___S2_decrypt_msg
B3:00A091 903971            MOV      DPTR,#rc
B3:00A094 EF                MOV      A,R7
B3:00A095 F0                MOVX     @DPTR,A
B3:00A096 6002              JZ       $ + 4H
B3:00A098 2173              AJMP     ?C0183?S2
B3:00A09A 31B0              ACALL    ?L?COM0461
B3:00A09C 7F05              MOV      R7,#05H
B3:00A09E 128E6A            LCALL    ___S2_fsm_post_event
B3:00A0A1 90396F            MOV      DPTR,#plain_text_len
B3:00A0A4 E0                MOVX     A,@DPTR
B3:00A0A5 7002              JNZ      ?C0273?S2
B3:00A0A7 A3                INC      DPTR
B3:00A0A8 E0                MOVX     A,@DPTR
B3:00A0A9         ?C0273?S2:
B3:00A0A9 7002              JNZ      $ + 4H
B3:00A0AB 21A7              AJMP     ?C0177?S2
B3:00A0AD 90396C            MOV      DPTR,#plain_text
B3:00A0B0 31FB              ACALL    ?L?COM0430
B3:00A0B2 6002              JZ       $ + 4H
B3:00A0B4 2155              AJMP     ?C0185?S2
B3:00A0B6 129279            LCALL    ?L?COM0066
B3:00A0B9 FF                MOV      R7,A
B3:00A0BA 640E              XRL      A,#0EH
B3:00A0BC 7002              JNZ      $ + 4H
B3:00A0BE 2155              AJMP     ?C0185?S2
B3:00A0C0 EF                MOV      A,R7
B3:00A0C1 6410              XRL      A,#010H
B3:00A0C3 7002              JNZ      $ + 4H
B3:00A0C5 2155              AJMP     ?C0185?S2
B3:00A0C7 903964            MOV      DPTR,#src
B3:00A0CA 1291A1            LCALL    ?L?COM004B
B3:00A0CD 30E002            JNB      ACC.0,$ + 5H
B3:00A0D0 21A7              AJMP     ?C0177?S2
B3:00A0D2         ?C0186?S2:
B3:00A0D2 90396C            MOV      DPTR,#plain_text
B3:00A0D5 129276            LCALL    ?L?COM0065
B3:00A0D8 640D              XRL      A,#0DH
B3:00A0DA 705F              JNZ      ?C0187?S2
B3:00A0DC 12AB0E            LCALL    ?L?COM024B
B3:00A0DF 740E              MOV      A,#0EH
B3:00A0E1 31A9              ACALL    ?L?COM02BD
B3:00A0E3 121FB3            LCALL    ?C?CLDPTR
B3:00A0E6 FF                MOV      R7,A
B3:00A0E7 31BD              ACALL    ?L?COM04FB
B3:00A0E9 FD                MOV      R5,A
B3:00A0EA 7B01              MOV      R3,#01H
B3:00A0EC 7A39              MOV      R2,#HIGH n_commands_supported
B3:00A0EE 7972              MOV      R1,#LOW n_commands_supported
B3:00A0F0 903FA9            MOV      DPTR,#?_S2_get_commands_supported?BYTE+05H
B3:00A0F3 1225A9            LCALL    ?C?PSTXDATA
B3:00A0F6 7A39              MOV      R2,#HIGH classes
B3:00A0F8 09                INC      R1
B3:00A0F9 12E1D9            LCALL    _S2_get_commands_supported
B3:00A0FC 903972            MOV      DPTR,#n_commands_supported
B3:00A0FF E0                MOVX     A,@DPTR
B3:00A100 FF                MOV      R7,A
B3:00A101 2402              ADD      A,#02H
B3:00A103 FD                MOV      R5,A
B3:00A104 E4                CLR      A
B3:00A105 33                RLC      A
B3:00A106 FC                MOV      R4,A
B3:00A107 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 916


B3:00A108 ED                MOV      A,R5
B3:00A109 9428              SUBB     A,#028H
B3:00A10B EC                MOV      A,R4
B3:00A10C 6480              XRL      A,#080H
B3:00A10E 9480              SUBB     A,#080H
B3:00A110 4002              JC       $ + 4H
B3:00A112 21A7              AJMP     ?C0177?S2
B3:00A114         ?C0188?S2:
B3:00A114 7E00              MOV      R6,#00H
B3:00A116 7804              MOV      R0,#LOW the_context+02F1H
B3:00A118 7C23              MOV      R4,#HIGH the_context+02F1H
B3:00A11A 7D01              MOV      R5,#01H
B3:00A11C 903973            MOV      DPTR,#classes
B3:00A11F 1270FA            LCALL    ?L?COM0233
B3:00A122 903BC5            MOV      DPTR,#?___S2_send_data?BYTE+03H
B3:00A125 12EFBB            LCALL    ?L?COM044E
B3:00A128 903972            MOV      DPTR,#n_commands_supported
B3:00A12B E0                MOVX     A,@DPTR
B3:00A12C 2402              ADD      A,#02H
B3:00A12E FE                MOV      R6,A
B3:00A12F E4                CLR      A
B3:00A130 33                RLC      A
B3:00A131 903BC8            MOV      DPTR,#?___S2_send_data?BYTE+06H
B3:00A134 F0                MOVX     @DPTR,A
B3:00A135 CE                XCH      A,R6
B3:00A136 31A8              ACALL    ?L?COM02BC
B3:00A138 02DEF3            LJMP     ___S2_send_data
B3:00A13B         ?C0187?S2:
B3:00A13B 90396C            MOV      DPTR,#plain_text
B3:00A13E 122589            LCALL    ?C?PLDXDATA
B3:00A141 9020EA            MOV      DPTR,#the_context+0D7H
B3:00A144 1225A9            LCALL    ?C?PSTXDATA
B3:00A147 90396F            MOV      DPTR,#plain_text_len
B3:00A14A 911C              ACALL    ?L?COM036F
B3:00A14C 31A9              ACALL    ?L?COM02BD
B3:00A14E 31BD              ACALL    ?L?COM04FB
B3:00A150 9020E9            MOV      DPTR,#the_context+0D6H
B3:00A153 804E              SJMP     ?C0278?S2
B3:00A155         ?C0185?S2:
B3:00A155 90396C            MOV      DPTR,#plain_text
B3:00A158 122589            LCALL    ?C?PLDXDATA
B3:00A15B 903CAD            MOV      DPTR,#?___S2_msg_received_event?BYTE+03H
B3:00A15E 1225A9            LCALL    ?C?PSTXDATA
B3:00A161 90396F            MOV      DPTR,#plain_text_len
B3:00A164 E0                MOVX     A,@DPTR
B3:00A165 FF                MOV      R7,A
B3:00A166 A3                INC      DPTR
B3:00A167 E0                MOVX     A,@DPTR
B3:00A168 903CB0            MOV      DPTR,#?___S2_msg_received_event?BYTE+06H
B3:00A16B CF                XCH      A,R7
B3:00A16C F0                MOVX     @DPTR,A
B3:00A16D A3                INC      DPTR
B3:00A16E EF                MOV      A,R7
B3:00A16F 31A9              ACALL    ?L?COM02BD
B3:00A171 414A              AJMP     ___S2_msg_received_event
B3:00A173         ?C0183?S2:
B3:00A173 903971            MOV      DPTR,#rc
B3:00A176 E0                MOVX     A,@DPTR
B3:00A177 6402              XRL      A,#02H
B3:00A179 702C              JNZ      ?C0177?S2
B3:00A17B 31B0              ACALL    ?L?COM0461
B3:00A17D 7F06              MOV      R7,#06H
B3:00A17F 128E6A            LCALL    ___S2_fsm_post_event
B3:00A182 F1BA              ACALL    ?L?COM0333
B3:00A184 02EA0E            LJMP     _s2_inclusion_decryption_failure
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 917


B3:00A187         ?C0194?S2:
B3:00A187 903964            MOV      DPTR,#src
B3:00A18A 1291A1            LCALL    ?L?COM004B
B3:00A18D 20E017            JB       ACC.0,?C0177?S2
B3:00A190 31B7              ACALL    ?L?COM04FD
B3:00A192 9020EA            MOV      DPTR,#the_context+0D7H
B3:00A195 1225A9            LCALL    ?C?PSTXDATA
B3:00A198 90396A            MOV      DPTR,#len
B3:00A19B 911C              ACALL    ?L?COM036F
B3:00A19D F0                MOVX     @DPTR,A
B3:00A19E 9020E9            MOV      DPTR,#the_context+0D6H
B3:00A1A1 74FF              MOV      A,#0FFH
B3:00A1A3         
B3:00A1A3 F0                MOVX     @DPTR,A
B3:00A1A4 12E8BA            LCALL    s2_inclusion_post_event
B3:00A1A7         ?C0177?S2:
B3:00A1A7 22                RET      
----- FUNCTION ___S2_application_command_handler (END) -------


----- FUNCTION ?L?COM02BC (BEGIN) -----
B3:00A1A8 A3                INC      DPTR
B3:00A1A9         ?L?COM02BD:
B3:00A1A9 F0                MOVX     @DPTR,A
B3:00A1AA         ?L?COM02BE:
B3:00A1AA 903964            MOV      DPTR,#src
B3:00A1AD 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM02BC (END) -------


----- FUNCTION ?L?COM0461 (BEGIN) -----
B3:00A1B0 7B01              MOV      R3,#01H
B3:00A1B2 7A39              MOV      R2,#HIGH d
B3:00A1B4 7976              MOV      R1,#LOW d
B3:00A1B6 22                RET      
----- FUNCTION ?L?COM0461 (END) -------


----- FUNCTION ?L?COM04FD (BEGIN) -----
B3:00A1B7 903967            MOV      DPTR,#buf
B3:00A1BA 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04FD (END) -------


----- FUNCTION ?L?COM04FB (BEGIN) -----
B3:00A1BD 900007            MOV      DPTR,#07H
B3:00A1C0 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM04FB (END) -------


----- FUNCTION ZW_ExploreRequestExclusion (BEGIN) -----
B3:00A1C3 300126            JNB      learnMode,?C0001?ZW_EXPLORE_EXCL_REQ
B3:00A1C6 200223            JB       findInProgress,?C0001?ZW_EXPLORE_EXCL_REQ
B3:00A1C9 E550              MOV      A,bNetworkWideInclusion
B3:00A1CB 6402              XRL      A,#02H
B3:00A1CD 701D              JNZ      ?C0001?ZW_EXPLORE_EXCL_REQ
B3:00A1CF 31F4              ACALL    ?L?COM035B
B3:00A1D1 1219DF            LCALL    ?INTERBANK_TABLE?_GenerateNodeInformation
B3:00A1D4 900977            MOV      DPTR,#exploreRequestBuffer+01H
B3:00A1D7 7423              MOV      A,#023H
B3:00A1D9 F0                MOVX     @DPTR,A
B3:00A1DA 31EF              ACALL    ?L?COM035A
B3:00A1DC 902BE5            MOV      DPTR,#blnodeInfoLength
B3:00A1DF E0                MOVX     A,@DPTR
B3:00A1E0 900A6F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 918


B3:00A1E3 B177              ACALL    ?L?COM01B6
B3:00A1E5 A3                INC      DPTR
B3:00A1E6 F0                MOVX     @DPTR,A
B3:00A1E7 7DFF              MOV      R5,#0FFH
B3:00A1E9 0292A3            LJMP     _ExploreQueueFrame
B3:00A1EC         ?C0001?ZW_EXPLORE_EXCL_REQ:
B3:00A1EC 7F00              MOV      R7,#00H
B3:00A1EE 22                RET      
----- FUNCTION ZW_ExploreRequestExclusion (END) -------


----- FUNCTION ?L?COM035A (BEGIN) -----
B3:00A1EF 901221            MOV      DPTR,#nodeID
B3:00A1F2 E0                MOVX     A,@DPTR
B3:00A1F3 FF                MOV      R7,A
B3:00A1F4         ?L?COM035B:
B3:00A1F4 7B01              MOV      R3,#01H
B3:00A1F6 7A09              MOV      R2,#HIGH exploreRequestBuffer
B3:00A1F8 7976              MOV      R1,#LOW exploreRequestBuffer
B3:00A1FA 22                RET      
----- FUNCTION ?L?COM035A (END) -------


----- FUNCTION ?L?COM0430 (BEGIN) -----
B3:00A1FB 122589            LCALL    ?C?PLDXDATA
B3:00A1FE 121FB3            LCALL    ?C?CLDPTR
B3:00A201 649F              XRL      A,#09FH
B3:00A203 22                RET      
----- FUNCTION ?L?COM0430 (END) -------


----- FUNCTION ?L?COM04C7 (BEGIN) -----
B3:00A204 1225A9            LCALL    ?C?PSTXDATA
B3:00A207 90396A            MOV      DPTR,#len
B3:00A20A E0                MOVX     A,@DPTR
B3:00A20B FF                MOV      R7,A
B3:00A20C A3                INC      DPTR
B3:00A20D E0                MOVX     A,@DPTR
B3:00A20E 22                RET      
----- FUNCTION ?L?COM04C7 (END) -------


----- FUNCTION _ZW_FirmwareUpdate_NVM_Set_NEWIMAGE (BEGIN) -----
B3:00A20F 90435C            MOV      DPTR,#bValue
B3:00A212 EF                MOV      A,R7
B3:00A213 F0                MOVX     @DPTR,A
B3:00A214 E4                CLR      A
B3:00A215 A3                INC      DPTR
B3:00A216 F0                MOVX     @DPTR,A
B3:00A217 90353F            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00A21A E0                MOVX     A,@DPTR
B3:00A21B 6027              JZ       ?C0004?ZW_FIRMWARE_UPDATE_NVM
B3:00A21D 90435C            MOV      DPTR,#bValue
B3:00A220 E0                MOVX     A,@DPTR
B3:00A221 B4010C            CJNE     A,#01H,?C0005?ZW_FIRMWARE_UPDATE_NVM
B3:00A224 51C4              ACALL    ?L?COM031B
B3:00A226 EF                MOV      A,R7
B3:00A227 2409              ADD      A,#09H
B3:00A229 1249DE            LCALL    ?L?COM0075
B3:00A22C FC                MOV      R4,A
B3:00A22D 121AF7            LCALL    ?INTERBANK_TABLE?_ZW_KeystoreNvmUpdate
B3:00A230         ?C0005?ZW_FIRMWARE_UPDATE_NVM:
B3:00A230 12D7BA            LCALL    ?L?COM01F9
B3:00A233 90435C            MOV      DPTR,#bValue
B3:00A236 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 919


B3:00A237 904176            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
B3:00A23A F0                MOVX     @DPTR,A
B3:00A23B 123BEC            LCALL    _NVM_ext_write_long_byte
B3:00A23E E4                CLR      A
B3:00A23F 33                RLC      A
B3:00A240 90435D            MOV      DPTR,#retVal
B3:00A243 F0                MOVX     @DPTR,A
B3:00A244         ?C0004?ZW_FIRMWARE_UPDATE_NVM:
B3:00A244 90435D            MOV      DPTR,#retVal
B3:00A247 E0                MOVX     A,@DPTR
B3:00A248 FF                MOV      R7,A
B3:00A249 22                RET      
----- FUNCTION _ZW_FirmwareUpdate_NVM_Set_NEWIMAGE (END) -------


----- FUNCTION ___S2_msg_received_event (BEGIN) -----
B3:00A24A 903CAA            MOV      DPTR,#src
B3:00A24D 1225A9            LCALL    ?C?PSTXDATA
B3:00A250 903CAA            MOV      DPTR,#src
B3:00A253 12576B            LCALL    ?L?COM0323
B3:00A256 125510            LCALL    ?L?COM000B
B3:00A259 903CB2            MOV      DPTR,#rxOpt
B3:00A25C 51BD              ACALL    ?L?COM0487
B3:00A25E E9                MOV      A,R1
B3:00A25F 2401              ADD      A,#01H
B3:00A261 125510            LCALL    ?L?COM000B
B3:00A264 903CB3            MOV      DPTR,#rxOpt+01H
B3:00A267 51BD              ACALL    ?L?COM0487
B3:00A269 121FB3            LCALL    ?C?CLDPTR
B3:00A26C 903CB4            MOV      DPTR,#rxOpt+02H
B3:00A26F F0                MOVX     @DPTR,A
B3:00A270 E9                MOV      A,R1
B3:00A271 2406              ADD      A,#06H
B3:00A273 125510            LCALL    ?L?COM000B
B3:00A276 903CB5            MOV      DPTR,#rxOpt+03H
B3:00A279 51BD              ACALL    ?L?COM0487
B3:00A27B 12550D            LCALL    ?L?COM000A
B3:00A27E 04                INC      A
B3:00A27F 903CB6            MOV      DPTR,#rxOpt+04H
B3:00A282 F0                MOVX     @DPTR,A
B3:00A283 C3                CLR      C
B3:00A284 903CB1            MOV      DPTR,#len+01H
B3:00A287 E0                MOVX     A,@DPTR
B3:00A288 9402              SUBB     A,#02H
B3:00A28A 903CB0            MOV      DPTR,#len
B3:00A28D E0                MOVX     A,@DPTR
B3:00A28E 9400              SUBB     A,#00H
B3:00A290 402A              JC       ?C0019?ZW_SECURITY_SCHEME2
B3:00A292         ?C0018?ZW_SECURITY_SCHEME2:
B3:00A292 903CAA            MOV      DPTR,#src
B3:00A295 12707E            LCALL    ?L?COM00F2
B3:00A298 125510            LCALL    ?L?COM000B
B3:00A29B 30E103            JNB      ACC.1,?C0020?ZW_SECURITY_SCHEME2
B3:00A29E 1219AD            LCALL    ?INTERBANK_TABLE?ZW_FollowUpReceived
B3:00A2A1         ?C0020?ZW_SECURITY_SCHEME2:
B3:00A2A1 903CB0            MOV      DPTR,#len
B3:00A2A4 A3                INC      DPTR
B3:00A2A5 E0                MOVX     A,@DPTR
B3:00A2A6 FD                MOV      R5,A
B3:00A2A7 7B01              MOV      R3,#01H
B3:00A2A9 7A3C              MOV      R2,#HIGH rxOpt
B3:00A2AB 79B2              MOV      R1,#LOW rxOpt
B3:00A2AD 9040B1            MOV      DPTR,#?_ApplicationCommandHandler?BYTE+04H
B3:00A2B0 1225A9            LCALL    ?C?PSTXDATA
B3:00A2B3 903CAD            MOV      DPTR,#buf
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 920


B3:00A2B6 122589            LCALL    ?C?PLDXDATA
B3:00A2B9 121EB2            LCALL    ?INTERBANK_TABLE?_ApplicationCommandHandler
B3:00A2BC         ?C0019?ZW_SECURITY_SCHEME2:
B3:00A2BC 22                RET      
----- FUNCTION ___S2_msg_received_event (END) -------


----- FUNCTION ?L?COM0487 (BEGIN) -----
B3:00A2BD F0                MOVX     @DPTR,A
B3:00A2BE 903CAA            MOV      DPTR,#src
B3:00A2C1 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0487 (END) -------


----- FUNCTION ?L?COM031B (BEGIN) -----
B3:00A2C4 90353B            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00A2C7 022499            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM031B (END) -------


----- FUNCTION check_compressed_crc (BEGIN) -----
B3:00A2CA 51C4              ACALL    ?L?COM031B
B3:00A2CC 910B              ACALL    ?L?COM03DB
B3:00A2CE 903326            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00A2D1 E4                CLR      A
B3:00A2D2 F0                MOVX     @DPTR,A
B3:00A2D3 A3                INC      DPTR
B3:00A2D4 7405              MOV      A,#05H
B3:00A2D6 F0                MOVX     @DPTR,A
B3:00A2D7 7F0F              MOV      R7,#0FH
B3:00A2D9 7E1D              MOV      R6,#01DH
B3:00A2DB 71FF              ACALL    ?L?COM02A3
B3:00A2DD C006              PUSH     AR6
B3:00A2DF C007              PUSH     AR7
B3:00A2E1 51C4              ACALL    ?L?COM031B
B3:00A2E3 EF                MOV      A,R7
B3:00A2E4 2407              ADD      A,#07H
B3:00A2E6 1249DE            LCALL    ?L?COM0075
B3:00A2E9 910A              ACALL    ?L?COM03DA
B3:00A2EB 903326            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00A2EE E4                CLR      A
B3:00A2EF F0                MOVX     @DPTR,A
B3:00A2F0 A3                INC      DPTR
B3:00A2F1 7414              MOV      A,#014H
B3:00A2F3 F0                MOVX     @DPTR,A
B3:00A2F4 D007              POP      AR7
B3:00A2F6 D006              POP      AR6
B3:00A2F8 71FF              ACALL    ?L?COM02A3
B3:00A2FA C006              PUSH     AR6
B3:00A2FC C007              PUSH     AR7
B3:00A2FE 51C4              ACALL    ?L?COM031B
B3:00A300 EF                MOV      A,R7
B3:00A301 241B              ADD      A,#01BH
B3:00A303 1249DE            LCALL    ?L?COM0075
B3:00A306 910A              ACALL    ?L?COM03DA
B3:00A308 9128              ACALL    ?L?COM024C
B3:00A30A 4006              JC       ?C0001?OTZ_CHECK_COMPRESSED_CRC
B3:00A30C 7EFF              MOV      R6,#0FFH
B3:00A30E 7FFF              MOV      R7,#0FFH
B3:00A310 8006              SJMP     ?C0002?OTZ_CHECK_COMPRESSED_CRC
B3:00A312         ?C0001?OTZ_CHECK_COMPRESSED_CRC:
B3:00A312 903521            MOV      DPTR,#compressionHdr+01H
B3:00A315 122499            LCALL    ?C?LLDXDATA
B3:00A318         ?C0002?OTZ_CHECK_COMPRESSED_CRC:
B3:00A318 903326            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 921


B3:00A31B EE                MOV      A,R6
B3:00A31C F0                MOVX     @DPTR,A
B3:00A31D A3                INC      DPTR
B3:00A31E EF                MOV      A,R7
B3:00A31F F0                MOVX     @DPTR,A
B3:00A320 D007              POP      AR7
B3:00A322 D006              POP      AR6
B3:00A324 71FF              ACALL    ?L?COM02A3
B3:00A326 9128              ACALL    ?L?COM024C
B3:00A328 402E              JC       ?C0003?OTZ_CHECK_COMPRESSED_CRC
B3:00A32A 51C4              ACALL    ?L?COM031B
B3:00A32C EF                MOV      A,R7
B3:00A32D 241A              ADD      A,#01AH
B3:00A32F FF                MOV      R7,A
B3:00A330 E4                CLR      A
B3:00A331 3E                ADDC     A,R6
B3:00A332 FE                MOV      R6,A
B3:00A333 ED                MOV      A,R5
B3:00A334 3401              ADDC     A,#01H
B3:00A336 FD                MOV      R5,A
B3:00A337 E4                CLR      A
B3:00A338 3C                ADDC     A,R4
B3:00A339 910A              ACALL    ?L?COM03DA
B3:00A33B 903521            MOV      DPTR,#compressionHdr+01H
B3:00A33E 122499            LCALL    ?C?LLDXDATA
B3:00A341 EF                MOV      A,R7
B3:00A342 2401              ADD      A,#01H
B3:00A344 FF                MOV      R7,A
B3:00A345 E4                CLR      A
B3:00A346 3E                ADDC     A,R6
B3:00A347 903326            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00A34A F0                MOVX     @DPTR,A
B3:00A34B A3                INC      DPTR
B3:00A34C EF                MOV      A,R7
B3:00A34D F0                MOVX     @DPTR,A
B3:00A34E 90435E            MOV      DPTR,#tempCRC
B3:00A351 E0                MOVX     A,@DPTR
B3:00A352 FE                MOV      R6,A
B3:00A353 A3                INC      DPTR
B3:00A354 E0                MOVX     A,@DPTR
B3:00A355 FF                MOV      R7,A
B3:00A356 71FF              ACALL    ?L?COM02A3
B3:00A358         ?C0003?OTZ_CHECK_COMPRESSED_CRC:
B3:00A358 903525            MOV      DPTR,#compressionHdr+05H
B3:00A35B E0                MOVX     A,@DPTR
B3:00A35C FE                MOV      R6,A
B3:00A35D A3                INC      DPTR
B3:00A35E E0                MOVX     A,@DPTR
B3:00A35F FF                MOV      R7,A
B3:00A360 90435E            MOV      DPTR,#tempCRC
B3:00A363 E0                MOVX     A,@DPTR
B3:00A364 6E                XRL      A,R6
B3:00A365 7003              JNZ      ?C0006?OTZ_CHECK_COMPRESSED_CRC
B3:00A367 A3                INC      DPTR
B3:00A368 E0                MOVX     A,@DPTR
B3:00A369 6F                XRL      A,R7
B3:00A36A         ?C0006?OTZ_CHECK_COMPRESSED_CRC:
B3:00A36A 7F00              MOV      R7,#00H
B3:00A36C 6002              JZ       ?C0004?OTZ_CHECK_COMPRESSED_CRC
B3:00A36E 7FFF              MOV      R7,#0FFH
B3:00A370         ?C0004?OTZ_CHECK_COMPRESSED_CRC:
B3:00A370 22                RET      
----- FUNCTION check_compressed_crc (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 922


----- FUNCTION _ZW_firmwareUpdate_NVM_UpdateCRC16 (BEGIN) -----
B3:00A371 903320            MOV      DPTR,#crc
B3:00A374 EE                MOV      A,R6
B3:00A375 F0                MOVX     @DPTR,A
B3:00A376 A3                INC      DPTR
B3:00A377 EF                MOV      A,R7
B3:00A378 F0                MOVX     @DPTR,A
B3:00A379 A3                INC      DPTR
B3:00A37A 122499            LCALL    ?C?LLDXDATA
B3:00A37D 903328            MOV      DPTR,#i
B3:00A380 1224F1            LCALL    ?C?LSTXDATA
B3:00A383 903326            MOV      DPTR,#blockSize
B3:00A386 E0                MOVX     A,@DPTR
B3:00A387 FF                MOV      R7,A
B3:00A388 A3                INC      DPTR
B3:00A389 E0                MOVX     A,@DPTR
B3:00A38A 90332C            MOV      DPTR,#blockLength
B3:00A38D CF                XCH      A,R7
B3:00A38E 8060              SJMP     ?C0015?ZW_FIRMWARE_UPDATE_NVM
B3:00A390         ?C0007?ZW_FIRMWARE_UPDATE_NVM:
B3:00A390 90332C            MOV      DPTR,#blockLength
B3:00A393 F190              ACALL    ?L?COM0098
B3:00A395 605F              JZ       ?C0008?ZW_FIRMWARE_UPDATE_NVM
B3:00A397 C3                CLR      C
B3:00A398 EF                MOV      A,R7
B3:00A399 9440              SUBB     A,#040H
B3:00A39B EE                MOV      A,R6
B3:00A39C 9400              SUBB     A,#00H
B3:00A39E 4006              JC       ?C0009?ZW_FIRMWARE_UPDATE_NVM
B3:00A3A0 A3                INC      DPTR
B3:00A3A1 7440              MOV      A,#040H
B3:00A3A3 F0                MOVX     @DPTR,A
B3:00A3A4 8005              SJMP     ?C0010?ZW_FIRMWARE_UPDATE_NVM
B3:00A3A6         ?C0009?ZW_FIRMWARE_UPDATE_NVM:
B3:00A3A6 90332E            MOV      DPTR,#bytesToRead
B3:00A3A9 EF                MOV      A,R7
B3:00A3AA F0                MOVX     @DPTR,A
B3:00A3AB         ?C0010?ZW_FIRMWARE_UPDATE_NVM:
B3:00A3AB 9111              ACALL    ?L?COM04E1
B3:00A3AD FF                MOV      R7,A
B3:00A3AE 903E70            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00A3B1 E4                CLR      A
B3:00A3B2 F0                MOVX     @DPTR,A
B3:00A3B3 A3                INC      DPTR
B3:00A3B4 EF                MOV      A,R7
B3:00A3B5 F0                MOVX     @DPTR,A
B3:00A3B6 903328            MOV      DPTR,#i
B3:00A3B9 122499            LCALL    ?C?LLDXDATA
B3:00A3BC 123C58            LCALL    _NVM_ext_read_long_buffer
B3:00A3BF 90332E            MOV      DPTR,#bytesToRead
B3:00A3C2 E0                MOVX     A,@DPTR
B3:00A3C3 FF                MOV      R7,A
B3:00A3C4 C3                CLR      C
B3:00A3C5 90332D            MOV      DPTR,#blockLength+01H
B3:00A3C8 E0                MOVX     A,@DPTR
B3:00A3C9 9F                SUBB     A,R7
B3:00A3CA F0                MOVX     @DPTR,A
B3:00A3CB 90332C            MOV      DPTR,#blockLength
B3:00A3CE E0                MOVX     A,@DPTR
B3:00A3CF 9400              SUBB     A,#00H
B3:00A3D1 F0                MOVX     @DPTR,A
B3:00A3D2 903328            MOV      DPTR,#i
B3:00A3D5 1224B5            LCALL    ?C?LLDXDATA0
B3:00A3D8 90332E            MOV      DPTR,#bytesToRead
B3:00A3DB 126DF3            LCALL    ?L?COM0609
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 923


B3:00A3DE 903328            MOV      DPTR,#i
B3:00A3E1 1224F1            LCALL    ?C?LSTXDATA
B3:00A3E4 71F6              ACALL    ?L?COM05A5
B3:00A3E6 9111              ACALL    ?L?COM04E1
B3:00A3E8 FD                MOV      R5,A
B3:00A3E9 12C45D            LCALL    ?L?COM02A6
B3:00A3EC 903320            MOV      DPTR,#crc
B3:00A3EF EE                MOV      A,R6
B3:00A3F0         
B3:00A3F0 F0                MOVX     @DPTR,A
B3:00A3F1 A3                INC      DPTR
B3:00A3F2 EF                MOV      A,R7
B3:00A3F3 F0                MOVX     @DPTR,A
B3:00A3F4 809A              SJMP     ?C0007?ZW_FIRMWARE_UPDATE_NVM
B3:00A3F6         ?C0008?ZW_FIRMWARE_UPDATE_NVM:
B3:;----                  JMP      ?L?COM05A5
----- FUNCTION _ZW_firmwareUpdate_NVM_UpdateCRC16 (END) -------


----- FUNCTION ?L?COM05A5 (BEGIN) -----
B3:00A3F6 903320            MOV      DPTR,#crc
B3:00A3F9 E0                MOVX     A,@DPTR
B3:00A3FA FE                MOV      R6,A
B3:00A3FB A3                INC      DPTR
B3:00A3FC E0                MOVX     A,@DPTR
B3:00A3FD FF                MOV      R7,A
B3:00A3FE 22                RET      
----- FUNCTION ?L?COM05A5 (END) -------


----- FUNCTION ?L?COM02A3 (BEGIN) -----
B3:00A3FF 7171              ACALL    _ZW_firmwareUpdate_NVM_UpdateCRC16
B3:00A401 90435E            MOV      DPTR,#tempCRC
B3:00A404 EE                MOV      A,R6
B3:00A405 F0                MOVX     @DPTR,A
B3:00A406 A3                INC      DPTR
B3:00A407 EF                MOV      A,R7
B3:00A408 F0                MOVX     @DPTR,A
B3:00A409 22                RET      
----- FUNCTION ?L?COM02A3 (END) -------


----- FUNCTION ?L?COM03DA (BEGIN) -----
B3:00A40A FC                MOV      R4,A
B3:00A40B         ?L?COM03DB:
B3:00A40B 903322            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+02H
B3:00A40E 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM03DA (END) -------


----- FUNCTION ?L?COM04E1 (BEGIN) -----
B3:00A411 7B01              MOV      R3,#01H
B3:00A413 7A33              MOV      R2,#HIGH dataBuffer
B3:00A415 792F              MOV      R1,#LOW dataBuffer
B3:00A417 90332E            MOV      DPTR,#bytesToRead
B3:00A41A E0                MOVX     A,@DPTR
B3:00A41B 22                RET      
----- FUNCTION ?L?COM04E1 (END) -------


----- FUNCTION ?L?COM036F (BEGIN) -----
B3:00A41C E0                MOVX     A,@DPTR
B3:00A41D FF                MOV      R7,A
B3:00A41E A3                INC      DPTR
B3:00A41F E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 924


B3:00A420 9020ED            MOV      DPTR,#the_context+0DAH
B3:00A423 CF                XCH      A,R7
B3:00A424 F0                MOVX     @DPTR,A
B3:00A425 A3                INC      DPTR
B3:00A426 EF                MOV      A,R7
B3:00A427 22                RET      
----- FUNCTION ?L?COM036F (END) -------


----- FUNCTION ?L?COM024C (BEGIN) -----
B3:00A428 E4                CLR      A
B3:00A429 7FFF              MOV      R7,#0FFH
B3:00A42B 7EFF              MOV      R6,#0FFH
B3:00A42D FD                MOV      R5,A
B3:00A42E FC                MOV      R4,A
B3:00A42F 903521            MOV      DPTR,#compressionHdr+01H
B3:00A432 1224B5            LCALL    ?C?LLDXDATA0
B3:00A435 D3                SETB     C
B3:00A436 0223D4            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM024C (END) -------


----- FUNCTION ZW_FirmwareUpdate_NVM_isValidCRC16 (BEGIN) -----
B3:00A439 51C4              ACALL    ?L?COM031B
B3:00A43B 7B01              MOV      R3,#01H
B3:00A43D 7A35              MOV      R2,#HIGH compressionHdr
B3:00A43F 7920              MOV      R1,#LOW compressionHdr
B3:00A441 903E70            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00A444 E4                CLR      A
B3:00A445 F0                MOVX     @DPTR,A
B3:00A446 A3                INC      DPTR
B3:00A447 741B              MOV      A,#01BH
B3:00A449 F0                MOVX     @DPTR,A
B3:00A44A 123C58            LCALL    _NVM_ext_read_long_buffer
B3:00A44D 51CA              ACALL    check_compressed_crc
B3:00A44F EF                MOV      A,R7
B3:00A450 C3                CLR      C
B3:00A451 7001              JNZ      ?C0012?ZW_FIRMWARE_UPDATE_NVM
B3:00A453 D3                SETB     C
B3:00A454         ?C0012?ZW_FIRMWARE_UPDATE_NVM:
B3:00A454 22                RET      
----- FUNCTION ZW_FirmwareUpdate_NVM_isValidCRC16 (END) -------


----- FUNCTION _MemoryGetByte (BEGIN) -----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:00A455 023964            LJMP     _NVM_ext_read_byte
----- FUNCTION _MemoryGetByte (END) -------


----- FUNCTION ExploreINIF (BEGIN) -----
B3:00A458 31F4              ACALL    ?L?COM035B
B3:00A45A 7D0A              MOV      R5,#0AH
B3:00A45C E4                CLR      A
B3:00A45D FF                MOV      R7,A
B3:00A45E 1299EF            LCALL    ___ZW_memset
B3:00A461 90097A            MOV      DPTR,#exploreRequestBuffer+04H
B3:00A464 7401              MOV      A,#01H
B3:00A466 F0                MOVX     @DPTR,A
B3:00A467 A3                INC      DPTR
B3:00A468 7426              MOV      A,#026H
B3:00A46A F0                MOVX     @DPTR,A
B3:00A46B 1261F4            LCALL    NetworkManagementGenerateDskpart
B3:00A46E 7B01              MOV      R3,#01H
B3:00A470 7A2B              MOV      R2,#HIGH Dsk+08H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 925


B3:00A472 7943              MOV      R1,#LOW Dsk+08H
B3:00A474 126149            LCALL    ?L?COM0047
B3:00A477 7A09              MOV      R2,#HIGH exploreRequestBuffer+06H
B3:00A479 797C              MOV      R1,#LOW exploreRequestBuffer+06H
B3:00A47B 7F04              MOV      R7,#04H
B3:00A47D 1280A2            LCALL    ___ZW_memcpy
B3:00A480 31EF              ACALL    ?L?COM035A
B3:00A482 900A6F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B3:00A485 740A              MOV      A,#0AH
B3:00A487 F0                MOVX     @DPTR,A
B3:00A488 A3                INC      DPTR
B3:00A489 7410              MOV      A,#010H
B3:00A48B B177              ACALL    ?L?COM01B6
B3:00A48D 7DFF              MOV      R5,#0FFH
B3:00A48F 0292A3            LJMP     _ExploreQueueFrame
----- FUNCTION ExploreINIF (END) -------


----- FUNCTION ZW_FirmwareUpdate_NVM_Init (BEGIN) -----
B3:00A492 E4                CLR      A
B3:00A493 90353F            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00A496 F0                MOVX     @DPTR,A
B3:00A497 7B01              MOV      R3,#01H
B3:00A499 7A35              MOV      R2,#HIGH systemNVM_type
B3:00A49B 790F              MOV      R1,#LOW systemNVM_type
B3:00A49D 126C4A            LCALL    _NVM_get_id
B3:00A4A0 903511            MOV      DPTR,#systemNVM_type+02H
B3:00A4A3 E0                MOVX     A,@DPTR
B3:00A4A4 FF                MOV      R7,A
B3:00A4A5 7411              MOV      A,#011H
B3:00A4A7 D3                SETB     C
B3:00A4A8 9F                SUBB     A,R7
B3:00A4A9 5068              JNC      ?C0001?ZW_FIRMWARE_UPDATE_NVM
B3:00A4AB E4                CLR      A
B3:00A4AC FF                MOV      R7,A
B3:00A4AD FE                MOV      R6,A
B3:00A4AE FD                MOV      R5,A
B3:00A4AF FC                MOV      R4,A
B3:00A4B0 7B01              MOV      R3,#01H
B3:00A4B2 7A42              MOV      R2,#HIGH tempTotalEnd
B3:00A4B4 7935              MOV      R1,#LOW tempTotalEnd
B3:00A4B6 903E70            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00A4B9 F0                MOVX     @DPTR,A
B3:00A4BA A3                INC      DPTR
B3:00A4BB 7402              MOV      A,#02H
B3:00A4BD F0                MOVX     @DPTR,A
B3:00A4BE 123C58            LCALL    _NVM_ext_read_long_buffer
B3:00A4C1 904235            MOV      DPTR,#tempTotalEnd
B3:00A4C4 12E50A            LCALL    ?L?COM00B0
B3:00A4C7 B134              ACALL    ?L?COM0543
B3:00A4C9 51C4              ACALL    ?L?COM031B
B3:00A4CB EF                MOV      A,R7
B3:00A4CC 2402              ADD      A,#02H
B3:00A4CE 1249DE            LCALL    ?L?COM0075
B3:00A4D1 FC                MOV      R4,A
B3:00A4D2 B134              ACALL    ?L?COM0543
B3:00A4D4 903BFC            MOV      DPTR,#NVRbNVMPageSize+01H
B3:00A4D7 E0                MOVX     A,@DPTR
B3:00A4D8 24FF              ADD      A,#0FFH
B3:00A4DA FF                MOV      R7,A
B3:00A4DB 903BFB            MOV      DPTR,#NVRbNVMPageSize
B3:00A4DE E0                MOVX     A,@DPTR
B3:00A4DF 34FF              ADDC     A,#0FFH
B3:00A4E1 FE                MOV      R6,A
B3:00A4E2 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 926


B3:00A4E3 FC                MOV      R4,A
B3:00A4E4 FD                MOV      R5,A
B3:00A4E5 90353B            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00A4E8 1224B5            LCALL    ?C?LLDXDATA0
B3:00A4EB 1223A3            LCALL    ?C?LAND
B3:00A4EE 904233            MOV      DPTR,#misalignment
B3:00A4F1 EE                MOV      A,R6
B3:00A4F2 F0                MOVX     @DPTR,A
B3:00A4F3 A3                INC      DPTR
B3:00A4F4 EF                MOV      A,R7
B3:00A4F5 F0                MOVX     @DPTR,A
B3:00A4F6 90353B            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00A4F9 1224B5            LCALL    ?C?LLDXDATA0
B3:00A4FC 904233            MOV      DPTR,#misalignment
B3:00A4FF 1265F9            LCALL    ?L?COM0199
B3:00A502 12729E            LCALL    ?L?COM0441
B3:00A505 E4                CLR      A
B3:00A506 FC                MOV      R4,A
B3:00A507 FD                MOV      R5,A
B3:00A508 12226B            LCALL    ?C?LADD
B3:00A50B B134              ACALL    ?L?COM0543
B3:00A50D 90353F            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00A510 7401              MOV      A,#01H
B3:00A512 F0                MOVX     @DPTR,A
B3:00A513         ?C0001?ZW_FIRMWARE_UPDATE_NVM:
B3:00A513 90353F            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00A516 E0                MOVX     A,@DPTR
B3:00A517 FB                MOV      R3,A
B3:00A518 6017              JZ       ?C0002?ZW_FIRMWARE_UPDATE_NVM
B3:00A51A E4                CLR      A
B3:00A51B FF                MOV      R7,A
B3:00A51C FE                MOV      R6,A
B3:00A51D 7D02              MOV      R5,#02H
B3:00A51F FC                MOV      R4,A
B3:00A520 903511            MOV      DPTR,#systemNVM_type+02H
B3:00A523 E0                MOVX     A,@DPTR
B3:00A524 24EF              ADD      A,#0EFH
B3:00A526 F9                MOV      R1,A
B3:00A527 F8                MOV      R0,A
B3:00A528 1223F8            LCALL    ?C?LSHL
B3:00A52B 903509            MOV      DPTR,#systemNVM_Size
B3:00A52E 1224F1            LCALL    ?C?LSTXDATA
B3:00A531         ?C0002?ZW_FIRMWARE_UPDATE_NVM:
B3:00A531 AF03              MOV      R7,AR3
B3:00A533 22                RET      
----- FUNCTION ZW_FirmwareUpdate_NVM_Init (END) -------


----- FUNCTION ?L?COM0543 (BEGIN) -----
B3:00A534 90353B            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00A537 0224F1            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM0543 (END) -------


----- FUNCTION ?L?COM02BF (BEGIN) -----
B3:00A53A 7E12              MOV      R6,#HIGH span_mpan_table
B3:00A53C 7F95              MOV      R7,#LOW span_mpan_table
B3:00A53E E4                CLR      A
B3:00A53F FC                MOV      R4,A
B3:00A540 FD                MOV      R5,A
B3:00A541         ?L?COM02C0:
B3:00A541 903501            MOV      DPTR,#s2_ctx
B3:00A544 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM02BF (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 927



----- FUNCTION s2_busy (BEGIN) -----
B3:00A547 B141              ACALL    ?L?COM02C0
B3:00A549 E9                MOV      A,R1
B3:00A54A 240F              ADD      A,#0FH
B3:00A54C B160              ACALL    ?L?COM05A8
B3:00A54E 7009              JNZ      ?C0044?ZW_SECURITY_SCHEME2
B3:00A550 B141              ACALL    ?L?COM02C0
B3:00A552 E9                MOV      A,R1
B3:00A553 240D              ADD      A,#0DH
B3:00A555 B160              ACALL    ?L?COM05A8
B3:00A557 6004              JZ       ?C0042?ZW_SECURITY_SCHEME2
B3:00A559         ?C0044?ZW_SECURITY_SCHEME2:
B3:00A559 7F01              MOV      R7,#01H
B3:00A55B 8002              SJMP     ?C0043?ZW_SECURITY_SCHEME2
B3:00A55D         ?C0042?ZW_SECURITY_SCHEME2:
B3:00A55D 7F00              MOV      R7,#00H
B3:00A55F         ?C0043?ZW_SECURITY_SCHEME2:
B3:00A55F 22                RET      
----- FUNCTION s2_busy (END) -------


----- FUNCTION ?L?COM05A8 (BEGIN) -----
B3:00A560 F9                MOV      R1,A
B3:00A561 EA                MOV      A,R2
B3:00A562 3402              ADDC     A,#02H
B3:00A564 FA                MOV      R2,A
B3:00A565 021FB3            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM05A8 (END) -------


----- FUNCTION ?L?COM01B5 (BEGIN) -----
B3:00A568 7B01              MOV      R3,#01H
B3:00A56A 7A09              MOV      R2,#HIGH exploreSearchResultBuffer
B3:00A56C 795E              MOV      R1,#LOW exploreSearchResultBuffer
B3:00A56E 900A1F            MOV      DPTR,#?_TransportEnQueueExploreFrame?BYTE+05H
B3:00A571 7419              MOV      A,#019H
B3:00A573 F0                MOVX     @DPTR,A
B3:00A574 A3                INC      DPTR
B3:00A575 7440              MOV      A,#040H
B3:00A577         ?L?COM01B6:
B3:00A577 F0                MOVX     @DPTR,A
B3:00A578 E4                CLR      A
B3:00A579 A3                INC      DPTR
B3:00A57A F0                MOVX     @DPTR,A
B3:00A57B A3                INC      DPTR
B3:00A57C F0                MOVX     @DPTR,A
B3:00A57D 22                RET      
----- FUNCTION ?L?COM01B5 (END) -------


----- FUNCTION ZW_GetNVRRevision (BEGIN) -----
B3:00A57E 90123D            MOV      DPTR,#bNVRValid
B3:00A581 E0                MOVX     A,@DPTR
B3:00A582 6004              JZ       ?C0015?ZW_NVR
B3:00A584 7F10              MOV      R7,#010H
B3:00A586 E16B              AJMP     _ZW_FLASH_nvr0_get
B3:00A588         ?C0015?ZW_NVR:
B3:00A588 7FFF              MOV      R7,#0FFH
B3:00A58A 22                RET      
----- FUNCTION ZW_GetNVRRevision (END) -------


----- FUNCTION ?L?COM015C (BEGIN) -----
B3:00A58B 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 928


B3:00A58D         ?L?COM015D:
B3:00A58D 90371D            MOV      DPTR,#?_AES_CTR_DRBG_Generate?BYTE+03H
B3:00A590 1225A9            LCALL    ?C?PSTXDATA
B3:00A593 7A23              MOV      R2,#HIGH s2_ctr_drbg
B3:00A595 796B              MOV      R1,#LOW s2_ctr_drbg
B3:00A597 021B29            LJMP     ?INTERBANK_TABLE?_AES_CTR_DRBG_Generate
----- FUNCTION ?L?COM015C (END) -------


----- FUNCTION ?L?COM0335 (BEGIN) -----
B3:00A59A 7B01              MOV      R3,#01H
B3:00A59C 7A20              MOV      R2,#HIGH the_context+0CFH
B3:00A59E 79E2              MOV      R1,#LOW the_context+0CFH
----- FUNCTION ___find_span_by_node (BEGIN) -----
B3:00A5A0 903A85            MOV      DPTR,#con
B3:00A5A3 1225A9            LCALL    ?C?PSTXDATA
B3:00A5A6 D1D5              ACALL    ?L?COM0604
B3:00A5A8         ?C0014?S2:
B3:00A5A8 903A98            MOV      DPTR,#i
B3:00A5AB 1265F9            LCALL    ?L?COM0199
B3:00A5AE 9405              SUBB     A,#05H
B3:00A5B0 EE                MOV      A,R6
B3:00A5B1 6480              XRL      A,#080H
B3:00A5B3 9480              SUBB     A,#080H
B3:00A5B5 504C              JNC      ?C0015?S2
B3:00A5B7 7A21              MOV      R2,#HIGH the_context+0106H
B3:00A5B9 7919              MOV      R1,#LOW the_context+0106H
B3:00A5BB 12710A            LCALL    ?L?COM0284
B3:00A5BE 7427              MOV      A,#027H
B3:00A5C0 D1C1              ACALL    ?L?COM0198
B3:00A5C2 6037              JZ       ?C0016?S2
B3:00A5C4 7A21              MOV      R2,#HIGH the_context+0101H
B3:00A5C6 7914              MOV      R1,#LOW the_context+0101H
B3:00A5C8 903A98            MOV      DPTR,#i
B3:00A5CB A3                INC      DPTR
B3:00A5CC E0                MOVX     A,@DPTR
B3:00A5CD F582              MOV      DPL,A
B3:00A5CF 8E83              MOV      DPH,R6
B3:00A5D1 7427              MOV      A,#027H
B3:00A5D3 D1C1              ACALL    ?L?COM0198
B3:00A5D5 FD                MOV      R5,A
B3:00A5D6 903A85            MOV      DPTR,#con
B3:00A5D9 122589            LCALL    ?C?PLDXDATA
B3:00A5DC 121FB3            LCALL    ?C?CLDPTR
B3:00A5DF 6D                XRL      A,R5
B3:00A5E0 7019              JNZ      ?C0016?S2
B3:00A5E2 7A21              MOV      R2,#HIGH the_context+0102H
B3:00A5E4 7915              MOV      R1,#LOW the_context+0102H
B3:00A5E6 D1C7              ACALL    ?L?COM031D
B3:00A5E8 7427              MOV      A,#027H
B3:00A5EA D1C1              ACALL    ?L?COM0198
B3:00A5EC FF                MOV      R7,A
B3:00A5ED 903A85            MOV      DPTR,#con
B3:00A5F0 129276            LCALL    ?L?COM0065
B3:00A5F3 B50705            CJNE     A,AR7,?C0016?S2
B3:00A5F6 903A98            MOV      DPTR,#i
B3:00A5F9 C19E              AJMP     ?C0275?S2
B3:00A5FB         ?C0016?S2:
B3:00A5FB 903A98            MOV      DPTR,#i
B3:00A5FE 123F7F            LCALL    ?L?COM0081
B3:00A601 80A5              SJMP     ?C0014?S2
B3:00A603         ?C0015?S2:
B3:00A603 7B01              MOV      R3,#01H
B3:00A605 7A3A              MOV      R2,#HIGH rnd
B3:00A607 7988              MOV      R1,#LOW rnd
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 929


B3:00A609 B18D              ACALL    ?L?COM015D
B3:00A60B D1D5              ACALL    ?L?COM0604
B3:00A60D         ?C0019?S2:
B3:00A60D 903A98            MOV      DPTR,#i
B3:00A610 1265F9            LCALL    ?L?COM0199
B3:00A613 9405              SUBB     A,#05H
B3:00A615 EE                MOV      A,R6
B3:00A616 6480              XRL      A,#080H
B3:00A618 9480              SUBB     A,#080H
B3:00A61A 5014              JNC      ?C0020?S2
B3:00A61C 7A21              MOV      R2,#HIGH the_context+0106H
B3:00A61E 7919              MOV      R1,#LOW the_context+0106H
B3:00A620 D1C7              ACALL    ?L?COM031D
B3:00A622 7427              MOV      A,#027H
B3:00A624 D1C1              ACALL    ?L?COM0198
B3:00A626 6008              JZ       ?C0020?S2
B3:00A628         ?C0022?S2:
B3:00A628         ?C0021?S2:
B3:00A628 903A98            MOV      DPTR,#i
B3:00A62B 123F7F            LCALL    ?L?COM0081
B3:00A62E 80DD              SJMP     ?C0019?S2
B3:00A630         ?C0020?S2:
B3:00A630 903A98            MOV      DPTR,#i
B3:00A633 E0                MOVX     A,@DPTR
B3:00A634 7004              JNZ      ?C0266?S2
B3:00A636 A3                INC      DPTR
B3:00A637 E0                MOVX     A,@DPTR
B3:00A638 6405              XRL      A,#05H
B3:00A63A         ?C0266?S2:
B3:00A63A 700A              JNZ      ?C0023?S2
B3:00A63C 903A88            MOV      DPTR,#rnd
B3:00A63F E0                MOVX     A,@DPTR
B3:00A640 903A98            MOV      DPTR,#i
B3:00A643 12C8FD            LCALL    ?L?COM04AA
B3:00A646         ?C0023?S2:
B3:00A646 7B01              MOV      R3,#01H
B3:00A648 7A21              MOV      R2,#HIGH the_context+0106H
B3:00A64A 7919              MOV      R1,#LOW the_context+0106H
B3:00A64C 903A98            MOV      DPTR,#i
B3:00A64F 12D53C            LCALL    ?L?COM0180
B3:00A652 D1CE              ACALL    ?L?COM05E0
B3:00A654 7401              MOV      A,#01H
B3:00A656 122084            LCALL    ?C?CSTOPTR
B3:00A659 903A85            MOV      DPTR,#con
B3:00A65C 122589            LCALL    ?C?PLDXDATA
B3:00A65F 121FB3            LCALL    ?C?CLDPTR
B3:00A662 FD                MOV      R5,A
B3:00A663 7B01              MOV      R3,#01H
B3:00A665 7A21              MOV      R2,#HIGH the_context+0101H
B3:00A667 7914              MOV      R1,#LOW the_context+0101H
B3:00A669 8F82              MOV      DPL,R7
B3:00A66B D1CE              ACALL    ?L?COM05E0
B3:00A66D ED                MOV      A,R5
B3:00A66E 122084            LCALL    ?C?CSTOPTR
B3:00A671 903A85            MOV      DPTR,#con
B3:00A674 129276            LCALL    ?L?COM0065
B3:00A677 FF                MOV      R7,A
B3:00A678 7B01              MOV      R3,#01H
B3:00A67A 7A21              MOV      R2,#HIGH the_context+0102H
B3:00A67C 7915              MOV      R1,#LOW the_context+0102H
B3:00A67E 903A98            MOV      DPTR,#i
B3:00A681 12515D            LCALL    ?L?COM0154
B3:00A684 7427              MOV      A,#027H
B3:00A686 D1E3              ACALL    ?L?COM0339
B3:00A688 903A89            MOV      DPTR,#rnd+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 930


B3:00A68B E0                MOVX     A,@DPTR
B3:00A68C FF                MOV      R7,A
B3:00A68D 7A21              MOV      R2,#HIGH the_context+0104H
B3:00A68F 7917              MOV      R1,#LOW the_context+0104H
B3:00A691 8D82              MOV      DPL,R5
B3:00A693 8C83              MOV      DPH,R4
B3:00A695 7427              MOV      A,#027H
B3:00A697 D1E3              ACALL    ?L?COM0339
B3:00A699 903A98            MOV      DPTR,#i
B3:00A69C E0                MOVX     A,@DPTR
B3:00A69D FE                MOV      R6,A
B3:00A69E         
B3:00A69E 7D27              MOV      R5,#027H
B3:00A6A0 12C8DB            LCALL    ?L?COM041D
B3:00A6A3 74F3              MOV      A,#LOW the_context+0E0H
B3:00A6A5 2F                ADD      A,R7
B3:00A6A6 F9                MOV      R1,A
B3:00A6A7 7420              MOV      A,#HIGH the_context+0E0H
B3:00A6A9 3E                ADDC     A,R6
B3:00A6AA FE                MOV      R6,A
B3:00A6AB AF01              MOV      R7,AR1
B3:00A6AD 9020EF            MOV      DPTR,#the_context+0DCH
B3:00A6B0 F0                MOVX     @DPTR,A
B3:00A6B1 A3                INC      DPTR
B3:00A6B2 EF                MOV      A,R7
B3:00A6B3 F0                MOVX     @DPTR,A
B3:00A6B4 22                RET      
----- FUNCTION ___find_span_by_node (END) -------


----- FUNCTION ?L?COM0195 (BEGIN) -----
B3:00A6B5 7B01              MOV      R3,#01H
B3:00A6B7 7A21              MOV      R2,#HIGH the_context+01B6H
B3:00A6B9 79C9              MOV      R1,#LOW the_context+01B6H
B3:00A6BB         ?L?COM0196:
B3:00A6BB 8F82              MOV      DPL,R7
B3:00A6BD         ?L?COM0197:
B3:00A6BD 8E83              MOV      DPH,R6
B3:00A6BF 7414              MOV      A,#014H
B3:00A6C1         ?L?COM0198:
B3:00A6C1 12256C            LCALL    ?C?OFFX256
B3:00A6C4 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0195 (END) -------


----- FUNCTION ?L?COM031D (BEGIN) -----
B3:00A6C7 7B01              MOV      R3,#01H
B3:00A6C9 8F82              MOV      DPL,R7
B3:00A6CB 8E83              MOV      DPH,R6
B3:00A6CD 22                RET      
----- FUNCTION ?L?COM031D (END) -------


----- FUNCTION ?L?COM05E0 (BEGIN) -----
B3:00A6CE 8E83              MOV      DPH,R6
B3:00A6D0 7427              MOV      A,#027H
B3:00A6D2 02256C            LJMP     ?C?OFFX256
----- FUNCTION ?L?COM05E0 (END) -------


----- FUNCTION ?L?COM0604 (BEGIN) -----
B3:00A6D5 E4                CLR      A
B3:00A6D6 903A98            MOV      DPTR,#i
B3:00A6D9 F0                MOVX     @DPTR,A
B3:00A6DA A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 931


B3:00A6DB F0                MOVX     @DPTR,A
B3:00A6DC 22                RET      
----- FUNCTION ?L?COM0604 (END) -------


----- FUNCTION ?L?COM0338 (BEGIN) -----
B3:00A6DD 8D82              MOV      DPL,R5
B3:00A6DF 8C83              MOV      DPH,R4
B3:00A6E1 7414              MOV      A,#014H
B3:00A6E3         ?L?COM0339:
B3:00A6E3 12256C            LCALL    ?C?OFFX256
B3:00A6E6 EF                MOV      A,R7
B3:00A6E7 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0338 (END) -------


----- FUNCTION _ZW_NVRGetValue (BEGIN) -----
B3:00A6EA 904195            MOV      DPTR,#bOffset
B3:00A6ED 124765            LCALL    ?L?COM0102
B3:00A6F0 1225A9            LCALL    ?C?PSTXDATA
B3:00A6F3         ?C0001?ZW_NVR:
B3:00A6F3 904196            MOV      DPTR,#bLength
B3:00A6F6 E0                MOVX     A,@DPTR
B3:00A6F7 6046              JZ       ?C0007?ZW_NVR
B3:00A6F9 90123D            MOV      DPTR,#bNVRValid
B3:00A6FC E0                MOVX     A,@DPTR
B3:00A6FD 6012              JZ       ?C0003?ZW_NVR
B3:00A6FF 904195            MOV      DPTR,#bOffset
B3:00A702 E0                MOVX     A,@DPTR
B3:00A703 2410              ADD      A,#010H
B3:00A705 FF                MOV      R7,A
B3:00A706 F16B              ACALL    _ZW_FLASH_nvr0_get
B3:00A708 904197            MOV      DPTR,#bRetBuffer
B3:00A70B 122589            LCALL    ?C?PLDXDATA
B3:00A70E EF                MOV      A,R7
B3:00A70F 8017              SJMP     ?C0019?ZW_NVR
B3:00A711         ?C0003?ZW_NVR:
B3:00A711 904195            MOV      DPTR,#bOffset
B3:00A714 E0                MOVX     A,@DPTR
B3:00A715 6401              XRL      A,#01H
B3:00A717 904197            MOV      DPTR,#bRetBuffer
B3:00A71A 7007              JNZ      ?C0005?ZW_NVR
B3:00A71C 122589            LCALL    ?C?PLDXDATA
B3:00A71F 7480              MOV      A,#080H
B3:00A721         
B3:00A721 8005              SJMP     ?C0019?ZW_NVR
B3:00A723         ?C0005?ZW_NVR:
B3:00A723 122589            LCALL    ?C?PLDXDATA
B3:00A726 74FF              MOV      A,#0FFH
B3:00A728         
B3:00A728 122072            LCALL    ?C?CSTPTR
B3:00A72B         ?C0004?ZW_NVR:
B3:00A72B 904198            MOV      DPTR,#bRetBuffer+01H
B3:00A72E 123F7F            LCALL    ?L?COM0081
B3:00A731 904196            MOV      DPTR,#bLength
B3:00A734 E0                MOVX     A,@DPTR
B3:00A735 14                DEC      A
B3:00A736 F0                MOVX     @DPTR,A
B3:00A737 904195            MOV      DPTR,#bOffset
B3:00A73A E0                MOVX     A,@DPTR
B3:00A73B 04                INC      A
B3:00A73C F0                MOVX     @DPTR,A
B3:00A73D 80B4              SJMP     ?C0001?ZW_NVR
B3:00A73F         ?C0007?ZW_NVR:
B3:00A73F 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 932


----- FUNCTION _ZW_NVRGetValue (END) -------


----- FUNCTION S2_init_prng (BEGIN) -----
B3:00A740 7B01              MOV      R3,#01H
B3:00A742 7A37              MOV      R2,#HIGH entropy
B3:00A744 79F1              MOV      R1,#LOW entropy
B3:00A746 7D20              MOV      R5,#020H
B3:00A748 12E01C            LCALL    _S2_get_hw_random
B3:00A74B 7B01              MOV      R3,#01H
B3:00A74D 7A37              MOV      R2,#HIGH entropy
B3:00A74F 79F1              MOV      R1,#LOW entropy
B3:00A751 903EA2            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+03H
B3:00A754 1225A9            LCALL    ?C?PSTXDATA
B3:00A757 7A23              MOV      R2,#HIGH zeros
B3:00A759 794B              MOV      R1,#LOW zeros
B3:00A75B 903EA5            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+06H
B3:00A75E 1225A9            LCALL    ?C?PSTXDATA
B3:00A761 7A23              MOV      R2,#HIGH s2_ctr_drbg
B3:00A763 796B              MOV      R1,#LOW s2_ctr_drbg
B3:00A765 021B24            LJMP     ?INTERBANK_TABLE?_AES_CTR_DRBG_Instantiate
----- FUNCTION S2_init_prng (END) -------


----- FUNCTION _ZW_GetSecurityS2PublicDSK (BEGIN) -----
;---- Variable 'buf' assigned to Register 'R1/R2/R3' ----
B3:00A768 021AD4            LJMP     ?INTERBANK_TABLE?_keystore_public_dsk_read
----- FUNCTION _ZW_GetSecurityS2PublicDSK (END) -------


----- FUNCTION _ZW_FLASH_nvr0_get (BEGIN) -----
;---- Variable 'bNvrAddress' assigned to Register 'R7' ----
B3:00A76B 75FF03            MOV      SFRPAGE,#03H
B3:00A76E E4                CLR      A
B3:00A76F F597              MOV      NVRCON,A
B3:00A771 12E567            LCALL    ?L?COM05A2
B3:00A774         ?C0001?ZW_PHY_FLASH_050X:
B3:00A774 E597              MOV      A,NVRCON
B3:00A776 20E1FB            JB       ACC.1,?C0001?ZW_PHY_FLASH_050X
B3:00A779         ?C0002?ZW_PHY_FLASH_050X:
B3:00A779 75FF03            MOV      SFRPAGE,#03H
B3:00A77C AF99              MOV      R7,NVRDATA
B3:00A77E 22                RET      
----- FUNCTION _ZW_FLASH_nvr0_get (END) -------


----- FUNCTION ?L?COM0097 (BEGIN) -----
B3:00A77F E4                CLR      A
B3:00A780 90259D            MOV      DPTR,#the_tx_session
B3:00A783 F0                MOVX     @DPTR,A
B3:00A784 7B01              MOV      R3,#01H
B3:00A786 7A25              MOV      R2,#HIGH the_tx_session+0BH
B3:00A788 79A8              MOV      R1,#LOW the_tx_session+0BH
B3:00A78A 121B15            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00A78D 9025E7            MOV      DPTR,#the_tx_session+04AH
B3:00A790         ?L?COM0098:
B3:00A790 E0                MOVX     A,@DPTR
B3:00A791 FE                MOV      R6,A
B3:00A792 A3                INC      DPTR
B3:00A793 E0                MOVX     A,@DPTR
B3:00A794 FF                MOV      R7,A
B3:00A795 4E                ORL      A,R6
B3:00A796 22                RET      
----- FUNCTION ?L?COM0097 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 933



----- FUNCTION s2_restore_spans_and_mpans (BEGIN) -----
B3:00A797 12E126            LCALL    ?L?COM0610
B3:00A79A 123967            LCALL    _NVM_ext_read_long_byte
B3:00A79D EF                MOV      A,R7
B3:00A79E 6010              JZ       ?C0039?ZW_SECURITY_SCHEME2
B3:00A7A0 B13A              ACALL    ?L?COM02BF
B3:00A7A2 E9                MOV      A,R1
B3:00A7A3 24E0              ADD      A,#0E0H
B3:00A7A5 F9                MOV      R1,A
B3:00A7A6 E4                CLR      A
B3:00A7A7 903E70            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00A7AA 12E12E            LCALL    ?L?COM0549
B3:00A7AD 123C58            LCALL    _NVM_ext_read_long_buffer
B3:00A7B0         ?C0039?ZW_SECURITY_SCHEME2:
B3:00A7B0 22                RET      
----- FUNCTION s2_restore_spans_and_mpans (END) -------


----- FUNCTION ?L?COM01B3 (BEGIN) -----
B3:00A7B1 7D01              MOV      R5,#01H
B3:00A7B3         ?L?COM01B4:
B3:00A7B3 7E00              MOV      R6,#00H
B3:00A7B5 7F10              MOV      R7,#010H
B3:00A7B7 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM01B3 (END) -------


----- FUNCTION ?L?COM0333 (BEGIN) -----
B3:00A7BA 7B01              MOV      R3,#01H
B3:00A7BC 7A20              MOV      R2,#HIGH the_context
B3:00A7BE 7913              MOV      R1,#LOW the_context
B3:00A7C0 22                RET      
----- FUNCTION ?L?COM0333 (END) -------


----- FUNCTION SampleNoiseLevel (BEGIN) -----
B3:00A7C1 125E54            LCALL    RF_mode_get
B3:00A7C4 EF                MOV      A,R7
B3:00A7C5 6401              XRL      A,#01H
B3:00A7C7 7069              JNZ      ?C0004?ZW_NOISE_DETECT
B3:00A7C9         ?C0003?ZW_NOISE_DETECT:
B3:00A7C9 126B41            LCALL    RF_channel_get
B3:00A7CC 90434C            MOV      DPTR,#currentChannel
B3:00A7CF EF                MOV      A,R7
B3:00A7D0 F0                MOVX     @DPTR,A
B3:00A7D1 D3                SETB     C
B3:00A7D2 9402              SUBB     A,#02H
B3:00A7D4 505C              JNC      ?C0004?ZW_NOISE_DETECT
B3:00A7D6         ?C0005?ZW_NOISE_DETECT:
B3:00A7D6 90406D            MOV      DPTR,#bNextChannelToSample
B3:00A7D9 E0                MOVX     A,@DPTR
B3:00A7DA FF                MOV      R7,A
B3:00A7DB 90434C            MOV      DPTR,#currentChannel
B3:00A7DE E0                MOVX     A,@DPTR
B3:00A7DF 6F                XRL      A,R7
B3:00A7E0 7050              JNZ      ?C0004?ZW_NOISE_DETECT
B3:00A7E2         ?C0006?ZW_NOISE_DETECT:
B3:00A7E2 125ED6            LCALL    RF_instant_rssi_get
B3:00A7E5 90434D            MOV      DPTR,#rssi_value
B3:00A7E8 EF                MOV      A,R7
B3:00A7E9 F0                MOVX     @DPTR,A
B3:00A7EA 7B01              MOV      R3,#01H
B3:00A7EC 7A43              MOV      R2,#HIGH rssi_value
B3:00A7EE 794D              MOV      R1,#LOW rssi_value
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 934


B3:00A7F0 7D01              MOV      R5,#01H
B3:00A7F2 12198A            LCALL    ?INTERBANK_TABLE?_CalculateRssi
B3:00A7F5 90434C            MOV      DPTR,#currentChannel
B3:00A7F8 E0                MOVX     A,@DPTR
B3:00A7F9 2469              ADD      A,#LOW sInternal_noise_levels
B3:00A7FB F582              MOV      DPL,A
B3:00A7FD E4                CLR      A
B3:00A7FE 3440              ADDC     A,#HIGH sInternal_noise_levels
B3:00A800 F583              MOV      DPH,A
B3:00A802 EF                MOV      A,R7
B3:00A803 F0                MOVX     @DPTR,A
B3:00A804 90406D            MOV      DPTR,#bNextChannelToSample
B3:00A807 E0                MOVX     A,@DPTR
B3:00A808 04                INC      A
B3:00A809 5401              ANL      A,#01H
B3:00A80B F0                MOVX     @DPTR,A
B3:00A80C 7024              JNZ      ?C0004?ZW_NOISE_DETECT
B3:00A80E 90406B            MOV      DPTR,#_cbFuncNoiseDetect
B3:00A811 E0                MOVX     A,@DPTR
B3:00A812 7002              JNZ      ?C0011?ZW_NOISE_DETECT
B3:00A814 A3                INC      DPTR
B3:00A815 E0                MOVX     A,@DPTR
B3:00A816         ?C0011?ZW_NOISE_DETECT:
B3:00A816 601A              JZ       ?C0004?ZW_NOISE_DETECT
B3:00A818 7B01              MOV      R3,#01H
B3:00A81A 7A40              MOV      R2,#HIGH cb_shadow_noise_levels
B3:00A81C 7967              MOV      R1,#LOW cb_shadow_noise_levels
B3:00A81E 12D85C            LCALL    _ZW_GetBackgroundRSSI
B3:00A821 7B01              MOV      R3,#01H
B3:00A823 7A40              MOV      R2,#HIGH cb_shadow_noise_levels
B3:00A825 7967              MOV      R1,#LOW cb_shadow_noise_levels
B3:00A827 90406B            MOV      DPTR,#_cbFuncNoiseDetect
B3:00A82A 12D53C            LCALL    ?L?COM0180
B3:00A82D 8E83              MOV      DPH,R6
B3:00A82F 12271A            LCALL    ?C?ICALL2
B3:00A832         ?C0004?ZW_NOISE_DETECT:
B3:00A832 22                RET      
----- FUNCTION SampleNoiseLevel (END) -------


----- FUNCTION s2_inclusion_neighbor_discovery_complete (BEGIN) -----
B3:00A833 7F0E              MOV      R7,#0EH
B3:00A835 7E02              MOV      R6,#02H
B3:00A837 8040              SJMP     _process_event
----- FUNCTION s2_inclusion_neighbor_discovery_complete (END) -------


----- FUNCTION _ExploreSetNWI (BEGIN) -----
;---- Variable 'mode' assigned to Register 'R7' ----
B3:00A839 E4                CLR      A
B3:00A83A F550              MOV      bNetworkWideInclusion,A
B3:00A83C EF                MOV      A,R7
B3:00A83D 24FF              ADD      A,#0FFH
B3:00A83F 920C              MOV      exploreInclusionModeRepeat,C
B3:00A841 EF                MOV      A,R7
B3:00A842 6003              JZ       ?C0008?ZW_EXPLORE_SUPPORT
B3:00A844 02D65C            LJMP     NWIStartTimer
B3:00A847         ?C0008?ZW_EXPLORE_SUPPORT:
B3:;----                  JMP      NWIStopTimer
----- FUNCTION _ExploreSetNWI (END) -------


----- FUNCTION NWIStopTimer (BEGIN) -----
B3:00A847 7B01              MOV      R3,#01H
B3:00A849 7A42              MOV      R2,#HIGH networkWideInclusionModeTimer
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 935


B3:00A84B 792A              MOV      R1,#LOW networkWideInclusionModeTimer
B3:00A84D 02523C            LJMP     _SafeTimerStop
----- FUNCTION NWIStopTimer (END) -------


----- FUNCTION _s2_inclusion_joining_start (BEGIN) -----
B3:00A850 904395            MOV      DPTR,#csa
B3:00A853 ED                MOV      A,R5
B3:00A854 F0                MOVX     @DPTR,A
;---- Variable 'p_connection' assigned to Register 'R1/R2/R3' ----
B3:00A855 78E2              MOV      R0,#LOW the_context+0CFH
B3:00A857 7C20              MOV      R4,#HIGH the_context+0CFH
B3:00A859 7D01              MOV      R5,#01H
B3:00A85B 12D589            LCALL    ?L?COM00DE
B3:00A85E 904395            MOV      DPTR,#csa
B3:00A861 E0                MOVX     A,@DPTR
B3:00A862 7F01              MOV      R7,#01H
B3:00A864 6002              JZ       ?C0047?S2_INCLUSION
B3:00A866 7F00              MOV      R7,#00H
B3:00A868         ?C0047?S2_INCLUSION:
B3:00A868         ?C0048?S2_INCLUSION:
B3:00A868 902223            MOV      DPTR,#the_context+0210H
B3:00A86B EF                MOV      A,R7
B3:00A86C F0                MOVX     @DPTR,A
B3:00A86D 7F01              MOV      R7,#01H
B3:00A86F 7E02              MOV      R6,#02H
B3:00A871 8006              SJMP     _process_event
----- FUNCTION _s2_inclusion_joining_start (END) -------


----- FUNCTION ?L?COM04DE (BEGIN) -----
B3:00A873 5123              ACALL    _inclusion_failed_frame_send
B3:00A875 7F0B              MOV      R7,#0BH
B3:00A877 7E02              MOV      R6,#02H
----- FUNCTION _process_event (BEGIN) -----
;---- Variable 'evt' assigned to Register 'R6/R7' ----
B3:00A879 9042F5            MOV      DPTR,#event
B3:00A87C 1265F2            LCALL    ?L?COM043B
B3:00A87F 9042F4            MOV      DPTR,#i
B3:00A882 F0                MOVX     @DPTR,A
B3:00A883         ?C0002?S2_INCLUSION:
B3:00A883 9042F4            MOV      DPTR,#i
B3:00A886 E0                MOVX     A,@DPTR
B3:00A887 FF                MOV      R7,A
B3:00A888 C3                CLR      C
B3:00A889 943B              SUBB     A,#03BH
B3:00A88B 4002              JC       $ + 4H
B3:00A88D 2161              AJMP     ?C0028?S2_INCLUSION
B3:00A88F 75F005            MOV      B,#05H
B3:00A892 EF                MOV      A,R7
B3:00A893 90260E            MOV      DPTR,#s2_transition_table
B3:00A896 12257D            LCALL    ?C?OFFXADD
B3:00A899 E0                MOVX     A,@DPTR
B3:00A89A FF                MOV      R7,A
B3:00A89B 902222            MOV      DPTR,#the_context+020FH
B3:00A89E E0                MOVX     A,@DPTR
B3:00A89F FE                MOV      R6,A
B3:00A8A0 6F                XRL      A,R7
B3:00A8A1 6007              JZ       ?C0006?S2_INCLUSION
B3:00A8A3 EF                MOV      A,R7
B3:00A8A4 6414              XRL      A,#014H
B3:00A8A6 6002              JZ       $ + 4H
B3:00A8A8 2159              AJMP     ?C0004?S2_INCLUSION
B3:00A8AA         ?C0006?S2_INCLUSION:
B3:00A8AA 9042F4            MOV      DPTR,#i
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 936


B3:00A8AD E0                MOVX     A,@DPTR
B3:00A8AE 90260F            MOV      DPTR,#s2_transition_table+01H
B3:00A8B1 3162              ACALL    ?L?COM04A8
B3:00A8B3 FC                MOV      R4,A
B3:00A8B4 A3                INC      DPTR
B3:00A8B5 E0                MOVX     A,@DPTR
B3:00A8B6 FD                MOV      R5,A
B3:00A8B7 9042F5            MOV      DPTR,#event
B3:00A8BA E0                MOVX     A,@DPTR
B3:00A8BB 6C                XRL      A,R4
B3:00A8BC 7003              JNZ      ?C0132?S2_INCLUSION
B3:00A8BE A3                INC      DPTR
B3:00A8BF E0                MOVX     A,@DPTR
B3:00A8C0 6D                XRL      A,R5
B3:00A8C1         ?C0132?S2_INCLUSION:
B3:00A8C1 600C              JZ       ?C0008?S2_INCLUSION
B3:00A8C3 ED                MOV      A,R5
B3:00A8C4 6410              XRL      A,#010H
B3:00A8C6 7003              JNZ      ?C0133?S2_INCLUSION
B3:00A8C8 EC                MOV      A,R4
B3:00A8C9 6402              XRL      A,#02H
B3:00A8CB         ?C0133?S2_INCLUSION:
B3:00A8CB 6002              JZ       $ + 4H
B3:00A8CD 2159              AJMP     ?C0004?S2_INCLUSION
B3:00A8CF         ?C0008?S2_INCLUSION:
B3:00A8CF 9042F4            MOV      DPTR,#i
B3:00A8D2 E0                MOVX     A,@DPTR
B3:00A8D3 75F005            MOV      B,#05H
B3:00A8D6 902612            MOV      DPTR,#s2_transition_table+04H
B3:00A8D9 12257D            LCALL    ?C?OFFXADD
B3:00A8DC E0                MOVX     A,@DPTR
B3:00A8DD FF                MOV      R7,A
B3:00A8DE 6414              XRL      A,#014H
B3:00A8E0 6009              JZ       ?C0009?S2_INCLUSION
B3:00A8E2 EE                MOV      A,R6
B3:00A8E3 6F                XRL      A,R7
B3:00A8E4 6005              JZ       ?C0009?S2_INCLUSION
B3:00A8E6 902222            MOV      DPTR,#the_context+020FH
B3:00A8E9 EF                MOV      A,R7
B3:00A8EA F0                MOVX     @DPTR,A
B3:00A8EB         ?C0009?S2_INCLUSION:
B3:00A8EB 9042F4            MOV      DPTR,#i
B3:00A8EE E0                MOVX     A,@DPTR
B3:00A8EF 902611            MOV      DPTR,#s2_transition_table+03H
B3:00A8F2 3162              ACALL    ?L?COM04A8
B3:00A8F4 1226B6            LCALL    ?C?CCASE
B3:00A8F7 A92B              DW       ?C0012?S2_INCLUSION
B3:00A8F9 01                DB       01H
B3:00A8FA A955              DW       ?C0024?S2_INCLUSION
B3:00A8FC 03                DB       03H
B3:00A8FD A957              DW       ?C0025?S2_INCLUSION
B3:00A8FF 04                DB       04H
B3:00A900 A930              DW       ?C0013?S2_INCLUSION
B3:00A902 05                DB       05H
B3:00A903 A933              DW       ?C0014?S2_INCLUSION
B3:00A905 06                DB       06H
B3:00A906 A93E              DW       ?C0015?S2_INCLUSION
B3:00A908 07                DB       07H
B3:00A909 A941              DW       ?C0016?S2_INCLUSION
B3:00A90B 08                DB       08H
B3:00A90C A943              DW       ?C0017?S2_INCLUSION
B3:00A90E 09                DB       09H
B3:00A90F A946              DW       ?C0018?S2_INCLUSION
B3:00A911 0A                DB       0AH
B3:00A912 A949              DW       ?C0019?S2_INCLUSION
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 937


B3:00A914 0B                DB       0BH
B3:00A915 A94C              DW       ?C0020?S2_INCLUSION
B3:00A917 0C                DB       0CH
B3:00A918 A94E              DW       ?C0021?S2_INCLUSION
B3:00A91A 0D                DB       0DH
B3:00A91B A950              DW       ?C0022?S2_INCLUSION
B3:00A91D 0E                DB       0EH
B3:00A91E A952              DW       ?C0023?S2_INCLUSION
B3:00A920 0F                DB       0FH
B3:00A921 A928              DW       ?C0011?S2_INCLUSION
B3:00A923 10                DB       010H
B3:00A924 0000              DW       00H
B3:00A926 A961              DW       ?C0028?S2_INCLUSION
B3:00A928         ?C0011?S2_INCLUSION:
B3:00A928 02D653            LJMP     remote_inclusion_failed_evt_push
B3:00A92B         ?C0012?S2_INCLUSION:
B3:00A92B E4                CLR      A
B3:00A92C FF                MOV      R7,A
B3:00A92D 02D5BC            LJMP     _inclusion_failed_evt_push
B3:00A930         ?C0013?S2_INCLUSION:
B3:00A930 02D446            LJMP     s2_joining_start
B3:00A933         ?C0014?S2_INCLUSION:
B3:00A933 7FB8              MOV      R7,#0B8H
B3:00A935 7E0B              MOV      R6,#0BH
B3:00A937 7D00              MOV      R5,#00H
B3:00A939 7C00              MOV      R4,#00H
B3:00A93B 029FF2            LJMP     _s2_inclusion_set_timeout
B3:00A93E         ?C0015?S2_INCLUSION:
B3:00A93E 02D5E5            LJMP     s2_send_kex_report
B3:00A941         ?C0016?S2_INCLUSION:
B3:00A941 413F              AJMP     s2_send_pub_key_b
B3:00A943         ?C0017?S2_INCLUSION:
B3:00A943 02B3D9            LJMP     s2_pub_key_a_recv
B3:00A946         ?C0018?S2_INCLUSION:
B3:00A946 029F59            LJMP     s2_do_ecdh_calc_b
B3:00A949         ?C0019?S2_INCLUSION:
B3:00A949 029FAD            LJMP     s2_send_echo_kex_set
B3:00A94C         ?C0020?S2_INCLUSION:
B3:00A94C 801C              SJMP     s2_send_net_key_get
B3:00A94E         ?C0021?S2_INCLUSION:
B3:00A94E 21D2              AJMP     s2_send_net_key_verify
B3:00A950         ?C0022?S2_INCLUSION:
B3:00A950 6135              AJMP     s2_send_final_transfer_end
B3:00A952         ?C0023?S2_INCLUSION:
B3:00A952 02D544            LJMP     s2_joining_complete
B3:00A955         ?C0024?S2_INCLUSION:
B3:00A955 6152              AJMP     s2_inclusion_send_frame
B3:00A957         ?C0025?S2_INCLUSION:
B3:00A957 805F              SJMP     s2_inclusion_send_data
B3:00A959         ?C0004?S2_INCLUSION:
B3:00A959 9042F4            MOV      DPTR,#i
B3:00A95C E0                MOVX     A,@DPTR
B3:00A95D 04                INC      A
B3:00A95E F0                MOVX     @DPTR,A
B3:00A95F 0183              AJMP     ?C0002?S2_INCLUSION
B3:00A961         ?C0028?S2_INCLUSION:
B3:00A961 22                RET      
----- FUNCTION _process_event (END) -------


----- FUNCTION ?L?COM04A8 (BEGIN) -----
B3:00A962 75F005            MOV      B,#05H
B3:00A965 12257D            LCALL    ?C?OFFXADD
B3:00A968 E0                MOVX     A,@DPTR
B3:00A969 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 938


----- FUNCTION ?L?COM04A8 (END) -------


----- FUNCTION s2_send_net_key_get (BEGIN) -----
B3:00A96A 129273            LCALL    ?L?COM0064
B3:00A96D B40509            CJNE     A,#05H,?C0113?S2_INCLUSION
B3:00A970 7175              ACALL    validate_echo_kex_report
B3:00A972 EF                MOV      A,R7
B3:00A973 6004              JZ       ?C0113?S2_INCLUSION
B3:00A975 7F0B              MOV      R7,#0BH
B3:00A977 801A              SJMP     ?C0146?S2_INCLUSION
B3:00A979         ?C0113?S2_INCLUSION:
B3:00A979 129273            LCALL    ?L?COM0064
B3:00A97C B40C0C            CJNE     A,#0CH,?C0115?S2_INCLUSION
B3:00A97F 711D              ACALL    ?L?COM0110
B3:00A981 5403              ANL      A,#03H
B3:00A983 6402              XRL      A,#02H
B3:00A985 6004              JZ       ?C0115?S2_INCLUSION
B3:00A987 7F0A              MOV      R7,#0AH
B3:00A989         
B3:00A989 8008              SJMP     ?C0146?S2_INCLUSION
B3:00A98B         ?C0115?S2_INCLUSION:
B3:00A98B 9020D7            MOV      DPTR,#the_context+0C4H
B3:00A98E E0                MOVX     A,@DPTR
B3:00A98F 7006              JNZ      ?C0118?S2_INCLUSION
B3:00A991 7F0F              MOV      R7,#0FH
B3:00A993         
B3:00A993 7E02              MOV      R6,#02H
B3:00A995 0179              AJMP     _process_event
B3:00A997         ?C0118?S2_INCLUSION:
B3:00A997 12EA06            LCALL    ?L?COM05FF
B3:00A99A FE                MOV      R6,A
B3:00A99B 5F                ANL      A,R7
B3:00A99C 7006              JNZ      ?C0119?S2_INCLUSION
B3:00A99E EE                MOV      A,R6
B3:00A99F 25E0              ADD      A,ACC
B3:00A9A1 F0                MOVX     @DPTR,A
B3:00A9A2 80F3              SJMP     ?C0118?S2_INCLUSION
B3:00A9A4         ?C0119?S2_INCLUSION:
B3:00A9A4 710E              ACALL    ?L?COM024B
B3:00A9A6 7409              MOV      A,#09H
B3:00A9A8 F0                MOVX     @DPTR,A
B3:00A9A9 9020D8            MOV      DPTR,#the_context+0C5H
B3:00A9AC E0                MOVX     A,@DPTR
B3:00A9AD 902304            MOV      DPTR,#the_context+02F1H
B3:00A9B0 71B6              ACALL    ?L?COM0277
B3:00A9B2 04                INC      A
B3:00A9B3 7123              ACALL    ?L?COM0270
B3:00A9B5 029FF2            LJMP     _s2_inclusion_set_timeout
----- FUNCTION s2_send_net_key_get (END) -------


----- FUNCTION s2_inclusion_send_data (BEGIN) -----
B3:00A9B8 7B01              MOV      R3,#01H
B3:00A9BA 12EEF1            LCALL    ?L?COM0147
B3:00A9BD 7A20              MOV      R2,#HIGH the_context+0CFH
B3:00A9BF 79E2              MOV      R1,#LOW the_context+0CFH
B3:00A9C1 12DEF3            LCALL    ___S2_send_data
B3:00A9C4 EF                MOV      A,R7
B3:00A9C5 902842            MOV      DPTR,#m_retry_counter
B3:00A9C8 7004              JNZ      ?C0129?S2_INCLUSION
B3:00A9CA 74FF              MOV      A,#0FFH
B3:00A9CC F0                MOVX     @DPTR,A
B3:00A9CD 22                RET      
B3:00A9CE         ?C0129?S2_INCLUSION:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 939


B3:00A9CE E0                MOVX     A,@DPTR
B3:00A9CF 14                DEC      A
B3:00A9D0 F0                MOVX     @DPTR,A
B3:00A9D1 22                RET      
----- FUNCTION s2_inclusion_send_data (END) -------


----- FUNCTION s2_send_net_key_verify (BEGIN) -----
B3:00A9D2 9020EA            MOV      DPTR,#the_context+0D7H
B3:00A9D5 711A              ACALL    ?L?COM010F
B3:00A9D7 FF                MOV      R7,A
;---- Variable 'received_key' assigned to Register 'R7' ----
B3:00A9D8 9020D8            MOV      DPTR,#the_context+0C5H
B3:00A9DB E0                MOVX     A,@DPTR
B3:00A9DC 6F                XRL      A,R7
B3:00A9DD 703E              JNZ      error_handling?S2_INCLUSION
B3:00A9DF         ?C0120?S2_INCLUSION:
B3:00A9DF E9                MOV      A,R1
B3:00A9E0 2403              ADD      A,#03H
B3:00A9E2 F9                MOV      R1,A
B3:00A9E3 E4                CLR      A
B3:00A9E4 3A                ADDC     A,R2
B3:00A9E5 FA                MOV      R2,A
B3:00A9E6 121AED            LCALL    ?INTERBANK_TABLE?_keystore_network_key_write
B3:00A9E9 9020D8            MOV      DPTR,#the_context+0C5H
B3:00A9EC E0                MOVX     A,@DPTR
B3:00A9ED 25E0              ADD      A,ACC
B3:00A9EF F0                MOVX     @DPTR,A
B3:00A9F0 9020EA            MOV      DPTR,#the_context+0D7H
B3:00A9F3 12707E            LCALL    ?L?COM00F2
B3:00A9F6 F9                MOV      R1,A
B3:00A9F7 E4                CLR      A
B3:00A9F8 3A                ADDC     A,R2
B3:00A9F9 FA                MOV      R2,A
B3:00A9FA E4                CLR      A
B3:00A9FB 9041AD            MOV      DPTR,#?___S2_network_key_update?BYTE+04H
B3:00A9FE F0                MOVX     @DPTR,A
B3:00A9FF 7F01              MOV      R7,#01H
B3:00AA01 12D00D            LCALL    ___S2_network_key_update
B3:00AA04 710E              ACALL    ?L?COM024B
B3:00AA06 740B              MOV      A,#0BH
B3:00AA08 F0                MOVX     @DPTR,A
B3:00AA09 90232A            MOV      DPTR,#the_context+0317H
B3:00AA0C 7402              MOV      A,#02H
B3:00AA0E F0                MOVX     @DPTR,A
B3:00AA0F 9020E9            MOV      DPTR,#the_context+0D6H
B3:00AA12 14                DEC      A
B3:00AA13 F0                MOVX     @DPTR,A
B3:00AA14 E4                CLR      A
B3:00AA15 9020E4            MOV      DPTR,#the_context+0D1H
B3:00AA18 7123              ACALL    ?L?COM0270
B3:00AA1A 029FF2            LJMP     _s2_inclusion_set_timeout
B3:00AA1D         error_handling:
B3:00AA1D E4                CLR      A
B3:00AA1E FD                MOV      R5,A
B3:00AA1F 7F0A              MOV      R7,#0AH
B3:00AA21 0173              AJMP     ?L?COM04DE
----- FUNCTION s2_send_net_key_verify (END) -------


----- FUNCTION _inclusion_failed_frame_send (BEGIN) -----
;---- Variable 'secure' assigned to Register 'R5' ----
;---- Variable 'error' assigned to Register 'R7' ----
B3:00AA23 710E              ACALL    ?L?COM024B
B3:00AA25 7407              MOV      A,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 940


B3:00AA27 F0                MOVX     @DPTR,A
B3:00AA28 A3                INC      DPTR
B3:00AA29 EF                MOV      A,R7
B3:00AA2A F0                MOVX     @DPTR,A
B3:00AA2B 90232A            MOV      DPTR,#the_context+0317H
B3:00AA2E 7403              MOV      A,#03H
B3:00AA30 F0                MOVX     @DPTR,A
B3:00AA31 902842            MOV      DPTR,#m_retry_counter
B3:00AA34 F0                MOVX     @DPTR,A
B3:00AA35 ED                MOV      A,R5
B3:00AA36 7005              JNZ      ?C0036?S2_INCLUSION
B3:00AA38 71BE              ACALL    ?L?COM0279
B3:00AA3A F0                MOVX     @DPTR,A
B3:00AA3B 21B8              AJMP     s2_inclusion_send_data
B3:00AA3D         ?C0036?S2_INCLUSION:
B3:00AA3D 6152              AJMP     s2_inclusion_send_frame
----- FUNCTION _inclusion_failed_frame_send (END) -------


----- FUNCTION s2_send_pub_key_b (BEGIN) -----
B3:00AA3F 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AA42 1291A1            LCALL    ?L?COM004B
B3:00AA45 12EFA8            LCALL    ?L?COM0408
B3:00AA48 700F              JNZ      ?C0096?S2_INCLUSION
B3:00AA4A 90260D            MOV      DPTR,#m_schemes
B3:00AA4D 12ED03            LCALL    ?L?COM059D
B3:00AA50 6007              JZ       ?C0096?S2_INCLUSION
B3:00AA52 9020D5            MOV      DPTR,#the_context+0C2H
B3:00AA55 EE                MOV      A,R6
B3:00AA56 F0                MOVX     @DPTR,A
B3:00AA57 8008              SJMP     ?C0097?S2_INCLUSION
B3:00AA59         ?C0096?S2_INCLUSION:
B3:00AA59 904396            MOV      DPTR,#support
B3:00AA5C 7402              MOV      A,#02H
B3:00AA5E F0                MOVX     @DPTR,A
B3:00AA5F 6104              AJMP     error_handling?S2_INCLUSION
B3:00AA61         ?C0097?S2_INCLUSION:
B3:00AA61 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AA64 122589            LCALL    ?C?PLDXDATA
B3:00AA67 1270EB            LCALL    ?L?COM01E4
B3:00AA6A 12EFA8            LCALL    ?L?COM0408
B3:00AA6D 700F              JNZ      ?C0099?S2_INCLUSION
B3:00AA6F 90281D            MOV      DPTR,#m_curves
B3:00AA72 12ED03            LCALL    ?L?COM059D
B3:00AA75 6007              JZ       ?C0099?S2_INCLUSION
B3:00AA77 9020D6            MOV      DPTR,#the_context+0C3H
B3:00AA7A EE                MOV      A,R6
B3:00AA7B F0                MOVX     @DPTR,A
B3:00AA7C 8008              SJMP     ?C0100?S2_INCLUSION
B3:00AA7E         ?C0099?S2_INCLUSION:
B3:00AA7E 904396            MOV      DPTR,#support
B3:00AA81 7403              MOV      A,#03H
B3:00AA83 F0                MOVX     @DPTR,A
B3:00AA84 807E              SJMP     error_handling?S2_INCLUSION
B3:00AA86         ?C0100?S2_INCLUSION:
B3:00AA86 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AA89 122589            LCALL    ?C?PLDXDATA
B3:00AA8C 71B0              ACALL    ?L?COM02EA
B3:00AA8E FF                MOV      R7,A
B3:00AA8F 904396            MOV      DPTR,#support
B3:00AA92 F0                MOVX     @DPTR,A
B3:00AA93 90260C            MOV      DPTR,#m_keys
B3:00AA96 E0                MOVX     A,@DPTR
B3:00AA97 F4                CPL      A
B3:00AA98 5F                ANL      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 941


B3:00AA99 7016              JNZ      ?C0143?S2_INCLUSION
B3:00AA9B 904396            MOV      DPTR,#support
B3:00AA9E E0                MOVX     A,@DPTR
B3:00AA9F 9020D7            MOV      DPTR,#the_context+0C4H
B3:00AAA2 F0                MOVX     @DPTR,A
B3:00AAA3         ?C0102?S2_INCLUSION:
B3:00AAA3 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AAA6 711A              ACALL    ?L?COM010F
B3:00AAA8 30E10E            JNB      ACC.1,?C0103?S2_INCLUSION
B3:00AAAB 902223            MOV      DPTR,#the_context+0210H
B3:00AAAE E0                MOVX     A,@DPTR
B3:00AAAF 600E              JZ       ?C0105?S2_INCLUSION
B3:00AAB1         
B3:00AAB1 904396            MOV      DPTR,#support
B3:00AAB4 7401              MOV      A,#01H
B3:00AAB6 F0                MOVX     @DPTR,A
B3:00AAB7 804B              SJMP     error_handling?S2_INCLUSION
B3:00AAB9         ?C0103?S2_INCLUSION:
B3:00AAB9 902223            MOV      DPTR,#the_context+0210H
B3:00AABC 7401              MOV      A,#01H
B3:00AABE F0                MOVX     @DPTR,A
B3:00AABF         ?C0105?S2_INCLUSION:
B3:00AABF 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AAC2 122589            LCALL    ?C?PLDXDATA
B3:00AAC5 71B0              ACALL    ?L?COM02EA
B3:00AAC7 9020D7            MOV      DPTR,#the_context+0C4H
B3:00AACA F0                MOVX     @DPTR,A
B3:00AACB A3                INC      DPTR
B3:00AACC 7401              MOV      A,#01H
B3:00AACE F0                MOVX     @DPTR,A
B3:00AACF 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AAD2 711A              ACALL    ?L?COM010F
B3:00AAD4 9020D4            MOV      DPTR,#the_context+0C1H
B3:00AAD7 710D              ACALL    ?L?COM024A
B3:00AAD9 7408              MOV      A,#08H
B3:00AADB 127318            LCALL    ?L?COM04C3
B3:00AADE 7A23              MOV      R2,#HIGH the_context+02F2H
B3:00AAE0 7905              MOV      R1,#LOW the_context+02F2H
B3:00AAE2 121AD9            LCALL    ?INTERBANK_TABLE?_keystore_public_key_read
B3:00AAE5 902223            MOV      DPTR,#the_context+0210H
B3:00AAE8 E0                MOVX     A,@DPTR
B3:00AAE9 B4010F            CJNE     A,#01H,?C0106?S2_INCLUSION
B3:00AAEC 9020D7            MOV      DPTR,#the_context+0C4H
B3:00AAEF E0                MOVX     A,@DPTR
B3:00AAF0 547E              ANL      A,#07EH
B3:00AAF2 6007              JZ       ?C0106?S2_INCLUSION
B3:00AAF4 E4                CLR      A
B3:00AAF5 902305            MOV      DPTR,#the_context+02F2H
B3:00AAF8 F0                MOVX     @DPTR,A
B3:00AAF9 A3                INC      DPTR
B3:00AAFA F0                MOVX     @DPTR,A
B3:00AAFB         ?C0106?S2_INCLUSION:
B3:00AAFB 7423              MOV      A,#023H
B3:00AAFD 7148              ACALL    ?L?COM042E
B3:00AAFF 712C              ACALL    ?L?COM0271
B3:00AB01 029FF2            LJMP     _s2_inclusion_set_timeout
B3:00AB04         error_handling:
B3:00AB04 904396            MOV      DPTR,#support
B3:00AB07 E0                MOVX     A,@DPTR
B3:00AB08 FF                MOV      R7,A
B3:00AB09 7DFF              MOV      R5,#0FFH
B3:00AB0B 0173              AJMP     ?L?COM04DE
----- FUNCTION s2_send_pub_key_b (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 942


----- FUNCTION ?L?COM024A (BEGIN) -----
B3:00AB0D F0                MOVX     @DPTR,A
B3:00AB0E         ?L?COM024B:
B3:00AB0E 902302            MOV      DPTR,#the_context+02EFH
B3:00AB11 749F              MOV      A,#09FH
B3:00AB13 F0                MOVX     @DPTR,A
B3:00AB14 A3                INC      DPTR
B3:00AB15 22                RET      
----- FUNCTION ?L?COM024A (END) -------


----- FUNCTION ?L?COM010E (BEGIN) -----
B3:00AB16 FF                MOV      R7,A
B3:00AB17 902E6E            MOV      DPTR,#ext_data
B3:00AB1A         ?L?COM010F:
B3:00AB1A 122589            LCALL    ?C?PLDXDATA
B3:00AB1D         ?L?COM0110:
B3:00AB1D 900002            MOV      DPTR,#02H
B3:00AB20 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM010E (END) -------


----- FUNCTION ?L?COM0270 (BEGIN) -----
B3:00AB23 F0                MOVX     @DPTR,A
B3:00AB24 902842            MOV      DPTR,#m_retry_counter
B3:00AB27 7403              MOV      A,#03H
B3:00AB29 F0                MOVX     @DPTR,A
B3:00AB2A 31B8              ACALL    s2_inclusion_send_data
B3:00AB2C         ?L?COM0271:
B3:00AB2C 7FE8              MOV      R7,#0E8H
B3:00AB2E 7E03              MOV      R6,#03H
B3:00AB30 7D00              MOV      R5,#00H
B3:00AB32 7C00              MOV      R4,#00H
B3:00AB34 22                RET      
----- FUNCTION ?L?COM0270 (END) -------


----- FUNCTION s2_send_final_transfer_end (BEGIN) -----
B3:00AB35 710E              ACALL    ?L?COM024B
B3:00AB37 740C              MOV      A,#0CH
B3:00AB39 F0                MOVX     @DPTR,A
B3:00AB3A A3                INC      DPTR
B3:00AB3B 7401              MOV      A,#01H
B3:00AB3D 71B6              ACALL    ?L?COM0277
B3:00AB3F F0                MOVX     @DPTR,A
B3:00AB40 902842            MOV      DPTR,#m_retry_counter
B3:00AB43 7403              MOV      A,#03H
B3:00AB45 F0                MOVX     @DPTR,A
B3:00AB46 21B8              AJMP     s2_inclusion_send_data
----- FUNCTION s2_send_final_transfer_end (END) -------


----- FUNCTION ?L?COM042E (BEGIN) -----
B3:00AB48 90232A            MOV      DPTR,#the_context+0317H
B3:00AB4B F0                MOVX     @DPTR,A
B3:00AB4C 902842            MOV      DPTR,#m_retry_counter
B3:00AB4F 7403              MOV      A,#03H
B3:00AB51 F0                MOVX     @DPTR,A
----- FUNCTION s2_inclusion_send_frame (BEGIN) -----
B3:00AB52 903F97            MOV      DPTR,#?___S2_send_frame?BYTE+03H
B3:00AB55 12EFBB            LCALL    ?L?COM044E
B3:00AB58 90232A            MOV      DPTR,#the_context+0317H
B3:00AB5B E0                MOVX     A,@DPTR
B3:00AB5C FF                MOV      R7,A
B3:00AB5D 903F9A            MOV      DPTR,#?___S2_send_frame?BYTE+06H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 943


B3:00AB60 E4                CLR      A
B3:00AB61 F0                MOVX     @DPTR,A
B3:00AB62 A3                INC      DPTR
B3:00AB63 EF                MOV      A,R7
B3:00AB64 F0                MOVX     @DPTR,A
B3:00AB65 12C3F8            LCALL    ?L?COM059B
B3:00AB68 902842            MOV      DPTR,#m_retry_counter
B3:00AB6B 7004              JNZ      ?C0126?S2_INCLUSION
B3:00AB6D 74FF              MOV      A,#0FFH
B3:00AB6F F0                MOVX     @DPTR,A
B3:00AB70 22                RET      
B3:00AB71         ?C0126?S2_INCLUSION:
B3:00AB71 E0                MOVX     A,@DPTR
B3:00AB72 14                DEC      A
B3:00AB73 F0                MOVX     @DPTR,A
B3:00AB74 22                RET      
----- FUNCTION s2_inclusion_send_frame (END) -------


----- FUNCTION validate_echo_kex_report (BEGIN) -----
B3:00AB75 9020EA            MOV      DPTR,#the_context+0D7H
B3:00AB78 1291A1            LCALL    ?L?COM004B
B3:00AB7B FF                MOV      R7,A
B3:00AB7C 90260D            MOV      DPTR,#m_schemes
B3:00AB7F E0                MOVX     A,@DPTR
B3:00AB80 6F                XRL      A,R7
B3:00AB81 7024              JNZ      ?C0039?S2_INCLUSION
B3:00AB83 1270EB            LCALL    ?L?COM01E4
B3:00AB86 FF                MOV      R7,A
B3:00AB87 90281D            MOV      DPTR,#m_curves
B3:00AB8A E0                MOVX     A,@DPTR
B3:00AB8B 6F                XRL      A,R7
B3:00AB8C 7019              JNZ      ?C0039?S2_INCLUSION
B3:00AB8E 71B0              ACALL    ?L?COM02EA
B3:00AB90 FF                MOV      R7,A
B3:00AB91 90260C            MOV      DPTR,#m_keys
B3:00AB94 E0                MOVX     A,@DPTR
B3:00AB95 B5070F            CJNE     A,AR7,?C0039?S2_INCLUSION
B3:00AB98 711D              ACALL    ?L?COM0110
B3:00AB9A FF                MOV      R7,A
B3:00AB9B 9020D3            MOV      DPTR,#the_context+0C0H
B3:00AB9E E0                MOVX     A,@DPTR
B3:00AB9F 4401              ORL      A,#01H
B3:00ABA1 B50703            CJNE     A,AR7,?C0039?S2_INCLUSION
B3:00ABA4 7F00              MOV      R7,#00H
B3:00ABA6 22                RET      
B3:00ABA7         ?C0039?S2_INCLUSION:
B3:00ABA7 E4                CLR      A
B3:00ABA8 FD                MOV      R5,A
B3:00ABA9 7F07              MOV      R7,#07H
B3:00ABAB 5123              ACALL    _inclusion_failed_frame_send
B3:00ABAD 7F07              MOV      R7,#07H
B3:00ABAF 22                RET      
----- FUNCTION validate_echo_kex_report (END) -------


----- FUNCTION ?L?COM02EA (BEGIN) -----
B3:00ABB0 900005            MOV      DPTR,#05H
B3:00ABB3 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM02EA (END) -------


----- FUNCTION ?L?COM0277 (BEGIN) -----
B3:00ABB6 F0                MOVX     @DPTR,A
B3:00ABB7 90232A            MOV      DPTR,#the_context+0317H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 944


B3:00ABBA 7403              MOV      A,#03H
B3:00ABBC         ?L?COM0278:
B3:00ABBC F0                MOVX     @DPTR,A
B3:00ABBD E4                CLR      A
B3:00ABBE         ?L?COM0279:
B3:00ABBE 9020E9            MOV      DPTR,#the_context+0D6H
B3:00ABC1 F0                MOVX     @DPTR,A
B3:00ABC2 9020E4            MOV      DPTR,#the_context+0D1H
B3:00ABC5 22                RET      
----- FUNCTION ?L?COM0277 (END) -------


----- FUNCTION _secure_learn_runCycle (BEGIN) -----
B3:00ABC6 9042CD            MOV      DPTR,#handle
B3:00ABC9 1225A9            LCALL    ?C?PSTXDATA
B3:00ABCC 91CA              ACALL    ?L?COM01CB
B3:00ABCE 12E203            LCALL    _clearOutEvents
B3:00ABD1 9042CD            MOV      DPTR,#handle
B3:00ABD4 B156              ACALL    ?L?COM0040
B3:00ABD6         ?C0022?SECURE_LEARN:
B3:00ABD6 91CA              ACALL    ?L?COM01CB
B3:00ABD8 900001            MOV      DPTR,#01H
B3:00ABDB 12219A            LCALL    ?C?ILDOPTR
B3:00ABDE FF                MOV      R7,A
B3:00ABDF AEF0              MOV      R6,B
B3:00ABE1 C3                CLR      C
B3:00ABE2 9401              SUBB     A,#01H
B3:00ABE4 EE                MOV      A,R6
B3:00ABE5 9400              SUBB     A,#00H
B3:00ABE7 4002              JC       $ + 4H
B3:00ABE9 816A              AJMP     ?C0023?SECURE_LEARN
B3:00ABEB 1272E5            LCALL    ?L?COM048E
B3:00ABEE 1226B6            LCALL    ?C?CCASE
B3:00ABF1 AC16              DW       ?C0026?SECURE_LEARN
B3:00ABF3 01                DB       01H
B3:00ABF4 AC1B              DW       ?C0027?SECURE_LEARN
B3:00ABF6 02                DB       02H
B3:00ABF7 AC21              DW       ?C0028?SECURE_LEARN
B3:00ABF9 03                DB       03H
B3:00ABFA AC28              DW       ?C0029?SECURE_LEARN
B3:00ABFC 04                DB       04H
B3:00ABFD AC2F              DW       ?C0030?SECURE_LEARN
B3:00ABFF 05                DB       05H
B3:00AC00 AC36              DW       ?C0031?SECURE_LEARN
B3:00AC02 06                DB       06H
B3:00AC03 AC3D              DW       ?C0032?SECURE_LEARN
B3:00AC05 07                DB       07H
B3:00AC06 AC43              DW       ?C0033?SECURE_LEARN
B3:00AC08 08                DB       08H
B3:00AC09 AC4A              DW       ?C0034?SECURE_LEARN
B3:00AC0B 09                DB       09H
B3:00AC0C AC50              DW       ?C0035?SECURE_LEARN
B3:00AC0E 0A                DB       0AH
B3:00AC0F AC57              DW       ?C0036?SECURE_LEARN
B3:00AC11 0B                DB       0BH
B3:00AC12 0000              DW       00H
B3:00AC14 AC5C              DW       ?C0024?SECURE_LEARN
B3:00AC16         ?C0026?SECURE_LEARN:
B3:00AC16 12B2DE            LCALL    _secure_learn_react_main_region_LearnMode_r1_Start
B3:00AC19 8041              SJMP     ?C0024?SECURE_LEARN
B3:00AC1B         ?C0027?SECURE_LEARN:
B3:00AC1B 91CA              ACALL    ?L?COM01CB
B3:00AC1D D188              ACALL    _secure_learn_react_main_region_LearnMode_r1_Scheme_report
B3:00AC1F 803B              SJMP     ?C0024?SECURE_LEARN
B3:00AC21         ?C0028?SECURE_LEARN:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 945


B3:00AC21 91CA              ACALL    ?L?COM01CB
B3:00AC23 12E2B1            LCALL    _secure_learn_react_main_region_LearnMode_r1_Fail
B3:00AC26 8034              SJMP     ?C0024?SECURE_LEARN
B3:00AC28         ?C0029?SECURE_LEARN:
B3:00AC28 91CA              ACALL    ?L?COM01CB
B3:00AC2A 12B210            LCALL    _secure_learn_react_main_region_LearnMode_r1_NewKey
B3:00AC2D 802D              SJMP     ?C0024?SECURE_LEARN
B3:00AC2F         ?C0030?SECURE_LEARN:
B3:00AC2F 91CA              ACALL    ?L?COM01CB
B3:00AC31 12E2E6            LCALL    _secure_learn_react_main_region_LearnMode_r1_Inherited
B3:00AC34 8026              SJMP     ?C0024?SECURE_LEARN
B3:00AC36         ?C0031?SECURE_LEARN:
B3:00AC36 91CA              ACALL    ?L?COM01CB
B3:00AC38 12E2CA            LCALL    _secure_learn_react_main_region_LearnMode_r1_InsecureNet
B3:00AC3B 801F              SJMP     ?C0024?SECURE_LEARN
B3:00AC3D         ?C0032?SECURE_LEARN:
B3:00AC3D 91CA              ACALL    ?L?COM01CB
B3:00AC3F F18B              ACALL    _secure_learn_react_main_region_LearnMode_r1_end
B3:00AC41 8019              SJMP     ?C0024?SECURE_LEARN
B3:00AC43         ?C0033?SECURE_LEARN:
B3:00AC43 91CA              ACALL    ?L?COM01CB
B3:00AC45 12B168            LCALL    _secure_learn_react_main_region_LearnMode_r1_EarlyStart
B3:00AC48 8012              SJMP     ?C0024?SECURE_LEARN
B3:00AC4A         ?C0034?SECURE_LEARN:
B3:00AC4A 91CA              ACALL    ?L?COM01CB
B3:00AC4C 91D0              ACALL    _secure_learn_react_main_region_Idle
B3:00AC4E 800C              SJMP     ?C0024?SECURE_LEARN
B3:00AC50         ?C0035?SECURE_LEARN:
B3:00AC50 91CA              ACALL    ?L?COM01CB
B3:00AC52 12E2D7            LCALL    _secure_learn_react_main_region_Complete
B3:00AC55 8005              SJMP     ?C0024?SECURE_LEARN
B3:00AC57         ?C0036?SECURE_LEARN:
B3:00AC57 91CA              ACALL    ?L?COM01CB
B3:00AC59 12E31B            LCALL    _secure_learn_react_main_region_SendReport
B3:00AC5C         ?C0024?SECURE_LEARN:
B3:00AC5C 91CA              ACALL    ?L?COM01CB
B3:00AC5E 900001            MOV      DPTR,#01H
B3:00AC61 E4                CLR      A
B3:00AC62 75F001            MOV      B,#01H
B3:00AC65 1221D2            LCALL    ?C?IILDOPTR
B3:00AC68 61D6              AJMP     ?C0022?SECURE_LEARN
B3:00AC6A         ?C0023?SECURE_LEARN:
B3:00AC6A 91CA              ACALL    ?L?COM01CB
B3:;----                  JMP      _clearInEvents
----- FUNCTION _secure_learn_runCycle (END) -------


----- FUNCTION _clearInEvents (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00AC6C 900018            MOV      DPTR,#018H
B3:00AC6F E4                CLR      A
B3:00AC70 122084            LCALL    ?C?CSTOPTR
B3:00AC73 900019            MOV      DPTR,#019H
B3:00AC76 E4                CLR      A
B3:00AC77 122084            LCALL    ?C?CSTOPTR
B3:00AC7A 90001A            MOV      DPTR,#01AH
B3:00AC7D E4                CLR      A
B3:00AC7E 122084            LCALL    ?C?CSTOPTR
B3:00AC81 90001F            MOV      DPTR,#01FH
B3:00AC84 E4                CLR      A
B3:00AC85 122084            LCALL    ?C?CSTOPTR
B3:00AC88 900023            MOV      DPTR,#023H
B3:00AC8B E4                CLR      A
B3:00AC8C 122084            LCALL    ?C?CSTOPTR
B3:00AC8F 900024            MOV      DPTR,#024H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 946


B3:00AC92 E4                CLR      A
B3:00AC93 122084            LCALL    ?C?CSTOPTR
B3:00AC96 12F026            LCALL    ?L?COM0601
B3:00AC99 90002A            MOV      DPTR,#02AH
B3:00AC9C E4                CLR      A
B3:00AC9D 122084            LCALL    ?C?CSTOPTR
B3:00ACA0 90002F            MOV      DPTR,#02FH
B3:00ACA3 E4                CLR      A
B3:00ACA4 122084            LCALL    ?C?CSTOPTR
B3:00ACA7 900034            MOV      DPTR,#034H
B3:00ACAA E4                CLR      A
B3:00ACAB 122084            LCALL    ?C?CSTOPTR
B3:00ACAE 900039            MOV      DPTR,#039H
B3:00ACB1 E4                CLR      A
B3:00ACB2 122084            LCALL    ?C?CSTOPTR
B3:00ACB5 900040            MOV      DPTR,#040H
B3:00ACB8 E4                CLR      A
B3:00ACB9 122084            LCALL    ?C?CSTOPTR
B3:00ACBC 900041            MOV      DPTR,#041H
B3:00ACBF E4                CLR      A
B3:00ACC0 122084            LCALL    ?C?CSTOPTR
B3:00ACC3 900042            MOV      DPTR,#042H
B3:00ACC6 E4                CLR      A
B3:00ACC7 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _clearInEvents (END) -------


----- FUNCTION ?L?COM01CB (BEGIN) -----
B3:00ACCA 9042CD            MOV      DPTR,#handle
B3:00ACCD 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM01CB (END) -------


----- FUNCTION _secure_learn_react_main_region_Idle (BEGIN) -----
B3:00ACD0 9042DF            MOV      DPTR,#handle
B3:00ACD3 1225A9            LCALL    ?C?PSTXDATA
B3:00ACD6 B142              ACALL    ?L?COM028D
B3:00ACD8 900018            MOV      DPTR,#018H
B3:00ACDB 121FF0            LCALL    ?C?CLDOPTR
B3:00ACDE 601A              JZ       ?C0149?SECURE_LEARN
B3:00ACE0 B148              ACALL    ?L?COM003D
B3:00ACE2 B13F              ACALL    ?L?COM028C
B3:00ACE4 E9                MOV      A,R1
B3:00ACE5 2440              ADD      A,#040H
B3:00ACE7 12B3BF            LCALL    ?L?COM011B
B3:00ACEA B142              ACALL    ?L?COM028D
B3:00ACEC 900014            MOV      DPTR,#014H
B3:00ACEF 122548            LCALL    ?C?LSTKOPTR
B3:00ACF2 00                DB       00H
B3:00ACF3 00                DB       00H
B3:00ACF4 00                DB       00H
B3:00ACF5 00                DB       00H
B3:00ACF6 7401              MOV      A,#01H
B3:00ACF8 8042              SJMP     ?C0198?SECURE_LEARN
B3:00ACFA         ?C0149?SECURE_LEARN:
B3:00ACFA B142              ACALL    ?L?COM028D
B3:00ACFC 90001F            MOV      DPTR,#01FH
B3:00ACFF 121FF0            LCALL    ?C?CLDOPTR
B3:00AD02 6028              JZ       ?C0151?SECURE_LEARN
B3:00AD04 B148              ACALL    ?L?COM003D
B3:00AD06 12B2D8            LCALL    ?L?COM01BD
B3:00AD09 C004              PUSH     AR4
B3:00AD0B C005              PUSH     AR5
B3:00AD0D C006              PUSH     AR6
B3:00AD0F C007              PUSH     AR7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 947


B3:00AD11 B142              ACALL    ?L?COM028D
B3:00AD13 F17A              ACALL    ?L?COM0507
B3:00AD15 903C94            MOV      DPTR,#?_secure_learnIface_send_commands_supported?BYTE+04H
B3:00AD18 1224F1            LCALL    ?C?LSTXDATA
B3:00AD1B D007              POP      AR7
B3:00AD1D D006              POP      AR6
B3:00AD1F D005              POP      AR5
B3:00AD21 D004              POP      AR4
B3:00AD23 121A8E            LCALL    ?INTERBANK_TABLE?_secure_learnIface_send_commands_supported
B3:00AD26 B142              ACALL    ?L?COM028D
B3:00AD28 740B              MOV      A,#0BH
B3:00AD2A         
B3:00AD2A 8010              SJMP     ?C0198?SECURE_LEARN
B3:00AD2C         ?C0151?SECURE_LEARN:
B3:00AD2C B142              ACALL    ?L?COM028D
B3:00AD2E 900019            MOV      DPTR,#019H
B3:00AD31 121FF0            LCALL    ?C?CLDOPTR
B3:00AD34 6008              JZ       ?C0154?SECURE_LEARN
B3:00AD36 B14E              ACALL    ?L?COM003E
B3:00AD38 B13F              ACALL    ?L?COM028C
B3:00AD3A 7408              MOV      A,#08H
B3:00AD3C         
B3:00AD3C B150              ACALL    ?L?COM003F
B3:00AD3E         ?C0154?SECURE_LEARN:
B3:00AD3E 22                RET      
----- FUNCTION _secure_learn_react_main_region_Idle (END) -------


----- FUNCTION ?L?COM028C (BEGIN) -----
B3:00AD3F 121AA7            LCALL    ?INTERBANK_TABLE?secure_learnIface_update_callback
B3:00AD42         ?L?COM028D:
B3:00AD42 9042DF            MOV      DPTR,#handle
B3:00AD45 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM028C (END) -------


----- FUNCTION ?L?COM003D (BEGIN) -----
B3:00AD48 9042DF            MOV      DPTR,#handle
B3:00AD4B 122589            LCALL    ?C?PLDXDATA
B3:00AD4E         ?L?COM003E:
B3:00AD4E 740C              MOV      A,#0CH
B3:00AD50         ?L?COM003F:
B3:00AD50 122072            LCALL    ?C?CSTPTR
B3:00AD53 9042DF            MOV      DPTR,#handle
B3:00AD56         ?L?COM0040:
B3:00AD56 122589            LCALL    ?C?PLDXDATA
B3:00AD59         ?L?COM0041:
B3:00AD59 900001            MOV      DPTR,#01H
B3:00AD5C E4                CLR      A
B3:00AD5D F5F0              MOV      B,A
B3:00AD5F 02223E            LJMP     ?C?ISTOPTR
----- FUNCTION ?L?COM003D (END) -------


----- FUNCTION _secure_learn_exit (BEGIN) -----
B3:00AD62 9042CA            MOV      DPTR,#handle
B3:00AD65 1225A9            LCALL    ?C?PSTXDATA
B3:00AD68 9042CA            MOV      DPTR,#handle
B3:00AD6B 122589            LCALL    ?C?PLDXDATA
B3:00AD6E 121FB3            LCALL    ?C?CLDPTR
B3:00AD71 1226B6            LCALL    ?C?CCASE
B3:00AD74 AD99              DW       ?C0007?SECURE_LEARN
B3:00AD76 01                DB       01H
B3:00AD77 ADA5              DW       ?C0008?SECURE_LEARN
B3:00AD79 02                DB       02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 948


B3:00AD7A ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD7C 03                DB       03H
B3:00AD7D ADB1              DW       ?C0010?SECURE_LEARN
B3:00AD7F 04                DB       04H
B3:00AD80 ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD82 05                DB       05H
B3:00AD83 ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD85 06                DB       06H
B3:00AD86 ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD88 07                DB       07H
B3:00AD89 ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD8B 08                DB       08H
B3:00AD8C ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD8E 09                DB       09H
B3:00AD8F ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD91 0A                DB       0AH
B3:00AD92 ADC0              DW       ?C0016?SECURE_LEARN
B3:00AD94 0B                DB       0BH
B3:00AD95 0000              DW       00H
B3:00AD97 ADC7              DW       ?C0006?SECURE_LEARN
B3:00AD99         ?C0007?SECURE_LEARN:
B3:00AD99 F180              ACALL    ?L?COM00D8
B3:00AD9B 9042CA            MOV      DPTR,#handle
B3:00AD9E B156              ACALL    ?L?COM0040
B3:00ADA0 E9                MOV      A,R1
B3:00ADA1 2440              ADD      A,#040H
B3:00ADA3 8016              SJMP     ?C0164?SECURE_LEARN
B3:00ADA5         ?C0008?SECURE_LEARN:
B3:00ADA5 F180              ACALL    ?L?COM00D8
B3:00ADA7 9042CA            MOV      DPTR,#handle
B3:00ADAA B156              ACALL    ?L?COM0040
B3:00ADAC E9                MOV      A,R1
B3:00ADAD 2441              ADD      A,#041H
B3:00ADAF         
B3:00ADAF 800A              SJMP     ?C0164?SECURE_LEARN
B3:00ADB1         ?C0010?SECURE_LEARN:
B3:00ADB1 F180              ACALL    ?L?COM00D8
B3:00ADB3 9042CA            MOV      DPTR,#handle
B3:00ADB6 B156              ACALL    ?L?COM0040
B3:00ADB8 E9                MOV      A,R1
B3:00ADB9 2442              ADD      A,#042H
B3:00ADBB         
B3:00ADBB 12B2C8            LCALL    ?L?COM0244
B3:00ADBE 8007              SJMP     ?C0006?SECURE_LEARN
B3:00ADC0         ?C0016?SECURE_LEARN:
B3:00ADC0         
B3:00ADC0         
B3:00ADC0 F180              ACALL    ?L?COM00D8
B3:00ADC2 9042CA            MOV      DPTR,#handle
B3:00ADC5 B156              ACALL    ?L?COM0040
B3:00ADC7         ?C0006?SECURE_LEARN:
B3:00ADC7 9042CA            MOV      DPTR,#handle
B3:00ADCA 122589            LCALL    ?C?PLDXDATA
B3:;----                  JMP      _secure_learn_exitaction
----- FUNCTION _secure_learn_exit (END) -------


----- FUNCTION _secure_learn_exitaction (BEGIN) -----
B3:00ADCD 22                RET      
----- FUNCTION _secure_learn_exitaction (END) -------


----- FUNCTION _ZCB_s2_evt_handler (BEGIN) -----
B3:00ADCE 9042BE            MOV      DPTR,#evt
B3:00ADD1 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 949


B3:00ADD4 9042BE            MOV      DPTR,#evt
B3:00ADD7 122589            LCALL    ?C?PLDXDATA
B3:00ADDA 12240B            LCALL    ?C?LLDPTR
B3:00ADDD 1226DC            LCALL    ?C?LCASE
B3:00ADE0 AE84              DW       ?C0012?ZW_S2_INCLUSION_GLUE
B3:00ADE2 0000              DW       00H
B3:00ADE4 0000              DW       00H
B3:00ADE6 ADFC              DW       ?C0005?ZW_S2_INCLUSION_GLUE
B3:00ADE8 0000              DW       00H
B3:00ADEA 0002              DW       02H
B3:00ADEC AE47              DW       ?C0008?ZW_S2_INCLUSION_GLUE
B3:00ADEE 0000              DW       00H
B3:00ADF0 0004              DW       04H
B3:00ADF2 AE5E              DW       ?C0010?ZW_S2_INCLUSION_GLUE
B3:00ADF4 0000              DW       00H
B3:00ADF6 0005              DW       05H
B3:00ADF8 0000              DW       00H
B3:00ADFA AE87              DW       ?C0014?ZW_S2_INCLUSION_GLUE
B3:00ADFC         ?C0005?ZW_S2_INCLUSION_GLUE:
B3:00ADFC E9                MOV      A,R1
B3:00ADFD 2410              ADD      A,#010H
B3:00ADFF 125510            LCALL    ?L?COM000B
B3:00AE02 D3                SETB     C
B3:00AE03 9400              SUBB     A,#00H
B3:00AE05 4010              JC       ?C0006?ZW_S2_INCLUSION_GLUE
B3:00AE07 E4                CLR      A
B3:00AE08 903835            MOV      DPTR,#securityEventData
B3:00AE0B F0                MOVX     @DPTR,A
B3:00AE0C A3                INC      DPTR
B3:00AE0D F0                MOVX     @DPTR,A
B3:00AE0E 7B01              MOV      R3,#01H
B3:00AE10 7A38              MOV      R2,#HIGH securityEventData
B3:00AE12 7935              MOV      R1,#LOW securityEventData
B3:00AE14 021E12            LJMP     ?INTERBANK_TABLE?_ApplicationSecurityEvent
B3:00AE17         ?C0006?ZW_S2_INCLUSION_GLUE:
B3:00AE17 12ECB9            LCALL    ?L?COM03AC
B3:00AE1A 2413              ADD      A,#013H
B3:00AE1C 125510            LCALL    ?L?COM000B
B3:00AE1F 903831            MOV      DPTR,#challenge_response
B3:00AE22 12ECB8            LCALL    ?L?COM03AB
B3:00AE25 2414              ADD      A,#014H
B3:00AE27 125510            LCALL    ?L?COM000B
B3:00AE2A 903832            MOV      DPTR,#challenge_response+01H
B3:00AE2D 12ECB8            LCALL    ?L?COM03AB
B3:00AE30 2415              ADD      A,#015H
B3:00AE32 125510            LCALL    ?L?COM000B
B3:00AE35 903833            MOV      DPTR,#challenge_response+02H
B3:00AE38 12ECB8            LCALL    ?L?COM03AB
B3:00AE3B 2416              ADD      A,#016H
B3:00AE3D 125510            LCALL    ?L?COM000B
B3:00AE40 903834            MOV      DPTR,#challenge_response+03H
B3:00AE43 F0                MOVX     @DPTR,A
B3:00AE44 02E1CC            LJMP     s2_inclusion_set_txqueue_empty_event
B3:00AE47         ?C0008?ZW_S2_INCLUSION_GLUE:
B3:00AE47 129CCB            LCALL    sec0_unpersist_netkey
B3:00AE4A 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B3:00AE4D 12A790            LCALL    ?L?COM0098
B3:00AE50 6035              JZ       ?C0014?ZW_S2_INCLUSION_GLUE
B3:00AE52 901221            MOV      DPTR,#nodeID
B3:00AE55 E0                MOVX     A,@DPTR
B3:00AE56 FD                MOV      R5,A
B3:00AE57 8F82              MOV      DPL,R7
B3:00AE59 12ECDA            LCALL    ?L?COM05D8
B3:00AE5C 801E              SJMP     ?C0019?ZW_S2_INCLUSION_GLUE
B3:00AE5E         ?C0010?ZW_S2_INCLUSION_GLUE:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 950


B3:00AE5E 121A75            LCALL    ?INTERBANK_TABLE?security_reset
B3:00AE61 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B3:00AE64 E0                MOVX     A,@DPTR
B3:00AE65 7002              JNZ      ?C0018?ZW_S2_INCLUSION_GLUE
B3:00AE67 A3                INC      DPTR
B3:00AE68 E0                MOVX     A,@DPTR
B3:00AE69         ?C0018?ZW_S2_INCLUSION_GLUE:
B3:00AE69 6011              JZ       ?C0011?ZW_S2_INCLUSION_GLUE
B3:00AE6B 7F02              MOV      R7,#02H
B3:00AE6D 121A61            LCALL    ?INTERBANK_TABLE?_secure_learn_set_errno
B3:00AE70 1273B5            LCALL    ?L?COM05A7
B3:00AE73 E0                MOVX     A,@DPTR
B3:00AE74 FE                MOV      R6,A
B3:00AE75 A3                INC      DPTR
B3:00AE76 E0                MOVX     A,@DPTR
B3:00AE77 F582              MOV      DPL,A
B3:00AE79 12ECDA            LCALL    ?L?COM05D8
B3:00AE7C         ?C0011?ZW_S2_INCLUSION_GLUE:
B3:00AE7C         
B3:00AE7C E4                CLR      A
B3:00AE7D 902BB0            MOV      DPTR,#_secureLearnAppCbFunc
B3:00AE80 F0                MOVX     @DPTR,A
B3:00AE81 A3                INC      DPTR
B3:00AE82 F0                MOVX     @DPTR,A
B3:00AE83 22                RET      
B3:00AE84         ?C0012?ZW_S2_INCLUSION_GLUE:
B3:00AE84 121A70            LCALL    ?INTERBANK_TABLE?security_learn_exit
B3:00AE87         ?C0014?ZW_S2_INCLUSION_GLUE:
B3:00AE87 22                RET      
----- FUNCTION _ZCB_s2_evt_handler (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Scheme_report (BEGIN) -----
B3:00AE88 9042D3            MOV      DPTR,#handle
B3:00AE8B 1225A9            LCALL    ?C?PSTXDATA
B3:00AE8E F174              ACALL    ?L?COM0165
B3:00AE90 12B2D8            LCALL    ?L?COM01BD
B3:00AE93 900030            MOV      DPTR,#030H
B3:00AE96 12ED2F            LCALL    ?L?COM060D
B3:00AE99 706A              JNZ      ?C0111?SECURE_LEARN
B3:00AE9B F174              ACALL    ?L?COM0165
B3:00AE9D 90002F            MOV      DPTR,#02FH
B3:00AEA0 121FF0            LCALL    ?C?CLDOPTR
B3:00AEA3 6060              JZ       ?C0111?SECURE_LEARN
B3:00AEA5 9042D3            MOV      DPTR,#handle
B3:00AEA8 F183              ACALL    ?L?COM00D9
B3:00AEAA 9042D3            MOV      DPTR,#handle
B3:00AEAD B156              ACALL    ?L?COM0040
B3:00AEAF F16A              ACALL    ?L?COM0164
B3:00AEB1 E9                MOV      A,R1
B3:00AEB2 2442              ADD      A,#042H
B3:00AEB4 12B3BF            LCALL    ?L?COM011B
B3:00AEB7 F174              ACALL    ?L?COM0165
B3:00AEB9 12B2D8            LCALL    ?L?COM01BD
B3:00AEBC C004              PUSH     AR4
B3:00AEBE C005              PUSH     AR5
B3:00AEC0 C006              PUSH     AR6
B3:00AEC2 C007              PUSH     AR7
B3:00AEC4 F174              ACALL    ?L?COM0165
B3:00AEC6 F17A              ACALL    ?L?COM0507
B3:00AEC8 903F30            MOV      DPTR,#?_secure_learnIfaceL_send_key_verify?BYTE+04H
B3:00AECB 1224F1            LCALL    ?C?LSTXDATA
B3:00AECE D007              POP      AR7
B3:00AED0 D006              POP      AR6
B3:00AED2 D005              POP      AR5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 951


B3:00AED4 D004              POP      AR4
B3:00AED6 121ABB            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_key_verify
B3:00AED9 F174              ACALL    ?L?COM0165
B3:00AEDB E9                MOV      A,R1
B3:00AEDC 2410              ADD      A,#010H
B3:00AEDE F9                MOV      R1,A
B3:00AEDF E4                CLR      A
B3:00AEE0 3A                ADDC     A,R2
B3:00AEE1 FA                MOV      R2,A
B3:00AEE2 C003              PUSH     AR3
B3:00AEE4 C002              PUSH     AR2
B3:00AEE6 C001              PUSH     AR1
B3:00AEE8 12240B            LCALL    ?C?LLDPTR
B3:00AEEB F174              ACALL    ?L?COM0165
B3:00AEED 900003            MOV      DPTR,#03H
B3:00AEF0 1224C1            LCALL    ?C?LLDOPTR0
B3:00AEF3 1223A3            LCALL    ?C?LAND
B3:00AEF6 D001              POP      AR1
B3:00AEF8 D002              POP      AR2
B3:00AEFA D003              POP      AR3
B3:00AEFC 12245B            LCALL    ?C?LSTPTR
B3:00AEFF F174              ACALL    ?L?COM0165
B3:00AF01 7404              MOV      A,#04H
B3:00AF03 805C              SJMP     ?C0186?SECURE_LEARN
B3:00AF05         ?C0111?SECURE_LEARN:
B3:00AF05 F174              ACALL    ?L?COM0165
B3:00AF07 12E337            LCALL    ?L?COM0377
B3:00AF0A 7008              JNZ      ?C0114?SECURE_LEARN
B3:00AF0C 900041            MOV      DPTR,#041H
B3:00AF0F 121FF0            LCALL    ?C?CLDOPTR
B3:00AF12 601A              JZ       ?C0113?SECURE_LEARN
B3:00AF14         ?C0114?SECURE_LEARN:
B3:00AF14 9042D3            MOV      DPTR,#handle
B3:00AF17 F183              ACALL    ?L?COM00D9
B3:00AF19 9042D3            MOV      DPTR,#handle
B3:00AF1C B156              ACALL    ?L?COM0040
B3:00AF1E F16A              ACALL    ?L?COM0164
B3:00AF20 900010            MOV      DPTR,#010H
B3:00AF23 122548            LCALL    ?C?LSTKOPTR
B3:00AF26 00                DB       00H
B3:00AF27 00                DB       00H
B3:00AF28 00                DB       00H
B3:00AF29 00                DB       00H
B3:00AF2A 7403              MOV      A,#03H
B3:00AF2C         
B3:00AF2C 8033              SJMP     ?C0186?SECURE_LEARN
B3:00AF2E         ?C0113?SECURE_LEARN:
B3:00AF2E F174              ACALL    ?L?COM0165
B3:00AF30 127366            LCALL    ?L?COM0545
B3:00AF33 900010            MOV      DPTR,#010H
B3:00AF36 1224C1            LCALL    ?C?LLDOPTR0
B3:00AF39 1223A3            LCALL    ?C?LAND
B3:00AF3C EC                MOV      A,R4
B3:00AF3D 4D                ORL      A,R5
B3:00AF3E 4E                ORL      A,R6
B3:00AF3F 4F                ORL      A,R7
B3:00AF40 7027              JNZ      ?C0117?SECURE_LEARN
B3:00AF42 F174              ACALL    ?L?COM0165
B3:00AF44 12E315            LCALL    ?L?COM0469
B3:00AF47 6020              JZ       ?C0117?SECURE_LEARN
B3:00AF49 9042D3            MOV      DPTR,#handle
B3:00AF4C F183              ACALL    ?L?COM00D9
B3:00AF4E 9042D3            MOV      DPTR,#handle
B3:00AF51 B156              ACALL    ?L?COM0040
B3:00AF53 F16A              ACALL    ?L?COM0164
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 952


B3:00AF55 900010            MOV      DPTR,#010H
B3:00AF58 122548            LCALL    ?C?LSTKOPTR
B3:00AF5B 00                DB       00H
B3:00AF5C 00                DB       00H
B3:00AF5D 00                DB       00H
B3:00AF5E 00                DB       00H
B3:00AF5F 7403              MOV      A,#03H
B3:00AF61         
B3:00AF61 122072            LCALL    ?C?CSTPTR
B3:00AF64 9042D3            MOV      DPTR,#handle
B3:00AF67 B156              ACALL    ?L?COM0040
B3:00AF69         ?C0117?SECURE_LEARN:
B3:00AF69 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Scheme_report (END) -------


----- FUNCTION ?L?COM0164 (BEGIN) -----
B3:00AF6A E9                MOV      A,R1
B3:00AF6B 2441              ADD      A,#041H
B3:00AF6D F9                MOV      R1,A
B3:00AF6E E4                CLR      A
B3:00AF6F 3A                ADDC     A,R2
B3:00AF70 FA                MOV      R2,A
B3:00AF71 121A89            LCALL    ?INTERBANK_TABLE?_secure_learn_unsetTimer
B3:00AF74         ?L?COM0165:
B3:00AF74 9042D3            MOV      DPTR,#handle
B3:00AF77 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0164 (END) -------


----- FUNCTION ?L?COM0507 (BEGIN) -----
B3:00AF7A 900007            MOV      DPTR,#07H
B3:00AF7D 02242B            LJMP     ?C?LLDOPTR
----- FUNCTION ?L?COM0507 (END) -------


----- FUNCTION ?L?COM00D8 (BEGIN) -----
B3:00AF80 9042CA            MOV      DPTR,#handle
B3:00AF83         ?L?COM00D9:
B3:00AF83 122589            LCALL    ?C?PLDXDATA
B3:00AF86 740C              MOV      A,#0CH
B3:00AF88 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM00D8 (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_end (BEGIN) -----
B3:00AF8B 9042D9            MOV      DPTR,#handle
B3:00AF8E 1225A9            LCALL    ?C?PSTXDATA
B3:00AF91 9042D9            MOV      DPTR,#handle
B3:00AF94 122589            LCALL    ?C?PLDXDATA
B3:00AF97 121FB3            LCALL    ?C?CLDPTR
B3:00AF9A 1226B6            LCALL    ?C?CCASE
B3:00AF9D AFB9              DW       ?C0135?SECURE_LEARN
B3:00AF9F 01                DB       01H
B3:00AFA0 AFC8              DW       ?C0136?SECURE_LEARN
B3:00AFA2 02                DB       02H
B3:00AFA3 AFE9              DW       ?C0141?SECURE_LEARN
B3:00AFA5 03                DB       03H
B3:00AFA6 AFD7              DW       ?C0138?SECURE_LEARN
B3:00AFA8 04                DB       04H
B3:00AFA9 AFE9              DW       ?C0141?SECURE_LEARN
B3:00AFAB 05                DB       05H
B3:00AFAC AFE9              DW       ?C0141?SECURE_LEARN
B3:00AFAE 06                DB       06H
B3:00AFAF AFE9              DW       ?C0141?SECURE_LEARN
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 953


B3:00AFB1 07                DB       07H
B3:00AFB2 AFE9              DW       ?C0141?SECURE_LEARN
B3:00AFB4 08                DB       08H
B3:00AFB5 0000              DW       00H
B3:00AFB7 AFF3              DW       ?C0134?SECURE_LEARN
B3:00AFB9         ?C0135?SECURE_LEARN:
B3:00AFB9 9042D9            MOV      DPTR,#handle
B3:00AFBC F183              ACALL    ?L?COM00D9
B3:00AFBE 9042D9            MOV      DPTR,#handle
B3:00AFC1 B156              ACALL    ?L?COM0040
B3:00AFC3 E9                MOV      A,R1
B3:00AFC4 2440              ADD      A,#040H
B3:00AFC6 801C              SJMP     ?C0191?SECURE_LEARN
B3:00AFC8         ?C0136?SECURE_LEARN:
B3:00AFC8 9042D9            MOV      DPTR,#handle
B3:00AFCB F183              ACALL    ?L?COM00D9
B3:00AFCD 9042D9            MOV      DPTR,#handle
B3:00AFD0 B156              ACALL    ?L?COM0040
B3:00AFD2 E9                MOV      A,R1
B3:00AFD3 2441              ADD      A,#041H
B3:00AFD5         
B3:00AFD5 800D              SJMP     ?C0191?SECURE_LEARN
B3:00AFD7         ?C0138?SECURE_LEARN:
B3:00AFD7 9042D9            MOV      DPTR,#handle
B3:00AFDA F183              ACALL    ?L?COM00D9
B3:00AFDC 9042D9            MOV      DPTR,#handle
B3:00AFDF B156              ACALL    ?L?COM0040
B3:00AFE1 E9                MOV      A,R1
B3:00AFE2 2442              ADD      A,#042H
B3:00AFE4         
B3:00AFE4 12B2C8            LCALL    ?L?COM0244
B3:00AFE7 800A              SJMP     ?C0134?SECURE_LEARN
B3:00AFE9         ?C0141?SECURE_LEARN:
B3:00AFE9         
B3:00AFE9         
B3:00AFE9 9042D9            MOV      DPTR,#handle
B3:00AFEC F183              ACALL    ?L?COM00D9
B3:00AFEE 9042D9            MOV      DPTR,#handle
B3:00AFF1 B156              ACALL    ?L?COM0040
B3:00AFF3         ?C0134?SECURE_LEARN:
B3:00AFF3 9042D9            MOV      DPTR,#handle
B3:00AFF6 12B15A            LCALL    ?L?COM0286
B3:00AFF9 12242B            LCALL    ?C?LLDOPTR
B3:00AFFC 900014            MOV      DPTR,#014H
B3:00AFFF 122475            LCALL    ?C?LSTOPTR
B3:00B002 121A93            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_save_state
B3:00B005 9042D9            MOV      DPTR,#handle
B3:00B008 12B15A            LCALL    ?L?COM0286
B3:00B00B 12242B            LCALL    ?C?LLDOPTR
B3:00B00E 121AA2            LCALL    ?INTERBANK_TABLE?_secure_learnIface_complete
B3:00B011 9042D9            MOV      DPTR,#handle
B3:00B014 122589            LCALL    ?C?PLDXDATA
B3:00B017 740A              MOV      A,#0AH
B3:00B019 122072            LCALL    ?C?CSTPTR
B3:00B01C 9042D9            MOV      DPTR,#handle
B3:00B01F 122589            LCALL    ?C?PLDXDATA
B3:00B022 12E2C3            LCALL    ?L?COM02FC
B3:00B025 02223E            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_end (END) -------


----- FUNCTION _secure_learnIface_set_txOptions (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B028 900007            MOV      DPTR,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 954


B3:00B02B 022475            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_txOptions (END) -------


----- FUNCTION _secure_learn_isActive (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'state' assigned to Register 'R5' ----
B3:00B02E ED                MOV      A,R5
B3:00B02F 1226B6            LCALL    ?C?CCASE
B3:00B032 B05A              DW       ?C0042?SECURE_LEARN
B3:00B034 00                DB       00H
B3:00B035 B06F              DW       ?C0046?SECURE_LEARN
B3:00B037 01                DB       01H
B3:00B038 B07A              DW       ?C0049?SECURE_LEARN
B3:00B03A 02                DB       02H
B3:00B03B B085              DW       ?C0052?SECURE_LEARN
B3:00B03D 03                DB       03H
B3:00B03E B090              DW       ?C0055?SECURE_LEARN
B3:00B040 04                DB       04H
B3:00B041 B09B              DW       ?C0058?SECURE_LEARN
B3:00B043 05                DB       05H
B3:00B044 B0A6              DW       ?C0061?SECURE_LEARN
B3:00B046 06                DB       06H
B3:00B047 B0B1              DW       ?C0064?SECURE_LEARN
B3:00B049 07                DB       07H
B3:00B04A B0BC              DW       ?C0067?SECURE_LEARN
B3:00B04C 08                DB       08H
B3:00B04D B0C7              DW       ?C0070?SECURE_LEARN
B3:00B04F 09                DB       09H
B3:00B050 B0D2              DW       ?C0073?SECURE_LEARN
B3:00B052 0A                DB       0AH
B3:00B053 B0DD              DW       ?C0076?SECURE_LEARN
B3:00B055 0B                DB       0BH
B3:00B056 0000              DW       00H
B3:00B058 B0E8              DW       ?C0079?SECURE_LEARN
B3:00B05A         ?C0042?SECURE_LEARN:
B3:00B05A 121FB3            LCALL    ?C?CLDPTR
B3:00B05D FF                MOV      R7,A
B3:00B05E C3                CLR      C
B3:00B05F 9400              SUBB     A,#00H
B3:00B061 4009              JC       ?C0043?SECURE_LEARN
B3:00B063 EF                MOV      A,R7
B3:00B064 D3                SETB     C
B3:00B065 9408              SUBB     A,#08H
B3:00B067 5003              JNC      ?C0043?SECURE_LEARN
B3:00B069 7F01              MOV      R7,#01H
B3:00B06B 22                RET      
B3:00B06C         ?C0043?SECURE_LEARN:
B3:00B06C 7F00              MOV      R7,#00H
B3:00B06E 22                RET      
B3:00B06F         ?C0046?SECURE_LEARN:
B3:00B06F 121FB3            LCALL    ?C?CLDPTR
B3:00B072 7F00              MOV      R7,#00H
B3:00B074 B40102            CJNE     A,#01H,?C0047?SECURE_LEARN
B3:00B077 7F01              MOV      R7,#01H
B3:00B079         ?C0047?SECURE_LEARN:
B3:00B079 22                RET      
B3:00B07A         ?C0049?SECURE_LEARN:
B3:00B07A 121FB3            LCALL    ?C?CLDPTR
B3:00B07D 7F00              MOV      R7,#00H
B3:00B07F B40202            CJNE     A,#02H,?C0050?SECURE_LEARN
B3:00B082 7F01              MOV      R7,#01H
B3:00B084         ?C0050?SECURE_LEARN:
B3:00B084 22                RET      
B3:00B085         ?C0052?SECURE_LEARN:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 955


B3:00B085 121FB3            LCALL    ?C?CLDPTR
B3:00B088 7F00              MOV      R7,#00H
B3:00B08A B40302            CJNE     A,#03H,?C0053?SECURE_LEARN
B3:00B08D 7F01              MOV      R7,#01H
B3:00B08F         ?C0053?SECURE_LEARN:
B3:00B08F 22                RET      
B3:00B090         ?C0055?SECURE_LEARN:
B3:00B090 121FB3            LCALL    ?C?CLDPTR
B3:00B093 7F00              MOV      R7,#00H
B3:00B095 B40402            CJNE     A,#04H,?C0056?SECURE_LEARN
B3:00B098 7F01              MOV      R7,#01H
B3:00B09A         ?C0056?SECURE_LEARN:
B3:00B09A 22                RET      
B3:00B09B         ?C0058?SECURE_LEARN:
B3:00B09B 121FB3            LCALL    ?C?CLDPTR
B3:00B09E 7F00              MOV      R7,#00H
B3:00B0A0 B40502            CJNE     A,#05H,?C0059?SECURE_LEARN
B3:00B0A3 7F01              MOV      R7,#01H
B3:00B0A5         ?C0059?SECURE_LEARN:
B3:00B0A5 22                RET      
B3:00B0A6         ?C0061?SECURE_LEARN:
B3:00B0A6 121FB3            LCALL    ?C?CLDPTR
B3:00B0A9 7F00              MOV      R7,#00H
B3:00B0AB B40602            CJNE     A,#06H,?C0062?SECURE_LEARN
B3:00B0AE 7F01              MOV      R7,#01H
B3:00B0B0         ?C0062?SECURE_LEARN:
B3:00B0B0 22                RET      
B3:00B0B1         ?C0064?SECURE_LEARN:
B3:00B0B1 121FB3            LCALL    ?C?CLDPTR
B3:00B0B4 7F00              MOV      R7,#00H
B3:00B0B6 B40702            CJNE     A,#07H,?C0065?SECURE_LEARN
B3:00B0B9 7F01              MOV      R7,#01H
B3:00B0BB         ?C0065?SECURE_LEARN:
B3:00B0BB 22                RET      
B3:00B0BC         ?C0067?SECURE_LEARN:
B3:00B0BC 121FB3            LCALL    ?C?CLDPTR
B3:00B0BF 7F00              MOV      R7,#00H
B3:00B0C1 B40802            CJNE     A,#08H,?C0068?SECURE_LEARN
B3:00B0C4 7F01              MOV      R7,#01H
B3:00B0C6         ?C0068?SECURE_LEARN:
B3:00B0C6 22                RET      
B3:00B0C7         ?C0070?SECURE_LEARN:
B3:00B0C7 121FB3            LCALL    ?C?CLDPTR
B3:00B0CA 7F00              MOV      R7,#00H
B3:00B0CC B40902            CJNE     A,#09H,?C0071?SECURE_LEARN
B3:00B0CF 7F01              MOV      R7,#01H
B3:00B0D1         ?C0071?SECURE_LEARN:
B3:00B0D1 22                RET      
B3:00B0D2         ?C0073?SECURE_LEARN:
B3:00B0D2 121FB3            LCALL    ?C?CLDPTR
B3:00B0D5 7F00              MOV      R7,#00H
B3:00B0D7 B40A02            CJNE     A,#0AH,?C0074?SECURE_LEARN
B3:00B0DA 7F01              MOV      R7,#01H
B3:00B0DC         ?C0074?SECURE_LEARN:
B3:00B0DC 22                RET      
B3:00B0DD         ?C0076?SECURE_LEARN:
B3:00B0DD 121FB3            LCALL    ?C?CLDPTR
B3:00B0E0 7F00              MOV      R7,#00H
B3:00B0E2 B40B02            CJNE     A,#0BH,?C0077?SECURE_LEARN
B3:00B0E5 7F01              MOV      R7,#01H
B3:00B0E7         ?C0077?SECURE_LEARN:
B3:00B0E7 22                RET      
B3:00B0E8         ?C0079?SECURE_LEARN:
B3:00B0E8 7F00              MOV      R7,#00H
B3:00B0EA 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 956


----- FUNCTION _secure_learn_isActive (END) -------


----- FUNCTION _secure_learn_init (BEGIN) -----
B3:00B0EB 9042C4            MOV      DPTR,#handle
;---- Variable 'i' assigned to Register 'R6/R7' ----
B3:00B0EE 127373            LCALL    ?L?COM0548
B3:00B0F1         ?C0001?SECURE_LEARN:
B3:00B0F1 3151              ACALL    ?L?COM04FA
B3:00B0F3 8F82              MOV      DPL,R7
B3:00B0F5 8E83              MOV      DPH,R6
B3:00B0F7 740C              MOV      A,#0CH
B3:00B0F9 122084            LCALL    ?C?CSTOPTR
B3:00B0FC 0F                INC      R7
B3:00B0FD BF0001            CJNE     R7,#00H,?C0160?SECURE_LEARN
B3:00B100 0E                INC      R6
B3:00B101         ?C0160?SECURE_LEARN:
B3:00B101 EF                MOV      A,R7
B3:00B102 6401              XRL      A,#01H
B3:00B104 4E                ORL      A,R6
B3:00B105 70EA              JNZ      ?C0001?SECURE_LEARN
B3:00B107         ?C0002?SECURE_LEARN:
B3:00B107 9042C4            MOV      DPTR,#handle
B3:00B10A 12AD56            LCALL    ?L?COM0040
B3:00B10D 12AC6C            LCALL    _clearInEvents
B3:00B110 3151              ACALL    ?L?COM04FA
B3:00B112 12E203            LCALL    _clearOutEvents
B3:00B115 3151              ACALL    ?L?COM04FA
B3:00B117 900003            MOV      DPTR,#03H
B3:00B11A 122548            LCALL    ?C?LSTKOPTR
B3:00B11D 00                DB       00H
B3:00B11E 00                DB       00H
B3:00B11F 00                DB       00H
B3:00B120 01                DB       01H
B3:00B121 900007            MOV      DPTR,#07H
B3:00B124 122548            LCALL    ?C?LSTKOPTR
B3:00B127 00                DB       00H
B3:00B128 00                DB       00H
B3:00B129 00                DB       00H
B3:00B12A 00                DB       00H
B3:00B12B 90000B            MOV      DPTR,#0BH
B3:00B12E E4                CLR      A
B3:00B12F 122084            LCALL    ?C?CSTOPTR
B3:00B132 90000C            MOV      DPTR,#0CH
B3:00B135 122548            LCALL    ?C?LSTKOPTR
B3:00B138 00                DB       00H
B3:00B139 00                DB       00H
B3:00B13A 00                DB       00H
B3:00B13B 00                DB       00H
B3:00B13C 900010            MOV      DPTR,#010H
B3:00B13F 122548            LCALL    ?C?LSTKOPTR
B3:00B142 00                DB       00H
B3:00B143 00                DB       00H
B3:00B144 00                DB       00H
B3:00B145 00                DB       00H
B3:00B146 900014            MOV      DPTR,#014H
B3:00B149 122548            LCALL    ?C?LSTKOPTR
B3:00B14C 00                DB       00H
B3:00B14D 00                DB       00H
B3:00B14E 00                DB       00H
B3:00B14F 00                DB       00H
B3:00B150 22                RET      
----- FUNCTION _secure_learn_init (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 957


----- FUNCTION ?L?COM04FA (BEGIN) -----
B3:00B151 9042C4            MOV      DPTR,#handle
B3:00B154 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04FA (END) -------


----- FUNCTION ?L?COM0285 (BEGIN) -----
B3:00B157 904300            MOV      DPTR,#s2_event
B3:00B15A         ?L?COM0286:
B3:00B15A 122589            LCALL    ?C?PLDXDATA
B3:00B15D 900010            MOV      DPTR,#010H
B3:00B160 22                RET      
----- FUNCTION ?L?COM0285 (END) -------


----- FUNCTION sec2_inclusion_abort (BEGIN) -----
B3:;----                  JMP      s2_inclusion_abort
----- FUNCTION sec2_inclusion_abort (END) -------


----- FUNCTION s2_inclusion_abort (BEGIN) -----
B3:00B161 7F03              MOV      R7,#03H
B3:00B163 7E02              MOV      R6,#02H
B3:00B165 02A879            LJMP     _process_event
----- FUNCTION s2_inclusion_abort (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_EarlyStart (BEGIN) -----
B3:00B168 9042DC            MOV      DPTR,#handle
B3:00B16B 1225A9            LCALL    ?C?PSTXDATA
B3:00B16E 9042DC            MOV      DPTR,#handle
B3:00B171 1299E2            LCALL    ?L?COM0113
B3:00B174 6061              JZ       ?C0145?SECURE_LEARN
B3:00B176 9042DC            MOV      DPTR,#handle
B3:00B179 12AF83            LCALL    ?L?COM00D9
B3:00B17C 9042DC            MOV      DPTR,#handle
B3:00B17F 12AD56            LCALL    ?L?COM0040
B3:00B182 71B0              ACALL    ?L?COM011A
B3:00B184 9042DC            MOV      DPTR,#handle
B3:00B187 51D5              ACALL    ?L?COM01BC
B3:00B189 C004              PUSH     AR4
B3:00B18B C005              PUSH     AR5
B3:00B18D C006              PUSH     AR6
B3:00B18F C007              PUSH     AR7
B3:00B191 9042DC            MOV      DPTR,#handle
B3:00B194 B10E              ACALL    ?L?COM024D
B3:00B196 1224FD            LCALL    ?C?LSTKXDATA
B3:00B199 00                DB       00H
B3:00B19A 00                DB       00H
B3:00B19B 00                DB       00H
B3:00B19C 00                DB       00H
B3:00B19D D007              POP      AR7
B3:00B19F D006              POP      AR6
B3:00B1A1 D005              POP      AR5
B3:00B1A3 D004              POP      AR4
B3:00B1A5 121AAC            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_scheme_report
B3:00B1A8 121AB1            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_set_inclusion_key
B3:00B1AB 9042DC            MOV      DPTR,#handle
B3:00B1AE 51D5              ACALL    ?L?COM01BC
B3:00B1B0 C004              PUSH     AR4
B3:00B1B2 C005              PUSH     AR5
B3:00B1B4 C006              PUSH     AR6
B3:00B1B6 C007              PUSH     AR7
B3:00B1B8 9042DC            MOV      DPTR,#handle
B3:00B1BB 315A              ACALL    ?L?COM0286
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 958


B3:00B1BD 12242B            LCALL    ?C?LLDOPTR
B3:00B1C0 903F50            MOV      DPTR,#?_secure_learnIfaceI_register_scheme?BYTE+04H
B3:00B1C3 1224F1            LCALL    ?C?LSTXDATA
B3:00B1C6 D007              POP      AR7
B3:00B1C8 D006              POP      AR6
B3:00B1CA D005              POP      AR5
B3:00B1CC D004              POP      AR4
B3:00B1CE 121AC0            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceI_register_scheme
B3:00B1D1 510A              ACALL    ?L?COM0511
B3:00B1D3 7402              MOV      A,#02H
B3:00B1D5 8029              SJMP     ?C0196?SECURE_LEARN
B3:00B1D7         ?C0145?SECURE_LEARN:
B3:00B1D7 510A              ACALL    ?L?COM0511
B3:00B1D9 900018            MOV      DPTR,#018H
B3:00B1DC 121FF0            LCALL    ?C?CLDOPTR
B3:00B1DF 6028              JZ       ?C0148?SECURE_LEARN
B3:00B1E1 9042DC            MOV      DPTR,#handle
B3:00B1E4 12AF83            LCALL    ?L?COM00D9
B3:00B1E7 9042DC            MOV      DPTR,#handle
B3:00B1EA 12AD56            LCALL    ?L?COM0040
B3:00B1ED E9                MOV      A,R1
B3:00B1EE 2440              ADD      A,#040H
B3:00B1F0 71BF              ACALL    ?L?COM011B
B3:00B1F2 510A              ACALL    ?L?COM0511
B3:00B1F4 900014            MOV      DPTR,#014H
B3:00B1F7 122548            LCALL    ?C?LSTKOPTR
B3:00B1FA 00                DB       00H
B3:00B1FB 00                DB       00H
B3:00B1FC 00                DB       00H
B3:00B1FD 00                DB       00H
B3:00B1FE 7401              MOV      A,#01H
B3:00B200         
B3:00B200 122072            LCALL    ?C?CSTPTR
B3:00B203 9042DC            MOV      DPTR,#handle
B3:00B206 12AD56            LCALL    ?L?COM0040
B3:00B209         ?C0148?SECURE_LEARN:
B3:00B209 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_EarlyStart (END) -------


----- FUNCTION ?L?COM0511 (BEGIN) -----
B3:00B20A 9042DC            MOV      DPTR,#handle
B3:00B20D 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0511 (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_NewKey (BEGIN) -----
B3:00B210 9042D6            MOV      DPTR,#handle
B3:00B213 1225A9            LCALL    ?C?PSTXDATA
B3:00B216 71A4              ACALL    ?L?COM0320
B3:00B218 701D              JNZ      ?C0120?SECURE_LEARN
B3:00B21A 12E315            LCALL    ?L?COM0469
B3:00B21D 6018              JZ       ?C0120?SECURE_LEARN
B3:00B21F 9042D6            MOV      DPTR,#handle
B3:00B222 12AF83            LCALL    ?L?COM00D9
B3:00B225 9042D6            MOV      DPTR,#handle
B3:00B228 12AD56            LCALL    ?L?COM0040
B3:00B22B 51C5              ACALL    ?L?COM0243
B3:00B22D 9042D6            MOV      DPTR,#handle
B3:00B230 122589            LCALL    ?C?PLDXDATA
B3:00B233 7407              MOV      A,#07H
B3:00B235 41BB              AJMP     ?C0188?SECURE_LEARN
B3:00B237         ?C0120?SECURE_LEARN:
B3:00B237 9042D6            MOV      DPTR,#handle
B3:00B23A 12E334            LCALL    ?L?COM0376
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 959


B3:00B23D 7008              JNZ      ?C0123?SECURE_LEARN
B3:00B23F 900042            MOV      DPTR,#042H
B3:00B242 121FF0            LCALL    ?C?CLDOPTR
B3:00B245 601E              JZ       ?C0122?SECURE_LEARN
B3:00B247         ?C0123?SECURE_LEARN:
B3:00B247 9042D6            MOV      DPTR,#handle
B3:00B24A 12AF83            LCALL    ?L?COM00D9
B3:00B24D 9042D6            MOV      DPTR,#handle
B3:00B250 12AD56            LCALL    ?L?COM0040
B3:00B253 51C5              ACALL    ?L?COM0243
B3:00B255 9042D6            MOV      DPTR,#handle
B3:00B258 315A              ACALL    ?L?COM0286
B3:00B25A 122548            LCALL    ?C?LSTKOPTR
B3:00B25D 00                DB       00H
B3:00B25E 00                DB       00H
B3:00B25F 00                DB       00H
B3:00B260 00                DB       00H
B3:00B261 7403              MOV      A,#03H
B3:00B263         
B3:00B263 8056              SJMP     ?C0188?SECURE_LEARN
B3:00B265         ?C0122?SECURE_LEARN:
B3:00B265 71A4              ACALL    ?L?COM0320
B3:00B267 605B              JZ       ?C0126?SECURE_LEARN
B3:00B269 51D8              ACALL    ?L?COM01BD
B3:00B26B 90002B            MOV      DPTR,#02BH
B3:00B26E 12ED2F            LCALL    ?L?COM060D
B3:00B271 7051              JNZ      ?C0126?SECURE_LEARN
B3:00B273 9042D6            MOV      DPTR,#handle
B3:00B276 122589            LCALL    ?C?PLDXDATA
B3:00B279 90002A            MOV      DPTR,#02AH
B3:00B27C 121FF0            LCALL    ?C?CLDOPTR
B3:00B27F 6043              JZ       ?C0126?SECURE_LEARN
B3:00B281 9042D6            MOV      DPTR,#handle
B3:00B284 12AF83            LCALL    ?L?COM00D9
B3:00B287 9042D6            MOV      DPTR,#handle
B3:00B28A 12AD56            LCALL    ?L?COM0040
B3:00B28D 51C5              ACALL    ?L?COM0243
B3:00B28F 9042D6            MOV      DPTR,#handle
B3:00B292 51D5              ACALL    ?L?COM01BC
B3:00B294 C004              PUSH     AR4
B3:00B296 C005              PUSH     AR5
B3:00B298 C006              PUSH     AR6
B3:00B29A C007              PUSH     AR7
B3:00B29C 9042D6            MOV      DPTR,#handle
B3:00B29F B10E              ACALL    ?L?COM024D
B3:00B2A1 1224FD            LCALL    ?C?LSTKXDATA
B3:00B2A4 00                DB       00H
B3:00B2A5 00                DB       00H
B3:00B2A6 00                DB       00H
B3:00B2A7 01                DB       01H
B3:00B2A8 D007              POP      AR7
B3:00B2AA D006              POP      AR6
B3:00B2AC D005              POP      AR5
B3:00B2AE D004              POP      AR4
B3:00B2B0 121AAC            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_scheme_report
B3:00B2B3 9042D6            MOV      DPTR,#handle
B3:00B2B6 122589            LCALL    ?C?PLDXDATA
B3:00B2B9 7405              MOV      A,#05H
B3:00B2BB         
B3:00B2BB 122072            LCALL    ?C?CSTPTR
B3:00B2BE 9042D6            MOV      DPTR,#handle
B3:00B2C1 12AD56            LCALL    ?L?COM0040
B3:00B2C4         ?C0126?SECURE_LEARN:
B3:00B2C4 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_NewKey (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 960




----- FUNCTION ?L?COM0243 (BEGIN) -----
B3:00B2C5 E9                MOV      A,R1
B3:00B2C6 2442              ADD      A,#042H
B3:00B2C8         ?L?COM0244:
B3:00B2C8 F9                MOV      R1,A
B3:00B2C9 E4                CLR      A
B3:00B2CA 3A                ADDC     A,R2
B3:00B2CB FA                MOV      R2,A
B3:00B2CC 021A89            LJMP     ?INTERBANK_TABLE?_secure_learn_unsetTimer
----- FUNCTION ?L?COM0243 (END) -------


----- FUNCTION _secure_learnIface_get_supported_schemes (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B2CF 027366            LJMP     ?L?COM0545
----- FUNCTION _secure_learnIface_get_supported_schemes (END) -------


----- FUNCTION ?L?COM01BB (BEGIN) -----
B3:00B2D2 9042D0            MOV      DPTR,#handle
B3:00B2D5         ?L?COM01BC:
B3:00B2D5 122589            LCALL    ?C?PLDXDATA
B3:00B2D8         ?L?COM01BD:
B3:00B2D8 90000C            MOV      DPTR,#0CH
B3:00B2DB 02242B            LJMP     ?C?LLDOPTR
----- FUNCTION ?L?COM01BB (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Start (BEGIN) -----
B3:00B2DE 9042D0            MOV      DPTR,#handle
B3:00B2E1 1225A9            LCALL    ?C?PSTXDATA
B3:00B2E4 9042D0            MOV      DPTR,#handle
B3:00B2E7 1299E2            LCALL    ?L?COM0113
B3:00B2EA 606A              JZ       ?C0104?SECURE_LEARN
B3:00B2EC 9042D0            MOV      DPTR,#handle
B3:00B2EF 12AF83            LCALL    ?L?COM00D9
B3:00B2F2 9042D0            MOV      DPTR,#handle
B3:00B2F5 12AD56            LCALL    ?L?COM0040
B3:00B2F8 E9                MOV      A,R1
B3:00B2F9 2440              ADD      A,#040H
B3:00B2FB 51C8              ACALL    ?L?COM0244
B3:00B2FD 9042D0            MOV      DPTR,#handle
B3:00B300 122589            LCALL    ?C?PLDXDATA
B3:00B303 71B0              ACALL    ?L?COM011A
B3:00B305 51D2              ACALL    ?L?COM01BB
B3:00B307 C004              PUSH     AR4
B3:00B309 C005              PUSH     AR5
B3:00B30B C006              PUSH     AR6
B3:00B30D C007              PUSH     AR7
B3:00B30F 9042D0            MOV      DPTR,#handle
B3:00B312 B10E              ACALL    ?L?COM024D
B3:00B314 1224FD            LCALL    ?C?LSTKXDATA
B3:00B317 00                DB       00H
B3:00B318 00                DB       00H
B3:00B319 00                DB       00H
B3:00B31A 00                DB       00H
B3:00B31B D007              POP      AR7
B3:00B31D D006              POP      AR6
B3:00B31F D005              POP      AR5
B3:00B321 D004              POP      AR4
B3:00B323 121AAC            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_scheme_report
B3:00B326 121AB1            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_set_inclusion_key
B3:00B329 51D2              ACALL    ?L?COM01BB
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 961


B3:00B32B C004              PUSH     AR4
B3:00B32D C005              PUSH     AR5
B3:00B32F C006              PUSH     AR6
B3:00B331 C007              PUSH     AR7
B3:00B333 9042D0            MOV      DPTR,#handle
B3:00B336 315A              ACALL    ?L?COM0286
B3:00B338 12242B            LCALL    ?C?LLDOPTR
B3:00B33B 903F50            MOV      DPTR,#?_secure_learnIfaceI_register_scheme?BYTE+04H
B3:00B33E 1224F1            LCALL    ?C?LSTXDATA
B3:00B341 D007              POP      AR7
B3:00B343 D006              POP      AR6
B3:00B345 D005              POP      AR5
B3:00B347 D004              POP      AR4
B3:00B349 121AC0            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceI_register_scheme
B3:00B34C 9042D0            MOV      DPTR,#handle
B3:00B34F 122589            LCALL    ?C?PLDXDATA
B3:00B352 7402              MOV      A,#02H
B3:00B354 8044              SJMP     ?C0184?SECURE_LEARN
B3:00B356         ?C0104?SECURE_LEARN:
B3:00B356 9042D0            MOV      DPTR,#handle
B3:00B359 122589            LCALL    ?C?PLDXDATA
B3:00B35C 900040            MOV      DPTR,#040H
B3:00B35F 121FF0            LCALL    ?C?CLDOPTR
B3:00B362 603F              JZ       ?C0110?SECURE_LEARN
B3:00B364 9042D0            MOV      DPTR,#handle
B3:00B367 12AF83            LCALL    ?L?COM00D9
B3:00B36A 9042D0            MOV      DPTR,#handle
B3:00B36D 12AD56            LCALL    ?L?COM0040
B3:00B370 E9                MOV      A,R1
B3:00B371 2440              ADD      A,#040H
B3:00B373 51C8              ACALL    ?L?COM0244
B3:00B375 9042D0            MOV      DPTR,#handle
B3:00B378 71A7              ACALL    ?L?COM0321
B3:00B37A 6013              JZ       ?C0107?SECURE_LEARN
B3:00B37C 121A9D            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_new_keys
B3:00B37F 9042D0            MOV      DPTR,#handle
B3:00B382 315A              ACALL    ?L?COM0286
B3:00B384 122548            LCALL    ?C?LSTKOPTR
B3:00B387 00                DB       00H
B3:00B388 00                DB       00H
B3:00B389 00                DB       00H
B3:00B38A 01                DB       01H
B3:00B38B 7406              MOV      A,#06H
B3:00B38D         
B3:00B38D 800B              SJMP     ?C0184?SECURE_LEARN
B3:00B38F         ?C0107?SECURE_LEARN:
B3:00B38F 121A98            LCALL    ?INTERBANK_TABLE?secure_learnIface_state_start_timeout
B3:00B392 9042D0            MOV      DPTR,#handle
B3:00B395 122589            LCALL    ?C?PLDXDATA
B3:00B398 7407              MOV      A,#07H
B3:00B39A         
B3:00B39A 122072            LCALL    ?C?CSTPTR
B3:00B39D 9042D0            MOV      DPTR,#handle
B3:00B3A0 12AD56            LCALL    ?L?COM0040
B3:00B3A3         ?C0110?SECURE_LEARN:
B3:00B3A3 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Start (END) -------


----- FUNCTION ?L?COM0320 (BEGIN) -----
B3:00B3A4 9042D6            MOV      DPTR,#handle
B3:00B3A7         ?L?COM0321:
B3:00B3A7 122589            LCALL    ?C?PLDXDATA
B3:00B3AA         ?L?COM0322:
B3:00B3AA 90000B            MOV      DPTR,#0BH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 962


B3:00B3AD 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0320 (END) -------


----- FUNCTION ?L?COM011A (BEGIN) -----
B3:00B3B0 900026            MOV      DPTR,#026H
B3:00B3B3 12242B            LCALL    ?C?LLDOPTR
B3:00B3B6 90000C            MOV      DPTR,#0CH
B3:00B3B9 122475            LCALL    ?C?LSTOPTR
B3:00B3BC E9                MOV      A,R1
B3:00B3BD 2441              ADD      A,#041H
B3:00B3BF         ?L?COM011B:
B3:00B3BF F9                MOV      R1,A
B3:00B3C0 E4                CLR      A
B3:00B3C1 3A                ADDC     A,R2
B3:00B3C2 FA                MOV      R2,A
B3:00B3C3 E4                CLR      A
B3:00B3C4 903F2B            MOV      DPTR,#?_secure_learn_setTimer?BYTE+07H
B3:00B3C7 F0                MOVX     @DPTR,A
B3:00B3C8 7F10              MOV      R7,#010H
B3:00B3CA 7E27              MOV      R6,#027H
B3:00B3CC FD                MOV      R5,A
B3:00B3CD FC                MOV      R4,A
B3:00B3CE 021A84            LJMP     ?INTERBANK_TABLE?_secure_learn_setTimer
----- FUNCTION ?L?COM011A (END) -------


----- FUNCTION _secure_learnIface_raise_tx_fail (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B3D1 900024            MOV      DPTR,#024H
B3:00B3D4 7401              MOV      A,#01H
B3:00B3D6 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_tx_fail (END) -------


----- FUNCTION s2_pub_key_a_recv (BEGIN) -----
B3:00B3D9 904300            MOV      DPTR,#s2_event
B3:00B3DC 12D641            LCALL    ?L?COM050D
B3:00B3DF 12D64A            LCALL    ?L?COM059C
B3:00B3E2 129FF2            LCALL    _s2_inclusion_set_timeout
B3:00B3E5 9020EA            MOV      DPTR,#the_context+0D7H
B3:00B3E8 12707E            LCALL    ?L?COM00F2
B3:00B3EB F9                MOV      R1,A
B3:00B3EC E4                CLR      A
B3:00B3ED 3A                ADDC     A,R2
B3:00B3EE FA                MOV      R2,A
B3:00B3EF 782B              MOV      R0,#LOW the_context+0318H
B3:00B3F1 7C23              MOV      R4,#HIGH the_context+0318H
B3:00B3F3 91F8              ACALL    ?L?COM023F
B3:00B3F5 9161              ACALL    ?L?COM0446
B3:00B3F7 12252E            LCALL    ?C?LSTKPTR
B3:00B3FA 00                DB       00H
B3:00B3FB 00                DB       00H
B3:00B3FC 00                DB       00H
B3:00B3FD 02                DB       02H
B3:00B3FE 904300            MOV      DPTR,#s2_event
B3:00B401 12D575            LCALL    ?L?COM00DD
B3:00B404 9020EA            MOV      DPTR,#the_context+0D7H
B3:00B407 12707E            LCALL    ?L?COM00F2
B3:00B40A F9                MOV      R1,A
B3:00B40B E4                CLR      A
B3:00B40C 3A                ADDC     A,R2
B3:00B40D FA                MOV      R2,A
B3:00B40E C003              PUSH     AR3
B3:00B410 C002              PUSH     AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 963


B3:00B412 C001              PUSH     AR1
B3:00B414 9161              ACALL    ?L?COM0446
B3:00B416 E9                MOV      A,R1
B3:00B417 2413              ADD      A,#013H
B3:00B419 F9                MOV      R1,A
B3:00B41A E4                CLR      A
B3:00B41B 3A                ADDC     A,R2
B3:00B41C A801              MOV      R0,AR1
B3:00B41E FC                MOV      R4,A
B3:00B41F AD03              MOV      R5,AR3
B3:00B421 D001              POP      AR1
B3:00B423 D002              POP      AR2
B3:00B425 D003              POP      AR3
B3:00B427 91FA              ACALL    ?L?COM0240
B3:00B429 9161              ACALL    ?L?COM0446
B3:00B42B 900011            MOV      DPTR,#011H
B3:00B42E E4                CLR      A
B3:00B42F 75F020            MOV      B,#020H
B3:00B432 12223E            LCALL    ?C?ISTOPTR
B3:00B435 9020D7            MOV      DPTR,#the_context+0C4H
B3:00B438 E0                MOVX     A,@DPTR
B3:00B439 FF                MOV      R7,A
B3:00B43A 90000F            MOV      DPTR,#0FH
B3:00B43D 122084            LCALL    ?C?CSTOPTR
B3:00B440 EF                MOV      A,R7
B3:00B441 5406              ANL      A,#06H
B3:00B443 600C              JZ       ?C0110?S2_INCLUSION
B3:00B445 902223            MOV      DPTR,#the_context+0210H
B3:00B448 E0                MOVX     A,@DPTR
B3:00B449 7006              JNZ      ?C0110?S2_INCLUSION
B3:00B44B 3157              ACALL    ?L?COM0285
B3:00B44D 7404              MOV      A,#04H
B3:00B44F 8003              SJMP     ?C0144?S2_INCLUSION
B3:00B451         ?C0110?S2_INCLUSION:
B3:00B451 3157              ACALL    ?L?COM0285
B3:00B453 E4                CLR      A
B3:00B454         
B3:00B454 122084            LCALL    ?C?CSTOPTR
B3:00B457         ?C0111?S2_INCLUSION:
B3:00B457 9161              ACALL    ?L?COM0446
B3:00B459 12D539            LCALL    ?L?COM017F
B3:00B45C 8E83              MOV      DPH,R6
B3:00B45E 02271A            LJMP     ?C?ICALL2
----- FUNCTION s2_pub_key_a_recv (END) -------


----- FUNCTION ?L?COM0446 (BEGIN) -----
B3:00B461 904300            MOV      DPTR,#s2_event
B3:00B464 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0446 (END) -------


----- FUNCTION _sec0_send_nonce (BEGIN) -----
B3:00B467 903AFE            MOV      DPTR,#snode
B3:00B46A 124765            LCALL    ?L?COM0102
B3:00B46D EB                MOV      A,R3
B3:00B46E F0                MOVX     @DPTR,A
B3:00B46F 7B01              MOV      R3,#01H
B3:00B471 7A23              MOV      R2,#HIGH txo
B3:00B473 7999              MOV      R1,#LOW txo
B3:00B475 7D06              MOV      R5,#06H
B3:00B477 E4                CLR      A
B3:00B478 FF                MOV      R7,A
B3:00B479 1299EF            LCALL    ___ZW_memset
B3:00B47C 903AFF            MOV      DPTR,#dnode
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 964


B3:00B47F E0                MOVX     A,@DPTR
B3:00B480 90239A            MOV      DPTR,#txo+01H
B3:00B483 F0                MOVX     @DPTR,A
B3:00B484 903AFE            MOV      DPTR,#snode
B3:00B487 E0                MOVX     A,@DPTR
B3:00B488 902399            MOV      DPTR,#txo
B3:00B48B F0                MOVX     @DPTR,A
B3:00B48C 903B00            MOV      DPTR,#txoptions
B3:00B48F E0                MOVX     A,@DPTR
B3:00B490 90239B            MOV      DPTR,#txo+02H
B3:00B493 F0                MOVX     @DPTR,A
B3:00B494         ?C0141?ZW_SECURITY_SCHEME0:
B3:00B494 7B01              MOV      R3,#01H
B3:00B496 7A3B              MOV      R2,#HIGH nonce
B3:00B498 7901              MOV      R1,#LOW nonce
B3:00B49A 12DA1A            LCALL    _aes_random8
B3:00B49D B101              ACALL    ?L?COM046B
B3:00B49F 7A3B              MOV      R2,#HIGH tmpnonce
B3:00B4A1 7909              MOV      R1,#LOW tmpnonce
B3:00B4A3 12ED3A            LCALL    ?L?COM0150
B3:00B4A6 E4                CLR      A
B3:00B4A7 903F92            MOV      DPTR,#?_get_nonce?BYTE+06H
B3:00B4AA F0                MOVX     @DPTR,A
B3:00B4AB 903B01            MOV      DPTR,#nonce
B3:00B4AE B133              ACALL    ?L?COM054B
B3:00B4B0 70E2              JNZ      ?C0141?ZW_SECURITY_SCHEME0
B3:00B4B2 90238F            MOV      DPTR,#nonce_res
B3:00B4B5 7498              MOV      A,#098H
B3:00B4B7 F0                MOVX     @DPTR,A
B3:00B4B8 A3                INC      DPTR
B3:00B4B9 7480              MOV      A,#080H
B3:00B4BB F0                MOVX     @DPTR,A
B3:00B4BC 7B01              MOV      R3,#01H
B3:00B4BE 7A3B              MOV      R2,#HIGH nonce
B3:00B4C0 7901              MOV      R1,#LOW nonce
B3:00B4C2 126149            LCALL    ?L?COM0047
B3:00B4C5 7A23              MOV      R2,#HIGH nonce_res+02H
B3:00B4C7 7991              MOV      R1,#LOW nonce_res+02H
B3:00B4C9 7F08              MOV      R7,#08H
B3:00B4CB 1280A2            LCALL    ___ZW_memcpy
B3:00B4CE 7B01              MOV      R3,#01H
B3:00B4D0 7A23              MOV      R2,#HIGH txo
B3:00B4D2 7999              MOV      R1,#LOW txo
B3:00B4D4 12704B            LCALL    ?L?COM00AE
B3:00B4D7 E4                CLR      A
B3:00B4D8 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00B4DB F0                MOVX     @DPTR,A
B3:00B4DC A3                INC      DPTR
B3:00B4DD F0                MOVX     @DPTR,A
B3:00B4DE 7A23              MOV      R2,#HIGH nonce_res
B3:00B4E0 798F              MOV      R1,#LOW nonce_res
B3:00B4E2 7D0A              MOV      R5,#0AH
B3:00B4E4 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00B4E7 EF                MOV      A,R7
B3:00B4E8 600D              JZ       ?C0143?ZW_SECURITY_SCHEME0
B3:00B4EA B101              ACALL    ?L?COM046B
B3:00B4EC 7A3B              MOV      R2,#HIGH nonce
B3:00B4EE 7901              MOV      R1,#LOW nonce
B3:00B4F0 12DB97            LCALL    ?L?COM054D
B3:00B4F3 1B                DEC      R3
B3:00B4F4 12DA3B            LCALL    _register_nonce
B3:00B4F7         ?C0143?ZW_SECURITY_SCHEME0:
B3:00B4F7 22                RET      
----- FUNCTION _sec0_send_nonce (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 965



----- FUNCTION ?L?COM023F (BEGIN) -----
B3:00B4F8 7D01              MOV      R5,#01H
B3:00B4FA         ?L?COM0240:
B3:00B4FA 7E00              MOV      R6,#00H
B3:00B4FC 7F20              MOV      R7,#020H
B3:00B4FE 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM023F (END) -------


----- FUNCTION ?L?COM046B (BEGIN) -----
B3:00B501 903AFF            MOV      DPTR,#dnode
B3:00B504 E0                MOVX     A,@DPTR
B3:00B505 FF                MOV      R7,A
B3:00B506 903AFE            MOV      DPTR,#snode
B3:00B509 E0                MOVX     A,@DPTR
B3:00B50A FD                MOV      R5,A
B3:00B50B 7B01              MOV      R3,#01H
B3:00B50D 22                RET      
----- FUNCTION ?L?COM046B (END) -------


----- FUNCTION ?L?COM024D (BEGIN) -----
B3:00B50E 122589            LCALL    ?C?PLDXDATA
B3:00B511 900007            MOV      DPTR,#07H
B3:00B514 12242B            LCALL    ?C?LLDOPTR
B3:00B517 903CA1            MOV      DPTR,#?_secure_learnIfaceL_send_scheme_report?BYTE+04H
B3:00B51A 1224F1            LCALL    ?C?LSTXDATA
B3:00B51D 903CA5            MOV      DPTR,#?_secure_learnIfaceL_send_scheme_report?BYTE+08H
B3:00B520 22                RET      
----- FUNCTION ?L?COM024D (END) -------


----- FUNCTION _secure_learnIface_raise_tx_done (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B521 900023            MOV      DPTR,#023H
B3:00B524 7401              MOV      A,#01H
B3:00B526 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_tx_done (END) -------


----- FUNCTION ?L?COM0334 (BEGIN) -----
B3:00B529 902E77            MOV      DPTR,#mpan
B3:00B52C 122589            LCALL    ?C?PLDXDATA
B3:00B52F 900012            MOV      DPTR,#012H
B3:00B532 22                RET      
----- FUNCTION ?L?COM0334 (END) -------


----- FUNCTION ?L?COM054B (BEGIN) -----
B3:00B533 E0                MOVX     A,@DPTR
B3:00B534 FB                MOV      R3,A
B3:00B535 B139              ACALL    _get_nonce
B3:00B537 EF                MOV      A,R7
B3:00B538 22                RET      
----- FUNCTION ?L?COM054B (END) -------


----- FUNCTION _get_nonce (BEGIN) -----
B3:00B539 903F8C            MOV      DPTR,#src
B3:00B53C 124765            LCALL    ?L?COM0102
B3:00B53F EB                MOV      A,R3
B3:00B540 F0                MOVX     @DPTR,A
B3:00B541 E4                CLR      A
B3:00B542 903F93            MOV      DPTR,#i
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 966


B3:00B545 F0                MOVX     @DPTR,A
B3:00B546         ?C0025?ZW_SECURITY_SCHEME0:
B3:00B546 903F93            MOV      DPTR,#i
B3:00B549 E0                MOVX     A,@DPTR
B3:00B54A FF                MOV      R7,A
B3:00B54B C3                CLR      C
B3:00B54C 940F              SUBB     A,#0FH
B3:00B54E 506A              JNC      ?C0026?ZW_SECURITY_SCHEME0
B3:00B550 129E52            LCALL    ?L?COM00D6
B3:00B553 E0                MOVX     A,@DPTR
B3:00B554 D3                SETB     C
B3:00B555 9400              SUBB     A,#00H
B3:00B557 4059              JC       ?C0027?ZW_SECURITY_SCHEME0
B3:00B559 903F93            MOV      DPTR,#i
B3:00B55C E0                MOVX     A,@DPTR
B3:00B55D 12DAFD            LCALL    ?L?COM024E
B3:00B560 E0                MOVX     A,@DPTR
B3:00B561 FE                MOV      R6,A
B3:00B562 903F8C            MOV      DPTR,#src
B3:00B565 E0                MOVX     A,@DPTR
B3:00B566 FD                MOV      R5,A
B3:00B567 EE                MOV      A,R6
B3:00B568 6D                XRL      A,R5
B3:00B569 7047              JNZ      ?C0027?ZW_SECURITY_SCHEME0
B3:00B56B EF                MOV      A,R7
B3:00B56C 12DB1A            LCALL    ?L?COM0235
B3:00B56F E0                MOVX     A,@DPTR
B3:00B570 FF                MOV      R7,A
B3:00B571 903F8D            MOV      DPTR,#dst
B3:00B574 E0                MOVX     A,@DPTR
B3:00B575 FE                MOV      R6,A
B3:00B576 EF                MOV      A,R7
B3:00B577 6E                XRL      A,R6
B3:00B578 7038              JNZ      ?C0027?ZW_SECURITY_SCHEME0
B3:00B57A 903F92            MOV      DPTR,#any_nonce
B3:00B57D E0                MOVX     A,@DPTR
B3:00B57E 701A              JNZ      ?C0030?ZW_SECURITY_SCHEME0
B3:00B580 A3                INC      DPTR
B3:00B581 E0                MOVX     A,@DPTR
B3:00B582 75F00C            MOV      B,#0CH
B3:00B585 A4                MUL      AB
B3:00B586 24B3              ADD      A,#LOW nonce_table+04H
B3:00B588 F582              MOV      DPL,A
B3:00B58A E4                CLR      A
B3:00B58B 3423              ADDC     A,#HIGH nonce_table+04H
B3:00B58D F583              MOV      DPH,A
B3:00B58F E0                MOVX     A,@DPTR
B3:00B590 FF                MOV      R7,A
B3:00B591 903F8E            MOV      DPTR,#ri
B3:00B594 E0                MOVX     A,@DPTR
B3:00B595 FE                MOV      R6,A
B3:00B596 EF                MOV      A,R7
B3:00B597 B50618            CJNE     A,AR6,?C0027?ZW_SECURITY_SCHEME0
B3:00B59A         ?C0030?ZW_SECURITY_SCHEME0:
B3:00B59A 903F93            MOV      DPTR,#i
B3:00B59D E0                MOVX     A,@DPTR
B3:00B59E 12DB28            LCALL    ?L?COM03F7
B3:00B5A1 126149            LCALL    ?L?COM0047
B3:00B5A4 903F8F            MOV      DPTR,#nonce
B3:00B5A7 122589            LCALL    ?C?PLDXDATA
B3:00B5AA 7F08              MOV      R7,#08H
B3:00B5AC 1280A2            LCALL    ___ZW_memcpy
B3:00B5AF 7F01              MOV      R7,#01H
B3:00B5B1 22                RET      
B3:00B5B2         ?C0027?ZW_SECURITY_SCHEME0:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 967


B3:00B5B2 903F93            MOV      DPTR,#i
B3:00B5B5 E0                MOVX     A,@DPTR
B3:00B5B6 04                INC      A
B3:00B5B7 F0                MOVX     @DPTR,A
B3:00B5B8 808C              SJMP     ?C0025?ZW_SECURITY_SCHEME0
B3:00B5BA         ?C0026?ZW_SECURITY_SCHEME0:
B3:00B5BA 7F00              MOV      R7,#00H
B3:00B5BC 22                RET      
----- FUNCTION _get_nonce (END) -------


----- FUNCTION ___S2_verify_seq (BEGIN) -----
B3:00B5BD 904393            MOV      DPTR,#seq
B3:00B5C0 ED                MOV      A,R5
B3:00B5C1 F0                MOVX     @DPTR,A
;---- Variable 'peer' assigned to Register 'R1/R2/R3' ----
B3:00B5C2 12A5A0            LCALL    ___find_span_by_node
;---- Variable 'span' assigned to Register 'R6/R7' ----
B3:00B5C5 EF                MOV      A,R7
B3:00B5C6 2426              ADD      A,#026H
B3:00B5C8 D117              ACALL    ?L?COM0096
B3:00B5CA E0                MOVX     A,@DPTR
B3:00B5CB 6401              XRL      A,#01H
B3:00B5CD 6010              JZ       ?C0032?S2
B3:00B5CF EF                MOV      A,R7
B3:00B5D0 2423              ADD      A,#023H
B3:00B5D2 D117              ACALL    ?L?COM0096
B3:00B5D4 E0                MOVX     A,@DPTR
B3:00B5D5 FD                MOV      R5,A
B3:00B5D6 904393            MOV      DPTR,#seq
B3:00B5D9 E0                MOVX     A,@DPTR
B3:00B5DA FC                MOV      R4,A
B3:00B5DB ED                MOV      A,R5
B3:00B5DC 6C                XRL      A,R4
B3:00B5DD 6011              JZ       ?C0031?S2
B3:00B5DF         ?C0032?S2:
B3:00B5DF 904393            MOV      DPTR,#seq
B3:00B5E2 E0                MOVX     A,@DPTR
B3:00B5E3 FD                MOV      R5,A
B3:00B5E4 EF                MOV      A,R7
B3:00B5E5 2423              ADD      A,#023H
B3:00B5E7 D117              ACALL    ?L?COM0096
B3:00B5E9 ED                MOV      A,R5
B3:00B5EA F0                MOVX     @DPTR,A
B3:00B5EB 7E00              MOV      R6,#00H
B3:00B5ED 7F01              MOV      R7,#01H
B3:00B5EF 22                RET      
B3:00B5F0         ?C0031?S2:
B3:00B5F0 E4                CLR      A
B3:00B5F1 FE                MOV      R6,A
B3:00B5F2 FF                MOV      R7,A
B3:00B5F3 22                RET      
----- FUNCTION ___S2_verify_seq (END) -------


----- FUNCTION ?L?COM0093 (BEGIN) -----
B3:00B5F4 900666            MOV      DPTR,#r
B3:00B5F7 E0                MOVX     A,@DPTR
B3:00B5F8 FE                MOV      R6,A
B3:00B5F9 A3                INC      DPTR
B3:00B5FA E0                MOVX     A,@DPTR
B3:00B5FB FF                MOV      R7,A
B3:00B5FC 2D                ADD      A,R5
B3:00B5FD F582              MOV      DPL,A
B3:00B5FF E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 968


B3:00B600 3E                ADDC     A,R6
B3:00B601 F583              MOV      DPH,A
B3:00B603 E0                MOVX     A,@DPTR
B3:00B604 FB                MOV      R3,A
B3:00B605 9006AD            MOV      DPTR,#UV+01H
B3:00B608 E0                MOVX     A,@DPTR
B3:00B609 2B                ADD      A,R3
B3:00B60A F0                MOVX     @DPTR,A
B3:00B60B 9006AC            MOV      DPTR,#UV
B3:00B60E E0                MOVX     A,@DPTR
B3:00B60F 3400              ADDC     A,#00H
B3:00B611 F0                MOVX     @DPTR,A
B3:00B612 A3                INC      DPTR
B3:00B613 E0                MOVX     A,@DPTR
B3:00B614 FC                MOV      R4,A
B3:00B615         ?L?COM0094:
B3:00B615 EF                MOV      A,R7
B3:00B616         ?L?COM0095:
B3:00B616 2D                ADD      A,R5
B3:00B617         ?L?COM0096:
B3:00B617 F582              MOV      DPL,A
B3:00B619 E4                CLR      A
B3:00B61A 3E                ADDC     A,R6
B3:00B61B F583              MOV      DPH,A
B3:00B61D 22                RET      
----- FUNCTION ?L?COM0093 (END) -------


----- FUNCTION ?L?COM04A2 (BEGIN) -----
B3:00B61E 7C06              MOV      R4,#HIGH t1
B3:00B620 7D45              MOV      R5,#LOW t1
B3:00B622 7A05              MOV      R2,#HIGH z2_50_0
B3:00B624 7BE5              MOV      R3,#LOW z2_50_0
----- FUNCTION _fe25519_mul (BEGIN) -----
B3:00B626 900666            MOV      DPTR,#r
B3:00B629 1270CD            LCALL    ?L?COM019E
B3:00B62C A3                INC      DPTR
B3:00B62D EA                MOV      A,R2
B3:00B62E F0                MOVX     @DPTR,A
B3:00B62F A3                INC      DPTR
B3:00B630 EB                MOV      A,R3
B3:00B631 F0                MOVX     @DPTR,A
B3:00B632 E4                CLR      A
B3:00B633 9006AC            MOV      DPTR,#UV
B3:00B636 F0                MOVX     @DPTR,A
B3:00B637 A3                INC      DPTR
B3:00B638 F0                MOVX     @DPTR,A
B3:00B639 123EDA            LCALL    ZW_WatchDogKick
B3:00B63C 7E06              MOV      R6,#HIGH t
B3:00B63E 7F6C              MOV      R7,#LOW t
B3:00B640 900668            MOV      DPTR,#a
B3:00B643 E0                MOVX     A,@DPTR
B3:00B644 FC                MOV      R4,A
B3:00B645 A3                INC      DPTR
B3:00B646 E0                MOVX     A,@DPTR
B3:00B647 FD                MOV      R5,A
B3:00B648 A3                INC      DPTR
B3:00B649 E0                MOVX     A,@DPTR
B3:00B64A FA                MOV      R2,A
B3:00B64B A3                INC      DPTR
B3:00B64C E0                MOVX     A,@DPTR
B3:00B64D FB                MOV      R3,A
B3:00B64E 121B56            LCALL    ?INTERBANK_TABLE?_bigint_mul32
;---- Variable 'i' assigned to Register 'R5' ----
B3:00B651 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 969


B3:00B652 FD                MOV      R5,A
B3:00B653         ?C0012?FE25519:
B3:00B653 12ED23            LCALL    ?L?COM04A3
B3:00B656 FC                MOV      R4,A
B3:00B657 75F004            MOV      B,#04H
B3:00B65A A4                MUL      AB
B3:00B65B FB                MOV      R3,A
B3:00B65C AAF0              MOV      R2,B
B3:00B65E EC                MOV      A,R4
B3:00B65F 75F020            MOV      B,#020H
B3:00B662 A4                MUL      AB
B3:00B663 2B                ADD      A,R3
B3:00B664 FB                MOV      R3,A
B3:00B665 E5F0              MOV      A,B
B3:00B667 3A                ADDC     A,R2
B3:00B668 FA                MOV      R2,A
B3:00B669 12ED23            LCALL    ?L?COM04A3
B3:00B66C 25E0              ADD      A,ACC
B3:00B66E FF                MOV      R7,A
B3:00B66F E4                CLR      A
B3:00B670 33                RLC      A
B3:00B671 FE                MOV      R6,A
B3:00B672 EB                MOV      A,R3
B3:00B673 2F                ADD      A,R7
B3:00B674 FB                MOV      R3,A
B3:00B675 EA                MOV      A,R2
B3:00B676 3E                ADDC     A,R6
B3:00B677 FA                MOV      R2,A
B3:00B678 9006AC            MOV      DPTR,#UV
B3:00B67B E0                MOVX     A,@DPTR
B3:00B67C 7E00              MOV      R6,#00H
B3:00B67E 2B                ADD      A,R3
B3:00B67F FF                MOV      R7,A
B3:00B680 EE                MOV      A,R6
B3:00B681 3A                ADDC     A,R2
B3:00B682 FE                MOV      R6,A
B3:00B683 746C              MOV      A,#LOW t
B3:00B685 2D                ADD      A,R5
B3:00B686 F582              MOV      DPL,A
B3:00B688 E4                CLR      A
B3:00B689 3406              ADDC     A,#HIGH t
B3:00B68B F583              MOV      DPH,A
B3:00B68D E0                MOVX     A,@DPTR
B3:00B68E 7A00              MOV      R2,#00H
B3:00B690 2F                ADD      A,R7
B3:00B691 FF                MOV      R7,A
B3:00B692 EA                MOV      A,R2
B3:00B693 3E                ADDC     A,R6
B3:00B694 9006AC            MOV      DPTR,#UV
B3:00B697 F0                MOVX     @DPTR,A
B3:00B698 A3                INC      DPTR
B3:00B699 EF                MOV      A,R7
B3:00B69A F0                MOVX     @DPTR,A
B3:00B69B 900666            MOV      DPTR,#r
B3:00B69E 12EDD6            LCALL    ?L?COM041F
B3:00B6A1 0D                INC      R5
B3:00B6A2 ED                MOV      A,R5
B3:00B6A3 B420AD            CJNE     A,#020H,?C0012?FE25519
B3:00B6A6         ?C0013?FE25519:
B3:00B6A6 9006AC            MOV      DPTR,#UV
B3:00B6A9 127175            LCALL    ?L?COM0318
B3:00B6AC 75F026            MOV      B,#026H
B3:00B6AF A4                MUL      AB
B3:00B6B0 FF                MOV      R7,A
B3:00B6B1 9006AC            MOV      DPTR,#UV
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 970


B3:00B6B4 12ED14            LCALL    ?L?COM01F0
B3:00B6B7 E4                CLR      A
B3:00B6B8 FD                MOV      R5,A
B3:00B6B9         ?C0015?FE25519:
B3:00B6B9 B1F4              ACALL    ?L?COM0093
B3:00B6BB EC                MOV      A,R4
B3:00B6BC F0                MOVX     @DPTR,A
B3:00B6BD 9006AC            MOV      DPTR,#UV
B3:00B6C0 E0                MOVX     A,@DPTR
B3:00B6C1 12ED79            LCALL    ?L?COM0135
B3:00B6C4 B420F2            CJNE     A,#020H,?C0015?FE25519
B3:00B6C7         ?C0016?FE25519:
B3:00B6C7 9006AC            MOV      DPTR,#UV
B3:00B6CA A3                INC      DPTR
B3:00B6CB E0                MOVX     A,@DPTR
B3:00B6CC 75F026            MOV      B,#026H
B3:00B6CF A4                MUL      AB
B3:00B6D0 FF                MOV      R7,A
B3:00B6D1 9006AC            MOV      DPTR,#UV
B3:00B6D4 12ED14            LCALL    ?L?COM01F0
B3:00B6D7 E4                CLR      A
B3:00B6D8 FD                MOV      R5,A
B3:00B6D9         ?C0018?FE25519:
B3:00B6D9 B1F4              ACALL    ?L?COM0093
B3:00B6DB EC                MOV      A,R4
B3:00B6DC F0                MOVX     @DPTR,A
B3:00B6DD 9006AC            MOV      DPTR,#UV
B3:00B6E0 E0                MOVX     A,@DPTR
B3:00B6E1 12ED79            LCALL    ?L?COM0135
B3:00B6E4 B403F2            CJNE     A,#03H,?C0018?FE25519
B3:00B6E7 22                RET      
----- FUNCTION _fe25519_mul (END) -------


----- FUNCTION ?L?COM005B (BEGIN) -----
B3:00B6E8 F106              ACALL    _fe25519_square
B3:00B6EA 7E06              MOV      R6,#HIGH t1
B3:00B6EC 7F45              MOV      R7,#LOW t1
B3:00B6EE 7C06              MOV      R4,#HIGH t0
B3:00B6F0 7D25              MOV      R5,#LOW t0
B3:00B6F2 F106              ACALL    _fe25519_square
B3:00B6F4         ?L?COM005C:
B3:00B6F4 7E06              MOV      R6,#HIGH t0
B3:00B6F6 7F25              MOV      R7,#LOW t0
B3:00B6F8 7C06              MOV      R4,#HIGH t1
B3:00B6FA 7D45              MOV      R5,#LOW t1
B3:00B6FC         ?L?COM005D:
B3:00B6FC F106              ACALL    _fe25519_square
B3:00B6FE         ?L?COM005E:
B3:00B6FE 7E06              MOV      R6,#HIGH t1
B3:00B700 7F45              MOV      R7,#LOW t1
B3:00B702 7C06              MOV      R4,#HIGH t0
B3:00B704 7D25              MOV      R5,#LOW t0
----- FUNCTION _fe25519_square (BEGIN) -----
;---- Variable 'x' assigned to Register 'R2/R3' ----
B3:00B706 AB05              MOV      R3,AR5
B3:00B708 AA04              MOV      R2,AR4
;---- Variable 'r' assigned to Register 'R6/R7' ----
B3:00B70A C126              AJMP     _fe25519_mul
----- FUNCTION _fe25519_square (END) -------


----- FUNCTION _fe25519_invert (BEGIN) -----
B3:00B70C 900521            MOV      DPTR,#r
B3:00B70F 1270CD            LCALL    ?L?COM019E
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 971


B3:00B712 7E05              MOV      R6,#HIGH z2
B3:00B714 7F25              MOV      R7,#LOW z2
B3:00B716 F106              ACALL    _fe25519_square
B3:00B718 7E06              MOV      R6,#HIGH t1
B3:00B71A 7F45              MOV      R7,#LOW t1
B3:00B71C 7C05              MOV      R4,#HIGH z2
B3:00B71E 7D25              MOV      R5,#LOW z2
B3:00B720 F106              ACALL    _fe25519_square
B3:00B722 7E06              MOV      R6,#HIGH t0
B3:00B724 7F25              MOV      R7,#LOW t0
B3:00B726 7C06              MOV      R4,#HIGH t1
B3:00B728 7D45              MOV      R5,#LOW t1
B3:00B72A F106              ACALL    _fe25519_square
B3:00B72C 7E05              MOV      R6,#HIGH z9
B3:00B72E 7F45              MOV      R7,#LOW z9
B3:00B730 7C06              MOV      R4,#HIGH t0
B3:00B732 7D25              MOV      R5,#LOW t0
B3:00B734 900523            MOV      DPTR,#x
B3:00B737 E0                MOVX     A,@DPTR
B3:00B738 FA                MOV      R2,A
B3:00B739 A3                INC      DPTR
B3:00B73A E0                MOVX     A,@DPTR
B3:00B73B FB                MOV      R3,A
B3:00B73C D126              ACALL    _fe25519_mul
B3:00B73E 7E05              MOV      R6,#HIGH z11
B3:00B740 7F65              MOV      R7,#LOW z11
B3:00B742 7C05              MOV      R4,#HIGH z9
B3:00B744 7D45              MOV      R5,#LOW z9
B3:00B746 7A05              MOV      R2,#HIGH z2
B3:00B748 7B25              MOV      R3,#LOW z2
B3:00B74A D126              ACALL    _fe25519_mul
B3:00B74C 7E06              MOV      R6,#HIGH t0
B3:00B74E 7F25              MOV      R7,#LOW t0
B3:00B750 7C05              MOV      R4,#HIGH z11
B3:00B752 7D65              MOV      R5,#LOW z11
B3:00B754 F106              ACALL    _fe25519_square
B3:00B756 7E05              MOV      R6,#HIGH z2_5_0
B3:00B758 7F85              MOV      R7,#LOW z2_5_0
B3:00B75A 7C06              MOV      R4,#HIGH t0
B3:00B75C 7D25              MOV      R5,#LOW t0
B3:00B75E 7A05              MOV      R2,#HIGH z9
B3:00B760 7B45              MOV      R3,#LOW z9
B3:00B762 D126              ACALL    _fe25519_mul
B3:00B764 7E06              MOV      R6,#HIGH t0
B3:00B766 7F25              MOV      R7,#LOW t0
B3:00B768 7C05              MOV      R4,#HIGH z2_5_0
B3:00B76A 7D85              MOV      R5,#LOW z2_5_0
B3:00B76C D1E8              ACALL    ?L?COM005B
B3:00B76E 7E06              MOV      R6,#HIGH t0
B3:00B770 7F25              MOV      R7,#LOW t0
B3:00B772 7C06              MOV      R4,#HIGH t1
B3:00B774 7D45              MOV      R5,#LOW t1
B3:00B776 F106              ACALL    _fe25519_square
B3:00B778 7E05              MOV      R6,#HIGH z2_10_0
B3:00B77A 7FA5              MOV      R7,#LOW z2_10_0
B3:00B77C 7C06              MOV      R4,#HIGH t0
B3:00B77E 7D25              MOV      R5,#LOW t0
B3:00B780 7A05              MOV      R2,#HIGH z2_5_0
B3:00B782 7B85              MOV      R3,#LOW z2_5_0
B3:00B784 D126              ACALL    _fe25519_mul
B3:00B786 7E06              MOV      R6,#HIGH t0
B3:00B788 7F25              MOV      R7,#LOW t0
B3:00B78A 7C05              MOV      R4,#HIGH z2_10_0
B3:00B78C 7DA5              MOV      R5,#LOW z2_10_0
B3:00B78E D1FC              ACALL    ?L?COM005D
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 972


B3:00B790 12B890            LCALL    ?L?COM0264
B3:00B793         ?C0041?FE25519:
B3:00B793 12ED1B            LCALL    ?L?COM05FC
B3:00B796 5007              JNC      ?C0042?FE25519
B3:00B798 D1F4              ACALL    ?L?COM005C
B3:00B79A 12B8A2            LCALL    ?L?COM0228
B3:00B79D 80F4              SJMP     ?C0041?FE25519
B3:00B79F         ?C0042?FE25519:
B3:00B79F 7E05              MOV      R6,#HIGH z2_20_0
B3:00B7A1 7FC5              MOV      R7,#LOW z2_20_0
B3:00B7A3 7C06              MOV      R4,#HIGH t1
B3:00B7A5 7D45              MOV      R5,#LOW t1
B3:00B7A7 7A05              MOV      R2,#HIGH z2_10_0
B3:00B7A9 7BA5              MOV      R3,#LOW z2_10_0
B3:00B7AB D126              ACALL    _fe25519_mul
B3:00B7AD 7E06              MOV      R6,#HIGH t0
B3:00B7AF 7F25              MOV      R7,#LOW t0
B3:00B7B1 7C05              MOV      R4,#HIGH z2_20_0
B3:00B7B3 7DC5              MOV      R5,#LOW z2_20_0
B3:00B7B5 D1FC              ACALL    ?L?COM005D
B3:00B7B7 12B890            LCALL    ?L?COM0264
B3:00B7BA         ?C0044?FE25519:
B3:00B7BA 900665            MOV      DPTR,#i
B3:00B7BD E0                MOVX     A,@DPTR
B3:00B7BE C3                CLR      C
B3:00B7BF 9414              SUBB     A,#014H
B3:00B7C1 5007              JNC      ?C0045?FE25519
B3:00B7C3 D1F4              ACALL    ?L?COM005C
B3:00B7C5 12B8A2            LCALL    ?L?COM0228
B3:00B7C8 80F0              SJMP     ?C0044?FE25519
B3:00B7CA         ?C0045?FE25519:
B3:00B7CA 7E06              MOV      R6,#HIGH t0
B3:00B7CC 7F25              MOV      R7,#LOW t0
B3:00B7CE 7C06              MOV      R4,#HIGH t1
B3:00B7D0 7D45              MOV      R5,#LOW t1
B3:00B7D2 7A05              MOV      R2,#HIGH z2_20_0
B3:00B7D4 7BC5              MOV      R3,#LOW z2_20_0
B3:00B7D6 D126              ACALL    _fe25519_mul
B3:00B7D8 D1FE              ACALL    ?L?COM005E
B3:00B7DA 12B885            LCALL    ?L?COM0263
B3:00B7DD         ?C0047?FE25519:
B3:00B7DD 12ED1B            LCALL    ?L?COM05FC
B3:00B7E0 5007              JNC      ?C0048?FE25519
B3:00B7E2 D1FE              ACALL    ?L?COM005E
B3:00B7E4 12B897            LCALL    ?L?COM0227
B3:00B7E7 80F4              SJMP     ?C0047?FE25519
B3:00B7E9         ?C0048?FE25519:
B3:00B7E9 7E05              MOV      R6,#HIGH z2_50_0
B3:00B7EB 7FE5              MOV      R7,#LOW z2_50_0
B3:00B7ED 7C06              MOV      R4,#HIGH t0
B3:00B7EF 7D25              MOV      R5,#LOW t0
B3:00B7F1 7A05              MOV      R2,#HIGH z2_10_0
B3:00B7F3 7BA5              MOV      R3,#LOW z2_10_0
B3:00B7F5 D126              ACALL    _fe25519_mul
B3:00B7F7 7E06              MOV      R6,#HIGH t0
B3:00B7F9 7F25              MOV      R7,#LOW t0
B3:00B7FB 7C05              MOV      R4,#HIGH z2_50_0
B3:00B7FD 7DE5              MOV      R5,#LOW z2_50_0
B3:00B7FF 12B6FC            LCALL    ?L?COM005D
B3:00B802 12B890            LCALL    ?L?COM0264
B3:00B805         ?C0050?FE25519:
B3:00B805 900665            MOV      DPTR,#i
B3:00B808 E0                MOVX     A,@DPTR
B3:00B809 C3                CLR      C
B3:00B80A 9432              SUBB     A,#032H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 973


B3:00B80C 5007              JNC      ?C0051?FE25519
B3:00B80E 12B6F4            LCALL    ?L?COM005C
B3:00B811 11A2              ACALL    ?L?COM0228
B3:00B813 80F0              SJMP     ?C0050?FE25519
B3:00B815         ?C0051?FE25519:
B3:00B815 7E06              MOV      R6,#HIGH z2_100_0
B3:00B817 7F05              MOV      R7,#LOW z2_100_0
B3:00B819 12B61E            LCALL    ?L?COM04A2
B3:00B81C 7E06              MOV      R6,#HIGH t1
B3:00B81E 7F45              MOV      R7,#LOW t1
B3:00B820 7C06              MOV      R4,#HIGH z2_100_0
B3:00B822 7D05              MOV      R5,#LOW z2_100_0
B3:00B824 12B706            LCALL    _fe25519_square
B3:00B827 1185              ACALL    ?L?COM0263
B3:00B829         ?C0053?FE25519:
B3:00B829 900665            MOV      DPTR,#i
B3:00B82C E0                MOVX     A,@DPTR
B3:00B82D C3                CLR      C
B3:00B82E 9464              SUBB     A,#064H
B3:00B830 5007              JNC      ?C0054?FE25519
B3:00B832 12B6FE            LCALL    ?L?COM005E
B3:00B835 1197              ACALL    ?L?COM0227
B3:00B837 80F0              SJMP     ?C0053?FE25519
B3:00B839         ?C0054?FE25519:
B3:00B839 7E06              MOV      R6,#HIGH t1
B3:00B83B 7F45              MOV      R7,#LOW t1
B3:00B83D 7C06              MOV      R4,#HIGH t0
B3:00B83F 7D25              MOV      R5,#LOW t0
B3:00B841 7A06              MOV      R2,#HIGH z2_100_0
B3:00B843 7B05              MOV      R3,#LOW z2_100_0
B3:00B845 12B626            LCALL    _fe25519_mul
B3:00B848 12B6F4            LCALL    ?L?COM005C
B3:00B84B 1190              ACALL    ?L?COM0264
B3:00B84D         ?C0056?FE25519:
B3:00B84D 900665            MOV      DPTR,#i
B3:00B850 E0                MOVX     A,@DPTR
B3:00B851 C3                CLR      C
B3:00B852 9432              SUBB     A,#032H
B3:00B854 5007              JNC      ?C0057?FE25519
B3:00B856 12B6F4            LCALL    ?L?COM005C
B3:00B859 11A2              ACALL    ?L?COM0228
B3:00B85B 80F0              SJMP     ?C0056?FE25519
B3:00B85D         ?C0057?FE25519:
B3:00B85D 7E06              MOV      R6,#HIGH t0
B3:00B85F 7F25              MOV      R7,#LOW t0
B3:00B861 12B61E            LCALL    ?L?COM04A2
B3:00B864 12B6FE            LCALL    ?L?COM005E
B3:00B867 7E06              MOV      R6,#HIGH t0
B3:00B869 7F25              MOV      R7,#LOW t0
B3:00B86B 7C06              MOV      R4,#HIGH t1
B3:00B86D 7D45              MOV      R5,#LOW t1
B3:00B86F 12B6E8            LCALL    ?L?COM005B
B3:00B872 900521            MOV      DPTR,#r
B3:00B875 E0                MOVX     A,@DPTR
B3:00B876 FE                MOV      R6,A
B3:00B877 A3                INC      DPTR
B3:00B878 E0                MOVX     A,@DPTR
B3:00B879 FF                MOV      R7,A
B3:00B87A 7C06              MOV      R4,#HIGH t1
B3:00B87C 7D45              MOV      R5,#LOW t1
B3:00B87E 7A05              MOV      R2,#HIGH z11
B3:00B880 7B65              MOV      R3,#LOW z11
B3:00B882 02B626            LJMP     _fe25519_mul
----- FUNCTION _fe25519_invert (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 974



----- FUNCTION ?L?COM0263 (BEGIN) -----
B3:00B885 7E06              MOV      R6,#HIGH t0
B3:00B887 7F25              MOV      R7,#LOW t0
B3:00B889 7C06              MOV      R4,#HIGH t1
B3:00B88B 7D45              MOV      R5,#LOW t1
B3:00B88D 12B706            LCALL    _fe25519_square
B3:00B890         ?L?COM0264:
B3:00B890 900665            MOV      DPTR,#i
B3:00B893 7402              MOV      A,#02H
B3:00B895 F0                MOVX     @DPTR,A
B3:00B896 22                RET      
----- FUNCTION ?L?COM0263 (END) -------


----- FUNCTION ?L?COM0227 (BEGIN) -----
B3:00B897 7E06              MOV      R6,#HIGH t0
B3:00B899 7F25              MOV      R7,#LOW t0
B3:00B89B 7C06              MOV      R4,#HIGH t1
B3:00B89D 7D45              MOV      R5,#LOW t1
B3:00B89F 12B706            LCALL    _fe25519_square
B3:00B8A2         ?L?COM0228:
B3:00B8A2 900665            MOV      DPTR,#i
B3:00B8A5 E0                MOVX     A,@DPTR
B3:00B8A6 2402              ADD      A,#02H
B3:00B8A8 F0                MOVX     @DPTR,A
B3:00B8A9 22                RET      
----- FUNCTION ?L?COM0227 (END) -------


----- FUNCTION send_frag_complete_cmd (BEGIN) -----
B3:00B8AA E4                CLR      A
B3:00B8AB 904263            MOV      DPTR,#ret
B3:00B8AE F0                MOVX     @DPTR,A
B3:00B8AF 9028A5            MOV      DPTR,#rcb+01CH
B3:00B8B2 E0                MOVX     A,@DPTR
B3:00B8B3 FE                MOV      R6,A
B3:00B8B4 D3                SETB     C
B3:00B8B5 940F              SUBB     A,#0FH
B3:00B8B7 4003              JC       ?C0184?TRANSPORT_SERVICE2
B3:00B8B9 7F00              MOV      R7,#00H
B3:00B8BB 22                RET      
B3:00B8BC         ?C0184?TRANSPORT_SERVICE2:
B3:00B8BC 904264            MOV      DPTR,#frag_compl
B3:00B8BF 7455              MOV      A,#055H
B3:00B8C1 F0                MOVX     @DPTR,A
B3:00B8C2 A3                INC      DPTR
B3:00B8C3 74E8              MOV      A,#0E8H
B3:00B8C5 F0                MOVX     @DPTR,A
B3:00B8C6 EE                MOV      A,R6
B3:00B8C7 C4                SWAP     A
B3:00B8C8 54F0              ANL      A,#0F0H
B3:00B8CA A3                INC      DPTR
B3:00B8CB B1ED              ACALL    ?L?COM002F
B3:00B8CD B1A7              ACALL    ?L?COM0083
B3:00B8CF 7B01              MOV      R3,#01H
B3:00B8D1 7A42              MOV      R2,#HIGH frag_compl
B3:00B8D3 7964              MOV      R1,#LOW frag_compl
B3:00B8D5 12EDEF            LCALL    ?L?COM02D1
B3:00B8D8 90288D            MOV      DPTR,#rcb+04H
B3:00B8DB 12CBD0            LCALL    ?L?COM013A
B3:00B8DE 12EC86            LCALL    ?L?COM0589
B3:00B8E1 12CDE8            LCALL    ?L?COM019C
B3:00B8E4 904263            MOV      DPTR,#ret
B3:00B8E7 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 975


B3:00B8E8         ?C0186?TRANSPORT_SERVICE2:
B3:00B8E8 9028A5            MOV      DPTR,#rcb+01CH
B3:00B8EB B1D7              ACALL    ?L?COM03C6
B3:00B8ED 7401              MOV      A,#01H
B3:00B8EF F0                MOVX     @DPTR,A
B3:00B8F0 12ED96            LCALL    ?L?COM042D
B3:00B8F3 E4                CLR      A
B3:00B8F4 9029A7            MOV      DPTR,#rcb+011EH
B3:00B8F7 F0                MOVX     @DPTR,A
B3:00B8F8 12EDCD            LCALL    ?L?COM0576
B3:00B8FB FF                MOV      R7,A
B3:00B8FC 1299EF            LCALL    ___ZW_memset
B3:00B8FF E4                CLR      A
B3:00B900 9029B2            MOV      DPTR,#rcb+0129H
B3:00B903 12ECC1            LCALL    ?L?COM04DC
B3:00B906 7F05              MOV      R7,#05H
B3:00B908 B15A              ACALL    _t2_sm_post_event
B3:00B90A 5126              ACALL    ?L?COM043E
B3:00B90C 9029B3            MOV      DPTR,#rcb+012AH
B3:00B90F A3                INC      DPTR
B3:00B910 E0                MOVX     A,@DPTR
B3:00B911 FD                MOV      R5,A
B3:00B912 902889            MOV      DPTR,#rcb
B3:00B915 E0                MOVX     A,@DPTR
B3:00B916 904185            MOV      DPTR,#?_TransportService_msg_received_event?BYTE+04H
B3:00B919 F0                MOVX     @DPTR,A
B3:00B91A 121A11            LCALL    ?INTERBANK_TABLE?_TransportService_msg_received_event
B3:00B91D 7F00              MOV      R7,#00H
B3:00B91F 22                RET      
----- FUNCTION send_frag_complete_cmd (END) -------


----- FUNCTION _ZW_SendConst (BEGIN) -----
B3:00B920 90434E            MOV      DPTR,#bChNo
B3:00B923 ED                MOV      A,R5
B3:00B924 F0                MOVX     @DPTR,A
B3:00B925 A3                INC      DPTR
B3:00B926 EB                MOV      A,R3
B3:00B927 F0                MOVX     @DPTR,A
;---- Variable 'bStart' assigned to Register 'R7' ----
B3:00B928 EF                MOV      A,R7
B3:00B929 607B              JZ       ?C0005?ZW_TRANSPORT_SUPPORT
B3:00B92B A2EB              MOV      C,ERF
B3:00B92D 9219              MOV      erf_store,C
B3:00B92F C2EB              CLR      ERF
B3:00B931 D21A              SETB     rfProdTestOn
B3:00B933 90434E            MOV      DPTR,#bChNo
B3:00B936 E0                MOVX     A,@DPTR
B3:00B937 90320E            MOV      DPTR,#rf_table+0CH
B3:00B93A 93                MOVC     A,@A+DPTR
B3:00B93B 5406              ANL      A,#06H
B3:00B93D 9006B0            MOV      DPTR,#rfTxCurrentSpeed
B3:00B940 F0                MOVX     @DPTR,A
B3:00B941 90434F            MOV      DPTR,#bSignalType
B3:00B944 E0                MOVX     A,@DPTR
B3:00B945 703C              JNZ      ?C0006?ZW_TRANSPORT_SUPPORT
B3:00B947 C218              CLR      rfProdTestDataMod
B3:00B949 31CA              ACALL    ?L?COM054E
B3:00B94B 75FF01            MOV      SFRPAGE,#01H
B3:00B94E 904350            MOV      DPTR,#temp_store_rfhssep
B3:00B951 E5DE              MOV      A,RFHSSEP
B3:00B953 F0                MOVX     @DPTR,A
B3:00B954 75FF01            MOV      SFRPAGE,#01H
B3:00B957 A3                INC      DPTR
B3:00B958 E5DF              MOV      A,RFLSSEP
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 976


B3:00B95A F0                MOVX     @DPTR,A
B3:00B95B 75FF01            MOV      SFRPAGE,#01H
B3:00B95E E4                CLR      A
B3:00B95F F5DE              MOV      RFHSSEP,A
B3:00B961 75FF01            MOV      SFRPAGE,#01H
B3:00B964 F5DF              MOV      RFLSSEP,A
B3:00B966 F5FF              MOV      SFRPAGE,A
B3:00B968 75CE11            MOV      DPLLGSCON,#011H
B3:00B96B F5FF              MOV      SFRPAGE,A
B3:00B96D F5CF              MOV      DPLLGSVLO,A
B3:00B96F F5FF              MOV      SFRPAGE,A
B3:00B971 75CE21            MOV      DPLLGSCON,#021H
B3:00B974 F5FF              MOV      SFRPAGE,A
B3:00B976 F5CF              MOV      DPLLGSVLO,A
B3:00B978 F5FF              MOV      SFRPAGE,A
B3:00B97A 75CE31            MOV      DPLLGSCON,#031H
B3:00B97D F5FF              MOV      SFRPAGE,A
B3:00B97F F5CF              MOV      DPLLGSVLO,A
B3:00B981 800B              SJMP     ?C0009?ZW_TRANSPORT_SUPPORT
B3:00B983         ?C0006?ZW_TRANSPORT_SUPPORT:
B3:00B983 90434F            MOV      DPTR,#bSignalType
B3:00B986 E0                MOVX     A,@DPTR
B3:00B987 B40104            CJNE     A,#01H,?C0009?ZW_TRANSPORT_SUPPORT
B3:00B98A D218              SETB     rfProdTestDataMod
B3:00B98C 31CA              ACALL    ?L?COM054E
B3:00B98E         ?C0009?ZW_TRANSPORT_SUPPORT:
B3:00B98E 90434E            MOV      DPTR,#bChNo
B3:00B991 E0                MOVX     A,@DPTR
B3:00B992 FF                MOV      R7,A
B3:00B993 9006B0            MOV      DPTR,#rfTxCurrentSpeed
B3:00B996 E0                MOVX     A,@DPTR
B3:00B997 FD                MOV      R5,A
B3:00B998 E4                CLR      A
B3:00B999 904024            MOV      DPTR,#?_RF_switch_to_TX?BYTE+03H
B3:00B99C F0                MOVX     @DPTR,A
B3:00B99D AB1B              MOV      R3,normal_PA_POW
B3:00B99F 125D1D            LCALL    _RF_switch_to_TX
B3:00B9A2 4025              JC       ?C0012?ZW_TRANSPORT_SUPPORT
B3:00B9A4 80E8              SJMP     ?C0009?ZW_TRANSPORT_SUPPORT
B3:00B9A6         ?C0005?ZW_TRANSPORT_SUPPORT:
B3:00B9A6 A219              MOV      C,erf_store
B3:00B9A8 92EB              MOV      ERF,C
B3:00B9AA C21A              CLR      rfProdTestOn
B3:00B9AC C218              CLR      rfProdTestDataMod
B3:00B9AE E4                CLR      A
B3:00B9AF F5FF              MOV      SFRPAGE,A
B3:00B9B1 53B1FD            ANL      DPLLCON,#0FDH
B3:00B9B4 124F67            LCALL    RF_shutdown
B3:00B9B7 75FF01            MOV      SFRPAGE,#01H
B3:00B9BA 904350            MOV      DPTR,#temp_store_rfhssep
B3:00B9BD E0                MOVX     A,@DPTR
B3:00B9BE F5DE              MOV      RFHSSEP,A
B3:00B9C0 75FF01            MOV      SFRPAGE,#01H
B3:00B9C3 A3                INC      DPTR
B3:00B9C4 E0                MOVX     A,@DPTR
B3:00B9C5 F5DF              MOV      RFLSSEP,A
B3:00B9C7 31CA              ACALL    ?L?COM054E
B3:00B9C9         ?C0012?ZW_TRANSPORT_SUPPORT:
B3:00B9C9 22                RET      
----- FUNCTION _ZW_SendConst (END) -------


----- FUNCTION ?L?COM054E (BEGIN) -----
B3:00B9CA 121A25            LCALL    ?INTERBANK_TABLE?RFDriverInitHW
B3:00B9CD 021A2F            LJMP     ?INTERBANK_TABLE?RFDriverInitSW
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 977


----- FUNCTION ?L?COM054E (END) -------


----- FUNCTION _secure_learn_raiseTimeEvent (BEGIN) -----
B3:00B9D0 904114            MOV      DPTR,#handle
B3:00B9D3 1225A9            LCALL    ?C?PSTXDATA
B3:00B9D6 5112              ACALL    ?L?COM03B3
B3:00B9D8 C003              PUSH     AR3
B3:00B9DA C002              PUSH     AR2
B3:00B9DC C001              PUSH     AR1
B3:00B9DE 510A              ACALL    ?L?COM060E
B3:00B9E0 D082              POP      DPL
B3:00B9E2 D083              POP      DPH
B3:00B9E4 D0E0              POP      ACC
B3:00B9E6 12736C            LCALL    ?L?COM0546
B3:00B9E9         ?C0161?SECURE_LEARN:
B3:00B9E9 401E              JC       ?C0040?SECURE_LEARN
B3:00B9EB 5112              ACALL    ?L?COM03B3
B3:00B9ED 1272CD            LCALL    ?L?COM0486
B3:00B9F0 C003              PUSH     AR3
B3:00B9F2 C002              PUSH     AR2
B3:00B9F4 C001              PUSH     AR1
B3:00B9F6 510A              ACALL    ?L?COM060E
B3:00B9F8 D082              POP      DPL
B3:00B9FA D083              POP      DPH
B3:00B9FC D0E0              POP      ACC
B3:00B9FE 12736C            LCALL    ?L?COM0546
B3:00BA01         ?C0162?SECURE_LEARN:
B3:00BA01 5006              JNC      ?C0040?SECURE_LEARN
B3:00BA03 904117            MOV      DPTR,#evid
B3:00BA06 12727A            LCALL    ?L?COM0432
B3:00BA09         ?C0040?SECURE_LEARN:
B3:00BA09 22                RET      
----- FUNCTION _secure_learn_raiseTimeEvent (END) -------


----- FUNCTION ?L?COM060E (BEGIN) -----
B3:00BA0A 904117            MOV      DPTR,#evid
B3:00BA0D 122589            LCALL    ?C?PLDXDATA
B3:00BA10 C3                CLR      C
B3:00BA11 22                RET      
----- FUNCTION ?L?COM060E (END) -------


----- FUNCTION ?L?COM03B3 (BEGIN) -----
B3:00BA12 904114            MOV      DPTR,#handle
B3:00BA15 122589            LCALL    ?C?PLDXDATA
B3:00BA18 E9                MOV      A,R1
B3:00BA19 2440              ADD      A,#040H
B3:00BA1B F9                MOV      R1,A
B3:00BA1C E4                CLR      A
B3:00BA1D 3A                ADDC     A,R2
B3:00BA1E FA                MOV      R2,A
B3:00BA1F 22                RET      
----- FUNCTION ?L?COM03B3 (END) -------


----- FUNCTION _secure_learnIface_get_net_scheme (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00BA20 900014            MOV      DPTR,#014H
B3:00BA23 02242B            LJMP     ?C?LLDOPTR
----- FUNCTION _secure_learnIface_get_net_scheme (END) -------


----- FUNCTION ?L?COM043E (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 978


B3:00BA26 7B01              MOV      R3,#01H
B3:00BA28 7A28              MOV      R2,#HIGH rcb+054H
B3:00BA2A 79DD              MOV      R1,#LOW rcb+054H
B3:00BA2C 22                RET      
----- FUNCTION ?L?COM043E (END) -------


----- FUNCTION _fe25519_sub (BEGIN) -----
B3:00BA2D 900AD1            MOV      DPTR,#r
B3:00BA30 EE                MOV      A,R6
B3:00BA31 F0                MOVX     @DPTR,A
B3:00BA32 A3                INC      DPTR
B3:00BA33 EF                MOV      A,R7
B3:00BA34 F0                MOVX     @DPTR,A
;---- Variable 'b' assigned to Register 'R2/R3' ----
;---- Variable 'a' assigned to Register 'R4/R5' ----
B3:00BA35 B19F              ACALL    ?L?COM04A4
B3:00BA37 FF                MOV      R7,A
B3:00BA38 903EB7            MOV      DPTR,#?_bigint_sub?BYTE+06H
B3:00BA3B 7420              MOV      A,#020H
B3:00BA3D F0                MOVX     @DPTR,A
B3:00BA3E 121B51            LCALL    ?INTERBANK_TABLE?_bigint_sub
;---- Variable 'borrow' assigned to Register 'R7' ----
B3:00BA41 EF                MOV      A,R7
B3:00BA42 12ED0C            LCALL    ?L?COM01EF
;---- Variable 'i' assigned to Register 'R5' ----
B3:00BA45 E4                CLR      A
B3:00BA46 FD                MOV      R5,A
B3:00BA47         ?C0005?FE25519:
B3:00BA47 B19F              ACALL    ?L?COM04A4
B3:00BA49 12B616            LCALL    ?L?COM0095
B3:00BA4C 12ED48            LCALL    ?L?COM0134
B3:00BA4F B420F5            CJNE     A,#020H,?C0005?FE25519
B3:00BA52         ?C0006?FE25519:
B3:00BA52 900AD3            MOV      DPTR,#tmp
B3:00BA55 A3                INC      DPTR
B3:00BA56 E0                MOVX     A,@DPTR
B3:00BA57 12ED0C            LCALL    ?L?COM01EF
B3:00BA5A E4                CLR      A
B3:00BA5B FD                MOV      R5,A
B3:00BA5C         ?C0008?FE25519:
B3:00BA5C B19F              ACALL    ?L?COM04A4
B3:00BA5E 12B616            LCALL    ?L?COM0095
B3:00BA61 12ED48            LCALL    ?L?COM0134
B3:00BA64 B403F5            CJNE     A,#03H,?C0008?FE25519
B3:00BA67 22                RET      
----- FUNCTION _fe25519_sub (END) -------


----- FUNCTION receive (BEGIN) -----
B3:00BA68 9028A7            MOV      DPTR,#rcb+01EH
B3:00BA6B 129276            LCALL    ?L?COM0065
B3:00BA6E 9038BB            MOV      DPTR,#byte1
B3:00BA71 F0                MOVX     @DPTR,A
B3:00BA72 12AB1D            LCALL    ?L?COM0110
B3:00BA75 9038BC            MOV      DPTR,#byte2
B3:00BA78 F0                MOVX     @DPTR,A
B3:00BA79 1291A4            LCALL    ?L?COM004C
B3:00BA7C 9038BD            MOV      DPTR,#byte3
B3:00BA7F F0                MOVX     @DPTR,A
B3:00BA80 1270EB            LCALL    ?L?COM01E4
B3:00BA83 9038BE            MOV      DPTR,#byte4
B3:00BA86 12A577            LCALL    ?L?COM01B6
B3:00BA89 A3                INC      DPTR
B3:00BA8A F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 979


B3:00BA8B 121FB3            LCALL    ?C?CLDPTR
B3:00BA8E 6455              XRL      A,#055H
B3:00BA90 6002              JZ       $ + 4H
B3:00BA92 A159              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00BA94         ?C0137?TRANSPORT_SERVICE2:
B3:00BA94 9038BB            MOV      DPTR,#byte1
B3:00BA97 E0                MOVX     A,@DPTR
B3:00BA98 54F8              ANL      A,#0F8H
B3:00BA9A 2438              ADD      A,#038H
B3:00BA9C 7002              JNZ      $ + 4H
B3:00BA9E 8164              AJMP     ?C0162?TRANSPORT_SERVICE2
B3:00BAA0 24E8              ADD      A,#0E8H
B3:00BAA2 7002              JNZ      $ + 4H
B3:00BAA4 615A              AJMP     ?C0149?TRANSPORT_SERVICE2
B3:00BAA6 24F8              ADD      A,#0F8H
B3:00BAA8 7002              JNZ      $ + 4H
B3:00BAAA 81B5              AJMP     ?C0168?TRANSPORT_SERVICE2
B3:00BAAC 24F8              ADD      A,#0F8H
B3:00BAAE 7002              JNZ      $ + 4H
B3:00BAB0 A107              AJMP     ?C0175?TRANSPORT_SERVICE2
B3:00BAB2 2430              ADD      A,#030H
B3:00BAB4 6002              JZ       $ + 4H
B3:00BAB6 A159              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00BAB8         ?C0140?TRANSPORT_SERVICE2:
B3:00BAB8 902882            MOV      DPTR,#flag_tie_broken
B3:00BABB E0                MOVX     A,@DPTR
B3:00BABC 6002              JZ       ?C0141?TRANSPORT_SERVICE2
B3:00BABE B1CE              ACALL    ?L?COM038C
B3:00BAC0         ?C0141?TRANSPORT_SERVICE2:
B3:00BAC0 9028AA            MOV      DPTR,#rcb+021H
B3:00BAC3 E0                MOVX     A,@DPTR
B3:00BAC4 D3                SETB     C
B3:00BAC5 9406              SUBB     A,#06H
B3:00BAC7 5002              JNC      ?C0142?TRANSPORT_SERVICE2
B3:00BAC9 6177              AJMP     ?C0221?TRANSPORT_SERVICE2
B3:00BACB         ?C0142?TRANSPORT_SERVICE2:
B3:00BACB 12ED9D            LCALL    ?L?COM00FB
B3:00BACE 127181            LCALL    ?L?COM031A
B3:00BAD1 EF                MOV      A,R7
B3:00BAD2 4E                ORL      A,R6
B3:00BAD3 6002              JZ       ?C0143?TRANSPORT_SERVICE2
B3:00BAD5         
B3:00BAD5 6177              AJMP     ?C0221?TRANSPORT_SERVICE2
B3:00BAD7         ?C0143?TRANSPORT_SERVICE2:
B3:00BAD7 9038BD            MOV      DPTR,#byte3
B3:00BADA B1C2              ACALL    ?L?COM029C
B3:00BADC 9028A5            MOV      DPTR,#rcb+01CH
B3:00BADF E0                MOVX     A,@DPTR
B3:00BAE0 FE                MOV      R6,A
B3:00BAE1 6F                XRL      A,R7
B3:00BAE2 6007              JZ       ?C0144?TRANSPORT_SERVICE2
B3:00BAE4 EE                MOV      A,R6
B3:00BAE5 6410              XRL      A,#010H
B3:00BAE7 6002              JZ       ?C0144?TRANSPORT_SERVICE2
B3:00BAE9 61A8              AJMP     ?C0219?TRANSPORT_SERVICE2
B3:00BAEB         ?C0144?TRANSPORT_SERVICE2:
B3:00BAEB 12ED82            LCALL    ?L?COM018F
B3:00BAEE 12EDB1            LCALL    ?L?COM028A
B3:00BAF1 4002              JC       ?C0145?TRANSPORT_SERVICE2
B3:00BAF3         
B3:00BAF3 61A8              AJMP     ?C0219?TRANSPORT_SERVICE2
B3:00BAF5         ?C0145?TRANSPORT_SERVICE2:
B3:00BAF5 12EC69            LCALL    ?L?COM0194
B3:00BAF8 B1B4              ACALL    ?L?COM0084
B3:00BAFA 9038C1            MOV      DPTR,#recvd_session_id
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 980


B3:00BAFD E0                MOVX     A,@DPTR
B3:00BAFE 9028A5            MOV      DPTR,#rcb+01CH
B3:00BB01 F0                MOVX     @DPTR,A
B3:00BB02 B1D8              ACALL    ?L?COM03C7
B3:00BB04 E4                CLR      A
B3:00BB05 F0                MOVX     @DPTR,A
B3:00BB06 9028AA            MOV      DPTR,#rcb+021H
B3:00BB09 E0                MOVX     A,@DPTR
B3:00BB0A 24FA              ADD      A,#0FAH
B3:00BB0C 9029A5            MOV      DPTR,#rcb+011CH
B3:00BB0F F0                MOVX     @DPTR,A
B3:00BB10 D124              ACALL    ?L?COM04A6
B3:00BB12 F0                MOVX     @DPTR,A
B3:00BB13 A3                INC      DPTR
B3:00BB14 EF                MOV      A,R7
B3:00BB15 F0                MOVX     @DPTR,A
B3:00BB16 902889            MOV      DPTR,#rcb
B3:00BB19 E0                MOVX     A,@DPTR
B3:00BB1A 9029A7            MOV      DPTR,#rcb+011EH
B3:00BB1D F0                MOVX     @DPTR,A
B3:00BB1E 9029A5            MOV      DPTR,#rcb+011CH
B3:00BB21 E0                MOVX     A,@DPTR
B3:00BB22 A3                INC      DPTR
B3:00BB23 F0                MOVX     @DPTR,A
B3:00BB24 FF                MOV      R7,A
B3:00BB25 9028A7            MOV      DPTR,#rcb+01EH
B3:00BB28 122589            LCALL    ?C?PLDXDATA
B3:00BB2B E9                MOV      A,R1
B3:00BB2C 2404              ADD      A,#04H
B3:00BB2E 126145            LCALL    ?L?COM0045
B3:00BB31 5126              ACALL    ?L?COM043E
B3:00BB33 1280A2            LCALL    ___ZW_memcpy
B3:00BB36 E4                CLR      A
B3:00BB37 FF                MOV      R7,A
B3:00BB38 FE                MOV      R6,A
B3:00BB39 12EA67            LCALL    _mark_frag_received
B3:00BB3C EF                MOV      A,R7
B3:00BB3D 6002              JZ       $ + 4H
B3:00BB3F A159              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00BB41         ?C0146?TRANSPORT_SERVICE2:
B3:00BB41 9029A5            MOV      DPTR,#rcb+011CH
B3:00BB44 E0                MOVX     A,@DPTR
B3:00BB45 FF                MOV      R7,A
B3:00BB46 9029B3            MOV      DPTR,#rcb+012AH
B3:00BB49 E0                MOVX     A,@DPTR
B3:00BB4A B4000B            CJNE     A,#00H,?C0147?TRANSPORT_SERVICE2
B3:00BB4D A3                INC      DPTR
B3:00BB4E E0                MOVX     A,@DPTR
B3:00BB4F B50706            CJNE     A,AR7,?C0147?TRANSPORT_SERVICE2
B3:00BB52 7F03              MOV      R7,#03H
B3:00BB54 B15A              ACALL    _t2_sm_post_event
B3:00BB56 01AA              AJMP     send_frag_complete_cmd
B3:00BB58         ?C0147?TRANSPORT_SERVICE2:
B3:00BB58         ?C0148?TRANSPORT_SERVICE2:
B3:00BB58 815E              AJMP     ?C0220?TRANSPORT_SERVICE2
B3:00BB5A         ?C0149?TRANSPORT_SERVICE2:
B3:00BB5A 902882            MOV      DPTR,#flag_tie_broken
B3:00BB5D E0                MOVX     A,@DPTR
B3:00BB5E 6002              JZ       ?C0150?TRANSPORT_SERVICE2
B3:00BB60 B1CE              ACALL    ?L?COM038C
B3:00BB62         ?C0150?TRANSPORT_SERVICE2:
B3:00BB62 9028AA            MOV      DPTR,#rcb+021H
B3:00BB65 E0                MOVX     A,@DPTR
B3:00BB66 D3                SETB     C
B3:00BB67 9407              SUBB     A,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 981


B3:00BB69 5002              JNC      ?C0151?TRANSPORT_SERVICE2
B3:00BB6B         
B3:00BB6B 800A              SJMP     ?C0221?TRANSPORT_SERVICE2
B3:00BB6D         ?C0151?TRANSPORT_SERVICE2:
B3:00BB6D 12ED9D            LCALL    ?L?COM00FB
B3:00BB70 127181            LCALL    ?L?COM031A
B3:00BB73 EF                MOV      A,R7
B3:00BB74 4E                ORL      A,R6
B3:00BB75 6004              JZ       ?C0152?TRANSPORT_SERVICE2
B3:00BB77         
B3:00BB77 7F01              MOV      R7,#01H
B3:00BB79 A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BB7B         ?C0152?TRANSPORT_SERVICE2:
B3:00BB7B 9038BD            MOV      DPTR,#byte3
B3:00BB7E E0                MOVX     A,@DPTR
B3:00BB7F 54F0              ANL      A,#0F0H
B3:00BB81 C4                SWAP     A
B3:00BB82 540F              ANL      A,#0FH
B3:00BB84 9038C1            MOV      DPTR,#recvd_session_id
B3:00BB87 F0                MOVX     @DPTR,A
B3:00BB88 B1D7              ACALL    ?L?COM03C6
B3:00BB8A E0                MOVX     A,@DPTR
B3:00BB8B B4010E            CJNE     A,#01H,?C0153?TRANSPORT_SERVICE2
B3:00BB8E 900B0F            MOV      DPTR,#current_state
B3:00BB91 E0                MOVX     A,@DPTR
B3:00BB92 6401              XRL      A,#01H
B3:00BB94 6002              JZ       $ + 4H
B3:00BB96 A159              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00BB98 7F15              MOV      R7,#015H
B3:00BB9A         
B3:00BB9A A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BB9C         ?C0153?TRANSPORT_SERVICE2:
B3:00BB9C 9028A5            MOV      DPTR,#rcb+01CH
B3:00BB9F B1E5              ACALL    ?L?COM03ED
B3:00BBA1 6009              JZ       ?C0156?TRANSPORT_SERVICE2
B3:00BBA3 EF                MOV      A,R7
B3:00BBA4 6410              XRL      A,#010H
B3:00BBA6 6004              JZ       ?C0156?TRANSPORT_SERVICE2
B3:00BBA8         
B3:00BBA8 7F0D              MOV      R7,#0DH
B3:00BBAA         
B3:00BBAA A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BBAC         ?C0156?TRANSPORT_SERVICE2:
B3:00BBAC 9038BD            MOV      DPTR,#byte3
B3:00BBAF E0                MOVX     A,@DPTR
B3:00BBB0 5407              ANL      A,#07H
B3:00BBB2 FF                MOV      R7,A
B3:00BBB3 9038BF            MOV      DPTR,#datagram_offset
B3:00BBB6 E4                CLR      A
B3:00BBB7 F0                MOVX     @DPTR,A
B3:00BBB8 A3                INC      DPTR
B3:00BBB9 EF                MOV      A,R7
B3:00BBBA F0                MOVX     @DPTR,A
B3:00BBBB E0                MOVX     A,@DPTR
B3:00BBBC FE                MOV      R6,A
B3:00BBBD 9038BE            MOV      DPTR,#byte4
B3:00BBC0 E0                MOVX     A,@DPTR
B3:00BBC1 1273E1            LCALL    ?L?COM05DA
B3:00BBC4 FE                MOV      R6,A
B3:00BBC5 A3                INC      DPTR
B3:00BBC6 F0                MOVX     @DPTR,A
B3:00BBC7 A3                INC      DPTR
B3:00BBC8 EF                MOV      A,R7
B3:00BBC9 F0                MOVX     @DPTR,A
B3:00BBCA 9028AA            MOV      DPTR,#rcb+021H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 982


B3:00BBCD E0                MOVX     A,@DPTR
B3:00BBCE 24F9              ADD      A,#0F9H
B3:00BBD0 9029A5            MOV      DPTR,#rcb+011CH
B3:00BBD3 F0                MOVX     @DPTR,A
B3:00BBD4 2F                ADD      A,R7
B3:00BBD5 FF                MOV      R7,A
B3:00BBD6 EC                MOV      A,R4
B3:00BBD7 3E                ADDC     A,R6
B3:00BBD8 FE                MOV      R6,A
B3:00BBD9 D3                SETB     C
B3:00BBDA EF                MOV      A,R7
B3:00BBDB 94C8              SUBB     A,#0C8H
B3:00BBDD EE                MOV      A,R6
B3:00BBDE 9400              SUBB     A,#00H
B3:00BBE0 400E              JC       ?C0157?TRANSPORT_SERVICE2
B3:00BBE2 900B0F            MOV      DPTR,#current_state
B3:00BBE5 E0                MOVX     A,@DPTR
B3:00BBE6 6401              XRL      A,#01H
B3:00BBE8 6002              JZ       $ + 4H
B3:00BBEA A159              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00BBEC 7F15              MOV      R7,#015H
B3:00BBEE         
B3:00BBEE A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BBF0         ?C0157?TRANSPORT_SERVICE2:
B3:00BBF0 12ED82            LCALL    ?L?COM018F
B3:00BBF3 12EDB1            LCALL    ?L?COM028A
B3:00BBF6 4004              JC       ?C0159?TRANSPORT_SERVICE2
B3:00BBF8 7F0D              MOV      R7,#0DH
B3:00BBFA         
B3:00BBFA A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BBFC         ?C0159?TRANSPORT_SERVICE2:
B3:00BBFC 12EC69            LCALL    ?L?COM0194
B3:00BBFF B1B4              ACALL    ?L?COM0084
B3:00BC01 B1FF              ACALL    ?L?COM05DB
B3:00BC03 FF                MOV      R7,A
B3:00BC04 12EA67            LCALL    _mark_frag_received
B3:00BC07 EF                MOV      A,R7
B3:00BC08 6002              JZ       $ + 4H
B3:00BC0A A159              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00BC0C         ?C0160?TRANSPORT_SERVICE2:
B3:00BC0C D124              ACALL    ?L?COM04A6
B3:00BC0E 12C404            LCALL    ?L?COM0127
B3:00BC11 7A28              MOV      R2,#HIGH rcb+054H
B3:00BC13 79DD              MOV      R1,#LOW rcb+054H
;---- Variable 'curr_datagramData' assigned to Register 'R1/R2/R3' ----
B3:00BC15 B1FF              ACALL    ?L?COM05DB
B3:00BC17 29                ADD      A,R1
B3:00BC18 F9                MOV      R1,A
B3:00BC19 EE                MOV      A,R6
B3:00BC1A 3A                ADDC     A,R2
B3:00BC1B FA                MOV      R2,A
B3:00BC1C 9029A5            MOV      DPTR,#rcb+011CH
B3:00BC1F E0                MOVX     A,@DPTR
B3:00BC20 FF                MOV      R7,A
B3:00BC21 C003              PUSH     AR3
B3:00BC23 C002              PUSH     AR2
B3:00BC25 C001              PUSH     AR1
B3:00BC27 9028A7            MOV      DPTR,#rcb+01EH
B3:00BC2A 12576B            LCALL    ?L?COM0323
B3:00BC2D 126145            LCALL    ?L?COM0045
B3:00BC30 D001              POP      AR1
B3:00BC32 D002              POP      AR2
B3:00BC34 D003              POP      AR3
B3:00BC36 1280A2            LCALL    ___ZW_memcpy
B3:00BC39 9029A5            MOV      DPTR,#rcb+011CH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 983


B3:00BC3C E0                MOVX     A,@DPTR
B3:00BC3D FF                MOV      R7,A
B3:00BC3E 9038C0            MOV      DPTR,#datagram_offset+01H
B3:00BC41 E0                MOVX     A,@DPTR
B3:00BC42 2F                ADD      A,R7
B3:00BC43 FF                MOV      R7,A
B3:00BC44 9038BF            MOV      DPTR,#datagram_offset
B3:00BC47 E0                MOVX     A,@DPTR
B3:00BC48 3400              ADDC     A,#00H
B3:00BC4A FE                MOV      R6,A
B3:00BC4B D3                SETB     C
B3:00BC4C 9029B4            MOV      DPTR,#rcb+012BH
B3:00BC4F E0                MOVX     A,@DPTR
B3:00BC50 9F                SUBB     A,R7
B3:00BC51 9029B3            MOV      DPTR,#rcb+012AH
B3:00BC54 E0                MOVX     A,@DPTR
B3:00BC55 9E                SUBB     A,R6
B3:00BC56 5006              JNC      ?C0161?TRANSPORT_SERVICE2
B3:00BC58 7F12              MOV      R7,#012H
B3:00BC5A B15A              ACALL    _t2_sm_post_event
B3:00BC5C A179              AJMP     find_missing
B3:00BC5E         ?C0161?TRANSPORT_SERVICE2:
B3:00BC5E         
B3:00BC5E E4                CLR      A
B3:00BC5F 9028CC            MOV      DPTR,#rcb+043H
B3:00BC62 F0                MOVX     @DPTR,A
B3:00BC63 22                RET      
B3:00BC64         ?C0162?TRANSPORT_SERVICE2:
B3:00BC64 B1BB              ACALL    ?L?COM029B
B3:00BC66 9029E2            MOV      DPTR,#scb+02DH
B3:00BC69 E0                MOVX     A,@DPTR
B3:00BC6A B50704            CJNE     A,AR7,?C0163?TRANSPORT_SERVICE2
B3:00BC6D 7F0F              MOV      R7,#0FH
B3:00BC6F         
B3:00BC6F A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BC71         ?C0163?TRANSPORT_SERVICE2:
B3:00BC71 B1E2              ACALL    ?L?COM03EC
B3:00BC73 6004              JZ       ?C0164?TRANSPORT_SERVICE2
B3:00BC75 7F0F              MOV      R7,#0FH
B3:00BC77         
B3:00BC77 A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BC79         ?C0164?TRANSPORT_SERVICE2:
B3:00BC79 D119              ACALL    ?L?COM04DD
B3:00BC7B 600A              JZ       ?C0165?TRANSPORT_SERVICE2
B3:00BC7D 9029A7            MOV      DPTR,#rcb+011EH
B3:00BC80 E0                MOVX     A,@DPTR
B3:00BC81 6004              JZ       ?C0165?TRANSPORT_SERVICE2
B3:00BC83 7F10              MOV      R7,#010H
B3:00BC85         
B3:00BC85 A10F              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BC87         ?C0165?TRANSPORT_SERVICE2:
B3:00BC87 D107              ACALL    ?L?COM0331
B3:00BC89 9038BC            MOV      DPTR,#byte2
B3:00BC8C E0                MOVX     A,@DPTR
B3:00BC8D 5407              ANL      A,#07H
B3:00BC8F 7F00              MOV      R7,#00H
B3:00BC91 FE                MOV      R6,A
B3:00BC92 9029B7            MOV      DPTR,#scb+02H
B3:00BC95 F0                MOVX     @DPTR,A
B3:00BC96 A3                INC      DPTR
B3:00BC97 EF                MOV      A,R7
B3:00BC98 F0                MOVX     @DPTR,A
B3:00BC99 9038BD            MOV      DPTR,#byte3
B3:00BC9C E0                MOVX     A,@DPTR
B3:00BC9D 9029B7            MOV      DPTR,#scb+02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 984


B3:00BCA0 12721A            LCALL    ?L?COM03D6
B3:00BCA3 7F11              MOV      R7,#011H
B3:00BCA5 D112              ACALL    ?L?COM03A8
B3:00BCA7 6007              JZ       ?C0166?TRANSPORT_SERVICE2
B3:00BCA9 902A23            MOV      DPTR,#scb+06EH
B3:00BCAC 7401              MOV      A,#01H
B3:00BCAE F0                MOVX     @DPTR,A
B3:00BCAF 22                RET      
B3:00BCB0         ?C0166?TRANSPORT_SERVICE2:
B3:00BCB0 B1F8              ACALL    ?L?COM0032
B3:00BCB2 02CBEC            LJMP     _reply_frag_req
B3:00BCB5         ?C0168?TRANSPORT_SERVICE2:
B3:00BCB5 B1BB              ACALL    ?L?COM029B
B3:00BCB7 9029E2            MOV      DPTR,#scb+02DH
B3:00BCBA E0                MOVX     A,@DPTR
B3:00BCBB B50704            CJNE     A,AR7,?C0169?TRANSPORT_SERVICE2
B3:00BCBE 7F0F              MOV      R7,#0FH
B3:00BCC0         
B3:00BCC0 804D              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BCC2         ?C0169?TRANSPORT_SERVICE2:
B3:00BCC2 B1E2              ACALL    ?L?COM03EC
B3:00BCC4 6004              JZ       ?C0170?TRANSPORT_SERVICE2
B3:00BCC6 7F0F              MOV      R7,#0FH
B3:00BCC8         
B3:00BCC8 8045              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BCCA         ?C0170?TRANSPORT_SERVICE2:
B3:00BCCA D119              ACALL    ?L?COM04DD
B3:00BCCC 600A              JZ       ?C0171?TRANSPORT_SERVICE2
B3:00BCCE 9029A7            MOV      DPTR,#rcb+011EH
B3:00BCD1 E0                MOVX     A,@DPTR
B3:00BCD2 6004              JZ       ?C0171?TRANSPORT_SERVICE2
B3:00BCD4 7F10              MOV      R7,#010H
B3:00BCD6         
B3:00BCD6 8037              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BCD8         ?C0171?TRANSPORT_SERVICE2:
B3:00BCD8 D107              ACALL    ?L?COM0331
B3:00BCDA 9038C1            MOV      DPTR,#recvd_session_id
B3:00BCDD E0                MOVX     A,@DPTR
B3:00BCDE FF                MOV      R7,A
B3:00BCDF 9029D9            MOV      DPTR,#scb+024H
B3:00BCE2 E0                MOVX     A,@DPTR
B3:00BCE3 B5071D            CJNE     A,AR7,?C0174?TRANSPORT_SERVICE2
B3:00BCE6 7413              MOV      A,#LOW scb+05EH
B3:00BCE8 2F                ADD      A,R7
B3:00BCE9 D136              ACALL    ?L?COM0204
B3:00BCEB 7401              MOV      A,#01H
B3:00BCED F0                MOVX     @DPTR,A
B3:00BCEE E4                CLR      A
B3:00BCEF 902A2E            MOV      DPTR,#scb+079H
B3:00BCF2 F0                MOVX     @DPTR,A
B3:00BCF3 9029C4            MOV      DPTR,#scb+0FH
B3:00BCF6 12A790            LCALL    ?L?COM0098
B3:00BCF9 6008              JZ       ?C0174?TRANSPORT_SERVICE2
B3:00BCFB 12CA1C            LCALL    ?L?COM0156
B3:00BCFE E4                CLR      A
B3:00BCFF FF                MOV      R7,A
B3:00BD00 12271A            LCALL    ?C?ICALL2
B3:00BD03         ?C0174?TRANSPORT_SERVICE2:
B3:00BD03 7F22              MOV      R7,#022H
B3:00BD05         
B3:00BD05 8008              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:00BD07         ?C0175?TRANSPORT_SERVICE2:
B3:00BD07 D130              ACALL    ?L?COM0203
B3:00BD09 E0                MOVX     A,@DPTR
B3:00BD0A B40104            CJNE     A,#01H,?C0176?TRANSPORT_SERVICE2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 985


B3:00BD0D 7F15              MOV      R7,#015H
B3:00BD0F         
B3:00BD0F 8049              SJMP     _t2_sm_post_event
B3:00BD11         ?C0176?TRANSPORT_SERVICE2:
B3:00BD11 7F1B              MOV      R7,#01BH
B3:00BD13 B15A              ACALL    _t2_sm_post_event
B3:00BD15 B1CE              ACALL    ?L?COM038C
B3:00BD17 7B01              MOV      R3,#01H
B3:00BD19 7A38              MOV      R2,#HIGH t
B3:00BD1B 79A8              MOV      R1,#LOW t
B3:00BD1D 7D13              MOV      R5,#013H
B3:00BD1F 1271C2            LCALL    ?L?COM036D
B3:00BD22 7A38              MOV      R2,#HIGH t
B3:00BD24 79A8              MOV      R1,#LOW t
B3:00BD26 7F02              MOV      R7,#02H
B3:00BD28 12D392            LCALL    _ZCB_ts_senddata_cb
B3:00BD2B 9038BC            MOV      DPTR,#byte2
B3:00BD2E E0                MOVX     A,@DPTR
B3:00BD2F 9028A6            MOV      DPTR,#rcb+01DH
B3:00BD32 F0                MOVX     @DPTR,A
B3:00BD33 E0                MOVX     A,@DPTR
B3:00BD34 75F064            MOV      B,#064H
B3:00BD37 A4                MUL      AB
B3:00BD38 2464              ADD      A,#064H
B3:00BD3A FF                MOV      R7,A
B3:00BD3B E4                CLR      A
B3:00BD3C 35F0              ADDC     A,B
B3:00BD3E FE                MOV      R6,A
B3:00BD3F E4                CLR      A
B3:00BD40 FC                MOV      R4,A
B3:00BD41 FD                MOV      R5,A
B3:00BD42 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00BD45 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_wait_restart_from_first
B3:00BD47 F0                MOVX     @DPTR,A
B3:00BD48 A3                INC      DPTR
B3:00BD49 7490              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_wait_restart_from_first
B3:00BD4B B1F7              ACALL    ?L?COM0031
B3:00BD4D A3                INC      DPTR
B3:00BD4E 1225A9            LCALL    ?C?PSTXDATA
B3:00BD51 0B                INC      R3
B3:00BD52 7A29              MOV      R2,#HIGH scb+03EH
B3:00BD54 79F3              MOV      R1,#LOW scb+03EH
B3:00BD56 121B10            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:00BD59         ?C0138?TRANSPORT_SERVICE2:
B3:00BD59 22                RET      
----- FUNCTION receive (END) -------


----- FUNCTION _t2_sm_post_event (BEGIN) -----
;---- Variable 'ev' assigned to Register 'R6' ----
B3:00BD5A AE07              MOV      R6,AR7
B3:00BD5C 900B0F            MOV      DPTR,#current_state
B3:00BD5F E0                MOVX     A,@DPTR
B3:00BD60 FF                MOV      R7,A
B3:00BD61 AD06              MOV      R5,AR6
B3:00BD63 12EC8F            LCALL    _find_transition
;---- Variable 'i' assigned to Register 'R7' ----
B3:00BD66 EF                MOV      A,R7
B3:00BD67 600F              JZ       ?C0007?TRANSPORT2_FSM
B3:00BD69 75F006            MOV      B,#06H
B3:00BD6C 902FEC            MOV      DPTR,#trans-04H
B3:00BD6F 12257D            LCALL    ?C?OFFXADD
B3:00BD72 E4                CLR      A
B3:00BD73 93                MOVC     A,@A+DPTR
B3:00BD74 900B0F            MOV      DPTR,#current_state
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 986


B3:00BD77 F0                MOVX     @DPTR,A
B3:00BD78         ?C0007?TRANSPORT2_FSM:
B3:00BD78 22                RET      
----- FUNCTION _t2_sm_post_event (END) -------


----- FUNCTION find_missing (BEGIN) -----
B3:00BD79 12EAC6            LCALL    get_num_missing_frag
;---- Variable 'missing_frag' assigned to Register 'R7' ----
B3:00BD7C EF                MOV      A,R7
B3:00BD7D 6011              JZ       ?C0126?TRANSPORT_SERVICE2
B3:00BD7F 90288E            MOV      DPTR,#rcb+05H
B3:00BD82 E0                MOVX     A,@DPTR
B3:00BD83 B40403            CJNE     A,#04H,?C0127?TRANSPORT_SERVICE2
B3:00BD86 029C7B            LJMP     discard_all_received_fragments
B3:00BD89         ?C0127?TRANSPORT_SERVICE2:
B3:00BD89 7F09              MOV      R7,#09H
B3:00BD8B B15A              ACALL    _t2_sm_post_event
B3:00BD8D 02EBBC            LJMP     send_frag_req_cmd
B3:00BD90         ?C0126?TRANSPORT_SERVICE2:
B3:00BD90 90288E            MOV      DPTR,#rcb+05H
B3:00BD93 E0                MOVX     A,@DPTR
B3:00BD94 6404              XRL      A,#04H
B3:00BD96 6006              JZ       ?C0128?TRANSPORT_SERVICE2
B3:00BD98         ?C0130?TRANSPORT_SERVICE2:
B3:00BD98 7F03              MOV      R7,#03H
B3:00BD9A B15A              ACALL    _t2_sm_post_event
B3:00BD9C 11AA              ACALL    send_frag_complete_cmd
B3:00BD9E         ?C0128?TRANSPORT_SERVICE2:
B3:00BD9E 22                RET      
----- FUNCTION find_missing (END) -------


----- FUNCTION ?L?COM04A4 (BEGIN) -----
B3:00BD9F 900AD1            MOV      DPTR,#r
B3:00BDA2 E0                MOVX     A,@DPTR
B3:00BDA3 FE                MOV      R6,A
B3:00BDA4 A3                INC      DPTR
B3:00BDA5 E0                MOVX     A,@DPTR
B3:00BDA6 22                RET      
----- FUNCTION ?L?COM04A4 (END) -------


----- FUNCTION ?L?COM0083 (BEGIN) -----
B3:00BDA7 A3                INC      DPTR
B3:00BDA8 1225A9            LCALL    ?C?PSTXDATA
B3:00BDAB 0B                INC      R3
B3:00BDAC 7A29              MOV      R2,#HIGH scb+02EH
B3:00BDAE 79E3              MOV      R1,#LOW scb+02EH
B3:00BDB0 7F88              MOV      R7,#088H
B3:00BDB2 7E13              MOV      R6,#013H
B3:00BDB4         ?L?COM0084:
B3:00BDB4 7D00              MOV      R5,#00H
B3:00BDB6 7C00              MOV      R4,#00H
B3:00BDB8 021B10            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION ?L?COM0083 (END) -------


----- FUNCTION ?L?COM029B (BEGIN) -----
B3:00BDBB 7F16              MOV      R7,#016H
B3:00BDBD B15A              ACALL    _t2_sm_post_event
B3:00BDBF 9038BC            MOV      DPTR,#byte2
B3:00BDC2         ?L?COM029C:
B3:00BDC2 E0                MOVX     A,@DPTR
B3:00BDC3 54F0              ANL      A,#0F0H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 987


B3:00BDC5 C4                SWAP     A
B3:00BDC6 540F              ANL      A,#0FH
B3:00BDC8 FF                MOV      R7,A
B3:00BDC9 9038C1            MOV      DPTR,#recvd_session_id
B3:00BDCC F0                MOVX     @DPTR,A
B3:00BDCD 22                RET      
----- FUNCTION ?L?COM029B (END) -------


----- FUNCTION ?L?COM038C (BEGIN) -----
B3:00BDCE 9029D9            MOV      DPTR,#scb+024H
B3:00BDD1 E0                MOVX     A,@DPTR
B3:00BDD2 9029E2            MOV      DPTR,#scb+02DH
B3:00BDD5 F0                MOVX     @DPTR,A
B3:00BDD6 22                RET      
----- FUNCTION ?L?COM038C (END) -------


----- FUNCTION ?L?COM03C6 (BEGIN) -----
B3:00BDD7 E0                MOVX     A,@DPTR
B3:00BDD8         ?L?COM03C7:
B3:00BDD8 24CD              ADD      A,#LOW rcb+044H
B3:00BDDA F582              MOV      DPL,A
B3:00BDDC E4                CLR      A
B3:00BDDD 3428              ADDC     A,#HIGH rcb+044H
B3:00BDDF F583              MOV      DPH,A
B3:00BDE1 22                RET      
----- FUNCTION ?L?COM03C6 (END) -------


----- FUNCTION ?L?COM03EC (BEGIN) -----
B3:00BDE2 9029D9            MOV      DPTR,#scb+024H
B3:00BDE5         ?L?COM03ED:
B3:00BDE5 E0                MOVX     A,@DPTR
B3:00BDE6 FF                MOV      R7,A
B3:00BDE7 9038C1            MOV      DPTR,#recvd_session_id
B3:00BDEA E0                MOVX     A,@DPTR
B3:00BDEB 6F                XRL      A,R7
B3:00BDEC 22                RET      
----- FUNCTION ?L?COM03EC (END) -------


----- FUNCTION ?L?COM002F (BEGIN) -----
B3:00BDED F0                MOVX     @DPTR,A
B3:00BDEE         ?L?COM0030:
B3:00BDEE 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00BDF1 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_reset_transport_service
B3:00BDF3 F0                MOVX     @DPTR,A
B3:00BDF4 A3                INC      DPTR
B3:00BDF5 7472              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_reset_transport_service
B3:00BDF7         ?L?COM0031:
B3:00BDF7 F0                MOVX     @DPTR,A
B3:00BDF8         ?L?COM0032:
B3:00BDF8 7B00              MOV      R3,#00H
B3:00BDFA 7A00              MOV      R2,#00H
B3:00BDFC 7900              MOV      R1,#00H
B3:00BDFE 22                RET      
----- FUNCTION ?L?COM002F (END) -------


----- FUNCTION ?L?COM05DB (BEGIN) -----
B3:00BDFF 9038BF            MOV      DPTR,#datagram_offset
B3:00BE02 E0                MOVX     A,@DPTR
B3:00BE03 FE                MOV      R6,A
B3:00BE04 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 988


B3:00BE05 E0                MOVX     A,@DPTR
B3:00BE06 22                RET      
----- FUNCTION ?L?COM05DB (END) -------


----- FUNCTION ?L?COM0331 (BEGIN) -----
B3:00BE07 7B01              MOV      R3,#01H
B3:00BE09 7A28              MOV      R2,#HIGH rcb+023H
B3:00BE0B 79AC              MOV      R1,#LOW rcb+023H
B3:00BE0D 021B15            LJMP     ?INTERBANK_TABLE?_ctimer_stop
----- FUNCTION ?L?COM0331 (END) -------


----- FUNCTION ?L?COM03A7 (BEGIN) -----
B3:00BE10 7F0E              MOV      R7,#0EH
B3:00BE12         ?L?COM03A8:
B3:00BE12 B15A              ACALL    _t2_sm_post_event
B3:00BE14 9029E0            MOV      DPTR,#scb+02BH
B3:00BE17 E0                MOVX     A,@DPTR
B3:00BE18 22                RET      
----- FUNCTION ?L?COM03A7 (END) -------


----- FUNCTION ?L?COM04DD (BEGIN) -----
B3:00BE19 902A2E            MOV      DPTR,#scb+079H
B3:00BE1C E0                MOVX     A,@DPTR
B3:00BE1D FF                MOV      R7,A
B3:00BE1E 902889            MOV      DPTR,#rcb
B3:00BE21 E0                MOVX     A,@DPTR
B3:00BE22 6F                XRL      A,R7
B3:00BE23 22                RET      
----- FUNCTION ?L?COM04DD (END) -------


----- FUNCTION ?L?COM04A6 (BEGIN) -----
B3:00BE24 9038C2            MOV      DPTR,#datagram_size_tmp
B3:00BE27 E0                MOVX     A,@DPTR
B3:00BE28 FF                MOV      R7,A
B3:00BE29 A3                INC      DPTR
B3:00BE2A E0                MOVX     A,@DPTR
B3:00BE2B 9029B3            MOV      DPTR,#rcb+012AH
B3:00BE2E CF                XCH      A,R7
B3:00BE2F 22                RET      
----- FUNCTION ?L?COM04A6 (END) -------


----- FUNCTION ?L?COM0203 (BEGIN) -----
B3:00BE30 9029D9            MOV      DPTR,#scb+024H
B3:00BE33 E0                MOVX     A,@DPTR
B3:00BE34 2413              ADD      A,#LOW scb+05EH
B3:00BE36         ?L?COM0204:
B3:00BE36 F582              MOV      DPL,A
B3:00BE38 E4                CLR      A
B3:00BE39 342A              ADDC     A,#HIGH scb+05EH
B3:00BE3B F583              MOV      DPH,A
B3:00BE3D 22                RET      
----- FUNCTION ?L?COM0203 (END) -------


----- FUNCTION _fe25519_add (BEGIN) -----
B3:00BE3E 900AA3            MOV      DPTR,#a
B3:00BE41 EC                MOV      A,R4
B3:00BE42 F0                MOVX     @DPTR,A
B3:00BE43 A3                INC      DPTR
B3:00BE44 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 989


B3:00BE45 F0                MOVX     @DPTR,A
B3:00BE46 900AA1            MOV      DPTR,#r
B3:00BE49 EE                MOV      A,R6
B3:00BE4A F0                MOVX     @DPTR,A
B3:00BE4B A3                INC      DPTR
B3:00BE4C EF                MOV      A,R7
B3:00BE4D F0                MOVX     @DPTR,A
;---- Variable 'b' assigned to Register 'R2/R3' ----
;---- Variable 'carry' assigned to Register 'R5' ----
B3:00BE4E A3                INC      DPTR
B3:00BE4F E0                MOVX     A,@DPTR
B3:00BE50 FC                MOV      R4,A
B3:00BE51 A3                INC      DPTR
B3:00BE52 E0                MOVX     A,@DPTR
B3:00BE53 FD                MOV      R5,A
B3:00BE54 903EAE            MOV      DPTR,#?_bigint_add?BYTE+06H
B3:00BE57 7420              MOV      A,#020H
B3:00BE59 F0                MOVX     @DPTR,A
B3:00BE5A 121B4C            LCALL    ?INTERBANK_TABLE?_bigint_add
B3:00BE5D AD07              MOV      R5,AR7
B3:00BE5F 12ED40            LCALL    ?L?COM04A5
B3:00BE62 241F              ADD      A,#01FH
B3:00BE64 12B617            LCALL    ?L?COM0096
B3:00BE67 E0                MOVX     A,@DPTR
B3:00BE68 127152            LCALL    ?L?COM02C7
B3:00BE6B FF                MOV      R7,A
B3:00BE6C AE05              MOV      R6,AR5
B3:00BE6E EE                MOV      A,R6
B3:00BE6F 25E0              ADD      A,ACC
B3:00BE71 4F                ORL      A,R7
B3:00BE72 75F013            MOV      B,#013H
B3:00BE75 A4                MUL      AB
B3:00BE76 FF                MOV      R7,A
B3:00BE77 900AA5            MOV      DPTR,#tmp
B3:00BE7A 12ED14            LCALL    ?L?COM01F0
;---- Variable 'i' assigned to Register 'R5' ----
B3:00BE7D E4                CLR      A
B3:00BE7E FD                MOV      R5,A
B3:00BE7F         ?C0001?FE25519:
B3:00BE7F 12ED40            LCALL    ?L?COM04A5
B3:00BE82 12B616            LCALL    ?L?COM0095
B3:00BE85 E0                MOVX     A,@DPTR
B3:00BE86 FF                MOV      R7,A
B3:00BE87 900AA6            MOV      DPTR,#tmp+01H
B3:00BE8A E0                MOVX     A,@DPTR
B3:00BE8B 2F                ADD      A,R7
B3:00BE8C FF                MOV      R7,A
B3:00BE8D 900AA5            MOV      DPTR,#tmp
B3:00BE90 E0                MOVX     A,@DPTR
B3:00BE91 3400              ADDC     A,#00H
B3:00BE93 F0                MOVX     @DPTR,A
B3:00BE94 A3                INC      DPTR
B3:00BE95 EF                MOV      A,R7
B3:00BE96 F0                MOVX     @DPTR,A
B3:00BE97 900AA1            MOV      DPTR,#r
B3:00BE9A 12EDD6            LCALL    ?L?COM041F
B3:00BE9D 900AA5            MOV      DPTR,#tmp
B3:00BEA0 E0                MOVX     A,@DPTR
B3:00BEA1 12ED79            LCALL    ?L?COM0135
B3:00BEA4 B41FD8            CJNE     A,#01FH,?C0001?FE25519
B3:00BEA7         ?C0002?FE25519:
B3:00BEA7 12ED40            LCALL    ?L?COM04A5
B3:00BEAA 12B616            LCALL    ?L?COM0095
B3:00BEAD E0                MOVX     A,@DPTR
B3:00BEAE 547F              ANL      A,#07FH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 990


B3:00BEB0 FF                MOV      R7,A
B3:00BEB1 900AA5            MOV      DPTR,#tmp
B3:00BEB4 A3                INC      DPTR
B3:00BEB5 E0                MOVX     A,@DPTR
B3:00BEB6 2F                ADD      A,R7
B3:00BEB7 FF                MOV      R7,A
B3:00BEB8 900AA1            MOV      DPTR,#r
B3:00BEBB E0                MOVX     A,@DPTR
B3:00BEBC FC                MOV      R4,A
B3:00BEBD A3                INC      DPTR
B3:00BEBE E0                MOVX     A,@DPTR
B3:00BEBF 2D                ADD      A,R5
B3:00BEC0 126333            LCALL    ?L?COM0330
B3:00BEC3 EF                MOV      A,R7
B3:00BEC4 F0                MOVX     @DPTR,A
B3:00BEC5 22                RET      
----- FUNCTION _fe25519_add (END) -------


----- FUNCTION _TransportService_ApplicationCommandHandler (BEGIN) -----
B3:00BEC6 903E24            MOV      DPTR,#pCmdHandlerStruct
B3:00BEC9 1271F8            LCALL    ?L?COM0385
B3:00BECC 903E27            MOV      DPTR,#p
B3:00BECF 1225A9            LCALL    ?C?PSTXDATA
B3:00BED2 903E24            MOV      DPTR,#pCmdHandlerStruct
B3:00BED5 122589            LCALL    ?C?PLDXDATA
B3:00BED8 900003            MOV      DPTR,#03H
B3:00BEDB 12262D            LCALL    ?C?PLDOPTR
B3:00BEDE 903E2A            MOV      DPTR,#pCmd
B3:00BEE1 1225A9            LCALL    ?C?PSTXDATA
B3:00BEE4 903E24            MOV      DPTR,#pCmdHandlerStruct
B3:00BEE7 1298C0            LCALL    ?L?COM00A2
B3:00BEEA 903E2D            MOV      DPTR,#cmdLength
B3:00BEED B1ED              ACALL    ?L?COM002F
B3:00BEEF B1A7              ACALL    ?L?COM0083
B3:00BEF1 12EA49            LCALL    ZW_TransportService_Is_Sending
B3:00BEF4 5023              JNC      ?C0087?TRANSPORT_SERVICE2
B3:00BEF6 903E27            MOV      DPTR,#p
B3:00BEF9 122589            LCALL    ?C?PLDXDATA
B3:00BEFC 121FB3            LCALL    ?C?CLDPTR
B3:00BEFF FF                MOV      R7,A
B3:00BF00 9029BE            MOV      DPTR,#scb+09H
B3:00BF03 E0                MOVX     A,@DPTR
B3:00BF04 B50712            CJNE     A,AR7,?C0087?TRANSPORT_SERVICE2
B3:00BF07 901221            MOV      DPTR,#nodeID
B3:00BF0A E0                MOVX     A,@DPTR
B3:00BF0B C3                CLR      C
B3:00BF0C 9F                SUBB     A,R7
B3:00BF0D 500A              JNC      ?C0087?TRANSPORT_SERVICE2
B3:00BF0F 7F14              MOV      R7,#014H
B3:00BF11 B15A              ACALL    _t2_sm_post_event
B3:00BF13 902882            MOV      DPTR,#flag_tie_broken
B3:00BF16 7401              MOV      A,#01H
B3:00BF18 F0                MOVX     @DPTR,A
B3:00BF19         ?C0087?TRANSPORT_SERVICE2:
B3:00BF19 903E27            MOV      DPTR,#p
B3:00BF1C 129276            LCALL    ?L?COM0065
B3:00BF1F FF                MOV      R7,A
B3:00BF20 121FB3            LCALL    ?C?CLDPTR
B3:00BF23 6F                XRL      A,R7
B3:00BF24 7003              JNZ      $ + 5H
B3:00BF26 02C030            LJMP     ?C0089?TRANSPORT_SERVICE2
B3:00BF29         ?C0088?TRANSPORT_SERVICE2:
B3:00BF29 903E2D            MOV      DPTR,#cmdLength
B3:00BF2C E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 991


B3:00BF2D D3                SETB     C
B3:00BF2E 94C8              SUBB     A,#0C8H
B3:00BF30 4003              JC       $ + 5H
B3:00BF32 02C030            LJMP     ?C0089?TRANSPORT_SERVICE2
B3:00BF35         ?C0090?TRANSPORT_SERVICE2:
B3:00BF35 903E27            MOV      DPTR,#p
B3:00BF38 122589            LCALL    ?C?PLDXDATA
B3:00BF3B 126149            LCALL    ?L?COM0047
B3:00BF3E 7B01              MOV      R3,#01H
B3:00BF40 7A2A              MOV      R2,#HIGH scb+06FH
B3:00BF42 7924              MOV      R1,#LOW scb+06FH
B3:00BF44 7F07              MOV      R7,#07H
B3:00BF46 1280A2            LCALL    ___ZW_memcpy
B3:00BF49 903E27            MOV      DPTR,#p
B3:00BF4C 122589            LCALL    ?C?PLDXDATA
B3:00BF4F 121FB3            LCALL    ?C?CLDPTR
B3:00BF52 FF                MOV      R7,A
B3:00BF53 9029A7            MOV      DPTR,#rcb+011EH
B3:00BF56 E0                MOVX     A,@DPTR
B3:00BF57 FE                MOV      R6,A
B3:00BF58 6F                XRL      A,R7
B3:00BF59 6003              JZ       ?C0093?TRANSPORT_SERVICE2
B3:00BF5B EE                MOV      A,R6
B3:00BF5C 700B              JNZ      ?C0092?TRANSPORT_SERVICE2
B3:00BF5E         ?C0093?TRANSPORT_SERVICE2:
B3:00BF5E 902A2E            MOV      DPTR,#scb+079H
B3:00BF61 E0                MOVX     A,@DPTR
B3:00BF62 FE                MOV      R6,A
B3:00BF63 6F                XRL      A,R7
B3:00BF64 602B              JZ       ?C0091?TRANSPORT_SERVICE2
B3:00BF66 EE                MOV      A,R6
B3:00BF67 6028              JZ       ?C0091?TRANSPORT_SERVICE2
B3:00BF69         ?C0092?TRANSPORT_SERVICE2:
B3:00BF69 12ABB0            LCALL    ?L?COM02EA
B3:00BF6C 7013              JNZ      ?C0094?TRANSPORT_SERVICE2
B3:00BF6E 900B0F            MOV      DPTR,#current_state
B3:00BF71 E0                MOVX     A,@DPTR
B3:00BF72 6404              XRL      A,#04H
B3:00BF74 7003              JNZ      $ + 5H
B3:00BF76 02C030            LJMP     ?C0089?TRANSPORT_SERVICE2
B3:00BF79         ?C0095?TRANSPORT_SERVICE2:
B3:00BF79 7F0B              MOV      R7,#0BH
B3:00BF7B D112              ACALL    ?L?COM03A8
B3:00BF7D 6043              JZ       ?C0213?TRANSPORT_SERVICE2
B3:00BF7F 803A              SJMP     ?C0212?TRANSPORT_SERVICE2
B3:00BF81         ?C0094?TRANSPORT_SERVICE2:
B3:00BF81 903E27            MOV      DPTR,#p
B3:00BF84 122589            LCALL    ?C?PLDXDATA
B3:00BF87 12ABB0            LCALL    ?L?COM02EA
B3:00BF8A B40404            CJNE     A,#04H,?C0091?TRANSPORT_SERVICE2
B3:00BF8D 7F0C              MOV      R7,#0CH
B3:00BF8F 8024              SJMP     ?C0214?TRANSPORT_SERVICE2
B3:00BF91         ?C0091?TRANSPORT_SERVICE2:
B3:00BF91 903E2A            MOV      DPTR,#pCmd
B3:00BF94 129276            LCALL    ?L?COM0065
B3:00BF97 FF                MOV      R7,A
;---- Variable 'cmd_type' assigned to Register 'R6' ----
B3:00BF98 54F8              ANL      A,#0F8H
B3:00BF9A FE                MOV      R6,A
B3:00BF9B 9028A5            MOV      DPTR,#rcb+01CH
B3:00BF9E E0                MOVX     A,@DPTR
B3:00BF9F 6410              XRL      A,#010H
B3:00BFA1 7022              JNZ      ?C0099?TRANSPORT_SERVICE2
B3:00BFA3 EE                MOV      A,R6
B3:00BFA4 64E0              XRL      A,#0E0H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 992


B3:00BFA6 701D              JNZ      ?C0099?TRANSPORT_SERVICE2
;---- Variable 'datagram_size_tmp' assigned to Register 'R7' ----
B3:00BFA8 12AB1D            LCALL    ?L?COM0110
B3:00BFAB 2400              ADD      A,#00H
B3:00BFAD D3                SETB     C
B3:00BFAE 94C8              SUBB     A,#0C8H
B3:00BFB0 4005              JC       ?C0100?TRANSPORT_SERVICE2
B3:00BFB2 E4                CLR      A
B3:00BFB3 7F0D              MOV      R7,#0DH
B3:00BFB5         
B3:00BFB5 A15A              AJMP     _t2_sm_post_event
B3:00BFB7         ?C0100?TRANSPORT_SERVICE2:
B3:00BFB7 D110              ACALL    ?L?COM03A7
B3:00BFB9 6007              JZ       ?C0101?TRANSPORT_SERVICE2
B3:00BFBB         
B3:00BFBB 902A22            MOV      DPTR,#scb+06DH
B3:00BFBE 7401              MOV      A,#01H
B3:00BFC0 F0                MOVX     @DPTR,A
B3:00BFC1 22                RET      
B3:00BFC2         ?C0101?TRANSPORT_SERVICE2:
B3:00BFC2         
B3:00BFC2 02CE3C            LJMP     send_frag_wait_cmd
B3:00BFC5         ?C0099?TRANSPORT_SERVICE2:
B3:00BFC5 900B0F            MOV      DPTR,#current_state
B3:00BFC8 E0                MOVX     A,@DPTR
B3:00BFC9 14                DEC      A
B3:00BFCA 6007              JZ       ?C0105?TRANSPORT_SERVICE2
B3:00BFCC 04                INC      A
B3:00BFCD 7008              JNZ      ?C0103?TRANSPORT_SERVICE2
B3:00BFCF         ?C0104?TRANSPORT_SERVICE2:
B3:00BFCF E4                CLR      A
B3:00BFD0 FF                MOV      R7,A
B3:00BFD1 8002              SJMP     ?C0215?TRANSPORT_SERVICE2
B3:00BFD3         ?C0105?TRANSPORT_SERVICE2:
B3:00BFD3 7F01              MOV      R7,#01H
B3:00BFD5         
B3:00BFD5 B15A              ACALL    _t2_sm_post_event
B3:00BFD7         ?C0103?TRANSPORT_SERVICE2:
B3:00BFD7 902A30            MOV      DPTR,#flag_initialize_once
B3:00BFDA E0                MOVX     A,@DPTR
B3:00BFDB 6028              JZ       ?C0108?TRANSPORT_SERVICE2
B3:00BFDD E4                CLR      A
B3:00BFDE F0                MOVX     @DPTR,A
B3:00BFDF 7B01              MOV      R3,#01H
B3:00BFE1 7A28              MOV      R2,#HIGH rcb
B3:00BFE3 7989              MOV      R1,#LOW rcb
B3:00BFE5 7D1E              MOV      R5,#01EH
B3:00BFE7 12ED92            LCALL    ?L?COM042C
B3:00BFEA 9028AB            MOV      DPTR,#rcb+022H
B3:00BFED 7401              MOV      A,#01H
B3:00BFEF F0                MOVX     @DPTR,A
B3:00BFF0 E4                CLR      A
B3:00BFF1 9029A5            MOV      DPTR,#rcb+011CH
B3:00BFF4 F0                MOVX     @DPTR,A
B3:00BFF5 A3                INC      DPTR
B3:00BFF6 F0                MOVX     @DPTR,A
B3:00BFF7 A3                INC      DPTR
B3:00BFF8 F0                MOVX     @DPTR,A
B3:00BFF9 9029B2            MOV      DPTR,#rcb+0129H
B3:00BFFC F0                MOVX     @DPTR,A
B3:00BFFD 5126              ACALL    ?L?COM043E
B3:00BFFF 7DC8              MOV      R5,#0C8H
B3:00C001 FF                MOV      R7,A
B3:00C002 1299EF            LCALL    ___ZW_memset
B3:00C005         ?C0108?TRANSPORT_SERVICE2:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 993


B3:00C005 903E2A            MOV      DPTR,#pCmd
B3:00C008 122589            LCALL    ?C?PLDXDATA
B3:00C00B 9028A7            MOV      DPTR,#rcb+01EH
B3:00C00E 1225A9            LCALL    ?C?PSTXDATA
B3:00C011 903E27            MOV      DPTR,#p
B3:00C014 122589            LCALL    ?C?PLDXDATA
B3:00C017 126149            LCALL    ?L?COM0047
B3:00C01A 7B01              MOV      R3,#01H
B3:00C01C 7A28              MOV      R2,#HIGH rcb
B3:00C01E 7989              MOV      R1,#LOW rcb
B3:00C020 7F07              MOV      R7,#07H
B3:00C022 1280A2            LCALL    ___ZW_memcpy
B3:00C025 903E2D            MOV      DPTR,#cmdLength
B3:00C028 E0                MOVX     A,@DPTR
B3:00C029 9028AA            MOV      DPTR,#rcb+021H
B3:00C02C F0                MOVX     @DPTR,A
B3:00C02D 12BA68            LCALL    receive
B3:00C030         ?C0089?TRANSPORT_SERVICE2:
B3:00C030 22                RET      
----- FUNCTION _TransportService_ApplicationCommandHandler (END) -------


----- FUNCTION _MemoryGetID (BEGIN) -----
B3:00C031 9040F6            MOV      DPTR,#pHomeID
B3:00C034 1225A9            LCALL    ?C?PSTXDATA
B3:00C037 1152              ACALL    ?L?COM0611
B3:00C039 9040F9            MOV      DPTR,#pNodeID
B3:00C03C 123F95            LCALL    ?L?COM00C0
B3:00C03F 9040F6            MOV      DPTR,#pHomeID
B3:00C042 122589            LCALL    ?C?PLDXDATA
B3:00C045 E9                MOV      A,R1
B3:00C046 4A                ORL      A,R2
B3:00C047 6008              JZ       ?C0005?ZW_MEM
B3:00C049 9040F6            MOV      DPTR,#pHomeID
B3:00C04C 115F              ACALL    ?L?COM04E6
B3:00C04E 127268            LCALL    ?L?COM0415
B3:00C051         ?C0005?ZW_MEM:
B3:00C051 22                RET      
----- FUNCTION _MemoryGetID (END) -------


----- FUNCTION ?L?COM0611 (BEGIN) -----
B3:00C052 7E00              MOV      R6,#HIGH NVM_NODEID_far
B3:00C054 7F08              MOV      R7,#LOW NVM_NODEID_far
B3:00C056 023964            LJMP     _NVM_ext_read_byte
----- FUNCTION ?L?COM0611 (END) -------


----- FUNCTION ?L?COM0508 (BEGIN) -----
B3:00C059 902E74            MOV      DPTR,#span
B3:00C05C 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0508 (END) -------


----- FUNCTION ?L?COM04E6 (BEGIN) -----
B3:00C05F 7E00              MOV      R6,#HIGH NVM_HOMEID_far
B3:00C061 7F04              MOV      R7,#LOW NVM_HOMEID_far
B3:00C063 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04E6 (END) -------


----- FUNCTION _MemoryPutID (BEGIN) -----
B3:00C066 9042B5            MOV      DPTR,#homeID
B3:00C069 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'bNodeID' assigned to Register 'R5' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 994


B3:00C06C         ?C0009?ZW_MEM:
B3:00C06C         ?C0010?ZW_MEM:
B3:00C06C 7E00              MOV      R6,#HIGH NVM_NODEID_far
B3:00C06E 7F08              MOV      R7,#LOW NVM_NODEID_far
B3:00C070 123FC4            LCALL    _NVM_ext_write_byte
B3:00C073 9042B5            MOV      DPTR,#homeID
B3:00C076 115F              ACALL    ?L?COM04E6
B3:00C078 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B3:00C07B 1183              ACALL    ?L?COM053D
B3:00C07D 126C78            LCALL    _NVM_ext_write_buffer
B3:00C080 7F01              MOV      R7,#01H
B3:00C082 22                RET      
----- FUNCTION _MemoryPutID (END) -------


----- FUNCTION ?L?COM053D (BEGIN) -----
B3:00C083 E4                CLR      A
B3:00C084 F0                MOVX     @DPTR,A
B3:00C085 A3                INC      DPTR
B3:00C086 7404              MOV      A,#04H
B3:00C088 F0                MOVX     @DPTR,A
B3:00C089 22                RET      
----- FUNCTION ?L?COM053D (END) -------


----- FUNCTION ?L?COM0462 (BEGIN) -----
B3:00C08A F1B8              ACALL    ___find_mpan_by_group_id
B3:00C08C         ?L?COM0463:
B3:00C08C 902E77            MOV      DPTR,#mpan
B3:00C08F 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0462 (END) -------


----- FUNCTION _fe25519_pack (BEGIN) -----
B3:00C092 9006D3            MOV      DPTR,#r
B3:00C095 EE                MOV      A,R6
B3:00C096 F0                MOVX     @DPTR,A
B3:00C097 A3                INC      DPTR
B3:00C098 EF                MOV      A,R7
B3:00C099 F0                MOVX     @DPTR,A
;---- Variable 'x' assigned to Register 'R4/R5' ----
B3:00C09A AE04              MOV      R6,AR4
B3:00C09C AF05              MOV      R7,AR5
B3:00C09E AA06              MOV      R2,AR6
B3:00C0A0 A907              MOV      R1,AR7
B3:00C0A2 7B01              MOV      R3,#01H
B3:00C0A4 78D5              MOV      R0,#LOW y
B3:00C0A6 7C06              MOV      R4,#HIGH y
B3:00C0A8 12B4F8            LCALL    ?L?COM023F
B3:00C0AB 7E06              MOV      R6,#HIGH y
B3:00C0AD 7FD5              MOV      R7,#LOW y
B3:00C0AF 910B              ACALL    _fe25519_freeze
;---- Variable 'i' assigned to Register 'R7' ----
B3:00C0B1 E4                CLR      A
B3:00C0B2 FF                MOV      R7,A
B3:00C0B3         ?C0036?FE25519:
B3:00C0B3 74D5              MOV      A,#LOW y
B3:00C0B5 2F                ADD      A,R7
B3:00C0B6 F582              MOV      DPL,A
B3:00C0B8 E4                CLR      A
B3:00C0B9 3406              ADDC     A,#HIGH y
B3:00C0BB F583              MOV      DPH,A
B3:00C0BD E0                MOVX     A,@DPTR
B3:00C0BE FE                MOV      R6,A
B3:00C0BF 9006D3            MOV      DPTR,#r
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 995


B3:00C0C2 E0                MOVX     A,@DPTR
B3:00C0C3 FC                MOV      R4,A
B3:00C0C4 A3                INC      DPTR
B3:00C0C5 E0                MOVX     A,@DPTR
B3:00C0C6 2F                ADD      A,R7
B3:00C0C7 126333            LCALL    ?L?COM0330
B3:00C0CA EE                MOV      A,R6
B3:00C0CB F0                MOVX     @DPTR,A
B3:00C0CC 0F                INC      R7
B3:00C0CD EF                MOV      A,R7
B3:00C0CE B420E2            CJNE     A,#020H,?C0036?FE25519
B3:00C0D1 22                RET      
----- FUNCTION _fe25519_pack (END) -------


----- FUNCTION _fe25519_setone (BEGIN) -----
;---- Variable 'r' assigned to Register 'R6/R7' ----
B3:00C0D2 8F82              MOV      DPL,R7
B3:00C0D4 8E83              MOV      DPH,R6
B3:00C0D6 7401              MOV      A,#01H
B3:00C0D8 F0                MOVX     @DPTR,A
;---- Variable 'i' assigned to Register 'R5' ----
B3:00C0D9 FD                MOV      R5,A
B3:00C0DA         ?C0027?FE25519:
B3:00C0DA 12B615            LCALL    ?L?COM0094
B3:00C0DD E4                CLR      A
B3:00C0DE F0                MOVX     @DPTR,A
B3:00C0DF 0D                INC      R5
B3:00C0E0 ED                MOV      A,R5
B3:00C0E1 B420F6            CJNE     A,#020H,?C0027?FE25519
B3:00C0E4 22                RET      
----- FUNCTION _fe25519_setone (END) -------


----- FUNCTION __S2_encrypt_and_send (BEGIN) -----
B3:00C0E5 12A59A            LCALL    ?L?COM0335
B3:00C0E8 903048            MOV      DPTR,#span
B3:00C0EB EE                MOV      A,R6
B3:00C0EC 9104              ACALL    ?L?COM0127
B3:00C0EE 7A22              MOV      R2,#HIGH the_context+0211H
B3:00C0F0 7924              MOV      R1,#LOW the_context+0211H
B3:00C0F2 903044            MOV      DPTR,#msg
B3:00C0F5 1225A9            LCALL    ?C?PSTXDATA
B3:00C0F8 903044            MOV      DPTR,#msg
B3:00C0FB 914C              ACALL    ?L?COM0431
B3:00C0FD 903044            MOV      DPTR,#msg
B3:00C100 12EE20            LCALL    ?L?COM025D
B3:00C103 903048            MOV      DPTR,#span
B3:00C106 E0                MOVX     A,@DPTR
B3:00C107 FE                MOV      R6,A
B3:00C108 A3                INC      DPTR
B3:00C109 E0                MOVX     A,@DPTR
B3:00C10A FF                MOV      R7,A
B3:00C10B 2424              ADD      A,#024H
B3:00C10D 12B617            LCALL    ?L?COM0096
B3:00C110 E0                MOVX     A,@DPTR
B3:00C111 12ECFD            LCALL    ?L?COM0131
B3:00C114 900003            MOV      DPTR,#03H
B3:00C117 E4                CLR      A
B3:00C118 122084            LCALL    ?C?CSTOPTR
B3:00C11B 903040            MOV      DPTR,#hdr_len
B3:00C11E 1183              ACALL    ?L?COM053D
B3:00C120 E4                CLR      A
B3:00C121 903047            MOV      DPTR,#n_ext
B3:00C124 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 996


B3:00C125 125525            LCALL    ?L?COM005A
B3:00C128 90303D            MOV      DPTR,#ext_data
B3:00C12B 1225A9            LCALL    ?C?PSTXDATA
B3:00C12E EF                MOV      A,R7
B3:00C12F 2426              ADD      A,#026H
B3:00C131 12B617            LCALL    ?L?COM0096
B3:00C134 E0                MOVX     A,@DPTR
B3:00C135 6404              XRL      A,#04H
B3:00C137 6002              JZ       $ + 4H
B3:00C139 21C4              AJMP     ?C0047?S2
B3:00C13B 7B01              MOV      R3,#01H
B3:00C13D 7A30              MOV      R2,#HIGH ei_sender
B3:00C13F 790A              MOV      R1,#LOW ei_sender
B3:00C141 12A58D            LCALL    ?L?COM015D
B3:00C144 71D3              ACALL    ?L?COM0337
B3:00C146 781A              MOV      R0,#LOW ei_receiver
B3:00C148 7C30              MOV      R4,#HIGH ei_receiver
B3:00C14A 12A7B1            LCALL    ?L?COM01B3
B3:00C14D 71D3              ACALL    ?L?COM0337
B3:00C14F C002              PUSH     AR2
B3:00C151 C001              PUSH     AR1
B3:00C153 7A30              MOV      R2,#HIGH ei_sender
B3:00C155 790A              MOV      R1,#LOW ei_sender
B3:00C157 903134            MOV      DPTR,#?_next_nonce_instantiate?BYTE+03H
B3:00C15A 1225A9            LCALL    ?C?PSTXDATA
B3:00C15D 7A30              MOV      R2,#HIGH ei_receiver
B3:00C15F 791A              MOV      R1,#LOW ei_receiver
B3:00C161 903137            MOV      DPTR,#?_next_nonce_instantiate?BYTE+06H
B3:00C164 1225A9            LCALL    ?C?PSTXDATA
B3:00C167 9020E9            MOV      DPTR,#the_context+0D6H
B3:00C16A E0                MOVX     A,@DPTR
B3:00C16B 75F040            MOV      B,#040H
B3:00C16E A4                MUL      AB
B3:00C16F 12EF36            LCALL    ?L?COM022D
B3:00C172 D001              POP      AR1
B3:00C174 D002              POP      AR2
B3:00C176 121B3D            LCALL    ?INTERBANK_TABLE?_next_nonce_instantiate
B3:00C179 9020E9            MOV      DPTR,#the_context+0D6H
B3:00C17C E0                MOVX     A,@DPTR
B3:00C17D FF                MOV      R7,A
B3:00C17E 903048            MOV      DPTR,#span
B3:00C181 E0                MOVX     A,@DPTR
B3:00C182 FC                MOV      R4,A
B3:00C183 A3                INC      DPTR
B3:00C184 E0                MOVX     A,@DPTR
B3:00C185 FD                MOV      R5,A
B3:00C186 2425              ADD      A,#025H
B3:00C188 126333            LCALL    ?L?COM0330
B3:00C18B EF                MOV      A,R7
B3:00C18C F0                MOVX     @DPTR,A
B3:00C18D ED                MOV      A,R5
B3:00C18E 2426              ADD      A,#026H
B3:00C190 126333            LCALL    ?L?COM0330
B3:00C193 7406              MOV      A,#06H
B3:00C195 F0                MOVX     @DPTR,A
B3:00C196 71C1              ACALL    ?L?COM016A
B3:00C198 7412              MOV      A,#012H
B3:00C19A 71BE              ACALL    ?L?COM0169
B3:00C19C 7441              MOV      A,#041H
B3:00C19E 122072            LCALL    ?C?CSTPTR
B3:00C1A1 90303D            MOV      DPTR,#ext_data
B3:00C1A4 12708F            LCALL    ?L?COM0149
B3:00C1A7 7A30              MOV      R2,#HIGH ei_sender
B3:00C1A9 790A              MOV      R1,#LOW ei_sender
B3:00C1AB 12A7B3            LCALL    ?L?COM01B4
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 997


B3:00C1AE 903040            MOV      DPTR,#hdr_len
B3:00C1B1 E4                CLR      A
B3:00C1B2 75F012            MOV      B,#012H
B3:00C1B5 122143            LCALL    ?C?IILDX
B3:00C1B8 90303E            MOV      DPTR,#ext_data+01H
B3:00C1BB 127161            LCALL    ?L?COM0301
B3:00C1BE 903047            MOV      DPTR,#n_ext
B3:00C1C1 E0                MOVX     A,@DPTR
B3:00C1C2 04                INC      A
B3:00C1C3 F0                MOVX     @DPTR,A
B3:00C1C4         ?C0047?S2:
B3:00C1C4 9020E4            MOV      DPTR,#the_context+0D1H
B3:00C1C7 E0                MOVX     A,@DPTR
B3:00C1C8 5406              ANL      A,#06H
B3:00C1CA 6046              JZ       ?C0048?S2
B3:00C1CC 71CB              ACALL    ?L?COM021A
B3:00C1CE 4E                ORL      A,R6
B3:00C1CF 6041              JZ       ?C0048?S2
B3:00C1D1 9020E3            MOV      DPTR,#the_context+0D0H
B3:00C1D4 E0                MOVX     A,@DPTR
B3:00C1D5 FF                MOV      R7,A
B3:00C1D6 12E767            LCALL    ___S2_is_node_mos
B3:00C1D9 EF                MOV      A,R7
B3:00C1DA 7022              JNZ      ?C0049?S2
B3:00C1DC 90303D            MOV      DPTR,#ext_data
B3:00C1DF 71C5              ACALL    ?L?COM016C
B3:00C1E1 7403              MOV      A,#03H
B3:00C1E3 71BE              ACALL    ?L?COM0169
B3:00C1E5 7443              MOV      A,#043H
B3:00C1E7 122072            LCALL    ?C?CSTPTR
B3:00C1EA 71CB              ACALL    ?L?COM021A
B3:00C1EC F582              MOV      DPL,A
B3:00C1EE 8E83              MOV      DPH,R6
B3:00C1F0 A3                INC      DPTR
B3:00C1F1 E0                MOVX     A,@DPTR
B3:00C1F2 FF                MOV      R7,A
B3:00C1F3 71C1              ACALL    ?L?COM016A
B3:00C1F5 EF                MOV      A,R7
B3:00C1F6 71E7              ACALL    ?L?COM0603
B3:00C1F8 75F003            MOV      B,#03H
B3:00C1FB 71EF              ACALL    ?L?COM057D
B3:00C1FD F0                MOVX     @DPTR,A
B3:00C1FE         ?C0049?S2:
B3:00C1FE 9020E4            MOV      DPTR,#the_context+0D1H
B3:00C201 E0                MOVX     A,@DPTR
B3:00C202 30E20D            JNB      ACC.2,?C0048?S2
B3:00C205 902221            MOV      DPTR,#the_context+020EH
B3:00C208 E0                MOVX     A,@DPTR
B3:00C209 B40206            CJNE     A,#02H,?C0048?S2
B3:00C20C 71CB              ACALL    ?L?COM021A
B3:00C20E FF                MOV      R7,A
B3:00C20F 12E77B            LCALL    _next_mpan_state
B3:00C212         ?C0048?S2:
B3:00C212 9020F1            MOV      DPTR,#the_context+0DEH
B3:00C215 12A790            LCALL    ?L?COM0098
B3:00C218 602F              JZ       ?C0051?S2
B3:00C21A EF                MOV      A,R7
B3:00C21B 2413              ADD      A,#013H
B3:00C21D 12B617            LCALL    ?L?COM0096
B3:00C220 E0                MOVX     A,@DPTR
B3:00C221 B40225            CJNE     A,#02H,?C0051?S2
B3:00C224 9020F1            MOV      DPTR,#the_context+0DEH
B3:00C227 A3                INC      DPTR
B3:00C228 E0                MOVX     A,@DPTR
B3:00C229 2413              ADD      A,#013H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 998


B3:00C22B 12B617            LCALL    ?L?COM0096
B3:00C22E E4                CLR      A
B3:00C22F F0                MOVX     @DPTR,A
B3:00C230 9020F1            MOV      DPTR,#the_context+0DEH
B3:00C233 F0                MOVX     @DPTR,A
B3:00C234 A3                INC      DPTR
B3:00C235 F0                MOVX     @DPTR,A
B3:00C236 90303D            MOV      DPTR,#ext_data
B3:00C239 71C5              ACALL    ?L?COM016C
B3:00C23B 7402              MOV      A,#02H
B3:00C23D 71BE              ACALL    ?L?COM0169
B3:00C23F 7404              MOV      A,#04H
B3:00C241 71E7              ACALL    ?L?COM0603
B3:00C243 75F002            MOV      B,#02H
B3:00C246 71EF              ACALL    ?L?COM057D
B3:00C248 F0                MOVX     @DPTR,A
B3:00C249         ?C0051?S2:
B3:00C249 903047            MOV      DPTR,#n_ext
B3:00C24C E0                MOVX     A,@DPTR
B3:00C24D 6045              JZ       ?C0052?S2
B3:00C24F 903044            MOV      DPTR,#msg
B3:00C252 12707E            LCALL    ?L?COM00F2
B3:00C255 125510            LCALL    ?L?COM000B
B3:00C258 4401              ORL      A,#01H
B3:00C25A 122072            LCALL    ?C?CSTPTR
B3:00C25D 903044            MOV      DPTR,#msg
B3:00C260 125522            LCALL    ?L?COM0059
B3:00C263 90303D            MOV      DPTR,#ext_data
B3:00C266 1225A9            LCALL    ?C?PSTXDATA
B3:00C269         ?C0053?S2:
B3:00C269 903047            MOV      DPTR,#n_ext
B3:00C26C E0                MOVX     A,@DPTR
B3:00C26D 14                DEC      A
B3:00C26E F0                MOVX     @DPTR,A
B3:00C26F 6013              JZ       ?C0054?S2
B3:00C271 90303D            MOV      DPTR,#ext_data
B3:00C274 122589            LCALL    ?C?PLDXDATA
B3:00C277 E9                MOV      A,R1
B3:00C278 2401              ADD      A,#01H
B3:00C27A 125510            LCALL    ?L?COM000B
B3:00C27D 4480              ORL      A,#080H
B3:00C27F 122072            LCALL    ?C?CSTPTR
B3:00C282 80E5              SJMP     ?C0053?S2
B3:00C284         ?C0054?S2:
B3:00C284 90303D            MOV      DPTR,#ext_data
B3:00C287 122589            LCALL    ?C?PLDXDATA
B3:00C28A 121FB3            LCALL    ?C?CLDPTR
B3:00C28D FF                MOV      R7,A
B3:00C28E 90303E            MOV      DPTR,#ext_data+01H
B3:00C291 12D1C3            LCALL    ?L?COM01D2
B3:00C294         ?C0052?S2:
B3:00C294 903044            MOV      DPTR,#msg
B3:00C297 122589            LCALL    ?C?PLDXDATA
B3:00C29A 903040            MOV      DPTR,#hdr_len
B3:00C29D 127138            LCALL    ?L?COM02A0
B3:00C2A0 90303A            MOV      DPTR,#ciphertext
B3:00C2A3 1225A9            LCALL    ?C?PSTXDATA
B3:00C2A6 D119              ACALL    ___S2_add_mpan_extensions
B3:00C2A8 903042            MOV      DPTR,#shdr_len
B3:00C2AB 1267E1            LCALL    ?L?COM0460
B3:00C2AE 600C              JZ       ?C0055?S2
B3:00C2B0 A3                INC      DPTR
B3:00C2B1 12707E            LCALL    ?L?COM00F2
B3:00C2B4 125510            LCALL    ?L?COM000B
B3:00C2B7 4402              ORL      A,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 999


B3:00C2B9 122072            LCALL    ?C?CSTPTR
B3:00C2BC         ?C0055?S2:
B3:00C2BC 12EE0D            LCALL    ?L?COM05A1
B3:00C2BF 90303A            MOV      DPTR,#ciphertext
B3:00C2C2 122589            LCALL    ?C?PLDXDATA
B3:00C2C5 903042            MOV      DPTR,#shdr_len
B3:00C2C8 E0                MOVX     A,@DPTR
B3:00C2C9 FC                MOV      R4,A
B3:00C2CA A3                INC      DPTR
B3:00C2CB E0                MOVX     A,@DPTR
B3:00C2CC 9020EA            MOV      DPTR,#the_context+0D7H
B3:00C2CF 1270F1            LCALL    ?L?COM0232
B3:00C2D2 9020E3            MOV      DPTR,#the_context+0D0H
B3:00C2D5 E0                MOVX     A,@DPTR
B3:00C2D6 903040            MOV      DPTR,#hdr_len
B3:00C2D9 12EF7A            LCALL    ?L?COM03AA
B3:00C2DC 903042            MOV      DPTR,#shdr_len
B3:00C2DF E0                MOVX     A,@DPTR
B3:00C2E0 FA                MOV      R2,A
B3:00C2E1 A3                INC      DPTR
B3:00C2E2 E0                MOVX     A,@DPTR
B3:00C2E3 FB                MOV      R3,A
B3:00C2E4 9020ED            MOV      DPTR,#the_context+0DAH
B3:00C2E7 E0                MOVX     A,@DPTR
B3:00C2E8 F8                MOV      R0,A
B3:00C2E9 A3                INC      DPTR
B3:00C2EA E0                MOVX     A,@DPTR
B3:00C2EB 2B                ADD      A,R3
B3:00C2EC FB                MOV      R3,A
B3:00C2ED E8                MOV      A,R0
B3:00C2EE 3A                ADDC     A,R2
B3:00C2EF FA                MOV      R2,A
B3:00C2F0 903040            MOV      DPTR,#hdr_len
B3:00C2F3 12EE51            LCALL    ?L?COM0336
B3:00C2F6 7A2F              MOV      R2,#HIGH aad
B3:00C2F8 79C8              MOV      R1,#LOW aad
B3:00C2FA 12EE3B            LCALL    ?L?COM02A1
B3:00C2FD 903044            MOV      DPTR,#msg
B3:00C300 D1FE              ACALL    ?L?COM04A9
B3:00C302 903008            MOV      DPTR,#aad_len
B3:00C305 EE                MOV      A,R6
B3:00C306 F0                MOVX     @DPTR,A
B3:00C307 A3                INC      DPTR
B3:00C308 EF                MOV      A,R7
B3:00C309 F0                MOVX     @DPTR,A
B3:00C30A 71D3              ACALL    ?L?COM0337
B3:00C30C C002              PUSH     AR2
B3:00C30E C001              PUSH     AR1
B3:00C310 9040ED            MOV      DPTR,#?_next_nonce_generate?BYTE+03H
B3:00C313 71E0              ACALL    ?L?COM05C8
B3:00C315 D001              POP      AR1
B3:00C317 D002              POP      AR2
B3:00C319 121B42            LCALL    ?INTERBANK_TABLE?_next_nonce_generate
B3:00C31C 9020E9            MOV      DPTR,#the_context+0D6H
B3:00C31F 12EE2B            LCALL    ?L?COM0205
B3:00C322 C003              PUSH     AR3
B3:00C324 C002              PUSH     AR2
B3:00C326 C001              PUSH     AR1
B3:00C328 903543            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+03H
B3:00C32B 71E0              ACALL    ?L?COM05C8
B3:00C32D 7A2F              MOV      R2,#HIGH aad
B3:00C32F 79C8              MOV      R1,#LOW aad
B3:00C331 903546            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+06H
B3:00C334 1225A9            LCALL    ?C?PSTXDATA
B3:00C337 903008            MOV      DPTR,#aad_len
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1000


B3:00C33A 12E50A            LCALL    ?L?COM00B0
B3:00C33D 903549            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+09H
B3:00C340 1224F1            LCALL    ?C?LSTXDATA
B3:00C343 90303A            MOV      DPTR,#ciphertext
B3:00C346 12EE04            LCALL    ?L?COM053E
B3:00C349 903042            MOV      DPTR,#shdr_len
B3:00C34C E0                MOVX     A,@DPTR
B3:00C34D FE                MOV      R6,A
B3:00C34E A3                INC      DPTR
B3:00C34F E0                MOVX     A,@DPTR
B3:00C350 FF                MOV      R7,A
B3:00C351 9020EE            MOV      DPTR,#the_context+0DBH
B3:00C354 E0                MOVX     A,@DPTR
B3:00C355 2F                ADD      A,R7
B3:00C356 FF                MOV      R7,A
B3:00C357 9020ED            MOV      DPTR,#the_context+0DAH
B3:00C35A E0                MOVX     A,@DPTR
B3:00C35B 3E                ADDC     A,R6
B3:00C35C 903550            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+010H
B3:00C35F F0                MOVX     @DPTR,A
B3:00C360 A3                INC      DPTR
B3:00C361 EF                MOV      A,R7
B3:00C362 F0                MOVX     @DPTR,A
B3:00C363 D001              POP      AR1
B3:00C365 D002              POP      AR2
B3:00C367 D003              POP      AR3
B3:00C369 121B1A            LCALL    ?INTERBANK_TABLE?_CCM_encrypt_and_auth
;---- Variable 'msg_len' assigned to Register 'R6/R7' ----
B3:00C36C 903044            MOV      DPTR,#msg
B3:00C36F 122589            LCALL    ?C?PLDXDATA
B3:00C372 903041            MOV      DPTR,#hdr_len+01H
B3:00C375 E0                MOVX     A,@DPTR
B3:00C376 2F                ADD      A,R7
B3:00C377 FD                MOV      R5,A
B3:00C378 903040            MOV      DPTR,#hdr_len
B3:00C37B E0                MOVX     A,@DPTR
B3:00C37C 3E                ADDC     A,R6
B3:00C37D FC                MOV      R4,A
B3:;----                  JMP      ___S2_send_raw
----- FUNCTION __S2_encrypt_and_send (END) -------


----- FUNCTION ___S2_send_raw (BEGIN) -----
B3:00C37E 903CB7            MOV      DPTR,#buf
B3:00C381 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R4/R5' ----
B3:00C384 903CB7            MOV      DPTR,#buf
B3:00C387 9154              ACALL    ?L?COM04FC
B3:00C389 AF05              MOV      R7,AR5
B3:00C38B 903F9A            MOV      DPTR,#?___S2_send_frame?BYTE+06H
B3:00C38E 9103              ACALL    ?L?COM0126
B3:00C390 71F8              ACALL    ?L?COM059B
B3:00C392 601A              JZ       ?C0066?S2
B3:00C394 12A59A            LCALL    ?L?COM0335
B3:00C397 903CC2            MOV      DPTR,#span
B3:00C39A EE                MOV      A,R6
B3:00C39B F0                MOVX     @DPTR,A
B3:00C39C A3                INC      DPTR
B3:00C39D EF                MOV      A,R7
B3:00C39E F0                MOVX     @DPTR,A
B3:00C39F 8E83              MOV      DPH,R6
B3:00C3A1 2424              ADD      A,#024H
B3:00C3A3 F582              MOV      DPL,A
B3:00C3A5 E4                CLR      A
B3:00C3A6 3583              ADDC     A,DPH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1001


B3:00C3A8 F583              MOV      DPH,A
B3:00C3AA E0                MOVX     A,@DPTR
B3:00C3AB 04                INC      A
B3:00C3AC F0                MOVX     @DPTR,A
B3:00C3AD 22                RET      
B3:00C3AE         ?C0066?S2:
B3:00C3AE 903CBD            MOV      DPTR,#e+03H
B3:00C3B1 7402              MOV      A,#02H
B3:00C3B3 F0                MOVX     @DPTR,A
B3:00C3B4 7B01              MOV      R3,#01H
B3:00C3B6 7A3C              MOV      R2,#HIGH e
B3:00C3B8 79BA              MOV      R1,#LOW e
B3:00C3BA FF                MOV      R7,A
B3:00C3BB 028E6A            LJMP     ___S2_fsm_post_event
----- FUNCTION ___S2_send_raw (END) -------


----- FUNCTION ?L?COM0169 (BEGIN) -----
B3:00C3BE 122072            LCALL    ?C?CSTPTR
B3:00C3C1         ?L?COM016A:
B3:00C3C1 90303D            MOV      DPTR,#ext_data
B3:00C3C4         ?L?COM016B:
B3:00C3C4 E4                CLR      A
B3:00C3C5         ?L?COM016C:
B3:00C3C5 75F001            MOV      B,#01H
B3:00C3C8 022592            LJMP     ?C?PLDIXDATA
----- FUNCTION ?L?COM0169 (END) -------


----- FUNCTION ?L?COM021A (BEGIN) -----
B3:00C3CB 9020F1            MOV      DPTR,#the_context+0DEH
B3:00C3CE E0                MOVX     A,@DPTR
B3:00C3CF FE                MOV      R6,A
B3:00C3D0 A3                INC      DPTR
B3:00C3D1 E0                MOVX     A,@DPTR
B3:00C3D2 22                RET      
----- FUNCTION ?L?COM021A (END) -------


----- FUNCTION ?L?COM0337 (BEGIN) -----
B3:00C3D3 903048            MOV      DPTR,#span
B3:00C3D6 E0                MOVX     A,@DPTR
B3:00C3D7 FE                MOV      R6,A
B3:00C3D8 A3                INC      DPTR
B3:00C3D9 E0                MOVX     A,@DPTR
B3:00C3DA AA06              MOV      R2,AR6
B3:00C3DC F9                MOV      R1,A
B3:00C3DD 7B01              MOV      R3,#01H
B3:00C3DF 22                RET      
----- FUNCTION ?L?COM0337 (END) -------


----- FUNCTION ?L?COM05C8 (BEGIN) -----
B3:00C3E0 7A30              MOV      R2,#HIGH nonce
B3:00C3E2 792A              MOV      R1,#LOW nonce
B3:00C3E4 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM05C8 (END) -------


----- FUNCTION ?L?COM0603 (BEGIN) -----
B3:00C3E7 122072            LCALL    ?C?CSTPTR
B3:00C3EA 903040            MOV      DPTR,#hdr_len
B3:00C3ED E4                CLR      A
B3:00C3EE 22                RET      
----- FUNCTION ?L?COM0603 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1002




----- FUNCTION ?L?COM057D (BEGIN) -----
B3:00C3EF 122143            LCALL    ?C?IILDX
B3:00C3F2 903047            MOV      DPTR,#n_ext
B3:00C3F5 E0                MOVX     A,@DPTR
B3:00C3F6 04                INC      A
B3:00C3F7 22                RET      
----- FUNCTION ?L?COM057D (END) -------


----- FUNCTION ?L?COM059B (BEGIN) -----
B3:00C3F8 7A20              MOV      R2,#HIGH the_context+0CFH
B3:00C3FA 79E2              MOV      R1,#LOW the_context+0CFH
B3:00C3FC 12CAE4            LCALL    ___S2_send_frame
B3:00C3FF EF                MOV      A,R7
B3:00C400 22                RET      
----- FUNCTION ?L?COM059B (END) -------


----- FUNCTION ?L?COM0125 (BEGIN) -----
B3:00C401 AF05              MOV      R7,AR5
B3:00C403         ?L?COM0126:
B3:00C403 EC                MOV      A,R4
B3:00C404         ?L?COM0127:
B3:00C404 F0                MOVX     @DPTR,A
B3:00C405 A3                INC      DPTR
B3:00C406 EF                MOV      A,R7
B3:00C407 F0                MOVX     @DPTR,A
B3:00C408 7B01              MOV      R3,#01H
B3:00C40A 22                RET      
----- FUNCTION ?L?COM0125 (END) -------


----- FUNCTION _fe25519_freeze (BEGIN) -----
B3:00C40B 9006F5            MOV      DPTR,#r
B3:00C40E 12732A            LCALL    ?L?COM04D7
B3:00C411 7E06              MOV      R6,#HIGH rt
B3:00C413 7FF7              MOV      R7,#LOW rt
;---- Variable 'c' assigned to Register 'R3' ----
B3:00C415 912B              ACALL    ?L?COM0256
B3:00C417 12848B            LCALL    _fe25519_cmov
B3:00C41A 7E06              MOV      R6,#HIGH rt
B3:00C41C 7FF7              MOV      R7,#LOW rt
B3:00C41E 9006F5            MOV      DPTR,#r
B3:00C421 E0                MOVX     A,@DPTR
B3:00C422 FC                MOV      R4,A
B3:00C423 A3                INC      DPTR
B3:00C424 E0                MOVX     A,@DPTR
B3:00C425 FD                MOV      R5,A
B3:00C426 912B              ACALL    ?L?COM0256
B3:00C428 02848B            LJMP     _fe25519_cmov
----- FUNCTION _fe25519_freeze (END) -------


----- FUNCTION ?L?COM0256 (BEGIN) -----
B3:00C42B 7A09              MOV      R2,#HIGH ECCParam_p
B3:00C42D 7BB7              MOV      R3,#LOW ECCParam_p
B3:00C42F 903EB7            MOV      DPTR,#?_bigint_sub?BYTE+06H
B3:00C432 7420              MOV      A,#020H
B3:00C434 F0                MOVX     @DPTR,A
B3:00C435 121B51            LCALL    ?INTERBANK_TABLE?_bigint_sub
B3:00C438 AB07              MOV      R3,AR7
B3:00C43A 9006F5            MOV      DPTR,#r
B3:00C43D E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1003


B3:00C43E FE                MOV      R6,A
B3:00C43F A3                INC      DPTR
B3:00C440 E0                MOVX     A,@DPTR
B3:00C441 FF                MOV      R7,A
B3:00C442 7C06              MOV      R4,#HIGH rt
B3:00C444 7DF7              MOV      R5,#LOW rt
B3:00C446 C3                CLR      C
B3:00C447 7401              MOV      A,#01H
B3:00C449 9B                SUBB     A,R3
B3:00C44A FB                MOV      R3,A
B3:00C44B 22                RET      
----- FUNCTION ?L?COM0256 (END) -------


----- FUNCTION ?L?COM0431 (BEGIN) -----
B3:00C44C 122589            LCALL    ?C?PLDXDATA
B3:00C44F 749F              MOV      A,#09FH
B3:00C451 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0431 (END) -------


----- FUNCTION ?L?COM04FC (BEGIN) -----
B3:00C454 122589            LCALL    ?C?PLDXDATA
B3:00C457 903F97            MOV      DPTR,#?___S2_send_frame?BYTE+03H
B3:00C45A 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04FC (END) -------


----- FUNCTION ?L?COM02A6 (BEGIN) -----
B3:00C45D 903F79            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B3:00C460 E4                CLR      A
B3:00C461 F0                MOVX     @DPTR,A
B3:00C462 A3                INC      DPTR
B3:00C463 ED                MOV      A,R5
B3:00C464 F0                MOVX     @DPTR,A
----- FUNCTION _ZW_CheckCrc16 (BEGIN) -----
;---- Variable 'bitMask' assigned to Register 'R5' ----
B3:00C465 903F74            MOV      DPTR,#crc
B3:00C468 127085            LCALL    ?L?COM00F3
B3:00C46B         ?C0001?ZW_CRC:
B3:00C46B 903F79            MOV      DPTR,#bDataLen
B3:00C46E 123F8D            LCALL    ?L?COM04AF
B3:00C471 45F0              ORL      A,B
B3:00C473 6057              JZ       ?C0002?ZW_CRC
B3:00C475 903F76            MOV      DPTR,#pDataAddr
B3:00C478 122589            LCALL    ?C?PLDXDATA
B3:00C47B 121FB3            LCALL    ?C?CLDPTR
B3:00C47E 903F7B            MOV      DPTR,#WorkData
B3:00C481 F0                MOVX     @DPTR,A
B3:00C482 903F77            MOV      DPTR,#pDataAddr+01H
B3:00C485 123F7F            LCALL    ?L?COM0081
B3:00C488 7D80              MOV      R5,#080H
B3:00C48A         ?C0003?ZW_CRC:
B3:00C48A ED                MOV      A,R5
B3:00C48B 60DE              JZ       ?C0001?ZW_CRC
B3:00C48D 903F74            MOV      DPTR,#crc
B3:00C490 12E9FF            LCALL    ?L?COM0506
B3:00C493 7C00              MOV      R4,#00H
B3:00C495 30E702            JNB      ACC.7,?C0006?ZW_CRC
B3:00C498 7C01              MOV      R4,#01H
B3:00C49A         ?C0006?ZW_CRC:
B3:00C49A         ?C0007?ZW_CRC:
B3:00C49A 903F7B            MOV      DPTR,#WorkData
B3:00C49D E0                MOVX     A,@DPTR
B3:00C49E 5D                ANL      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1004


B3:00C49F 7B00              MOV      R3,#00H
B3:00C4A1 6002              JZ       ?C0008?ZW_CRC
B3:00C4A3 7B01              MOV      R3,#01H
B3:00C4A5         ?C0008?ZW_CRC:
B3:00C4A5         ?C0009?ZW_CRC:
B3:00C4A5 EB                MOV      A,R3
B3:00C4A6 6C                XRL      A,R4
B3:00C4A7 FC                MOV      R4,A
;---- Variable 'NewBit' assigned to Register 'R4' ----
B3:00C4A8 EF                MOV      A,R7
B3:00C4A9 25E0              ADD      A,ACC
B3:00C4AB FF                MOV      R7,A
B3:00C4AC EE                MOV      A,R6
B3:00C4AD 33                RLC      A
B3:00C4AE 903F74            MOV      DPTR,#crc
B3:00C4B1 F0                MOVX     @DPTR,A
B3:00C4B2 A3                INC      DPTR
B3:00C4B3 EF                MOV      A,R7
B3:00C4B4 F0                MOVX     @DPTR,A
B3:00C4B5 AF04              MOV      R7,AR4
B3:00C4B7 EF                MOV      A,R7
B3:00C4B8 600C              JZ       ?C0005?ZW_CRC
B3:00C4BA 903F74            MOV      DPTR,#crc
B3:00C4BD E0                MOVX     A,@DPTR
B3:00C4BE 6410              XRL      A,#010H
B3:00C4C0 F0                MOVX     @DPTR,A
B3:00C4C1 A3                INC      DPTR
B3:00C4C2 E0                MOVX     A,@DPTR
B3:00C4C3 6421              XRL      A,#021H
B3:00C4C5 F0                MOVX     @DPTR,A
B3:00C4C6         ?C0005?ZW_CRC:
B3:00C4C6 ED                MOV      A,R5
B3:00C4C7 C3                CLR      C
B3:00C4C8 13                RRC      A
B3:00C4C9 FD                MOV      R5,A
B3:00C4CA 80BE              SJMP     ?C0003?ZW_CRC
B3:00C4CC         ?C0002?ZW_CRC:
B3:00C4CC 903F74            MOV      DPTR,#crc
B3:00C4CF E0                MOVX     A,@DPTR
B3:00C4D0 FE                MOV      R6,A
B3:00C4D1 A3                INC      DPTR
B3:00C4D2 E0                MOVX     A,@DPTR
B3:00C4D3 FF                MOV      R7,A
B3:00C4D4 22                RET      
----- FUNCTION _ZW_CheckCrc16 (END) -------


----- FUNCTION __S2_encrypt_and_send_multi (BEGIN) -----
B3:00C4D5 7B01              MOV      R3,#01H
B3:00C4D7 7A22              MOV      R2,#HIGH the_context+0211H
B3:00C4D9 7924              MOV      R1,#LOW the_context+0211H
B3:00C4DB 9032C0            MOV      DPTR,#msg
B3:00C4DE 1225A9            LCALL    ?C?PSTXDATA
B3:00C4E1 9032C0            MOV      DPTR,#msg
B3:00C4E4 914C              ACALL    ?L?COM0431
B3:00C4E6 9032C0            MOV      DPTR,#msg
B3:00C4E9 12EE20            LCALL    ?L?COM025D
B3:00C4EC 900002            MOV      DPTR,#02H
B3:00C4EF 74FF              MOV      A,#0FFH
B3:00C4F1 122084            LCALL    ?C?CSTOPTR
B3:00C4F4 7401              MOV      A,#01H
B3:00C4F6 1271DE            LCALL    ?L?COM0378
B3:00C4F9 900004            MOV      DPTR,#04H
B3:00C4FC 7403              MOV      A,#03H
B3:00C4FE 122084            LCALL    ?C?CSTOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1005


B3:00C501 900005            MOV      DPTR,#05H
B3:00C504 7443              MOV      A,#043H
B3:00C506 122084            LCALL    ?C?CSTOPTR
B3:00C509 71CB              ACALL    ?L?COM021A
B3:00C50B F582              MOV      DPL,A
B3:00C50D 8E83              MOV      DPH,R6
B3:00C50F A3                INC      DPTR
B3:00C510 E0                MOVX     A,@DPTR
B3:00C511 900006            MOV      DPTR,#06H
B3:00C514 122084            LCALL    ?C?CSTOPTR
B3:00C517 9032BE            MOV      DPTR,#hdr_len
B3:00C51A E4                CLR      A
B3:00C51B F0                MOVX     @DPTR,A
B3:00C51C A3                INC      DPTR
B3:00C51D 7407              MOV      A,#07H
B3:00C51F F0                MOVX     @DPTR,A
B3:00C520 29                ADD      A,R1
B3:00C521 F9                MOV      R1,A
B3:00C522 E4                CLR      A
B3:00C523 3A                ADDC     A,R2
B3:00C524 FA                MOV      R2,A
B3:00C525 9032BB            MOV      DPTR,#ciphertext
B3:00C528 1225A9            LCALL    ?C?PSTXDATA
B3:00C52B 12EE0D            LCALL    ?L?COM05A1
B3:00C52E 9032BB            MOV      DPTR,#ciphertext
B3:00C531 12EE16            LCALL    ?L?COM0521
B3:00C534 9020EA            MOV      DPTR,#the_context+0D7H
B3:00C537 1270FA            LCALL    ?L?COM0233
B3:00C53A 9020E3            MOV      DPTR,#the_context+0D0H
B3:00C53D E0                MOVX     A,@DPTR
B3:00C53E FD                MOV      R5,A
B3:00C53F 9032BE            MOV      DPTR,#hdr_len
B3:00C542 E0                MOVX     A,@DPTR
B3:00C543 FA                MOV      R2,A
B3:00C544 A3                INC      DPTR
B3:00C545 E0                MOVX     A,@DPTR
B3:00C546 FB                MOV      R3,A
B3:00C547 903C50            MOV      DPTR,#?___S2_make_aad?BYTE+05H
B3:00C54A EA                MOV      A,R2
B3:00C54B F0                MOVX     @DPTR,A
B3:00C54C A3                INC      DPTR
B3:00C54D EB                MOV      A,R3
B3:00C54E F0                MOVX     @DPTR,A
B3:00C54F 9020ED            MOV      DPTR,#the_context+0DAH
B3:00C552 12EE51            LCALL    ?L?COM0336
B3:00C555 7A32              MOV      R2,#HIGH aad
B3:00C557 7969              MOV      R1,#LOW aad
B3:00C559 12EE3B            LCALL    ?L?COM02A1
B3:00C55C 9032C0            MOV      DPTR,#msg
B3:00C55F D1FE              ACALL    ?L?COM04A9
B3:00C561 9032A9            MOV      DPTR,#aad_len
B3:00C564 EE                MOV      A,R6
B3:00C565 F0                MOVX     @DPTR,A
B3:00C566 A3                INC      DPTR
B3:00C567 EF                MOV      A,R7
B3:00C568 F0                MOVX     @DPTR,A
B3:00C569 71CB              ACALL    ?L?COM021A
B3:00C56B 2412              ADD      A,#012H
B3:00C56D 12B617            LCALL    ?L?COM0096
B3:00C570 E0                MOVX     A,@DPTR
B3:00C571 12EF99            LCALL    ?L?COM03F0
B3:00C574 C002              PUSH     AR2
B3:00C576 C001              PUSH     AR1
B3:00C578 71CB              ACALL    ?L?COM021A
B3:00C57A 2402              ADD      A,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1006


B3:00C57C FF                MOV      R7,A
B3:00C57D E4                CLR      A
B3:00C57E 3E                ADDC     A,R6
B3:00C57F FA                MOV      R2,A
B3:00C580 A907              MOV      R1,AR7
B3:00C582 12EE4B            LCALL    ?L?COM051B
B3:00C585 903EC9            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B3:00C588 12EDF6            LCALL    ?L?COM04CE
B3:00C58B D001              POP      AR1
B3:00C58D D002              POP      AR2
B3:00C58F 12898D            LCALL    _ZW_AES_ecb
B3:00C592 71CB              ACALL    ?L?COM021A
B3:00C594 FF                MOV      R7,A
B3:00C595 12E77B            LCALL    _next_mpan_state
B3:00C598 71CB              ACALL    ?L?COM021A
B3:00C59A 2412              ADD      A,#012H
B3:00C59C 12B617            LCALL    ?L?COM0096
B3:00C59F 12EE2B            LCALL    ?L?COM0205
B3:00C5A2 C003              PUSH     AR3
B3:00C5A4 C002              PUSH     AR2
B3:00C5A6 C001              PUSH     AR1
B3:00C5A8 903543            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+03H
B3:00C5AB 12EDF6            LCALL    ?L?COM04CE
B3:00C5AE 7A32              MOV      R2,#HIGH aad
B3:00C5B0 7969              MOV      R1,#LOW aad
B3:00C5B2 903546            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+06H
B3:00C5B5 1225A9            LCALL    ?C?PSTXDATA
B3:00C5B8 9032A9            MOV      DPTR,#aad_len
B3:00C5BB 12E50A            LCALL    ?L?COM00B0
B3:00C5BE 903549            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+09H
B3:00C5C1 1224F1            LCALL    ?C?LSTXDATA
B3:00C5C4 9032BB            MOV      DPTR,#ciphertext
B3:00C5C7 12EE04            LCALL    ?L?COM053E
B3:00C5CA 9020ED            MOV      DPTR,#the_context+0DAH
B3:00C5CD E0                MOVX     A,@DPTR
B3:00C5CE FF                MOV      R7,A
B3:00C5CF A3                INC      DPTR
B3:00C5D0 E0                MOVX     A,@DPTR
B3:00C5D1 903550            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+010H
B3:00C5D4 CF                XCH      A,R7
B3:00C5D5 F0                MOVX     @DPTR,A
B3:00C5D6 A3                INC      DPTR
B3:00C5D7 EF                MOV      A,R7
B3:00C5D8 F0                MOVX     @DPTR,A
B3:00C5D9 D001              POP      AR1
B3:00C5DB D002              POP      AR2
B3:00C5DD D003              POP      AR3
B3:00C5DF 121B1A            LCALL    ?INTERBANK_TABLE?_CCM_encrypt_and_auth
;---- Variable 'msg_len' assigned to Register 'R6/R7' ----
B3:00C5E2 9032C0            MOV      DPTR,#msg
B3:00C5E5 122589            LCALL    ?C?PLDXDATA
B3:00C5E8 903F9F            MOV      DPTR,#?___S2_send_frame_multi?BYTE+03H
B3:00C5EB 1225A9            LCALL    ?C?PSTXDATA
B3:00C5EE 9032BF            MOV      DPTR,#hdr_len+01H
B3:00C5F1 E0                MOVX     A,@DPTR
B3:00C5F2 2F                ADD      A,R7
B3:00C5F3 FF                MOV      R7,A
B3:00C5F4 9032BE            MOV      DPTR,#hdr_len
B3:00C5F7 E0                MOVX     A,@DPTR
B3:00C5F8 3E                ADDC     A,R6
B3:00C5F9 903FA2            MOV      DPTR,#?___S2_send_frame_multi?BYTE+06H
B3:00C5FC 9104              ACALL    ?L?COM0127
B3:00C5FE 7A20              MOV      R2,#HIGH the_context+0CFH
B3:00C600 79E2              MOV      R1,#LOW the_context+0CFH
B3:00C602 12DEA8            LCALL    ___S2_send_frame_multi
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1007


B3:00C605 EF                MOV      A,R7
B3:00C606 7010              JNZ      ?C0060?S2
B3:00C608         ?C0058?S2:
B3:00C608 9032C6            MOV      DPTR,#e+03H
B3:00C60B 7402              MOV      A,#02H
B3:00C60D F0                MOVX     @DPTR,A
B3:00C60E 7B01              MOV      R3,#01H
B3:00C610 7A32              MOV      R2,#HIGH e
B3:00C612 79C3              MOV      R1,#LOW e
B3:00C614 FF                MOV      R7,A
B3:00C615 128E6A            LCALL    ___S2_fsm_post_event
B3:00C618         ?C0060?S2:
B3:00C618 22                RET      
----- FUNCTION __S2_encrypt_and_send_multi (END) -------


----- FUNCTION ___S2_add_mpan_extensions (BEGIN) -----
B3:00C619 903DC6            MOV      DPTR,#ext_data
B3:00C61C 1225A9            LCALL    ?C?PSTXDATA
B3:00C61F 903DCB            MOV      DPTR,#p
B3:00C622 1225A9            LCALL    ?C?PSTXDATA
B3:00C625 E4                CLR      A
B3:00C626 903DCA            MOV      DPTR,#k
B3:00C629 F0                MOVX     @DPTR,A
B3:00C62A 903DC9            MOV      DPTR,#i
B3:00C62D F0                MOVX     @DPTR,A
B3:00C62E         ?C0040?S2:
B3:00C62E 903DC9            MOV      DPTR,#i
B3:00C631 E0                MOVX     A,@DPTR
B3:00C632 FF                MOV      R7,A
B3:00C633 C3                CLR      C
B3:00C634 9403              SUBB     A,#03H
B3:00C636 4002              JC       $ + 4H
B3:00C638 C1B9              AJMP     ?C0041?S2
B3:00C63A EF                MOV      A,R7
B3:00C63B D1EC              ACALL    ?L?COM0108
B3:00C63D FF                MOV      R7,A
B3:00C63E 9020E3            MOV      DPTR,#the_context+0D0H
B3:00C641 E0                MOVX     A,@DPTR
B3:00C642 6F                XRL      A,R7
B3:00C643 706C              JNZ      ?C0042?S2
B3:00C645 09                INC      R1
B3:00C646 12EDFD            LCALL    ?L?COM053F
B3:00C649 D1F2              ACALL    ?L?COM0109
B3:00C64B FD                MOV      R5,A
B3:00C64C E4                CLR      A
B3:00C64D 1B                DEC      R3
B3:00C64E FF                MOV      R7,A
B3:00C64F F1B8              ACALL    ___find_mpan_by_group_id
B3:00C651 903DCE            MOV      DPTR,#mpan
B3:00C654 12EF29            LCALL    ?L?COM0217
B3:00C657 6058              JZ       ?C0042?S2
B3:00C659         ?C0044?S2:
B3:00C659 903DCA            MOV      DPTR,#k
B3:00C65C E0                MOVX     A,@DPTR
B3:00C65D 04                INC      A
B3:00C65E F0                MOVX     @DPTR,A
B3:00C65F A3                INC      DPTR
B3:00C660 71C4              ACALL    ?L?COM016B
B3:00C662 7413              MOV      A,#013H
B3:00C664 122072            LCALL    ?C?CSTPTR
B3:00C667 903DCB            MOV      DPTR,#p
B3:00C66A 71C4              ACALL    ?L?COM016B
B3:00C66C 74C2              MOV      A,#0C2H
B3:00C66E 122072            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1008


B3:00C671 7B01              MOV      R3,#01H
B3:00C673 791B              MOV      R1,#LOW the_context+0208H
B3:00C675 12EDFD            LCALL    ?L?COM053F
B3:00C678 D1F2              ACALL    ?L?COM0109
B3:00C67A FF                MOV      R7,A
B3:00C67B 903DCB            MOV      DPTR,#p
B3:00C67E 71C4              ACALL    ?L?COM016B
B3:00C680 EF                MOV      A,R7
B3:00C681 122072            LCALL    ?C?CSTPTR
B3:00C684 903DCE            MOV      DPTR,#mpan
B3:00C687 128518            LCALL    ?L?COM00FE
B3:00C68A FA                MOV      R2,A
B3:00C68B C003              PUSH     AR3
B3:00C68D C002              PUSH     AR2
B3:00C68F C001              PUSH     AR1
B3:00C691 903DCB            MOV      DPTR,#p
B3:00C694 12EE16            LCALL    ?L?COM0521
B3:00C697 D001              POP      AR1
B3:00C699 D002              POP      AR2
B3:00C69B D003              POP      AR3
B3:00C69D 12A7B3            LCALL    ?L?COM01B4
B3:00C6A0 7B01              MOV      R3,#01H
B3:00C6A2 7A22              MOV      R2,#HIGH the_context+0207H
B3:00C6A4 791A              MOV      R1,#LOW the_context+0207H
B3:00C6A6 903DC9            MOV      DPTR,#i
B3:00C6A9 E0                MOVX     A,@DPTR
B3:00C6AA 127100            LCALL    ?L?COM0272
B3:00C6AD E4                CLR      A
B3:00C6AE 122084            LCALL    ?C?CSTOPTR
B3:00C6B1         ?C0042?S2:
B3:00C6B1 903DC9            MOV      DPTR,#i
B3:00C6B4 E0                MOVX     A,@DPTR
B3:00C6B5 04                INC      A
B3:00C6B6 F0                MOVX     @DPTR,A
B3:00C6B7 C12E              AJMP     ?C0040?S2
B3:00C6B9         ?C0041?S2:
B3:00C6B9 903DCA            MOV      DPTR,#k
B3:00C6BC E0                MOVX     A,@DPTR
B3:00C6BD FF                MOV      R7,A
B3:00C6BE 6020              JZ       ?C0045?S2
B3:00C6C0 903DC6            MOV      DPTR,#ext_data
B3:00C6C3 122589            LCALL    ?C?PLDXDATA
B3:00C6C6 75F013            MOV      B,#013H
B3:00C6C9 EF                MOV      A,R7
B3:00C6CA 90FFEE            MOV      DPTR,#0FFEEH
B3:00C6CD 12257D            LCALL    ?C?OFFXADD
B3:00C6D0 E9                MOV      A,R1
B3:00C6D1 2582              ADD      A,DPL
B3:00C6D3 F9                MOV      R1,A
B3:00C6D4 EA                MOV      A,R2
B3:00C6D5 3583              ADDC     A,DPH
B3:00C6D7 FA                MOV      R2,A
B3:00C6D8 121FB3            LCALL    ?C?CLDPTR
B3:00C6DB 547F              ANL      A,#07FH
B3:00C6DD 122072            LCALL    ?C?CSTPTR
B3:00C6E0         ?C0045?S2:
B3:00C6E0 903DCA            MOV      DPTR,#k
B3:00C6E3 E0                MOVX     A,@DPTR
B3:00C6E4 75F013            MOV      B,#013H
B3:00C6E7 A4                MUL      AB
B3:00C6E8 FF                MOV      R7,A
B3:00C6E9 AEF0              MOV      R6,B
B3:00C6EB 22                RET      
----- FUNCTION ___S2_add_mpan_extensions (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1009



----- FUNCTION ?L?COM0108 (BEGIN) -----
B3:00C6EC 7B01              MOV      R3,#01H
B3:00C6EE 7A22              MOV      R2,#HIGH the_context+0207H
B3:00C6F0 791A              MOV      R1,#LOW the_context+0207H
B3:00C6F2         ?L?COM0109:
B3:00C6F2 75F002            MOV      B,#02H
B3:00C6F5         ?L?COM010A:
B3:00C6F5 A4                MUL      AB
B3:00C6F6 F582              MOV      DPL,A
B3:00C6F8 85F083            MOV      DPH,B
B3:00C6FB 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0108 (END) -------


----- FUNCTION ?L?COM04A9 (BEGIN) -----
B3:00C6FE 122589            LCALL    ?C?PLDXDATA
B3:00C701 9020E2            MOV      DPTR,#the_context+0CFH
B3:00C704 E0                MOVX     A,@DPTR
B3:00C705 FF                MOV      R7,A
----- FUNCTION ___S2_make_aad (BEGIN) -----
B3:00C706 903C4B            MOV      DPTR,#sender
B3:00C709 124765            LCALL    ?L?COM0102
B3:00C70C 1225A9            LCALL    ?C?PSTXDATA
B3:00C70F F19F              ACALL    ?L?COM03F1
B3:00C711 C3                CLR      C
B3:00C712 903C58            MOV      DPTR,#max_size+01H
B3:00C715 E0                MOVX     A,@DPTR
B3:00C716 9F                SUBB     A,R7
B3:00C717 903C57            MOV      DPTR,#max_size
B3:00C71A E0                MOVX     A,@DPTR
B3:00C71B 9E                SUBB     A,R6
B3:00C71C 5004              JNC      ?C0090?S2
B3:00C71E E4                CLR      A
B3:00C71F FE                MOV      R6,A
B3:00C720 FF                MOV      R7,A
B3:00C721 22                RET      
B3:00C722         ?C0090?S2:
B3:00C722 903C4B            MOV      DPTR,#sender
B3:00C725 E0                MOVX     A,@DPTR
B3:00C726 FF                MOV      R7,A
B3:00C727 903C54            MOV      DPTR,#aad
B3:00C72A 123F95            LCALL    ?L?COM00C0
B3:00C72D 903C4C            MOV      DPTR,#receiver
B3:00C730 E0                MOVX     A,@DPTR
B3:00C731 FF                MOV      R7,A
B3:00C732 903C54            MOV      DPTR,#aad
B3:00C735 122589            LCALL    ?C?PLDXDATA
B3:00C738 900001            MOV      DPTR,#01H
B3:00C73B F1AE              ACALL    ?L?COM02EE
B3:00C73D 7818              MOV      R0,#018H
B3:00C73F 1223E5            LCALL    ?C?ULSHR
B3:00C742 900002            MOV      DPTR,#02H
B3:00C745 F1AE              ACALL    ?L?COM02EE
B3:00C747 7810              MOV      R0,#010H
B3:00C749 1223E5            LCALL    ?C?ULSHR
B3:00C74C 900003            MOV      DPTR,#03H
B3:00C74F F1AE              ACALL    ?L?COM02EE
B3:00C751 7808              MOV      R0,#08H
B3:00C753 1223E5            LCALL    ?C?ULSHR
B3:00C756 900004            MOV      DPTR,#04H
B3:00C759 F1AE              ACALL    ?L?COM02EE
B3:00C75B 1271BB            LCALL    ?L?COM0361
B3:00C75E 903C52            MOV      DPTR,#msg_len
B3:00C761 1247B6            LCALL    ?L?COM031C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1010


B3:00C764 127301            LCALL    ?L?COM04C0
B3:00C767 122084            LCALL    ?C?CSTOPTR
B3:00C76A 903C51            MOV      DPTR,#hdr_len+01H
B3:00C76D E0                MOVX     A,@DPTR
B3:00C76E 24FE              ADD      A,#0FEH
B3:00C770 FF                MOV      R7,A
B3:00C771 903C50            MOV      DPTR,#hdr_len
B3:00C774 E0                MOVX     A,@DPTR
B3:00C775 34FF              ADDC     A,#0FFH
B3:00C777 FE                MOV      R6,A
B3:00C778 903C4D            MOV      DPTR,#msg
B3:00C77B 128518            LCALL    ?L?COM00FE
B3:00C77E FA                MOV      R2,A
B3:00C77F C003              PUSH     AR3
B3:00C781 C002              PUSH     AR2
B3:00C783 C001              PUSH     AR1
B3:00C785 903C54            MOV      DPTR,#aad
B3:00C788 122589            LCALL    ?C?PLDXDATA
B3:00C78B E9                MOV      A,R1
B3:00C78C 2408              ADD      A,#08H
B3:00C78E F9                MOV      R1,A
B3:00C78F E4                CLR      A
B3:00C790 3A                ADDC     A,R2
B3:00C791 A801              MOV      R0,AR1
B3:00C793 FC                MOV      R4,A
B3:00C794 AD03              MOV      R5,AR3
B3:00C796 D001              POP      AR1
B3:00C798 D002              POP      AR2
B3:00C79A D003              POP      AR3
B3:00C79C 121F8D            LCALL    ?C?COPY
B3:;----                  JMP      ?L?COM03F1
----- FUNCTION ___S2_make_aad (END) -------


----- FUNCTION ?L?COM03F1 (BEGIN) -----
B3:00C79F 903C51            MOV      DPTR,#hdr_len+01H
B3:00C7A2 E0                MOVX     A,@DPTR
B3:00C7A3 2406              ADD      A,#06H
B3:00C7A5 FF                MOV      R7,A
B3:00C7A6 903C50            MOV      DPTR,#hdr_len
B3:00C7A9 E0                MOVX     A,@DPTR
B3:00C7AA 3400              ADDC     A,#00H
B3:00C7AC FE                MOV      R6,A
B3:00C7AD 22                RET      
----- FUNCTION ?L?COM03F1 (END) -------


----- FUNCTION ?L?COM02EE (BEGIN) -----
B3:00C7AE EF                MOV      A,R7
B3:00C7AF 122084            LCALL    ?C?CSTOPTR
B3:00C7B2 9020DA            MOV      DPTR,#the_context+0C7H
B3:00C7B5 022499            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM02EE (END) -------


----- FUNCTION ___find_mpan_by_group_id (BEGIN) -----
B3:00C7B8 903A70            MOV      DPTR,#owner_id
B3:00C7BB 124765            LCALL    ?L?COM0102
B3:00C7BE EB                MOV      A,R3
B3:00C7BF F0                MOVX     @DPTR,A
B3:00C7C0 12C8D3            LCALL    ?L?COM0605
B3:00C7C3         ?C0001?S2:
B3:00C7C3 903A83            MOV      DPTR,#i
B3:00C7C6 1265F9            LCALL    ?L?COM0199
B3:00C7C9 9405              SUBB     A,#05H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1011


B3:00C7CB EE                MOV      A,R6
B3:00C7CC 6480              XRL      A,#080H
B3:00C7CE 9480              SUBB     A,#080H
B3:00C7D0 504A              JNC      ?C0002?S2
B3:00C7D2 12A6B5            LCALL    ?L?COM0195
B3:00C7D5 603D              JZ       ?C0003?S2
B3:00C7D7 7A21              MOV      R2,#HIGH the_context+01A4H
B3:00C7D9 79B7              MOV      R1,#LOW the_context+01A4H
B3:00C7DB 12C8E3            LCALL    ?L?COM0606
B3:00C7DE 12A6BD            LCALL    ?L?COM0197
B3:00C7E1 FD                MOV      R5,A
B3:00C7E2 903A71            MOV      DPTR,#group_id
B3:00C7E5 E0                MOVX     A,@DPTR
B3:00C7E6 6D                XRL      A,R5
B3:00C7E7 702B              JNZ      ?C0003?S2
B3:00C7E9 7A21              MOV      R2,#HIGH the_context+01A3H
B3:00C7EB 19                DEC      R1
B3:00C7EC 12A6BB            LCALL    ?L?COM0196
B3:00C7EF FF                MOV      R7,A
B3:00C7F0 903A70            MOV      DPTR,#owner_id
B3:00C7F3 E0                MOVX     A,@DPTR
B3:00C7F4 6F                XRL      A,R7
B3:00C7F5 701D              JNZ      ?C0003?S2
B3:00C7F7 7A21              MOV      R2,#HIGH the_context+01B5H
B3:00C7F9 79C8              MOV      R1,#LOW the_context+01B5H
B3:00C7FB 12C8E3            LCALL    ?L?COM0606
B3:00C7FE 12A6BD            LCALL    ?L?COM0197
B3:00C801 12C8EB            LCALL    ?L?COM0583
B3:00C804 8005              SJMP     ?C0264?S2
B3:00C806         ?C0263?S2:
B3:00C806 C3                CLR      C
B3:00C807 33                RLC      A
B3:00C808 CE                XCH      A,R6
B3:00C809 33                RLC      A
B3:00C80A CE                XCH      A,R6
B3:00C80B         ?C0264?S2:
B3:00C80B D8F9              DJNZ     R0,?C0263?S2
B3:00C80D 12C8F4            LCALL    ?L?COM05A0
B3:00C810 6002              JZ       ?C0003?S2
B3:00C812 01B0              AJMP     ?C0274?S2
B3:00C814         ?C0003?S2:
B3:00C814 903A83            MOV      DPTR,#i
B3:00C817 123F7F            LCALL    ?L?COM0081
B3:00C81A 80A7              SJMP     ?C0001?S2
B3:00C81C         ?C0002?S2:
B3:00C81C 903A72            MOV      DPTR,#create_new
B3:00C81F E0                MOVX     A,@DPTR
B3:00C820 7004              JNZ      ?C0006?S2
B3:00C822 FB                MOV      R3,A
B3:00C823 FA                MOV      R2,A
B3:00C824 F9                MOV      R1,A
B3:00C825 22                RET      
B3:00C826         ?C0006?S2:
B3:00C826 7B01              MOV      R3,#01H
B3:00C828 7A3A              MOV      R2,#HIGH rnd
B3:00C82A 7973              MOV      R1,#LOW rnd
B3:00C82C 12A58D            LCALL    ?L?COM015D
B3:00C82F 11D3              ACALL    ?L?COM0605
B3:00C831         ?C0007?S2:
B3:00C831 903A83            MOV      DPTR,#i
B3:00C834 1265F9            LCALL    ?L?COM0199
B3:00C837 9405              SUBB     A,#05H
B3:00C839 EE                MOV      A,R6
B3:00C83A 6480              XRL      A,#080H
B3:00C83C 9480              SUBB     A,#080H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1012


B3:00C83E 500D              JNC      ?C0008?S2
B3:00C840 12A6B5            LCALL    ?L?COM0195
B3:00C843 6008              JZ       ?C0008?S2
B3:00C845         ?C0010?S2:
B3:00C845         ?C0009?S2:
B3:00C845 903A83            MOV      DPTR,#i
B3:00C848 123F7F            LCALL    ?L?COM0081
B3:00C84B 80E4              SJMP     ?C0007?S2
B3:00C84D         ?C0008?S2:
B3:00C84D 903A83            MOV      DPTR,#i
B3:00C850 E0                MOVX     A,@DPTR
B3:00C851 7004              JNZ      ?C0265?S2
B3:00C853 A3                INC      DPTR
B3:00C854 E0                MOVX     A,@DPTR
B3:00C855 6405              XRL      A,#05H
B3:00C857         ?C0265?S2:
B3:00C857 7009              JNZ      ?C0011?S2
B3:00C859 903A73            MOV      DPTR,#rnd
B3:00C85C E0                MOVX     A,@DPTR
B3:00C85D 903A83            MOV      DPTR,#i
B3:00C860 11FD              ACALL    ?L?COM04AA
B3:00C862         ?C0011?S2:
B3:00C862 903A70            MOV      DPTR,#owner_id
B3:00C865 E0                MOVX     A,@DPTR
B3:00C866 FF                MOV      R7,A
B3:00C867 7E01              MOV      R6,#01H
B3:00C869 6002              JZ       ?C0012?S2
B3:00C86B 7E02              MOV      R6,#02H
B3:00C86D         ?C0012?S2:
B3:00C86D         ?C0013?S2:
B3:00C86D 7B01              MOV      R3,#01H
B3:00C86F 7A21              MOV      R2,#HIGH the_context+01B6H
B3:00C871 79C9              MOV      R1,#LOW the_context+01B6H
B3:00C873 903A83            MOV      DPTR,#i
B3:00C876 12515D            LCALL    ?L?COM0154
B3:00C879 11CA              ACALL    ?L?COM04EE
B3:00C87B 903A71            MOV      DPTR,#group_id
B3:00C87E E0                MOVX     A,@DPTR
B3:00C87F FE                MOV      R6,A
B3:00C880 7A21              MOV      R2,#HIGH the_context+01A4H
B3:00C882 79B7              MOV      R1,#LOW the_context+01A4H
B3:00C884 8D82              MOV      DPL,R5
B3:00C886 8C83              MOV      DPH,R4
B3:00C888 11CA              ACALL    ?L?COM04EE
B3:00C88A 7A21              MOV      R2,#HIGH the_context+01A3H
B3:00C88C 19                DEC      R1
B3:00C88D 12A6DD            LCALL    ?L?COM0338
B3:00C890 9020E9            MOV      DPTR,#the_context+0D6H
B3:00C893 E0                MOVX     A,@DPTR
B3:00C894 FF                MOV      R7,A
B3:00C895 7A21              MOV      R2,#HIGH the_context+01B5H
B3:00C897 79C8              MOV      R1,#LOW the_context+01B5H
B3:00C899 12A6DD            LCALL    ?L?COM0338
B3:00C89C 903A83            MOV      DPTR,#i
B3:00C89F E0                MOVX     A,@DPTR
B3:00C8A0 FE                MOV      R6,A
B3:00C8A1 7D14              MOV      R5,#014H
B3:00C8A3 11DB              ACALL    ?L?COM041D
B3:00C8A5 74B8              MOV      A,#LOW the_context+01A5H
B3:00C8A7 2F                ADD      A,R7
B3:00C8A8 F9                MOV      R1,A
B3:00C8A9 7421              MOV      A,#HIGH the_context+01A5H
B3:00C8AB 3E                ADDC     A,R6
B3:00C8AC FA                MOV      R2,A
B3:00C8AD 12A58D            LCALL    ?L?COM015D
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1013


B3:00C8B0         
B3:00C8B0 903A83            MOV      DPTR,#i
B3:00C8B3 E0                MOVX     A,@DPTR
B3:00C8B4 FE                MOV      R6,A
B3:00C8B5 A3                INC      DPTR
B3:00C8B6 E0                MOVX     A,@DPTR
B3:00C8B7 FF                MOV      R7,A
B3:00C8B8 7C00              MOV      R4,#00H
B3:00C8BA 7D14              MOV      R5,#014H
B3:00C8BC 1220A6            LCALL    ?C?IMUL
B3:00C8BF 7B01              MOV      R3,#01H
B3:00C8C1 74B6              MOV      A,#LOW the_context+01A3H
B3:00C8C3 2F                ADD      A,R7
B3:00C8C4 F9                MOV      R1,A
B3:00C8C5 7421              MOV      A,#HIGH the_context+01A3H
B3:00C8C7 3E                ADDC     A,R6
B3:00C8C8 FA                MOV      R2,A
B3:00C8C9 22                RET      
----- FUNCTION ___find_mpan_by_group_id (END) -------


----- FUNCTION ?L?COM04EE (BEGIN) -----
B3:00C8CA 7414              MOV      A,#014H
B3:00C8CC 12256C            LCALL    ?C?OFFX256
B3:00C8CF EE                MOV      A,R6
B3:00C8D0 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM04EE (END) -------


----- FUNCTION ?L?COM0605 (BEGIN) -----
B3:00C8D3 E4                CLR      A
B3:00C8D4 903A83            MOV      DPTR,#i
B3:00C8D7 F0                MOVX     @DPTR,A
B3:00C8D8 A3                INC      DPTR
B3:00C8D9 F0                MOVX     @DPTR,A
B3:00C8DA 22                RET      
----- FUNCTION ?L?COM0605 (END) -------


----- FUNCTION ?L?COM041D (BEGIN) -----
B3:00C8DB A3                INC      DPTR
B3:00C8DC E0                MOVX     A,@DPTR
B3:00C8DD FF                MOV      R7,A
B3:00C8DE 7C00              MOV      R4,#00H
B3:00C8E0 0220A6            LJMP     ?C?IMUL
----- FUNCTION ?L?COM041D (END) -------


----- FUNCTION ?L?COM0606 (BEGIN) -----
B3:00C8E3 903A83            MOV      DPTR,#i
B3:00C8E6 A3                INC      DPTR
B3:00C8E7 E0                MOVX     A,@DPTR
B3:00C8E8 F582              MOV      DPL,A
B3:00C8EA 22                RET      
----- FUNCTION ?L?COM0606 (END) -------


----- FUNCTION ?L?COM0583 (BEGIN) -----
B3:00C8EB FF                MOV      R7,A
B3:00C8EC 7401              MOV      A,#01H
B3:00C8EE 7E00              MOV      R6,#00H
B3:00C8F0 A807              MOV      R0,AR7
B3:00C8F2 08                INC      R0
B3:00C8F3 22                RET      
----- FUNCTION ?L?COM0583 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1014




----- FUNCTION ?L?COM05A0 (BEGIN) -----
B3:00C8F4 FF                MOV      R7,A
B3:00C8F5 9020D9            MOV      DPTR,#the_context+0C6H
B3:00C8F8 E0                MOVX     A,@DPTR
B3:00C8F9 FD                MOV      R5,A
B3:00C8FA EF                MOV      A,R7
B3:00C8FB 5D                ANL      A,R5
B3:00C8FC 22                RET      
----- FUNCTION ?L?COM05A0 (END) -------


----- FUNCTION ?L?COM04AA (BEGIN) -----
B3:00C8FD 75F005            MOV      B,#05H
B3:00C900 84                DIV      AB
B3:00C901 AFF0              MOV      R7,B
B3:00C903 E4                CLR      A
B3:00C904 F0                MOVX     @DPTR,A
B3:00C905 A3                INC      DPTR
B3:00C906 EF                MOV      A,R7
B3:00C907 F0                MOVX     @DPTR,A
B3:00C908 22                RET      
----- FUNCTION ?L?COM04AA (END) -------


----- FUNCTION ?L?COM040B (BEGIN) -----
B3:00C909 241E              ADD      A,#01EH
B3:00C90B         ?L?COM040C:
B3:00C90B F9                MOV      R1,A
B3:00C90C E4                CLR      A
B3:00C90D 3A                ADDC     A,R2
B3:00C90E FA                MOV      R2,A
B3:00C90F E4                CLR      A
B3:00C910 F5F0              MOV      B,A
B3:00C912 22                RET      
----- FUNCTION ?L?COM040B (END) -------


----- FUNCTION _ZW_CreateCrc16 (BEGIN) -----
;---- Variable 'bHeaderLen' assigned to Register 'R5' ----
;---- Variable 'pHeaderAddr' assigned to Register 'R1/R2/R3' ----
;---- Variable 'crc' assigned to Register 'R6/R7' ----
B3:00C913 7F0F              MOV      R7,#0FH
B3:00C915 7E1D              MOV      R6,#01DH
B3:00C917 12C45D            LCALL    ?L?COM02A6
B3:00C91A 903F80            MOV      DPTR,#pPayloadAddr
B3:00C91D 122589            LCALL    ?C?PLDXDATA
B3:00C920 903F83            MOV      DPTR,#bPayloadLen
B3:00C923 E0                MOVX     A,@DPTR
B3:00C924 FD                MOV      R5,A
B3:00C925 02C45D            LJMP     ?L?COM02A6
----- FUNCTION _ZW_CreateCrc16 (END) -------


----- FUNCTION ExtMemoryWriteBusy (BEGIN) -----
B3:00C928 023A49            LJMP     NVM_ext_busy
----- FUNCTION ExtMemoryWriteBusy (END) -------


----- FUNCTION MemoryGetStatus (BEGIN) -----
B3:00C92B 026DFA            LJMP     NVM_ext_read_status
----- FUNCTION MemoryGetStatus (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1015


----- FUNCTION MemoryClearStatus (BEGIN) -----
B3:00C92E 026E00            LJMP     NVM_ext_clear_status
----- FUNCTION MemoryClearStatus (END) -------


----- FUNCTION _ZW_EepromInit (BEGIN) -----
B3:00C931 E4                CLR      A
B3:00C932 90434A            MOV      DPTR,#offes
B3:00C935 F0                MOVX     @DPTR,A
B3:00C936 A3                INC      DPTR
B3:00C937 F0                MOVX     @DPTR,A
B3:00C938 203702            JB       productionTest,?C0003?ZW_MEM_SUPPORT
B3:00C93B C3                CLR      C
B3:00C93C 22                RET      
B3:00C93D         ?C0003?ZW_MEM_SUPPORT:
B3:00C93D 90434A            MOV      DPTR,#offes
B3:00C940 1265F9            LCALL    ?L?COM0199
B3:00C943 EE                MOV      A,R6
B3:00C944 9440              SUBB     A,#040H
B3:00C946 501B              JNC      ?C0004?ZW_MEM_SUPPORT
B3:00C948 12BDF8            LCALL    ?L?COM0032
B3:00C94B 90402D            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B3:00C94E E4                CLR      A
B3:00C94F F0                MOVX     @DPTR,A
B3:00C950 A3                INC      DPTR
B3:00C951 7420              MOV      A,#020H
B3:00C953 F0                MOVX     @DPTR,A
B3:00C954 126C78            LCALL    _NVM_ext_write_buffer
B3:00C957 90434A            MOV      DPTR,#offes
B3:00C95A E4                CLR      A
B3:00C95B 75F020            MOV      B,#020H
B3:00C95E 122143            LCALL    ?C?IILDX
B3:00C961 80DA              SJMP     ?C0003?ZW_MEM_SUPPORT
B3:00C963         ?C0004?ZW_MEM_SUPPORT:
B3:00C963 D3                SETB     C
B3:00C964 22                RET      
----- FUNCTION _ZW_EepromInit (END) -------


----- FUNCTION _ZW_NodeMaskGetNextNode (BEGIN) -----
;---- Variable 'currentNodeId' assigned to Register 'R7' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00C965         ?C0018?ZW_NODEMASK:
B3:00C965 EF                MOV      A,R7
B3:00C966 C3                CLR      C
B3:00C967 94E8              SUBB     A,#0E8H
B3:00C969 5024              JNC      ?C0019?ZW_NODEMASK
B3:00C96B EF                MOV      A,R7
B3:00C96C 13                RRC      A
B3:00C96D 13                RRC      A
B3:00C96E 13                RRC      A
B3:00C96F 541F              ANL      A,#01FH
B3:00C971 F582              MOV      DPL,A
B3:00C973 1289F4            LCALL    ?L?COM00E4
B3:00C976 FE                MOV      R6,A
B3:00C977 EF                MOV      A,R7
B3:00C978 5407              ANL      A,#07H
B3:00C97A FD                MOV      R5,A
B3:00C97B EE                MOV      A,R6
B3:00C97C A805              MOV      R0,AR5
B3:00C97E 08                INC      R0
B3:00C97F 8002              SJMP     ?C0029?ZW_NODEMASK
B3:00C981         ?C0028?ZW_NODEMASK:
B3:00C981 C3                CLR      C
B3:00C982 13                RRC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1016


B3:00C983         ?C0029?ZW_NODEMASK:
B3:00C983 D8FC              DJNZ     R0,?C0028?ZW_NODEMASK
B3:00C985 30E004            JNB      ACC.0,?C0020?ZW_NODEMASK
B3:00C988 EF                MOV      A,R7
B3:00C989 04                INC      A
B3:00C98A FF                MOV      R7,A
B3:00C98B 22                RET      
B3:00C98C         ?C0020?ZW_NODEMASK:
B3:00C98C 0F                INC      R7
B3:00C98D 80D6              SJMP     ?C0018?ZW_NODEMASK
B3:00C98F         ?C0019?ZW_NODEMASK:
B3:00C98F 7F00              MOV      R7,#00H
B3:00C991 22                RET      
----- FUNCTION _ZW_NodeMaskGetNextNode (END) -------


----- FUNCTION _MemoryPutBuffer (BEGIN) -----
;---- Variable 'buffer' assigned to Register 'R1/R2/R3' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:00C992 903E15            MOV      DPTR,#length
B3:00C995 E0                MOVX     A,@DPTR
B3:00C996 FD                MOV      R5,A
B3:00C997 A3                INC      DPTR
B3:00C998 E0                MOVX     A,@DPTR
B3:00C999 904057            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B3:00C99C CD                XCH      A,R5
B3:00C99D F0                MOVX     @DPTR,A
B3:00C99E A3                INC      DPTR
B3:00C99F ED                MOV      A,R5
B3:00C9A0 F0                MOVX     @DPTR,A
B3:00C9A1 12896D            LCALL    _ZW_MemoryPutBuffer
B3:00C9A4 903E19            MOV      DPTR,#retVal
B3:00C9A7 EF                MOV      A,R7
B3:00C9A8 F0                MOVX     @DPTR,A
B3:00C9A9 903E17            MOV      DPTR,#func
B3:00C9AC 12A790            LCALL    ?L?COM0098
B3:00C9AF 6003              JZ       ?C0001?ZW_MEM_API
B3:00C9B1 124774            LCALL    ?L?COM0304
B3:00C9B4         ?C0001?ZW_MEM_API:
B3:00C9B4 903E19            MOV      DPTR,#retVal
B3:00C9B7 E0                MOVX     A,@DPTR
B3:00C9B8 FF                MOV      R7,A
B3:00C9B9 22                RET      
----- FUNCTION _MemoryPutBuffer (END) -------


----- FUNCTION _ZCB_fc_timer_expired (BEGIN) -----
B3:00C9BA 9029E1            MOV      DPTR,#scb+02CH
B3:00C9BD E0                MOVX     A,@DPTR
B3:00C9BE 601B              JZ       ?C0029?TRANSPORT_SERVICE2
B3:00C9C0 12BDCE            LCALL    ?L?COM038C
B3:00C9C3 E4                CLR      A
B3:00C9C4 9029E1            MOV      DPTR,#scb+02CH
B3:00C9C7 F0                MOVX     @DPTR,A
B3:00C9C8 902A2E            MOV      DPTR,#scb+079H
B3:00C9CB F0                MOVX     @DPTR,A
B3:00C9CC 7F20              MOV      R7,#020H
B3:00C9CE 12BD5A            LCALL    _t2_sm_post_event
B3:00C9D1 9029C4            MOV      DPTR,#scb+0FH
B3:00C9D4 12A790            LCALL    ?L?COM0098
B3:00C9D7 6042              JZ       ?C0031?TRANSPORT_SERVICE2
B3:00C9D9 800E              SJMP     ?C0206?TRANSPORT_SERVICE2
B3:00C9DB         ?C0029?TRANSPORT_SERVICE2:
B3:00C9DB 12D43C            LCALL    ?L?COM053A
B3:00C9DE B5070F            CJNE     A,AR7,?C0032?TRANSPORT_SERVICE2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1017


B3:00C9E1 9029C4            MOV      DPTR,#scb+0FH
B3:00C9E4 12A790            LCALL    ?L?COM0098
B3:00C9E7 6032              JZ       ?C0031?TRANSPORT_SERVICE2
B3:00C9E9         
B3:00C9E9 511C              ACALL    ?L?COM0156
B3:00C9EB 7F02              MOV      R7,#02H
B3:00C9ED 02271A            LJMP     ?C?ICALL2
B3:00C9F0         ?C0032?TRANSPORT_SERVICE2:
B3:00C9F0 902A2D            MOV      DPTR,#scb+078H
B3:00C9F3 E0                MOVX     A,@DPTR
B3:00C9F4 6018              JZ       ?C0034?TRANSPORT_SERVICE2
B3:00C9F6 E4                CLR      A
B3:00C9F7 F0                MOVX     @DPTR,A
B3:00C9F8 A3                INC      DPTR
B3:00C9F9 F0                MOVX     @DPTR,A
B3:00C9FA 9029C4            MOV      DPTR,#scb+0FH
B3:00C9FD 12A790            LCALL    ?L?COM0098
B3:00CA00 6007              JZ       ?C0035?TRANSPORT_SERVICE2
B3:00CA02 511C              ACALL    ?L?COM0156
B3:00CA04 7F02              MOV      R7,#02H
B3:00CA06 12271A            LCALL    ?C?ICALL2
B3:00CA09         ?C0035?TRANSPORT_SERVICE2:
B3:00CA09 7F1F              MOV      R7,#01FH
B3:00CA0B 02BD5A            LJMP     _t2_sm_post_event
B3:00CA0E         ?C0034?TRANSPORT_SERVICE2:
B3:00CA0E 7F1E              MOV      R7,#01EH
B3:00CA10 12BD5A            LCALL    _t2_sm_post_event
B3:00CA13 902A2D            MOV      DPTR,#scb+078H
B3:00CA16 E0                MOVX     A,@DPTR
B3:00CA17 04                INC      A
B3:00CA18 F0                MOVX     @DPTR,A
B3:00CA19 714E              ACALL    send_last_frag
B3:00CA1B         ?C0031?TRANSPORT_SERVICE2:
B3:00CA1B 22                RET      
----- FUNCTION _ZCB_fc_timer_expired (END) -------


----- FUNCTION ?L?COM0156 (BEGIN) -----
B3:00CA1C 7B01              MOV      R3,#01H
B3:00CA1E 7A29              MOV      R2,#HIGH scb+011H
B3:00CA20 79C6              MOV      R1,#LOW scb+011H
B3:00CA22 8F82              MOV      DPL,R7
B3:00CA24 8E83              MOV      DPH,R6
B3:00CA26 22                RET      
----- FUNCTION ?L?COM0156 (END) -------


----- FUNCTION ___S2_send_nonce_report (BEGIN) -----
B3:00CA27 90394A            MOV      DPTR,#conn
B3:00CA2A 1225A9            LCALL    ?C?PSTXDATA
B3:00CA2D 90394D            MOV      DPTR,#flags
B3:00CA30 ED                MOV      A,R5
B3:00CA31 F0                MOVX     @DPTR,A
B3:00CA32 7B01              MOV      R3,#01H
B3:00CA34 7A22              MOV      R2,#HIGH the_context+0211H
B3:00CA36 7924              MOV      R1,#LOW the_context+0211H
B3:00CA38 903961            MOV      DPTR,#nonce_report
B3:00CA3B 1225A9            LCALL    ?C?PSTXDATA
B3:00CA3E 90394A            MOV      DPTR,#conn
B3:00CA41 12EEDA            LCALL    ?L?COM04DF
B3:00CA44 7B01              MOV      R3,#01H
B3:00CA46 90394E            MOV      DPTR,#span
B3:00CA49 1225A9            LCALL    ?C?PSTXDATA
B3:00CA4C 903961            MOV      DPTR,#nonce_report
B3:00CA4F 12C44C            LCALL    ?L?COM0431
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1018


B3:00CA52 903961            MOV      DPTR,#nonce_report
B3:00CA55 122589            LCALL    ?C?PLDXDATA
B3:00CA58 1271FE            LCALL    ?L?COM039A
B3:00CA5B 90394D            MOV      DPTR,#flags
B3:00CA5E E0                MOVX     A,@DPTR
B3:00CA5F FF                MOV      R7,A
B3:00CA60 12716F            LCALL    ?L?COM0313
B3:00CA63 90394E            MOV      DPTR,#span
B3:00CA66 12E334            LCALL    ?L?COM0376
B3:00CA69 FE                MOV      R6,A
B3:00CA6A 903961            MOV      DPTR,#nonce_report
B3:00CA6D 127358            LCALL    ?L?COM0515
B3:00CA70 EE                MOV      A,R6
B3:00CA71 122084            LCALL    ?C?CSTOPTR
B3:00CA74 EF                MOV      A,R7
B3:00CA75 30E039            JNB      ACC.0,?C0075?S2
B3:00CA78 90394E            MOV      DPTR,#span
B3:00CA7B 129C6A            LCALL    ?L?COM01CD
B3:00CA7E 7403              MOV      A,#03H
B3:00CA80 122084            LCALL    ?C?CSTOPTR
B3:00CA83 7A39              MOV      R2,#HIGH rnd
B3:00CA85 7951              MOV      R1,#LOW rnd
B3:00CA87 12A58B            LCALL    ?L?COM015C
B3:00CA8A 90394E            MOV      DPTR,#span
B3:00CA8D 12708F            LCALL    ?L?COM0149
B3:00CA90 7A39              MOV      R2,#HIGH rnd
B3:00CA92 7951              MOV      R1,#LOW rnd
B3:00CA94 12A7B3            LCALL    ?L?COM01B4
B3:00CA97 903961            MOV      DPTR,#nonce_report
B3:00CA9A 122589            LCALL    ?C?PLDXDATA
B3:00CA9D E9                MOV      A,R1
B3:00CA9E 2404              ADD      A,#04H
B3:00CAA0 F9                MOV      R1,A
B3:00CAA1 E4                CLR      A
B3:00CAA2 3A                ADDC     A,R2
B3:00CAA3 A801              MOV      R0,AR1
B3:00CAA5 FC                MOV      R4,A
B3:00CAA6 AD03              MOV      R5,AR3
B3:00CAA8 90394E            MOV      DPTR,#span
B3:00CAAB 122589            LCALL    ?C?PLDXDATA
B3:00CAAE 12A7B3            LCALL    ?L?COM01B4
B3:00CAB1         ?C0075?S2:
B3:00CAB1 90394E            MOV      DPTR,#span
B3:00CAB4 122589            LCALL    ?C?PLDXDATA
B3:00CAB7 900024            MOV      DPTR,#024H
B3:00CABA 7401              MOV      A,#01H
B3:00CABC 12203F            LCALL    ?C?CILDOPTR
B3:00CABF 903961            MOV      DPTR,#nonce_report
B3:00CAC2 12C454            LCALL    ?L?COM04FC
B3:00CAC5 903961            MOV      DPTR,#nonce_report
B3:00CAC8 1291A1            LCALL    ?L?COM004B
B3:00CACB 7E00              MOV      R6,#00H
B3:00CACD 30E004            JNB      ACC.0,?C0076?S2
B3:00CAD0 7F14              MOV      R7,#014H
B3:00CAD2 8002              SJMP     ?C0077?S2
B3:00CAD4         ?C0076?S2:
B3:00CAD4 7F04              MOV      R7,#04H
B3:00CAD6         ?C0077?S2:
B3:00CAD6 903F9A            MOV      DPTR,#?___S2_send_frame?BYTE+06H
B3:00CAD9 EE                MOV      A,R6
B3:00CADA F0                MOVX     @DPTR,A
B3:00CADB A3                INC      DPTR
B3:00CADC EF                MOV      A,R7
B3:00CADD F0                MOVX     @DPTR,A
B3:00CADE 90394A            MOV      DPTR,#conn
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1019


B3:00CAE1 122589            LCALL    ?C?PLDXDATA
B3:;----                  JMP      ___S2_send_frame
----- FUNCTION ___S2_send_nonce_report (END) -------


----- FUNCTION ___S2_send_frame (BEGIN) -----
B3:00CAE4 903F94            MOV      DPTR,#conn
B3:00CAE7 1225A9            LCALL    ?C?PSTXDATA
B3:00CAEA 7B01              MOV      R3,#01H
B3:00CAEC 7A34              MOV      R2,#HIGH txo
B3:00CAEE 79CE              MOV      R1,#LOW txo
B3:00CAF0 7D06              MOV      R5,#06H
B3:00CAF2 E4                CLR      A
B3:00CAF3 FF                MOV      R7,A
B3:00CAF4 1299EF            LCALL    ___ZW_memset
B3:00CAF7 903F94            MOV      DPTR,#conn
B3:00CAFA 122589            LCALL    ?C?PLDXDATA
B3:00CAFD 121FB3            LCALL    ?C?CLDPTR
B3:00CB00 9034CF            MOV      DPTR,#txo+01H
B3:00CB03 F0                MOVX     @DPTR,A
B3:00CB04 E9                MOV      A,R1
B3:00CB05 2401              ADD      A,#01H
B3:00CB07 125510            LCALL    ?L?COM000B
B3:00CB0A 9034CE            MOV      DPTR,#txo
B3:00CB0D F0                MOVX     @DPTR,A
B3:00CB0E 903F94            MOV      DPTR,#conn
B3:00CB11 122589            LCALL    ?C?PLDXDATA
B3:00CB14 E9                MOV      A,R1
B3:00CB15 2404              ADD      A,#04H
B3:00CB17 125510            LCALL    ?L?COM000B
B3:00CB1A 9034D0            MOV      DPTR,#txo+02H
B3:00CB1D F0                MOVX     @DPTR,A
B3:00CB1E 9034D3            MOV      DPTR,#txo+05H
B3:00CB21 7401              MOV      A,#01H
B3:00CB23 F0                MOVX     @DPTR,A
B3:00CB24 903F9A            MOV      DPTR,#len
B3:00CB27 A3                INC      DPTR
B3:00CB28 7A34              MOV      R2,#HIGH txo
B3:00CB2A 79CE              MOV      R1,#LOW txo
B3:00CB2C 127047            LCALL    ?L?COM00AD
B3:00CB2F 12EECF            LCALL    ?L?COM04CA
B3:00CB32 903F97            MOV      DPTR,#buf
B3:00CB35 122589            LCALL    ?C?PLDXDATA
B3:00CB38 021980            LJMP     ?INTERBANK_TABLE?_ZW_SendDataEx
----- FUNCTION ___S2_send_frame (END) -------


----- FUNCTION _ZW_NodeMaskSetBit (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00CB3B 91C2              ACALL    ?L?COM04AE
B3:00CB3D 29                ADD      A,R1
B3:00CB3E 125510            LCALL    ?L?COM000B
B3:00CB41 91D4              ACALL    ?L?COM0513
B3:00CB43 08                INC      R0
B3:00CB44 8002              SJMP     ?C0023?ZW_NODEMASK
B3:00CB46         ?C0022?ZW_NODEMASK:
B3:00CB46 C3                CLR      C
B3:00CB47 33                RLC      A
B3:00CB48         ?C0023?ZW_NODEMASK:
B3:00CB48 D8FC              DJNZ     R0,?C0022?ZW_NODEMASK
B3:00CB4A 4F                ORL      A,R7
B3:00CB4B 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_NodeMaskSetBit (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1020



----- FUNCTION send_last_frag (BEGIN) -----
B3:00CB4E E4                CLR      A
B3:00CB4F 904397            MOV      DPTR,#ret
B3:00CB52 F0                MOVX     @DPTR,A
B3:00CB53 12BE07            LCALL    ?L?COM0331
B3:00CB56 12BDEE            LCALL    ?L?COM0030
B3:00CB59 12BDA7            LCALL    ?L?COM0083
B3:00CB5C E4                CLR      A
B3:00CB5D 9029E0            MOV      DPTR,#scb+02BH
B3:00CB60 F0                MOVX     @DPTR,A
B3:00CB61 9029DA            MOV      DPTR,#scb+025H
B3:00CB64 F0                MOVX     @DPTR,A
B3:00CB65 902A2F            MOV      DPTR,#scb+07AH
B3:00CB68 E0                MOVX     A,@DPTR
B3:00CB69 91CA              ACALL    ?L?COM0329
B3:00CB6B 6006              JZ       ?C0038?TRANSPORT_SERVICE2
B3:00CB6D A3                INC      DPTR
B3:00CB6E E0                MOVX     A,@DPTR
B3:00CB6F 2407              ADD      A,#07H
B3:00CB71 8004              SJMP     ?C0207?TRANSPORT_SERVICE2
B3:00CB73         ?C0038?TRANSPORT_SERVICE2:
B3:00CB73 A3                INC      DPTR
B3:00CB74 E0                MOVX     A,@DPTR
B3:00CB75 2406              ADD      A,#06H
B3:00CB77         
B3:00CB77 71C9              ACALL    ?L?COM0139
B3:00CB79 A3                INC      DPTR
B3:00CB7A 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_temp_callback_last_frag
B3:00CB7C F0                MOVX     @DPTR,A
B3:00CB7D A3                INC      DPTR
B3:00CB7E 7481              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_temp_callback_last_frag
B3:00CB80 B1E4              ACALL    ?L?COM019B
B3:00CB82 904397            MOV      DPTR,#ret
B3:00CB85 F0                MOVX     @DPTR,A
B3:00CB86         ?C0039?TRANSPORT_SERVICE2:
B3:00CB86 904397            MOV      DPTR,#ret
B3:00CB89 E0                MOVX     A,@DPTR
B3:00CB8A 7013              JNZ      ?C0040?TRANSPORT_SERVICE2
B3:00CB8C 9029C4            MOV      DPTR,#scb+0FH
B3:00CB8F 12A790            LCALL    ?L?COM0098
B3:00CB92 6007              JZ       ?C0041?TRANSPORT_SERVICE2
B3:00CB94 511C              ACALL    ?L?COM0156
B3:00CB96 7F02              MOV      R7,#02H
B3:00CB98 12271A            LCALL    ?C?ICALL2
B3:00CB9B         ?C0041?TRANSPORT_SERVICE2:
B3:00CB9B 7F21              MOV      R7,#021H
B3:00CB9D 8023              SJMP     ?C0209?TRANSPORT_SERVICE2
B3:00CB9F         ?C0040?TRANSPORT_SERVICE2:
B3:00CB9F 9029C1            MOV      DPTR,#scb+0CH
B3:00CBA2 E0                MOVX     A,@DPTR
B3:00CBA3 6404              XRL      A,#04H
B3:00CBA5 6007              JZ       ?C0044?TRANSPORT_SERVICE2
B3:00CBA7 9029BE            MOV      DPTR,#scb+09H
B3:00CBAA E0                MOVX     A,@DPTR
B3:00CBAB B4FF04            CJNE     A,#0FFH,?C0043?TRANSPORT_SERVICE2
B3:00CBAE         ?C0044?TRANSPORT_SERVICE2:
B3:00CBAE 7F0A              MOV      R7,#0AH
B3:00CBB0         
B3:00CBB0 8010              SJMP     ?C0209?TRANSPORT_SERVICE2
B3:00CBB2         ?C0043?TRANSPORT_SERVICE2:
B3:00CBB2 91E8              ACALL    ?L?COM0537
B3:00CBB4 12BDF7            LCALL    ?L?COM0031
B3:00CBB7 91DE              ACALL    ?L?COM0517
B3:00CBB9 7FE8              MOV      R7,#0E8H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1021


B3:00CBBB 7E03              MOV      R6,#03H
B3:00CBBD 12BDB4            LCALL    ?L?COM0084
B3:00CBC0 7F05              MOV      R7,#05H
B3:00CBC2         
B3:00CBC2 02BD5A            LJMP     _t2_sm_post_event
----- FUNCTION send_last_frag (END) -------


----- FUNCTION ?L?COM0138 (BEGIN) -----
B3:00CBC5 A3                INC      DPTR
B3:00CBC6 E0                MOVX     A,@DPTR
B3:00CBC7 2407              ADD      A,#07H
B3:00CBC9         ?L?COM0139:
B3:00CBC9 903FD8            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
B3:00CBCC F0                MOVX     @DPTR,A
B3:00CBCD 9029C1            MOV      DPTR,#scb+0CH
B3:00CBD0         ?L?COM013A:
B3:00CBD0 E0                MOVX     A,@DPTR
B3:00CBD1 4401              ORL      A,#01H
B3:00CBD3 903FD9            MOV      DPTR,#?_TS_SendRaw?BYTE+05H
B3:00CBD6 F0                MOVX     @DPTR,A
B3:00CBD7 22                RET      
----- FUNCTION ?L?COM0138 (END) -------


----- FUNCTION _ZW_NodeMaskClearBit (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00CBD8 91C2              ACALL    ?L?COM04AE
B3:00CBDA 29                ADD      A,R1
B3:00CBDB 125510            LCALL    ?L?COM000B
B3:00CBDE 91D4              ACALL    ?L?COM0513
B3:00CBE0 08                INC      R0
B3:00CBE1 8002              SJMP     ?C0025?ZW_NODEMASK
B3:00CBE3         ?C0024?ZW_NODEMASK:
B3:00CBE3 C3                CLR      C
B3:00CBE4 33                RLC      A
B3:00CBE5         ?C0025?ZW_NODEMASK:
B3:00CBE5 D8FC              DJNZ     R0,?C0024?ZW_NODEMASK
B3:00CBE7 F4                CPL      A
B3:00CBE8 5F                ANL      A,R7
B3:00CBE9 022072            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_NodeMaskClearBit (END) -------


----- FUNCTION _reply_frag_req (BEGIN) -----
B3:00CBEC 12BE30            LCALL    ?L?COM0203
B3:00CBEF E0                MOVX     A,@DPTR
B3:00CBF0 6401              XRL      A,#01H
B3:00CBF2 7002              JNZ      $ + 4H
B3:00CBF4 81B9              AJMP     ?C0080?TRANSPORT_SERVICE2
B3:00CBF6         ?C0079?TRANSPORT_SERVICE2:
B3:00CBF6 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CBF9 E0                MOVX     A,@DPTR
B3:00CBFA FF                MOV      R7,A
B3:00CBFB 9029B5            MOV      DPTR,#scb
B3:00CBFE E4                CLR      A
B3:00CBFF 12ECCB            LCALL    ?L?COM02D3
B3:00CC02 91BA              ACALL    ?L?COM05FD
B3:00CC04 A3                INC      DPTR
B3:00CC05 127118            LCALL    ?L?COM0289
B3:00CC08 2F                ADD      A,R7
B3:00CC09 FF                MOV      R7,A
B3:00CC0A EC                MOV      A,R4
B3:00CC0B 3E                ADDC     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1022


B3:00CC0C FE                MOV      R6,A
B3:00CC0D 9029DE            MOV      DPTR,#scb+029H
B3:00CC10 E0                MOVX     A,@DPTR
B3:00CC11 FA                MOV      R2,A
B3:00CC12 A3                INC      DPTR
B3:00CC13 E0                MOVX     A,@DPTR
B3:00CC14 FB                MOV      R3,A
B3:00CC15 C3                CLR      C
B3:00CC16 9F                SUBB     A,R7
B3:00CC17 EA                MOV      A,R2
B3:00CC18 9E                SUBB     A,R6
B3:00CC19 500D              JNC      ?C0081?TRANSPORT_SERVICE2
B3:00CC1B C3                CLR      C
B3:00CC1C EB                MOV      A,R3
B3:00CC1D 9D                SUBB     A,R5
B3:00CC1E FE                MOV      R6,A
B3:00CC1F EA                MOV      A,R2
B3:00CC20 9C                SUBB     A,R4
B3:00CC21 9029B5            MOV      DPTR,#scb
B3:00CC24 F0                MOVX     @DPTR,A
B3:00CC25 A3                INC      DPTR
B3:00CC26 CE                XCH      A,R6
B3:00CC27 F0                MOVX     @DPTR,A
B3:00CC28         ?C0081?TRANSPORT_SERVICE2:
B3:00CC28 12ECE1            LCALL    ?L?COM012F
B3:00CC2B 9029B7            MOV      DPTR,#scb+02H
B3:00CC2E 12EEA4            LCALL    ?L?COM01D0
B3:00CC31 3A                ADDC     A,R2
B3:00CC32 FA                MOV      R2,A
B3:00CC33 C003              PUSH     AR3
B3:00CC35 C002              PUSH     AR2
B3:00CC37 C001              PUSH     AR1
B3:00CC39 12EE67            LCALL    ?L?COM0538
B3:00CC3C 9029B7            MOV      DPTR,#scb+02H
B3:00CC3F 12EE8C            LCALL    ?L?COM0587
B3:00CC42 126148            LCALL    ?L?COM0046
B3:00CC45 D001              POP      AR1
B3:00CC47 D002              POP      AR2
B3:00CC49 D003              POP      AR3
B3:00CC4B 12EE6D            LCALL    ?L?COM02D2
B3:00CC4E 2405              ADD      A,#05H
B3:00CC50 FD                MOV      R5,A
B3:00CC51 F1D6              ACALL    _add_crc
B3:00CC53 91BA              ACALL    ?L?COM05FD
B3:00CC55 FF                MOV      R7,A
B3:00CC56 9029B8            MOV      DPTR,#scb+03H
B3:00CC59 E0                MOVX     A,@DPTR
B3:00CC5A 2F                ADD      A,R7
B3:00CC5B FF                MOV      R7,A
B3:00CC5C 9029B7            MOV      DPTR,#scb+02H
B3:00CC5F E0                MOVX     A,@DPTR
B3:00CC60 3E                ADDC     A,R6
B3:00CC61 FE                MOV      R6,A
B3:00CC62 9029DE            MOV      DPTR,#scb+029H
B3:00CC65 E0                MOVX     A,@DPTR
B3:00CC66 B50618            CJNE     A,AR6,?C0082?TRANSPORT_SERVICE2
B3:00CC69 A3                INC      DPTR
B3:00CC6A E0                MOVX     A,@DPTR
B3:00CC6B B50713            CJNE     A,AR7,?C0082?TRANSPORT_SERVICE2
B3:00CC6E 902A2F            MOV      DPTR,#scb+07AH
B3:00CC71 7401              MOV      A,#01H
B3:00CC73 F0                MOVX     @DPTR,A
B3:00CC74 7F1D              MOV      R7,#01DH
B3:00CC76 12BD5A            LCALL    _t2_sm_post_event
B3:00CC79 9029E1            MOV      DPTR,#scb+02CH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1023


B3:00CC7C 7401              MOV      A,#01H
B3:00CC7E F0                MOVX     @DPTR,A
B3:00CC7F 614E              AJMP     send_last_frag
B3:00CC81         ?C0082?TRANSPORT_SERVICE2:
B3:00CC81 12BDEE            LCALL    ?L?COM0030
B3:00CC84 12BDA7            LCALL    ?L?COM0083
B3:00CC87 9029E0            MOV      DPTR,#scb+02BH
B3:00CC8A E0                MOVX     A,@DPTR
B3:00CC8B 91CA              ACALL    ?L?COM0329
B3:00CC8D 6007              JZ       ?C0083?TRANSPORT_SERVICE2
B3:00CC8F 71C5              ACALL    ?L?COM0138
B3:00CC91 12EE7C            LCALL    ?L?COM05E6
B3:00CC94 8009              SJMP     ?C0211?TRANSPORT_SERVICE2
B3:00CC96         ?C0083?TRANSPORT_SERVICE2:
B3:00CC96 71C5              ACALL    ?L?COM0138
B3:00CC98 A3                INC      DPTR
B3:00CC99 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_temp_callback_reply_frag_req
B3:00CC9B F0                MOVX     @DPTR,A
B3:00CC9C A3                INC      DPTR
B3:00CC9D 7495              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_temp_callback_reply_frag_req
B3:00CC9F         
B3:00CC9F B1E4              ACALL    ?L?COM019B
B3:00CCA1 90439A            MOV      DPTR,#ret
B3:00CCA4 F0                MOVX     @DPTR,A
B3:00CCA5         ?C0084?TRANSPORT_SERVICE2:
B3:00CCA5         ?C0085?TRANSPORT_SERVICE2:
B3:00CCA5 9029E1            MOV      DPTR,#scb+02CH
B3:00CCA8 7401              MOV      A,#01H
B3:00CCAA F0                MOVX     @DPTR,A
B3:00CCAB 91E8              ACALL    ?L?COM0537
B3:00CCAD 12BDF7            LCALL    ?L?COM0031
B3:00CCB0 91DE              ACALL    ?L?COM0517
B3:00CCB2 7FDC              MOV      R7,#0DCH
B3:00CCB4 7E05              MOV      R6,#05H
B3:00CCB6 12BDB4            LCALL    ?L?COM0084
B3:00CCB9         ?C0080?TRANSPORT_SERVICE2:
B3:00CCB9 22                RET      
----- FUNCTION _reply_frag_req (END) -------


----- FUNCTION ?L?COM05FD (BEGIN) -----
B3:00CCBA 9029B5            MOV      DPTR,#scb
B3:00CCBD E0                MOVX     A,@DPTR
B3:00CCBE FE                MOV      R6,A
B3:00CCBF A3                INC      DPTR
B3:00CCC0 E0                MOVX     A,@DPTR
B3:00CCC1 22                RET      
----- FUNCTION ?L?COM05FD (END) -------


----- FUNCTION ?L?COM04AE (BEGIN) -----
B3:00CCC2 1D                DEC      R5
B3:00CCC3 ED                MOV      A,R5
B3:00CCC4 13                RRC      A
B3:00CCC5 13                RRC      A
B3:00CCC6 13                RRC      A
B3:00CCC7 541F              ANL      A,#01FH
B3:00CCC9 22                RET      
----- FUNCTION ?L?COM04AE (END) -------


----- FUNCTION ?L?COM0329 (BEGIN) -----
B3:00CCCA 7B01              MOV      R3,#01H
B3:00CCCC 7A28              MOV      R2,#HIGH t2_txBuf
B3:00CCCE 7943              MOV      R1,#LOW t2_txBuf
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1024


B3:00CCD0 9029B5            MOV      DPTR,#scb
B3:00CCD3 22                RET      
----- FUNCTION ?L?COM0329 (END) -------


----- FUNCTION ?L?COM0513 (BEGIN) -----
B3:00CCD4 FF                MOV      R7,A
B3:00CCD5 ED                MOV      A,R5
B3:00CCD6 5407              ANL      A,#07H
B3:00CCD8 FE                MOV      R6,A
B3:00CCD9 7401              MOV      A,#01H
B3:00CCDB A806              MOV      R0,AR6
B3:00CCDD 22                RET      
----- FUNCTION ?L?COM0513 (END) -------


----- FUNCTION ?L?COM0517 (BEGIN) -----
B3:00CCDE A3                INC      DPTR
B3:00CCDF 1225A9            LCALL    ?C?PSTXDATA
B3:00CCE2 0B                INC      R3
B3:00CCE3 7A28              MOV      R2,#HIGH rcb+023H
B3:00CCE5 79AC              MOV      R1,#LOW rcb+023H
B3:00CCE7 22                RET      
----- FUNCTION ?L?COM0517 (END) -------


----- FUNCTION ?L?COM0537 (BEGIN) -----
B3:00CCE8 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00CCEB 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_fc_timer_expired
B3:00CCED F0                MOVX     @DPTR,A
B3:00CCEE A3                INC      DPTR
B3:00CCEF 747C              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_fc_timer_expired
B3:00CCF1 22                RET      
----- FUNCTION ?L?COM0537 (END) -------


----- FUNCTION _ZW_NodeMaskClear (BEGIN) -----
;---- Variable 'bLength' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00CCF2 ED                MOV      A,R5
B3:00CCF3 600C              JZ       ?C0007?ZW_NODEMASK
B3:00CCF5         ?C0006?ZW_NODEMASK:
B3:00CCF5 E4                CLR      A
B3:00CCF6 122072            LCALL    ?C?CSTPTR
B3:00CCF9 04                INC      A
B3:00CCFA 29                ADD      A,R1
B3:00CCFB F9                MOV      R1,A
B3:00CCFC E4                CLR      A
B3:00CCFD 3A                ADDC     A,R2
B3:00CCFE FA                MOV      R2,A
B3:00CCFF DDF4              DJNZ     R5,?C0006?ZW_NODEMASK
B3:00CD01         ?C0007?ZW_NODEMASK:
B3:00CD01 22                RET      
----- FUNCTION _ZW_NodeMaskClear (END) -------


----- FUNCTION _ZCB_send_subseq_frag (BEGIN) -----
B3:00CD02 E4                CLR      A
B3:00CD03 904398            MOV      DPTR,#ret
B3:00CD06 F0                MOVX     @DPTR,A
B3:00CD07 12BE07            LCALL    ?L?COM0331
B3:00CD0A 9029BB            MOV      DPTR,#scb+06H
B3:00CD0D E0                MOVX     A,@DPTR
B3:00CD0E 7002              JNZ      ?C0200?TRANSPORT_SERVICE2
B3:00CD10 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1025


B3:00CD11 E0                MOVX     A,@DPTR
B3:00CD12         ?C0200?TRANSPORT_SERVICE2:
B3:00CD12 7004              JNZ      ?C0053?TRANSPORT_SERVICE2
B3:00CD14 12EE95            LCALL    ?L?COM03EE
B3:00CD17 F0                MOVX     @DPTR,A
B3:00CD18         ?C0053?TRANSPORT_SERVICE2:
B3:00CD18 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CD1B E0                MOVX     A,@DPTR
B3:00CD1C FF                MOV      R7,A
B3:00CD1D 7E00              MOV      R6,#00H
B3:00CD1F 12D42B            LCALL    ?L?COM02AD
B3:00CD22 9F                SUBB     A,R7
B3:00CD23 EC                MOV      A,R4
B3:00CD24 9E                SUBB     A,R6
B3:00CD25 9029B5            MOV      DPTR,#scb
B3:00CD28 4007              JC       ?C0054?TRANSPORT_SERVICE2
B3:00CD2A EE                MOV      A,R6
B3:00CD2B F0                MOVX     @DPTR,A
B3:00CD2C A3                INC      DPTR
B3:00CD2D EF                MOV      A,R7
B3:00CD2E F0                MOVX     @DPTR,A
B3:00CD2F 8005              SJMP     ?C0055?TRANSPORT_SERVICE2
B3:00CD31         ?C0054?TRANSPORT_SERVICE2:
B3:00CD31 EC                MOV      A,R4
B3:00CD32 F0                MOVX     @DPTR,A
B3:00CD33 A3                INC      DPTR
B3:00CD34 ED                MOV      A,R5
B3:00CD35 F0                MOVX     @DPTR,A
B3:00CD36         ?C0055?TRANSPORT_SERVICE2:
B3:00CD36 12BE30            LCALL    ?L?COM0203
B3:00CD39 E0                MOVX     A,@DPTR
B3:00CD3A 6401              XRL      A,#01H
B3:00CD3C 7002              JNZ      $ + 4H
B3:00CD3E A1DC              AJMP     ?C0057?TRANSPORT_SERVICE2
B3:00CD40         ?C0056?TRANSPORT_SERVICE2:
B3:00CD40 9029BB            MOV      DPTR,#scb+06H
B3:00CD43 1265F9            LCALL    ?L?COM0199
B3:00CD46 9029DF            MOV      DPTR,#scb+02AH
B3:00CD49 E0                MOVX     A,@DPTR
B3:00CD4A 9F                SUBB     A,R7
B3:00CD4B FF                MOV      R7,A
B3:00CD4C 9029DE            MOV      DPTR,#scb+029H
B3:00CD4F E0                MOVX     A,@DPTR
B3:00CD50 9E                SUBB     A,R6
B3:00CD51 9029B9            MOV      DPTR,#scb+04H
B3:00CD54 12ECCB            LCALL    ?L?COM02D3
B3:00CD57 12ECE1            LCALL    ?L?COM012F
B3:00CD5A 9029B9            MOV      DPTR,#scb+04H
B3:00CD5D 12EEA4            LCALL    ?L?COM01D0
B3:00CD60 3A                ADDC     A,R2
B3:00CD61 FA                MOV      R2,A
B3:00CD62 C003              PUSH     AR3
B3:00CD64 C002              PUSH     AR2
B3:00CD66 C001              PUSH     AR1
B3:00CD68 12EE67            LCALL    ?L?COM0538
B3:00CD6B 9029B9            MOV      DPTR,#scb+04H
B3:00CD6E 12EE8C            LCALL    ?L?COM0587
B3:00CD71 126148            LCALL    ?L?COM0046
B3:00CD74 D001              POP      AR1
B3:00CD76 D002              POP      AR2
B3:00CD78 D003              POP      AR3
B3:00CD7A 12EE6D            LCALL    ?L?COM02D2
B3:00CD7D 2405              ADD      A,#05H
B3:00CD7F FD                MOV      R5,A
B3:00CD80 F1D6              ACALL    _add_crc
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1026


B3:00CD82 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CD85 E0                MOVX     A,@DPTR
B3:00CD86 FF                MOV      R7,A
B3:00CD87 D3                SETB     C
B3:00CD88 9029BC            MOV      DPTR,#scb+07H
B3:00CD8B E0                MOVX     A,@DPTR
B3:00CD8C 9F                SUBB     A,R7
B3:00CD8D 9029BB            MOV      DPTR,#scb+06H
B3:00CD90 E0                MOVX     A,@DPTR
B3:00CD91 9400              SUBB     A,#00H
B3:00CD93 500D              JNC      ?C0058?TRANSPORT_SERVICE2
B3:00CD95 902A2F            MOV      DPTR,#scb+07AH
B3:00CD98 7401              MOV      A,#01H
B3:00CD9A F0                MOVX     @DPTR,A
B3:00CD9B 7F1C              MOV      R7,#01CH
B3:00CD9D 12BD5A            LCALL    _t2_sm_post_event
B3:00CDA0 614E              AJMP     send_last_frag
B3:00CDA2         ?C0058?TRANSPORT_SERVICE2:
B3:00CDA2 12BDEE            LCALL    ?L?COM0030
B3:00CDA5 12BDA7            LCALL    ?L?COM0083
B3:00CDA8 91CA              ACALL    ?L?COM0329
B3:00CDAA 71C5              ACALL    ?L?COM0138
B3:00CDAC B1DD              ACALL    ?L?COM019A
B3:00CDAE 904398            MOV      DPTR,#ret
B3:00CDB1 F0                MOVX     @DPTR,A
B3:00CDB2         ?C0059?TRANSPORT_SERVICE2:
B3:00CDB2 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CDB5 E0                MOVX     A,@DPTR
B3:00CDB6 F9                MOV      R1,A
B3:00CDB7 FF                MOV      R7,A
B3:00CDB8 12D42B            LCALL    ?L?COM02AD
B3:00CDBB 9F                SUBB     A,R7
B3:00CDBC EC                MOV      A,R4
B3:00CDBD 9400              SUBB     A,#00H
B3:00CDBF 4009              JC       ?C0060?TRANSPORT_SERVICE2
B3:00CDC1 ED                MOV      A,R5
B3:00CDC2 9F                SUBB     A,R7
B3:00CDC3 FE                MOV      R6,A
B3:00CDC4 EC                MOV      A,R4
B3:00CDC5 9400              SUBB     A,#00H
B3:00CDC7 12EE84            LCALL    ?L?COM05FE
B3:00CDCA         ?C0060?TRANSPORT_SERVICE2:
B3:00CDCA 12EB5A            LCALL    ?L?COM00C1
B3:00CDCD ED                MOV      A,R5
B3:00CDCE 4C                ORL      A,R4
B3:00CDCF 6006              JZ       ?C0061?TRANSPORT_SERVICE2
B3:00CDD1 9029DA            MOV      DPTR,#scb+025H
B3:00CDD4 E0                MOVX     A,@DPTR
B3:00CDD5 04                INC      A
B3:00CDD6 F0                MOVX     @DPTR,A
B3:00CDD7         ?C0061?TRANSPORT_SERVICE2:
B3:00CDD7 7F18              MOV      R7,#018H
B3:00CDD9 12BD5A            LCALL    _t2_sm_post_event
B3:00CDDC         ?C0057?TRANSPORT_SERVICE2:
B3:00CDDC 22                RET      
----- FUNCTION _ZCB_send_subseq_frag (END) -------


----- FUNCTION ?L?COM019A (BEGIN) -----
B3:00CDDD A3                INC      DPTR
B3:00CDDE 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00CDE0 F0                MOVX     @DPTR,A
B3:00CDE1 A3                INC      DPTR
B3:00CDE2 7486              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00CDE4         ?L?COM019B:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1027


B3:00CDE4 F0                MOVX     @DPTR,A
B3:00CDE5 9029BE            MOV      DPTR,#scb+09H
B3:00CDE8         ?L?COM019C:
B3:00CDE8 E0                MOVX     A,@DPTR
B3:00CDE9 FF                MOV      R7,A
B3:00CDEA B1EF              ACALL    _TS_SendRaw
B3:00CDEC E4                CLR      A
B3:00CDED 33                RLC      A
B3:00CDEE 22                RET      
----- FUNCTION ?L?COM019A (END) -------


----- FUNCTION _TS_SendRaw (BEGIN) -----
B3:00CDEF 903FD4            MOV      DPTR,#dst
B3:00CDF2 127088            LCALL    ?L?COM00F4
B3:00CDF5 7B01              MOV      R3,#01H
B3:00CDF7 7A28              MOV      R2,#HIGH ts_txo
B3:00CDF9 797C              MOV      R1,#LOW ts_txo
B3:00CDFB 7D06              MOV      R5,#06H
B3:00CDFD E4                CLR      A
B3:00CDFE FF                MOV      R7,A
B3:00CDFF 1299EF            LCALL    ___ZW_memset
B3:00CE02 903FD4            MOV      DPTR,#dst
B3:00CE05 E0                MOVX     A,@DPTR
B3:00CE06 90287C            MOV      DPTR,#ts_txo
B3:00CE09 F0                MOVX     @DPTR,A
B3:00CE0A 903FD9            MOV      DPTR,#txopt
B3:00CE0D E0                MOVX     A,@DPTR
B3:00CE0E 90287E            MOV      DPTR,#ts_txo+02H
B3:00CE11 F0                MOVX     @DPTR,A
B3:00CE12 903FD8            MOV      DPTR,#buflen
B3:00CE15 E0                MOVX     A,@DPTR
B3:00CE16 FD                MOV      R5,A
B3:00CE17 7B01              MOV      R3,#01H
B3:00CE19 7A28              MOV      R2,#HIGH ts_txo
B3:00CE1B 797C              MOV      R1,#LOW ts_txo
B3:00CE1D 12704B            LCALL    ?L?COM00AE
B3:00CE20 903FDA            MOV      DPTR,#cb
B3:00CE23 E0                MOVX     A,@DPTR
B3:00CE24 FF                MOV      R7,A
B3:00CE25 A3                INC      DPTR
B3:00CE26 E0                MOVX     A,@DPTR
B3:00CE27 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00CE2A CF                XCH      A,R7
B3:00CE2B F0                MOVX     @DPTR,A
B3:00CE2C A3                INC      DPTR
B3:00CE2D EF                MOV      A,R7
B3:00CE2E F0                MOVX     @DPTR,A
B3:00CE2F 903FD5            MOV      DPTR,#buf
B3:00CE32 122589            LCALL    ?C?PLDXDATA
B3:00CE35 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00CE38 EF                MOV      A,R7
B3:00CE39 24FF              ADD      A,#0FFH
B3:00CE3B 22                RET      
----- FUNCTION _TS_SendRaw (END) -------


----- FUNCTION send_frag_wait_cmd (BEGIN) -----
B3:00CE3C E4                CLR      A
B3:00CE3D 90425F            MOV      DPTR,#ret
B3:00CE40 F0                MOVX     @DPTR,A
B3:00CE41 A3                INC      DPTR
B3:00CE42 7455              MOV      A,#055H
B3:00CE44 F0                MOVX     @DPTR,A
B3:00CE45 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1028


B3:00CE46 74F0              MOV      A,#0F0H
B3:00CE48 12BDED            LCALL    ?L?COM002F
B3:00CE4B 12BDA7            LCALL    ?L?COM0083
B3:00CE4E 9029E0            MOV      DPTR,#scb+02BH
B3:00CE51 E0                MOVX     A,@DPTR
B3:00CE52 601C              JZ       ?C0178?TRANSPORT_SERVICE2
B3:00CE54 9029DA            MOV      DPTR,#scb+025H
B3:00CE57 12EDE4            LCALL    ?L?COM02D0
B3:00CE5A 902A28            MOV      DPTR,#scb+073H
B3:00CE5D 71D0              ACALL    ?L?COM013A
B3:00CE5F 12EE7C            LCALL    ?L?COM05E6
B3:00CE62 F0                MOVX     @DPTR,A
B3:00CE63 902A24            MOV      DPTR,#scb+06FH
B3:00CE66 B1E8              ACALL    ?L?COM019C
B3:00CE68 90425F            MOV      DPTR,#ret
B3:00CE6B F0                MOVX     @DPTR,A
B3:00CE6C 7F06              MOV      R7,#06H
B3:00CE6E 802A              SJMP     ?C0234?TRANSPORT_SERVICE2
B3:00CE70         ?C0178?TRANSPORT_SERVICE2:
B3:00CE70 9028A5            MOV      DPTR,#rcb+01CH
B3:00CE73 E0                MOVX     A,@DPTR
B3:00CE74 B41005            CJNE     A,#010H,?C0180?TRANSPORT_SERVICE2
B3:00CE77 E4                CLR      A
B3:00CE78 A3                INC      DPTR
B3:00CE79 F0                MOVX     @DPTR,A
B3:00CE7A 8003              SJMP     ?C0181?TRANSPORT_SERVICE2
B3:00CE7C         ?C0180?TRANSPORT_SERVICE2:
B3:00CE7C 12EB26            LCALL    calculate_pending_segments
B3:00CE7F         ?C0181?TRANSPORT_SERVICE2:
B3:00CE7F 9028A6            MOV      DPTR,#rcb+01DH
B3:00CE82 12EDE4            LCALL    ?L?COM02D0
B3:00CE85 902A28            MOV      DPTR,#scb+073H
B3:00CE88 71D0              ACALL    ?L?COM013A
B3:00CE8A E4                CLR      A
B3:00CE8B A3                INC      DPTR
B3:00CE8C F0                MOVX     @DPTR,A
B3:00CE8D A3                INC      DPTR
B3:00CE8E F0                MOVX     @DPTR,A
B3:00CE8F 902A24            MOV      DPTR,#scb+06FH
B3:00CE92 B1E8              ACALL    ?L?COM019C
B3:00CE94 90425F            MOV      DPTR,#ret
B3:00CE97 F0                MOVX     @DPTR,A
B3:00CE98 7F05              MOV      R7,#05H
B3:00CE9A         
B3:00CE9A 12BD5A            LCALL    _t2_sm_post_event
B3:00CE9D         ?C0179?TRANSPORT_SERVICE2:
B3:00CE9D         ?C0182?TRANSPORT_SERVICE2:
B3:00CE9D 7F00              MOV      R7,#00H
B3:00CE9F 22                RET      
----- FUNCTION send_frag_wait_cmd (END) -------


----- FUNCTION send_first_frag (BEGIN) -----
B3:00CEA0 E4                CLR      A
B3:00CEA1 904399            MOV      DPTR,#ret
B3:00CEA4 F0                MOVX     @DPTR,A
B3:00CEA5 9029D9            MOV      DPTR,#scb+024H
B3:00CEA8 E0                MOVX     A,@DPTR
B3:00CEA9 7010              JNZ      ?C0063?TRANSPORT_SERVICE2
B3:00CEAB 12413E            LCALL    ZW_Random
B3:00CEAE EF                MOV      A,R7
B3:00CEAF 75F00F            MOV      B,#0FH
B3:00CEB2 84                DIV      AB
B3:00CEB3 9029D9            MOV      DPTR,#scb+024H
B3:00CEB6 E5F0              MOV      A,B
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1029


B3:00CEB8 F0                MOVX     @DPTR,A
B3:00CEB9 8006              SJMP     ?C0064?TRANSPORT_SERVICE2
B3:00CEBB         ?C0063?TRANSPORT_SERVICE2:
B3:00CEBB 9029D9            MOV      DPTR,#scb+024H
B3:00CEBE E0                MOVX     A,@DPTR
B3:00CEBF 04                INC      A
B3:00CEC0 F0                MOVX     @DPTR,A
B3:00CEC1         ?C0064?TRANSPORT_SERVICE2:
B3:00CEC1 9029D9            MOV      DPTR,#scb+024H
B3:00CEC4 E0                MOVX     A,@DPTR
B3:00CEC5 D3                SETB     C
B3:00CEC6 940F              SUBB     A,#0FH
B3:00CEC8 4002              JC       ?C0065?TRANSPORT_SERVICE2
B3:00CECA E4                CLR      A
B3:00CECB F0                MOVX     @DPTR,A
B3:00CECC         ?C0065?TRANSPORT_SERVICE2:
B3:00CECC 12BE30            LCALL    ?L?COM0203
B3:00CECF E4                CLR      A
B3:00CED0 F0                MOVX     @DPTR,A
B3:00CED1 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CED4 742F              MOV      A,#02FH
B3:00CED6 F0                MOVX     @DPTR,A
B3:00CED7 9029C1            MOV      DPTR,#scb+0CH
B3:00CEDA E0                MOVX     A,@DPTR
B3:00CEDB FF                MOV      R7,A
B3:00CEDC 30E502            JNB      ACC.5,?C0066?TRANSPORT_SERVICE2
B3:00CEDF 8004              SJMP     ?C0210?TRANSPORT_SERVICE2
B3:00CEE1         ?C0066?TRANSPORT_SERVICE2:
B3:00CEE1 EF                MOV      A,R7
B3:00CEE2 20E407            JB       ACC.4,?C0067?TRANSPORT_SERVICE2
B3:00CEE5         
B3:00CEE5 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CEE8 E0                MOVX     A,@DPTR
B3:00CEE9 24F8              ADD      A,#0F8H
B3:00CEEB F0                MOVX     @DPTR,A
B3:00CEEC         ?C0067?TRANSPORT_SERVICE2:
B3:00CEEC 9029BB            MOV      DPTR,#scb+06H
B3:00CEEF E0                MOVX     A,@DPTR
B3:00CEF0 7002              JNZ      ?C0201?TRANSPORT_SERVICE2
B3:00CEF2 A3                INC      DPTR
B3:00CEF3 E0                MOVX     A,@DPTR
B3:00CEF4         ?C0201?TRANSPORT_SERVICE2:
B3:00CEF4 7004              JNZ      ?C0069?TRANSPORT_SERVICE2
B3:00CEF6 12EE95            LCALL    ?L?COM03EE
B3:00CEF9 F0                MOVX     @DPTR,A
B3:00CEFA         ?C0069?TRANSPORT_SERVICE2:
B3:00CEFA 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CEFD E0                MOVX     A,@DPTR
B3:00CEFE F9                MOV      R1,A
B3:00CEFF FF                MOV      R7,A
B3:00CF00 9029DE            MOV      DPTR,#scb+029H
B3:00CF03 1267D1            LCALL    ?L?COM0539
B3:00CF06 9F                SUBB     A,R7
B3:00CF07 EC                MOV      A,R4
B3:00CF08 9400              SUBB     A,#00H
B3:00CF0A 4016              JC       ?C0070?TRANSPORT_SERVICE2
B3:00CF0C E9                MOV      A,R1
B3:00CF0D FB                MOV      R3,A
B3:00CF0E 7A00              MOV      R2,#00H
B3:00CF10 ED                MOV      A,R5
B3:00CF11 9B                SUBB     A,R3
B3:00CF12 FE                MOV      R6,A
B3:00CF13 EC                MOV      A,R4
B3:00CF14 9A                SUBB     A,R2
B3:00CF15 12EE84            LCALL    ?L?COM05FE
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1030


B3:00CF18 9029B5            MOV      DPTR,#scb
B3:00CF1B EA                MOV      A,R2
B3:00CF1C F0                MOVX     @DPTR,A
B3:00CF1D A3                INC      DPTR
B3:00CF1E EB                MOV      A,R3
B3:00CF1F F0                MOVX     @DPTR,A
B3:00CF20 8017              SJMP     ?C0071?TRANSPORT_SERVICE2
B3:00CF22         ?C0070?TRANSPORT_SERVICE2:
B3:00CF22 9029BB            MOV      DPTR,#scb+06H
B3:00CF25 EC                MOV      A,R4
B3:00CF26 F0                MOVX     @DPTR,A
B3:00CF27 A3                INC      DPTR
B3:00CF28 ED                MOV      A,R5
B3:00CF29 F0                MOVX     @DPTR,A
B3:00CF2A 9029DE            MOV      DPTR,#scb+029H
B3:00CF2D E0                MOVX     A,@DPTR
B3:00CF2E FF                MOV      R7,A
B3:00CF2F A3                INC      DPTR
B3:00CF30 E0                MOVX     A,@DPTR
B3:00CF31 9029B5            MOV      DPTR,#scb
B3:00CF34 CF                XCH      A,R7
B3:00CF35 F0                MOVX     @DPTR,A
B3:00CF36 A3                INC      DPTR
B3:00CF37 EF                MOV      A,R7
B3:00CF38 F0                MOVX     @DPTR,A
B3:00CF39         ?C0071?TRANSPORT_SERVICE2:
B3:00CF39 902885            MOV      DPTR,#first_frag
B3:00CF3C 12ECD2            LCALL    ?L?COM02D4
B3:00CF3F 9029DE            MOV      DPTR,#scb+029H
B3:00CF42 1247B6            LCALL    ?L?COM031C
B3:00CF45 5407              ANL      A,#07H
B3:00CF47 44C0              ORL      A,#0C0H
B3:00CF49 FF                MOV      R7,A
B3:00CF4A 902885            MOV      DPTR,#first_frag
B3:00CF4D 12ECF2            LCALL    ?L?COM0130
B3:00CF50 9029D9            MOV      DPTR,#scb+024H
B3:00CF53 E0                MOVX     A,@DPTR
B3:00CF54 C4                SWAP     A
B3:00CF55 54F0              ANL      A,#0F0H
B3:00CF57 12716F            LCALL    ?L?COM0313
B3:00CF5A 9029B5            MOV      DPTR,#scb
B3:00CF5D A3                INC      DPTR
B3:00CF5E E0                MOVX     A,@DPTR
B3:00CF5F FF                MOV      R7,A
B3:00CF60 125525            LCALL    ?L?COM005A
B3:00CF63 C003              PUSH     AR3
B3:00CF65 C002              PUSH     AR2
B3:00CF67 C001              PUSH     AR1
B3:00CF69 12EE67            LCALL    ?L?COM0538
B3:00CF6C 126149            LCALL    ?L?COM0047
B3:00CF6F D001              POP      AR1
B3:00CF71 D002              POP      AR2
B3:00CF73 D003              POP      AR3
B3:00CF75 12EE6D            LCALL    ?L?COM02D2
B3:00CF78 2404              ADD      A,#04H
B3:00CF7A FD                MOV      R5,A
B3:00CF7B F1D6              ACALL    _add_crc
B3:00CF7D 12EB5A            LCALL    ?L?COM00C1
B3:00CF80 ED                MOV      A,R5
B3:00CF81 4C                ORL      A,R4
B3:00CF82 6006              JZ       ?C0072?TRANSPORT_SERVICE2
B3:00CF84 9029DA            MOV      DPTR,#scb+025H
B3:00CF87 E0                MOVX     A,@DPTR
B3:00CF88 04                INC      A
B3:00CF89 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1031


B3:00CF8A         ?C0072?TRANSPORT_SERVICE2:
B3:00CF8A 902888            MOV      DPTR,#FragmentMaxPayload
B3:00CF8D E0                MOVX     A,@DPTR
B3:00CF8E FF                MOV      R7,A
B3:00CF8F D3                SETB     C
B3:00CF90 9029DF            MOV      DPTR,#scb+02AH
B3:00CF93 E0                MOVX     A,@DPTR
B3:00CF94 9F                SUBB     A,R7
B3:00CF95 9029DE            MOV      DPTR,#scb+029H
B3:00CF98 E0                MOVX     A,@DPTR
B3:00CF99 9400              SUBB     A,#00H
B3:00CF9B 500C              JNC      ?C0073?TRANSPORT_SERVICE2
B3:00CF9D E4                CLR      A
B3:00CF9E 902A2F            MOV      DPTR,#scb+07AH
B3:00CFA1 F0                MOVX     @DPTR,A
B3:00CFA2 7F1C              MOV      R7,#01CH
B3:00CFA4 12BD5A            LCALL    _t2_sm_post_event
B3:00CFA7 614E              AJMP     send_last_frag
B3:00CFA9         ?C0073?TRANSPORT_SERVICE2:
B3:00CFA9 12BDEE            LCALL    ?L?COM0030
B3:00CFAC 12BDA7            LCALL    ?L?COM0083
B3:00CFAF 91CA              ACALL    ?L?COM0329
B3:00CFB1 A3                INC      DPTR
B3:00CFB2 E0                MOVX     A,@DPTR
B3:00CFB3 2406              ADD      A,#06H
B3:00CFB5 71C9              ACALL    ?L?COM0139
B3:00CFB7 B1DD              ACALL    ?L?COM019A
B3:00CFB9 904399            MOV      DPTR,#ret
B3:00CFBC F0                MOVX     @DPTR,A
B3:00CFBD 6016              JZ       ?C0074?TRANSPORT_SERVICE2
B3:00CFBF         ?C0075?TRANSPORT_SERVICE2:
B3:00CFBF 12D425            LCALL    clock_time
B3:00CFC2 902A2B            MOV      DPTR,#scb+076H
B3:00CFC5 EE                MOV      A,R6
B3:00CFC6 F0                MOVX     @DPTR,A
B3:00CFC7 A3                INC      DPTR
B3:00CFC8 EF                MOV      A,R7
B3:00CFC9 F0                MOVX     @DPTR,A
B3:00CFCA 9029E0            MOV      DPTR,#scb+02BH
B3:00CFCD 7401              MOV      A,#01H
B3:00CFCF F0                MOVX     @DPTR,A
B3:00CFD0 7F18              MOV      R7,#018H
B3:00CFD2 12BD5A            LCALL    _t2_sm_post_event
B3:00CFD5         ?C0074?TRANSPORT_SERVICE2:
B3:00CFD5 22                RET      
----- FUNCTION send_first_frag (END) -------


----- FUNCTION _add_crc (BEGIN) -----
B3:00CFD6 90424F            MOV      DPTR,#len
B3:00CFD9 ED                MOV      A,R5
B3:00CFDA F0                MOVX     @DPTR,A
;---- Variable 'buf' assigned to Register 'R1/R2/R3' ----
B3:00CFDB A3                INC      DPTR
B3:00CFDC 1225A9            LCALL    ?C?PSTXDATA
B3:00CFDF 90424F            MOV      DPTR,#len
B3:00CFE2 12EDA6            LCALL    ?L?COM00FC
B3:00CFE5 127181            LCALL    ?L?COM031A
;---- Variable 'crc' assigned to Register 'R4/R5' ----
B3:00CFE8 AD07              MOV      R5,AR7
B3:00CFEA AC06              MOV      R4,AR6
B3:00CFEC 90424F            MOV      DPTR,#len
B3:00CFEF E0                MOVX     A,@DPTR
B3:00CFF0 FF                MOV      R7,A
B3:00CFF1 904251            MOV      DPTR,#tmp_buf+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1032


B3:00CFF4 12D1C3            LCALL    ?L?COM01D2
B3:00CFF7 EC                MOV      A,R4
B3:00CFF8 FF                MOV      R7,A
B3:00CFF9 904250            MOV      DPTR,#tmp_buf
B3:00CFFC 12C3C4            LCALL    ?L?COM016B
B3:00CFFF EF                MOV      A,R7
B3:00D000 122072            LCALL    ?C?CSTPTR
B3:00D003 904250            MOV      DPTR,#tmp_buf
B3:00D006 122589            LCALL    ?C?PLDXDATA
B3:00D009 ED                MOV      A,R5
B3:00D00A 022072            LJMP     ?C?CSTPTR
----- FUNCTION _add_crc (END) -------


----- FUNCTION ___S2_network_key_update (BEGIN) -----
B3:00D00D 9041AA            MOV      DPTR,#net_key
B3:00D010 1225A9            LCALL    ?C?PSTXDATA
B3:00D013 9041A9            MOV      DPTR,#class_id
B3:00D016 EF                MOV      A,R7
B3:00D017 F0                MOVX     @DPTR,A
B3:00D018 C3                CLR      C
B3:00D019 9403              SUBB     A,#03H
B3:00D01B 4003              JC       ?C0170?S2
B3:00D01D 7F00              MOV      R7,#00H
B3:00D01F 22                RET      
B3:00D020         ?C0170?S2:
B3:00D020 9041AD            MOV      DPTR,#temp_key_expand
B3:00D023 E0                MOVX     A,@DPTR
B3:00D024 9041A9            MOV      DPTR,#class_id
B3:00D027 6016              JZ       ?C0172?S2
B3:00D029 E0                MOVX     A,@DPTR
B3:00D02A 9038FD            MOV      DPTR,#?_tempkey_expand?BYTE+03H
B3:00D02D 11B9              ACALL    ?L?COM029D
B3:00D02F 903900            MOV      DPTR,#?_tempkey_expand?BYTE+06H
B3:00D032 1225A9            LCALL    ?C?PSTXDATA
B3:00D035 903903            MOV      DPTR,#?_tempkey_expand?BYTE+09H
B3:00D038 11A8              ACALL    ?L?COM03A9
B3:00D03A 121B38            LCALL    ?INTERBANK_TABLE?_tempkey_expand
B3:00D03D 8014              SJMP     ?C0173?S2
B3:00D03F         ?C0172?S2:
B3:00D03F E0                MOVX     A,@DPTR
B3:00D040 9038E2            MOV      DPTR,#?_networkkey_expand?BYTE+03H
B3:00D043 11B9              ACALL    ?L?COM029D
B3:00D045 9038E5            MOV      DPTR,#?_networkkey_expand?BYTE+06H
B3:00D048 1225A9            LCALL    ?C?PSTXDATA
B3:00D04B 9038E8            MOV      DPTR,#?_networkkey_expand?BYTE+09H
B3:00D04E 11A8              ACALL    ?L?COM03A9
B3:00D050 121B2E            LCALL    ?INTERBANK_TABLE?_networkkey_expand
B3:00D053         ?C0173?S2:
B3:00D053 9020D9            MOV      DPTR,#the_context+0C6H
B3:00D056 E0                MOVX     A,@DPTR
B3:00D057 FF                MOV      R7,A
B3:00D058 9041A9            MOV      DPTR,#class_id
B3:00D05B E0                MOVX     A,@DPTR
B3:00D05C FE                MOV      R6,A
B3:00D05D 7401              MOV      A,#01H
B3:00D05F A806              MOV      R0,AR6
B3:00D061 08                INC      R0
B3:00D062 8002              SJMP     ?C0272?S2
B3:00D064         ?C0271?S2:
B3:00D064 C3                CLR      C
B3:00D065 33                RLC      A
B3:00D066         ?C0272?S2:
B3:00D066 D8FC              DJNZ     R0,?C0271?S2
B3:00D068 4F                ORL      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1033


B3:00D069 9020D9            MOV      DPTR,#the_context+0C6H
B3:00D06C F0                MOVX     @DPTR,A
B3:00D06D 7F01              MOV      R7,#01H
B3:00D06F 22                RET      
----- FUNCTION ___S2_network_key_update (END) -------


----- FUNCTION _fe25519_unpack (BEGIN) -----
B3:00D070 900AD5            MOV      DPTR,#r
B3:00D073 1270CD            LCALL    ?L?COM019E
;---- Variable 'i' assigned to Register 'R7' ----
B3:00D076 E4                CLR      A
B3:00D077 FF                MOV      R7,A
B3:00D078         ?C0032?FE25519:
B3:00D078 900AD7            MOV      DPTR,#x
B3:00D07B E0                MOVX     A,@DPTR
B3:00D07C FC                MOV      R4,A
B3:00D07D A3                INC      DPTR
B3:00D07E E0                MOVX     A,@DPTR
B3:00D07F 2F                ADD      A,R7
B3:00D080 126333            LCALL    ?L?COM0330
B3:00D083 E0                MOVX     A,@DPTR
B3:00D084 FE                MOV      R6,A
B3:00D085 900AD5            MOV      DPTR,#r
B3:00D088 E0                MOVX     A,@DPTR
B3:00D089 FC                MOV      R4,A
B3:00D08A A3                INC      DPTR
B3:00D08B E0                MOVX     A,@DPTR
B3:00D08C 2F                ADD      A,R7
B3:00D08D 126333            LCALL    ?L?COM0330
B3:00D090 EE                MOV      A,R6
B3:00D091 F0                MOVX     @DPTR,A
B3:00D092 0F                INC      R7
B3:00D093 EF                MOV      A,R7
B3:00D094 B420E1            CJNE     A,#020H,?C0032?FE25519
B3:00D097         ?C0033?FE25519:
B3:00D097 900AD5            MOV      DPTR,#r
B3:00D09A E0                MOVX     A,@DPTR
B3:00D09B FE                MOV      R6,A
B3:00D09C A3                INC      DPTR
B3:00D09D E0                MOVX     A,@DPTR
B3:00D09E 241F              ADD      A,#01FH
B3:00D0A0 12B617            LCALL    ?L?COM0096
B3:00D0A3 E0                MOVX     A,@DPTR
B3:00D0A4 547F              ANL      A,#07FH
B3:00D0A6 F0                MOVX     @DPTR,A
B3:00D0A7 22                RET      
----- FUNCTION _fe25519_unpack (END) -------


----- FUNCTION ?L?COM03A9 (BEGIN) -----
B3:00D0A8 7423              MOV      A,#LOW the_context+010H
B3:00D0AA 2F                ADD      A,R7
B3:00D0AB F9                MOV      R1,A
B3:00D0AC 7420              MOV      A,#HIGH the_context+010H
B3:00D0AE 3E                ADDC     A,R6
B3:00D0AF FA                MOV      R2,A
B3:00D0B0 1225A9            LCALL    ?C?PSTXDATA
B3:00D0B3 9041AA            MOV      DPTR,#net_key
B3:00D0B6 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03A9 (END) -------


----- FUNCTION ?L?COM029D (BEGIN) -----
B3:00D0B9 75F040            MOV      B,#040H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1034


B3:00D0BC A4                MUL      AB
B3:00D0BD FF                MOV      R7,A
B3:00D0BE AEF0              MOV      R6,B
B3:00D0C0 7B01              MOV      R3,#01H
B3:00D0C2 2413              ADD      A,#LOW the_context
B3:00D0C4 F9                MOV      R1,A
B3:00D0C5 7420              MOV      A,#HIGH the_context
B3:00D0C7 3E                ADDC     A,R6
B3:00D0C8 FA                MOV      R2,A
B3:00D0C9 1225A9            LCALL    ?C?PSTXDATA
B3:00D0CC 7433              MOV      A,#LOW the_context+020H
B3:00D0CE 2F                ADD      A,R7
B3:00D0CF F9                MOV      R1,A
B3:00D0D0 7420              MOV      A,#HIGH the_context+020H
B3:00D0D2 3E                ADDC     A,R6
B3:00D0D3 FA                MOV      R2,A
B3:00D0D4 22                RET      
----- FUNCTION ?L?COM029D (END) -------


----- FUNCTION _fe25519_setzero (BEGIN) -----
;---- Variable 'r' assigned to Register 'R6/R7' ----
;---- Variable 'i' assigned to Register 'R5' ----
B3:00D0D5 E4                CLR      A
B3:00D0D6 FD                MOV      R5,A
B3:00D0D7         ?C0023?FE25519:
B3:00D0D7 12B615            LCALL    ?L?COM0094
B3:00D0DA E4                CLR      A
B3:00D0DB F0                MOVX     @DPTR,A
B3:00D0DC 0D                INC      R5
B3:00D0DD ED                MOV      A,R5
B3:00D0DE B420F6            CJNE     A,#020H,?C0023?FE25519
B3:00D0E1 22                RET      
----- FUNCTION _fe25519_setzero (END) -------


----- FUNCTION _ZW_NodeMaskBitsIn (BEGIN) -----
;---- Variable 'bLength' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
;---- Variable 'count' assigned to Register 'R7' ----
B3:00D0E2 E4                CLR      A
B3:00D0E3 FF                MOV      R7,A
B3:00D0E4 ED                MOV      A,R5
B3:00D0E5 6015              JZ       ?C0008?ZW_NODEMASK
B3:00D0E7         ?C0011?ZW_NODEMASK:
;---- Variable 't' assigned to Register 'R6' ----
B3:00D0E7 7E01              MOV      R6,#01H
B3:00D0E9         ?C0012?ZW_NODEMASK:
B3:00D0E9 EE                MOV      A,R6
B3:00D0EA 600C              JZ       ?C0013?ZW_NODEMASK
B3:00D0EC 121FB3            LCALL    ?C?CLDPTR
B3:00D0EF 5E                ANL      A,R6
B3:00D0F0 6001              JZ       ?C0014?ZW_NODEMASK
B3:00D0F2 0F                INC      R7
B3:00D0F3         ?C0014?ZW_NODEMASK:
B3:00D0F3 EE                MOV      A,R6
B3:00D0F4 2E                ADD      A,R6
B3:00D0F5 FE                MOV      R6,A
B3:00D0F6 80F1              SJMP     ?C0012?ZW_NODEMASK
B3:00D0F8         ?C0013?ZW_NODEMASK:
B3:00D0F8 31DB              ACALL    ?L?COM0614
B3:00D0FA DDEB              DJNZ     R5,?C0011?ZW_NODEMASK
B3:00D0FC         ?C0008?ZW_NODEMASK:
B3:00D0FC 22                RET      
----- FUNCTION _ZW_NodeMaskBitsIn (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1035




----- FUNCTION _ZW_NodeMaskNodeIn (BEGIN) -----
;---- Variable 'bNode' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00D0FD 12CCC2            LCALL    ?L?COM04AE
B3:00D100 F582              MOV      DPL,A
B3:00D102 1289F4            LCALL    ?L?COM00E4
B3:00D105 FF                MOV      R7,A
B3:00D106 ED                MOV      A,R5
B3:00D107 5407              ANL      A,#07H
B3:00D109 FE                MOV      R6,A
B3:00D10A EF                MOV      A,R7
B3:00D10B A806              MOV      R0,AR6
B3:00D10D 08                INC      R0
B3:00D10E 8002              SJMP     ?C0027?ZW_NODEMASK
B3:00D110         ?C0026?ZW_NODEMASK:
B3:00D110 C3                CLR      C
B3:00D111 13                RRC      A
B3:00D112         ?C0027?ZW_NODEMASK:
B3:00D112 D8FC              DJNZ     R0,?C0026?ZW_NODEMASK
B3:00D114 5401              ANL      A,#01H
B3:00D116 FF                MOV      R7,A
B3:00D117 22                RET      
----- FUNCTION _ZW_NodeMaskNodeIn (END) -------


----- FUNCTION _sec0_persist_netkey (BEGIN) -----
;---- Variable 'netkey' assigned to Register 'R1/R2/R3' ----
B3:00D118 7F80              MOV      R7,#080H
B3:00D11A 021AED            LJMP     ?INTERBANK_TABLE?_keystore_network_key_write
----- FUNCTION _sec0_persist_netkey (END) -------


----- FUNCTION _EventPush (BEGIN) -----
;---- Variable 'bStatus' assigned to Register 'R5' ----
;---- Variable 'bEvent' assigned to Register 'R7' ----
B3:00D11D 90418F            MOV      DPTR,#eventQueueCount
B3:00D120 E0                MOVX     A,@DPTR
B3:00D121 FE                MOV      R6,A
B3:00D122 C3                CLR      C
B3:00D123 9402              SUBB     A,#02H
B3:00D125 5027              JNC      ?C0001?ZW_EVENT
B3:00D127 EE                MOV      A,R6
B3:00D128 25E0              ADD      A,ACC
B3:00D12A 248B              ADD      A,#LOW eventQueue
B3:00D12C F582              MOV      DPL,A
B3:00D12E E4                CLR      A
B3:00D12F 3441              ADDC     A,#HIGH eventQueue
B3:00D131 F583              MOV      DPH,A
B3:00D133 EF                MOV      A,R7
B3:00D134 F0                MOVX     @DPTR,A
B3:00D135 AF05              MOV      R7,AR5
B3:00D137 90418F            MOV      DPTR,#eventQueueCount
B3:00D13A E0                MOVX     A,@DPTR
B3:00D13B FE                MOV      R6,A
B3:00D13C 04                INC      A
B3:00D13D F0                MOVX     @DPTR,A
B3:00D13E EE                MOV      A,R6
B3:00D13F 25E0              ADD      A,ACC
B3:00D141 248C              ADD      A,#LOW eventQueue+01H
B3:00D143 F582              MOV      DPL,A
B3:00D145 E4                CLR      A
B3:00D146 3441              ADDC     A,#HIGH eventQueue+01H
B3:00D148 F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1036


B3:00D14A EF                MOV      A,R7
B3:00D14B F0                MOVX     @DPTR,A
B3:00D14C D3                SETB     C
B3:00D14D 22                RET      
B3:00D14E         ?C0001?ZW_EVENT:
B3:00D14E C3                CLR      C
B3:00D14F 22                RET      
----- FUNCTION _EventPush (END) -------


----- FUNCTION _EventPop (BEGIN) -----
B3:00D150 904384            MOV      DPTR,#pbEvent
B3:00D153 EF                MOV      A,R7
B3:00D154 F0                MOVX     @DPTR,A
;---- Variable 'pbStatus' assigned to Register 'R5' ----
B3:00D155 90418F            MOV      DPTR,#eventQueueCount
B3:00D158 E0                MOVX     A,@DPTR
B3:00D159 602D              JZ       ?C0003?ZW_EVENT
B3:00D15B 90418B            MOV      DPTR,#eventQueue
B3:00D15E E0                MOVX     A,@DPTR
B3:00D15F FF                MOV      R7,A
B3:00D160 904384            MOV      DPTR,#pbEvent
B3:00D163 E0                MOVX     A,@DPTR
B3:00D164 F8                MOV      R0,A
B3:00D165 A607              MOV      @R0,AR7
B3:00D167 90418C            MOV      DPTR,#eventQueue+01H
B3:00D16A E0                MOVX     A,@DPTR
B3:00D16B A805              MOV      R0,AR5
B3:00D16D F6                MOV      @R0,A
B3:00D16E 7B01              MOV      R3,#01H
B3:00D170 7A41              MOV      R2,#HIGH eventQueue+02H
B3:00D172 798D              MOV      R1,#LOW eventQueue+02H
B3:00D174 126149            LCALL    ?L?COM0047
B3:00D177 7A41              MOV      R2,#HIGH eventQueue
B3:00D179 798B              MOV      R1,#LOW eventQueue
B3:00D17B 7F02              MOV      R7,#02H
B3:00D17D 1280A2            LCALL    ___ZW_memcpy
B3:00D180 90418F            MOV      DPTR,#eventQueueCount
B3:00D183 E0                MOVX     A,@DPTR
B3:00D184 14                DEC      A
B3:00D185 F0                MOVX     @DPTR,A
B3:00D186 D3                SETB     C
B3:00D187 22                RET      
B3:00D188         ?C0003?ZW_EVENT:
B3:00D188 904384            MOV      DPTR,#pbEvent
B3:00D18B E0                MOVX     A,@DPTR
B3:00D18C F8                MOV      R0,A
B3:00D18D E4                CLR      A
B3:00D18E F6                MOV      @R0,A
B3:00D18F C3                CLR      C
B3:00D190 22                RET      
----- FUNCTION _EventPop (END) -------


----- FUNCTION _ZCB_ExploreComplete (BEGIN) -----
B3:00D191 900ACD            MOV      DPTR,#bTxStatus
B3:00D194 127088            LCALL    ?L?COM00F4
B3:00D197 900ACE            MOV      DPTR,#pTxStatusReport
B3:00D19A 122589            LCALL    ?C?PLDXDATA
B3:00D19D 126149            LCALL    ?L?COM0047
B3:00D1A0 7B01              MOV      R3,#01H
B3:00D1A2 7A09              MOV      R2,#HIGH currentTxStatusReport
B3:00D1A4 79A4              MOV      R1,#LOW currentTxStatusReport
B3:00D1A6 7F13              MOV      R7,#013H
B3:00D1A8 1280A2            LCALL    ___ZW_memcpy
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1037


B3:00D1AB 900ACD            MOV      DPTR,#bTxStatus
B3:00D1AE E0                MOVX     A,@DPTR
B3:00D1AF FD                MOV      R5,A
B3:00D1B0 7F04              MOV      R7,#04H
B3:00D1B2 211D              AJMP     _EventPush
----- FUNCTION _ZCB_ExploreComplete (END) -------


----- FUNCTION ?L?COM01D1 (BEGIN) -----
B3:00D1B4 902E6E            MOV      DPTR,#ext_data
B3:00D1B7 122589            LCALL    ?C?PLDXDATA
B3:00D1BA 121FB3            LCALL    ?C?CLDPTR
B3:00D1BD FF                MOV      R7,A
B3:00D1BE 902E71            MOV      DPTR,#ext_len
B3:00D1C1 F0                MOVX     @DPTR,A
B3:00D1C2 A3                INC      DPTR
B3:00D1C3         ?L?COM01D2:
B3:00D1C3 E4                CLR      A
B3:00D1C4 8FF0              MOV      B,R7
B3:00D1C6 022143            LJMP     ?C?IILDX
----- FUNCTION ?L?COM01D1 (END) -------


----- FUNCTION sec0_clear_netkey (BEGIN) -----
B3:00D1C9 7F80              MOV      R7,#080H
B3:00D1CB 021AE3            LJMP     ?INTERBANK_TABLE?_keystore_network_key_clear
----- FUNCTION sec0_clear_netkey (END) -------


----- FUNCTION _secure_learnIface_set_net_scheme (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00D1CE 900014            MOV      DPTR,#014H
B3:00D1D1 022475            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_net_scheme (END) -------


----- FUNCTION _secure_learnIface_set_isController (BEGIN) -----
;---- Variable 'value' assigned to Register 'R5' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00D1D4 90000B            MOV      DPTR,#0BH
B3:00D1D7 ED                MOV      A,R5
B3:00D1D8 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_set_isController (END) -------


----- FUNCTION ?L?COM0614 (BEGIN) -----
B3:00D1DB 7401              MOV      A,#01H
B3:00D1DD 29                ADD      A,R1
B3:00D1DE F9                MOV      R1,A
B3:00D1DF E4                CLR      A
B3:00D1E0 3A                ADDC     A,R2
B3:00D1E1 FA                MOV      R2,A
B3:00D1E2 22                RET      
----- FUNCTION ?L?COM0614 (END) -------


----- FUNCTION ?L?COM0450 (BEGIN) -----
B3:00D1E3 A3                INC      DPTR
B3:00D1E4 1225A9            LCALL    ?C?PSTXDATA
B3:00D1E7 0B                INC      R3
B3:00D1E8 7A25              MOV      R2,#HIGH the_tx_session+0BH
B3:00D1EA 79A8              MOV      R1,#LOW the_tx_session+0BH
B3:00D1EC 021B10            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION ?L?COM0450 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1038




----- FUNCTION ExploreFrameIgnoreTick (BEGIN) -----
;---- Variable 'i' assigned to Register 'R7' ----
B3:00D1EF E4                CLR      A
B3:00D1F0 FF                MOV      R7,A
B3:00D1F1         ?C0047?ZW_EXPLORE:
B3:00D1F1 EF                MOV      A,R7
B3:00D1F2 511B              ACALL    ?L?COM026D
B3:00D1F4 E6                MOV      A,@R0
B3:00D1F5 FC                MOV      R4,A
B3:00D1F6 08                INC      R0
B3:00D1F7 E6                MOV      A,@R0
B3:00D1F8 4C                ORL      A,R4
B3:00D1F9 6019              JZ       ?C0049?ZW_EXPLORE
B3:00D1FB EF                MOV      A,R7
B3:00D1FC 511B              ACALL    ?L?COM026D
B3:00D1FE 08                INC      R0
B3:00D1FF E6                MOV      A,@R0
B3:00D200 16                DEC      @R0
B3:00D201 18                DEC      R0
B3:00D202 7001              JNZ      ?C0143?ZW_EXPLORE
B3:00D204 16                DEC      @R0
B3:00D205         ?C0143?ZW_EXPLORE:
B3:00D205 14                DEC      A
B3:00D206 8604              MOV      AR4,@R0
B3:00D208 4C                ORL      A,R4
B3:00D209 7009              JNZ      ?C0049?ZW_EXPLORE
B3:00D20B 5184              ACALL    ?L?COM046E
B3:00D20D 76FF              MOV      @R0,#0FFH
B3:00D20F EF                MOV      A,R7
B3:00D210 517C              ACALL    ?L?COM033B
B3:00D212 E4                CLR      A
B3:00D213 F6                MOV      @R0,A
B3:00D214         ?C0049?ZW_EXPLORE:
B3:00D214 0F                INC      R7
B3:00D215 EF                MOV      A,R7
B3:00D216 B402D8            CJNE     A,#02H,?C0047?ZW_EXPLORE
B3:00D219 22                RET      
----- FUNCTION ExploreFrameIgnoreTick (END) -------


----- FUNCTION ?L?COM026C (BEGIN) -----
B3:00D21A EE                MOV      A,R6
B3:00D21B         ?L?COM026D:
B3:00D21B 25E0              ADD      A,ACC
B3:00D21D 25E0              ADD      A,ACC
B3:00D21F 2458              ADD      A,#LOW exploreFrameIgnoreQueue+02H
B3:00D221 F8                MOV      R0,A
B3:00D222 22                RET      
----- FUNCTION ?L?COM026C (END) -------


----- FUNCTION _ExploreFrameIgnoreQueueIndex (BEGIN) -----
;---- Variable 'j' assigned to Register 'R1' ----
;---- Variable 'bSourceNode' assigned to Register 'R7' ----
B3:00D223 EF                MOV      A,R7
B3:00D224 7002              JNZ      ?C0076?ZW_EXPLORE
B3:00D226 7FEF              MOV      R7,#0EFH
B3:00D228         ?C0076?ZW_EXPLORE:
B3:00D228 900B0E            MOV      DPTR,#i
B3:00D22B 74FF              MOV      A,#0FFH
B3:00D22D F0                MOVX     @DPTR,A
;---- Variable 'n' assigned to Register 'R4/R5' ----
B3:00D22E FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1039


B3:00D22F FC                MOV      R4,A
;---- Variable 'foundSlotIndex' assigned to Register 'R6' ----
B3:00D230 E4                CLR      A
B3:00D231 FE                MOV      R6,A
B3:00D232         ?C0077?ZW_EXPLORE:
B3:00D232 511A              ACALL    ?L?COM026C
B3:00D234 E6                MOV      A,@R0
B3:00D235 FA                MOV      R2,A
B3:00D236 08                INC      R0
B3:00D237 E6                MOV      A,@R0
B3:00D238 FB                MOV      R3,A
B3:00D239 D3                SETB     C
B3:00D23A 9D                SUBB     A,R5
B3:00D23B EA                MOV      A,R2
B3:00D23C 9C                SUBB     A,R4
B3:00D23D 5006              JNC      ?C0080?ZW_EXPLORE
B3:00D23F AC02              MOV      R4,AR2
B3:00D241 AD03              MOV      R5,AR3
B3:00D243 A906              MOV      R1,AR6
B3:00D245         ?C0080?ZW_EXPLORE:
B3:00D245 517B              ACALL    ?L?COM033A
B3:00D247 E6                MOV      A,@R0
B3:00D248 B50704            CJNE     A,AR7,?C0081?ZW_EXPLORE
B3:00D24B A906              MOV      R1,AR6
B3:00D24D 8013              SJMP     ?C0078?ZW_EXPLORE
B3:00D24F         ?C0081?ZW_EXPLORE:
B3:00D24F 511A              ACALL    ?L?COM026C
B3:00D251 E6                MOV      A,@R0
B3:00D252 FA                MOV      R2,A
B3:00D253 08                INC      R0
B3:00D254 E6                MOV      A,@R0
B3:00D255 4A                ORL      A,R2
B3:00D256 7005              JNZ      ?C0079?ZW_EXPLORE
B3:00D258 900B0E            MOV      DPTR,#i
B3:00D25B EE                MOV      A,R6
B3:00D25C F0                MOVX     @DPTR,A
B3:00D25D         ?C0079?ZW_EXPLORE:
B3:00D25D 0E                INC      R6
B3:00D25E EE                MOV      A,R6
B3:00D25F B402D0            CJNE     A,#02H,?C0077?ZW_EXPLORE
B3:00D262         ?C0078?ZW_EXPLORE:
B3:00D262 EE                MOV      A,R6
B3:00D263 C3                CLR      C
B3:00D264 9402              SUBB     A,#02H
B3:00D266 4010              JC       ?C0084?ZW_EXPLORE
B3:00D268 900B0E            MOV      DPTR,#i
B3:00D26B E0                MOVX     A,@DPTR
B3:00D26C FE                MOV      R6,A
B3:00D26D 94FF              SUBB     A,#0FFH
B3:00D26F 5002              JNC      ?C0085?ZW_EXPLORE
B3:00D271 A906              MOV      R1,AR6
B3:00D273         ?C0085?ZW_EXPLORE:
B3:00D273 E9                MOV      A,R1
B3:00D274 517C              ACALL    ?L?COM033B
B3:00D276 A607              MOV      @R0,AR7
B3:00D278         ?C0084?ZW_EXPLORE:
B3:00D278 AF01              MOV      R7,AR1
B3:00D27A 22                RET      
----- FUNCTION _ExploreFrameIgnoreQueueIndex (END) -------


----- FUNCTION ?L?COM033A (BEGIN) -----
B3:00D27B EE                MOV      A,R6
B3:00D27C         ?L?COM033B:
B3:00D27C 25E0              ADD      A,ACC
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1040


B3:00D27E 25E0              ADD      A,ACC
B3:00D280 2456              ADD      A,#LOW exploreFrameIgnoreQueue
B3:00D282 F8                MOV      R0,A
B3:00D283 22                RET      
----- FUNCTION ?L?COM033A (END) -------


----- FUNCTION ?L?COM046E (BEGIN) -----
B3:00D284 EF                MOV      A,R7
B3:00D285         ?L?COM046F:
B3:00D285 25E0              ADD      A,ACC
B3:00D287 25E0              ADD      A,ACC
B3:00D289 2457              ADD      A,#LOW exploreFrameIgnoreQueue+01H
B3:00D28B F8                MOV      R0,A
B3:00D28C 22                RET      
----- FUNCTION ?L?COM046E (END) -------


----- FUNCTION ExploreQueueIndex (BEGIN) -----
;---- Variable 'i' assigned to Register 'R7' ----
B3:00D28D E4                CLR      A
B3:00D28E FF                MOV      R7,A
B3:00D28F         ?C0071?ZW_EXPLORE:
B3:00D28F EF                MOV      A,R7
B3:00D290 7184              ACALL    ?L?COM0434
B3:00D292 E0                MOVX     A,@DPTR
B3:00D293 6005              JZ       ?C0072?ZW_EXPLORE
B3:00D295         ?C0074?ZW_EXPLORE:
B3:00D295         ?C0073?ZW_EXPLORE:
B3:00D295 0F                INC      R7
B3:00D296 EF                MOV      A,R7
B3:00D297 B402F5            CJNE     A,#02H,?C0071?ZW_EXPLORE
B3:00D29A         ?C0072?ZW_EXPLORE:
B3:00D29A 22                RET      
----- FUNCTION ExploreQueueIndex (END) -------


----- FUNCTION _ExploreFrameIgnoreCheck (BEGIN) -----
;---- Variable 'sourceID' assigned to Register 'R7' ----
;---- Variable 'sequenceNo' assigned to Register 'R5' ----
B3:00D29B 901221            MOV      DPTR,#nodeID
B3:00D29E E0                MOVX     A,@DPTR
B3:00D29F B50702            CJNE     A,AR7,?C0087?ZW_EXPLORE
B3:00D2A2 D3                SETB     C
B3:00D2A3 22                RET      
B3:00D2A4         ?C0087?ZW_EXPLORE:
B3:00D2A4 EF                MOV      A,R7
B3:00D2A5 7002              JNZ      ?C0089?ZW_EXPLORE
B3:00D2A7 7FEF              MOV      R7,#0EFH
B3:00D2A9         ?C0089?ZW_EXPLORE:
;---- Variable 'i' assigned to Register 'R6' ----
B3:00D2A9 E4                CLR      A
B3:00D2AA FE                MOV      R6,A
B3:00D2AB         ?C0090?ZW_EXPLORE:
B3:00D2AB 511A              ACALL    ?L?COM026C
B3:00D2AD E6                MOV      A,@R0
B3:00D2AE FA                MOV      R2,A
B3:00D2AF 08                INC      R0
B3:00D2B0 E6                MOV      A,@R0
B3:00D2B1 4A                ORL      A,R2
B3:00D2B2 601F              JZ       ?C0092?ZW_EXPLORE
B3:00D2B4 EF                MOV      A,R7
B3:00D2B5 B4EF08            CJNE     A,#0EFH,?C0094?ZW_EXPLORE
B3:00D2B8 517B              ACALL    ?L?COM033A
B3:00D2BA E6                MOV      A,@R0
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1041


B3:00D2BB B4FE02            CJNE     A,#0FEH,?C0094?ZW_EXPLORE
B3:00D2BE D3                SETB     C
B3:00D2BF 22                RET      
B3:00D2C0         ?C0094?ZW_EXPLORE:
B3:00D2C0 517B              ACALL    ?L?COM033A
B3:00D2C2 E6                MOV      A,@R0
B3:00D2C3 B5070D            CJNE     A,AR7,?C0092?ZW_EXPLORE
B3:00D2C6 EE                MOV      A,R6
B3:00D2C7 5185              ACALL    ?L?COM046F
B3:00D2C9 E6                MOV      A,@R0
B3:00D2CA 6D                XRL      A,R5
B3:00D2CB 6004              JZ       ?C0097?ZW_EXPLORE
B3:00D2CD EF                MOV      A,R7
B3:00D2CE B4EF02            CJNE     A,#0EFH,?C0092?ZW_EXPLORE
B3:00D2D1         ?C0097?ZW_EXPLORE:
B3:00D2D1 D3                SETB     C
B3:00D2D2 22                RET      
B3:00D2D3         ?C0092?ZW_EXPLORE:
B3:00D2D3 0E                INC      R6
B3:00D2D4 EE                MOV      A,R6
B3:00D2D5 B402D3            CJNE     A,#02H,?C0090?ZW_EXPLORE
B3:00D2D8         ?C0091?ZW_EXPLORE:
B3:00D2D8 C3                CLR      C
B3:00D2D9 22                RET      
----- FUNCTION _ExploreFrameIgnoreCheck (END) -------


----- FUNCTION _ExplorePurgeQueue (BEGIN) -----
B3:00D2DA 900B02            MOV      DPTR,#sourceID
B3:00D2DD EF                MOV      A,R7
B3:00D2DE F0                MOVX     @DPTR,A
B3:00D2DF 901221            MOV      DPTR,#nodeID
B3:00D2E2 E0                MOVX     A,@DPTR
B3:00D2E3 6F                XRL      A,R7
B3:00D2E4 7002              JNZ      $ + 4H
B3:00D2E6 6173              AJMP     ?C0104?ZW_EXPLORE
B3:00D2E8 E4                CLR      A
B3:00D2E9 900B03            MOV      DPTR,#j
B3:00D2EC F0                MOVX     @DPTR,A
B3:00D2ED         ?C0099?ZW_EXPLORE:
B3:00D2ED 900B03            MOV      DPTR,#j
B3:00D2F0 E0                MOVX     A,@DPTR
B3:00D2F1 FF                MOV      R7,A
B3:00D2F2 C3                CLR      C
B3:00D2F3 9402              SUBB     A,#02H
B3:00D2F5 5067              JNC      ?C0100?ZW_EXPLORE
B3:00D2F7 EF                MOV      A,R7
B3:00D2F8 7178              ACALL    ?L?COM0307
B3:00D2FA 124699            LCALL    ?L?COM0226
B3:00D2FD 4E                ORL      A,R6
B3:00D2FE 604E              JZ       ?C0102?ZW_EXPLORE
B3:00D300 900B03            MOV      DPTR,#j
B3:00D303 E0                MOVX     A,@DPTR
B3:00D304 75F060            MOV      B,#060H
B3:00D307 A4                MUL      AB
B3:00D308 24A1              ADD      A,#LOW exploreQueue+09H
B3:00D30A F582              MOV      DPL,A
B3:00D30C E4                CLR      A
B3:00D30D 3408              ADDC     A,#HIGH exploreQueue+09H
B3:00D30F 124699            LCALL    ?L?COM0226
B3:00D312 FF                MOV      R7,A
B3:00D313 1251F8            LCALL    _getTickTimePassed
B3:00D316 900B03            MOV      DPTR,#j
B3:00D319 E0                MOVX     A,@DPTR
B3:00D31A FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1042


B3:00D31B 75F060            MOV      B,#060H
B3:00D31E A4                MUL      AB
B3:00D31F 24A3              ADD      A,#LOW exploreQueue+0BH
B3:00D321 F582              MOV      DPL,A
B3:00D323 E4                CLR      A
B3:00D324 3408              ADDC     A,#HIGH exploreQueue+0BH
B3:00D326 F583              MOV      DPH,A
B3:00D328 EE                MOV      A,R6
B3:00D329 F0                MOVX     @DPTR,A
B3:00D32A A3                INC      DPTR
B3:00D32B EF                MOV      A,R7
B3:00D32C F0                MOVX     @DPTR,A
B3:00D32D ED                MOV      A,R5
B3:00D32E 75F060            MOV      B,#060H
B3:00D331 A4                MUL      AB
B3:00D332 24A3              ADD      A,#LOW exploreQueue+0BH
B3:00D334 F9                MOV      R1,A
B3:00D335 7408              MOV      A,#HIGH exploreQueue+0BH
B3:00D337 35F0              ADDC     A,B
B3:00D339 FA                MOV      R2,A
B3:00D33A 7B01              MOV      R3,#01H
B3:00D33C 7174              ACALL    ?L?COM0306
B3:00D33E 124699            LCALL    ?L?COM0226
B3:00D341 F582              MOV      DPL,A
B3:00D343 127168            LCALL    ?L?COM0308
B3:00D346 7174              ACALL    ?L?COM0306
B3:00D348 F583              MOV      DPH,A
B3:00D34A E4                CLR      A
B3:00D34B F0                MOVX     @DPTR,A
B3:00D34C A3                INC      DPTR
B3:00D34D F0                MOVX     @DPTR,A
B3:00D34E         ?C0102?ZW_EXPLORE:
B3:00D34E 900B03            MOV      DPTR,#j
B3:00D351 E0                MOVX     A,@DPTR
B3:00D352 7184              ACALL    ?L?COM0434
B3:00D354 E4                CLR      A
B3:00D355 F0                MOVX     @DPTR,A
B3:00D356 900B03            MOV      DPTR,#j
B3:00D359 E0                MOVX     A,@DPTR
B3:00D35A 04                INC      A
B3:00D35B F0                MOVX     @DPTR,A
B3:00D35C 808F              SJMP     ?C0099?ZW_EXPLORE
B3:00D35E         ?C0100?ZW_EXPLORE:
B3:00D35E C20E              CLR      bExploreSlotTaken
B3:00D360 900B02            MOV      DPTR,#sourceID
B3:00D363 E0                MOVX     A,@DPTR
B3:00D364 B4FE0C            CJNE     A,#0FEH,?C0104?ZW_EXPLORE
B3:00D367 7FFE              MOV      R7,#0FEH
B3:00D369 5123              ACALL    _ExploreFrameIgnoreQueueIndex
B3:00D36B EF                MOV      A,R7
B3:00D36C 511B              ACALL    ?L?COM026D
B3:00D36E 7607              MOV      @R0,#07H
B3:00D370 08                INC      R0
B3:00D371 76D0              MOV      @R0,#0D0H
B3:00D373         ?C0104?ZW_EXPLORE:
B3:00D373 22                RET      
----- FUNCTION _ExplorePurgeQueue (END) -------


----- FUNCTION ?L?COM0306 (BEGIN) -----
B3:00D374 900B03            MOV      DPTR,#j
B3:00D377 E0                MOVX     A,@DPTR
B3:00D378         ?L?COM0307:
B3:00D378 75F060            MOV      B,#060H
B3:00D37B A4                MUL      AB
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1043


B3:00D37C 24B6              ADD      A,#LOW exploreQueue+01EH
B3:00D37E F582              MOV      DPL,A
B3:00D380 E4                CLR      A
B3:00D381 3408              ADDC     A,#HIGH exploreQueue+01EH
B3:00D383 22                RET      
----- FUNCTION ?L?COM0306 (END) -------


----- FUNCTION ?L?COM0434 (BEGIN) -----
B3:00D384 75F060            MOV      B,#060H
B3:00D387 A4                MUL      AB
B3:00D388 2498              ADD      A,#LOW exploreQueue
B3:00D38A F582              MOV      DPL,A
B3:00D38C E4                CLR      A
B3:00D38D 3408              ADDC     A,#HIGH exploreQueue
B3:00D38F F583              MOV      DPH,A
B3:00D391 22                RET      
----- FUNCTION ?L?COM0434 (END) -------


----- FUNCTION _ZCB_ts_senddata_cb (BEGIN) -----
B3:00D392 904257            MOV      DPTR,#status_send
B3:00D395 127088            LCALL    ?L?COM00F4
B3:00D398 904258            MOV      DPTR,#txStatus
B3:00D39B 122589            LCALL    ?C?PLDXDATA
B3:00D39E 126149            LCALL    ?L?COM0047
B3:00D3A1 9135              ACALL    ?L?COM051F
B3:00D3A3 7F13              MOV      R7,#013H
B3:00D3A5 1280A2            LCALL    ___ZW_memcpy
B3:00D3A8 902A2B            MOV      DPTR,#scb+076H
B3:00D3AB E0                MOVX     A,@DPTR
B3:00D3AC 7002              JNZ      ?C0199?TRANSPORT_SERVICE2
B3:00D3AE A3                INC      DPTR
B3:00D3AF E0                MOVX     A,@DPTR
B3:00D3B0         ?C0199?TRANSPORT_SERVICE2:
B3:00D3B0 601E              JZ       ?C0046?TRANSPORT_SERVICE2
B3:00D3B2 9125              ACALL    clock_time
B3:00D3B4 902A2B            MOV      DPTR,#scb+076H
B3:00D3B7 912E              ACALL    ?L?COM02AE
B3:00D3B9 EF                MOV      A,R7
B3:00D3BA 9D                SUBB     A,R5
B3:00D3BB FF                MOV      R7,A
B3:00D3BC EE                MOV      A,R6
B3:00D3BD 9C                SUBB     A,R4
B3:00D3BE 902A2B            MOV      DPTR,#scb+076H
B3:00D3C1 F0                MOVX     @DPTR,A
B3:00D3C2 A3                INC      DPTR
B3:00D3C3 EF                MOV      A,R7
B3:00D3C4 F0                MOVX     @DPTR,A
B3:00D3C5 902A2B            MOV      DPTR,#scb+076H
B3:00D3C8 7401              MOV      A,#01H
B3:00D3CA 75F02C            MOV      B,#02CH
B3:00D3CD 122143            LCALL    ?C?IILDX
B3:00D3D0         ?C0046?TRANSPORT_SERVICE2:
B3:00D3D0         ?C0047?TRANSPORT_SERVICE2:
B3:00D3D0 902A23            MOV      DPTR,#scb+06EH
B3:00D3D3 E0                MOVX     A,@DPTR
B3:00D3D4 6008              JZ       ?C0048?TRANSPORT_SERVICE2
B3:00D3D6 E4                CLR      A
B3:00D3D7 F0                MOVX     @DPTR,A
B3:00D3D8 FB                MOV      R3,A
B3:00D3D9 FA                MOV      R2,A
B3:00D3DA F9                MOV      R1,A
B3:00D3DB 02CBEC            LJMP     _reply_frag_req
B3:00D3DE         ?C0048?TRANSPORT_SERVICE2:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1044


B3:00D3DE 902A22            MOV      DPTR,#scb+06DH
B3:00D3E1 E0                MOVX     A,@DPTR
B3:00D3E2 6005              JZ       ?C0050?TRANSPORT_SERVICE2
B3:00D3E4 E4                CLR      A
B3:00D3E5 F0                MOVX     @DPTR,A
B3:00D3E6 02CE3C            LJMP     send_frag_wait_cmd
B3:00D3E9         ?C0050?TRANSPORT_SERVICE2:
B3:00D3E9 913C              ACALL    ?L?COM053A
B3:00D3EB B5070B            CJNE     A,AR7,?C0051?TRANSPORT_SERVICE2
B3:00D3EE 7B01              MOV      R3,#01H
B3:00D3F0 7A2A              MOV      R2,#HIGH scb+04EH
B3:00D3F2 7903              MOV      R1,#LOW scb+04EH
B3:00D3F4 121B15            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00D3F7 8024              SJMP     ?C0052?TRANSPORT_SERVICE2
B3:00D3F9         ?C0051?TRANSPORT_SERVICE2:
B3:00D3F9 902A2C            MOV      DPTR,#scb+077H
B3:00D3FC E0                MOVX     A,@DPTR
B3:00D3FD 240F              ADD      A,#0FH
B3:00D3FF 902A2B            MOV      DPTR,#scb+076H
B3:00D402 1273A3            LCALL    ?L?COM059A
B3:00D405 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00D408 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_send_subseq_frag
B3:00D40A F0                MOVX     @DPTR,A
B3:00D40B A3                INC      DPTR
B3:00D40C 748B              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_send_subseq_frag
B3:00D40E 12BDF7            LCALL    ?L?COM0031
B3:00D411 A3                INC      DPTR
B3:00D412 1225A9            LCALL    ?C?PSTXDATA
B3:00D415 0B                INC      R3
B3:00D416 7A2A              MOV      R2,#HIGH scb+04EH
B3:00D418 7903              MOV      R1,#LOW scb+04EH
B3:00D41A 121B10            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:00D41D         ?C0052?TRANSPORT_SERVICE2:
B3:00D41D E4                CLR      A
B3:00D41E 902A2B            MOV      DPTR,#scb+076H
B3:00D421 F0                MOVX     @DPTR,A
B3:00D422 A3                INC      DPTR
B3:00D423 F0                MOVX     @DPTR,A
B3:00D424 22                RET      
----- FUNCTION _ZCB_ts_senddata_cb (END) -------


----- FUNCTION clock_time (BEGIN) -----
B3:00D425 1251E9            LCALL    getTickTime
B3:00D428 0247C4            LJMP     ?L?COM060F
----- FUNCTION clock_time (END) -------


----- FUNCTION ?L?COM02AD (BEGIN) -----
B3:00D42B 9029BB            MOV      DPTR,#scb+06H
B3:00D42E         ?L?COM02AE:
B3:00D42E E0                MOVX     A,@DPTR
B3:00D42F FC                MOV      R4,A
B3:00D430 A3                INC      DPTR
B3:00D431 E0                MOVX     A,@DPTR
B3:00D432 FD                MOV      R5,A
B3:00D433 C3                CLR      C
B3:00D434 22                RET      
----- FUNCTION ?L?COM02AD (END) -------


----- FUNCTION ?L?COM051F (BEGIN) -----
B3:00D435 7B01              MOV      R3,#01H
B3:00D437 7A29              MOV      R2,#HIGH scb+011H
B3:00D439 79C6              MOV      R1,#LOW scb+011H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1045


B3:00D43B 22                RET      
----- FUNCTION ?L?COM051F (END) -------


----- FUNCTION ?L?COM053A (BEGIN) -----
B3:00D43C 9029D9            MOV      DPTR,#scb+024H
B3:00D43F E0                MOVX     A,@DPTR
B3:00D440 FF                MOV      R7,A
B3:00D441 9029E2            MOV      DPTR,#scb+02DH
B3:00D444 E0                MOVX     A,@DPTR
B3:00D445 22                RET      
----- FUNCTION ?L?COM053A (END) -------


----- FUNCTION s2_joining_start (BEGIN) -----
B3:00D446 E4                CLR      A
B3:00D447 9020E4            MOV      DPTR,#the_context+0D1H
B3:00D44A F0                MOVX     @DPTR,A
B3:00D44B 7FFF              MOV      R7,#0FFH
B3:00D44D 121AE3            LCALL    ?INTERBANK_TABLE?_keystore_network_key_clear
B3:00D450 7F70              MOV      R7,#070H
B3:00D452 7E17              MOV      R6,#017H
B3:00D454 7D00              MOV      R5,#00H
B3:00D456 7C00              MOV      R4,#00H
B3:00D458 029FF2            LJMP     _s2_inclusion_set_timeout
----- FUNCTION s2_joining_start (END) -------


----- FUNCTION _ZCB_temp_callback_last_frag (BEGIN) -----
B3:00D45B 904253            MOV      DPTR,#status
B3:00D45E 127088            LCALL    ?L?COM00F4
B3:00D461 904254            MOV      DPTR,#user
B3:00D464 122589            LCALL    ?C?PLDXDATA
B3:00D467 126149            LCALL    ?L?COM0047
B3:00D46A 9135              ACALL    ?L?COM051F
B3:00D46C 7F13              MOV      R7,#013H
B3:00D46E 0280A2            LJMP     ___ZW_memcpy
----- FUNCTION _ZCB_temp_callback_last_frag (END) -------


----- FUNCTION _ZCB_nonce_timer_timeout (BEGIN) -----
;---- Variable 'i' assigned to Register 'R7' ----
B3:00D471 E4                CLR      A
B3:00D472 FF                MOV      R7,A
B3:00D473         ?C0037?ZW_SECURITY_SCHEME0:
B3:00D473 129E52            LCALL    ?L?COM00D6
B3:00D476 E0                MOVX     A,@DPTR
B3:00D477 D3                SETB     C
B3:00D478 9400              SUBB     A,#00H
B3:00D47A 4006              JC       ?C0039?ZW_SECURITY_SCHEME0
B3:00D47C 129E52            LCALL    ?L?COM00D6
B3:00D47F E0                MOVX     A,@DPTR
B3:00D480 14                DEC      A
B3:00D481 F0                MOVX     @DPTR,A
B3:00D482         ?C0039?ZW_SECURITY_SCHEME0:
B3:00D482 0F                INC      R7
B3:00D483 EF                MOV      A,R7
B3:00D484 B40FEC            CJNE     A,#0FH,?C0037?ZW_SECURITY_SCHEME0
B3:00D487         ?C0038?ZW_SECURITY_SCHEME0:
B3:00D487 919B              ACALL    ?L?COM03C8
B3:00D489 12BDF7            LCALL    ?L?COM0031
B3:00D48C 9191              ACALL    ?L?COM051A
B3:00D48E 021B10            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION _ZCB_nonce_timer_timeout (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1046



----- FUNCTION ?L?COM051A (BEGIN) -----
B3:00D491 A3                INC      DPTR
B3:00D492 1225A9            LCALL    ?C?PSTXDATA
B3:00D495 0B                INC      R3
B3:00D496 7A24              MOV      R2,#HIGH nonce_timer
B3:00D498 7973              MOV      R1,#LOW nonce_timer
B3:00D49A 22                RET      
----- FUNCTION ?L?COM051A (END) -------


----- FUNCTION ?L?COM03C8 (BEGIN) -----
B3:00D49B E4                CLR      A
B3:00D49C 7FE8              MOV      R7,#0E8H
B3:00D49E 7E03              MOV      R6,#03H
B3:00D4A0 FD                MOV      R5,A
B3:00D4A1 FC                MOV      R4,A
B3:00D4A2 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00D4A5 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_nonce_timer_timeout
B3:00D4A7 F0                MOVX     @DPTR,A
B3:00D4A8 A3                INC      DPTR
B3:00D4A9 743C              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_nonce_timer_timeout
B3:00D4AB 22                RET      
----- FUNCTION ?L?COM03C8 (END) -------


----- FUNCTION _ZCB_temp_callback_reply_frag_req (BEGIN) -----
B3:00D4AC 90425B            MOV      DPTR,#status
B3:00D4AF 127088            LCALL    ?L?COM00F4
B3:00D4B2 90425C            MOV      DPTR,#user
B3:00D4B5 122589            LCALL    ?C?PLDXDATA
B3:00D4B8 126149            LCALL    ?L?COM0047
B3:00D4BB 9135              ACALL    ?L?COM051F
B3:00D4BD 7F13              MOV      R7,#013H
B3:00D4BF 1280A2            LCALL    ___ZW_memcpy
B3:00D4C2 90425B            MOV      DPTR,#status
B3:00D4C5 E0                MOVX     A,@DPTR
B3:00D4C6 FF                MOV      R7,A
B3:00D4C7 6014              JZ       ?C0076?TRANSPORT_SERVICE2
B3:00D4C9 9029C4            MOV      DPTR,#scb+0FH
B3:00D4CC E0                MOVX     A,@DPTR
B3:00D4CD FC                MOV      R4,A
B3:00D4CE A3                INC      DPTR
B3:00D4CF E0                MOVX     A,@DPTR
B3:00D4D0 FD                MOV      R5,A
B3:00D4D1 4C                ORL      A,R4
B3:00D4D2 6009              JZ       ?C0076?TRANSPORT_SERVICE2
B3:00D4D4 90425C            MOV      DPTR,#user
B3:00D4D7 122589            LCALL    ?C?PLDXDATA
B3:00D4DA 1272EC            LCALL    ?L?COM0491
B3:00D4DD         ?C0076?TRANSPORT_SERVICE2:
B3:00D4DD 7F1A              MOV      R7,#01AH
B3:00D4DF 02BD5A            LJMP     _t2_sm_post_event
----- FUNCTION _ZCB_temp_callback_reply_frag_req (END) -------


----- FUNCTION _IsNetworkHomeIDValid (BEGIN) -----
B3:00D4E2 900B04            MOV      DPTR,#pNetworkHomeID
B3:00D4E5 127332            LCALL    ?L?COM04E5
B3:00D4E8 C002              PUSH     AR2
B3:00D4EA C001              PUSH     AR1
B3:00D4EC 7A12              MOV      R2,#HIGH homeID
B3:00D4EE 7923              MOV      R1,#LOW homeID
B3:00D4F0 904064            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B3:00D4F3 1225A9            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1047


B3:00D4F6 D001              POP      AR1
B3:00D4F8 D002              POP      AR2
B3:00D4FA 7F04              MOV      R7,#04H
B3:00D4FC 1281BB            LCALL    ___ZW_memcmp
B3:00D4FF EF                MOV      A,R7
B3:00D500 7002              JNZ      ?C0105?ZW_EXPLORE
B3:00D502 D3                SETB     C
B3:00D503 22                RET      
B3:00D504         ?C0105?ZW_EXPLORE:
B3:00D504 900B04            MOV      DPTR,#pNetworkHomeID
B3:00D507 B13C              ACALL    ?L?COM0180
B3:00D509 8E83              MOV      DPH,R6
B3:00D50B A3                INC      DPTR
B3:00D50C E0                MOVX     A,@DPTR
B3:00D50D FD                MOV      R5,A
B3:00D50E 8F82              MOV      DPL,R7
B3:00D510 8E83              MOV      DPH,R6
B3:00D512 E0                MOVX     A,@DPTR
B3:00D513 4D                ORL      A,R5
B3:00D514 FF                MOV      R7,A
B3:00D515 900B04            MOV      DPTR,#pNetworkHomeID
B3:00D518 12515D            LCALL    ?L?COM0154
B3:00D51B A3                INC      DPTR
B3:00D51C A3                INC      DPTR
B3:00D51D E0                MOVX     A,@DPTR
B3:00D51E 4F                ORL      A,R7
B3:00D51F FF                MOV      R7,A
B3:00D520 8D82              MOV      DPL,R5
B3:00D522 8C83              MOV      DPH,R4
B3:00D524 A3                INC      DPTR
B3:00D525 A3                INC      DPTR
B3:00D526 A3                INC      DPTR
B3:00D527 E0                MOVX     A,@DPTR
B3:00D528 4F                ORL      A,R7
B3:00D529 C3                CLR      C
B3:00D52A 7001              JNZ      ?C0107?ZW_EXPLORE
B3:00D52C D3                SETB     C
B3:00D52D         ?C0107?ZW_EXPLORE:
B3:00D52D 22                RET      
----- FUNCTION _IsNetworkHomeIDValid (END) -------


----- FUNCTION ?L?COM017E (BEGIN) -----
B3:00D52E FF                MOV      R7,A
B3:00D52F 122589            LCALL    ?C?PLDXDATA
B3:00D532 90000C            MOV      DPTR,#0CH
B3:00D535 EF                MOV      A,R7
B3:00D536 122084            LCALL    ?C?CSTOPTR
B3:00D539         ?L?COM017F:
B3:00D539 9027FB            MOV      DPTR,#m_evt_handler
B3:00D53C         ?L?COM0180:
B3:00D53C E0                MOVX     A,@DPTR
B3:00D53D FE                MOV      R6,A
B3:00D53E A3                INC      DPTR
B3:00D53F E0                MOVX     A,@DPTR
B3:00D540 FF                MOV      R7,A
B3:00D541 F582              MOV      DPL,A
B3:00D543 22                RET      
----- FUNCTION ?L?COM017E (END) -------


----- FUNCTION s2_joining_complete (BEGIN) -----
B3:00D544 904303            MOV      DPTR,#s2_event
B3:00D547 B16C              ACALL    ?L?COM0332
B3:00D549 129EE5            LCALL    ?L?COM05D5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1048


B3:00D54C 904303            MOV      DPTR,#s2_event
B3:00D54F 122589            LCALL    ?C?PLDXDATA
B3:00D552 12252E            LCALL    ?C?LSTKPTR
B3:00D555 00                DB       00H
B3:00D556 00                DB       00H
B3:00D557 00                DB       00H
B3:00D558 04                DB       04H
B3:00D559 904303            MOV      DPTR,#s2_event
B3:00D55C B175              ACALL    ?L?COM00DD
B3:00D55E 9020D7            MOV      DPTR,#the_context+0C4H
B3:00D561 E0                MOVX     A,@DPTR
B3:00D562 904303            MOV      DPTR,#s2_event
B3:00D565 B12E              ACALL    ?L?COM017E
B3:00D567 8E83              MOV      DPH,R6
B3:00D569 02271A            LJMP     ?C?ICALL2
----- FUNCTION s2_joining_complete (END) -------


----- FUNCTION ?L?COM0332 (BEGIN) -----
B3:00D56C 7B01              MOV      R3,#01H
B3:00D56E 7A27              MOV      R2,#HIGH m_event_buffer
B3:00D570 797B              MOV      R1,#LOW m_event_buffer
B3:00D572 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0332 (END) -------


----- FUNCTION ?L?COM00DD (BEGIN) -----
B3:00D575 122589            LCALL    ?C?PLDXDATA
B3:00D578 E9                MOV      A,R1
B3:00D579 2404              ADD      A,#04H
B3:00D57B F9                MOV      R1,A
B3:00D57C E4                CLR      A
B3:00D57D 3A                ADDC     A,R2
B3:00D57E A801              MOV      R0,AR1
B3:00D580 FC                MOV      R4,A
B3:00D581 AD03              MOV      R5,AR3
B3:00D583 7B01              MOV      R3,#01H
B3:00D585 7A20              MOV      R2,#HIGH the_context+0CFH
B3:00D587 79E2              MOV      R1,#LOW the_context+0CFH
B3:00D589         ?L?COM00DE:
B3:00D589 7E00              MOV      R6,#00H
B3:00D58B 7F08              MOV      R7,#08H
B3:00D58D 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM00DD (END) -------


----- FUNCTION ZCB_NWITimeout (BEGIN) -----
B3:00D590 904227            MOV      DPTR,#timeoutNWICount
B3:00D593 1272FA            LCALL    ?L?COM049B
B3:00D596 45F0              ORL      A,B
B3:00D598 7005              JNZ      ?C0003?ZW_EXPLORE_SUPPORT
B3:00D59A C20C              CLR      exploreInclusionModeRepeat
B3:00D59C 12A847            LCALL    NWIStopTimer
B3:00D59F         ?C0003?ZW_EXPLORE_SUPPORT:
B3:00D59F 22                RET      
----- FUNCTION ZCB_NWITimeout (END) -------


----- FUNCTION ___S2_set_peer (BEGIN) -----
;---- Variable 'peer' assigned to Register 'R1/R2/R3' ----
B3:00D5A0 78E2              MOV      R0,#LOW the_context+0CFH
B3:00D5A2 7C20              MOV      R4,#HIGH the_context+0CFH
B3:00D5A4 7D01              MOV      R5,#01H
B3:00D5A6 B189              ACALL    ?L?COM00DE
B3:00D5A8 903FCF            MOV      DPTR,#buf
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1049


B3:00D5AB 122589            LCALL    ?C?PLDXDATA
B3:00D5AE 9020EA            MOV      DPTR,#the_context+0D7H
B3:00D5B1 1225A9            LCALL    ?C?PSTXDATA
B3:00D5B4 903FD2            MOV      DPTR,#len
B3:00D5B7 12A41C            LCALL    ?L?COM036F
B3:00D5BA F0                MOVX     @DPTR,A
B3:00D5BB 22                RET      
----- FUNCTION ___S2_set_peer (END) -------


----- FUNCTION _inclusion_failed_evt_push (BEGIN) -----
B3:00D5BC 904243            MOV      DPTR,#fail_type
B3:00D5BF EF                MOV      A,R7
B3:00D5C0 F0                MOVX     @DPTR,A
B3:00D5C1 A3                INC      DPTR
B3:00D5C2 B16C              ACALL    ?L?COM0332
B3:00D5C4 129EE5            LCALL    ?L?COM05D5
B3:00D5C7 904244            MOV      DPTR,#p_s2_event
B3:00D5CA 122589            LCALL    ?C?PLDXDATA
B3:00D5CD 12252E            LCALL    ?C?LSTKPTR
B3:00D5D0 00                DB       00H
B3:00D5D1 00                DB       00H
B3:00D5D2 00                DB       00H
B3:00D5D3 05                DB       05H
B3:00D5D4 904244            MOV      DPTR,#p_s2_event
B3:00D5D7 B175              ACALL    ?L?COM00DD
B3:00D5D9 904243            MOV      DPTR,#fail_type
B3:00D5DC E0                MOVX     A,@DPTR
B3:00D5DD A3                INC      DPTR
B3:00D5DE B12E              ACALL    ?L?COM017E
B3:00D5E0 8E83              MOV      DPH,R6
B3:00D5E2 02271A            LJMP     ?C?ICALL2
----- FUNCTION _inclusion_failed_evt_push (END) -------


----- FUNCTION s2_send_kex_report (BEGIN) -----
B3:00D5E5 9042FD            MOV      DPTR,#p_s2_event
B3:00D5E8 D141              ACALL    ?L?COM050D
B3:00D5EA 12252E            LCALL    ?C?LSTKPTR
B3:00D5ED 00                DB       00H
B3:00D5EE 00                DB       00H
B3:00D5EF 00                DB       00H
B3:00D5F0 00                DB       00H
B3:00D5F1 9042FD            MOV      DPTR,#p_s2_event
B3:00D5F4 B175              ACALL    ?L?COM00DD
B3:00D5F6 9042FD            MOV      DPTR,#p_s2_event
B3:00D5F9 122589            LCALL    ?C?PLDXDATA
B3:00D5FC B139              ACALL    ?L?COM017F
B3:00D5FE 8E83              MOV      DPH,R6
B3:00D600 12271A            LCALL    ?C?ICALL2
B3:00D603 902223            MOV      DPTR,#the_context+0210H
B3:00D606 E0                MOVX     A,@DPTR
B3:00D607 7F00              MOV      R7,#00H
B3:00D609 7002              JNZ      ?C0093?S2_INCLUSION
B3:00D60B 7F02              MOV      R7,#02H
B3:00D60D         ?C0093?S2_INCLUSION:
B3:00D60D         ?C0094?S2_INCLUSION:
B3:00D60D 9020D3            MOV      DPTR,#the_context+0C0H
B3:00D610 EF                MOV      A,R7
B3:00D611 12AB0D            LCALL    ?L?COM024A
B3:00D614 7405              MOV      A,#05H
B3:00D616 F0                MOVX     @DPTR,A
B3:00D617 9020D3            MOV      DPTR,#the_context+0C0H
B3:00D61A E0                MOVX     A,@DPTR
B3:00D61B 902304            MOV      DPTR,#the_context+02F1H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1050


B3:00D61E F0                MOVX     @DPTR,A
B3:00D61F 90260D            MOV      DPTR,#m_schemes
B3:00D622 E0                MOVX     A,@DPTR
B3:00D623 902305            MOV      DPTR,#the_context+02F2H
B3:00D626 F0                MOVX     @DPTR,A
B3:00D627 90281D            MOV      DPTR,#m_curves
B3:00D62A E0                MOVX     A,@DPTR
B3:00D62B 902306            MOV      DPTR,#the_context+02F3H
B3:00D62E F0                MOVX     @DPTR,A
B3:00D62F 90260C            MOV      DPTR,#m_keys
B3:00D632 E0                MOVX     A,@DPTR
B3:00D633 902307            MOV      DPTR,#the_context+02F4H
B3:00D636 F0                MOVX     @DPTR,A
B3:00D637 7406              MOV      A,#06H
B3:00D639 12AB48            LCALL    ?L?COM042E
B3:00D63C D14A              ACALL    ?L?COM059C
B3:00D63E 029FF2            LJMP     _s2_inclusion_set_timeout
----- FUNCTION s2_send_kex_report (END) -------


----- FUNCTION ?L?COM050D (BEGIN) -----
B3:00D641 7B01              MOV      R3,#01H
B3:00D643 7A27              MOV      R2,#HIGH m_event_buffer
B3:00D645 797B              MOV      R1,#LOW m_event_buffer
B3:00D647 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM050D (END) -------


----- FUNCTION ?L?COM059C (BEGIN) -----
B3:00D64A 7FC0              MOV      R7,#0C0H
B3:00D64C 7E5D              MOV      R6,#05DH
B3:00D64E 7D00              MOV      R5,#00H
B3:00D650 7C00              MOV      R4,#00H
B3:00D652 22                RET      
----- FUNCTION ?L?COM059C (END) -------


----- FUNCTION remote_inclusion_failed_evt_push (BEGIN) -----
B3:00D653 9020EA            MOV      DPTR,#the_context+0D7H
B3:00D656 12AB1A            LCALL    ?L?COM010F
B3:00D659 FF                MOV      R7,A
B3:00D65A A1BC              AJMP     _inclusion_failed_evt_push
----- FUNCTION remote_inclusion_failed_evt_push (END) -------


----- FUNCTION NWIStartTimer (BEGIN) -----
B3:00D65C 904229            MOV      DPTR,#timeoutNWIInMin
B3:00D65F E0                MOVX     A,@DPTR
B3:00D660 75F018            MOV      B,#018H
B3:00D663 A4                MUL      AB
B3:00D664 FF                MOV      R7,A
B3:00D665 904227            MOV      DPTR,#timeoutNWICount
B3:00D668 E5F0              MOV      A,B
B3:00D66A 12C404            LCALL    ?L?COM0127
B3:00D66D 7A42              MOV      R2,#HIGH networkWideInclusionModeTimer
B3:00D66F 792A              MOV      R1,#LOW networkWideInclusionModeTimer
B3:00D671 7C1B              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_NWITimeout
B3:00D673 7DC9              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_NWITimeout
B3:00D675 904018            MOV      DPTR,#?_SafeTimerSysStart?BYTE+05H
B3:00D678 74FA              MOV      A,#0FAH
B3:00D67A F0                MOVX     @DPTR,A
B3:00D67B A3                INC      DPTR
B3:00D67C 74FF              MOV      A,#0FFH
B3:00D67E F0                MOVX     @DPTR,A
B3:00D67F 0257B6            LJMP     _SafeTimerSysStart
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1051


----- FUNCTION NWIStartTimer (END) -------


----- FUNCTION _ExploreSetNWITimeout (BEGIN) -----
;---- Variable 'timeout' assigned to Register 'R7' ----
B3:00D682 EF                MOV      A,R7
B3:00D683 7004              JNZ      ?C0005?ZW_EXPLORE_SUPPORT
B3:00D685 7F05              MOV      R7,#05H
B3:00D687 8000              SJMP     ?C0006?ZW_EXPLORE_SUPPORT
B3:00D689         ?C0005?ZW_EXPLORE_SUPPORT:
B3:00D689         ?C0006?ZW_EXPLORE_SUPPORT:
B3:00D689 904229            MOV      DPTR,#timeoutNWIInMin
B3:00D68C EF                MOV      A,R7
B3:00D68D F0                MOVX     @DPTR,A
B3:00D68E 22                RET      
----- FUNCTION _ExploreSetNWITimeout (END) -------


----- FUNCTION ZW_ExploreRequestInclusion (BEGIN) -----
B3:00D68F 904385            MOV      DPTR,#bExploreTransmitOptions
B3:00D692 7410              MOV      A,#010H
B3:00D694 F0                MOVX     @DPTR,A
B3:00D695 300166            JNB      learnMode,?C0003?ZW_EXPLORE_INCL_REQ
B3:00D698 200263            JB       findInProgress,?C0003?ZW_EXPLORE_INCL_REQ
B3:00D69B 12C052            LCALL    ?L?COM0611
B3:00D69E EF                MOV      A,R7
B3:00D69F 705D              JNZ      ?C0003?ZW_EXPLORE_INCL_REQ
B3:00D6A1 E550              MOV      A,bNetworkWideInclusion
B3:00D6A3 6401              XRL      A,#01H
B3:00D6A5 7057              JNZ      ?C0003?ZW_EXPLORE_INCL_REQ
B3:00D6A7 129E61            LCALL    GenerateNIF
B3:00D6AA 30031A            JNB      learnModeDsk,?C0004?ZW_EXPLORE_INCL_REQ
B3:00D6AD 1261BD            LCALL    NetworkManagementSmartStartIsInclude
B3:00D6B0 EF                MOV      A,R7
B3:00D6B1 90097B            MOV      DPTR,#exploreRequestBuffer+05H
B3:00D6B4 600C              JZ       ?C0005?ZW_EXPLORE_INCL_REQ
B3:00D6B6 7428              MOV      A,#028H
B3:00D6B8 F0                MOVX     @DPTR,A
B3:00D6B9 904385            MOV      DPTR,#bExploreTransmitOptions
B3:00D6BC E0                MOVX     A,@DPTR
B3:00D6BD 4408              ORL      A,#08H
B3:00D6BF F0                MOVX     @DPTR,A
B3:00D6C0 800C              SJMP     ?C0007?ZW_EXPLORE_INCL_REQ
B3:00D6C2         ?C0005?ZW_EXPLORE_INCL_REQ:
B3:00D6C2 7427              MOV      A,#027H
B3:00D6C4 F0                MOVX     @DPTR,A
B3:00D6C5 8007              SJMP     ?C0007?ZW_EXPLORE_INCL_REQ
B3:00D6C7         ?C0004?ZW_EXPLORE_INCL_REQ:
B3:00D6C7 904385            MOV      DPTR,#bExploreTransmitOptions
B3:00D6CA E0                MOVX     A,@DPTR
B3:00D6CB 4401              ORL      A,#01H
B3:00D6CD F0                MOVX     @DPTR,A
B3:00D6CE         ?C0007?ZW_EXPLORE_INCL_REQ:
B3:00D6CE 12A1F4            LCALL    ?L?COM035B
B3:00D6D1 902BE5            MOV      DPTR,#blnodeInfoLength
B3:00D6D4 E0                MOVX     A,@DPTR
B3:00D6D5 2404              ADD      A,#04H
B3:00D6D7 900A6F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B3:00D6DA F0                MOVX     @DPTR,A
B3:00D6DB 904385            MOV      DPTR,#bExploreTransmitOptions
B3:00D6DE E0                MOVX     A,@DPTR
B3:00D6DF 900A70            MOV      DPTR,#?_ExploreQueueFrame?BYTE+06H
B3:00D6E2 F0                MOVX     @DPTR,A
B3:00D6E3 300306            JNB      learnModeDsk,?C0008?ZW_EXPLORE_INCL_REQ
B3:00D6E6 7E40              MOV      R6,#HIGH _ZCB_NetworkManagementExploreRequestComplete
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1052


B3:00D6E8 7F1C              MOV      R7,#LOW _ZCB_NetworkManagementExploreRequestComplete
B3:00D6EA 8004              SJMP     ?C0009?ZW_EXPLORE_INCL_REQ
B3:00D6EC         ?C0008?ZW_EXPLORE_INCL_REQ:
B3:00D6EC 7E00              MOV      R6,#00H
B3:00D6EE 7F00              MOV      R7,#00H
B3:00D6F0         ?C0009?ZW_EXPLORE_INCL_REQ:
B3:00D6F0 EE                MOV      A,R6
B3:00D6F1 1270E3            LCALL    ?L?COM01CE
B3:00D6F4 901221            MOV      DPTR,#nodeID
B3:00D6F7 E0                MOVX     A,@DPTR
B3:00D6F8 FF                MOV      R7,A
B3:00D6F9 7DFF              MOV      R5,#0FFH
B3:00D6FB 0292A3            LJMP     _ExploreQueueFrame
B3:00D6FE         ?C0003?ZW_EXPLORE_INCL_REQ:
B3:00D6FE 7F00              MOV      R7,#00H
B3:00D700 22                RET      
----- FUNCTION ZW_ExploreRequestInclusion (END) -------


----- FUNCTION Power_Management_FLiRSSetup (BEGIN) -----
B3:00D701 125167            LCALL    ?L?COM04E4
B3:00D704 90122A            MOV      DPTR,#bldeviceOptionsMask
B3:00D707 E0                MOVX     A,@DPTR
B3:00D708 901240            MOV      DPTR,#extInt1Enabled
B3:00D70B 30E50D            JNB      ACC.5,?C0001?ZW_POWER_MANAGEMENT
B3:00D70E E0                MOVX     A,@DPTR
B3:00D70F FB                MOV      R3,A
B3:00D710 7D01              MOV      R5,#01H
B3:00D712 7F01              MOV      R7,#01H
B3:00D714 124848            LCALL    _ZW_power_down_mode_init
B3:00D717 7F1F              MOV      R7,#01FH
B3:00D719 8008              SJMP     ?C0022?ZW_POWER_MANAGEMENT
B3:00D71B         ?C0001?ZW_POWER_MANAGEMENT:
B3:00D71B 124875            LCALL    ?L?COM054F
B3:00D71E 124848            LCALL    _ZW_power_down_mode_init
B3:00D721 E4                CLR      A
B3:00D722 FF                MOV      R7,A
B3:00D723         
B3:00D723 02489F            LJMP     _ZW_power_down_wut_timeout
----- FUNCTION Power_Management_FLiRSSetup (END) -------


----- FUNCTION Power_Management_Check (BEGIN) -----
B3:00D726 901217            MOV      DPTR,#eSystemTypeState
B3:00D729 E0                MOVX     A,@DPTR
B3:00D72A FF                MOV      R7,A
B3:00D72B 20E203            JB       ACC.2,?C0011?ZW_POWER_MANAGEMENT
B3:00D72E 20E147            JB       ACC.1,?C0010?ZW_POWER_MANAGEMENT
B3:00D731         ?C0011?ZW_POWER_MANAGEMENT:
B3:00D731 F1AF              ACALL    ?L?COM03D7
B3:00D733 C3                CLR      C
B3:00D734 1223D4            LCALL    ?C?ULCMP
B3:00D737 7007              JNZ      ?C0012?ZW_POWER_MANAGEMENT
B3:00D739 901228            MOV      DPTR,#wakeupCountRest
B3:00D73C E0                MOVX     A,@DPTR
B3:00D73D 7001              JNZ      ?C0012?ZW_POWER_MANAGEMENT
B3:00D73F 22                RET      
B3:00D740         ?C0012?ZW_POWER_MANAGEMENT:
B3:00D740 F1AF              ACALL    ?L?COM03D7
B3:00D742 C3                CLR      C
B3:00D743 1223D4            LCALL    ?C?ULCMP
B3:00D746 6012              JZ       ?C0015?ZW_POWER_MANAGEMENT
B3:00D748 7FFF              MOV      R7,#0FFH
B3:00D74A 12489F            LCALL    _ZW_SetWutTimeout
B3:00D74D 901218            MOV      DPTR,#wakeupCount
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1053


B3:00D750 F1BD              ACALL    ?L?COM01FA
B3:00D752 901218            MOV      DPTR,#wakeupCount
B3:00D755 1224F1            LCALL    ?C?LSTXDATA
B3:00D758 800D              SJMP     ?C0014?ZW_POWER_MANAGEMENT
B3:00D75A         ?C0015?ZW_POWER_MANAGEMENT:
B3:00D75A 901228            MOV      DPTR,#wakeupCountRest
B3:00D75D E0                MOVX     A,@DPTR
B3:00D75E FF                MOV      R7,A
B3:00D75F 12489F            LCALL    _ZW_SetWutTimeout
B3:00D762 E4                CLR      A
B3:00D763 901228            MOV      DPTR,#wakeupCountRest
B3:00D766 F0                MOVX     @DPTR,A
B3:00D767         ?C0014?ZW_POWER_MANAGEMENT:
B3:00D767 125167            LCALL    ?L?COM04E4
B3:00D76A 901240            MOV      DPTR,#extInt1Enabled
B3:00D76D 124875            LCALL    ?L?COM054F
B3:00D770 124848            LCALL    _ZW_power_down_mode_init
B3:00D773 7F01              MOV      R7,#01H
B3:00D775 024881            LJMP     _ZW_power_down_mode
B3:00D778         ?C0010?ZW_POWER_MANAGEMENT:
B3:00D778 F101              ACALL    Power_Management_FLiRSSetup
B3:00D77A 7F05              MOV      R7,#05H
B3:;----                  JMP      _Power_Management_PowerDown
----- FUNCTION Power_Management_Check (END) -------


----- FUNCTION _Power_Management_PowerDown (BEGIN) -----
B3:00D77C 904386            MOV      DPTR,#bSleepMode
B3:00D77F EF                MOV      A,R7
B3:00D780 F0                MOVX     @DPTR,A
B3:00D781 123670            LCALL    ?L?COM046D
B3:00D784 F0                MOVX     @DPTR,A
B3:00D785 904386            MOV      DPTR,#bSleepMode
B3:00D788 E0                MOVX     A,@DPTR
B3:00D789 B40204            CJNE     A,#02H,?C0004?ZW_POWER_MANAGEMENT
B3:00D78C E4                CLR      A
B3:00D78D FF                MOV      R7,A
B3:00D78E 801B              SJMP     ?C0024?ZW_POWER_MANAGEMENT
B3:00D790         ?C0004?ZW_POWER_MANAGEMENT:
B3:00D790 904386            MOV      DPTR,#bSleepMode
B3:00D793 E0                MOVX     A,@DPTR
B3:00D794 B40304            CJNE     A,#03H,?C0006?ZW_POWER_MANAGEMENT
B3:00D797 7F01              MOV      R7,#01H
B3:00D799         
B3:00D799 8010              SJMP     ?C0024?ZW_POWER_MANAGEMENT
B3:00D79B         ?C0006?ZW_POWER_MANAGEMENT:
B3:00D79B 904386            MOV      DPTR,#bSleepMode
B3:00D79E E0                MOVX     A,@DPTR
B3:00D79F B4050C            CJNE     A,#05H,?C0009?ZW_POWER_MANAGEMENT
B3:00D7A2 901215            MOV      DPTR,#bFLiRSStatus
B3:00D7A5 E0                MOVX     A,@DPTR
B3:00D7A6 4401              ORL      A,#01H
B3:00D7A8 F0                MOVX     @DPTR,A
B3:00D7A9 7F01              MOV      R7,#01H
B3:00D7AB         
B3:00D7AB 124881            LCALL    _ZW_power_down_mode
B3:00D7AE         ?C0009?ZW_POWER_MANAGEMENT:
B3:00D7AE 22                RET      
----- FUNCTION _Power_Management_PowerDown (END) -------


----- FUNCTION ?L?COM03D7 (BEGIN) -----
B3:00D7AF E4                CLR      A
B3:00D7B0 FF                MOV      R7,A
B3:00D7B1 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1054


B3:00D7B2 FD                MOV      R5,A
B3:00D7B3 FC                MOV      R4,A
B3:00D7B4 901218            MOV      DPTR,#wakeupCount
B3:00D7B7 0224B5            LJMP     ?C?LLDXDATA0
----- FUNCTION ?L?COM03D7 (END) -------


----- FUNCTION ?L?COM01F9 (BEGIN) -----
B3:00D7BA 90353B            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00D7BD         ?L?COM01FA:
B3:00D7BD 122499            LCALL    ?C?LLDXDATA
B3:00D7C0 EF                MOV      A,R7
B3:00D7C1 24FF              ADD      A,#0FFH
B3:00D7C3 FF                MOV      R7,A
B3:00D7C4 EE                MOV      A,R6
B3:00D7C5 34FF              ADDC     A,#0FFH
B3:00D7C7 FE                MOV      R6,A
B3:00D7C8 ED                MOV      A,R5
B3:00D7C9 34FF              ADDC     A,#0FFH
B3:00D7CB FD                MOV      R5,A
B3:00D7CC EC                MOV      A,R4
B3:00D7CD 34FF              ADDC     A,#0FFH
B3:00D7CF FC                MOV      R4,A
B3:00D7D0 22                RET      
----- FUNCTION ?L?COM01F9 (END) -------


----- FUNCTION ZW_FirmwareUpdate_NVM_Get_NEWIMAGE (BEGIN) -----
B3:00D7D1 E4                CLR      A
B3:00D7D2 904392            MOV      DPTR,#retVal
B3:00D7D5 F0                MOVX     @DPTR,A
B3:00D7D6 90353F            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00D7D9 E0                MOVX     A,@DPTR
B3:00D7DA 601C              JZ       ?C0001?ZW_FIRMWARE_UPDATE_NVM_FLASH
B3:00D7DC 903509            MOV      DPTR,#systemNVM_Size
B3:00D7DF 122499            LCALL    ?C?LLDXDATA
B3:00D7E2 E4                CLR      A
B3:00D7E3 FB                MOV      R3,A
B3:00D7E4 FA                MOV      R2,A
B3:00D7E5 7902              MOV      R1,#02H
B3:00D7E7 F8                MOV      R0,A
B3:00D7E8 D3                SETB     C
B3:00D7E9 1223D4            LCALL    ?C?ULCMP
B3:00D7EC 500A              JNC      ?C0001?ZW_FIRMWARE_UPDATE_NVM_FLASH
B3:00D7EE F1BA              ACALL    ?L?COM01F9
B3:00D7F0 123967            LCALL    _NVM_ext_read_long_byte
B3:00D7F3 904392            MOV      DPTR,#retVal
B3:00D7F6 EF                MOV      A,R7
B3:00D7F7 F0                MOVX     @DPTR,A
B3:00D7F8         ?C0001?ZW_FIRMWARE_UPDATE_NVM_FLASH:
B3:00D7F8 904392            MOV      DPTR,#retVal
B3:00D7FB E0                MOVX     A,@DPTR
B3:00D7FC FF                MOV      R7,A
B3:00D7FD 22                RET      
----- FUNCTION ZW_FirmwareUpdate_NVM_Get_NEWIMAGE (END) -------


----- FUNCTION _Power_Management_SetTimeout (BEGIN) -----
B3:00D7FE 90422B            MOV      DPTR,#sleep
B3:00D801 1224F1            LCALL    ?C?LSTXDATA
B3:00D804 12D83E            LCALL    ?L?COM0413
B3:00D807 E4                CLR      A
B3:00D808 7BFF              MOV      R3,#0FFH
B3:00D80A 1246C2            LCALL    ?L?COM04AD
B3:00D80D 501C              JNC      ?C0018?ZW_POWER_MANAGEMENT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1055


B3:00D80F E4                CLR      A
B3:00D810 113D              ACALL    ?L?COM0412
B3:00D812 122311            LCALL    ?C?ULDIV
B3:00D815 901218            MOV      DPTR,#wakeupCount
B3:00D818 1224F1            LCALL    ?C?LSTXDATA
B3:00D81B E4                CLR      A
B3:00D81C 7BFF              MOV      R3,#0FFH
B3:00D81E FA                MOV      R2,A
B3:00D81F F9                MOV      R1,A
B3:00D820 113D              ACALL    ?L?COM0412
B3:00D822 122311            LCALL    ?C?ULDIV
B3:00D825 901228            MOV      DPTR,#wakeupCountRest
B3:00D828 EB                MOV      A,R3
B3:00D829 F0                MOVX     @DPTR,A
B3:00D82A 22                RET      
B3:00D82B         ?C0018?ZW_POWER_MANAGEMENT:
B3:00D82B 901218            MOV      DPTR,#wakeupCount
B3:00D82E 1224FD            LCALL    ?C?LSTKXDATA
B3:00D831 00                DB       00H
B3:00D832 00                DB       00H
B3:00D833 00                DB       00H
B3:00D834 00                DB       00H
B3:00D835 113E              ACALL    ?L?COM0413
B3:00D837 901228            MOV      DPTR,#wakeupCountRest
B3:00D83A EF                MOV      A,R7
B3:00D83B F0                MOVX     @DPTR,A
B3:00D83C 22                RET      
----- FUNCTION _Power_Management_SetTimeout (END) -------


----- FUNCTION ?L?COM0412 (BEGIN) -----
B3:00D83D F8                MOV      R0,A
B3:00D83E         ?L?COM0413:
B3:00D83E 90422B            MOV      DPTR,#sleep
B3:00D841 022499            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM0412 (END) -------


----- FUNCTION _ZW_Power_Management_Init (BEGIN) -----
B3:00D844 904190            MOV      DPTR,#sleep
B3:00D847 1224F1            LCALL    ?C?LSTXDATA
B3:00D84A 904194            MOV      DPTR,#IntEnable
B3:00D84D E0                MOVX     A,@DPTR
B3:00D84E 5402              ANL      A,#02H
B3:00D850 901240            MOV      DPTR,#extInt1Enabled
B3:00D853 F0                MOVX     @DPTR,A
B3:00D854 904190            MOV      DPTR,#sleep
B3:00D857 122499            LCALL    ?C?LLDXDATA
B3:00D85A 80A2              SJMP     _Power_Management_SetTimeout
----- FUNCTION _ZW_Power_Management_Init (END) -------


----- FUNCTION _ZW_GetBackgroundRSSI (BEGIN) -----
;---- Variable 'noise_levels' assigned to Register 'R1/R2/R3' ----
B3:00D85C C003              PUSH     AR3
B3:00D85E C002              PUSH     AR2
B3:00D860 C001              PUSH     AR1
B3:00D862 7B01              MOV      R3,#01H
B3:00D864 7A40              MOV      R2,#HIGH sInternal_noise_levels
B3:00D866 7969              MOV      R1,#LOW sInternal_noise_levels
B3:00D868 126149            LCALL    ?L?COM0047
B3:00D86B D001              POP      AR1
B3:00D86D D002              POP      AR2
B3:00D86F D003              POP      AR3
B3:00D871 7F02              MOV      R7,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1056


B3:00D873 0280A2            LJMP     ___ZW_memcpy
----- FUNCTION _ZW_GetBackgroundRSSI (END) -------


----- FUNCTION _ZW_RegisterBackgroundRSSICallback (BEGIN) -----
;---- Variable 'cbFun' assigned to Register 'R6/R7' ----
B3:00D876 90406B            MOV      DPTR,#_cbFuncNoiseDetect
B3:00D879 EE                MOV      A,R6
B3:00D87A F0                MOVX     @DPTR,A
B3:00D87B A3                INC      DPTR
B3:00D87C EF                MOV      A,R7
B3:00D87D F0                MOVX     @DPTR,A
B3:00D87E 22                RET      
----- FUNCTION _ZW_RegisterBackgroundRSSICallback (END) -------


----- FUNCTION NoiseDetectPowerOnInit (BEGIN) -----
B3:00D87F E4                CLR      A
B3:00D880 90406D            MOV      DPTR,#bNextChannelToSample
B3:00D883 F0                MOVX     @DPTR,A
B3:00D884 90406B            MOV      DPTR,#_cbFuncNoiseDetect
B3:00D887 F0                MOVX     @DPTR,A
B3:00D888 A3                INC      DPTR
B3:00D889 F0                MOVX     @DPTR,A
B3:00D88A 02891D            LJMP     NoiseDetectSetDefault
----- FUNCTION NoiseDetectPowerOnInit (END) -------


----- FUNCTION gp_timeout (BEGIN) -----
B3:00D88D 75FF01            MOV      SFRPAGE,#01H
B3:00D890 E5A4              MOV      A,GPTCON
B3:00D892 C3                CLR      C
B3:00D893 30E401            JNB      ACC.4,?C0001?ZW_TRANSPORT_SUPPORT
B3:00D896 D3                SETB     C
B3:00D897         ?C0001?ZW_TRANSPORT_SUPPORT:
B3:00D897 22                RET      
----- FUNCTION gp_timeout (END) -------


----- FUNCTION _start_gp_timer (BEGIN) -----
;---- Variable 'timeout' assigned to Register 'R6/R7' ----
B3:00D898 75FF01            MOV      SFRPAGE,#01H
B3:00D89B 7C0C              MOV      R4,#0CH
B3:00D89D 7D35              MOV      R5,#035H
B3:00D89F 122740            LCALL    ?C?LIMUL
B3:00D8A2 E4                CLR      A
B3:00D8A3 7B64              MOV      R3,#064H
B3:00D8A5 FA                MOV      R2,A
B3:00D8A6 F9                MOV      R1,A
B3:00D8A7 F8                MOV      R0,A
B3:00D8A8 122311            LCALL    ?C?ULDIV
;---- Variable 'gp_value' assigned to Register 'R4/R5' ----
B3:00D8AB AD07              MOV      R5,AR7
B3:00D8AD EE                MOV      A,R6
B3:00D8AE F5A9              MOV      GPTTHR,A
B3:00D8B0 ED                MOV      A,R5
B3:00D8B1 F5A7              MOV      GPTTLR,A
B3:00D8B3 75FF01            MOV      SFRPAGE,#01H
B3:00D8B6 75A410            MOV      GPTCON,#010H
B3:00D8B9 75FF02            MOV      SFRPAGE,#02H
B3:00D8BC 75F602            MOV      GPTCON2,#02H
B3:00D8BF 75FF01            MOV      SFRPAGE,#01H
B3:00D8C2 75A415            MOV      GPTCON,#015H
B3:00D8C5 22                RET      
----- FUNCTION _start_gp_timer (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1057




----- FUNCTION SendProdTestCarrier (BEGIN) -----
B3:00D8C6 301A35            JNB      rfProdTestOn,?C0013?ZW_TRANSPORT_SUPPORT
B3:00D8C9 43FA08            ORL      MODCTRL,#08H
B3:00D8CC 301805            JNB      rfProdTestDataMod,?C0014?ZW_TRANSPORT_SUPPORT
B3:00D8CF 12413E            LCALL    ZW_Random
B3:00D8D2 8002              SJMP     ?C0022?ZW_TRANSPORT_SUPPORT
B3:00D8D4         ?C0014?ZW_TRANSPORT_SUPPORT:
B3:00D8D4 E4                CLR      A
B3:00D8D5 FF                MOV      R7,A
B3:00D8D6         
B3:00D8D6 1258D5            LCALL    _RF_byte_set
B3:00D8D9         ?C0015?ZW_TRANSPORT_SUPPORT:
B3:00D8D9 E4                CLR      A
B3:00D8DA F5FF              MOV      SFRPAGE,A
B3:00D8DC 53B1FD            ANL      DPLLCON,#0FDH
B3:00D8DF F5FF              MOV      SFRPAGE,A
B3:00D8E1 43B102            ORL      DPLLCON,#02H
B3:00D8E4         ?C0016?ZW_TRANSPORT_SUPPORT:
B3:00D8E4 E5B1              MOV      A,DPLLCON
B3:00D8E6 30E2FB            JNB      ACC.2,?C0016?ZW_TRANSPORT_SUPPORT
B3:00D8E9         ?C0017?ZW_TRANSPORT_SUPPORT:
B3:00D8E9 E4                CLR      A
B3:00D8EA F5FF              MOV      SFRPAGE,A
B3:00D8EC E5B1              MOV      A,DPLLCON
B3:00D8EE 20E30D            JB       ACC.3,?C0013?ZW_TRANSPORT_SUPPORT
B3:00D8F1 43FC04            ORL      SEQCON,#04H
B3:00D8F4 7F01              MOV      R7,#01H
B3:00D8F6 7E00              MOV      R6,#00H
B3:00D8F8 1198              ACALL    _start_gp_timer
B3:00D8FA         ?C0019?ZW_TRANSPORT_SUPPORT:
B3:00D8FA 118D              ACALL    gp_timeout
B3:00D8FC 50FC              JNC      ?C0019?ZW_TRANSPORT_SUPPORT
B3:00D8FE         ?C0020?ZW_TRANSPORT_SUPPORT:
B3:00D8FE         ?C0013?ZW_TRANSPORT_SUPPORT:
B3:00D8FE A21A              MOV      C,rfProdTestOn
B3:00D900 22                RET      
----- FUNCTION SendProdTestCarrier (END) -------


----- FUNCTION ___S2_span_ok (BEGIN) -----
B3:00D901 9042EE            MOV      DPTR,#con
B3:00D904 1225A9            LCALL    ?C?PSTXDATA
B3:00D907 12A5A0            LCALL    ___find_span_by_node
;---- Variable 'span' assigned to Register 'R6/R7' ----
B3:00D90A EF                MOV      A,R7
B3:00D90B 4E                ORL      A,R6
B3:00D90C 602E              JZ       ?C0024?S2
B3:00D90E EF                MOV      A,R7
B3:00D90F 2426              ADD      A,#026H
B3:00D911 12B617            LCALL    ?L?COM0096
B3:00D914 E0                MOVX     A,@DPTR
B3:00D915 FD                MOV      R5,A
B3:00D916 6406              XRL      A,#06H
B3:00D918 6004              JZ       ?C0027?S2
B3:00D91A ED                MOV      A,R5
B3:00D91B B40419            CJNE     A,#04H,?C0025?S2
B3:00D91E         ?C0027?S2:
B3:00D91E 9042EE            MOV      DPTR,#con
B3:00D921 122589            LCALL    ?C?PLDXDATA
B3:00D924 12A1BD            LCALL    ?L?COM04FB
B3:00D927 FD                MOV      R5,A
B3:00D928 EF                MOV      A,R7
B3:00D929 2425              ADD      A,#025H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1058


B3:00D92B 12B617            LCALL    ?L?COM0096
B3:00D92E E0                MOVX     A,@DPTR
B3:00D92F B50505            CJNE     A,AR5,?C0025?S2
B3:00D932 7E00              MOV      R6,#00H
B3:00D934 7F01              MOV      R7,#01H
B3:00D936 22                RET      
B3:00D937         ?C0025?S2:
B3:00D937 7E00              MOV      R6,#00H
B3:00D939 7F00              MOV      R7,#00H
B3:00D93B 22                RET      
B3:00D93C         ?C0024?S2:
B3:00D93C E4                CLR      A
B3:00D93D FE                MOV      R6,A
B3:00D93E FF                MOV      R7,A
B3:00D93F 22                RET      
----- FUNCTION ___S2_span_ok (END) -------


----- FUNCTION ZW_NVRCheck (BEGIN) -----
B3:00D940 E4                CLR      A
B3:00D941 904387            MOV      DPTR,#bIndex
B3:00D944 F0                MOVX     @DPTR,A
B3:00D945         ?C0008?ZW_NVR:
B3:00D945 904387            MOV      DPTR,#bIndex
B3:00D948 E0                MOVX     A,@DPTR
B3:00D949 FF                MOV      R7,A
B3:00D94A D3                SETB     C
B3:00D94B 946F              SUBB     A,#06FH
B3:00D94D 501F              JNC      ?C0009?ZW_NVR
B3:00D94F EF                MOV      A,R7
B3:00D950 2410              ADD      A,#010H
B3:00D952 FF                MOV      R7,A
B3:00D953 12A76B            LCALL    _ZW_FLASH_nvr0_get
B3:00D956 904387            MOV      DPTR,#bIndex
B3:00D959 E0                MOVX     A,@DPTR
B3:00D95A FE                MOV      R6,A
B3:00D95B E4                CLR      A
B3:00D95C 2E                ADD      A,R6
B3:00D95D F582              MOV      DPL,A
B3:00D95F E4                CLR      A
B3:00D960 344F              ADDC     A,#04FH
B3:00D962 F583              MOV      DPH,A
B3:00D964 EF                MOV      A,R7
B3:00D965 F0                MOVX     @DPTR,A
B3:00D966 904387            MOV      DPTR,#bIndex
B3:00D969 E0                MOVX     A,@DPTR
B3:00D96A 04                INC      A
B3:00D96B F0                MOVX     @DPTR,A
B3:00D96C 80D7              SJMP     ?C0008?ZW_NVR
B3:00D96E         ?C0009?ZW_NVR:
B3:00D96E 7B01              MOV      R3,#01H
B3:00D970 7A4F              MOV      R2,#04FH
B3:00D972 7900              MOV      R1,#00H
B3:00D974 903F79            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B3:00D977 E4                CLR      A
B3:00D978 F0                MOVX     @DPTR,A
B3:00D979 7470              MOV      A,#070H
B3:00D97B 12717F            LCALL    ?L?COM0319
;---- Variable 'wCRC16' assigned to Register 'R6/R7' ----
B3:00D97E EF                MOV      A,R7
B3:00D97F 4E                ORL      A,R6
B3:00D980 7F00              MOV      R7,#00H
B3:00D982 7002              JNZ      ?C0011?ZW_NVR
B3:00D984 7F01              MOV      R7,#01H
B3:00D986         ?C0011?ZW_NVR:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1059


B3:00D986         ?C0012?ZW_NVR:
B3:00D986 90123D            MOV      DPTR,#bNVRValid
B3:00D989 EF                MOV      A,R7
B3:00D98A F0                MOVX     @DPTR,A
B3:00D98B 24FF              ADD      A,#0FFH
B3:00D98D 22                RET      
----- FUNCTION ZW_NVRCheck (END) -------


----- FUNCTION ZW_IsNVRValid (BEGIN) -----
B3:00D98E 90123D            MOV      DPTR,#bNVRValid
B3:00D991 E0                MOVX     A,@DPTR
B3:00D992 24FF              ADD      A,#0FFH
B3:00D994 22                RET      
----- FUNCTION ZW_IsNVRValid (END) -------


----- FUNCTION TransportTimerRestart (BEGIN) -----
B3:00D995 301F0E            JNB      canRestart,?C0011?ZW_TRANSPORT_TIMER
B3:00D998 128BF0            LCALL    ?L?COM02EF
B3:00D99B E4                CLR      A
B3:00D99C F576              MOV      slow_timer_count,A
B3:00D99E D220              SETB     slow_timer_running
B3:00D9A0 75FF02            MOV      SFRPAGE,#02H
B3:00D9A3 438580            ORL      SLTCON1,#080H
B3:00D9A6         ?C0011?ZW_TRANSPORT_TIMER:
B3:00D9A6 22                RET      
----- FUNCTION TransportTimerRestart (END) -------


----- FUNCTION TransportTimerPoll (BEGIN) -----
B3:00D9A7 302015            JNB      slow_timer_running,?C0015?ZW_TRANSPORT_TIMER
B3:00D9AA E576              MOV      A,slow_timer_count
B3:00D9AC 6011              JZ       ?C0015?ZW_TRANSPORT_TIMER
B3:00D9AE 1576              DEC      slow_timer_count
B3:00D9B0 904352            MOV      DPTR,#Func
B3:00D9B3 12A790            LCALL    ?L?COM0098
B3:00D9B6 6007              JZ       ?C0015?ZW_TRANSPORT_TIMER
B3:00D9B8 AA06              MOV      R2,AR6
B3:00D9BA A907              MOV      R1,AR7
B3:00D9BC 122716            LCALL    ?C?ICALL
B3:00D9BF         ?C0015?ZW_TRANSPORT_TIMER:
B3:00D9BF 22                RET      
----- FUNCTION TransportTimerPoll (END) -------


----- FUNCTION TransportTimerInit (BEGIN) -----
B3:00D9C0 E4                CLR      A
B3:00D9C1 F576              MOV      slow_timer_count,A
B3:00D9C3 C220              CLR      slow_timer_running
B3:00D9C5 22                RET      
----- FUNCTION TransportTimerInit (END) -------


----- FUNCTION _aes_ofb (BEGIN) -----
B3:00D9C6 90419A            MOV      DPTR,#pData
B3:00D9C9 1225A9            LCALL    ?C?PSTXDATA
B3:00D9CC 90419D            MOV      DPTR,#len
B3:00D9CF ED                MOV      A,R5
B3:00D9D0 F0                MOVX     @DPTR,A
B3:00D9D1 E4                CLR      A
B3:00D9D2 A3                INC      DPTR
B3:00D9D3 F0                MOVX     @DPTR,A
B3:00D9D4         ?C0003?ZW_SECURITY_SCHEME0:
B3:00D9D4 90419D            MOV      DPTR,#len
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1060


B3:00D9D7 128AFD            LCALL    ?L?COM027B
B3:00D9DA 5036              JNC      ?C0007?ZW_SECURITY_SCHEME0
B3:00D9DC EE                MOV      A,R6
B3:00D9DD 540F              ANL      A,#0FH
B3:00D9DF 7008              JNZ      ?C0006?ZW_SECURITY_SCHEME0
B3:00D9E1 5113              ACALL    ?L?COM04F6
B3:00D9E3 129E2B            LCALL    ?L?COM02D7
B3:00D9E6 129D91            LCALL    _aes_encrypt
B3:00D9E9         ?C0006?ZW_SECURITY_SCHEME0:
B3:00D9E9 90419A            MOV      DPTR,#pData
B3:00D9EC 122589            LCALL    ?C?PLDXDATA
B3:00D9EF 90419E            MOV      DPTR,#i
B3:00D9F2 E0                MOVX     A,@DPTR
B3:00D9F3 FF                MOV      R7,A
B3:00D9F4 29                ADD      A,R1
B3:00D9F5 125510            LCALL    ?L?COM000B
B3:00D9F8 FE                MOV      R6,A
B3:00D9F9 EF                MOV      A,R7
B3:00D9FA 540F              ANL      A,#0FH
B3:00D9FC 24FC              ADD      A,#LOW aes_iv
B3:00D9FE F582              MOV      DPL,A
B3:00DA00 E4                CLR      A
B3:00DA01 3425              ADDC     A,#HIGH aes_iv
B3:00DA03 F583              MOV      DPH,A
B3:00DA05 E0                MOVX     A,@DPTR
B3:00DA06 6E                XRL      A,R6
B3:00DA07 122072            LCALL    ?C?CSTPTR
B3:00DA0A 90419E            MOV      DPTR,#i
B3:00DA0D E0                MOVX     A,@DPTR
B3:00DA0E 04                INC      A
B3:00DA0F F0                MOVX     @DPTR,A
B3:00DA10 80C2              SJMP     ?C0003?ZW_SECURITY_SCHEME0
B3:00DA12         ?C0007?ZW_SECURITY_SCHEME0:
B3:00DA12 22                RET      
----- FUNCTION _aes_ofb (END) -------


----- FUNCTION ?L?COM04F6 (BEGIN) -----
B3:00DA13 7B01              MOV      R3,#01H
B3:00DA15 7A25              MOV      R2,#HIGH aes_iv
B3:00DA17 79FC              MOV      R1,#LOW aes_iv
B3:00DA19 22                RET      
----- FUNCTION ?L?COM04F6 (END) -------


----- FUNCTION _aes_random8 (BEGIN) -----
B3:00DA1A 903AEB            MOV      DPTR,#d
B3:00DA1D 1225A9            LCALL    ?C?PSTXDATA
B3:00DA20 7A3A              MOV      R2,#HIGH rtemp
B3:00DA22 79EE              MOV      R1,#LOW rtemp
B3:00DA24 12A58B            LCALL    ?L?COM015C
B3:00DA27 7B01              MOV      R3,#01H
B3:00DA29 7A3A              MOV      R2,#HIGH rtemp
B3:00DA2B 79EE              MOV      R1,#LOW rtemp
B3:00DA2D 126149            LCALL    ?L?COM0047
B3:00DA30 903AEB            MOV      DPTR,#d
B3:00DA33 122589            LCALL    ?C?PLDXDATA
B3:00DA36 7F08              MOV      R7,#08H
B3:00DA38 0280A2            LJMP     ___ZW_memcpy
----- FUNCTION _aes_random8 (END) -------


----- FUNCTION _register_nonce (BEGIN) -----
B3:00DA3B 90406E            MOV      DPTR,#src
B3:00DA3E 124765            LCALL    ?L?COM0102
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1061


B3:00DA41 EB                MOV      A,R3
B3:00DA42 F0                MOVX     @DPTR,A
B3:00DA43 6047              JZ       ?C0015?ZW_SECURITY_SCHEME0
B3:00DA45 E4                CLR      A
B3:00DA46 904074            MOV      DPTR,#i
B3:00DA49 F0                MOVX     @DPTR,A
B3:00DA4A         ?C0016?ZW_SECURITY_SCHEME0:
B3:00DA4A 51F4              ACALL    ?L?COM05AA
B3:00DA4C 503E              JNC      ?C0015?ZW_SECURITY_SCHEME0
B3:00DA4E EF                MOV      A,R7
B3:00DA4F 710B              ACALL    ?L?COM0433
B3:00DA51 E0                MOVX     A,@DPTR
B3:00DA52 6030              JZ       ?C0018?ZW_SECURITY_SCHEME0
B3:00DA54 904074            MOV      DPTR,#i
B3:00DA57 E0                MOVX     A,@DPTR
B3:00DA58 129E53            LCALL    ?L?COM00D7
B3:00DA5B E0                MOVX     A,@DPTR
B3:00DA5C D3                SETB     C
B3:00DA5D 9400              SUBB     A,#00H
B3:00DA5F 4023              JC       ?C0018?ZW_SECURITY_SCHEME0
B3:00DA61 EF                MOV      A,R7
B3:00DA62 51FD              ACALL    ?L?COM024E
B3:00DA64 E0                MOVX     A,@DPTR
B3:00DA65 FF                MOV      R7,A
B3:00DA66 90406E            MOV      DPTR,#src
B3:00DA69 E0                MOVX     A,@DPTR
B3:00DA6A FE                MOV      R6,A
B3:00DA6B EF                MOV      A,R7
B3:00DA6C 6E                XRL      A,R6
B3:00DA6D 7015              JNZ      ?C0018?ZW_SECURITY_SCHEME0
B3:00DA6F 904074            MOV      DPTR,#i
B3:00DA72 E0                MOVX     A,@DPTR
B3:00DA73 FF                MOV      R7,A
B3:00DA74 711A              ACALL    ?L?COM0235
B3:00DA76 E0                MOVX     A,@DPTR
B3:00DA77 FE                MOV      R6,A
B3:00DA78 90406F            MOV      DPTR,#dst
B3:00DA7B E0                MOVX     A,@DPTR
B3:00DA7C FD                MOV      R5,A
B3:00DA7D EE                MOV      A,R6
B3:00DA7E 6D                XRL      A,R5
B3:00DA7F 7003              JNZ      ?C0018?ZW_SECURITY_SCHEME0
B3:00DA81 EF                MOV      A,R7
B3:00DA82 803C              SJMP     ?C0173?ZW_SECURITY_SCHEME0
B3:00DA84         ?C0018?ZW_SECURITY_SCHEME0:
B3:00DA84 904074            MOV      DPTR,#i
B3:00DA87 E0                MOVX     A,@DPTR
B3:00DA88 04                INC      A
B3:00DA89 F0                MOVX     @DPTR,A
B3:00DA8A 80BE              SJMP     ?C0016?ZW_SECURITY_SCHEME0
B3:00DA8C         ?C0015?ZW_SECURITY_SCHEME0:
B3:00DA8C E4                CLR      A
B3:00DA8D 904074            MOV      DPTR,#i
B3:00DA90 F0                MOVX     @DPTR,A
B3:00DA91         ?C0021?ZW_SECURITY_SCHEME0:
B3:00DA91 51F4              ACALL    ?L?COM05AA
B3:00DA93 505C              JNC      ?C0022?ZW_SECURITY_SCHEME0
B3:00DA95 129E52            LCALL    ?L?COM00D6
B3:00DA98 E0                MOVX     A,@DPTR
B3:00DA99 704E              JNZ      ?C0023?ZW_SECURITY_SCHEME0
B3:00DA9B 90406E            MOV      DPTR,#src
B3:00DA9E E0                MOVX     A,@DPTR
B3:00DA9F FF                MOV      R7,A
B3:00DAA0 904074            MOV      DPTR,#i
B3:00DAA3 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1062


B3:00DAA4 FE                MOV      R6,A
B3:00DAA5 51FD              ACALL    ?L?COM024E
B3:00DAA7 EF                MOV      A,R7
B3:00DAA8 F0                MOVX     @DPTR,A
B3:00DAA9 90406F            MOV      DPTR,#dst
B3:00DAAC E0                MOVX     A,@DPTR
B3:00DAAD FF                MOV      R7,A
B3:00DAAE 7119              ACALL    ?L?COM0234
B3:00DAB0 EF                MOV      A,R7
B3:00DAB1 F0                MOVX     @DPTR,A
B3:00DAB2 904070            MOV      DPTR,#reply_nonce
B3:00DAB5 E0                MOVX     A,@DPTR
B3:00DAB6 FF                MOV      R7,A
B3:00DAB7 EE                MOV      A,R6
B3:00DAB8 710B              ACALL    ?L?COM0433
B3:00DABA EF                MOV      A,R7
B3:00DABB F0                MOVX     @DPTR,A
B3:00DABC 904074            MOV      DPTR,#i
B3:00DABF E0                MOVX     A,@DPTR
B3:00DAC0         
B3:00DAC0 7128              ACALL    ?L?COM03F7
B3:00DAC2 C003              PUSH     AR3
B3:00DAC4 C002              PUSH     AR2
B3:00DAC6 C001              PUSH     AR1
B3:00DAC8 904071            MOV      DPTR,#nonce
B3:00DACB 122589            LCALL    ?C?PLDXDATA
B3:00DACE 126149            LCALL    ?L?COM0047
B3:00DAD1 D001              POP      AR1
B3:00DAD3 D002              POP      AR2
B3:00DAD5 D003              POP      AR3
B3:00DAD7 7F08              MOV      R7,#08H
B3:00DAD9 1280A2            LCALL    ___ZW_memcpy
B3:00DADC 904074            MOV      DPTR,#i
B3:00DADF E0                MOVX     A,@DPTR
B3:00DAE0 129E53            LCALL    ?L?COM00D7
B3:00DAE3 740A              MOV      A,#0AH
B3:00DAE5 F0                MOVX     @DPTR,A
B3:00DAE6 7F01              MOV      R7,#01H
B3:00DAE8 22                RET      
B3:00DAE9         ?C0023?ZW_SECURITY_SCHEME0:
B3:00DAE9 904074            MOV      DPTR,#i
B3:00DAEC E0                MOVX     A,@DPTR
B3:00DAED 04                INC      A
B3:00DAEE F0                MOVX     @DPTR,A
B3:00DAEF 80A0              SJMP     ?C0021?ZW_SECURITY_SCHEME0
B3:00DAF1         ?C0022?ZW_SECURITY_SCHEME0:
B3:00DAF1 7F00              MOV      R7,#00H
B3:00DAF3 22                RET      
----- FUNCTION _register_nonce (END) -------


----- FUNCTION ?L?COM05AA (BEGIN) -----
B3:00DAF4 904074            MOV      DPTR,#i
B3:00DAF7 E0                MOVX     A,@DPTR
B3:00DAF8 FF                MOV      R7,A
B3:00DAF9 C3                CLR      C
B3:00DAFA 940F              SUBB     A,#0FH
B3:00DAFC 22                RET      
----- FUNCTION ?L?COM05AA (END) -------


----- FUNCTION ?L?COM024E (BEGIN) -----
B3:00DAFD 75F00C            MOV      B,#0CH
B3:00DB00 A4                MUL      AB
B3:00DB01 24AF              ADD      A,#LOW nonce_table
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1063


B3:00DB03 F582              MOV      DPL,A
B3:00DB05 E4                CLR      A
B3:00DB06 3423              ADDC     A,#HIGH nonce_table
B3:00DB08 F583              MOV      DPH,A
B3:00DB0A 22                RET      
----- FUNCTION ?L?COM024E (END) -------


----- FUNCTION ?L?COM0433 (BEGIN) -----
B3:00DB0B 75F00C            MOV      B,#0CH
B3:00DB0E A4                MUL      AB
B3:00DB0F 24B2              ADD      A,#LOW nonce_table+03H
B3:00DB11 F582              MOV      DPL,A
B3:00DB13 E4                CLR      A
B3:00DB14 3423              ADDC     A,#HIGH nonce_table+03H
B3:00DB16 F583              MOV      DPH,A
B3:00DB18 22                RET      
----- FUNCTION ?L?COM0433 (END) -------


----- FUNCTION ?L?COM0234 (BEGIN) -----
B3:00DB19 EE                MOV      A,R6
B3:00DB1A         ?L?COM0235:
B3:00DB1A 75F00C            MOV      B,#0CH
B3:00DB1D A4                MUL      AB
B3:00DB1E 24B0              ADD      A,#LOW nonce_table+01H
B3:00DB20 F582              MOV      DPL,A
B3:00DB22 E4                CLR      A
B3:00DB23 3423              ADDC     A,#HIGH nonce_table+01H
B3:00DB25 F583              MOV      DPH,A
B3:00DB27 22                RET      
----- FUNCTION ?L?COM0234 (END) -------


----- FUNCTION ?L?COM03F7 (BEGIN) -----
B3:00DB28 75F00C            MOV      B,#0CH
B3:00DB2B A4                MUL      AB
B3:00DB2C 24B3              ADD      A,#LOW nonce_table+04H
B3:00DB2E F9                MOV      R1,A
B3:00DB2F 7423              MOV      A,#HIGH nonce_table+04H
B3:00DB31 35F0              ADDC     A,B
B3:00DB33 FA                MOV      R2,A
B3:00DB34 7B01              MOV      R3,#01H
B3:00DB36 22                RET      
----- FUNCTION ?L?COM03F7 (END) -------


----- FUNCTION _ZCB_tx_timeout (BEGIN) -----
B3:00DB37 7F07              MOV      R7,#07H
B3:00DB39 0280D7            LJMP     _?tx_session_state_set
----- FUNCTION _ZCB_tx_timeout (END) -------


----- FUNCTION _ZCB_noce_get_callback (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B3:00DB3C 9025A7            MOV      DPTR,#the_tx_session+0AH
B3:00DB3F E0                MOVX     A,@DPTR
B3:00DB40 700A              JNZ      ?C0062?ZW_SECURITY_SCHEME0
B3:00DB42 EF                MOV      A,R7
B3:00DB43 7F07              MOV      R7,#07H
B3:00DB45 7002              JNZ      ?C0060?ZW_SECURITY_SCHEME0
B3:00DB47 7F01              MOV      R7,#01H
B3:00DB49         ?C0060?ZW_SECURITY_SCHEME0:
B3:00DB49         ?C0061?ZW_SECURITY_SCHEME0:
B3:00DB49 1280D7            LCALL    _?tx_session_state_set
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1064


B3:00DB4C         ?C0062?ZW_SECURITY_SCHEME0:
B3:00DB4C 22                RET      
----- FUNCTION _ZCB_noce_get_callback (END) -------


----- FUNCTION _sec0_register_nonce (BEGIN) -----
B3:00DB4D 9042B8            MOV      DPTR,#nonce
B3:00DB50 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'dst' assigned to Register 'R5' ----
;---- Variable 'src' assigned to Register 'R7' ----
B3:00DB53 90259D            MOV      DPTR,#the_tx_session
B3:00DB56 E0                MOVX     A,@DPTR
B3:00DB57 6F                XRL      A,R7
B3:00DB58 703C              JNZ      ?C0101?ZW_SECURITY_SCHEME0
B3:00DB5A A3                INC      DPTR
B3:00DB5B E0                MOVX     A,@DPTR
B3:00DB5C 6D                XRL      A,R5
B3:00DB5D 7037              JNZ      ?C0101?ZW_SECURITY_SCHEME0
B3:00DB5F 9042B8            MOV      DPTR,#nonce
B3:00DB62 122589            LCALL    ?C?PLDXDATA
B3:00DB65 7197              ACALL    ?L?COM054D
B3:00DB67 E4                CLR      A
B3:00DB68 FB                MOV      R3,A
B3:00DB69 513B              ACALL    _register_nonce
B3:00DB6B 9025A7            MOV      DPTR,#the_tx_session+0AH
B3:00DB6E E0                MOVX     A,@DPTR
B3:00DB6F FF                MOV      R7,A
B3:00DB70 6401              XRL      A,#01H
B3:00DB72 6003              JZ       ?C0096?ZW_SECURITY_SCHEME0
B3:00DB74 EF                MOV      A,R7
B3:00DB75 7004              JNZ      ?C0095?ZW_SECURITY_SCHEME0
B3:00DB77         ?C0096?ZW_SECURITY_SCHEME0:
B3:00DB77 7F02              MOV      R7,#02H
B3:00DB79 8018              SJMP     ?C0181?ZW_SECURITY_SCHEME0
B3:00DB7B         ?C0095?ZW_SECURITY_SCHEME0:
B3:00DB7B 9025A7            MOV      DPTR,#the_tx_session+0AH
B3:00DB7E E0                MOVX     A,@DPTR
B3:00DB7F FF                MOV      R7,A
B3:00DB80 6403              XRL      A,#03H
B3:00DB82 600D              JZ       ?C0099?ZW_SECURITY_SCHEME0
B3:00DB84 EF                MOV      A,R7
B3:00DB85 B4020E            CJNE     A,#02H,?C0101?ZW_SECURITY_SCHEME0
B3:00DB88 9025A6            MOV      DPTR,#the_tx_session+09H
B3:00DB8B E0                MOVX     A,@DPTR
B3:00DB8C D3                SETB     C
B3:00DB8D 9400              SUBB     A,#00H
B3:00DB8F 4005              JC       ?C0101?ZW_SECURITY_SCHEME0
B3:00DB91         ?C0099?ZW_SECURITY_SCHEME0:
B3:00DB91 7F04              MOV      R7,#04H
B3:00DB93         
B3:00DB93 1280D7            LCALL    _?tx_session_state_set
B3:00DB96         ?C0101?ZW_SECURITY_SCHEME0:
B3:00DB96 22                RET      
----- FUNCTION _sec0_register_nonce (END) -------


----- FUNCTION ?L?COM054D (BEGIN) -----
B3:00DB97 904071            MOV      DPTR,#?_register_nonce?BYTE+03H
B3:00DB9A 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM054D (END) -------


----- FUNCTION _ZCB_msg1_callback (BEGIN) -----
B3:00DB9D 904388            MOV      DPTR,#status
B3:00DBA0 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1065


B3:00DBA1 F0                MOVX     @DPTR,A
;---- Variable 'extendedTxStatus' assigned to Register 'R1/R2/R3' ----
B3:00DBA2 9025A7            MOV      DPTR,#the_tx_session+0AH
B3:00DBA5 E0                MOVX     A,@DPTR
B3:00DBA6 6402              XRL      A,#02H
B3:00DBA8 700F              JNZ      ?C0066?ZW_SECURITY_SCHEME0
B3:00DBAA 71BA              ACALL    ?L?COM03CA
B3:00DBAC 904388            MOV      DPTR,#status
B3:00DBAF E0                MOVX     A,@DPTR
B3:00DBB0 7F07              MOV      R7,#07H
B3:00DBB2 7002              JNZ      ?C0064?ZW_SECURITY_SCHEME0
B3:00DBB4 7F03              MOV      R7,#03H
B3:00DBB6         ?C0064?ZW_SECURITY_SCHEME0:
B3:00DBB6         ?C0065?ZW_SECURITY_SCHEME0:
B3:00DBB6 1280D7            LCALL    _?tx_session_state_set
B3:00DBB9         ?C0066?ZW_SECURITY_SCHEME0:
B3:00DBB9 22                RET      
----- FUNCTION _ZCB_msg1_callback (END) -------


----- FUNCTION ?L?COM03CA (BEGIN) -----
B3:00DBBA 78E9              MOV      R0,#LOW the_tx_session+04CH
B3:00DBBC 7C25              MOV      R4,#HIGH the_tx_session+04CH
B3:00DBBE 7D01              MOV      R5,#01H
B3:00DBC0 FE                MOV      R6,A
B3:00DBC1 7F13              MOV      R7,#013H
B3:00DBC3 021F8D            LJMP     ?C?COPY
----- FUNCTION ?L?COM03CA (END) -------


----- FUNCTION _ZCB_msg2_callback (BEGIN) -----
B3:00DBC6 904389            MOV      DPTR,#status
B3:00DBC9 EF                MOV      A,R7
B3:00DBCA F0                MOVX     @DPTR,A
;---- Variable 'extendedTxStatus' assigned to Register 'R1/R2/R3' ----
B3:00DBCB 9025A7            MOV      DPTR,#the_tx_session+0AH
B3:00DBCE E0                MOVX     A,@DPTR
B3:00DBCF 6404              XRL      A,#04H
B3:00DBD1 700F              JNZ      ?C0070?ZW_SECURITY_SCHEME0
B3:00DBD3 71BA              ACALL    ?L?COM03CA
B3:00DBD5 904389            MOV      DPTR,#status
B3:00DBD8 E0                MOVX     A,@DPTR
B3:00DBD9 7F07              MOV      R7,#07H
B3:00DBDB 7002              JNZ      ?C0068?ZW_SECURITY_SCHEME0
B3:00DBDD 7F05              MOV      R7,#05H
B3:00DBDF         ?C0068?ZW_SECURITY_SCHEME0:
B3:00DBDF         ?C0069?ZW_SECURITY_SCHEME0:
B3:00DBDF 1280D7            LCALL    _?tx_session_state_set
B3:00DBE2         ?C0070?ZW_SECURITY_SCHEME0:
B3:00DBE2 22                RET      
----- FUNCTION _ZCB_msg2_callback (END) -------


----- FUNCTION get_seq (BEGIN) -----
B3:00DBE3 90238E            MOV      DPTR,#s
B3:00DBE6 E0                MOVX     A,@DPTR
B3:00DBE7 04                INC      A
B3:00DBE8 F0                MOVX     @DPTR,A
B3:00DBE9 E0                MOVX     A,@DPTR
B3:00DBEA FF                MOV      R7,A
B3:00DBEB 22                RET      
----- FUNCTION get_seq (END) -------


----- FUNCTION _sec0_send_data (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1066


;---- Variable 'snode' assigned to Register 'R7' ----
;---- Variable 'pData' assigned to Register 'R1/R2/R3' ----
;---- Variable 'dnode' assigned to Register 'R5' ----
B3:00DBEC 90259D            MOV      DPTR,#the_tx_session
B3:00DBEF E0                MOVX     A,@DPTR
B3:00DBF0 6003              JZ       ?C0092?ZW_SECURITY_SCHEME0
B3:00DBF2 7F00              MOV      R7,#00H
B3:00DBF4 22                RET      
B3:00DBF5         ?C0092?ZW_SECURITY_SCHEME0:
B3:00DBF5 90259E            MOV      DPTR,#the_tx_session+01H
B3:00DBF8 EF                MOV      A,R7
B3:00DBF9 F0                MOVX     @DPTR,A
B3:00DBFA 90259D            MOV      DPTR,#the_tx_session
B3:00DBFD ED                MOV      A,R5
B3:00DBFE F0                MOVX     @DPTR,A
B3:00DBFF 9025A3            MOV      DPTR,#the_tx_session+06H
B3:00DC02 1225A9            LCALL    ?C?PSTXDATA
B3:00DC05 903EBF            MOV      DPTR,#len
B3:00DC08 E0                MOVX     A,@DPTR
B3:00DC09 9025A6            MOV      DPTR,#the_tx_session+09H
B3:00DC0C F0                MOVX     @DPTR,A
B3:00DC0D 903EC0            MOV      DPTR,#txoptions
B3:00DC10 E0                MOVX     A,@DPTR
B3:00DC11 90259F            MOV      DPTR,#the_tx_session+02H
B3:00DC14 F0                MOVX     @DPTR,A
B3:00DC15 903EC1            MOV      DPTR,#callback
B3:00DC18 E0                MOVX     A,@DPTR
B3:00DC19 FF                MOV      R7,A
B3:00DC1A A3                INC      DPTR
B3:00DC1B E0                MOVX     A,@DPTR
B3:00DC1C 9025E7            MOV      DPTR,#the_tx_session+04AH
B3:00DC1F CF                XCH      A,R7
B3:00DC20 F0                MOVX     @DPTR,A
B3:00DC21 A3                INC      DPTR
B3:00DC22 EF                MOV      A,R7
B3:00DC23 F0                MOVX     @DPTR,A
B3:00DC24 71E3              ACALL    get_seq
B3:00DC26 9025E6            MOV      DPTR,#the_tx_session+049H
B3:00DC29 EF                MOV      A,R7
B3:00DC2A F0                MOVX     @DPTR,A
B3:00DC2B 7F00              MOV      R7,#00H
B3:00DC2D 1280D7            LCALL    _?tx_session_state_set
B3:00DC30 7F01              MOV      R7,#01H
B3:00DC32 22                RET      
----- FUNCTION _sec0_send_data (END) -------


----- FUNCTION _is_free (BEGIN) -----
;---- Variable 'e' assigned to Register 'R1/R2/R3' ----
B3:00DC33 E9                MOV      A,R1
B3:00DC34 2402              ADD      A,#02H
B3:00DC36 125510            LCALL    ?L?COM000B
B3:00DC39 7F00              MOV      R7,#00H
B3:00DC3B B40302            CJNE     A,#03H,?C0102?ZW_SECURITY_SCHEME0
B3:00DC3E 7F01              MOV      R7,#01H
B3:00DC40         ?C0102?ZW_SECURITY_SCHEME0:
B3:00DC40 22                RET      
----- FUNCTION _is_free (END) -------


----- FUNCTION _new_rx_session (BEGIN) -----
B3:00DC41 9042BB            MOV      DPTR,#snode
B3:00DC44 127271            LCALL    ?L?COM0419
B3:00DC47         ?C0105?ZW_SECURITY_SCHEME0:
B3:00DC47 9042BD            MOV      DPTR,#i
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1067


B3:00DC4A E0                MOVX     A,@DPTR
B3:00DC4B FF                MOV      R7,A
B3:00DC4C C3                CLR      C
B3:00DC4D 9402              SUBB     A,#02H
B3:00DC4F 503F              JNC      ?C0106?ZW_SECURITY_SCHEME0
B3:00DC51 129E44            LCALL    ?L?COM01D3
B3:00DC54 7B01              MOV      R3,#01H
B3:00DC56 9133              ACALL    _is_free
B3:00DC58 EF                MOV      A,R7
B3:00DC59 602D              JZ       ?C0107?ZW_SECURITY_SCHEME0
B3:00DC5B 9042BB            MOV      DPTR,#snode
B3:00DC5E E0                MOVX     A,@DPTR
B3:00DC5F FF                MOV      R7,A
B3:00DC60 9042BD            MOV      DPTR,#i
B3:00DC63 E0                MOVX     A,@DPTR
B3:00DC64 FE                MOV      R6,A
B3:00DC65 75F085            MOV      B,#085H
B3:00DC68 902493            MOV      DPTR,#rxsessions
B3:00DC6B 12257D            LCALL    ?C?OFFXADD
B3:00DC6E EF                MOV      A,R7
B3:00DC6F F0                MOVX     @DPTR,A
B3:00DC70 9042BC            MOV      DPTR,#dnode
B3:00DC73 E0                MOVX     A,@DPTR
B3:00DC74 FF                MOV      R7,A
B3:00DC75 75F085            MOV      B,#085H
B3:00DC78 EE                MOV      A,R6
B3:00DC79 902494            MOV      DPTR,#rxsessions+01H
B3:00DC7C 12257D            LCALL    ?C?OFFXADD
B3:00DC7F EF                MOV      A,R7
B3:00DC80 F0                MOVX     @DPTR,A
B3:00DC81 9042BD            MOV      DPTR,#i
B3:00DC84 E0                MOVX     A,@DPTR
B3:00DC85 029E45            LJMP     ?L?COM01D4
B3:00DC88         ?C0107?ZW_SECURITY_SCHEME0:
B3:00DC88 9042BD            MOV      DPTR,#i
B3:00DC8B E0                MOVX     A,@DPTR
B3:00DC8C 04                INC      A
B3:00DC8D F0                MOVX     @DPTR,A
B3:00DC8E 80B7              SJMP     ?C0105?ZW_SECURITY_SCHEME0
B3:00DC90         ?C0106?ZW_SECURITY_SCHEME0:
B3:00DC90 02BDF8            LJMP     ?L?COM0032
----- FUNCTION _new_rx_session (END) -------


----- FUNCTION _get_rx_session_by_nodes (BEGIN) -----
B3:00DC93 90410E            MOV      DPTR,#snode
B3:00DC96 127271            LCALL    ?L?COM0419
B3:00DC99         ?C0134?ZW_SECURITY_SCHEME0:
B3:00DC99 904110            MOV      DPTR,#i
B3:00DC9C E0                MOVX     A,@DPTR
B3:00DC9D FF                MOV      R7,A
B3:00DC9E C3                CLR      C
B3:00DC9F 9402              SUBB     A,#02H
B3:00DCA1 503C              JNC      ?C0135?ZW_SECURITY_SCHEME0
B3:00DCA3 129E44            LCALL    ?L?COM01D3
B3:00DCA6 7B01              MOV      R3,#01H
B3:00DCA8 A3                INC      DPTR
B3:00DCA9 1225A9            LCALL    ?C?PSTXDATA
B3:00DCAC 9133              ACALL    _is_free
B3:00DCAE EF                MOV      A,R7
B3:00DCAF 7026              JNZ      ?C0136?ZW_SECURITY_SCHEME0
B3:00DCB1 904111            MOV      DPTR,#e
B3:00DCB4 122589            LCALL    ?C?PLDXDATA
B3:00DCB7 E9                MOV      A,R1
B3:00DCB8 2401              ADD      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1068


B3:00DCBA 125510            LCALL    ?L?COM000B
B3:00DCBD FF                MOV      R7,A
B3:00DCBE 90410F            MOV      DPTR,#dnode
B3:00DCC1 E0                MOVX     A,@DPTR
B3:00DCC2 B50712            CJNE     A,AR7,?C0136?ZW_SECURITY_SCHEME0
B3:00DCC5 904111            MOV      DPTR,#e
B3:00DCC8 122589            LCALL    ?C?PLDXDATA
B3:00DCCB 121FB3            LCALL    ?C?CLDPTR
B3:00DCCE FF                MOV      R7,A
B3:00DCCF 90410E            MOV      DPTR,#snode
B3:00DCD2 E0                MOVX     A,@DPTR
B3:00DCD3 B50701            CJNE     A,AR7,?C0136?ZW_SECURITY_SCHEME0
B3:00DCD6 22                RET      
B3:00DCD7         ?C0136?ZW_SECURITY_SCHEME0:
B3:00DCD7 904110            MOV      DPTR,#i
B3:00DCDA E0                MOVX     A,@DPTR
B3:00DCDB 04                INC      A
B3:00DCDC F0                MOVX     @DPTR,A
B3:00DCDD 80BA              SJMP     ?C0134?ZW_SECURITY_SCHEME0
B3:00DCDF         ?C0135?ZW_SECURITY_SCHEME0:
B3:00DCDF 02BDF8            LJMP     ?L?COM0032
----- FUNCTION _get_rx_session_by_nodes (END) -------


----- FUNCTION sec0_abort_all_tx_sessions (BEGIN) -----
B3:00DCE2 90259D            MOV      DPTR,#the_tx_session
B3:00DCE5 E0                MOVX     A,@DPTR
B3:00DCE6 6005              JZ       ?C0122?ZW_SECURITY_SCHEME0
B3:00DCE8 7F07              MOV      R7,#07H
B3:00DCEA 1280D7            LCALL    _?tx_session_state_set
B3:00DCED         ?C0122?ZW_SECURITY_SCHEME0:
B3:00DCED 22                RET      
----- FUNCTION sec0_abort_all_tx_sessions (END) -------


----- FUNCTION _sec2_send_data (BEGIN) -----
B3:00DCEE 903AAF            MOV      DPTR,#vdata
B3:00DCF1 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R4/R5' ----
B3:00DCF4 B166              ACALL    ?L?COM03F6
B3:00DCF6 E9                MOV      A,R1
B3:00DCF7 2401              ADD      A,#01H
B3:00DCF9 125510            LCALL    ?L?COM000B
B3:00DCFC 903AB9            MOV      DPTR,#s2_con
B3:00DCFF B165              ACALL    ?L?COM03F5
B3:00DD01 121FB3            LCALL    ?C?CLDPTR
B3:00DD04 903ABA            MOV      DPTR,#s2_con+01H
B3:00DD07 F0                MOVX     @DPTR,A
B3:00DD08 E9                MOV      A,R1
B3:00DD09 2403              ADD      A,#03H
B3:00DD0B 125510            LCALL    ?L?COM000B
B3:00DD0E 903ABB            MOV      DPTR,#s2_con+02H
B3:00DD11 B165              ACALL    ?L?COM03F5
B3:00DD13 E9                MOV      A,R1
B3:00DD14 2402              ADD      A,#02H
B3:00DD16 125510            LCALL    ?L?COM000B
B3:00DD19 903ABD            MOV      DPTR,#s2_con+04H
B3:00DD1C F0                MOVX     @DPTR,A
B3:00DD1D 9034FD            MOV      DPTR,#s2_send_callback
B3:00DD20 E0                MOVX     A,@DPTR
B3:00DD21 FF                MOV      R7,A
B3:00DD22 A3                INC      DPTR
B3:00DD23 E0                MOVX     A,@DPTR
B3:00DD24 903AC1            MOV      DPTR,#cb_save
B3:00DD27 CF                XCH      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1069


B3:00DD28 F0                MOVX     @DPTR,A
B3:00DD29 A3                INC      DPTR
B3:00DD2A EF                MOV      A,R7
B3:00DD2B F0                MOVX     @DPTR,A
B3:00DD2C 903AB7            MOV      DPTR,#callback
B3:00DD2F B16C              ACALL    ?L?COM04AB
B3:00DD31 B165              ACALL    ?L?COM03F5
B3:00DD33 E9                MOV      A,R1
B3:00DD34 2404              ADD      A,#04H
B3:00DD36 125510            LCALL    ?L?COM000B
B3:00DD39 14                DEC      A
B3:00DD3A 903AC0            MOV      DPTR,#s2_con+07H
B3:00DD3D F0                MOVX     @DPTR,A
B3:00DD3E 903AAF            MOV      DPTR,#vdata
B3:00DD41 122589            LCALL    ?C?PLDXDATA
B3:00DD44 903BC5            MOV      DPTR,#?___S2_send_data?BYTE+03H
B3:00DD47 1225A9            LCALL    ?C?PSTXDATA
B3:00DD4A 903BC8            MOV      DPTR,#?___S2_send_data?BYTE+06H
B3:00DD4D 12C401            LCALL    ?L?COM0125
B3:00DD50 7A3A              MOV      R2,#HIGH s2_con
B3:00DD52 79B9              MOV      R1,#LOW s2_con
B3:00DD54 D1F3              ACALL    ___S2_send_data
B3:00DD56 EF                MOV      A,R7
B3:00DD57 6003              JZ       ?C0005?ZW_SECURITY_SCHEME2
B3:00DD59 7F01              MOV      R7,#01H
B3:00DD5B 22                RET      
B3:00DD5C         ?C0005?ZW_SECURITY_SCHEME2:
B3:00DD5C 903AC1            MOV      DPTR,#cb_save
B3:00DD5F B16C              ACALL    ?L?COM04AB
B3:00DD61 F0                MOVX     @DPTR,A
B3:00DD62         ?C0007?ZW_SECURITY_SCHEME2:
B3:00DD62 7F00              MOV      R7,#00H
B3:00DD64 22                RET      
----- FUNCTION _sec2_send_data (END) -------


----- FUNCTION ?L?COM03F5 (BEGIN) -----
B3:00DD65 F0                MOVX     @DPTR,A
B3:00DD66         ?L?COM03F6:
B3:00DD66 903AB4            MOV      DPTR,#txOptionsEx
B3:00DD69 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03F5 (END) -------


----- FUNCTION ?L?COM04AB (BEGIN) -----
B3:00DD6C E0                MOVX     A,@DPTR
B3:00DD6D FF                MOV      R7,A
B3:00DD6E A3                INC      DPTR
B3:00DD6F E0                MOVX     A,@DPTR
B3:00DD70 9034FD            MOV      DPTR,#s2_send_callback
B3:00DD73 CF                XCH      A,R7
B3:00DD74 F0                MOVX     @DPTR,A
B3:00DD75 A3                INC      DPTR
B3:00DD76 EF                MOV      A,R7
B3:00DD77 22                RET      
----- FUNCTION ?L?COM04AB (END) -------


----- FUNCTION ___S2_send_done_event (BEGIN) -----
B3:00DD78 90438B            MOV      DPTR,#status
B3:00DD7B EF                MOV      A,R7
B3:00DD7C F0                MOVX     @DPTR,A
B3:00DD7D 9034FF            MOV      DPTR,#s2_send_multi_callback
B3:00DD80 12A790            LCALL    ?L?COM0098
B3:00DD83 6037              JZ       ?C0008?ZW_SECURITY_SCHEME2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1070


B3:00DD85 903504            MOV      DPTR,#cb_multi_save
B3:00DD88 1265F2            LCALL    ?L?COM043B
B3:00DD8B 9034FF            MOV      DPTR,#s2_send_multi_callback
B3:00DD8E F0                MOVX     @DPTR,A
B3:00DD8F A3                INC      DPTR
B3:00DD90 F0                MOVX     @DPTR,A
B3:00DD91 90438B            MOV      DPTR,#status
B3:00DD94 E0                MOVX     A,@DPTR
B3:00DD95 B4021A            CJNE     A,#02H,?C0009?ZW_SECURITY_SCHEME2
B3:00DD98 903506            MOV      DPTR,#delayed_callback
B3:00DD9B 7401              MOV      A,#01H
B3:00DD9D F0                MOVX     @DPTR,A
B3:00DD9E 903504            MOV      DPTR,#cb_multi_save
B3:00DDA1 E0                MOVX     A,@DPTR
B3:00DDA2 FF                MOV      R7,A
B3:00DDA3 A3                INC      DPTR
B3:00DDA4 E0                MOVX     A,@DPTR
B3:00DDA5 903507            MOV      DPTR,#delayed_callback+01H
B3:00DDA8 CF                XCH      A,R7
B3:00DDA9 12476C            LCALL    ?L?COM0303
B3:00DDAC EF                MOV      A,R7
B3:00DDAD F4                CPL      A
B3:00DDAE 703E              JNZ      ?C0012?ZW_SECURITY_SCHEME2
B3:00DDB0 8026              SJMP     ?C0052?ZW_SECURITY_SCHEME2
B3:00DDB2         ?C0009?ZW_SECURITY_SCHEME2:
B3:00DDB2 90438B            MOV      DPTR,#status
B3:00DDB5 E0                MOVX     A,@DPTR
B3:00DDB6 FF                MOV      R7,A
B3:00DDB7 903504            MOV      DPTR,#cb_multi_save
B3:00DDBA 802C              SJMP     ?C0053?ZW_SECURITY_SCHEME2
B3:00DDBC         ?C0008?ZW_SECURITY_SCHEME2:
B3:00DDBC 9034FD            MOV      DPTR,#s2_send_callback
B3:00DDBF 12A790            LCALL    ?L?COM0098
B3:00DDC2 602A              JZ       ?C0012?ZW_SECURITY_SCHEME2
B3:00DDC4 90438B            MOV      DPTR,#status
B3:00DDC7 E0                MOVX     A,@DPTR
B3:00DDC8 B4020F            CJNE     A,#02H,?C0015?ZW_SECURITY_SCHEME2
B3:00DDCB E4                CLR      A
B3:00DDCC 903506            MOV      DPTR,#delayed_callback
B3:00DDCF F0                MOVX     @DPTR,A
B3:00DDD0 A3                INC      DPTR
B3:00DDD1 EE                MOV      A,R6
B3:00DDD2 12476C            LCALL    ?L?COM0303
B3:00DDD5 BFFF16            CJNE     R7,#0FFH,?C0012?ZW_SECURITY_SCHEME2
B3:00DDD8         
B3:00DDD8 8015              SJMP     ZCB_delayed_send_callback
B3:00DDDA         ?C0015?ZW_SECURITY_SCHEME2:
B3:00DDDA 90438B            MOV      DPTR,#status
B3:00DDDD E0                MOVX     A,@DPTR
B3:00DDDE FF                MOV      R7,A
B3:00DDDF 7B01              MOV      R3,#01H
B3:00DDE1 7A34              MOV      R2,#HIGH sExtendedTxStatusS2
B3:00DDE3 79DA              MOV      R1,#LOW sExtendedTxStatusS2
B3:00DDE5 9034FD            MOV      DPTR,#s2_send_callback
B3:00DDE8         
B3:00DDE8 12515D            LCALL    ?L?COM0154
B3:00DDEB 12271A            LCALL    ?C?ICALL2
B3:00DDEE         ?C0012?ZW_SECURITY_SCHEME2:
B3:00DDEE 22                RET      
----- FUNCTION ___S2_send_done_event (END) -------


----- FUNCTION ZCB_delayed_send_callback (BEGIN) -----
B3:00DDEF 903506            MOV      DPTR,#delayed_callback
B3:00DDF2 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1071


B3:00DDF3 B40103            CJNE     A,#01H,?C0049?ZW_SECURITY_SCHEME2
B3:00DDF6 A3                INC      DPTR
B3:00DDF7 8009              SJMP     ?C0054?ZW_SECURITY_SCHEME2
B3:00DDF9         ?C0049?ZW_SECURITY_SCHEME2:
B3:00DDF9 7B01              MOV      R3,#01H
B3:00DDFB 7A34              MOV      R2,#HIGH sExtendedTxStatusS2
B3:00DDFD 79DA              MOV      R1,#LOW sExtendedTxStatusS2
B3:00DDFF 903507            MOV      DPTR,#delayed_callback+01H
B3:00DE02         
B3:;----                  JMP      ?L?COM0414
----- FUNCTION ZCB_delayed_send_callback (END) -------


----- FUNCTION ?L?COM0414 (BEGIN) -----
B3:00DE02 E0                MOVX     A,@DPTR
B3:00DE03 FE                MOV      R6,A
B3:00DE04 A3                INC      DPTR
B3:00DE05 E0                MOVX     A,@DPTR
B3:00DE06 F582              MOV      DPL,A
B3:00DE08 8E83              MOV      DPH,R6
B3:00DE0A 7F02              MOV      R7,#02H
B3:00DE0C 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0414 (END) -------


----- FUNCTION ___S2_post_send_done_event (BEGIN) -----
B3:00DE0F 904394            MOV      DPTR,#status
B3:00DE12 EF                MOV      A,R7
B3:00DE13 F0                MOVX     @DPTR,A
B3:00DE14 12A7BA            LCALL    ?L?COM0333
B3:00DE17 6004              JZ       ?C0199?S2
B3:00DE19 E0                MOVX     A,@DPTR
B3:00DE1A B40504            CJNE     A,#05H,?C0197?S2
B3:00DE1D         ?C0199?S2:
B3:00DE1D 7D01              MOV      R5,#01H
B3:00DE1F 8002              SJMP     ?C0198?S2
B3:00DE21         ?C0197?S2:
B3:00DE21 7D00              MOV      R5,#00H
B3:00DE23         ?C0198?S2:
B3:00DE23 D12C              ACALL    _s2_inclusion_send_done
B3:00DE25 904394            MOV      DPTR,#status
B3:00DE28 E0                MOVX     A,@DPTR
B3:00DE29 FF                MOV      R7,A
B3:00DE2A A178              AJMP     ___S2_send_done_event
----- FUNCTION ___S2_post_send_done_event (END) -------


----- FUNCTION _s2_inclusion_send_done (BEGIN) -----
B3:00DE2C 90424B            MOV      DPTR,#p_context
B3:00DE2F 1225A9            LCALL    ?C?PSTXDATA
B3:00DE32 90424E            MOV      DPTR,#status
B3:00DE35 ED                MOV      A,R5
B3:00DE36 F0                MOVX     @DPTR,A
B3:00DE37 902842            MOV      DPTR,#m_retry_counter
B3:00DE3A E0                MOVX     A,@DPTR
B3:00DE3B B4FF09            CJNE     A,#0FFH,?C0078?S2_INCLUSION
B3:00DE3E 7403              MOV      A,#03H
B3:00DE40 F0                MOVX     @DPTR,A
B3:00DE41 7F08              MOV      R7,#08H
B3:00DE43 7E02              MOV      R6,#02H
B3:00DE45 802F              SJMP     ?C0142?S2_INCLUSION
B3:00DE47         ?C0078?S2_INCLUSION:
B3:00DE47 902842            MOV      DPTR,#m_retry_counter
B3:00DE4A E0                MOVX     A,@DPTR
B3:00DE4B D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1072


B3:00DE4C 9400              SUBB     A,#00H
B3:00DE4E 4018              JC       ?C0080?S2_INCLUSION
B3:00DE50 902222            MOV      DPTR,#the_context+020FH
B3:00DE53 E0                MOVX     A,@DPTR
B3:00DE54 640A              XRL      A,#0AH
B3:00DE56 6010              JZ       ?C0080?S2_INCLUSION
B3:00DE58 90424E            MOV      DPTR,#status
B3:00DE5B E0                MOVX     A,@DPTR
B3:00DE5C 7E02              MOV      R6,#02H
B3:00DE5E 6004              JZ       ?C0081?S2_INCLUSION
B3:00DE60 7F0C              MOV      R7,#0CH
B3:00DE62 8002              SJMP     ?C0082?S2_INCLUSION
B3:00DE64         ?C0081?S2_INCLUSION:
B3:00DE64 7F08              MOV      R7,#08H
B3:00DE66         ?C0082?S2_INCLUSION:
B3:00DE66         
B3:00DE66 800E              SJMP     ?C0142?S2_INCLUSION
B3:00DE68         ?C0080?S2_INCLUSION:
B3:00DE68 90424E            MOV      DPTR,#status
B3:00DE6B E0                MOVX     A,@DPTR
B3:00DE6C 7E02              MOV      R6,#02H
B3:00DE6E 6004              JZ       ?C0084?S2_INCLUSION
B3:00DE70 7F0C              MOV      R7,#0CH
B3:00DE72 8002              SJMP     ?C0085?S2_INCLUSION
B3:00DE74         ?C0084?S2_INCLUSION:
B3:00DE74 7F0D              MOV      R7,#0DH
B3:00DE76         ?C0085?S2_INCLUSION:
B3:00DE76         
B3:00DE76 02A879            LJMP     _process_event
----- FUNCTION _s2_inclusion_send_done (END) -------


----- FUNCTION _ZCB_S2_send_frame_callback (BEGIN) -----
B3:00DE79 90438C            MOV      DPTR,#txStatus
B3:00DE7C EF                MOV      A,R7
B3:00DE7D F0                MOVX     @DPTR,A
;---- Variable 'extendedTxStatus' assigned to Register 'R1/R2/R3' ----
B3:00DE7E 78DA              MOV      R0,#LOW sExtendedTxStatusS2
B3:00DE80 7C34              MOV      R4,#HIGH sExtendedTxStatusS2
B3:00DE82 7D01              MOV      R5,#01H
B3:00DE84 7E00              MOV      R6,#00H
B3:00DE86 7F13              MOV      R7,#013H
B3:00DE88 121F8D            LCALL    ?C?COPY
B3:00DE8B 90438C            MOV      DPTR,#txStatus
B3:00DE8E E0                MOVX     A,@DPTR
B3:00DE8F FF                MOV      R7,A
B3:00DE90 7DF4              MOV      R5,#0F4H
B3:00DE92 7C01              MOV      R4,#01H
B3:;----                  JMP      ___S2_send_frame_done_notify
----- FUNCTION _ZCB_S2_send_frame_callback (END) -------


----- FUNCTION ___S2_send_frame_done_notify (BEGIN) -----
;---- Variable 'tx_time' assigned to Register 'R4/R5' ----
;---- Variable 'status' assigned to Register 'R7' ----
B3:00DE94 903FC7            MOV      DPTR,#e+03H
B3:00DE97 EF                MOV      A,R7
B3:00DE98 F0                MOVX     @DPTR,A
B3:00DE99 AF05              MOV      R7,AR5
B3:00DE9B A3                INC      DPTR
B3:00DE9C 12C403            LCALL    ?L?COM0126
B3:00DE9F 7A3F              MOV      R2,#HIGH e
B3:00DEA1 79C4              MOV      R1,#LOW e
B3:00DEA3 7F02              MOV      R7,#02H
B3:00DEA5 028E6A            LJMP     ___S2_fsm_post_event
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1073


----- FUNCTION ___S2_send_frame_done_notify (END) -------


----- FUNCTION ___S2_send_frame_multi (BEGIN) -----
B3:00DEA8 903F9C            MOV      DPTR,#conn
B3:00DEAB 1225A9            LCALL    ?C?PSTXDATA
B3:00DEAE 7B01              MOV      R3,#01H
B3:00DEB0 7A34              MOV      R2,#HIGH s2_sfm_txopt
B3:00DEB2 79D4              MOV      R1,#LOW s2_sfm_txopt
B3:00DEB4 7D06              MOV      R5,#06H
B3:00DEB6 E4                CLR      A
B3:00DEB7 FF                MOV      R7,A
B3:00DEB8 1299EF            LCALL    ___ZW_memset
B3:00DEBB 903F9C            MOV      DPTR,#conn
B3:00DEBE 122589            LCALL    ?C?PLDXDATA
B3:00DEC1 121FB3            LCALL    ?C?CLDPTR
B3:00DEC4 9034D5            MOV      DPTR,#s2_sfm_txopt+01H
B3:00DEC7 F0                MOVX     @DPTR,A
B3:00DEC8 9034D4            MOV      DPTR,#s2_sfm_txopt
B3:00DECB 74FF              MOV      A,#0FFH
B3:00DECD F0                MOVX     @DPTR,A
B3:00DECE E9                MOV      A,R1
B3:00DECF 2404              ADD      A,#04H
B3:00DED1 125510            LCALL    ?L?COM000B
B3:00DED4 9034D6            MOV      DPTR,#s2_sfm_txopt+02H
B3:00DED7 F0                MOVX     @DPTR,A
B3:00DED8 903FA2            MOV      DPTR,#len
B3:00DEDB A3                INC      DPTR
B3:00DEDC E0                MOVX     A,@DPTR
B3:00DEDD FD                MOV      R5,A
B3:00DEDE 7B01              MOV      R3,#01H
B3:00DEE0 7A34              MOV      R2,#HIGH s2_sfm_txopt
B3:00DEE2 79D4              MOV      R1,#LOW s2_sfm_txopt
B3:00DEE4 12704B            LCALL    ?L?COM00AE
B3:00DEE7 12EECF            LCALL    ?L?COM04CA
B3:00DEEA 903F9F            MOV      DPTR,#buf
B3:00DEED 122589            LCALL    ?C?PLDXDATA
B3:00DEF0 021980            LJMP     ?INTERBANK_TABLE?_ZW_SendDataEx
----- FUNCTION ___S2_send_frame_multi (END) -------


----- FUNCTION ___S2_send_data (BEGIN) -----
B3:00DEF3 903BC2            MOV      DPTR,#dst
B3:00DEF6 1225A9            LCALL    ?C?PSTXDATA
B3:00DEF9 903BC8            MOV      DPTR,#len
B3:00DEFC 12A790            LCALL    ?L?COM0098
B3:00DEFF 6019              JZ       ?C0163?S2
B3:00DF01 D3                SETB     C
B3:00DF02 EF                MOV      A,R7
B3:00DF03 9400              SUBB     A,#00H
B3:00DF05 EE                MOV      A,R6
B3:00DF06 9405              SUBB     A,#05H
B3:00DF08 5010              JNC      ?C0163?S2
B3:00DF0A 903BC5            MOV      DPTR,#buf
B3:00DF0D 122589            LCALL    ?C?PLDXDATA
B3:00DF10 E9                MOV      A,R1
B3:00DF11 4A                ORL      A,R2
B3:00DF12 6006              JZ       ?C0163?S2
B3:00DF14 12E845            LCALL    __S2_is_send_data_busy
B3:00DF17 EF                MOV      A,R7
B3:00DF18 6003              JZ       ?C0162?S2
B3:00DF1A         ?C0163?S2:
B3:00DF1A 7F00              MOV      R7,#00H
B3:00DF1C 22                RET      
B3:00DF1D         ?C0162?S2:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1074


B3:00DF1D 903BC5            MOV      DPTR,#buf
B3:00DF20 122589            LCALL    ?C?PLDXDATA
B3:00DF23 903BCD            MOV      DPTR,#d+03H
B3:00DF26 1225A9            LCALL    ?C?PSTXDATA
B3:00DF29 903BC8            MOV      DPTR,#len
B3:00DF2C E0                MOVX     A,@DPTR
B3:00DF2D FF                MOV      R7,A
B3:00DF2E A3                INC      DPTR
B3:00DF2F E0                MOVX     A,@DPTR
B3:00DF30 903BD0            MOV      DPTR,#d+06H
B3:00DF33 CF                XCH      A,R7
B3:00DF34 F0                MOVX     @DPTR,A
B3:00DF35 A3                INC      DPTR
B3:00DF36 EF                MOV      A,R7
B3:00DF37 F0                MOVX     @DPTR,A
B3:00DF38 903BC2            MOV      DPTR,#dst
B3:00DF3B 122589            LCALL    ?C?PLDXDATA
B3:00DF3E 903BCA            MOV      DPTR,#d
B3:00DF41 1225A9            LCALL    ?C?PSTXDATA
B3:00DF44 7B01              MOV      R3,#01H
B3:00DF46 7A3B              MOV      R2,#HIGH d
B3:00DF48 79CA              MOV      R1,#LOW d
B3:00DF4A E4                CLR      A
B3:00DF4B FF                MOV      R7,A
B3:00DF4C 128E6A            LCALL    ___S2_fsm_post_event
B3:00DF4F 7F01              MOV      R7,#01H
B3:00DF51 22                RET      
----- FUNCTION ___S2_send_data (END) -------


----- FUNCTION _ZW_TransportService_SendData (BEGIN) -----
B3:00DF52 90388B            MOV      DPTR,#p
B3:00DF55 1225A9            LCALL    ?C?PSTXDATA
B3:00DF58 7B01              MOV      R3,#01H
B3:00DF5A 7A38              MOV      R2,#HIGH t
B3:00DF5C 7995              MOV      R1,#LOW t
B3:00DF5E 7D13              MOV      R5,#013H
B3:00DF60 E4                CLR      A
B3:00DF61 FF                MOV      R7,A
B3:00DF62 1299EF            LCALL    ___ZW_memset
B3:00DF65 12BDEE            LCALL    ?L?COM0030
B3:00DF68 12BDA7            LCALL    ?L?COM0083
B3:00DF6B 12EA49            LCALL    ZW_TransportService_Is_Sending
B3:00DF6E 5002              JNC      ?C0021?TRANSPORT_SERVICE2
B3:00DF70 8005              SJMP     ?C0204?TRANSPORT_SERVICE2
B3:00DF72         ?C0021?TRANSPORT_SERVICE2:
B3:00DF72 12EA51            LCALL    ZW_TransportService_Is_Receving
B3:00DF75 500D              JNC      ?C0023?TRANSPORT_SERVICE2
B3:00DF77         
B3:00DF77 7B01              MOV      R3,#01H
B3:00DF79 7A38              MOV      R2,#HIGH t
B3:00DF7B 7995              MOV      R1,#LOW t
B3:00DF7D 903893            MOV      DPTR,#completedFunc
B3:00DF80 D102              ACALL    ?L?COM0414
B3:00DF82 C3                CLR      C
B3:00DF83 22                RET      
B3:00DF84         ?C0023?TRANSPORT_SERVICE2:
B3:00DF84 90388E            MOV      DPTR,#pData
B3:00DF87 122589            LCALL    ?C?PLDXDATA
B3:00DF8A 9029DB            MOV      DPTR,#scb+026H
B3:00DF8D 1225A9            LCALL    ?C?PSTXDATA
B3:00DF90 90388B            MOV      DPTR,#p
B3:00DF93 122589            LCALL    ?C?PLDXDATA
B3:00DF96 126149            LCALL    ?L?COM0047
B3:00DF99 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1075


B3:00DF9B 7A29              MOV      R2,#HIGH scb+08H
B3:00DF9D 79BD              MOV      R1,#LOW scb+08H
B3:00DF9F 7F07              MOV      R7,#07H
B3:00DFA1 1280A2            LCALL    ___ZW_memcpy
B3:00DFA4 903891            MOV      DPTR,#dataLength
B3:00DFA7 E0                MOVX     A,@DPTR
B3:00DFA8 FF                MOV      R7,A
B3:00DFA9 A3                INC      DPTR
B3:00DFAA E0                MOVX     A,@DPTR
B3:00DFAB 9029DE            MOV      DPTR,#scb+029H
B3:00DFAE CF                XCH      A,R7
B3:00DFAF F0                MOVX     @DPTR,A
B3:00DFB0 A3                INC      DPTR
B3:00DFB1 EF                MOV      A,R7
B3:00DFB2 F0                MOVX     @DPTR,A
B3:00DFB3 903893            MOV      DPTR,#completedFunc
B3:00DFB6 E0                MOVX     A,@DPTR
B3:00DFB7 FF                MOV      R7,A
B3:00DFB8 A3                INC      DPTR
B3:00DFB9 E0                MOVX     A,@DPTR
B3:00DFBA 9029C4            MOV      DPTR,#scb+0FH
B3:00DFBD CF                XCH      A,R7
B3:00DFBE 12C404            LCALL    ?L?COM0127
B3:00DFC1 7A29              MOV      R2,#HIGH scb+011H
B3:00DFC3 79C6              MOV      R1,#LOW scb+011H
B3:00DFC5 7D13              MOV      R5,#013H
B3:00DFC7 E4                CLR      A
B3:00DFC8 FF                MOV      R7,A
B3:00DFC9 1299EF            LCALL    ___ZW_memset
B3:00DFCC E4                CLR      A
B3:00DFCD 9029E0            MOV      DPTR,#scb+02BH
B3:00DFD0 F0                MOVX     @DPTR,A
B3:00DFD1 A3                INC      DPTR
B3:00DFD2 F0                MOVX     @DPTR,A
B3:00DFD3 A3                INC      DPTR
B3:00DFD4 7411              MOV      A,#011H
B3:00DFD6 F0                MOVX     @DPTR,A
B3:00DFD7 E4                CLR      A
B3:00DFD8 902A22            MOV      DPTR,#scb+06DH
B3:00DFDB F0                MOVX     @DPTR,A
B3:00DFDC A3                INC      DPTR
B3:00DFDD F0                MOVX     @DPTR,A
B3:00DFDE 902A2B            MOV      DPTR,#scb+076H
B3:00DFE1 F0                MOVX     @DPTR,A
B3:00DFE2 A3                INC      DPTR
B3:00DFE3 F0                MOVX     @DPTR,A
B3:00DFE4 A3                INC      DPTR
B3:00DFE5 F0                MOVX     @DPTR,A
B3:00DFE6 9029BB            MOV      DPTR,#scb+06H
B3:00DFE9 F0                MOVX     @DPTR,A
B3:00DFEA A3                INC      DPTR
B3:00DFEB F0                MOVX     @DPTR,A
B3:00DFEC 902A2E            MOV      DPTR,#scb+079H
B3:00DFEF F0                MOVX     @DPTR,A
B3:00DFF0 90388B            MOV      DPTR,#p
B3:00DFF3 129276            LCALL    ?L?COM0065
B3:00DFF6 902A2E            MOV      DPTR,#scb+079H
B3:00DFF9 F0                MOVX     @DPTR,A
B3:00DFFA 900B0F            MOV      DPTR,#current_state
B3:00DFFD E0                MOVX     A,@DPTR
B3:00DFFE 24FA              ADD      A,#0FAH
B3:00E000 6008              JZ       ?C0026?TRANSPORT_SERVICE2
B3:00E002 2406              ADD      A,#06H
B3:00E004 7009              JNZ      ?C0024?TRANSPORT_SERVICE2
B3:00E006         ?C0025?TRANSPORT_SERVICE2:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1076


B3:00E006 7F17              MOV      R7,#017H
B3:00E008 8002              SJMP     ?C0205?TRANSPORT_SERVICE2
B3:00E00A         ?C0026?TRANSPORT_SERVICE2:
B3:00E00A 7F18              MOV      R7,#018H
B3:00E00C         
B3:00E00C 12BD5A            LCALL    _t2_sm_post_event
B3:00E00F         ?C0024?TRANSPORT_SERVICE2:
B3:00E00F 12CEA0            LCALL    send_first_frag
B3:00E012 D3                SETB     C
B3:00E013 22                RET      
----- FUNCTION _ZW_TransportService_SendData (END) -------


----- FUNCTION _ZCB_timeout2 (BEGIN) -----
B3:;----                  JMP      __S2_timeout_notify
----- FUNCTION _ZCB_timeout2 (END) -------


----- FUNCTION __S2_timeout_notify (BEGIN) -----
B3:00E014 12BDF8            LCALL    ?L?COM0032
B3:00E017 7F08              MOV      R7,#08H
B3:00E019 028E6A            LJMP     ___S2_fsm_post_event
----- FUNCTION __S2_timeout_notify (END) -------


----- FUNCTION _S2_get_hw_random (BEGIN) -----
B3:00E01C 90419F            MOV      DPTR,#buf
B3:00E01F 1225A9            LCALL    ?C?PSTXDATA
B3:00E022 9041A2            MOV      DPTR,#len
B3:00E025 ED                MOV      A,R5
B3:00E026 F0                MOVX     @DPTR,A
B3:00E027 A3                INC      DPTR
B3:00E028 F0                MOVX     @DPTR,A
B3:00E029 D3                SETB     C
B3:00E02A 9410              SUBB     A,#010H
B3:00E02C 4003              JC       ?C0029?ZW_SECURITY_SCHEME2
B3:00E02E 7410              MOV      A,#010H
B3:00E030 F0                MOVX     @DPTR,A
B3:00E031         ?C0029?ZW_SECURITY_SCHEME2:
B3:00E031 9041A3            MOV      DPTR,#tmpLen
B3:00E034 E0                MOVX     A,@DPTR
B3:00E035 FF                MOV      R7,A
B3:00E036 7B01              MOV      R3,#01H
B3:00E038 7A12              MOV      R2,#HIGH retentionRandom
B3:00E03A 792B              MOV      R1,#LOW retentionRandom
B3:00E03C 126149            LCALL    ?L?COM0047
B3:00E03F 90419F            MOV      DPTR,#buf
B3:00E042 122589            LCALL    ?C?PLDXDATA
B3:00E045 1280A2            LCALL    ___ZW_memcpy
B3:00E048 90419F            MOV      DPTR,#buf
B3:00E04B 122589            LCALL    ?C?PLDXDATA
B3:00E04E 9041A3            MOV      DPTR,#tmpLen
B3:00E051 E0                MOVX     A,@DPTR
B3:00E052 FF                MOV      R7,A
B3:00E053 1164              ACALL    ?L?COM02C3
B3:00E055 9041A2            MOV      DPTR,#len
B3:00E058 E0                MOVX     A,@DPTR
B3:00E059 C3                CLR      C
B3:00E05A 9F                SUBB     A,R7
B3:00E05B FD                MOV      R5,A
B3:00E05C 023780            LJMP     _ZW_GetRandomArray
----- FUNCTION _S2_get_hw_random (END) -------


----- FUNCTION ?L?COM02C2 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1077


B3:00E05F F9                MOV      R1,A
B3:00E060 E4                CLR      A
B3:00E061 3A                ADDC     A,R2
B3:00E062 FA                MOV      R2,A
B3:00E063 EF                MOV      A,R7
B3:00E064         ?L?COM02C3:
B3:00E064 7C00              MOV      R4,#00H
B3:00E066 29                ADD      A,R1
B3:00E067 F9                MOV      R1,A
B3:00E068 EC                MOV      A,R4
B3:00E069 3A                ADDC     A,R2
B3:00E06A FA                MOV      R2,A
B3:00E06B 22                RET      
----- FUNCTION ?L?COM02C2 (END) -------


----- FUNCTION _Security2CommandHandler (BEGIN) -----
B3:00E06C 903C01            MOV      DPTR,#pCmd
B3:00E06F 1225A9            LCALL    ?C?PSTXDATA
B3:00E072 903C04            MOV      DPTR,#cmdLength
B3:00E075 127257            LCALL    ?L?COM0404
B3:00E078 2401              ADD      A,#01H
B3:00E07A 125510            LCALL    ?L?COM000B
B3:00E07D FC                MOV      R4,A
B3:00E07E 903C09            MOV      DPTR,#conn+01H
B3:00E081 F0                MOVX     @DPTR,A
B3:00E082 901221            MOV      DPTR,#nodeID
B3:00E085 E0                MOVX     A,@DPTR
B3:00E086 FD                MOV      R5,A
B3:00E087 903C08            MOV      DPTR,#conn
B3:00E08A F0                MOVX     @DPTR,A
B3:00E08B 903C05            MOV      DPTR,#rxopt
B3:00E08E 122589            LCALL    ?C?PLDXDATA
B3:00E091 121FB3            LCALL    ?C?CLDPTR
B3:00E094 540C              ANL      A,#0CH
B3:00E096 7E00              MOV      R6,#00H
B3:00E098 6002              JZ       ?C0031?ZW_SECURITY_SCHEME2
B3:00E09A 7E01              MOV      R6,#01H
B3:00E09C         ?C0031?ZW_SECURITY_SCHEME2:
B3:00E09C         ?C0032?ZW_SECURITY_SCHEME2:
B3:00E09C 903C0B            MOV      DPTR,#conn+03H
B3:00E09F EE                MOV      A,R6
B3:00E0A0 F0                MOVX     @DPTR,A
B3:00E0A1 121FB3            LCALL    ?C?CLDPTR
B3:00E0A4 903C0D            MOV      DPTR,#conn+05H
B3:00E0A7 F0                MOVX     @DPTR,A
B3:00E0A8 7E00              MOV      R6,#00H
B3:00E0AA 30E102            JNB      ACC.1,?C0033?ZW_SECURITY_SCHEME2
B3:00E0AD 7E02              MOV      R6,#02H
B3:00E0AF         ?C0033?ZW_SECURITY_SCHEME2:
B3:00E0AF         ?C0034?ZW_SECURITY_SCHEME2:
B3:00E0AF EE                MOV      A,R6
B3:00E0B0 4405              ORL      A,#05H
B3:00E0B2 903C0C            MOV      DPTR,#conn+04H
B3:00E0B5 F0                MOVX     @DPTR,A
B3:00E0B6 903C05            MOV      DPTR,#rxopt
B3:00E0B9 12707E            LCALL    ?L?COM00F2
B3:00E0BC 125510            LCALL    ?L?COM000B
B3:00E0BF 903C0E            MOV      DPTR,#conn+06H
B3:00E0C2 F0                MOVX     @DPTR,A
B3:00E0C3 903C01            MOV      DPTR,#pCmd
B3:00E0C6 12A1FB            LCALL    ?L?COM0430
B3:00E0C9 702C              JNZ      ?C0036?ZW_SECURITY_SCHEME2
B3:00E0CB         ?C0035?ZW_SECURITY_SCHEME2:
B3:00E0CB E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1078


B3:00E0CC 2401              ADD      A,#01H
B3:00E0CE 125510            LCALL    ?L?COM000B
B3:00E0D1 B40404            CJNE     A,#04H,?C0037?ZW_SECURITY_SCHEME2
B3:00E0D4 AF04              MOV      R7,AR4
B3:00E0D6 11F8              ACALL    ___S2_set_inclusion_peer
B3:00E0D8         ?C0037?ZW_SECURITY_SCHEME2:
B3:00E0D8 903C01            MOV      DPTR,#pCmd
B3:00E0DB 122589            LCALL    ?C?PLDXDATA
B3:00E0DE 903967            MOV      DPTR,#?___S2_application_command_handler?BYTE+03H
B3:00E0E1 1225A9            LCALL    ?C?PSTXDATA
B3:00E0E4 903C04            MOV      DPTR,#cmdLength
B3:00E0E7 E0                MOVX     A,@DPTR
B3:00E0E8 FF                MOV      R7,A
B3:00E0E9 90396A            MOV      DPTR,#?___S2_application_command_handler?BYTE+06H
B3:00E0EC E4                CLR      A
B3:00E0ED 12C404            LCALL    ?L?COM0127
B3:00E0F0 7A3C              MOV      R2,#HIGH conn
B3:00E0F2 7908              MOV      R1,#LOW conn
B3:00E0F4 12A020            LCALL    ___S2_application_command_handler
B3:00E0F7         ?C0036?ZW_SECURITY_SCHEME2:
B3:00E0F7 22                RET      
----- FUNCTION _Security2CommandHandler (END) -------


----- FUNCTION ___S2_set_inclusion_peer (BEGIN) -----
;---- Variable 'my_nodeid' assigned to Register 'R5' ----
;---- Variable 'inclusion_peer_nodeid' assigned to Register 'R7' ----
B3:00E0F8 9020E2            MOV      DPTR,#the_context+0CFH
B3:00E0FB ED                MOV      A,R5
B3:00E0FC F0                MOVX     @DPTR,A
B3:00E0FD A3                INC      DPTR
B3:00E0FE EF                MOV      A,R7
B3:00E0FF F0                MOVX     @DPTR,A
B3:00E100 22                RET      
----- FUNCTION ___S2_set_inclusion_peer (END) -------


----- FUNCTION s2_save_spans_and_mpans (BEGIN) -----
B3:00E101 903501            MOV      DPTR,#s2_ctx
B3:00E104 12705A            LCALL    ?L?COM00DA
B3:00E107 45F0              ORL      A,B
B3:00E109 601A              JZ       ?C0041?ZW_SECURITY_SCHEME2
B3:00E10B 12A53A            LCALL    ?L?COM02BF
B3:00E10E E9                MOV      A,R1
B3:00E10F 24E0              ADD      A,#0E0H
B3:00E111 F9                MOV      R1,A
B3:00E112 E4                CLR      A
B3:00E113 903C44            MOV      DPTR,#?_NVM_ext_write_long_buffer?BYTE+07H
B3:00E116 312E              ACALL    ?L?COM0549
B3:00E118 126600            LCALL    _NVM_ext_write_long_buffer
B3:00E11B 3126              ACALL    ?L?COM0610
B3:00E11D 904176            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
B3:00E120 04                INC      A
B3:00E121 F0                MOVX     @DPTR,A
B3:00E122 123BEC            LCALL    _NVM_ext_write_long_byte
B3:00E125         ?C0041?ZW_SECURITY_SCHEME2:
B3:00E125 22                RET      
----- FUNCTION s2_save_spans_and_mpans (END) -------


----- FUNCTION ?L?COM0610 (BEGIN) -----
B3:00E126 7E12              MOV      R6,#HIGH span_mpan_table_valid
B3:00E128 7F94              MOV      R7,#LOW span_mpan_table_valid
B3:00E12A E4                CLR      A
B3:00E12B FC                MOV      R4,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1079


B3:00E12C FD                MOV      R5,A
B3:00E12D 22                RET      
----- FUNCTION ?L?COM0610 (END) -------


----- FUNCTION ?L?COM0549 (BEGIN) -----
B3:00E12E 3A                ADDC     A,R2
B3:00E12F FA                MOV      R2,A
B3:00E130 7401              MOV      A,#01H
B3:00E132 F0                MOVX     @DPTR,A
B3:00E133 A3                INC      DPTR
B3:00E134 7427              MOV      A,#027H
B3:00E136 F0                MOVX     @DPTR,A
B3:00E137 22                RET      
----- FUNCTION ?L?COM0549 (END) -------


----- FUNCTION _ZW_SetSecurityS2InclusionPublicDSK_CSA (BEGIN) -----
;---- Variable 'response' assigned to Register 'R1/R2/R3' ----
B3:;----                  JMP      _s2_inclusion_set_public_csa_dsk
----- FUNCTION _ZW_SetSecurityS2InclusionPublicDSK_CSA (END) -------


----- FUNCTION _s2_inclusion_set_public_csa_dsk (BEGIN) -----
B3:00E138 9042C1            MOV      DPTR,#response_dsk
B3:00E13B 1225A9            LCALL    ?C?PSTXDATA
B3:00E13E 9042C1            MOV      DPTR,#response_dsk
B3:00E141 122589            LCALL    ?C?PLDXDATA
B3:00E144 121FB3            LCALL    ?C?CLDPTR
B3:00E147 903831            MOV      DPTR,#challenge_response
B3:00E14A F0                MOVX     @DPTR,A
B3:00E14B E9                MOV      A,R1
B3:00E14C 2401              ADD      A,#01H
B3:00E14E 125510            LCALL    ?L?COM000B
B3:00E151 903832            MOV      DPTR,#challenge_response+01H
B3:00E154 F0                MOVX     @DPTR,A
B3:00E155 9042C1            MOV      DPTR,#response_dsk
B3:00E158 122589            LCALL    ?C?PLDXDATA
B3:00E15B E9                MOV      A,R1
B3:00E15C 2402              ADD      A,#02H
B3:00E15E 125510            LCALL    ?L?COM000B
B3:00E161 903833            MOV      DPTR,#challenge_response+02H
B3:00E164 F0                MOVX     @DPTR,A
B3:00E165 9042C1            MOV      DPTR,#response_dsk
B3:00E168 12707E            LCALL    ?L?COM00F2
B3:00E16B 125510            LCALL    ?L?COM000B
B3:00E16E 903834            MOV      DPTR,#challenge_response+03H
B3:00E171 F0                MOVX     @DPTR,A
B3:00E172 31BD              ACALL    ?L?COM03F4
B3:;----                  JMP      _s2_inclusion_challenge_response
----- FUNCTION _s2_inclusion_set_public_csa_dsk (END) -------


----- FUNCTION _s2_inclusion_challenge_response (BEGIN) -----
B3:00E174 9041AF            MOV      DPTR,#p_response
B3:00E177 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'include' assigned to Register 'R7' ----
B3:00E17A EF                MOV      A,R7
B3:00E17B 6401              XRL      A,#01H
B3:00E17D 7033              JNZ      ?C0042?S2_INCLUSION
B3:00E17F         ?C0043?S2_INCLUSION:
B3:00E17F 9041B2            MOV      DPTR,#responseLength
B3:00E182 E0                MOVX     A,@DPTR
B3:00E183 FF                MOV      R7,A
B3:00E184 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1080


B3:00E185 F0                MOVX     @DPTR,A
B3:00E186 EF                MOV      A,R7
B3:00E187 6023              JZ       ?C0044?S2_INCLUSION
B3:00E189 9041AF            MOV      DPTR,#p_response
B3:00E18C 122589            LCALL    ?C?PLDXDATA
B3:00E18F 9041B2            MOV      DPTR,#responseLength
B3:00E192 E0                MOVX     A,@DPTR
B3:00E193 FF                MOV      R7,A
B3:00E194 F582              MOV      DPL,A
B3:00E196 1289F4            LCALL    ?L?COM00E4
B3:00E199 FE                MOV      R6,A
B3:00E19A EF                MOV      A,R7
B3:00E19B 7C00              MOV      R4,#00H
B3:00E19D 7B01              MOV      R3,#01H
B3:00E19F 242B              ADD      A,#LOW the_context+0318H
B3:00E1A1 F9                MOV      R1,A
B3:00E1A2 EC                MOV      A,R4
B3:00E1A3 3423              ADDC     A,#HIGH the_context+0318H
B3:00E1A5 FA                MOV      R2,A
B3:00E1A6 EE                MOV      A,R6
B3:00E1A7 122072            LCALL    ?C?CSTPTR
B3:00E1AA 80D3              SJMP     ?C0043?S2_INCLUSION
B3:00E1AC         ?C0044?S2_INCLUSION:
B3:00E1AC 7402              MOV      A,#02H
B3:00E1AE FF                MOV      R7,A
B3:00E1AF FE                MOV      R6,A
B3:00E1B0 8004              SJMP     ?C0134?S2_INCLUSION
B3:00E1B2         ?C0042?S2_INCLUSION:
B3:00E1B2 7F03              MOV      R7,#03H
B3:00E1B4 7E02              MOV      R6,#02H
B3:00E1B6         
B3:00E1B6 02A879            LJMP     _process_event
----- FUNCTION _s2_inclusion_challenge_response (END) -------


----- FUNCTION ZCB_s2_inclusion_txqueue_empty (BEGIN) -----
B3:00E1B9 31BD              ACALL    ?L?COM03F4
B3:00E1BB 80B7              SJMP     _s2_inclusion_challenge_response
----- FUNCTION ZCB_s2_inclusion_txqueue_empty (END) -------


----- FUNCTION ?L?COM03F4 (BEGIN) -----
B3:00E1BD 7B01              MOV      R3,#01H
B3:00E1BF 7A38              MOV      R2,#HIGH challenge_response
B3:00E1C1 7931              MOV      R1,#LOW challenge_response
B3:00E1C3 9041B2            MOV      DPTR,#?_s2_inclusion_challenge_response?BYTE+04H
B3:00E1C6 7404              MOV      A,#04H
B3:00E1C8 F0                MOVX     @DPTR,A
B3:00E1C9 7F01              MOV      R7,#01H
B3:00E1CB 22                RET      
----- FUNCTION ?L?COM03F4 (END) -------


----- FUNCTION s2_inclusion_set_txqueue_empty_event (BEGIN) -----
B3:00E1CC 7B01              MOV      R3,#01H
B3:00E1CE 7A38              MOV      R2,#HIGH sTxQueueEmptyEvent_elem
B3:00E1D0 794A              MOV      R1,#LOW sTxQueueEmptyEvent_elem
B3:00E1D2 7C1C              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_s2_inclusion_txqueue_empty
B3:00E1D4 7DB4              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_s2_inclusion_txqueue_empty
B3:00E1D6 021A48            LJMP     ?INTERBANK_TABLE?_TxQueueEmptyEvent_Add
----- FUNCTION s2_inclusion_set_txqueue_empty_event (END) -------


----- FUNCTION _S2_get_commands_supported (BEGIN) -----
;---- Variable 'ppCmdClasses' assigned to Register 'R1/R2/R3' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1081


;---- Variable 'class_id' assigned to Register 'R5' ----
B3:00E1D9 ED                MOV      A,R5
B3:00E1DA 04                INC      A
B3:00E1DB FF                MOV      R7,A
B3:00E1DC C003              PUSH     AR3
B3:00E1DE C002              PUSH     AR2
B3:00E1E0 C001              PUSH     AR1
B3:00E1E2 903FA9            MOV      DPTR,#pLength
B3:00E1E5 122589            LCALL    ?C?PLDXDATA
B3:00E1E8 903E5A            MOV      DPTR,#?_ApplicationSecureCommandsSupported?BYTE+04H
B3:00E1EB 1225A9            LCALL    ?C?PSTXDATA
B3:00E1EE D001              POP      AR1
B3:00E1F0 D002              POP      AR2
B3:00E1F2 D003              POP      AR3
B3:00E1F4 021EAD            LJMP     ?INTERBANK_TABLE?_ApplicationSecureCommandsSupported
----- FUNCTION _S2_get_commands_supported (END) -------


----- FUNCTION ZW_s2_inclusion_init (BEGIN) -----
B3:00E1F7 121E17            LCALL    ?INTERBANK_TABLE?ApplicationSecureKeysRequested
B3:00E1FA AB07              MOV      R3,AR7
B3:00E1FC 7D01              MOV      R5,#01H
B3:00E1FE 7F02              MOV      R7,#02H
B3:00E200 02891E            LJMP     _s2_inclusion_init
----- FUNCTION ZW_s2_inclusion_init (END) -------


----- FUNCTION _clearOutEvents (BEGIN) -----
B3:00E203 22                RET      
----- FUNCTION _clearOutEvents (END) -------


----- FUNCTION _secure_learnIface_raise_learnRequest (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E204 900018            MOV      DPTR,#018H
B3:00E207 7401              MOV      A,#01H
B3:00E209 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_learnRequest (END) -------


----- FUNCTION _secure_learnIface_raise_assignIdDone (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E20C 900019            MOV      DPTR,#019H
B3:00E20F 7401              MOV      A,#01H
B3:00E211 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_assignIdDone (END) -------


----- FUNCTION _secure_learnIface_raise_inclusionRequest (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E214 90001B            MOV      DPTR,#01BH
B3:00E217 122475            LCALL    ?C?LSTOPTR
B3:00E21A 90001A            MOV      DPTR,#01AH
B3:00E21D 7401              MOV      A,#01H
B3:00E21F 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_inclusionRequest (END) -------


----- FUNCTION _secure_learnIface_raise_commandsSupportedRequest (BEGIN) -----
B3:00E222 90411A            MOV      DPTR,#handle
B3:00E225 1225A9            LCALL    ?C?PSTXDATA
B3:00E228 90411D            MOV      DPTR,#value
B3:00E22B 122589            LCALL    ?C?PLDXDATA
B3:00E22E C003              PUSH     AR3
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1082


B3:00E230 C002              PUSH     AR2
B3:00E232 C001              PUSH     AR1
B3:00E234 90411A            MOV      DPTR,#handle
B3:00E237 122589            LCALL    ?C?PLDXDATA
B3:00E23A 900020            MOV      DPTR,#020H
B3:00E23D 12265D            LCALL    ?C?PSTOPTR
B3:00E240 90411A            MOV      DPTR,#handle
B3:00E243 122589            LCALL    ?C?PLDXDATA
B3:00E246 90001F            MOV      DPTR,#01FH
B3:00E249 7401              MOV      A,#01H
B3:00E24B 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_commandsSupportedRequest (END) -------


----- FUNCTION _secure_learnIface_raise_scheme_get (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E24E 900026            MOV      DPTR,#026H
B3:00E251 122475            LCALL    ?C?LSTOPTR
B3:00E254 900025            MOV      DPTR,#025H
B3:00E257 7401              MOV      A,#01H
B3:00E259 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_scheme_get (END) -------


----- FUNCTION _secure_learnIface_raise_scheme_inherit (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E25C 90002B            MOV      DPTR,#02BH
B3:00E25F 122475            LCALL    ?C?LSTOPTR
B3:00E262 90002A            MOV      DPTR,#02AH
B3:00E265 7401              MOV      A,#01H
B3:00E267 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_scheme_inherit (END) -------


----- FUNCTION _secure_learnIface_raise_key_set (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E26A 900030            MOV      DPTR,#030H
B3:00E26D 122475            LCALL    ?C?LSTOPTR
B3:00E270 90002F            MOV      DPTR,#02FH
B3:00E273 7401              MOV      A,#01H
B3:00E275 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_key_set (END) -------


----- FUNCTION _secure_learnIface_raise_scheme_report (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E278 900035            MOV      DPTR,#035H
B3:00E27B 122475            LCALL    ?C?LSTOPTR
B3:00E27E 900034            MOV      DPTR,#034H
B3:00E281 7401              MOV      A,#01H
B3:00E283 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_scheme_report (END) -------


----- FUNCTION _secure_learnIface_raise_key_verify (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E286 90003A            MOV      DPTR,#03AH
B3:00E289 122475            LCALL    ?C?LSTOPTR
B3:00E28C 900039            MOV      DPTR,#039H
B3:00E28F 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1083


B3:00E291 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_key_verify (END) -------


----- FUNCTION _secure_learnIface_get_txOptions (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E294 02AF7A            LJMP     ?L?COM0507
----- FUNCTION _secure_learnIface_get_txOptions (END) -------


----- FUNCTION _secure_learnIface_get_isController (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E297 12B3AA            LCALL    ?L?COM0322
B3:00E29A FF                MOV      R7,A
B3:00E29B 22                RET      
----- FUNCTION _secure_learnIface_get_isController (END) -------


----- FUNCTION _secure_learnIface_get_node (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E29C 02B2D8            LJMP     ?L?COM01BD
----- FUNCTION _secure_learnIface_get_node (END) -------


----- FUNCTION _secure_learnIface_set_node (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E29F 90000C            MOV      DPTR,#0CH
B3:00E2A2 022475            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_node (END) -------


----- FUNCTION _secure_learnIface_get_scheme (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E2A5 900010            MOV      DPTR,#010H
B3:00E2A8 02242B            LJMP     ?C?LLDOPTR
----- FUNCTION _secure_learnIface_get_scheme (END) -------


----- FUNCTION _secure_learnIface_set_scheme (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E2AB 900010            MOV      DPTR,#010H
B3:00E2AE 022475            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_scheme (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Fail (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E2B1 740C              MOV      A,#0CH
B3:00E2B3 122072            LCALL    ?C?CSTPTR
B3:00E2B6 12AD59            LCALL    ?L?COM0041
B3:00E2B9 51BE              ACALL    ?L?COM02FA
B3:00E2BB 02223E            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Fail (END) -------


----- FUNCTION ?L?COM02FA (BEGIN) -----
B3:00E2BE 7407              MOV      A,#07H
B3:00E2C0         ?L?COM02FB:
B3:00E2C0 122072            LCALL    ?C?CSTPTR
B3:00E2C3         ?L?COM02FC:
B3:00E2C3 900001            MOV      DPTR,#01H
B3:00E2C6 E4                CLR      A
B3:00E2C7 F5F0              MOV      B,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1084


B3:00E2C9 22                RET      
----- FUNCTION ?L?COM02FA (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_InsecureNet (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E2CA 740C              MOV      A,#0CH
B3:00E2CC 122072            LCALL    ?C?CSTPTR
B3:00E2CF 12AD59            LCALL    ?L?COM0041
B3:00E2D2 51BE              ACALL    ?L?COM02FA
B3:00E2D4 02223E            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_InsecureNet (END) -------


----- FUNCTION _secure_learn_react_main_region_Complete (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E2D7 740C              MOV      A,#0CH
B3:00E2D9 122072            LCALL    ?C?CSTPTR
B3:00E2DC 12AD59            LCALL    ?L?COM0041
B3:00E2DF 7409              MOV      A,#09H
B3:00E2E1 51C0              ACALL    ?L?COM02FB
B3:00E2E3 02223E            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_Complete (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Inherited (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E2E6 7115              ACALL    ?L?COM0469
B3:00E2E8 600C              JZ       ?C0127?SECURE_LEARN
B3:00E2EA 740C              MOV      A,#0CH
B3:00E2EC 122072            LCALL    ?C?CSTPTR
B3:00E2EF 12AD59            LCALL    ?L?COM0041
B3:00E2F2 7407              MOV      A,#07H
B3:00E2F4 8018              SJMP     ?C0189?SECURE_LEARN
B3:00E2F6         ?C0127?SECURE_LEARN:
B3:00E2F6 7137              ACALL    ?L?COM0377
B3:00E2F8 601A              JZ       ?C0130?SECURE_LEARN
B3:00E2FA 740C              MOV      A,#0CH
B3:00E2FC 122072            LCALL    ?C?CSTPTR
B3:00E2FF 12AD59            LCALL    ?L?COM0041
B3:00E302 900010            MOV      DPTR,#010H
B3:00E305 122548            LCALL    ?C?LSTKOPTR
B3:00E308 00                DB       00H
B3:00E309 00                DB       00H
B3:00E30A 00                DB       00H
B3:00E30B 00                DB       00H
B3:00E30C 7403              MOV      A,#03H
B3:00E30E         
B3:00E30E 122072            LCALL    ?C?CSTPTR
B3:00E311 12AD59            LCALL    ?L?COM0041
B3:00E314         ?C0130?SECURE_LEARN:
B3:00E314 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Inherited (END) -------


----- FUNCTION ?L?COM0469 (BEGIN) -----
B3:00E315 900023            MOV      DPTR,#023H
B3:00E318 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0469 (END) -------


----- FUNCTION _secure_learn_react_main_region_SendReport (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E31B 7137              ACALL    ?L?COM0377
B3:00E31D 7004              JNZ      ?C0158?SECURE_LEARN
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1085


B3:00E31F 7115              ACALL    ?L?COM0469
B3:00E321 6010              JZ       ?C0159?SECURE_LEARN
B3:00E323         ?C0158?SECURE_LEARN:
B3:00E323 740C              MOV      A,#0CH
B3:00E325 122072            LCALL    ?C?CSTPTR
B3:00E328 12AD59            LCALL    ?L?COM0041
B3:00E32B 7409              MOV      A,#09H
B3:00E32D 122072            LCALL    ?C?CSTPTR
B3:00E330 12AD59            LCALL    ?L?COM0041
B3:00E333         ?C0159?SECURE_LEARN:
B3:00E333 22                RET      
----- FUNCTION _secure_learn_react_main_region_SendReport (END) -------


----- FUNCTION ?L?COM0376 (BEGIN) -----
B3:00E334 122589            LCALL    ?C?PLDXDATA
B3:00E337         ?L?COM0377:
B3:00E337 900024            MOV      DPTR,#024H
B3:00E33A 021FF0            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0376 (END) -------


----- FUNCTION _ZW_UART_tx_send_str (BEGIN) -----
B3:00E33D 9042E2            MOV      DPTR,#str
B3:00E340 7174              ACALL    ?L?COM060C
B3:00E342 B40117            CJNE     A,#01H,?C0014?ZW_UART_SUPPORT
B3:00E345         ?C0011?ZW_UART_SUPPORT:
B3:00E345 9042E2            MOV      DPTR,#str
B3:00E348 122589            LCALL    ?C?PLDXDATA
B3:00E34B 121FB3            LCALL    ?C?CLDPTR
B3:00E34E FF                MOV      R7,A
B3:00E34F 6022              JZ       ?C0016?ZW_UART_SUPPORT
B3:00E351 126C20            LCALL    _ZW_UART0_tx_send_byte
B3:00E354 9042E3            MOV      DPTR,#str+01H
B3:00E357 123F7F            LCALL    ?L?COM0081
B3:00E35A 80E9              SJMP     ?C0011?ZW_UART_SUPPORT
B3:00E35C         ?C0014?ZW_UART_SUPPORT:
B3:00E35C 9042E2            MOV      DPTR,#str
B3:00E35F 122589            LCALL    ?C?PLDXDATA
B3:00E362 121FB3            LCALL    ?C?CLDPTR
B3:00E365 FF                MOV      R7,A
B3:00E366 600B              JZ       ?C0016?ZW_UART_SUPPORT
B3:00E368 128A85            LCALL    _ZW_UART1_tx_send_byte
B3:00E36B 9042E3            MOV      DPTR,#str+01H
B3:00E36E 123F7F            LCALL    ?L?COM0081
B3:00E371 80E9              SJMP     ?C0014?ZW_UART_SUPPORT
B3:00E373         ?C0016?ZW_UART_SUPPORT:
B3:00E373 22                RET      
----- FUNCTION _ZW_UART_tx_send_str (END) -------


----- FUNCTION ?L?COM060C (BEGIN) -----
B3:00E374 1225A9            LCALL    ?C?PSTXDATA
B3:00E377 901229            MOV      DPTR,#bNVRUartPinSwap
B3:00E37A E0                MOVX     A,@DPTR
B3:00E37B 22                RET      
----- FUNCTION ?L?COM060C (END) -------


----- FUNCTION _ZW_UART0_tx_send_w_num (BEGIN) -----
B3:00E37C 904358            MOV      DPTR,#bData
B3:00E37F EE                MOV      A,R6
B3:00E380 F0                MOVX     @DPTR,A
B3:00E381 A3                INC      DPTR
B3:00E382 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1086


B3:00E383 F0                MOVX     @DPTR,A
B3:00E384 904358            MOV      DPTR,#bData
B3:00E387 E0                MOVX     A,@DPTR
B3:00E388 FF                MOV      R7,A
B3:00E389 128B9A            LCALL    _ZW_UART0_tx_send_hex
B3:00E38C 904358            MOV      DPTR,#bData
B3:00E38F A3                INC      DPTR
B3:00E390 E0                MOVX     A,@DPTR
B3:00E391 FF                MOV      R7,A
B3:00E392 028B9A            LJMP     _ZW_UART0_tx_send_hex
----- FUNCTION _ZW_UART0_tx_send_w_num (END) -------


----- FUNCTION _ZW_UART1_tx_send_w_num (BEGIN) -----
B3:00E395 90435A            MOV      DPTR,#bData
B3:00E398 EE                MOV      A,R6
B3:00E399 F0                MOVX     @DPTR,A
B3:00E39A A3                INC      DPTR
B3:00E39B EF                MOV      A,R7
B3:00E39C F0                MOVX     @DPTR,A
B3:00E39D 90435A            MOV      DPTR,#bData
B3:00E3A0 E0                MOVX     A,@DPTR
B3:00E3A1 FF                MOV      R7,A
B3:00E3A2 128A8D            LCALL    _ZW_UART1_tx_send_hex
B3:00E3A5 90435A            MOV      DPTR,#bData
B3:00E3A8 A3                INC      DPTR
B3:00E3A9 E0                MOVX     A,@DPTR
B3:00E3AA FF                MOV      R7,A
B3:00E3AB 028A8D            LJMP     _ZW_UART1_tx_send_hex
----- FUNCTION _ZW_UART1_tx_send_w_num (END) -------


----- FUNCTION _ZW_FirmwareUpdate_NVM_Write (BEGIN) -----
B3:00E3AE 903E1A            MOV      DPTR,#sourceBuffer
B3:00E3B1 1225A9            LCALL    ?C?PSTXDATA
B3:00E3B4 903E1D            MOV      DPTR,#fw_bufSize
B3:00E3B7 EC                MOV      A,R4
B3:00E3B8 F0                MOVX     @DPTR,A
B3:00E3B9 A3                INC      DPTR
B3:00E3BA ED                MOV      A,R5
B3:00E3BB F0                MOVX     @DPTR,A
B3:00E3BC E4                CLR      A
B3:00E3BD 903E23            MOV      DPTR,#retVal
B3:00E3C0 F0                MOVX     @DPTR,A
B3:00E3C1 90353F            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00E3C4 E0                MOVX     A,@DPTR
B3:00E3C5 603A              JZ       ?C0001?ZW_FIRMWARE_UPDATE_NVM_WRITE
B3:00E3C7 9107              ACALL    ?L?COM0542
B3:00E3C9 1270C7            LCALL    ?L?COM0161
B3:00E3CC 1273AC            LCALL    ?L?COM05A4
B3:00E3CF 903E1D            MOV      DPTR,#fw_bufSize
B3:00E3D2 B10A              ACALL    ?L?COM00B0
B3:00E3D4 12226B            LCALL    ?C?LADD
B3:00E3D7 903509            MOV      DPTR,#systemNVM_Size
B3:00E3DA 1224B5            LCALL    ?C?LLDXDATA0
B3:00E3DD C3                CLR      C
B3:00E3DE 1223D4            LCALL    ?C?ULCMP
B3:00E3E1 401E              JC       ?C0001?ZW_FIRMWARE_UPDATE_NVM_WRITE
B3:00E3E3 9107              ACALL    ?L?COM0542
B3:00E3E5 1270C7            LCALL    ?L?COM0161
B3:00E3E8 C007              PUSH     AR7
B3:00E3EA 903E1A            MOV      DPTR,#sourceBuffer
B3:00E3ED 122589            LCALL    ?C?PLDXDATA
B3:00E3F0 903E1D            MOV      DPTR,#fw_bufSize
B3:00E3F3 126C93            LCALL    ?L?COM0467
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1087


B3:00E3F6 D007              POP      AR7
B3:00E3F8 126600            LCALL    _NVM_ext_write_long_buffer
B3:00E3FB E4                CLR      A
B3:00E3FC 33                RLC      A
B3:00E3FD 903E23            MOV      DPTR,#retVal
B3:00E400 F0                MOVX     @DPTR,A
B3:00E401         ?C0001?ZW_FIRMWARE_UPDATE_NVM_WRITE:
B3:00E401 903E23            MOV      DPTR,#retVal
B3:00E404 E0                MOVX     A,@DPTR
B3:00E405 FF                MOV      R7,A
B3:00E406 22                RET      
----- FUNCTION _ZW_FirmwareUpdate_NVM_Write (END) -------


----- FUNCTION ?L?COM0542 (BEGIN) -----
B3:00E407 903E1F            MOV      DPTR,#firmwareOffset
B3:00E40A 122499            LCALL    ?C?LLDXDATA
B3:00E40D 90353B            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00E410 22                RET      
----- FUNCTION ?L?COM0542 (END) -------


----- FUNCTION _byte2UniAsciiHex (BEGIN) -----
B3:00E411 90407C            MOV      DPTR,#outBuf
B3:00E414 1225A9            LCALL    ?C?PSTXDATA
B3:00E417 904082            MOV      DPTR,#bData
B3:00E41A E0                MOVX     A,@DPTR
B3:00E41B FF                MOV      R7,A
B3:00E41C 913D              ACALL    ?L?COM05A3
B3:00E41E 121FCC            LCALL    ?C?CLDIPTR
B3:00E421 FE                MOV      R6,A
B3:00E422 90407C            MOV      DPTR,#outBuf
B3:00E425 122589            LCALL    ?C?PLDXDATA
B3:00E428 8E82              MOV      DPL,R6
B3:00E42A 1271E7            LCALL    ?L?COM037C
B3:00E42D 913D              ACALL    ?L?COM05A3
B3:00E42F 121FCC            LCALL    ?C?CLDIPTR
B3:00E432 FF                MOV      R7,A
B3:00E433 90407C            MOV      DPTR,#outBuf
B3:00E436 128C47            LCALL    ?L?COM00B5
B3:00E439 E4                CLR      A
B3:00E43A 022084            LJMP     ?C?CSTOPTR
----- FUNCTION _byte2UniAsciiHex (END) -------


----- FUNCTION ?L?COM05A3 (BEGIN) -----
B3:00E43D 90407F            MOV      DPTR,#pPos
B3:00E440 122589            LCALL    ?C?PLDXDATA
B3:00E443 7401              MOV      A,#01H
B3:00E445 22                RET      
----- FUNCTION ?L?COM05A3 (END) -------


----- FUNCTION _ZW_UART1_init (BEGIN) -----
B3:00E446 904237            MOV      DPTR,#bBaudRate
B3:00E449 EE                MOV      A,R6
B3:00E44A F0                MOVX     @DPTR,A
B3:00E44B A3                INC      DPTR
B3:00E44C 124765            LCALL    ?L?COM0102
B3:00E44F EB                MOV      A,R3
B3:00E450 F0                MOVX     @DPTR,A
B3:00E451 91BD              ACALL    ?L?COM0177
B3:00E453 1247DB            LCALL    ?L?COM058C
B3:00E456 C006              PUSH     AR6
B3:00E458 C007              PUSH     AR7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1088


B3:00E45A 904237            MOV      DPTR,#bBaudRate
B3:00E45D 1272C0            LCALL    ?L?COM0466
B3:00E460 F8                MOV      R0,A
B3:00E461 D007              POP      AR7
B3:00E463 D006              POP      AR6
B3:00E465 D3                SETB     C
B3:00E466 1223BE            LCALL    ?C?SLCMP
B3:00E469 7E00              MOV      R6,#00H
B3:00E46B 5004              JNC      ?C0001?ZW_PHY_UART1_050X
B3:00E46D 7F01              MOV      R7,#01H
B3:00E46F 8002              SJMP     ?C0027?ZW_PHY_UART1_050X
B3:00E471         ?C0001?ZW_PHY_UART1_050X:
B3:00E471 7F00              MOV      R7,#00H
B3:00E473         
B3:00E473 C006              PUSH     AR6
B3:00E475 C007              PUSH     AR7
B3:00E477         ?C0002?ZW_PHY_UART1_050X:
B3:00E477 91BD              ACALL    ?L?COM0177
B3:00E479 D0E0              POP      ACC
B3:00E47B 2F                ADD      A,R7
B3:00E47C FF                MOV      R7,A
B3:00E47D D0E0              POP      ACC
B3:00E47F 3E                ADDC     A,R6
B3:00E480 904237            MOV      DPTR,#bBaudRate
B3:00E483 F0                MOVX     @DPTR,A
B3:00E484 A3                INC      DPTR
B3:00E485 EF                MOV      A,R7
B3:00E486 F0                MOVX     @DPTR,A
B3:00E487 53ECCF            ANL      UARTCON,#0CFH
B3:00E48A 904237            MOV      DPTR,#bBaudRate
B3:00E48D 1247B6            LCALL    ?L?COM031C
B3:00E490 5403              ANL      A,#03H
B3:00E492 126E50            LCALL    ?L?COM04E0
B3:00E495 42EC              ORL      UARTCON,A
B3:00E497 75FF02            MOV      SFRPAGE,#02H
B3:00E49A ED                MOV      A,R5
B3:00E49B F5AE              MOV      UART1BRL,A
B3:00E49D 75ED20            MOV      UARTSTAT,#020H
B3:00E4A0 75ED40            MOV      UARTSTAT,#040H
B3:00E4A3 A3                INC      DPTR
B3:00E4A4 E0                MOVX     A,@DPTR
B3:00E4A5 6005              JZ       ?C0003?ZW_PHY_UART1_050X
B3:00E4A7 43EC80            ORL      UARTCON,#080H
B3:00E4AA 8003              SJMP     ?C0004?ZW_PHY_UART1_050X
B3:00E4AC         ?C0003?ZW_PHY_UART1_050X:
B3:00E4AC 53EC7F            ANL      UARTCON,#07FH
B3:00E4AF         ?C0004?ZW_PHY_UART1_050X:
B3:00E4AF 90423A            MOV      DPTR,#bEnableRx
B3:00E4B2 E0                MOVX     A,@DPTR
B3:00E4B3 6004              JZ       ?C0005?ZW_PHY_UART1_050X
B3:00E4B5 43EC40            ORL      UARTCON,#040H
B3:00E4B8 22                RET      
B3:00E4B9         ?C0005?ZW_PHY_UART1_050X:
B3:00E4B9 53ECBF            ANL      UARTCON,#0BFH
B3:00E4BC 22                RET      
----- FUNCTION _ZW_UART1_init (END) -------


----- FUNCTION ?L?COM0177 (BEGIN) -----
B3:00E4BD 904237            MOV      DPTR,#bBaudRate
B3:00E4C0 E0                MOVX     A,@DPTR
B3:00E4C1 FE                MOV      R6,A
B3:00E4C2 A3                INC      DPTR
B3:00E4C3 E0                MOVX     A,@DPTR
B3:00E4C4 FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1089


B3:00E4C5 AA06              MOV      R2,AR6
B3:00E4C7 E4                CLR      A
B3:00E4C8 F9                MOV      R1,A
B3:00E4C9 F8                MOV      R0,A
B3:00E4CA 7F80              MOV      R7,#080H
B3:00E4CC 7E38              MOV      R6,#038H
B3:00E4CE 7D01              MOV      R5,#01H
B3:00E4D0 FC                MOV      R4,A
B3:00E4D1 022F31            LJMP     ?C?SLDIV
----- FUNCTION ?L?COM0177 (END) -------


----- FUNCTION ?L?COM00AF (BEGIN) -----
B3:00E4D4 7A2E              MOV      R2,#HIGH nonce
B3:00E4D6 7951              MOV      R1,#LOW nonce
B3:00E4D8 903408            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+03H
B3:00E4DB 1225A9            LCALL    ?C?PSTXDATA
B3:00E4DE 902E61            MOV      DPTR,#aad
B3:00E4E1 122589            LCALL    ?C?PLDXDATA
B3:00E4E4 90340B            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+06H
B3:00E4E7 1225A9            LCALL    ?C?PSTXDATA
B3:00E4EA 902E64            MOV      DPTR,#aad_len
B3:00E4ED E0                MOVX     A,@DPTR
B3:00E4EE FE                MOV      R6,A
B3:00E4EF A3                INC      DPTR
B3:00E4F0 E0                MOVX     A,@DPTR
B3:00E4F1 FF                MOV      R7,A
B3:00E4F2 E4                CLR      A
B3:00E4F3 FC                MOV      R4,A
B3:00E4F4 FD                MOV      R5,A
B3:00E4F5 90340E            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+09H
B3:00E4F8 1224F1            LCALL    ?C?LSTXDATA
B3:00E4FB 902E67            MOV      DPTR,#ciphertext
B3:00E4FE 122589            LCALL    ?C?PLDXDATA
B3:00E501 903412            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+0DH
B3:00E504 1225A9            LCALL    ?C?PSTXDATA
B3:00E507 902E6A            MOV      DPTR,#ciphertext_len
B3:00E50A         ?L?COM00B0:
B3:00E50A E0                MOVX     A,@DPTR
B3:00E50B FE                MOV      R6,A
B3:00E50C A3                INC      DPTR
B3:00E50D E0                MOVX     A,@DPTR
B3:00E50E FF                MOV      R7,A
B3:00E50F E4                CLR      A
B3:00E510 FC                MOV      R4,A
B3:00E511 FD                MOV      R5,A
B3:00E512 22                RET      
----- FUNCTION ?L?COM00AF (END) -------


----- FUNCTION ZW_UART1_rx_int_clear (BEGIN) -----
B3:00E513 75ED40            MOV      UARTSTAT,#040H
B3:00E516 22                RET      
----- FUNCTION ZW_UART1_rx_int_clear (END) -------


----- FUNCTION ZW_UART1_tx_int_clear (BEGIN) -----
B3:00E517 75ED20            MOV      UARTSTAT,#020H
B3:00E51A 22                RET      
----- FUNCTION ZW_UART1_tx_int_clear (END) -------


----- FUNCTION ZW_UART1_rx_data_wait_get (BEGIN) -----
B3:00E51B         ?C0010?ZW_PHY_UART1_050X:
B3:00E51B E5ED              MOV      A,UARTSTAT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1090


B3:00E51D 30E6FB            JNB      ACC.6,?C0010?ZW_PHY_UART1_050X
B3:00E520         ?C0011?ZW_PHY_UART1_050X:
B3:00E520 75ED40            MOV      UARTSTAT,#040H
;---- Variable 'tmp' assigned to Register 'R7' ----
B3:00E523 AFEE              MOV      R7,UART1BUF
B3:00E525 22                RET      
----- FUNCTION ZW_UART1_rx_data_wait_get (END) -------


----- FUNCTION ZW_UART1_rx_data_get (BEGIN) -----
;---- Variable 'tmp' assigned to Register 'R7' ----
B3:00E526 AFEE              MOV      R7,UART1BUF
B3:00E528 22                RET      
----- FUNCTION ZW_UART1_rx_data_get (END) -------


----- FUNCTION _ZW_UART1_tx_data_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
B3:00E529 8FEE              MOV      UART1BUF,R7
B3:00E52B 22                RET      
----- FUNCTION _ZW_UART1_tx_data_set (END) -------


----- FUNCTION _ZW_UART1_rx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E52C EF                MOV      A,R7
B3:00E52D 6004              JZ       ?C0018?ZW_PHY_UART1_050X
B3:00E52F 43EC40            ORL      UARTCON,#040H
B3:00E532 22                RET      
B3:00E533         ?C0018?ZW_PHY_UART1_050X:
B3:00E533 53ECBF            ANL      UARTCON,#0BFH
B3:00E536 22                RET      
----- FUNCTION _ZW_UART1_rx_enable (END) -------


----- FUNCTION _ZW_UART1_tx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E537 EF                MOV      A,R7
B3:00E538 6004              JZ       ?C0021?ZW_PHY_UART1_050X
B3:00E53A 43EC80            ORL      UARTCON,#080H
B3:00E53D 22                RET      
B3:00E53E         ?C0021?ZW_PHY_UART1_050X:
B3:00E53E 53EC7F            ANL      UARTCON,#07FH
B3:00E541 22                RET      
----- FUNCTION _ZW_UART1_tx_enable (END) -------


----- FUNCTION ZW_UART1_tx_int_get (BEGIN) -----
B3:00E542 E5ED              MOV      A,UARTSTAT
B3:00E544 5420              ANL      A,#020H
B3:00E546 FF                MOV      R7,A
B3:00E547 22                RET      
----- FUNCTION ZW_UART1_tx_int_get (END) -------


----- FUNCTION ZW_UART1_rx_int_get (BEGIN) -----
B3:00E548 E5ED              MOV      A,UARTSTAT
B3:00E54A 5440              ANL      A,#040H
B3:00E54C FF                MOV      R7,A
B3:00E54D 22                RET      
----- FUNCTION ZW_UART1_rx_int_get (END) -------


----- FUNCTION ZW_UART1_tx_active_get (BEGIN) -----
B3:00E54E E5ED              MOV      A,UARTSTAT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1091


B3:00E550 5410              ANL      A,#010H
B3:00E552 FF                MOV      R7,A
B3:00E553 22                RET      
----- FUNCTION ZW_UART1_tx_active_get (END) -------


----- FUNCTION _ZW_FLASH_nvr1_get (BEGIN) -----
;---- Variable 'bNvrAddress' assigned to Register 'R7' ----
B3:00E554 75FF03            MOV      SFRPAGE,#03H
B3:00E557 759701            MOV      NVRCON,#01H
B3:00E55A B167              ACALL    ?L?COM05A2
B3:00E55C         ?C0004?ZW_PHY_FLASH_050X:
B3:00E55C E597              MOV      A,NVRCON
B3:00E55E 20E1FB            JB       ACC.1,?C0004?ZW_PHY_FLASH_050X
B3:00E561         ?C0005?ZW_PHY_FLASH_050X:
B3:00E561 75FF03            MOV      SFRPAGE,#03H
B3:00E564 AF99              MOV      R7,NVRDATA
B3:00E566 22                RET      
----- FUNCTION _ZW_FLASH_nvr1_get (END) -------


----- FUNCTION ?L?COM05A2 (BEGIN) -----
B3:00E567 75FF03            MOV      SFRPAGE,#03H
B3:00E56A 8F98              MOV      NVRADDR,R7
B3:00E56C 75FF03            MOV      SFRPAGE,#03H
B3:00E56F 22                RET      
----- FUNCTION ?L?COM05A2 (END) -------


----- FUNCTION _ZW_FLASH_code_prog_unlock (BEGIN) -----
;---- Variable 'pbUnlockString' assigned to Register 'R1/R2/R3' ----
B3:00E570 B1A1              ACALL    ?L?COM0541
B3:00E572 75FF03            MOV      SFRPAGE,#03H
B3:00E575 121FB3            LCALL    ?C?CLDPTR
B3:00E578 F5D3              MOV      FLCON3,A
B3:00E57A 75FF03            MOV      SFRPAGE,#03H
B3:00E57D 129279            LCALL    ?L?COM0066
B3:00E580 F5D3              MOV      FLCON3,A
B3:00E582 75FF03            MOV      SFRPAGE,#03H
B3:00E585 12AB1D            LCALL    ?L?COM0110
B3:00E588 F5D3              MOV      FLCON3,A
B3:00E58A 75FF03            MOV      SFRPAGE,#03H
B3:00E58D 1291A4            LCALL    ?L?COM004C
B3:00E590 F5D3              MOV      FLCON3,A
B3:00E592 75FF03            MOV      SFRPAGE,#03H
B3:00E595 75D401            MOV      FLCON4,#01H
B3:00E598 75FF03            MOV      SFRPAGE,#03H
B3:00E59B E5D5              MOV      A,FLSTAT
B3:00E59D 5402              ANL      A,#02H
B3:00E59F FF                MOV      R7,A
B3:00E5A0 22                RET      
----- FUNCTION _ZW_FLASH_code_prog_unlock (END) -------


----- FUNCTION ?L?COM0541 (BEGIN) -----
B3:00E5A1 75FF03            MOV      SFRPAGE,#03H
B3:00E5A4 75D402            MOV      FLCON4,#02H
B3:00E5A7 22                RET      
----- FUNCTION ?L?COM0541 (END) -------


----- FUNCTION ZW_FLASH_code_prog_lock (BEGIN) -----
B3:00E5A8 B1A1              ACALL    ?L?COM0541
B3:00E5AA 75FF03            MOV      SFRPAGE,#03H
B3:00E5AD E5D5              MOV      A,FLSTAT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1092


B3:00E5AF F4                CPL      A
B3:00E5B0 5402              ANL      A,#02H
B3:00E5B2 FF                MOV      R7,A
B3:00E5B3 22                RET      
----- FUNCTION ZW_FLASH_code_prog_lock (END) -------


----- FUNCTION _ZW_FLASH_code_sector_erase (BEGIN) -----
;---- Variable 'bSector' assigned to Register 'R7' ----
B3:00E5B4 75FF03            MOV      SFRPAGE,#03H
B3:00E5B7 EF                MOV      A,R7
B3:00E5B8 543F              ANL      A,#03FH
B3:00E5BA 4480              ORL      A,#080H
B3:00E5BC F5D1              MOV      FLCON1,A
B3:00E5BE         ?C0009?ZW_PHY_FLASH_050X:
B3:00E5BE E5D5              MOV      A,FLSTAT
B3:00E5C0 20E20A            JB       ACC.2,?C0010?ZW_PHY_FLASH_050X
B3:00E5C3 E5D5              MOV      A,FLSTAT
B3:00E5C5 20E005            JB       ACC.0,?C0010?ZW_PHY_FLASH_050X
B3:00E5C8 E5D5              MOV      A,FLSTAT
B3:00E5CA 30E1F1            JNB      ACC.1,?C0009?ZW_PHY_FLASH_050X
B3:00E5CD         ?C0010?ZW_PHY_FLASH_050X:
B3:00E5CD E5D5              MOV      A,FLSTAT
B3:00E5CF 5403              ANL      A,#03H
B3:00E5D1 FF                MOV      R7,A
;---- Variable 's' assigned to Register 'R7' ----
B3:00E5D2 75FF03            MOV      SFRPAGE,#03H
B3:00E5D5 75D505            MOV      FLSTAT,#05H
B3:00E5D8 80C7              SJMP     ?L?COM0541
----- FUNCTION _ZW_FLASH_code_sector_erase (END) -------


----- FUNCTION _ZW_FLASH_code_page_prog (BEGIN) -----
;---- Variable 'pbRamAddress' assigned to Register 'R1/R2/R3' ----
;---- Variable 'bSector' assigned to Register 'R5' ----
B3:00E5DA 75FF03            MOV      SFRPAGE,#03H
;---- Variable 's' assigned to Register 'R4' ----
B3:00E5DD ACD5              MOV      R4,FLSTAT
B3:00E5DF EC                MOV      A,R4
B3:00E5E0 20E13C            JB       ACC.1,?C0012?ZW_PHY_FLASH_050X
B3:00E5E3 75FF03            MOV      SFRPAGE,#03H
B3:00E5E6 ED                MOV      A,R5
B3:00E5E7 543F              ANL      A,#03FH
B3:00E5E9 F5D1              MOV      FLCON1,A
B3:00E5EB 75FF03            MOV      SFRPAGE,#03H
B3:00E5EE E9                MOV      A,R1
B3:00E5EF F5D3              MOV      FLCON3,A
B3:00E5F1 75FF03            MOV      SFRPAGE,#03H
B3:00E5F4 EA                MOV      A,R2
B3:00E5F5 540F              ANL      A,#0FH
B3:00E5F7 FF                MOV      R7,A
B3:00E5F8 9041A8            MOV      DPTR,#bPage
B3:00E5FB E0                MOVX     A,@DPTR
B3:00E5FC C4                SWAP     A
B3:00E5FD 5470              ANL      A,#070H
B3:00E5FF 4480              ORL      A,#080H
B3:00E601 4F                ORL      A,R7
B3:00E602 F5D2              MOV      FLCON2,A
B3:00E604         ?C0013?ZW_PHY_FLASH_050X:
B3:00E604 E5D5              MOV      A,FLSTAT
B3:00E606 20E205            JB       ACC.2,?C0014?ZW_PHY_FLASH_050X
B3:00E609 E5D5              MOV      A,FLSTAT
B3:00E60B 30E0F6            JNB      ACC.0,?C0013?ZW_PHY_FLASH_050X
B3:00E60E         ?C0014?ZW_PHY_FLASH_050X:
B3:00E60E E5D5              MOV      A,FLSTAT
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1093


B3:00E610 5401              ANL      A,#01H
B3:00E612 FC                MOV      R4,A
B3:00E613 75FF03            MOV      SFRPAGE,#03H
B3:00E616 43D402            ORL      FLCON4,#02H
B3:00E619 75FF03            MOV      SFRPAGE,#03H
B3:00E61C 75D505            MOV      FLSTAT,#05H
B3:00E61F         ?C0012?ZW_PHY_FLASH_050X:
B3:00E61F AF04              MOV      R7,AR4
B3:00E621 22                RET      
----- FUNCTION _ZW_FLASH_code_page_prog (END) -------


----- FUNCTION ZW_FLASH_auto_prog_set (BEGIN) -----
B3:00E622 C2AF              CLR      EA
B3:00E624 75FF03            MOV      SFRPAGE,#03H
B3:00E627 75D404            MOV      FLCON4,#04H
B3:00E62A 123FF9            LCALL    ZW_WatchDogEnable
B3:00E62D 124FBF            LCALL    stop_phy_timer
B3:00E630 7FE8              MOV      R7,#0E8H
B3:00E632 7E03              MOV      R6,#03H
B3:00E634 124F00            LCALL    _set_phy_timer_timeout
B3:00E637 D182              ACALL    ?L?COM0608
B3:00E639         ?C0016?ZW_PHY_FLASH_050X:
B3:00E639 124EF9            LCALL    start_phy_timer
B3:00E63C 124F24            LCALL    wait_phy_timer_timeout
B3:00E63F 904360            MOV      DPTR,#delay_loop
B3:00E642 123F7F            LCALL    ?L?COM0081
B3:00E645 C3                CLR      C
B3:00E646 904361            MOV      DPTR,#delay_loop+01H
B3:00E649 E0                MOVX     A,@DPTR
B3:00E64A 94D7              SUBB     A,#0D7H
B3:00E64C 904360            MOV      DPTR,#delay_loop
B3:00E64F E0                MOVX     A,@DPTR
B3:00E650 9403              SUBB     A,#03H
B3:00E652 40E5              JC       ?C0016?ZW_PHY_FLASH_050X
B3:00E654         ?C0017?ZW_PHY_FLASH_050X:
B3:00E654 75FF01            MOV      SFRPAGE,#01H
B3:00E657 75D301            MOV      RES1,#01H
B3:00E65A 75FF02            MOV      SFRPAGE,#02H
B3:00E65D 75D280            MOV      USBCON,#080H
B3:00E660 75FF02            MOV      SFRPAGE,#02H
B3:00E663 43E704            ORL      USBCON2,#04H
B3:00E666 D182              ACALL    ?L?COM0608
B3:00E668         ?C0019?ZW_PHY_FLASH_050X:
B3:00E668 904360            MOV      DPTR,#delay_loop
B3:00E66B 123F7F            LCALL    ?L?COM0081
B3:00E66E 904360            MOV      DPTR,#delay_loop
B3:00E671 E0                MOVX     A,@DPTR
B3:00E672 B403F3            CJNE     A,#03H,?C0019?ZW_PHY_FLASH_050X
B3:00E675 A3                INC      DPTR
B3:00E676 E0                MOVX     A,@DPTR
B3:00E677 B4E8EE            CJNE     A,#0E8H,?C0019?ZW_PHY_FLASH_050X
B3:00E67A         ?C0020?ZW_PHY_FLASH_050X:
B3:00E67A 75FF02            MOV      SFRPAGE,#02H
B3:00E67D 53E7FB            ANL      USBCON2,#0FBH
B3:00E680         ?C0022?ZW_PHY_FLASH_050X:
B3:00E680 80FE              SJMP     ?C0022?ZW_PHY_FLASH_050X
----- FUNCTION ZW_FLASH_auto_prog_set (END) -------


----- FUNCTION ?L?COM0608 (BEGIN) -----
B3:00E682 E4                CLR      A
B3:00E683 904360            MOV      DPTR,#delay_loop
B3:00E686 F0                MOVX     @DPTR,A
B3:00E687 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1094


B3:00E688 F0                MOVX     @DPTR,A
B3:00E689 22                RET      
----- FUNCTION ?L?COM0608 (END) -------


----- FUNCTION ZW_FLASH_prog_state (BEGIN) -----
B3:00E68A 75FF03            MOV      SFRPAGE,#03H
B3:00E68D AFD5              MOV      R7,FLSTAT
B3:00E68F 22                RET      
----- FUNCTION ZW_FLASH_prog_state (END) -------


----- FUNCTION _ZW_AES_ecb_set (BEGIN) -----
B3:00E690 904120            MOV      DPTR,#bData
B3:00E693 D1C4              ACALL    ?L?COM0540
B3:00E695         ?C0001?ZW_PHY_AES_050X:
B3:00E695 E58F              MOV      A,AESCON1
B3:00E697 20E0FB            JB       ACC.0,?C0001?ZW_PHY_AES_050X
B3:00E69A         ?C0002?ZW_PHY_AES_050X:
B3:00E69A D1CB              ACALL    ?L?COM0465
B3:00E69C 75FF01            MOV      SFRPAGE,#01H
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E69F E4                CLR      A
B3:00E6A0 FF                MOV      R7,A
B3:00E6A1         ?C0003?ZW_PHY_AES_050X:
B3:00E6A1 904120            MOV      DPTR,#bData
B3:00E6A4 128C47            LCALL    ?L?COM00B5
B3:00E6A7 121FF0            LCALL    ?C?CLDOPTR
B3:00E6AA F593              MOV      AESDATA,A
B3:00E6AC 0F                INC      R7
B3:00E6AD EF                MOV      A,R7
B3:00E6AE B410F0            CJNE     A,#010H,?C0003?ZW_PHY_AES_050X
B3:00E6B1         ?C0004?ZW_PHY_AES_050X:
B3:00E6B1 E4                CLR      A
B3:00E6B2 FF                MOV      R7,A
B3:00E6B3         ?C0006?ZW_PHY_AES_050X:
B3:00E6B3 904123            MOV      DPTR,#bKey
B3:00E6B6 128C47            LCALL    ?L?COM00B5
B3:00E6B9 121FF0            LCALL    ?C?CLDOPTR
B3:00E6BC F594              MOV      AESKEY,A
B3:00E6BE 0F                INC      R7
B3:00E6BF EF                MOV      A,R7
B3:00E6C0 B410F0            CJNE     A,#010H,?C0006?ZW_PHY_AES_050X
B3:00E6C3 22                RET      
----- FUNCTION _ZW_AES_ecb_set (END) -------


----- FUNCTION ?L?COM0540 (BEGIN) -----
B3:00E6C4 1225A9            LCALL    ?C?PSTXDATA
B3:00E6C7 75FF01            MOV      SFRPAGE,#01H
B3:00E6CA 22                RET      
----- FUNCTION ?L?COM0540 (END) -------


----- FUNCTION ?L?COM0465 (BEGIN) -----
B3:00E6CB 75FF01            MOV      SFRPAGE,#01H
B3:00E6CE 538F06            ANL      AESCON1,#06H
B3:00E6D1 75FF01            MOV      SFRPAGE,#01H
B3:00E6D4 538FF0            ANL      AESCON1,#0F0H
B3:00E6D7 22                RET      
----- FUNCTION ?L?COM0465 (END) -------


----- FUNCTION _ZW_AES_ecb_get (BEGIN) -----
B3:00E6D8 9042EB            MOV      DPTR,#bData
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1095


B3:00E6DB D1C4              ACALL    ?L?COM0540
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E6DD E4                CLR      A
B3:00E6DE FF                MOV      R7,A
B3:00E6DF         ?C0010?ZW_PHY_AES_050X:
B3:00E6DF 9042EB            MOV      DPTR,#bData
B3:00E6E2 128C47            LCALL    ?L?COM00B5
B3:00E6E5 E593              MOV      A,AESDATA
B3:00E6E7 122084            LCALL    ?C?CSTOPTR
B3:00E6EA 0F                INC      R7
B3:00E6EB EF                MOV      A,R7
B3:00E6EC B410F0            CJNE     A,#010H,?C0010?ZW_PHY_AES_050X
B3:00E6EF 22                RET      
----- FUNCTION _ZW_AES_ecb_get (END) -------


----- FUNCTION _ZW_AES_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E6F0 EF                MOV      A,R7
B3:00E6F1 B40107            CJNE     A,#01H,?C0014?ZW_PHY_AES_050X
B3:00E6F4 F107              ACALL    ?L?COM0607
B3:00E6F6 4401              ORL      A,#01H
B3:00E6F8 F58F              MOV      AESCON1,A
B3:00E6FA 22                RET      
B3:00E6FB         ?C0014?ZW_PHY_AES_050X:
B3:00E6FB 75FF01            MOV      SFRPAGE,#01H
B3:00E6FE E58F              MOV      A,AESCON1
B3:00E700 54F0              ANL      A,#0F0H
B3:00E702 4406              ORL      A,#06H
B3:00E704 F58F              MOV      AESCON1,A
B3:00E706 22                RET      
----- FUNCTION _ZW_AES_enable (END) -------


----- FUNCTION ?L?COM0607 (BEGIN) -----
B3:00E707 75FF01            MOV      SFRPAGE,#01H
B3:00E70A E58F              MOV      A,AESCON1
B3:00E70C 54F6              ANL      A,#0F6H
B3:00E70E 22                RET      
----- FUNCTION ?L?COM0607 (END) -------


----- FUNCTION ZW_AES_int_clear (BEGIN) -----
B3:00E70F F107              ACALL    ?L?COM0607
B3:00E711 4408              ORL      A,#08H
B3:00E713 F58F              MOV      AESCON1,A
B3:00E715 22                RET      
----- FUNCTION ZW_AES_int_clear (END) -------


----- FUNCTION ZW_AES_int_get (BEGIN) -----
B3:00E716 75FF01            MOV      SFRPAGE,#01H
B3:00E719 E58F              MOV      A,AESCON1
B3:00E71B 5408              ANL      A,#08H
B3:00E71D FF                MOV      R7,A
B3:00E71E 22                RET      
----- FUNCTION ZW_AES_int_get (END) -------


----- FUNCTION _ZW_AES_int_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E71F EF                MOV      A,R7
B3:00E720 B40107            CJNE     A,#01H,?C0019?ZW_PHY_AES_050X
B3:00E723 75FF01            MOV      SFRPAGE,#01H
B3:00E726 43AE20            ORL      INTCON,#020H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1096


B3:00E729 22                RET      
B3:00E72A         ?C0019?ZW_PHY_AES_050X:
B3:00E72A 75FF01            MOV      SFRPAGE,#01H
B3:00E72D 53AEDF            ANL      INTCON,#0DFH
B3:00E730 22                RET      
----- FUNCTION _ZW_AES_int_enable (END) -------


----- FUNCTION ZW_AES_active_get (BEGIN) -----
B3:00E731 75FF01            MOV      SFRPAGE,#01H
B3:00E734 E58F              MOV      A,AESCON1
B3:00E736 5401              ANL      A,#01H
B3:00E738 FF                MOV      R7,A
B3:00E739 22                RET      
----- FUNCTION ZW_AES_active_get (END) -------


----- FUNCTION _ZW_AES_swap_data (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E73A EF                MOV      A,R7
B3:00E73B B40107            CJNE     A,#01H,?C0023?ZW_PHY_AES_050X
B3:00E73E 75FF01            MOV      SFRPAGE,#01H
B3:00E741 439120            ORL      AESCON2,#020H
B3:00E744 22                RET      
B3:00E745         ?C0023?ZW_PHY_AES_050X:
B3:00E745 75FF01            MOV      SFRPAGE,#01H
B3:00E748 5391DF            ANL      AESCON2,#0DFH
B3:00E74B 22                RET      
----- FUNCTION _ZW_AES_swap_data (END) -------


----- FUNCTION __S2_send_nonce_get (BEGIN) -----
B3:00E74C 12A59A            LCALL    ?L?COM0335
;---- Variable 'span' assigned to Register 'DPTR' ----
B3:00E74F EF                MOV      A,R7
B3:00E750 2424              ADD      A,#024H
B3:00E752 12B617            LCALL    ?L?COM0096
B3:00E755 E0                MOVX     A,@DPTR
B3:00E756 902002            MOV      DPTR,#nonce_get+02H
B3:00E759 F0                MOVX     @DPTR,A
B3:00E75A 7B01              MOV      R3,#01H
B3:00E75C 7A20              MOV      R2,#HIGH nonce_get
B3:00E75E 7900              MOV      R1,#LOW nonce_get
B3:00E760 7D03              MOV      R5,#03H
B3:00E762 7C00              MOV      R4,#00H
B3:00E764 02C37E            LJMP     ___S2_send_raw
----- FUNCTION __S2_send_nonce_get (END) -------


----- FUNCTION ___S2_is_node_mos (BEGIN) -----
;---- Variable 'nodeid' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
B3:00E767 E4                CLR      A
B3:00E768 FE                MOV      R6,A
B3:00E769         ?C0035?S2:
B3:00E769 EE                MOV      A,R6
B3:00E76A 12C6EC            LCALL    ?L?COM0108
B3:00E76D B50703            CJNE     A,AR7,?C0037?S2
B3:00E770 7F01              MOV      R7,#01H
B3:00E772 22                RET      
B3:00E773         ?C0037?S2:
B3:00E773 0E                INC      R6
B3:00E774 EE                MOV      A,R6
B3:00E775 B403F1            CJNE     A,#03H,?C0035?S2
B3:00E778         ?C0036?S2:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1097


B3:00E778 7F00              MOV      R7,#00H
B3:00E77A 22                RET      
----- FUNCTION ___S2_is_node_mos (END) -------


----- FUNCTION _next_mpan_state (BEGIN) -----
;---- Variable 'mpan' assigned to Register 'R2/R3' ----
B3:00E77B AB07              MOV      R3,AR7
B3:00E77D AA06              MOV      R2,AR6
B3:00E77F EB                MOV      A,R3
B3:00E780 2402              ADD      A,#02H
B3:00E782 FD                MOV      R5,A
B3:00E783 E4                CLR      A
B3:00E784 3A                ADDC     A,R2
B3:00E785 FC                MOV      R4,A
B3:00E786 AF05              MOV      R7,AR5
B3:00E788 FE                MOV      R6,A
B3:00E789 7A20              MOV      R2,#HIGH one
B3:00E78B 7B03              MOV      R3,#LOW one
B3:00E78D 903EAE            MOV      DPTR,#?_bigint_add?BYTE+06H
B3:00E790 7410              MOV      A,#010H
B3:00E792 F0                MOVX     @DPTR,A
B3:00E793 021B4C            LJMP     ?INTERBANK_TABLE?_bigint_add
----- FUNCTION _next_mpan_state (END) -------


----- FUNCTION __S2_is_busy (BEGIN) -----
B3:00E796 902222            MOV      DPTR,#the_context+020FH
B3:00E799 E0                MOVX     A,@DPTR
B3:00E79A 7006              JNZ      ?C0064?S2
B3:00E79C 902220            MOV      DPTR,#the_context+020DH
B3:00E79F E0                MOVX     A,@DPTR
B3:00E7A0 6004              JZ       ?C0062?S2
B3:00E7A2         ?C0064?S2:
B3:00E7A2 7F01              MOV      R7,#01H
B3:00E7A4 8002              SJMP     ?C0063?S2
B3:00E7A6         ?C0062?S2:
B3:00E7A6 7F00              MOV      R7,#00H
B3:00E7A8         ?C0063?S2:
B3:00E7A8 22                RET      
----- FUNCTION __S2_is_busy (END) -------


----- FUNCTION ___S2_is_mos (BEGIN) -----
;---- Variable 'clear' assigned to Register 'R5' ----
;---- Variable 'node_id' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
B3:00E7A9 E4                CLR      A
B3:00E7AA FE                MOV      R6,A
B3:00E7AB         ?C0069?S2:
B3:00E7AB 7B01              MOV      R3,#01H
B3:00E7AD 7A21              MOV      R2,#HIGH the_context+01A3H
B3:00E7AF 79B6              MOV      R1,#LOW the_context+01A3H
B3:00E7B1 75F014            MOV      B,#014H
B3:00E7B4 EE                MOV      A,R6
B3:00E7B5 12C6F5            LCALL    ?L?COM010A
B3:00E7B8 6F                XRL      A,R7
B3:00E7B9 701F              JNZ      ?C0071?S2
B3:00E7BB 7A21              MOV      R2,#HIGH the_context+01B6H
B3:00E7BD 79C9              MOV      R1,#LOW the_context+01B6H
B3:00E7BF 75F014            MOV      B,#014H
B3:00E7C2 EE                MOV      A,R6
B3:00E7C3 12C6F5            LCALL    ?L?COM010A
B3:00E7C6 B40211            CJNE     A,#02H,?C0071?S2
B3:00E7C9 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1098


B3:00E7CA 600B              JZ       ?C0073?S2
B3:00E7CC 75F014            MOV      B,#014H
B3:00E7CF EE                MOV      A,R6
B3:00E7D0 127103            LCALL    ?L?COM0273
B3:00E7D3 E4                CLR      A
B3:00E7D4 122084            LCALL    ?C?CSTOPTR
B3:00E7D7         ?C0073?S2:
B3:00E7D7 7F01              MOV      R7,#01H
B3:00E7D9 22                RET      
B3:00E7DA         ?C0071?S2:
B3:00E7DA 0E                INC      R6
B3:00E7DB EE                MOV      A,R6
B3:00E7DC B405CC            CJNE     A,#05H,?C0069?S2
B3:00E7DF         ?C0070?S2:
B3:00E7DF 7F00              MOV      R7,#00H
B3:00E7E1 22                RET      
----- FUNCTION ___S2_is_mos (END) -------


----- FUNCTION _S2_set_node_mos (BEGIN) -----
B3:00E7E2 9042F1            MOV      DPTR,#p_context
B3:00E7E5 1225A9            LCALL    ?C?PSTXDATA
;---- Variable 'node' assigned to Register 'R5' ----
B3:00E7E8 902220            MOV      DPTR,#the_context+020DH
B3:00E7EB E0                MOVX     A,@DPTR
B3:00E7EC FF                MOV      R7,A
B3:00E7ED 6404              XRL      A,#04H
B3:00E7EF 6005              JZ       ?C0080?S2
B3:00E7F1 EF                MOV      A,R7
B3:00E7F2 6402              XRL      A,#02H
B3:00E7F4 704E              JNZ      ?C0085?S2
B3:00E7F6         ?C0080?S2:
B3:00E7F6 9020E4            MOV      DPTR,#the_context+0D1H
B3:00E7F9 E0                MOVX     A,@DPTR
B3:00E7FA 5406              ANL      A,#06H
B3:00E7FC 6046              JZ       ?C0085?S2
B3:00E7FE 12C3CB            LCALL    ?L?COM021A
B3:00E801 4E                ORL      A,R6
B3:00E802 6040              JZ       ?C0085?S2
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E804 E4                CLR      A
B3:00E805 FF                MOV      R7,A
B3:00E806         ?C0081?S2:
B3:00E806 7B01              MOV      R3,#01H
B3:00E808 7A22              MOV      R2,#HIGH the_context+0207H
B3:00E80A 791A              MOV      R1,#LOW the_context+0207H
B3:00E80C 75F002            MOV      B,#02H
B3:00E80F EF                MOV      A,R7
B3:00E810 12C6F5            LCALL    ?L?COM010A
B3:00E813 702A              JNZ      ?C0083?S2
B3:00E815 9020F1            MOV      DPTR,#the_context+0DEH
B3:00E818 E0                MOVX     A,@DPTR
B3:00E819 FA                MOV      R2,A
B3:00E81A A3                INC      DPTR
B3:00E81B E0                MOVX     A,@DPTR
B3:00E81C F582              MOV      DPL,A
B3:00E81E 8A83              MOV      DPH,R2
B3:00E820 A3                INC      DPTR
B3:00E821 E0                MOVX     A,@DPTR
B3:00E822 FE                MOV      R6,A
B3:00E823 7A22              MOV      R2,#HIGH the_context+0208H
B3:00E825 09                INC      R1
B3:00E826 75F002            MOV      B,#02H
B3:00E829 EF                MOV      A,R7
B3:00E82A 127103            LCALL    ?L?COM0273
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1099


B3:00E82D EE                MOV      A,R6
B3:00E82E 122084            LCALL    ?C?CSTOPTR
B3:00E831 7A22              MOV      R2,#HIGH the_context+0207H
B3:00E833 19                DEC      R1
B3:00E834 75F002            MOV      B,#02H
B3:00E837 EF                MOV      A,R7
B3:00E838 127103            LCALL    ?L?COM0273
B3:00E83B ED                MOV      A,R5
B3:00E83C 022084            LJMP     ?C?CSTOPTR
B3:00E83F         ?C0083?S2:
B3:00E83F 0F                INC      R7
B3:00E840 EF                MOV      A,R7
B3:00E841 B403C2            CJNE     A,#03H,?C0081?S2
B3:00E844         ?C0085?S2:
B3:00E844 22                RET      
----- FUNCTION _S2_set_node_mos (END) -------


----- FUNCTION __S2_is_send_data_busy (BEGIN) -----
B3:00E845 902220            MOV      DPTR,#the_context+020DH
B3:00E848 E0                MOVX     A,@DPTR
B3:00E849 6008              JZ       ?C0165?S2
B3:00E84B 6405              XRL      A,#05H
B3:00E84D 6004              JZ       ?C0165?S2
B3:00E84F 7F01              MOV      R7,#01H
B3:00E851 8002              SJMP     ?C0166?S2
B3:00E853         ?C0165?S2:
B3:00E853 7F00              MOV      R7,#00H
B3:00E855         ?C0166?S2:
B3:00E855 22                RET      
----- FUNCTION __S2_is_send_data_busy (END) -------


----- FUNCTION __S2_destroy (BEGIN) -----
B3:00E856 7E03              MOV      R6,#03H
B3:00E858 7F38              MOV      R7,#038H
B3:00E85A 7D00              MOV      R5,#00H
B3:00E85C 12A7BA            LCALL    ?L?COM0333
B3:00E85F 022917            LJMP     ?C?MEMSET
----- FUNCTION __S2_destroy (END) -------


----- FUNCTION ___S2_send_data_multicast (BEGIN) -----
B3:00E862 903BD2            MOV      DPTR,#con
B3:00E865 1225A9            LCALL    ?C?PSTXDATA
B3:00E868 11A5              ACALL    __S2_is_send_data_multicast_busy
B3:00E86A EF                MOV      A,R7
B3:00E86B 6003              JZ       ?C0258?S2
B3:00E86D 7F00              MOV      R7,#00H
B3:00E86F 22                RET      
B3:00E870         ?C0258?S2:
B3:00E870 903BD5            MOV      DPTR,#buf
B3:00E873 122589            LCALL    ?C?PLDXDATA
B3:00E876 903BDD            MOV      DPTR,#e+03H
B3:00E879 1225A9            LCALL    ?C?PSTXDATA
B3:00E87C 903BD8            MOV      DPTR,#len
B3:00E87F E0                MOVX     A,@DPTR
B3:00E880 FF                MOV      R7,A
B3:00E881 A3                INC      DPTR
B3:00E882 E0                MOVX     A,@DPTR
B3:00E883 903BE0            MOV      DPTR,#e+06H
B3:00E886 CF                XCH      A,R7
B3:00E887 F0                MOVX     @DPTR,A
B3:00E888 A3                INC      DPTR
B3:00E889 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1100


B3:00E88A F0                MOVX     @DPTR,A
B3:00E88B 903BD2            MOV      DPTR,#con
B3:00E88E 122589            LCALL    ?C?PLDXDATA
B3:00E891 903BDA            MOV      DPTR,#e
B3:00E894 1225A9            LCALL    ?C?PSTXDATA
B3:00E897 7B01              MOV      R3,#01H
B3:00E899 7A3B              MOV      R2,#HIGH e
B3:00E89B 79DA              MOV      R1,#LOW e
B3:00E89D 7F01              MOV      R7,#01H
B3:00E89F 128E6A            LCALL    ___S2_fsm_post_event
B3:00E8A2 7F01              MOV      R7,#01H
B3:00E8A4 22                RET      
----- FUNCTION ___S2_send_data_multicast (END) -------


----- FUNCTION __S2_is_send_data_multicast_busy (BEGIN) -----
B3:00E8A5 902220            MOV      DPTR,#the_context+020DH
B3:00E8A8 E0                MOVX     A,@DPTR
B3:00E8A9 7F00              MOV      R7,#00H
B3:00E8AB 6002              JZ       ?C0260?S2
B3:00E8AD 7F01              MOV      R7,#01H
B3:00E8AF         ?C0260?S2:
B3:00E8AF 22                RET      
----- FUNCTION __S2_is_send_data_multicast_busy (END) -------


----- FUNCTION _s2_default_evt_handler (BEGIN) -----
B3:00E8B0 22                RET      
----- FUNCTION _s2_default_evt_handler (END) -------


----- FUNCTION _s2_inclusion_set_event_handler (BEGIN) -----
;---- Variable 'evt_handler' assigned to Register 'R6/R7' ----
B3:00E8B1 9027FB            MOV      DPTR,#m_evt_handler
B3:00E8B4 EE                MOV      A,R6
B3:00E8B5 F0                MOVX     @DPTR,A
B3:00E8B6 A3                INC      DPTR
B3:00E8B7 EF                MOV      A,R7
B3:00E8B8 F0                MOVX     @DPTR,A
B3:00E8B9 22                RET      
----- FUNCTION _s2_inclusion_set_event_handler (END) -------


----- FUNCTION s2_inclusion_post_event (BEGIN) -----
B3:00E8BA 129273            LCALL    ?L?COM0064
B3:00E8BD 904248            MOV      DPTR,#event
B3:00E8C0 1272AB            LCALL    ?L?COM0447
B3:00E8C3 24FC              ADD      A,#0FCH
B3:00E8C5 FF                MOV      R7,A
B3:00E8C6 A3                INC      DPTR
B3:00E8C7 F0                MOVX     @DPTR,A
B3:00E8C8 7409              MOV      A,#09H
B3:00E8CA C3                CLR      C
B3:00E8CB 9F                SUBB     A,R7
B3:00E8CC 5002              JNC      $ + 4H
B3:00E8CE 21C4              AJMP     ?C0054?S2_INCLUSION
B3:00E8D0 902222            MOV      DPTR,#the_context+020FH
B3:00E8D3 E0                MOVX     A,@DPTR
B3:00E8D4 7002              JNZ      $ + 4H
B3:00E8D6 21C4              AJMP     ?C0054?S2_INCLUSION
B3:00E8D8         ?C0052?S2_INCLUSION:
B3:00E8D8 31C5              ACALL    ?L?COM042F
B3:00E8DA 241E              ADD      A,#LOW m_frame_rules
B3:00E8DC F582              MOV      DPL,A
B3:00E8DE E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1101


B3:00E8DF 3428              ADDC     A,#HIGH m_frame_rules
B3:00E8E1 F583              MOV      DPH,A
B3:00E8E3 E0                MOVX     A,@DPTR
B3:00E8E4 FF                MOV      R7,A
B3:00E8E5 C3                CLR      C
B3:00E8E6 9020EE            MOV      DPTR,#the_context+0DBH
B3:00E8E9 E0                MOVX     A,@DPTR
B3:00E8EA 9F                SUBB     A,R7
B3:00E8EB 9020ED            MOV      DPTR,#the_context+0DAH
B3:00E8EE E0                MOVX     A,@DPTR
B3:00E8EF 9400              SUBB     A,#00H
B3:00E8F1 5004              JNC      ?C0055?S2_INCLUSION
B3:00E8F3 7F0A              MOV      R7,#0AH
B3:00E8F5 805E              SJMP     ?C0135?S2_INCLUSION
B3:00E8F7         ?C0055?S2_INCLUSION:
B3:00E8F7 90424A            MOV      DPTR,#event_rule_index
B3:00E8FA E0                MOVX     A,@DPTR
B3:00E8FB FF                MOV      R7,A
B3:00E8FC 25E0              ADD      A,ACC
B3:00E8FE 25E0              ADD      A,ACC
B3:00E900 241F              ADD      A,#LOW m_frame_rules+01H
B3:00E902 F582              MOV      DPL,A
B3:00E904 E4                CLR      A
B3:00E905 3428              ADDC     A,#HIGH m_frame_rules+01H
B3:00E907 F583              MOV      DPH,A
B3:00E909 E0                MOVX     A,@DPTR
B3:00E90A FE                MOV      R6,A
B3:00E90B B40212            CJNE     A,#02H,?C0056?S2_INCLUSION
B3:00E90E 9020EA            MOV      DPTR,#the_context+0D7H
B3:00E911 12AB1A            LCALL    ?L?COM010F
B3:00E914 30E009            JNB      ACC.0,?C0056?S2_INCLUSION
B3:00E917 EF                MOV      A,R7
B3:00E918 25E0              ADD      A,ACC
B3:00E91A 25E0              ADD      A,ACC
B3:00E91C 31F7              ACALL    ?L?COM05CD
B3:00E91E 8009              SJMP     ?C0136?S2_INCLUSION
B3:00E920         ?C0056?S2_INCLUSION:
B3:00E920 31C5              ACALL    ?L?COM042F
B3:00E922 2420              ADD      A,#LOW m_frame_rules+02H
B3:00E924 F582              MOV      DPL,A
B3:00E926 E4                CLR      A
B3:00E927 3428              ADDC     A,#HIGH m_frame_rules+02H
B3:00E929         
B3:00E929 F583              MOV      DPH,A
B3:00E92B E0                MOVX     A,@DPTR
B3:00E92C 904247            MOV      DPTR,#crypt_rule
B3:00E92F F0                MOVX     @DPTR,A
B3:00E930         ?C0057?S2_INCLUSION:
B3:00E930 9020E9            MOV      DPTR,#the_context+0D6H
B3:00E933 E0                MOVX     A,@DPTR
B3:00E934 FF                MOV      R7,A
B3:00E935 904247            MOV      DPTR,#crypt_rule
B3:00E938 E0                MOVX     A,@DPTR
B3:00E939 6F                XRL      A,R7
B3:00E93A 601D              JZ       ?C0058?S2_INCLUSION
B3:00E93C EE                MOV      A,R6
B3:00E93D B4010C            CJNE     A,#01H,?C0060?S2_INCLUSION
B3:00E940 31C5              ACALL    ?L?COM042F
B3:00E942 31F7              ACALL    ?L?COM05CD
B3:00E944 F583              MOV      DPH,A
B3:00E946 E0                MOVX     A,@DPTR
B3:00E947 FE                MOV      R6,A
B3:00E948 EF                MOV      A,R7
B3:00E949 6E                XRL      A,R6
B3:00E94A 600D              JZ       ?C0058?S2_INCLUSION
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1102


B3:00E94C         ?C0060?S2_INCLUSION:
B3:00E94C 7DFF              MOV      R5,#0FFH
B3:00E94E 7F07              MOV      R7,#07H
B3:00E950 12AA23            LCALL    _inclusion_failed_frame_send
B3:00E953 7F0B              MOV      R7,#0BH
B3:00E955         
B3:00E955 7E02              MOV      R6,#02H
B3:00E957 8068              SJMP     ?C0137?S2_INCLUSION
B3:00E959         ?C0058?S2_INCLUSION:
B3:00E959 904248            MOV      DPTR,#event
B3:00E95C 31FF              ACALL    ?L?COM0506
B3:00E95E 7059              JNZ      ?C0061?S2_INCLUSION
B3:00E960 EF                MOV      A,R7
B3:00E961 24FA              ADD      A,#0FAH
B3:00E963 600F              JZ       ?C0063?S2_INCLUSION
B3:00E965 24FE              ADD      A,#0FEH
B3:00E967 600B              JZ       ?C0063?S2_INCLUSION
B3:00E969 24FD              ADD      A,#0FDH
B3:00E96B 601B              JZ       ?C0065?S2_INCLUSION
B3:00E96D 14                DEC      A
B3:00E96E 6029              JZ       ?C0068?S2_INCLUSION
B3:00E970 2407              ADD      A,#07H
B3:00E972 7045              JNZ      ?C0061?S2_INCLUSION
B3:00E974         ?C0063?S2_INCLUSION:
B3:00E974         
B3:00E974 9020EA            MOV      DPTR,#the_context+0D7H
B3:00E977 12AB1A            LCALL    ?L?COM010F
B3:00E97A 5401              ANL      A,#01H
B3:00E97C FE                MOV      R6,A
B3:00E97D 904248            MOV      DPTR,#event
B3:00E980 E0                MOVX     A,@DPTR
B3:00E981 4E                ORL      A,R6
B3:00E982 F0                MOVX     @DPTR,A
B3:00E983 A3                INC      DPTR
B3:00E984 E0                MOVX     A,@DPTR
B3:00E985 F0                MOVX     @DPTR,A
B3:00E986 8031              SJMP     ?C0061?S2_INCLUSION
B3:00E988         ?C0065?S2_INCLUSION:
B3:00E988 5106              ACALL    ?L?COM05FF
B3:00E98A B50706            CJNE     A,AR7,?C0066?S2_INCLUSION
B3:00E98D 7E02              MOV      R6,#02H
B3:00E98F 7F07              MOV      R7,#07H
B3:00E991 801E              SJMP     ?C0139?S2_INCLUSION
B3:00E993         ?C0066?S2_INCLUSION:
B3:00E993 7E00              MOV      R6,#00H
B3:00E995 7F0B              MOV      R7,#0BH
B3:00E997         ?C0067?S2_INCLUSION:
B3:00E997 8018              SJMP     ?C0139?S2_INCLUSION
B3:00E999         ?C0068?S2_INCLUSION:
B3:00E999 9020D8            MOV      DPTR,#the_context+0C5H
B3:00E99C E0                MOVX     A,@DPTR
B3:00E99D F4                CPL      A
B3:00E99E 04                INC      A
B3:00E99F FF                MOV      R7,A
B3:00E9A0 9020D7            MOV      DPTR,#the_context+0C4H
B3:00E9A3 E0                MOVX     A,@DPTR
B3:00E9A4 5F                ANL      A,R7
B3:00E9A5 6006              JZ       ?C0069?S2_INCLUSION
B3:00E9A7 7E00              MOV      R6,#00H
B3:00E9A9 7F0C              MOV      R7,#0CH
B3:00E9AB 8004              SJMP     ?C0070?S2_INCLUSION
B3:00E9AD         ?C0069?S2_INCLUSION:
B3:00E9AD 7E02              MOV      R6,#02H
B3:00E9AF 7F05              MOV      R7,#05H
B3:00E9B1         ?C0070?S2_INCLUSION:
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1103


B3:00E9B1         
B3:00E9B1 904248            MOV      DPTR,#event
B3:00E9B4 EE                MOV      A,R6
B3:00E9B5 F0                MOVX     @DPTR,A
B3:00E9B6 A3                INC      DPTR
B3:00E9B7 EF                MOV      A,R7
B3:00E9B8 F0                MOVX     @DPTR,A
B3:00E9B9         ?C0061?S2_INCLUSION:
B3:00E9B9 904248            MOV      DPTR,#event
B3:00E9BC E0                MOVX     A,@DPTR
B3:00E9BD FE                MOV      R6,A
B3:00E9BE A3                INC      DPTR
B3:00E9BF E0                MOVX     A,@DPTR
B3:00E9C0 FF                MOV      R7,A
B3:00E9C1         
B3:00E9C1 12A879            LCALL    _process_event
B3:00E9C4         ?C0054?S2_INCLUSION:
B3:00E9C4 22                RET      
----- FUNCTION s2_inclusion_post_event (END) -------


----- FUNCTION ?L?COM042F (BEGIN) -----
B3:00E9C5 90424A            MOV      DPTR,#event_rule_index
B3:00E9C8 E0                MOVX     A,@DPTR
B3:00E9C9 25E0              ADD      A,ACC
B3:00E9CB 25E0              ADD      A,ACC
B3:00E9CD 22                RET      
----- FUNCTION ?L?COM042F (END) -------


----- FUNCTION _ZCB_s2_inclusion_notify_timeout (BEGIN) -----
B3:00E9CE 9042F7            MOV      DPTR,#p_context
B3:00E9D1 1225A9            LCALL    ?C?PSTXDATA
B3:00E9D4 902222            MOV      DPTR,#the_context+020FH
B3:00E9D7 E0                MOVX     A,@DPTR
B3:00E9D8 B40A15            CJNE     A,#0AH,?C0072?S2_INCLUSION
B3:00E9DB 902842            MOV      DPTR,#m_retry_counter
B3:00E9DE E0                MOVX     A,@DPTR
B3:00E9DF 6003              JZ       ?C0075?S2_INCLUSION
B3:00E9E1 B4FF06            CJNE     A,#0FFH,?C0073?S2_INCLUSION
B3:00E9E4         ?C0075?S2_INCLUSION:
B3:00E9E4 7E02              MOV      R6,#02H
B3:00E9E6 7F09              MOV      R7,#09H
B3:00E9E8 800A              SJMP     ?C0140?S2_INCLUSION
B3:00E9EA         ?C0073?S2_INCLUSION:
B3:00E9EA 7E02              MOV      R6,#02H
B3:00E9EC 7F08              MOV      R7,#08H
B3:00E9EE         ?C0074?S2_INCLUSION:
B3:00E9EE 8004              SJMP     ?C0140?S2_INCLUSION
B3:00E9F0         ?C0072?S2_INCLUSION:
B3:00E9F0 7F09              MOV      R7,#09H
B3:00E9F2 7E02              MOV      R6,#02H
B3:00E9F4         
B3:00E9F4 02A879            LJMP     _process_event
----- FUNCTION _ZCB_s2_inclusion_notify_timeout (END) -------


----- FUNCTION ?L?COM05CD (BEGIN) -----
B3:00E9F7 2421              ADD      A,#LOW m_frame_rules+03H
B3:00E9F9 F582              MOV      DPL,A
B3:00E9FB E4                CLR      A
B3:00E9FC 3428              ADDC     A,#HIGH m_frame_rules+03H
B3:00E9FE 22                RET      
----- FUNCTION ?L?COM05CD (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1104



----- FUNCTION ?L?COM0506 (BEGIN) -----
B3:00E9FF E0                MOVX     A,@DPTR
B3:00EA00 FE                MOV      R6,A
B3:00EA01 A3                INC      DPTR
B3:00EA02 E0                MOVX     A,@DPTR
B3:00EA03 FF                MOV      R7,A
B3:00EA04 EE                MOV      A,R6
B3:00EA05 22                RET      
----- FUNCTION ?L?COM0506 (END) -------


----- FUNCTION ?L?COM05FF (BEGIN) -----
B3:00EA06 9020D7            MOV      DPTR,#the_context+0C4H
B3:00EA09 E0                MOVX     A,@DPTR
B3:00EA0A FF                MOV      R7,A
B3:00EA0B A3                INC      DPTR
B3:00EA0C E0                MOVX     A,@DPTR
B3:00EA0D 22                RET      
----- FUNCTION ?L?COM05FF (END) -------


----- FUNCTION _s2_inclusion_decryption_failure (BEGIN) -----
B3:00EA0E 9042FA            MOV      DPTR,#p_context
B3:00EA11 1225A9            LCALL    ?C?PSTXDATA
B3:00EA14 7F04              MOV      R7,#04H
B3:00EA16 7E02              MOV      R6,#02H
B3:00EA18 02A879            LJMP     _process_event
----- FUNCTION _s2_inclusion_decryption_failure (END) -------


----- FUNCTION _ZCB_reset_transport_service (BEGIN) -----
B3:00EA1B 7B01              MOV      R3,#01H
B3:00EA1D 7A29              MOV      R2,#HIGH scb+02EH
B3:00EA1F 79E3              MOV      R1,#LOW scb+02EH
B3:00EA21 121B15            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00EA24 E4                CLR      A
B3:00EA25 900B0F            MOV      DPTR,#current_state
B3:00EA28 F0                MOVX     @DPTR,A
B3:00EA29 029C7B            LJMP     discard_all_received_fragments
----- FUNCTION _ZCB_reset_transport_service (END) -------


----- FUNCTION recv_or_send (BEGIN) -----
B3:00EA2C 900B0F            MOV      DPTR,#current_state
B3:00EA2F E0                MOVX     A,@DPTR
B3:00EA30 14                DEC      A
B3:00EA31 24FB              ADD      A,#0FBH
B3:00EA33 500B              JNC      ?C0009?TRANSPORT_SERVICE2
B3:00EA35 24FD              ADD      A,#0FDH
B3:00EA37 500A              JNC      ?C0012?TRANSPORT_SERVICE2
B3:00EA39 2409              ADD      A,#09H
B3:00EA3B 7009              JNZ      ?C0002?TRANSPORT_SERVICE2
B3:00EA3D         ?C0003?TRANSPORT_SERVICE2:
B3:00EA3D 7F02              MOV      R7,#02H
B3:00EA3F 22                RET      
B3:00EA40         ?C0009?TRANSPORT_SERVICE2:
B3:00EA40 7F01              MOV      R7,#01H
B3:00EA42 22                RET      
B3:00EA43         ?C0012?TRANSPORT_SERVICE2:
B3:00EA43 7F00              MOV      R7,#00H
B3:00EA45 22                RET      
B3:00EA46         ?C0002?TRANSPORT_SERVICE2:
B3:00EA46 7FFF              MOV      R7,#0FFH
B3:00EA48 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1105


----- FUNCTION recv_or_send (END) -------


----- FUNCTION ZW_TransportService_Is_Sending (BEGIN) -----
B3:00EA49 512C              ACALL    recv_or_send
B3:00EA4B EF                MOV      A,R7
B3:00EA4C C3                CLR      C
B3:00EA4D 7001              JNZ      ?C0017?TRANSPORT_SERVICE2
B3:00EA4F D3                SETB     C
B3:00EA50         ?C0017?TRANSPORT_SERVICE2:
B3:00EA50 22                RET      
----- FUNCTION ZW_TransportService_Is_Sending (END) -------


----- FUNCTION ZW_TransportService_Is_Receving (BEGIN) -----
B3:00EA51 512C              ACALL    recv_or_send
B3:00EA53 BF0103            CJNE     R7,#01H,?C0014?TRANSPORT_SERVICE2
B3:00EA56 D3                SETB     C
B3:00EA57 8001              SJMP     ?C0015?TRANSPORT_SERVICE2
B3:00EA59         ?C0014?TRANSPORT_SERVICE2:
B3:00EA59 C3                CLR      C
B3:00EA5A         ?C0015?TRANSPORT_SERVICE2:
B3:00EA5A 22                RET      
----- FUNCTION ZW_TransportService_Is_Receving (END) -------


----- FUNCTION _ZCB_wait_restart_from_first (BEGIN) -----
B3:00EA5B 02CEA0            LJMP     send_first_frag
----- FUNCTION _ZCB_wait_restart_from_first (END) -------


----- FUNCTION _ZW_TransportService_Init (BEGIN) -----
;---- Variable 'commandHandler' assigned to Register 'R6/R7' ----
B3:00EA5E 902883            MOV      DPTR,#TSApplicationCommandHandler
B3:00EA61 EE                MOV      A,R6
B3:00EA62 F0                MOVX     @DPTR,A
B3:00EA63 A3                INC      DPTR
B3:00EA64 EF                MOV      A,R7
B3:00EA65 F0                MOVX     @DPTR,A
B3:00EA66 22                RET      
----- FUNCTION _ZW_TransportService_Init (END) -------


----- FUNCTION _mark_frag_received (BEGIN) -----
;---- Variable 'offset' assigned to Register 'R2/R3' ----
B3:00EA67 AB07              MOV      R3,AR7
B3:00EA69 AA06              MOV      R2,AR6
B3:00EA6B E4                CLR      A
B3:00EA6C 90439B            MOV      DPTR,#frag_no
B3:00EA6F F0                MOVX     @DPTR,A
B3:00EA70 9029A6            MOV      DPTR,#rcb+011DH
B3:00EA73 E0                MOVX     A,@DPTR
B3:00EA74 FE                MOV      R6,A
B3:00EA75 7003              JNZ      ?C0109?TRANSPORT_SERVICE2
B3:00EA77 7F01              MOV      R7,#01H
B3:00EA79 22                RET      
B3:00EA7A         ?C0109?TRANSPORT_SERVICE2:
B3:00EA7A EB                MOV      A,R3
B3:00EA7B 4A                ORL      A,R2
B3:00EA7C 6010              JZ       ?C0111?TRANSPORT_SERVICE2
B3:00EA7E EE                MOV      A,R6
B3:00EA7F FD                MOV      R5,A
B3:00EA80 7C00              MOV      R4,#00H
B3:00EA82 AF03              MOV      R7,AR3
B3:00EA84 AE02              MOV      R6,AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1106


B3:00EA86 1220B8            LCALL    ?C?UIDIV
B3:00EA89 90439B            MOV      DPTR,#frag_no
B3:00EA8C EF                MOV      A,R7
B3:00EA8D F0                MOVX     @DPTR,A
B3:00EA8E         ?C0111?TRANSPORT_SERVICE2:
B3:00EA8E EB                MOV      A,R3
B3:00EA8F 4A                ORL      A,R2
B3:00EA90 6019              JZ       ?C0112?TRANSPORT_SERVICE2
B3:00EA92 9029A8            MOV      DPTR,#rcb+011FH
B3:00EA95 E0                MOVX     A,@DPTR
B3:00EA96 7013              JNZ      ?C0112?TRANSPORT_SERVICE2
B3:00EA98 12BE10            LCALL    ?L?COM03A7
B3:00EA9B 6008              JZ       ?C0113?TRANSPORT_SERVICE2
B3:00EA9D 902A22            MOV      DPTR,#scb+06DH
B3:00EAA0 7401              MOV      A,#01H
B3:00EAA2 F0                MOVX     @DPTR,A
B3:00EAA3 8003              SJMP     ?C0114?TRANSPORT_SERVICE2
B3:00EAA5         ?C0113?TRANSPORT_SERVICE2:
B3:00EAA5 12CE3C            LCALL    send_frag_wait_cmd
B3:00EAA8         ?C0114?TRANSPORT_SERVICE2:
B3:00EAA8 7F01              MOV      R7,#01H
B3:00EAAA 22                RET      
B3:00EAAB         ?C0112?TRANSPORT_SERVICE2:
B3:00EAAB 90439B            MOV      DPTR,#frag_no
B3:00EAAE E0                MOVX     A,@DPTR
B3:00EAAF FE                MOV      R6,A
B3:00EAB0 24A8              ADD      A,#LOW rcb+011FH
B3:00EAB2 51F5              ACALL    ?L?COM02CF
B3:00EAB4 E0                MOVX     A,@DPTR
B3:00EAB5 B40103            CJNE     A,#01H,?C0115?TRANSPORT_SERVICE2
B3:00EAB8 7F01              MOV      R7,#01H
B3:00EABA 22                RET      
B3:00EABB         ?C0115?TRANSPORT_SERVICE2:
B3:00EABB 74A8              MOV      A,#LOW rcb+011FH
B3:00EABD 2E                ADD      A,R6
B3:00EABE 51F5              ACALL    ?L?COM02CF
B3:00EAC0 7401              MOV      A,#01H
B3:00EAC2 F0                MOVX     @DPTR,A
B3:00EAC3 7F00              MOV      R7,#00H
B3:00EAC5 22                RET      
----- FUNCTION _mark_frag_received (END) -------


----- FUNCTION get_num_missing_frag (BEGIN) -----
;---- Variable 'missing_frag' assigned to Register 'R3' ----
B3:00EAC6 E4                CLR      A
B3:00EAC7 FB                MOV      R3,A
B3:00EAC8 9029A6            MOV      DPTR,#rcb+011DH
B3:00EACB E0                MOVX     A,@DPTR
B3:00EACC FE                MOV      R6,A
B3:00EACD 7002              JNZ      ?C0117?TRANSPORT_SERVICE2
B3:00EACF FF                MOV      R7,A
B3:00EAD0 22                RET      
B3:00EAD1         ?C0117?TRANSPORT_SERVICE2:
B3:00EAD1 EE                MOV      A,R6
B3:00EAD2 711F              ACALL    ?L?COM02B5
B3:00EAD4 717D              ACALL    ?L?COM00C2
;---- Variable 'max_frag_no' assigned to Register 'R2' ----
B3:00EAD6 AA07              MOV      R2,AR7
B3:00EAD8 711B              ACALL    ?L?COM02B4
B3:00EADA 717D              ACALL    ?L?COM00C2
B3:00EADC ED                MOV      A,R5
B3:00EADD 4C                ORL      A,R4
B3:00EADE 6001              JZ       ?C0120?TRANSPORT_SERVICE2
B3:00EAE0 0A                INC      R2
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1107


B3:00EAE1         ?C0120?TRANSPORT_SERVICE2:
B3:00EAE1 AF02              MOV      R7,AR2
B3:00EAE3 1A                DEC      R2
B3:00EAE4 EF                MOV      A,R7
B3:00EAE5 6008              JZ       ?C0121?TRANSPORT_SERVICE2
B3:00EAE7 51F2              ACALL    ?L?COM02CE
B3:00EAE9 E0                MOVX     A,@DPTR
B3:00EAEA 70F5              JNZ      ?C0120?TRANSPORT_SERVICE2
B3:00EAEC 0B                INC      R3
B3:00EAED 80F2              SJMP     ?C0120?TRANSPORT_SERVICE2
B3:00EAEF         ?C0121?TRANSPORT_SERVICE2:
B3:00EAEF AF03              MOV      R7,AR3
B3:00EAF1 22                RET      
----- FUNCTION get_num_missing_frag (END) -------


----- FUNCTION ?L?COM02CE (BEGIN) -----
B3:00EAF2 74A8              MOV      A,#LOW rcb+011FH
B3:00EAF4 2A                ADD      A,R2
B3:00EAF5         ?L?COM02CF:
B3:00EAF5 F582              MOV      DPL,A
B3:00EAF7 E4                CLR      A
B3:00EAF8 3429              ADDC     A,#HIGH rcb+011FH
B3:00EAFA F583              MOV      DPH,A
B3:00EAFC 22                RET      
----- FUNCTION ?L?COM02CE (END) -------


----- FUNCTION _ZCB_rx_timer_expired (BEGIN) -----
;---- Variable 'puser' assigned to Register 'R1/R2/R3' ----
;---- Variable 'rdata' assigned to Register 'R1/R2/R3' ----
B3:00EAFD 121FB3            LCALL    ?C?CLDPTR
B3:00EB00 90439C            MOV      DPTR,#state
B3:00EB03 91C1              ACALL    ?L?COM04DC
B3:00EB05 7F08              MOV      R7,#08H
B3:00EB07 12BD5A            LCALL    _t2_sm_post_event
B3:00EB0A 90439C            MOV      DPTR,#state
B3:00EB0D E0                MOVX     A,@DPTR
B3:00EB0E 6008              JZ       ?C0123?TRANSPORT_SERVICE2
B3:00EB10 51C6              ACALL    get_num_missing_frag
B3:00EB12 EF                MOV      A,R7
B3:00EB13 6003              JZ       ?C0123?TRANSPORT_SERVICE2
B3:00EB15 029C7B            LJMP     discard_all_received_fragments
B3:00EB18         ?C0123?TRANSPORT_SERVICE2:
B3:00EB18 02BD79            LJMP     find_missing
----- FUNCTION _ZCB_rx_timer_expired (END) -------


----- FUNCTION ?L?COM02B4 (BEGIN) -----
B3:00EB1B 9029A6            MOV      DPTR,#rcb+011DH
B3:00EB1E E0                MOVX     A,@DPTR
B3:00EB1F         ?L?COM02B5:
B3:00EB1F FD                MOV      R5,A
B3:00EB20 7C00              MOV      R4,#00H
B3:00EB22 9029B3            MOV      DPTR,#rcb+012AH
B3:00EB25 22                RET      
----- FUNCTION ?L?COM02B4 (END) -------


----- FUNCTION calculate_pending_segments (BEGIN) -----
B3:00EB26 E4                CLR      A
B3:00EB27 9028A6            MOV      DPTR,#rcb+01DH
B3:00EB2A F0                MOVX     @DPTR,A
B3:00EB2B 9029A6            MOV      DPTR,#rcb+011DH
B3:00EB2E E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1108


B3:00EB2F 6028              JZ       ?C0132?TRANSPORT_SERVICE2
B3:00EB31         ?C0131?TRANSPORT_SERVICE2:
B3:00EB31 9029A6            MOV      DPTR,#rcb+011DH
B3:00EB34 E0                MOVX     A,@DPTR
B3:00EB35 FB                MOV      R3,A
B3:00EB36 711F              ACALL    ?L?COM02B5
B3:00EB38 717D              ACALL    ?L?COM00C2
;---- Variable 'max_frag_no' assigned to Register 'R2' ----
B3:00EB3A AA07              MOV      R2,AR7
B3:00EB3C EB                MOV      A,R3
B3:00EB3D 711F              ACALL    ?L?COM02B5
B3:00EB3F 717D              ACALL    ?L?COM00C2
B3:00EB41 ED                MOV      A,R5
B3:00EB42 4C                ORL      A,R4
B3:00EB43 6001              JZ       ?C0134?TRANSPORT_SERVICE2
B3:00EB45 0A                INC      R2
B3:00EB46         ?C0134?TRANSPORT_SERVICE2:
B3:00EB46 AF02              MOV      R7,AR2
B3:00EB48 1A                DEC      R2
B3:00EB49 EF                MOV      A,R7
B3:00EB4A 600D              JZ       ?C0132?TRANSPORT_SERVICE2
B3:00EB4C 51F2              ACALL    ?L?COM02CE
B3:00EB4E E0                MOVX     A,@DPTR
B3:00EB4F 70F5              JNZ      ?C0134?TRANSPORT_SERVICE2
B3:00EB51 9028A6            MOV      DPTR,#rcb+01DH
B3:00EB54 E0                MOVX     A,@DPTR
B3:00EB55 04                INC      A
B3:00EB56 F0                MOVX     @DPTR,A
B3:00EB57 80ED              SJMP     ?C0134?TRANSPORT_SERVICE2
B3:00EB59         ?C0132?TRANSPORT_SERVICE2:
B3:00EB59 22                RET      
----- FUNCTION calculate_pending_segments (END) -------


----- FUNCTION ?L?COM00C1 (BEGIN) -----
B3:00EB5A 9029B5            MOV      DPTR,#scb
B3:00EB5D E0                MOVX     A,@DPTR
B3:00EB5E FC                MOV      R4,A
B3:00EB5F A3                INC      DPTR
B3:00EB60 E0                MOVX     A,@DPTR
B3:00EB61 FD                MOV      R5,A
B3:00EB62 9029BB            MOV      DPTR,#scb+06H
B3:00EB65 E0                MOVX     A,@DPTR
B3:00EB66 FE                MOV      R6,A
B3:00EB67 A3                INC      DPTR
B3:00EB68 E0                MOVX     A,@DPTR
B3:00EB69 FF                MOV      R7,A
B3:00EB6A 1220B8            LCALL    ?C?UIDIV
B3:00EB6D 9029DA            MOV      DPTR,#scb+025H
B3:00EB70 EF                MOV      A,R7
B3:00EB71 F0                MOVX     @DPTR,A
B3:00EB72 9029B5            MOV      DPTR,#scb
B3:00EB75 E0                MOVX     A,@DPTR
B3:00EB76 FC                MOV      R4,A
B3:00EB77 A3                INC      DPTR
B3:00EB78 E0                MOVX     A,@DPTR
B3:00EB79 FD                MOV      R5,A
B3:00EB7A 9029BB            MOV      DPTR,#scb+06H
B3:00EB7D         ?L?COM00C2:
B3:00EB7D E0                MOVX     A,@DPTR
B3:00EB7E FE                MOV      R6,A
B3:00EB7F A3                INC      DPTR
B3:00EB80 E0                MOVX     A,@DPTR
B3:00EB81 FF                MOV      R7,A
B3:00EB82 0220B8            LJMP     ?C?UIDIV
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1109


----- FUNCTION ?L?COM00C1 (END) -------


----- FUNCTION get_next_missing_frag (BEGIN) -----
B3:00EB85 711B              ACALL    ?L?COM02B4
B3:00EB87 717D              ACALL    ?L?COM00C2
;---- Variable 'max_offset' assigned to Register 'R3' ----
B3:00EB89 AB07              MOV      R3,AR7
;---- Variable 'i' assigned to Register 'R2' ----
B3:00EB8B 711B              ACALL    ?L?COM02B4
B3:00EB8D 717D              ACALL    ?L?COM00C2
B3:00EB8F ED                MOV      A,R5
B3:00EB90 4C                ORL      A,R4
B3:00EB91 6001              JZ       ?C0187?TRANSPORT_SERVICE2
B3:00EB93 0B                INC      R3
B3:00EB94         ?C0187?TRANSPORT_SERVICE2:
B3:00EB94 9029B2            MOV      DPTR,#rcb+0129H
B3:00EB97 E0                MOVX     A,@DPTR
B3:00EB98 FA                MOV      R2,A
B3:00EB99         ?C0188?TRANSPORT_SERVICE2:
B3:00EB99 EA                MOV      A,R2
B3:00EB9A C3                CLR      C
B3:00EB9B 9B                SUBB     A,R3
B3:00EB9C 501A              JNC      ?C0189?TRANSPORT_SERVICE2
B3:00EB9E 51F2              ACALL    ?L?COM02CE
B3:00EBA0 E0                MOVX     A,@DPTR
B3:00EBA1 7012              JNZ      ?C0190?TRANSPORT_SERVICE2
B3:00EBA3 9029B2            MOV      DPTR,#rcb+0129H
B3:00EBA6 EA                MOV      A,R2
B3:00EBA7 F0                MOVX     @DPTR,A
B3:00EBA8 9029A6            MOV      DPTR,#rcb+011DH
B3:00EBAB E0                MOVX     A,@DPTR
B3:00EBAC FF                MOV      R7,A
B3:00EBAD EA                MOV      A,R2
B3:00EBAE 8FF0              MOV      B,R7
B3:00EBB0 A4                MUL      AB
B3:00EBB1 FF                MOV      R7,A
B3:00EBB2 AEF0              MOV      R6,B
B3:00EBB4 22                RET      
B3:00EBB5         ?C0190?TRANSPORT_SERVICE2:
B3:00EBB5 0A                INC      R2
B3:00EBB6 80E1              SJMP     ?C0188?TRANSPORT_SERVICE2
B3:00EBB8         ?C0189?TRANSPORT_SERVICE2:
B3:00EBB8 E4                CLR      A
B3:00EBB9 FE                MOV      R6,A
B3:00EBBA FF                MOV      R7,A
B3:00EBBB 22                RET      
----- FUNCTION get_next_missing_frag (END) -------


----- FUNCTION send_frag_req_cmd (BEGIN) -----
B3:00EBBC 7B01              MOV      R3,#01H
B3:00EBBE 7A28              MOV      R2,#HIGH t2_txBuf
B3:00EBC0 7943              MOV      R1,#LOW t2_txBuf
B3:00EBC2 904126            MOV      DPTR,#frag_req
B3:00EBC5 1225A9            LCALL    ?C?PSTXDATA
B3:00EBC8 E4                CLR      A
B3:00EBC9 90412B            MOV      DPTR,#ret1
B3:00EBCC F0                MOVX     @DPTR,A
B3:00EBCD 7185              ACALL    get_next_missing_frag
B3:00EBCF 904129            MOV      DPTR,#offset_to_request
B3:00EBD2 1267E1            LCALL    ?L?COM0460
B3:00EBD5 7008              JNZ      ?C0193?TRANSPORT_SERVICE2
B3:00EBD7 7F05              MOV      R7,#05H
B3:00EBD9 12BD5A            LCALL    _t2_sm_post_event
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1110


B3:00EBDC 7F00              MOV      R7,#00H
B3:00EBDE 22                RET      
B3:00EBDF         ?C0193?TRANSPORT_SERVICE2:
B3:00EBDF 9028A5            MOV      DPTR,#rcb+01CH
B3:00EBE2 E0                MOVX     A,@DPTR
B3:00EBE3 D3                SETB     C
B3:00EBE4 940F              SUBB     A,#0FH
B3:00EBE6 4003              JC       ?C0195?TRANSPORT_SERVICE2
B3:00EBE8 7F00              MOV      R7,#00H
B3:00EBEA 22                RET      
B3:00EBEB         ?C0195?TRANSPORT_SERVICE2:
B3:00EBEB 904126            MOV      DPTR,#frag_req
B3:00EBEE 91D2              ACALL    ?L?COM02D4
B3:00EBF0 904126            MOV      DPTR,#frag_req
B3:00EBF3 122589            LCALL    ?C?PLDXDATA
B3:00EBF6 900001            MOV      DPTR,#01H
B3:00EBF9 74C8              MOV      A,#0C8H
B3:00EBFB 122084            LCALL    ?C?CSTOPTR
B3:00EBFE 9028A5            MOV      DPTR,#rcb+01CH
B3:00EC01 E0                MOVX     A,@DPTR
B3:00EC02 C4                SWAP     A
B3:00EC03 54F0              ANL      A,#0F0H
B3:00EC05 91FD              ACALL    ?L?COM0131
B3:00EC07 E9                MOV      A,R1
B3:00EC08 2402              ADD      A,#02H
B3:00EC0A 125510            LCALL    ?L?COM000B
B3:00EC0D FD                MOV      R5,A
B3:00EC0E 904129            MOV      DPTR,#offset_to_request
B3:00EC11 E0                MOVX     A,@DPTR
B3:00EC12 5407              ANL      A,#07H
B3:00EC14 4D                ORL      A,R5
B3:00EC15 122072            LCALL    ?C?CSTPTR
B3:00EC18 904129            MOV      DPTR,#offset_to_request
B3:00EC1B A3                INC      DPTR
B3:00EC1C E0                MOVX     A,@DPTR
B3:00EC1D FF                MOV      R7,A
B3:00EC1E 904126            MOV      DPTR,#frag_req
B3:00EC21 122589            LCALL    ?C?PLDXDATA
B3:00EC24 900003            MOV      DPTR,#03H
B3:00EC27 EF                MOV      A,R7
B3:00EC28 122084            LCALL    ?C?CSTOPTR
B3:00EC2B 12BDEE            LCALL    ?L?COM0030
B3:00EC2E 12BDA7            LCALL    ?L?COM0083
B3:00EC31 7B01              MOV      R3,#01H
B3:00EC33 7A28              MOV      R2,#HIGH t2_txBuf
B3:00EC35 7943              MOV      R1,#LOW t2_txBuf
B3:00EC37 903FD8            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
B3:00EC3A 7404              MOV      A,#04H
B3:00EC3C F0                MOVX     @DPTR,A
B3:00EC3D 90288D            MOV      DPTR,#rcb+04H
B3:00EC40 12CBD0            LCALL    ?L?COM013A
B3:00EC43 9186              ACALL    ?L?COM0589
B3:00EC45 12CDE8            LCALL    ?L?COM019C
B3:00EC48 90412B            MOV      DPTR,#ret1
B3:00EC4B F0                MOVX     @DPTR,A
B3:00EC4C 7008              JNZ      ?C0196?TRANSPORT_SERVICE2
B3:00EC4E 9028AB            MOV      DPTR,#rcb+022H
B3:00EC51 E0                MOVX     A,@DPTR
B3:00EC52 6002              JZ       ?C0196?TRANSPORT_SERVICE2
B3:00EC54 14                DEC      A
B3:00EC55 F0                MOVX     @DPTR,A
B3:00EC56         ?C0196?TRANSPORT_SERVICE2:
B3:00EC56 9028CC            MOV      DPTR,#rcb+043H
B3:00EC59 7401              MOV      A,#01H
B3:00EC5B F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1111


B3:00EC5C 7F05              MOV      R7,#05H
B3:00EC5E 12BD5A            LCALL    _t2_sm_post_event
B3:00EC61 9169              ACALL    ?L?COM0194
B3:00EC63 12BDB4            LCALL    ?L?COM0084
B3:00EC66 7F00              MOV      R7,#00H
B3:00EC68 22                RET      
----- FUNCTION send_frag_req_cmd (END) -------


----- FUNCTION ?L?COM0194 (BEGIN) -----
B3:00EC69 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00EC6C 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_rx_timer_expired
B3:00EC6E F0                MOVX     @DPTR,A
B3:00EC6F A3                INC      DPTR
B3:00EC70 749F              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_rx_timer_expired
B3:00EC72 F0                MOVX     @DPTR,A
B3:00EC73 7B01              MOV      R3,#01H
B3:00EC75 7A28              MOV      R2,#HIGH rcb+043H
B3:00EC77 79CC              MOV      R1,#LOW rcb+043H
B3:00EC79 A3                INC      DPTR
B3:00EC7A 1225A9            LCALL    ?C?PSTXDATA
B3:00EC7D 7A28              MOV      R2,#HIGH rcb+033H
B3:00EC7F 79BC              MOV      R1,#LOW rcb+033H
B3:00EC81 7F20              MOV      R7,#020H
B3:00EC83 7E03              MOV      R6,#03H
B3:00EC85 22                RET      
----- FUNCTION ?L?COM0194 (END) -------


----- FUNCTION ?L?COM0589 (BEGIN) -----
B3:00EC86 E4                CLR      A
B3:00EC87 A3                INC      DPTR
B3:00EC88 F0                MOVX     @DPTR,A
B3:00EC89 A3                INC      DPTR
B3:00EC8A F0                MOVX     @DPTR,A
B3:00EC8B 902889            MOV      DPTR,#rcb
B3:00EC8E 22                RET      
----- FUNCTION ?L?COM0589 (END) -------


----- FUNCTION _find_transition (BEGIN) -----
;---- Variable 'event' assigned to Register 'R5' ----
;---- Variable 'cstate' assigned to Register 'R7' ----
;---- Variable 'num_trans' assigned to Register 'R6' ----
B3:00EC8F 7E38              MOV      R6,#038H
B3:00EC91         ?C0001?TRANSPORT2_FSM:
B3:00EC91 AC06              MOV      R4,AR6
B3:00EC93 1E                DEC      R6
B3:00EC94 EC                MOV      A,R4
B3:00EC95 6014              JZ       ?C0002?TRANSPORT2_FSM
B3:00EC97 902FF0            MOV      DPTR,#trans
B3:00EC9A 91AE              ACALL    ?L?COM0536
B3:00EC9C B507F2            CJNE     A,AR7,?C0001?TRANSPORT2_FSM
B3:00EC9F 902FF1            MOV      DPTR,#trans+01H
B3:00ECA2 91AE              ACALL    ?L?COM0536
B3:00ECA4 B505EA            CJNE     A,AR5,?C0001?TRANSPORT2_FSM
B3:00ECA7 EE                MOV      A,R6
B3:00ECA8 04                INC      A
B3:00ECA9 FF                MOV      R7,A
B3:00ECAA 22                RET      
B3:00ECAB         ?C0002?TRANSPORT2_FSM:
B3:00ECAB 7F00              MOV      R7,#00H
B3:00ECAD 22                RET      
----- FUNCTION _find_transition (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1112



----- FUNCTION ?L?COM0536 (BEGIN) -----
B3:00ECAE 75F006            MOV      B,#06H
B3:00ECB1 EE                MOV      A,R6
B3:00ECB2 12257D            LCALL    ?C?OFFXADD
B3:00ECB5 E4                CLR      A
B3:00ECB6 93                MOVC     A,@A+DPTR
B3:00ECB7 22                RET      
----- FUNCTION ?L?COM0536 (END) -------


----- FUNCTION ?L?COM03AB (BEGIN) -----
B3:00ECB8 F0                MOVX     @DPTR,A
B3:00ECB9         ?L?COM03AC:
B3:00ECB9 9042BE            MOV      DPTR,#evt
B3:00ECBC 122589            LCALL    ?C?PLDXDATA
B3:00ECBF E9                MOV      A,R1
B3:00ECC0 22                RET      
----- FUNCTION ?L?COM03AB (END) -------


----- FUNCTION ?L?COM04DC (BEGIN) -----
B3:00ECC1 F0                MOVX     @DPTR,A
B3:00ECC2 7B01              MOV      R3,#01H
B3:00ECC4 7A28              MOV      R2,#HIGH rcb+033H
B3:00ECC6 79BC              MOV      R1,#LOW rcb+033H
B3:00ECC8 021B15            LJMP     ?INTERBANK_TABLE?_ctimer_stop
----- FUNCTION ?L?COM04DC (END) -------


----- FUNCTION ?L?COM02D3 (BEGIN) -----
B3:00ECCB F0                MOVX     @DPTR,A
B3:00ECCC A3                INC      DPTR
B3:00ECCD EF                MOV      A,R7
B3:00ECCE F0                MOVX     @DPTR,A
B3:00ECCF 902879            MOV      DPTR,#subseq_frag
B3:00ECD2         ?L?COM02D4:
B3:00ECD2 122589            LCALL    ?C?PLDXDATA
B3:00ECD5 7455              MOV      A,#055H
B3:00ECD7 022072            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM02D3 (END) -------


----- FUNCTION ?L?COM05D8 (BEGIN) -----
B3:00ECDA 8E83              MOV      DPH,R6
B3:00ECDC E4                CLR      A
B3:00ECDD FF                MOV      R7,A
B3:00ECDE 02271A            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM05D8 (END) -------


----- FUNCTION ?L?COM012F (BEGIN) -----
B3:00ECE1 9029DE            MOV      DPTR,#scb+029H
B3:00ECE4 E0                MOVX     A,@DPTR
B3:00ECE5 FC                MOV      R4,A
B3:00ECE6 A3                INC      DPTR
B3:00ECE7 E0                MOVX     A,@DPTR
B3:00ECE8 FD                MOV      R5,A
B3:00ECE9 EC                MOV      A,R4
B3:00ECEA 5407              ANL      A,#07H
B3:00ECEC 44E0              ORL      A,#0E0H
B3:00ECEE FF                MOV      R7,A
B3:00ECEF 902879            MOV      DPTR,#subseq_frag
B3:00ECF2         ?L?COM0130:
B3:00ECF2 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1113


B3:00ECF5 900001            MOV      DPTR,#01H
B3:00ECF8 EF                MOV      A,R7
B3:00ECF9 122084            LCALL    ?C?CSTOPTR
B3:00ECFC ED                MOV      A,R5
B3:00ECFD         ?L?COM0131:
B3:00ECFD 900002            MOV      DPTR,#02H
B3:00ED00 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM012F (END) -------


----- FUNCTION ?L?COM059D (BEGIN) -----
B3:00ED03 E0                MOVX     A,@DPTR
B3:00ED04 FF                MOV      R7,A
B3:00ED05 904396            MOV      DPTR,#support
B3:00ED08 E0                MOVX     A,@DPTR
B3:00ED09 FE                MOV      R6,A
B3:00ED0A 5F                ANL      A,R7
B3:00ED0B 22                RET      
----- FUNCTION ?L?COM059D (END) -------


----- FUNCTION ?L?COM01EF (BEGIN) -----
B3:00ED0C 75F026            MOV      B,#026H
B3:00ED0F A4                MUL      AB
B3:00ED10 FF                MOV      R7,A
B3:00ED11 900AD3            MOV      DPTR,#tmp
B3:00ED14         ?L?COM01F0:
B3:00ED14 E5F0              MOV      A,B
B3:00ED16 F0                MOVX     @DPTR,A
B3:00ED17 A3                INC      DPTR
B3:00ED18 EF                MOV      A,R7
B3:00ED19 F0                MOVX     @DPTR,A
B3:00ED1A 22                RET      
----- FUNCTION ?L?COM01EF (END) -------


----- FUNCTION ?L?COM05FC (BEGIN) -----
B3:00ED1B 900665            MOV      DPTR,#i
B3:00ED1E E0                MOVX     A,@DPTR
B3:00ED1F C3                CLR      C
B3:00ED20 940A              SUBB     A,#0AH
B3:00ED22 22                RET      
----- FUNCTION ?L?COM05FC (END) -------


----- FUNCTION ?L?COM04A3 (BEGIN) -----
B3:00ED23 748C              MOV      A,#LOW t+020H
B3:00ED25 2D                ADD      A,R5
B3:00ED26 F582              MOV      DPL,A
B3:00ED28 E4                CLR      A
B3:00ED29 3406              ADDC     A,#HIGH t+020H
B3:00ED2B F583              MOV      DPH,A
B3:00ED2D E0                MOVX     A,@DPTR
B3:00ED2E 22                RET      
----- FUNCTION ?L?COM04A3 (END) -------


----- FUNCTION ?L?COM060D (BEGIN) -----
B3:00ED2F 1224C1            LCALL    ?C?LLDOPTR0
B3:00ED32 C3                CLR      C
B3:00ED33 0223BE            LJMP     ?C?SLCMP
----- FUNCTION ?L?COM060D (END) -------


----- FUNCTION ?L?COM014F (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1114


B3:00ED36 E0                MOVX     A,@DPTR
B3:00ED37 FD                MOV      R5,A
B3:00ED38 7B01              MOV      R3,#01H
B3:00ED3A         ?L?COM0150:
B3:00ED3A 903F8F            MOV      DPTR,#?_get_nonce?BYTE+03H
B3:00ED3D 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM014F (END) -------


----- FUNCTION ?L?COM04A5 (BEGIN) -----
B3:00ED40 900AA1            MOV      DPTR,#r
B3:00ED43 E0                MOVX     A,@DPTR
B3:00ED44 FE                MOV      R6,A
B3:00ED45 A3                INC      DPTR
B3:00ED46 E0                MOVX     A,@DPTR
B3:00ED47 22                RET      
----- FUNCTION ?L?COM04A5 (END) -------


----- FUNCTION ?L?COM0134 (BEGIN) -----
B3:00ED48 E0                MOVX     A,@DPTR
B3:00ED49 FF                MOV      R7,A
B3:00ED4A 900AD3            MOV      DPTR,#tmp
B3:00ED4D E0                MOVX     A,@DPTR
B3:00ED4E FA                MOV      R2,A
B3:00ED4F A3                INC      DPTR
B3:00ED50 E0                MOVX     A,@DPTR
B3:00ED51 FB                MOV      R3,A
B3:00ED52 C3                CLR      C
B3:00ED53 EF                MOV      A,R7
B3:00ED54 9B                SUBB     A,R3
B3:00ED55 FF                MOV      R7,A
B3:00ED56 E4                CLR      A
B3:00ED57 9A                SUBB     A,R2
B3:00ED58 900AD3            MOV      DPTR,#tmp
B3:00ED5B F0                MOVX     @DPTR,A
B3:00ED5C A3                INC      DPTR
B3:00ED5D EF                MOV      A,R7
B3:00ED5E F0                MOVX     @DPTR,A
B3:00ED5F 900AD1            MOV      DPTR,#r
B3:00ED62 E0                MOVX     A,@DPTR
B3:00ED63 FA                MOV      R2,A
B3:00ED64 A3                INC      DPTR
B3:00ED65 E0                MOVX     A,@DPTR
B3:00ED66 2D                ADD      A,R5
B3:00ED67 F582              MOV      DPL,A
B3:00ED69 E4                CLR      A
B3:00ED6A 3A                ADDC     A,R2
B3:00ED6B F583              MOV      DPH,A
B3:00ED6D EF                MOV      A,R7
B3:00ED6E F0                MOVX     @DPTR,A
B3:00ED6F 900AD3            MOV      DPTR,#tmp
B3:00ED72 E0                MOVX     A,@DPTR
B3:00ED73 C4                SWAP     A
B3:00ED74 13                RRC      A
B3:00ED75 13                RRC      A
B3:00ED76 13                RRC      A
B3:00ED77 5401              ANL      A,#01H
B3:00ED79         ?L?COM0135:
B3:00ED79 F8                MOV      R0,A
B3:00ED7A E4                CLR      A
B3:00ED7B F0                MOVX     @DPTR,A
B3:00ED7C E8                MOV      A,R0
B3:00ED7D A3                INC      DPTR
B3:00ED7E F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1115


B3:00ED7F 0D                INC      R5
B3:00ED80 ED                MOV      A,R5
B3:00ED81 22                RET      
----- FUNCTION ?L?COM0134 (END) -------


----- FUNCTION ?L?COM018F (BEGIN) -----
B3:00ED82 9038BB            MOV      DPTR,#byte1
B3:00ED85 E0                MOVX     A,@DPTR
B3:00ED86 5407              ANL      A,#07H
B3:00ED88 FF                MOV      R7,A
B3:00ED89 9038C2            MOV      DPTR,#datagram_size_tmp
B3:00ED8C E4                CLR      A
B3:00ED8D F0                MOVX     @DPTR,A
B3:00ED8E A3                INC      DPTR
B3:00ED8F EF                MOV      A,R7
B3:00ED90 F0                MOVX     @DPTR,A
B3:00ED91 22                RET      
----- FUNCTION ?L?COM018F (END) -------


----- FUNCTION ?L?COM042C (BEGIN) -----
B3:00ED92 FF                MOV      R7,A
B3:00ED93 1299EF            LCALL    ___ZW_memset
B3:00ED96         ?L?COM042D:
B3:00ED96 9028A5            MOV      DPTR,#rcb+01CH
B3:00ED99 7410              MOV      A,#010H
B3:00ED9B F0                MOVX     @DPTR,A
B3:00ED9C 22                RET      
----- FUNCTION ?L?COM042C (END) -------


----- FUNCTION ?L?COM00FB (BEGIN) -----
B3:00ED9D 9028A7            MOV      DPTR,#rcb+01EH
B3:00EDA0 122589            LCALL    ?C?PLDXDATA
B3:00EDA3 9028AA            MOV      DPTR,#rcb+021H
B3:00EDA6         ?L?COM00FC:
B3:00EDA6 E0                MOVX     A,@DPTR
B3:00EDA7 FF                MOV      R7,A
B3:00EDA8 903F79            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B3:00EDAB E4                CLR      A
B3:00EDAC F0                MOVX     @DPTR,A
B3:00EDAD A3                INC      DPTR
B3:00EDAE EF                MOV      A,R7
B3:00EDAF F0                MOVX     @DPTR,A
B3:00EDB0 22                RET      
----- FUNCTION ?L?COM00FB (END) -------


----- FUNCTION ?L?COM028A (BEGIN) -----
B3:00EDB1 E0                MOVX     A,@DPTR
B3:00EDB2 FE                MOV      R6,A
B3:00EDB3 9038BC            MOV      DPTR,#byte2
B3:00EDB6 E0                MOVX     A,@DPTR
B3:00EDB7 7C00              MOV      R4,#00H
B3:00EDB9 2400              ADD      A,#00H
B3:00EDBB FF                MOV      R7,A
B3:00EDBC EC                MOV      A,R4
B3:00EDBD 3E                ADDC     A,R6
B3:00EDBE FE                MOV      R6,A
B3:00EDBF 9038C2            MOV      DPTR,#datagram_size_tmp
B3:00EDC2 F0                MOVX     @DPTR,A
B3:00EDC3 A3                INC      DPTR
B3:00EDC4 EF                MOV      A,R7
B3:00EDC5 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1116


B3:00EDC6 D3                SETB     C
B3:00EDC7 94C8              SUBB     A,#0C8H
B3:00EDC9 EE                MOV      A,R6
B3:00EDCA 9400              SUBB     A,#00H
B3:00EDCC 22                RET      
----- FUNCTION ?L?COM028A (END) -------


----- FUNCTION ?L?COM0576 (BEGIN) -----
B3:00EDCD 7B01              MOV      R3,#01H
B3:00EDCF 7A29              MOV      R2,#HIGH rcb+011FH
B3:00EDD1 79A8              MOV      R1,#LOW rcb+011FH
B3:00EDD3 7D0A              MOV      R5,#0AH
B3:00EDD5 22                RET      
----- FUNCTION ?L?COM0576 (END) -------


----- FUNCTION ?L?COM041F (BEGIN) -----
B3:00EDD6 E0                MOVX     A,@DPTR
B3:00EDD7 FA                MOV      R2,A
B3:00EDD8 A3                INC      DPTR
B3:00EDD9 E0                MOVX     A,@DPTR
B3:00EDDA 2D                ADD      A,R5
B3:00EDDB F582              MOV      DPL,A
B3:00EDDD E4                CLR      A
B3:00EDDE 3A                ADDC     A,R2
B3:00EDDF F583              MOV      DPH,A
B3:00EDE1 EF                MOV      A,R7
B3:00EDE2 F0                MOVX     @DPTR,A
B3:00EDE3 22                RET      
----- FUNCTION ?L?COM041F (END) -------


----- FUNCTION ?L?COM02D0 (BEGIN) -----
B3:00EDE4 E0                MOVX     A,@DPTR
B3:00EDE5 904262            MOV      DPTR,#frag_wait+02H
B3:00EDE8 F0                MOVX     @DPTR,A
B3:00EDE9 7B01              MOV      R3,#01H
B3:00EDEB 7A42              MOV      R2,#HIGH frag_wait
B3:00EDED 7960              MOV      R1,#LOW frag_wait
B3:00EDEF         ?L?COM02D1:
B3:00EDEF 903FD8            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
B3:00EDF2 7403              MOV      A,#03H
B3:00EDF4 F0                MOVX     @DPTR,A
B3:00EDF5 22                RET      
----- FUNCTION ?L?COM02D0 (END) -------


----- FUNCTION ?L?COM04CE (BEGIN) -----
B3:00EDF6 7A32              MOV      R2,#HIGH nonce
B3:00EDF8 79AB              MOV      R1,#LOW nonce
B3:00EDFA 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04CE (END) -------


----- FUNCTION ?L?COM053F (BEGIN) -----
B3:00EDFD 7A22              MOV      R2,#HIGH the_context+0208H
B3:00EDFF 903DC9            MOV      DPTR,#i
B3:00EE02 E0                MOVX     A,@DPTR
B3:00EE03 22                RET      
----- FUNCTION ?L?COM053F (END) -------


----- FUNCTION ?L?COM053E (BEGIN) -----
B3:00EE04 122589            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1117


B3:00EE07 90354D            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+0DH
B3:00EE0A 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM053E (END) -------


----- FUNCTION ?L?COM05A1 (BEGIN) -----
B3:00EE0D 9020ED            MOV      DPTR,#the_context+0DAH
B3:00EE10 E0                MOVX     A,@DPTR
B3:00EE11 FE                MOV      R6,A
B3:00EE12 A3                INC      DPTR
B3:00EE13 E0                MOVX     A,@DPTR
B3:00EE14 FF                MOV      R7,A
B3:00EE15 22                RET      
----- FUNCTION ?L?COM05A1 (END) -------


----- FUNCTION ?L?COM0521 (BEGIN) -----
B3:00EE16 122589            LCALL    ?C?PLDXDATA
B3:00EE19 A801              MOV      R0,AR1
B3:00EE1B AC02              MOV      R4,AR2
B3:00EE1D AD03              MOV      R5,AR3
B3:00EE1F 22                RET      
----- FUNCTION ?L?COM0521 (END) -------


----- FUNCTION ?L?COM025D (BEGIN) -----
B3:00EE20 122589            LCALL    ?C?PLDXDATA
B3:00EE23 900001            MOV      DPTR,#01H
B3:00EE26 7403              MOV      A,#03H
B3:00EE28 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM025D (END) -------


----- FUNCTION ?L?COM0205 (BEGIN) -----
B3:00EE2B E0                MOVX     A,@DPTR
B3:00EE2C         ?L?COM0206:
B3:00EE2C 75F040            MOV      B,#040H
B3:00EE2F A4                MUL      AB
B3:00EE30 7B01              MOV      R3,#01H
B3:00EE32 2413              ADD      A,#LOW the_context
B3:00EE34 F9                MOV      R1,A
B3:00EE35 7420              MOV      A,#HIGH the_context
B3:00EE37 35F0              ADDC     A,B
B3:00EE39 FA                MOV      R2,A
B3:00EE3A 22                RET      
----- FUNCTION ?L?COM0205 (END) -------


----- FUNCTION ?L?COM02A1 (BEGIN) -----
B3:00EE3B 7B01              MOV      R3,#01H
B3:00EE3D A3                INC      DPTR
B3:00EE3E         ?L?COM02A2:
B3:00EE3E 1225A9            LCALL    ?C?PSTXDATA
B3:00EE41 903C57            MOV      DPTR,#?___S2_make_aad?BYTE+0CH
B3:00EE44 E4                CLR      A
B3:00EE45 F0                MOVX     @DPTR,A
B3:00EE46 A3                INC      DPTR
B3:00EE47 7440              MOV      A,#040H
B3:00EE49 F0                MOVX     @DPTR,A
B3:00EE4A 22                RET      
----- FUNCTION ?L?COM02A1 (END) -------


----- FUNCTION ?L?COM051B (BEGIN) -----
B3:00EE4B 903EC6            MOV      DPTR,#?_ZW_AES_ecb?BYTE+03H
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1118


B3:00EE4E 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM051B (END) -------


----- FUNCTION ?L?COM0336 (BEGIN) -----
B3:00EE51 E0                MOVX     A,@DPTR
B3:00EE52 F8                MOV      R0,A
B3:00EE53 A3                INC      DPTR
B3:00EE54 E0                MOVX     A,@DPTR
B3:00EE55 2B                ADD      A,R3
B3:00EE56 FB                MOV      R3,A
B3:00EE57 E8                MOV      A,R0
B3:00EE58 3A                ADDC     A,R2
B3:00EE59 CB                XCH      A,R3
B3:00EE5A 2408              ADD      A,#08H
B3:00EE5C FE                MOV      R6,A
B3:00EE5D E4                CLR      A
B3:00EE5E 3B                ADDC     A,R3
B3:00EE5F 903C52            MOV      DPTR,#?___S2_make_aad?BYTE+07H
B3:00EE62 F0                MOVX     @DPTR,A
B3:00EE63 A3                INC      DPTR
B3:00EE64 CE                XCH      A,R6
B3:00EE65 F0                MOVX     @DPTR,A
B3:00EE66 22                RET      
----- FUNCTION ?L?COM0336 (END) -------


----- FUNCTION ?L?COM0538 (BEGIN) -----
B3:00EE67 9029DB            MOV      DPTR,#scb+026H
B3:00EE6A 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0538 (END) -------


----- FUNCTION ?L?COM02D2 (BEGIN) -----
B3:00EE6D 1280A2            LCALL    ___ZW_memcpy
B3:00EE70 902879            MOV      DPTR,#subseq_frag
B3:00EE73 122589            LCALL    ?C?PLDXDATA
B3:00EE76 9029B5            MOV      DPTR,#scb
B3:00EE79 A3                INC      DPTR
B3:00EE7A E0                MOVX     A,@DPTR
B3:00EE7B 22                RET      
----- FUNCTION ?L?COM02D2 (END) -------


----- FUNCTION ?L?COM05E6 (BEGIN) -----
B3:00EE7C A3                INC      DPTR
B3:00EE7D 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00EE7F F0                MOVX     @DPTR,A
B3:00EE80 A3                INC      DPTR
B3:00EE81 7486              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00EE83 22                RET      
----- FUNCTION ?L?COM05E6 (END) -------


----- FUNCTION ?L?COM05FE (BEGIN) -----
B3:00EE84 9029BB            MOV      DPTR,#scb+06H
B3:00EE87 F0                MOVX     @DPTR,A
B3:00EE88 A3                INC      DPTR
B3:00EE89 CE                XCH      A,R6
B3:00EE8A F0                MOVX     @DPTR,A
B3:00EE8B 22                RET      
----- FUNCTION ?L?COM05FE (END) -------


----- FUNCTION ?L?COM0587 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1119


B3:00EE8C E0                MOVX     A,@DPTR
B3:00EE8D FC                MOV      R4,A
B3:00EE8E A3                INC      DPTR
B3:00EE8F E0                MOVX     A,@DPTR
B3:00EE90 29                ADD      A,R1
B3:00EE91 F9                MOV      R1,A
B3:00EE92 EA                MOV      A,R2
B3:00EE93 3C                ADDC     A,R4
B3:00EE94 22                RET      
----- FUNCTION ?L?COM0587 (END) -------


----- FUNCTION ?L?COM03EE (BEGIN) -----
B3:00EE95 9029DE            MOV      DPTR,#scb+029H
B3:00EE98 E0                MOVX     A,@DPTR
B3:00EE99 FF                MOV      R7,A
B3:00EE9A A3                INC      DPTR
B3:00EE9B E0                MOVX     A,@DPTR
B3:00EE9C 9029BB            MOV      DPTR,#scb+06H
B3:00EE9F CF                XCH      A,R7
B3:00EEA0 F0                MOVX     @DPTR,A
B3:00EEA1 A3                INC      DPTR
B3:00EEA2 EF                MOV      A,R7
B3:00EEA3 22                RET      
----- FUNCTION ?L?COM03EE (END) -------


----- FUNCTION ?L?COM01D0 (BEGIN) -----
B3:00EEA4 E0                MOVX     A,@DPTR
B3:00EEA5 FC                MOV      R4,A
B3:00EEA6 A3                INC      DPTR
B3:00EEA7 E0                MOVX     A,@DPTR
B3:00EEA8 FD                MOV      R5,A
B3:00EEA9 EC                MOV      A,R4
B3:00EEAA 5407              ANL      A,#07H
B3:00EEAC FF                MOV      R7,A
B3:00EEAD 9029D9            MOV      DPTR,#scb+024H
B3:00EEB0 E0                MOVX     A,@DPTR
B3:00EEB1 FE                MOV      R6,A
B3:00EEB2 C4                SWAP     A
B3:00EEB3 54F0              ANL      A,#0F0H
B3:00EEB5 4F                ORL      A,R7
B3:00EEB6 900003            MOV      DPTR,#03H
B3:00EEB9 122084            LCALL    ?C?CSTOPTR
B3:00EEBC ED                MOV      A,R5
B3:00EEBD 900004            MOV      DPTR,#04H
B3:00EEC0 122084            LCALL    ?C?CSTOPTR
B3:00EEC3 9029B5            MOV      DPTR,#scb
B3:00EEC6 A3                INC      DPTR
B3:00EEC7 E0                MOVX     A,@DPTR
B3:00EEC8 FF                MOV      R7,A
B3:00EEC9 E9                MOV      A,R1
B3:00EECA 2405              ADD      A,#05H
B3:00EECC F9                MOV      R1,A
B3:00EECD E4                CLR      A
B3:00EECE 22                RET      
----- FUNCTION ?L?COM01D0 (END) -------


----- FUNCTION ?L?COM04CA (BEGIN) -----
B3:00EECF 900A53            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00EED2 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_S2_send_frame_callback
B3:00EED4 F0                MOVX     @DPTR,A
B3:00EED5 A3                INC      DPTR
B3:00EED6 748C              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_S2_send_frame_callback
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1120


B3:00EED8 F0                MOVX     @DPTR,A
B3:00EED9 22                RET      
----- FUNCTION ?L?COM04CA (END) -------


----- FUNCTION ?L?COM04DF (BEGIN) -----
B3:00EEDA 122589            LCALL    ?C?PLDXDATA
B3:00EEDD 12A5A0            LCALL    ___find_span_by_node
B3:00EEE0 AA06              MOV      R2,AR6
B3:00EEE2 A907              MOV      R1,AR7
B3:00EEE4 22                RET      
----- FUNCTION ?L?COM04DF (END) -------


----- FUNCTION ?L?COM007C (BEGIN) -----
B3:00EEE5 FF                MOV      R7,A
B3:00EEE6         ?L?COM007D:
B3:00EEE6 122589            LCALL    ?C?PLDXDATA
B3:00EEE9 E9                MOV      A,R1
B3:00EEEA 2401              ADD      A,#01H
B3:00EEEC F9                MOV      R1,A
B3:00EEED E4                CLR      A
B3:00EEEE 3A                ADDC     A,R2
B3:00EEEF FA                MOV      R2,A
B3:00EEF0 22                RET      
----- FUNCTION ?L?COM007C (END) -------


----- FUNCTION ?L?COM0147 (BEGIN) -----
B3:00EEF1 7A23              MOV      R2,#HIGH the_context+02EFH
B3:00EEF3 7902              MOV      R1,#LOW the_context+02EFH
B3:00EEF5 903BC5            MOV      DPTR,#?___S2_send_data?BYTE+03H
B3:00EEF8 1225A9            LCALL    ?C?PSTXDATA
B3:00EEFB 90232A            MOV      DPTR,#the_context+0317H
B3:00EEFE E0                MOVX     A,@DPTR
B3:00EEFF FF                MOV      R7,A
B3:00EF00 903BC8            MOV      DPTR,#?___S2_send_data?BYTE+06H
B3:00EF03 E4                CLR      A
B3:00EF04 F0                MOVX     @DPTR,A
B3:00EF05 A3                INC      DPTR
B3:00EF06 EF                MOV      A,R7
B3:00EF07 F0                MOVX     @DPTR,A
B3:00EF08 22                RET      
----- FUNCTION ?L?COM0147 (END) -------


----- FUNCTION ?L?COM01CF (BEGIN) -----
B3:00EF09 FD                MOV      R5,A
B3:00EF0A 7B01              MOV      R3,#01H
B3:00EF0C 903F88            MOV      DPTR,#?_aes_cbc_mac?BYTE+04H
B3:00EF0F 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01CF (END) -------


----- FUNCTION ?L?COM01F1 (BEGIN) -----
B3:00EF12 7B01              MOV      R3,#01H
B3:00EF14 7A2E              MOV      R2,#HIGH nonce
B3:00EF16 7951              MOV      R1,#LOW nonce
B3:00EF18 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01F1 (END) -------


----- FUNCTION ?L?COM0200 (BEGIN) -----
B3:00EF1B 7B01              MOV      R3,#01H
B3:00EF1D 7A25              MOV      R2,#HIGH the_tx_session+04CH
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1121


B3:00EF1F 79E9              MOV      R1,#LOW the_tx_session+04CH
B3:00EF21 8F82              MOV      DPL,R7
B3:00EF23 8E83              MOV      DPH,R6
B3:00EF25 22                RET      
----- FUNCTION ?L?COM0200 (END) -------


----- FUNCTION ?L?COM0216 (BEGIN) -----
B3:00EF26 90359F            MOV      DPTR,#s
B3:00EF29         ?L?COM0217:
B3:00EF29 1225A9            LCALL    ?C?PSTXDATA
B3:00EF2C EA                MOV      A,R2
B3:00EF2D 49                ORL      A,R1
B3:00EF2E 4B                ORL      A,R3
B3:00EF2F 22                RET      
----- FUNCTION ?L?COM0216 (END) -------


----- FUNCTION ?L?COM022C (BEGIN) -----
B3:00EF30 75F040            MOV      B,#040H
B3:00EF33 A4                MUL      AB
B3:00EF34 7B01              MOV      R3,#01H
B3:00EF36         ?L?COM022D:
B3:00EF36 2433              ADD      A,#LOW the_context+020H
B3:00EF38 F9                MOV      R1,A
B3:00EF39 7420              MOV      A,#HIGH the_context+020H
B3:00EF3B 35F0              ADDC     A,B
B3:00EF3D FA                MOV      R2,A
B3:00EF3E 90313A            MOV      DPTR,#?_next_nonce_instantiate?BYTE+09H
B3:00EF41 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM022C (END) -------


----- FUNCTION ?L?COM026E (BEGIN) -----
B3:00EF44 7B01              MOV      R3,#01H
B3:00EF46 7A35              MOV      R2,#HIGH iv
B3:00EF48 79AC              MOV      R1,#LOW iv
B3:00EF4A         ?L?COM026F:
B3:00EF4A 90410B            MOV      DPTR,#?_aes_set_key?BYTE+03H
B3:00EF4D 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM026E (END) -------


----- FUNCTION ?L?COM0288 (BEGIN) -----
B3:00EF50 FF                MOV      R7,A
B3:00EF51 902E03            MOV      DPTR,#conn
B3:00EF54 122589            LCALL    ?C?PLDXDATA
B3:00EF57 900007            MOV      DPTR,#07H
B3:00EF5A EF                MOV      A,R7
B3:00EF5B 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0288 (END) -------


----- FUNCTION ?L?COM02A4 (BEGIN) -----
B3:00EF5E E552              MOV      A,bExploreQueueIndex
B3:00EF60         ?L?COM02A5:
B3:00EF60 75F060            MOV      B,#060H
B3:00EF63 A4                MUL      AB
B3:00EF64 2498              ADD      A,#LOW exploreQueue
B3:00EF66 F9                MOV      R1,A
B3:00EF67 7408              MOV      A,#HIGH exploreQueue
B3:00EF69 35F0              ADDC     A,B
B3:00EF6B FA                MOV      R2,A
B3:00EF6C 7B01              MOV      R3,#01H
B3:00EF6E 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1122


----- FUNCTION ?L?COM02A4 (END) -------


----- FUNCTION ?L?COM0380 (BEGIN) -----
B3:00EF6F 902E77            MOV      DPTR,#mpan
B3:00EF72 122589            LCALL    ?C?PLDXDATA
B3:00EF75 AE02              MOV      R6,AR2
B3:00EF77 AF01              MOV      R7,AR1
B3:00EF79 22                RET      
----- FUNCTION ?L?COM0380 (END) -------


----- FUNCTION ?L?COM03AA (BEGIN) -----
B3:00EF7A FD                MOV      R5,A
B3:00EF7B E0                MOVX     A,@DPTR
B3:00EF7C FB                MOV      R3,A
B3:00EF7D A3                INC      DPTR
B3:00EF7E E0                MOVX     A,@DPTR
B3:00EF7F 903C50            MOV      DPTR,#?___S2_make_aad?BYTE+05H
B3:00EF82 CB                XCH      A,R3
B3:00EF83 F0                MOVX     @DPTR,A
B3:00EF84 A3                INC      DPTR
B3:00EF85 EB                MOV      A,R3
B3:00EF86 F0                MOVX     @DPTR,A
B3:00EF87 22                RET      
----- FUNCTION ?L?COM03AA (END) -------


----- FUNCTION ?L?COM03C9 (BEGIN) -----
B3:00EF88 E4                CLR      A
B3:00EF89 7F10              MOV      R7,#010H
B3:00EF8B 7E27              MOV      R6,#027H
B3:00EF8D FD                MOV      R5,A
B3:00EF8E FC                MOV      R4,A
B3:00EF8F 903D7B            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00EF92 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_tx_timeout
B3:00EF94 F0                MOVX     @DPTR,A
B3:00EF95 A3                INC      DPTR
B3:00EF96 744B              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_tx_timeout
B3:00EF98 22                RET      
----- FUNCTION ?L?COM03C9 (END) -------


----- FUNCTION ?L?COM03F0 (BEGIN) -----
B3:00EF99 75F040            MOV      B,#040H
B3:00EF9C A4                MUL      AB
B3:00EF9D 7B01              MOV      R3,#01H
B3:00EF9F 2423              ADD      A,#LOW the_context+010H
B3:00EFA1 F9                MOV      R1,A
B3:00EFA2 7420              MOV      A,#HIGH the_context+010H
B3:00EFA4 35F0              ADDC     A,B
B3:00EFA6 FA                MOV      R2,A
B3:00EFA7 22                RET      
----- FUNCTION ?L?COM03F0 (END) -------


----- FUNCTION ?L?COM0408 (BEGIN) -----
B3:00EFA8 904396            MOV      DPTR,#support
B3:00EFAB F0                MOVX     @DPTR,A
B3:00EFAC E0                MOVX     A,@DPTR
B3:00EFAD FF                MOV      R7,A
B3:00EFAE 14                DEC      A
B3:00EFAF FE                MOV      R6,A
B3:00EFB0 EF                MOV      A,R7
B3:00EFB1 5E                ANL      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1123


B3:00EFB2 22                RET      
----- FUNCTION ?L?COM0408 (END) -------


----- FUNCTION ?L?COM041B (BEGIN) -----
B3:00EFB3 E9                MOV      A,R1
B3:00EFB4 2411              ADD      A,#011H
B3:00EFB6 F9                MOV      R1,A
B3:00EFB7 E4                CLR      A
B3:00EFB8 3A                ADDC     A,R2
B3:00EFB9 FA                MOV      R2,A
B3:00EFBA 22                RET      
----- FUNCTION ?L?COM041B (END) -------


----- FUNCTION ?L?COM044E (BEGIN) -----
B3:00EFBB 7B01              MOV      R3,#01H
B3:00EFBD 7A23              MOV      R2,#HIGH the_context+02EFH
B3:00EFBF 7902              MOV      R1,#LOW the_context+02EFH
B3:00EFC1 0225A9            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM044E (END) -------


----- FUNCTION ?L?COM0464 (BEGIN) -----
B3:00EFC4 FE                MOV      R6,A
B3:00EFC5 C3                CLR      C
B3:00EFC6 902E0A            MOV      DPTR,#msg_len+01H
B3:00EFC9 E0                MOVX     A,@DPTR
B3:00EFCA 9F                SUBB     A,R7
B3:00EFCB 902E09            MOV      DPTR,#msg_len
B3:00EFCE E0                MOVX     A,@DPTR
B3:00EFCF 9E                SUBB     A,R6
B3:00EFD0 22                RET      
----- FUNCTION ?L?COM0464 (END) -------


----- FUNCTION ?L?COM04A7 (BEGIN) -----
B3:00EFD1 7A23              MOV      R2,#HIGH the_context+0318H
B3:00EFD3 792B              MOV      R1,#LOW the_context+0318H
B3:00EFD5 1225A9            LCALL    ?C?PSTXDATA
B3:00EFD8 7A27              MOV      R2,#HIGH shared_secret
B3:00EFDA 79FD              MOV      R1,#LOW shared_secret
B3:00EFDC 22                RET      
----- FUNCTION ?L?COM04A7 (END) -------


----- FUNCTION ?L?COM04E2 (BEGIN) -----
B3:00EFDD 903577            MOV      DPTR,#dnode
B3:00EFE0 E0                MOVX     A,@DPTR
B3:00EFE1 FF                MOV      R7,A
B3:00EFE2 903576            MOV      DPTR,#snode
B3:00EFE5 E0                MOVX     A,@DPTR
B3:00EFE6 FD                MOV      R5,A
B3:00EFE7 22                RET      
----- FUNCTION ?L?COM04E2 (END) -------


----- FUNCTION ?L?COM04E3 (BEGIN) -----
B3:00EFE8 A3                INC      DPTR
B3:00EFE9 F0                MOVX     @DPTR,A
B3:00EFEA 7A25              MOV      R2,#HIGH the_tx_session+01BH
B3:00EFEC 79B8              MOV      R1,#LOW the_tx_session+01BH
B3:00EFEE 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00EFF1 EF                MOV      A,R7
B3:00EFF2 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1124


----- FUNCTION ?L?COM04E3 (END) -------


----- FUNCTION ?L?COM04F8 (BEGIN) -----
B3:00EFF3 9035D6            MOV      DPTR,#enc_data
B3:00EFF6 022589            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04F8 (END) -------


----- FUNCTION ?L?COM0550 (BEGIN) -----
B3:00EFF9 7B01              MOV      R3,#01H
B3:00EFFB 7A09              MOV      R2,#HIGH exploreSearchResultBuffer
B3:00EFFD 795E              MOV      R1,#LOW exploreSearchResultBuffer
B3:00EFFF 0280A2            LJMP     ___ZW_memcpy
----- FUNCTION ?L?COM0550 (END) -------


----- FUNCTION ?L?COM0582 (BEGIN) -----
B3:00F002 90259E            MOV      DPTR,#the_tx_session+01H
B3:00F005 E0                MOVX     A,@DPTR
B3:00F006 FF                MOV      R7,A
B3:00F007 90259D            MOV      DPTR,#the_tx_session
B3:00F00A 22                RET      
----- FUNCTION ?L?COM0582 (END) -------


----- FUNCTION ?L?COM059E (BEGIN) -----
B3:00F00B 7F10              MOV      R7,#010H
B3:00F00D 7E27              MOV      R6,#027H
B3:00F00F 7D00              MOV      R5,#00H
B3:00F011 7C00              MOV      R4,#00H
B3:00F013 22                RET      
----- FUNCTION ?L?COM059E (END) -------


----- FUNCTION ?L?COM059F (BEGIN) -----
B3:00F014 902E71            MOV      DPTR,#ext_len
B3:00F017 E0                MOVX     A,@DPTR
B3:00F018 FF                MOV      R7,A
B3:00F019 902E6F            MOV      DPTR,#ext_data+01H
B3:00F01C 22                RET      
----- FUNCTION ?L?COM059F (END) -------


----- FUNCTION ?L?COM05A9 (BEGIN) -----
B3:00F01D 903576            MOV      DPTR,#snode
B3:00F020 E0                MOVX     A,@DPTR
B3:00F021 FF                MOV      R7,A
B3:00F022 A3                INC      DPTR
B3:00F023 E0                MOVX     A,@DPTR
B3:00F024 FD                MOV      R5,A
B3:00F025 22                RET      
----- FUNCTION ?L?COM05A9 (END) -------


----- FUNCTION ?L?COM0601 (BEGIN) -----
B3:00F026 900025            MOV      DPTR,#025H
B3:00F029 E4                CLR      A
B3:00F02A 022084            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0601 (END) -------


----- FUNCTION ?L?COM0612 (BEGIN) -----
B3:00F02D 122072            LCALL    ?C?CSTPTR
B3:00F030 900A6F            MOV      DPTR,#bDataLength
LX51 LINKER/LOCATER V4.66.41.0                                                        11/02/2021  02:45:12  PAGE 1125


B3:00F033 E0                MOVX     A,@DPTR
B3:00F034 22                RET      
----- FUNCTION ?L?COM0612 (END) -------



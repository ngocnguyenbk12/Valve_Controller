LX51 LINKER/LOCATER V4.66.41.0                                                          12/14/2021  16:17:53  PAGE 1





ASSEMBLER CODE PACKING OF MODULE:  .\BUILD\SERIALAPI_SLAVE_ENHANCED_232_OTW_ZW050X_RELS\SERIALAPI_SLAVE_ENHANCED_232_OTW
>> _ZW050X_US.AOF (APP_RFSETUP)


001823 02685E            LJMP     0685EH
00182B 02586D            LJMP     0586DH
00184B 025454            LJMP     05454H
----- FUNCTION _ZW_Version (BEGIN) -----
;---- Variable 'dst' assigned to Register 'R6/R7' ----
;---- Variable 'offset' assigned to Register 'R5' ----
00309E E4                CLR      A
00309F FD                MOV      R5,A
;---- Variable 'length' assigned to Register 'R4' ----
0030A0 7C0C              MOV      R4,#0CH
0030A2         ?C0003?ZW_VERSION:
0030A2 AB05              MOV      R3,AR5
0030A4 0D                INC      R5
0030A5 EB                MOV      A,R3
0030A6 9018F1            MOV      DPTR,#ZW_basis_version
0030A9 93                MOVC     A,@A+DPTR
0030AA 8F82              MOV      DPL,R7
0030AC 8E83              MOV      DPH,R6
0030AE F0                MOVX     @DPTR,A
0030AF 0F                INC      R7
0030B0 BF0001            CJNE     R7,#00H,?C0006?ZW_VERSION
0030B3 0E                INC      R6
0030B4         ?C0006?ZW_VERSION:
0030B4 DCEC              DJNZ     R4,?C0003?ZW_VERSION
;----                  JMP      ZW_Type_Library
----- FUNCTION _ZW_Version (END) -------


----- FUNCTION ZW_Type_Library (BEGIN) -----
0030B6 7F03              MOV      R7,#03H
0030B8 22                RET      
----- FUNCTION ZW_Type_Library (END) -------


----- FUNCTION _ZW_GetProtocolVersion (BEGIN) -----
;---- Variable 'dst' assigned to Register 'R6/R7' ----
0030B9 8F82              MOV      DPL,R7
0030BB 8E83              MOV      DPH,R6
0030BD E4                CLR      A
0030BE F0                MOVX     @DPTR,A
0030BF A3                INC      DPTR
0030C0 7406              MOV      A,#06H
0030C2 F0                MOVX     @DPTR,A
0030C3 8F82              MOV      DPL,R7
0030C5 8E83              MOV      DPH,R6
0030C7 A3                INC      DPTR
0030C8 A3                INC      DPTR
0030C9 740A              MOV      A,#0AH
0030CB F0                MOVX     @DPTR,A
0030CC 11E0              ACALL    ?L?COM0581
0030CE E4                CLR      A
0030CF F0                MOVX     @DPTR,A
0030D0 EF                MOV      A,R7
0030D1 2404              ADD      A,#04H
0030D3 F582              MOV      DPL,A
0030D5 E4                CLR      A
0030D6 3E                ADDC     A,R6
0030D7 F583              MOV      DPH,A
0030D9 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 2


0030DA F0                MOVX     @DPTR,A
0030DB A3                INC      DPTR
0030DC 746D              MOV      A,#06DH
0030DE F0                MOVX     @DPTR,A
0030DF 22                RET      
----- FUNCTION _ZW_GetProtocolVersion (END) -------


----- FUNCTION ?L?COM0581 (BEGIN) -----
0030E0 8F82              MOV      DPL,R7
0030E2 8E83              MOV      DPH,R6
0030E4 A3                INC      DPTR
0030E5 A3                INC      DPTR
0030E6 A3                INC      DPTR
0030E7 22                RET      
----- FUNCTION ?L?COM0581 (END) -------


----- FUNCTION _main_SetSystemType (BEGIN) -----
;---- Variable 'bAppType' assigned to Register 'R5' ----
0030E8 AD07              MOV      R5,AR7
0030EA 901217            MOV      DPTR,#eSystemTypeState
0030ED E0                MOVX     A,@DPTR
0030EE 54FC              ANL      A,#0FCH
0030F0 F0                MOVX     @DPTR,A
0030F1 E0                MOVX     A,@DPTR
0030F2 FF                MOV      R7,A
0030F3 ED                MOV      A,R5
0030F4 5430              ANL      A,#030H
0030F6 7E00              MOV      R6,#00H
0030F8 6002              JZ       ?C0002?ZW_MAIN
0030FA 7E02              MOV      R6,#02H
0030FC         ?C0002?ZW_MAIN:
0030FC         ?C0003?ZW_MAIN:
0030FC EF                MOV      A,R7
0030FD 4E                ORL      A,R6
0030FE 901217            MOV      DPTR,#eSystemTypeState
003101 F0                MOVX     @DPTR,A
003102 E0                MOVX     A,@DPTR
003103 FF                MOV      R7,A
003104 ED                MOV      A,R5
003105 7E00              MOV      R6,#00H
003107 30E002            JNB      ACC.0,?C0004?ZW_MAIN
00310A 7E01              MOV      R6,#01H
00310C         ?C0004?ZW_MAIN:
00310C         ?C0005?ZW_MAIN:
00310C EF                MOV      A,R7
00310D 4E                ORL      A,R6
00310E 901217            MOV      DPTR,#eSystemTypeState
003111 F0                MOVX     @DPTR,A
003112 22                RET      
----- FUNCTION _main_SetSystemType (END) -------


----- FUNCTION CallApplicationInitSW (BEGIN) -----
003113 9003C9            MOV      DPTR,#bStartupState
003116 7402              MOV      A,#02H
003118 F0                MOVX     @DPTR,A
003119 9003C0            MOV      DPTR,#mNvmLayout
00311C E0                MOVX     A,@DPTR
00311D FF                MOV      R7,A
00311E 121E53            LCALL    ?INTERBANK_TABLE?_ApplicationInitSW
003121 11E8              ACALL    _main_SetSystemType
003123 9003C9            MOV      DPTR,#bStartupState
003126 7405              MOV      A,#05H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 3


003128 F0                MOVX     @DPTR,A
003129 22                RET      
----- FUNCTION CallApplicationInitSW (END) -------


----- FUNCTION main (BEGIN) -----
00312A 75FF02            MOV      SFRPAGE,#02H
00312D 75E404            MOV      WDTCON,#04H
003130 E4                CLR      A
003131 F5E4              MOV      WDTCON,A
003133 1270A4            LCALL    ?L?COM059A
003136 C3                CLR      C
003137 30E001            JNB      ACC.0,?C0084?ZW_MAIN
00313A D3                SETB     C
00313B         ?C0084?ZW_MAIN:
00313B         ?C0085?ZW_MAIN:
00313B 4017              JC       ?C0083?ZW_MAIN
00313D E5E6              MOV      A,RSETVEC
00313F 30E012            JNB      ACC.0,?C0083?ZW_MAIN
003142 901217            MOV      DPTR,#eSystemTypeState
003145 E0                MOVX     A,@DPTR
003146 540C              ANL      A,#0CH
003148 600A              JZ       ?C0083?ZW_MAIN
00314A 121C0A            LCALL    ?INTERBANK_TABLE?Power_Management_Check
00314D 901217            MOV      DPTR,#eSystemTypeState
003150 E0                MOVX     A,@DPTR
003151 54F7              ANL      A,#0F7H
003153 F0                MOVX     @DPTR,A
003154         ?C0083?ZW_MAIN:
003154 C218              CLR      RF_WakeupReceived
003156 1270A4            LCALL    ?L?COM059A
003159 30E039            JNB      ACC.0,?C0086?ZW_MAIN
00315C E5E6              MOV      A,RSETVEC
00315E 5403              ANL      A,#03H
003160 6401              XRL      A,#01H
003162 7031              JNZ      ?C0086?ZW_MAIN
003164 121A39            LCALL    ?INTERBANK_TABLE?RFDriverInitHWFLiRS
003167 125711            LCALL    RF_WaitForBeam
00316A 401F              JC       ?C0087?ZW_MAIN
00316C 90123F            MOV      DPTR,#bBeamCountWakeup
00316F E0                MOVX     A,@DPTR
003170 600B              JZ       ?C0088?ZW_MAIN
003172 E0                MOVX     A,@DPTR
003173 14                DEC      A
003174 F0                MOVX     @DPTR,A
003175 7006              JNZ      ?C0088?ZW_MAIN
003177 122E10            LCALL    ZW_ram_clear
00317A 126EE5            LCALL    ?L?COM036F
00317D         ?C0088?ZW_MAIN:
00317D 901215            MOV      DPTR,#bFLiRSStatus
003180 E0                MOVX     A,@DPTR
003181 20E002            JB       ACC.0,$ + 5H
003184 4123              AJMP     ?C0092?ZW_MAIN
003186 1248B7            LCALL    GoToSleep
003189 4123              AJMP     ?C0092?ZW_MAIN
00318B         ?C0087?ZW_MAIN:
00318B 122E10            LCALL    ZW_ram_clear
00318E D218              SETB     RF_WakeupReceived
003190 126EE5            LCALL    ?L?COM036F
003193 4123              AJMP     ?C0092?ZW_MAIN
003195         ?C0086?ZW_MAIN:
003195 122E10            LCALL    ZW_ram_clear
003198 125FEA            LCALL    Reset_GetReset
00319B 9003C2            MOV      DPTR,#bMainWakeUpReason
00319E EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 4


00319F F0                MOVX     @DPTR,A
0031A0 901200            MOV      DPTR,#criticalMemMagic1
0031A3 E0                MOVX     A,@DPTR
0031A4 B47A14            CJNE     A,#07AH,?C0094?ZW_MAIN
0031A7 901214            MOV      DPTR,#criticalMemMagic2
0031AA E0                MOVX     A,@DPTR
0031AB B49C0D            CJNE     A,#09CH,?C0094?ZW_MAIN
0031AE 9003C2            MOV      DPTR,#bMainWakeUpReason
0031B1 E0                MOVX     A,@DPTR
0031B2 FF                MOV      R7,A
0031B3 6405              XRL      A,#05H
0031B5 6004              JZ       ?C0094?ZW_MAIN
0031B7 EF                MOV      A,R7
0031B8 B40330            CJNE     A,#03H,?C0093?ZW_MAIN
0031BB         ?C0094?ZW_MAIN:
0031BB E4                CLR      A
0031BC 9003C8            MOV      DPTR,#tmpMain
0031BF F0                MOVX     @DPTR,A
0031C0         ?C0095?ZW_MAIN:
0031C0 9003C8            MOV      DPTR,#tmpMain
0031C3 E0                MOVX     A,@DPTR
0031C4 FF                MOV      R7,A
0031C5 C3                CLR      C
0031C6 9480              SUBB     A,#080H
0031C8 5013              JNC      ?C0096?ZW_MAIN
0031CA E4                CLR      A
0031CB 2F                ADD      A,R7
0031CC F582              MOV      DPL,A
0031CE E4                CLR      A
0031CF 3412              ADDC     A,#012H
0031D1 F583              MOV      DPH,A
0031D3 E4                CLR      A
0031D4 F0                MOVX     @DPTR,A
0031D5 9003C8            MOV      DPTR,#tmpMain
0031D8 E0                MOVX     A,@DPTR
0031D9 04                INC      A
0031DA F0                MOVX     @DPTR,A
0031DB 80E3              SJMP     ?C0095?ZW_MAIN
0031DD         ?C0096?ZW_MAIN:
0031DD 901200            MOV      DPTR,#criticalMemMagic1
0031E0 747A              MOV      A,#07AH
0031E2 F0                MOVX     @DPTR,A
0031E3 901214            MOV      DPTR,#criticalMemMagic2
0031E6 749C              MOV      A,#09CH
0031E8 F0                MOVX     @DPTR,A
0031E9 D214              SETB     criticalCleared
0031EB         ?C0093?ZW_MAIN:
0031EB 121C3C            LCALL    ?INTERBANK_TABLE?ZW_IsNVRValid
0031EE 4003              JC       ?C0098?ZW_MAIN
0031F0 121C37            LCALL    ?INTERBANK_TABLE?ZW_NVRCheck
0031F3         ?C0098?ZW_MAIN:
0031F3 7B01              MOV      R3,#01H
0031F5 7A12              MOV      R2,#HIGH phyRfData+0FH
0031F7 7910              MOV      R1,#LOW phyRfData+0FH
0031F9 7D01              MOV      R5,#01H
0031FB 7F01              MOV      R7,#01H
0031FD 121C32            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
003200 7B01              MOV      R3,#01H
003202 7A12              MOV      R2,#HIGH phyRfData+010H
003204 7911              MOV      R1,#LOW phyRfData+010H
003206 7D01              MOV      R5,#01H
003208 7F21              MOV      R7,#021H
00320A 121C32            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
00320D 7B01              MOV      R3,#01H
00320F 7A12              MOV      R2,#HIGH phyRfData+011H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 5


003211 7912              MOV      R1,#LOW phyRfData+011H
003213 7D01              MOV      R5,#01H
003215 7F22              MOV      R7,#022H
003217 121C32            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
00321A 7A12              MOV      R2,#HIGH bNVRUartPinSwap
00321C 7929              MOV      R1,#LOW bNVRUartPinSwap
00321E 7F02              MOV      R7,#02H
003220 126B4A            LCALL    ?L?COM042A
003223         ?C0092?ZW_MAIN:
003223 901229            MOV      DPTR,#bNVRUartPinSwap
003226 E0                MOVX     A,@DPTR
003227 B40105            CJNE     A,#01H,?C0099?ZW_MAIN
00322A 7F01              MOV      R7,#01H
00322C 126849            LCALL    _ZW_UART0_zm4102_mode_enable
00322F         ?C0099?ZW_MAIN:
00322F 121A3E            LCALL    ?INTERBANK_TABLE?RFDriverInitHW
003232 125FEA            LCALL    Reset_GetReset
003235 121A34            LCALL    ?INTERBANK_TABLE?_ZW_setSwWakeupReason
003238 9003C2            MOV      DPTR,#bMainWakeUpReason
00323B EF                MOV      A,R7
00323C F0                MOVX     @DPTR,A
00323D 12199E            LCALL    ?INTERBANK_TABLE?transportVarInit
003240 121A2F            LCALL    ?INTERBANK_TABLE?Init_ZW_HW
003243 9003C2            MOV      DPTR,#bMainWakeUpReason
003246 E0                MOVX     A,@DPTR
003247 FF                MOV      R7,A
003248 B40602            CJNE     A,#06H,?C0100?ZW_MAIN
00324B 800C              SJMP     ?C0175?ZW_MAIN
00324D         ?C0100?ZW_MAIN:
00324D 301804            JNB      RF_WakeupReceived,?C0102?ZW_MAIN
003250 7F02              MOV      R7,#02H
003252 8005              SJMP     ?C0103?ZW_MAIN
003254         ?C0102?ZW_MAIN:
003254 9003C2            MOV      DPTR,#bMainWakeUpReason
003257 E0                MOVX     A,@DPTR
003258 FF                MOV      R7,A
003259         ?C0103?ZW_MAIN:
003259         
003259 121E4E            LCALL    ?INTERBANK_TABLE?_ApplicationInitHW
00325C EF                MOV      A,R7
00325D 24FF              ADD      A,#0FFH
00325F B3                CPL      C
003260 923A              MOV      productionTest,C
003262 75FF02            MOV      SFRPAGE,#02H
003265 53E6BF            ANL      RSETVEC,#0BFH
003268         ?C0101?ZW_MAIN:
003268 123CED            LCALL    ?L?COM04D8
00326B 6003              JZ       ?C0104?ZW_MAIN
00326D 126EE5            LCALL    ?L?COM036F
003270         ?C0104?ZW_MAIN:
003270 12584A            LCALL    SysTimerInit
003273 121A48            LCALL    ?INTERBANK_TABLE?RFDriverInitSW
003276 1238AC            LCALL    Init_ZW_SW
003279 30140B            JNB      criticalCleared,?C0105?ZW_MAIN
00327C 7B01              MOV      R3,#01H
00327E 7A12              MOV      R2,#HIGH retentionRandom
003280 792B              MOV      R1,#LOW retentionRandom
003282 7D10              MOV      R5,#010H
003284 125E35            LCALL    _ZW_GetRandomArray
003287         ?C0105?ZW_MAIN:
003287 121A84            LCALL    ?INTERBANK_TABLE?security_init
00328A 901215            MOV      DPTR,#bFLiRSStatus
00328D E0                MOVX     A,@DPTR
00328E C3                CLR      C
00328F 30E001            JNB      ACC.0,?C0107?ZW_MAIN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 6


003292 D3                SETB     C
003293         ?C0107?ZW_MAIN:
003293         ?C0108?ZW_MAIN:
003293 400E              JC       ?C0106?ZW_MAIN
003295 203A0B            JB       productionTest,?C0106?ZW_MAIN
003298 3113              ACALL    CallApplicationInitSW
00329A 7B01              MOV      R3,#01H
00329C 7A33              MOV      R2,#HIGH slaveFrameBuffer
00329E 79AC              MOV      R1,#LOW slaveFrameBuffer
0032A0 1219DF            LCALL    ?INTERBANK_TABLE?_UpdateNodeInformation
0032A3         ?C0106?ZW_MAIN:
0032A3 90122A            MOV      DPTR,#bldeviceOptionsMask
0032A6 E0                MOVX     A,@DPTR
0032A7 30E002            JNB      ACC.0,?C0109?ZW_MAIN
0032AA 8003              SJMP     ?C0176?ZW_MAIN
0032AC         ?C0109?ZW_MAIN:
0032AC 301805            JNB      RF_WakeupReceived,?C0110?ZW_MAIN
0032AF         
0032AF 7F01              MOV      R7,#01H
0032B1 125006            LCALL    _ZW_SetRFReceiveMode
0032B4         ?C0110?ZW_MAIN:
0032B4 D2AF              SETB     EA
0032B6 203A02            JB       productionTest,$ + 5H
0032B9 6143              AJMP     ?C0133?ZW_MAIN
0032BB         ?C0113?ZW_MAIN:
0032BB 121C55            LCALL    ?INTERBANK_TABLE?TransportTimerPoll
0032BE 124524            LCALL    TimerAction
0032C1 121E49            LCALL    ?INTERBANK_TABLE?ApplicationTestPoll
0032C4 121C2D            LCALL    ?INTERBANK_TABLE?SendProdTestCarrier
0032C7 40F2              JC       ?C0113?ZW_MAIN
0032C9 9003C1            MOV      DPTR,#sleepMode
0032CC E0                MOVX     A,@DPTR
0032CD 6042              JZ       ?C0116?ZW_MAIN
0032CF 121A66            LCALL    ?INTERBANK_TABLE?TxQueueIsEmpty
0032D2 EF                MOV      A,R7
0032D3 7005              JNZ      ?C0119?ZW_MAIN
0032D5 125972            LCALL    ?L?COM02CF
0032D8 4037              JC       ?C0116?ZW_MAIN
0032DA         ?C0119?ZW_MAIN:
0032DA E514              MOV      A,RF_state
0032DC 70FC              JNZ      ?C0119?ZW_MAIN
0032DE         ?C0120?ZW_MAIN:
0032DE E515              MOV      A,RF_status
0032E0 20E503            JB       ACC.5,?C0122?ZW_MAIN
0032E3 1253F5            LCALL    RFPowerDown
0032E6         ?C0122?ZW_MAIN:
0032E6 121B7E            LCALL    ?INTERBANK_TABLE?ExtMemoryWriteBusy
0032E9 EF                MOV      A,R7
0032EA 70FA              JNZ      ?C0122?ZW_MAIN
0032EC         ?C0123?ZW_MAIN:
0032EC 125F20            LCALL    ZW_BootloaderPresent
0032EF 5005              JNC      ?C0125?ZW_MAIN
0032F1 125F0C            LCALL    ?L?COM042D
0032F4 5004              JNC      ?C0124?ZW_MAIN
0032F6         ?C0125?ZW_MAIN:
0032F6 7F01              MOV      R7,#01H
0032F8 918A              ACALL    _NVM_ext_deeppowerdown
0032FA         ?C0124?ZW_MAIN:
0032FA 9003C1            MOV      DPTR,#sleepMode
0032FD E0                MOVX     A,@DPTR
0032FE B40204            CJNE     A,#02H,?C0126?ZW_MAIN
003301 E4                CLR      A
003302 FF                MOV      R7,A
003303 8009              SJMP     ?C0177?ZW_MAIN
003305         ?C0126?ZW_MAIN:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 7


003305 9003C1            MOV      DPTR,#sleepMode
003308 E0                MOVX     A,@DPTR
003309 B40305            CJNE     A,#03H,?C0116?ZW_MAIN
00330C 7F01              MOV      R7,#01H
00330E         
00330E 1248BC            LCALL    _ZW_power_down_mode
003311         ?C0116?ZW_MAIN:
003311 121A5C            LCALL    ?INTERBANK_TABLE?TxQueueServiceTransmit
003314 E515              MOV      A,RF_status
003316 30E1A2            JNB      ACC.1,?C0113?ZW_MAIN
003319 125D9E            LCALL    ?L?COM02F1
00331C 4002              JC       ?C0130?ZW_MAIN
00331E E4                CLR      A
00331F F0                MOVX     @DPTR,A
003320         ?C0130?ZW_MAIN:
003320 E515              MOV      A,RF_status
003322 20E505            JB       ACC.5,?C0131?ZW_MAIN
003325 9163              ACALL    ?L?COM00DA
003327 123D88            LCALL    ?L?COM0482
00332A         ?C0131?ZW_MAIN:
00332A 126E04            LCALL    ?L?COM0193
00332D AF82              MOV      R7,DPL
00332F AE83              MOV      R6,DPH
003331 EF                MOV      A,R7
003332 C0E0              PUSH     ACC
003334 9171              ACALL    ?L?COM00DB
003336 9003C4            MOV      DPTR,#receivedLength
003339 E0                MOVX     A,@DPTR
00333A FD                MOV      R5,A
00333B D0E0              POP      ACC
00333D FF                MOV      R7,A
00333E 121994            LCALL    ?INTERBANK_TABLE?_ReceiveHandler
003341 41BB              AJMP     ?C0113?ZW_MAIN
003343         ?C0133?ZW_MAIN:
003343 1257EA            LCALL    ProtocolMonitor
003346 1248E0            LCALL    NewIDNeeded
003349 5003              JNC      ?C0135?ZW_MAIN
00334B 124900            LCALL    NewIDCreate
00334E         ?C0135?ZW_MAIN:
00334E 9181              ACALL    main_ProtocolStateIsShutdownPending
003350 EF                MOV      A,R7
003351 7006              JNZ      ?C0137?ZW_MAIN
003353 9003C1            MOV      DPTR,#sleepMode
003356 E0                MOVX     A,@DPTR
003357 6053              JZ       ?C0136?ZW_MAIN
003359         ?C0137?ZW_MAIN:
003359 903315            MOV      DPTR,#assignState
00335C E0                MOVX     A,@DPTR
00335D 704D              JNZ      ?C0136?ZW_MAIN
00335F 121A66            LCALL    ?INTERBANK_TABLE?TxQueueIsEmpty
003362 EF                MOV      A,R7
003363 7005              JNZ      ?C0140?ZW_MAIN
003365 125972            LCALL    ?L?COM02CF
003368 4042              JC       ?C0136?ZW_MAIN
00336A         ?C0140?ZW_MAIN:
00336A E514              MOV      A,RF_state
00336C 70FC              JNZ      ?C0140?ZW_MAIN
00336E         ?C0141?ZW_MAIN:
00336E E515              MOV      A,RF_status
003370 20E503            JB       ACC.5,?C0142?ZW_MAIN
003373 1253F5            LCALL    RFPowerDown
003376         ?C0142?ZW_MAIN:
003376 121CC3            LCALL    ?INTERBANK_TABLE?s2_save_spans_and_mpans
003379         ?C0143?ZW_MAIN:
003379 121B7E            LCALL    ?INTERBANK_TABLE?ExtMemoryWriteBusy
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 8


00337C EF                MOV      A,R7
00337D 70FA              JNZ      ?C0143?ZW_MAIN
00337F         ?C0144?ZW_MAIN:
00337F 125F20            LCALL    ZW_BootloaderPresent
003382 5005              JNC      ?C0146?ZW_MAIN
003384 125F0C            LCALL    ?L?COM042D
003387 5004              JNC      ?C0145?ZW_MAIN
003389         ?C0146?ZW_MAIN:
003389 7F01              MOV      R7,#01H
00338B 918A              ACALL    _NVM_ext_deeppowerdown
00338D         ?C0145?ZW_MAIN:
00338D 9003C1            MOV      DPTR,#sleepMode
003390 E0                MOVX     A,@DPTR
003391 7011              JNZ      ?C0147?ZW_MAIN
003393 9181              ACALL    main_ProtocolStateIsShutdownPending
003395 EF                MOV      A,R7
003396 600C              JZ       ?C0147?ZW_MAIN
003398 124021            LCALL    main_ProtocolStateSetShutdownReady
00339B 901217            MOV      DPTR,#eSystemTypeState
00339E E0                MOVX     A,@DPTR
00339F 4408              ORL      A,#08H
0033A1 F0                MOVX     @DPTR,A
0033A2 8008              SJMP     ?C0136?ZW_MAIN
0033A4         ?C0147?ZW_MAIN:
0033A4 9003C1            MOV      DPTR,#sleepMode
0033A7 E0                MOVX     A,@DPTR
0033A8 FF                MOV      R7,A
0033A9 121C05            LCALL    ?INTERBANK_TABLE?_Power_Management_PowerDown
0033AC         ?C0136?ZW_MAIN:
0033AC 121C55            LCALL    ?INTERBANK_TABLE?TransportTimerPoll
0033AF 124524            LCALL    TimerAction
0033B2 121C1E            LCALL    ?INTERBANK_TABLE?SampleNoiseLevel
0033B5 123FFB            LCALL    main_ApplicationStateUpdate
0033B8 124009            LCALL    main_ApplicationStateIsActive
0033BB EF                MOV      A,R7
0033BC 7023              JNZ      ?C0149?ZW_MAIN
0033BE 124036            LCALL    main_ProtocolStateIsReadyForShutdown
0033C1 EF                MOV      A,R7
0033C2 6005              JZ       ?C0150?ZW_MAIN
0033C4 121C0A            LCALL    ?INTERBANK_TABLE?Power_Management_Check
0033C7 8038              SJMP     ?C0155?ZW_MAIN
0033C9         ?C0150?ZW_MAIN:
0033C9 9181              ACALL    main_ProtocolStateIsShutdownPending
0033CB EF                MOV      A,R7
0033CC 7033              JNZ      ?C0155?ZW_MAIN
0033CE 125F4F            LCALL    NetworkManagementLearnActive
0033D1 EF                MOV      A,R7
0033D2 702D              JNZ      ?C0155?ZW_MAIN
0033D4 1247F4            LCALL    main_PowerDown_ReadyCheck
0033D7 EF                MOV      A,R7
0033D8 6401              XRL      A,#01H
0033DA 7025              JNZ      ?C0155?ZW_MAIN
0033DC 12401A            LCALL    main_ProtocolStateSetShutdownPending
0033DF 8020              SJMP     ?C0155?ZW_MAIN
0033E1         ?C0149?ZW_MAIN:
0033E1 901217            MOV      DPTR,#eSystemTypeState
0033E4 E0                MOVX     A,@DPTR
0033E5 20E219            JB       ACC.2,?C0155?ZW_MAIN
0033E8 124036            LCALL    main_ProtocolStateIsReadyForShutdown
0033EB EF                MOV      A,R7
0033EC 600E              JZ       ?C0157?ZW_MAIN
0033EE 125F20            LCALL    ZW_BootloaderPresent
0033F1 5005              JNC      ?C0159?ZW_MAIN
0033F3 125F0C            LCALL    ?L?COM042D
0033F6 5004              JNC      ?C0157?ZW_MAIN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 9


0033F8         ?C0159?ZW_MAIN:
0033F8 E4                CLR      A
0033F9 FF                MOV      R7,A
0033FA 918A              ACALL    _NVM_ext_deeppowerdown
0033FC         ?C0157?ZW_MAIN:
0033FC E4                CLR      A
0033FD 9003C7            MOV      DPTR,#eProtocolState
003400 F0                MOVX     @DPTR,A
003401         ?C0155?ZW_MAIN:
003401 201505            JB       bPauseEnabled,?C0160?ZW_MAIN
003404 121A5C            LCALL    ?INTERBANK_TABLE?TxQueueServiceTransmit
003407 8022              SJMP     ?C0161?ZW_MAIN
003409         ?C0160?ZW_MAIN:
003409 12593A            LCALL    getTickTime
;---- Variable 'bCurrentTickTime' assigned to Register 'R7' ----
00340C 9003BA            MOV      DPTR,#bPauseTransmitCountdown
00340F E0                MOVX     A,@DPTR
003410 FE                MOV      R6,A
003411 EF                MOV      A,R7
003412 C3                CLR      C
003413 9E                SUBB     A,R6
003414 4005              JC       ?C0163?ZW_MAIN
003416 EF                MOV      A,R7
003417 9E                SUBB     A,R6
003418 FF                MOV      R7,A
003419 8008              SJMP     ?C0164?ZW_MAIN
00341B         ?C0163?ZW_MAIN:
00341B 9003BA            MOV      DPTR,#bPauseTransmitCountdown
00341E E0                MOVX     A,@DPTR
00341F F4                CPL      A
003420 04                INC      A
003421 2F                ADD      A,R7
003422 FF                MOV      R7,A
003423         ?C0164?ZW_MAIN:
003423 7406              MOV      A,#06H
003425 D3                SETB     C
003426 9F                SUBB     A,R7
003427 5002              JNC      ?C0161?ZW_MAIN
003429 C215              CLR      bPauseEnabled
00342B         ?C0161?ZW_MAIN:
00342B E515              MOV      A,RF_status
00342D 30E128            JNB      ACC.1,?C0165?ZW_MAIN
003430 125D9E            LCALL    ?L?COM02F1
003433 4002              JC       ?C0166?ZW_MAIN
003435 E4                CLR      A
003436 F0                MOVX     @DPTR,A
003437         ?C0166?ZW_MAIN:
003437 E515              MOV      A,RF_status
003439 20E505            JB       ACC.5,?C0167?ZW_MAIN
00343C 9163              ACALL    ?L?COM00DA
00343E 123D88            LCALL    ?L?COM0482
003441         ?C0167?ZW_MAIN:
003441 126E04            LCALL    ?L?COM0193
003444 AF82              MOV      R7,DPL
003446 AE83              MOV      R6,DPH
003448 EF                MOV      A,R7
003449 C0E0              PUSH     ACC
00344B 9171              ACALL    ?L?COM00DB
00344D 9003C4            MOV      DPTR,#receivedLength
003450 E0                MOVX     A,@DPTR
003451 FD                MOV      R5,A
003452 D0E0              POP      ACC
003454 FF                MOV      R7,A
003455 121994            LCALL    ?INTERBANK_TABLE?_ReceiveHandler
003458         ?C0165?ZW_MAIN:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 10


003458 121BD3            LCALL    ?INTERBANK_TABLE?ExploreMachine
00345B 121A70            LCALL    ?INTERBANK_TABLE?runCycle
00345E 125838            LCALL    TaskPoll
003461 6143              AJMP     ?C0133?ZW_MAIN
----- FUNCTION main (END) -------


----- FUNCTION ?L?COM00DA (BEGIN) -----
003463 9003C3            MOV      DPTR,#currentRxBuffer
003466 E0                MOVX     A,@DPTR
003467 FD                MOV      R5,A
003468 75F0AA            MOV      B,#0AAH
00346B 9003CD            MOV      DPTR,#frameBuffer
00346E 122546            LCALL    ?C?OFFXADD
003471         ?L?COM00DB:
003471 ED                MOV      A,R5
003472 75F002            MOV      B,#02H
003475 A4                MUL      AB
003476 24BC              ADD      A,#LOW rssiBuffer
003478 F9                MOV      R1,A
003479 7403              MOV      A,#HIGH rssiBuffer
00347B 35F0              ADDC     A,B
00347D FA                MOV      R2,A
00347E 7B01              MOV      R3,#01H
003480 22                RET      
----- FUNCTION ?L?COM00DA (END) -------


----- FUNCTION main_ProtocolStateIsShutdownPending (BEGIN) -----
003481 12402F            LCALL    ?L?COM04D9
003484 B40102            CJNE     A,#01H,?C0017?ZW_MAIN
003487 7F01              MOV      R7,#01H
003489         ?C0017?ZW_MAIN:
003489 22                RET      
----- FUNCTION main_ProtocolStateIsShutdownPending (END) -------


----- FUNCTION _NVM_ext_deeppowerdown (BEGIN) -----
00348A 904673            MOV      DPTR,#bDeepPowerdown
00348D EF                MOV      A,R7
00348E F0                MOVX     @DPTR,A
00348F E4                CLR      A
003490 A3                INC      DPTR
003491 F0                MOVX     @DPTR,A
003492 90415C            MOV      DPTR,#NVRbNVMType
003495 E0                MOVX     A,@DPTR
003496 FF                MOV      R7,A
003497 B4020A            CJNE     A,#02H,?C0056?ZW_PHY_GENERIC_SPI_IF
00349A 740F              MOV      A,#0FH
00349C 127094            LCALL    ?L?COM0594
00349F 74B9              MOV      A,#0B9H
0034A1 F0                MOVX     @DPTR,A
0034A2 800D              SJMP     ?C0057?ZW_PHY_GENERIC_SPI_IF
0034A4         ?C0056?ZW_PHY_GENERIC_SPI_IF:
0034A4 EF                MOV      A,R7
0034A5 6404              XRL      A,#04H
0034A7 7044              JNZ      ?C0060?ZW_PHY_GENERIC_SPI_IF
0034A9 743D              MOV      A,#03DH
0034AB 127094            LCALL    ?L?COM0594
0034AE 7479              MOV      A,#079H
0034B0 F0                MOVX     @DPTR,A
0034B1         ?C0057?ZW_PHY_GENERIC_SPI_IF:
0034B1 7F01              MOV      R7,#01H
0034B3 D1C2              ACALL    _ZW_SPI1_enable
0034B5 F15B              ACALL    NVM_CS_enable
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 11


0034B7 904673            MOV      DPTR,#bDeepPowerdown
0034BA E0                MOVX     A,@DPTR
0034BB 6007              JZ       ?C0061?ZW_PHY_GENERIC_SPI_IF
0034BD 90415B            MOV      DPTR,#deepPowerdown
0034C0 E0                MOVX     A,@DPTR
0034C1 FF                MOV      R7,A
0034C2 8002              SJMP     ?C0062?ZW_PHY_GENERIC_SPI_IF
0034C4         ?C0061?ZW_PHY_GENERIC_SPI_IF:
0034C4 7FAB              MOV      R7,#0ABH
0034C6         ?C0062?ZW_PHY_GENERIC_SPI_IF:
0034C6 91F2              ACALL    _ZW_SPI1_tx_set
0034C8 D13E              ACALL    NVM_CS_disable
0034CA 904673            MOV      DPTR,#bDeepPowerdown
0034CD E0                MOVX     A,@DPTR
0034CE 90415B            MOV      DPTR,#deepPowerdown
0034D1 F0                MOVX     @DPTR,A
0034D2 7015              JNZ      ?C0063?ZW_PHY_GENERIC_SPI_IF
0034D4         ?C0064?ZW_PHY_GENERIC_SPI_IF:
0034D4 904674            MOV      DPTR,#x
0034D7 E0                MOVX     A,@DPTR
0034D8 D3                SETB     C
0034D9 9400              SUBB     A,#00H
0034DB 400C              JC       ?C0063?ZW_PHY_GENERIC_SPI_IF
0034DD 7FFF              MOV      R7,#0FFH
0034DF 91F2              ACALL    _ZW_SPI1_tx_set
0034E1 904674            MOV      DPTR,#x
0034E4 E0                MOVX     A,@DPTR
0034E5 14                DEC      A
0034E6 F0                MOVX     @DPTR,A
0034E7 80EB              SJMP     ?C0064?ZW_PHY_GENERIC_SPI_IF
0034E9         ?C0063?ZW_PHY_GENERIC_SPI_IF:
0034E9 E4                CLR      A
0034EA FF                MOV      R7,A
0034EB D1C2              ACALL    _ZW_SPI1_enable
0034ED         ?C0060?ZW_PHY_GENERIC_SPI_IF:
0034ED 22                RET      
----- FUNCTION _NVM_ext_deeppowerdown (END) -------


----- FUNCTION ?L?COM0429 (BEGIN) -----
0034EE 122462            LCALL    ?C?LLDXDATA
0034F1 E4                CLR      A
----- FUNCTION _ZW_SPI1_tx_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
0034F2         ?C0015?ZW_PHY_SPI1_050X:
0034F2 E5C8              MOV      A,SPISTAT
0034F4 20E2FB            JB       ACC.2,?C0015?ZW_PHY_SPI1_050X
0034F7         ?C0016?ZW_PHY_SPI1_050X:
0034F7 8FEB              MOV      SPI1DATA,R7
0034F9 22                RET      
----- FUNCTION _ZW_SPI1_tx_set (END) -------


----- FUNCTION NVM_read_id (BEGIN) -----
0034FA 7F01              MOV      R7,#01H
0034FC D1C2              ACALL    _ZW_SPI1_enable
0034FE 90469E            MOV      DPTR,#spiNVMbusy
003501 7401              MOV      A,#01H
003503 F0                MOVX     @DPTR,A
003504         ?C0045?ZW_PHY_GENERIC_SPI_IF:
003504 90469E            MOV      DPTR,#spiNVMbusy
003507 E0                MOVX     A,@DPTR
003508 602F              JZ       ?C0046?ZW_PHY_GENERIC_SPI_IF
00350A F1E0              ACALL    ?L?COM0523
00350C B186              ACALL    ?L?COM00E0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 12


00350E 90469E            MOV      DPTR,#spiNVMbusy
003511 EF                MOV      A,R7
003512 F0                MOVX     @DPTR,A
003513 D13E              ACALL    NVM_CS_disable
003515 B175              ACALL    ?L?COM00DE
003517 90414F            MOV      DPTR,#spiNVMstatus2
00351A EF                MOV      A,R7
00351B F0                MOVX     @DPTR,A
00351C D13E              ACALL    NVM_CS_disable
00351E 90469E            MOV      DPTR,#spiNVMbusy
003521 E0                MOVX     A,@DPTR
003522 5401              ANL      A,#01H
003524 12708C            LCALL    ?L?COM0592
003527 60DB              JZ       ?C0045?ZW_PHY_GENERIC_SPI_IF
003529 A3                INC      DPTR
00352A E0                MOVX     A,@DPTR
00352B F4                CPL      A
00352C 60D6              JZ       ?C0045?ZW_PHY_GENERIC_SPI_IF
00352E EF                MOV      A,R7
00352F 30E7D2            JNB      ACC.7,?C0045?ZW_PHY_GENERIC_SPI_IF
003532 E4                CLR      A
003533 90469E            MOV      DPTR,#spiNVMbusy
003536 F0                MOVX     @DPTR,A
003537 80CB              SJMP     ?C0045?ZW_PHY_GENERIC_SPI_IF
003539         ?C0046?ZW_PHY_GENERIC_SPI_IF:
003539 F15B              ACALL    NVM_CS_enable
00353B 7F9F              MOV      R7,#09FH
00353D 91F2              ACALL    _ZW_SPI1_tx_set
00353F B186              ACALL    ?L?COM00E0
003541 904150            MOV      DPTR,#manufacturerID
003544 B184              ACALL    ?L?COM00DF
003546 904155            MOV      DPTR,#memoryType
003549 B184              ACALL    ?L?COM00DF
00354B 904156            MOV      DPTR,#memoryCapacity
00354E EF                MOV      A,R7
00354F F0                MOVX     @DPTR,A
003550 D1BE              ACALL    ?L?COM026D
003552 90414E            MOV      DPTR,#spiNVMstatus1
003555 E0                MOVX     A,@DPTR
003556 F4                CPL      A
003557 601B              JZ       ?C0049?ZW_PHY_GENERIC_SPI_IF
003559 A3                INC      DPTR
00355A E0                MOVX     A,@DPTR
00355B F4                CPL      A
00355C 6016              JZ       ?C0049?ZW_PHY_GENERIC_SPI_IF
00355E 904155            MOV      DPTR,#memoryType
003561 E0                MOVX     A,@DPTR
003562 FD                MOV      R5,A
003563 541F              ANL      A,#01FH
003565 240F              ADD      A,#0FH
003567 A3                INC      DPTR
003568 F0                MOVX     @DPTR,A
003569 ED                MOV      A,R5
00356A C4                SWAP     A
00356B 13                RRC      A
00356C 5407              ANL      A,#07H
00356E 4480              ORL      A,#080H
003570 904155            MOV      DPTR,#memoryType
003573 F0                MOVX     @DPTR,A
003574         ?C0049?ZW_PHY_GENERIC_SPI_IF:
003574 22                RET      
----- FUNCTION NVM_read_id (END) -------


----- FUNCTION ?L?COM00DE (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 13


003575 F15B              ACALL    NVM_CS_enable
003577 7FD7              MOV      R7,#0D7H
003579 91F2              ACALL    _ZW_SPI1_tx_set
00357B 7FFF              MOV      R7,#0FFH
00357D 91F2              ACALL    _ZW_SPI1_tx_set
00357F B18A              ACALL    ZW_SPI1_rx_get
003581 90414E            MOV      DPTR,#spiNVMstatus1
003584         ?L?COM00DF:
003584 EF                MOV      A,R7
003585 F0                MOVX     @DPTR,A
003586         ?L?COM00E0:
003586 7FFF              MOV      R7,#0FFH
003588 91F2              ACALL    _ZW_SPI1_tx_set
----- FUNCTION ZW_SPI1_rx_get (BEGIN) -----
00358A         ?C0012?ZW_PHY_SPI1_050X:
00358A E5C8              MOV      A,SPISTAT
00358C 20E2FB            JB       ACC.2,?C0012?ZW_PHY_SPI1_050X
00358F         ?C0013?ZW_PHY_SPI1_050X:
;---- Variable 'tmp' assigned to Register 'R7' ----
00358F AFEB              MOV      R7,SPI1DATA
003591 22                RET      
----- FUNCTION ZW_SPI1_rx_get (END) -------


----- FUNCTION NVM_ext_busy (BEGIN) -----
003592 7F01              MOV      R7,#01H
003594 D1C2              ACALL    _ZW_SPI1_enable
003596 303814            JNB      writeActive,?C0107?ZW_PHY_GENERIC_SPI_IF
003599 F1E0              ACALL    ?L?COM0523
00359B B186              ACALL    ?L?COM00E0
00359D 90469F            MOV      DPTR,#status
0035A0 EF                MOV      A,R7
0035A1 F0                MOVX     @DPTR,A
0035A2 D13E              ACALL    NVM_CS_disable
0035A4 90469F            MOV      DPTR,#status
0035A7 E0                MOVX     A,@DPTR
0035A8 20E002            JB       ACC.0,?C0107?ZW_PHY_GENERIC_SPI_IF
0035AB C238              CLR      writeActive
0035AD         ?C0107?ZW_PHY_GENERIC_SPI_IF:
0035AD 303818            JNB      writeActive,?C0109?ZW_PHY_GENERIC_SPI_IF
0035B0 B175              ACALL    ?L?COM00DE
0035B2 90414F            MOV      DPTR,#spiNVMstatus2
0035B5 EF                MOV      A,R7
0035B6 12708C            LCALL    ?L?COM0592
0035B9 600B              JZ       ?C0110?ZW_PHY_GENERIC_SPI_IF
0035BB A3                INC      DPTR
0035BC E0                MOVX     A,@DPTR
0035BD F4                CPL      A
0035BE 6006              JZ       ?C0110?ZW_PHY_GENERIC_SPI_IF
0035C0 EF                MOV      A,R7
0035C1 30E702            JNB      ACC.7,?C0110?ZW_PHY_GENERIC_SPI_IF
0035C4 C238              CLR      writeActive
0035C6         ?C0110?ZW_PHY_GENERIC_SPI_IF:
0035C6 D13E              ACALL    NVM_CS_disable
0035C8         ?C0109?ZW_PHY_GENERIC_SPI_IF:
0035C8 E4                CLR      A
0035C9 FF                MOV      R7,A
0035CA D1C2              ACALL    _ZW_SPI1_enable
0035CC A238              MOV      C,writeActive
0035CE E4                CLR      A
0035CF 33                RLC      A
0035D0 FF                MOV      R7,A
0035D1 22                RET      
----- FUNCTION NVM_ext_busy (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 14



----- FUNCTION _NVMPutArray_long (BEGIN) -----
0035D2 90429E            MOV      DPTR,#offset
0035D5 1224BA            LCALL    ?C?LSTXDATA
0035D8 9042A2            MOV      DPTR,#buf
0035DB 122572            LCALL    ?C?PSTXDATA
0035DE F1E6              ACALL    ZW_WatchDogKick
0035E0         ?C0037?ZW_PHY_GENERIC_SPI_IF:
0035E0 B192              ACALL    NVM_ext_busy
0035E2 EF                MOV      A,R7
0035E3 6005              JZ       ?C0038?ZW_PHY_GENERIC_SPI_IF
0035E5 124724            LCALL    ZW_Poll
0035E8 80F6              SJMP     ?C0037?ZW_PHY_GENERIC_SPI_IF
0035EA         ?C0038?ZW_PHY_GENERIC_SPI_IF:
0035EA F1F5              ACALL    ?L?COM0170
0035EC 6009              JZ       ?C0039?ZW_PHY_GENERIC_SPI_IF
0035EE 90429E            MOV      DPTR,#offset
0035F1 126E73            LCALL    ?L?COM02AB
0035F4 E4                CLR      A
0035F5 91F2              ACALL    _ZW_SPI1_tx_set
0035F7         ?C0039?ZW_PHY_GENERIC_SPI_IF:
0035F7 90429E            MOV      DPTR,#offset
0035FA 126E6B            LCALL    ?L?COM02AA
0035FD E4                CLR      A
0035FE 91F2              ACALL    _ZW_SPI1_tx_set
003600 90429E            MOV      DPTR,#offset
003603 122462            LCALL    ?C?LLDXDATA
003606 E4                CLR      A
003607 8026              SJMP     ?C0199?ZW_PHY_GENERIC_SPI_IF
003609         ?C0040?ZW_PHY_GENERIC_SPI_IF:
003609 9042A5            MOV      DPTR,#length
00360C 126EF4            LCALL    ?L?COM0373
00360F 6022              JZ       ?C0041?ZW_PHY_GENERIC_SPI_IF
003611 9042A2            MOV      DPTR,#buf
003614 122552            LCALL    ?C?PLDXDATA
003617 E9                MOV      A,R1
003618 4A                ORL      A,R2
003619 6012              JZ       ?C0042?ZW_PHY_GENERIC_SPI_IF
00361B 121F7C            LCALL    ?C?CLDPTR
00361E FF                MOV      R7,A
00361F 91F2              ACALL    _ZW_SPI1_tx_set
003621 9042A3            MOV      DPTR,#buf+01H
003624 E4                CLR      A
003625 75F001            MOV      B,#01H
003628 12210C            LCALL    ?C?IILDX
00362B 80DC              SJMP     ?C0040?ZW_PHY_GENERIC_SPI_IF
00362D         ?C0042?ZW_PHY_GENERIC_SPI_IF:
00362D E4                CLR      A
00362E FF                MOV      R7,A
00362F         
00362F 91F2              ACALL    _ZW_SPI1_tx_set
003631 80D6              SJMP     ?C0040?ZW_PHY_GENERIC_SPI_IF
003633         ?C0041?ZW_PHY_GENERIC_SPI_IF:
003633 D1BE              ACALL    ?L?COM026D
003635 904152            MOV      DPTR,#bNVMstatusReadDisturbed
003638 7401              MOV      A,#01H
00363A F0                MOVX     @DPTR,A
00363B 22                RET      
----- FUNCTION _NVMPutArray_long (END) -------


----- FUNCTION ?L?COM0468 (BEGIN) -----
00363C 91F2              ACALL    _ZW_SPI1_tx_set
----- FUNCTION NVM_CS_disable (BEGIN) -----
00363E         ?C0016?ZW_PHY_GENERIC_SPI_IF:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 15


00363E 126C08            LCALL    ZW_SPI1_active_get
003641 EF                MOV      A,R7
003642 70FA              JNZ      ?C0016?ZW_PHY_GENERIC_SPI_IF
003644         ?C0017?ZW_PHY_GENERIC_SPI_IF:
003644 904155            MOV      DPTR,#memoryType
003647 E0                MOVX     A,@DPTR
003648 F4                CPL      A
003649 600B              JZ       ?C0018?ZW_PHY_GENERIC_SPI_IF
00364B 90469D            MOV      DPTR,#x
00364E 7406              MOV      A,#06H
003650 F0                MOVX     @DPTR,A
003651         ?C0019?ZW_PHY_GENERIC_SPI_IF:
003651 12709C            LCALL    ?L?COM0595
003654 70FB              JNZ      ?C0019?ZW_PHY_GENERIC_SPI_IF
003656         ?C0018?ZW_PHY_GENERIC_SPI_IF:
003656 904153            MOV      DPTR,#NVRbNVMChipSelect
003659 E0                MOVX     A,@DPTR
00365A 12267F            LCALL    ?C?CCASE
00365D 3679              DW       ?C0023?ZW_PHY_GENERIC_SPI_IF
00365F 04                DB       04H
003660 3681              DW       ?C0024?ZW_PHY_GENERIC_SPI_IF
003662 14                DB       014H
003663 3686              DW       ?C0025?ZW_PHY_GENERIC_SPI_IF
003665 15                DB       015H
003666 368B              DW       ?C0026?ZW_PHY_GENERIC_SPI_IF
003668 17                DB       017H
003669 369B              DW       ?C0029?ZW_PHY_GENERIC_SPI_IF
00366B 30                DB       030H
00366C 36A0              DW       ?C0030?ZW_PHY_GENERIC_SPI_IF
00366E 34                DB       034H
00366F 36A5              DW       ?C0031?ZW_PHY_GENERIC_SPI_IF
003671 36                DB       036H
003672 36AA              DW       ?C0032?ZW_PHY_GENERIC_SPI_IF
003674 37                DB       037H
003675 0000              DW       00H
003677 3693              DW       ?C0028?ZW_PHY_GENERIC_SPI_IF
003679         ?C0023?ZW_PHY_GENERIC_SPI_IF:
003679 436C10            ORL      P0Shadow,#010H
00367C 856C80            MOV      P0,P0Shadow
00367F 802F              SJMP     ?C0022?ZW_PHY_GENERIC_SPI_IF
003681         ?C0024?ZW_PHY_GENERIC_SPI_IF:
003681 436D10            ORL      P1Shadow,#010H
003684 8008              SJMP     ?C0195?ZW_PHY_GENERIC_SPI_IF
003686         ?C0025?ZW_PHY_GENERIC_SPI_IF:
003686 436D20            ORL      P1Shadow,#020H
003689         
003689 8003              SJMP     ?C0195?ZW_PHY_GENERIC_SPI_IF
00368B         ?C0026?ZW_PHY_GENERIC_SPI_IF:
00368B 436D80            ORL      P1Shadow,#080H
00368E         
00368E 856D90            MOV      P1,P1Shadow
003691 801D              SJMP     ?C0022?ZW_PHY_GENERIC_SPI_IF
003693         ?C0028?ZW_PHY_GENERIC_SPI_IF:
003693 436E20            ORL      P2Shadow,#020H
003696 856EA0            MOV      P2,P2Shadow
003699 8015              SJMP     ?C0022?ZW_PHY_GENERIC_SPI_IF
00369B         ?C0029?ZW_PHY_GENERIC_SPI_IF:
00369B 436F01            ORL      P3Shadow,#01H
00369E 800D              SJMP     ?C0198?ZW_PHY_GENERIC_SPI_IF
0036A0         ?C0030?ZW_PHY_GENERIC_SPI_IF:
0036A0 436F10            ORL      P3Shadow,#010H
0036A3         
0036A3 8008              SJMP     ?C0198?ZW_PHY_GENERIC_SPI_IF
0036A5         ?C0031?ZW_PHY_GENERIC_SPI_IF:
0036A5 436F40            ORL      P3Shadow,#040H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 16


0036A8         
0036A8 8003              SJMP     ?C0198?ZW_PHY_GENERIC_SPI_IF
0036AA         ?C0032?ZW_PHY_GENERIC_SPI_IF:
0036AA 436F80            ORL      P3Shadow,#080H
0036AD         
0036AD 856FB0            MOV      P3,P3Shadow
0036B0         ?C0022?ZW_PHY_GENERIC_SPI_IF:
0036B0 90469D            MOV      DPTR,#x
0036B3 740C              MOV      A,#0CH
0036B5 F0                MOVX     @DPTR,A
0036B6         ?C0033?ZW_PHY_GENERIC_SPI_IF:
0036B6 12709C            LCALL    ?L?COM0595
0036B9 70FB              JNZ      ?C0033?ZW_PHY_GENERIC_SPI_IF
0036BB 22                RET      
----- FUNCTION NVM_CS_disable (END) -------


----- FUNCTION ?L?COM026C (BEGIN) -----
0036BC 91F2              ACALL    _ZW_SPI1_tx_set
0036BE         ?L?COM026D:
0036BE D13E              ACALL    NVM_CS_disable
0036C0 E4                CLR      A
0036C1 FF                MOV      R7,A
----- FUNCTION _ZW_SPI1_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
0036C2 EF                MOV      A,R7
0036C3 B40104            CJNE     A,#01H,?C0008?ZW_PHY_SPI1_050X
0036C6 43FE20            ORL      SPI1CON,#020H
0036C9 22                RET      
0036CA         ?C0008?ZW_PHY_SPI1_050X:
0036CA 53FEDF            ANL      SPI1CON,#0DFH
0036CD 22                RET      
----- FUNCTION _ZW_SPI1_enable (END) -------


----- FUNCTION _NVM_ext_write_long_byte (BEGIN) -----
0036CE 9044FB            MOV      DPTR,#offset
0036D1 1224BA            LCALL    ?C?LSTXDATA
0036D4 9044FB            MOV      DPTR,#offset
0036D7 122462            LCALL    ?C?LLDXDATA
0036DA F11B              ACALL    _NVM_ext_read_long_byte
0036DC 9044FF            MOV      DPTR,#bData
0036DF E0                MOVX     A,@DPTR
0036E0 6F                XRL      A,R7
0036E1 6036              JZ       ?C0117?ZW_PHY_GENERIC_SPI_IF
0036E3 F1E6              ACALL    ZW_WatchDogKick
0036E5         ?C0118?ZW_PHY_GENERIC_SPI_IF:
0036E5 B192              ACALL    NVM_ext_busy
0036E7 EF                MOV      A,R7
0036E8 6005              JZ       ?C0119?ZW_PHY_GENERIC_SPI_IF
0036EA 124724            LCALL    ZW_Poll
0036ED 80F6              SJMP     ?C0118?ZW_PHY_GENERIC_SPI_IF
0036EF         ?C0119?ZW_PHY_GENERIC_SPI_IF:
0036EF F1F5              ACALL    ?L?COM0170
0036F1 6009              JZ       ?C0120?ZW_PHY_GENERIC_SPI_IF
0036F3 9044FB            MOV      DPTR,#offset
0036F6 126E73            LCALL    ?L?COM02AB
0036F9 E4                CLR      A
0036FA 91F2              ACALL    _ZW_SPI1_tx_set
0036FC         ?C0120?ZW_PHY_GENERIC_SPI_IF:
0036FC 9044FB            MOV      DPTR,#offset
0036FF 126E6B            LCALL    ?L?COM02AA
003702 E4                CLR      A
003703 91F2              ACALL    _ZW_SPI1_tx_set
003705 9044FB            MOV      DPTR,#offset
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 17


003708 91EE              ACALL    ?L?COM0429
00370A 9044FF            MOV      DPTR,#bData
00370D E0                MOVX     A,@DPTR
00370E FF                MOV      R7,A
00370F D1BC              ACALL    ?L?COM026C
003711 904152            MOV      DPTR,#bNVMstatusReadDisturbed
003714 7401              MOV      A,#01H
003716 F0                MOVX     @DPTR,A
003717 D3                SETB     C
003718 22                RET      
003719         ?C0117?ZW_PHY_GENERIC_SPI_IF:
003719 C3                CLR      C
00371A 22                RET      
----- FUNCTION _NVM_ext_write_long_byte (END) -------


----- FUNCTION _NVM_ext_read_long_byte (BEGIN) -----
00371B 9044F6            MOV      DPTR,#offset
00371E 1224BA            LCALL    ?C?LSTXDATA
003721 F1E6              ACALL    ZW_WatchDogKick
003723         ?C0112?ZW_PHY_GENERIC_SPI_IF:
003723 B192              ACALL    NVM_ext_busy
003725 EF                MOV      A,R7
003726 6005              JZ       ?C0113?ZW_PHY_GENERIC_SPI_IF
003728 124724            LCALL    ZW_Poll
00372B 80F6              SJMP     ?C0112?ZW_PHY_GENERIC_SPI_IF
00372D         ?C0113?ZW_PHY_GENERIC_SPI_IF:
00372D 126FC3            LCALL    ?L?COM044E
003730 12380D            LCALL    ?L?COM0171
003733 6009              JZ       ?C0114?ZW_PHY_GENERIC_SPI_IF
003735 9044F6            MOV      DPTR,#offset
003738 126E73            LCALL    ?L?COM02AB
00373B E4                CLR      A
00373C 91F2              ACALL    _ZW_SPI1_tx_set
00373E         ?C0114?ZW_PHY_GENERIC_SPI_IF:
00373E 9044F6            MOV      DPTR,#offset
003741 126E6B            LCALL    ?L?COM02AA
003744 E4                CLR      A
003745 91F2              ACALL    _ZW_SPI1_tx_set
003747 9044F6            MOV      DPTR,#offset
00374A 91EE              ACALL    ?L?COM0429
00374C B186              ACALL    ?L?COM00E0
00374E 9044FA            MOV      DPTR,#bData
003751 EF                MOV      A,R7
003752 F0                MOVX     @DPTR,A
003753 D1BE              ACALL    ?L?COM026D
003755 9044FA            MOV      DPTR,#bData
003758 E0                MOVX     A,@DPTR
003759 FF                MOV      R7,A
00375A 22                RET      
----- FUNCTION _NVM_ext_read_long_byte (END) -------


----- FUNCTION NVM_CS_enable (BEGIN) -----
00375B 904153            MOV      DPTR,#NVRbNVMChipSelect
00375E E0                MOVX     A,@DPTR
00375F 12267F            LCALL    ?C?CCASE
003762 377E              DW       ?C0002?ZW_PHY_GENERIC_SPI_IF
003764 04                DB       04H
003765 3786              DW       ?C0003?ZW_PHY_GENERIC_SPI_IF
003767 14                DB       014H
003768 378B              DW       ?C0004?ZW_PHY_GENERIC_SPI_IF
00376A 15                DB       015H
00376B 3790              DW       ?C0005?ZW_PHY_GENERIC_SPI_IF
00376D 17                DB       017H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 18


00376E 37A0              DW       ?C0008?ZW_PHY_GENERIC_SPI_IF
003770 30                DB       030H
003771 37A5              DW       ?C0009?ZW_PHY_GENERIC_SPI_IF
003773 34                DB       034H
003774 37AA              DW       ?C0010?ZW_PHY_GENERIC_SPI_IF
003776 36                DB       036H
003777 37AF              DW       ?C0011?ZW_PHY_GENERIC_SPI_IF
003779 37                DB       037H
00377A 0000              DW       00H
00377C 3798              DW       ?C0007?ZW_PHY_GENERIC_SPI_IF
00377E         ?C0002?ZW_PHY_GENERIC_SPI_IF:
00377E 536CEF            ANL      P0Shadow,#0EFH
003781 856C80            MOV      P0,P0Shadow
003784 802F              SJMP     ?C0001?ZW_PHY_GENERIC_SPI_IF
003786         ?C0003?ZW_PHY_GENERIC_SPI_IF:
003786 536DEF            ANL      P1Shadow,#0EFH
003789 8008              SJMP     ?C0190?ZW_PHY_GENERIC_SPI_IF
00378B         ?C0004?ZW_PHY_GENERIC_SPI_IF:
00378B 536DDF            ANL      P1Shadow,#0DFH
00378E         
00378E 8003              SJMP     ?C0190?ZW_PHY_GENERIC_SPI_IF
003790         ?C0005?ZW_PHY_GENERIC_SPI_IF:
003790 536D7F            ANL      P1Shadow,#07FH
003793         
003793 856D90            MOV      P1,P1Shadow
003796 801D              SJMP     ?C0001?ZW_PHY_GENERIC_SPI_IF
003798         ?C0007?ZW_PHY_GENERIC_SPI_IF:
003798 536EDF            ANL      P2Shadow,#0DFH
00379B 856EA0            MOV      P2,P2Shadow
00379E 8015              SJMP     ?C0001?ZW_PHY_GENERIC_SPI_IF
0037A0         ?C0008?ZW_PHY_GENERIC_SPI_IF:
0037A0 536FFE            ANL      P3Shadow,#0FEH
0037A3 800D              SJMP     ?C0193?ZW_PHY_GENERIC_SPI_IF
0037A5         ?C0009?ZW_PHY_GENERIC_SPI_IF:
0037A5 536FEF            ANL      P3Shadow,#0EFH
0037A8         
0037A8 8008              SJMP     ?C0193?ZW_PHY_GENERIC_SPI_IF
0037AA         ?C0010?ZW_PHY_GENERIC_SPI_IF:
0037AA 536FBF            ANL      P3Shadow,#0BFH
0037AD         
0037AD 8003              SJMP     ?C0193?ZW_PHY_GENERIC_SPI_IF
0037AF         ?C0011?ZW_PHY_GENERIC_SPI_IF:
0037AF 536F7F            ANL      P3Shadow,#07FH
0037B2         
0037B2 856FB0            MOV      P3,P3Shadow
0037B5         ?C0001?ZW_PHY_GENERIC_SPI_IF:
;---- Variable 'x' assigned to Register 'R7' ----
0037B5 7F0C              MOV      R7,#0CH
0037B7         ?C0012?ZW_PHY_GENERIC_SPI_IF:
0037B7 DFFE              DJNZ     R7,?C0012?ZW_PHY_GENERIC_SPI_IF
0037B9 22                RET      
----- FUNCTION NVM_CS_enable (END) -------


----- FUNCTION NVM_clearStatusReg (BEGIN) -----
0037BA F1E6              ACALL    ZW_WatchDogKick
0037BC         ?C0050?ZW_PHY_GENERIC_SPI_IF:
0037BC B192              ACALL    NVM_ext_busy
0037BE EF                MOV      A,R7
0037BF 6005              JZ       ?C0051?ZW_PHY_GENERIC_SPI_IF
0037C1 124724            LCALL    ZW_Poll
0037C4 80F6              SJMP     ?C0050?ZW_PHY_GENERIC_SPI_IF
0037C6         ?C0051?ZW_PHY_GENERIC_SPI_IF:
0037C6 7F01              MOV      R7,#01H
0037C8 D1C2              ACALL    _ZW_SPI1_enable
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 19


0037CA D238              SETB     writeActive
0037CC F15B              ACALL    NVM_CS_enable
0037CE 7F06              MOV      R7,#06H
0037D0 D13C              ACALL    ?L?COM0468
0037D2 F15B              ACALL    NVM_CS_enable
0037D4 7F01              MOV      R7,#01H
0037D6 91F2              ACALL    _ZW_SPI1_tx_set
0037D8 7F03              MOV      R7,#03H
0037DA D13C              ACALL    ?L?COM0468
0037DC E4                CLR      A
0037DD FF                MOV      R7,A
0037DE C1C2              AJMP     _ZW_SPI1_enable
----- FUNCTION NVM_clearStatusReg (END) -------


----- FUNCTION ?L?COM0523 (BEGIN) -----
0037E0 F15B              ACALL    NVM_CS_enable
0037E2 7F05              MOV      R7,#05H
0037E4 81F2              AJMP     _ZW_SPI1_tx_set
----- FUNCTION ?L?COM0523 (END) -------


----- FUNCTION ZW_WatchDogKick (BEGIN) -----
0037E6 75FF02            MOV      SFRPAGE,#02H
0037E9 E5E4              MOV      A,WDTCON
0037EB 30E106            JNB      ACC.1,?C0042?ZW_MAIN
0037EE 75E406            MOV      WDTCON,#06H
0037F1 75E403            MOV      WDTCON,#03H
0037F4         ?C0042?ZW_MAIN:
0037F4 22                RET      
----- FUNCTION ZW_WatchDogKick (END) -------


----- FUNCTION ?L?COM0170 (BEGIN) -----
0037F5 7F01              MOV      R7,#01H
0037F7 D1C2              ACALL    _ZW_SPI1_enable
0037F9 D238              SETB     writeActive
0037FB F15B              ACALL    NVM_CS_enable
0037FD 7F06              MOV      R7,#06H
0037FF 1234F2            LCALL    _ZW_SPI1_tx_set
003802 12363E            LCALL    NVM_CS_disable
003805 12375B            LCALL    NVM_CS_enable
003808 904151            MOV      DPTR,#bNVMWriteCommand
00380B E0                MOVX     A,@DPTR
00380C FF                MOV      R7,A
00380D         ?L?COM0171:
00380D 1234F2            LCALL    _ZW_SPI1_tx_set
003810 904154            MOV      DPTR,#bNVMAddressSize
003813 E0                MOVX     A,@DPTR
003814 6402              XRL      A,#02H
003816 22                RET      
----- FUNCTION ?L?COM0170 (END) -------


----- FUNCTION _NVM_ext_read_long_buffer (BEGIN) -----
003817 9042A7            MOV      DPTR,#offset
00381A 1224BA            LCALL    ?C?LSTXDATA
00381D 9042AB            MOV      DPTR,#buf
003820 122572            LCALL    ?C?PSTXDATA
003823 1237E6            LCALL    ZW_WatchDogKick
003826         ?C0123?ZW_PHY_GENERIC_SPI_IF:
003826 123592            LCALL    NVM_ext_busy
003829 EF                MOV      A,R7
00382A 6005              JZ       ?C0124?ZW_PHY_GENERIC_SPI_IF
00382C 124724            LCALL    ZW_Poll
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 20


00382F 80F5              SJMP     ?C0123?ZW_PHY_GENERIC_SPI_IF
003831         ?C0124?ZW_PHY_GENERIC_SPI_IF:
003831 126FC3            LCALL    ?L?COM044E
003834 110D              ACALL    ?L?COM0171
003836 600A              JZ       ?C0125?ZW_PHY_GENERIC_SPI_IF
003838 9042A7            MOV      DPTR,#offset
00383B 126E73            LCALL    ?L?COM02AB
00383E E4                CLR      A
00383F 1234F2            LCALL    _ZW_SPI1_tx_set
003842         ?C0125?ZW_PHY_GENERIC_SPI_IF:
003842 9042A7            MOV      DPTR,#offset
003845 126E6B            LCALL    ?L?COM02AA
003848 E4                CLR      A
003849 1234F2            LCALL    _ZW_SPI1_tx_set
00384C 9042A7            MOV      DPTR,#offset
00384F 1234EE            LCALL    ?L?COM0429
003852         ?C0126?ZW_PHY_GENERIC_SPI_IF:
003852 9042AE            MOV      DPTR,#length
003855 126EF4            LCALL    ?L?COM0373
003858 6015              JZ       ?C0127?ZW_PHY_GENERIC_SPI_IF
00385A 123586            LCALL    ?L?COM00E0
00385D 9042AB            MOV      DPTR,#buf
003860 1256DF            LCALL    ?L?COM0125
003863 9042AC            MOV      DPTR,#buf+01H
003866 E4                CLR      A
003867 75F001            MOV      B,#01H
00386A 12210C            LCALL    ?C?IILDX
00386D 80E3              SJMP     ?C0126?ZW_PHY_GENERIC_SPI_IF
00386F         ?C0127?ZW_PHY_GENERIC_SPI_IF:
00386F 12363E            LCALL    NVM_CS_disable
003872 E4                CLR      A
003873 FF                MOV      R7,A
003874 0236C2            LJMP     _ZW_SPI1_enable
----- FUNCTION _NVM_ext_read_long_buffer (END) -------


----- FUNCTION ?L?COM0099 (BEGIN) -----
003877 90402C            MOV      DPTR,#nvmModuleDescriptorOldPtr
00387A 122552            LCALL    ?C?PLDXDATA
00387D AE02              MOV      R6,AR2
00387F AF01              MOV      R7,AR1
003881 7B01              MOV      R3,#01H
003883 7A40              MOV      R2,#HIGH dataLengthOld
003885 793B              MOV      R1,#LOW dataLengthOld
003887         ?L?COM009A:
003887 904478            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
00388A 7402              MOV      A,#02H
00388C F0                MOVX     @DPTR,A
----- FUNCTION _NVM_ext_read_buffer (BEGIN) -----
00388D 904475            MOV      DPTR,#buf
003890 122572            LCALL    ?C?PSTXDATA
;---- Variable 'offset' assigned to Register 'R6/R7' ----
003893 E4                CLR      A
003894 FC                MOV      R4,A
003895 FD                MOV      R5,A
003896 C007              PUSH     AR7
003898 904475            MOV      DPTR,#buf
00389B 122552            LCALL    ?C?PLDXDATA
00389E 904478            MOV      DPTR,#length
0038A1 E0                MOVX     A,@DPTR
0038A2 9042AE            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
0038A5 126E29            LCALL    ?L?COM01DA
0038A8 D007              POP      AR7
0038AA 0117              AJMP     _NVM_ext_read_long_buffer
----- FUNCTION _NVM_ext_read_buffer (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 21




----- FUNCTION Init_ZW_SW (BEGIN) -----
0038AC 126979            LCALL    NVM_ext_init
0038AF 121A57            LCALL    ?INTERBANK_TABLE?TxQueueInit
0038B2 121B24            LCALL    ?INTERBANK_TABLE?ctimer_init
0038B5 121999            LCALL    ?INTERBANK_TABLE?TransportInit
0038B8 121C5A            LCALL    ?INTERBANK_TABLE?TransportTimerInit
0038BB 91ED              ACALL    ?L?COM04D8
0038BD 7002              JNZ      $ + 4H
0038BF 2196              AJMP     ?C0024?ZW_MAIN
0038C1 7FFF              MOV      R7,#0FFH
0038C3 121ADE            LCALL    ?INTERBANK_TABLE?_FindCorrespondingOldNvmModuleDescriptor
0038C6 900A53            MOV      DPTR,#nvmModuleDescriptorOldPtr
0038C9 122572            LCALL    ?C?PSTXDATA
0038CC 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_VALID_far
0038CE 7F09              MOV      R7,#LOW NVM_CONFIGURATION_VALID_far
0038D0 31F2              ACALL    _NVM_ext_read_byte
0038D2 BF540D            CJNE     R7,#054H,?C0025?ZW_MAIN
0038D5 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_REALLYVALID_far
0038D7 7F0A              MOV      R7,#LOW NVM_CONFIGURATION_REALLYVALID_far
0038D9 31F2              ACALL    _NVM_ext_read_byte
0038DB BFA504            CJNE     R7,#0A5H,?C0025?ZW_MAIN
0038DE 7F01              MOV      R7,#01H
0038E0 8002              SJMP     ?C0026?ZW_MAIN
0038E2         ?C0025?ZW_MAIN:
0038E2 7F00              MOV      R7,#00H
0038E4         ?C0026?ZW_MAIN:
0038E4 9003C0            MOV      DPTR,#mNvmLayout
0038E7 EF                MOV      A,R7
0038E8 F0                MOVX     @DPTR,A
0038E9 900A53            MOV      DPTR,#nvmModuleDescriptorOldPtr
0038EC 122552            LCALL    ?C?PLDXDATA
0038EF E9                MOV      A,R1
0038F0 4A                ORL      A,R2
0038F1 4B                ORL      A,R3
0038F2 701D              JNZ      ?C0030?ZW_MAIN
0038F4 7F04              MOV      R7,#04H
0038F6 FE                MOV      R6,A
0038F7 31F2              ACALL    _NVM_ext_read_byte
0038F9 EF                MOV      A,R7
0038FA 2401              ADD      A,#01H
0038FC FF                MOV      R7,A
0038FD E4                CLR      A
0038FE 33                RLC      A
0038FF FE                MOV      R6,A
003900 C3                CLR      C
003901 7401              MOV      A,#01H
003903 12533F            LCALL    ?L?COM011E
003906 7F00              MOV      R7,#00H
003908 5002              JNC      ?C0028?ZW_MAIN
00390A 7F01              MOV      R7,#01H
00390C         ?C0028?ZW_MAIN:
00390C         ?C0029?ZW_MAIN:
00390C 9003C0            MOV      DPTR,#mNvmLayout
00390F EF                MOV      A,R7
003910 F0                MOVX     @DPTR,A
003911         ?C0030?ZW_MAIN:
003911 9003C0            MOV      DPTR,#mNvmLayout
003914 E0                MOVX     A,@DPTR
003915 6401              XRL      A,#01H
003917 704B              JNZ      ?C0031?ZW_MAIN
003919 900A53            MOV      DPTR,#nvmModuleDescriptorOldPtr
00391C 126EC6            LCALL    ?L?COM0353
00391F 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 22


003921 7A0A              MOV      R2,#HIGH tmp
003923 7959              MOV      R1,#LOW tmp
003925 1187              ACALL    ?L?COM009A
003927 900A59            MOV      DPTR,#tmp
00392A E0                MOVX     A,@DPTR
00392B FE                MOV      R6,A
00392C A3                INC      DPTR
00392D E0                MOVX     A,@DPTR
00392E 900A53            MOV      DPTR,#nvmModuleDescriptorOldPtr
003931 126EFE            LCALL    ?L?COM0376
003934 E4                CLR      A
003935 3A                ADDC     A,R2
003936 FA                MOV      R2,A
003937 900A56            MOV      DPTR,#nvmDescriptorOldPtr
00393A 122572            LCALL    ?C?PSTXDATA
00393D E9                MOV      A,R1
00393E 2408              ADD      A,#08H
003940 F9                MOV      R1,A
003941 E4                CLR      A
003942 3A                ADDC     A,R2
003943 FE                MOV      R6,A
003944 AF01              MOV      R7,AR1
003946 7B01              MOV      R3,#01H
003948 7A0A              MOV      R2,#HIGH tmp
00394A 7959              MOV      R1,#LOW tmp
00394C 1187              ACALL    ?L?COM009A
00394E 900A59            MOV      DPTR,#tmp
003951 E0                MOVX     A,@DPTR
003952 6406              XRL      A,#HIGH _APP_VERSION_
003954 7004              JNZ      ?C0174?ZW_MAIN
003956 A3                INC      DPTR
003957 E0                MOVX     A,@DPTR
003958 640A              XRL      A,#LOW _APP_VERSION_
00395A         ?C0174?ZW_MAIN:
00395A 6008              JZ       ?C0031?ZW_MAIN
00395C 121AE3            LCALL    ?INTERBANK_TABLE?RearrangeNVMmodules
00395F 9003C0            MOV      DPTR,#mNvmLayout
003962 EF                MOV      A,R7
003963 F0                MOVX     @DPTR,A
003964         ?C0031?ZW_MAIN:
003964 9003C0            MOV      DPTR,#mNvmLayout
003967 E0                MOVX     A,@DPTR
003968 7024              JNZ      ?C0033?ZW_MAIN
00396A 7E00              MOV      R6,#HIGH NVM_HOMEID_far
00396C 7F04              MOV      R7,#LOW NVM_HOMEID_far
00396E C006              PUSH     AR6
003970 C3                CLR      C
003971 7484              MOV      A,#LOW _HDATA_E_
003973 9404              SUBB     A,#LOW NVM_HOMEID_far
003975 FE                MOV      R6,A
003976 741C              MOV      A,#HIGH _HDATA_E_
003978 9400              SUBB     A,#HIGH NVM_HOMEID_far
00397A 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
00397D F0                MOVX     @DPTR,A
00397E A3                INC      DPTR
00397F CE                XCH      A,R6
003980 F0                MOVX     @DPTR,A
003981 1247C7            LCALL    ?L?COM0359
003984 D006              POP      AR6
003986 F1F4              ACALL    ?L?COM057E
003988 E4                CLR      A
003989 FF                MOV      R7,A
00398A FE                MOV      R6,A
00398B 121AE8            LCALL    ?INTERBANK_TABLE?_CinitNVMvariables
00398E         ?C0033?ZW_MAIN:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 23


00398E 9003C0            MOV      DPTR,#mNvmLayout
003991 E0                MOVX     A,@DPTR
003992 FF                MOV      R7,A
003993 121B0B            LCALL    ?INTERBANK_TABLE?_ZW_KeystoreInit
003996         ?C0024?ZW_MAIN:
003996 91ED              ACALL    ?L?COM04D8
003998 7F00              MOV      R7,#00H
00399A 6002              JZ       ?C0034?ZW_MAIN
00399C 7F01              MOV      R7,#01H
00399E         ?C0034?ZW_MAIN:
00399E         ?C0035?ZW_MAIN:
00399E 121A0C            LCALL    ?INTERBANK_TABLE?_SlaveInit
0039A1 121A16            LCALL    ?INTERBANK_TABLE?SlaveInitDone
0039A4 121962            LCALL    ?INTERBANK_TABLE?ReturnRouteResetPriority
0039A7 126E1D            LCALL    ?L?COM01CC
0039AA 7A12              MOV      R2,#HIGH homeID
0039AC 7923              MOV      R1,#LOW homeID
0039AE 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetID
0039B1 1248F8            LCALL    ?L?COM042E
0039B4 FE                MOV      R6,A
0039B5 4F                ORL      A,R7
0039B6 FD                MOV      R5,A
0039B7 A3                INC      DPTR
0039B8 E0                MOVX     A,@DPTR
0039B9 FC                MOV      R4,A
0039BA 4D                ORL      A,R5
0039BB FD                MOV      R5,A
0039BC A3                INC      DPTR
0039BD E0                MOVX     A,@DPTR
0039BE FB                MOV      R3,A
0039BF 4D                ORL      A,R5
0039C0 600B              JZ       ?C0037?ZW_MAIN
0039C2 EE                MOV      A,R6
0039C3 5F                ANL      A,R7
0039C4 FF                MOV      R7,A
0039C5 EC                MOV      A,R4
0039C6 5F                ANL      A,R7
0039C7 FF                MOV      R7,A
0039C8 EB                MOV      A,R3
0039C9 5F                ANL      A,R7
0039CA F4                CPL      A
0039CB 7003              JNZ      ?C0036?ZW_MAIN
0039CD         ?C0037?ZW_MAIN:
0039CD 124900            LCALL    NewIDCreate
0039D0         ?C0036?ZW_MAIN:
0039D0 901221            MOV      DPTR,#nodeID
0039D3 E0                MOVX     A,@DPTR
0039D4 FF                MOV      R7,A
0039D5 901225            MOV      DPTR,#homeID+02H
0039D8 E0                MOVX     A,@DPTR
0039D9 6F                XRL      A,R7
0039DA 9003BB            MOV      DPTR,#randomSeed
0039DD F0                MOVX     @DPTR,A
0039DE 021C28            LJMP     ?INTERBANK_TABLE?NoiseDetectPowerOnInit
----- FUNCTION Init_ZW_SW (END) -------


----- FUNCTION ?L?COM007D (BEGIN) -----
0039E1 E0                MOVX     A,@DPTR
0039E2         ?L?COM007E:
0039E2 75F002            MOV      B,#02H
0039E5 A4                MUL      AB
0039E6 2485              ADD      A,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
0039E8 F9                MOV      R1,A
0039E9 740F              MOV      A,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 24


0039EB         ?L?COM007F:
0039EB 35F0              ADDC     A,B
0039ED 7B02              MOV      R3,#MBYTE NVM_RETURN_ROUTE_SPEED_START_far
0039EF FE                MOV      R6,A
0039F0 AF01              MOV      R7,AR1
----- FUNCTION _NVM_ext_read_byte (BEGIN) -----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
0039F2 E4                CLR      A
0039F3 FC                MOV      R4,A
0039F4 FD                MOV      R5,A
0039F5 02371B            LJMP     _NVM_ext_read_long_byte
----- FUNCTION _NVM_ext_read_byte (END) -------


----- FUNCTION ?L?COM0481 (BEGIN) -----
0039F8 7402              MOV      A,#02H
0039FA F0                MOVX     @DPTR,A
----- FUNCTION _NVM_ext_write_buffer (BEGIN) -----
0039FB 9043F0            MOV      DPTR,#buf
0039FE 122572            LCALL    ?C?PSTXDATA
;---- Variable 'offset' assigned to Register 'R6/R7' ----
003A01 E4                CLR      A
003A02 FC                MOV      R4,A
003A03 FD                MOV      R5,A
003A04 C007              PUSH     AR7
003A06 9043F0            MOV      DPTR,#buf
003A09 122552            LCALL    ?C?PLDXDATA
003A0C 9043F3            MOV      DPTR,#length
003A0F 126E91            LCALL    ?L?COM02DE
003A12 D007              POP      AR7
;----                  JMP      _NVM_ext_write_long_buffer
----- FUNCTION _NVM_ext_write_buffer (END) -------


----- FUNCTION _NVM_ext_write_long_buffer (BEGIN) -----
003A14 90417B            MOV      DPTR,#offset
003A17 1224BA            LCALL    ?C?LSTXDATA
003A1A 90417F            MOV      DPTR,#buf
003A1D 122572            LCALL    ?C?PSTXDATA
003A20 90417B            MOV      DPTR,#offset
003A23 122462            LCALL    ?C?LLDXDATA
003A26 904158            MOV      DPTR,#NVRbNVMPageSize+01H
003A29 E0                MOVX     A,@DPTR
003A2A 24FF              ADD      A,#0FFH
003A2C FD                MOV      R5,A
003A2D 904157            MOV      DPTR,#NVRbNVMPageSize
003A30 E0                MOVX     A,@DPTR
003A31 34FF              ADDC     A,#0FFH
003A33 5E                ANL      A,R6
003A34 FE                MOV      R6,A
003A35 ED                MOV      A,R5
003A36 5F                ANL      A,R7
003A37 FF                MOV      R7,A
003A38 904184            MOV      DPTR,#i
003A3B 126F4A            LCALL    ?L?COM03D3
003A3E 6066              JZ       ?C0148?ZW_PHY_GENERIC_SPI_IF
003A40 71EA              ACALL    ?L?COM0390
003A42 C3                CLR      C
003A43 126F5D            LCALL    ?L?COM0400
003A46 FE                MOV      R6,A
003A47 904184            MOV      DPTR,#i
003A4A F0                MOVX     @DPTR,A
003A4B A3                INC      DPTR
003A4C EF                MOV      A,R7
003A4D F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 25


003A4E 904182            MOV      DPTR,#length
003A51 91E6              ACALL    ?L?COM0452
003A53 9F                SUBB     A,R7
003A54 EC                MOV      A,R4
003A55 9E                SUBB     A,R6
003A56 5006              JNC      ?C0142?ZW_PHY_GENERIC_SPI_IF
003A58 A3                INC      DPTR
003A59 EC                MOV      A,R4
003A5A F0                MOVX     @DPTR,A
003A5B A3                INC      DPTR
003A5C ED                MOV      A,R5
003A5D F0                MOVX     @DPTR,A
003A5E         ?C0142?ZW_PHY_GENERIC_SPI_IF:
003A5E 7149              ACALL    ?L?COM0116
003A60 91C9              ACALL    ?L?COM021F
003A62 6032              JZ       ?C0143?ZW_PHY_GENERIC_SPI_IF
003A64 9111              ACALL    ?L?COM0145
003A66 9101              ACALL    ?L?COM02BB
003A68 90417B            MOV      DPTR,#offset
003A6B 12247E            LCALL    ?C?LLDXDATA0
003A6E 122234            LCALL    ?C?LADD
003A71 C004              PUSH     AR4
003A73 C005              PUSH     AR5
003A75 C006              PUSH     AR6
003A77 C007              PUSH     AR7
003A79 7149              ACALL    ?L?COM0116
003A7B E9                MOV      A,R1
003A7C 4A                ORL      A,R2
003A7D 6004              JZ       ?C0144?ZW_PHY_GENERIC_SPI_IF
003A7F 71F3              ACALL    ?L?COM031C
003A81 8002              SJMP     ?C0145?ZW_PHY_GENERIC_SPI_IF
003A83         ?C0144?ZW_PHY_GENERIC_SPI_IF:
003A83 7F00              MOV      R7,#00H
003A85         ?C0145?ZW_PHY_GENERIC_SPI_IF:
003A85 7E00              MOV      R6,#00H
003A87 7149              ACALL    ?L?COM0116
003A89 91FE              ACALL    ?L?COM02D7
003A8B D007              POP      AR7
003A8D D006              POP      AR6
003A8F D005              POP      AR5
003A91 D004              POP      AR4
003A93 1235D2            LCALL    _NVMPutArray_long
003A96         ?C0143?ZW_PHY_GENERIC_SPI_IF:
003A96 7122              ACALL    ?L?COM0115
003A98 E9                MOV      A,R1
003A99 4A                ORL      A,R2
003A9A 6004              JZ       ?C0146?ZW_PHY_GENERIC_SPI_IF
003A9C 71EA              ACALL    ?L?COM0390
003A9E 8075              SJMP     ?C0156?ZW_PHY_GENERIC_SPI_IF
003AA0         ?C0146?ZW_PHY_GENERIC_SPI_IF:
003AA0 7E00              MOV      R6,#00H
003AA2 7F00              MOV      R7,#00H
003AA4         ?C0147?ZW_PHY_GENERIC_SPI_IF:
003AA4 806F              SJMP     ?C0156?ZW_PHY_GENERIC_SPI_IF
003AA6         ?C0148?ZW_PHY_GENERIC_SPI_IF:
003AA6 904182            MOV      DPTR,#length
003AA9 F1ED              ACALL    ?L?COM03C3
003AAB 6073              JZ       ?C0149?ZW_PHY_GENERIC_SPI_IF
003AAD 904157            MOV      DPTR,#NVRbNVMPageSize
003AB0 91E6              ACALL    ?L?COM0452
003AB2 EF                MOV      A,R7
003AB3 9D                SUBB     A,R5
003AB4 EE                MOV      A,R6
003AB5 9C                SUBB     A,R4
003AB6 400A              JC       ?C0150?ZW_PHY_GENERIC_SPI_IF
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 26


003AB8 904184            MOV      DPTR,#i
003ABB EC                MOV      A,R4
003ABC F0                MOVX     @DPTR,A
003ABD A3                INC      DPTR
003ABE ED                MOV      A,R5
003ABF F0                MOVX     @DPTR,A
003AC0 800D              SJMP     ?C0151?ZW_PHY_GENERIC_SPI_IF
003AC2         ?C0150?ZW_PHY_GENERIC_SPI_IF:
003AC2 904182            MOV      DPTR,#length
003AC5 E0                MOVX     A,@DPTR
003AC6 FF                MOV      R7,A
003AC7 A3                INC      DPTR
003AC8 E0                MOVX     A,@DPTR
003AC9 A3                INC      DPTR
003ACA CF                XCH      A,R7
003ACB F0                MOVX     @DPTR,A
003ACC A3                INC      DPTR
003ACD EF                MOV      A,R7
003ACE F0                MOVX     @DPTR,A
003ACF         ?C0151?ZW_PHY_GENERIC_SPI_IF:
003ACF 7149              ACALL    ?L?COM0116
003AD1 91C9              ACALL    ?L?COM021F
003AD3 6032              JZ       ?C0152?ZW_PHY_GENERIC_SPI_IF
003AD5 9111              ACALL    ?L?COM0145
003AD7 9101              ACALL    ?L?COM02BB
003AD9 90417B            MOV      DPTR,#offset
003ADC 12247E            LCALL    ?C?LLDXDATA0
003ADF 122234            LCALL    ?C?LADD
003AE2 C004              PUSH     AR4
003AE4 C005              PUSH     AR5
003AE6 C006              PUSH     AR6
003AE8 C007              PUSH     AR7
003AEA 7149              ACALL    ?L?COM0116
003AEC E9                MOV      A,R1
003AED 4A                ORL      A,R2
003AEE 6004              JZ       ?C0153?ZW_PHY_GENERIC_SPI_IF
003AF0 71F3              ACALL    ?L?COM031C
003AF2 8002              SJMP     ?C0154?ZW_PHY_GENERIC_SPI_IF
003AF4         ?C0153?ZW_PHY_GENERIC_SPI_IF:
003AF4 7F00              MOV      R7,#00H
003AF6         ?C0154?ZW_PHY_GENERIC_SPI_IF:
003AF6 7E00              MOV      R6,#00H
003AF8 7149              ACALL    ?L?COM0116
003AFA 91FE              ACALL    ?L?COM02D7
003AFC D007              POP      AR7
003AFE D006              POP      AR6
003B00 D005              POP      AR5
003B02 D004              POP      AR4
003B04 1235D2            LCALL    _NVMPutArray_long
003B07         ?C0152?ZW_PHY_GENERIC_SPI_IF:
003B07 7122              ACALL    ?L?COM0115
003B09 E9                MOV      A,R1
003B0A 4A                ORL      A,R2
003B0B 6004              JZ       ?C0155?ZW_PHY_GENERIC_SPI_IF
003B0D 71EA              ACALL    ?L?COM0390
003B0F 8004              SJMP     ?C0156?ZW_PHY_GENERIC_SPI_IF
003B11         ?C0155?ZW_PHY_GENERIC_SPI_IF:
003B11 7E00              MOV      R6,#00H
003B13 7F00              MOV      R7,#00H
003B15         ?C0156?ZW_PHY_GENERIC_SPI_IF:
003B15 904180            MOV      DPTR,#buf+01H
003B18 EE                MOV      A,R6
003B19 8FF0              MOV      B,R7
003B1B 12210C            LCALL    ?C?IILDX
003B1E 8086              SJMP     ?C0148?ZW_PHY_GENERIC_SPI_IF
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 27


003B20         ?C0149?ZW_PHY_GENERIC_SPI_IF:
003B20 D3                SETB     C
003B21 22                RET      
----- FUNCTION _NVM_ext_write_long_buffer (END) -------


----- FUNCTION ?L?COM0115 (BEGIN) -----
003B22 904184            MOV      DPTR,#i
003B25 E0                MOVX     A,@DPTR
003B26 FE                MOV      R6,A
003B27 A3                INC      DPTR
003B28 E0                MOVX     A,@DPTR
003B29 FF                MOV      R7,A
003B2A C3                CLR      C
003B2B 904183            MOV      DPTR,#length+01H
003B2E E0                MOVX     A,@DPTR
003B2F 9F                SUBB     A,R7
003B30 F0                MOVX     @DPTR,A
003B31 904182            MOV      DPTR,#length
003B34 E0                MOVX     A,@DPTR
003B35 9E                SUBB     A,R6
003B36 F0                MOVX     @DPTR,A
003B37 90417B            MOV      DPTR,#offset
003B3A 12247E            LCALL    ?C?LLDXDATA0
003B3D E4                CLR      A
003B3E FC                MOV      R4,A
003B3F FD                MOV      R5,A
003B40 122234            LCALL    ?C?LADD
003B43 90417B            MOV      DPTR,#offset
003B46 1224BA            LCALL    ?C?LSTXDATA
003B49         ?L?COM0116:
003B49 90417F            MOV      DPTR,#buf
003B4C 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0115 (END) -------


----- FUNCTION _GetLowestBit (BEGIN) -----
;---- Variable 'val' assigned to Register 'R7' ----
003B4F EF                MOV      A,R7
003B50 F4                CPL      A
003B51 04                INC      A
003B52 5F                ANL      A,R7
003B53 FF                MOV      R7,A
;----                  JMP      _GetHighestBit
----- FUNCTION _GetLowestBit (END) -------


----- FUNCTION _GetHighestBit (BEGIN) -----
;---- Variable 'val' assigned to Register 'R7' ----
;---- Variable 'retVal' assigned to Register 'R6' ----
003B54 E4                CLR      A
003B55 FE                MOV      R6,A
003B56 EF                MOV      A,R7
003B57 7003              JNZ      ?C0130?ZW_PHY_GENERIC_SPI_IF
003B59 7FFF              MOV      R7,#0FFH
003B5B 22                RET      
003B5C         ?C0130?ZW_PHY_GENERIC_SPI_IF:
003B5C EF                MOV      A,R7
003B5D D3                SETB     C
003B5E 940F              SUBB     A,#0FH
003B60 4009              JC       ?C0132?ZW_PHY_GENERIC_SPI_IF
003B62 EF                MOV      A,R7
003B63 C4                SWAP     A
003B64 540F              ANL      A,#0FH
003B66 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 28


003B67 EE                MOV      A,R6
003B68 4404              ORL      A,#04H
003B6A FE                MOV      R6,A
003B6B         ?C0132?ZW_PHY_GENERIC_SPI_IF:
003B6B EF                MOV      A,R7
003B6C D3                SETB     C
003B6D 9403              SUBB     A,#03H
003B6F 400A              JC       ?C0133?ZW_PHY_GENERIC_SPI_IF
003B71 EF                MOV      A,R7
003B72 13                RRC      A
003B73 13                RRC      A
003B74 543F              ANL      A,#03FH
003B76 FF                MOV      R7,A
003B77 EE                MOV      A,R6
003B78 4402              ORL      A,#02H
003B7A FE                MOV      R6,A
003B7B         ?C0133?ZW_PHY_GENERIC_SPI_IF:
003B7B EF                MOV      A,R7
003B7C 30E101            JNB      ACC.1,?C0134?ZW_PHY_GENERIC_SPI_IF
003B7F 0E                INC      R6
003B80         ?C0134?ZW_PHY_GENERIC_SPI_IF:
003B80 AF06              MOV      R7,AR6
003B82 22                RET      
----- FUNCTION _GetHighestBit (END) -------


----- FUNCTION _GetModifiedLength (BEGIN) -----
;---- Variable 'bLength' assigned to Register 'R2/R3' ----
003B83 AB07              MOV      R3,AR7
003B85 AA06              MOV      R2,AR6
;---- Variable 'bSubBuffers' assigned to Register 'R5' ----
003B87 EB                MOV      A,R3
003B88 241F              ADD      A,#01FH
003B8A FF                MOV      R7,A
003B8B E4                CLR      A
003B8C 3A                ADDC     A,R2
003B8D FE                MOV      R6,A
003B8E EF                MOV      A,R7
003B8F 7805              MOV      R0,#05H
003B91         ?C0188?ZW_PHY_GENERIC_SPI_IF:
003B91 CE                XCH      A,R6
003B92 C3                CLR      C
003B93 13                RRC      A
003B94 CE                XCH      A,R6
003B95 13                RRC      A
003B96 D8F9              DJNZ     R0,?C0188?ZW_PHY_GENERIC_SPI_IF
;---- Variable 'bBlocks' assigned to Register 'R1' ----
003B98 F9                MOV      R1,A
003B99 EB                MOV      A,R3
003B9A 541F              ANL      A,#01FH
003B9C 9046A0            MOV      DPTR,#bRest
003B9F F0                MOVX     @DPTR,A
003BA0 AF05              MOV      R7,AR5
003BA2 714F              ACALL    _GetLowestBit
003BA4 EF                MOV      A,R7
003BA5 C4                SWAP     A
003BA6 33                RLC      A
003BA7 54E0              ANL      A,#0E0H
;---- Variable 'blow' assigned to Register 'R4' ----
003BA9 FC                MOV      R4,A
003BAA AF05              MOV      R7,AR5
003BAC 7154              ACALL    _GetHighestBit
003BAE AE01              MOV      R6,AR1
003BB0 EE                MOV      A,R6
003BB1 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 29


003BB2 C3                CLR      C
003BB3 9F                SUBB     A,R7
003BB4 C4                SWAP     A
003BB5 33                RLC      A
003BB6 54E0              ANL      A,#0E0H
;---- Variable 'bhigh' assigned to Register 'R1' ----
003BB8 F9                MOV      R1,A
003BB9 AF04              MOV      R7,AR4
003BBB C3                CLR      C
003BBC EB                MOV      A,R3
003BBD 9F                SUBB     A,R7
003BBE FF                MOV      R7,A
003BBF EA                MOV      A,R2
003BC0 9400              SUBB     A,#00H
003BC2 FE                MOV      R6,A
003BC3 E9                MOV      A,R1
003BC4 FD                MOV      R5,A
003BC5 C3                CLR      C
003BC6 EF                MOV      A,R7
003BC7 9D                SUBB     A,R5
003BC8 FF                MOV      R7,A
003BC9 EE                MOV      A,R6
003BCA 9400              SUBB     A,#00H
003BCC FE                MOV      R6,A
003BCD ED                MOV      A,R5
003BCE 600F              JZ       ?C0136?ZW_PHY_GENERIC_SPI_IF
003BD0 E0                MOVX     A,@DPTR
003BD1 FD                MOV      R5,A
003BD2 6007              JZ       ?C0138?ZW_PHY_GENERIC_SPI_IF
003BD4 C3                CLR      C
003BD5 7420              MOV      A,#020H
003BD7 9D                SUBB     A,R5
003BD8 FD                MOV      R5,A
003BD9 8006              SJMP     ?C0137?ZW_PHY_GENERIC_SPI_IF
003BDB         ?C0138?ZW_PHY_GENERIC_SPI_IF:
003BDB 7D00              MOV      R5,#00H
003BDD         ?C0139?ZW_PHY_GENERIC_SPI_IF:
003BDD 8002              SJMP     ?C0137?ZW_PHY_GENERIC_SPI_IF
003BDF         ?C0136?ZW_PHY_GENERIC_SPI_IF:
003BDF 7D00              MOV      R5,#00H
003BE1         ?C0137?ZW_PHY_GENERIC_SPI_IF:
003BE1 7C00              MOV      R4,#00H
003BE3 EF                MOV      A,R7
003BE4 2D                ADD      A,R5
003BE5 FF                MOV      R7,A
003BE6 EC                MOV      A,R4
003BE7 3E                ADDC     A,R6
003BE8 FE                MOV      R6,A
003BE9 22                RET      
----- FUNCTION _GetModifiedLength (END) -------


----- FUNCTION ?L?COM0390 (BEGIN) -----
003BEA 904184            MOV      DPTR,#i
003BED E0                MOVX     A,@DPTR
003BEE FE                MOV      R6,A
003BEF A3                INC      DPTR
003BF0 E0                MOVX     A,@DPTR
003BF1 FF                MOV      R7,A
003BF2 22                RET      
----- FUNCTION ?L?COM0390 (END) -------


----- FUNCTION ?L?COM031C (BEGIN) -----
003BF3 904188            MOV      DPTR,#bSubBuffers
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 30


003BF6 E0                MOVX     A,@DPTR
003BF7 FF                MOV      R7,A
003BF8 714F              ACALL    _GetLowestBit
003BFA         ?L?COM031D:
003BFA EF                MOV      A,R7
003BFB C4                SWAP     A
003BFC 33                RLC      A
003BFD 54E0              ANL      A,#0E0H
003BFF FF                MOV      R7,A
003C00 22                RET      
----- FUNCTION ?L?COM031C (END) -------


----- FUNCTION ?L?COM02BB (BEGIN) -----
003C01 E0                MOVX     A,@DPTR
003C02 FF                MOV      R7,A
003C03 714F              ACALL    _GetLowestBit
003C05 EF                MOV      A,R7
003C06 75F020            MOV      B,#020H
003C09 A4                MUL      AB
003C0A         ?L?COM02BC:
003C0A FF                MOV      R7,A
003C0B AEF0              MOV      R6,B
003C0D E4                CLR      A
003C0E FC                MOV      R4,A
003C0F FD                MOV      R5,A
003C10 22                RET      
----- FUNCTION ?L?COM02BB (END) -------


----- FUNCTION ?L?COM0145 (BEGIN) -----
003C11 904184            MOV      DPTR,#i
003C14 E0                MOVX     A,@DPTR
003C15 FE                MOV      R6,A
003C16 A3                INC      DPTR
003C17 E0                MOVX     A,@DPTR
003C18 FF                MOV      R7,A
003C19 904188            MOV      DPTR,#bSubBuffers
003C1C E0                MOVX     A,@DPTR
003C1D FD                MOV      R5,A
003C1E 7183              ACALL    _GetModifiedLength
003C20 904186            MOV      DPTR,#wLength
003C23         ?L?COM0146:
003C23 EE                MOV      A,R6
003C24 F0                MOVX     @DPTR,A
003C25 A3                INC      DPTR
003C26 EF                MOV      A,R7
003C27 F0                MOVX     @DPTR,A
003C28 A3                INC      DPTR
003C29 22                RET      
----- FUNCTION ?L?COM0145 (END) -------


----- FUNCTION _IsSaved_split (BEGIN) -----
003C2A 91F4              ACALL    ?L?COM04CF
003C2C 122572            LCALL    ?C?PSTXDATA
003C2F E4                CLR      A
003C30 9041EE            MOV      DPTR,#bPages
003C33 F0                MOVX     @DPTR,A
003C34 A3                INC      DPTR
003C35 04                INC      A
003C36 F0                MOVX     @DPTR,A
003C37         ?C0167?ZW_PHY_GENERIC_SPI_IF:
003C37 9041EB            MOV      DPTR,#length
003C3A F1ED              ACALL    ?L?COM03C3
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 31


003C3C 7002              JNZ      $ + 4H
003C3E 81C3              AJMP     ?C0168?ZW_PHY_GENERIC_SPI_IF
003C40 D3                SETB     C
003C41 EF                MOV      A,R7
003C42 9420              SUBB     A,#020H
003C44 EE                MOV      A,R6
003C45 9400              SUBB     A,#00H
003C47 4004              JC       ?C0169?ZW_PHY_GENERIC_SPI_IF
003C49 7F20              MOV      R7,#020H
003C4B 8006              SJMP     ?C0170?ZW_PHY_GENERIC_SPI_IF
003C4D         ?C0169?ZW_PHY_GENERIC_SPI_IF:
003C4D 9041EB            MOV      DPTR,#length
003C50 A3                INC      DPTR
003C51 E0                MOVX     A,@DPTR
003C52 FF                MOV      R7,A
003C53         ?C0170?ZW_PHY_GENERIC_SPI_IF:
003C53 9041ED            MOV      DPTR,#bSubBufferLength
003C56 EF                MOV      A,R7
003C57 F0                MOVX     @DPTR,A
003C58 9041E8            MOV      DPTR,#buf
003C5B 122552            LCALL    ?C?PLDXDATA
003C5E 9041ED            MOV      DPTR,#bSubBufferLength
003C61 E0                MOVX     A,@DPTR
003C62 903E4C            MOV      DPTR,#?_IsSaved_long?BYTE+07H
003C65 126E84            LCALL    ?L?COM02D6
003C68 9041E4            MOV      DPTR,#offset
003C6B 122462            LCALL    ?C?LLDXDATA
003C6E B114              ACALL    _IsSaved_long
003C70 400E              JC       ?C0171?ZW_PHY_GENERIC_SPI_IF
003C72 9041EE            MOV      DPTR,#bPages
003C75 E0                MOVX     A,@DPTR
003C76 FF                MOV      R7,A
003C77 A3                INC      DPTR
003C78 E0                MOVX     A,@DPTR
003C79 FE                MOV      R6,A
003C7A EF                MOV      A,R7
003C7B 4E                ORL      A,R6
003C7C 9041EE            MOV      DPTR,#bPages
003C7F F0                MOVX     @DPTR,A
003C80         ?C0171?ZW_PHY_GENERIC_SPI_IF:
003C80 9041ED            MOV      DPTR,#bSubBufferLength
003C83 E0                MOVX     A,@DPTR
003C84 FF                MOV      R7,A
003C85 C3                CLR      C
003C86 9041EC            MOV      DPTR,#length+01H
003C89 E0                MOVX     A,@DPTR
003C8A 9F                SUBB     A,R7
003C8B F0                MOVX     @DPTR,A
003C8C 9041EB            MOV      DPTR,#length
003C8F E0                MOVX     A,@DPTR
003C90 9400              SUBB     A,#00H
003C92 F0                MOVX     @DPTR,A
003C93 9041E4            MOV      DPTR,#offset
003C96 12247E            LCALL    ?C?LLDXDATA0
003C99 9041ED            MOV      DPTR,#bSubBufferLength
003C9C 127065            LCALL    ?L?COM0544
003C9F 91F4              ACALL    ?L?COM04CF
003CA1 122552            LCALL    ?C?PLDXDATA
003CA4 E9                MOV      A,R1
003CA5 4A                ORL      A,R2
003CA6 6007              JZ       ?C0172?ZW_PHY_GENERIC_SPI_IF
003CA8 9041ED            MOV      DPTR,#bSubBufferLength
003CAB E0                MOVX     A,@DPTR
003CAC FF                MOV      R7,A
003CAD 8002              SJMP     ?C0173?ZW_PHY_GENERIC_SPI_IF
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 32


003CAF         ?C0172?ZW_PHY_GENERIC_SPI_IF:
003CAF 7F00              MOV      R7,#00H
003CB1         ?C0173?ZW_PHY_GENERIC_SPI_IF:
003CB1 9041E9            MOV      DPTR,#buf+01H
003CB4 E4                CLR      A
003CB5 8FF0              MOV      B,R7
003CB7 12210C            LCALL    ?C?IILDX
003CBA 9041EF            MOV      DPTR,#flag
003CBD E0                MOVX     A,@DPTR
003CBE 25E0              ADD      A,ACC
003CC0 F0                MOVX     @DPTR,A
003CC1 8137              AJMP     ?C0167?ZW_PHY_GENERIC_SPI_IF
003CC3         ?C0168?ZW_PHY_GENERIC_SPI_IF:
003CC3 9041EE            MOV      DPTR,#bPages
003CC6 E0                MOVX     A,@DPTR
003CC7 FF                MOV      R7,A
003CC8 22                RET      
----- FUNCTION _IsSaved_split (END) -------


----- FUNCTION ?L?COM021F (BEGIN) -----
003CC9 904184            MOV      DPTR,#i
003CCC E0                MOVX     A,@DPTR
003CCD FF                MOV      R7,A
003CCE A3                INC      DPTR
003CCF E0                MOVX     A,@DPTR
003CD0 9041EB            MOV      DPTR,#?_IsSaved_split?BYTE+07H
003CD3 CF                XCH      A,R7
003CD4 F0                MOVX     @DPTR,A
003CD5 A3                INC      DPTR
003CD6 EF                MOV      A,R7
003CD7 F0                MOVX     @DPTR,A
003CD8 90417B            MOV      DPTR,#offset
003CDB 122462            LCALL    ?C?LLDXDATA
003CDE 912A              ACALL    _IsSaved_split
003CE0 904188            MOV      DPTR,#bSubBuffers
003CE3 EF                MOV      A,R7
003CE4 F0                MOVX     @DPTR,A
003CE5 22                RET      
----- FUNCTION ?L?COM021F (END) -------


----- FUNCTION ?L?COM0452 (BEGIN) -----
003CE6 E0                MOVX     A,@DPTR
003CE7 FC                MOV      R4,A
003CE8 A3                INC      DPTR
003CE9 E0                MOVX     A,@DPTR
003CEA FD                MOV      R5,A
003CEB D3                SETB     C
003CEC 22                RET      
----- FUNCTION ?L?COM0452 (END) -------


----- FUNCTION ?L?COM04D8 (BEGIN) -----
003CED 9003C2            MOV      DPTR,#bMainWakeUpReason
003CF0 E0                MOVX     A,@DPTR
003CF1 6401              XRL      A,#01H
003CF3 22                RET      
----- FUNCTION ?L?COM04D8 (END) -------


----- FUNCTION ?L?COM04CF (BEGIN) -----
003CF4 9041E4            MOV      DPTR,#offset
003CF7 1224BA            LCALL    ?C?LSTXDATA
003CFA 9041E8            MOV      DPTR,#buf
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 33


003CFD 22                RET      
----- FUNCTION ?L?COM04CF (END) -------


----- FUNCTION ?L?COM02D7 (BEGIN) -----
003CFE E9                MOV      A,R1
003CFF 2F                ADD      A,R7
003D00 F9                MOV      R1,A
003D01 EE                MOV      A,R6
003D02 3A                ADDC     A,R2
003D03 FA                MOV      R2,A
003D04 904186            MOV      DPTR,#wLength
003D07 E0                MOVX     A,@DPTR
003D08 FF                MOV      R7,A
003D09 A3                INC      DPTR
003D0A E0                MOVX     A,@DPTR
003D0B 9042A5            MOV      DPTR,#?_NVMPutArray_long?BYTE+07H
003D0E CF                XCH      A,R7
003D0F F0                MOVX     @DPTR,A
003D10 A3                INC      DPTR
003D11 EF                MOV      A,R7
003D12 F0                MOVX     @DPTR,A
003D13 22                RET      
----- FUNCTION ?L?COM02D7 (END) -------


----- FUNCTION _IsSaved_long (BEGIN) -----
003D14 903E45            MOV      DPTR,#offset
003D17 1224BA            LCALL    ?C?LSTXDATA
003D1A 903E49            MOV      DPTR,#buf
003D1D 122572            LCALL    ?C?PSTXDATA
003D20 E4                CLR      A
003D21 903E6E            MOV      DPTR,#i
003D24 F0                MOVX     @DPTR,A
003D25 D3                SETB     C
003D26 903E4D            MOV      DPTR,#length+01H
003D29 E0                MOVX     A,@DPTR
003D2A 9420              SUBB     A,#020H
003D2C 903E4C            MOV      DPTR,#length
003D2F E0                MOVX     A,@DPTR
003D30 9400              SUBB     A,#00H
003D32 4001              JC       ?C0159?ZW_PHY_GENERIC_SPI_IF
003D34 22                RET      
003D35         ?C0159?ZW_PHY_GENERIC_SPI_IF:
003D35 7B01              MOV      R3,#01H
003D37 7A3E              MOV      R2,#HIGH dataFlash
003D39 794E              MOV      R1,#LOW dataFlash
003D3B 903E4C            MOV      DPTR,#length
003D3E 126F51            LCALL    ?L?COM03FD
003D41 F0                MOVX     @DPTR,A
003D42 903E45            MOV      DPTR,#offset
003D45 122462            LCALL    ?C?LLDXDATA
003D48 1117              ACALL    _NVM_ext_read_long_buffer
003D4A         ?C0163?ZW_PHY_GENERIC_SPI_IF:
003D4A 903E49            MOV      DPTR,#buf
003D4D 122552            LCALL    ?C?PLDXDATA
003D50 E9                MOV      A,R1
003D51 4A                ORL      A,R2
003D52 6009              JZ       ?C0165?ZW_PHY_GENERIC_SPI_IF
003D54 903E6E            MOV      DPTR,#i
003D57 126E9E            LCALL    ?L?COM02F3
003D5A FF                MOV      R7,A
003D5B 8002              SJMP     ?C0166?ZW_PHY_GENERIC_SPI_IF
003D5D         ?C0165?ZW_PHY_GENERIC_SPI_IF:
003D5D 7F00              MOV      R7,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 34


003D5F         ?C0166?ZW_PHY_GENERIC_SPI_IF:
003D5F 903E6E            MOV      DPTR,#i
003D62 E0                MOVX     A,@DPTR
003D63 244E              ADD      A,#LOW dataFlash
003D65 F582              MOV      DPL,A
003D67 E4                CLR      A
003D68 343E              ADDC     A,#HIGH dataFlash
003D6A F583              MOV      DPH,A
003D6C E0                MOVX     A,@DPTR
003D6D 6F                XRL      A,R7
003D6E 6002              JZ       ?C0161?ZW_PHY_GENERIC_SPI_IF
003D70 C3                CLR      C
003D71 22                RET      
003D72         ?C0161?ZW_PHY_GENERIC_SPI_IF:
003D72 903E6E            MOV      DPTR,#i
003D75 E0                MOVX     A,@DPTR
003D76 04                INC      A
003D77 FF                MOV      R7,A
003D78 F0                MOVX     @DPTR,A
003D79 D3                SETB     C
003D7A 903E4D            MOV      DPTR,#length+01H
003D7D E0                MOVX     A,@DPTR
003D7E 9F                SUBB     A,R7
003D7F 903E4C            MOV      DPTR,#length
003D82 E0                MOVX     A,@DPTR
003D83 9400              SUBB     A,#00H
003D85 50C3              JNC      ?C0163?ZW_PHY_GENERIC_SPI_IF
003D87 22                RET      
----- FUNCTION _IsSaved_long (END) -------


----- FUNCTION ?L?COM0482 (BEGIN) -----
003D88 AF82              MOV      R7,DPL
003D8A AE83              MOV      R6,DPH
003D8C 7D01              MOV      R5,#01H
----- FUNCTION _RFReceiveRestart (BEGIN) -----
003D8E 900A68            MOV      DPTR,#buffer
003D91 9123              ACALL    ?L?COM0146
003D93 122572            LCALL    ?C?PSTXDATA
003D96 E514              MOV      A,RF_state
003D98 7078              JNZ      ?C0076?ZW_RF_DRIVER
003D9A 1253CD            LCALL    ?L?COM042C
003D9D 5004              JNC      ?C0064?ZW_RF_DRIVER
003D9F C236              CLR      ?RF_demodulator_enable?BIT
003DA1 D113              ACALL    RF_demodulator_enable
003DA3         ?C0064?ZW_RF_DRIVER:
003DA3 900A68            MOV      DPTR,#buffer
003DA6 E0                MOVX     A,@DPTR
003DA7 FE                MOV      R6,A
003DA8 A3                INC      DPTR
003DA9 E0                MOVX     A,@DPTR
003DAA 8E11              MOV      RF_data_addr,R6
003DAC F512              MOV      RF_data_addr+01H,A
003DAE A3                INC      DPTR
003DAF 122552            LCALL    ?C?PLDXDATA
003DB2 90093C            MOV      DPTR,#RF_rssi_samples
003DB5 122572            LCALL    ?C?PSTXDATA
003DB8 AE11              MOV      R6,RF_data_addr
003DBA AF12              MOV      R7,RF_data_addr+01H
003DBC 7DAA              MOV      R5,#0AAH
003DBE 126B7F            LCALL    _ZW_FH_rx_init
003DC1 E4                CLR      A
003DC2 F5FF              MOV      SFRPAGE,A
003DC4 75D901            MOV      FHINTLVL,#01H
003DC7 F510              MOV      demodState,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 35


003DC9 E515              MOV      A,RF_status
003DCB 5421              ANL      A,#021H
003DCD 602B              JZ       ?C0065?ZW_RF_DRIVER
003DCF E515              MOV      A,RF_status
003DD1 30E504            JNB      ACC.5,?C0066?ZW_RF_DRIVER
003DD4 E4                CLR      A
003DD5 FF                MOV      R7,A
003DD6 F148              ACALL    _RF_channel_set
003DD8         ?C0066?ZW_RF_DRIVER:
003DD8 E4                CLR      A
003DD9 900A6D            MOV      DPTR,#bRestartCount
003DDC F0                MOVX     @DPTR,A
003DDD         ?C0069?ZW_RF_DRIVER:
003DDD 900A6D            MOV      DPTR,#bRestartCount
003DE0 E0                MOVX     A,@DPTR
003DE1 04                INC      A
003DE2 F0                MOVX     @DPTR,A
003DE3 12623B            LCALL    RF_switch_to_RX
;---- Variable 'bSwitchStatus' assigned to Register 'R7' ----
003DE6         ?C0070?ZW_RF_DRIVER:
003DE6         ?C0067?ZW_RF_DRIVER:
003DE6 EF                MOV      A,R7
003DE7 6009              JZ       ?C0068?ZW_RF_DRIVER
003DE9 900A6D            MOV      DPTR,#bRestartCount
003DEC E0                MOVX     A,@DPTR
003DED C3                CLR      C
003DEE 9410              SUBB     A,#010H
003DF0 40EB              JC       ?C0069?ZW_RF_DRIVER
003DF2         ?C0068?ZW_RF_DRIVER:
003DF2 7F02              MOV      R7,#02H
003DF4 121E67            LCALL    ?INTERBANK_TABLE?_ApplicationRfNotify
003DF7 5315DE            ANL      RF_status,#0DEH
003DFA         ?C0065?ZW_RF_DRIVER:
003DFA 900938            MOV      DPTR,#rfRxCurrentSpeed
003DFD E0                MOVX     A,@DPTR
003DFE 7F00              MOV      R7,#00H
003E00 B40302            CJNE     A,#03H,?C0074?ZW_RF_DRIVER
003E03 7F01              MOV      R7,#01H
003E05         ?C0074?ZW_RF_DRIVER:
003E05         ?C0075?ZW_RF_DRIVER:
;---- Variable 'bNextRFChannel' assigned to Register 'R7' ----
003E05 125CAA            LCALL    ?L?COM0297
003E08 D236              SETB     ?RF_demodulator_enable?BIT
003E0A D113              ACALL    RF_demodulator_enable
003E0C D2EB              SETB     ERF
003E0E A217              MOV      C,fEUSB
003E10 92ED              MOV      EUSB,C
003E12         ?C0076?ZW_RF_DRIVER:
003E12 22                RET      
----- FUNCTION _RFReceiveRestart (END) -------


----- FUNCTION RF_demodulator_enable (BEGIN) -----
003E13 90469C            MOV      DPTR,#setting
003E16 E5F4              MOV      A,DMCTRL
003E18 F0                MOVX     @DPTR,A
003E19 E0                MOVX     A,@DPTR
003E1A 547F              ANL      A,#07FH
003E1C F5F4              MOV      DMCTRL,A
003E1E 7F82              MOV      R7,#082H
003E20 7E00              MOV      R6,#00H
003E22 F12A              ACALL    ?L?COM0302
003E24         ?C0193?ZW_PHY_RF_050X:
003E24 F12F              ACALL    phy_timer_runs
003E26 5005              JNC      ?C0194?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 36


003E28 E5FC              MOV      A,SEQCON
003E2A 20E6F7            JB       ACC.6,?C0193?ZW_PHY_RF_050X
003E2D         ?C0194?ZW_PHY_RF_050X:
003E2D 303608            JNB      enable,?C0197?ZW_PHY_RF_050X
003E30 90469C            MOV      DPTR,#setting
003E33 E0                MOVX     A,@DPTR
003E34 4480              ORL      A,#080H
003E36 F5F4              MOV      DMCTRL,A
003E38         ?C0197?ZW_PHY_RF_050X:
003E38 F126              ACALL    ?L?COM0301
003E3A         ?C0198?ZW_PHY_RF_050X:
003E3A F12F              ACALL    phy_timer_runs
003E3C 5005              JNC      ?C0199?ZW_PHY_RF_050X
003E3E E5FC              MOV      A,SEQCON
003E40 20E6F7            JB       ACC.6,?C0198?ZW_PHY_RF_050X
003E43         ?C0199?ZW_PHY_RF_050X:
003E43 75FF01            MOV      SFRPAGE,#01H
003E46 E5D5              MOV      A,RFCON
003E48 20E702            JB       ACC.7,?C0202?ZW_PHY_RF_050X
003E4B C3                CLR      C
003E4C 22                RET      
003E4D         ?C0202?ZW_PHY_RF_050X:
003E4D E5F4              MOV      A,DMCTRL
003E4F D3                SETB     C
003E50 30E601            JNB      ACC.6,?C0204?ZW_PHY_RF_050X
003E53 C3                CLR      C
003E54         ?C0204?ZW_PHY_RF_050X:
003E54 22                RET      
----- FUNCTION RF_demodulator_enable (END) -------


----- FUNCTION _RF_WaitForSOForTimeout (BEGIN) -----
003E55 900AD0            MOV      DPTR,#bChannel
003E58 EF                MOV      A,R7
003E59 F0                MOVX     @DPTR,A
003E5A C237              CLR      ?RF_demodulator_enable_fast?BIT
003E5C 126182            LCALL    RF_demodulator_enable_fast
003E5F D220              SETB     ?RF_sensor_mode_enable?BIT
003E61 900AD0            MOV      DPTR,#bChannel
003E64 E0                MOVX     A,@DPTR
003E65 9045D0            MOV      DPTR,#?RF_sensor_mode_enable?BYTE
003E68 F0                MOVX     @DPTR,A
003E69 D221              SETB     ?RF_sensor_mode_enable?BIT+01H
003E6B A3                INC      DPTR
003E6C E4                CLR      A
003E6D F0                MOVX     @DPTR,A
003E6E A3                INC      DPTR
003E6F 740D              MOV      A,#0DH
003E71 F0                MOVX     @DPTR,A
003E72 1260D1            LCALL    RF_sensor_mode_enable
003E75 E4                CLR      A
003E76 900AD1            MOV      DPTR,#res
003E79 F0                MOVX     @DPTR,A
003E7A         ?C0190?ZW_RF_DRIVER:
003E7A 1253D5            LCALL    RF_demodulator_enable_get
003E7D 5076              JNC      ?C0191?ZW_RF_DRIVER
003E7F 900AD1            MOV      DPTR,#res
003E82 E0                MOVX     A,@DPTR
003E83 7070              JNZ      ?C0191?ZW_RF_DRIVER
003E85 E5F7              MOV      A,DMSTAT1
003E87 54C0              ANL      A,#0C0H
003E89 60EF              JZ       ?C0190?ZW_RF_DRIVER
003E8B F10B              ACALL    RF_byte_get
003E8D F11E              ACALL    ?L?COM03AB
003E8F 6455              XRL      A,#055H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 37


003E91 704E              JNZ      ?C0193?ZW_RF_DRIVER
003E93 F11E              ACALL    ?L?COM03AB
003E95 901221            MOV      DPTR,#nodeID
003E98 E0                MOVX     A,@DPTR
003E99 6F                XRL      A,R7
003E9A 600E              JZ       ?C0195?ZW_RF_DRIVER
003E9C 900AD1            MOV      DPTR,#res
003E9F E0                MOVX     A,@DPTR
003EA0 F4                CPL      A
003EA1 7039              JNZ      ?C0194?ZW_RF_DRIVER
003EA3 901215            MOV      DPTR,#bFLiRSStatus
003EA6 E0                MOVX     A,@DPTR
003EA7 30E132            JNB      ACC.1,?C0194?ZW_RF_DRIVER
003EAA         ?C0195?ZW_RF_DRIVER:
003EAA F11E              ACALL    ?L?COM03AB
003EAC 6455              XRL      A,#055H
003EAE 6018              JZ       ?C0197?ZW_RF_DRIVER
003EB0 E0                MOVX     A,@DPTR
003EB1 FF                MOV      R7,A
003EB2 644A              XRL      A,#04AH
003EB4 6012              JZ       ?C0197?ZW_RF_DRIVER
003EB6 EF                MOV      A,R7
003EB7 640A              XRL      A,#0AH
003EB9 600D              JZ       ?C0197?ZW_RF_DRIVER
003EBB 901221            MOV      DPTR,#nodeID
003EBE E0                MOVX     A,@DPTR
003EBF FF                MOV      R7,A
003EC0 900AD1            MOV      DPTR,#res
003EC3 E0                MOVX     A,@DPTR
003EC4 FE                MOV      R6,A
003EC5 6F                XRL      A,R7
003EC6 7005              JNZ      ?C0196?ZW_RF_DRIVER
003EC8         ?C0197?ZW_RF_DRIVER:
003EC8 900AD1            MOV      DPTR,#res
003ECB 800A              SJMP     ?C0253?ZW_RF_DRIVER
003ECD         ?C0196?ZW_RF_DRIVER:
003ECD 900939            MOV      DPTR,#bHomeIDHash
003ED0 E0                MOVX     A,@DPTR
003ED1 6E                XRL      A,R6
003ED2 900AD1            MOV      DPTR,#res
003ED5 7019              JNZ      ?C0255?ZW_RF_DRIVER
003ED7         
003ED7 7402              MOV      A,#02H
003ED9 F0                MOVX     @DPTR,A
003EDA 809E              SJMP     ?C0190?ZW_RF_DRIVER
003EDC         ?C0194?ZW_RF_DRIVER:
003EDC 900AD1            MOV      DPTR,#res
003EDF         
003EDF 800F              SJMP     ?C0255?ZW_RF_DRIVER
003EE1         ?C0193?ZW_RF_DRIVER:
003EE1 900AD1            MOV      DPTR,#res
003EE4 E0                MOVX     A,@DPTR
003EE5 B45405            CJNE     A,#054H,?C0203?ZW_RF_DRIVER
003EE8 7433              MOV      A,#033H
003EEA F0                MOVX     @DPTR,A
003EEB 808D              SJMP     ?C0190?ZW_RF_DRIVER
003EED         ?C0203?ZW_RF_DRIVER:
003EED 900AD1            MOV      DPTR,#res
003EF0         
003EF0 7401              MOV      A,#01H
003EF2 F0                MOVX     @DPTR,A
003EF3 8085              SJMP     ?C0190?ZW_RF_DRIVER
003EF5         ?C0191?ZW_RF_DRIVER:
003EF5 900AD1            MOV      DPTR,#res
003EF8 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 38


003EF9 B40206            CJNE     A,#02H,?C0205?ZW_RF_DRIVER
003EFC C236              CLR      ?RF_demodulator_enable?BIT
003EFE D113              ACALL    RF_demodulator_enable
003F00 8000              SJMP     ?C0252?ZW_RF_DRIVER
003F02         ?C0205?ZW_RF_DRIVER:
003F02         
003F02 1260C4            LCALL    ?L?COM0341
003F05         ?C0206?ZW_RF_DRIVER:
003F05 900AD1            MOV      DPTR,#res
003F08 E0                MOVX     A,@DPTR
003F09 FF                MOV      R7,A
003F0A 22                RET      
----- FUNCTION _RF_WaitForSOForTimeout (END) -------


----- FUNCTION RF_byte_get (BEGIN) -----
003F0B         ?C0260?ZW_PHY_RF_050X:
003F0B E5F7              MOV      A,DMSTAT1
003F0D 20E008            JB       ACC.0,?C0261?ZW_PHY_RF_050X
003F10 E5F7              MOV      A,DMSTAT1
003F12 54C0              ANL      A,#0C0H
003F14 70F5              JNZ      ?C0260?ZW_PHY_RF_050X
003F16 FF                MOV      R7,A
003F17 22                RET      
003F18         ?C0261?ZW_PHY_RF_050X:
003F18 43F701            ORL      DMSTAT1,#01H
003F1B AFF9              MOV      R7,DMOUT
003F1D 22                RET      
----- FUNCTION RF_byte_get (END) -------


----- FUNCTION ?L?COM03AB (BEGIN) -----
003F1E F10B              ACALL    RF_byte_get
003F20 900AD1            MOV      DPTR,#res
003F23 EF                MOV      A,R7
003F24 F0                MOVX     @DPTR,A
003F25 22                RET      
----- FUNCTION ?L?COM03AB (END) -------


----- FUNCTION ?L?COM0301 (BEGIN) -----
003F26 7FE8              MOV      R7,#0E8H
003F28 7E03              MOV      R6,#03H
003F2A         ?L?COM0302:
003F2A 126448            LCALL    _set_phy_timer_timeout_max
003F2D 8012              SJMP     start_phy_timer
----- FUNCTION ?L?COM0301 (END) -------


----- FUNCTION phy_timer_runs (BEGIN) -----
003F2F 75FF03            MOV      SFRPAGE,#03H
003F32 E591              MOV      A,PHYTCON1
003F34 C3                CLR      C
003F35 30E701            JNB      ACC.7,?C0018?ZW_PHY_RF_050X
003F38 D3                SETB     C
003F39         ?C0018?ZW_PHY_RF_050X:
003F39 22                RET      
----- FUNCTION phy_timer_runs (END) -------


----- FUNCTION ?L?COM022F (BEGIN) -----
003F3A 7FC8              MOV      R7,#0C8H
003F3C         ?L?COM0230:
003F3C 7E00              MOV      R6,#00H
003F3E 1260A7            LCALL    _set_phy_timer_timeout
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 39


----- FUNCTION start_phy_timer (BEGIN) -----
003F41 75FF03            MOV      SFRPAGE,#03H
003F44 439180            ORL      PHYTCON1,#080H
003F47 22                RET      
----- FUNCTION start_phy_timer (END) -------


----- FUNCTION _RF_channel_set (BEGIN) -----
;---- Variable 'chsel' assigned to Register 'R7' ----
003F48 75FF01            MOV      SFRPAGE,#01H
003F4B E5D5              MOV      A,RFCON
003F4D 30E602            JNB      ACC.6,?C0191?ZW_PHY_RF_050X
003F50 C3                CLR      C
003F51 22                RET      
003F52         ?C0191?ZW_PHY_RF_050X:
003F52 E4                CLR      A
003F53 F5FF              MOV      SFRPAGE,A
003F55 439A80            ORL      DMLSFLT1,#080H
003F58 EF                MOV      A,R7
003F59 124FEF            LCALL    ?L?COM03F9
003F5C E4                CLR      A
003F5D F5FF              MOV      SFRPAGE,A
003F5F 539A7F            ANL      DMLSFLT1,#07FH
003F62 D3                SETB     C
003F63 22                RET      
----- FUNCTION _RF_channel_set (END) -------


----- FUNCTION _RF_lbt_get_rssi (BEGIN) -----
003F64 90455A            MOV      DPTR,#bChannel
003F67 EF                MOV      A,R7
003F68 F0                MOVX     @DPTR,A
003F69 A3                INC      DPTR
003F6A 12663F            LCALL    ?L?COM040F
003F6D F0                MOVX     @DPTR,A
003F6E 75FF01            MOV      SFRPAGE,#01H
003F71 126481            LCALL    RF_mode_get
003F74 EF                MOV      A,R7
003F75 6401              XRL      A,#01H
003F77 6002              JZ       ?C0287?ZW_PHY_RF_050X
003F79 C3                CLR      C
003F7A 22                RET      
003F7B         ?C0287?ZW_PHY_RF_050X:
003F7B E5F4              MOV      A,DMCTRL
003F7D 30E602            JNB      ACC.6,?C0289?ZW_PHY_RF_050X
003F80 C3                CLR      C
003F81 22                RET      
003F82         ?C0289?ZW_PHY_RF_050X:
003F82 7FE8              MOV      R7,#0E8H
003F84 7E03              MOV      R6,#03H
003F86 1260A7            LCALL    _set_phy_timer_timeout
003F89 F141              ACALL    start_phy_timer
003F8B 126832            LCALL    _wait_until_no_preamble
003F8E 4001              JC       ?C0290?ZW_PHY_RF_050X
003F90 22                RET      
003F91         ?C0290?ZW_PHY_RF_050X:
003F91 C236              CLR      ?RF_demodulator_enable?BIT
003F93 D113              ACALL    RF_demodulator_enable
003F95 90455A            MOV      DPTR,#bChannel
003F98 E0                MOVX     A,@DPTR
003F99 FF                MOV      R7,A
003F9A F148              ACALL    _RF_channel_set
003F9C 53F4DF            ANL      DMCTRL,#0DFH
003F9F D236              SETB     ?RF_demodulator_enable?BIT
003FA1 D113              ACALL    RF_demodulator_enable
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 40


003FA3 7F78              MOV      R7,#078H
003FA5 7E00              MOV      R6,#00H
003FA7 1261CF            LCALL    _wait_phy_timer_elapse
003FAA 75FF01            MOV      SFRPAGE,#01H
003FAD 53E4BF            ANL      SDCON1,#0BFH
003FB0         ?C0291?ZW_PHY_RF_050X:
003FB0 E5E4              MOV      A,SDCON1
003FB2 30E7FB            JNB      ACC.7,?C0291?ZW_PHY_RF_050X
003FB5         ?C0292?ZW_PHY_RF_050X:
003FB5 12656A            LCALL    ?L?COM04D1
003FB8 7F8A              MOV      R7,#08AH
003FBA 12642B            LCALL    ?L?COM0526
003FBD 30E609            JNB      ACC.6,?C0293?ZW_PHY_RF_050X
003FC0 90455B            MOV      DPTR,#rssi_value
003FC3 124FE5            LCALL    ?L?COM02A0
003FC6 E4                CLR      A
003FC7 800B              SJMP     ?C0311?ZW_PHY_RF_050X
003FC9         ?C0293?ZW_PHY_RF_050X:
003FC9 75FF01            MOV      SFRPAGE,#01H
003FCC 90455B            MOV      DPTR,#rssi_value
003FCF 124FE5            LCALL    ?L?COM02A0
003FD2 E5D9              MOV      A,DFSTAT
003FD4         
003FD4 12203B            LCALL    ?C?CSTPTR
003FD7         ?C0294?ZW_PHY_RF_050X:
003FD7 75FF01            MOV      SFRPAGE,#01H
003FDA 43E440            ORL      SDCON1,#040H
003FDD 126593            LCALL    ?L?COM02F0
003FE0 4003              JC       ?C0295?ZW_PHY_RF_050X
003FE2 43F420            ORL      DMCTRL,#020H
003FE5         ?C0295?ZW_PHY_RF_050X:
003FE5 126832            LCALL    _wait_until_no_preamble
003FE8 4001              JC       ?C0296?ZW_PHY_RF_050X
003FEA 22                RET      
003FEB         ?C0296?ZW_PHY_RF_050X:
003FEB D3                SETB     C
003FEC 22                RET      
----- FUNCTION _RF_lbt_get_rssi (END) -------


----- FUNCTION ?L?COM03C3 (BEGIN) -----
003FED E0                MOVX     A,@DPTR
003FEE FE                MOV      R6,A
003FEF A3                INC      DPTR
003FF0 E0                MOVX     A,@DPTR
003FF1 FF                MOV      R7,A
003FF2 4E                ORL      A,R6
003FF3 22                RET      
----- FUNCTION ?L?COM03C3 (END) -------


----- FUNCTION ?L?COM057E (BEGIN) -----
003FF4 31FB              ACALL    _NVM_ext_write_buffer
003FF6 74FF              MOV      A,#0FFH
003FF8 FD                MOV      R5,A
003FF9 FC                MOV      R4,A
003FFA 22                RET      
----- FUNCTION ?L?COM057E (END) -------


----- FUNCTION main_ApplicationStateUpdate (BEGIN) -----
003FFB 9003C7            MOV      DPTR,#eProtocolState
003FFE E0                MOVX     A,@DPTR
003FFF FF                MOV      R7,A
004000 121E44            LCALL    ?INTERBANK_TABLE?_ApplicationPoll
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 41


004003 9003CC            MOV      DPTR,#eApplicationState
004006 EF                MOV      A,R7
004007 F0                MOVX     @DPTR,A
004008 22                RET      
----- FUNCTION main_ApplicationStateUpdate (END) -------


----- FUNCTION main_ApplicationStateIsActive (BEGIN) -----
004009 9003CC            MOV      DPTR,#eApplicationState
00400C E0                MOVX     A,@DPTR
00400D 7F00              MOV      R7,#00H
00400F 7002              JNZ      ?C0008?ZW_MAIN
004011 7F01              MOV      R7,#01H
004013         ?C0008?ZW_MAIN:
004013 22                RET      
----- FUNCTION main_ApplicationStateIsActive (END) -------


----- FUNCTION main_ProtocolStateSetActive (BEGIN) -----
004014 E4                CLR      A
004015 9003C7            MOV      DPTR,#eProtocolState
004018 F0                MOVX     @DPTR,A
004019 22                RET      
----- FUNCTION main_ProtocolStateSetActive (END) -------


----- FUNCTION main_ProtocolStateSetShutdownPending (BEGIN) -----
00401A 9003C7            MOV      DPTR,#eProtocolState
00401D 7401              MOV      A,#01H
00401F F0                MOVX     @DPTR,A
004020 22                RET      
----- FUNCTION main_ProtocolStateSetShutdownPending (END) -------


----- FUNCTION main_ProtocolStateSetShutdownReady (BEGIN) -----
004021 9003C7            MOV      DPTR,#eProtocolState
004024 7402              MOV      A,#02H
004026 F0                MOVX     @DPTR,A
004027 22                RET      
----- FUNCTION main_ProtocolStateSetShutdownReady (END) -------


----- FUNCTION main_ProtocolStateIsActive (BEGIN) -----
004028 112F              ACALL    ?L?COM04D9
00402A 7002              JNZ      ?C0014?ZW_MAIN
00402C 7F01              MOV      R7,#01H
00402E         ?C0014?ZW_MAIN:
00402E 22                RET      
----- FUNCTION main_ProtocolStateIsActive (END) -------


----- FUNCTION ?L?COM04D9 (BEGIN) -----
00402F 9003C7            MOV      DPTR,#eProtocolState
004032 E0                MOVX     A,@DPTR
004033 7F00              MOV      R7,#00H
004035 22                RET      
----- FUNCTION ?L?COM04D9 (END) -------


----- FUNCTION main_ProtocolStateIsReadyForShutdown (BEGIN) -----
004036 112F              ACALL    ?L?COM04D9
004038 B40202            CJNE     A,#02H,?C0020?ZW_MAIN
00403B 7F01              MOV      R7,#01H
00403D         ?C0020?ZW_MAIN:
00403D 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 42


----- FUNCTION main_ProtocolStateIsReadyForShutdown (END) -------


----- FUNCTION ZW_WatchDogEnable (BEGIN) -----
00403E 75FF02            MOV      SFRPAGE,#02H
004041 75E404            MOV      WDTCON,#04H
004044 75E401            MOV      WDTCON,#01H
004047 75E402            MOV      WDTCON,#02H
00404A 22                RET      
----- FUNCTION ZW_WatchDogEnable (END) -------


----- FUNCTION ZW_WatchDogDisable (BEGIN) -----
00404B 75FF02            MOV      SFRPAGE,#02H
00404E 75E404            MOV      WDTCON,#04H
004051 E4                CLR      A
004052 F5E4              MOV      WDTCON,A
004054 22                RET      
----- FUNCTION ZW_WatchDogDisable (END) -------


----- FUNCTION main_PowerDown_Setup (BEGIN) -----
004055 12593A            LCALL    getTickTime
004058 9003CA            MOV      DPTR,#bSleepWaitTimeout
00405B EE                MOV      A,R6
00405C F0                MOVX     @DPTR,A
00405D A3                INC      DPTR
00405E EF                MOV      A,R7
00405F F0                MOVX     @DPTR,A
004060 22                RET      
----- FUNCTION main_PowerDown_Setup (END) -------


----- FUNCTION _ZCB_NetworkManagementExploreRequestComplete (BEGIN) -----
004061 125F32            LCALL    NetworkManagementSmartStartIsInclude
004064 EF                MOV      A,R7
004065 7008              JNZ      ?C0031?ZW_NETWORK_MANAGEMENT
004067 7FA0              MOV      R7,#0A0H
004069 7E0F              MOV      R6,#0FH
00406B FD                MOV      R5,A
00406C FC                MOV      R4,A
00406D 2102              AJMP     ?C0104?ZW_NETWORK_MANAGEMENT
00406F         ?C0031?ZW_NETWORK_MANAGEMENT:
00406F 125F69            LCALL    NetworkManagementSmartStartCurrentRequestNo
004072 9041D9            MOV      DPTR,#bRequestNo
004075 EF                MOV      A,R7
004076 F0                MOVX     @DPTR,A
004077 7406              MOV      A,#06H
004079 D3                SETB     C
00407A 9F                SUBB     A,R7
00407B 4067              JC       ?C0033?ZW_NETWORK_MANAGEMENT
00407D E0                MOVX     A,@DPTR
00407E 605A              JZ       ?C0034?ZW_NETWORK_MANAGEMENT
004080 3187              ACALL    ?L?COM052A
004082 7E00              MOV      R6,#00H
004084 9041D9            MOV      DPTR,#bRequestNo
004087 E0                MOVX     A,@DPTR
004088 14                DEC      A
004089 FD                MOV      R5,A
00408A E5F0              MOV      A,B
00408C A805              MOV      R0,AR5
00408E 08                INC      R0
00408F 8005              SJMP     ?C0098?ZW_NETWORK_MANAGEMENT
004091         ?C0097?ZW_NETWORK_MANAGEMENT:
004091 C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 43


004092 33                RLC      A
004093 CE                XCH      A,R6
004094 33                RLC      A
004095 CE                XCH      A,R6
004096         ?C0098?ZW_NETWORK_MANAGEMENT:
004096 D8F9              DJNZ     R0,?C0097?ZW_NETWORK_MANAGEMENT
004098 FF                MOV      R7,A
004099 3180              ACALL    ?L?COM0599
00409B 316C              ACALL    ?L?COM01D9
00409D 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
0040A0 12247E            LCALL    ?C?LLDXDATA0
0040A3 C000              PUSH     AR0
0040A5 C001              PUSH     AR1
0040A7 C002              PUSH     AR2
0040A9 C003              PUSH     AR3
0040AB 9041D9            MOV      DPTR,#bRequestNo
0040AE E0                MOVX     A,@DPTR
0040AF 14                DEC      A
0040B0 FF                MOV      R7,A
0040B1 7410              MOV      A,#010H
0040B3 7E00              MOV      R6,#00H
0040B5 A807              MOV      R0,AR7
0040B7 08                INC      R0
0040B8 8005              SJMP     ?C0100?ZW_NETWORK_MANAGEMENT
0040BA         ?C0099?ZW_NETWORK_MANAGEMENT:
0040BA C3                CLR      C
0040BB 33                RLC      A
0040BC CE                XCH      A,R6
0040BD 33                RLC      A
0040BE CE                XCH      A,R6
0040BF         ?C0100?ZW_NETWORK_MANAGEMENT:
0040BF D8F9              DJNZ     R0,?C0099?ZW_NETWORK_MANAGEMENT
0040C1 FF                MOV      R7,A
0040C2 EE                MOV      A,R6
0040C3 33                RLC      A
0040C4 95E0              SUBB     A,ACC
0040C6 FD                MOV      R5,A
0040C7 FC                MOV      R4,A
0040C8 3178              ACALL    ?L?COM031F
0040CA 12224F            LCALL    ?C?LMUL
0040CD D003              POP      AR3
0040CF D002              POP      AR2
0040D1 D001              POP      AR1
0040D3 D000              POP      AR0
0040D5 122234            LCALL    ?C?LADD
0040D8         
0040D8 8028              SJMP     ?C0104?ZW_NETWORK_MANAGEMENT
0040DA         ?C0034?ZW_NETWORK_MANAGEMENT:
0040DA 3187              ACALL    ?L?COM052A
0040DC AFF0              MOV      R7,B
0040DE 7E00              MOV      R6,#00H
0040E0 3180              ACALL    ?L?COM0599
0040E2 801E              SJMP     ?C0105?ZW_NETWORK_MANAGEMENT
0040E4         ?C0033?ZW_NETWORK_MANAGEMENT:
0040E4 9041E1            MOV      DPTR,#bInclusionRequestIntervals
0040E7 E0                MOVX     A,@DPTR
0040E8 FF                MOV      R7,A
0040E9 600F              JZ       ?C0037?ZW_NETWORK_MANAGEMENT
0040EB E4                CLR      A
0040EC FC                MOV      R4,A
0040ED FD                MOV      R5,A
0040EE FE                MOV      R6,A
0040EF FB                MOV      R3,A
0040F0 7AF4              MOV      R2,#0F4H
0040F2 7901              MOV      R1,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 44


0040F4 F8                MOV      R0,A
0040F5 12224F            LCALL    ?C?LMUL
0040F8 8008              SJMP     ?C0102?ZW_NETWORK_MANAGEMENT
0040FA         ?C0037?ZW_NETWORK_MANAGEMENT:
0040FA 7F00              MOV      R7,#00H
0040FC 7ED0              MOV      R6,#0D0H
0040FE 7D07              MOV      R5,#07H
004100 7C00              MOV      R4,#00H
004102         
004102         
004102         
004102 316C              ACALL    ?L?COM01D9
004104         ?C0032?ZW_NETWORK_MANAGEMENT:
004104 319A              ACALL    NetworkManagementSmartStartNextState
004106 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
004108 7FC6              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
00410A C006              PUSH     AR6
00410C C007              PUSH     AR7
00410E 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
004111 122462            LCALL    ?C?LLDXDATA
004114 F104              ACALL    ?L?COM026F
004116 D007              POP      AR7
004118 D006              POP      AR6
00411A 51D5              ACALL    ?L?COM037A
00411C F0                MOVX     @DPTR,A
00411D 125F43            LCALL    NetworkManagementSmartStartIsListeningNode
004120 EF                MOV      A,R7
004121 7046              JNZ      ?C0043?ZW_NETWORK_MANAGEMENT
004123 3172              ACALL    ?L?COM031E
004125 D3                SETB     C
004126 12239D            LCALL    ?C?ULCMP
004129 4007              JC       ?C0040?ZW_NETWORK_MANAGEMENT
00412B E4                CLR      A
00412C 7F01              MOV      R7,#01H
00412E FE                MOV      R6,A
00412F FD                MOV      R5,A
004130 802A              SJMP     ?C0106?ZW_NETWORK_MANAGEMENT
004132         ?C0040?ZW_NETWORK_MANAGEMENT:
004132 3172              ACALL    ?L?COM031E
004134 1222DA            LCALL    ?C?ULDIV
004137 316C              ACALL    ?L?COM01D9
004139 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
00413C 122462            LCALL    ?C?LLDXDATA
00413F E4                CLR      A
004140 7B01              MOV      R3,#01H
004142 F199              ACALL    ?L?COM041C
004144 5018              JNC      ?C0041?ZW_NETWORK_MANAGEMENT
004146 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
004149 122462            LCALL    ?C?LLDXDATA
00414C C3                CLR      C
00414D EF                MOV      A,R7
00414E 9401              SUBB     A,#01H
004150 FF                MOV      R7,A
004151 EE                MOV      A,R6
004152 9400              SUBB     A,#00H
004154 FE                MOV      R6,A
004155 ED                MOV      A,R5
004156 9400              SUBB     A,#00H
004158 FD                MOV      R5,A
004159 EC                MOV      A,R4
00415A 9400              SUBB     A,#00H
00415C         
00415C 316B              ACALL    ?L?COM01D8
00415E         ?C0041?ZW_NETWORK_MANAGEMENT:
00415E 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 45


004161 122462            LCALL    ?C?LLDXDATA
004164 121C0F            LCALL    ?INTERBANK_TABLE?_Power_Management_SetTimeout
004167 1155              ACALL    main_PowerDown_Setup
004169         ?C0043?ZW_NETWORK_MANAGEMENT:
004169 22                RET      
----- FUNCTION _ZCB_NetworkManagementExploreRequestComplete (END) -------


----- FUNCTION ?L?COM01D7 (BEGIN) -----
00416A FD                MOV      R5,A
00416B         ?L?COM01D8:
00416B FC                MOV      R4,A
00416C         ?L?COM01D9:
00416C 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
00416F 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM01D7 (END) -------


----- FUNCTION ?L?COM031E (BEGIN) -----
004172 9041DA            MOV      DPTR,#dwSmartStartInclusionRequestTimeout
004175 122462            LCALL    ?C?LLDXDATA
004178         ?L?COM031F:
004178 E4                CLR      A
004179 7BE8              MOV      R3,#0E8H
00417B 7A03              MOV      R2,#03H
00417D F9                MOV      R1,A
00417E F8                MOV      R0,A
00417F 22                RET      
----- FUNCTION ?L?COM031E (END) -------


----- FUNCTION ?L?COM0599 (BEGIN) -----
004180 7C00              MOV      R4,#00H
004182 7D64              MOV      R5,#064H
004184 022709            LJMP     ?C?LIMUL
----- FUNCTION ?L?COM0599 (END) -------


----- FUNCTION ?L?COM052A (BEGIN) -----
004187 318F              ACALL    ZW_Random
004189 EF                MOV      A,R7
00418A 75F0A0            MOV      B,#0A0H
00418D 84                DIV      AB
00418E 22                RET      
----- FUNCTION ?L?COM052A (END) -------


----- FUNCTION ZW_Random (BEGIN) -----
00418F 9003BB            MOV      DPTR,#randomSeed
004192 E0                MOVX     A,@DPTR
004193 64AA              XRL      A,#0AAH
004195 2411              ADD      A,#011H
004197 FF                MOV      R7,A
004198 F0                MOVX     @DPTR,A
004199 22                RET      
----- FUNCTION ZW_Random (END) -------


----- FUNCTION NetworkManagementSmartStartNextState (BEGIN) -----
00419A F1A7              ACALL    NetworkManagementWUTPowerDownInterrupted
00419C EF                MOV      A,R7
00419D 600F              JZ       ?C0013?ZW_NETWORK_MANAGEMENT
00419F E4                CLR      A
0041A0 7FA0              MOV      R7,#0A0H
0041A2 7E0F              MOV      R6,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 46


0041A4 316A              ACALL    ?L?COM01D7
0041A6 901217            MOV      DPTR,#eSystemTypeState
0041A9 E0                MOVX     A,@DPTR
0041AA 54E7              ANL      A,#0E7H
0041AC F0                MOVX     @DPTR,A
0041AD 22                RET      
0041AE         ?C0013?ZW_NETWORK_MANAGEMENT:
0041AE 901217            MOV      DPTR,#eSystemTypeState
0041B1 E0                MOVX     A,@DPTR
0041B2 FF                MOV      R7,A
0041B3 74E0              MOV      A,#0E0H
0041B5 D3                SETB     C
0041B6 9F                SUBB     A,R7
0041B7 4005              JC       ?C0015?ZW_NETWORK_MANAGEMENT
0041B9 E0                MOVX     A,@DPTR
0041BA 2410              ADD      A,#010H
0041BC F0                MOVX     @DPTR,A
0041BD 22                RET      
0041BE         ?C0015?ZW_NETWORK_MANAGEMENT:
0041BE EF                MOV      A,R7
0041BF 6410              XRL      A,#010H
0041C1 901217            MOV      DPTR,#eSystemTypeState
0041C4 F0                MOVX     @DPTR,A
0041C5 22                RET      
----- FUNCTION NetworkManagementSmartStartNextState (END) -------


----- FUNCTION ZCB_NetworkManagementLearnNodeStateTimeout (BEGIN) -----
0041C6 91E1              ACALL    ?L?COM02B3
0041C8 9041DE            MOV      DPTR,#learnState
0041CB E0                MOVX     A,@DPTR
0041CC B4020A            CJNE     A,#02H,?C0044?ZW_NETWORK_MANAGEMENT
0041CF F1A0              ACALL    ?L?COM0598
0041D1 9041DE            MOV      DPTR,#learnState
0041D4 7403              MOV      A,#03H
0041D6 F0                MOVX     @DPTR,A
0041D7 4165              AJMP     NetworkManagementLearnStateProcess
0041D9         ?C0044?ZW_NETWORK_MANAGEMENT:
0041D9 9041DE            MOV      DPTR,#learnState
0041DC E0                MOVX     A,@DPTR
0041DD 6403              XRL      A,#03H
0041DF 706B              JNZ      ?C0046?ZW_NETWORK_MANAGEMENT
0041E1 9041E0            MOV      DPTR,#bIncReqCount
0041E4 E0                MOVX     A,@DPTR
0041E5 6058              JZ       ?C0047?ZW_NETWORK_MANAGEMENT
0041E7 9041E2            MOV      DPTR,#NW_Action
0041EA E0                MOVX     A,@DPTR
0041EB B40105            CJNE     A,#01H,?C0048?ZW_NETWORK_MANAGEMENT
0041EE 121BF6            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestInclusion
0041F1 800A              SJMP     ?C0049?ZW_NETWORK_MANAGEMENT
0041F3         ?C0048?ZW_NETWORK_MANAGEMENT:
0041F3 9041E2            MOV      DPTR,#NW_Action
0041F6 E0                MOVX     A,@DPTR
0041F7 B40203            CJNE     A,#02H,?C0049?ZW_NETWORK_MANAGEMENT
0041FA 121BFB            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestExclusion
0041FD         ?C0049?ZW_NETWORK_MANAGEMENT:
0041FD 9041E0            MOV      DPTR,#bIncReqCount
004200 E0                MOVX     A,@DPTR
004201 14                DEC      A
004202 F0                MOVX     @DPTR,A
004203 E0                MOVX     A,@DPTR
004204 601F              JZ       ?C0051?ZW_NETWORK_MANAGEMENT
004206 318F              ACALL    ZW_Random
004208 EF                MOV      A,R7
004209 75F046            MOV      B,#046H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 47


00420C 84                DIV      AB
00420D E5F0              MOV      A,B
00420F 75F064            MOV      B,#064H
004212 A4                MUL      AB
004213 FF                MOV      R7,A
004214 EF                MOV      A,R7
004215 24A0              ADD      A,#0A0H
004217 FF                MOV      R7,A
004218 E5F0              MOV      A,B
00421A 340F              ADDC     A,#0FH
00421C FE                MOV      R6,A
00421D E4                CLR      A
00421E 33                RLC      A
00421F FD                MOV      R5,A
004220 E4                CLR      A
004221 33                RLC      A
004222 FC                MOV      R4,A
004223 8007              SJMP     ?C0052?ZW_NETWORK_MANAGEMENT
004225         ?C0051?ZW_NETWORK_MANAGEMENT:
004225 E4                CLR      A
004226 7FA0              MOV      R7,#0A0H
004228 7E0F              MOV      R6,#0FH
00422A FD                MOV      R5,A
00422B FC                MOV      R4,A
00422C         ?C0052?ZW_NETWORK_MANAGEMENT:
00422C 904314            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+02H
00422F 1224BA            LCALL    ?C?LSTXDATA
004232 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
004234 7FC6              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
004236 E4                CLR      A
004237 904318            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+06H
00423A F0                MOVX     @DPTR,A
00423B 51D5              ACALL    ?L?COM037A
00423D F0                MOVX     @DPTR,A
00423E 22                RET      
00423F         ?C0047?ZW_NETWORK_MANAGEMENT:
00423F 9041DE            MOV      DPTR,#learnState
004242 7401              MOV      A,#01H
004244 F0                MOVX     @DPTR,A
004245 5165              ACALL    NetworkManagementLearnStateProcess
004247 7FFD              MOV      R7,#0FDH
004249 021E58            LJMP     ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
00424C         ?C0046?ZW_NETWORK_MANAGEMENT:
00424C 9041DE            MOV      DPTR,#learnState
00424F E0                MOVX     A,@DPTR
004250 B4040E            CJNE     A,#04H,?C0058?ZW_NETWORK_MANAGEMENT
004253 F1A7              ACALL    NetworkManagementWUTPowerDownInterrupted
004255 EF                MOV      A,R7
004256 6006              JZ       ?C0056?ZW_NETWORK_MANAGEMENT
004258 F1C7              ACALL    ?L?COM0359
00425A E4                CLR      A
00425B FF                MOV      R7,A
00425C 0161              AJMP     _ZCB_NetworkManagementExploreRequestComplete
00425E         ?C0056?ZW_NETWORK_MANAGEMENT:
00425E 121BF6            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestInclusion
004261         ?C0058?ZW_NETWORK_MANAGEMENT:
004261 22                RET      
----- FUNCTION ZCB_NetworkManagementLearnNodeStateTimeout (END) -------


----- FUNCTION ?L?COM04D6 (BEGIN) -----
004262 7401              MOV      A,#01H
004264 F0                MOVX     @DPTR,A
----- FUNCTION NetworkManagementLearnStateProcess (BEGIN) -----
004265 9041DE            MOV      DPTR,#learnState
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 48


004268 E0                MOVX     A,@DPTR
004269 6402              XRL      A,#02H
00426B 7024              JNZ      ?C0059?ZW_NETWORK_MANAGEMENT
00426D 7C44              MOV      R4,#HIGH _ZCB_NetworkManagementLearnModeCompleted
00426F 7D57              MOV      R5,#LOW _ZCB_NetworkManagementLearnModeCompleted
004271 7F01              MOV      R7,#01H
004273 121A02            LCALL    ?INTERBANK_TABLE?_InternSetLearnMode
004276 E4                CLR      A
004277 FB                MOV      R3,A
004278 FA                MOV      R2,A
004279 FD                MOV      R5,A
00427A 7FFF              MOV      R7,#0FFH
00427C 1219E9            LCALL    ?INTERBANK_TABLE?_ZW_SendNodeInformation
00427F 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
004281 7FC6              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
004283 C006              PUSH     AR6
004285 C007              PUSH     AR7
004287 D1FD              ACALL    ?L?COM026E
004289 D007              POP      AR7
00428B D006              POP      AR6
00428D 51D5              ACALL    ?L?COM037A
00428F F0                MOVX     @DPTR,A
004290 22                RET      
004291         ?C0059?ZW_NETWORK_MANAGEMENT:
004291 9041DE            MOV      DPTR,#learnState
004294 E0                MOVX     A,@DPTR
004295 6403              XRL      A,#03H
004297 7017              JNZ      ?C0061?ZW_NETWORK_MANAGEMENT
004299 FF                MOV      R7,A
00429A FE                MOV      R6,A
00429B 316A              ACALL    ?L?COM01D7
00429D 9041E2            MOV      DPTR,#NW_Action
0042A0 E0                MOVX     A,@DPTR
0042A1 7C44              MOV      R4,#HIGH _ZCB_NetworkManagementLearnModeCompleted
0042A3 7D57              MOV      R5,#LOW _ZCB_NetworkManagementLearnModeCompleted
0042A5 B40204            CJNE     A,#02H,?C0062?ZW_NETWORK_MANAGEMENT
0042A8 7F03              MOV      R7,#03H
0042AA 8011              SJMP     ?C0108?ZW_NETWORK_MANAGEMENT
0042AC         ?C0062?ZW_NETWORK_MANAGEMENT:
0042AC 7F02              MOV      R7,#02H
0042AE         
0042AE 800D              SJMP     ?C0108?ZW_NETWORK_MANAGEMENT
0042B0         ?C0061?ZW_NETWORK_MANAGEMENT:
0042B0 9041DE            MOV      DPTR,#learnState
0042B3 E0                MOVX     A,@DPTR
0042B4 B4040B            CJNE     A,#04H,?C0065?ZW_NETWORK_MANAGEMENT
0042B7 7C44              MOV      R4,#HIGH _ZCB_NetworkManagementLearnModeCompleted
0042B9 7D57              MOV      R5,#LOW _ZCB_NetworkManagementLearnModeCompleted
0042BB 7F04              MOV      R7,#04H
0042BD         
0042BD 121A02            LCALL    ?INTERBANK_TABLE?_InternSetLearnMode
0042C0 21C6              AJMP     ZCB_NetworkManagementLearnNodeStateTimeout
0042C2         ?C0065?ZW_NETWORK_MANAGEMENT:
0042C2 9041DE            MOV      DPTR,#learnState
0042C5 E0                MOVX     A,@DPTR
0042C6 B4010B            CJNE     A,#01H,?C0068?ZW_NETWORK_MANAGEMENT
0042C9 F1A0              ACALL    ?L?COM0598
0042CB 91E1              ACALL    ?L?COM02B3
0042CD 7141              ACALL    NetworkManagementSmartStartClear
0042CF E4                CLR      A
0042D0 9041DE            MOV      DPTR,#learnState
0042D3 F0                MOVX     @DPTR,A
0042D4         ?C0068?ZW_NETWORK_MANAGEMENT:
0042D4 22                RET      
----- FUNCTION NetworkManagementLearnStateProcess (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 49




----- FUNCTION ?L?COM037A (BEGIN) -----
0042D5 51DC              ACALL    _ZW_TimerLongStart
0042D7 9041E3            MOV      DPTR,#learnStateHandle
0042DA EF                MOV      A,R7
0042DB 22                RET      
----- FUNCTION ?L?COM037A (END) -------


----- FUNCTION _ZW_TimerLongStart (BEGIN) -----
0042DC 904312            MOV      DPTR,#func
0042DF EE                MOV      A,R6
0042E0 F0                MOVX     @DPTR,A
0042E1 A3                INC      DPTR
0042E2 EF                MOV      A,R7
0042E3 F0                MOVX     @DPTR,A
;---- Variable 'bHandle' assigned to Register 'R7' ----
0042E4 7FFF              MOV      R7,#0FFH
0042E6 A3                INC      DPTR
0042E7 12247E            LCALL    ?C?LLDXDATA0
0042EA E8                MOV      A,R0
0042EB 49                ORL      A,R1
0042EC 4A                ORL      A,R2
0042ED 4B                ORL      A,R3
0042EE 6050              JZ       ?C0033?ZW_TIMER
0042F0 904319            MOV      DPTR,#bTimerHandle
0042F3 7403              MOV      A,#03H
0042F5 F0                MOVX     @DPTR,A
0042F6         ?C0034?ZW_TIMER:
0042F6 904319            MOV      DPTR,#bTimerHandle
0042F9 E0                MOVX     A,@DPTR
0042FA FE                MOV      R6,A
0042FB C3                CLR      C
0042FC 940E              SUBB     A,#0EH
0042FE 5040              JNC      ?C0033?ZW_TIMER
004300 EE                MOV      A,R6
004301 B116              ACALL    ?L?COM0103
004303 E0                MOVX     A,@DPTR
004304 7032              JNZ      ?C0036?ZW_TIMER
004306 904319            MOV      DPTR,#bTimerHandle
004309 B114              ACALL    ?L?COM0102
00430B 7405              MOV      A,#05H
00430D F0                MOVX     @DPTR,A
00430E C007              PUSH     AR7
004310 904314            MOV      DPTR,#dwtimerTicks
004313 122462            LCALL    ?C?LLDXDATA
004316 90430D            MOV      DPTR,#?_TimerSave?BYTE+03H
004319 1224BA            LCALL    ?C?LSTXDATA
00431C 904318            MOV      DPTR,#brepeats
00431F E0                MOVX     A,@DPTR
004320 904311            MOV      DPTR,#?_TimerSave?BYTE+07H
004323 F0                MOVX     @DPTR,A
004324 904312            MOV      DPTR,#func
004327 E0                MOVX     A,@DPTR
004328 FC                MOV      R4,A
004329 A3                INC      DPTR
00432A E0                MOVX     A,@DPTR
00432B FD                MOV      R5,A
00432C D007              POP      AR7
00432E B1FB              ACALL    _TimerSave
004330 904319            MOV      DPTR,#bTimerHandle
004333 E0                MOVX     A,@DPTR
004334 04                INC      A
004335 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 50


004336 8008              SJMP     ?C0033?ZW_TIMER
004338         ?C0036?ZW_TIMER:
004338 904319            MOV      DPTR,#bTimerHandle
00433B E0                MOVX     A,@DPTR
00433C 04                INC      A
00433D F0                MOVX     @DPTR,A
00433E 80B6              SJMP     ?C0034?ZW_TIMER
004340         ?C0033?ZW_TIMER:
004340 22                RET      
----- FUNCTION _ZW_TimerLongStart (END) -------


----- FUNCTION NetworkManagementSmartStartClear (BEGIN) -----
004341 901217            MOV      DPTR,#eSystemTypeState
004344 E0                MOVX     A,@DPTR
004345 5403              ANL      A,#03H
004347 F0                MOVX     @DPTR,A
004348 22                RET      
----- FUNCTION NetworkManagementSmartStartClear (END) -------


----- FUNCTION _ZW_NetworkLearnModeStart (BEGIN) -----
004349 90469B            MOV      DPTR,#bMode
00434C EF                MOV      A,R7
00434D F0                MOVX     @DPTR,A
00434E C22E              CLR      bSmartStartLearn
004350 901221            MOV      DPTR,#nodeID
004353 E0                MOVX     A,@DPTR
004354 6020              JZ       ?C0076?ZW_NETWORK_MANAGEMENT
004356 7E12              MOV      R6,#HIGH NVM_SYSTEM_STATE
004358 7F0B              MOV      R7,#LOW NVM_SYSTEM_STATE
00435A 1239F2            LCALL    _NVM_ext_read_byte
00435D BF0108            CJNE     R7,#01H,?C0077?ZW_NETWORK_MANAGEMENT
004360 7FFF              MOV      R7,#0FFH
004362 121E58            LCALL    ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
004365 7F00              MOV      R7,#00H
004367 22                RET      
004368         ?C0077?ZW_NETWORK_MANAGEMENT:
004368 9041DE            MOV      DPTR,#learnState
00436B E0                MOVX     A,@DPTR
00436C 6008              JZ       ?C0076?ZW_NETWORK_MANAGEMENT
00436E 901221            MOV      DPTR,#nodeID
004371 E0                MOVX     A,@DPTR
004372 FF                MOV      R7,A
004373 121E58            LCALL    ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
004376         ?C0076?ZW_NETWORK_MANAGEMENT:
004376 911E              ACALL    ?L?COM0294
004378 90469B            MOV      DPTR,#bMode
00437B E0                MOVX     A,@DPTR
00437C 7002              JNZ      $ + 4H
00437E 61FF              AJMP     ?C0080?ZW_NETWORK_MANAGEMENT
004380 E4                CLR      A
004381 9041E2            MOV      DPTR,#NW_Action
004384 F0                MOVX     @DPTR,A
004385 9041DE            MOV      DPTR,#learnState
004388 E0                MOVX     A,@DPTR
004389 6002              JZ       ?C0081?ZW_NETWORK_MANAGEMENT
00438B 5162              ACALL    ?L?COM04D6
00438D         ?C0081?ZW_NETWORK_MANAGEMENT:
00438D 90469B            MOV      DPTR,#bMode
004390 E0                MOVX     A,@DPTR
004391 FF                MOV      R7,A
004392 B40107            CJNE     A,#01H,?C0082?ZW_NETWORK_MANAGEMENT
004395 9041E2            MOV      DPTR,#NW_Action
004398 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 51


00439A 8009              SJMP     ?C0109?ZW_NETWORK_MANAGEMENT
00439C         ?C0082?ZW_NETWORK_MANAGEMENT:
00439C EF                MOV      A,R7
00439D B40310            CJNE     A,#03H,?C0084?ZW_NETWORK_MANAGEMENT
0043A0 9041E2            MOV      DPTR,#NW_Action
0043A3 7402              MOV      A,#02H
0043A5         
0043A5 F0                MOVX     @DPTR,A
0043A6 7141              ACALL    NetworkManagementSmartStartClear
0043A8 9041E0            MOV      DPTR,#bIncReqCount
0043AB 7404              MOV      A,#04H
0043AD F0                MOVX     @DPTR,A
0043AE 8047              SJMP     ?C0110?ZW_NETWORK_MANAGEMENT
0043B0         ?C0084?ZW_NETWORK_MANAGEMENT:
0043B0 EF                MOV      A,R7
0043B1 6404              XRL      A,#04H
0043B3 7034              JNZ      ?C0086?ZW_NETWORK_MANAGEMENT
0043B5 901221            MOV      DPTR,#nodeID
0043B8 E0                MOVX     A,@DPTR
0043B9 701D              JNZ      ?C0087?ZW_NETWORK_MANAGEMENT
0043BB D22E              SETB     bSmartStartLearn
0043BD D1E2              ACALL    NetworkManagementSmartStartIsEnabled
0043BF EF                MOV      A,R7
0043C0 700E              JNZ      ?C0088?ZW_NETWORK_MANAGEMENT
0043C2 7141              ACALL    NetworkManagementSmartStartClear
0043C4 F1DC              ACALL    NetworkManagementSmartStartEnable
0043C6 7E12              MOV      R6,#HIGH NVM_SYSTEM_STATE
0043C8 7F0B              MOV      R7,#LOW NVM_SYSTEM_STATE
0043CA 7D01              MOV      R5,#01H
0043CC 914A              ACALL    _NVM_ext_write_byte
0043CE 9126              ACALL    NVM_ext_flush
0043D0         ?C0088?ZW_NETWORK_MANAGEMENT:
0043D0 9041DE            MOV      DPTR,#learnState
0043D3 7404              MOV      A,#04H
0043D5 F0                MOVX     @DPTR,A
0043D6 8039              SJMP     ?C0093?ZW_NETWORK_MANAGEMENT
0043D8         ?C0087?ZW_NETWORK_MANAGEMENT:
0043D8 9003C2            MOV      DPTR,#bMainWakeUpReason
0043DB E0                MOVX     A,@DPTR
0043DC B40505            CJNE     A,#05H,?C0090?ZW_NETWORK_MANAGEMENT
0043DF E4                CLR      A
0043E0 F0                MOVX     @DPTR,A
0043E1 121BF1            LCALL    ?INTERBANK_TABLE?ExploreINIF
0043E4         ?C0090?ZW_NETWORK_MANAGEMENT:
0043E4 7141              ACALL    NetworkManagementSmartStartClear
0043E6 7F00              MOV      R7,#00H
0043E8 22                RET      
0043E9         ?C0086?ZW_NETWORK_MANAGEMENT:
0043E9 90469B            MOV      DPTR,#bMode
0043EC E0                MOVX     A,@DPTR
0043ED 6402              XRL      A,#02H
0043EF 7020              JNZ      ?C0093?ZW_NETWORK_MANAGEMENT
0043F1 9041E0            MOV      DPTR,#bIncReqCount
0043F4 F0                MOVX     @DPTR,A
0043F5 7141              ACALL    NetworkManagementSmartStartClear
0043F7         
0043F7 9041DE            MOV      DPTR,#learnState
0043FA 7402              MOV      A,#02H
0043FC F0                MOVX     @DPTR,A
0043FD 8012              SJMP     ?C0093?ZW_NETWORK_MANAGEMENT
0043FF         ?C0080?ZW_NETWORK_MANAGEMENT:
0043FF E4                CLR      A
004400 9041E2            MOV      DPTR,#NW_Action
004403 F0                MOVX     @DPTR,A
004404 D1E2              ACALL    NetworkManagementSmartStartIsEnabled
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 52


004406 EF                MOV      A,R7
004407 6002              JZ       ?C0094?ZW_NETWORK_MANAGEMENT
004409 911E              ACALL    ?L?COM0294
00440B         ?C0094?ZW_NETWORK_MANAGEMENT:
00440B 9041DE            MOV      DPTR,#learnState
00440E 7401              MOV      A,#01H
004410 F0                MOVX     @DPTR,A
004411         ?C0093?ZW_NETWORK_MANAGEMENT:
004411 5165              ACALL    NetworkManagementLearnStateProcess
004413 9041DE            MOV      DPTR,#learnState
004416 E0                MOVX     A,@DPTR
004417 7F00              MOV      R7,#00H
004419 6002              JZ       ?C0095?ZW_NETWORK_MANAGEMENT
00441B 7F01              MOV      R7,#01H
00441D         ?C0095?ZW_NETWORK_MANAGEMENT:
00441D 22                RET      
----- FUNCTION _ZW_NetworkLearnModeStart (END) -------


----- FUNCTION ?L?COM0294 (BEGIN) -----
00441E 7E12              MOV      R6,#HIGH NVM_SYSTEM_STATE
004420 7F0B              MOV      R7,#LOW NVM_SYSTEM_STATE
004422 E4                CLR      A
004423 FD                MOV      R5,A
004424 914A              ACALL    _NVM_ext_write_byte
----- FUNCTION NVM_ext_flush (BEGIN) -----
004426 1237E6            LCALL    ZW_WatchDogKick
004429         ?C0176?ZW_PHY_GENERIC_SPI_IF:
004429 123592            LCALL    NVM_ext_busy
00442C EF                MOV      A,R7
00442D 6004              JZ       ?C0178?ZW_PHY_GENERIC_SPI_IF
00442F F124              ACALL    ZW_Poll
004431 80F6              SJMP     ?C0176?ZW_PHY_GENERIC_SPI_IF
004433         ?C0178?ZW_PHY_GENERIC_SPI_IF:
004433 22                RET      
----- FUNCTION NVM_ext_flush (END) -------


----- FUNCTION ?L?COM0178 (BEGIN) -----
004434 E0                MOVX     A,@DPTR
004435 75F002            MOV      B,#02H
004438 A4                MUL      AB
004439 2484              ADD      A,#LOW NVM_RETURN_ROUTE_SPEED_START_far
00443B F9                MOV      R1,A
00443C 740F              MOV      A,#HIGH NVM_RETURN_ROUTE_SPEED_START_far
00443E 35F0              ADDC     A,B
004440 7B02              MOV      R3,#MBYTE NVM_RETURN_ROUTE_SPEED_START_far
004442 FE                MOV      R6,A
004443 AF01              MOV      R7,AR1
004445 90339C            MOV      DPTR,#temp
004448 E0                MOVX     A,@DPTR
004449 FD                MOV      R5,A
----- FUNCTION _NVM_ext_write_byte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R3' ----
00444A AB05              MOV      R3,AR5
;---- Variable 'offset' assigned to Register 'R6/R7' ----
00444C E4                CLR      A
00444D FC                MOV      R4,A
00444E FD                MOV      R5,A
00444F 9044FF            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
004452 EB                MOV      A,R3
004453 F0                MOVX     @DPTR,A
004454 0236CE            LJMP     _NVM_ext_write_long_byte
----- FUNCTION _NVM_ext_write_byte (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 53



----- FUNCTION _ZCB_NetworkManagementLearnModeCompleted (BEGIN) -----
004457 904671            MOV      DPTR,#bStatus
00445A EF                MOV      A,R7
00445B F0                MOVX     @DPTR,A
00445C A3                INC      DPTR
00445D ED                MOV      A,R5
00445E F0                MOVX     @DPTR,A
00445F 91E1              ACALL    ?L?COM02B3
004461 904671            MOV      DPTR,#bStatus
004464 E0                MOVX     A,@DPTR
004465 B40112            CJNE     A,#01H,?C0019?ZW_NETWORK_MANAGEMENT
004468 A3                INC      DPTR
004469 E0                MOVX     A,@DPTR
00446A 9041DF            MOV      DPTR,#bCachedNodeID
00446D F0                MOVX     @DPTR,A
00446E 7141              ACALL    NetworkManagementSmartStartClear
004470 9041DE            MOV      DPTR,#learnState
004473 7405              MOV      A,#05H
004475 F0                MOVX     @DPTR,A
004476 7FFE              MOV      R7,#0FEH
004478 8060              SJMP     ?C0101?ZW_NETWORK_MANAGEMENT
00447A         ?C0019?ZW_NETWORK_MANAGEMENT:
00447A 904671            MOV      DPTR,#bStatus
00447D E0                MOVX     A,@DPTR
00447E 6402              XRL      A,#02H
004480 7024              JNZ      ?C0021?ZW_NETWORK_MANAGEMENT
004482 9041E2            MOV      DPTR,#NW_Action
004485 E0                MOVX     A,@DPTR
004486 6402              XRL      A,#02H
004488 7056              JNZ      ?C0030?ZW_NETWORK_MANAGEMENT
00448A 9041D9            MOV      DPTR,#bRequestNo
00448D F0                MOVX     @DPTR,A
00448E 9041DE            MOV      DPTR,#learnState
004491 7403              MOV      A,#03H
004493 F0                MOVX     @DPTR,A
004494 7E41              MOV      R6,#HIGH ZCB_NetworkManagementLearnNodeStateTimeout
004496 7FC6              MOV      R7,#LOW ZCB_NetworkManagementLearnNodeStateTimeout
004498 C006              PUSH     AR6
00449A C007              PUSH     AR7
00449C D1FD              ACALL    ?L?COM026E
00449E D007              POP      AR7
0044A0 D006              POP      AR6
0044A2 51D5              ACALL    ?L?COM037A
0044A4 F0                MOVX     @DPTR,A
0044A5 22                RET      
0044A6         ?C0021?ZW_NETWORK_MANAGEMENT:
0044A6 904671            MOV      DPTR,#bStatus
0044A9 E0                MOVX     A,@DPTR
0044AA 7034              JNZ      ?C0030?ZW_NETWORK_MANAGEMENT
0044AC 121A75            LCALL    ?INTERBANK_TABLE?secure_learn_get_errno
0044AF EF                MOV      A,R7
0044B0 6401              XRL      A,#01H
0044B2 6029              JZ       ?C0025?ZW_NETWORK_MANAGEMENT
0044B4 302E14            JNB      bSmartStartLearn,?C0026?ZW_NETWORK_MANAGEMENT
0044B7 121E6C            LCALL    ?INTERBANK_TABLE?ApplicationSecureKeysRequested
0044BA EF                MOV      A,R7
0044BB 600C              JZ       ?C0027?ZW_NETWORK_MANAGEMENT
0044BD 121A75            LCALL    ?INTERBANK_TABLE?secure_learn_get_errno
0044C0 EF                MOV      A,R7
0044C1 6006              JZ       ?C0027?ZW_NETWORK_MANAGEMENT
0044C3 904672            MOV      DPTR,#nodeID
0044C6 74FF              MOV      A,#0FFH
0044C8 F0                MOVX     @DPTR,A
0044C9         ?C0027?ZW_NETWORK_MANAGEMENT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 54


0044C9 C22E              CLR      bSmartStartLearn
0044CB         ?C0026?ZW_NETWORK_MANAGEMENT:
0044CB 911E              ACALL    ?L?COM0294
0044CD 9041DE            MOV      DPTR,#learnState
0044D0 E0                MOVX     A,@DPTR
0044D1 6002              JZ       ?C0028?ZW_NETWORK_MANAGEMENT
0044D3 5162              ACALL    ?L?COM04D6
0044D5         ?C0028?ZW_NETWORK_MANAGEMENT:
0044D5 904672            MOV      DPTR,#nodeID
0044D8 E0                MOVX     A,@DPTR
0044D9 FF                MOV      R7,A
0044DA         
0044DA 021E58            LJMP     ?INTERBANK_TABLE?_ApplicationNetworkLearnModeCompleted
0044DD         ?C0025?ZW_NETWORK_MANAGEMENT:
0044DD 121A7F            LCALL    ?INTERBANK_TABLE?secure_learn_set_errno_reset
0044E0         ?C0030?ZW_NETWORK_MANAGEMENT:
0044E0 22                RET      
----- FUNCTION _ZCB_NetworkManagementLearnModeCompleted (END) -------


----- FUNCTION ?L?COM02B3 (BEGIN) -----
0044E1 9041E3            MOV      DPTR,#learnStateHandle
0044E4 E0                MOVX     A,@DPTR
0044E5 FF                MOV      R7,A
0044E6 91EE              ACALL    _TimerCancel
0044E8 E4                CLR      A
0044E9 9041E3            MOV      DPTR,#learnStateHandle
0044EC F0                MOVX     @DPTR,A
0044ED 22                RET      
----- FUNCTION ?L?COM02B3 (END) -------


----- FUNCTION _TimerCancel (BEGIN) -----
;---- Variable 'btimerHandle' assigned to Register 'R3' ----
0044EE AB07              MOV      R3,AR7
;---- Variable 'retCode' assigned to Register 'R7' ----
0044F0 E4                CLR      A
0044F1 FF                MOV      R7,A
0044F2 1B                DEC      R3
0044F3 EB                MOV      A,R3
0044F4 C3                CLR      C
0044F5 940E              SUBB     A,#0EH
0044F7 501A              JNC      ?C0029?ZW_TIMER
0044F9 D1EE              ACALL    ?L?COM01D5
0044FB 1224C6            LCALL    ?C?LSTKXDATA
0044FE 00                DB       00H
0044FF 00                DB       00H
004500 00                DB       00H
004501 00                DB       00H
004502 EB                MOV      A,R3
004503 B1DD              ACALL    ?L?COM00A0
004505 1224C6            LCALL    ?C?LSTKXDATA
004508 00                DB       00H
004509 00                DB       00H
00450A 00                DB       00H
00450B 00                DB       00H
00450C EB                MOV      A,R3
00450D B116              ACALL    ?L?COM0103
00450F E4                CLR      A
004510 F0                MOVX     @DPTR,A
004511 7F01              MOV      R7,#01H
004513         ?C0029?ZW_TIMER:
004513 22                RET      
----- FUNCTION _TimerCancel (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 55



----- FUNCTION ?L?COM0102 (BEGIN) -----
004514 E0                MOVX     A,@DPTR
004515 FF                MOV      R7,A
004516         ?L?COM0103:
004516 75F00C            MOV      B,#0CH
004519 A4                MUL      AB
00451A 2474              ADD      A,#LOW timerArray+0BH
00451C F582              MOV      DPL,A
00451E E4                CLR      A
00451F 3435              ADDC     A,#HIGH timerArray+0BH
004521 F583              MOV      DPH,A
004523 22                RET      
----- FUNCTION ?L?COM0102 (END) -------


----- FUNCTION TimerAction (BEGIN) -----
004524 D3                SETB     C
004525 900001            MOV      DPTR,#timerCount+01H
004528 E0                MOVX     A,@DPTR
004529 9400              SUBB     A,#00H
00452B 900000            MOV      DPTR,#timerCount
00452E E0                MOVX     A,@DPTR
00452F 9400              SUBB     A,#00H
004531 5002              JNC      $ + 4H
004533 A1DA              AJMP     ?C0023?ZW_TIMER
004535 C2AD              CLR      EMULTI
004537 E0                MOVX     A,@DPTR
004538 FF                MOV      R7,A
004539 A3                INC      DPTR
00453A E0                MOVX     A,@DPTR
00453B 90466F            MOV      DPTR,#bTicks
00453E F1CE              ACALL    ?L?COM04BE
004540 900000            MOV      DPTR,#timerCount
004543 F0                MOVX     @DPTR,A
004544 A3                INC      DPTR
004545 F0                MOVX     @DPTR,A
004546 D2AD              SETB     EMULTI
004548 F57D              MOV      timerHandle,A
00454A         ?C0012?ZW_TIMER:
00454A E57D              MOV      A,timerHandle
00454C B116              ACALL    ?L?COM0103
00454E E0                MOVX     A,@DPTR
00454F 6073              JZ       ?C0014?ZW_TIMER
004551 90466F            MOV      DPTR,#bTicks
004554 F1AF              ACALL    ?L?COM0358
004556 FD                MOV      R5,A
004557 B1DB              ACALL    ?L?COM009F
004559 12247E            LCALL    ?C?LLDXDATA0
00455C D3                SETB     C
00455D 12239D            LCALL    ?C?ULCMP
004560 5041              JNC      ?C0016?ZW_TIMER
004562 B1EB              ACALL    ?L?COM01B4
004564 E0                MOVX     A,@DPTR
004565 FF                MOV      R7,A
004566 6008              JZ       ?C0017?ZW_TIMER
004568 F4                CPL      A
004569 6005              JZ       ?C0017?ZW_TIMER
00456B B1EB              ACALL    ?L?COM01B4
00456D E0                MOVX     A,@DPTR
00456E 14                DEC      A
00456F F0                MOVX     @DPTR,A
004570         ?C0017?ZW_TIMER:
004570 B1EB              ACALL    ?L?COM01B4
004572 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 56


004573 600E              JZ       ?C0019?ZW_TIMER
004575 E57D              MOV      A,timerHandle
004577 D1EF              ACALL    ?L?COM01D6
004579 122462            LCALL    ?C?LLDXDATA
00457C B1DB              ACALL    ?L?COM009F
00457E 1224BA            LCALL    ?C?LSTXDATA
004581 800F              SJMP     ?C0020?ZW_TIMER
004583         ?C0019?ZW_TIMER:
004583 E57D              MOV      A,timerHandle
004585 B116              ACALL    ?L?COM0103
004587 E4                CLR      A
004588 F0                MOVX     @DPTR,A
004589 B1DB              ACALL    ?L?COM009F
00458B 1224C6            LCALL    ?C?LSTKXDATA
00458E 00                DB       00H
00458F 00                DB       00H
004590 00                DB       00H
004591 00                DB       00H
004592         ?C0020?ZW_TIMER:
004592 F110              ACALL    ?L?COM0210
004594 4E                ORL      A,R6
004595 6008              JZ       ?C0021?ZW_TIMER
004597 F110              ACALL    ?L?COM0210
004599 AA06              MOV      R2,AR6
00459B F9                MOV      R1,A
00459C 1226DF            LCALL    ?C?ICALL
00459F         ?C0021?ZW_TIMER:
00459F F124              ACALL    ZW_Poll
0045A1 8021              SJMP     ?C0014?ZW_TIMER
0045A3         ?C0016?ZW_TIMER:
0045A3 B1DB              ACALL    ?L?COM009F
0045A5 C083              PUSH     DPH
0045A7 C082              PUSH     DPL
0045A9 122462            LCALL    ?C?LLDXDATA
0045AC C006              PUSH     AR6
0045AE C007              PUSH     AR7
0045B0 90466F            MOV      DPTR,#bTicks
0045B3 12652A            LCALL    ?L?COM01DC
0045B6 D007              POP      AR7
0045B8 D006              POP      AR6
0045BA 122241            LCALL    ?C?LSUB
0045BD D082              POP      DPL
0045BF D083              POP      DPH
0045C1 1224BA            LCALL    ?C?LSTXDATA
0045C4         ?C0014?ZW_TIMER:
0045C4 057D              INC      timerHandle
0045C6 E57D              MOV      A,timerHandle
0045C8 C3                CLR      C
0045C9 940E              SUBB     A,#0EH
0045CB 5002              JNC      $ + 4H
0045CD A14A              AJMP     ?C0012?ZW_TIMER
0045CF         ?C0013?ZW_TIMER:
0045CF 90466F            MOV      DPTR,#bTicks
0045D2 E0                MOVX     A,@DPTR
0045D3 FE                MOV      R6,A
0045D4 A3                INC      DPTR
0045D5 E0                MOVX     A,@DPTR
0045D6 FF                MOV      R7,A
0045D7 121B1F            LCALL    ?INTERBANK_TABLE?_ctimer_poll
0045DA         ?C0023?ZW_TIMER:
0045DA 22                RET      
----- FUNCTION TimerAction (END) -------


----- FUNCTION ?L?COM009F (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 57


0045DB E57D              MOV      A,timerHandle
0045DD         ?L?COM00A0:
0045DD 75F00C            MOV      B,#0CH
0045E0 A4                MUL      AB
0045E1 2469              ADD      A,#LOW timerArray
0045E3 F582              MOV      DPL,A
0045E5 E4                CLR      A
0045E6 3435              ADDC     A,#HIGH timerArray
0045E8 F583              MOV      DPH,A
0045EA 22                RET      
----- FUNCTION ?L?COM009F (END) -------


----- FUNCTION ?L?COM01B4 (BEGIN) -----
0045EB E57D              MOV      A,timerHandle
0045ED         ?L?COM01B5:
0045ED 75F00C            MOV      B,#0CH
0045F0 A4                MUL      AB
0045F1 2473              ADD      A,#LOW timerArray+0AH
0045F3 F582              MOV      DPL,A
0045F5 E4                CLR      A
0045F6 3435              ADDC     A,#HIGH timerArray+0AH
0045F8 F583              MOV      DPH,A
0045FA 22                RET      
----- FUNCTION ?L?COM01B4 (END) -------


----- FUNCTION _TimerSave (BEGIN) -----
0045FB 90430B            MOV      DPTR,#func
0045FE EC                MOV      A,R4
0045FF F0                MOVX     @DPTR,A
004600 A3                INC      DPTR
004601 ED                MOV      A,R5
004602 F0                MOVX     @DPTR,A
004603 90430A            MOV      DPTR,#btimerHandle
004606 EF                MOV      A,R7
004607 F0                MOVX     @DPTR,A
004608 FB                MOV      R3,A
004609 90430D            MOV      DPTR,#dwTimerTicks
00460C 122462            LCALL    ?C?LLDXDATA
00460F D1EE              ACALL    ?L?COM01D5
004611 1224BA            LCALL    ?C?LSTXDATA
004614 EB                MOV      A,R3
004615 B1DD              ACALL    ?L?COM00A0
004617 1224BA            LCALL    ?C?LSTXDATA
00461A EB                MOV      A,R3
00461B B1DD              ACALL    ?L?COM00A0
00461D C083              PUSH     DPH
00461F C082              PUSH     DPL
004621 12247E            LCALL    ?C?LLDXDATA0
004624 900000            MOV      DPTR,#timerCount
004627 F1AF              ACALL    ?L?COM0358
004629 FD                MOV      R5,A
00462A 122234            LCALL    ?C?LADD
00462D D082              POP      DPL
00462F D083              POP      DPH
004631 1224BA            LCALL    ?C?LSTXDATA
004634 904311            MOV      DPTR,#brepeats
004637 E0                MOVX     A,@DPTR
004638 FF                MOV      R7,A
004639 90430A            MOV      DPTR,#btimerHandle
00463C E0                MOVX     A,@DPTR
00463D FE                MOV      R6,A
00463E B1ED              ACALL    ?L?COM01B5
004640 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 58


004641 F0                MOVX     @DPTR,A
004642 90430B            MOV      DPTR,#func
004645 E0                MOVX     A,@DPTR
004646 FC                MOV      R4,A
004647 A3                INC      DPTR
004648 E0                MOVX     A,@DPTR
004649 FD                MOV      R5,A
00464A EE                MOV      A,R6
00464B 75F00C            MOV      B,#0CH
00464E A4                MUL      AB
00464F 2471              ADD      A,#LOW timerArray+08H
004651 F582              MOV      DPL,A
004653 E4                CLR      A
004654 3435              ADDC     A,#HIGH timerArray+08H
004656 F583              MOV      DPH,A
004658 EC                MOV      A,R4
004659 F0                MOVX     @DPTR,A
00465A A3                INC      DPTR
00465B ED                MOV      A,R5
00465C F0                MOVX     @DPTR,A
00465D 22                RET      
----- FUNCTION _TimerSave (END) -------


----- FUNCTION _TimerStart_ (BEGIN) -----
00465E 9043D2            MOV      DPTR,#func
004661 126560            LCALL    ?L?COM00E8
004664 EB                MOV      A,R3
004665 F0                MOVX     @DPTR,A
004666 9043D7            MOV      DPTR,#retCode
004669 74FF              MOV      A,#0FFH
00466B F0                MOVX     @DPTR,A
00466C 9043D6            MOV      DPTR,#bstartTimer
00466F E0                MOVX     A,@DPTR
004670 9043D8            MOV      DPTR,#timerHandle
004673 F0                MOVX     @DPTR,A
004674         ?C0002?ZW_TIMER:
004674 9043D8            MOV      DPTR,#timerHandle
004677 E0                MOVX     A,@DPTR
004678 FF                MOV      R7,A
004679 C3                CLR      C
00467A 940E              SUBB     A,#0EH
00467C 505E              JNC      ?C0003?ZW_TIMER
00467E EF                MOV      A,R7
00467F B1DD              ACALL    ?L?COM00A0
004681 122462            LCALL    ?C?LLDXDATA
004684 E4                CLR      A
004685 FB                MOV      R3,A
004686 F199              ACALL    ?L?COM041C
004688 704A              JNZ      ?C0004?ZW_TIMER
00468A 9043D6            MOV      DPTR,#bstartTimer
00468D E0                MOVX     A,@DPTR
00468E 7E01              MOV      R6,#01H
004690 7002              JNZ      ?C0006?ZW_TIMER
004692 7E02              MOV      R6,#02H
004694         ?C0006?ZW_TIMER:
004694         ?C0007?ZW_TIMER:
004694 9043D8            MOV      DPTR,#timerHandle
004697 B114              ACALL    ?L?COM0102
004699 EE                MOV      A,R6
00469A F0                MOVX     @DPTR,A
00469B C007              PUSH     AR7
00469D 9043D4            MOV      DPTR,#btimerTicks
0046A0 E0                MOVX     A,@DPTR
0046A1 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 59


0046A2 7E00              MOV      R6,#00H
0046A4 6004              JZ       ?C0008?ZW_TIMER
0046A6 F1D5              ACALL    ?L?COM056C
0046A8 8002              SJMP     ?C0009?ZW_TIMER
0046AA         ?C0008?ZW_TIMER:
0046AA 7F0A              MOV      R7,#0AH
0046AC         ?C0009?ZW_TIMER:
0046AC E4                CLR      A
0046AD FC                MOV      R4,A
0046AE FD                MOV      R5,A
0046AF 90430D            MOV      DPTR,#?_TimerSave?BYTE+03H
0046B2 1224BA            LCALL    ?C?LSTXDATA
0046B5 9043D5            MOV      DPTR,#brepeats
0046B8 E0                MOVX     A,@DPTR
0046B9 904311            MOV      DPTR,#?_TimerSave?BYTE+07H
0046BC F0                MOVX     @DPTR,A
0046BD 9043D2            MOV      DPTR,#func
0046C0 E0                MOVX     A,@DPTR
0046C1 FC                MOV      R4,A
0046C2 A3                INC      DPTR
0046C3 E0                MOVX     A,@DPTR
0046C4 FD                MOV      R5,A
0046C5 D007              POP      AR7
0046C7 B1FB              ACALL    _TimerSave
0046C9 9043D8            MOV      DPTR,#timerHandle
0046CC E0                MOVX     A,@DPTR
0046CD 04                INC      A
0046CE FF                MOV      R7,A
0046CF 9043D7            MOV      DPTR,#retCode
0046D2 F0                MOVX     @DPTR,A
0046D3 22                RET      
0046D4         ?C0004?ZW_TIMER:
0046D4 9043D8            MOV      DPTR,#timerHandle
0046D7 E0                MOVX     A,@DPTR
0046D8 04                INC      A
0046D9 F0                MOVX     @DPTR,A
0046DA 8098              SJMP     ?C0002?ZW_TIMER
0046DC         ?C0003?ZW_TIMER:
0046DC 9043D7            MOV      DPTR,#retCode
0046DF E0                MOVX     A,@DPTR
0046E0 FF                MOV      R7,A
0046E1 22                RET      
----- FUNCTION _TimerStart_ (END) -------


----- FUNCTION NetworkManagementSmartStartIsEnabled (BEGIN) -----
0046E2 901217            MOV      DPTR,#eSystemTypeState
0046E5 E0                MOVX     A,@DPTR
0046E6 7F00              MOV      R7,#00H
0046E8 30E202            JNB      ACC.2,?C0004?ZW_NETWORK_MANAGEMENT
0046EB 7F01              MOV      R7,#01H
0046ED         ?C0004?ZW_NETWORK_MANAGEMENT:
0046ED 22                RET      
----- FUNCTION NetworkManagementSmartStartIsEnabled (END) -------


----- FUNCTION ?L?COM01D5 (BEGIN) -----
0046EE EB                MOV      A,R3
0046EF         ?L?COM01D6:
0046EF 75F00C            MOV      B,#0CH
0046F2 A4                MUL      AB
0046F3 246D              ADD      A,#LOW timerArray+04H
0046F5 F582              MOV      DPL,A
0046F7 E4                CLR      A
0046F8 3435              ADDC     A,#HIGH timerArray+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 60


0046FA F583              MOV      DPH,A
0046FC 22                RET      
----- FUNCTION ?L?COM01D5 (END) -------


----- FUNCTION ?L?COM026E (BEGIN) -----
0046FD E4                CLR      A
0046FE 7FD0              MOV      R7,#0D0H
004700 7E07              MOV      R6,#07H
004702 FD                MOV      R5,A
004703 FC                MOV      R4,A
004704         ?L?COM026F:
004704 904314            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+02H
004707 1224BA            LCALL    ?C?LSTXDATA
00470A E4                CLR      A
00470B 904318            MOV      DPTR,#?_ZW_TimerLongStart?BYTE+06H
00470E F0                MOVX     @DPTR,A
00470F 22                RET      
----- FUNCTION ?L?COM026E (END) -------


----- FUNCTION ?L?COM0210 (BEGIN) -----
004710 E57D              MOV      A,timerHandle
004712 75F00C            MOV      B,#0CH
004715 A4                MUL      AB
004716 2471              ADD      A,#LOW timerArray+08H
004718 F582              MOV      DPL,A
00471A E4                CLR      A
00471B 3435              ADDC     A,#HIGH timerArray+08H
00471D         ?L?COM0211:
00471D F583              MOV      DPH,A
00471F E0                MOVX     A,@DPTR
004720 FE                MOV      R6,A
004721 A3                INC      DPTR
004722 E0                MOVX     A,@DPTR
004723 22                RET      
----- FUNCTION ?L?COM0210 (END) -------


----- FUNCTION ZW_Poll (BEGIN) -----
004724 E515              MOV      A,RF_status
004726 30E20F            JNB      ACC.2,?C0077?ZW_MAIN
004729 E515              MOV      A,RF_status
00472B 20E50A            JB       ACC.5,?C0077?ZW_MAIN
00472E E515              MOV      A,RF_status
004730 30E005            JNB      ACC.0,?C0077?ZW_MAIN
004733 7F01              MOV      R7,#01H
004735 125006            LCALL    _ZW_SetRFReceiveMode
004738         ?C0077?ZW_MAIN:
004738 22                RET      
----- FUNCTION ZW_Poll (END) -------


----- FUNCTION _ZW_SerialPutByte_uart (BEGIN) -----
004739 900AEC            MOV      DPTR,#val
00473C EF                MOV      A,R7
00473D F0                MOVX     @DPTR,A
00473E         ?C0014?ZW_CONBUFIO_UART:
00473E E575              MOV      A,txCount
004740 C3                CLR      C
004741 9420              SUBB     A,#020H
004743 4004              JC       ?C0015?ZW_CONBUFIO_UART
004745 F124              ACALL    ZW_Poll
004747 80F5              SJMP     ?C0014?ZW_CONBUFIO_UART
004749         ?C0015?ZW_CONBUFIO_UART:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 61


004749 E571              MOV      A,txInPtr
00474B C3                CLR      C
00474C 9420              SUBB     A,#020H
00474E 4003              JC       ?C0016?ZW_CONBUFIO_UART
004750 E4                CLR      A
004751 F571              MOV      txInPtr,A
004753         ?C0016?ZW_CONBUFIO_UART:
004753 C2AC              CLR      ES0
004755 F1C1              ACALL    ZW_UART0_tx_active_get
004757 EF                MOV      A,R7
004758 700D              JNZ      ?C0017?ZW_CONBUFIO_UART
00475A E575              MOV      A,txCount
00475C 7009              JNZ      ?C0017?ZW_CONBUFIO_UART
00475E 900AEC            MOV      DPTR,#val
004761 E0                MOVX     A,@DPTR
004762 FF                MOV      R7,A
004763 F1BB              ACALL    _ZW_UART0_tx_data_set
004765 8012              SJMP     ?C0018?ZW_CONBUFIO_UART
004767         ?C0017?ZW_CONBUFIO_UART:
004767 900AEC            MOV      DPTR,#val
00476A E0                MOVX     A,@DPTR
00476B FF                MOV      R7,A
00476C AE71              MOV      R6,txInPtr
00476E 0571              INC      txInPtr
004770 7418              MOV      A,#LOW UARTTxQueue
004772 2E                ADD      A,R6
004773 F1E4              ACALL    ?L?COM0546
004775 EF                MOV      A,R7
004776 F0                MOVX     @DPTR,A
004777 0575              INC      txCount
004779         ?C0018?ZW_CONBUFIO_UART:
004779 D2AC              SETB     ES0
00477B 7F01              MOV      R7,#01H
00477D 22                RET      
----- FUNCTION _ZW_SerialPutByte_uart (END) -------


----- FUNCTION _TimerRestart (BEGIN) -----
;---- Variable 'btimerHandle' assigned to Register 'R3' ----
00477E AB07              MOV      R3,AR7
;---- Variable 'retCode' assigned to Register 'R2' ----
004780 E4                CLR      A
004781 FA                MOV      R2,A
004782 1B                DEC      R3
004783 EB                MOV      A,R3
004784 C3                CLR      C
004785 940E              SUBB     A,#0EH
004787 500D              JNC      ?C0026?ZW_TIMER
004789 D1EE              ACALL    ?L?COM01D5
00478B F1EC              ACALL    ?L?COM057A
00478D 6007              JZ       ?C0026?ZW_TIMER
00478F EB                MOV      A,R3
004790 B1DD              ACALL    ?L?COM00A0
004792 1224BA            LCALL    ?C?LSTXDATA
004795 0A                INC      R2
004796         ?C0026?ZW_TIMER:
004796 AF02              MOV      R7,AR2
004798 22                RET      
----- FUNCTION _TimerRestart (END) -------


----- FUNCTION ?L?COM041C (BEGIN) -----
004799 FA                MOV      R2,A
00479A F9                MOV      R1,A
00479B F8                MOV      R0,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 62


00479C C3                CLR      C
00479D 02239D            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM041C (END) -------


----- FUNCTION ?L?COM0598 (BEGIN) -----
0047A0 E4                CLR      A
0047A1 FD                MOV      R5,A
0047A2 FC                MOV      R4,A
0047A3 FF                MOV      R7,A
0047A4 021A02            LJMP     ?INTERBANK_TABLE?_InternSetLearnMode
----- FUNCTION ?L?COM0598 (END) -------


----- FUNCTION NetworkManagementWUTPowerDownInterrupted (BEGIN) -----
0047A7 901217            MOV      DPTR,#eSystemTypeState
0047AA E0                MOVX     A,@DPTR
0047AB 5408              ANL      A,#08H
0047AD FF                MOV      R7,A
0047AE 22                RET      
----- FUNCTION NetworkManagementWUTPowerDownInterrupted (END) -------


----- FUNCTION ?L?COM0358 (BEGIN) -----
0047AF E0                MOVX     A,@DPTR
0047B0 FE                MOV      R6,A
0047B1 A3                INC      DPTR
0047B2 E0                MOVX     A,@DPTR
0047B3 FF                MOV      R7,A
0047B4 E4                CLR      A
0047B5 FC                MOV      R4,A
0047B6 22                RET      
----- FUNCTION ?L?COM0358 (END) -------


----- FUNCTION _ZW_TimerLongRestart (BEGIN) -----
;---- Variable 'bTimerHandle' assigned to Register 'R7' ----
0047B7 80C5              SJMP     _TimerRestart
----- FUNCTION _ZW_TimerLongRestart (END) -------


----- FUNCTION _ZW_TimerLongCancel (BEGIN) -----
;---- Variable 'bTimerHandle' assigned to Register 'R7' ----
0047B9 81EE              AJMP     _TimerCancel
----- FUNCTION _ZW_TimerLongCancel (END) -------


----- FUNCTION _ZW_UART0_tx_data_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
0047BB 8FEF              MOV      UART0BUF,R7
0047BD 22                RET      
----- FUNCTION _ZW_UART0_tx_data_set (END) -------


----- FUNCTION ?L?COM03CA (BEGIN) -----
0047BE F139              ACALL    _ZW_SerialPutByte_uart
----- FUNCTION ZW_SerialFlush_uart (BEGIN) -----
0047C0 22                RET      
----- FUNCTION ZW_SerialFlush_uart (END) -------


----- FUNCTION ZW_UART0_tx_active_get (BEGIN) -----
0047C1 E5ED              MOV      A,UARTSTAT
0047C3 5401              ANL      A,#01H
0047C5 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 63


0047C6 22                RET      
----- FUNCTION ZW_UART0_tx_active_get (END) -------


----- FUNCTION ?L?COM0359 (BEGIN) -----
0047C7 7B00              MOV      R3,#00H
0047C9 7A00              MOV      R2,#00H
0047CB 7900              MOV      R1,#00H
0047CD 22                RET      
----- FUNCTION ?L?COM0359 (END) -------


----- FUNCTION ?L?COM04BE (BEGIN) -----
0047CE CF                XCH      A,R7
0047CF F0                MOVX     @DPTR,A
0047D0 A3                INC      DPTR
0047D1 EF                MOV      A,R7
0047D2 F0                MOVX     @DPTR,A
0047D3 E4                CLR      A
0047D4 22                RET      
----- FUNCTION ?L?COM04BE (END) -------


----- FUNCTION ?L?COM056C (BEGIN) -----
0047D5 7C00              MOV      R4,#00H
0047D7 7D0A              MOV      R5,#0AH
0047D9 02206F            LJMP     ?C?IMUL
----- FUNCTION ?L?COM056C (END) -------


----- FUNCTION NetworkManagementSmartStartEnable (BEGIN) -----
0047DC 901217            MOV      DPTR,#eSystemTypeState
0047DF E0                MOVX     A,@DPTR
0047E0 4404              ORL      A,#04H
0047E2 F0                MOVX     @DPTR,A
0047E3 22                RET      
----- FUNCTION NetworkManagementSmartStartEnable (END) -------


----- FUNCTION ?L?COM0546 (BEGIN) -----
0047E4 F582              MOV      DPL,A
0047E6 E4                CLR      A
0047E7 3409              ADDC     A,#HIGH UARTTxQueue
0047E9 F583              MOV      DPH,A
0047EB 22                RET      
----- FUNCTION ?L?COM0546 (END) -------


----- FUNCTION ?L?COM057A (BEGIN) -----
0047EC 122462            LCALL    ?C?LLDXDATA
0047EF EC                MOV      A,R4
0047F0 4D                ORL      A,R5
0047F1 4E                ORL      A,R6
0047F2 4F                ORL      A,R7
0047F3 22                RET      
----- FUNCTION ?L?COM057A (END) -------


----- FUNCTION main_PowerDown_ReadyCheck (BEGIN) -----
0047F4 20022C            JB       findInProgress,?C0044?ZW_MAIN
0047F7 901217            MOV      DPTR,#eSystemTypeState
0047FA E0                MOVX     A,@DPTR
0047FB 30E10B            JNB      ACC.1,?C0046?ZW_MAIN
0047FE 124826            LCALL    RFIsReceivingBeam
004801 5006              JNC      ?C0046?ZW_MAIN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 64


004803 7E00              MOV      R6,#00H
004805 7F01              MOV      R7,#01H
004807 8004              SJMP     ?C0047?ZW_MAIN
004809         ?C0046?ZW_MAIN:
004809 7E00              MOV      R6,#00H
00480B 7F00              MOV      R7,#00H
00480D         ?C0047?ZW_MAIN:
00480D EF                MOV      A,R7
00480E 4E                ORL      A,R6
00480F 7012              JNZ      ?C0044?ZW_MAIN
004811 121C91            LCALL    ?INTERBANK_TABLE?sec0_state
004814 EF                MOV      A,R7
004815 700C              JNZ      ?C0044?ZW_MAIN
004817 121CC8            LCALL    ?INTERBANK_TABLE?s2_busy
00481A EF                MOV      A,R7
00481B 7006              JNZ      ?C0044?ZW_MAIN
00481D 124055            LCALL    main_PowerDown_Setup
004820 7F01              MOV      R7,#01H
004822 22                RET      
004823         ?C0044?ZW_MAIN:
004823 7F00              MOV      R7,#00H
004825 22                RET      
----- FUNCTION main_PowerDown_ReadyCheck (END) -------


----- FUNCTION RFIsReceivingBeam (BEGIN) -----
004826 A218              MOV      C,RF_WakeupReceived
004828 22                RET      
----- FUNCTION RFIsReceivingBeam (END) -------


----- FUNCTION _ZW_SetSleepMode (BEGIN) -----
004829 900AB2            MOV      DPTR,#Mode
00482C EF                MOV      A,R7
00482D F0                MOVX     @DPTR,A
00482E 900AB4            MOV      DPTR,#bBeamCount
004831 EB                MOV      A,R3
004832 F0                MOVX     @DPTR,A
004833 900AB3            MOV      DPTR,#IntEnable
004836 ED                MOV      A,R5
004837 F0                MOVX     @DPTR,A
004838 5402              ANL      A,#02H
00483A 901240            MOV      DPTR,#extInt1Enabled
00483D F0                MOVX     @DPTR,A
00483E 1247F4            LCALL    main_PowerDown_ReadyCheck
004841 EF                MOV      A,R7
004842 7002              JNZ      ?C0050?ZW_MAIN
004844 C3                CLR      C
004845 22                RET      
004846         ?C0050?ZW_MAIN:
004846 900AB2            MOV      DPTR,#Mode
004849 E0                MOVX     A,@DPTR
00484A B40411            CJNE     A,#04H,?C0052?ZW_MAIN
00484D A3                INC      DPTR
00484E E0                MOVX     A,@DPTR
00484F FB                MOV      R3,A
004850 7D01              MOV      R5,#01H
004852 7F01              MOV      R7,#01H
004854 1183              ACALL    _ZW_power_down_mode_init
004856 900AB2            MOV      DPTR,#Mode
004859 7403              MOV      A,#03H
00485B F0                MOVX     @DPTR,A
00485C 8013              SJMP     ?C0053?ZW_MAIN
00485E         ?C0052?ZW_MAIN:
00485E 900AB2            MOV      DPTR,#Mode
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 65


004861 E0                MOVX     A,@DPTR
004862 B40505            CJNE     A,#05H,?C0054?ZW_MAIN
004865 121C00            LCALL    ?INTERBANK_TABLE?Power_Management_FLiRSSetup
004868 8007              SJMP     ?C0053?ZW_MAIN
00486A         ?C0054?ZW_MAIN:
00486A 900AB3            MOV      DPTR,#IntEnable
00486D 11B0              ACALL    ?L?COM04B1
00486F 1183              ACALL    _ZW_power_down_mode_init
004871         ?C0053?ZW_MAIN:
004871 900AB2            MOV      DPTR,#Mode
004874 E0                MOVX     A,@DPTR
004875 9003C1            MOV      DPTR,#sleepMode
004878 F0                MOVX     @DPTR,A
004879 900AB4            MOV      DPTR,#bBeamCount
00487C E0                MOVX     A,@DPTR
00487D 90123F            MOV      DPTR,#bBeamCountWakeup
004880 F0                MOVX     @DPTR,A
004881 D3                SETB     C
004882 22                RET      
----- FUNCTION _ZW_SetSleepMode (END) -------


----- FUNCTION _ZW_power_down_mode_init (BEGIN) -----
;---- Variable 'bHighResolutionWUT' assigned to Register 'R7' ----
;---- Variable 'bEnableExtInt' assigned to Register 'R3' ----
;---- Variable 'bKeepCriticalMemory' assigned to Register 'R5' ----
004883 EB                MOV      A,R3
004884 6008              JZ       ?C0001?ZW_PHY_POWER_050X
004886 75FF01            MOV      SFRPAGE,#01H
004889 53CDFD            ANL      PMGTINT2,#0FDH
00488C 8006              SJMP     ?C0002?ZW_PHY_POWER_050X
00488E         ?C0001?ZW_PHY_POWER_050X:
00488E 75FF01            MOV      SFRPAGE,#01H
004891 43CD02            ORL      PMGTINT2,#02H
004894         ?C0002?ZW_PHY_POWER_050X:
004894 ED                MOV      A,R5
004895 6005              JZ       ?C0003?ZW_PHY_POWER_050X
004897 53FBDF            ANL      PMGTCON,#0DFH
00489A 8003              SJMP     ?C0004?ZW_PHY_POWER_050X
00489C         ?C0003?ZW_PHY_POWER_050X:
00489C 43FB20            ORL      PMGTCON,#020H
00489F         ?C0004?ZW_PHY_POWER_050X:
00489F EF                MOV      A,R7
0048A0 6007              JZ       ?C0005?ZW_PHY_POWER_050X
0048A2 75FF02            MOV      SFRPAGE,#02H
0048A5 43E140            ORL      WUTREG1,#040H
0048A8 22                RET      
0048A9         ?C0005?ZW_PHY_POWER_050X:
0048A9 75FF02            MOV      SFRPAGE,#02H
0048AC 53E1BF            ANL      WUTREG1,#0BFH
0048AF 22                RET      
----- FUNCTION _ZW_power_down_mode_init (END) -------


----- FUNCTION ?L?COM04B1 (BEGIN) -----
0048B0 E0                MOVX     A,@DPTR
0048B1 FB                MOV      R3,A
0048B2 7D01              MOV      R5,#01H
0048B4 E4                CLR      A
0048B5 FF                MOV      R7,A
0048B6 22                RET      
----- FUNCTION ?L?COM04B1 (END) -------


----- FUNCTION GoToSleep (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 66


0048B7 121C00            LCALL    ?INTERBANK_TABLE?Power_Management_FLiRSSetup
0048BA 7F01              MOV      R7,#01H
;----                  JMP      _ZW_power_down_mode
----- FUNCTION GoToSleep (END) -------


----- FUNCTION _ZW_power_down_mode (BEGIN) -----
;---- Variable 'bEnableWUT' assigned to Register 'R7' ----
0048BC 43FB10            ORL      PMGTCON,#010H
0048BF 75FF02            MOV      SFRPAGE,#02H
0048C2 43E640            ORL      RSETVEC,#040H
0048C5 EF                MOV      A,R7
0048C6 600D              JZ       ?C0008?ZW_PHY_POWER_050X
0048C8 75FF02            MOV      SFRPAGE,#02H
0048CB         ?C0009?ZW_PHY_POWER_050X:
0048CB E5E1              MOV      A,WUTREG1
0048CD 20E7FB            JB       ACC.7,?C0009?ZW_PHY_POWER_050X
0048D0         ?C0010?ZW_PHY_POWER_050X:
0048D0 43FB0D            ORL      PMGTCON,#0DH
0048D3 8003              SJMP     ?C0012?ZW_PHY_POWER_050X
0048D5         ?C0008?ZW_PHY_POWER_050X:
0048D5 43FB0E            ORL      PMGTCON,#0EH
0048D8         ?C0012?ZW_PHY_POWER_050X:
0048D8 80FE              SJMP     ?C0012?ZW_PHY_POWER_050X
----- FUNCTION _ZW_power_down_mode (END) -------


----- FUNCTION _ZW_SetWutTimeout (BEGIN) -----
;---- Variable 'wutTimeout' assigned to Register 'R7' ----
;----                  JMP      _ZW_power_down_wut_timeout
----- FUNCTION _ZW_SetWutTimeout (END) -------


----- FUNCTION _ZW_power_down_wut_timeout (BEGIN) -----
;---- Variable 'bTimeout' assigned to Register 'R7' ----
0048DA 75FF02            MOV      SFRPAGE,#02H
0048DD 8FE3              MOV      WUTTIME,R7
0048DF 22                RET      
----- FUNCTION _ZW_power_down_wut_timeout (END) -------


----- FUNCTION NewIDNeeded (BEGIN) -----
0048E0 901221            MOV      DPTR,#nodeID
0048E3 E0                MOVX     A,@DPTR
0048E4 7010              JNZ      ?C0058?ZW_MAIN
0048E6 11F8              ACALL    ?L?COM042E
0048E8 4F                ORL      A,R7
0048E9 FF                MOV      R7,A
0048EA A3                INC      DPTR
0048EB E0                MOVX     A,@DPTR
0048EC 4F                ORL      A,R7
0048ED FF                MOV      R7,A
0048EE A3                INC      DPTR
0048EF E0                MOVX     A,@DPTR
0048F0 4F                ORL      A,R7
0048F1 7003              JNZ      ?C0058?ZW_MAIN
0048F3 D3                SETB     C
0048F4 8001              SJMP     ?C0059?ZW_MAIN
0048F6         ?C0058?ZW_MAIN:
0048F6 C3                CLR      C
0048F7         ?C0059?ZW_MAIN:
0048F7 22                RET      
----- FUNCTION NewIDNeeded (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 67


----- FUNCTION ?L?COM042E (BEGIN) -----
0048F8 901223            MOV      DPTR,#homeID
0048FB E0                MOVX     A,@DPTR
0048FC FF                MOV      R7,A
0048FD A3                INC      DPTR
0048FE E0                MOVX     A,@DPTR
0048FF 22                RET      
----- FUNCTION ?L?COM042E (END) -------


----- FUNCTION NewIDCreate (BEGIN) -----
004900 E4                CLR      A
004901 FF                MOV      R7,A
004902 125006            LCALL    _ZW_SetRFReceiveMode
004905 EF                MOV      A,R7
004906 603F              JZ       ?C0071?ZW_MAIN
004908         ?C0064?ZW_MAIN:
004908 F1D6              ACALL    ?L?COM02D2
00490A 3148              ACALL    _RF_get_random_word
00490C 5009              JNC      ?C0068?ZW_MAIN
00490E         ?C0065?ZW_MAIN:
00490E         ?C0062?ZW_MAIN:
00490E 901223            MOV      DPTR,#homeID
004911 E0                MOVX     A,@DPTR
004912 C3                CLR      C
004913 94C0              SUBB     A,#0C0H
004915 40F1              JC       ?C0064?ZW_MAIN
004917         ?C0068?ZW_MAIN:
004917 7B01              MOV      R3,#01H
004919 7A12              MOV      R2,#HIGH homeID+02H
00491B 7925              MOV      R1,#LOW homeID+02H
00491D 3148              ACALL    _RF_get_random_word
00491F 500E              JNC      ?C0067?ZW_MAIN
004921         ?C0069?ZW_MAIN:
004921         ?C0066?ZW_MAIN:
004921 11F8              ACALL    ?L?COM042E
004923 5F                ANL      A,R7
004924 FF                MOV      R7,A
004925 A3                INC      DPTR
004926 E0                MOVX     A,@DPTR
004927 5F                ANL      A,R7
004928 FF                MOV      R7,A
004929 A3                INC      DPTR
00492A E0                MOVX     A,@DPTR
00492B 5F                ANL      A,R7
00492C F4                CPL      A
00492D 60E8              JZ       ?C0068?ZW_MAIN
00492F         ?C0067?ZW_MAIN:
00492F 90122A            MOV      DPTR,#bldeviceOptionsMask
004932 E0                MOVX     A,@DPTR
004933 30E005            JNB      ACC.0,?C0070?ZW_MAIN
004936 7F01              MOV      R7,#01H
004938 125006            LCALL    _ZW_SetRFReceiveMode
00493B         ?C0070?ZW_MAIN:
00493B E4                CLR      A
00493C 901221            MOV      DPTR,#nodeID
00493F F0                MOVX     @DPTR,A
004940 F1D6              ACALL    ?L?COM02D2
004942 E0                MOVX     A,@DPTR
004943 FD                MOV      R5,A
004944 121B88            LCALL    ?INTERBANK_TABLE?_MemoryPutID
004947         ?C0071?ZW_MAIN:
004947 22                RET      
----- FUNCTION NewIDCreate (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 68



----- FUNCTION _RF_get_random_word (BEGIN) -----
004948 90422C            MOV      DPTR,#randomWord
00494B 12663F            LCALL    ?L?COM040F
00494E F0                MOVX     @DPTR,A
00494F 904232            MOV      DPTR,#rf_random
004952 1224C6            LCALL    ?C?LSTKXDATA
004955 00                DB       00H
004956 00                DB       00H
004957 00                DB       00H
004958 01                DB       01H
004959 904236            MOV      DPTR,#success
00495C 7401              MOV      A,#01H
00495E F0                MOVX     @DPTR,A
00495F F5FF              MOV      SFRPAGE,A
004961 E5D5              MOV      A,RFCON
004963 54C0              ANL      A,#0C0H
004965 7005              JNZ      ?C0269?ZW_PHY_RF_050X
004967 1253D5            LCALL    RF_demodulator_enable_get
00496A 5002              JNC      ?C0268?ZW_PHY_RF_050X
00496C         ?C0269?ZW_PHY_RF_050X:
00496C C3                CLR      C
00496D 22                RET      
00496E         ?C0268?ZW_PHY_RF_050X:
00496E E4                CLR      A
00496F F5FF              MOV      SFRPAGE,A
004971 53967F            ANL      DMSETUP5,#07FH
004974 75FF01            MOV      SFRPAGE,#01H
004977 75D504            MOV      RFCON,#04H
00497A 7F3F              MOV      R7,#03FH
00497C FE                MOV      R6,A
00497D 12622D            LCALL    ?L?COM00F7
004980 75FF01            MOV      SFRPAGE,#01H
004983 43D508            ORL      RFCON,#08H
004986 E4                CLR      A
004987 F5FF              MOV      SFRPAGE,A
004989 5394FB            ANL      DMSETUP1,#0FBH
00498C F5FF              MOV      SFRPAGE,A
00498E 53847F            ANL      TRACKCON,#07FH
004991 F5FF              MOV      SFRPAGE,A
004993 7598FF            MOV      DMLSPLO,#0FFH
004996 904230            MOV      DPTR,#dmctrlOld
004999 E5F4              MOV      A,DMCTRL
00499B F0                MOVX     @DPTR,A
00499C 75F49C            MOV      DMCTRL,#09CH
00499F 75FF01            MOV      SFRPAGE,#01H
0049A2 A3                INC      DPTR
0049A3 E5E4              MOV      A,SDCON1
0049A5 F0                MOVX     @DPTR,A
0049A6 75E425            MOV      SDCON1,#025H
0049A9 7B01              MOV      R3,#01H
0049AB 7A42              MOV      R2,#HIGH success
0049AD 7936              MOV      R1,#LOW success
0049AF 12660B            LCALL    __RF_check_checksum
0049B2 904236            MOV      DPTR,#success
0049B5 E0                MOVX     A,@DPTR
0049B6 6401              XRL      A,#01H
0049B8 6002              JZ       $ + 4H
0049BA 416E              AJMP     ?C0271?ZW_PHY_RF_050X
0049BC F5FF              MOV      SFRPAGE,A
0049BE 90422F            MOV      DPTR,#bNumOfBits
0049C1 7414              MOV      A,#014H
0049C3 F0                MOVX     @DPTR,A
0049C4         ?C0274?ZW_PHY_RF_050X:
0049C4 904232            MOV      DPTR,#rf_random
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 69


0049C7 51B0              ACALL    ?L?COM0025
0049C9 7801              MOV      R0,#01H
0049CB 1223C1            LCALL    ?C?LSHL
0049CE 904232            MOV      DPTR,#rf_random
0049D1 1224BA            LCALL    ?C?LSTXDATA
0049D4         ?C0275?ZW_PHY_RF_050X:
0049D4 E5A7              MOV      A,DMSTAT2
0049D6 30E1FB            JNB      ACC.1,?C0275?ZW_PHY_RF_050X
0049D9         ?C0276?ZW_PHY_RF_050X:
0049D9 43A702            ORL      DMSTAT2,#02H
0049DC 904232            MOV      DPTR,#rf_random
0049DF 51B0              ACALL    ?L?COM0025
0049E1 E5A7              MOV      A,DMSTAT2
0049E3 30E005            JNB      ACC.0,?C0277?ZW_PHY_RF_050X
0049E6 E4                CLR      A
0049E7 7B01              MOV      R3,#01H
0049E9 8002              SJMP     ?C0309?ZW_PHY_RF_050X
0049EB         ?C0277?ZW_PHY_RF_050X:
0049EB E4                CLR      A
0049EC FB                MOV      R3,A
0049ED         
0049ED FA                MOV      R2,A
0049EE F9                MOV      R1,A
0049EF F8                MOV      R0,A
0049F0         ?C0278?ZW_PHY_RF_050X:
0049F0 EF                MOV      A,R7
0049F1 4B                ORL      A,R3
0049F2 FF                MOV      R7,A
0049F3 EE                MOV      A,R6
0049F4 4A                ORL      A,R2
0049F5 FE                MOV      R6,A
0049F6 ED                MOV      A,R5
0049F7 49                ORL      A,R1
0049F8 FD                MOV      R5,A
0049F9 EC                MOV      A,R4
0049FA 48                ORL      A,R0
0049FB FC                MOV      R4,A
0049FC 904232            MOV      DPTR,#rf_random
0049FF 1224BA            LCALL    ?C?LSTXDATA
004A02 90422F            MOV      DPTR,#bNumOfBits
004A05 E0                MOVX     A,@DPTR
004A06 14                DEC      A
004A07 F0                MOVX     @DPTR,A
004A08 70BA              JNZ      ?C0274?ZW_PHY_RF_050X
004A0A 904232            MOV      DPTR,#rf_random
004A0D 51B0              ACALL    ?L?COM0025
004A0F 7810              MOV      R0,#010H
004A11 1223AE            LCALL    ?C?ULSHR
004A14 7B6D              MOV      R3,#06DH
004A16 7A4E              MOV      R2,#04EH
004A18 79C6              MOV      R1,#0C6H
004A1A 7841              MOV      R0,#041H
004A1C 12224F            LCALL    ?C?LMUL
004A1F EF                MOV      A,R7
004A20 2439              ADD      A,#039H
004A22 FF                MOV      R7,A
004A23 EE                MOV      A,R6
004A24 3430              ADDC     A,#030H
004A26 B1C2              ACALL    ?L?COM0045
;---- Variable 'seed' assigned to Register 'R4/R5/R6/R7' ----
004A28 E4                CLR      A
004A29 FB                MOV      R3,A
004A2A FA                MOV      R2,A
004A2B 7901              MOV      R1,#01H
004A2D F8                MOV      R0,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 70


004A2E 1222DA            LCALL    ?C?ULDIV
004A31 EE                MOV      A,R6
004A32 547F              ANL      A,#07FH
004A34 FE                MOV      R6,A
004A35 E4                CLR      A
004A36 FD                MOV      R5,A
004A37 FC                MOV      R4,A
004A38 125C8D            LCALL    ?L?COM03F5
004A3B 904232            MOV      DPTR,#rf_random
004A3E 51B0              ACALL    ?L?COM0025
004A40 EB                MOV      A,R3
004A41 6F                XRL      A,R7
004A42 FF                MOV      R7,A
004A43 EA                MOV      A,R2
004A44 6E                XRL      A,R6
004A45 FE                MOV      R6,A
004A46 E8                MOV      A,R0
;---- Variable 'result' assigned to Register 'R4/R5' ----
004A47 CD                XCH      A,R5
004A48 EF                MOV      A,R7
004A49 CD                XCH      A,R5
004A4A CC                XCH      A,R4
004A4B EE                MOV      A,R6
004A4C CC                XCH      A,R4
004A4D EC                MOV      A,R4
004A4E FF                MOV      R7,A
004A4F 90422C            MOV      DPTR,#randomWord
004A52 F1E5              ACALL    ?L?COM02A0
004A54 EF                MOV      A,R7
004A55 12203B            LCALL    ?C?CSTPTR
004A58 90422C            MOV      DPTR,#randomWord
004A5B F1E5              ACALL    ?L?COM02A0
004A5D ED                MOV      A,R5
004A5E 126B68            LCALL    ?L?COM0469
004A61 90120F            MOV      DPTR,#phyRfData+0EH
004A64 E0                MOVX     A,@DPTR
004A65 30E606            JNB      ACC.6,?C0271?ZW_PHY_RF_050X
004A68 E4                CLR      A
004A69 F5FF              MOV      SFRPAGE,A
004A6B 759680            MOV      DMSETUP5,#080H
004A6E         ?C0271?ZW_PHY_RF_050X:
004A6E 75FF01            MOV      SFRPAGE,#01H
004A71 E4                CLR      A
004A72 F5D5              MOV      RFCON,A
004A74 904230            MOV      DPTR,#dmctrlOld
004A77 E0                MOVX     A,@DPTR
004A78 F5F4              MOV      DMCTRL,A
004A7A 75FF01            MOV      SFRPAGE,#01H
004A7D A3                INC      DPTR
004A7E E0                MOVX     A,@DPTR
004A7F F5E4              MOV      SDCON1,A
004A81 126695            LCALL    _RF_init_demodulator
004A84 904236            MOV      DPTR,#success
004A87 E0                MOVX     A,@DPTR
004A88 B40103            CJNE     A,#01H,?C0280?ZW_PHY_RF_050X
004A8B D3                SETB     C
004A8C 8001              SJMP     ?C0281?ZW_PHY_RF_050X
004A8E         ?C0280?ZW_PHY_RF_050X:
004A8E C3                CLR      C
004A8F         ?C0281?ZW_PHY_RF_050X:
004A8F 22                RET      
----- FUNCTION _RF_get_random_word (END) -------


----- FUNCTION ?L?COM0022 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 71


004A90 E0                MOVX     A,@DPTR
004A91 FB                MOV      R3,A
004A92 25E0              ADD      A,ACC
004A94 25E0              ADD      A,ACC
004A96 2401              ADD      A,#LOW phyRfData
004A98 F582              MOV      DPL,A
004A9A E4                CLR      A
004A9B 3412              ADDC     A,#HIGH phyRfData
004A9D F583              MOV      DPH,A
004A9F 1224BA            LCALL    ?C?LSTXDATA
004AA2         ?L?COM0023:
004AA2 EB                MOV      A,R3
004AA3         ?L?COM0024:
004AA3 25E0              ADD      A,ACC
004AA5 25E0              ADD      A,ACC
004AA7 2401              ADD      A,#LOW phyRfData
004AA9 F582              MOV      DPL,A
004AAB E4                CLR      A
004AAC 3412              ADDC     A,#HIGH phyRfData
004AAE F583              MOV      DPH,A
004AB0         ?L?COM0025:
004AB0 E0                MOVX     A,@DPTR
004AB1 FC                MOV      R4,A
004AB2 A3                INC      DPTR
004AB3 E0                MOVX     A,@DPTR
004AB4 FD                MOV      R5,A
004AB5 A3                INC      DPTR
004AB6 E0                MOVX     A,@DPTR
004AB7 FE                MOV      R6,A
004AB8 A3                INC      DPTR
004AB9 E0                MOVX     A,@DPTR
004ABA FF                MOV      R7,A
004ABB 22                RET      
----- FUNCTION ?L?COM0022 (END) -------


----- FUNCTION _RF_onetime_init_and_rx (BEGIN) -----
004ABC 903EBD            MOV      DPTR,#freq_ch0
004ABF 1224BA            LCALL    ?C?LSTXDATA
004AC2 903ECD            MOV      DPTR,#success
004AC5 7401              MOV      A,#01H
004AC7 F0                MOVX     @DPTR,A
004AC8 E4                CLR      A
004AC9 A3                INC      DPTR
004ACA F0                MOVX     @DPTR,A
004ACB 1263F1            LCALL    ?L?COM03FA
004ACE 75FF02            MOV      SFRPAGE,#02H
004AD1 E5E6              MOV      A,RSETVEC
004AD3 30E00E            JNB      ACC.0,?C0092?ZW_PHY_RF_050X
004AD6 903ECE            MOV      DPTR,#rf_already_calculated
004AD9 7401              MOV      A,#01H
004ADB F0                MOVX     @DPTR,A
004ADC FB                MOV      R3,A
004ADD 7A3E              MOV      R2,#HIGH rf_already_calculated
004ADF 79CE              MOV      R1,#LOW rf_already_calculated
004AE1 12660B            LCALL    __RF_check_checksum
004AE4         ?C0092?ZW_PHY_RF_050X:
004AE4 903ED8            MOV      DPTR,#freq_min
004AE7 1224C6            LCALL    ?C?LSTKXDATA
004AEA 00                DB       00H
004AEB 2D                DB       02DH
004AEC C6                DB       0C6H
004AED C0                DB       0C0H
004AEE E4                CLR      A
004AEF F5FF              MOV      SFRPAGE,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 72


004AF1 F5A4              MOV      DMHSFLT4,A
004AF3 90120F            MOV      DPTR,#phyRfData+0EH
004AF6 F0                MOVX     @DPTR,A
004AF7 903ECF            MOV      DPTR,#ch
004AFA 7402              MOV      A,#02H
004AFC F0                MOVX     @DPTR,A
004AFD         ?C0095?ZW_PHY_RF_050X:
004AFD 75FF03            MOV      SFRPAGE,#03H
004B00 903ECF            MOV      DPTR,#ch
004B03 E0                MOVX     A,@DPTR
004B04 FF                MOV      R7,A
004B05 F595              MOV      DMCHAN,A
004B07 EF                MOV      A,R7
004B08 14                DEC      A
004B09 6013              JZ       ?C0098?ZW_PHY_RF_050X
004B0B 14                DEC      A
004B0C 601C              JZ       ?C0099?ZW_PHY_RF_050X
004B0E 2402              ADD      A,#02H
004B10 7027              JNZ      ?C0096?ZW_PHY_RF_050X
004B12         ?C0097?ZW_PHY_RF_050X:
004B12 903EBD            MOV      DPTR,#freq_ch0
004B15 51B0              ACALL    ?L?COM0025
004B17 D19F              ACALL    ?L?COM047F
004B19 903EC9            MOV      DPTR,#rxmode_ch0
004B1C 8016              SJMP     ?C0306?ZW_PHY_RF_050X
004B1E         ?C0098?ZW_PHY_RF_050X:
004B1E 903EC1            MOV      DPTR,#freq_ch1
004B21 51B0              ACALL    ?L?COM0025
004B23 D19F              ACALL    ?L?COM047F
004B25 903ECA            MOV      DPTR,#rxmode_ch1
004B28         
004B28 800A              SJMP     ?C0306?ZW_PHY_RF_050X
004B2A         ?C0099?ZW_PHY_RF_050X:
004B2A 903EC5            MOV      DPTR,#freq_ch2
004B2D 51B0              ACALL    ?L?COM0025
004B2F D19F              ACALL    ?L?COM047F
004B31 903ECB            MOV      DPTR,#rxmode_ch2
004B34         
004B34 E0                MOVX     A,@DPTR
004B35 903EDC            MOV      DPTR,#rxmode
004B38 F0                MOVX     @DPTR,A
004B39         ?C0096?ZW_PHY_RF_050X:
004B39 1267C6            LCALL    _RF_general_setup_per_ch
004B3C 903EDC            MOV      DPTR,#rxmode
004B3F E0                MOVX     A,@DPTR
004B40 7005              JNZ      ?C0100?ZW_PHY_RF_050X
004B42 126F35            LCALL    ?L?COM03A9
004B45 8063              SJMP     ?C0093?ZW_PHY_RF_050X
004B47         ?C0100?ZW_PHY_RF_050X:
004B47 90120E            MOV      DPTR,#phyRfData+0DH
004B4A E0                MOVX     A,@DPTR
004B4B 04                INC      A
004B4C F0                MOVX     @DPTR,A
004B4D 903ECF            MOV      DPTR,#ch
004B50 F1EE              ACALL    ?L?COM03F8
004B52 903ECE            MOV      DPTR,#rf_already_calculated
004B55 E0                MOVX     A,@DPTR
004B56 7019              JNZ      ?C0102?ZW_PHY_RF_050X
004B58 903ED8            MOV      DPTR,#freq_min
004B5B 51B0              ACALL    ?L?COM0025
004B5D 903ED4            MOV      DPTR,#freq
004B60 D15F              ACALL    ?L?COM01AC
004B62 C3                CLR      C
004B63 12239D            LCALL    ?C?ULCMP
004B66 5009              JNC      ?C0102?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 73


004B68 903ED4            MOV      DPTR,#freq
004B6B 51B0              ACALL    ?L?COM0025
004B6D A3                INC      DPTR
004B6E 1224BA            LCALL    ?C?LSTXDATA
004B71         ?C0102?ZW_PHY_RF_050X:
004B71 903EDC            MOV      DPTR,#rxmode
004B74 E0                MOVX     A,@DPTR
004B75 FF                MOV      R7,A
004B76 126647            LCALL    __RF_setup_rx_and_filter
004B79 903ECC            MOV      DPTR,#highside
004B7C E0                MOVX     A,@DPTR
004B7D FF                MOV      R7,A
004B7E 903ECF            MOV      DPTR,#ch
004B81 E0                MOVX     A,@DPTR
004B82 FD                MOV      R5,A
004B83 A234              MOV      C,rf_enable
004B85 9231              MOV      ?__RF_set_IF_setting?BIT,C
004B87 126774            LCALL    __RF_set_IF_setting
004B8A 903ECE            MOV      DPTR,#rf_already_calculated
004B8D E0                MOVX     A,@DPTR
004B8E 7012              JNZ      ?C0104?ZW_PHY_RF_050X
004B90 903ED4            MOV      DPTR,#freq
004B93 51B0              ACALL    ?L?COM0025
004B95 9044F2            MOV      DPTR,#?_calculate_fcw?BYTE+01H
004B98 1224BA            LCALL    ?C?LSTXDATA
004B9B 903ECF            MOV      DPTR,#ch
004B9E E0                MOVX     A,@DPTR
004B9F FF                MOV      R7,A
004BA0 B1CA              ACALL    _calculate_fcw
004BA2         ?C0104?ZW_PHY_RF_050X:
004BA2 903ECF            MOV      DPTR,#ch
004BA5 E0                MOVX     A,@DPTR
004BA6 51A3              ACALL    ?L?COM0024
004BA8 D16B              ACALL    __set_fcw
004BAA         ?C0093?ZW_PHY_RF_050X:
004BAA 12704C            LCALL    ?L?COM0528
004BAD 6002              JZ       $ + 4H
004BAF 41FD              AJMP     ?C0095?ZW_PHY_RF_050X
004BB1 903ECE            MOV      DPTR,#rf_already_calculated
004BB4 E0                MOVX     A,@DPTR
004BB5 7044              JNZ      ?C0105?ZW_PHY_RF_050X
004BB7 A3                INC      DPTR
004BB8 7402              MOV      A,#02H
004BBA F0                MOVX     @DPTR,A
004BBB         ?C0108?ZW_PHY_RF_050X:
004BBB 75FF03            MOV      SFRPAGE,#03H
004BBE 903ECF            MOV      DPTR,#ch
004BC1 F1DD              ACALL    ?L?COM0596
004BC3 7011              JNZ      ?C0106?ZW_PHY_RF_050X
004BC5 903ED8            MOV      DPTR,#freq_min
004BC8 B1A0              ACALL    ?L?COM0040
004BCA 7801              MOV      R0,#01H
004BCC 1223AE            LCALL    ?C?ULSHR
004BCF 903ECF            MOV      DPTR,#ch
004BD2 5190              ACALL    ?L?COM0022
004BD4 D16B              ACALL    __set_fcw
004BD6         ?C0106?ZW_PHY_RF_050X:
004BD6 12704C            LCALL    ?L?COM0528
004BD9 70E0              JNZ      ?C0108?ZW_PHY_RF_050X
004BDB 903ED8            MOV      DPTR,#freq_min
004BDE F1CB              ACALL    ?L?COM0309
004BE0 2420              ADD      A,#020H
004BE2 FF                MOV      R7,A
004BE3 EE                MOV      A,R6
004BE4 344E              ADDC     A,#04EH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 74


004BE6 B1C2              ACALL    ?L?COM0045
004BE8 E4                CLR      A
004BE9 FB                MOV      R3,A
004BEA 7A04              MOV      R2,#04H
004BEC F9                MOV      R1,A
004BED F8                MOV      R0,A
004BEE B1B0              ACALL    ?L?COM0042
004BF0 7801              MOV      R0,#01H
004BF2 1223AE            LCALL    ?C?ULSHR
004BF5 903ED0            MOV      DPTR,#fcw
004BF8 1224BA            LCALL    ?C?LSTXDATA
004BFB         ?C0105?ZW_PHY_RF_050X:
004BFB 12658D            LCALL    ?L?COM02EF
004BFE 4003              JC       ?C0110?ZW_PHY_RF_050X
004C00 43F420            ORL      DMCTRL,#020H
004C03         ?C0110?ZW_PHY_RF_050X:
004C03 A234              MOV      C,rf_enable
004C05 9232              MOV      ?_RF_general_setup?BIT,C
004C07 1266A6            LCALL    _RF_general_setup
004C0A 903ECE            MOV      DPTR,#rf_already_calculated
004C0D E0                MOVX     A,@DPTR
004C0E 24FF              ADD      A,#0FFH
004C10 9230              MOV      ?__PLL_set_bank5?BIT,C
004C12 903ED0            MOV      DPTR,#fcw
004C15 51B0              ACALL    ?L?COM0025
004C17 126581            LCALL    ?L?COM03F7
004C1A F5BD              MOV      DPLLSTART,A
004C1C E4                CLR      A
004C1D F5FF              MOV      SFRPAGE,A
004C1F 75E508            MOV      SDSTAT3,#08H
004C22 126574            LCALL    ?L?COM03F6
004C25         ?C0111?ZW_PHY_RF_050X:
004C25 E59B              MOV      A,SEQCON5
004C27 30E7FB            JNB      ACC.7,?C0111?ZW_PHY_RF_050X
004C2A         ?C0112?ZW_PHY_RF_050X:
004C2A 126218            LCALL    ?L?COM00F4
004C2D 75FF01            MOV      SFRPAGE,#01H
004C30 43D504            ORL      RFCON,#04H
004C33 123F3A            LCALL    ?L?COM022F
004C36 B17A              ACALL    _RF_generate_checksum
004C38 126232            LCALL    wait_phy_timer_timeout
004C3B 7B01              MOV      R3,#01H
004C3D 7A3E              MOV      R2,#HIGH success
004C3F 79CD              MOV      R1,#LOW success
004C41 1265B3            LCALL    __PLL_wait_lock_and_sequencer_done
004C44 90120E            MOV      DPTR,#phyRfData+0DH
004C47 E0                MOVX     A,@DPTR
004C48 B40103            CJNE     A,#01H,?C0113?ZW_PHY_RF_050X
004C4B 126424            LCALL    ?L?COM04D3
004C4E         ?C0113?ZW_PHY_RF_050X:
004C4E 903ECD            MOV      DPTR,#success
004C51 E0                MOVX     A,@DPTR
004C52 B40103            CJNE     A,#01H,?C0114?ZW_PHY_RF_050X
004C55 D3                SETB     C
004C56 8001              SJMP     ?C0115?ZW_PHY_RF_050X
004C58         ?C0114?ZW_PHY_RF_050X:
004C58 C3                CLR      C
004C59         ?C0115?ZW_PHY_RF_050X:
004C59 22                RET      
----- FUNCTION _RF_onetime_init_and_rx (END) -------


----- FUNCTION _RF_onetime_init (BEGIN) -----
004C5A 903FC5            MOV      DPTR,#freq_ch0
004C5D 1224BA            LCALL    ?C?LSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 75


004C60 1263F1            LCALL    ?L?COM03FA
004C63 903FDA            MOV      DPTR,#freq_min
004C66 1224C6            LCALL    ?C?LSTKXDATA
004C69 00                DB       00H
004C6A 2D                DB       02DH
004C6B C6                DB       0C6H
004C6C C0                DB       0C0H
004C6D E4                CLR      A
004C6E F5FF              MOV      SFRPAGE,A
004C70 F5A4              MOV      DMHSFLT4,A
004C72 90120E            MOV      DPTR,#phyRfData+0DH
004C75 F0                MOVX     @DPTR,A
004C76 A3                INC      DPTR
004C77 F0                MOVX     @DPTR,A
004C78 903FD5            MOV      DPTR,#ch
004C7B 7402              MOV      A,#02H
004C7D F0                MOVX     @DPTR,A
004C7E         ?C0078?ZW_PHY_RF_050X:
004C7E 75FF03            MOV      SFRPAGE,#03H
004C81 903FD5            MOV      DPTR,#ch
004C84 E0                MOVX     A,@DPTR
004C85 FF                MOV      R7,A
004C86 F595              MOV      DMCHAN,A
004C88 EF                MOV      A,R7
004C89 14                DEC      A
004C8A 6013              JZ       ?C0081?ZW_PHY_RF_050X
004C8C 14                DEC      A
004C8D 601C              JZ       ?C0082?ZW_PHY_RF_050X
004C8F 2402              ADD      A,#02H
004C91 7027              JNZ      ?C0079?ZW_PHY_RF_050X
004C93         ?C0080?ZW_PHY_RF_050X:
004C93 903FC5            MOV      DPTR,#freq_ch0
004C96 51B0              ACALL    ?L?COM0025
004C98 D199              ACALL    ?L?COM047E
004C9A 903FD1            MOV      DPTR,#rxmode_ch0
004C9D 8016              SJMP     ?C0304?ZW_PHY_RF_050X
004C9F         ?C0081?ZW_PHY_RF_050X:
004C9F 903FC9            MOV      DPTR,#freq_ch1
004CA2 51B0              ACALL    ?L?COM0025
004CA4 D199              ACALL    ?L?COM047E
004CA6 903FD2            MOV      DPTR,#rxmode_ch1
004CA9         
004CA9 800A              SJMP     ?C0304?ZW_PHY_RF_050X
004CAB         ?C0082?ZW_PHY_RF_050X:
004CAB 903FCD            MOV      DPTR,#freq_ch2
004CAE 51B0              ACALL    ?L?COM0025
004CB0 D199              ACALL    ?L?COM047E
004CB2 903FD3            MOV      DPTR,#rxmode_ch2
004CB5         
004CB5 E0                MOVX     A,@DPTR
004CB6 903FDE            MOV      DPTR,#rxmode
004CB9 F0                MOVX     @DPTR,A
004CBA         ?C0079?ZW_PHY_RF_050X:
004CBA 1267C6            LCALL    _RF_general_setup_per_ch
004CBD 903FDE            MOV      DPTR,#rxmode
004CC0 E0                MOVX     A,@DPTR
004CC1 7005              JNZ      ?C0083?ZW_PHY_RF_050X
004CC3 126F35            LCALL    ?L?COM03A9
004CC6 8053              SJMP     ?C0076?ZW_PHY_RF_050X
004CC8         ?C0083?ZW_PHY_RF_050X:
004CC8 90120E            MOV      DPTR,#phyRfData+0DH
004CCB E0                MOVX     A,@DPTR
004CCC 04                INC      A
004CCD F0                MOVX     @DPTR,A
004CCE 903FD5            MOV      DPTR,#ch
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 76


004CD1 F1EE              ACALL    ?L?COM03F8
004CD3 903FDA            MOV      DPTR,#freq_min
004CD6 51B0              ACALL    ?L?COM0025
004CD8 903FD6            MOV      DPTR,#freq
004CDB D15F              ACALL    ?L?COM01AC
004CDD C3                CLR      C
004CDE 12239D            LCALL    ?C?ULCMP
004CE1 5009              JNC      ?C0085?ZW_PHY_RF_050X
004CE3 903FD6            MOV      DPTR,#freq
004CE6 51B0              ACALL    ?L?COM0025
004CE8 A3                INC      DPTR
004CE9 1224BA            LCALL    ?C?LSTXDATA
004CEC         ?C0085?ZW_PHY_RF_050X:
004CEC 903FDE            MOV      DPTR,#rxmode
004CEF E0                MOVX     A,@DPTR
004CF0 FF                MOV      R7,A
004CF1 126647            LCALL    __RF_setup_rx_and_filter
004CF4 903FD4            MOV      DPTR,#highside
004CF7 E0                MOVX     A,@DPTR
004CF8 FF                MOV      R7,A
004CF9 A3                INC      DPTR
004CFA E0                MOVX     A,@DPTR
004CFB FD                MOV      R5,A
004CFC A233              MOV      C,rf_enable
004CFE 9231              MOV      ?__RF_set_IF_setting?BIT,C
004D00 126774            LCALL    __RF_set_IF_setting
004D03 A3                INC      DPTR
004D04 51B0              ACALL    ?L?COM0025
004D06 9044F2            MOV      DPTR,#?_calculate_fcw?BYTE+01H
004D09 1224BA            LCALL    ?C?LSTXDATA
004D0C 903FD5            MOV      DPTR,#ch
004D0F E0                MOVX     A,@DPTR
004D10 FF                MOV      R7,A
004D11 B1CA              ACALL    _calculate_fcw
004D13 903FD5            MOV      DPTR,#ch
004D16 E0                MOVX     A,@DPTR
004D17 51A3              ACALL    ?L?COM0024
004D19 D16B              ACALL    __set_fcw
004D1B         ?C0076?ZW_PHY_RF_050X:
004D1B 127055            LCALL    ?L?COM0529
004D1E 6002              JZ       $ + 4H
004D20 817E              AJMP     ?C0078?ZW_PHY_RF_050X
004D22 7402              MOV      A,#02H
004D24 F0                MOVX     @DPTR,A
004D25         ?C0088?ZW_PHY_RF_050X:
004D25 75FF03            MOV      SFRPAGE,#03H
004D28 903FD5            MOV      DPTR,#ch
004D2B F1DD              ACALL    ?L?COM0596
004D2D 7016              JNZ      ?C0086?ZW_PHY_RF_050X
004D2F FF                MOV      R7,A
004D30 7E04              MOV      R6,#04H
004D32 FD                MOV      R5,A
004D33 FC                MOV      R4,A
004D34 903FDA            MOV      DPTR,#freq_min
004D37 B1A5              ACALL    ?L?COM0041
004D39 7801              MOV      R0,#01H
004D3B 1223AE            LCALL    ?C?ULSHR
004D3E 903FD5            MOV      DPTR,#ch
004D41 5190              ACALL    ?L?COM0022
004D43 D16B              ACALL    __set_fcw
004D45         ?C0086?ZW_PHY_RF_050X:
004D45 127055            LCALL    ?L?COM0529
004D48 70DB              JNZ      ?C0088?ZW_PHY_RF_050X
004D4A 12658D            LCALL    ?L?COM02EF
004D4D 4003              JC       ?C0090?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 77


004D4F 43F420            ORL      DMCTRL,#020H
004D52         ?C0090?ZW_PHY_RF_050X:
004D52 A233              MOV      C,rf_enable
004D54 9232              MOV      ?_RF_general_setup?BIT,C
004D56 1266A6            LCALL    _RF_general_setup
004D59 903FDA            MOV      DPTR,#freq_min
004D5C F1CB              ACALL    ?L?COM0309
004D5E 2420              ADD      A,#020H
004D60 FF                MOV      R7,A
004D61 EE                MOV      A,R6
004D62 344E              ADDC     A,#04EH
004D64 B1C2              ACALL    ?L?COM0045
004D66 E4                CLR      A
004D67 FB                MOV      R3,A
004D68 7A04              MOV      R2,#04H
004D6A F9                MOV      R1,A
004D6B F8                MOV      R0,A
004D6C B1B0              ACALL    ?L?COM0042
004D6E 7801              MOV      R0,#01H
004D70 1223AE            LCALL    ?C?ULSHR
;---- Variable 'fcw' assigned to Register 'R4/R5/R6/R7' ----
004D73 C230              CLR      ?__PLL_set_bank5?BIT
004D75 126581            LCALL    ?L?COM03F7
004D78 F5BD              MOV      DPLLSTART,A
;----                  JMP      _RF_generate_checksum
----- FUNCTION _RF_onetime_init (END) -------


----- FUNCTION _RF_generate_checksum (BEGIN) -----
004D7A 901213            MOV      DPTR,#phyRfData+012H
004D7D 7401              MOV      A,#01H
004D7F F0                MOVX     @DPTR,A
004D80 7E12              MOV      R6,#HIGH phyRfData
004D82 7F01              MOV      R7,#LOW phyRfData
;---- Variable 'adr' assigned to Register 'R6/R7' ----
;---- Variable 'i' assigned to Register 'R5' ----
004D84 E4                CLR      A
004D85 FD                MOV      R5,A
004D86         ?C0021?ZW_PHY_RF_050X:
004D86 8F82              MOV      DPL,R7
004D88 8E83              MOV      DPH,R6
004D8A EF                MOV      A,R7
004D8B 2D                ADD      A,R5
004D8C F582              MOV      DPL,A
004D8E E4                CLR      A
004D8F 3E                ADDC     A,R6
004D90 F583              MOV      DPH,A
004D92 E0                MOVX     A,@DPTR
004D93 FC                MOV      R4,A
004D94 901213            MOV      DPTR,#phyRfData+012H
004D97 E0                MOVX     A,@DPTR
004D98 2C                ADD      A,R4
004D99 F0                MOVX     @DPTR,A
004D9A 0D                INC      R5
004D9B ED                MOV      A,R5
004D9C B412E7            CJNE     A,#012H,?C0021?ZW_PHY_RF_050X
004D9F 22                RET      
----- FUNCTION _RF_generate_checksum (END) -------


----- FUNCTION ?L?COM0040 (BEGIN) -----
004DA0 FF                MOV      R7,A
004DA1 7E04              MOV      R6,#04H
004DA3 FD                MOV      R5,A
004DA4 FC                MOV      R4,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 78


004DA5         ?L?COM0041:
004DA5 E0                MOVX     A,@DPTR
004DA6 F8                MOV      R0,A
004DA7 A3                INC      DPTR
004DA8 E0                MOVX     A,@DPTR
004DA9 F9                MOV      R1,A
004DAA A3                INC      DPTR
004DAB E0                MOVX     A,@DPTR
004DAC FA                MOV      R2,A
004DAD A3                INC      DPTR
004DAE E0                MOVX     A,@DPTR
004DAF FB                MOV      R3,A
004DB0         ?L?COM0042:
004DB0 12224F            LCALL    ?C?LMUL
004DB3 E4                CLR      A
004DB4 7B7D              MOV      R3,#07DH
004DB6 FA                MOV      R2,A
004DB7 F9                MOV      R1,A
004DB8 F8                MOV      R0,A
004DB9 1222DA            LCALL    ?C?ULDIV
004DBC         ?L?COM0043:
004DBC EF                MOV      A,R7
004DBD 2401              ADD      A,#01H
004DBF         ?L?COM0044:
004DBF FF                MOV      R7,A
004DC0 E4                CLR      A
004DC1 3E                ADDC     A,R6
004DC2         ?L?COM0045:
004DC2 FE                MOV      R6,A
004DC3 E4                CLR      A
004DC4 3D                ADDC     A,R5
004DC5 FD                MOV      R5,A
004DC6 E4                CLR      A
004DC7 3C                ADDC     A,R4
004DC8 FC                MOV      R4,A
004DC9 22                RET      
----- FUNCTION ?L?COM0040 (END) -------


----- FUNCTION _calculate_fcw (BEGIN) -----
004DCA 9044F1            MOV      DPTR,#ch
004DCD EF                MOV      A,R7
004DCE F0                MOVX     @DPTR,A
004DCF E4                CLR      A
004DD0 A3                INC      DPTR
004DD1 B1A0              ACALL    ?L?COM0040
004DD3 7801              MOV      R0,#01H
004DD5 1223AE            LCALL    ?C?ULSHR
004DD8 9044F1            MOV      DPTR,#ch
004DDB E0                MOVX     A,@DPTR
004DDC FB                MOV      R3,A
004DDD D1A6              ACALL    ?L?COM0232
004DDF F583              MOV      DPH,A
004DE1 1224BA            LCALL    ?C?LSTXDATA
004DE4 901210            MOV      DPTR,#phyRfData+0FH
004DE7 E0                MOVX     A,@DPTR
004DE8 6480              XRL      A,#080H
004DEA 6072              JZ       ?C0075?ZW_PHY_RF_050X
004DEC E0                MOVX     A,@DPTR
004DED C3                CLR      C
004DEE 947F              SUBB     A,#07FH
004DF0 5039              JNC      ?C0073?ZW_PHY_RF_050X
004DF2 EB                MOV      A,R3
004DF3 D1A6              ACALL    ?L?COM0232
004DF5 F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 79


004DF7 C083              PUSH     DPH
004DF9 C082              PUSH     DPL
004DFB 51B0              ACALL    ?L?COM0025
004DFD EE                MOV      A,R6
004DFE C0E0              PUSH     ACC
004E00 EF                MOV      A,R7
004E01 C0E0              PUSH     ACC
004E03 901210            MOV      DPTR,#phyRfData+0FH
004E06 E0                MOVX     A,@DPTR
004E07 75F004            MOV      B,#04H
004E0A A4                MUL      AB
004E0B AEF0              MOV      R6,B
004E0D FB                MOV      R3,A
004E0E CA                XCH      A,R2
004E0F EE                MOV      A,R6
004E10 CA                XCH      A,R2
004E11 EA                MOV      A,R2
004E12 33                RLC      A
004E13 95E0              SUBB     A,ACC
004E15 F9                MOV      R1,A
004E16 F8                MOV      R0,A
004E17 D0E0              POP      ACC
004E19 FF                MOV      R7,A
004E1A D0E0              POP      ACC
004E1C FE                MOV      R6,A
004E1D C3                CLR      C
004E1E EF                MOV      A,R7
004E1F 9B                SUBB     A,R3
004E20 FF                MOV      R7,A
004E21 EE                MOV      A,R6
004E22 9A                SUBB     A,R2
004E23 FE                MOV      R6,A
004E24 ED                MOV      A,R5
004E25 99                SUBB     A,R1
004E26 FD                MOV      R5,A
004E27 EC                MOV      A,R4
004E28 98                SUBB     A,R0
004E29 802B              SJMP     ?C0302?ZW_PHY_RF_050X
004E2B         ?C0073?ZW_PHY_RF_050X:
004E2B 9044F1            MOV      DPTR,#ch
004E2E D1A5              ACALL    ?L?COM0231
004E30 F583              MOV      DPH,A
004E32 C083              PUSH     DPH
004E34 C082              PUSH     DPL
004E36 D15F              ACALL    ?L?COM01AC
004E38 901210            MOV      DPTR,#phyRfData+0FH
004E3B E0                MOVX     A,@DPTR
004E3C F4                CPL      A
004E3D 04                INC      A
004E3E 75F004            MOV      B,#04H
004E41 A4                MUL      AB
004E42 FF                MOV      R7,A
004E43 AEF0              MOV      R6,B
004E45 EE                MOV      A,R6
004E46 33                RLC      A
004E47 95E0              SUBB     A,ACC
004E49 FD                MOV      R5,A
004E4A FC                MOV      R4,A
004E4B EB                MOV      A,R3
004E4C 2F                ADD      A,R7
004E4D FF                MOV      R7,A
004E4E EA                MOV      A,R2
004E4F 3E                ADDC     A,R6
004E50 FE                MOV      R6,A
004E51 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 80


004E52 3D                ADDC     A,R5
004E53 FD                MOV      R5,A
004E54 E8                MOV      A,R0
004E55 3C                ADDC     A,R4
004E56         
004E56 FC                MOV      R4,A
004E57 D082              POP      DPL
004E59 D083              POP      DPH
004E5B 1224BA            LCALL    ?C?LSTXDATA
004E5E         ?C0075?ZW_PHY_RF_050X:
004E5E 22                RET      
----- FUNCTION _calculate_fcw (END) -------


----- FUNCTION ?L?COM01AC (BEGIN) -----
004E5F E0                MOVX     A,@DPTR
004E60 F8                MOV      R0,A
004E61 A3                INC      DPTR
004E62 E0                MOVX     A,@DPTR
004E63 F9                MOV      R1,A
004E64         ?L?COM01AD:
004E64 A3                INC      DPTR
004E65 E0                MOVX     A,@DPTR
004E66 FA                MOV      R2,A
004E67 A3                INC      DPTR
004E68 E0                MOVX     A,@DPTR
004E69 FB                MOV      R3,A
004E6A 22                RET      
----- FUNCTION ?L?COM01AC (END) -------


----- FUNCTION __set_fcw (BEGIN) -----
004E6B 90454E            MOV      DPTR,#fcw
004E6E 1224BA            LCALL    ?C?LSTXDATA
004E71 75FF01            MOV      SFRPAGE,#01H
004E74 90454E            MOV      DPTR,#fcw
004E77 A3                INC      DPTR
004E78 E0                MOVX     A,@DPTR
004E79 FD                MOV      R5,A
004E7A A3                INC      DPTR
004E7B A3                INC      DPTR
004E7C 126FAE            LCALL    ?L?COM043F
004E7F 8FE1              MOV      RFFREQ1,R7
004E81 90454E            MOV      DPTR,#fcw
004E84 A3                INC      DPTR
004E85 A3                INC      DPTR
004E86 E0                MOVX     A,@DPTR
004E87 FE                MOV      R6,A
004E88 A3                INC      DPTR
004E89 126FA4            LCALL    ?L?COM043E
004E8C 8FE2              MOV      RFFREQ2,R7
004E8E 90454E            MOV      DPTR,#fcw
004E91 A3                INC      DPTR
004E92 A3                INC      DPTR
004E93 A3                INC      DPTR
004E94 E0                MOVX     A,@DPTR
004E95 FF                MOV      R7,A
004E96 8FE3              MOV      RFFREQ3,R7
004E98 22                RET      
----- FUNCTION __set_fcw (END) -------


----- FUNCTION ?L?COM047E (BEGIN) -----
004E99 903FD6            MOV      DPTR,#freq
004E9C 0224BA            LJMP     ?C?LSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 81


----- FUNCTION ?L?COM047E (END) -------


----- FUNCTION ?L?COM047F (BEGIN) -----
004E9F 903ED4            MOV      DPTR,#freq
004EA2 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM047F (END) -------


----- FUNCTION ?L?COM0231 (BEGIN) -----
004EA5 E0                MOVX     A,@DPTR
004EA6         ?L?COM0232:
004EA6 25E0              ADD      A,ACC
004EA8 25E0              ADD      A,ACC
004EAA 2401              ADD      A,#LOW phyRfData
004EAC F582              MOV      DPL,A
004EAE E4                CLR      A
004EAF 3412              ADDC     A,#HIGH phyRfData
004EB1 22                RET      
----- FUNCTION ?L?COM0231 (END) -------


----- FUNCTION _RF_switch_to_TX (BEGIN) -----
004EB2 9043E7            MOV      DPTR,#chsel
004EB5 126563            LCALL    ?L?COM00E9
004EB8 EB                MOV      A,R3
004EB9 F0                MOVX     @DPTR,A
004EBA         ?C0151?ZW_PHY_RF_050X:
004EBA 9043ED            MOV      DPTR,#success
004EBD 7401              MOV      A,#01H
004EBF F0                MOVX     @DPTR,A
004EC0 C235              CLR      rf_inconsistency
004EC2 123F26            LCALL    ?L?COM0301
004EC5         ?C0152?ZW_PHY_RF_050X:
004EC5 123F2F            LCALL    phy_timer_runs
004EC8 5005              JNC      ?C0153?ZW_PHY_RF_050X
004ECA E5FC              MOV      A,SEQCON
004ECC 20E6F6            JB       ACC.6,?C0152?ZW_PHY_RF_050X
004ECF         ?C0153?ZW_PHY_RF_050X:
004ECF 126481            LCALL    RF_mode_get
004ED2 BF0108            CJNE     R7,#01H,?C0156?ZW_PHY_RF_050X
004ED5 E4                CLR      A
004ED6 F5FC              MOV      SEQCON,A
004ED8 75FC40            MOV      SEQCON,#040H
004EDB 8008              SJMP     ?C0157?ZW_PHY_RF_050X
004EDD         ?C0156?ZW_PHY_RF_050X:
004EDD 126481            LCALL    RF_mode_get
004EE0 BF0202            CJNE     R7,#02H,?C0157?ZW_PHY_RF_050X
004EE3 D3                SETB     C
004EE4 22                RET      
004EE5         ?C0157?ZW_PHY_RF_050X:
004EE5 12641D            LCALL    ?L?COM04D2
004EE8 9043E8            MOV      DPTR,#speed
004EEB E0                MOVX     A,@DPTR
004EEC FF                MOV      R7,A
004EED 1267D3            LCALL    _RF_TX_speed_set
004EF0 75FF01            MOV      SFRPAGE,#01H
004EF3 53D5DF            ANL      RFCON,#0DFH
004EF6 53FAFB            ANL      MODCTRL,#0FBH
004EF9 9043E7            MOV      DPTR,#chsel
004EFC E0                MOVX     A,@DPTR
004EFD FF                MOV      R7,A
004EFE 123F48            LCALL    _RF_channel_set
004F01 9043E8            MOV      DPTR,#speed
004F04 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 82


004F05 9043E7            MOV      DPTR,#chsel
004F08 B4080C            CJNE     A,#08H,?C0160?ZW_PHY_RF_050X
004F0B D1A5              ACALL    ?L?COM0231
004F0D F583              MOV      DPH,A
004F0F F1CB              ACALL    ?L?COM0309
004F11 2452              ADD      A,#052H
004F13 B1BF              ACALL    ?L?COM0044
004F15 8003              SJMP     ?C0308?ZW_PHY_RF_050X
004F17         ?C0160?ZW_PHY_RF_050X:
004F17 E0                MOVX     A,@DPTR
004F18 51A3              ACALL    ?L?COM0024
004F1A         
004F1A D16B              ACALL    __set_fcw
004F1C         ?C0161?ZW_PHY_RF_050X:
004F1C 9043E9            MOV      DPTR,#rfpower
004F1F E0                MOVX     A,@DPTR
004F20 FF                MOV      R7,A
004F21 12682C            LCALL    _RF_TX_power_set
004F24 75FF01            MOV      SFRPAGE,#01H
004F27 75FF03            MOV      SFRPAGE,#03H
004F2A 759B04            MOV      SEQCON5,#04H
004F2D 123F26            LCALL    ?L?COM0301
004F30         ?C0164?ZW_PHY_RF_050X:
004F30 75FC42            MOV      SEQCON,#042H
004F33 E5FC              MOV      A,SEQCON
004F35 20E105            JB       ACC.1,?C0163?ZW_PHY_RF_050X
004F38 123F2F            LCALL    phy_timer_runs
004F3B 40F3              JC       ?C0164?ZW_PHY_RF_050X
004F3D         ?C0163?ZW_PHY_RF_050X:
004F3D 9043EA            MOV      DPTR,#highdco
004F40 E0                MOVX     A,@DPTR
004F41 F0                MOVX     @DPTR,A
004F42         ?C0168?ZW_PHY_RF_050X:
004F42 75FF03            MOV      SFRPAGE,#03H
004F45 E59B              MOV      A,SEQCON5
004F47 20E705            JB       ACC.7,?C0167?ZW_PHY_RF_050X
004F4A 123F2F            LCALL    phy_timer_runs
004F4D 40F3              JC       ?C0168?ZW_PHY_RF_050X
004F4F         ?C0167?ZW_PHY_RF_050X:
004F4F E59B              MOV      A,SEQCON5
004F51 20E70D            JB       ACC.7,?C0170?ZW_PHY_RF_050X
004F54 75FF03            MOV      SFRPAGE,#03H
004F57 759B1F            MOV      SEQCON5,#01FH
004F5A 1256F5            LCALL    RF_shutdown
004F5D D235              SETB     rf_inconsistency
004F5F 804F              SJMP     ?C0171?ZW_PHY_RF_050X
004F61         ?C0170?ZW_PHY_RF_050X:
004F61 F1C4              ACALL    ?L?COM04D4
004F63 12660B            LCALL    __RF_check_checksum
004F66 9043E8            MOV      DPTR,#speed
004F69 E0                MOVX     A,@DPTR
004F6A FD                MOV      R5,A
004F6B 90120F            MOV      DPTR,#phyRfData+0EH
004F6E E0                MOVX     A,@DPTR
004F6F 5D                ANL      A,R5
004F70 701C              JNZ      ?C0172?ZW_PHY_RF_050X
004F72 9043E7            MOV      DPTR,#chsel
004F75 E0                MOVX     A,@DPTR
004F76 FF                MOV      R7,A
004F77 F1C4              ACALL    ?L?COM04D4
004F79 125A70            LCALL    __set_separation_TX
004F7C 90120F            MOV      DPTR,#phyRfData+0EH
004F7F E0                MOVX     A,@DPTR
004F80 FF                MOV      R7,A
004F81 9043E8            MOV      DPTR,#speed
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 83


004F84 E0                MOVX     A,@DPTR
004F85 FE                MOV      R6,A
004F86 EF                MOV      A,R7
004F87 4E                ORL      A,R6
004F88 90120F            MOV      DPTR,#phyRfData+0EH
004F8B F0                MOVX     @DPTR,A
004F8C B17A              ACALL    _RF_generate_checksum
004F8E         ?C0172?ZW_PHY_RF_050X:
004F8E 1262E9            LCALL    _PLL_boost_bias
004F91         ?C0173?ZW_PHY_RF_050X:
004F91 7B01              MOV      R3,#01H
004F93 7A43              MOV      R2,#HIGH timer_mark
004F95 79EB              MOV      R1,#LOW timer_mark
004F97 126433            LCALL    _get_phy_timer
004F9A 500F              JNC      ?C0174?ZW_PHY_RF_050X
004F9C C3                CLR      C
004F9D 9043EC            MOV      DPTR,#timer_mark+01H
004FA0 E0                MOVX     A,@DPTR
004FA1 9420              SUBB     A,#020H
004FA3 9043EB            MOV      DPTR,#timer_mark
004FA6 E0                MOVX     A,@DPTR
004FA7 9403              SUBB     A,#03H
004FA9 40E6              JC       ?C0173?ZW_PHY_RF_050X
004FAB         ?C0174?ZW_PHY_RF_050X:
004FAB F1C4              ACALL    ?L?COM04D4
004FAD 1265B3            LCALL    __PLL_wait_lock_and_sequencer_done
004FB0         ?C0171?ZW_PHY_RF_050X:
004FB0 126232            LCALL    wait_phy_timer_timeout
004FB3 303502            JNB      rf_inconsistency,$ + 5H
004FB6 C1BA              AJMP     ?C0151?ZW_PHY_RF_050X
004FB8 9043ED            MOV      DPTR,#success
004FBB E0                MOVX     A,@DPTR
004FBC B40103            CJNE     A,#01H,?C0175?ZW_PHY_RF_050X
004FBF D3                SETB     C
004FC0 8001              SJMP     ?C0176?ZW_PHY_RF_050X
004FC2         ?C0175?ZW_PHY_RF_050X:
004FC2 C3                CLR      C
004FC3         ?C0176?ZW_PHY_RF_050X:
004FC3 22                RET      
----- FUNCTION _RF_switch_to_TX (END) -------


----- FUNCTION ?L?COM04D4 (BEGIN) -----
004FC4 7B01              MOV      R3,#01H
004FC6 7A43              MOV      R2,#HIGH success
004FC8 79ED              MOV      R1,#LOW success
004FCA 22                RET      
----- FUNCTION ?L?COM04D4 (END) -------


----- FUNCTION ?L?COM0309 (BEGIN) -----
004FCB E0                MOVX     A,@DPTR
004FCC FC                MOV      R4,A
004FCD A3                INC      DPTR
004FCE E0                MOVX     A,@DPTR
004FCF FD                MOV      R5,A
004FD0 A3                INC      DPTR
004FD1 E0                MOVX     A,@DPTR
004FD2 FE                MOV      R6,A
004FD3 A3                INC      DPTR
004FD4 E0                MOVX     A,@DPTR
004FD5 22                RET      
----- FUNCTION ?L?COM0309 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 84


----- FUNCTION ?L?COM02D2 (BEGIN) -----
004FD6 7B01              MOV      R3,#01H
004FD8 7A12              MOV      R2,#HIGH homeID
004FDA 7923              MOV      R1,#LOW homeID
004FDC 22                RET      
----- FUNCTION ?L?COM02D2 (END) -------


----- FUNCTION ?L?COM0596 (BEGIN) -----
004FDD E0                MOVX     A,@DPTR
004FDE F595              MOV      DMCHAN,A
004FE0 E5F4              MOV      A,DMCTRL
004FE2 5407              ANL      A,#07H
004FE4 22                RET      
----- FUNCTION ?L?COM0596 (END) -------


----- FUNCTION ?L?COM02A0 (BEGIN) -----
004FE5 E0                MOVX     A,@DPTR
004FE6 FB                MOV      R3,A
004FE7 A3                INC      DPTR
004FE8 E0                MOVX     A,@DPTR
004FE9 FA                MOV      R2,A
004FEA A3                INC      DPTR
004FEB E0                MOVX     A,@DPTR
004FEC F9                MOV      R1,A
004FED 22                RET      
----- FUNCTION ?L?COM02A0 (END) -------


----- FUNCTION ?L?COM03F8 (BEGIN) -----
004FEE E0                MOVX     A,@DPTR
004FEF         ?L?COM03F9:
004FEF 33                RLC      A
004FF0 33                RLC      A
004FF1 33                RLC      A
004FF2 54F8              ANL      A,#0F8H
004FF4 F5F4              MOV      DMCTRL,A
004FF6 22                RET      
----- FUNCTION ?L?COM03F8 (END) -------


----- FUNCTION _GetRandom (BEGIN) -----
;---- Variable 'bMax' assigned to Register 'R6' ----
004FF7 AE07              MOV      R6,AR7
004FF9 12418F            LCALL    ZW_Random
004FFC EE                MOV      A,R6
004FFD 04                INC      A
004FFE FE                MOV      R6,A
004FFF EF                MOV      A,R7
005000 8EF0              MOV      B,R6
005002 84                DIV      AB
005003 AFF0              MOV      R7,B
005005 22                RET      
----- FUNCTION _GetRandom (END) -------


----- FUNCTION _ZW_SetRFReceiveMode (BEGIN) -----
;---- Variable 'mode' assigned to Register 'R7' ----
005006 EF                MOV      A,R7
005007 600E              JZ       ?C0078?ZW_MAIN
005009 123463            LCALL    ?L?COM00DA
00500C AF82              MOV      R7,DPL
00500E AE83              MOV      R6,DPH
005010 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 85


005011 FD                MOV      R5,A
005012 123D8E            LCALL    _RFReceiveRestart
005015 8009              SJMP     ?C0079?ZW_MAIN
005017         ?C0078?ZW_MAIN:
005017 121A6B            LCALL    ?INTERBANK_TABLE?TxQueueWaitForIdle
00501A 71F5              ACALL    RFPowerDown
00501C E4                CLR      A
00501D 33                RLC      A
00501E FF                MOV      R7,A
00501F 22                RET      
005020         ?C0079?ZW_MAIN:
005020 7F01              MOV      R7,#01H
005022 22                RET      
----- FUNCTION _ZW_SetRFReceiveMode (END) -------


----- FUNCTION _RFTransmitNow (BEGIN) -----
005023 900A80            MOV      DPTR,#pFrameToSend
005026 122572            LCALL    ?C?PSTXDATA
005029 D22A              SETB     bUseFrameHandler
00502B C2EB              CLR      ERF
00502D E514              MOV      A,RF_state
00502F 6002              JZ       $ + 4H
005031 4195              AJMP     ?C0107?ZW_RF_DRIVER
005033 E515              MOV      A,RF_status
005035 30E202            JNB      ACC.2,?C0108?ZW_RF_DRIVER
005038 C3                CLR      C
005039 22                RET      
00503A         ?C0108?ZW_RF_DRIVER:
00503A 51E5              ACALL    ?L?COM018C
00503C 7134              ACALL    ?L?COM047C
00503E FA                MOV      R2,A
00503F E4                CLR      A
005040 12203B            LCALL    ?C?CSTPTR
005043 F1B0              ACALL    GenerateHomeIDHash
005045 51EB              ACALL    ?L?COM001D
005047 5407              ANL      A,#07H
005049 FF                MOV      R7,A
00504A 90093A            MOV      DPTR,#rfTxCurrentSpeed
00504D F0                MOVX     @DPTR,A
00504E 125C9A            LCALL    _Speed2Channel
005051 900A83            MOV      DPTR,#bChannel
005054 EF                MOV      A,R7
005055 F0                MOVX     @DPTR,A
005056 E515              MOV      A,RF_status
005058 20E072            JB       ACC.0,?C0110?ZW_RF_DRIVER
00505B 71D5              ACALL    RF_demodulator_enable_get
00505D 4004              JC       ?C0111?ZW_RF_DRIVER
00505F 7F01              MOV      R7,#01H
005061 1106              ACALL    _ZW_SetRFReceiveMode
005063         ?C0111?ZW_RF_DRIVER:
005063 900A83            MOV      DPTR,#bChannel
005066 E0                MOVX     A,@DPTR
005067 FF                MOV      R7,A
005068 7B01              MOV      R3,#01H
00506A 7A0A              MOV      R2,#HIGH bRSSILevel
00506C 7984              MOV      R1,#LOW bRSSILevel
00506E 123F64            LCALL    _RF_lbt_get_rssi
005071 E4                CLR      A
005072 33                RLC      A
;---- Variable 'bRSSIStatus' assigned to Register 'R7' ----
005073 7004              JNZ      ?C0112?ZW_RF_DRIVER
005075 D2EB              SETB     ERF
005077 4170              AJMP     ?C0246?ZW_RF_DRIVER
005079         ?C0112?ZW_RF_DRIVER:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 86


005079 900A83            MOV      DPTR,#bChannel
00507C E0                MOVX     A,@DPTR
00507D 2464              ADD      A,#LOW bListenRSSIThreshold
00507F 127084            LCALL    ?L?COM058C
005082 E0                MOVX     A,@DPTR
005083 FF                MOV      R7,A
005084 900A84            MOV      DPTR,#bRSSILevel
005087 E0                MOVX     A,@DPTR
005088 D3                SETB     C
005089 9F                SUBB     A,R7
00508A 4041              JC       ?C0110?ZW_RF_DRIVER
00508C D2EB              SETB     ERF
00508E 125E07            LCALL    NS_IncLBTBackOffs
005091 A217              MOV      C,fEUSB
005093 92ED              MOV      EUSB,C
005095 90094B            MOV      DPTR,#bLBTTimeout
005098 E0                MOVX     A,@DPTR
005099 6015              JZ       ?C0114?ZW_RF_DRIVER
00509B 51E5              ACALL    ?L?COM018C
00509D 7134              ACALL    ?L?COM047C
00509F FA                MOV      R2,A
0050A0 7401              MOV      A,#01H
0050A2 12203B            LCALL    ?C?CSTPTR
0050A5 431504            ORL      RF_status,#04H
0050A8 71B8              ACALL    ?L?COM04D7
0050AA 795A              MOV      R1,#LOW bLBTFailedTimerhandler
0050AC 71DD              ACALL    _SafeTimerStop
0050AE D3                SETB     C
0050AF 22                RET      
0050B0         ?C0114?ZW_RF_DRIVER:
0050B0 90095A            MOV      DPTR,#bLBTFailedTimerhandler
0050B3 E0                MOVX     A,@DPTR
0050B4 7015              JNZ      ?C0115?ZW_RF_DRIVER
0050B6 7B01              MOV      R3,#01H
0050B8 7A09              MOV      R2,#HIGH bLBTFailedTimerhandler
0050BA 795A              MOV      R1,#LOW bLBTFailedTimerhandler
0050BC 7C59              MOV      R4,#HIGH RFLBtTimeoutFunction
0050BE 7D84              MOV      R5,#LOW RFLBtTimeoutFunction
0050C0 9043DE            MOV      DPTR,#?_SafeTimerSysStart?BYTE+05H
0050C3 7464              MOV      A,#064H
0050C5 F0                MOVX     @DPTR,A
0050C6 E4                CLR      A
0050C7 A3                INC      DPTR
0050C8 F0                MOVX     @DPTR,A
0050C9 911C              ACALL    _SafeTimerSysStart
0050CB         ?C0115?ZW_RF_DRIVER:
0050CB C3                CLR      C
0050CC 22                RET      
0050CD         ?C0110?ZW_RF_DRIVER:
0050CD 71D5              ACALL    RF_demodulator_enable_get
0050CF 5005              JNC      ?C0116?ZW_RF_DRIVER
0050D1 C236              CLR      ?RF_demodulator_enable?BIT
0050D3 123E13            LCALL    RF_demodulator_enable
0050D6         ?C0116?ZW_RF_DRIVER:
0050D6 D1D2              ACALL    ?L?COM0295
0050D8         ?C0117?ZW_RF_DRIVER:
0050D8 E5D1              MOV      A,FHCON1
0050DA 20E0FB            JB       ACC.0,?C0117?ZW_RF_DRIVER
0050DD         ?C0118?ZW_RF_DRIVER:
0050DD E4                CLR      A
0050DE F510              MOV      demodState,A
0050E0 C218              CLR      RF_WakeupReceived
0050E2 51EB              ACALL    ?L?COM001D
0050E4 5407              ANL      A,#07H
0050E6 C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 87


0050E7 9403              SUBB     A,#03H
0050E9 E4                CLR      A
0050EA 9400              SUBB     A,#00H
0050EC 5031              JNC      ?C0119?ZW_RF_DRIVER
0050EE 51E5              ACALL    ?L?COM018C
0050F0 E9                MOV      A,R1
0050F1 24B1              ADD      A,#0B1H
0050F3 51DD              ACALL    ?L?COM0009
0050F5 51E4              ACALL    ?L?COM018B
0050F7 E9                MOV      A,R1
0050F8 24D8              ADD      A,#0D8H
0050FA 51DD              ACALL    ?L?COM0009
0050FC 2F                ADD      A,R7
0050FD FF                MOV      R7,A
0050FE E4                CLR      A
0050FF 33                RLC      A
005100 FE                MOV      R6,A
005101 D3                SETB     C
005102 EF                MOV      A,R7
005103 9440              SUBB     A,#040H
005105 EE                MOV      A,R6
005106 6480              XRL      A,#080H
005108 9480              SUBB     A,#080H
00510A 4013              JC       ?C0119?ZW_RF_DRIVER
00510C 51E5              ACALL    ?L?COM018C
00510E 7134              ACALL    ?L?COM047C
005110 FA                MOV      R2,A
005111 7402              MOV      A,#02H
005113 12203B            LCALL    ?C?CSTPTR
005116 431504            ORL      RF_status,#04H
005119 A217              MOV      C,fEUSB
00511B 92ED              MOV      EUSB,C
00511D D3                SETB     C
00511E 22                RET      
00511F         ?C0119?ZW_RF_DRIVER:
00511F 51E5              ACALL    ?L?COM018C
005121 E9                MOV      A,R1
005122 2408              ADD      A,#08H
005124 F9                MOV      R1,A
005125 E4                CLR      A
005126 3A                ADDC     A,R2
005127 CF                XCH      A,R7
005128 E9                MOV      A,R1
005129 CF                XCH      A,R7
00512A F511              MOV      RF_data_addr,A
00512C 8F12              MOV      RF_data_addr+01H,R7
00512E 51E5              ACALL    ?L?COM018C
005130 E9                MOV      A,R1
005131 24B1              ADD      A,#0B1H
005133 51DD              ACALL    ?L?COM0009
005135 F516              MOV      RF_data_count,A
005137 AE11              MOV      R6,RF_data_addr
005139 126BA9            LCALL    _ZW_FH_buf1addr_set
00513C 51E5              ACALL    ?L?COM018C
00513E E9                MOV      A,R1
00513F 24B2              ADD      A,#0B2H
005141 F9                MOV      R1,A
005142 E4                CLR      A
005143 3A                ADDC     A,R2
005144 8B1C              MOV      RF_header_addr,R3
005146 F51D              MOV      RF_header_addr+01H,A
005148 891E              MOV      RF_header_addr+02H,R1
00514A 51E5              ACALL    ?L?COM018C
00514C E9                MOV      A,R1
00514D 24D8              ADD      A,#0D8H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 88


00514F 51DD              ACALL    ?L?COM0009
005151 F51F              MOV      RF_header_count,A
005153 51EB              ACALL    ?L?COM001D
005155 FD                MOV      R5,A
005156 ACF0              MOV      R4,B
005158 5460              ANL      A,#060H
00515A 6034              JZ       ?C0121?ZW_RF_DRIVER
00515C 51E5              ACALL    ?L?COM018C
00515E E9                MOV      A,R1
00515F 24D9              ADD      A,#0D9H
005161 51DD              ACALL    ?L?COM0009
005163 FF                MOV      R7,A
005164 125DC7            LCALL    _RFSetupBeamFragmentTX
005167 C22A              CLR      bUseFrameHandler
005169 51CD              ACALL    ?L?COM0007
00516B FB                MOV      R3,A
00516C 7A00              MOV      R2,#00H
00516E 90095B            MOV      DPTR,#RF_BeamCount
005171 E0                MOVX     A,@DPTR
005172 FE                MOV      R6,A
005173 A3                INC      DPTR
005174 E0                MOVX     A,@DPTR
005175 FF                MOV      R7,A
005176 7C00              MOV      R4,#00H
005178 7D18              MOV      R5,#018H
00517A 12206F            LCALL    ?C?IMUL
00517D EF                MOV      A,R7
00517E 2B                ADD      A,R3
00517F FF                MOV      R7,A
005180 EA                MOV      A,R2
005181 3E                ADDC     A,R6
005182 FE                MOV      R6,A
005183 EF                MOV      A,R7
005184 2414              ADD      A,#014H
005186 FB                MOV      R3,A
005187 E4                CLR      A
005188 3E                ADDC     A,R6
005189 FA                MOV      R2,A
00518A 7D02              MOV      R5,#02H
00518C 7F01              MOV      R7,#01H
00518E 4160              AJMP     ?C0248?ZW_RF_DRIVER
005190         ?C0121?ZW_RF_DRIVER:
005190 51EB              ACALL    ?L?COM001D
005192 5407              ANL      A,#07H
005194 90093A            MOV      DPTR,#rfTxCurrentSpeed
005197 F0                MOVX     @DPTR,A
005198 751408            MOV      RF_state,#08H
00519B 51E5              ACALL    ?L?COM018C
00519D D1E6              ACALL    ?L?COM018D
00519F F182              ACALL    _ZW_FH_buf0addr_set
0051A1 51E5              ACALL    ?L?COM018C
0051A3 E9                MOV      A,R1
0051A4 24D8              ADD      A,#0D8H
0051A6 51DD              ACALL    ?L?COM0009
0051A8 FF                MOV      R7,A
0051A9 AD16              MOV      R5,RF_data_count
0051AB F18F              ACALL    _ZW_FH_tx_buflen_set
0051AD 90093A            MOV      DPTR,#rfTxCurrentSpeed
0051B0 E0                MOVX     A,@DPTR
0051B1 6403              XRL      A,#03H
0051B3 7023              JNZ      ?C0123?ZW_RF_DRIVER
0051B5 7B01              MOV      R3,#01H
0051B7 FD                MOV      R5,A
0051B8 519D              ACALL    ?L?COM0005
0051BA D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 89


0051BB 713F              ACALL    ?L?COM011E
0051BD 5005              JNC      ?C0124?ZW_RF_DRIVER
0051BF 7401              MOV      A,#01H
0051C1 121FE6            LCALL    ?C?CILDPTR
0051C4         ?C0124?ZW_RF_DRIVER:
0051C4 E4                CLR      A
0051C5 F5FF              MOV      SFRPAGE,A
0051C7 F16D              ACALL    ?L?COM052C
0051C9 121F7C            LCALL    ?C?CLDPTR
0051CC 2428              ADD      A,#028H
0051CE FB                MOV      R3,A
0051CF E4                CLR      A
0051D0 33                RLC      A
0051D1 FA                MOV      R2,A
0051D2 7D03              MOV      R5,#03H
0051D4 E4                CLR      A
0051D5 FF                MOV      R7,A
0051D6         
0051D6 4160              AJMP     ?C0248?ZW_RF_DRIVER
0051D8         ?C0123?ZW_RF_DRIVER:
0051D8 90093A            MOV      DPTR,#rfTxCurrentSpeed
0051DB E0                MOVX     A,@DPTR
0051DC 6402              XRL      A,#02H
0051DE 702A              JNZ      ?C0126?ZW_RF_DRIVER
0051E0 51A0              ACALL    ?L?COM0006
0051E2 D3                SETB     C
0051E3 713F              ACALL    ?L?COM011E
0051E5 4005              JC       ?C0127?ZW_RF_DRIVER
0051E7 74FF              MOV      A,#0FFH
0051E9 121FE6            LCALL    ?C?CILDPTR
0051EC         ?C0127?ZW_RF_DRIVER:
0051EC E4                CLR      A
0051ED F5FF              MOV      SFRPAGE,A
0051EF E5D2              MOV      A,FHCON2
0051F1 5480              ANL      A,#080H
0051F3 440A              ORL      A,#0AH
0051F5 F5D2              MOV      FHCON2,A
0051F7 121F7C            LCALL    ?C?CLDPTR
0051FA 2414              ADD      A,#014H
0051FC FB                MOV      R3,A
0051FD E4                CLR      A
0051FE 33                RLC      A
0051FF FA                MOV      R2,A
005200 7D02              MOV      R5,#02H
005202 7F01              MOV      R7,#01H
005204 7148              ACALL    _UpdateTxTimer
005206 51FB              ACALL    ?L?COM04E2
005208 8058              SJMP     ?C0122?ZW_RF_DRIVER
00520A         ?C0126?ZW_RF_DRIVER:
00520A E4                CLR      A
00520B FB                MOV      R3,A
00520C 7D01              MOV      R5,#01H
00520E 519D              ACALL    ?L?COM0005
005210 D3                SETB     C
005211 713F              ACALL    ?L?COM011E
005213 4005              JC       ?C0129?ZW_RF_DRIVER
005215 74FF              MOV      A,#0FFH
005217 121FE6            LCALL    ?C?CILDPTR
00521A         ?C0129?ZW_RF_DRIVER:
00521A E4                CLR      A
00521B F5FF              MOV      SFRPAGE,A
00521D 51EB              ACALL    ?L?COM001D
00521F 4410              ORL      A,#010H
005221 45F0              ORL      A,B
005223 7F05              MOV      R7,#05H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 90


005225 6002              JZ       ?C0130?ZW_RF_DRIVER
005227 7F0A              MOV      R7,#0AH
005229         ?C0130?ZW_RF_DRIVER:
005229         ?C0131?ZW_RF_DRIVER:
005229 EF                MOV      A,R7
00522A 547F              ANL      A,#07FH
00522C FF                MOV      R7,A
00522D E5D2              MOV      A,FHCON2
00522F 5480              ANL      A,#080H
005231 4F                ORL      A,R7
005232 F5D2              MOV      FHCON2,A
005234 E4                CLR      A
005235 F5FF              MOV      SFRPAGE,A
005237 43D280            ORL      FHCON2,#080H
00523A 51CD              ACALL    ?L?COM0007
00523C FD                MOV      R5,A
00523D 7C00              MOV      R4,#00H
00523F 51EB              ACALL    ?L?COM001D
005241 4410              ORL      A,#010H
005243 45F0              ORL      A,B
005245 7E00              MOV      R6,#00H
005247 6004              JZ       ?C0132?ZW_RF_DRIVER
005249 7F0A              MOV      R7,#0AH
00524B 8002              SJMP     ?C0133?ZW_RF_DRIVER
00524D         ?C0132?ZW_RF_DRIVER:
00524D 7F05              MOV      R7,#05H
00524F         ?C0133?ZW_RF_DRIVER:
00524F EF                MOV      A,R7
005250 25E0              ADD      A,ACC
005252 FF                MOV      R7,A
005253 EE                MOV      A,R6
005254 33                RLC      A
005255 FE                MOV      R6,A
005256 EF                MOV      A,R7
005257 2D                ADD      A,R5
005258 FB                MOV      R3,A
005259 EE                MOV      A,R6
00525A 3C                ADDC     A,R4
00525B FA                MOV      R2,A
00525C 7D01              MOV      R5,#01H
00525E 7F01              MOV      R7,#01H
005260         
005260 7148              ACALL    _UpdateTxTimer
005262         ?C0122?ZW_RF_DRIVER:
005262 51EB              ACALL    ?L?COM001D
005264 FF                MOV      R7,A
005265 AEF0              MOV      R6,B
005267 A22A              MOV      C,bUseFrameHandler
005269 9229              MOV      ?_SwitchToTX?BIT,C
00526B 125BFD            LCALL    _SwitchToTX
00526E 4006              JC       ?C0134?ZW_RF_DRIVER
005270         
005270 A217              MOV      C,fEUSB
005272 92ED              MOV      EUSB,C
005274 C3                CLR      C
005275 22                RET      
005276         ?C0134?ZW_RF_DRIVER:
005276 71B8              ACALL    ?L?COM04D7
005278 795A              MOV      R1,#LOW bLBTFailedTimerhandler
00527A 71DD              ACALL    _SafeTimerStop
00527C 900A83            MOV      DPTR,#bChannel
00527F E0                MOVX     A,@DPTR
005280 51E4              ACALL    ?L?COM018B
005282 E9                MOV      A,R1
005283 24E5              ADD      A,#0E5H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 91


005285 F9                MOV      R1,A
005286 E4                CLR      A
005287 3A                ADDC     A,R2
005288 FA                MOV      R2,A
005289 EF                MOV      A,R7
00528A 12203B            LCALL    ?C?CSTPTR
00528D         ?C0135?ZW_RF_DRIVER:
00528D A217              MOV      C,fEUSB
00528F 92ED              MOV      EUSB,C
005291 D2EB              SETB     ERF
005293 D3                SETB     C
005294 22                RET      
005295         ?C0107?ZW_RF_DRIVER:
005295 A217              MOV      C,fEUSB
005297 92ED              MOV      EUSB,C
005299 D2EB              SETB     ERF
00529B C3                CLR      C
00529C 22                RET      
----- FUNCTION _RFTransmitNow (END) -------


----- FUNCTION ?L?COM0005 (BEGIN) -----
00529D FF                MOV      R7,A
00529E 7100              ACALL    _ZW_FH_tx_init
0052A0         ?L?COM0006:
0052A0 900A80            MOV      DPTR,#pFrameToSend
0052A3 122552            LCALL    ?C?PLDXDATA
0052A6 E9                MOV      A,R1
0052A7 24B1              ADD      A,#0B1H
0052A9 F9                MOV      R1,A
0052AA E4                CLR      A
0052AB 3A                ADDC     A,R2
0052AC FA                MOV      R2,A
0052AD 121F7C            LCALL    ?C?CLDPTR
0052B0 FF                MOV      R7,A
0052B1 900A80            MOV      DPTR,#pFrameToSend
0052B4 122552            LCALL    ?C?PLDXDATA
0052B7 E9                MOV      A,R1
0052B8 24D8              ADD      A,#0D8H
0052BA F9                MOV      R1,A
0052BB E4                CLR      A
0052BC 3A                ADDC     A,R2
0052BD FA                MOV      R2,A
0052BE 121F7C            LCALL    ?C?CLDPTR
0052C1 2F                ADD      A,R7
0052C2 FF                MOV      R7,A
0052C3 E4                CLR      A
0052C4 33                RLC      A
0052C5 FE                MOV      R6,A
0052C6 EF                MOV      A,R7
0052C7 2401              ADD      A,#01H
0052C9 FF                MOV      R7,A
0052CA E4                CLR      A
0052CB 3E                ADDC     A,R6
0052CC FE                MOV      R6,A
0052CD         ?L?COM0007:
0052CD 900A80            MOV      DPTR,#pFrameToSend
0052D0 122552            LCALL    ?C?PLDXDATA
0052D3 E9                MOV      A,R1
0052D4 24B2              ADD      A,#0B2H
0052D6 F9                MOV      R1,A
0052D7 E4                CLR      A
0052D8 3A                ADDC     A,R2
0052D9 FA                MOV      R2,A
0052DA         ?L?COM0008:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 92


0052DA E9                MOV      A,R1
0052DB 2407              ADD      A,#07H
0052DD         ?L?COM0009:
0052DD F9                MOV      R1,A
0052DE E4                CLR      A
0052DF 3A                ADDC     A,R2
0052E0 FA                MOV      R2,A
0052E1 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0005 (END) -------


----- FUNCTION ?L?COM018B (BEGIN) -----
0052E4 FF                MOV      R7,A
0052E5         ?L?COM018C:
0052E5 900A80            MOV      DPTR,#pFrameToSend
0052E8 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM018B (END) -------


----- FUNCTION ?L?COM001D (BEGIN) -----
0052EB 900A80            MOV      DPTR,#pFrameToSend
0052EE         ?L?COM001E:
0052EE 122552            LCALL    ?C?PLDXDATA
0052F1         ?L?COM001F:
0052F1 E9                MOV      A,R1
0052F2         ?L?COM0020:
0052F2 2404              ADD      A,#04H
0052F4         ?L?COM0021:
0052F4 F9                MOV      R1,A
0052F5 E4                CLR      A
0052F6 3A                ADDC     A,R2
0052F7 FA                MOV      R2,A
0052F8 022138            LJMP     ?C?ILDPTR
----- FUNCTION ?L?COM001D (END) -------


----- FUNCTION ?L?COM04E2 (BEGIN) -----
0052FB E4                CLR      A
0052FC FB                MOV      R3,A
0052FD 7D01              MOV      R5,#01H
0052FF FF                MOV      R7,A
----- FUNCTION _ZW_FH_tx_init (BEGIN) -----
;---- Variable 'insert_viola' assigned to Register 'R7' ----
;---- Variable 'insert_crc16' assigned to Register 'R3' ----
;---- Variable 'insert_chksum' assigned to Register 'R5' ----
005300 E4                CLR      A
005301 F5FF              MOV      SFRPAGE,A
005303 75D102            MOV      FHCON1,#02H
005306         ?C0001?ZW_PHY_FRAME_HANDLER_050X:
005306 E5D1              MOV      A,FHCON1
005308 20E0FB            JB       ACC.0,?C0001?ZW_PHY_FRAME_HANDLER_050X
00530B         ?C0002?ZW_PHY_FRAME_HANDLER_050X:
00530B E4                CLR      A
00530C F5FF              MOV      SFRPAGE,A
00530E F5D1              MOV      FHCON1,A
005310 EF                MOV      A,R7
005311 6008              JZ       ?C0003?ZW_PHY_FRAME_HANDLER_050X
005313 E4                CLR      A
005314 F5FF              MOV      SFRPAGE,A
005316 43D280            ORL      FHCON2,#080H
005319 8006              SJMP     ?C0004?ZW_PHY_FRAME_HANDLER_050X
00531B         ?C0003?ZW_PHY_FRAME_HANDLER_050X:
00531B E4                CLR      A
00531C F5FF              MOV      SFRPAGE,A
00531E 53D27F            ANL      FHCON2,#07FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 93


005321         ?C0004?ZW_PHY_FRAME_HANDLER_050X:
005321 EB                MOV      A,R3
005322 6006              JZ       ?C0005?ZW_PHY_FRAME_HANDLER_050X
005324 E4                CLR      A
005325 F5FF              MOV      SFRPAGE,A
005327 43D104            ORL      FHCON1,#04H
00532A         ?C0005?ZW_PHY_FRAME_HANDLER_050X:
00532A ED                MOV      A,R5
00532B 6006              JZ       ?C0007?ZW_PHY_FRAME_HANDLER_050X
00532D E4                CLR      A
00532E F5FF              MOV      SFRPAGE,A
005330 43D108            ORL      FHCON1,#08H
005333         ?C0007?ZW_PHY_FRAME_HANDLER_050X:
005333 22                RET      
----- FUNCTION _ZW_FH_tx_init (END) -------


----- FUNCTION ?L?COM047C (BEGIN) -----
005334 E9                MOV      A,R1
005335 24E3              ADD      A,#0E3H
005337 F9                MOV      R1,A
005338 E4                CLR      A
005339 3A                ADDC     A,R2
00533A 22                RET      
----- FUNCTION ?L?COM047C (END) -------


----- FUNCTION ?L?COM011C (BEGIN) -----
00533B 33                RLC      A
00533C FE                MOV      R6,A
00533D E0                MOVX     A,@DPTR
00533E         ?L?COM011D:
00533E C3                CLR      C
00533F         ?L?COM011E:
00533F 9F                SUBB     A,R7
005340 EE                MOV      A,R6
005341         ?L?COM011F:
005341 6480              XRL      A,#080H
005343 F8                MOV      R0,A
005344 7480              MOV      A,#080H
005346 98                SUBB     A,R0
005347 22                RET      
----- FUNCTION ?L?COM011C (END) -------


----- FUNCTION _UpdateTxTimer (BEGIN) -----
005348 900ABB            MOV      DPTR,#bChannel
00534B EF                MOV      A,R7
00534C F0                MOVX     @DPTR,A
;---- Variable 'wSize' assigned to Register 'R2/R3' ----
;---- Variable 'bBaudRate' assigned to Register 'R5' ----
00534D ED                MOV      A,R5
00534E 24FE              ADD      A,#0FEH
005350 6019              JZ       ?C0232?ZW_RF_DRIVER
005352 14                DEC      A
005353 6026              JZ       ?C0233?ZW_RF_DRIVER
005355 2402              ADD      A,#02H
005357 703B              JNZ      ?C0230?ZW_RF_DRIVER
005359         ?C0231?ZW_RF_DRIVER:
005359 EB                MOV      A,R3
00535A 2402              ADD      A,#02H
00535C FF                MOV      R7,A
00535D E4                CLR      A
00535E 3A                ADDC     A,R2
00535F FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 94


005360 7C00              MOV      R4,#00H
005362 7D50              MOV      R5,#050H
005364 12206F            LCALL    ?C?IMUL
005367 7D60              MOV      R5,#060H
005369 801E              SJMP     ?C0258?ZW_RF_DRIVER
00536B         ?C0232?ZW_RF_DRIVER:
00536B 71C2              ACALL    ?L?COM044F
00536D         ?C0243?ZW_RF_DRIVER:
00536D C3                CLR      C
00536E 33                RLC      A
00536F CE                XCH      A,R6
005370 33                RLC      A
005371 CE                XCH      A,R6
005372 D8F9              DJNZ     R0,?C0243?ZW_RF_DRIVER
005374 FF                MOV      R7,A
005375 7C00              MOV      R4,#00H
005377 7D28              MOV      R5,#028H
005379         
005379 800E              SJMP     ?C0258?ZW_RF_DRIVER
00537B         ?C0233?ZW_RF_DRIVER:
00537B 71C2              ACALL    ?L?COM044F
00537D         ?C0244?ZW_RF_DRIVER:
00537D C3                CLR      C
00537E 33                RLC      A
00537F CE                XCH      A,R6
005380 33                RLC      A
005381 CE                XCH      A,R6
005382 D8F9              DJNZ     R0,?C0244?ZW_RF_DRIVER
005384 FF                MOV      R7,A
005385 7C00              MOV      R4,#00H
005387 7D64              MOV      R5,#064H
005389         
005389 122081            LCALL    ?C?UIDIV
00538C 900ABC            MOV      DPTR,#wTime
00538F EE                MOV      A,R6
005390 F0                MOVX     @DPTR,A
005391 A3                INC      DPTR
005392 EF                MOV      A,R7
005393 F0                MOVX     @DPTR,A
005394         ?C0230?ZW_RF_DRIVER:
005394 900ABB            MOV      DPTR,#bChannel
005397 E0                MOVX     A,@DPTR
005398 125EB8            LCALL    ?L?COM03AA
00539B C083              PUSH     DPH
00539D C082              PUSH     DPL
00539F 12247E            LCALL    ?C?LLDXDATA0
0053A2 900ABD            MOV      DPTR,#wTime+01H
0053A5 E0                MOVX     A,@DPTR
0053A6 2401              ADD      A,#01H
0053A8 900ABC            MOV      DPTR,#wTime
0053AB 127043            LCALL    ?L?COM04FA
0053AE 122234            LCALL    ?C?LADD
0053B1 D082              POP      DPL
0053B3 D083              POP      DPH
0053B5 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION _UpdateTxTimer (END) -------


----- FUNCTION ?L?COM04D7 (BEGIN) -----
0053B8 E4                CLR      A
0053B9 90094B            MOV      DPTR,#bLBTTimeout
0053BC F0                MOVX     @DPTR,A
0053BD 7B01              MOV      R3,#01H
0053BF 7A09              MOV      R2,#HIGH bLBTFailedTimerhandler
0053C1 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 95


----- FUNCTION ?L?COM04D7 (END) -------


----- FUNCTION ?L?COM044F (BEGIN) -----
0053C2 EB                MOV      A,R3
0053C3 2401              ADD      A,#01H
0053C5 FF                MOV      R7,A
0053C6 E4                CLR      A
0053C7 3A                ADDC     A,R2
0053C8 FE                MOV      R6,A
0053C9 EF                MOV      A,R7
0053CA 7803              MOV      R0,#03H
0053CC 22                RET      
----- FUNCTION ?L?COM044F (END) -------


----- FUNCTION ?L?COM042C (BEGIN) -----
0053CD C2EB              CLR      ERF
0053CF A2ED              MOV      C,EUSB
0053D1 9217              MOV      fEUSB,C
0053D3 C2ED              CLR      EUSB
----- FUNCTION RF_demodulator_enable_get (BEGIN) -----
0053D5 E5F4              MOV      A,DMCTRL
0053D7 C3                CLR      C
0053D8 30E701            JNB      ACC.7,?C0209?ZW_PHY_RF_050X
0053DB D3                SETB     C
0053DC         ?C0209?ZW_PHY_RF_050X:
0053DC 22                RET      
----- FUNCTION RF_demodulator_enable_get (END) -------


----- FUNCTION _SafeTimerStop (BEGIN) -----
0053DD 9045CA            MOV      DPTR,#pbTimerHandle
0053E0 122572            LCALL    ?C?PSTXDATA
0053E3 9045CA            MOV      DPTR,#pbTimerHandle
0053E6 914C              ACALL    ?L?COM0410
0053E8 1244EE            LCALL    _TimerCancel
0053EB 9045CA            MOV      DPTR,#pbTimerHandle
0053EE 122552            LCALL    ?C?PLDXDATA
0053F1 E4                CLR      A
0053F2 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _SafeTimerStop (END) -------


----- FUNCTION RFPowerDown (BEGIN) -----
0053F5 E514              MOV      A,RF_state
0053F7 7021              JNZ      ?C0083?ZW_RF_DRIVER
0053F9 71CD              ACALL    ?L?COM042C
0053FB 5005              JNC      ?C0084?ZW_RF_DRIVER
0053FD C236              CLR      ?RF_demodulator_enable?BIT
0053FF 123E13            LCALL    RF_demodulator_enable
005402         ?C0084?ZW_RF_DRIVER:
005402 D1EE              ACALL    ?L?COM052B
005404 D1D2              ACALL    ?L?COM0295
005406         ?C0085?ZW_RF_DRIVER:
005406 E5D1              MOV      A,FHCON1
005408 20E0FB            JB       ACC.0,?C0085?ZW_RF_DRIVER
00540B         ?C0086?ZW_RF_DRIVER:
00540B 431520            ORL      RF_status,#020H
00540E 5315FE            ANL      RF_status,#0FEH
005411 E4                CLR      A
005412 F510              MOV      demodState,A
005414 A217              MOV      C,fEUSB
005416 92ED              MOV      EUSB,C
005418 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 96


005419 22                RET      
00541A         ?C0083?ZW_RF_DRIVER:
00541A C3                CLR      C
00541B 22                RET      
----- FUNCTION RFPowerDown (END) -------


----- FUNCTION _SafeTimerSysStart (BEGIN) -----
00541C 9043DC            MOV      DPTR,#func
00541F EC                MOV      A,R4
005420 F0                MOVX     @DPTR,A
005421 A3                INC      DPTR
005422 ED                MOV      A,R5
005423 F0                MOVX     @DPTR,A
005424 9043D9            MOV      DPTR,#pbTimerHandle
005427 122572            LCALL    ?C?PSTXDATA
00542A 71DD              ACALL    _SafeTimerStop
00542C 9043DC            MOV      DPTR,#func
00542F 126EB3            LCALL    ?L?COM031A
005432 F1A8              ACALL    _TimerSysStart
005434 9043D9            MOV      DPTR,#pbTimerHandle
005437 D1DF              ACALL    ?L?COM0125
005439 9043D9            MOV      DPTR,#pbTimerHandle
00543C 122552            LCALL    ?C?PLDXDATA
00543F 121F7C            LCALL    ?C?CLDPTR
005442 B4FF04            CJNE     A,#0FFH,?C0056?ZW_TIMER
005445 E4                CLR      A
005446 12203B            LCALL    ?C?CSTPTR
005449         ?C0056?ZW_TIMER:
005449 9043D9            MOV      DPTR,#pbTimerHandle
;----                  JMP      ?L?COM0410
----- FUNCTION _SafeTimerSysStart (END) -------


----- FUNCTION ?L?COM0410 (BEGIN) -----
00544C 122552            LCALL    ?C?PLDXDATA
00544F 121F7C            LCALL    ?C?CLDPTR
005452 FF                MOV      R7,A
005453 22                RET      
----- FUNCTION ?L?COM0410 (END) -------


----- FUNCTION RFInterrupt (BEGIN) -----
005454 C0E0              PUSH     ACC
005456 C0F0              PUSH     B
005458 C083              PUSH     DPH
00545A C082              PUSH     DPL
00545C C0D0              PUSH     PSW
00545E 75D008            MOV      PSW,#08H
005461 C0FF              PUSH     SFRPAGE
005463 75FF01            MOV      SFRPAGE,#01H
005466 E5D5              MOV      A,RFCON
005468 30E604            JNB      ACC.6,?C0138?ZW_RF_DRIVER
00546B 7F02              MOV      R7,#02H
00546D 8009              SJMP     ?C0139?ZW_RF_DRIVER
00546F         ?C0138?ZW_RF_DRIVER:
00546F E5D5              MOV      A,RFCON
005471 7F00              MOV      R7,#00H
005473 30E702            JNB      ACC.7,?C0141?ZW_RF_DRIVER
005476 7F01              MOV      R7,#01H
005478         ?C0141?ZW_RF_DRIVER:
005478         ?C0142?ZW_RF_DRIVER:
005478         ?C0139?ZW_RF_DRIVER:
005478 8F18              MOV      bRFIntMode,R7
00547A E518              MOV      A,bRFIntMode
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 97


00547C 6402              XRL      A,#02H
00547E 6002              JZ       $ + 4H
005480 A130              AJMP     ?C0143?ZW_RF_DRIVER
005482 E514              MOV      A,RF_state
005484 12267F            LCALL    ?C?CCASE
005487 54A0              DW       ?C0145?ZW_RF_DRIVER
005489 01                DB       01H
00548A 54B3              DW       ?C0147?ZW_RF_DRIVER
00548C 02                DB       02H
00548D 5518              DW       ?C0153?ZW_RF_DRIVER
00548F 08                DB       08H
005490 54BE              DW       ?C0148?ZW_RF_DRIVER
005492 09                DB       09H
005493 54C9              DW       ?C0149?ZW_RF_DRIVER
005495 0A                DB       0AH
005496 54D7              DW       ?C0150?ZW_RF_DRIVER
005498 0B                DB       0BH
005499 54F5              DW       ?C0152?ZW_RF_DRIVER
00549B 0C                DB       0CH
00549C 0000              DW       00H
00549E 56B7              DW       ?C0155?ZW_RF_DRIVER
0054A0         ?C0145?ZW_RF_DRIVER:
0054A0 75FF01            MOV      SFRPAGE,#01H
0054A3 75C355            MOV      MODDATA,#055H
0054A6 151A              DEC      RF_num
0054A8 E51A              MOV      A,RF_num
0054AA 6002              JZ       $ + 4H
0054AC C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054AE 751402            MOV      RF_state,#02H
0054B1 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054B3         ?C0147?ZW_RF_DRIVER:
0054B3 75FF01            MOV      SFRPAGE,#01H
0054B6 75C3F0            MOV      MODDATA,#0F0H
0054B9 751409            MOV      RF_state,#09H
0054BC C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054BE         ?C0148?ZW_RF_DRIVER:
0054BE 75FF01            MOV      SFRPAGE,#01H
0054C1 75C355            MOV      MODDATA,#055H
0054C4 75140A            MOV      RF_state,#0AH
0054C7 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054C9         ?C0149?ZW_RF_DRIVER:
0054C9 75FF01            MOV      SFRPAGE,#01H
0054CC 90094C            MOV      DPTR,#bBeamDestAddress
0054CF E0                MOVX     A,@DPTR
0054D0 F5C3              MOV      MODDATA,A
0054D2 75140B            MOV      RF_state,#0BH
0054D5 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054D7         ?C0150?ZW_RF_DRIVER:
0054D7 75FF01            MOV      SFRPAGE,#01H
0054DA 900939            MOV      DPTR,#bHomeIDHash
0054DD E0                MOVX     A,@DPTR
0054DE F5C3              MOV      MODDATA,A
0054E0 751401            MOV      RF_state,#01H
0054E3 751A14            MOV      RF_num,#014H
0054E6 90095B            MOV      DPTR,#RF_BeamCount
0054E9 126ED4            LCALL    ?L?COM0363
0054EC 6002              JZ       $ + 4H
0054EE C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054F0 75140C            MOV      RF_state,#0CH
0054F3 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0054F5         ?C0152?ZW_RF_DRIVER:
0054F5 AB1C              MOV      R3,RF_header_addr
0054F7 AA1D              MOV      R2,RF_header_addr+01H
0054F9 A91E              MOV      R1,RF_header_addr+02H
0054FB F182              ACALL    _ZW_FH_buf0addr_set
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 98


0054FD AD16              MOV      R5,RF_data_count
0054FF AF1F              MOV      R7,RF_header_count
005501 F18F              ACALL    _ZW_FH_tx_buflen_set
005503 51FB              ACALL    ?L?COM04E2
005505 75FF00            MOV      SFRPAGE,#00H
005508 F16D              ACALL    ?L?COM052C
00550A 43FA04            ORL      MODCTRL,#04H
00550D 75FF00            MOV      SFRPAGE,#00H
005510 125CB3            LCALL    ?L?COM0299
005513 751408            MOV      RF_state,#08H
005516 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
005518         ?C0153?ZW_RF_DRIVER:
005518 C2EB              CLR      ERF
00551A 751400            MOV      RF_state,#00H
00551D 431504            ORL      RF_status,#04H
005520 125DF9            LCALL    ?L?COM03AC
005523 4002              JC       $ + 4H
005525 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
005527 E4                CLR      A
005528 75F001            MOV      B,#01H
00552B 12210C            LCALL    ?C?IILDX
00552E C1B7              AJMP     ?C0155?ZW_RF_DRIVER
005530         ?C0143?ZW_RF_DRIVER:
005530 E518              MOV      A,bRFIntMode
005532 6401              XRL      A,#01H
005534 6002              JZ       $ + 4H
005536 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
005538 F1DB              ACALL    RF_IsSofDetected
00553A 4002              JC       $ + 4H
00553C C1B7              AJMP     ?C0155?ZW_RF_DRIVER
00553E E510              MOV      A,demodState
005540 7022              JNZ      ?C0158?ZW_RF_DRIVER
005542 D1CB              ACALL    ?L?COM02B6
005544 E0                MOVX     A,@DPTR
005545 FF                MOV      R7,A
;---- Variable 'bData1' assigned to Register 'R7' ----
005546 6455              XRL      A,#055H
005548 6004              JZ       ?C0160?ZW_RF_DRIVER
00554A EF                MOV      A,R7
00554B B4540B            CJNE     A,#054H,?C0159?ZW_RF_DRIVER
00554E         ?C0160?ZW_RF_DRIVER:
00554E D218              SETB     RF_WakeupReceived
005550 AF77              MOV      R7,tickTime+01H
005552 900959            MOV      DPTR,#rfWakeupReceivedTickSample
005555 EF                MOV      A,R7
005556 F0                MOVX     @DPTR,A
005557 C130              AJMP     ?C0250?ZW_RF_DRIVER
005559         ?C0159?ZW_RF_DRIVER:
005559 751002            MOV      demodState,#02H
00555C 75FF00            MOV      SFRPAGE,#00H
00555F 75D908            MOV      FHINTLVL,#08H
005562 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
005564         ?C0158?ZW_RF_DRIVER:
005564 E510              MOV      A,demodState
005566 6402              XRL      A,#02H
005568 706E              JNZ      ?C0163?ZW_RF_DRIVER
00556A 75FF01            MOV      SFRPAGE,#01H
00556D F5EA              MOV      DFCON3,A
00556F 75EAFF            MOV      DFCON3,#0FFH
005572 90093C            MOV      DPTR,#RF_rssi_samples
005575 122552            LCALL    ?C?PLDXDATA
005578 E5D9              MOV      A,DFSTAT
00557A 12203B            LCALL    ?C?CSTPTR
00557D 126808            LCALL    RF_RX_speed_get
005580 125DB3            LCALL    _ConvertPhySpeedToRFSpeed
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 99


005583 900938            MOV      DPTR,#rfRxCurrentSpeed
005586 EF                MOV      A,R7
005587 F0                MOVX     @DPTR,A
005588 F176              ACALL    ?L?COM042B
00558A E0                MOVX     A,@DPTR
00558B 900AE2            MOV      DPTR,#bData2
00558E F0                MOVX     @DPTR,A
00558F E0                MOVX     A,@DPTR
005590 FF                MOV      R7,A
005591 D3                SETB     C
005592 9409              SUBB     A,#09H
005594 4025              JC       ?C0165?ZW_RF_DRIVER
005596 900938            MOV      DPTR,#rfRxCurrentSpeed
005599 E0                MOVX     A,@DPTR
00559A D3                SETB     C
00559B 9402              SUBB     A,#02H
00559D 400C              JC       ?C0166?ZW_RF_DRIVER
00559F EF                MOV      A,R7
0055A0 D3                SETB     C
0055A1 94AA              SUBB     A,#0AAH
0055A3 7F00              MOV      R7,#00H
0055A5 4002              JC       ?C0168?ZW_RF_DRIVER
0055A7 7F01              MOV      R7,#01H
0055A9         ?C0168?ZW_RF_DRIVER:
0055A9         ?C0169?ZW_RF_DRIVER:
0055A9 800D              SJMP     ?C0167?ZW_RF_DRIVER
0055AB         ?C0166?ZW_RF_DRIVER:
0055AB 900AE2            MOV      DPTR,#bData2
0055AE E0                MOVX     A,@DPTR
0055AF D3                SETB     C
0055B0 9440              SUBB     A,#040H
0055B2 7F00              MOV      R7,#00H
0055B4 4002              JC       ?C0170?ZW_RF_DRIVER
0055B6 7F01              MOV      R7,#01H
0055B8         ?C0170?ZW_RF_DRIVER:
0055B8         ?C0171?ZW_RF_DRIVER:
0055B8         ?C0167?ZW_RF_DRIVER:
0055B8 EF                MOV      A,R7
0055B9 6004              JZ       ?C0164?ZW_RF_DRIVER
0055BB         ?C0165?ZW_RF_DRIVER:
0055BB F164              ACALL    ResetSensorState
0055BD         
0055BD 8071              SJMP     ?C0250?ZW_RF_DRIVER
0055BF         ?C0164?ZW_RF_DRIVER:
0055BF 900AE2            MOV      DPTR,#bData2
0055C2 E0                MOVX     A,@DPTR
0055C3 F516              MOV      RF_data_count,A
0055C5 1267FD            LCALL    RF_channel_get
0055C8 901222            MOV      DPTR,#rfRxCurrentCh
0055CB EF                MOV      A,R7
0055CC F0                MOVX     @DPTR,A
0055CD 75FF00            MOV      SFRPAGE,#00H
0055D0 8516D9            MOV      FHINTLVL,RF_data_count
0055D3 751003            MOV      demodState,#03H
0055D6 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0055D8         ?C0163?ZW_RF_DRIVER:
0055D8 E510              MOV      A,demodState
0055DA 6403              XRL      A,#03H
0055DC 6002              JZ       $ + 4H
0055DE C1B7              AJMP     ?C0155?ZW_RF_DRIVER
0055E0 90093C            MOV      DPTR,#RF_rssi_samples
0055E3 914C              ACALL    ?L?COM0410
0055E5 F1E2              ACALL    ?L?COM0221
0055E7 EF                MOV      A,R7
0055E8 12203B            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 100


0055EB F164              ACALL    ResetSensorState
0055ED 75FF00            MOV      SFRPAGE,#00H
0055F0 900938            MOV      DPTR,#rfRxCurrentSpeed
0055F3 E0                MOVX     A,@DPTR
0055F4 C3                CLR      C
0055F5 9403              SUBB     A,#03H
0055F7 E5D3              MOV      A,FHSTAT
0055F9 5005              JNC      ?C0175?ZW_RF_DRIVER
0055FB 5402              ANL      A,#02H
0055FD FF                MOV      R7,A
0055FE 8003              SJMP     ?C0176?ZW_RF_DRIVER
005600         ?C0175?ZW_RF_DRIVER:
005600 5401              ANL      A,#01H
005602 FF                MOV      R7,A
005603         ?C0176?ZW_RF_DRIVER:
;---- Variable 'bSFRVal' assigned to Register 'R7' ----
005603 EF                MOV      A,R7
005604 602F              JZ       ?C0177?ZW_RF_DRIVER
005606 30E111            JNB      ACC.1,?C0178?ZW_RF_DRIVER
005609 C3                CLR      C
00560A 900946            MOV      DPTR,#sRFStats+07H
00560D E0                MOVX     A,@DPTR
00560E 94FF              SUBB     A,#0FFH
005610 900945            MOV      DPTR,#sRFStats+06H
005613 E0                MOVX     A,@DPTR
005614 94FF              SUBB     A,#0FFH
005616 5018              JNC      ?C0180?ZW_RF_DRIVER
005618 800F              SJMP     ?C0251?ZW_RF_DRIVER
00561A         ?C0178?ZW_RF_DRIVER:
00561A C3                CLR      C
00561B 900948            MOV      DPTR,#sRFStats+09H
00561E E0                MOVX     A,@DPTR
00561F 94FF              SUBB     A,#0FFH
005621 900947            MOV      DPTR,#sRFStats+08H
005624 E0                MOVX     A,@DPTR
005625 94FF              SUBB     A,#0FFH
005627 5007              JNC      ?C0180?ZW_RF_DRIVER
005629         
005629 E4                CLR      A
00562A 75F001            MOV      B,#01H
00562D 12210C            LCALL    ?C?IILDX
005630         ?C0180?ZW_RF_DRIVER:
005630         
005630 125CBA            LCALL    _RFRxRestart
005633 C1B7              AJMP     ?C0155?ZW_RF_DRIVER
005635         ?C0177?ZW_RF_DRIVER:
005635 C236              CLR      ?RF_demodulator_enable?BIT
005637 123E13            LCALL    RF_demodulator_enable
00563A 75FF00            MOV      SFRPAGE,#00H
00563D D1D5              ACALL    ?L?COM0296
00563F         ?C0183?ZW_RF_DRIVER:
00563F E5D1              MOV      A,FHCON1
005641 20E0FB            JB       ACC.0,?C0183?ZW_RF_DRIVER
005644         ?C0184?ZW_RF_DRIVER:
005644 C2EB              CLR      ERF
005646 431502            ORL      RF_status,#02H
005649 D1CB              ACALL    ?L?COM02B6
00564B A3                INC      DPTR
00564C E0                MOVX     A,@DPTR
00564D FF                MOV      R7,A
00564E 901224            MOV      DPTR,#homeID+01H
005651 E0                MOVX     A,@DPTR
005652 FE                MOV      R6,A
005653 EF                MOV      A,R7
005654 6E                XRL      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 101


005655 D1CA              ACALL    ?L?COM02B5
005657 E0                MOVX     A,@DPTR
005658 901223            MOV      DPTR,#homeID
00565B D1C4              ACALL    ?L?COM02B4
00565D A3                INC      DPTR
00565E A3                INC      DPTR
00565F E0                MOVX     A,@DPTR
005660 901225            MOV      DPTR,#homeID+02H
005663 D1C4              ACALL    ?L?COM02B4
005665 A3                INC      DPTR
005666 A3                INC      DPTR
005667 A3                INC      DPTR
005668 E0                MOVX     A,@DPTR
005669 FE                MOV      R6,A
00566A 901226            MOV      DPTR,#homeID+03H
00566D E0                MOVX     A,@DPTR
00566E FD                MOV      R5,A
00566F EE                MOV      A,R6
005670 6D                XRL      A,R5
005671 4F                ORL      A,R7
005672 6016              JZ       ?C0185?ZW_RF_DRIVER
005674 C3                CLR      C
005675 90094A            MOV      DPTR,#sRFStats+0BH
005678 E0                MOVX     A,@DPTR
005679 94FF              SUBB     A,#0FFH
00567B 900949            MOV      DPTR,#sRFStats+0AH
00567E E0                MOVX     A,@DPTR
00567F 94FF              SUBB     A,#0FFH
005681 5007              JNC      ?C0185?ZW_RF_DRIVER
005683 E4                CLR      A
005684 75F001            MOV      B,#01H
005687 12210C            LCALL    ?C?IILDX
00568A         ?C0185?ZW_RF_DRIVER:
00568A C3                CLR      C
00568B 900944            MOV      DPTR,#sRFStats+05H
00568E E0                MOVX     A,@DPTR
00568F 94FF              SUBB     A,#0FFH
005691 900943            MOV      DPTR,#sRFStats+04H
005694 E0                MOVX     A,@DPTR
005695 94FF              SUBB     A,#0FFH
005697 5007              JNC      ?C0187?ZW_RF_DRIVER
005699 E4                CLR      A
00569A 75F001            MOV      B,#01H
00569D 12210C            LCALL    ?C?IILDX
0056A0         ?C0187?ZW_RF_DRIVER:
0056A0 751000            MOV      demodState,#00H
0056A3 900938            MOV      DPTR,#rfRxCurrentSpeed
0056A6 E0                MOVX     A,@DPTR
0056A7 B40307            CJNE     A,#03H,?C0188?ZW_RF_DRIVER
0056AA 1516              DEC      RF_data_count
0056AC F176              ACALL    ?L?COM042B
0056AE E516              MOV      A,RF_data_count
0056B0 F0                MOVX     @DPTR,A
0056B1         ?C0188?ZW_RF_DRIVER:
0056B1 9003C4            MOV      DPTR,#receivedLength
0056B4 E516              MOV      A,RF_data_count
0056B6 F0                MOVX     @DPTR,A
0056B7         ?C0155?ZW_RF_DRIVER:
0056B7 D0FF              POP      SFRPAGE
0056B9 D0D0              POP      PSW
0056BB D082              POP      DPL
0056BD D083              POP      DPH
0056BF D0F0              POP      B
0056C1 D0E0              POP      ACC
0056C3 32                RETI     
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 102


----- FUNCTION RFInterrupt (END) -------


----- FUNCTION ?L?COM02B4 (BEGIN) -----
0056C4 FE                MOV      R6,A
0056C5 E0                MOVX     A,@DPTR
0056C6 FD                MOV      R5,A
0056C7 EE                MOV      A,R6
0056C8 6D                XRL      A,R5
0056C9 4F                ORL      A,R7
0056CA         ?L?COM02B5:
0056CA FF                MOV      R7,A
0056CB         ?L?COM02B6:
0056CB 851282            MOV      DPL,RF_data_addr+01H
0056CE 851183            MOV      DPH,RF_data_addr
0056D1 22                RET      
----- FUNCTION ?L?COM02B4 (END) -------


----- FUNCTION ?L?COM0295 (BEGIN) -----
0056D2 E4                CLR      A
0056D3 F5FF              MOV      SFRPAGE,A
0056D5         ?L?COM0296:
0056D5 E5D1              MOV      A,FHCON1
0056D7 54FE              ANL      A,#0FEH
0056D9 4402              ORL      A,#02H
0056DB F5D1              MOV      FHCON1,A
0056DD 22                RET      
----- FUNCTION ?L?COM0295 (END) -------


----- FUNCTION ?L?COM0124 (BEGIN) -----
0056DE FF                MOV      R7,A
0056DF         ?L?COM0125:
0056DF 122552            LCALL    ?C?PLDXDATA
0056E2 EF                MOV      A,R7
0056E3 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0124 (END) -------


----- FUNCTION ?L?COM018D (BEGIN) -----
0056E6 E9                MOV      A,R1
0056E7         ?L?COM018E:
0056E7 24B2              ADD      A,#0B2H
0056E9 F9                MOV      R1,A
0056EA E4                CLR      A
0056EB 3A                ADDC     A,R2
0056EC FA                MOV      R2,A
0056ED 22                RET      
----- FUNCTION ?L?COM018D (END) -------


----- FUNCTION ?L?COM052B (BEGIN) -----
0056EE D1F5              ACALL    RF_shutdown
0056F0 7F08              MOV      R7,#08H
0056F2 021E67            LJMP     ?INTERBANK_TABLE?_ApplicationRfNotify
----- FUNCTION ?L?COM052B (END) -------


----- FUNCTION RF_shutdown (BEGIN) -----
0056F5         ?C0177?ZW_PHY_RF_050X:
0056F5 E5FA              MOV      A,MODCTRL
0056F7 30E1FB            JNB      ACC.1,?C0177?ZW_PHY_RF_050X
0056FA         ?C0178?ZW_PHY_RF_050X:
0056FA 75FC80            MOV      SEQCON,#080H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 103


0056FD 75FF01            MOV      SFRPAGE,#01H
005700 53D5EF            ANL      RFCON,#0EFH
005703 E4                CLR      A
005704 F5FC              MOV      SEQCON,A
005706 75FC40            MOV      SEQCON,#040H
005709 F15D              ACALL    stop_phy_timer
00570B         ?C0179?ZW_PHY_RF_050X:
00570B E5FC              MOV      A,SEQCON
00570D 20E6FB            JB       ACC.6,?C0179?ZW_PHY_RF_050X
005710 22                RET      
----- FUNCTION RF_shutdown (END) -------


----- FUNCTION RF_WaitForBeam (BEGIN) -----
005711 F1B0              ACALL    GenerateHomeIDHash
005713 7F02              MOV      R7,#02H
005715 121E67            LCALL    ?INTERBANK_TABLE?_ApplicationRfNotify
005718 7F01              MOV      R7,#01H
00571A 123E55            LCALL    _RF_WaitForSOForTimeout
00571D 900AE3            MOV      DPTR,#bStatus
005720 EF                MOV      A,R7
005721 F0                MOVX     @DPTR,A
005722 BF0202            CJNE     R7,#02H,?C0208?ZW_RF_DRIVER
005725 8014              SJMP     ?C0256?ZW_RF_DRIVER
005727         ?C0208?ZW_RF_DRIVER:
005727 900AE3            MOV      DPTR,#bStatus
00572A E0                MOVX     A,@DPTR
00572B B43312            CJNE     A,#033H,?C0210?ZW_RF_DRIVER
00572E E4                CLR      A
00572F F0                MOVX     @DPTR,A
005730 7F01              MOV      R7,#01H
005732 123E55            LCALL    _RF_WaitForSOForTimeout
005735 BF020D            CJNE     R7,#02H,?C0209?ZW_RF_DRIVER
005738 900AE3            MOV      DPTR,#bStatus
00573B         
00573B 7401              MOV      A,#01H
00573D F0                MOVX     @DPTR,A
00573E 8005              SJMP     ?C0209?ZW_RF_DRIVER
005740         ?C0210?ZW_RF_DRIVER:
005740 E4                CLR      A
005741 900AE3            MOV      DPTR,#bStatus
005744 F0                MOVX     @DPTR,A
005745         ?C0209?ZW_RF_DRIVER:
005745 900AE3            MOV      DPTR,#bStatus
005748 E0                MOVX     A,@DPTR
005749 700B              JNZ      ?C0213?ZW_RF_DRIVER
00574B 71D5              ACALL    RF_demodulator_enable_get
00574D 5005              JNC      ?C0214?ZW_RF_DRIVER
00574F C236              CLR      ?RF_demodulator_enable?BIT
005751 123E13            LCALL    RF_demodulator_enable
005754         ?C0214?ZW_RF_DRIVER:
005754 D1EE              ACALL    ?L?COM052B
005756         ?C0213?ZW_RF_DRIVER:
005756 900AE3            MOV      DPTR,#bStatus
005759 E0                MOVX     A,@DPTR
00575A 24FF              ADD      A,#0FFH
00575C 22                RET      
----- FUNCTION RF_WaitForBeam (END) -------


----- FUNCTION stop_phy_timer (BEGIN) -----
00575D 75FF03            MOV      SFRPAGE,#03H
005760 E4                CLR      A
005761 F591              MOV      PHYTCON1,A
005763 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 104


----- FUNCTION stop_phy_timer (END) -------


----- FUNCTION ResetSensorState (BEGIN) -----
005764 301805            JNB      RF_WakeupReceived,?C0137?ZW_RF_DRIVER
005767 C218              CLR      RF_WakeupReceived
005769 1260C4            LCALL    ?L?COM0341
00576C         ?C0137?ZW_RF_DRIVER:
00576C 22                RET      
----- FUNCTION ResetSensorState (END) -------


----- FUNCTION ?L?COM052C (BEGIN) -----
00576D E5D2              MOV      A,FHCON2
00576F 5480              ANL      A,#080H
005771 4414              ORL      A,#014H
005773 F5D2              MOV      FHCON2,A
005775 22                RET      
----- FUNCTION ?L?COM052C (END) -------


----- FUNCTION ?L?COM042B (BEGIN) -----
005776 E512              MOV      A,RF_data_addr+01H
005778 2407              ADD      A,#07H
00577A F582              MOV      DPL,A
00577C E4                CLR      A
00577D 3511              ADDC     A,RF_data_addr
00577F F583              MOV      DPH,A
005781 22                RET      
----- FUNCTION ?L?COM042B (END) -------


----- FUNCTION _ZW_FH_buf0addr_set (BEGIN) -----
;---- Variable 'wAddress' assigned to Register 'R1/R2/R3' ----
005782 E4                CLR      A
005783 F5FF              MOV      SFRPAGE,A
005785 E9                MOV      A,R1
005786 126BA0            LCALL    ?L?COM0522
005789 EA                MOV      A,R2
00578A 540F              ANL      A,#0FH
00578C 42D6              ORL      FHRAMBUF,A
00578E 22                RET      
----- FUNCTION _ZW_FH_buf0addr_set (END) -------


----- FUNCTION _ZW_FH_tx_buflen_set (BEGIN) -----
;---- Variable 'bBuf1len' assigned to Register 'R5' ----
;---- Variable 'bBuf0len' assigned to Register 'R7' ----
00578F E4                CLR      A
005790 F5FF              MOV      SFRPAGE,A
005792 8FD4              MOV      FHFRML0,R7
005794 F5FF              MOV      SFRPAGE,A
005796 CF                XCH      A,R7
005797 ED                MOV      A,R5
005798 CF                XCH      A,R7
005799 8FD5              MOV      FHFRML1,R7
00579B 22                RET      
----- FUNCTION _ZW_FH_tx_buflen_set (END) -------


----- FUNCTION ?L?COM02AC (BEGIN) -----
00579C F0                MOVX     @DPTR,A
00579D A3                INC      DPTR
00579E EF                MOV      A,R7
00579F F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 105


0057A0 7E1C              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_delayed_send_callback
0057A2 7FD7              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_delayed_send_callback
0057A4         ?L?COM02AD:
0057A4 E4                CLR      A
0057A5 FB                MOV      R3,A
0057A6 7D01              MOV      R5,#01H
----- FUNCTION _TimerSysStart (BEGIN) -----
;---- Variable 'func' assigned to Register 'R6/R7' ----
;---- Variable 'brepeats' assigned to Register 'R3' ----
;---- Variable 'btimerTicks' assigned to Register 'R5' ----
0057A8 E4                CLR      A
0057A9 9043D6            MOV      DPTR,#?_TimerStart_?BYTE+04H
0057AC F0                MOVX     @DPTR,A
0057AD 02465E            LJMP     _TimerStart_
----- FUNCTION _TimerSysStart (END) -------


----- FUNCTION GenerateHomeIDHash (BEGIN) -----
;---- Variable 'bHash' assigned to Register 'R7' ----
0057B0 901223            MOV      DPTR,#homeID
0057B3 E0                MOVX     A,@DPTR
0057B4 F4                CPL      A
0057B5 FF                MOV      R7,A
0057B6 A3                INC      DPTR
0057B7 E0                MOVX     A,@DPTR
0057B8 6F                XRL      A,R7
0057B9 FF                MOV      R7,A
0057BA A3                INC      DPTR
0057BB E0                MOVX     A,@DPTR
0057BC 6F                XRL      A,R7
0057BD FF                MOV      R7,A
0057BE A3                INC      DPTR
0057BF E0                MOVX     A,@DPTR
0057C0 6F                XRL      A,R7
0057C1 FF                MOV      R7,A
0057C2 6455              XRL      A,#055H
0057C4 6009              JZ       ?C0239?ZW_RF_DRIVER
0057C6 EF                MOV      A,R7
0057C7 644A              XRL      A,#04AH
0057C9 6004              JZ       ?C0239?ZW_RF_DRIVER
0057CB EF                MOV      A,R7
0057CC B40A01            CJNE     A,#0AH,?C0238?ZW_RF_DRIVER
0057CF         ?C0239?ZW_RF_DRIVER:
0057CF 0F                INC      R7
0057D0         ?C0238?ZW_RF_DRIVER:
0057D0 900939            MOV      DPTR,#bHomeIDHash
0057D3 EF                MOV      A,R7
0057D4 F0                MOVX     @DPTR,A
0057D5 22                RET      
----- FUNCTION GenerateHomeIDHash (END) -------


----- FUNCTION RFPowerDownForce (BEGIN) -----
0057D6 E4                CLR      A
0057D7 F514              MOV      RF_state,A
0057D9 61F5              AJMP     RFPowerDown
----- FUNCTION RFPowerDownForce (END) -------


----- FUNCTION RF_IsSofDetected (BEGIN) -----
0057DB E5F7              MOV      A,DMSTAT1
0057DD 54C0              ANL      A,#0C0H
0057DF 24FF              ADD      A,#0FFH
0057E1 22                RET      
----- FUNCTION RF_IsSofDetected (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 106




----- FUNCTION ?L?COM0221 (BEGIN) -----
0057E2 E9                MOV      A,R1
0057E3         ?L?COM0222:
0057E3 2401              ADD      A,#01H
0057E5 F9                MOV      R1,A
0057E6 E4                CLR      A
0057E7 3A                ADDC     A,R2
0057E8 FA                MOV      R2,A
0057E9 22                RET      
----- FUNCTION ?L?COM0221 (END) -------


----- FUNCTION ProtocolMonitor (BEGIN) -----
0057EA 30160C            JNB      protocolLockedCachedRoute,?C0081?ZW_MAIN
0057ED 903315            MOV      DPTR,#assignState
0057F0 E0                MOVX     A,@DPTR
0057F1 7006              JNZ      ?C0081?ZW_MAIN
0057F3 FF                MOV      R7,A
0057F4 1219BC            LCALL    ?INTERBANK_TABLE?_ZW_LockRoute
0057F7 C216              CLR      protocolLockedCachedRoute
0057F9         ?C0081?ZW_MAIN:
;----                  JMP      RFUpdateIsWakeupReceivedStatus
----- FUNCTION ProtocolMonitor (END) -------


----- FUNCTION RFUpdateIsWakeupReceivedStatus (BEGIN) -----
0057F9 301823            JNB      RF_WakeupReceived,?C0008?ZW_RF_DRIVER
0057FC AF77              MOV      R7,tickTime+01H
;---- Variable 'tmp' assigned to Register 'R7' ----
0057FE 900959            MOV      DPTR,#rfWakeupReceivedTickSample
005801 E0                MOVX     A,@DPTR
005802 FE                MOV      R6,A
005803 EF                MOV      A,R7
005804 C3                CLR      C
005805 9E                SUBB     A,R6
005806 400A              JC       ?C0004?ZW_RF_DRIVER
005808 EF                MOV      A,R7
005809 9E                SUBB     A,R6
00580A D3                SETB     C
00580B 9402              SUBB     A,#02H
00580D 4010              JC       ?C0008?ZW_RF_DRIVER
00580F C218              CLR      RF_WakeupReceived
005811 22                RET      
005812         ?C0004?ZW_RF_DRIVER:
005812 900959            MOV      DPTR,#rfWakeupReceivedTickSample
005815 E0                MOVX     A,@DPTR
005816 F4                CPL      A
005817 2F                ADD      A,R7
005818 D3                SETB     C
005819 9401              SUBB     A,#01H
00581B 4002              JC       ?C0008?ZW_RF_DRIVER
00581D C218              CLR      RF_WakeupReceived
00581F         ?C0008?ZW_RF_DRIVER:
00581F 22                RET      
----- FUNCTION RFUpdateIsWakeupReceivedStatus (END) -------


----- FUNCTION _ZW_AddPollTask (BEGIN) -----
;---- Variable 'CBPolltask' assigned to Register 'R6/R7' ----
005820 9003C5            MOV      DPTR,#pPolltask
005823 E0                MOVX     A,@DPTR
005824 FC                MOV      R4,A
005825 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 107


005826 E0                MOVX     A,@DPTR
005827 4C                ORL      A,R4
005828 7005              JNZ      ?C0169?ZW_MAIN
00582A 9003C5            MOV      DPTR,#pPolltask
00582D 8002              SJMP     ?L?COM04C1
00582F         ?C0169?ZW_MAIN:
00582F C3                CLR      C
005830 22                RET      
----- FUNCTION _ZW_AddPollTask (END) -------


----- FUNCTION ?L?COM04C1 (BEGIN) -----
005831 EE                MOV      A,R6
005832 F0                MOVX     @DPTR,A
005833 A3                INC      DPTR
005834 EF                MOV      A,R7
005835 F0                MOVX     @DPTR,A
005836 D3                SETB     C
005837 22                RET      
----- FUNCTION ?L?COM04C1 (END) -------


----- FUNCTION TaskPoll (BEGIN) -----
005838 9003C5            MOV      DPTR,#pPolltask
00583B 123FED            LCALL    ?L?COM03C3
00583E 6009              JZ       ?C0172?ZW_MAIN
005840 CA                XCH      A,R2
005841 EE                MOV      A,R6
005842 CA                XCH      A,R2
005843 C9                XCH      A,R1
005844 EF                MOV      A,R7
005845 C9                XCH      A,R1
005846 1226DF            LCALL    ?C?ICALL
005849         ?C0172?ZW_MAIN:
005849 22                RET      
----- FUNCTION TaskPoll (END) -------


----- FUNCTION SysTimerInit (BEGIN) -----
00584A D2AD              SETB     EMULTI
00584C D2BD              SETB     PMULTI
00584E 75FF02            MOV      SFRPAGE,#02H
005851 758E71            MOV      SYSTCON,#071H
005854 757C09            MOV      timerRes,#09H
005857 75FF02            MOV      SFRPAGE,#02H
00585A E58E              MOV      A,SYSTCON
00585C 546F              ANL      A,#06FH
00585E 4480              ORL      A,#080H
005860 F58E              MOV      SYSTCON,A
005862 904546            MOV      DPTR,#systemTime
005865 1224C6            LCALL    ?C?LSTKXDATA
005868 00                DB       00H
005869 00                DB       00H
00586A 00                DB       00H
00586B 00                DB       00H
00586C 22                RET      
----- FUNCTION SysTimerInit (END) -------


----- FUNCTION MultiInterrupt (BEGIN) -----
00586D C0E0              PUSH     ACC
00586F C0F0              PUSH     B
005871 C083              PUSH     DPH
005873 C082              PUSH     DPL
005875 C0D0              PUSH     PSW
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 108


005877 75D008            MOV      PSW,#08H
00587A C0FF              PUSH     SFRPAGE
00587C 75FF02            MOV      SFRPAGE,#02H
00587F E58E              MOV      A,SYSTCON
005881 30E43E            JNB      ACC.4,?C0002?ZW_MULTI_INT_050X
005884 75FF02            MOV      SFRPAGE,#02H
005887 E58E              MOV      A,SYSTCON
005889 54EF              ANL      A,#0EFH
00588B 4410              ORL      A,#010H
00588D F58E              MOV      SYSTCON,A
00588F 904546            MOV      DPTR,#systemTime
005892 122462            LCALL    ?C?LLDXDATA
005895 124DBC            LCALL    ?L?COM0043
005898 904546            MOV      DPTR,#systemTime
00589B 1224BA            LCALL    ?C?LSTXDATA
00589E 900000            MOV      DPTR,#timerCount
0058A1 E4                CLR      A
0058A2 75F001            MOV      B,#01H
0058A5 12210C            LCALL    ?C?IILDX
0058A8 E57C              MOV      A,timerRes
0058AA 30E002            JNB      ACC.0,?C0003?ZW_MULTI_INT_050X
0058AD 0551              INC      bCurrentExploreTimerTicks
0058AF         ?C0003?ZW_MULTI_INT_050X:
0058AF E57C              MOV      A,timerRes
0058B1 700D              JNZ      ?C0004?ZW_MULTI_INT_050X
0058B3 757C09            MOV      timerRes,#09H
0058B6 0577              INC      tickTime+01H
0058B8 E577              MOV      A,tickTime+01H
0058BA 7002              JNZ      ?C0008?ZW_MULTI_INT_050X
0058BC 0576              INC      tickTime
0058BE         ?C0008?ZW_MULTI_INT_050X:
0058BE 8002              SJMP     ?C0002?ZW_MULTI_INT_050X
0058C0         ?C0004?ZW_MULTI_INT_050X:
0058C0 157C              DEC      timerRes
0058C2         ?C0002?ZW_MULTI_INT_050X:
0058C2 75FF02            MOV      SFRPAGE,#02H
0058C5 E585              MOV      A,SLTCON1
0058C7 30E408            JNB      ACC.4,?C0006?ZW_MULTI_INT_050X
0058CA 75FF02            MOV      SFRPAGE,#02H
0058CD 438510            ORL      SLTCON1,#010H
0058D0 057E              INC      slow_timer_count
0058D2         ?C0006?ZW_MULTI_INT_050X:
0058D2 D0FF              POP      SFRPAGE
0058D4 D0D0              POP      PSW
0058D6 D082              POP      DPL
0058D8 D083              POP      DPH
0058DA D0F0              POP      B
0058DC D0E0              POP      ACC
0058DE 32                RETI     
----- FUNCTION MultiInterrupt (END) -------


----- FUNCTION ?L?COM054D (BEGIN) -----
0058DF 7BFF              MOV      R3,#0FFH
0058E1 7D01              MOV      R5,#01H
----- FUNCTION _TimerStart (BEGIN) -----
;---- Variable 'func' assigned to Register 'R6/R7' ----
;---- Variable 'brepeats' assigned to Register 'R3' ----
;---- Variable 'btimerTicks' assigned to Register 'R5' ----
0058E3 9043D6            MOV      DPTR,#?_TimerStart_?BYTE+04H
0058E6 7403              MOV      A,#03H
0058E8 F0                MOVX     @DPTR,A
0058E9 02465E            LJMP     _TimerStart_
----- FUNCTION _TimerStart (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 109



----- FUNCTION _ZW_TimerLongGetTimeLeft (BEGIN) -----
;---- Variable 'bTimerHandle' assigned to Register 'R7' ----
0058EC 1F                DEC      R7
0058ED EF                MOV      A,R7
0058EE C3                CLR      C
0058EF 940E              SUBB     A,#0EH
0058F1 5009              JNC      ?C0039?ZW_TIMER
0058F3 EF                MOV      A,R7
0058F4 1245DD            LCALL    ?L?COM00A0
0058F7 122462            LCALL    ?C?LLDXDATA
0058FA 8005              SJMP     ?C0040?ZW_TIMER
0058FC         ?C0039?ZW_TIMER:
0058FC E4                CLR      A
0058FD FF                MOV      R7,A
0058FE FE                MOV      R6,A
0058FF FD                MOV      R5,A
005900 FC                MOV      R4,A
005901         ?C0040?ZW_TIMER:
005901 22                RET      
----- FUNCTION _ZW_TimerLongGetTimeLeft (END) -------


----- FUNCTION _TimerOptionCount (BEGIN) -----
;---- Variable 'bTimerOptionMask' assigned to Register 'R5' ----
;---- Variable 'bstartElem' assigned to Register 'R7' ----
;---- Variable 'bCount' assigned to Register 'R6' ----
005902 E4                CLR      A
005903 FE                MOV      R6,A
;---- Variable 'i' assigned to Register 'R7' ----
005904         ?C0042?ZW_TIMER:
005904 EF                MOV      A,R7
005905 C3                CLR      C
005906 940E              SUBB     A,#0EH
005908 5013              JNC      ?C0043?ZW_TIMER
00590A EF                MOV      A,R7
00590B 124516            LCALL    ?L?COM0103
00590E E0                MOVX     A,@DPTR
00590F 5D                ANL      A,R5
005910 7C00              MOV      R4,#00H
005912 B50502            CJNE     A,AR5,?C0045?ZW_TIMER
005915 7C01              MOV      R4,#01H
005917         ?C0045?ZW_TIMER:
005917         ?C0046?ZW_TIMER:
005917 EC                MOV      A,R4
005918 2E                ADD      A,R6
005919 FE                MOV      R6,A
00591A 0F                INC      R7
00591B 80E7              SJMP     ?C0042?ZW_TIMER
00591D         ?C0043?ZW_TIMER:
00591D AF06              MOV      R7,AR6
00591F 22                RET      
----- FUNCTION _TimerOptionCount (END) -------


----- FUNCTION TimerGetActiveSys (BEGIN) -----
005920 7D02              MOV      R5,#02H
005922 E4                CLR      A
005923 FF                MOV      R7,A
005924 80DC              SJMP     _TimerOptionCount
----- FUNCTION TimerGetActiveSys (END) -------


----- FUNCTION TimerGetActive (BEGIN) -----
005926 7D01              MOV      R5,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 110


005928 7F03              MOV      R7,#03H
00592A 3102              ACALL    _TimerOptionCount
00592C AB07              MOV      R3,AR7
00592E 3120              ACALL    TimerGetActiveSys
005930 EF                MOV      A,R7
005931 2B                ADD      A,R3
005932 FF                MOV      R7,A
005933 22                RET      
----- FUNCTION TimerGetActive (END) -------


----- FUNCTION ZW_TimerGetFree (BEGIN) -----
005934 E4                CLR      A
005935 FD                MOV      R5,A
005936 7F03              MOV      R7,#03H
005938 80C8              SJMP     _TimerOptionCount
----- FUNCTION ZW_TimerGetFree (END) -------


----- FUNCTION getTickTime (BEGIN) -----
00593A A2AD              MOV      C,EMULTI
00593C 9228              MOV      EMULTItmp,C
00593E C2AD              CLR      EMULTI
;---- Variable 'tickTimeTmp' assigned to Register 'R6/R7' ----
005940 AF77              MOV      R7,tickTime+01H
005942 AE76              MOV      R6,tickTime
005944 A228              MOV      C,EMULTItmp
005946 92AD              MOV      EMULTI,C
005948 22                RET      
----- FUNCTION getTickTime (END) -------


----- FUNCTION _getTickTimePassed (BEGIN) -----
;---- Variable 'wStartTickTime' assigned to Register 'R4/R5' ----
005949 AD07              MOV      R5,AR7
00594B AC06              MOV      R4,AR6
00594D 313A              ACALL    getTickTime
;---- Variable 'wTick' assigned to Register 'R6/R7' ----
00594F C3                CLR      C
005950 EF                MOV      A,R7
005951 9D                SUBB     A,R5
005952 EE                MOV      A,R6
005953 9C                SUBB     A,R4
005954 4008              JC       ?C0052?ZW_TIMER
005956 EF                MOV      A,R7
005957 9D                SUBB     A,R5
005958 FF                MOV      R7,A
005959 EE                MOV      A,R6
00595A 9C                SUBB     A,R4
00595B FE                MOV      R6,A
00595C 8013              SJMP     ?C0053?ZW_TIMER
00595E         ?C0052?ZW_TIMER:
00595E ED                MOV      A,R5
00595F F4                CPL      A
005960 FD                MOV      R5,A
005961 EC                MOV      A,R4
005962 F4                CPL      A
005963 FC                MOV      R4,A
005964 ED                MOV      A,R5
005965 2401              ADD      A,#01H
005967 FD                MOV      R5,A
005968 E4                CLR      A
005969 3C                ADDC     A,R4
00596A FC                MOV      R4,A
00596B ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 111


00596C 2F                ADD      A,R7
00596D FF                MOV      R7,A
00596E EC                MOV      A,R4
00596F 3E                ADDC     A,R6
005970 FE                MOV      R6,A
005971         ?C0053?ZW_TIMER:
005971 22                RET      
----- FUNCTION _getTickTimePassed (END) -------


----- FUNCTION ?L?COM02CF (BEGIN) -----
005972 9003CA            MOV      DPTR,#bSleepWaitTimeout
005975 E0                MOVX     A,@DPTR
005976 FE                MOV      R6,A
005977 A3                INC      DPTR
005978 E0                MOVX     A,@DPTR
005979 FF                MOV      R7,A
00597A 3149              ACALL    _getTickTimePassed
00597C         ?L?COM02D0:
00597C D3                SETB     C
00597D EF                MOV      A,R7
00597E 94C8              SUBB     A,#0C8H
005980 EE                MOV      A,R6
005981 9400              SUBB     A,#00H
005983 22                RET      
----- FUNCTION ?L?COM02CF (END) -------


----- FUNCTION RFLBtTimeoutFunction (BEGIN) -----
005984 E4                CLR      A
005985 90095A            MOV      DPTR,#bLBTFailedTimerhandler
005988 F0                MOVX     @DPTR,A
005989 90094B            MOV      DPTR,#bLBTTimeout
00598C 04                INC      A
00598D F0                MOVX     @DPTR,A
00598E 22                RET      
----- FUNCTION RFLBtTimeoutFunction (END) -------


----- FUNCTION RFIsReceiving (BEGIN) -----
00598F 1253D5            LCALL    RF_demodulator_enable_get
005992 5004              JNC      ?C0012?ZW_RF_DRIVER
005994 31A0              ACALL    RF_IsSofOrPreambDetected
005996 4003              JC       ?C0011?ZW_RF_DRIVER
005998         ?C0012?ZW_RF_DRIVER:
005998 301803            JNB      RF_WakeupReceived,?C0009?ZW_RF_DRIVER
00599B         ?C0011?ZW_RF_DRIVER:
00599B D3                SETB     C
00599C 8001              SJMP     ?C0010?ZW_RF_DRIVER
00599E         ?C0009?ZW_RF_DRIVER:
00599E C3                CLR      C
00599F         ?C0010?ZW_RF_DRIVER:
00599F 22                RET      
----- FUNCTION RFIsReceiving (END) -------


----- FUNCTION RF_IsSofOrPreambDetected (BEGIN) -----
0059A0 E5F7              MOV      A,DMSTAT1
0059A2 54E0              ANL      A,#0E0H
0059A4 24FF              ADD      A,#0FFH
0059A6 22                RET      
----- FUNCTION RF_IsSofOrPreambDetected (END) -------


----- FUNCTION RFIsTransmitting (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 112


0059A7 AF14              MOV      R7,RF_state
0059A9 EF                MOV      A,R7
0059AA C3                CLR      C
0059AB 6001              JZ       ?C0014?ZW_RF_DRIVER
0059AD D3                SETB     C
0059AE         ?C0014?ZW_RF_DRIVER:
0059AE 22                RET      
----- FUNCTION RFIsTransmitting (END) -------


----- FUNCTION _ZW_RFPowerlevelRediscoverySet (BEGIN) -----
;---- Variable 'bNewPower' assigned to Register 'R7' ----
0059AF EF                MOV      A,R7
0059B0 C3                CLR      C
0059B1 940E              SUBB     A,#0EH
0059B3 5005              JNC      ?C0018?ZW_RF_DRIVER
0059B5 90093B            MOV      DPTR,#bRediscoveryPowerLevel
0059B8 EF                MOV      A,R7
0059B9 F0                MOVX     @DPTR,A
0059BA         ?C0018?ZW_RF_DRIVER:
0059BA 22                RET      
----- FUNCTION _ZW_RFPowerlevelRediscoverySet (END) -------


----- FUNCTION ZW_RFPowerLevelGet (BEGIN) -----
0059BB E517              MOV      A,powerIndex
0059BD 540F              ANL      A,#0FH
0059BF FF                MOV      R7,A
0059C0 22                RET      
----- FUNCTION ZW_RFPowerLevelGet (END) -------


----- FUNCTION _ZW_RFPowerLevelSet (BEGIN) -----
;---- Variable 'powerLevel' assigned to Register 'R7' ----
0059C1 E517              MOV      A,powerIndex
0059C3 C3                CLR      C
0059C4 94F0              SUBB     A,#0F0H
0059C6 501F              JNC      ?C0020?ZW_RF_DRIVER
0059C8 5317F0            ANL      powerIndex,#0F0H
0059CB 31EA              ACALL    ?L?COM03FC
0059CD FE                MOV      R6,A
;---- Variable 'p' assigned to Register 'R6' ----
0059CE 740F              MOV      A,#0FH
0059D0 C3                CLR      C
0059D1 9F                SUBB     A,R7
0059D2 4005              JC       ?C0022?ZW_RF_DRIVER
0059D4 EE                MOV      A,R6
0059D5 940E              SUBB     A,#0EH
0059D7 4005              JC       ?C0021?ZW_RF_DRIVER
0059D9         ?C0022?ZW_RF_DRIVER:
0059D9 43170D            ORL      powerIndex,#0DH
0059DC 8003              SJMP     ?C0023?ZW_RF_DRIVER
0059DE         ?C0021?ZW_RF_DRIVER:
0059DE EF                MOV      A,R7
0059DF 4217              ORL      powerIndex,A
0059E1         ?C0023?ZW_RF_DRIVER:
0059E1 E517              MOV      A,powerIndex
0059E3 540F              ANL      A,#0FH
0059E5 FF                MOV      R7,A
0059E6 22                RET      
0059E7         ?C0020?ZW_RF_DRIVER:
0059E7 7F00              MOV      R7,#00H
0059E9 22                RET      
----- FUNCTION _ZW_RFPowerLevelSet (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 113



----- FUNCTION ?L?COM03FC (BEGIN) -----
0059EA E517              MOV      A,powerIndex
0059EC C4                SWAP     A
0059ED 540F              ANL      A,#0FH
0059EF FE                MOV      R6,A
0059F0 EF                MOV      A,R7
0059F1 902FE4            MOV      DPTR,#index_map
0059F4 93                MOVC     A,@A+DPTR
0059F5 2E                ADD      A,R6
0059F6 22                RET      
----- FUNCTION ?L?COM03FC (END) -------


----- FUNCTION _RFPowerGetTxPwrReg (BEGIN) -----
;---- Variable 'powerLevel' assigned to Register 'R7' ----
0059F7 31EA              ACALL    ?L?COM03FC
0059F9 FF                MOV      R7,A
;---- Variable 'i' assigned to Register 'R7' ----
0059FA C3                CLR      C
0059FB 940E              SUBB     A,#0EH
0059FD 4002              JC       ?C0034?ZW_RF_DRIVER
0059FF 7F0D              MOV      R7,#0DH
005A01         ?C0034?ZW_RF_DRIVER:
005A01 EF                MOV      A,R7
005A02 902FC6            MOV      DPTR,#rf_power_table
005A05 93                MOVC     A,@A+DPTR
005A06 FF                MOV      R7,A
005A07 22                RET      
----- FUNCTION _RFPowerGetTxPwrReg (END) -------


----- FUNCTION _RF_get_tx_power (BEGIN) -----
;---- Variable 'wRFoptions' assigned to Register 'R6/R7' ----
005A08 EF                MOV      A,R7
005A09 30E303            JNB      ACC.3,?C0054?ZW_RF_DRIVER
005A0C AF13              MOV      R7,low_PA_POW
005A0E 22                RET      
005A0F         ?C0054?ZW_RF_DRIVER:
;---- Variable 'i' assigned to Register 'R5' ----
005A0F AD1B              MOV      R5,normal_PA_POW
005A11 201904            JB       reducedFindNeighborPower,?C0057?ZW_RF_DRIVER
005A14 EE                MOV      A,R6
005A15 30E00B            JNB      ACC.0,?C0056?ZW_RF_DRIVER
005A18         ?C0057?ZW_RF_DRIVER:
005A18 E517              MOV      A,powerIndex
005A1A C3                CLR      C
005A1B 94F0              SUBB     A,#0F0H
005A1D 5020              JNC      ?C0059?ZW_RF_DRIVER
005A1F 5142              ACALL    RFPowerLevelGetReduced
005A21 8018              SJMP     ?C0245?ZW_RF_DRIVER
005A23         ?C0056?ZW_RF_DRIVER:
005A23 E519              MOV      A,ackPower
005A25 6006              JZ       ?C0060?ZW_RF_DRIVER
005A27 FD                MOV      R5,A
005A28 E4                CLR      A
005A29 F519              MOV      ackPower,A
005A2B 8012              SJMP     ?C0059?ZW_RF_DRIVER
005A2D         ?C0060?ZW_RF_DRIVER:
005A2D E517              MOV      A,powerIndex
005A2F C3                CLR      C
005A30 94F0              SUBB     A,#0F0H
005A32 500B              JNC      ?C0059?ZW_RF_DRIVER
005A34 E517              MOV      A,powerIndex
005A36 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 114


005A38 FF                MOV      R7,A
005A39 6004              JZ       ?C0059?ZW_RF_DRIVER
005A3B         
005A3B 31F7              ACALL    _RFPowerGetTxPwrReg
005A3D AD07              MOV      R5,AR7
005A3F         ?C0059?ZW_RF_DRIVER:
005A3F AF05              MOV      R7,AR5
005A41 22                RET      
----- FUNCTION _RF_get_tx_power (END) -------


----- FUNCTION RFPowerLevelGetReduced (BEGIN) -----
005A42 90093B            MOV      DPTR,#bRediscoveryPowerLevel
005A45 E0                MOVX     A,@DPTR
005A46 FD                MOV      R5,A
005A47 FF                MOV      R7,A
005A48 C3                CLR      C
005A49 740E              MOV      A,#0EH
005A4B 5169              ACALL    ?L?COM03E6
005A4D EF                MOV      A,R7
005A4E C4                SWAP     A
005A4F F8                MOV      R0,A
005A50 540F              ANL      A,#0FH
005A52 C8                XCH      A,R0
005A53 68                XRL      A,R0
005A54 FF                MOV      R7,A
005A55 EE                MOV      A,R6
005A56 C4                SWAP     A
005A57 54F0              ANL      A,#0F0H
005A59 48                ORL      A,R0
005A5A FE                MOV      R6,A
005A5B E517              MOV      A,powerIndex
005A5D 54F0              ANL      A,#0F0H
005A5F 12533E            LCALL    ?L?COM011D
005A62 7F00              MOV      R7,#00H
005A64 5002              JNC      ?C0029?ZW_RF_DRIVER
005A66 AF05              MOV      R7,AR5
005A68         ?C0029?ZW_RF_DRIVER:
005A68 22                RET      
----- FUNCTION RFPowerLevelGetReduced (END) -------


----- FUNCTION ?L?COM03E6 (BEGIN) -----
005A69 9F                SUBB     A,R7
005A6A FF                MOV      R7,A
005A6B E4                CLR      A
005A6C 9400              SUBB     A,#00H
005A6E FE                MOV      R6,A
005A6F 22                RET      
----- FUNCTION ?L?COM03E6 (END) -------


----- FUNCTION __set_separation_TX (BEGIN) -----
005A70 904556            MOV      DPTR,#speed
005A73 ED                MOV      A,R5
005A74 F0                MOVX     @DPTR,A
;---- Variable 'ch' assigned to Register 'R7' ----
;---- Variable 'success' assigned to Register 'R1/R2/R3' ----
005A75 901211            MOV      DPTR,#phyRfData+010H
005A78 E0                MOVX     A,@DPTR
005A79 F4                CPL      A
005A7A 6005              JZ       ?C0134?ZW_PHY_RF_050X
005A7C A3                INC      DPTR
005A7D E0                MOVX     A,@DPTR
005A7E B4FF0C            CJNE     A,#0FFH,?C0133?ZW_PHY_RF_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 115


005A81         ?C0134?ZW_PHY_RF_050X:
005A81 904558            MOV      DPTR,#txcal1
005A84 7418              MOV      A,#018H
005A86 F0                MOVX     @DPTR,A
005A87 A3                INC      DPTR
005A88 7413              MOV      A,#013H
005A8A F0                MOVX     @DPTR,A
005A8B 8010              SJMP     ?C0135?ZW_PHY_RF_050X
005A8D         ?C0133?ZW_PHY_RF_050X:
005A8D 901211            MOV      DPTR,#phyRfData+010H
005A90 E0                MOVX     A,@DPTR
005A91 904558            MOV      DPTR,#txcal1
005A94 F0                MOVX     @DPTR,A
005A95 901212            MOV      DPTR,#phyRfData+011H
005A98 E0                MOVX     A,@DPTR
005A99 904559            MOV      DPTR,#txcal2
005A9C F0                MOVX     @DPTR,A
005A9D         ?C0135?ZW_PHY_RF_050X:
005A9D 121F7C            LCALL    ?C?CLDPTR
005AA0 6401              XRL      A,#01H
005AA2 6002              JZ       $ + 4H
005AA4 61D0              AJMP     ?C0148?ZW_PHY_RF_050X
005AA6 904556            MOV      DPTR,#speed
005AA9 E0                MOVX     A,@DPTR
005AAA FE                MOV      R6,A
005AAB 6408              XRL      A,#08H
005AAD 6004              JZ       ?C0138?ZW_PHY_RF_050X
005AAF EE                MOV      A,R6
005AB0 B40408            CJNE     A,#04H,?C0137?ZW_PHY_RF_050X
005AB3         ?C0138?ZW_PHY_RF_050X:
005AB3 904557            MOV      DPTR,#separation
005AB6 7428              MOV      A,#028H
005AB8 F0                MOVX     @DPTR,A
005AB9 8006              SJMP     ?C0139?ZW_PHY_RF_050X
005ABB         ?C0137?ZW_PHY_RF_050X:
005ABB 904557            MOV      DPTR,#separation
005ABE 743A              MOV      A,#03AH
005AC0 F0                MOVX     @DPTR,A
005AC1         ?C0139?ZW_PHY_RF_050X:
005AC1 EF                MOV      A,R7
005AC2 124AA3            LCALL    ?L?COM0024
005AC5 122379            LCALL    ?C?LNEG
005AC8 E4                CLR      A
005AC9 71D8              ACALL    ?L?COM0527
005ACB EF                MOV      A,R7
005ACC 24D8              ADD      A,#0D8H
005ACE FF                MOV      R7,A
005ACF EE                MOV      A,R6
005AD0 343F              ADDC     A,#03FH
005AD2 FE                MOV      R6,A
005AD3 ED                MOV      A,R5
005AD4 3493              ADDC     A,#093H
005AD6 FD                MOV      R5,A
005AD7 EC                MOV      A,R4
005AD8 3416              ADDC     A,#016H
005ADA FC                MOV      R4,A
005ADB 7B00              MOV      R3,#00H
005ADD 7A80              MOV      R2,#080H
005ADF 7903              MOV      R1,#03H
005AE1 7800              MOV      R0,#00H
005AE3 122DCC            LCALL    ?C?SLDIV
005AE6 918D              ACALL    ?L?COM03F5
005AE8 904559            MOV      DPTR,#txcal2
005AEB E0                MOVX     A,@DPTR
005AEC FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 116


005AED 904558            MOV      DPTR,#txcal1
005AF0 E0                MOVX     A,@DPTR
005AF1 C3                CLR      C
005AF2 5169              ACALL    ?L?COM03E6
005AF4 E4                CLR      A
005AF5 FC                MOV      R4,A
005AF6 FD                MOV      R5,A
005AF7 12224F            LCALL    ?C?LMUL
005AFA EC                MOV      A,R4
005AFB C0E0              PUSH     ACC
005AFD ED                MOV      A,R5
005AFE C0E0              PUSH     ACC
005B00 EE                MOV      A,R6
005B01 C0E0              PUSH     ACC
005B03 EF                MOV      A,R7
005B04 C0E0              PUSH     ACC
005B06 904559            MOV      DPTR,#txcal2
005B09 71D1              ACALL    ?L?COM02DC
005B0B 71D8              ACALL    ?L?COM0527
005B0D D0E0              POP      ACC
005B0F FB                MOV      R3,A
005B10 D0E0              POP      ACC
005B12 FA                MOV      R2,A
005B13 D0E0              POP      ACC
005B15 F9                MOV      R1,A
005B16 D0E0              POP      ACC
005B18 F8                MOV      R0,A
005B19 EB                MOV      A,R3
005B1A 2F                ADD      A,R7
005B1B FB                MOV      R3,A
005B1C EA                MOV      A,R2
005B1D 3E                ADDC     A,R6
005B1E FA                MOV      R2,A
005B1F E9                MOV      A,R1
005B20 3D                ADDC     A,R5
005B21 F9                MOV      R1,A
005B22 E8                MOV      A,R0
005B23 3C                ADDC     A,R4
005B24 F8                MOV      R0,A
005B25 904557            MOV      DPTR,#separation
005B28 71D1              ACALL    ?L?COM02DC
005B2A 12224F            LCALL    ?C?LMUL
005B2D EF                MOV      A,R7
005B2E 2454              ADD      A,#054H
005B30 FF                MOV      R7,A
005B31 EE                MOV      A,R6
005B32 340B              ADDC     A,#0BH
005B34 124DC2            LCALL    ?L?COM0045
005B37 E4                CLR      A
005B38 7BA8              MOV      R3,#0A8H
005B3A 7A16              MOV      R2,#016H
005B3C F9                MOV      R1,A
005B3D F8                MOV      R0,A
005B3E 122DCC            LCALL    ?C?SLDIV
;---- Variable 'tx_calibration' assigned to Register 'R3' ----
005B41 CB                XCH      A,R3
005B42 EF                MOV      A,R7
005B43 CB                XCH      A,R3
005B44 904556            MOV      DPTR,#speed
005B47 E0                MOVX     A,@DPTR
005B48 14                DEC      A
005B49 605D              JZ       ?C0147?ZW_PHY_RF_050X
005B4B 14                DEC      A
005B4C 601B              JZ       ?C0143?ZW_PHY_RF_050X
005B4E 24FE              ADD      A,#0FEH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 117


005B50 600C              JZ       ?C0142?ZW_PHY_RF_050X
005B52 24FC              ADD      A,#0FCH
005B54 707A              JNZ      ?C0148?ZW_PHY_RF_050X
005B56         ?C0141?ZW_PHY_RF_050X:
005B56 E4                CLR      A
005B57 F5FF              MOV      SFRPAGE,A
005B59 75CE31            MOV      DPLLGSCON,#031H
005B5C 8006              SJMP     ?C0307?ZW_PHY_RF_050X
005B5E         ?C0142?ZW_PHY_RF_050X:
005B5E E4                CLR      A
005B5F F5FF              MOV      SFRPAGE,A
005B61 75CE21            MOV      DPLLGSCON,#021H
005B64         
005B64 F5FF              MOV      SFRPAGE,A
005B66 8BCF              MOV      DPLLGSVLO,R3
005B68 22                RET      
005B69         ?C0143?ZW_PHY_RF_050X:
;---- Variable 'loop' assigned to Register 'R2' ----
005B69 E4                CLR      A
005B6A FA                MOV      R2,A
005B6B         ?C0144?ZW_PHY_RF_050X:
005B6B E4                CLR      A
005B6C F5FF              MOV      SFRPAGE,A
005B6E EA                MOV      A,R2
005B6F 2440              ADD      A,#040H
005B71 F5CE              MOV      DPLLGSCON,A
005B73 E4                CLR      A
005B74 F5FF              MOV      SFRPAGE,A
005B76 EA                MOV      A,R2
005B77 FF                MOV      R7,A
005B78 C3                CLR      C
005B79 7407              MOV      A,#07H
005B7B 5169              ACALL    ?L?COM03E6
005B7D 7482              MOV      A,#LOW GAUSS_CONSTANTS
005B7F 2F                ADD      A,R7
005B80 F582              MOV      DPL,A
005B82 7430              MOV      A,#HIGH GAUSS_CONSTANTS
005B84 3E                ADDC     A,R6
005B85 F583              MOV      DPH,A
005B87 E4                CLR      A
005B88 71E0              ACALL    ?L?COM0242
005B8A C3                CLR      C
005B8B 9D                SUBB     A,R5
005B8C F5CF              MOV      DPLLGSVLO,A
005B8E E4                CLR      A
005B8F F5FF              MOV      SFRPAGE,A
005B91 EA                MOV      A,R2
005B92 2448              ADD      A,#048H
005B94 F5CE              MOV      DPLLGSCON,A
005B96 E4                CLR      A
005B97 F5FF              MOV      SFRPAGE,A
005B99 EA                MOV      A,R2
005B9A 903082            MOV      DPTR,#GAUSS_CONSTANTS
005B9D 71E0              ACALL    ?L?COM0242
005B9F 2D                ADD      A,R5
005BA0 F5CF              MOV      DPLLGSVLO,A
005BA2 0A                INC      R2
005BA3 EA                MOV      A,R2
005BA4 B408C4            CJNE     A,#08H,?C0144?ZW_PHY_RF_050X
005BA7 22                RET      
005BA8         ?C0147?ZW_PHY_RF_050X:
005BA8 E4                CLR      A
005BA9 F5FF              MOV      SFRPAGE,A
005BAB 75CE01            MOV      DPLLGSCON,#01H
005BAE F5FF              MOV      SFRPAGE,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 118


005BB0 8BCF              MOV      DPLLGSVLO,R3
005BB2 F5FF              MOV      SFRPAGE,A
005BB4 75CE0E            MOV      DPLLGSCON,#0EH
005BB7 F5FF              MOV      SFRPAGE,A
005BB9 EB                MOV      A,R3
005BBA 25E0              ADD      A,ACC
005BBC F5CF              MOV      DPLLGSVLO,A
005BBE E4                CLR      A
005BBF F5FF              MOV      SFRPAGE,A
005BC1 75CE0F            MOV      DPLLGSCON,#0FH
005BC4 F5FF              MOV      SFRPAGE,A
005BC6 CF                XCH      A,R7
005BC7 EB                MOV      A,R3
005BC8 CF                XCH      A,R7
005BC9 EB                MOV      A,R3
005BCA 75F003            MOV      B,#03H
005BCD A4                MUL      AB
005BCE F5CF              MOV      DPLLGSVLO,A
005BD0         ?C0148?ZW_PHY_RF_050X:
005BD0 22                RET      
----- FUNCTION __set_separation_TX (END) -------


----- FUNCTION ?L?COM02DC (BEGIN) -----
005BD1 E0                MOVX     A,@DPTR
005BD2 FF                MOV      R7,A
005BD3 E4                CLR      A
005BD4 FC                MOV      R4,A
005BD5 FD                MOV      R5,A
005BD6 FE                MOV      R6,A
005BD7 22                RET      
----- FUNCTION ?L?COM02DC (END) -------


----- FUNCTION ?L?COM0527 (BEGIN) -----
005BD8 7B64              MOV      R3,#064H
005BDA FA                MOV      R2,A
005BDB F9                MOV      R1,A
005BDC F8                MOV      R0,A
005BDD 02224F            LJMP     ?C?LMUL
----- FUNCTION ?L?COM0527 (END) -------


----- FUNCTION ?L?COM0242 (BEGIN) -----
005BE0 93                MOVC     A,@A+DPTR
005BE1 25E0              ADD      A,ACC
005BE3 FD                MOV      R5,A
005BE4 E4                CLR      A
005BE5 33                RLC      A
005BE6 FC                MOV      R4,A
005BE7 EB                MOV      A,R3
005BE8 75F010            MOV      B,#010H
005BEB A4                MUL      AB
005BEC FF                MOV      R7,A
005BED AEF0              MOV      R6,B
005BEF 122081            LCALL    ?C?UIDIV
005BF2 CD                XCH      A,R5
005BF3 EF                MOV      A,R7
005BF4 CD                XCH      A,R5
005BF5 EB                MOV      A,R3
005BF6 FF                MOV      R7,A
005BF7 E4                CLR      A
005BF8 C3                CLR      C
005BF9 13                RRC      A
005BFA EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 119


005BFB 13                RRC      A
005BFC 22                RET      
----- FUNCTION ?L?COM0242 (END) -------


----- FUNCTION _SwitchToTX (BEGIN) -----
;---- Variable 'wRFoptions' assigned to Register 'R6/R7' ----
005BFD 431501            ORL      RF_status,#01H
005C00 5315DF            ANL      RF_status,#0DFH
005C03 5108              ACALL    _RF_get_tx_power
005C05 913D              ACALL    _RF_setup_tx_mode
005C07 4004              JC       ?C0099?ZW_RF_DRIVER
005C09 E4                CLR      A
005C0A F514              MOV      RF_state,A
005C0C 22                RET      
005C0D         ?C0099?ZW_RF_DRIVER:
005C0D 43FA04            ORL      MODCTRL,#04H
005C10 5315FB            ANL      RF_status,#0FBH
005C13 302904            JNB      bUseFrameHandler,?C0101?ZW_RF_DRIVER
005C16 91B0              ACALL    ?L?COM0298
005C18 800A              SJMP     ?C0102?ZW_RF_DRIVER
005C1A         ?C0101?ZW_RF_DRIVER:
005C1A 7F55              MOV      R7,#055H
005C1C 9126              ACALL    _RF_byte_set
005C1E 7F55              MOV      R7,#055H
005C20 9126              ACALL    _RF_byte_set
005C22 D2EB              SETB     ERF
005C24         ?C0102?ZW_RF_DRIVER:
005C24 D3                SETB     C
005C25 22                RET      
----- FUNCTION _SwitchToTX (END) -------


----- FUNCTION _RF_byte_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
005C26 75FF01            MOV      SFRPAGE,#01H
005C29 E5D5              MOV      A,RFCON
005C2B 20E602            JB       ACC.6,?C0266?ZW_PHY_RF_050X
005C2E C3                CLR      C
005C2F 22                RET      
005C30         ?C0266?ZW_PHY_RF_050X:
005C30 E5FA              MOV      A,MODCTRL
005C32 5403              ANL      A,#03H
005C34 60FA              JZ       ?C0266?ZW_PHY_RF_050X
005C36         ?C0267?ZW_PHY_RF_050X:
005C36 75FF01            MOV      SFRPAGE,#01H
005C39 8FC3              MOV      MODDATA,R7
005C3B D3                SETB     C
005C3C 22                RET      
----- FUNCTION _RF_byte_set (END) -------


----- FUNCTION _RF_setup_tx_mode (BEGIN) -----
;---- Variable 'power' assigned to Register 'R7' ----
005C3D 900AB9            MOV      DPTR,#txPwr
005C40 EF                MOV      A,R7
005C41 F0                MOVX     @DPTR,A
005C42 90093A            MOV      DPTR,#rfTxCurrentSpeed
005C45 E0                MOVX     A,@DPTR
005C46 FF                MOV      R7,A
005C47 919A              ACALL    _Speed2Channel
005C49 900ABA            MOV      DPTR,#txCh
005C4C EF                MOV      A,R7
005C4D F0                MOVX     @DPTR,A
005C4E 90093A            MOV      DPTR,#rfTxCurrentSpeed
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 120


005C51 E0                MOVX     A,@DPTR
005C52 24FD              ADD      A,#0FDH
005C54 6013              JZ       ?C0050?ZW_RF_DRIVER
005C56 04                INC      A
005C57 7008              JNZ      ?C0049?ZW_RF_DRIVER
005C59         ?C0047?ZW_RF_DRIVER:
005C59 900AB8            MOV      DPTR,#rfTxCurrentSpeedLocal
005C5C 7404              MOV      A,#04H
005C5E F0                MOVX     @DPTR,A
005C5F 800E              SJMP     ?C0046?ZW_RF_DRIVER
005C61         ?C0049?ZW_RF_DRIVER:
005C61 900AB8            MOV      DPTR,#rfTxCurrentSpeedLocal
005C64 7408              MOV      A,#08H
005C66 F0                MOVX     @DPTR,A
005C67 8006              SJMP     ?C0046?ZW_RF_DRIVER
005C69         ?C0050?ZW_RF_DRIVER:
005C69 900AB8            MOV      DPTR,#rfTxCurrentSpeedLocal
005C6C 7402              MOV      A,#02H
005C6E F0                MOVX     @DPTR,A
005C6F         ?C0046?ZW_RF_DRIVER:
005C6F 7F01              MOV      R7,#01H
005C71 121E67            LCALL    ?INTERBANK_TABLE?_ApplicationRfNotify
005C74         ?C0051?ZW_RF_DRIVER:
005C74 900ABA            MOV      DPTR,#txCh
005C77 E0                MOVX     A,@DPTR
005C78 FF                MOV      R7,A
005C79 900AB8            MOV      DPTR,#rfTxCurrentSpeedLocal
005C7C E0                MOVX     A,@DPTR
005C7D FD                MOV      R5,A
005C7E A3                INC      DPTR
005C7F E0                MOVX     A,@DPTR
005C80 FB                MOV      R3,A
005C81 E4                CLR      A
005C82 9043EA            MOV      DPTR,#?_RF_switch_to_TX?BYTE+03H
005C85 F0                MOVX     @DPTR,A
005C86 124EB2            LCALL    _RF_switch_to_TX
005C89 50E9              JNC      ?C0051?ZW_RF_DRIVER
005C8B         ?C0052?ZW_RF_DRIVER:
005C8B D3                SETB     C
005C8C 22                RET      
----- FUNCTION _RF_setup_tx_mode (END) -------


----- FUNCTION ?L?COM03F5 (BEGIN) -----
005C8D C8                XCH      A,R0
005C8E EC                MOV      A,R4
005C8F C8                XCH      A,R0
005C90 C9                XCH      A,R1
005C91 ED                MOV      A,R5
005C92 C9                XCH      A,R1
005C93 CA                XCH      A,R2
005C94 EE                MOV      A,R6
005C95 CA                XCH      A,R2
005C96 CB                XCH      A,R3
005C97 EF                MOV      A,R7
005C98 CB                XCH      A,R3
005C99 22                RET      
----- FUNCTION ?L?COM03F5 (END) -------


----- FUNCTION _Speed2Channel (BEGIN) -----
;---- Variable 'txCh' assigned to Register 'R6' ----
;---- Variable 'bSpeed' assigned to Register 'R7' ----
005C9A EF                MOV      A,R7
005C9B 24FD              ADD      A,#0FDH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 121


005C9D 6006              JZ       ?C0044?ZW_RF_DRIVER
005C9F 8000              SJMP     ?C0043?ZW_RF_DRIVER
005CA1         ?C0043?ZW_RF_DRIVER:
005CA1 7E01              MOV      R6,#01H
005CA3 8002              SJMP     ?C0040?ZW_RF_DRIVER
005CA5         ?C0044?ZW_RF_DRIVER:
005CA5 E4                CLR      A
005CA6 FE                MOV      R6,A
005CA7         ?C0040?ZW_RF_DRIVER:
005CA7 AF06              MOV      R7,AR6
005CA9 22                RET      
----- FUNCTION _Speed2Channel (END) -------


----- FUNCTION ?L?COM0297 (BEGIN) -----
005CAA 123F48            LCALL    _RF_channel_set
005CAD 43FA04            ORL      MODCTRL,#04H
005CB0         ?L?COM0298:
005CB0 E4                CLR      A
005CB1 F5FF              MOV      SFRPAGE,A
005CB3         ?L?COM0299:
005CB3 53D1FD            ANL      FHCON1,#0FDH
005CB6 43D101            ORL      FHCON1,#01H
005CB9 22                RET      
----- FUNCTION ?L?COM0297 (END) -------


----- FUNCTION _RFRxRestart (BEGIN) -----
005CBA C236              CLR      ?RF_demodulator_enable?BIT
005CBC 123E13            LCALL    RF_demodulator_enable
005CBF 1256D2            LCALL    ?L?COM0295
005CC2         ?C0077?ZW_RF_DRIVER:
005CC2 E5D1              MOV      A,FHCON1
005CC4 20E0FB            JB       ACC.0,?C0077?ZW_RF_DRIVER
005CC7         ?C0078?ZW_RF_DRIVER:
005CC7 E4                CLR      A
005CC8 F5FF              MOV      SFRPAGE,A
005CCA 75D901            MOV      FHINTLVL,#01H
005CCD 900938            MOV      DPTR,#rfRxCurrentSpeed
005CD0 E0                MOVX     A,@DPTR
005CD1 7F00              MOV      R7,#00H
005CD3 B40302            CJNE     A,#03H,?C0079?ZW_RF_DRIVER
005CD6 7F01              MOV      R7,#01H
005CD8         ?C0079?ZW_RF_DRIVER:
005CD8         ?C0080?ZW_RF_DRIVER:
;---- Variable 'bNextRFChannel' assigned to Register 'R7' ----
005CD8 91AA              ACALL    ?L?COM0297
005CDA D236              SETB     ?RF_demodulator_enable?BIT
005CDC 123E13            LCALL    RF_demodulator_enable
005CDF E4                CLR      A
005CE0 F510              MOV      demodState,A
005CE2 22                RET      
----- FUNCTION _RFRxRestart (END) -------


----- FUNCTION _ZW_SetDefaultPowerLevels (BEGIN) -----
;---- Variable 'bNormalPower0' assigned to Register 'R7' ----
005CE3 9003C9            MOV      DPTR,#bStartupState
005CE6 E0                MOVX     A,@DPTR
005CE7 B4020D            CJNE     A,#02H,?C0026?ZW_RF_DRIVER
005CEA 8F1B              MOV      normal_PA_POW,R7
005CEC 900A65            MOV      DPTR,#bLowPower0
005CEF E0                MOVX     A,@DPTR
005CF0 F513              MOV      low_PA_POW,A
005CF2 121A43            LCALL    ?INTERBANK_TABLE?_RFDriverPowerToIndex
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 122


005CF5 D3                SETB     C
005CF6 22                RET      
005CF7         ?C0026?ZW_RF_DRIVER:
005CF7 C3                CLR      C
005CF8 22                RET      
----- FUNCTION _ZW_SetDefaultPowerLevels (END) -------


----- FUNCTION _ZW_GetDefaultPowerLevels (BEGIN) -----
005CF9 900AB5            MOV      DPTR,#pPowerlevels
005CFC 122572            LCALL    ?C?PSTXDATA
005CFF 900AB5            MOV      DPTR,#pPowerlevels
005D02 122552            LCALL    ?C?PLDXDATA
005D05 E51B              MOV      A,normal_PA_POW
005D07 B12E              ACALL    ?L?COM0306
005D09 122552            LCALL    ?C?PLDXDATA
005D0C 1257E2            LCALL    ?L?COM0221
005D0F B12D              ACALL    ?L?COM0305
005D11 122552            LCALL    ?C?PLDXDATA
005D14 B147              ACALL    ?L?COM03C9
005D16 FA                MOV      R2,A
005D17 B12D              ACALL    ?L?COM0305
005D19 B14E              ACALL    ?L?COM00AF
005D1B E513              MOV      A,low_PA_POW
005D1D B12E              ACALL    ?L?COM0306
005D1F B135              ACALL    ?L?COM00E4
005D21 B12D              ACALL    ?L?COM0305
005D23 B140              ACALL    ?L?COM034F
005D25 F9                MOV      R1,A
005D26 E4                CLR      A
005D27 3A                ADDC     A,R2
005D28 FA                MOV      R2,A
005D29 E4                CLR      A
005D2A 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_GetDefaultPowerLevels (END) -------


----- FUNCTION ?L?COM0305 (BEGIN) -----
005D2D E4                CLR      A
005D2E         ?L?COM0306:
005D2E 12203B            LCALL    ?C?CSTPTR
005D31 900AB5            MOV      DPTR,#pPowerlevels
005D34 22                RET      
----- FUNCTION ?L?COM0305 (END) -------


----- FUNCTION ?L?COM00E4 (BEGIN) -----
005D35 122552            LCALL    ?C?PLDXDATA
005D38         ?L?COM00E5:
005D38 E9                MOV      A,R1
005D39         ?L?COM00E6:
005D39 2404              ADD      A,#04H
005D3B F9                MOV      R1,A
005D3C E4                CLR      A
005D3D 3A                ADDC     A,R2
005D3E FA                MOV      R2,A
005D3F 22                RET      
----- FUNCTION ?L?COM00E4 (END) -------


----- FUNCTION ?L?COM034F (BEGIN) -----
005D40 122552            LCALL    ?C?PLDXDATA
005D43 E9                MOV      A,R1
005D44 2405              ADD      A,#05H
005D46 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 123


----- FUNCTION ?L?COM034F (END) -------


----- FUNCTION ?L?COM03C9 (BEGIN) -----
005D47 E9                MOV      A,R1
005D48 2402              ADD      A,#02H
005D4A F9                MOV      R1,A
005D4B E4                CLR      A
005D4C 3A                ADDC     A,R2
005D4D 22                RET      
----- FUNCTION ?L?COM03C9 (END) -------


----- FUNCTION ?L?COM00AF (BEGIN) -----
005D4E 122552            LCALL    ?C?PLDXDATA
005D51         ?L?COM00B0:
005D51 E9                MOV      A,R1
005D52         ?L?COM00B1:
005D52 2403              ADD      A,#03H
005D54 F9                MOV      R1,A
005D55 E4                CLR      A
005D56 3A                ADDC     A,R2
005D57 FA                MOV      R2,A
005D58 22                RET      
----- FUNCTION ?L?COM00AF (END) -------


----- FUNCTION _RFPowerGetTxPwrReg_100 (BEGIN) -----
;---- Variable 'powerLevel' assigned to Register 'R7' ----
005D59 E517              MOV      A,powerIndex
005D5B 54F0              ANL      A,#0F0H
005D5D C4                SWAP     A
005D5E 540F              ANL      A,#0FH
005D60 2F                ADD      A,R7
005D61 FF                MOV      R7,A
;---- Variable 'i' assigned to Register 'R7' ----
005D62 C3                CLR      C
005D63 9410              SUBB     A,#010H
005D65 4002              JC       ?C0032?ZW_RF_DRIVER
005D67 7F0F              MOV      R7,#0FH
005D69         ?C0032?ZW_RF_DRIVER:
005D69 EF                MOV      A,R7
005D6A 902FD4            MOV      DPTR,#rf_power_table_100
005D6D 93                MOVC     A,@A+DPTR
005D6E FF                MOV      R7,A
005D6F 22                RET      
----- FUNCTION _RFPowerGetTxPwrReg_100 (END) -------


----- FUNCTION _RFPowerConvert (BEGIN) -----
;---- Variable 'power' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
005D70 7E10              MOV      R6,#010H
005D72         ?C0036?ZW_RF_DRIVER:
005D72 EE                MOV      A,R6
005D73 6009              JZ       ?C0037?ZW_RF_DRIVER
005D75 1E                DEC      R6
005D76 EE                MOV      A,R6
005D77 902FD4            MOV      DPTR,#rf_power_table_100
005D7A 93                MOVC     A,@A+DPTR
005D7B B507F4            CJNE     A,AR7,?C0036?ZW_RF_DRIVER
005D7E         ?C0037?ZW_RF_DRIVER:
005D7E EE                MOV      A,R6
005D7F C3                CLR      C
005D80 940E              SUBB     A,#0EH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 124


005D82 4002              JC       ?C0038?ZW_RF_DRIVER
005D84 7E0D              MOV      R6,#0DH
005D86         ?C0038?ZW_RF_DRIVER:
005D86 EE                MOV      A,R6
005D87 902FC6            MOV      DPTR,#rf_power_table
005D8A 93                MOVC     A,@A+DPTR
005D8B FF                MOV      R7,A
005D8C 22                RET      
----- FUNCTION _RFPowerConvert (END) -------


----- FUNCTION _RFSetStatus (BEGIN) -----
;---- Variable 'bitMask' assigned to Register 'R7' ----
005D8D C2AF              CLR      EA
005D8F EF                MOV      A,R7
005D90 4215              ORL      RF_status,A
005D92 D2AF              SETB     EA
005D94 22                RET      
----- FUNCTION _RFSetStatus (END) -------


----- FUNCTION _RFClearStatus (BEGIN) -----
;---- Variable 'bitMask' assigned to Register 'R7' ----
005D95 C2AF              CLR      EA
005D97 EF                MOV      A,R7
005D98 F4                CPL      A
005D99 5215              ANL      RF_status,A
005D9B D2AF              SETB     EA
005D9D 22                RET      
----- FUNCTION _RFClearStatus (END) -------


----- FUNCTION ?L?COM02F1 (BEGIN) -----
005D9E 7F02              MOV      R7,#02H
005DA0 B195              ACALL    _RFClearStatus
005DA2 9003C3            MOV      DPTR,#currentRxBuffer
005DA5 E0                MOVX     A,@DPTR
005DA6 9003C8            MOV      DPTR,#tmpMain
005DA9 F0                MOVX     @DPTR,A
005DAA 9003C3            MOV      DPTR,#currentRxBuffer
005DAD 04                INC      A
005DAE F0                MOVX     @DPTR,A
005DAF C3                CLR      C
005DB0 9402              SUBB     A,#02H
005DB2 22                RET      
----- FUNCTION ?L?COM02F1 (END) -------


----- FUNCTION _ConvertPhySpeedToRFSpeed (BEGIN) -----
;---- Variable 'bInSpeed' assigned to Register 'R7' ----
005DB3 EF                MOV      A,R7
005DB4 24FE              ADD      A,#0FEH
005DB6 600C              JZ       ?C0095?ZW_RF_DRIVER
005DB8 24FE              ADD      A,#0FEH
005DBA 6005              JZ       ?C0094?ZW_RF_DRIVER
005DBC 8000              SJMP     ?C0092?ZW_RF_DRIVER
005DBE         ?C0092?ZW_RF_DRIVER:
005DBE 7F01              MOV      R7,#01H
005DC0 22                RET      
005DC1         ?C0094?ZW_RF_DRIVER:
005DC1 7F02              MOV      R7,#02H
005DC3 22                RET      
005DC4         ?C0095?ZW_RF_DRIVER:
005DC4 7F03              MOV      R7,#03H
005DC6 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 125


----- FUNCTION _ConvertPhySpeedToRFSpeed (END) -------


----- FUNCTION _RFSetupBeamFragmentTX (BEGIN) -----
;---- Variable 'RF_Options' assigned to Register 'R4/R5' ----
;---- Variable 'bBeamAddress' assigned to Register 'R7' ----
005DC7 751401            MOV      RF_state,#01H
005DCA 751A13            MOV      RF_num,#013H
005DCD 90094C            MOV      DPTR,#bBeamDestAddress
005DD0 EF                MOV      A,R7
005DD1 F0                MOVX     @DPTR,A
005DD2 90093A            MOV      DPTR,#rfTxCurrentSpeed
005DD5 7402              MOV      A,#02H
005DD7 F0                MOVX     @DPTR,A
005DD8 ED                MOV      A,R5
005DD9 90095B            MOV      DPTR,#RF_BeamCount
005DDC 30E507            JNB      ACC.5,?C0096?ZW_RF_DRIVER
005DDF E4                CLR      A
005DE0 F0                MOVX     @DPTR,A
005DE1 A3                INC      DPTR
005DE2 743A              MOV      A,#03AH
005DE4 F0                MOVX     @DPTR,A
005DE5 22                RET      
005DE6         ?C0096?ZW_RF_DRIVER:
005DE6 E4                CLR      A
005DE7 F0                MOVX     @DPTR,A
005DE8 A3                INC      DPTR
005DE9 74E6              MOV      A,#0E6H
005DEB F0                MOVX     @DPTR,A
005DEC 22                RET      
----- FUNCTION _RFSetupBeamFragmentTX (END) -------


----- FUNCTION NS_IncTxFrames (BEGIN) -----
005DED B1F9              ACALL    ?L?COM03AC
005DEF 5007              JNC      ?C0104?ZW_RF_DRIVER
005DF1 E4                CLR      A
005DF2 75F001            MOV      B,#01H
005DF5 12210C            LCALL    ?C?IILDX
005DF8         ?C0104?ZW_RF_DRIVER:
005DF8 22                RET      
----- FUNCTION NS_IncTxFrames (END) -------


----- FUNCTION ?L?COM03AC (BEGIN) -----
005DF9 C3                CLR      C
005DFA 900940            MOV      DPTR,#sRFStats+01H
005DFD E0                MOVX     A,@DPTR
005DFE 94FF              SUBB     A,#0FFH
005E00 90093F            MOV      DPTR,#sRFStats
005E03 E0                MOVX     A,@DPTR
005E04 94FF              SUBB     A,#0FFH
005E06 22                RET      
----- FUNCTION ?L?COM03AC (END) -------


----- FUNCTION NS_IncLBTBackOffs (BEGIN) -----
005E07 C3                CLR      C
005E08 900942            MOV      DPTR,#sRFStats+03H
005E0B E0                MOVX     A,@DPTR
005E0C 94FF              SUBB     A,#0FFH
005E0E 900941            MOV      DPTR,#sRFStats+02H
005E11 E0                MOVX     A,@DPTR
005E12 94FF              SUBB     A,#0FFH
005E14 5007              JNC      ?C0106?ZW_RF_DRIVER
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 126


005E16 E4                CLR      A
005E17 75F001            MOV      B,#01H
005E1A 12210C            LCALL    ?C?IILDX
005E1D         ?C0106?ZW_RF_DRIVER:
005E1D 22                RET      
----- FUNCTION NS_IncLBTBackOffs (END) -------


----- FUNCTION RF_EnableFLiRSBroadcast (BEGIN) -----
005E1E 901215            MOV      DPTR,#bFLiRSStatus
005E21 E0                MOVX     A,@DPTR
005E22 302B04            JNB      bEnable,?C0216?ZW_RF_DRIVER
005E25 4402              ORL      A,#02H
005E27 F0                MOVX     @DPTR,A
005E28 22                RET      
005E29         ?C0216?ZW_RF_DRIVER:
005E29 54FD              ANL      A,#0FDH
005E2B F0                MOVX     @DPTR,A
005E2C 22                RET      
----- FUNCTION RF_EnableFLiRSBroadcast (END) -------


----- FUNCTION RF_GetBeamcount (BEGIN) -----
005E2D 90095B            MOV      DPTR,#RF_BeamCount
005E30 E0                MOVX     A,@DPTR
005E31 A3                INC      DPTR
005E32 E0                MOVX     A,@DPTR
005E33 FF                MOV      R7,A
005E34 22                RET      
----- FUNCTION RF_GetBeamcount (END) -------


----- FUNCTION _ZW_GetRandomArray (BEGIN) -----
005E35 900A85            MOV      DPTR,#pRandomArray
005E38 122572            LCALL    ?C?PSTXDATA
005E3B 900A88            MOV      DPTR,#bArrayByteCount
005E3E ED                MOV      A,R5
005E3F F0                MOVX     @DPTR,A
005E40 E4                CLR      A
005E41 A3                INC      DPTR
005E42 F0                MOVX     @DPTR,A
005E43 ED                MOV      A,R5
005E44 54FE              ANL      A,#0FEH
005E46 900A88            MOV      DPTR,#bArrayByteCount
005E49 F0                MOVX     @DPTR,A
005E4A 6030              JZ       ?C0220?ZW_RF_DRIVER
005E4C E4                CLR      A
005E4D FF                MOV      R7,A
005E4E 125006            LCALL    _ZW_SetRFReceiveMode
005E51 BF0128            CJNE     R7,#01H,?C0220?ZW_RF_DRIVER
005E54         ?C0223?ZW_RF_DRIVER:
005E54 900A85            MOV      DPTR,#pRandomArray
005E57 122552            LCALL    ?C?PLDXDATA
005E5A 124948            LCALL    _RF_get_random_word
005E5D 501D              JNC      ?C0220?ZW_RF_DRIVER
005E5F 900A86            MOV      DPTR,#pRandomArray+01H
005E62 E4                CLR      A
005E63 75F002            MOV      B,#02H
005E66 12210C            LCALL    ?C?IILDX
005E69 900A89            MOV      DPTR,#bByteGenerated
005E6C E0                MOVX     A,@DPTR
005E6D 2402              ADD      A,#02H
005E6F F0                MOVX     @DPTR,A
005E70         ?C0221?ZW_RF_DRIVER:
005E70 900A89            MOV      DPTR,#bByteGenerated
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 127


005E73 E0                MOVX     A,@DPTR
005E74 FF                MOV      R7,A
005E75 900A88            MOV      DPTR,#bArrayByteCount
005E78 E0                MOVX     A,@DPTR
005E79 6F                XRL      A,R7
005E7A 70D8              JNZ      ?C0223?ZW_RF_DRIVER
005E7C         ?C0220?ZW_RF_DRIVER:
005E7C 7F01              MOV      R7,#01H
005E7E 125006            LCALL    _ZW_SetRFReceiveMode
005E81 900A89            MOV      DPTR,#bByteGenerated
005E84 E0                MOVX     A,@DPTR
005E85 FF                MOV      R7,A
005E86 22                RET      
----- FUNCTION _ZW_GetRandomArray (END) -------


----- FUNCTION _ZW_GetRandomWord (BEGIN) -----
;---- Variable 'randomWord' assigned to Register 'R1/R2/R3' ----
005E87 7D02              MOV      R5,#02H
005E89 D135              ACALL    _ZW_GetRandomArray
005E8B EF                MOV      A,R7
005E8C C3                CLR      C
005E8D 6001              JZ       ?C0227?ZW_RF_DRIVER
005E8F D3                SETB     C
005E90         ?C0227?ZW_RF_DRIVER:
005E90 22                RET      
----- FUNCTION _ZW_GetRandomWord (END) -------


----- FUNCTION ZW_ClearTxTimers (BEGIN) -----
005E91 E4                CLR      A
005E92 FF                MOV      R7,A
005E93 FE                MOV      R6,A
005E94 90094D            MOV      DPTR,#awTxTimeChannels
005E97 D1A6              ACALL    ?L?COM04DD
005E99 900951            MOV      DPTR,#awTxTimeChannels+04H
005E9C D1A6              ACALL    ?L?COM04DD
005E9E FD                MOV      R5,A
005E9F FC                MOV      R4,A
005EA0 900955            MOV      DPTR,#awTxTimeChannels+08H
005EA3 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ZW_ClearTxTimers (END) -------


----- FUNCTION ?L?COM04DD (BEGIN) -----
005EA6 FD                MOV      R5,A
005EA7 FC                MOV      R4,A
005EA8 1224BA            LCALL    ?C?LSTXDATA
005EAB E4                CLR      A
005EAC FF                MOV      R7,A
005EAD FE                MOV      R6,A
005EAE 22                RET      
----- FUNCTION ?L?COM04DD (END) -------


----- FUNCTION _ZW_GetTxTimer (BEGIN) -----
;---- Variable 'dwValue' assigned to Register 'R1/R2/R3' ----
;---- Variable 'bChannel' assigned to Register 'R7' ----
005EAF EF                MOV      A,R7
005EB0 D1B8              ACALL    ?L?COM03AA
005EB2 122462            LCALL    ?C?LLDXDATA
005EB5 022424            LJMP     ?C?LSTPTR
----- FUNCTION _ZW_GetTxTimer (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 128


----- FUNCTION ?L?COM03AA (BEGIN) -----
005EB8 25E0              ADD      A,ACC
005EBA 25E0              ADD      A,ACC
005EBC 244D              ADD      A,#LOW awTxTimeChannels
005EBE F582              MOV      DPL,A
005EC0 E4                CLR      A
005EC1 3409              ADDC     A,#HIGH awTxTimeChannels
005EC3 F583              MOV      DPH,A
005EC5 22                RET      
----- FUNCTION ?L?COM03AA (END) -------


----- FUNCTION ZW_ClearNetworkStats (BEGIN) -----
005EC6 A2EB              MOV      C,ERF
005EC8 922C              MOV      tmpERF,C
005ECA C2EB              CLR      ERF
005ECC 7A09              MOV      R2,#HIGH sRFStats
005ECE 793F              MOV      R1,#LOW sRFStats
005ED0 7B01              MOV      R3,#01H
005ED2 7D0C              MOV      R5,#0CH
005ED4 E4                CLR      A
005ED5 FF                MOV      R7,A
005ED6 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
005ED9 A22C              MOV      C,tmpERF
005EDB 92EB              MOV      ERF,C
005EDD 22                RET      
----- FUNCTION ZW_ClearNetworkStats (END) -------


----- FUNCTION _ZW_GetNetworkStats (BEGIN) -----
;---- Variable 'sNetworkStats' assigned to Register 'R1/R2/R3' ----
005EDE A2EB              MOV      C,ERF
005EE0 922D              MOV      tmpERF,C
005EE2 C2EB              CLR      ERF
005EE4 EB                MOV      A,R3
005EE5 C0E0              PUSH     ACC
005EE7 EA                MOV      A,R2
005EE8 C0E0              PUSH     ACC
005EEA E9                MOV      A,R1
005EEB C0E0              PUSH     ACC
005EED 7B01              MOV      R3,#01H
005EEF 7A09              MOV      R2,#HIGH sRFStats
005EF1 793F              MOV      R1,#LOW sRFStats
005EF3 904423            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
005EF6 122572            LCALL    ?C?PSTXDATA
005EF9 D0E0              POP      ACC
005EFB F9                MOV      R1,A
005EFC D0E0              POP      ACC
005EFE FA                MOV      R2,A
005EFF D0E0              POP      ACC
005F01 FB                MOV      R3,A
005F02 7F0C              MOV      R7,#0CH
005F04 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
005F07 A22D              MOV      C,tmpERF
005F09 92EB              MOV      ERF,C
005F0B 22                RET      
----- FUNCTION _ZW_GetNetworkStats (END) -------


----- FUNCTION ?L?COM042D (BEGIN) -----
005F0C 7F01              MOV      R7,#01H
005F0E 7E00              MOV      R6,#00H
----- FUNCTION _ZW_BootIsSupported (BEGIN) -----
;---- Variable 'wSupportedCapability' assigned to Register 'R6/R7' ----
005F10 9017FC            MOV      DPTR,#sBootCapabilities+02H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 129


005F13 E4                CLR      A
005F14 93                MOVC     A,@A+DPTR
005F15 5E                ANL      A,R6
005F16 FE                MOV      R6,A
005F17 7401              MOV      A,#01H
005F19 93                MOVC     A,@A+DPTR
005F1A 5F                ANL      A,R7
005F1B 4E                ORL      A,R6
005F1C 24FF              ADD      A,#0FFH
005F1E B3                CPL      C
005F1F 22                RET      
----- FUNCTION _ZW_BootIsSupported (END) -------


----- FUNCTION ZW_BootloaderPresent (BEGIN) -----
005F20 900001            MOV      DPTR,#01H
005F23 7401              MOV      A,#01H
005F25 93                MOVC     A,@A+DPTR
005F26 B40007            CJNE     A,#00H,?C0002?ZW_BOOTLOADER_CAPABILITIES
005F29 E4                CLR      A
005F2A 93                MOVC     A,@A+DPTR
005F2B B41802            CJNE     A,#018H,?C0002?ZW_BOOTLOADER_CAPABILITIES
005F2E C3                CLR      C
005F2F 22                RET      
005F30         ?C0002?ZW_BOOTLOADER_CAPABILITIES:
005F30 D3                SETB     C
005F31 22                RET      
----- FUNCTION ZW_BootloaderPresent (END) -------


----- FUNCTION NetworkManagementSmartStartIsInclude (BEGIN) -----
005F32 901217            MOV      DPTR,#eSystemTypeState
005F35 E0                MOVX     A,@DPTR
005F36 5414              ANL      A,#014H
005F38 FF                MOV      R7,A
005F39 BF1404            CJNE     R7,#014H,?C0007?ZW_NETWORK_MANAGEMENT
005F3C 7F01              MOV      R7,#01H
005F3E 8002              SJMP     ?C0008?ZW_NETWORK_MANAGEMENT
005F40         ?C0007?ZW_NETWORK_MANAGEMENT:
005F40 7F00              MOV      R7,#00H
005F42         ?C0008?ZW_NETWORK_MANAGEMENT:
005F42 22                RET      
----- FUNCTION NetworkManagementSmartStartIsInclude (END) -------


----- FUNCTION NetworkManagementSmartStartIsListeningNode (BEGIN) -----
005F43 901217            MOV      DPTR,#eSystemTypeState
005F46 E0                MOVX     A,@DPTR
005F47 7F00              MOV      R7,#00H
005F49 30E002            JNB      ACC.0,?C0010?ZW_NETWORK_MANAGEMENT
005F4C 7F01              MOV      R7,#01H
005F4E         ?C0010?ZW_NETWORK_MANAGEMENT:
005F4E 22                RET      
----- FUNCTION NetworkManagementSmartStartIsListeningNode (END) -------


----- FUNCTION NetworkManagementLearnActive (BEGIN) -----
005F4F 9041DE            MOV      DPTR,#learnState
005F52 E0                MOVX     A,@DPTR
005F53 B4040D            CJNE     A,#04H,?C0071?ZW_NETWORK_MANAGEMENT
005F56 9041E3            MOV      DPTR,#learnStateHandle
005F59 E0                MOVX     A,@DPTR
005F5A 6007              JZ       ?C0071?ZW_NETWORK_MANAGEMENT
005F5C F143              ACALL    NetworkManagementSmartStartIsListeningNode
005F5E EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 130


005F5F 7002              JNZ      ?C0071?ZW_NETWORK_MANAGEMENT
005F61 FF                MOV      R7,A
005F62 22                RET      
005F63         ?C0071?ZW_NETWORK_MANAGEMENT:
005F63 9041DE            MOV      DPTR,#learnState
005F66 E0                MOVX     A,@DPTR
005F67 FF                MOV      R7,A
005F68 22                RET      
----- FUNCTION NetworkManagementLearnActive (END) -------


----- FUNCTION NetworkManagementSmartStartCurrentRequestNo (BEGIN) -----
005F69 901217            MOV      DPTR,#eSystemTypeState
005F6C E0                MOVX     A,@DPTR
005F6D C4                SWAP     A
005F6E 13                RRC      A
005F6F 5407              ANL      A,#07H
005F71 FF                MOV      R7,A
005F72 22                RET      
----- FUNCTION NetworkManagementSmartStartCurrentRequestNo (END) -------


----- FUNCTION NetworkManagementGenerateDskpart (BEGIN) -----
005F73 903334            MOV      DPTR,#Dsk+08H
005F76 E0                MOVX     A,@DPTR
005F77 7009              JNZ      ?C0069?ZW_NETWORK_MANAGEMENT
005F79 7B01              MOV      R3,#01H
005F7B 7A33              MOV      R2,#HIGH Dsk
005F7D 792C              MOV      R1,#LOW Dsk
005F7F 121AED            LCALL    ?INTERBANK_TABLE?_keystore_public_dsk_read
005F82         ?C0069?ZW_NETWORK_MANAGEMENT:
005F82 903334            MOV      DPTR,#Dsk+08H
005F85 E0                MOVX     A,@DPTR
005F86 44C0              ORL      A,#0C0H
005F88 F0                MOVX     @DPTR,A
005F89 903337            MOV      DPTR,#Dsk+0BH
005F8C E0                MOVX     A,@DPTR
005F8D 54FE              ANL      A,#0FEH
005F8F F0                MOVX     @DPTR,A
005F90 A3                INC      DPTR
005F91 E0                MOVX     A,@DPTR
005F92 44C0              ORL      A,#0C0H
005F94 F0                MOVX     @DPTR,A
005F95 90333B            MOV      DPTR,#Dsk+0FH
005F98 E0                MOVX     A,@DPTR
005F99 54FE              ANL      A,#0FEH
005F9B F0                MOVX     @DPTR,A
005F9C 22                RET      
----- FUNCTION NetworkManagementGenerateDskpart (END) -------


----- FUNCTION _ZW_NetworkManagementSetMaxInclusionRequestIntervals (BEGIN) -----
;---- Variable 'bInclRequestIntervals' assigned to Register 'R7' ----
005F9D 7405              MOV      A,#05H
005F9F D3                SETB     C
005FA0 9F                SUBB     A,R7
005FA1 500B              JNC      ?C0074?ZW_NETWORK_MANAGEMENT
005FA3 7463              MOV      A,#063H
005FA5 C3                CLR      C
005FA6 9F                SUBB     A,R7
005FA7 4005              JC       ?C0074?ZW_NETWORK_MANAGEMENT
005FA9 9041E1            MOV      DPTR,#bInclusionRequestIntervals
005FAC EF                MOV      A,R7
005FAD F0                MOVX     @DPTR,A
005FAE         ?C0074?ZW_NETWORK_MANAGEMENT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 131


005FAE 9041E1            MOV      DPTR,#bInclusionRequestIntervals
005FB1 E0                MOVX     A,@DPTR
005FB2 FF                MOV      R7,A
005FB3 22                RET      
----- FUNCTION _ZW_NetworkManagementSetMaxInclusionRequestIntervals (END) -------


----- FUNCTION _ZW_SetExtIntLevel (BEGIN) -----
;---- Variable 'triggerLevel' assigned to Register 'R5' ----
;---- Variable 'intSrc' assigned to Register 'R7' ----
005FB4 8007              SJMP     _ZW_INT_ext_level_set
----- FUNCTION _ZW_SetExtIntLevel (END) -------


----- FUNCTION ?L?COM0447 (BEGIN) -----
005FB6 901249            MOV      DPTR,#extInt1TrigLvl
005FB9 E0                MOVX     A,@DPTR
005FBA FD                MOV      R5,A
005FBB 7F01              MOV      R7,#01H
----- FUNCTION _ZW_INT_ext_level_set (BEGIN) -----
;---- Variable 'triggerLevel' assigned to Register 'R5' ----
;---- Variable 'intSrc' assigned to Register 'R7' ----
005FBD EF                MOV      A,R7
005FBE 7011              JNZ      ?C0002?ZW_PHY_050X
005FC0 ED                MOV      A,R5
005FC1 6007              JZ       ?C0003?ZW_PHY_050X
005FC3 75FF01            MOV      SFRPAGE,#01H
005FC6 43AE01            ORL      INTCON,#01H
005FC9 22                RET      
005FCA         ?C0003?ZW_PHY_050X:
005FCA 75FF01            MOV      SFRPAGE,#01H
005FCD 53AEFE            ANL      INTCON,#0FEH
005FD0 22                RET      
005FD1         ?C0002?ZW_PHY_050X:
005FD1 EF                MOV      A,R7
005FD2 B40114            CJNE     A,#01H,?C0009?ZW_PHY_050X
005FD5 901249            MOV      DPTR,#extInt1TrigLvl
005FD8 ED                MOV      A,R5
005FD9 F0                MOVX     @DPTR,A
005FDA 6007              JZ       ?C0007?ZW_PHY_050X
005FDC 75FF01            MOV      SFRPAGE,#01H
005FDF 43AE02            ORL      INTCON,#02H
005FE2 22                RET      
005FE3         ?C0007?ZW_PHY_050X:
005FE3 75FF01            MOV      SFRPAGE,#01H
005FE6 53AEFD            ANL      INTCON,#0FDH
005FE9         ?C0009?ZW_PHY_050X:
005FE9 22                RET      
----- FUNCTION _ZW_INT_ext_level_set (END) -------


----- FUNCTION Reset_GetReset (BEGIN) -----
005FEA 75FF02            MOV      SFRPAGE,#02H
005FED E5E6              MOV      A,RSETVEC
005FEF 30E203            JNB      ACC.2,?C0010?ZW_PHY_050X
005FF2 7F03              MOV      R7,#03H
005FF4 22                RET      
005FF5         ?C0010?ZW_PHY_050X:
005FF5 E5E6              MOV      A,RSETVEC
005FF7 30E303            JNB      ACC.3,?C0013?ZW_PHY_050X
005FFA 7F00              MOV      R7,#00H
005FFC 22                RET      
005FFD         ?C0013?ZW_PHY_050X:
005FFD E5E6              MOV      A,RSETVEC
005FFF 30E103            JNB      ACC.1,?C0015?ZW_PHY_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 132


006002 7F04              MOV      R7,#04H
006004 22                RET      
006005         ?C0015?ZW_PHY_050X:
006005 E5E6              MOV      A,RSETVEC
006007 7F05              MOV      R7,#05H
006009 30E002            JNB      ACC.0,?C0017?ZW_PHY_050X
00600C 7F01              MOV      R7,#01H
00600E         ?C0017?ZW_PHY_050X:
00600E 22                RET      
----- FUNCTION Reset_GetReset (END) -------


----- FUNCTION _ZW_IOS_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
00600F EF                MOV      A,R7
006010 6007              JZ       ?C0019?ZW_PHY_050X
006012 75FF02            MOV      SFRPAGE,#02H
006015 53E6BF            ANL      RSETVEC,#0BFH
006018 22                RET      
006019         ?C0019?ZW_PHY_050X:
006019 75FF02            MOV      SFRPAGE,#02H
00601C 43E640            ORL      RSETVEC,#040H
00601F 22                RET      
----- FUNCTION _ZW_IOS_enable (END) -------


----- FUNCTION _ZW_IOS_set (BEGIN) -----
;---- Variable 'bPort' assigned to Register 'R7' ----
;---- Variable 'bValue' assigned to Register 'R3' ----
;---- Variable 'bDirection' assigned to Register 'R5' ----
006020 EF                MOV      A,R7
006021 14                DEC      A
006022 600F              JZ       ?C0024?ZW_PHY_050X
006024 14                DEC      A
006025 6014              JZ       ?C0025?ZW_PHY_050X
006027 2402              ADD      A,#02H
006029 7018              JNZ      ?C0026?ZW_PHY_050X
00602B         ?C0023?ZW_PHY_050X:
00602B 8B80              MOV      P0,R3
00602D 75FF01            MOV      SFRPAGE,#01H
006030 8DFD              MOV      P0DIR,R5
006032 22                RET      
006033         ?C0024?ZW_PHY_050X:
006033 8B90              MOV      P1,R3
006035 75FF01            MOV      SFRPAGE,#01H
006038 8DC9              MOV      P1DIR,R5
00603A 22                RET      
00603B         ?C0025?ZW_PHY_050X:
00603B 8BA0              MOV      P2,R3
00603D 75FF01            MOV      SFRPAGE,#01H
006040 8DCA              MOV      P2DIR,R5
006042 22                RET      
006043         ?C0026?ZW_PHY_050X:
006043 AF03              MOV      R7,AR3
006045 8FB0              MOV      P3,R7
006047 75FF01            MOV      SFRPAGE,#01H
00604A AF05              MOV      R7,AR5
00604C 8FCB              MOV      P3DIR,R7
00604E 22                RET      
----- FUNCTION _ZW_IOS_set (END) -------


----- FUNCTION _ZW_IOS_get (BEGIN) -----
00604F 9043E1            MOV      DPTR,#bDirection
006052 122572            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 133


;---- Variable 'bPort' assigned to Register 'R7' ----
006055 EF                MOV      A,R7
006056 14                DEC      A
006057 6011              JZ       ?C0030?ZW_PHY_050X
006059 14                DEC      A
00605A 6018              JZ       ?C0031?ZW_PHY_050X
00605C 2402              ADD      A,#02H
00605E 701E              JNZ      ?C0032?ZW_PHY_050X
006060         ?C0029?ZW_PHY_050X:
006060 1189              ACALL    ?L?COM03FB
006062 E580              MOV      A,P0
006064 118F              ACALL    ?L?COM021C
006066 E5FD              MOV      A,P0DIR
006068 801C              SJMP     ?C0038?ZW_PHY_050X
00606A         ?C0030?ZW_PHY_050X:
00606A 1189              ACALL    ?L?COM03FB
00606C E590              MOV      A,P1
00606E 118F              ACALL    ?L?COM021C
006070 E5C9              MOV      A,P1DIR
006072         
006072 8012              SJMP     ?C0038?ZW_PHY_050X
006074         ?C0031?ZW_PHY_050X:
006074 1189              ACALL    ?L?COM03FB
006076 E5A0              MOV      A,P2
006078 118F              ACALL    ?L?COM021C
00607A E5CA              MOV      A,P2DIR
00607C         
00607C 8008              SJMP     ?C0038?ZW_PHY_050X
00607E         ?C0032?ZW_PHY_050X:
00607E 1189              ACALL    ?L?COM03FB
006080 E5B0              MOV      A,P3
006082 118F              ACALL    ?L?COM021C
006084 E5CB              MOV      A,P3DIR
006086         
006086 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_IOS_get (END) -------


----- FUNCTION ?L?COM03FB (BEGIN) -----
006089 9043E4            MOV      DPTR,#bValue
00608C 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03FB (END) -------


----- FUNCTION ?L?COM021C (BEGIN) -----
00608F 12203B            LCALL    ?C?CSTPTR
006092 75FF01            MOV      SFRPAGE,#01H
006095 9043E1            MOV      DPTR,#bDirection
006098 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM021C (END) -------


----- FUNCTION ZW_CHIP_type_get (BEGIN) -----
00609B E4                CLR      A
00609C F5FF              MOV      SFRPAGE,A
00609E AF91              MOV      R7,CHTYPE
0060A0 22                RET      
----- FUNCTION ZW_CHIP_type_get (END) -------


----- FUNCTION ZW_CHIP_revision_get (BEGIN) -----
0060A1 E4                CLR      A
0060A2 F5FF              MOV      SFRPAGE,A
0060A4 AF92              MOV      R7,CHREV
0060A6 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 134


----- FUNCTION ZW_CHIP_revision_get (END) -------


----- FUNCTION _set_phy_timer_timeout (BEGIN) -----
;---- Variable 'timeout' assigned to Register 'R6/R7' ----
0060A7 75FF03            MOV      SFRPAGE,#03H
0060AA D3                SETB     C
0060AB EF                MOV      A,R7
0060AC 9402              SUBB     A,#02H
0060AE EE                MOV      A,R6
0060AF 9400              SUBB     A,#00H
0060B1 4008              JC       ?C0003?ZW_PHY_RF_050X
0060B3 74FE              MOV      A,#0FEH
0060B5 2F                ADD      A,R7
0060B6 FF                MOV      R7,A
0060B7 74FF              MOV      A,#0FFH
0060B9 3E                ADDC     A,R6
0060BA FE                MOV      R6,A
0060BB         ?C0003?ZW_PHY_RF_050X:
0060BB EF                MOV      A,R7
0060BC F592              MOV      PHYTCON2,A
0060BE EE                MOV      A,R6
0060BF 540F              ANL      A,#0FH
0060C1 F591              MOV      PHYTCON1,A
0060C3 22                RET      
----- FUNCTION _set_phy_timer_timeout (END) -------


----- FUNCTION ?L?COM0341 (BEGIN) -----
0060C4 C220              CLR      ?RF_sensor_mode_enable?BIT
0060C6 E4                CLR      A
0060C7 9045D0            MOV      DPTR,#?RF_sensor_mode_enable?BYTE
0060CA F0                MOVX     @DPTR,A
0060CB C221              CLR      ?RF_sensor_mode_enable?BIT+01H
0060CD A3                INC      DPTR
0060CE F0                MOVX     @DPTR,A
0060CF A3                INC      DPTR
0060D0 F0                MOVX     @DPTR,A
----- FUNCTION RF_sensor_mode_enable (BEGIN) -----
;---- Variable 'rssi_threshold' assigned to Register 'R5' ----
0060D1 75FF01            MOV      SFRPAGE,#01H
0060D4 E5D5              MOV      A,RFCON
0060D6 20E702            JB       ACC.7,?C0237?ZW_PHY_RF_050X
0060D9 C3                CLR      C
0060DA 22                RET      
0060DB         ?C0237?ZW_PHY_RF_050X:
0060DB C237              CLR      ?RF_demodulator_enable_fast?BIT
0060DD 3182              ACALL    RF_demodulator_enable_fast
0060DF 202002            JB       enable,$ + 5H
0060E2 2174              AJMP     ?C0239?ZW_PHY_RF_050X
0060E4 53F4DF            ANL      DMCTRL,#0DFH
0060E7 9045D0            MOV      DPTR,#bChannel
0060EA E0                MOVX     A,@DPTR
0060EB FF                MOV      R7,A
0060EC 123F48            LCALL    _RF_channel_set
0060EF 9124              ACALL    ?L?COM04D3
0060F1 302105            JNB      enable_timeout,?C0240?ZW_PHY_RF_050X
0060F4 43F440            ORL      DMCTRL,#040H
0060F7 8003              SJMP     ?C0241?ZW_PHY_RF_050X
0060F9         ?C0240?ZW_PHY_RF_050X:
0060F9 53F4BF            ANL      DMCTRL,#0BFH
0060FC         ?C0241?ZW_PHY_RF_050X:
0060FC E4                CLR      A
0060FD F5FF              MOV      SFRPAGE,A
0060FF 53F5F0            ANL      DMSETUP2,#0F0H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 135


006102 9045D1            MOV      DPTR,#timeout
006105 E0                MOVX     A,@DPTR
006106 FA                MOV      R2,A
006107 A3                INC      DPTR
006108 E0                MOVX     A,@DPTR
006109 FB                MOV      R3,A
00610A EA                MOV      A,R2
00610B 42F5              ORL      DMSETUP2,A
00610D EB                MOV      A,R3
00610E F5F6              MOV      DMSETUP3,A
006110 D237              SETB     ?RF_demodulator_enable_fast?BIT
006112 3182              ACALL    RF_demodulator_enable_fast
006114 123F3A            LCALL    ?L?COM022F
006117         ?C0244?ZW_PHY_RF_050X:
006117 E4                CLR      A
006118 F5FF              MOV      SFRPAGE,A
00611A E593              MOV      A,SEQCON2
00611C 20E605            JB       ACC.6,?C0243?ZW_PHY_RF_050X
00611F 123F2F            LCALL    phy_timer_runs
006122 40F3              JC       ?C0244?ZW_PHY_RF_050X
006124         ?C0243?ZW_PHY_RF_050X:
006124 302159            JNB      enable_timeout,?C0258?ZW_PHY_RF_050X
006127 E5F4              MOV      A,DMCTRL
006129 30E304            JNB      ACC.3,?C0247?ZW_PHY_RF_050X
00612C 7D28              MOV      R5,#028H
00612E 8010              SJMP     ?C0248?ZW_PHY_RF_050X
006130         ?C0247?ZW_PHY_RF_050X:
006130 E5F4              MOV      A,DMCTRL
006132 30E204            JNB      ACC.2,?C0249?ZW_PHY_RF_050X
006135 7D28              MOV      R5,#028H
006137 8007              SJMP     ?C0248?ZW_PHY_RF_050X
006139         ?C0249?ZW_PHY_RF_050X:
006139 E5F4              MOV      A,DMCTRL
00613B 30E102            JNB      ACC.1,?C0248?ZW_PHY_RF_050X
00613E 7D28              MOV      R5,#028H
006140         ?C0248?ZW_PHY_RF_050X:
006140 12575D            LCALL    stop_phy_timer
006143 7F28              MOV      R7,#028H
006145 123F3C            LCALL    ?L?COM0230
006148         ?C0252?ZW_PHY_RF_050X:
006148 123F2F            LCALL    phy_timer_runs
00614B 40FB              JC       ?C0252?ZW_PHY_RF_050X
00614D         ?C0253?ZW_PHY_RF_050X:
00614D 7F78              MOV      R7,#078H
00614F 123F3C            LCALL    ?L?COM0230
006152         ?C0254?ZW_PHY_RF_050X:
006152 123F2F            LCALL    phy_timer_runs
006155 5029              JNC      ?C0258?ZW_PHY_RF_050X
006157 31A3              ACALL    _rssi_rdy
006159 50F7              JNC      ?C0254?ZW_PHY_RF_050X
00615B 31CA              ACALL    _instant_rssi
00615D EF                MOV      A,R7
00615E C3                CLR      C
00615F 9D                SUBB     A,R5
006160 50F0              JNC      ?C0254?ZW_PHY_RF_050X
006162 31A3              ACALL    _rssi_rdy
006164 50EC              JNC      ?C0254?ZW_PHY_RF_050X
006166 E5F7              MOV      A,DMSTAT1
006168 20E5E7            JB       ACC.5,?C0254?ZW_PHY_RF_050X
00616B C237              CLR      ?RF_demodulator_enable_fast?BIT
00616D 3182              ACALL    RF_demodulator_enable_fast
00616F 12575D            LCALL    stop_phy_timer
006172 80DE              SJMP     ?C0254?ZW_PHY_RF_050X
006174         ?C0239?ZW_PHY_RF_050X:
006174 53F4BF            ANL      DMCTRL,#0BFH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 136


006177 B193              ACALL    ?L?COM02F0
006179 4005              JC       ?C0258?ZW_PHY_RF_050X
00617B 43F420            ORL      DMCTRL,#020H
00617E 911D              ACALL    ?L?COM04D2
006180         ?C0258?ZW_PHY_RF_050X:
006180 D3                SETB     C
006181 22                RET      
----- FUNCTION RF_sensor_mode_enable (END) -------


----- FUNCTION RF_demodulator_enable_fast (BEGIN) -----
;---- Variable 'setting' assigned to Register 'R7' ----
006182 AFF4              MOV      R7,DMCTRL
006184 EF                MOV      A,R7
006185 547F              ANL      A,#07FH
006187 F5F4              MOV      DMCTRL,A
006189 303705            JNB      enable,?C0205?ZW_PHY_RF_050X
00618C EF                MOV      A,R7
00618D 4480              ORL      A,#080H
00618F F5F4              MOV      DMCTRL,A
006191         ?C0205?ZW_PHY_RF_050X:
006191 75FF01            MOV      SFRPAGE,#01H
006194 E5D5              MOV      A,RFCON
006196 20E702            JB       ACC.7,?C0206?ZW_PHY_RF_050X
006199 C3                CLR      C
00619A 22                RET      
00619B         ?C0206?ZW_PHY_RF_050X:
00619B E5F4              MOV      A,DMCTRL
00619D D3                SETB     C
00619E 30E601            JNB      ACC.6,?C0208?ZW_PHY_RF_050X
0061A1 C3                CLR      C
0061A2         ?C0208?ZW_PHY_RF_050X:
0061A2 22                RET      
----- FUNCTION RF_demodulator_enable_fast (END) -------


----- FUNCTION _rssi_rdy (BEGIN) -----
0061A3 75FF01            MOV      SFRPAGE,#01H
0061A6 E5E4              MOV      A,SDCON1
0061A8 33                RLC      A
0061A9 22                RET      
----- FUNCTION _rssi_rdy (END) -------


----- FUNCTION RF_instant_rssi_get (BEGIN) -----
;---- Variable 'temp' assigned to Register 'R7' ----
0061AA E4                CLR      A
0061AB FF                MOV      R7,A
0061AC E5F7              MOV      A,DMSTAT1
0061AE 54C0              ANL      A,#0C0H
0061B0 6002              JZ       ?C0235?ZW_PHY_RF_050X
0061B2 8016              SJMP     _instant_rssi
0061B4         ?C0235?ZW_PHY_RF_050X:
0061B4 75FF01            MOV      SFRPAGE,#01H
0061B7 E5D5              MOV      A,RFCON
0061B9 30E30D            JNB      ACC.3,?C0232?ZW_PHY_RF_050X
0061BC 31A3              ACALL    _rssi_rdy
0061BE 50F4              JNC      ?C0235?ZW_PHY_RF_050X
0061C0 31CA              ACALL    _instant_rssi
0061C2 EF                MOV      A,R7
0061C3 60EF              JZ       ?C0235?ZW_PHY_RF_050X
0061C5 31A3              ACALL    _rssi_rdy
0061C7 50EB              JNC      ?C0235?ZW_PHY_RF_050X
0061C9         ?C0232?ZW_PHY_RF_050X:
0061C9 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 137


----- FUNCTION RF_instant_rssi_get (END) -------


----- FUNCTION _instant_rssi (BEGIN) -----
0061CA B16A              ACALL    ?L?COM04D1
0061CC AFD9              MOV      R7,DFSTAT
0061CE 22                RET      
----- FUNCTION _instant_rssi (END) -------


----- FUNCTION _wait_phy_timer_elapse (BEGIN) -----
;---- Variable 'time_elapse' assigned to Register 'R4/R5' ----
0061CF CD                XCH      A,R5
0061D0 EF                MOV      A,R7
0061D1 CD                XCH      A,R5
0061D2 CC                XCH      A,R4
0061D3 EE                MOV      A,R6
0061D4 CC                XCH      A,R4
0061D5 510C              ACALL    ?L?COM033F
0061D7 AB94              MOV      R3,PHYTSL
0061D9 EF                MOV      A,R7
0061DA 4B                ORL      A,R3
0061DB 9179              ACALL    ?L?COM0597
;---- Variable 'time_now' assigned to Register 'R2/R3' ----
0061DD CB                XCH      A,R3
0061DE EF                MOV      A,R7
0061DF CB                XCH      A,R3
0061E0 FA                MOV      R2,A
0061E1         ?C0014?ZW_PHY_RF_050X:
0061E1 E591              MOV      A,PHYTCON1
0061E3 30E718            JNB      ACC.7,?C0015?ZW_PHY_RF_050X
0061E6 510F              ACALL    ?L?COM0340
0061E8 A994              MOV      R1,PHYTSL
0061EA E9                MOV      A,R1
0061EB F582              MOV      DPL,A
0061ED EF                MOV      A,R7
0061EE 4582              ORL      A,DPL
0061F0 FF                MOV      R7,A
0061F1 EB                MOV      A,R3
0061F2 B146              ACALL    ?L?COM054B
0061F4 C3                CLR      C
0061F5 EF                MOV      A,R7
0061F6 9582              SUBB     A,DPL
0061F8 E5F0              MOV      A,B
0061FA 9583              SUBB     A,DPH
0061FC 40E3              JC       ?C0014?ZW_PHY_RF_050X
0061FE         ?C0015?ZW_PHY_RF_050X:
0061FE E591              MOV      A,PHYTCON1
006200 20E708            JB       ACC.7,?C0017?ZW_PHY_RF_050X
006203 CE                XCH      A,R6
006204 EC                MOV      A,R4
006205 CE                XCH      A,R6
006206 CF                XCH      A,R7
006207 ED                MOV      A,R5
006208 CF                XCH      A,R7
006209 512D              ACALL    ?L?COM00F7
00620B         ?C0017?ZW_PHY_RF_050X:
00620B 22                RET      
----- FUNCTION _wait_phy_timer_elapse (END) -------


----- FUNCTION ?L?COM033F (BEGIN) -----
00620C 75FF03            MOV      SFRPAGE,#03H
00620F         ?L?COM0340:
00620F AF93              MOV      R7,PHYTSH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 138


006211 EF                MOV      A,R7
006212 75F010            MOV      B,#010H
006215 A4                MUL      AB
006216 FF                MOV      R7,A
006217 22                RET      
----- FUNCTION ?L?COM033F (END) -------


----- FUNCTION ?L?COM00F4 (BEGIN) -----
006218 E4                CLR      A
006219 F5FF              MOV      SFRPAGE,A
00621B 758EC8            MOV      DPLLSMCON,#0C8H
00621E 51E9              ACALL    _PLL_boost_bias
006220 75FF01            MOV      SFRPAGE,#01H
006223 53D5FB            ANL      RFCON,#0FBH
006226 12575D            LCALL    stop_phy_timer
006229         ?L?COM00F5:
006229 7F14              MOV      R7,#014H
00622B         ?L?COM00F6:
00622B 7E00              MOV      R6,#00H
00622D         ?L?COM00F7:
00622D 11A7              ACALL    _set_phy_timer_timeout
00622F 123F41            LCALL    start_phy_timer
----- FUNCTION wait_phy_timer_timeout (BEGIN) -----
006232 75FF03            MOV      SFRPAGE,#03H
006235         ?C0008?ZW_PHY_RF_050X:
006235 E591              MOV      A,PHYTCON1
006237 20E7FB            JB       ACC.7,?C0008?ZW_PHY_RF_050X
00623A 22                RET      
----- FUNCTION wait_phy_timer_timeout (END) -------


----- FUNCTION RF_switch_to_RX (BEGIN) -----
00623B E4                CLR      A
00623C 904552            MOV      DPTR,#success
00623F F0                MOVX     @DPTR,A
006240 A3                INC      DPTR
006241 04                INC      A
006242 F0                MOVX     @DPTR,A
006243 E4                CLR      A
006244 904555            MOV      DPTR,#from_tx
006247 F0                MOVX     @DPTR,A
006248         ?C0117?ZW_PHY_RF_050X:
006248 E5FA              MOV      A,MODCTRL
00624A 30E1FB            JNB      ACC.1,?C0117?ZW_PHY_RF_050X
00624D         ?C0118?ZW_PHY_RF_050X:
00624D 75FF01            MOV      SFRPAGE,#01H
006250 E5D5              MOV      A,RFCON
006252 30E703            JNB      ACC.7,?C0119?ZW_PHY_RF_050X
006255 7F00              MOV      R7,#00H
006257 22                RET      
006258         ?C0119?ZW_PHY_RF_050X:
006258 E4                CLR      A
006259 F5FF              MOV      SFRPAGE,A
00625B 75E508            MOV      SDSTAT3,#08H
00625E 911D              ACALL    ?L?COM04D2
006260 E5D5              MOV      A,RFCON
006262 30E61A            JNB      ACC.6,?C0121?ZW_PHY_RF_050X
006265 75FF01            MOV      SFRPAGE,#01H
006268 904554            MOV      DPTR,#temp_rfpow
00626B E5DA              MOV      A,RFPOW
00626D F0                MOVX     @DPTR,A
00626E E4                CLR      A
00626F F5DA              MOV      RFPOW,A
006271 75FF01            MOV      SFRPAGE,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 139


006274         ?C0122?ZW_PHY_RF_050X:
006274 E5D6              MOV      A,RFCON2
006276 30E3FB            JNB      ACC.3,?C0122?ZW_PHY_RF_050X
006279         ?C0123?ZW_PHY_RF_050X:
006279 904555            MOV      DPTR,#from_tx
00627C 7401              MOV      A,#01H
00627E F0                MOVX     @DPTR,A
00627F         ?C0121?ZW_PHY_RF_050X:
00627F B174              ACALL    ?L?COM03F6
006281         ?C0124?ZW_PHY_RF_050X:
006281 E59B              MOV      A,SEQCON5
006283 30E7FB            JNB      ACC.7,?C0124?ZW_PHY_RF_050X
006286         ?C0125?ZW_PHY_RF_050X:
;---- Variable 'ch' assigned to Register 'R3' ----
006286 E4                CLR      A
006287 FB                MOV      R3,A
006288         ?C0126?ZW_PHY_RF_050X:
006288 75FF03            MOV      SFRPAGE,#03H
00628B 8B95              MOV      DMCHAN,R3
00628D 124AA2            LCALL    ?L?COM0023
006290 124E6B            LCALL    __set_fcw
006293 0B                INC      R3
006294 EB                MOV      A,R3
006295 B403F0            CJNE     A,#03H,?C0126?ZW_PHY_RF_050X
006298         ?C0127?ZW_PHY_RF_050X:
006298 75FF03            MOV      SFRPAGE,#03H
00629B 759580            MOV      DMCHAN,#080H
00629E 5118              ACALL    ?L?COM00F4
0062A0 75FF01            MOV      SFRPAGE,#01H
0062A3 43D504            ORL      RFCON,#04H
0062A6 904555            MOV      DPTR,#from_tx
0062A9 E0                MOVX     A,@DPTR
0062AA 7007              JNZ      ?C0129?ZW_PHY_RF_050X
0062AC 12575D            LCALL    stop_phy_timer
0062AF 7FC8              MOV      R7,#0C8H
0062B1 512B              ACALL    ?L?COM00F6
0062B3         ?C0129?ZW_PHY_RF_050X:
0062B3 7B01              MOV      R3,#01H
0062B5 7A45              MOV      R2,#HIGH tmp_success
0062B7 7953              MOV      R1,#LOW tmp_success
0062B9 B1B3              ACALL    __PLL_wait_lock_and_sequencer_done
0062BB 904553            MOV      DPTR,#tmp_success
0062BE E0                MOVX     A,@DPTR
0062BF 904552            MOV      DPTR,#success
0062C2 7006              JNZ      ?C0130?ZW_PHY_RF_050X
0062C4 E0                MOVX     A,@DPTR
0062C5 4404              ORL      A,#04H
0062C7 FF                MOV      R7,A
0062C8 8002              SJMP     ?C0131?ZW_PHY_RF_050X
0062CA         ?C0130?ZW_PHY_RF_050X:
0062CA E0                MOVX     A,@DPTR
0062CB FF                MOV      R7,A
0062CC         ?C0131?ZW_PHY_RF_050X:
0062CC 904552            MOV      DPTR,#success
0062CF EF                MOV      A,R7
0062D0 F0                MOVX     @DPTR,A
0062D1 90120E            MOV      DPTR,#phyRfData+0DH
0062D4 E0                MOVX     A,@DPTR
0062D5 B40102            CJNE     A,#01H,?C0132?ZW_PHY_RF_050X
0062D8 9124              ACALL    ?L?COM04D3
0062DA         ?C0132?ZW_PHY_RF_050X:
0062DA 75FF01            MOV      SFRPAGE,#01H
0062DD 904554            MOV      DPTR,#temp_rfpow
0062E0 E0                MOVX     A,@DPTR
0062E1 F5DA              MOV      RFPOW,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 140


0062E3 904552            MOV      DPTR,#success
0062E6 E0                MOVX     A,@DPTR
0062E7 FF                MOV      R7,A
0062E8 22                RET      
----- FUNCTION RF_switch_to_RX (END) -------


----- FUNCTION _PLL_boost_bias (BEGIN) -----
0062E9 E4                CLR      A
0062EA F5FF              MOV      SFRPAGE,A
0062EC 75C2E1            MOV      DPLLNRM4,#0E1H
0062EF 7F1E              MOV      R7,#01EH
0062F1 912B              ACALL    ?L?COM0526
0062F3 30E707            JNB      ACC.7,?C0031?ZW_PHY_RF_050X
0062F6 E4                CLR      A
0062F7 F5FF              MOV      SFRPAGE,A
0062F9 75C2A1            MOV      DPLLNRM4,#0A1H
0062FC 22                RET      
0062FD         ?C0031?ZW_PHY_RF_050X:
0062FD E4                CLR      A
0062FE F5FF              MOV      SFRPAGE,A
006300 75C281            MOV      DPLLNRM4,#081H
006303 22                RET      
----- FUNCTION _PLL_boost_bias (END) -------


----- FUNCTION __PLL_set_bank5 (BEGIN) -----
006304 90405E            MOV      DPTR,#fcw
006307 1224BA            LCALL    ?C?LSTXDATA
00630A E4                CLR      A
00630B F5FF              MOV      SFRPAGE,A
00630D 75BB05            MOV      DPLLORBNK,#05H
006310 75BB85            MOV      DPLLORBNK,#085H
006313 75FF01            MOV      SFRPAGE,#01H
006316 75D502            MOV      RFCON,#02H
006319 203007            JB       rf_already_calculated,?C0045?ZW_PHY_RF_050X
00631C 7F3F              MOV      R7,#03FH
00631E FE                MOV      R6,A
00631F 512D              ACALL    ?L?COM00F7
006321 51E9              ACALL    _PLL_boost_bias
006323         ?C0045?ZW_PHY_RF_050X:
006323 75FF01            MOV      SFRPAGE,#01H
006326 43D520            ORL      RFCON,#020H
006329 303002            JNB      rf_already_calculated,$ + 5H
00632C 61C5              AJMP     ?C0046?ZW_PHY_RF_050X
00632E E4                CLR      A
00632F F5FF              MOV      SFRPAGE,A
006331 538EF7            ANL      DPLLSMCON,#0F7H
006334 438E07            ORL      DPLLSMCON,#07H
;---- Variable 'i' assigned to Register 'R5' ----
006337 7D04              MOV      R5,#04H
006339         ?C0047?ZW_PHY_RF_050X:
006339 E4                CLR      A
00633A F5FF              MOV      SFRPAGE,A
00633C 8DBC              MOV      DPLLORVAL,R5
00633E F5FF              MOV      SFRPAGE,A
006340 43B102            ORL      DPLLCON,#02H
006343         ?C0050?ZW_PHY_RF_050X:
006343 E5B1              MOV      A,DPLLCON
006345 30E2FB            JNB      ACC.2,?C0050?ZW_PHY_RF_050X
006348         ?C0051?ZW_PHY_RF_050X:
006348 E4                CLR      A
006349 F5FF              MOV      SFRPAGE,A
00634B AFDF              MOV      R7,DPLLSMHI
00634D EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 141


00634E FE                MOV      R6,A
00634F ACDE              MOV      R4,DPLLSMLO
006351 EC                MOV      A,R4
006352 FB                MOV      R3,A
006353 EB                MOV      A,R3
006354 FF                MOV      R7,A
006355 ED                MOV      A,R5
006356 25E0              ADD      A,ACC
006358 245C              ADD      A,#LOW b5table-08H
00635A F582              MOV      DPL,A
00635C E4                CLR      A
00635D 3440              ADDC     A,#HIGH b5table-08H
00635F F583              MOV      DPH,A
006361 71EA              ACALL    ?L?COM03AD
006363 F5FF              MOV      SFRPAGE,A
006365 F5FF              MOV      SFRPAGE,A
006367 53B1FD            ANL      DPLLCON,#0FDH
00636A 0D                INC      R5
00636B ED                MOV      A,R5
00636C B40CCA            CJNE     A,#0CH,?C0047?ZW_PHY_RF_050X
00636F         ?C0048?ZW_PHY_RF_050X:
00636F 90405E            MOV      DPTR,#fcw
006372 124AB0            LCALL    ?L?COM0025
006375 7809              MOV      R0,#09H
006377 1223AE            LCALL    ?C?ULSHR
00637A A3                INC      DPTR
00637B 71EA              ACALL    ?L?COM03AD
00637D FD                MOV      R5,A
00637E         ?C0054?ZW_PHY_RF_050X:
00637E ED                MOV      A,R5
00637F 25E0              ADD      A,ACC
006381 2466              ADD      A,#LOW b5table+02H
006383 F582              MOV      DPL,A
006385 E4                CLR      A
006386 3440              ADDC     A,#HIGH b5table+02H
006388 F583              MOV      DPH,A
00638A E0                MOVX     A,@DPTR
00638B C3                CLR      C
00638C 13                RRC      A
00638D FA                MOV      R2,A
00638E A3                INC      DPTR
00638F E0                MOVX     A,@DPTR
006390 13                RRC      A
006391 FB                MOV      R3,A
006392 71DF              ACALL    ?L?COM033D
006394 F583              MOV      DPH,A
006396 91AD              ACALL    ?L?COM041A
006398 2B                ADD      A,R3
006399 FF                MOV      R7,A
00639A EE                MOV      A,R6
00639B 3A                ADDC     A,R2
00639C FE                MOV      R6,A
00639D 71DF              ACALL    ?L?COM033D
00639F B157              ACALL    ?L?COM050A
0063A1 2404              ADD      A,#04H
0063A3 90120D            MOV      DPTR,#phyRfData+0CH
0063A6 F0                MOVX     @DPTR,A
0063A7 ED                MOV      A,R5
0063A8 C3                CLR      C
0063A9 9407              SUBB     A,#07H
0063AB 5018              JNC      ?C0046?ZW_PHY_RF_050X
0063AD CF                XCH      A,R7
0063AE ED                MOV      A,R5
0063AF CF                XCH      A,R7
0063B0 0D                INC      R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 142


0063B1 EF                MOV      A,R7
0063B2 71E0              ACALL    ?L?COM033E
0063B4 12471D            LCALL    ?L?COM0211
0063B7 FF                MOV      R7,A
0063B8 C3                CLR      C
0063B9 904063            MOV      DPTR,#fcw_upper+01H
0063BC E0                MOVX     A,@DPTR
0063BD 9F                SUBB     A,R7
0063BE 904062            MOV      DPTR,#fcw_upper
0063C1 E0                MOVX     A,@DPTR
0063C2 9E                SUBB     A,R6
0063C3 50B9              JNC      ?C0054?ZW_PHY_RF_050X
0063C5         ?C0046?ZW_PHY_RF_050X:
0063C5 E4                CLR      A
0063C6 F5FF              MOV      SFRPAGE,A
0063C8 758EC8            MOV      DPLLSMCON,#0C8H
0063CB F5FF              MOV      SFRPAGE,A
0063CD 90120D            MOV      DPTR,#phyRfData+0CH
0063D0 E0                MOVX     A,@DPTR
0063D1 F5BC              MOV      DPLLORVAL,A
0063D3 E4                CLR      A
0063D4 F5FF              MOV      SFRPAGE,A
0063D6 75BB80            MOV      DPLLORBNK,#080H
0063D9 75FF01            MOV      SFRPAGE,#01H
0063DC F5D5              MOV      RFCON,A
0063DE 22                RET      
----- FUNCTION __PLL_set_bank5 (END) -------


----- FUNCTION ?L?COM033D (BEGIN) -----
0063DF ED                MOV      A,R5
0063E0         ?L?COM033E:
0063E0 25E0              ADD      A,ACC
0063E2 2464              ADD      A,#LOW b5table
0063E4 F582              MOV      DPL,A
0063E6 E4                CLR      A
0063E7 3440              ADDC     A,#HIGH b5table
0063E9 22                RET      
----- FUNCTION ?L?COM033D (END) -------


----- FUNCTION ?L?COM03AD (BEGIN) -----
0063EA EE                MOV      A,R6
0063EB F0                MOVX     @DPTR,A
0063EC A3                INC      DPTR
0063ED EF                MOV      A,R7
0063EE F0                MOVX     @DPTR,A
0063EF E4                CLR      A
0063F0 22                RET      
----- FUNCTION ?L?COM03AD (END) -------


----- FUNCTION ?L?COM03FA (BEGIN) -----
0063F1 75FF02            MOV      SFRPAGE,#02H
0063F4 43E180            ORL      WUTREG1,#080H
0063F7 1256F5            LCALL    RF_shutdown
----- FUNCTION _RF_LDO_precharge (BEGIN) -----
0063FA 9113              ACALL    ?L?COM04D5
0063FC 53DB7F            ANL      RFTEST,#07FH
0063FF 75FF01            MOV      SFRPAGE,#01H
006402 75D502            MOV      RFCON,#02H
006405 5129              ACALL    ?L?COM00F5
006407 9113              ACALL    ?L?COM04D5
006409 43DB80            ORL      RFTEST,#080H
00640C 75FF01            MOV      SFRPAGE,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 143


00640F E4                CLR      A
006410 F5D5              MOV      RFCON,A
006412 22                RET      
----- FUNCTION _RF_LDO_precharge (END) -------


----- FUNCTION ?L?COM04D5 (BEGIN) -----
006413 75FF01            MOV      SFRPAGE,#01H
006416 438E10            ORL      ADCCON5,#010H
006419 75FF01            MOV      SFRPAGE,#01H
00641C 22                RET      
----- FUNCTION ?L?COM04D5 (END) -------


----- FUNCTION ?L?COM04D2 (BEGIN) -----
00641D 75FF01            MOV      SFRPAGE,#01H
006420 53D8EF            ANL      DFCON2,#0EFH
006423 22                RET      
----- FUNCTION ?L?COM04D2 (END) -------


----- FUNCTION ?L?COM04D3 (BEGIN) -----
006424 75FF01            MOV      SFRPAGE,#01H
006427 43D810            ORL      DFCON2,#010H
00642A 22                RET      
----- FUNCTION ?L?COM04D3 (END) -------


----- FUNCTION ?L?COM0526 (BEGIN) -----
00642B FE                MOV      R6,A
00642C 31CF              ACALL    _wait_phy_timer_elapse
00642E 90120F            MOV      DPTR,#phyRfData+0EH
006431 E0                MOVX     A,@DPTR
006432 22                RET      
----- FUNCTION ?L?COM0526 (END) -------


----- FUNCTION _get_phy_timer (BEGIN) -----
;---- Variable 'timer_value' assigned to Register 'R1/R2/R3' ----
006433 510C              ACALL    ?L?COM033F
006435 AD94              MOV      R5,PHYTSL
006437 EF                MOV      A,R7
006438 4D                ORL      A,R5
006439 9179              ACALL    ?L?COM0597
00643B 8FF0              MOV      B,R7
00643D 1221E8            LCALL    ?C?ISTPTR
006440 E591              MOV      A,PHYTCON1
006442 C3                CLR      C
006443 30E701            JNB      ACC.7,?C0011?ZW_PHY_RF_050X
006446 D3                SETB     C
006447         ?C0011?ZW_PHY_RF_050X:
006447 22                RET      
----- FUNCTION _get_phy_timer (END) -------


----- FUNCTION _set_phy_timer_timeout_max (BEGIN) -----
006448 90454A            MOV      DPTR,#timeout
00644B EE                MOV      A,R6
00644C F0                MOVX     @DPTR,A
00644D A3                INC      DPTR
00644E EF                MOV      A,R7
00644F F0                MOVX     @DPTR,A
006450 7B01              MOV      R3,#01H
006452 7A45              MOV      R2,#HIGH temp_timer
006454 794C              MOV      R1,#LOW temp_timer
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 144


006456 9133              ACALL    _get_phy_timer
006458 5014              JNC      ?C0006?ZW_PHY_RF_050X
00645A 90454C            MOV      DPTR,#temp_timer
00645D E0                MOVX     A,@DPTR
00645E FE                MOV      R6,A
00645F A3                INC      DPTR
006460 E0                MOVX     A,@DPTR
006461 FF                MOV      R7,A
006462 90454B            MOV      DPTR,#timeout+01H
006465 E0                MOVX     A,@DPTR
006466 9F                SUBB     A,R7
006467 90454A            MOV      DPTR,#timeout
00646A E0                MOVX     A,@DPTR
00646B 9E                SUBB     A,R6
00646C 400A              JC       ?C0007?ZW_PHY_RF_050X
00646E         ?C0006?ZW_PHY_RF_050X:
00646E 90454A            MOV      DPTR,#timeout
006471 E0                MOVX     A,@DPTR
006472 FE                MOV      R6,A
006473 A3                INC      DPTR
006474 E0                MOVX     A,@DPTR
006475 FF                MOV      R7,A
006476 11A7              ACALL    _set_phy_timer_timeout
006478         ?C0007?ZW_PHY_RF_050X:
006478 22                RET      
----- FUNCTION _set_phy_timer_timeout_max (END) -------


----- FUNCTION ?L?COM0597 (BEGIN) -----
006479 24FB              ADD      A,#0FBH
00647B FF                MOV      R7,A
00647C E5F0              MOV      A,B
00647E 34FF              ADDC     A,#0FFH
006480 22                RET      
----- FUNCTION ?L?COM0597 (END) -------


----- FUNCTION RF_mode_get (BEGIN) -----
006481 7FFA              MOV      R7,#0FAH
006483 123F3C            LCALL    ?L?COM0230
006486         ?C0212?ZW_PHY_RF_050X:
006486 E5FC              MOV      A,SEQCON
006488 30E605            JNB      ACC.6,?C0213?ZW_PHY_RF_050X
00648B 123F2F            LCALL    phy_timer_runs
00648E 40F6              JC       ?C0212?ZW_PHY_RF_050X
006490         ?C0213?ZW_PHY_RF_050X:
006490 E5FC              MOV      A,SEQCON
006492 30E603            JNB      ACC.6,?C0216?ZW_PHY_RF_050X
006495 7F03              MOV      R7,#03H
006497 22                RET      
006498         ?C0216?ZW_PHY_RF_050X:
006498 75FF01            MOV      SFRPAGE,#01H
00649B E5D5              MOV      A,RFCON
00649D 30E603            JNB      ACC.6,?C0219?ZW_PHY_RF_050X
0064A0 7F02              MOV      R7,#02H
0064A2 22                RET      
0064A3         ?C0219?ZW_PHY_RF_050X:
0064A3 E5D5              MOV      A,RFCON
0064A5 7F00              MOV      R7,#00H
0064A7 30E702            JNB      ACC.7,?C0221?ZW_PHY_RF_050X
0064AA 7F01              MOV      R7,#01H
0064AC         ?C0221?ZW_PHY_RF_050X:
0064AC 22                RET      
----- FUNCTION RF_mode_get (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 145



----- FUNCTION ?L?COM041A (BEGIN) -----
0064AD E0                MOVX     A,@DPTR
0064AE C3                CLR      C
0064AF 13                RRC      A
0064B0 FE                MOV      R6,A
0064B1 A3                INC      DPTR
0064B2 E0                MOVX     A,@DPTR
0064B3 13                RRC      A
0064B4 22                RET      
----- FUNCTION ?L?COM041A (END) -------


----- FUNCTION _ZW_UART0_init (BEGIN) -----
0064B5 90455E            MOV      DPTR,#bBaudRate
0064B8 B160              ACALL    ?L?COM00E8
0064BA EB                MOV      A,R3
0064BB F0                MOVX     @DPTR,A
0064BC B127              ACALL    ?L?COM01DB
0064BE B135              ACALL    ?L?COM0436
0064C0 B14E              ACALL    ?L?COM04EC
0064C2 C006              PUSH     AR6
0064C4 C007              PUSH     AR7
0064C6 90455E            MOV      DPTR,#bBaudRate
0064C9 91AD              ACALL    ?L?COM041A
0064CB B12E              ACALL    ?L?COM01DD
0064CD D007              POP      AR7
0064CF D006              POP      AR6
0064D1 D3                SETB     C
0064D2 122387            LCALL    ?C?SLCMP
0064D5 7E00              MOV      R6,#00H
0064D7 5004              JNC      ?C0001?ZW_PHY_UART0_050X
0064D9 7F01              MOV      R7,#01H
0064DB 8002              SJMP     ?C0030?ZW_PHY_UART0_050X
0064DD         ?C0001?ZW_PHY_UART0_050X:
0064DD 7F00              MOV      R7,#00H
0064DF         
0064DF C006              PUSH     AR6
0064E1 C007              PUSH     AR7
0064E3         ?C0002?ZW_PHY_UART0_050X:
0064E3 B127              ACALL    ?L?COM01DB
0064E5 B135              ACALL    ?L?COM0436
0064E7 D0E0              POP      ACC
0064E9 2F                ADD      A,R7
0064EA FF                MOV      R7,A
0064EB D0E0              POP      ACC
0064ED 3E                ADDC     A,R6
0064EE 90455E            MOV      DPTR,#bBaudRate
0064F1 F0                MOVX     @DPTR,A
0064F2 A3                INC      DPTR
0064F3 EF                MOV      A,R7
0064F4 F0                MOVX     @DPTR,A
0064F5 53ECFC            ANL      UARTCON,#0FCH
0064F8 90455E            MOV      DPTR,#bBaudRate
0064FB B13F              ACALL    ?L?COM03C6
0064FD 5403              ANL      A,#03H
0064FF 42EC              ORL      UARTCON,A
006501 75FF02            MOV      SFRPAGE,#02H
006504 ED                MOV      A,R5
006505 F5AF              MOV      UART0BRL,A
006507 75ED02            MOV      UARTSTAT,#02H
00650A 75ED04            MOV      UARTSTAT,#04H
00650D A3                INC      DPTR
00650E E0                MOVX     A,@DPTR
00650F 6005              JZ       ?C0003?ZW_PHY_UART0_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 146


006511 43EC08            ORL      UARTCON,#08H
006514 8003              SJMP     ?C0004?ZW_PHY_UART0_050X
006516         ?C0003?ZW_PHY_UART0_050X:
006516 53ECF7            ANL      UARTCON,#0F7H
006519         ?C0004?ZW_PHY_UART0_050X:
006519 904561            MOV      DPTR,#bEnableRx
00651C E0                MOVX     A,@DPTR
00651D 6004              JZ       ?C0005?ZW_PHY_UART0_050X
00651F 43EC04            ORL      UARTCON,#04H
006522 22                RET      
006523         ?C0005?ZW_PHY_UART0_050X:
006523 53ECFB            ANL      UARTCON,#0FBH
006526 22                RET      
----- FUNCTION _ZW_UART0_init (END) -------


----- FUNCTION ?L?COM01DB (BEGIN) -----
006527 90455E            MOV      DPTR,#bBaudRate
00652A         ?L?COM01DC:
00652A E0                MOVX     A,@DPTR
00652B FE                MOV      R6,A
00652C A3                INC      DPTR
00652D E0                MOVX     A,@DPTR
00652E         ?L?COM01DD:
00652E FB                MOV      R3,A
00652F AA06              MOV      R2,AR6
006531 E4                CLR      A
006532 F9                MOV      R1,A
006533 F8                MOV      R0,A
006534 22                RET      
----- FUNCTION ?L?COM01DB (END) -------


----- FUNCTION ?L?COM0436 (BEGIN) -----
006535 7F80              MOV      R7,#080H
006537 7E38              MOV      R6,#038H
006539 7D01              MOV      R5,#01H
00653B FC                MOV      R4,A
00653C 022DCC            LJMP     ?C?SLDIV
----- FUNCTION ?L?COM0436 (END) -------


----- FUNCTION ?L?COM03C6 (BEGIN) -----
00653F E0                MOVX     A,@DPTR
006540 FC                MOV      R4,A
006541 A3                INC      DPTR
006542 E0                MOVX     A,@DPTR
006543 FD                MOV      R5,A
006544 EC                MOV      A,R4
006545 22                RET      
----- FUNCTION ?L?COM03C6 (END) -------


----- FUNCTION ?L?COM054B (BEGIN) -----
006546 2D                ADD      A,R5
006547 F582              MOV      DPL,A
006549 EA                MOV      A,R2
00654A 3C                ADDC     A,R4
00654B F583              MOV      DPH,A
00654D 22                RET      
----- FUNCTION ?L?COM054B (END) -------


----- FUNCTION ?L?COM04EC (BEGIN) -----
00654E AC00              MOV      R4,AR0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 147


006550 AD01              MOV      R5,AR1
006552 AE02              MOV      R6,AR2
006554 AF03              MOV      R7,AR3
006556 22                RET      
----- FUNCTION ?L?COM04EC (END) -------


----- FUNCTION ?L?COM050A (BEGIN) -----
006557 F583              MOV      DPH,A
006559 EE                MOV      A,R6
00655A F0                MOVX     @DPTR,A
00655B A3                INC      DPTR
00655C EF                MOV      A,R7
00655D F0                MOVX     @DPTR,A
00655E ED                MOV      A,R5
00655F 22                RET      
----- FUNCTION ?L?COM050A (END) -------


----- FUNCTION ?L?COM00E8 (BEGIN) -----
006560 EE                MOV      A,R6
006561 F0                MOVX     @DPTR,A
006562 A3                INC      DPTR
006563         ?L?COM00E9:
006563 EF                MOV      A,R7
006564 F0                MOVX     @DPTR,A
006565 A3                INC      DPTR
006566 ED                MOV      A,R5
006567 F0                MOVX     @DPTR,A
006568 A3                INC      DPTR
006569 22                RET      
----- FUNCTION ?L?COM00E8 (END) -------


----- FUNCTION ?L?COM04D1 (BEGIN) -----
00656A 75FF01            MOV      SFRPAGE,#01H
00656D E4                CLR      A
00656E F5EA              MOV      DFCON3,A
006570 75EAFF            MOV      DFCON3,#0FFH
006573 22                RET      
----- FUNCTION ?L?COM04D1 (END) -------


----- FUNCTION ?L?COM03F6 (BEGIN) -----
006574 75FF03            MOV      SFRPAGE,#03H
006577 759B04            MOV      SEQCON5,#04H
00657A 75FC41            MOV      SEQCON,#041H
00657D 75FF03            MOV      SFRPAGE,#03H
006580 22                RET      
----- FUNCTION ?L?COM03F6 (END) -------


----- FUNCTION ?L?COM03F7 (BEGIN) -----
006581 7104              ACALL    __PLL_set_bank5
006583 E4                CLR      A
006584 F5FF              MOV      SFRPAGE,A
006586 E5BD              MOV      A,DPLLSTART
006588 54F8              ANL      A,#0F8H
00658A 4404              ORL      A,#04H
00658C 22                RET      
----- FUNCTION ?L?COM03F7 (END) -------


----- FUNCTION ?L?COM02EF (BEGIN) -----
00658D 75FF03            MOV      SFRPAGE,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 148


006590 759580            MOV      DMCHAN,#080H
006593         ?L?COM02F0:
006593 90120E            MOV      DPTR,#phyRfData+0DH
006596 E0                MOVX     A,@DPTR
006597 D3                SETB     C
006598 9401              SUBB     A,#01H
00659A 22                RET      
----- FUNCTION ?L?COM02EF (END) -------


----- FUNCTION _ZW_InitSerialIf_uart (BEGIN) -----
;---- Variable 'bBaudRate' assigned to Register 'R6/R7' ----
00659B C2AC              CLR      ES0
00659D E4                CLR      A
00659E F575              MOV      txCount,A
0065A0 F574              MOV      rxCount,A
0065A2 F573              MOV      txOutPtr,A
0065A4 F571              MOV      txInPtr,A
0065A6 F572              MOV      rxOutPtr,A
0065A8 F570              MOV      rxInPtr,A
0065AA 7B01              MOV      R3,#01H
0065AC 7D01              MOV      R5,#01H
0065AE 91B5              ACALL    _ZW_UART0_init
0065B0 D2AC              SETB     ES0
0065B2 22                RET      
----- FUNCTION _ZW_InitSerialIf_uart (END) -------


----- FUNCTION __PLL_wait_lock_and_sequencer_done (BEGIN) -----
;---- Variable 'success' assigned to Register 'R1/R2/R3' ----
0065B3 C22F              CLR      rf_setting_changed
0065B5 75FF03            MOV      SFRPAGE,#03H
0065B8 759B1F            MOV      SEQCON5,#01FH
0065BB         ?C0036?ZW_PHY_RF_050X:
0065BB 75FF03            MOV      SFRPAGE,#03H
0065BE 90120F            MOV      DPTR,#phyRfData+0EH
0065C1 E0                MOVX     A,@DPTR
0065C2 20E71B            JB       ACC.7,?C0034?ZW_PHY_RF_050X
0065C5 E59A              MOV      A,SEQCON4
0065C7 540F              ANL      A,#0FH
0065C9 C3                CLR      C
0065CA 9402              SUBB     A,#02H
0065CC 4012              JC       ?C0034?ZW_PHY_RF_050X
0065CE E0                MOVX     A,@DPTR
0065CF 4480              ORL      A,#080H
0065D1 F0                MOVX     @DPTR,A
0065D2 E4                CLR      A
0065D3 F5FF              MOV      SFRPAGE,A
0065D5 75C2A1            MOV      DPLLNRM4,#0A1H
0065D8 43FC04            ORL      SEQCON,#04H
0065DB 75FF03            MOV      SFRPAGE,#03H
0065DE D22F              SETB     rf_setting_changed
0065E0         ?C0034?ZW_PHY_RF_050X:
0065E0 E5FC              MOV      A,SEQCON
0065E2 30E609            JNB      ACC.6,?C0035?ZW_PHY_RF_050X
0065E5 E59A              MOV      A,SEQCON4
0065E7 540F              ANL      A,#0FH
0065E9 C3                CLR      C
0065EA 9405              SUBB     A,#05H
0065EC 40CD              JC       ?C0036?ZW_PHY_RF_050X
0065EE         ?C0035?ZW_PHY_RF_050X:
0065EE E5FC              MOV      A,SEQCON
0065F0 30E611            JNB      ACC.6,?C0040?ZW_PHY_RF_050X
0065F3 E4                CLR      A
0065F4 12203B            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 149


0065F7 75FC80            MOV      SEQCON,#080H
0065FA F5FC              MOV      SEQCON,A
0065FC 75FC40            MOV      SEQCON,#040H
0065FF         ?C0041?ZW_PHY_RF_050X:
0065FF E5FC              MOV      A,SEQCON
006601 20E6FB            JB       ACC.6,?C0041?ZW_PHY_RF_050X
006604         ?C0042?ZW_PHY_RF_050X:
006604         ?C0040?ZW_PHY_RF_050X:
006604 302F03            JNB      rf_setting_changed,?C0044?ZW_PHY_RF_050X
006607 124D7A            LCALL    _RF_generate_checksum
00660A         ?C0044?ZW_PHY_RF_050X:
00660A 22                RET      
----- FUNCTION __PLL_wait_lock_and_sequencer_done (END) -------


----- FUNCTION __RF_check_checksum (BEGIN) -----
00660B 9045CD            MOV      DPTR,#success
00660E D13F              ACALL    ?L?COM040F
006610 F0                MOVX     @DPTR,A
;---- Variable 'value' assigned to Register 'R7' ----
006611 7F01              MOV      R7,#01H
006613 7C12              MOV      R4,#HIGH phyRfData
006615 7D01              MOV      R5,#LOW phyRfData
;---- Variable 'adr' assigned to Register 'R4/R5' ----
;---- Variable 'i' assigned to Register 'R6' ----
006617 E4                CLR      A
006618 FE                MOV      R6,A
006619         ?C0025?ZW_PHY_RF_050X:
006619 8D82              MOV      DPL,R5
00661B 8C83              MOV      DPH,R4
00661D ED                MOV      A,R5
00661E 2E                ADD      A,R6
00661F F582              MOV      DPL,A
006621 E4                CLR      A
006622 3C                ADDC     A,R4
006623 F583              MOV      DPH,A
006625 E0                MOVX     A,@DPTR
006626 2F                ADD      A,R7
006627 FF                MOV      R7,A
006628 0E                INC      R6
006629 EE                MOV      A,R6
00662A B412EC            CJNE     A,#012H,?C0025?ZW_PHY_RF_050X
00662D         ?C0026?ZW_PHY_RF_050X:
00662D 901213            MOV      DPTR,#phyRfData+012H
006630 E0                MOVX     A,@DPTR
006631 6F                XRL      A,R7
006632 600A              JZ       ?C0029?ZW_PHY_RF_050X
006634 9045CD            MOV      DPTR,#success
006637 124FE5            LCALL    ?L?COM02A0
00663A E4                CLR      A
00663B 12203B            LCALL    ?C?CSTPTR
00663E         ?C0029?ZW_PHY_RF_050X:
00663E 22                RET      
----- FUNCTION __RF_check_checksum (END) -------


----- FUNCTION ?L?COM040F (BEGIN) -----
00663F EB                MOV      A,R3
006640 F0                MOVX     @DPTR,A
006641 A3                INC      DPTR
006642 EA                MOV      A,R2
006643 F0                MOVX     @DPTR,A
006644 A3                INC      DPTR
006645 E9                MOV      A,R1
006646 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 150


----- FUNCTION ?L?COM040F (END) -------


----- FUNCTION __RF_setup_rx_and_filter (BEGIN) -----
;---- Variable 'rxmode' assigned to Register 'R7' ----
006647 EF                MOV      A,R7
006648 30E00E            JNB      ACC.0,?C0057?ZW_PHY_RF_050X
00664B 43F401            ORL      DMCTRL,#01H
00664E E4                CLR      A
00664F F5FF              MOV      SFRPAGE,A
006651 43A404            ORL      DMHSFLT4,#04H
006654 F5FF              MOV      SFRPAGE,A
006656 759624            MOV      DMSETUP5,#024H
006659         ?C0057?ZW_PHY_RF_050X:
006659 EF                MOV      A,R7
00665A 30E10E            JNB      ACC.1,?C0058?ZW_PHY_RF_050X
00665D 43F401            ORL      DMCTRL,#01H
006660 E4                CLR      A
006661 F5FF              MOV      SFRPAGE,A
006663 43A408            ORL      DMHSFLT4,#08H
006666 F5FF              MOV      SFRPAGE,A
006668 759624            MOV      DMSETUP5,#024H
00666B         ?C0058?ZW_PHY_RF_050X:
00666B EF                MOV      A,R7
00666C 30E209            JNB      ACC.2,?C0059?ZW_PHY_RF_050X
00666F 43F402            ORL      DMCTRL,#02H
006672 E4                CLR      A
006673 F5FF              MOV      SFRPAGE,A
006675 75961E            MOV      DMSETUP5,#01EH
006678         ?C0059?ZW_PHY_RF_050X:
006678 EF                MOV      A,R7
006679 30E309            JNB      ACC.3,?C0060?ZW_PHY_RF_050X
00667C 43F404            ORL      DMCTRL,#04H
00667F E4                CLR      A
006680 F5FF              MOV      SFRPAGE,A
006682 759610            MOV      DMSETUP5,#010H
006685         ?C0060?ZW_PHY_RF_050X:
006685 75FF01            MOV      SFRPAGE,#01H
006688 EF                MOV      A,R7
006689 5403              ANL      A,#03H
00668B 6004              JZ       ?C0061?ZW_PHY_RF_050X
00668D 75D712            MOV      DFCON1,#012H
006690 22                RET      
006691         ?C0061?ZW_PHY_RF_050X:
006691 75D72D            MOV      DFCON1,#02DH
006694 22                RET      
----- FUNCTION __RF_setup_rx_and_filter (END) -------


----- FUNCTION _RF_init_demodulator (BEGIN) -----
006695 E4                CLR      A
006696 F5FF              MOV      SFRPAGE,A
006698 7584E6            MOV      TRACKCON,#0E6H
00669B F5FF              MOV      SFRPAGE,A
00669D 439404            ORL      DMSETUP1,#04H
0066A0 F5FF              MOV      SFRPAGE,A
0066A2 759814            MOV      DMLSPLO,#014H
0066A5 22                RET      
----- FUNCTION _RF_init_demodulator (END) -------


----- FUNCTION _RF_general_setup (BEGIN) -----
0066A6 E4                CLR      A
0066A7 F5FF              MOV      SFRPAGE,A
0066A9 75933F            MOV      SEQCON2,#03FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 151


0066AC 75FF03            MOV      SFRPAGE,#03H
0066AF 759A40            MOV      SEQCON4,#040H
0066B2 D195              ACALL    _RF_init_demodulator
0066B4 E4                CLR      A
0066B5 F5FF              MOV      SFRPAGE,A
0066B7 759C93            MOV      DMLSFLT3,#093H
0066BA F5FF              MOV      SFRPAGE,A
0066BC 75A1A3            MOV      DMHSFLT2,#0A3H
0066BF F5FF              MOV      SFRPAGE,A
0066C1 758531            MOV      TRACKHS,#031H
0066C4 F5FF              MOV      SFRPAGE,A
0066C6 758628            MOV      TRACKLS,#028H
0066C9 E5FA              MOV      A,MODCTRL
0066CB 5430              ANL      A,#030H
0066CD 4480              ORL      A,#080H
0066CF F5FA              MOV      MODCTRL,A
0066D1 75FF01            MOV      SFRPAGE,#01H
0066D4 75E74A            MOV      SDCON4,#04AH
0066D7 75FF02            MOV      SFRPAGE,#02H
0066DA 75DF49            MOV      SDCON5,#049H
0066DD 75FF01            MOV      SFRPAGE,#01H
0066E0 43D304            ORL      RES1,#04H
0066E3 75FF01            MOV      SFRPAGE,#01H
0066E6 53D367            ANL      RES1,#067H
0066E9 E4                CLR      A
0066EA F5FF              MOV      SFRPAGE,A
0066EC 53E6BF            ANL      RES3,#0BFH
0066EF 75FF01            MOV      SFRPAGE,#01H
0066F2 75D825            MOV      DFCON2,#025H
0066F5 F5FF              MOV      SFRPAGE,A
0066F7 75B503            MOV      DPLLZXB,#03H
0066FA F5FF              MOV      SFRPAGE,A
0066FC 75B215            MOV      DPLLZXM,#015H
0066FF F5FF              MOV      SFRPAGE,A
006701 75BA02            MOV      DPLLSBITB,#02H
006704 F5FF              MOV      SFRPAGE,A
006706 75AFB3            MOV      DPLLMAGEN,#0B3H
006709 F5FF              MOV      SFRPAGE,A
00670B 75CD0A            MOV      DPLLGPMD6,#0AH
00670E F5FF              MOV      SFRPAGE,A
006710 75CB08            MOV      DPLLGPMD1,#08H
006713 F5FF              MOV      SFRPAGE,A
006715 75CA12            MOV      DPLLGIMD1,#012H
006718 F5FF              MOV      SFRPAGE,A
00671A 75BF0E            MOV      DPLLNRM1,#0EH
00671D F5FF              MOV      SFRPAGE,A
00671F 75CC96            MOV      DPLLGIMD6,#096H
006722 F5FF              MOV      SFRPAGE,A
006724 F5BD              MOV      DPLLSTART,A
006726 F5FF              MOV      SFRPAGE,A
006728 75C281            MOV      DPLLNRM4,#081H
00672B F5FF              MOV      SFRPAGE,A
00672D 75AEE1            MOV      DPLLIBBW,#0E1H
006730 F5FF              MOV      SFRPAGE,A
006732 75DA55            MOV      FHPREAMB,#055H
006735 F5FF              MOV      SFRPAGE,A
006737 75F580            MOV      DMSETUP2,#080H
00673A F5FF              MOV      SFRPAGE,A
00673C 75E903            MOV      DMHSFLT7,#03H
00673F F5FF              MOV      SFRPAGE,A
006741 75E933            MOV      DMHSFLT7,#033H
006744 F5FF              MOV      SFRPAGE,A
006746 75972A            MOV      DMSETUP6,#02AH
006749 75FF01            MOV      SFRPAGE,#01H
00674C 759B42            MOV      GSHSET1,#042H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 152


00674F 759CA4            MOV      GSHSET2,#0A4H
006752 759D29            MOV      GSHSET3,#029H
006755 759E48            MOV      GSHSET4,#048H
006758 759F24            MOV      GSHSET5,#024H
00675B 75A112            MOV      GSHSET6,#012H
00675E 75A312            MOV      GSHSET7,#012H
006761 759AF8            MOV      GSHSETX,#0F8H
006764 20320C            JB       rf_enable,?C0070?ZW_PHY_RF_050X
006767 F5FF              MOV      SFRPAGE,A
006769 439680            ORL      DMSETUP5,#080H
00676C 90120F            MOV      DPTR,#phyRfData+0EH
00676F E0                MOVX     A,@DPTR
006770 4440              ORL      A,#040H
006772 F0                MOVX     @DPTR,A
006773         ?C0070?ZW_PHY_RF_050X:
006773 22                RET      
----- FUNCTION _RF_general_setup (END) -------


----- FUNCTION __RF_set_IF_setting (BEGIN) -----
;---- Variable 'ch' assigned to Register 'R5' ----
;---- Variable 'highside' assigned to Register 'R4' ----
006774 CC                XCH      A,R4
006775 EF                MOV      A,R7
006776 CC                XCH      A,R4
006777 CF                XCH      A,R7
006778 ED                MOV      A,R5
006779 CF                XCH      A,R7
00677A 7401              MOV      A,#01H
00677C 7E00              MOV      R6,#00H
00677E C8                XCH      A,R0
00677F EF                MOV      A,R7
006780 C8                XCH      A,R0
006781 08                INC      R0
006782 8005              SJMP     ?C0301?ZW_PHY_RF_050X
006784         ?C0300?ZW_PHY_RF_050X:
006784 C3                CLR      C
006785 33                RLC      A
006786 CE                XCH      A,R6
006787 33                RLC      A
006788 CE                XCH      A,R6
006789         ?C0301?ZW_PHY_RF_050X:
006789 D8F9              DJNZ     R0,?C0300?ZW_PHY_RF_050X
00678B FF                MOV      R7,A
00678C CD                XCH      A,R5
00678D EC                MOV      A,R4
00678E CD                XCH      A,R5
00678F EF                MOV      A,R7
006790 5D                ANL      A,R5
006791 601B              JZ       ?C0065?ZW_PHY_RF_050X
006793 303118            JNB      rf_enable,?C0065?ZW_PHY_RF_050X
006796 75FF01            MOV      SFRPAGE,#01H
006799 75DCAD            MOV      RFHSIF,#0ADH
00679C 75FF01            MOV      SFRPAGE,#01H
00679F 75DDCD            MOV      RFLSIF,#0CDH
0067A2 E4                CLR      A
0067A3 F5FF              MOV      SFRPAGE,A
0067A5 759A74            MOV      DMLSFLT1,#074H
0067A8 F5FF              MOV      SFRPAGE,A
0067AA 759484            MOV      DMSETUP1,#084H
0067AD 22                RET      
0067AE         ?C0065?ZW_PHY_RF_050X:
0067AE 75FF01            MOV      SFRPAGE,#01H
0067B1 75DC53            MOV      RFHSIF,#053H
0067B4 75FF01            MOV      SFRPAGE,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 153


0067B7 75DD33            MOV      RFLSIF,#033H
0067BA E4                CLR      A
0067BB F5FF              MOV      SFRPAGE,A
0067BD 759A14            MOV      DMLSFLT1,#014H
0067C0 F5FF              MOV      SFRPAGE,A
0067C2 759404            MOV      DMSETUP1,#04H
0067C5 22                RET      
----- FUNCTION __RF_set_IF_setting (END) -------


----- FUNCTION _RF_general_setup_per_ch (BEGIN) -----
0067C6 75FF01            MOV      SFRPAGE,#01H
0067C9 75E465            MOV      SDCON1,#065H
0067CC 75FF01            MOV      SFRPAGE,#01H
0067CF 75D647            MOV      RFCON2,#047H
0067D2 22                RET      
----- FUNCTION _RF_general_setup_per_ch (END) -------


----- FUNCTION _RF_TX_speed_set (BEGIN) -----
;---- Variable 'speed' assigned to Register 'R7' ----
0067D3 75FF01            MOV      SFRPAGE,#01H
0067D6 E5D5              MOV      A,RFCON
0067D8 30E602            JNB      ACC.6,?C0182?ZW_PHY_RF_050X
0067DB C3                CLR      C
0067DC 22                RET      
0067DD         ?C0182?ZW_PHY_RF_050X:
0067DD 53FACF            ANL      MODCTRL,#0CFH
0067E0 EF                MOV      A,R7
0067E1 B40805            CJNE     A,#08H,?C0184?ZW_PHY_RF_050X
0067E4 43FA30            ORL      MODCTRL,#030H
0067E7 8012              SJMP     ?C0185?ZW_PHY_RF_050X
0067E9         ?C0184?ZW_PHY_RF_050X:
0067E9 EF                MOV      A,R7
0067EA B40405            CJNE     A,#04H,?C0186?ZW_PHY_RF_050X
0067ED 43FA20            ORL      MODCTRL,#020H
0067F0 8009              SJMP     ?C0185?ZW_PHY_RF_050X
0067F2         ?C0186?ZW_PHY_RF_050X:
0067F2 EF                MOV      A,R7
0067F3 B40205            CJNE     A,#02H,?C0188?ZW_PHY_RF_050X
0067F6 43FA10            ORL      MODCTRL,#010H
0067F9 8000              SJMP     ?C0185?ZW_PHY_RF_050X
0067FB         ?C0188?ZW_PHY_RF_050X:
0067FB         ?C0185?ZW_PHY_RF_050X:
0067FB D3                SETB     C
0067FC 22                RET      
----- FUNCTION _RF_TX_speed_set (END) -------


----- FUNCTION RF_channel_get (BEGIN) -----
0067FD E5F4              MOV      A,DMCTRL
0067FF 5418              ANL      A,#018H
006801 13                RRC      A
006802 13                RRC      A
006803 13                RRC      A
006804 541F              ANL      A,#01FH
006806 FF                MOV      R7,A
006807 22                RET      
----- FUNCTION RF_channel_get (END) -------


----- FUNCTION RF_RX_speed_get (BEGIN) -----
006808 E5F7              MOV      A,DMSTAT1
00680A 5406              ANL      A,#06H
00680C FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 154


00680D BF0603            CJNE     R7,#06H,?C0223?ZW_PHY_RF_050X
006810 7F08              MOV      R7,#08H
006812 22                RET      
006813         ?C0223?ZW_PHY_RF_050X:
006813 E5F7              MOV      A,DMSTAT1
006815 5406              ANL      A,#06H
006817 FF                MOV      R7,A
006818 BF0403            CJNE     R7,#04H,?C0225?ZW_PHY_RF_050X
00681B 7F04              MOV      R7,#04H
00681D 22                RET      
00681E         ?C0225?ZW_PHY_RF_050X:
00681E E5F7              MOV      A,DMSTAT1
006820 5406              ANL      A,#06H
006822 FF                MOV      R7,A
006823 BF0203            CJNE     R7,#02H,?C0226?ZW_PHY_RF_050X
006826 7F02              MOV      R7,#02H
006828 22                RET      
006829         ?C0226?ZW_PHY_RF_050X:
006829 7F01              MOV      R7,#01H
00682B 22                RET      
----- FUNCTION RF_RX_speed_get (END) -------


----- FUNCTION _RF_TX_power_set (BEGIN) -----
;---- Variable 'power' assigned to Register 'R7' ----
00682C 75FF01            MOV      SFRPAGE,#01H
00682F 8FDA              MOV      RFPOW,R7
006831 22                RET      
----- FUNCTION _RF_TX_power_set (END) -------


----- FUNCTION _wait_until_no_preamble (BEGIN) -----
006832         ?C0282?ZW_PHY_RF_050X:
006832 E5F7              MOV      A,DMSTAT1
006834 30E510            JNB      ACC.5,?C0283?ZW_PHY_RF_050X
006837 E5F7              MOV      A,DMSTAT1
006839 54C0              ANL      A,#0C0H
00683B 7005              JNZ      ?C0285?ZW_PHY_RF_050X
00683D 123F2F            LCALL    phy_timer_runs
006840 40F0              JC       ?C0282?ZW_PHY_RF_050X
006842         ?C0285?ZW_PHY_RF_050X:
006842 12575D            LCALL    stop_phy_timer
006845 C3                CLR      C
006846 22                RET      
006847         ?C0283?ZW_PHY_RF_050X:
006847 D3                SETB     C
006848 22                RET      
----- FUNCTION _wait_until_no_preamble (END) -------


----- FUNCTION _ZW_UART0_zm4102_mode_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
006849 EF                MOV      A,R7
00684A 6007              JZ       ?C0008?ZW_PHY_UART0_050X
00684C 75FF02            MOV      SFRPAGE,#02H
00684F 43E610            ORL      RSETVEC,#010H
006852 22                RET      
006853         ?C0008?ZW_PHY_UART0_050X:
006853 75FF02            MOV      SFRPAGE,#02H
006856 53E6EF            ANL      RSETVEC,#0EFH
006859 22                RET      
----- FUNCTION _ZW_UART0_zm4102_mode_enable (END) -------


----- FUNCTION ZW_UART0_rx_int_clear (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 155


00685A 75ED04            MOV      UARTSTAT,#04H
00685D 22                RET      
----- FUNCTION ZW_UART0_rx_int_clear (END) -------


----- FUNCTION UART0_RX_TX_interrupt (BEGIN) -----
00685E C0E0              PUSH     ACC
006860 C0F0              PUSH     B
006862 C083              PUSH     DPH
006864 C082              PUSH     DPL
006866 C0D0              PUSH     PSW
006868 75D000            MOV      PSW,#00H
00686B C000              PUSH     AR0
00686D C001              PUSH     AR1
00686F C002              PUSH     AR2
006871 C003              PUSH     AR3
006873 C004              PUSH     AR4
006875 C005              PUSH     AR5
006877 C006              PUSH     AR6
006879 C007              PUSH     AR7
00687B C0FF              PUSH     SFRPAGE
00687D 11FB              ACALL    ZW_UART0_rx_int_get
00687F EF                MOV      A,R7
006880 6027              JZ       ?C0002?ZW_CONBUFIO_UART
006882 115A              ACALL    ZW_UART0_rx_int_clear
006884 11EE              ACALL    ZW_UART0_rx_data_get
;---- Variable 'bReceivedByte' assigned to Register 'R7' ----
006886 E570              MOV      A,rxInPtr
006888 C3                CLR      C
006889 9420              SUBB     A,#020H
00688B 4003              JC       ?C0003?ZW_CONBUFIO_UART
00688D 757000            MOV      rxInPtr,#00H
006890         ?C0003?ZW_CONBUFIO_UART:
006890 E574              MOV      A,rxCount
006892 C3                CLR      C
006893 9420              SUBB     A,#020H
006895 500F              JNC      ?C0004?ZW_CONBUFIO_UART
006897 AE70              MOV      R6,rxInPtr
006899 0570              INC      rxInPtr
00689B 74F8              MOV      A,#LOW UARTRxQueue
00689D 2E                ADD      A,R6
00689E 3101              ACALL    ?L?COM0547
0068A0 EF                MOV      A,R7
0068A1 F0                MOVX     @DPTR,A
0068A2 0574              INC      rxCount
0068A4 8003              SJMP     ?C0002?ZW_CONBUFIO_UART
0068A6         ?C0004?ZW_CONBUFIO_UART:
0068A6 757420            MOV      rxCount,#020H
0068A9         ?C0002?ZW_CONBUFIO_UART:
0068A9 11F5              ACALL    ZW_UART0_tx_int_get
0068AB EF                MOV      A,R7
0068AC 6023              JZ       ?C0006?ZW_CONBUFIO_UART
0068AE 11F1              ACALL    ZW_UART0_tx_int_clear
0068B0 E575              MOV      A,txCount
0068B2 D3                SETB     C
0068B3 9400              SUBB     A,#00H
0068B5 401A              JC       ?C0006?ZW_CONBUFIO_UART
0068B7 E573              MOV      A,txOutPtr
0068B9 9420              SUBB     A,#020H
0068BB 4003              JC       ?C0008?ZW_CONBUFIO_UART
0068BD 757300            MOV      txOutPtr,#00H
0068C0         ?C0008?ZW_CONBUFIO_UART:
0068C0 AF73              MOV      R7,txOutPtr
0068C2 0573              INC      txOutPtr
0068C4 7418              MOV      A,#LOW UARTTxQueue
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 156


0068C6 2F                ADD      A,R7
0068C7 1247E4            LCALL    ?L?COM0546
0068CA E0                MOVX     A,@DPTR
0068CB FF                MOV      R7,A
0068CC 1247BB            LCALL    _ZW_UART0_tx_data_set
0068CF 1575              DEC      txCount
0068D1         ?C0006?ZW_CONBUFIO_UART:
0068D1 D0FF              POP      SFRPAGE
0068D3 D007              POP      AR7
0068D5 D006              POP      AR6
0068D7 D005              POP      AR5
0068D9 D004              POP      AR4
0068DB D003              POP      AR3
0068DD D002              POP      AR2
0068DF D001              POP      AR1
0068E1 D000              POP      AR0
0068E3 D0D0              POP      PSW
0068E5 D082              POP      DPL
0068E7 D083              POP      DPH
0068E9 D0F0              POP      B
0068EB D0E0              POP      ACC
0068ED 32                RETI     
----- FUNCTION UART0_RX_TX_interrupt (END) -------


----- FUNCTION ZW_UART0_rx_data_get (BEGIN) -----
;---- Variable 'tmp' assigned to Register 'R7' ----
0068EE AFEF              MOV      R7,UART0BUF
0068F0 22                RET      
----- FUNCTION ZW_UART0_rx_data_get (END) -------


----- FUNCTION ZW_UART0_tx_int_clear (BEGIN) -----
0068F1 75ED02            MOV      UARTSTAT,#02H
0068F4 22                RET      
----- FUNCTION ZW_UART0_tx_int_clear (END) -------


----- FUNCTION ZW_UART0_tx_int_get (BEGIN) -----
0068F5 E5ED              MOV      A,UARTSTAT
0068F7 5402              ANL      A,#02H
0068F9 FF                MOV      R7,A
0068FA 22                RET      
----- FUNCTION ZW_UART0_tx_int_get (END) -------


----- FUNCTION ZW_UART0_rx_int_get (BEGIN) -----
0068FB E5ED              MOV      A,UARTSTAT
0068FD 5404              ANL      A,#04H
0068FF FF                MOV      R7,A
006900 22                RET      
----- FUNCTION ZW_UART0_rx_int_get (END) -------


----- FUNCTION ?L?COM0547 (BEGIN) -----
006901 F582              MOV      DPL,A
006903 E4                CLR      A
006904 3408              ADDC     A,#HIGH UARTRxQueue
006906 F583              MOV      DPH,A
006908 22                RET      
----- FUNCTION ?L?COM0547 (END) -------


----- FUNCTION ZW_SerialGetByte_uart (BEGIN) -----
006909 E572              MOV      A,rxOutPtr
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 157


00690B C3                CLR      C
00690C 9420              SUBB     A,#020H
00690E 4003              JC       ?C0011?ZW_CONBUFIO_UART
006910 E4                CLR      A
006911 F572              MOV      rxOutPtr,A
006913         ?C0011?ZW_CONBUFIO_UART:
006913 AF72              MOV      R7,rxOutPtr
006915 0572              INC      rxOutPtr
006917 74F8              MOV      A,#LOW UARTRxQueue
006919 2F                ADD      A,R7
00691A 3101              ACALL    ?L?COM0547
00691C E0                MOVX     A,@DPTR
00691D FF                MOV      R7,A
;---- Variable 'retVal' assigned to Register 'R7' ----
00691E C2AC              CLR      ES0
006920 E574              MOV      A,rxCount
006922 D3                SETB     C
006923 9400              SUBB     A,#00H
006925 4002              JC       ?C0012?ZW_CONBUFIO_UART
006927 1574              DEC      rxCount
006929         ?C0012?ZW_CONBUFIO_UART:
006929 D2AC              SETB     ES0
00692B 22                RET      
----- FUNCTION ZW_SerialGetByte_uart (END) -------


----- FUNCTION ZW_UART0_rx_data_wait_get (BEGIN) -----
00692C         ?C0013?ZW_PHY_UART0_050X:
00692C E5ED              MOV      A,UARTSTAT
00692E 30E2FB            JNB      ACC.2,?C0013?ZW_PHY_UART0_050X
006931         ?C0014?ZW_PHY_UART0_050X:
006931 75ED04            MOV      UARTSTAT,#04H
;---- Variable 'tmp' assigned to Register 'R7' ----
006934 AFEF              MOV      R7,UART0BUF
006936 22                RET      
----- FUNCTION ZW_UART0_rx_data_wait_get (END) -------


----- FUNCTION _ZW_UART0_tx_send_byte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
006937         ?C0018?ZW_PHY_UART0_050X:
006937 E5ED              MOV      A,UARTSTAT
006939 20E0FB            JB       ACC.0,?C0018?ZW_PHY_UART0_050X
00693C         ?C0019?ZW_PHY_UART0_050X:
00693C 8FEF              MOV      UART0BUF,R7
00693E 22                RET      
----- FUNCTION _ZW_UART0_tx_send_byte (END) -------


----- FUNCTION _ZW_UART0_rx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
00693F EF                MOV      A,R7
006940 6004              JZ       ?C0021?ZW_PHY_UART0_050X
006942 43EC04            ORL      UARTCON,#04H
006945 22                RET      
006946         ?C0021?ZW_PHY_UART0_050X:
006946 53ECFB            ANL      UARTCON,#0FBH
006949 22                RET      
----- FUNCTION _ZW_UART0_rx_enable (END) -------


----- FUNCTION _ZW_UART0_tx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
00694A EF                MOV      A,R7
00694B 6004              JZ       ?C0024?ZW_PHY_UART0_050X
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 158


00694D 43EC08            ORL      UARTCON,#08H
006950 22                RET      
006951         ?C0024?ZW_PHY_UART0_050X:
006951 53ECF7            ANL      UARTCON,#0F7H
006954 22                RET      
----- FUNCTION _ZW_UART0_tx_enable (END) -------


----- FUNCTION NVM_setPageSize256 (BEGIN) -----
006955 90414E            MOV      DPTR,#spiNVMstatus1
006958 E0                MOVX     A,@DPTR
006959 20E01C            JB       ACC.0,?C0054?ZW_PHY_GENERIC_SPI_IF
00695C 7F01              MOV      R7,#01H
00695E 1236C2            LCALL    _ZW_SPI1_enable
006961 12375B            LCALL    NVM_CS_enable
006964 7F3D              MOV      R7,#03DH
006966 1234F2            LCALL    _ZW_SPI1_tx_set
006969 7F2A              MOV      R7,#02AH
00696B 1234F2            LCALL    _ZW_SPI1_tx_set
00696E 7F80              MOV      R7,#080H
006970 1234F2            LCALL    _ZW_SPI1_tx_set
006973 7FA6              MOV      R7,#0A6H
006975 1236BC            LCALL    ?L?COM026C
006978         ?C0054?ZW_PHY_GENERIC_SPI_IF:
006978 22                RET      
----- FUNCTION NVM_setPageSize256 (END) -------


----- FUNCTION NVM_ext_init (BEGIN) -----
006979 7B01              MOV      R3,#01H
00697B 7A41              MOV      R2,#HIGH NVRbNVMChipSelect
00697D 7953              MOV      R1,#LOW NVRbNVMChipSelect
00697F 7D01              MOV      R5,#01H
006981 7F03              MOV      R7,#03H
006983 121C32            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
006986 7A41              MOV      R2,#HIGH NVRbNVMType
006988 795C              MOV      R1,#LOW NVRbNVMType
00698A 7F08              MOV      R7,#08H
00698C 714A              ACALL    ?L?COM042A
00698E 7A41              MOV      R2,#HIGH NVRbNVMSize
006990 7959              MOV      R1,#LOW NVRbNVMSize
006992 7F09              MOV      R7,#09H
006994 7130              ACALL    ?L?COM0593
006996 7A41              MOV      R2,#HIGH NVRbNVMPageSize
006998 7957              MOV      R1,#LOW NVRbNVMPageSize
00699A 7F0B              MOV      R7,#0BH
00699C 7130              ACALL    ?L?COM0593
00699E 904157            MOV      DPTR,#NVRbNVMPageSize
0069A1 123FED            LCALL    ?L?COM03C3
0069A4 6006              JZ       ?C0068?ZW_PHY_GENERIC_SPI_IF
0069A6 BEFF16            CJNE     R6,#0FFH,?C0067?ZW_PHY_GENERIC_SPI_IF
0069A9 BFFF13            CJNE     R7,#0FFH,?C0067?ZW_PHY_GENERIC_SPI_IF
0069AC         ?C0068?ZW_PHY_GENERIC_SPI_IF:
0069AC 7137              ACALL    ?L?COM0525
0069AE 5002              JNC      ?C0072?ZW_PHY_GENERIC_SPI_IF
0069B0 8004              SJMP     ?C0073?ZW_PHY_GENERIC_SPI_IF
0069B2         ?C0072?ZW_PHY_GENERIC_SPI_IF:
0069B2 7140              ACALL    ?L?COM04D0
0069B4 8009              SJMP     ?C0067?ZW_PHY_GENERIC_SPI_IF
0069B6         ?C0073?ZW_PHY_GENERIC_SPI_IF:
0069B6 904157            MOV      DPTR,#NVRbNVMPageSize
0069B9 E4                CLR      A
0069BA F0                MOVX     @DPTR,A
0069BB A3                INC      DPTR
0069BC 7440              MOV      A,#040H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 159


0069BE F0                MOVX     @DPTR,A
0069BF         ?C0067?ZW_PHY_GENERIC_SPI_IF:
0069BF 7137              ACALL    ?L?COM0525
0069C1 5002              JNC      ?C0077?ZW_PHY_GENERIC_SPI_IF
0069C3 8008              SJMP     ?C0078?ZW_PHY_GENERIC_SPI_IF
0069C5         ?C0077?ZW_PHY_GENERIC_SPI_IF:
0069C5 904154            MOV      DPTR,#bNVMAddressSize
0069C8 7403              MOV      A,#03H
0069CA F0                MOVX     @DPTR,A
0069CB 8006              SJMP     ?C0074?ZW_PHY_GENERIC_SPI_IF
0069CD         ?C0078?ZW_PHY_GENERIC_SPI_IF:
0069CD 904154            MOV      DPTR,#bNVMAddressSize
0069D0 7402              MOV      A,#02H
0069D2 F0                MOVX     @DPTR,A
0069D3         ?C0074?ZW_PHY_GENERIC_SPI_IF:
0069D3 904153            MOV      DPTR,#NVRbNVMChipSelect
0069D6 E0                MOVX     A,@DPTR
0069D7 12267F            LCALL    ?C?CCASE
0069DA 69F6              DW       ?C0080?ZW_PHY_GENERIC_SPI_IF
0069DC 04                DB       04H
0069DD 6A01              DW       ?C0081?ZW_PHY_GENERIC_SPI_IF
0069DF 14                DB       014H
0069E0 6A09              DW       ?C0082?ZW_PHY_GENERIC_SPI_IF
0069E2 15                DB       015H
0069E3 6A11              DW       ?C0083?ZW_PHY_GENERIC_SPI_IF
0069E5 17                DB       017H
0069E6 6A27              DW       ?C0086?ZW_PHY_GENERIC_SPI_IF
0069E8 30                DB       030H
0069E9 6A2F              DW       ?C0087?ZW_PHY_GENERIC_SPI_IF
0069EB 34                DB       034H
0069EC 6A37              DW       ?C0088?ZW_PHY_GENERIC_SPI_IF
0069EE 36                DB       036H
0069EF 6A3F              DW       ?C0089?ZW_PHY_GENERIC_SPI_IF
0069F1 37                DB       037H
0069F2 0000              DW       00H
0069F4 6A1C              DW       ?C0085?ZW_PHY_GENERIC_SPI_IF
0069F6         ?C0080?ZW_PHY_GENERIC_SPI_IF:
0069F6 75FF01            MOV      SFRPAGE,#01H
0069F9 5368EF            ANL      P0ShadowDIR,#0EFH
0069FC 8568FD            MOV      P0DIR,P0ShadowDIR
0069FF 8047              SJMP     ?C0079?ZW_PHY_GENERIC_SPI_IF
006A01         ?C0081?ZW_PHY_GENERIC_SPI_IF:
006A01 75FF01            MOV      SFRPAGE,#01H
006A04 5369EF            ANL      P1ShadowDIR,#0EFH
006A07 800E              SJMP     ?C0201?ZW_PHY_GENERIC_SPI_IF
006A09         ?C0082?ZW_PHY_GENERIC_SPI_IF:
006A09 75FF01            MOV      SFRPAGE,#01H
006A0C 5369DF            ANL      P1ShadowDIR,#0DFH
006A0F         
006A0F 8006              SJMP     ?C0201?ZW_PHY_GENERIC_SPI_IF
006A11         ?C0083?ZW_PHY_GENERIC_SPI_IF:
006A11 75FF01            MOV      SFRPAGE,#01H
006A14 53697F            ANL      P1ShadowDIR,#07FH
006A17         
006A17 8569C9            MOV      P1DIR,P1ShadowDIR
006A1A 802C              SJMP     ?C0079?ZW_PHY_GENERIC_SPI_IF
006A1C         ?C0085?ZW_PHY_GENERIC_SPI_IF:
006A1C 75FF01            MOV      SFRPAGE,#01H
006A1F 536ADF            ANL      P2ShadowDIR,#0DFH
006A22 856ACA            MOV      P2DIR,P2ShadowDIR
006A25 8021              SJMP     ?C0079?ZW_PHY_GENERIC_SPI_IF
006A27         ?C0086?ZW_PHY_GENERIC_SPI_IF:
006A27 75FF01            MOV      SFRPAGE,#01H
006A2A 536BFE            ANL      P3ShadowDIR,#0FEH
006A2D 8016              SJMP     ?C0204?ZW_PHY_GENERIC_SPI_IF
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 160


006A2F         ?C0087?ZW_PHY_GENERIC_SPI_IF:
006A2F 75FF01            MOV      SFRPAGE,#01H
006A32 536BEF            ANL      P3ShadowDIR,#0EFH
006A35         
006A35 800E              SJMP     ?C0204?ZW_PHY_GENERIC_SPI_IF
006A37         ?C0088?ZW_PHY_GENERIC_SPI_IF:
006A37 75FF01            MOV      SFRPAGE,#01H
006A3A 536BBF            ANL      P3ShadowDIR,#0BFH
006A3D         
006A3D 8006              SJMP     ?C0204?ZW_PHY_GENERIC_SPI_IF
006A3F         ?C0089?ZW_PHY_GENERIC_SPI_IF:
006A3F 75FF01            MOV      SFRPAGE,#01H
006A42 536B7F            ANL      P3ShadowDIR,#07FH
006A45         
006A45 856BCB            MOV      P3DIR,P3ShadowDIR
006A48         ?C0079?ZW_PHY_GENERIC_SPI_IF:
006A48 12363E            LCALL    NVM_CS_disable
006A4B 7F11              MOV      R7,#011H
006A4D 7122              ACALL    _ZW_SPI1_init
006A4F E4                CLR      A
006A50 FF                MOV      R7,A
006A51 12348A            LCALL    _NVM_ext_deeppowerdown
006A54 1234FA            LCALL    NVM_read_id
006A57 904151            MOV      DPTR,#bNVMWriteCommand
006A5A 7402              MOV      A,#02H
006A5C F0                MOVX     @DPTR,A
006A5D 904155            MOV      DPTR,#memoryType
006A60 E0                MOVX     A,@DPTR
006A61 247F              ADD      A,#07FH
006A63 6009              JZ       ?C0092?ZW_PHY_GENERIC_SPI_IF
006A65 04                INC      A
006A66 7015              JNZ      ?C0090?ZW_PHY_GENERIC_SPI_IF
006A68         ?C0091?ZW_PHY_GENERIC_SPI_IF:
006A68 7128              ACALL    ?L?COM0524
006A6A 740A              MOV      A,#0AH
006A6C 8006              SJMP     ?C0205?ZW_PHY_GENERIC_SPI_IF
006A6E         ?C0092?ZW_PHY_GENERIC_SPI_IF:
006A6E 3155              ACALL    NVM_setPageSize256
006A70 7128              ACALL    ?L?COM0524
006A72 7458              MOV      A,#058H
006A74         
006A74 F0                MOVX     @DPTR,A
006A75 904154            MOV      DPTR,#bNVMAddressSize
006A78 7403              MOV      A,#03H
006A7A F0                MOVX     @DPTR,A
006A7B 7140              ACALL    ?L?COM04D0
006A7D         ?C0090?ZW_PHY_GENERIC_SPI_IF:
006A7D 904156            MOV      DPTR,#memoryCapacity
006A80 E0                MOVX     A,@DPTR
006A81 F4                CPL      A
006A82 6002              JZ       $ + 4H
006A84 611F              AJMP     ?C0094?ZW_PHY_GENERIC_SPI_IF
006A86 904159            MOV      DPTR,#NVRbNVMSize
006A89 E0                MOVX     A,@DPTR
006A8A FE                MOV      R6,A
006A8B A3                INC      DPTR
006A8C E0                MOVX     A,@DPTR
006A8D FF                MOV      R7,A
006A8E 6410              XRL      A,#010H
006A90 4E                ORL      A,R6
006A91 7006              JNZ      ?C0095?ZW_PHY_GENERIC_SPI_IF
006A93 904156            MOV      DPTR,#memoryCapacity
006A96 740E              MOV      A,#0EH
006A98 F0                MOVX     @DPTR,A
006A99         ?C0095?ZW_PHY_GENERIC_SPI_IF:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 161


006A99 EF                MOV      A,R7
006A9A 6420              XRL      A,#020H
006A9C 4E                ORL      A,R6
006A9D 7006              JNZ      ?C0096?ZW_PHY_GENERIC_SPI_IF
006A9F 904156            MOV      DPTR,#memoryCapacity
006AA2 740F              MOV      A,#0FH
006AA4 F0                MOVX     @DPTR,A
006AA5         ?C0096?ZW_PHY_GENERIC_SPI_IF:
006AA5 EF                MOV      A,R7
006AA6 6440              XRL      A,#040H
006AA8 4E                ORL      A,R6
006AA9 7006              JNZ      ?C0097?ZW_PHY_GENERIC_SPI_IF
006AAB 904156            MOV      DPTR,#memoryCapacity
006AAE 7410              MOV      A,#010H
006AB0 F0                MOVX     @DPTR,A
006AB1         ?C0097?ZW_PHY_GENERIC_SPI_IF:
006AB1 EF                MOV      A,R7
006AB2 6480              XRL      A,#080H
006AB4 4E                ORL      A,R6
006AB5 7006              JNZ      ?C0098?ZW_PHY_GENERIC_SPI_IF
006AB7 904156            MOV      DPTR,#memoryCapacity
006ABA 7411              MOV      A,#011H
006ABC F0                MOVX     @DPTR,A
006ABD         ?C0098?ZW_PHY_GENERIC_SPI_IF:
006ABD E4                CLR      A
006ABE B5070A            CJNE     A,AR7,?C0099?ZW_PHY_GENERIC_SPI_IF
006AC1 EE                MOV      A,R6
006AC2 B40106            CJNE     A,#01H,?C0099?ZW_PHY_GENERIC_SPI_IF
006AC5 904156            MOV      DPTR,#memoryCapacity
006AC8 7412              MOV      A,#012H
006ACA F0                MOVX     @DPTR,A
006ACB         ?C0099?ZW_PHY_GENERIC_SPI_IF:
006ACB E4                CLR      A
006ACC B5070A            CJNE     A,AR7,?C0100?ZW_PHY_GENERIC_SPI_IF
006ACF EE                MOV      A,R6
006AD0 B40206            CJNE     A,#02H,?C0100?ZW_PHY_GENERIC_SPI_IF
006AD3 904156            MOV      DPTR,#memoryCapacity
006AD6 7413              MOV      A,#013H
006AD8 F0                MOVX     @DPTR,A
006AD9         ?C0100?ZW_PHY_GENERIC_SPI_IF:
006AD9 E4                CLR      A
006ADA B5070A            CJNE     A,AR7,?C0101?ZW_PHY_GENERIC_SPI_IF
006ADD EE                MOV      A,R6
006ADE B40406            CJNE     A,#04H,?C0101?ZW_PHY_GENERIC_SPI_IF
006AE1 904156            MOV      DPTR,#memoryCapacity
006AE4 7414              MOV      A,#014H
006AE6 F0                MOVX     @DPTR,A
006AE7         ?C0101?ZW_PHY_GENERIC_SPI_IF:
006AE7 E4                CLR      A
006AE8 B5070A            CJNE     A,AR7,?C0102?ZW_PHY_GENERIC_SPI_IF
006AEB EE                MOV      A,R6
006AEC B40806            CJNE     A,#08H,?C0102?ZW_PHY_GENERIC_SPI_IF
006AEF 904156            MOV      DPTR,#memoryCapacity
006AF2 7415              MOV      A,#015H
006AF4 F0                MOVX     @DPTR,A
006AF5         ?C0102?ZW_PHY_GENERIC_SPI_IF:
006AF5 E4                CLR      A
006AF6 B5070A            CJNE     A,AR7,?C0103?ZW_PHY_GENERIC_SPI_IF
006AF9 EE                MOV      A,R6
006AFA B41006            CJNE     A,#010H,?C0103?ZW_PHY_GENERIC_SPI_IF
006AFD 904156            MOV      DPTR,#memoryCapacity
006B00 7416              MOV      A,#016H
006B02 F0                MOVX     @DPTR,A
006B03         ?C0103?ZW_PHY_GENERIC_SPI_IF:
006B03 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 162


006B04 B5070A            CJNE     A,AR7,?C0104?ZW_PHY_GENERIC_SPI_IF
006B07 EE                MOV      A,R6
006B08 B42006            CJNE     A,#020H,?C0104?ZW_PHY_GENERIC_SPI_IF
006B0B 904156            MOV      DPTR,#memoryCapacity
006B0E 7417              MOV      A,#017H
006B10 F0                MOVX     @DPTR,A
006B11         ?C0104?ZW_PHY_GENERIC_SPI_IF:
006B11 E4                CLR      A
006B12 B5070A            CJNE     A,AR7,?C0094?ZW_PHY_GENERIC_SPI_IF
006B15 EE                MOV      A,R6
006B16 B44006            CJNE     A,#040H,?C0094?ZW_PHY_GENERIC_SPI_IF
006B19 904156            MOV      DPTR,#memoryCapacity
006B1C 7418              MOV      A,#018H
006B1E F0                MOVX     @DPTR,A
006B1F         ?C0094?ZW_PHY_GENERIC_SPI_IF:
006B1F 0237BA            LJMP     NVM_clearStatusReg
----- FUNCTION NVM_ext_init (END) -------


----- FUNCTION _ZW_SPI1_init (BEGIN) -----
;---- Variable 'bSpiInit' assigned to Register 'R7' ----
006B22 EF                MOV      A,R7
006B23 4420              ORL      A,#020H
006B25 F5FE              MOV      SPI1CON,A
006B27 22                RET      
----- FUNCTION _ZW_SPI1_init (END) -------


----- FUNCTION ?L?COM0524 (BEGIN) -----
006B28 7F10              MOV      R7,#010H
006B2A 7122              ACALL    _ZW_SPI1_init
006B2C 904151            MOV      DPTR,#bNVMWriteCommand
006B2F 22                RET      
----- FUNCTION ?L?COM0524 (END) -------


----- FUNCTION ?L?COM0593 (BEGIN) -----
006B30 7B01              MOV      R3,#01H
006B32 7D02              MOV      R5,#02H
006B34 021C32            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION ?L?COM0593 (END) -------


----- FUNCTION ?L?COM0525 (BEGIN) -----
006B37 90415C            MOV      DPTR,#NVRbNVMType
006B3A E0                MOVX     A,@DPTR
006B3B 24FE              ADD      A,#0FEH
006B3D 24FD              ADD      A,#0FDH
006B3F 22                RET      
----- FUNCTION ?L?COM0525 (END) -------


----- FUNCTION ?L?COM04D0 (BEGIN) -----
006B40 904157            MOV      DPTR,#NVRbNVMPageSize
006B43 7401              MOV      A,#01H
006B45 F0                MOVX     @DPTR,A
006B46 A3                INC      DPTR
006B47 E4                CLR      A
006B48 F0                MOVX     @DPTR,A
006B49 22                RET      
----- FUNCTION ?L?COM04D0 (END) -------


----- FUNCTION ?L?COM042A (BEGIN) -----
006B4A 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 163


006B4C 7D01              MOV      R5,#01H
006B4E 021C32            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION ?L?COM042A (END) -------


----- FUNCTION _NVM_get_id (BEGIN) -----
;---- Variable 'pNVM_type' assigned to Register 'R1/R2/R3' ----
006B51 904150            MOV      DPTR,#manufacturerID
006B54 E0                MOVX     A,@DPTR
006B55 12203B            LCALL    ?C?CSTPTR
006B58 904155            MOV      DPTR,#memoryType
006B5B E0                MOVX     A,@DPTR
006B5C 7168              ACALL    ?L?COM0469
006B5E 904156            MOV      DPTR,#memoryCapacity
006B61 E0                MOVX     A,@DPTR
006B62 900002            MOV      DPTR,#02H
006B65 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _NVM_get_id (END) -------


----- FUNCTION ?L?COM0469 (BEGIN) -----
006B68 900001            MOV      DPTR,#01H
006B6B 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0469 (END) -------


----- FUNCTION NVM_ext_off (BEGIN) -----
006B6E E4                CLR      A
006B6F FF                MOV      R7,A
006B70 0236C2            LJMP     _ZW_SPI1_enable
----- FUNCTION NVM_ext_off (END) -------


----- FUNCTION NVM_ext_read_status (BEGIN) -----
006B73 904152            MOV      DPTR,#bNVMstatusReadDisturbed
006B76 E0                MOVX     A,@DPTR
006B77 FF                MOV      R7,A
006B78 22                RET      
----- FUNCTION NVM_ext_read_status (END) -------


----- FUNCTION NVM_ext_clear_status (BEGIN) -----
006B79 E4                CLR      A
006B7A 904152            MOV      DPTR,#bNVMstatusReadDisturbed
006B7D F0                MOVX     @DPTR,A
006B7E 22                RET      
----- FUNCTION NVM_ext_clear_status (END) -------


----- FUNCTION _ZW_FH_rx_init (BEGIN) -----
;---- Variable 'wRxAddress' assigned to Register 'R6/R7' ----
;---- Variable 'bRxLen' assigned to Register 'R5' ----
006B7F E4                CLR      A
006B80 F5FF              MOV      SFRPAGE,A
006B82 75D102            MOV      FHCON1,#02H
006B85         ?C0008?ZW_PHY_FRAME_HANDLER_050X:
006B85 E5D1              MOV      A,FHCON1
006B87 20E0FB            JB       ACC.0,?C0008?ZW_PHY_FRAME_HANDLER_050X
006B8A         ?C0009?ZW_PHY_FRAME_HANDLER_050X:
006B8A E4                CLR      A
006B8B F5D1              MOV      FHCON1,A
006B8D F5FF              MOV      SFRPAGE,A
006B8F EF                MOV      A,R7
006B90 71A0              ACALL    ?L?COM0522
006B92 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 164


006B93 540F              ANL      A,#0FH
006B95 42D6              ORL      FHRAMBUF,A
006B97 E4                CLR      A
006B98 F5FF              MOV      SFRPAGE,A
006B9A CF                XCH      A,R7
006B9B ED                MOV      A,R5
006B9C CF                XCH      A,R7
006B9D 8FD4              MOV      FHFRML0,R7
006B9F 22                RET      
----- FUNCTION _ZW_FH_rx_init (END) -------


----- FUNCTION ?L?COM0522 (BEGIN) -----
006BA0 F5D7              MOV      FHRBAL0,A
006BA2 E4                CLR      A
006BA3 F5FF              MOV      SFRPAGE,A
006BA5 53D6F0            ANL      FHRAMBUF,#0F0H
006BA8 22                RET      
----- FUNCTION ?L?COM0522 (END) -------


----- FUNCTION _ZW_FH_buf1addr_set (BEGIN) -----
;---- Variable 'wAddress' assigned to Register 'R6/R7' ----
006BA9 E4                CLR      A
006BAA F5FF              MOV      SFRPAGE,A
006BAC EF                MOV      A,R7
006BAD F5D8              MOV      FHRBAL1,A
006BAF E4                CLR      A
006BB0 F5FF              MOV      SFRPAGE,A
006BB2 53D60F            ANL      FHRAMBUF,#0FH
006BB5 EE                MOV      A,R6
006BB6 540F              ANL      A,#0FH
006BB8 71BD              ACALL    ?L?COM0445
006BBA 42D6              ORL      FHRAMBUF,A
006BBC 22                RET      
----- FUNCTION _ZW_FH_buf1addr_set (END) -------


----- FUNCTION ?L?COM0445 (BEGIN) -----
006BBD C4                SWAP     A
006BBE F8                MOV      R0,A
006BBF 54F0              ANL      A,#0F0H
006BC1 C8                XCH      A,R0
006BC2 E4                CLR      A
006BC3 C4                SWAP     A
006BC4 540F              ANL      A,#0FH
006BC6 48                ORL      A,R0
006BC7 22                RET      
----- FUNCTION ?L?COM0445 (END) -------


----- FUNCTION _ZW_FH_rx_buflen_set (BEGIN) -----
;---- Variable 'bBuflen' assigned to Register 'R7' ----
006BC8 E4                CLR      A
006BC9 F5FF              MOV      SFRPAGE,A
006BCB 8FD4              MOV      FHFRML0,R7
006BCD 22                RET      
----- FUNCTION _ZW_FH_rx_buflen_set (END) -------


----- FUNCTION ZW_FH_status_get (BEGIN) -----
006BCE E4                CLR      A
006BCF F5FF              MOV      SFRPAGE,A
006BD1 E5D1              MOV      A,FHCON1
006BD3 5401              ANL      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 165


006BD5 33                RLC      A
006BD6 33                RLC      A
006BD7 33                RLC      A
006BD8 54F8              ANL      A,#0F8H
006BDA FF                MOV      R7,A
;---- Variable 'temp_' assigned to Register 'R7' ----
006BDB E4                CLR      A
006BDC F5FF              MOV      SFRPAGE,A
006BDE E5D3              MOV      A,FHSTAT
006BE0 5407              ANL      A,#07H
006BE2 4F                ORL      A,R7
006BE3 FF                MOV      R7,A
006BE4 22                RET      
----- FUNCTION ZW_FH_status_get (END) -------


----- FUNCTION _ZW_SPI1_int_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
006BE5 EF                MOV      A,R7
006BE6 B40109            CJNE     A,#01H,?C0001?ZW_PHY_SPI1_050X
006BE9 D2AD              SETB     ESPI1
006BEB 75FF01            MOV      SFRPAGE,#01H
006BEE 43AE40            ORL      INTCON,#040H
006BF1 22                RET      
006BF2         ?C0001?ZW_PHY_SPI1_050X:
006BF2 C2AD              CLR      ESPI1
006BF4 75FF01            MOV      SFRPAGE,#01H
006BF7 53AEBF            ANL      INTCON,#0BFH
006BFA 22                RET      
----- FUNCTION _ZW_SPI1_int_enable (END) -------


----- FUNCTION ZW_SPI1_int_clear (BEGIN) -----
006BFB 75C801            MOV      SPISTAT,#01H
006BFE 22                RET      
----- FUNCTION ZW_SPI1_int_clear (END) -------


----- FUNCTION ZW_SPI1_coll_get (BEGIN) -----
006BFF E5C8              MOV      A,SPISTAT
006C01 5402              ANL      A,#02H
006C03 FF                MOV      R7,A
;---- Variable 'r' assigned to Register 'R7' ----
006C04 75C802            MOV      SPISTAT,#02H
006C07 22                RET      
----- FUNCTION ZW_SPI1_coll_get (END) -------


----- FUNCTION ZW_SPI1_active_get (BEGIN) -----
006C08 E5C8              MOV      A,SPISTAT
006C0A 5404              ANL      A,#04H
006C0C FF                MOV      R7,A
006C0D 22                RET      
----- FUNCTION ZW_SPI1_active_get (END) -------


----- FUNCTION ZW_SPI1_int_get (BEGIN) -----
006C0E E5C8              MOV      A,SPISTAT
006C10 5401              ANL      A,#01H
006C12 FF                MOV      R7,A
006C13 22                RET      
----- FUNCTION ZW_SPI1_int_get (END) -------


----- FUNCTION ?L?COM04DC (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 166


006C14 E0                MOVX     A,@DPTR
006C15 24FF              ADD      A,#0FFH
006C17 923E              MOV      ?_ZW_PortPinSet?BIT,C
----- FUNCTION _ZW_PortPinSet (BEGIN) -----
;---- Variable 'bPortPin' assigned to Register 'R7' ----
006C19 EF                MOV      A,R7
006C1A 5470              ANL      A,#070H
006C1C 24F0              ADD      A,#0F0H
006C1E 6028              JZ       ?C0005?ZW_PORTPIN
006C20 24F0              ADD      A,#0F0H
006C22 6040              JZ       ?C0008?ZW_PORTPIN
006C24 24F0              ADD      A,#0F0H
006C26 6058              JZ       ?C0011?ZW_PORTPIN
006C28 2430              ADD      A,#030H
006C2A 706F              JNZ      ?C0015?ZW_PORTPIN
006C2C         ?C0002?ZW_PORTPIN:
006C2C 303E0C            JNB      bVal,?C0003?ZW_PORTPIN
006C2F 919F              ACALL    ?L?COM0090
006C31 08                INC      R0
006C32 8002              SJMP     ?C0053?ZW_PORTPIN
006C34         ?C0052?ZW_PORTPIN:
006C34 C3                CLR      C
006C35 33                RLC      A
006C36         ?C0053?ZW_PORTPIN:
006C36 D8FC              DJNZ     R0,?C0052?ZW_PORTPIN
006C38 4280              ORL      P0,A
006C3A 22                RET      
006C3B         ?C0003?ZW_PORTPIN:
006C3B 919F              ACALL    ?L?COM0090
006C3D 08                INC      R0
006C3E 8002              SJMP     ?C0055?ZW_PORTPIN
006C40         ?C0054?ZW_PORTPIN:
006C40 C3                CLR      C
006C41 33                RLC      A
006C42         ?C0055?ZW_PORTPIN:
006C42 D8FC              DJNZ     R0,?C0054?ZW_PORTPIN
006C44 F4                CPL      A
006C45 5280              ANL      P0,A
006C47 22                RET      
006C48         ?C0005?ZW_PORTPIN:
006C48 303E0C            JNB      bVal,?C0006?ZW_PORTPIN
006C4B 919F              ACALL    ?L?COM0090
006C4D 08                INC      R0
006C4E 8002              SJMP     ?C0057?ZW_PORTPIN
006C50         ?C0056?ZW_PORTPIN:
006C50 C3                CLR      C
006C51 33                RLC      A
006C52         ?C0057?ZW_PORTPIN:
006C52 D8FC              DJNZ     R0,?C0056?ZW_PORTPIN
006C54 4290              ORL      P1,A
006C56 22                RET      
006C57         ?C0006?ZW_PORTPIN:
006C57 919F              ACALL    ?L?COM0090
006C59 08                INC      R0
006C5A 8002              SJMP     ?C0059?ZW_PORTPIN
006C5C         ?C0058?ZW_PORTPIN:
006C5C C3                CLR      C
006C5D 33                RLC      A
006C5E         ?C0059?ZW_PORTPIN:
006C5E D8FC              DJNZ     R0,?C0058?ZW_PORTPIN
006C60 F4                CPL      A
006C61 5290              ANL      P1,A
006C63 22                RET      
006C64         ?C0008?ZW_PORTPIN:
006C64 303E0C            JNB      bVal,?C0009?ZW_PORTPIN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 167


006C67 919F              ACALL    ?L?COM0090
006C69 08                INC      R0
006C6A 8002              SJMP     ?C0061?ZW_PORTPIN
006C6C         ?C0060?ZW_PORTPIN:
006C6C C3                CLR      C
006C6D 33                RLC      A
006C6E         ?C0061?ZW_PORTPIN:
006C6E D8FC              DJNZ     R0,?C0060?ZW_PORTPIN
006C70 42A0              ORL      P2,A
006C72 22                RET      
006C73         ?C0009?ZW_PORTPIN:
006C73 919F              ACALL    ?L?COM0090
006C75 08                INC      R0
006C76 8002              SJMP     ?C0063?ZW_PORTPIN
006C78         ?C0062?ZW_PORTPIN:
006C78 C3                CLR      C
006C79 33                RLC      A
006C7A         ?C0063?ZW_PORTPIN:
006C7A D8FC              DJNZ     R0,?C0062?ZW_PORTPIN
006C7C F4                CPL      A
006C7D 52A0              ANL      P2,A
006C7F 22                RET      
006C80         ?C0011?ZW_PORTPIN:
006C80 303E0C            JNB      bVal,?C0012?ZW_PORTPIN
006C83 919F              ACALL    ?L?COM0090
006C85 08                INC      R0
006C86 8002              SJMP     ?C0065?ZW_PORTPIN
006C88         ?C0064?ZW_PORTPIN:
006C88 C3                CLR      C
006C89 33                RLC      A
006C8A         ?C0065?ZW_PORTPIN:
006C8A D8FC              DJNZ     R0,?C0064?ZW_PORTPIN
006C8C 42B0              ORL      P3,A
006C8E 22                RET      
006C8F         ?C0012?ZW_PORTPIN:
006C8F 919F              ACALL    ?L?COM0090
006C91 08                INC      R0
006C92 8002              SJMP     ?C0067?ZW_PORTPIN
006C94         ?C0066?ZW_PORTPIN:
006C94 C3                CLR      C
006C95 33                RLC      A
006C96         ?C0067?ZW_PORTPIN:
006C96 D8FC              DJNZ     R0,?C0066?ZW_PORTPIN
006C98 F4                CPL      A
006C99 52B0              ANL      P3,A
006C9B         ?C0015?ZW_PORTPIN:
006C9B 22                RET      
----- FUNCTION _ZW_PortPinSet (END) -------


----- FUNCTION ?L?COM008F (BEGIN) -----
006C9C 75FF01            MOV      SFRPAGE,#01H
006C9F         ?L?COM0090:
006C9F EF                MOV      A,R7
006CA0 5407              ANL      A,#07H
006CA2 FF                MOV      R7,A
006CA3 7401              MOV      A,#01H
006CA5 A807              MOV      R0,AR7
006CA7 22                RET      
----- FUNCTION ?L?COM008F (END) -------


----- FUNCTION _ZW_PortPinIn (BEGIN) -----
;---- Variable 'bPortPin' assigned to Register 'R7' ----
006CA8 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 168


006CA9 5470              ANL      A,#070H
006CAB 24F0              ADD      A,#0F0H
006CAD 6018              JZ       ?C0040?ZW_PORTPIN
006CAF 24F0              ADD      A,#0F0H
006CB1 6020              JZ       ?C0041?ZW_PORTPIN
006CB3 24F0              ADD      A,#0F0H
006CB5 6028              JZ       ?C0042?ZW_PORTPIN
006CB7 2430              ADD      A,#030H
006CB9 702F              JNZ      ?C0044?ZW_PORTPIN
006CBB         ?C0039?ZW_PORTPIN:
006CBB 919C              ACALL    ?L?COM008F
006CBD 08                INC      R0
006CBE 8002              SJMP     ?C0077?ZW_PORTPIN
006CC0         ?C0076?ZW_PORTPIN:
006CC0 C3                CLR      C
006CC1 33                RLC      A
006CC2         ?C0077?ZW_PORTPIN:
006CC2 D8FC              DJNZ     R0,?C0076?ZW_PORTPIN
006CC4 42FD              ORL      P0DIR,A
006CC6 22                RET      
006CC7         ?C0040?ZW_PORTPIN:
006CC7 919C              ACALL    ?L?COM008F
006CC9 08                INC      R0
006CCA 8002              SJMP     ?C0079?ZW_PORTPIN
006CCC         ?C0078?ZW_PORTPIN:
006CCC C3                CLR      C
006CCD 33                RLC      A
006CCE         ?C0079?ZW_PORTPIN:
006CCE D8FC              DJNZ     R0,?C0078?ZW_PORTPIN
006CD0 42C9              ORL      P1DIR,A
006CD2 22                RET      
006CD3         ?C0041?ZW_PORTPIN:
006CD3 919C              ACALL    ?L?COM008F
006CD5 08                INC      R0
006CD6 8002              SJMP     ?C0081?ZW_PORTPIN
006CD8         ?C0080?ZW_PORTPIN:
006CD8 C3                CLR      C
006CD9 33                RLC      A
006CDA         ?C0081?ZW_PORTPIN:
006CDA D8FC              DJNZ     R0,?C0080?ZW_PORTPIN
006CDC 42CA              ORL      P2DIR,A
006CDE 22                RET      
006CDF         ?C0042?ZW_PORTPIN:
006CDF 919C              ACALL    ?L?COM008F
006CE1 08                INC      R0
006CE2 8002              SJMP     ?C0083?ZW_PORTPIN
006CE4         ?C0082?ZW_PORTPIN:
006CE4 C3                CLR      C
006CE5 33                RLC      A
006CE6         ?C0083?ZW_PORTPIN:
006CE6 D8FC              DJNZ     R0,?C0082?ZW_PORTPIN
006CE8 42CB              ORL      P3DIR,A
006CEA         ?C0044?ZW_PORTPIN:
006CEA 22                RET      
----- FUNCTION _ZW_PortPinIn (END) -------


----- FUNCTION _ZW_PortPinOut (BEGIN) -----
;---- Variable 'bPortPin' assigned to Register 'R7' ----
006CEB EF                MOV      A,R7
006CEC 5470              ANL      A,#070H
006CEE 24F0              ADD      A,#0F0H
006CF0 6019              JZ       ?C0047?ZW_PORTPIN
006CF2 24F0              ADD      A,#0F0H
006CF4 6022              JZ       ?C0048?ZW_PORTPIN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 169


006CF6 24F0              ADD      A,#0F0H
006CF8 602B              JZ       ?C0049?ZW_PORTPIN
006CFA 2430              ADD      A,#030H
006CFC 7033              JNZ      ?C0051?ZW_PORTPIN
006CFE         ?C0046?ZW_PORTPIN:
006CFE 919C              ACALL    ?L?COM008F
006D00 08                INC      R0
006D01 8002              SJMP     ?C0085?ZW_PORTPIN
006D03         ?C0084?ZW_PORTPIN:
006D03 C3                CLR      C
006D04 33                RLC      A
006D05         ?C0085?ZW_PORTPIN:
006D05 D8FC              DJNZ     R0,?C0084?ZW_PORTPIN
006D07 F4                CPL      A
006D08 52FD              ANL      P0DIR,A
006D0A 22                RET      
006D0B         ?C0047?ZW_PORTPIN:
006D0B 919C              ACALL    ?L?COM008F
006D0D 08                INC      R0
006D0E 8002              SJMP     ?C0087?ZW_PORTPIN
006D10         ?C0086?ZW_PORTPIN:
006D10 C3                CLR      C
006D11 33                RLC      A
006D12         ?C0087?ZW_PORTPIN:
006D12 D8FC              DJNZ     R0,?C0086?ZW_PORTPIN
006D14 F4                CPL      A
006D15 52C9              ANL      P1DIR,A
006D17 22                RET      
006D18         ?C0048?ZW_PORTPIN:
006D18 919C              ACALL    ?L?COM008F
006D1A 08                INC      R0
006D1B 8002              SJMP     ?C0089?ZW_PORTPIN
006D1D         ?C0088?ZW_PORTPIN:
006D1D C3                CLR      C
006D1E 33                RLC      A
006D1F         ?C0089?ZW_PORTPIN:
006D1F D8FC              DJNZ     R0,?C0088?ZW_PORTPIN
006D21 F4                CPL      A
006D22 52CA              ANL      P2DIR,A
006D24 22                RET      
006D25         ?C0049?ZW_PORTPIN:
006D25 919C              ACALL    ?L?COM008F
006D27 08                INC      R0
006D28 8002              SJMP     ?C0091?ZW_PORTPIN
006D2A         ?C0090?ZW_PORTPIN:
006D2A C3                CLR      C
006D2B 33                RLC      A
006D2C         ?C0091?ZW_PORTPIN:
006D2C D8FC              DJNZ     R0,?C0090?ZW_PORTPIN
006D2E F4                CPL      A
006D2F 52CB              ANL      P3DIR,A
006D31         ?C0051?ZW_PORTPIN:
006D31 22                RET      
----- FUNCTION _ZW_PortPinOut (END) -------


----- FUNCTION _ZW_PortPinGet (BEGIN) -----
;---- Variable 'bPortPin' assigned to Register 'R5' ----
006D32 AD07              MOV      R5,AR7
006D34 ED                MOV      A,R5
006D35 5470              ANL      A,#070H
006D37 24F0              ADD      A,#0F0H
006D39 601F              JZ       ?C0021?ZW_PORTPIN
006D3B 24F0              ADD      A,#0F0H
006D3D 6032              JZ       ?C0024?ZW_PORTPIN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 170


006D3F 24F0              ADD      A,#0F0H
006D41 6041              JZ       ?C0027?ZW_PORTPIN
006D43 2430              ADD      A,#030H
006D45 7052              JNZ      ?C0016?ZW_PORTPIN
006D47         ?C0017?ZW_PORTPIN:
006D47 B19B              ACALL    ?L?COM0168
006D49 8005              SJMP     ?C0069?ZW_PORTPIN
006D4B         ?C0068?ZW_PORTPIN:
006D4B C3                CLR      C
006D4C 33                RLC      A
006D4D CE                XCH      A,R6
006D4E 33                RLC      A
006D4F CE                XCH      A,R6
006D50         ?C0069?ZW_PORTPIN:
006D50 D8F9              DJNZ     R0,?C0068?ZW_PORTPIN
006D52 AC80              MOV      R4,P0
006D54 B1A7              ACALL    ?L?COM0485
006D56 6001              JZ       ?C0018?ZW_PORTPIN
006D58 D3                SETB     C
006D59         ?C0018?ZW_PORTPIN:
006D59 22                RET      
006D5A         ?C0021?ZW_PORTPIN:
006D5A B19B              ACALL    ?L?COM0168
006D5C 8005              SJMP     ?C0071?ZW_PORTPIN
006D5E         ?C0070?ZW_PORTPIN:
006D5E C3                CLR      C
006D5F 33                RLC      A
006D60 CE                XCH      A,R6
006D61 33                RLC      A
006D62 CE                XCH      A,R6
006D63         ?C0071?ZW_PORTPIN:
006D63 D8F9              DJNZ     R0,?C0070?ZW_PORTPIN
006D65 FF                MOV      R7,A
006D66 AC90              MOV      R4,P1
006D68 EC                MOV      A,R4
006D69 FB                MOV      R3,A
006D6A EF                MOV      A,R7
006D6B 5B                ANL      A,R3
006D6C C3                CLR      C
006D6D 6001              JZ       ?C0022?ZW_PORTPIN
006D6F D3                SETB     C
006D70         ?C0022?ZW_PORTPIN:
006D70 22                RET      
006D71         ?C0024?ZW_PORTPIN:
006D71 B19B              ACALL    ?L?COM0168
006D73 8005              SJMP     ?C0073?ZW_PORTPIN
006D75         ?C0072?ZW_PORTPIN:
006D75 C3                CLR      C
006D76 33                RLC      A
006D77 CE                XCH      A,R6
006D78 33                RLC      A
006D79 CE                XCH      A,R6
006D7A         ?C0073?ZW_PORTPIN:
006D7A D8F9              DJNZ     R0,?C0072?ZW_PORTPIN
006D7C ACA0              MOV      R4,P2
006D7E B1A7              ACALL    ?L?COM0485
006D80 6001              JZ       ?C0025?ZW_PORTPIN
006D82 D3                SETB     C
006D83         ?C0025?ZW_PORTPIN:
006D83 22                RET      
006D84         ?C0027?ZW_PORTPIN:
006D84 B19B              ACALL    ?L?COM0168
006D86 8005              SJMP     ?C0075?ZW_PORTPIN
006D88         ?C0074?ZW_PORTPIN:
006D88 C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 171


006D89 33                RLC      A
006D8A CE                XCH      A,R6
006D8B 33                RLC      A
006D8C CE                XCH      A,R6
006D8D         ?C0075?ZW_PORTPIN:
006D8D D8F9              DJNZ     R0,?C0074?ZW_PORTPIN
006D8F FF                MOV      R7,A
006D90 ADB0              MOV      R5,P3
006D92 EF                MOV      A,R7
006D93 5D                ANL      A,R5
006D94 C3                CLR      C
006D95 6001              JZ       ?C0028?ZW_PORTPIN
006D97 D3                SETB     C
006D98         ?C0028?ZW_PORTPIN:
006D98 22                RET      
006D99         ?C0016?ZW_PORTPIN:
006D99 C3                CLR      C
006D9A 22                RET      
----- FUNCTION _ZW_PortPinGet (END) -------


----- FUNCTION ?L?COM0168 (BEGIN) -----
006D9B ED                MOV      A,R5
006D9C         ?L?COM0169:
006D9C 5407              ANL      A,#07H
006D9E         ?L?COM016A:
006D9E FF                MOV      R7,A
006D9F 7401              MOV      A,#01H
006DA1 7E00              MOV      R6,#00H
006DA3 A807              MOV      R0,AR7
006DA5 08                INC      R0
006DA6 22                RET      
----- FUNCTION ?L?COM0168 (END) -------


----- FUNCTION ?L?COM0485 (BEGIN) -----
006DA7 FF                MOV      R7,A
006DA8 EC                MOV      A,R4
006DA9 FB                MOV      R3,A
006DAA EF                MOV      A,R7
006DAB 5B                ANL      A,R3
006DAC C3                CLR      C
006DAD 22                RET      
----- FUNCTION ?L?COM0485 (END) -------


----- FUNCTION _ZW_PortGet (BEGIN) -----
;---- Variable 'port' assigned to Register 'R7' ----
006DAE EF                MOV      A,R7
006DAF 14                DEC      A
006DB0 600D              JZ       ?C0034?ZW_PORTPIN
006DB2 14                DEC      A
006DB3 600D              JZ       ?C0035?ZW_PORTPIN
006DB5 14                DEC      A
006DB6 600D              JZ       ?C0036?ZW_PORTPIN
006DB8 2403              ADD      A,#03H
006DBA 700C              JNZ      ?C0031?ZW_PORTPIN
006DBC         ?C0032?ZW_PORTPIN:
006DBC AF80              MOV      R7,P0
006DBE 22                RET      
006DBF         ?C0034?ZW_PORTPIN:
006DBF AF90              MOV      R7,P1
006DC1 22                RET      
006DC2         ?C0035?ZW_PORTPIN:
006DC2 AFA0              MOV      R7,P2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 172


006DC4 22                RET      
006DC5         ?C0036?ZW_PORTPIN:
006DC5 AFB0              MOV      R7,P3
006DC7 22                RET      
006DC8         ?C0031?ZW_PORTPIN:
006DC8 7F00              MOV      R7,#00H
006DCA 22                RET      
----- FUNCTION _ZW_PortGet (END) -------


----- FUNCTION ZW_FinishConfiguration_uart (BEGIN) -----
006DCB D3                SETB     C
006DCC 22                RET      
----- FUNCTION ZW_FinishConfiguration_uart (END) -------


----- FUNCTION ZW_SerialCheck_uart (BEGIN) -----
006DCD AF74              MOV      R7,rxCount
006DCF 22                RET      
----- FUNCTION ZW_SerialCheck_uart (END) -------


----- FUNCTION ZW_SerialTxActive_uart (BEGIN) -----
006DD0 C2AC              CLR      ES0
006DD2 1247C1            LCALL    ZW_UART0_tx_active_get
006DD5 EF                MOV      A,R7
006DD6 7004              JNZ      ?C0022?ZW_CONBUFIO_UART
006DD8 E575              MOV      A,txCount
006DDA 6004              JZ       ?C0020?ZW_CONBUFIO_UART
006DDC         ?C0022?ZW_CONBUFIO_UART:
006DDC 7F01              MOV      R7,#01H
006DDE 8002              SJMP     ?C0021?ZW_CONBUFIO_UART
006DE0         ?C0020?ZW_CONBUFIO_UART:
006DE0 7F00              MOV      R7,#00H
006DE2         ?C0021?ZW_CONBUFIO_UART:
;---- Variable 'x' assigned to Register 'R7' ----
006DE2 D2AC              SETB     ES0
006DE4 22                RET      
----- FUNCTION ZW_SerialTxActive_uart (END) -------


----- FUNCTION ZW_GetTxBufferFreeSize_uart (BEGIN) -----
006DE5 C2AC              CLR      ES0
006DE7 C3                CLR      C
006DE8 7420              MOV      A,#020H
006DEA 9575              SUBB     A,txCount
006DEC FF                MOV      R7,A
;---- Variable 'x' assigned to Register 'R7' ----
006DED D2AC              SETB     ES0
006DEF 22                RET      
----- FUNCTION ZW_GetTxBufferFreeSize_uart (END) -------


----- FUNCTION ?L?COM0071 (BEGIN) -----
006DF0 FF                MOV      R7,A
006DF1         ?L?COM0072:
006DF1 900854            MOV      DPTR,#pExploreQueueElement
006DF4 122552            LCALL    ?C?PLDXDATA
006DF7 E9                MOV      A,R1
006DF8 22                RET      
----- FUNCTION ?L?COM0071 (END) -------


----- FUNCTION ?L?COM015F (BEGIN) -----
006DF9 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 173


006DFA         ?L?COM0160:
006DFA 122552            LCALL    ?C?PLDXDATA
006DFD 900001            MOV      DPTR,#01H
006E00 EF                MOV      A,R7
006E01 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM015F (END) -------


----- FUNCTION ?L?COM0193 (BEGIN) -----
006E04 9003C8            MOV      DPTR,#tmpMain
006E07 E0                MOVX     A,@DPTR
006E08 FD                MOV      R5,A
006E09 75F0AA            MOV      B,#0AAH
006E0C 9003CD            MOV      DPTR,#frameBuffer
006E0F 022546            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM0193 (END) -------


----- FUNCTION ?L?COM01A2 (BEGIN) -----
006E12 FF                MOV      R7,A
006E13         ?L?COM01A3:
006E13 E0                MOVX     A,@DPTR
006E14 FC                MOV      R4,A
006E15         ?L?COM01A4:
006E15 A3                INC      DPTR
006E16 E0                MOVX     A,@DPTR
006E17 FD                MOV      R5,A
006E18 F582              MOV      DPL,A
006E1A 8C83              MOV      DPH,R4
006E1C 22                RET      
----- FUNCTION ?L?COM01A2 (END) -------


----- FUNCTION ?L?COM01CC (BEGIN) -----
006E1D 7B01              MOV      R3,#01H
006E1F 7A12              MOV      R2,#HIGH nodeID
006E21 7921              MOV      R1,#LOW nodeID
006E23         ?L?COM01CD:
006E23 9044B8            MOV      DPTR,#?_MemoryGetID?BYTE+03H
006E26 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01CC (END) -------


----- FUNCTION ?L?COM01DA (BEGIN) -----
006E29 FF                MOV      R7,A
006E2A E4                CLR      A
006E2B F0                MOVX     @DPTR,A
006E2C A3                INC      DPTR
006E2D EF                MOV      A,R7
006E2E F0                MOVX     @DPTR,A
006E2F 22                RET      
----- FUNCTION ?L?COM01DA (END) -------


----- FUNCTION ?L?COM01DE (BEGIN) -----
006E30 2409              ADD      A,#09H
006E32 F9                MOV      R1,A
006E33 E4                CLR      A
006E34 3A                ADDC     A,R2
006E35 FA                MOV      R2,A
006E36 22                RET      
----- FUNCTION ?L?COM01DE (END) -------


----- FUNCTION ?L?COM01E7 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 174


006E37 E0                MOVX     A,@DPTR
006E38 FC                MOV      R4,A
006E39 A3                INC      DPTR
006E3A E0                MOVX     A,@DPTR
006E3B 29                ADD      A,R1
006E3C F9                MOV      R1,A
006E3D EA                MOV      A,R2
006E3E 3C                ADDC     A,R4
006E3F 22                RET      
----- FUNCTION ?L?COM01E7 (END) -------


----- FUNCTION ?L?COM01FC (BEGIN) -----
006E40 FF                MOV      R7,A
006E41         ?L?COM01FD:
006E41 E0                MOVX     A,@DPTR
006E42         ?L?COM01FE:
006E42 FE                MOV      R6,A
006E43 7401              MOV      A,#01H
006E45 A806              MOV      R0,AR6
006E47 08                INC      R0
006E48 22                RET      
----- FUNCTION ?L?COM01FC (END) -------


----- FUNCTION ?L?COM0201 (BEGIN) -----
006E49 F9                MOV      R1,A
006E4A EA                MOV      A,R2
006E4B 34FF              ADDC     A,#0FFH
006E4D FA                MOV      R2,A
006E4E 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0201 (END) -------


----- FUNCTION ?L?COM0252 (BEGIN) -----
006E51 E0                MOVX     A,@DPTR
006E52 FE                MOV      R6,A
006E53 A3                INC      DPTR
006E54 E0                MOVX     A,@DPTR
006E55 29                ADD      A,R1
006E56 F9                MOV      R1,A
006E57 EA                MOV      A,R2
006E58 3E                ADDC     A,R6
006E59 FA                MOV      R2,A
006E5A 22                RET      
----- FUNCTION ?L?COM0252 (END) -------


----- FUNCTION ?L?COM0280 (BEGIN) -----
006E5B 7A12              MOV      R2,#HIGH homeID
006E5D 7923              MOV      R1,#LOW homeID
006E5F         ?L?COM0281:
006E5F 90442A            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
006E62 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0280 (END) -------


----- FUNCTION ?L?COM0282 (BEGIN) -----
006E65 904307            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
006E68 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0282 (END) -------


----- FUNCTION ?L?COM02AA (BEGIN) -----
006E6B 122462            LCALL    ?C?LLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 175


006E6E 7808              MOV      R0,#08H
006E70 0223AE            LJMP     ?C?ULSHR
----- FUNCTION ?L?COM02AA (END) -------


----- FUNCTION ?L?COM02AB (BEGIN) -----
006E73 122462            LCALL    ?C?LLDXDATA
006E76 7810              MOV      R0,#010H
006E78 0223AE            LJMP     ?C?ULSHR
----- FUNCTION ?L?COM02AB (END) -------


----- FUNCTION ?L?COM02C1 (BEGIN) -----
006E7B EF                MOV      A,R7
006E7C         ?L?COM02C2:
006E7C F0                MOVX     @DPTR,A
006E7D A3                INC      DPTR
006E7E ED                MOV      A,R5
006E7F F0                MOVX     @DPTR,A
006E80 E4                CLR      A
006E81 A3                INC      DPTR
006E82 F0                MOVX     @DPTR,A
006E83 22                RET      
----- FUNCTION ?L?COM02C1 (END) -------


----- FUNCTION ?L?COM02D6 (BEGIN) -----
006E84 FF                MOV      R7,A
006E85 E4                CLR      A
006E86 F0                MOVX     @DPTR,A
006E87 A3                INC      DPTR
006E88 EF                MOV      A,R7
006E89 F0                MOVX     @DPTR,A
006E8A 22                RET      
----- FUNCTION ?L?COM02D6 (END) -------


----- FUNCTION ?L?COM02DB (BEGIN) -----
006E8B EF                MOV      A,R7
006E8C F0                MOVX     @DPTR,A
006E8D A3                INC      DPTR
006E8E 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM02DB (END) -------


----- FUNCTION ?L?COM02DE (BEGIN) -----
006E91 E0                MOVX     A,@DPTR
006E92 FF                MOV      R7,A
006E93 A3                INC      DPTR
006E94 E0                MOVX     A,@DPTR
006E95 904182            MOV      DPTR,#?_NVM_ext_write_long_buffer?BYTE+07H
006E98 CF                XCH      A,R7
006E99 F0                MOVX     @DPTR,A
006E9A A3                INC      DPTR
006E9B EF                MOV      A,R7
006E9C F0                MOVX     @DPTR,A
006E9D 22                RET      
----- FUNCTION ?L?COM02DE (END) -------


----- FUNCTION ?L?COM02F3 (BEGIN) -----
006E9E E0                MOVX     A,@DPTR
006E9F         ?L?COM02F4:
006E9F F582              MOV      DPL,A
006EA1         ?L?COM02F5:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 176


006EA1 758300            MOV      DPH,#00H
006EA4 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM02F3 (END) -------


----- FUNCTION ?L?COM030B (BEGIN) -----
006EA7 7B01              MOV      R3,#01H
006EA9 7D13              MOV      R5,#013H
006EAB         ?L?COM030C:
006EAB E4                CLR      A
006EAC FF                MOV      R7,A
006EAD 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
006EB0 7B01              MOV      R3,#01H
006EB2 22                RET      
----- FUNCTION ?L?COM030B (END) -------


----- FUNCTION ?L?COM031A (BEGIN) -----
006EB3 E0                MOVX     A,@DPTR
006EB4 FE                MOV      R6,A
006EB5 A3                INC      DPTR
006EB6 E0                MOVX     A,@DPTR
006EB7 FF                MOV      R7,A
006EB8         ?L?COM031B:
006EB8 A3                INC      DPTR
006EB9 E0                MOVX     A,@DPTR
006EBA FD                MOV      R5,A
006EBB A3                INC      DPTR
006EBC E0                MOVX     A,@DPTR
006EBD FB                MOV      R3,A
006EBE 22                RET      
----- FUNCTION ?L?COM031A (END) -------


----- FUNCTION ?L?COM0349 (BEGIN) -----
006EBF EC                MOV      A,R4
006EC0 F0                MOVX     @DPTR,A
006EC1 A3                INC      DPTR
006EC2 ED                MOV      A,R5
006EC3 F0                MOVX     @DPTR,A
006EC4 A3                INC      DPTR
006EC5 22                RET      
----- FUNCTION ?L?COM0349 (END) -------


----- FUNCTION ?L?COM0353 (BEGIN) -----
006EC6 122552            LCALL    ?C?PLDXDATA
006EC9 AE02              MOV      R6,AR2
006ECB AF01              MOV      R7,AR1
006ECD 22                RET      
----- FUNCTION ?L?COM0353 (END) -------


----- FUNCTION ?L?COM035B (BEGIN) -----
006ECE 122572            LCALL    ?C?PSTXDATA
006ED1 022587            LJMP     ?C?PLDPTR
----- FUNCTION ?L?COM035B (END) -------


----- FUNCTION ?L?COM0363 (BEGIN) -----
006ED4 74FF              MOV      A,#0FFH
006ED6 F5F0              MOV      B,A
006ED8 12210C            LCALL    ?C?IILDX
006EDB 45F0              ORL      A,B
006EDD 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 177


----- FUNCTION ?L?COM0363 (END) -------


----- FUNCTION ?L?COM0365 (BEGIN) -----
006EDE 7B01              MOV      R3,#01H
006EE0 7F07              MOV      R7,#07H
006EE2 021BAB            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION ?L?COM0365 (END) -------


----- FUNCTION ?L?COM036F (BEGIN) -----
006EE5 901215            MOV      DPTR,#bFLiRSStatus
006EE8 E0                MOVX     A,@DPTR
006EE9 54FE              ANL      A,#0FEH
006EEB F0                MOVX     @DPTR,A
006EEC 22                RET      
----- FUNCTION ?L?COM036F (END) -------


----- FUNCTION ?L?COM0372 (BEGIN) -----
006EED 8E83              MOV      DPH,R6
006EEF 7F01              MOV      R7,#01H
006EF1 0226E3            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0372 (END) -------


----- FUNCTION ?L?COM0373 (BEGIN) -----
006EF4 74FF              MOV      A,#0FFH
006EF6 F5F0              MOV      B,A
006EF8 122122            LCALL    ?C?ILDIX
006EFB 45F0              ORL      A,B
006EFD 22                RET      
----- FUNCTION ?L?COM0373 (END) -------


----- FUNCTION ?L?COM0376 (BEGIN) -----
006EFE FF                MOV      R7,A
006EFF 122552            LCALL    ?C?PLDXDATA
006F02 C3                CLR      C
006F03 E9                MOV      A,R1
006F04 9F                SUBB     A,R7
006F05 F9                MOV      R1,A
006F06 EA                MOV      A,R2
006F07 9E                SUBB     A,R6
006F08 FA                MOV      R2,A
006F09 E9                MOV      A,R1
006F0A 2407              ADD      A,#07H
006F0C F9                MOV      R1,A
006F0D 22                RET      
----- FUNCTION ?L?COM0376 (END) -------


----- FUNCTION ?L?COM0382 (BEGIN) -----
006F0E 242D              ADD      A,#02DH
006F10 F9                MOV      R1,A
006F11 E4                CLR      A
006F12 3A                ADDC     A,R2
006F13 FA                MOV      R2,A
006F14 7D04              MOV      R5,#04H
006F16 E4                CLR      A
006F17 FF                MOV      R7,A
006F18 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM0382 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 178


----- FUNCTION ?L?COM0388 (BEGIN) -----
006F1B 904478            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
006F1E 7404              MOV      A,#04H
006F20 F0                MOVX     @DPTR,A
006F21 02388D            LJMP     _NVM_ext_read_buffer
----- FUNCTION ?L?COM0388 (END) -------


----- FUNCTION ?L?COM0389 (BEGIN) -----
006F24 904229            MOV      DPTR,#?_ctimer_set?BYTE+09H
006F27 122572            LCALL    ?C?PSTXDATA
006F2A 7B01              MOV      R3,#01H
006F2C 22                RET      
----- FUNCTION ?L?COM0389 (END) -------


----- FUNCTION ?L?COM03A2 (BEGIN) -----
006F2D 122552            LCALL    ?C?PLDXDATA
006F30 7401              MOV      A,#01H
006F32 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM03A2 (END) -------


----- FUNCTION ?L?COM03A9 (BEGIN) -----
006F35 F5FF              MOV      SFRPAGE,A
006F37 F596              MOV      DMSETUP5,A
006F39 75FF01            MOV      SFRPAGE,#01H
006F3C 75D709            MOV      DFCON1,#09H
006F3F 75F418            MOV      DMCTRL,#018H
006F42 22                RET      
----- FUNCTION ?L?COM03A9 (END) -------


----- FUNCTION ?L?COM03B6 (BEGIN) -----
006F43 2420              ADD      A,#020H
006F45 F9                MOV      R1,A
006F46 E4                CLR      A
006F47 3A                ADDC     A,R2
006F48 FA                MOV      R2,A
006F49 22                RET      
----- FUNCTION ?L?COM03B6 (END) -------


----- FUNCTION ?L?COM03D3 (BEGIN) -----
006F4A EE                MOV      A,R6
006F4B F0                MOVX     @DPTR,A
006F4C A3                INC      DPTR
006F4D EF                MOV      A,R7
006F4E F0                MOVX     @DPTR,A
006F4F 4E                ORL      A,R6
006F50 22                RET      
----- FUNCTION ?L?COM03D3 (END) -------


----- FUNCTION ?L?COM03FD (BEGIN) -----
006F51 E0                MOVX     A,@DPTR
006F52 FF                MOV      R7,A
006F53 A3                INC      DPTR
006F54 E0                MOVX     A,@DPTR
006F55 9042AE            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
006F58 CF                XCH      A,R7
006F59 F0                MOVX     @DPTR,A
006F5A A3                INC      DPTR
006F5B EF                MOV      A,R7
006F5C 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 179


----- FUNCTION ?L?COM03FD (END) -------


----- FUNCTION ?L?COM0400 (BEGIN) -----
006F5D 904158            MOV      DPTR,#NVRbNVMPageSize+01H
006F60 E0                MOVX     A,@DPTR
006F61 9F                SUBB     A,R7
006F62 FF                MOV      R7,A
006F63 904157            MOV      DPTR,#NVRbNVMPageSize
006F66 E0                MOVX     A,@DPTR
006F67 9E                SUBB     A,R6
006F68 22                RET      
----- FUNCTION ?L?COM0400 (END) -------


----- FUNCTION ?L?COM0404 (BEGIN) -----
006F69 F0                MOVX     @DPTR,A
006F6A A3                INC      DPTR
006F6B F0                MOVX     @DPTR,A
006F6C A3                INC      DPTR
006F6D F0                MOVX     @DPTR,A
006F6E A3                INC      DPTR
006F6F F0                MOVX     @DPTR,A
006F70 22                RET      
----- FUNCTION ?L?COM0404 (END) -------


----- FUNCTION ?L?COM0405 (BEGIN) -----
006F71 242C              ADD      A,#02CH
006F73 F9                MOV      R1,A
006F74 E4                CLR      A
006F75 3A                ADDC     A,R2
006F76 FA                MOV      R2,A
006F77 7440              MOV      A,#040H
006F79 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0405 (END) -------


----- FUNCTION ?L?COM0406 (BEGIN) -----
006F7C E0                MOVX     A,@DPTR
006F7D FE                MOV      R6,A
006F7E A3                INC      DPTR
006F7F E0                MOVX     A,@DPTR
006F80 FF                MOV      R7,A
006F81 7B01              MOV      R3,#01H
006F83 22                RET      
----- FUNCTION ?L?COM0406 (END) -------


----- FUNCTION ?L?COM0408 (BEGIN) -----
006F84 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
006F87 E0                MOVX     A,@DPTR
006F88 FE                MOV      R6,A
006F89 A3                INC      DPTR
006F8A E0                MOVX     A,@DPTR
006F8B 22                RET      
----- FUNCTION ?L?COM0408 (END) -------


----- FUNCTION ?L?COM0416 (BEGIN) -----
006F8C 122552            LCALL    ?C?PLDXDATA
006F8F 8D82              MOV      DPL,R5
006F91 8C83              MOV      DPH,R4
006F93 22                RET      
----- FUNCTION ?L?COM0416 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 180




----- FUNCTION ?L?COM042F (BEGIN) -----
006F94 EC                MOV      A,R4
006F95         ?L?COM0430:
006F95 C4                SWAP     A
006F96 F8                MOV      R0,A
006F97 54F0              ANL      A,#0F0H
006F99 C8                XCH      A,R0
006F9A 68                XRL      A,R0
006F9B 22                RET      
----- FUNCTION ?L?COM042F (END) -------


----- FUNCTION ?L?COM0438 (BEGIN) -----
006F9C E9                MOV      A,R1
006F9D         ?L?COM0439:
006F9D 240C              ADD      A,#0CH
006F9F F9                MOV      R1,A
006FA0 E4                CLR      A
006FA1 3A                ADDC     A,R2
006FA2 FA                MOV      R2,A
006FA3 22                RET      
----- FUNCTION ?L?COM0438 (END) -------


----- FUNCTION ?L?COM043E (BEGIN) -----
006FA4 E4                CLR      A
006FA5 FF                MOV      R7,A
006FA6 E4                CLR      A
006FA7 FD                MOV      R5,A
006FA8 FC                MOV      R4,A
006FA9 7808              MOV      R0,#08H
006FAB 0223AE            LJMP     ?C?ULSHR
----- FUNCTION ?L?COM043E (END) -------


----- FUNCTION ?L?COM043F (BEGIN) -----
006FAE E4                CLR      A
006FAF FF                MOV      R7,A
006FB0 FE                MOV      R6,A
006FB1 E4                CLR      A
006FB2 FC                MOV      R4,A
006FB3 7810              MOV      R0,#010H
006FB5 0223AE            LJMP     ?C?ULSHR
----- FUNCTION ?L?COM043F (END) -------


----- FUNCTION ?L?COM0448 (BEGIN) -----
006FB8 EE                MOV      A,R6
006FB9 F0                MOVX     @DPTR,A
006FBA A3                INC      DPTR
006FBB EF                MOV      A,R7
006FBC F0                MOVX     @DPTR,A
006FBD AA06              MOV      R2,AR6
006FBF F9                MOV      R1,A
006FC0 7B01              MOV      R3,#01H
006FC2 22                RET      
----- FUNCTION ?L?COM0448 (END) -------


----- FUNCTION ?L?COM044E (BEGIN) -----
006FC3 7F01              MOV      R7,#01H
006FC5 1236C2            LCALL    _ZW_SPI1_enable
006FC8 12375B            LCALL    NVM_CS_enable
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 181


006FCB 7F03              MOV      R7,#03H
006FCD 22                RET      
----- FUNCTION ?L?COM044E (END) -------


----- FUNCTION ?L?COM0453 (BEGIN) -----
006FCE EF                MOV      A,R7
006FCF F0                MOVX     @DPTR,A
006FD0 901221            MOV      DPTR,#nodeID
006FD3 E0                MOVX     A,@DPTR
006FD4 22                RET      
----- FUNCTION ?L?COM0453 (END) -------


----- FUNCTION ?L?COM045D (BEGIN) -----
006FD5 E0                MOVX     A,@DPTR
006FD6 FF                MOV      R7,A
006FD7 7404              MOV      A,#04H
006FD9 D3                SETB     C
006FDA 9F                SUBB     A,R7
006FDB 22                RET      
----- FUNCTION ?L?COM045D (END) -------


----- FUNCTION ?L?COM0466 (BEGIN) -----
006FDC E4                CLR      A
006FDD F0                MOVX     @DPTR,A
006FDE A3                INC      DPTR
006FDF 7405              MOV      A,#05H
006FE1 F0                MOVX     @DPTR,A
006FE2 22                RET      
----- FUNCTION ?L?COM0466 (END) -------


----- FUNCTION ?L?COM046C (BEGIN) -----
006FE3 FF                MOV      R7,A
006FE4 E4                CLR      A
006FE5 F0                MOVX     @DPTR,A
006FE6 A3                INC      DPTR
006FE7 EF                MOV      A,R7
006FE8 F0                MOVX     @DPTR,A
006FE9 22                RET      
----- FUNCTION ?L?COM046C (END) -------


----- FUNCTION ?L?COM0474 (BEGIN) -----
006FEA 2411              ADD      A,#011H
006FEC F9                MOV      R1,A
006FED E4                CLR      A
006FEE 3A                ADDC     A,R2
006FEF FA                MOV      R2,A
006FF0 22                RET      
----- FUNCTION ?L?COM0474 (END) -------


----- FUNCTION ?L?COM0475 (BEGIN) -----
006FF1 12203B            LCALL    ?C?CSTPTR
006FF4 900854            MOV      DPTR,#pExploreQueueElement
006FF7 22                RET      
----- FUNCTION ?L?COM0475 (END) -------


----- FUNCTION ?L?COM0498 (BEGIN) -----
006FF8 E0                MOVX     A,@DPTR
006FF9 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 182


006FFA 7E00              MOV      R6,#00H
006FFC EE                MOV      A,R6
006FFD F0                MOVX     @DPTR,A
006FFE A3                INC      DPTR
006FFF EF                MOV      A,R7
007000 F0                MOVX     @DPTR,A
007001 22                RET      
----- FUNCTION ?L?COM0498 (END) -------


----- FUNCTION ?L?COM049F (BEGIN) -----
007002 EF                MOV      A,R7
007003 9D                SUBB     A,R5
007004 FF                MOV      R7,A
007005 EE                MOV      A,R6
007006 9C                SUBB     A,R4
007007 F0                MOVX     @DPTR,A
007008 A3                INC      DPTR
007009 EF                MOV      A,R7
00700A F0                MOVX     @DPTR,A
00700B 22                RET      
----- FUNCTION ?L?COM049F (END) -------


----- FUNCTION ?L?COM04A8 (BEGIN) -----
00700C 900003            MOV      DPTR,#03H
00700F 0223F4            LJMP     ?C?LLDOPTR
----- FUNCTION ?L?COM04A8 (END) -------


----- FUNCTION ?L?COM04A9 (BEGIN) -----
007012 E9                MOV      A,R1
007013 9582              SUBB     A,DPL
007015 EA                MOV      A,R2
007016 9583              SUBB     A,DPH
007018 22                RET      
----- FUNCTION ?L?COM04A9 (END) -------


----- FUNCTION ?L?COM04AB (BEGIN) -----
007019 122572            LCALL    ?C?PSTXDATA
00701C E4                CLR      A
00701D FF                MOV      R7,A
00701E FE                MOV      R6,A
00701F 22                RET      
----- FUNCTION ?L?COM04AB (END) -------


----- FUNCTION ?L?COM04E0 (BEGIN) -----
007020 F9                MOV      R1,A
007021 E4                CLR      A
007022 3A                ADDC     A,R2
007023 FA                MOV      R2,A
007024 EE                MOV      A,R6
007025 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM04E0 (END) -------


----- FUNCTION ?L?COM04E3 (BEGIN) -----
007028 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
00702B 901221            MOV      DPTR,#nodeID
00702E E0                MOVX     A,@DPTR
00702F FF                MOV      R7,A
007030 22                RET      
----- FUNCTION ?L?COM04E3 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 183




----- FUNCTION ?L?COM04E5 (BEGIN) -----
007031 122552            LCALL    ?C?PLDXDATA
007034 8E82              MOV      DPL,R6
007036 758300            MOV      DPH,#00H
007039 22                RET      
----- FUNCTION ?L?COM04E5 (END) -------


----- FUNCTION ?L?COM04ED (BEGIN) -----
00703A A804              MOV      R0,AR4
00703C A905              MOV      R1,AR5
00703E AA06              MOV      R2,AR6
007040 AB07              MOV      R3,AR7
007042 22                RET      
----- FUNCTION ?L?COM04ED (END) -------


----- FUNCTION ?L?COM04FA (BEGIN) -----
007043 FF                MOV      R7,A
007044 E0                MOVX     A,@DPTR
007045 3400              ADDC     A,#00H
007047 FE                MOV      R6,A
007048 E4                CLR      A
007049 FC                MOV      R4,A
00704A FD                MOV      R5,A
00704B 22                RET      
----- FUNCTION ?L?COM04FA (END) -------


----- FUNCTION ?L?COM0528 (BEGIN) -----
00704C 903ECF            MOV      DPTR,#ch
00704F E0                MOVX     A,@DPTR
007050 FF                MOV      R7,A
007051 14                DEC      A
007052 F0                MOVX     @DPTR,A
007053 EF                MOV      A,R7
007054 22                RET      
----- FUNCTION ?L?COM0528 (END) -------


----- FUNCTION ?L?COM0529 (BEGIN) -----
007055 903FD5            MOV      DPTR,#ch
007058 E0                MOVX     A,@DPTR
007059 FF                MOV      R7,A
00705A 14                DEC      A
00705B F0                MOVX     @DPTR,A
00705C EF                MOV      A,R7
00705D 22                RET      
----- FUNCTION ?L?COM0529 (END) -------


----- FUNCTION ?L?COM0533 (BEGIN) -----
00705E F9                MOV      R1,A
00705F EC                MOV      A,R4
007060 3A                ADDC     A,R2
007061 FA                MOV      R2,A
007062 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0533 (END) -------


----- FUNCTION ?L?COM0544 (BEGIN) -----
007065 E4                CLR      A
007066 FC                MOV      R4,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 184


007067 FD                MOV      R5,A
007068 FE                MOV      R6,A
007069 022234            LJMP     ?C?LADD
----- FUNCTION ?L?COM0544 (END) -------


----- FUNCTION ?L?COM0552 (BEGIN) -----
00706C 741C              MOV      A,#HIGH _HDATA_E_
00706E F0                MOVX     @DPTR,A
00706F A3                INC      DPTR
007070 7484              MOV      A,#LOW _HDATA_E_
007072 F0                MOVX     @DPTR,A
007073 22                RET      
----- FUNCTION ?L?COM0552 (END) -------


----- FUNCTION ?L?COM056E (BEGIN) -----
007074 AF03              MOV      R7,AR3
007076 EA                MOV      A,R2
007077 F0                MOVX     @DPTR,A
007078 A3                INC      DPTR
007079 EF                MOV      A,R7
00707A F0                MOVX     @DPTR,A
00707B 22                RET      
----- FUNCTION ?L?COM056E (END) -------


----- FUNCTION ?L?COM0571 (BEGIN) -----
00707C FF                MOV      R7,A
00707D 54F0              ANL      A,#0F0H
00707F C4                SWAP     A
007080 540F              ANL      A,#0FH
007082 FE                MOV      R6,A
007083 22                RET      
----- FUNCTION ?L?COM0571 (END) -------


----- FUNCTION ?L?COM058C (BEGIN) -----
007084 F582              MOV      DPL,A
007086 E4                CLR      A
007087 3407              ADDC     A,#HIGH bListenRSSIThreshold
007089 F583              MOV      DPH,A
00708B 22                RET      
----- FUNCTION ?L?COM058C (END) -------


----- FUNCTION ?L?COM0592 (BEGIN) -----
00708C F0                MOVX     @DPTR,A
00708D 90414E            MOV      DPTR,#spiNVMstatus1
007090 E0                MOVX     A,@DPTR
007091 FF                MOV      R7,A
007092 F4                CPL      A
007093 22                RET      
----- FUNCTION ?L?COM0592 (END) -------


----- FUNCTION ?L?COM0594 (BEGIN) -----
007094 904674            MOV      DPTR,#x
007097 F0                MOVX     @DPTR,A
007098 90415B            MOV      DPTR,#deepPowerdown
00709B 22                RET      
----- FUNCTION ?L?COM0594 (END) -------


----- FUNCTION ?L?COM0595 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 185


00709C 90469D            MOV      DPTR,#x
00709F E0                MOVX     A,@DPTR
0070A0 14                DEC      A
0070A1 F0                MOVX     @DPTR,A
0070A2 E0                MOVX     A,@DPTR
0070A3 22                RET      
----- FUNCTION ?L?COM0595 (END) -------


----- FUNCTION ?L?COM059A (BEGIN) -----
0070A4 75FF02            MOV      SFRPAGE,#02H
0070A7 901215            MOV      DPTR,#bFLiRSStatus
0070AA E0                MOVX     A,@DPTR
0070AB 22                RET      
----- FUNCTION ?L?COM059A (END) -------


----- FUNCTION _ZCB_TsCallbackFunc (BEGIN) -----
;---- Variable 'txS' assigned to Register 'R1/R2/R3' ----
;---- Variable 'txStatus' assigned to Register 'R7' ----
B1:0081AA 900785            MOV      DPTR,#_ts_stored_callback
B1:0081AD E0                MOVX     A,@DPTR
B1:0081AE FC                MOV      R4,A
B1:0081AF A3                INC      DPTR
B1:0081B0 E0                MOVX     A,@DPTR
B1:0081B1 4C                ORL      A,R4
B1:0081B2 6009              JZ       ?C0002?ZW_TRANSPORT
B1:0081B4 900785            MOV      DPTR,#_ts_stored_callback
B1:0081B7 126E15            LCALL    ?L?COM01A4
B1:0081BA 1226E3            LCALL    ?C?ICALL2
B1:0081BD         ?C0002?ZW_TRANSPORT:
B1:0081BD 22                RET      
----- FUNCTION _ZCB_TsCallbackFunc (END) -------


----- FUNCTION _ZCB_TransportDummyApplicationCallback (BEGIN) -----
B1:0081BE 22                RET      
----- FUNCTION _ZCB_TransportDummyApplicationCallback (END) -------


----- FUNCTION _TransportTransmitComplete (BEGIN) -----
B1:0081BF 900ABE            MOV      DPTR,#pTransmittedFrame
B1:0081C2 122572            LCALL    ?C?PSTXDATA
B1:0081C5 7F01              MOV      R7,#01H
B1:0081C7 125006            LCALL    _ZW_SetRFReceiveMode
B1:0081CA F1F6              ACALL    ?L?COM0470
B1:0081CC 1252F4            LCALL    ?L?COM0021
B1:0081CF 45F0              ORL      A,B
B1:0081D1 601D              JZ       ?C0005?ZW_TRANSPORT
B1:0081D3 900ABE            MOV      DPTR,#pTransmittedFrame
B1:0081D6 122552            LCALL    ?C?PLDXDATA
B1:0081D9 C003              PUSH     AR3
B1:0081DB C002              PUSH     AR2
B1:0081DD C001              PUSH     AR1
B1:0081DF F1F6              ACALL    ?L?COM0470
B1:0081E1 1252F4            LCALL    ?L?COM0021
B1:0081E4 12FEC6            LCALL    ?L?COM0511
B1:0081E7 D001              POP      AR1
B1:0081E9 D002              POP      AR2
B1:0081EB D003              POP      AR3
B1:0081ED 1226E3            LCALL    ?C?ICALL2
B1:0081F0         ?C0005?ZW_TRANSPORT:
B1:0081F0 22                RET      
----- FUNCTION _TransportTransmitComplete (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 186



----- FUNCTION TxQueueServiceTransmit (BEGIN) -----
B1:0081F1 E4                CLR      A
B1:0081F2 900ADC            MOV      DPTR,#bStatus
;---- Variable 'bFoundWaiting' assigned to Register 'R7' ----
B1:0081F5 F1EE              ACALL    ?L?COM057C
B1:0081F7 9003B3            MOV      DPTR,#bCurrentTransmit
B1:0081FA E0                MOVX     A,@DPTR
B1:0081FB 75F0EB            MOV      B,#0EBH
B1:0081FE 7143              ACALL    ?L?COM00ED
B1:008200 E0                MOVX     A,@DPTR
B1:008201 54F0              ANL      A,#0F0H
B1:008203 6440              XRL      A,#040H
B1:008205 7002              JNZ      $ + 4H
B1:008207 41FD              AJMP     ?C0015?ZW_TX_QUEUE
;---- Variable 'bCount' assigned to Register 'R6' ----
B1:008209 E4                CLR      A
B1:00820A FE                MOV      R6,A
B1:00820B         ?C0016?ZW_TX_QUEUE:
B1:00820B 75F0EB            MOV      B,#0EBH
B1:00820E EE                MOV      A,R6
B1:00820F 7143              ACALL    ?L?COM00ED
B1:008211 E0                MOVX     A,@DPTR
B1:008212 FD                MOV      R5,A
B1:008213 B40109            CJNE     A,#01H,?C0019?ZW_TX_QUEUE
B1:008216 900ADD            MOV      DPTR,#bElement
B1:008219 EE                MOV      A,R6
B1:00821A F0                MOVX     @DPTR,A
B1:00821B E4                CLR      A
B1:00821C FF                MOV      R7,A
B1:00821D 8023              SJMP     ?C0017?ZW_TX_QUEUE
B1:00821F         ?C0019?ZW_TX_QUEUE:
B1:00821F ED                MOV      A,R5
B1:008220 B4020B            CJNE     A,#02H,?C0020?ZW_TX_QUEUE
B1:008223 900ADD            MOV      DPTR,#bElement
B1:008226 E0                MOVX     A,@DPTR
B1:008227 B4FF04            CJNE     A,#0FFH,?C0020?ZW_TX_QUEUE
B1:00822A EE                MOV      A,R6
B1:00822B F0                MOVX     @DPTR,A
B1:00822C 800F              SJMP     ?C0018?ZW_TX_QUEUE
B1:00822E         ?C0020?ZW_TX_QUEUE:
B1:00822E 75F0EB            MOV      B,#0EBH
B1:008231 EE                MOV      A,R6
B1:008232 7143              ACALL    ?L?COM00ED
B1:008234 E0                MOVX     A,@DPTR
B1:008235 54F0              ANL      A,#0F0H
B1:008237 FD                MOV      R5,A
B1:008238 BD8002            CJNE     R5,#080H,?C0018?ZW_TX_QUEUE
B1:00823B 7F01              MOV      R7,#01H
B1:00823D         ?C0018?ZW_TX_QUEUE:
B1:00823D 0E                INC      R6
B1:00823E EE                MOV      A,R6
B1:00823F B404C9            CJNE     A,#04H,?C0016?ZW_TX_QUEUE
B1:008242         ?C0017?ZW_TX_QUEUE:
B1:008242 EF                MOV      A,R7
B1:008243 6006              JZ       ?C0023?ZW_TX_QUEUE
B1:008245 900ADD            MOV      DPTR,#bElement
B1:008248 74FF              MOV      A,#0FFH
B1:00824A F0                MOVX     @DPTR,A
B1:00824B         ?C0023?ZW_TX_QUEUE:
B1:00824B 900ADD            MOV      DPTR,#bElement
B1:00824E E0                MOVX     A,@DPTR
B1:00824F F4                CPL      A
B1:008250 7002              JNZ      $ + 4H
B1:008252 41FD              AJMP     ?C0015?ZW_TX_QUEUE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 187


B1:008254 12598F            LCALL    RFIsReceiving
B1:008257 5002              JNC      $ + 4H
B1:008259 41FD              AJMP     ?C0015?ZW_TX_QUEUE
B1:00825B E515              MOV      A,RF_status
B1:00825D 30E102            JNB      ACC.1,$ + 5H
B1:008260 41FD              AJMP     ?C0015?ZW_TX_QUEUE
B1:008262 900ADD            MOV      DPTR,#bElement
B1:008265 E0                MOVX     A,@DPTR
B1:008266 90000A            MOV      DPTR,#X4K_TxQueue+03H
B1:008269 12FE73            LCALL    ?L?COM038C
B1:00826C 30E409            JNB      ACC.4,?C0025?ZW_TX_QUEUE
B1:00826F 90000C            MOV      DPTR,#X4K_TxQueue+05H
B1:008272 12FE7C            LCALL    ?L?COM0392
B1:008275 549F              ANL      A,#09FH
B1:008277 F0                MOVX     @DPTR,A
B1:008278         ?C0025?ZW_TX_QUEUE:
B1:008278 900ADD            MOV      DPTR,#bElement
B1:00827B E0                MOVX     A,@DPTR
B1:00827C 9000BE            MOV      DPTR,#X4K_TxQueue+0B7H
B1:00827F 12FE73            LCALL    ?L?COM038C
B1:008282 540F              ANL      A,#0FH
B1:008284 FE                MOV      R6,A
B1:008285 BE0509            CJNE     R6,#05H,?C0028?ZW_TX_QUEUE
B1:008288 9000C2            MOV      DPTR,#X4K_TxQueue+0BBH
B1:00828B 12FE7C            LCALL    ?L?COM0392
B1:00828E 30E120            JNB      ACC.1,?C0027?ZW_TX_QUEUE
B1:008291         ?C0028?ZW_TX_QUEUE:
B1:008291 900ADD            MOV      DPTR,#bElement
B1:008294 E0                MOVX     A,@DPTR
B1:008295 FF                MOV      R7,A
B1:008296 75F0EB            MOV      B,#0EBH
B1:008299 900009            MOV      DPTR,#X4K_TxQueue+02H
B1:00829C 122546            LCALL    ?C?OFFXADD
B1:00829F E0                MOVX     A,@DPTR
B1:0082A0 20E52E            JB       ACC.5,?C0026?ZW_TX_QUEUE
B1:0082A3 75F0EB            MOV      B,#0EBH
B1:0082A6 EF                MOV      A,R7
B1:0082A7 9000C1            MOV      DPTR,#X4K_TxQueue+0BAH
B1:0082AA 122546            LCALL    ?C?OFFXADD
B1:0082AD E0                MOVX     A,@DPTR
B1:0082AE B4FF20            CJNE     A,#0FFH,?C0026?ZW_TX_QUEUE
B1:0082B1         ?C0027?ZW_TX_QUEUE:
B1:0082B1 900ADD            MOV      DPTR,#bElement
B1:0082B4 E0                MOVX     A,@DPTR
B1:0082B5 75F0EB            MOV      B,#0EBH
B1:0082B8 90000B            MOV      DPTR,#X4K_TxQueue+04H
B1:0082BB 122546            LCALL    ?C?OFFXADD
B1:0082BE C083              PUSH     DPH
B1:0082C0 C082              PUSH     DPL
B1:0082C2 E0                MOVX     A,@DPTR
B1:0082C3 4401              ORL      A,#01H
B1:0082C5 FF                MOV      R7,A
B1:0082C6 A3                INC      DPTR
B1:0082C7 E0                MOVX     A,@DPTR
B1:0082C8 D082              POP      DPL
B1:0082CA D083              POP      DPH
B1:0082CC CF                XCH      A,R7
B1:0082CD F0                MOVX     @DPTR,A
B1:0082CE A3                INC      DPTR
B1:0082CF EF                MOV      A,R7
B1:0082D0 F0                MOVX     @DPTR,A
B1:0082D1         ?C0026?ZW_TX_QUEUE:
B1:0082D1 900ADD            MOV      DPTR,#bElement
B1:0082D4 F1BF              ACALL    ?L?COM01B2
B1:0082D6 125023            LCALL    _RFTransmitNow
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 188


B1:0082D9 5022              JNC      ?C0015?ZW_TX_QUEUE
B1:0082DB 900ADD            MOV      DPTR,#bElement
B1:0082DE E0                MOVX     A,@DPTR
B1:0082DF 9003B3            MOV      DPTR,#bCurrentTransmit
B1:0082E2 F0                MOVX     @DPTR,A
B1:0082E3 75F0EB            MOV      B,#0EBH
B1:0082E6 7143              ACALL    ?L?COM00ED
B1:0082E8 E0                MOVX     A,@DPTR
B1:0082E9 4440              ORL      A,#040H
B1:0082EB F0                MOVX     @DPTR,A
B1:0082EC 900ADC            MOV      DPTR,#bStatus
B1:0082EF 7401              MOV      A,#01H
B1:0082F1 F0                MOVX     @DPTR,A
B1:0082F2 900672            MOV      DPTR,#bRestartAckTimerAllowed
B1:0082F5 F0                MOVX     @DPTR,A
B1:0082F6 E515              MOV      A,RF_status
B1:0082F8 30E202            JNB      ACC.2,?C0015?ZW_TX_QUEUE
B1:0082FB D3                SETB     C
B1:0082FC 22                RET      
B1:0082FD         ?C0015?ZW_TX_QUEUE:
B1:0082FD E515              MOV      A,RF_status
B1:0082FF 30E236            JNB      ACC.2,?C0033?ZW_TX_QUEUE
B1:008302 7F04              MOV      R7,#04H
B1:008304 125D95            LCALL    _RFClearStatus
B1:008307 9003B3            MOV      DPTR,#bCurrentTransmit
B1:00830A E0                MOVX     A,@DPTR
B1:00830B FF                MOV      R7,A
B1:00830C 75F0EB            MOV      B,#0EBH
B1:00830F 7143              ACALL    ?L?COM00ED
B1:008311 E0                MOVX     A,@DPTR
B1:008312 FE                MOV      R6,A
B1:008313 54F0              ANL      A,#0F0H
B1:008315 6440              XRL      A,#040H
B1:008317 7015              JNZ      ?C0034?ZW_TX_QUEUE
B1:008319 713F              ACALL    ?L?COM00EC
B1:00831B EE                MOV      A,R6
B1:00831C 540F              ANL      A,#0FH
B1:00831E F0                MOVX     @DPTR,A
B1:00831F 713F              ACALL    ?L?COM00EC
B1:008321 E0                MOVX     A,@DPTR
B1:008322 4480              ORL      A,#080H
B1:008324 F0                MOVX     @DPTR,A
B1:008325 9003B3            MOV      DPTR,#bCurrentTransmit
B1:008328 F1BF              ACALL    ?L?COM01B2
B1:00832A 31BF              ACALL    _TransportTransmitComplete
B1:00832C 800A              SJMP     ?C0033?ZW_TX_QUEUE
B1:00832E         ?C0034?ZW_TX_QUEUE:
B1:00832E E515              MOV      A,RF_status
B1:008330 30E005            JNB      ACC.0,?C0033?ZW_TX_QUEUE
B1:008333 7F01              MOV      R7,#01H
B1:008335 125006            LCALL    _ZW_SetRFReceiveMode
B1:008338         ?C0033?ZW_TX_QUEUE:
B1:008338 900ADC            MOV      DPTR,#bStatus
B1:00833B E0                MOVX     A,@DPTR
B1:00833C 24FF              ADD      A,#0FFH
B1:00833E 22                RET      
----- FUNCTION TxQueueServiceTransmit (END) -------


----- FUNCTION ?L?COM00EC (BEGIN) -----
B1:00833F 75F0EB            MOV      B,#0EBH
B1:008342 EF                MOV      A,R7
B1:008343         ?L?COM00ED:
B1:008343 900007            MOV      DPTR,#X4K_TxQueue
B1:008346 022546            LJMP     ?C?OFFXADD
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 189


----- FUNCTION ?L?COM00EC (END) -------


----- FUNCTION ?L?COM0431 (BEGIN) -----
B1:008349 EB                MOV      A,R3
B1:00834A F0                MOVX     @DPTR,A
B1:00834B 7F02              MOV      R7,#02H
----- FUNCTION _TxQueueGetElement (BEGIN) -----
B1:00834D 900ADA            MOV      DPTR,#bPriority
B1:008350 EF                MOV      A,R7
;---- Variable 'bFree' assigned to Register 'R7' ----
B1:008351 F1EE              ACALL    ?L?COM057C
;---- Variable 'fHighPriorityQueued' assigned to Register 'R6' ----
B1:008353 FE                MOV      R6,A
;---- Variable 'bCount' assigned to Register 'R5' ----
B1:008354 FD                MOV      R5,A
B1:008355         ?C0005?ZW_TX_QUEUE:
B1:008355 75F0EB            MOV      B,#0EBH
B1:008358 ED                MOV      A,R5
B1:008359 7143              ACALL    ?L?COM00ED
B1:00835B E0                MOVX     A,@DPTR
B1:00835C FC                MOV      R4,A
B1:00835D 700C              JNZ      ?C0008?ZW_TX_QUEUE
B1:00835F 900ADB            MOV      DPTR,#bElement
B1:008362 E0                MOVX     A,@DPTR
B1:008363 B4FF02            CJNE     A,#0FFH,?C0009?ZW_TX_QUEUE
B1:008366 ED                MOV      A,R5
B1:008367 F0                MOVX     @DPTR,A
B1:008368         ?C0009?ZW_TX_QUEUE:
B1:008368 0F                INC      R7
B1:008369 8006              SJMP     ?C0007?ZW_TX_QUEUE
B1:00836B         ?C0008?ZW_TX_QUEUE:
B1:00836B EC                MOV      A,R4
B1:00836C 30E002            JNB      ACC.0,?C0007?ZW_TX_QUEUE
B1:00836F 7E01              MOV      R6,#01H
B1:008371         ?C0007?ZW_TX_QUEUE:
B1:008371 0D                INC      R5
B1:008372 ED                MOV      A,R5
B1:008373 B404DF            CJNE     A,#04H,?C0005?ZW_TX_QUEUE
B1:008376         ?C0006?ZW_TX_QUEUE:
B1:008376 900ADA            MOV      DPTR,#bPriority
B1:008379 E0                MOVX     A,@DPTR
B1:00837A 6401              XRL      A,#01H
B1:00837C 600D              JZ       ?C0012?ZW_TX_QUEUE
B1:00837E EF                MOV      A,R7
B1:00837F C3                CLR      C
B1:008380 9402              SUBB     A,#02H
B1:008382 5007              JNC      ?C0012?ZW_TX_QUEUE
B1:008384 EE                MOV      A,R6
B1:008385 7004              JNZ      ?C0012?ZW_TX_QUEUE
B1:008387 A3                INC      DPTR
B1:008388 74FF              MOV      A,#0FFH
B1:00838A F0                MOVX     @DPTR,A
B1:00838B         ?C0012?ZW_TX_QUEUE:
B1:00838B 900ADB            MOV      DPTR,#bElement
B1:00838E E0                MOVX     A,@DPTR
B1:00838F FF                MOV      R7,A
B1:008390 C3                CLR      C
B1:008391 9404              SUBB     A,#04H
B1:008393 501E              JNC      ?C0013?ZW_TX_QUEUE
B1:008395 EF                MOV      A,R7
B1:008396 F1C0              ACALL    ?L?COM01B3
B1:008398 7DEB              MOV      R5,#0EBH
B1:00839A E4                CLR      A
B1:00839B FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 190


B1:00839C 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00839F 900ADA            MOV      DPTR,#bPriority
B1:0083A2 E0                MOVX     A,@DPTR
B1:0083A3 4410              ORL      A,#010H
B1:0083A5 FF                MOV      R7,A
B1:0083A6 A3                INC      DPTR
B1:0083A7 E0                MOVX     A,@DPTR
B1:0083A8 FE                MOV      R6,A
B1:0083A9 75F0EB            MOV      B,#0EBH
B1:0083AC 7143              ACALL    ?L?COM00ED
B1:0083AE EF                MOV      A,R7
B1:0083AF F0                MOVX     @DPTR,A
B1:0083B0 EE                MOV      A,R6
B1:0083B1 E1C0              AJMP     ?L?COM01B3
B1:0083B3         ?C0013?ZW_TX_QUEUE:
B1:0083B3 02A79C            LJMP     ?L?COM00A4
----- FUNCTION _TxQueueGetElement (END) -------


----- FUNCTION _ZCB_ZWRepeatComplete (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B1:0083B6 EF                MOV      A,R7
B1:0083B7 7002              JNZ      $ + 4H
B1:0083B9 A118              AJMP     ?C0238?ZW_TRANSPORT
B1:0083BB B11B              ACALL    ?L?COM000C
B1:0083BD 4A                ORL      A,R2
B1:0083BE 7002              JNZ      $ + 4H
B1:0083C0 A118              AJMP     ?C0238?ZW_TRANSPORT
B1:0083C2 E9                MOV      A,R1
B1:0083C3 24BB              ADD      A,#0BBH
B1:0083C5 B1F5              ACALL    ?L?COM0004
B1:0083C7 30E002            JNB      ACC.0,$ + 5H
B1:0083CA A118              AJMP     ?C0238?ZW_TRANSPORT
B1:0083CC B11B              ACALL    ?L?COM000C
B1:0083CE 24B8              ADD      A,#0B8H
B1:0083D0 B1F5              ACALL    ?L?COM0004
B1:0083D2 900A23            MOV      DPTR,#routingBuffer
B1:0083D5 B11A              ACALL    ?L?COM000B
B1:0083D7 12D092            LCALL    ?L?COM035A
B1:0083DA F1B9              ACALL    ?L?COM003F
B1:0083DC 7A0A              MOV      R2,#HIGH routingBuffer+01H
B1:0083DE 7924              MOV      R1,#LOW routingBuffer+01H
B1:0083E0 126EDE            LCALL    ?L?COM0365
B1:0083E3 B11B              ACALL    ?L?COM000C
B1:0083E5 24B6              ADD      A,#0B6H
B1:0083E7 B1F5              ACALL    ?L?COM0004
B1:0083E9 900A2B            MOV      DPTR,#repeatSource
B1:0083EC F0                MOVX     @DPTR,A
B1:0083ED 7F02              MOV      R7,#02H
B1:0083EF 714D              ACALL    _TxQueueGetElement
B1:0083F1 900A20            MOV      DPTR,#pFrame
B1:0083F4 12D134            LCALL    ?L?COM0287
B1:0083F7 7002              JNZ      $ + 4H
B1:0083F9 A118              AJMP     ?C0238?ZW_TRANSPORT
B1:0083FB         ?C0237?ZW_TRANSPORT:
B1:0083FB 900A20            MOV      DPTR,#pFrame
B1:0083FE 12E012            LCALL    ?L?COM00B3
B1:008401 12E45A            LCALL    ?L?COM03B3
B1:008404 12203B            LCALL    ?C?CSTPTR
B1:008407 900A26            MOV      DPTR,#routingBuffer+03H
B1:00840A E0                MOVX     A,@DPTR
B1:00840B C4                SWAP     A
B1:00840C 540F              ANL      A,#0FH
B1:00840E F4                CPL      A
B1:00840F 04                INC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 191


B1:008410 FF                MOV      R7,A
B1:008411 C3                CLR      C
B1:008412 740B              MOV      A,#0BH
B1:008414 9F                SUBB     A,R7
B1:008415 B123              ACALL    ?L?COM00F2
B1:008417 24D8              ADD      A,#0D8H
B1:008419 F1AB              ACALL    ?L?COM0015
B1:00841B 900A20            MOV      DPTR,#pFrame
B1:00841E 12D1A1            LCALL    ?L?COM00E1
B1:008421 900A20            MOV      DPTR,#pFrame
B1:008424 122552            LCALL    ?C?PLDXDATA
B1:008427 129F96            LCALL    _SetTransmitHomeID
B1:00842A 900A24            MOV      DPTR,#routingBuffer+01H
B1:00842D E0                MOVX     A,@DPTR
B1:00842E B123              ACALL    ?L?COM00F2
B1:008430 24B6              ADD      A,#0B6H
B1:008432 F1AB              ACALL    ?L?COM0015
B1:008434 B124              ACALL    ?L?COM00F3
B1:008436 24B7              ADD      A,#0B7H
B1:008438 12A441            LCALL    ?L?COM0182
B1:00843B 12203B            LCALL    ?C?CSTPTR
B1:00843E 4480              ORL      A,#080H
B1:008440 12203B            LCALL    ?C?CSTPTR
B1:008443 B124              ACALL    ?L?COM00F3
B1:008445 24B1              ADD      A,#0B1H
B1:008447 B1F5              ACALL    ?L?COM0004
B1:008449 B123              ACALL    ?L?COM00F2
B1:00844B 24D8              ADD      A,#0D8H
B1:00844D B1F5              ACALL    ?L?COM0004
B1:00844F 2F                ADD      A,R7
B1:008450 04                INC      A
B1:008451 B123              ACALL    ?L?COM00F2
B1:008453 24B9              ADD      A,#0B9H
B1:008455 F1AB              ACALL    ?L?COM0015
B1:008457 900A23            MOV      DPTR,#routingBuffer
B1:00845A E0                MOVX     A,@DPTR
B1:00845B 540F              ANL      A,#0FH
B1:00845D B123              ACALL    ?L?COM00F2
B1:00845F 24B8              ADD      A,#0B8H
B1:008461 F1AB              ACALL    ?L?COM0015
B1:008463 900A2B            MOV      DPTR,#repeatSource
B1:008466 E0                MOVX     A,@DPTR
B1:008467 B123              ACALL    ?L?COM00F2
B1:008469 24BA              ADD      A,#0BAH
B1:00846B F1AB              ACALL    ?L?COM0015
B1:00846D 900A26            MOV      DPTR,#routingBuffer+03H
B1:008470 E0                MOVX     A,@DPTR
B1:008471 FF                MOV      R7,A
B1:008472 C4                SWAP     A
B1:008473 54F0              ANL      A,#0F0H
B1:008475 FE                MOV      R6,A
B1:008476 B124              ACALL    ?L?COM00F3
B1:008478 24BB              ADD      A,#0BBH
B1:00847A 127020            LCALL    ?L?COM04E0
B1:00847D 4401              ORL      A,#01H
B1:00847F 12203B            LCALL    ?C?CSTPTR
B1:008482 4404              ORL      A,#04H
B1:008484 12203B            LCALL    ?C?CSTPTR
B1:008487 EF                MOV      A,R7
B1:008488 24FE              ADD      A,#0FEH
B1:00848A 540F              ANL      A,#0FH
B1:00848C FF                MOV      R7,A
B1:00848D 900A26            MOV      DPTR,#routingBuffer+03H
B1:008490 E0                MOVX     A,@DPTR
B1:008491 54F0              ANL      A,#0F0H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 192


B1:008493 FE                MOV      R6,A
B1:008494 4F                ORL      A,R7
B1:008495 B123              ACALL    ?L?COM00F2
B1:008497 24BC              ADD      A,#0BCH
B1:008499 F1AB              ACALL    ?L?COM0015
B1:00849B 540F              ANL      A,#0FH
B1:00849D FF                MOV      R7,A
B1:00849E BF0F0B            CJNE     R7,#0FH,?C0239?ZW_TRANSPORT
B1:0084A1 B124              ACALL    ?L?COM00F3
B1:0084A3 24B7              ADD      A,#0B7H
B1:0084A5 B1F5              ACALL    ?L?COM0004
B1:0084A7 4440              ORL      A,#040H
B1:0084A9 12203B            LCALL    ?C?CSTPTR
B1:0084AC         ?C0239?ZW_TRANSPORT:
B1:0084AC EE                MOV      A,R6
B1:0084AD C4                SWAP     A
B1:0084AE 540F              ANL      A,#0FH
B1:0084B0 FE                MOV      R6,A
B1:0084B1 D3                SETB     C
B1:0084B2 9404              SUBB     A,#04H
B1:0084B4 AF06              MOV      R7,AR6
B1:0084B6 4002              JC       ?C0240?ZW_TRANSPORT
B1:0084B8 7F04              MOV      R7,#04H
B1:0084BA         ?C0240?ZW_TRANSPORT:
B1:0084BA         ?C0241?ZW_TRANSPORT:
B1:0084BA B124              ACALL    ?L?COM00F3
B1:0084BC F1DF              ACALL    ?L?COM02B8
B1:0084BE C003              PUSH     AR3
B1:0084C0 C002              PUSH     AR2
B1:0084C2 C001              PUSH     AR1
B1:0084C4 7B01              MOV      R3,#01H
B1:0084C6 7A0A              MOV      R2,#HIGH routingBuffer+04H
B1:0084C8 7927              MOV      R1,#LOW routingBuffer+04H
B1:0084CA F1B9              ACALL    ?L?COM003F
B1:0084CC D001              POP      AR1
B1:0084CE D002              POP      AR2
B1:0084D0 D003              POP      AR3
B1:0084D2 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:0084D5         ?C0242?ZW_TRANSPORT:
B1:0084D5 900A20            MOV      DPTR,#pFrame
B1:0084D8 B1EF              ACALL    ?L?COM0002
B1:0084DA 4420              ORL      A,#020H
B1:0084DC 12203B            LCALL    ?C?CSTPTR
B1:0084DF 900666            MOV      DPTR,#bRxCurrentSpeed
B1:0084E2 E0                MOVX     A,@DPTR
B1:0084E3 B123              ACALL    ?L?COM00F2
B1:0084E5 24B6              ADD      A,#0B6H
B1:0084E7 B1F5              ACALL    ?L?COM0004
B1:0084E9 FD                MOV      R5,A
B1:0084EA B124              ACALL    ?L?COM00F3
B1:0084EC 24BA              ADD      A,#0BAH
B1:0084EE B1F5              ACALL    ?L?COM0004
B1:0084F0 FB                MOV      R3,A
B1:0084F1 C003              PUSH     AR3
B1:0084F3 B124              ACALL    ?L?COM00F3
B1:0084F5 12BC01            LCALL    ?L?COM0123
B1:0084F8 12D6FC            LCALL    ?L?COM0354
B1:0084FB B124              ACALL    ?L?COM00F3
B1:0084FD 24B1              ADD      A,#0B1H
B1:0084FF B1F5              ACALL    ?L?COM0004
B1:008501 12F794            LCALL    ?L?COM040E
B1:008504 F0                MOVX     @DPTR,A
B1:008505 900A20            MOV      DPTR,#pFrame
B1:008508 B1EF              ACALL    ?L?COM0002
B1:00850A 12FC67            LCALL    ?L?COM03C0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 193


B1:00850D 900A20            MOV      DPTR,#pFrame
B1:008510 12D77E            LCALL    ?L?COM027B
B1:008513 D003              POP      AR3
B1:008515 12912A            LCALL    _EnqueueSingleDataPtr
B1:008518         ?C0238?ZW_TRANSPORT:
B1:008518 22                RET      
----- FUNCTION _ZCB_ZWRepeatComplete (END) -------


----- FUNCTION ?L?COM000A (BEGIN) -----
B1:008519 EF                MOV      A,R7
B1:00851A         ?L?COM000B:
B1:00851A F0                MOVX     @DPTR,A
B1:00851B         ?L?COM000C:
B1:00851B 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00851E 122552            LCALL    ?C?PLDXDATA
B1:008521 E9                MOV      A,R1
B1:008522 22                RET      
----- FUNCTION ?L?COM000A (END) -------


----- FUNCTION ?L?COM00F2 (BEGIN) -----
B1:008523 FF                MOV      R7,A
B1:008524         ?L?COM00F3:
B1:008524 900A20            MOV      DPTR,#pFrame
B1:008527 122552            LCALL    ?C?PLDXDATA
B1:00852A E9                MOV      A,R1
B1:00852B 22                RET      
----- FUNCTION ?L?COM00F2 (END) -------


----- FUNCTION _ProtocolWaitForACK (BEGIN) -----
;---- Variable 'pTransmittedFrame' assigned to Register 'R1/R2/R3' ----
B1:00852C 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00852F 122572            LCALL    ?C?PSTXDATA
B1:008532 E9                MOV      A,R1
B1:008533 24E3              ADD      A,#0E3H
B1:008535 B1F5              ACALL    ?L?COM0004
B1:008537 6015              JZ       ?C0012?ZW_TXQ_PROTOCOL
B1:008539 E4                CLR      A
B1:00853A 90402B            MOV      DPTR,#delayCountProtocol
B1:00853D B11A              ACALL    ?L?COM000B
B1:00853F 12A43F            LCALL    ?L?COM0181
B1:008542 12203B            LCALL    ?C?CSTPTR
B1:008545 7E1A              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:008547 7F4D              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:008549 FD                MOV      R5,A
B1:00854A 7C00              MOV      R4,#00H
B1:00854C 807A              SJMP     ?C0050?ZW_TXQ_PROTOCOL
B1:00854E         ?C0012?ZW_TXQ_PROTOCOL:
B1:00854E B11B              ACALL    ?L?COM000C
B1:008550 2401              ADD      A,#01H
B1:008552 B1F5              ACALL    ?L?COM0004
B1:008554 D3                SETB     C
B1:008555 9401              SUBB     A,#01H
B1:008557 403A              JC       ?C0014?ZW_TXQ_PROTOCOL
B1:008559 128FF2            LCALL    TxRandom
B1:00855C 90402B            MOV      DPTR,#delayCountProtocol
B1:00855F EF                MOV      A,R7
B1:008560 F0                MOVX     @DPTR,A
B1:008561 7E1A              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:008563 7F4D              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:008565 B11B              ACALL    ?L?COM000C
B1:008567 24B7              ADD      A,#0B7H
B1:008569 B1F5              ACALL    ?L?COM0004
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 194


B1:00856B 30E719            JNB      ACC.7,?C0015?ZW_TXQ_PROTOCOL
B1:00856E B11B              ACALL    ?L?COM000C
B1:008570 24BB              ADD      A,#0BBH
B1:008572 B1F5              ACALL    ?L?COM0004
B1:008574 20E010            JB       ACC.0,?C0015?ZW_TXQ_PROTOCOL
B1:008577 B11B              ACALL    ?L?COM000C
B1:008579 24BC              ADD      A,#0BCH
B1:00857B B1F5              ACALL    ?L?COM0004
B1:00857D 12FEBD            LCALL    ?L?COM04EB
B1:008580 B50404            CJNE     A,AR4,?C0015?ZW_TXQ_PROTOCOL
B1:008583 7D07              MOV      R5,#07H
B1:008585 8008              SJMP     ?C0016?ZW_TXQ_PROTOCOL
B1:008587         ?C0015?ZW_TXQ_PROTOCOL:
B1:008587 B11B              ACALL    ?L?COM000C
B1:008589 24B1              ADD      A,#0B1H
B1:00858B B1F5              ACALL    ?L?COM0004
B1:00858D F1E6              ACALL    ?L?COM0543
B1:00858F         ?C0016?ZW_TXQ_PROTOCOL:
B1:00858F 7C00              MOV      R4,#00H
B1:008591         
B1:008591 8035              SJMP     ?C0050?ZW_TXQ_PROTOCOL
B1:008593         ?C0014?ZW_TXQ_PROTOCOL:
B1:008593 E4                CLR      A
B1:008594 90402B            MOV      DPTR,#delayCountProtocol
B1:008597 F0                MOVX     @DPTR,A
B1:008598 7E1A              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:00859A 7F4D              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_RetransmitDelay
B1:00859C B11B              ACALL    ?L?COM000C
B1:00859E 24B7              ADD      A,#0B7H
B1:0085A0 B1F5              ACALL    ?L?COM0004
B1:0085A2 30E719            JNB      ACC.7,?C0018?ZW_TXQ_PROTOCOL
B1:0085A5 B11B              ACALL    ?L?COM000C
B1:0085A7 24BB              ADD      A,#0BBH
B1:0085A9 B1F5              ACALL    ?L?COM0004
B1:0085AB 20E010            JB       ACC.0,?C0018?ZW_TXQ_PROTOCOL
B1:0085AE B11B              ACALL    ?L?COM000C
B1:0085B0 24BC              ADD      A,#0BCH
B1:0085B2 B1F5              ACALL    ?L?COM0004
B1:0085B4 12FEBD            LCALL    ?L?COM04EB
B1:0085B7 B50404            CJNE     A,AR4,?C0018?ZW_TXQ_PROTOCOL
B1:0085BA 7D07              MOV      R5,#07H
B1:0085BC 8008              SJMP     ?C0019?ZW_TXQ_PROTOCOL
B1:0085BE         ?C0018?ZW_TXQ_PROTOCOL:
B1:0085BE B11B              ACALL    ?L?COM000C
B1:0085C0 24B1              ADD      A,#0B1H
B1:0085C2 B1F5              ACALL    ?L?COM0004
B1:0085C4 F1E6              ACALL    ?L?COM0543
B1:0085C6         ?C0019?ZW_TXQ_PROTOCOL:
B1:0085C6 7C00              MOV      R4,#00H
B1:0085C8         
B1:;----                  JMP      _TransmitTimerStart
----- FUNCTION _ProtocolWaitForACK (END) -------


----- FUNCTION _TransmitTimerStart (BEGIN) -----
B1:0085C8 900AD4            MOV      DPTR,#func
B1:0085CB EE                MOV      A,R6
B1:0085CC F0                MOVX     @DPTR,A
B1:0085CD A3                INC      DPTR
B1:0085CE EF                MOV      A,R7
B1:0085CF F0                MOVX     @DPTR,A
;---- Variable 'timerTicks' assigned to Register 'R4/R5' ----
B1:0085D0 904013            MOV      DPTR,#bRetransmitTimer
B1:0085D3 7401              MOV      A,#01H
B1:0085D5 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 195


B1:0085D6 AE04              MOV      R6,AR4
B1:0085D8 AF05              MOV      R7,AR5
B1:0085DA 128800            LCALL    _TimeOutConvert
B1:0085DD AC06              MOV      R4,AR6
B1:0085DF AD07              MOV      R5,AR7
B1:0085E1 900AD4            MOV      DPTR,#func
B1:0085E4 E0                MOVX     A,@DPTR
B1:0085E5 FE                MOV      R6,A
B1:0085E6 A3                INC      DPTR
B1:0085E7 E0                MOVX     A,@DPTR
B1:0085E8 FF                MOV      R7,A
B1:0085E9 021C46            LJMP     ?INTERBANK_TABLE?_TransportTimerStart
----- FUNCTION _TransmitTimerStart (END) -------


----- FUNCTION ?L?COM0001 (BEGIN) -----
B1:0085EC 904197            MOV      DPTR,#pCmd
B1:0085EF         ?L?COM0002:
B1:0085EF 122552            LCALL    ?C?PLDXDATA
B1:0085F2         ?L?COM0003:
B1:0085F2 E9                MOV      A,R1
B1:0085F3 2403              ADD      A,#03H
B1:0085F5         ?L?COM0004:
B1:0085F5 F9                MOV      R1,A
B1:0085F6 E4                CLR      A
B1:0085F7 3A                ADDC     A,R2
B1:0085F8 FA                MOV      R2,A
B1:0085F9 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0001 (END) -------


----- FUNCTION _HandleTransferAck (BEGIN) -----
B1:0085FC 900AE8            MOV      DPTR,#bTransferAckRssi
B1:0085FF B119              ACALL    ?L?COM000A
B1:008601 24B7              ADD      A,#0B7H
B1:008603 B1F5              ACALL    ?L?COM0004
B1:008605 FF                MOV      R7,A
B1:008606 30E77A            JNB      ACC.7,?C0417?ZW_TRANSPORT
B1:008609 540F              ANL      A,#0FH
B1:00860B 6401              XRL      A,#01H
B1:00860D 7074              JNZ      ?C0417?ZW_TRANSPORT
B1:00860F B11B              ACALL    ?L?COM000C
B1:008611 24B6              ADD      A,#0B6H
B1:008613 B1F5              ACALL    ?L?COM0004
B1:008615 12D707            LCALL    ?L?COM0183
B1:008618 7069              JNZ      ?C0417?ZW_TRANSPORT
B1:00861A 900667            MOV      DPTR,#isRoutedAckErr
B1:00861D E0                MOVX     A,@DPTR
B1:00861E 7063              JNZ      ?C0417?ZW_TRANSPORT
B1:008620 904017            MOV      DPTR,#waitingForRoutedACK
B1:008623 04                INC      A
B1:008624 B11A              ACALL    ?L?COM000B
B1:008626 24BB              ADD      A,#0BBH
B1:008628 B1F5              ACALL    ?L?COM0004
B1:00862A 30E33C            JNB      ACC.3,?C0418?ZW_TRANSPORT
B1:00862D B11B              ACALL    ?L?COM000C
B1:00862F 24BC              ADD      A,#0BCH
B1:008631 B1F5              ACALL    ?L?COM0004
B1:008633 12BBF5            LCALL    ?L?COM01E2
B1:008636 B11B              ACALL    ?L?COM000C
B1:008638 24BD              ADD      A,#0BDH
B1:00863A 12B8C4            LCALL    ?L?COM002D
B1:00863D 121F7C            LCALL    ?C?CLDPTR
B1:008640 540F              ANL      A,#0FH
B1:008642 7025              JNZ      ?C0418?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 196


B1:008644 B11B              ACALL    ?L?COM000C
B1:008646 2F                ADD      A,R7
B1:008647 F9                MOV      R1,A
B1:008648 EE                MOV      A,R6
B1:008649 3A                ADDC     A,R2
B1:00864A FA                MOV      R2,A
B1:00864B E9                MOV      A,R1
B1:00864C 24BE              ADD      A,#0BEH
B1:00864E B1F5              ACALL    ?L?COM0004
B1:008650 5460              ANL      A,#060H
B1:008652 6015              JZ       ?C0418?ZW_TRANSPORT
B1:008654 B11B              ACALL    ?L?COM000C
B1:008656 24BC              ADD      A,#0BCH
B1:008658 B1F5              ACALL    ?L?COM0004
B1:00865A C4                SWAP     A
B1:00865B 540F              ANL      A,#0FH
B1:00865D 2404              ADD      A,#04H
B1:00865F 12FECF            LCALL    ?L?COM051A
B1:008662 7D6E              MOV      R5,#06EH
B1:008664 7C00              MOV      R4,#00H
B1:008666 028859            LJMP     _TransmitTimerStart_NoSpeed
B1:008669         ?C0418?ZW_TRANSPORT:
B1:008669 E4                CLR      A
B1:00866A 90066C            MOV      DPTR,#delayCount
B1:00866D B11A              ACALL    ?L?COM000B
B1:00866F 24BC              ADD      A,#0BCH
B1:008671 B1F5              ACALL    ?L?COM0004
B1:008673 C4                SWAP     A
B1:008674 540F              ANL      A,#0FH
B1:008676 75F03E            MOV      B,#03EH
B1:008679 A4                MUL      AB
B1:00867A FD                MOV      R5,A
B1:00867B ACF0              MOV      R4,B
B1:00867D 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:00867F 7F6C              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:008681 A1C8              AJMP     _TransmitTimerStart
B1:008683         ?C0417?ZW_TRANSPORT:
B1:008683 B11B              ACALL    ?L?COM000C
B1:008685 24B7              ADD      A,#0B7H
B1:008687 B1F5              ACALL    ?L?COM0004
B1:008689 20E716            JB       ACC.7,?C0421?ZW_TRANSPORT
B1:00868C 90076A            MOV      DPTR,#activeTransmit+01H
B1:00868F E0                MOVX     A,@DPTR
B1:008690 F4                CPL      A
B1:008691 6003              JZ       ?C0422?ZW_TRANSPORT
B1:008693 1288C3            LCALL    ?L?COM051D
B1:008696         ?C0422?ZW_TRANSPORT:
B1:008696 B11B              ACALL    ?L?COM000C
B1:008698 24B2              ADD      A,#0B2H
B1:00869A F1D7              ACALL    ?L?COM02D1
B1:00869C 12D43A            LCALL    _StoreRoute
B1:00869F 1289DD            LCALL    _UpdateResponseRouteLastReturnRoute
B1:0086A2         ?C0421?ZW_TRANSPORT:
B1:0086A2 F1CF              ACALL    TransmitTimerStop
B1:0086A4 7A07              MOV      R2,#HIGH abRssiFeedback+01H
B1:0086A6 7989              MOV      R1,#LOW abRssiFeedback+01H
B1:0086A8 12FAC3            LCALL    ?L?COM04CA
B1:0086AB 900AE8            MOV      DPTR,#bTransferAckRssi
B1:0086AE E0                MOVX     A,@DPTR
B1:0086AF 900788            MOV      DPTR,#abRssiFeedback
B1:0086B2 F0                MOVX     @DPTR,A
B1:0086B3 901222            MOV      DPTR,#rfRxCurrentCh
B1:0086B6 E0                MOVX     A,@DPTR
B1:0086B7 FF                MOV      R7,A
B1:0086B8 B11B              ACALL    ?L?COM000C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 197


B1:0086BA 24E4              ADD      A,#0E4H
B1:0086BC F1AB              ACALL    ?L?COM0015
B1:0086BE 7B01              MOV      R3,#01H
B1:0086C0 7A07              MOV      R2,#HIGH abRssiFeedback
B1:0086C2 7988              MOV      R1,#LOW abRssiFeedback
B1:0086C4 7F01              MOV      R7,#01H
B1:;----                  JMP      _TxPermanentlyDone
----- FUNCTION _HandleTransferAck (END) -------


----- FUNCTION _TxPermanentlyDone (BEGIN) -----
B1:0086C6 90456E            MOV      DPTR,#fStatus
B1:0086C9 12D851            LCALL    ?L?COM01BA
B1:0086CC 12C554            LCALL    ClearSendDataTxStatus
B1:0086CF B11B              ACALL    ?L?COM000C
B1:0086D1 4A                ORL      A,R2
B1:0086D2 C3                CLR      C
B1:0086D3 6001              JZ       ?C0025?ZW_TXQ_PROTOCOL
B1:0086D5 D3                SETB     C
B1:0086D6         ?C0025?ZW_TXQ_PROTOCOL:
B1:0086D6         ?C0026?ZW_TXQ_PROTOCOL:
B1:0086D6 4002              JC       $ + 4H
B1:0086D8 E19C              AJMP     ?C0027?ZW_TXQ_PROTOCOL
B1:0086DA         ?C0024?ZW_TXQ_PROTOCOL:
B1:0086DA 12F6B9            LCALL    ?L?COM0421
B1:0086DD 5013              JNC      ?C0028?ZW_TXQ_PROTOCOL
B1:0086DF E0                MOVX     A,@DPTR
B1:0086E0 FF                MOV      R7,A
B1:0086E1 9404              SUBB     A,#04H
B1:0086E3 5002              JNC      ?C0029?ZW_TXQ_PROTOCOL
B1:0086E5 8002              SJMP     ?C0030?ZW_TXQ_PROTOCOL
B1:0086E7         ?C0029?ZW_TXQ_PROTOCOL:
B1:0086E7 7F04              MOV      R7,#04H
B1:0086E9         ?C0030?ZW_TXQ_PROTOCOL:
B1:0086E9 B11B              ACALL    ?L?COM000C
B1:0086EB F1DF              ACALL    ?L?COM02B8
B1:0086ED F1B9              ACALL    ?L?COM003F
B1:0086EF 12FE99            LCALL    ?L?COM0478
B1:0086F2         ?C0028?ZW_TXQ_PROTOCOL:
B1:0086F2 B11B              ACALL    ?L?COM000C
B1:0086F4 1252F2            LCALL    ?L?COM0020
B1:0086F7 5467              ANL      A,#067H
B1:0086F9 904027            MOV      DPTR,#tx_status+0FH
B1:0086FC B11A              ACALL    ?L?COM000B
B1:0086FE 24DF              ADD      A,#0DFH
B1:008700 B1F5              ACALL    ?L?COM0004
B1:008702 904022            MOV      DPTR,#tx_status+0AH
B1:008705 B11A              ACALL    ?L?COM000B
B1:008707 24E6              ADD      A,#0E6H
B1:008709 B1F5              ACALL    ?L?COM0004
B1:00870B 904028            MOV      DPTR,#tx_status+010H
B1:00870E B11A              ACALL    ?L?COM000B
B1:008710 24E7              ADD      A,#0E7H
B1:008712 B1F5              ACALL    ?L?COM0004
B1:008714 904029            MOV      DPTR,#tx_status+011H
B1:008717 B11A              ACALL    ?L?COM000B
B1:008719 24E8              ADD      A,#0E8H
B1:00871B B1F5              ACALL    ?L?COM0004
B1:00871D 90402A            MOV      DPTR,#tx_status+012H
B1:008720 B11A              ACALL    ?L?COM000B
B1:008722 24E4              ADD      A,#0E4H
B1:008724 B1F5              ACALL    ?L?COM0004
B1:008726 904020            MOV      DPTR,#tx_status+08H
B1:008729 B11A              ACALL    ?L?COM000B
B1:00872B 24E5              ADD      A,#0E5H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 198


B1:00872D B1F5              ACALL    ?L?COM0004
B1:00872F 904021            MOV      DPTR,#tx_status+09H
B1:008732 B11A              ACALL    ?L?COM000B
B1:008734 24E9              ADD      A,#0E9H
B1:008736 1252F4            LCALL    ?L?COM0021
B1:008739 12FE65            LCALL    ?L?COM038B
B1:00873C F0                MOVX     @DPTR,A
B1:00873D 904014            MOV      DPTR,#pFrameWaitingForACK
B1:008740 12964E            LCALL    ?L?COM0461
B1:008743 E4                CLR      A
B1:008744 904017            MOV      DPTR,#waitingForRoutedACK
B1:008747 F0                MOVX     @DPTR,A
B1:008748 90456E            MOV      DPTR,#fStatus
B1:00874B E0                MOVX     A,@DPTR
B1:00874C 600E              JZ       ?C0031?ZW_TXQ_PROTOCOL
B1:00874E A3                INC      DPTR
B1:00874F F1B6              ACALL    ?L?COM003E
B1:008751 7B01              MOV      R3,#01H
B1:008753 7A40              MOV      R2,#HIGH tx_status+03H
B1:008755 791B              MOV      R1,#LOW tx_status+03H
B1:008757 7F05              MOV      R7,#05H
B1:008759 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00875C         ?C0031?ZW_TXQ_PROTOCOL:
B1:00875C 90456E            MOV      DPTR,#fStatus
B1:00875F E0                MOVX     A,@DPTR
B1:008760 7F01              MOV      R7,#01H
B1:008762 6002              JZ       ?C0032?ZW_TXQ_PROTOCOL
B1:008764 7F00              MOV      R7,#00H
B1:008766         ?C0032?ZW_TXQ_PROTOCOL:
B1:008766         ?C0033?ZW_TXQ_PROTOCOL:
B1:008766 90456E            MOV      DPTR,#fStatus
B1:008769 B119              ACALL    ?L?COM000A
B1:00876B 24DC              ADD      A,#0DCH
B1:00876D 1252F4            LCALL    ?L?COM0021
B1:008770 45F0              ORL      A,B
B1:008772 601F              JZ       ?C0034?ZW_TXQ_PROTOCOL
B1:008774 90456E            MOV      DPTR,#fStatus
B1:008777 12FEAB            LCALL    ?L?COM04DE
B1:00877A C003              PUSH     AR3
B1:00877C C002              PUSH     AR2
B1:00877E C001              PUSH     AR1
B1:008780 B11B              ACALL    ?L?COM000C
B1:008782 24DC              ADD      A,#0DCH
B1:008784 1252F4            LCALL    ?L?COM0021
B1:008787 12FEB4            LCALL    ?L?COM04E9
B1:00878A D001              POP      AR1
B1:00878C D002              POP      AR2
B1:00878E D003              POP      AR3
B1:008790 1226E3            LCALL    ?C?ICALL2
B1:008793         ?C0034?ZW_TXQ_PROTOCOL:
B1:008793 12A79C            LCALL    ?L?COM00A4
B1:008796 904014            MOV      DPTR,#pFrameWaitingForACK
B1:008799 122572            LCALL    ?C?PSTXDATA
B1:00879C         ?C0027?ZW_TXQ_PROTOCOL:
B1:00879C 22                RET      
----- FUNCTION _TxPermanentlyDone (END) -------


----- FUNCTION ?L?COM0012 (BEGIN) -----
B1:00879D FA                MOV      R2,A
B1:00879E 121F7C            LCALL    ?C?CLDPTR
B1:0087A1         ?L?COM0013:
B1:0087A1 FF                MOV      R7,A
B1:0087A2 900A07            MOV      DPTR,#pRxFrame
B1:0087A5         ?L?COM0014:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 199


B1:0087A5 122552            LCALL    ?C?PLDXDATA
B1:0087A8 E9                MOV      A,R1
B1:0087A9 2408              ADD      A,#08H
B1:0087AB         ?L?COM0015:
B1:0087AB F9                MOV      R1,A
B1:0087AC E4                CLR      A
B1:0087AD 3A                ADDC     A,R2
B1:0087AE FA                MOV      R2,A
B1:0087AF EF                MOV      A,R7
B1:0087B0 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0012 (END) -------


----- FUNCTION ?L?COM003D (BEGIN) -----
B1:0087B3 904197            MOV      DPTR,#pCmd
B1:0087B6         ?L?COM003E:
B1:0087B6 122552            LCALL    ?C?PLDXDATA
B1:0087B9         ?L?COM003F:
B1:0087B9 904423            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
B1:0087BC 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM003D (END) -------


----- FUNCTION ?L?COM01B2 (BEGIN) -----
B1:0087BF E0                MOVX     A,@DPTR
B1:0087C0         ?L?COM01B3:
B1:0087C0 75F0EB            MOV      B,#0EBH
B1:0087C3 A4                MUL      AB
B1:0087C4 2407              ADD      A,#LOW X4K_TxQueue
B1:0087C6 F9                MOV      R1,A
B1:0087C7 7400              MOV      A,#HIGH X4K_TxQueue
B1:0087C9 35F0              ADDC     A,B
B1:0087CB FA                MOV      R2,A
B1:0087CC 7B01              MOV      R3,#01H
B1:0087CE 22                RET      
----- FUNCTION ?L?COM01B2 (END) -------


----- FUNCTION TransmitTimerStop (BEGIN) -----
B1:0087CF E4                CLR      A
B1:0087D0 904013            MOV      DPTR,#bRetransmitTimer
B1:0087D3 F0                MOVX     @DPTR,A
B1:0087D4 021C4B            LJMP     ?INTERBANK_TABLE?TransportTimerCancel
----- FUNCTION TransmitTimerStop (END) -------


----- FUNCTION ?L?COM02D1 (BEGIN) -----
B1:0087D7 F9                MOV      R1,A
B1:0087D8 E4                CLR      A
B1:0087D9 3A                ADDC     A,R2
B1:0087DA FE                MOV      R6,A
B1:0087DB AF01              MOV      R7,AR1
B1:0087DD 22                RET      
----- FUNCTION ?L?COM02D1 (END) -------


----- FUNCTION ?L?COM02B7 (BEGIN) -----
B1:0087DE E9                MOV      A,R1
B1:0087DF         ?L?COM02B8:
B1:0087DF 24BD              ADD      A,#0BDH
B1:0087E1 F9                MOV      R1,A
B1:0087E2 E4                CLR      A
B1:0087E3 3A                ADDC     A,R2
B1:0087E4 FA                MOV      R2,A
B1:0087E5 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 200


----- FUNCTION ?L?COM02B7 (END) -------


----- FUNCTION ?L?COM0543 (BEGIN) -----
B1:0087E6 75F00A            MOV      B,#0AH
B1:0087E9 84                DIV      AB
B1:0087EA 2406              ADD      A,#06H
B1:0087EC FD                MOV      R5,A
B1:0087ED 22                RET      
----- FUNCTION ?L?COM0543 (END) -------


----- FUNCTION ?L?COM057C (BEGIN) -----
B1:0087EE F0                MOVX     @DPTR,A
B1:0087EF A3                INC      DPTR
B1:0087F0 74FF              MOV      A,#0FFH
B1:0087F2 F0                MOVX     @DPTR,A
B1:0087F3 E4                CLR      A
B1:0087F4 FF                MOV      R7,A
B1:0087F5 22                RET      
----- FUNCTION ?L?COM057C (END) -------


----- FUNCTION ?L?COM0470 (BEGIN) -----
B1:0087F6 900ABE            MOV      DPTR,#pTransmittedFrame
B1:0087F9 122552            LCALL    ?C?PLDXDATA
B1:0087FC E9                MOV      A,R1
B1:0087FD 24DA              ADD      A,#0DAH
B1:0087FF 22                RET      
----- FUNCTION ?L?COM0470 (END) -------


----- FUNCTION _TimeOutConvert (BEGIN) -----
B1:008800 900AD2            MOV      DPTR,#timeOut
B1:008803 EE                MOV      A,R6
B1:008804 F0                MOVX     @DPTR,A
B1:008805 A3                INC      DPTR
B1:008806 128519            LCALL    ?L?COM000A
B1:008809 1252F2            LCALL    ?L?COM0020
B1:00880C 5407              ANL      A,#07H
B1:00880E FF                MOV      R7,A
B1:00880F 6402              XRL      A,#02H
B1:008811 6005              JZ       ?C0007?ZW_TRANSPORT
B1:008813 EF                MOV      A,R7
B1:008814 6403              XRL      A,#03H
B1:008816 7016              JNZ      ?C0006?ZW_TRANSPORT
B1:008818         ?C0007?ZW_TRANSPORT:
B1:008818 1150              ACALL    ?L?COM0521
B1:00881A 25E0              ADD      A,ACC
B1:00881C FB                MOV      R3,A
B1:00881D EC                MOV      A,R4
B1:00881E 33                RLC      A
B1:00881F FA                MOV      R2,A
B1:008820 ED                MOV      A,R5
B1:008821 AE04              MOV      R6,AR4
B1:008823 7803              MOV      R0,#03H
B1:008825         ?C0556?ZW_TRANSPORT:
B1:008825 C3                CLR      C
B1:008826 33                RLC      A
B1:008827 CE                XCH      A,R6
B1:008828 33                RLC      A
B1:008829 CE                XCH      A,R6
B1:00882A D8F9              DJNZ     R0,?C0556?ZW_TRANSPORT
B1:00882C 801C              SJMP     ?C0575?ZW_TRANSPORT
B1:00882E         ?C0006?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 201


B1:00882E 1150              ACALL    ?L?COM0521
B1:008830 AE04              MOV      R6,AR4
B1:008832 7803              MOV      R0,#03H
B1:008834         ?C0557?ZW_TRANSPORT:
B1:008834 C3                CLR      C
B1:008835 33                RLC      A
B1:008836 CE                XCH      A,R6
B1:008837 33                RLC      A
B1:008838 CE                XCH      A,R6
B1:008839 D8F9              DJNZ     R0,?C0557?ZW_TRANSPORT
B1:00883B FB                MOV      R3,A
B1:00883C AA06              MOV      R2,AR6
B1:00883E ED                MOV      A,R5
B1:00883F AE04              MOV      R6,AR4
B1:008841 7805              MOV      R0,#05H
B1:008843         ?C0558?ZW_TRANSPORT:
B1:008843 C3                CLR      C
B1:008844 33                RLC      A
B1:008845 CE                XCH      A,R6
B1:008846 33                RLC      A
B1:008847 CE                XCH      A,R6
B1:008848 D8F9              DJNZ     R0,?C0558?ZW_TRANSPORT
B1:00884A         
B1:00884A 2B                ADD      A,R3
B1:00884B FF                MOV      R7,A
B1:00884C EE                MOV      A,R6
B1:00884D 3A                ADDC     A,R2
B1:00884E FE                MOV      R6,A
B1:00884F 22                RET      
----- FUNCTION _TimeOutConvert (END) -------


----- FUNCTION ?L?COM0521 (BEGIN) -----
B1:008850 900AD2            MOV      DPTR,#timeOut
B1:008853 E0                MOVX     A,@DPTR
B1:008854 FC                MOV      R4,A
B1:008855 A3                INC      DPTR
B1:008856 E0                MOVX     A,@DPTR
B1:008857 FD                MOV      R5,A
B1:008858 22                RET      
----- FUNCTION ?L?COM0521 (END) -------


----- FUNCTION _TransmitTimerStart_NoSpeed (BEGIN) -----
;---- Variable 'timerTicks' assigned to Register 'R4/R5' ----
;---- Variable 'func' assigned to Register 'R6/R7' ----
B1:008859 904013            MOV      DPTR,#bRetransmitTimer
B1:00885C 7401              MOV      A,#01H
B1:00885E F0                MOVX     @DPTR,A
B1:00885F C006              PUSH     AR6
B1:008861 C007              PUSH     AR7
B1:008863 ED                MOV      A,R5
B1:008864 AE04              MOV      R6,AR4
B1:008866 7803              MOV      R0,#03H
B1:008868         ?C0559?ZW_TRANSPORT:
B1:008868 C3                CLR      C
B1:008869 33                RLC      A
B1:00886A CE                XCH      A,R6
B1:00886B 33                RLC      A
B1:00886C CE                XCH      A,R6
B1:00886D D8F9              DJNZ     R0,?C0559?ZW_TRANSPORT
B1:00886F FB                MOV      R3,A
B1:008870 AA06              MOV      R2,AR6
B1:008872 AE04              MOV      R6,AR4
B1:008874 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 202


B1:008875 7805              MOV      R0,#05H
B1:008877         ?C0560?ZW_TRANSPORT:
B1:008877 C3                CLR      C
B1:008878 33                RLC      A
B1:008879 CE                XCH      A,R6
B1:00887A 33                RLC      A
B1:00887B CE                XCH      A,R6
B1:00887C D8F9              DJNZ     R0,?C0560?ZW_TRANSPORT
B1:00887E 2B                ADD      A,R3
B1:00887F FD                MOV      R5,A
B1:008880 EE                MOV      A,R6
B1:008881 3A                ADDC     A,R2
B1:008882 FC                MOV      R4,A
B1:008883 D007              POP      AR7
B1:008885 D006              POP      AR6
B1:008887 021C46            LJMP     ?INTERBANK_TABLE?_TransportTimerStart
----- FUNCTION _TransmitTimerStart_NoSpeed (END) -------


----- FUNCTION DelayTimerStop (BEGIN) -----
B1:00888A 7B01              MOV      R3,#01H
B1:00888C 7A07              MOV      R2,#HIGH delayHandle
B1:00888E 797B              MOV      R1,#LOW delayHandle
B1:008890 0253DD            LJMP     _SafeTimerStop
----- FUNCTION DelayTimerStop (END) -------


----- FUNCTION ReturnRouteResetPriority (BEGIN) -----
B1:008893 E4                CLR      A
B1:008894 900AE4            MOV      DPTR,#bDestIndex
B1:008897 F0                MOVX     @DPTR,A
B1:008898 F0                MOVX     @DPTR,A
B1:008899         ?C0014?ZW_TRANSPORT:
B1:008899 900AE4            MOV      DPTR,#bDestIndex
B1:00889C E0                MOVX     A,@DPTR
B1:00889D FF                MOV      R7,A
B1:00889E C3                CLR      C
B1:00889F 94E9              SUBB     A,#0E9H
B1:0088A1 500A              JNC      ?C0017?ZW_TRANSPORT
B1:0088A3 11AE              ACALL    _ReturnRouteClearPriority
B1:0088A5 900AE4            MOV      DPTR,#bDestIndex
B1:0088A8 E0                MOVX     A,@DPTR
B1:0088A9 04                INC      A
B1:0088AA F0                MOVX     @DPTR,A
B1:0088AB 80EC              SJMP     ?C0014?ZW_TRANSPORT
B1:0088AD         ?C0017?ZW_TRANSPORT:
B1:0088AD 22                RET      
----- FUNCTION ReturnRouteResetPriority (END) -------


----- FUNCTION _ReturnRouteClearPriority (BEGIN) -----
;---- Variable 'bDestIndex' assigned to Register 'R7' ----
B1:0088AE 747A              MOV      A,#LOW abReturnRoutePriority
B1:0088B0 2F                ADD      A,R7
B1:0088B1 11BB              ACALL    ?L?COM01D4
B1:0088B3 74E4              MOV      A,#0E4H
B1:0088B5 F0                MOVX     @DPTR,A
B1:0088B6 22                RET      
----- FUNCTION _ReturnRouteClearPriority (END) -------


----- FUNCTION ?L?COM01D3 (BEGIN) -----
B1:0088B7 747A              MOV      A,#LOW abReturnRoutePriority
B1:0088B9 2565              ADD      A,destRouteIndex
B1:0088BB         ?L?COM01D4:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 203


B1:0088BB F582              MOV      DPL,A
B1:0088BD E4                CLR      A
B1:0088BE 3406              ADDC     A,#HIGH abReturnRoutePriority
B1:0088C0 F583              MOV      DPH,A
B1:0088C2 22                RET      
----- FUNCTION ?L?COM01D3 (END) -------


----- FUNCTION ?L?COM051D (BEGIN) -----
B1:0088C3 90077A            MOV      DPTR,#bReturnRoutePriorityIndex
B1:0088C6 E0                MOVX     A,@DPTR
B1:0088C7 FF                MOV      R7,A
----- FUNCTION _ReturnRouteChangePriority (BEGIN) -----
;---- Variable 'bRouteIndex' assigned to Register 'R7' ----
B1:0088C8 7403              MOV      A,#03H
B1:0088CA A807              MOV      R0,AR7
B1:0088CC 08                INC      R0
B1:0088CD 8002              SJMP     ?C0564?ZW_TRANSPORT
B1:0088CF         ?C0563?ZW_TRANSPORT:
B1:0088CF C3                CLR      C
B1:0088D0 33                RLC      A
B1:0088D1         ?C0564?ZW_TRANSPORT:
B1:0088D1 D8FC              DJNZ     R0,?C0563?ZW_TRANSPORT
B1:0088D3 FE                MOV      R6,A
;---- Variable 'bMask' assigned to Register 'R6' ----
B1:0088D4 11B7              ACALL    ?L?COM01D3
B1:0088D6 E0                MOVX     A,@DPTR
B1:0088D7 5E                ANL      A,R6
B1:0088D8 FE                MOV      R6,A
B1:0088D9 A807              MOV      R0,AR7
B1:0088DB 08                INC      R0
B1:0088DC 8002              SJMP     ?C0566?ZW_TRANSPORT
B1:0088DE         ?C0565?ZW_TRANSPORT:
B1:0088DE C3                CLR      C
B1:0088DF 13                RRC      A
B1:0088E0         ?C0566?ZW_TRANSPORT:
B1:0088E0 D8FC              DJNZ     R0,?C0565?ZW_TRANSPORT
B1:0088E2 900AC1            MOV      DPTR,#bOldPriority
B1:0088E5 F0                MOVX     @DPTR,A
B1:0088E6 E4                CLR      A
B1:0088E7 A3                INC      DPTR
B1:0088E8 F0                MOVX     @DPTR,A
B1:0088E9 A3                INC      DPTR
B1:0088EA 04                INC      A
B1:0088EB F0                MOVX     @DPTR,A
B1:0088EC 7E03              MOV      R6,#03H
B1:0088EE         ?C0026?ZW_TRANSPORT:
B1:0088EE 900AC2            MOV      DPTR,#bTemp2
B1:0088F1 E0                MOVX     A,@DPTR
B1:0088F2 FD                MOV      R5,A
B1:0088F3 C3                CLR      C
B1:0088F4 9404              SUBB     A,#04H
B1:0088F6 5056              JNC      ?C0030?ZW_TRANSPORT
B1:0088F8 11B7              ACALL    ?L?COM01D3
B1:0088FA E0                MOVX     A,@DPTR
B1:0088FB 5E                ANL      A,R6
B1:0088FC FC                MOV      R4,A
B1:0088FD A805              MOV      R0,AR5
B1:0088FF 08                INC      R0
B1:008900 8002              SJMP     ?C0568?ZW_TRANSPORT
B1:008902         ?C0567?ZW_TRANSPORT:
B1:008902 C3                CLR      C
B1:008903 13                RRC      A
B1:008904         ?C0568?ZW_TRANSPORT:
B1:008904 D8FC              DJNZ     R0,?C0567?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 204


B1:008906 FD                MOV      R5,A
;---- Variable 'bPriority' assigned to Register 'R5' ----
B1:008907 C3                CLR      C
B1:008908 9400              SUBB     A,#00H
B1:00890A 4013              JC       ?C0029?ZW_TRANSPORT
B1:00890C 900AC1            MOV      DPTR,#bOldPriority
B1:00890F E0                MOVX     A,@DPTR
B1:008910 FC                MOV      R4,A
B1:008911 ED                MOV      A,R5
B1:008912 9C                SUBB     A,R4
B1:008913 500A              JNC      ?C0029?ZW_TRANSPORT
B1:008915 900AC3            MOV      DPTR,#bInc
B1:008918 E0                MOVX     A,@DPTR
B1:008919 FD                MOV      R5,A
B1:00891A 11B7              ACALL    ?L?COM01D3
B1:00891C E0                MOVX     A,@DPTR
B1:00891D 2D                ADD      A,R5
B1:00891E F0                MOVX     @DPTR,A
B1:00891F         ?C0029?ZW_TRANSPORT:
B1:00891F 11B7              ACALL    ?L?COM01D3
B1:008921 C083              PUSH     DPH
B1:008923 C082              PUSH     DPL
B1:008925 E0                MOVX     A,@DPTR
B1:008926 FD                MOV      R5,A
B1:008927 7403              MOV      A,#03H
B1:008929 A807              MOV      R0,AR7
B1:00892B 08                INC      R0
B1:00892C 8002              SJMP     ?C0570?ZW_TRANSPORT
B1:00892E         ?C0569?ZW_TRANSPORT:
B1:00892E C3                CLR      C
B1:00892F 33                RLC      A
B1:008930         ?C0570?ZW_TRANSPORT:
B1:008930 D8FC              DJNZ     R0,?C0569?ZW_TRANSPORT
B1:008932 F4                CPL      A
B1:008933 5D                ANL      A,R5
B1:008934 D082              POP      DPL
B1:008936 D083              POP      DPH
B1:008938 F0                MOVX     @DPTR,A
B1:008939 900AC2            MOV      DPTR,#bTemp2
B1:00893C E0                MOVX     A,@DPTR
B1:00893D 04                INC      A
B1:00893E F0                MOVX     @DPTR,A
B1:00893F EE                MOV      A,R6
B1:008940 25E0              ADD      A,ACC
B1:008942 25E0              ADD      A,ACC
B1:008944 FE                MOV      R6,A
B1:008945 A3                INC      DPTR
B1:008946 E0                MOVX     A,@DPTR
B1:008947 25E0              ADD      A,ACC
B1:008949 25E0              ADD      A,ACC
B1:00894B F0                MOVX     @DPTR,A
B1:00894C 80A0              SJMP     ?C0026?ZW_TRANSPORT
B1:00894E         ?C0030?ZW_TRANSPORT:
B1:00894E 22                RET      
----- FUNCTION _ReturnRouteChangePriority (END) -------


----- FUNCTION ?L?COM0518 (BEGIN) -----
B1:00894F 903329            MOV      DPTR,#tempi
B1:008952 E0                MOVX     A,@DPTR
B1:008953 FD                MOV      R5,A
----- FUNCTION _ZCB_ReturnRouteFindPriority (BEGIN) -----
B1:008954 900A8A            MOV      DPTR,#bPriority
B1:008957 126E7B            LCALL    ?L?COM02C1
B1:00895A A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 205


B1:00895B F0                MOVX     @DPTR,A
B1:00895C A3                INC      DPTR
B1:00895D 7403              MOV      A,#03H
B1:00895F F0                MOVX     @DPTR,A
B1:008960 900A8B            MOV      DPTR,#bRouteIndex
B1:008963 1239E1            LCALL    ?L?COM007D
B1:008966 EF                MOV      A,R7
B1:008967 541C              ANL      A,#01CH
B1:008969 13                RRC      A
B1:00896A 13                RRC      A
B1:00896B 543F              ANL      A,#03FH
B1:00896D 900A8D            MOV      DPTR,#bPriorityRoute
B1:008970 F0                MOVX     @DPTR,A
B1:008971 E0                MOVX     A,@DPTR
B1:008972 FF                MOV      R7,A
B1:008973 6014              JZ       ?C0022?ZW_TRANSPORT
B1:008975 900A8A            MOV      DPTR,#bPriority
B1:008978 E0                MOVX     A,@DPTR
B1:008979 700E              JNZ      ?C0022?ZW_TRANSPORT
B1:00897B EF                MOV      A,R7
B1:00897C 14                DEC      A
B1:00897D FF                MOV      R7,A
B1:00897E 11C8              ACALL    _ReturnRouteChangePriority
B1:008980 900A8D            MOV      DPTR,#bPriorityRoute
B1:008983 E0                MOVX     A,@DPTR
B1:008984 C3                CLR      C
B1:008985 9401              SUBB     A,#01H
B1:008987 FF                MOV      R7,A
B1:008988 22                RET      
B1:008989         ?C0022?ZW_TRANSPORT:
B1:008989 900A8C            MOV      DPTR,#bIndex
B1:00898C E0                MOVX     A,@DPTR
B1:00898D FF                MOV      R7,A
B1:00898E C3                CLR      C
B1:00898F 9404              SUBB     A,#04H
B1:008991 5043              JNC      ?C0023?ZW_TRANSPORT
B1:008993 900A8B            MOV      DPTR,#bRouteIndex
B1:008996 E0                MOVX     A,@DPTR
B1:008997 247A              ADD      A,#LOW abReturnRoutePriority
B1:008999 11BB              ACALL    ?L?COM01D4
B1:00899B E0                MOVX     A,@DPTR
B1:00899C FE                MOV      R6,A
B1:00899D 900A8E            MOV      DPTR,#bMask
B1:0089A0 E0                MOVX     A,@DPTR
B1:0089A1 FD                MOV      R5,A
B1:0089A2 EE                MOV      A,R6
B1:0089A3 5D                ANL      A,R5
B1:0089A4 FE                MOV      R6,A
B1:0089A5 EF                MOV      A,R7
B1:0089A6 25E0              ADD      A,ACC
B1:0089A8 FF                MOV      R7,A
B1:0089A9 EE                MOV      A,R6
B1:0089AA A807              MOV      R0,AR7
B1:0089AC 08                INC      R0
B1:0089AD 8002              SJMP     ?C0562?ZW_TRANSPORT
B1:0089AF         ?C0561?ZW_TRANSPORT:
B1:0089AF C3                CLR      C
B1:0089B0 13                RRC      A
B1:0089B1         ?C0562?ZW_TRANSPORT:
B1:0089B1 D8FC              DJNZ     R0,?C0561?ZW_TRANSPORT
B1:0089B3 FF                MOV      R7,A
B1:0089B4 900A8A            MOV      DPTR,#bPriority
B1:0089B7 E0                MOVX     A,@DPTR
B1:0089B8 B5070A            CJNE     A,AR7,?C0024?ZW_TRANSPORT
B1:0089BB 900A8C            MOV      DPTR,#bIndex
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 206


B1:0089BE E0                MOVX     A,@DPTR
B1:0089BF FF                MOV      R7,A
B1:0089C0 90077A            MOV      DPTR,#bReturnRoutePriorityIndex
B1:0089C3 F0                MOVX     @DPTR,A
B1:0089C4 22                RET      
B1:0089C5         ?C0024?ZW_TRANSPORT:
B1:0089C5 900A8C            MOV      DPTR,#bIndex
B1:0089C8 E0                MOVX     A,@DPTR
B1:0089C9 04                INC      A
B1:0089CA F0                MOVX     @DPTR,A
B1:0089CB ED                MOV      A,R5
B1:0089CC 25E0              ADD      A,ACC
B1:0089CE 25E0              ADD      A,ACC
B1:0089D0 900A8E            MOV      DPTR,#bMask
B1:0089D3 F0                MOVX     @DPTR,A
B1:0089D4 80B3              SJMP     ?C0022?ZW_TRANSPORT
B1:0089D6         ?C0023?ZW_TRANSPORT:
B1:0089D6 7F00              MOV      R7,#00H
B1:0089D8 22                RET      
----- FUNCTION _ZCB_ReturnRouteFindPriority (END) -------


----- FUNCTION ?L?COM0433 (BEGIN) -----
B1:0089D9 FF                MOV      R7,A
B1:0089DA 12D43A            LCALL    _StoreRoute
----- FUNCTION _UpdateResponseRouteLastReturnRoute (BEGIN) -----
B1:0089DD 90456A            MOV      DPTR,#bResponseRouteIndex
B1:0089E0 EF                MOV      A,R7
B1:0089E1 F0                MOVX     @DPTR,A
B1:0089E2 C3                CLR      C
B1:0089E3 9402              SUBB     A,#02H
B1:0089E5 4002              JC       $ + 4H
B1:0089E7 61EF              AJMP     ?C0114?ZW_SLAVE
B1:0089E9         ?C0113?ZW_SLAVE:
B1:0089E9 90456A            MOV      DPTR,#bResponseRouteIndex
B1:0089EC D16A              ACALL    ?L?COM026A
B1:0089EE E0                MOVX     A,@DPTR
B1:0089EF FF                MOV      R7,A
B1:0089F0 90456D            MOV      DPTR,#bDestNodeID
B1:0089F3 F0                MOVX     @DPTR,A
B1:0089F4 9033A5            MOV      DPTR,#sucNodeID
B1:0089F7 E0                MOVX     A,@DPTR
B1:0089F8 FE                MOV      R6,A
B1:0089F9 EF                MOV      A,R7
B1:0089FA B50603            CJNE     A,AR6,?C0115?ZW_SLAVE
B1:0089FD E4                CLR      A
B1:0089FE 8004              SJMP     ?C0310?ZW_SLAVE
B1:008A00         ?C0115?ZW_SLAVE:
B1:008A00 90456D            MOV      DPTR,#bDestNodeID
B1:008A03 E0                MOVX     A,@DPTR
B1:008A04         
B1:008A04 903329            MOV      DPTR,#tempi
B1:008A07 F0                MOVX     @DPTR,A
B1:008A08         ?C0116?ZW_SLAVE:
B1:008A08 903329            MOV      DPTR,#tempi
B1:008A0B E0                MOVX     A,@DPTR
B1:008A0C 75F011            MOV      B,#011H
B1:008A0F A4                MUL      AB
B1:008A10 240B              ADD      A,#LOW NVM_RETURN_ROUTE_START_far
B1:008A12 F9                MOV      R1,A
B1:008A13 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far
B1:008A15 35F0              ADDC     A,B
B1:008A17 90456D            MOV      DPTR,#bDestNodeID
B1:008A1A F1D1              ACALL    ?L?COM04E6
B1:008A1C 903329            MOV      DPTR,#tempi
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 207


B1:008A1F 1239E1            LCALL    ?L?COM007D
B1:008A22 90339C            MOV      DPTR,#temp
B1:008A25 EF                MOV      A,R7
B1:008A26 F0                MOVX     @DPTR,A
B1:008A27 E0                MOVX     A,@DPTR
B1:008A28 5403              ANL      A,#03H
B1:008A2A FF                MOV      R7,A
B1:008A2B 602C              JZ       ?C0117?ZW_SLAVE
B1:008A2D 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008A30 E0                MOVX     A,@DPTR
B1:008A31 FE                MOV      R6,A
B1:008A32 71F4              ACALL    ?L?COM010D
B1:008A34 E0                MOVX     A,@DPTR
B1:008A35 548F              ANL      A,#08FH
B1:008A37 F0                MOVX     @DPTR,A
B1:008A38 743B              MOV      A,#LOW responseRouteSpeedNumHops
B1:008A3A 2E                ADD      A,R6
B1:008A3B 71F6              ACALL    ?L?COM010E
B1:008A3D E0                MOVX     A,@DPTR
B1:008A3E 4420              ORL      A,#020H
B1:008A40 F0                MOVX     @DPTR,A
B1:008A41 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008A44 E0                MOVX     A,@DPTR
B1:008A45 FE                MOV      R6,A
B1:008A46 D179              ACALL    ?L?COM020E
B1:008A48 E0                MOVX     A,@DPTR
B1:008A49 549F              ANL      A,#09FH
B1:008A4B F0                MOVX     @DPTR,A
B1:008A4C 741C              MOV      A,#LOW responseRouteRFOption
B1:008A4E 2E                ADD      A,R6
B1:008A4F D17B              ACALL    ?L?COM020F
B1:008A51 E0                MOVX     A,@DPTR
B1:008A52 FE                MOV      R6,A
B1:008A53 123BFA            LCALL    ?L?COM031D
B1:008A56 EE                MOV      A,R6
B1:008A57 4F                ORL      A,R7
B1:008A58 F0                MOVX     @DPTR,A
B1:008A59         ?C0117?ZW_SLAVE:
B1:008A59 E4                CLR      A
B1:008A5A 90456C            MOV      DPTR,#q
B1:008A5D F0                MOVX     @DPTR,A
B1:008A5E         ?C0118?ZW_SLAVE:
B1:008A5E E4                CLR      A
B1:008A5F 90456B            MOV      DPTR,#t
B1:008A62 F0                MOVX     @DPTR,A
B1:008A63         ?C0121?ZW_SLAVE:
B1:008A63 903329            MOV      DPTR,#tempi
B1:008A66 9106              ACALL    ?L?COM009C
B1:008A68 FA                MOV      R2,A
B1:008A69 90456C            MOV      DPTR,#q
B1:008A6C 912D              ACALL    ?L?COM007C
B1:008A6E FA                MOV      R2,A
B1:008A6F 90456B            MOV      DPTR,#t
B1:008A72 E0                MOVX     A,@DPTR
B1:008A73 D1B2              ACALL    ?L?COM0130
B1:008A75 B109              ACALL    ?L?COM0195
B1:008A77 90339C            MOV      DPTR,#temp
B1:008A7A EF                MOV      A,R7
B1:008A7B F0                MOVX     @DPTR,A
B1:008A7C 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008A7F E0                MOVX     A,@DPTR
B1:008A80 FF                MOV      R7,A
B1:008A81 71F4              ACALL    ?L?COM010D
B1:008A83 E0                MOVX     A,@DPTR
B1:008A84 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 208


B1:008A86 FE                MOV      R6,A
B1:008A87 90456B            MOV      DPTR,#t
B1:008A8A E0                MOVX     A,@DPTR
B1:008A8B FD                MOV      R5,A
B1:008A8C C3                CLR      C
B1:008A8D 9E                SUBB     A,R6
B1:008A8E 500B              JNC      ?C0124?ZW_SLAVE
B1:008A90 EF                MOV      A,R7
B1:008A91 D151              ACALL    ?L?COM00D1
B1:008A93 D15F              ACALL    ?L?COM0191
B1:008A95 E0                MOVX     A,@DPTR
B1:008A96 FD                MOV      R5,A
B1:008A97 7C00              MOV      R4,#00H
B1:008A99 800F              SJMP     ?C0125?ZW_SLAVE
B1:008A9B         ?C0124?ZW_SLAVE:
B1:008A9B 90456B            MOV      DPTR,#t
B1:008A9E E0                MOVX     A,@DPTR
B1:008A9F 7005              JNZ      ?C0126?ZW_SLAVE
B1:008AA1 FC                MOV      R4,A
B1:008AA2 7DFE              MOV      R5,#0FEH
B1:008AA4 8004              SJMP     ?C0127?ZW_SLAVE
B1:008AA6         ?C0126?ZW_SLAVE:
B1:008AA6 7C00              MOV      R4,#00H
B1:008AA8 7D00              MOV      R5,#00H
B1:008AAA         ?C0127?ZW_SLAVE:
B1:008AAA         ?C0125?ZW_SLAVE:
B1:008AAA AF05              MOV      R7,AR5
;---- Variable 'bRepeat' assigned to Register 'R7' ----
B1:008AAC 90339C            MOV      DPTR,#temp
B1:008AAF E0                MOVX     A,@DPTR
B1:008AB0 6F                XRL      A,R7
B1:008AB1 6002              JZ       ?C0128?ZW_SLAVE
B1:008AB3 801E              SJMP     ?C0122?ZW_SLAVE
B1:008AB5         ?C0128?ZW_SLAVE:
B1:008AB5 EF                MOV      A,R7
B1:008AB6 64FE              XRL      A,#0FEH
B1:008AB8 7002              JNZ      $ + 4H
B1:008ABA 61EF              AJMP     ?C0114?ZW_SLAVE
B1:008ABC 90456B            MOV      DPTR,#t
B1:008ABF E0                MOVX     A,@DPTR
B1:008AC0 FD                MOV      R5,A
B1:008AC1 6009              JZ       ?C0123?ZW_SLAVE
B1:008AC3 EF                MOV      A,R7
B1:008AC4 7006              JNZ      ?C0123?ZW_SLAVE
B1:008AC6 EE                MOV      A,R6
B1:008AC7 6D                XRL      A,R5
B1:008AC8 7002              JNZ      $ + 4H
B1:008ACA 61EF              AJMP     ?C0114?ZW_SLAVE
B1:008ACC         ?C0123?ZW_SLAVE:
B1:008ACC 90456B            MOV      DPTR,#t
B1:008ACF D192              ACALL    ?L?COM0537
B1:008AD1 4090              JC       ?C0121?ZW_SLAVE
B1:008AD3         ?C0122?ZW_SLAVE:
B1:008AD3 90456B            MOV      DPTR,#t
B1:008AD6 E0                MOVX     A,@DPTR
B1:008AD7 6404              XRL      A,#04H
B1:008AD9 7002              JNZ      $ + 4H
B1:008ADB 61EF              AJMP     ?C0114?ZW_SLAVE
B1:008ADD         ?C0132?ZW_SLAVE:
B1:008ADD         ?C0120?ZW_SLAVE:
B1:008ADD 90456C            MOV      DPTR,#q
B1:008AE0 D192              ACALL    ?L?COM0537
B1:008AE2 5002              JNC      $ + 4H
B1:008AE4 415E              AJMP     ?C0118?ZW_SLAVE
B1:008AE6         ?C0119?ZW_SLAVE:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 209


B1:008AE6 903329            MOV      DPTR,#tempi
B1:008AE9 9106              ACALL    ?L?COM009C
B1:008AEB AF01              MOV      R7,AR1
B1:008AED F17F              ACALL    ?L?COM044D
B1:008AEF 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008AF2 71F3              ACALL    ?L?COM010C
B1:008AF4 E0                MOVX     A,@DPTR
B1:008AF5 540F              ANL      A,#0FH
B1:008AF7 90339C            MOV      DPTR,#temp
B1:008AFA F0                MOVX     @DPTR,A
B1:008AFB E4                CLR      A
B1:008AFC 90456B            MOV      DPTR,#t
B1:008AFF F0                MOVX     @DPTR,A
B1:008B00         ?C0133?ZW_SLAVE:
B1:008B00 90456B            MOV      DPTR,#t
B1:008B03 E0                MOVX     A,@DPTR
B1:008B04 FF                MOV      R7,A
B1:008B05 C3                CLR      C
B1:008B06 9404              SUBB     A,#04H
B1:008B08 5016              JNC      ?C0134?ZW_SLAVE
B1:008B0A 314F              ACALL    ?L?COM0518
B1:008B0C 903329            MOV      DPTR,#tempi
B1:008B0F 71FE              ACALL    ?L?COM009B
B1:008B11 D183              ACALL    ?L?COM03C8
B1:008B13 B109              ACALL    ?L?COM0195
B1:008B15 EF                MOV      A,R7
B1:008B16 6008              JZ       ?C0134?ZW_SLAVE
B1:008B18         ?C0136?ZW_SLAVE:
B1:008B18         ?C0135?ZW_SLAVE:
B1:008B18 90456B            MOV      DPTR,#t
B1:008B1B E0                MOVX     A,@DPTR
B1:008B1C 04                INC      A
B1:008B1D F0                MOVX     @DPTR,A
B1:008B1E 80E0              SJMP     ?C0133?ZW_SLAVE
B1:008B20         ?C0134?ZW_SLAVE:
B1:008B20 90456B            MOV      DPTR,#t
B1:008B23 E0                MOVX     A,@DPTR
B1:008B24 C3                CLR      C
B1:008B25 9404              SUBB     A,#04H
B1:008B27 4003              JC       ?C0137?ZW_SLAVE
B1:008B29 7403              MOV      A,#03H
B1:008B2B F0                MOVX     @DPTR,A
B1:008B2C         ?C0137?ZW_SLAVE:
B1:008B2C 90456B            MOV      DPTR,#t
B1:008B2F E0                MOVX     A,@DPTR
B1:008B30 FF                MOV      R7,A
B1:008B31 314F              ACALL    ?L?COM0518
B1:008B33 90456B            MOV      DPTR,#t
B1:008B36 EF                MOV      A,R7
B1:008B37 F0                MOVX     @DPTR,A
B1:008B38 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008B3B 71F3              ACALL    ?L?COM010C
B1:008B3D E0                MOVX     A,@DPTR
B1:008B3E 540F              ANL      A,#0FH
B1:008B40 FF                MOV      R7,A
B1:008B41 90339C            MOV      DPTR,#temp
B1:008B44 F0                MOVX     @DPTR,A
B1:008B45 E4                CLR      A
B1:008B46 90456C            MOV      DPTR,#q
B1:008B49 F0                MOVX     @DPTR,A
B1:008B4A EF                MOV      A,R7
B1:008B4B 7012              JNZ      ?C0139?ZW_SLAVE
B1:008B4D 903329            MOV      DPTR,#tempi
B1:008B50 9106              ACALL    ?L?COM009C
B1:008B52 FA                MOV      R2,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 210


B1:008B53 90456B            MOV      DPTR,#t
B1:008B56 912D              ACALL    ?L?COM007C
B1:008B58 FE                MOV      R6,A
B1:008B59 AF01              MOV      R7,AR1
B1:008B5B 7DFE              MOV      R5,#0FEH
B1:008B5D 802B              SJMP     ?C0311?ZW_SLAVE
B1:008B5F         ?C0139?ZW_SLAVE:
B1:008B5F 90339C            MOV      DPTR,#temp
B1:008B62 E0                MOVX     A,@DPTR
B1:008B63 FF                MOV      R7,A
B1:008B64 90456C            MOV      DPTR,#q
B1:008B67 E0                MOVX     A,@DPTR
B1:008B68 C3                CLR      C
B1:008B69 9F                SUBB     A,R7
B1:008B6A 5029              JNC      ?C0140?ZW_SLAVE
B1:008B6C 903329            MOV      DPTR,#tempi
B1:008B6F 9106              ACALL    ?L?COM009C
B1:008B71 FA                MOV      R2,A
B1:008B72 90456B            MOV      DPTR,#t
B1:008B75 912D              ACALL    ?L?COM007C
B1:008B77 FA                MOV      R2,A
B1:008B78 A3                INC      DPTR
B1:008B79 E0                MOVX     A,@DPTR
B1:008B7A D1B2              ACALL    ?L?COM0130
B1:008B7C FE                MOV      R6,A
B1:008B7D AF01              MOV      R7,AR1
B1:008B7F E0                MOVX     A,@DPTR
B1:008B80 FD                MOV      R5,A
B1:008B81 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008B84 D150              ACALL    ?L?COM00D0
B1:008B86 D15F              ACALL    ?L?COM0191
B1:008B88 E0                MOVX     A,@DPTR
B1:008B89 FD                MOV      R5,A
B1:008B8A         
B1:008B8A 12444A            LCALL    _NVM_ext_write_byte
B1:008B8D 90456C            MOV      DPTR,#q
B1:008B90 E0                MOVX     A,@DPTR
B1:008B91 04                INC      A
B1:008B92 F0                MOVX     @DPTR,A
B1:008B93 80CA              SJMP     ?C0139?ZW_SLAVE
B1:008B95         ?C0140?ZW_SLAVE:
B1:008B95 90456C            MOV      DPTR,#q
B1:008B98 E0                MOVX     A,@DPTR
B1:008B99 C3                CLR      C
B1:008B9A 9404              SUBB     A,#04H
B1:008B9C 5012              JNC      ?C0142?ZW_SLAVE
B1:008B9E 903329            MOV      DPTR,#tempi
B1:008BA1 9106              ACALL    ?L?COM009C
B1:008BA3 FA                MOV      R2,A
B1:008BA4 90456B            MOV      DPTR,#t
B1:008BA7 912D              ACALL    ?L?COM007C
B1:008BA9 FA                MOV      R2,A
B1:008BAA A3                INC      DPTR
B1:008BAB E0                MOVX     A,@DPTR
B1:008BAC D1B2              ACALL    ?L?COM0130
B1:008BAE F1C9              ACALL    ?L?COM02A1
B1:008BB0         ?C0142?ZW_SLAVE:
B1:008BB0 903329            MOV      DPTR,#tempi
B1:008BB3 F190              ACALL    ?L?COM032B
B1:008BB5 1239EB            LCALL    ?L?COM007F
B1:008BB8 90339C            MOV      DPTR,#temp
B1:008BBB EF                MOV      A,R7
B1:008BBC F0                MOVX     @DPTR,A
B1:008BBD 90456A            MOV      DPTR,#bResponseRouteIndex
B1:008BC0 71F3              ACALL    ?L?COM010C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 211


B1:008BC2 E0                MOVX     A,@DPTR
B1:008BC3 54F0              ANL      A,#0F0H
B1:008BC5 C3                CLR      C
B1:008BC6 9402              SUBB     A,#02H
B1:008BC8 500F              JNC      ?C0143?ZW_SLAVE
B1:008BCA D1A2              ACALL    ?L?COM0517
B1:008BCC 126E41            LCALL    ?L?COM01FD
B1:008BCF 8002              SJMP     ?C0299?ZW_SLAVE
B1:008BD1         ?C0298?ZW_SLAVE:
B1:008BD1 C3                CLR      C
B1:008BD2 33                RLC      A
B1:008BD3         ?C0299?ZW_SLAVE:
B1:008BD3 D8FC              DJNZ     R0,?C0298?ZW_SLAVE
B1:008BD5 F4                CPL      A
B1:008BD6 5F                ANL      A,R7
B1:008BD7 800C              SJMP     ?C0312?ZW_SLAVE
B1:008BD9         ?C0143?ZW_SLAVE:
B1:008BD9 D1A2              ACALL    ?L?COM0517
B1:008BDB 126E41            LCALL    ?L?COM01FD
B1:008BDE 8002              SJMP     ?C0301?ZW_SLAVE
B1:008BE0         ?C0300?ZW_SLAVE:
B1:008BE0 C3                CLR      C
B1:008BE1 33                RLC      A
B1:008BE2         ?C0301?ZW_SLAVE:
B1:008BE2 D8FC              DJNZ     R0,?C0300?ZW_SLAVE
B1:008BE4 4F                ORL      A,R7
B1:008BE5         
B1:008BE5 90339C            MOV      DPTR,#temp
B1:008BE8 F0                MOVX     @DPTR,A
B1:008BE9         ?C0144?ZW_SLAVE:
B1:008BE9 903329            MOV      DPTR,#tempi
B1:008BEC 124434            LCALL    ?L?COM0178
B1:008BEF         ?C0114?ZW_SLAVE:
B1:008BEF 22                RET      
----- FUNCTION _UpdateResponseRouteLastReturnRoute (END) -------


----- FUNCTION ?L?COM010B (BEGIN) -----
B1:008BF0 904504            MOV      DPTR,#routetmp
B1:008BF3         ?L?COM010C:
B1:008BF3 E0                MOVX     A,@DPTR
B1:008BF4         ?L?COM010D:
B1:008BF4 243B              ADD      A,#LOW responseRouteSpeedNumHops
B1:008BF6         ?L?COM010E:
B1:008BF6 F582              MOV      DPL,A
B1:008BF8 E4                CLR      A
B1:008BF9 3412              ADDC     A,#HIGH responseRouteSpeedNumHops
B1:008BFB F583              MOV      DPH,A
B1:008BFD 22                RET      
----- FUNCTION ?L?COM010B (END) -------


----- FUNCTION ?L?COM009B (BEGIN) -----
B1:008BFE EF                MOV      A,R7
B1:008BFF 75F004            MOV      B,#04H
B1:008C02 A4                MUL      AB
B1:008C03 FD                MOV      R5,A
B1:008C04 ACF0              MOV      R4,B
B1:008C06         ?L?COM009C:
B1:008C06 E0                MOVX     A,@DPTR
B1:008C07         ?L?COM009D:
B1:008C07 75F011            MOV      B,#011H
B1:008C0A         ?L?COM009E:
B1:008C0A A4                MUL      AB
B1:008C0B 240C              ADD      A,#LOW NVM_RETURN_ROUTE_START_far+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 212


B1:008C0D F9                MOV      R1,A
B1:008C0E 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+01H
B1:008C10 35F0              ADDC     A,B
B1:008C12 22                RET      
----- FUNCTION ?L?COM009B (END) -------


----- FUNCTION ?L?COM007B (BEGIN) -----
B1:008C13 903327            MOV      DPTR,#tempwi
B1:008C16 E0                MOVX     A,@DPTR
B1:008C17 FE                MOV      R6,A
B1:008C18 A3                INC      DPTR
B1:008C19 E0                MOVX     A,@DPTR
B1:008C1A FF                MOV      R7,A
B1:008C1B 7C00              MOV      R4,#00H
B1:008C1D 7D11              MOV      R5,#011H
B1:008C1F 12206F            LCALL    ?C?IMUL
B1:008C22 741D              MOV      A,#LOW NVM_RETURN_ROUTE_START_far+012H
B1:008C24 2F                ADD      A,R7
B1:008C25 F9                MOV      R1,A
B1:008C26 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+012H
B1:008C28 3E                ADDC     A,R6
B1:008C29 FA                MOV      R2,A
B1:008C2A 9041A2            MOV      DPTR,#n
B1:008C2D         ?L?COM007C:
B1:008C2D E0                MOVX     A,@DPTR
B1:008C2E 75F004            MOV      B,#04H
B1:008C31 A4                MUL      AB
B1:008C32 29                ADD      A,R1
B1:008C33 F9                MOV      R1,A
B1:008C34 EA                MOV      A,R2
B1:008C35 35F0              ADDC     A,B
B1:008C37 22                RET      
----- FUNCTION ?L?COM007B (END) -------


----- FUNCTION _ReturnRouteFindNext (BEGIN) -----
B1:008C38 900AD6            MOV      DPTR,#bStartRouteNo
B1:008C3B EF                MOV      A,R7
B1:008C3C F0                MOVX     @DPTR,A
B1:008C3D         ?C0031?ZW_TRANSPORT:
B1:008C3D D19A              ACALL    ?L?COM0591
B1:008C3F 5057              JNC      ?C0032?ZW_TRANSPORT
B1:008C41 E565              MOV      A,destRouteIndex
B1:008C43 91FE              ACALL    ?L?COM0194
B1:008C45 8F5E              MOV      returnRoute,R7
B1:008C47 EF                MOV      A,R7
B1:008C48 6046              JZ       ?C0033?ZW_TRANSPORT
B1:008C4A 91F3              ACALL    ?L?COM0428
B1:008C4C 75F004            MOV      B,#04H
B1:008C4F A4                MUL      AB
B1:008C50 FD                MOV      R5,A
B1:008C51 ACF0              MOV      R4,B
B1:008C53 E565              MOV      A,destRouteIndex
B1:008C55 9107              ACALL    ?L?COM009D
B1:008C57 D183              ACALL    ?L?COM03C8
B1:008C59 FE                MOV      R6,A
B1:008C5A AF01              MOV      R7,AR1
B1:008C5C F1C2              ACALL    ?L?COM04CC
B1:008C5E 126F1B            LCALL    ?L?COM0388
B1:008C61 900AD6            MOV      DPTR,#bStartRouteNo
B1:008C64 E0                MOVX     A,@DPTR
B1:008C65 C4                SWAP     A
B1:008C66 54F0              ANL      A,#0F0H
B1:008C68 F55F              MOV      returnRoute+01H,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 213


B1:008C6A E560              MOV      A,returnRoute+02H
B1:008C6C 64FE              XRL      A,#0FEH
B1:008C6E 6028              JZ       ?C0032?ZW_TRANSPORT
;---- Variable 'index' assigned to Register 'R7' ----
B1:008C70 E4                CLR      A
B1:008C71 FF                MOV      R7,A
B1:008C72         ?C0035?ZW_TRANSPORT:
B1:008C72 7460              MOV      A,#LOW returnRoute+02H
B1:008C74 2F                ADD      A,R7
B1:008C75 F8                MOV      R0,A
B1:008C76 E6                MOV      A,@R0
B1:008C77 700E              JNZ      ?C0038?ZW_TRANSPORT
B1:008C79 900AD6            MOV      DPTR,#bStartRouteNo
B1:008C7C E0                MOVX     A,@DPTR
B1:008C7D 6019              JZ       ?C0032?ZW_TRANSPORT
B1:008C7F EF                MOV      A,R7
B1:008C80 7016              JNZ      ?C0032?ZW_TRANSPORT
B1:008C82 74FF              MOV      A,#0FFH
B1:008C84 F0                MOVX     @DPTR,A
B1:008C85 8011              SJMP     ?C0032?ZW_TRANSPORT
B1:008C87         ?C0038?ZW_TRANSPORT:
B1:008C87 055F              INC      returnRoute+01H
B1:008C89 0F                INC      R7
B1:008C8A EF                MOV      A,R7
B1:008C8B B404E4            CJNE     A,#04H,?C0035?ZW_TRANSPORT
B1:008C8E 8008              SJMP     ?C0032?ZW_TRANSPORT
B1:008C90         ?C0033?ZW_TRANSPORT:
B1:008C90 900AD6            MOV      DPTR,#bStartRouteNo
B1:008C93 7404              MOV      A,#04H
B1:008C95 F0                MOVX     @DPTR,A
B1:008C96 80A5              SJMP     ?C0031?ZW_TRANSPORT
B1:008C98         ?C0032?ZW_TRANSPORT:
B1:008C98 D19A              ACALL    ?L?COM0591
B1:008C9A 4005              JC       ?C0041?ZW_TRANSPORT
B1:008C9C 74FF              MOV      A,#0FFH
B1:008C9E F0                MOVX     @DPTR,A
B1:008C9F 804C              SJMP     ?C0042?ZW_TRANSPORT
B1:008CA1         ?C0041?ZW_TRANSPORT:
B1:008CA1 E565              MOV      A,destRouteIndex
B1:008CA3 F191              ACALL    ?L?COM032C
B1:008CA5 1239EB            LCALL    ?L?COM007F
B1:008CA8 900AD7            MOV      DPTR,#bSpeed
B1:008CAB EF                MOV      A,R7
B1:008CAC F0                MOVX     @DPTR,A
B1:008CAD 91F3              ACALL    ?L?COM0428
B1:008CAF 25E0              ADD      A,ACC
B1:008CB1 FF                MOV      R7,A
B1:008CB2 900AD7            MOV      DPTR,#bSpeed
B1:008CB5 E0                MOVX     A,@DPTR
B1:008CB6 FE                MOV      R6,A
B1:008CB7 A807              MOV      R0,AR7
B1:008CB9 08                INC      R0
B1:008CBA 8002              SJMP     ?C0572?ZW_TRANSPORT
B1:008CBC         ?C0571?ZW_TRANSPORT:
B1:008CBC C3                CLR      C
B1:008CBD 13                RRC      A
B1:008CBE         ?C0572?ZW_TRANSPORT:
B1:008CBE D8FC              DJNZ     R0,?C0571?ZW_TRANSPORT
B1:008CC0 5403              ANL      A,#03H
B1:008CC2 600C              JZ       ?C0045?ZW_TRANSPORT
B1:008CC4 24FE              ADD      A,#0FEH
B1:008CC6 600D              JZ       ?C0046?ZW_TRANSPORT
B1:008CC8 14                DEC      A
B1:008CC9 700F              JNZ      ?C0048?ZW_TRANSPORT
B1:008CCB         ?C0044?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 214


B1:008CCB 756418            MOV      returnRoute+06H,#018H
B1:008CCE 800D              SJMP     ?C0043?ZW_TRANSPORT
B1:008CD0         ?C0045?ZW_TRANSPORT:
B1:008CD0 756420            MOV      returnRoute+06H,#020H
B1:008CD3 8008              SJMP     ?C0043?ZW_TRANSPORT
B1:008CD5         ?C0046?ZW_TRANSPORT:
B1:008CD5 756410            MOV      returnRoute+06H,#010H
B1:008CD8 8003              SJMP     ?C0043?ZW_TRANSPORT
B1:008CDA         ?C0048?ZW_TRANSPORT:
B1:008CDA 756408            MOV      returnRoute+06H,#08H
B1:008CDD         ?C0043?ZW_TRANSPORT:
B1:008CDD E565              MOV      A,destRouteIndex
B1:008CDF 1239E2            LCALL    ?L?COM007E
B1:008CE2 EF                MOV      A,R7
B1:008CE3 5403              ANL      A,#03H
;---- Variable 'bBeam' assigned to Register 'R7' ----
B1:008CE5 6006              JZ       ?C0042?ZW_TRANSPORT
B1:008CE7 25E0              ADD      A,ACC
B1:008CE9 4410              ORL      A,#010H
B1:008CEB F564              MOV      returnRoute+06H,A
B1:008CED         ?C0042?ZW_TRANSPORT:
B1:008CED 900AD6            MOV      DPTR,#bStartRouteNo
B1:008CF0 E0                MOVX     A,@DPTR
B1:008CF1 FF                MOV      R7,A
B1:008CF2 22                RET      
----- FUNCTION _ReturnRouteFindNext (END) -------


----- FUNCTION ?L?COM0428 (BEGIN) -----
B1:008CF3 900AD6            MOV      DPTR,#bStartRouteNo
B1:008CF6 E0                MOVX     A,@DPTR
B1:008CF7 FF                MOV      R7,A
B1:008CF8 AD65              MOV      R5,destRouteIndex
B1:008CFA 3154              ACALL    _ZCB_ReturnRouteFindPriority
B1:008CFC EF                MOV      A,R7
B1:008CFD 22                RET      
----- FUNCTION ?L?COM0428 (END) -------


----- FUNCTION ?L?COM0194 (BEGIN) -----
B1:008CFE 75F011            MOV      B,#011H
B1:008D01 A4                MUL      AB
B1:008D02 240B              ADD      A,#LOW NVM_RETURN_ROUTE_START_far
B1:008D04 F9                MOV      R1,A
B1:008D05 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far
B1:008D07 35F0              ADDC     A,B
B1:008D09         ?L?COM0195:
B1:008D09 FE                MOV      R6,A
B1:008D0A AF01              MOV      R7,AR1
B1:008D0C 0239F2            LJMP     _NVM_ext_read_byte
----- FUNCTION ?L?COM0194 (END) -------


----- FUNCTION _ReturnRouteFindFirst (BEGIN) -----
B1:008D0F 900AE5            MOV      DPTR,#bDestNode
B1:008D12 EF                MOV      A,R7
B1:008D13 F177              ACALL    ?L?COM03EE
B1:008D15 9033A5            MOV      DPTR,#sucNodeID
B1:008D18 EF                MOV      A,R7
B1:008D19 F0                MOVX     @DPTR,A
B1:008D1A 7565FF            MOV      destRouteIndex,#0FFH
B1:008D1D 90076A            MOV      DPTR,#activeTransmit+01H
B1:008D20 74FF              MOV      A,#0FFH
B1:008D22 F0                MOVX     @DPTR,A
B1:008D23 900AE5            MOV      DPTR,#bDestNode
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 215


B1:008D26 E0                MOVX     A,@DPTR
B1:008D27 B50705            CJNE     A,AR7,?C0051?ZW_TRANSPORT
B1:008D2A E4                CLR      A
B1:008D2B F565              MOV      destRouteIndex,A
B1:008D2D 801C              SJMP     ?C0576?ZW_TRANSPORT
B1:008D2F         ?C0051?ZW_TRANSPORT:
B1:008D2F 900AE5            MOV      DPTR,#bDestNode
B1:008D32 E0                MOVX     A,@DPTR
B1:008D33 FD                MOV      R5,A
B1:008D34 E4                CLR      A
B1:008D35 FF                MOV      R7,A
B1:008D36 3154              ACALL    _ZCB_ReturnRouteFindPriority
B1:008D38 900AE5            MOV      DPTR,#bDestNode
B1:008D3B 71FE              ACALL    ?L?COM009B
B1:008D3D D183              ACALL    ?L?COM03C8
B1:008D3F B109              ACALL    ?L?COM0195
B1:008D41 EF                MOV      A,R7
B1:008D42 6009              JZ       ?C0052?ZW_TRANSPORT
B1:008D44 900AE5            MOV      DPTR,#bDestNode
B1:008D47 E0                MOVX     A,@DPTR
B1:008D48 F565              MOV      destRouteIndex,A
B1:008D4A E4                CLR      A
B1:008D4B         
B1:008D4B F187              ACALL    ?L?COM04CB
B1:008D4D         ?C0052?ZW_TRANSPORT:
B1:008D4D E565              MOV      A,destRouteIndex
B1:008D4F C3                CLR      C
B1:008D50 94FF              SUBB     A,#0FFH
B1:008D52 5002              JNC      ?C0054?ZW_TRANSPORT
B1:008D54 8001              SJMP     ?C0055?ZW_TRANSPORT
B1:008D56         ?C0054?ZW_TRANSPORT:
B1:008D56 C3                CLR      C
B1:008D57         ?C0055?ZW_TRANSPORT:
B1:008D57 22                RET      
----- FUNCTION _ReturnRouteFindFirst (END) -------


----- FUNCTION _ZW_IsNodeWithinDirectRange (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:008D58 EF                MOV      A,R7
B1:008D59 7002              JNZ      ?C0276?ZW_SLAVE
B1:008D5B C3                CLR      C
B1:008D5C 22                RET      
B1:008D5D         ?C0276?ZW_SLAVE:
B1:008D5D EF                MOV      A,R7
B1:008D5E 24FF              ADD      A,#0FFH
B1:008D60 FF                MOV      R7,A
B1:008D61 E4                CLR      A
B1:008D62 34FF              ADDC     A,#0FFH
B1:008D64 FE                MOV      R6,A
B1:008D65 F17F              ACALL    ?L?COM044D
B1:008D67 F1A3              ACALL    ?L?COM00EB
B1:008D69 D18A              ACALL    ?L?COM040D
B1:008D6B B109              ACALL    ?L?COM0195
B1:008D6D EF                MOV      A,R7
B1:008D6E 601C              JZ       ?C0278?ZW_SLAVE
B1:008D70 E4                CLR      A
B1:008D71 903329            MOV      DPTR,#tempi
B1:008D74 F0                MOVX     @DPTR,A
B1:008D75         ?C0279?ZW_SLAVE:
B1:008D75 F19B              ACALL    ?L?COM00EA
B1:008D77 D18A              ACALL    ?L?COM040D
B1:008D79 FA                MOV      R2,A
B1:008D7A A3                INC      DPTR
B1:008D7B 912D              ACALL    ?L?COM007C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 216


B1:008D7D B109              ACALL    ?L?COM0195
B1:008D7F BFFE02            CJNE     R7,#0FEH,?C0281?ZW_SLAVE
B1:008D82 D3                SETB     C
B1:008D83 22                RET      
B1:008D84         ?C0281?ZW_SLAVE:
B1:008D84 F1BB              ACALL    ?L?COM0379
B1:008D86 E0                MOVX     A,@DPTR
B1:008D87 C3                CLR      C
B1:008D88 9404              SUBB     A,#04H
B1:008D8A 40E9              JC       ?C0279?ZW_SLAVE
B1:008D8C         ?C0278?ZW_SLAVE:
B1:008D8C C3                CLR      C
B1:008D8D 22                RET      
----- FUNCTION _ZW_IsNodeWithinDirectRange (END) -------


----- FUNCTION _StoreRouteExplore (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R5' ----
B1:008D8E AD07              MOV      R5,AR7
;---- Variable 'routetmp' assigned to Register 'R1' ----
B1:008D90 79FF              MOV      R1,#0FFH
B1:008D92 301B02            JNB      bRouteCached,$ + 5H
B1:008D95 C14A              AJMP     ?C0050?ZW_ROUTING_ALL
B1:008D97 12D614            LCALL    _GetResponseRouteIndex
B1:008D9A A907              MOV      R1,AR7
B1:008D9C EF                MOV      A,R7
B1:008D9D F4                CPL      A
B1:008D9E 7027              JNZ      ?C0051?ZW_ROUTING_ALL
B1:008DA0 F1E1              ACALL    ?L?COM0587
B1:008DA2 501A              JNC      ?C0052?ZW_ROUTING_ALL
B1:008DA4 E0                MOVX     A,@DPTR
B1:008DA5 04                INC      A
B1:008DA6 F0                MOVX     @DPTR,A
B1:008DA7 E4                CLR      A
B1:008DA8 F9                MOV      R1,A
B1:008DA9         ?C0053?ZW_ROUTING_ALL:
B1:008DA9 741E              MOV      A,#LOW responseRouteNodeID
B1:008DAB 29                ADD      A,R1
B1:008DAC D16D              ACALL    ?L?COM026B
B1:008DAE E0                MOVX     A,@DPTR
B1:008DAF 6005              JZ       ?C0054?ZW_ROUTING_ALL
B1:008DB1         ?C0056?ZW_ROUTING_ALL:
B1:008DB1         ?C0055?ZW_ROUTING_ALL:
B1:008DB1 09                INC      R1
B1:008DB2 E9                MOV      A,R1
B1:008DB3 B402F3            CJNE     A,#02H,?C0053?ZW_ROUTING_ALL
B1:008DB6         ?C0054?ZW_ROUTING_ALL:
B1:008DB6 E9                MOV      A,R1
B1:008DB7 B4020D            CJNE     A,#02H,?C0051?ZW_ROUTING_ALL
B1:008DBA 7901              MOV      R1,#01H
B1:008DBC 8009              SJMP     ?C0051?ZW_ROUTING_ALL
B1:008DBE         ?C0052?ZW_ROUTING_ALL:
B1:008DBE 201C04            JB       routesLocked,?C0059?ZW_ROUTING_ALL
B1:008DC1 E4                CLR      A
B1:008DC2 F9                MOV      R1,A
B1:008DC3 8002              SJMP     ?C0051?ZW_ROUTING_ALL
B1:008DC5         ?C0059?ZW_ROUTING_ALL:
B1:008DC5 7901              MOV      R1,#01H
B1:008DC7         ?C0051?ZW_ROUTING_ALL:
B1:008DC7 741E              MOV      A,#LOW responseRouteNodeID
B1:008DC9 29                ADD      A,R1
B1:008DCA D16D              ACALL    ?L?COM026B
B1:008DCC ED                MOV      A,R5
B1:008DCD F0                MOVX     @DPTR,A
B1:008DCE 741C              MOV      A,#LOW responseRouteRFOption
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 217


B1:008DD0 29                ADD      A,R1
B1:008DD1 D17B              ACALL    ?L?COM020F
B1:008DD3 E4                CLR      A
B1:008DD4 F0                MOVX     @DPTR,A
B1:008DD5 9045D4            MOV      DPTR,#pRoute
B1:008DD8 F1E9              ACALL    ?L?COM0209
B1:008DDA E0                MOVX     A,@DPTR
B1:008DDB 540F              ANL      A,#0FH
B1:008DDD FE                MOV      R6,A
;---- Variable 'routeLen' assigned to Register 'R6' ----
B1:008DDE 743B              MOV      A,#LOW responseRouteSpeedNumHops
B1:008DE0 29                ADD      A,R1
B1:008DE1 71F6              ACALL    ?L?COM010E
B1:008DE3 EE                MOV      A,R6
B1:008DE4 F0                MOVX     @DPTR,A
B1:008DE5 743B              MOV      A,#LOW responseRouteSpeedNumHops
B1:008DE7 29                ADD      A,R1
B1:008DE8 71F6              ACALL    ?L?COM010E
B1:008DEA C083              PUSH     DPH
B1:008DEC C082              PUSH     DPL
B1:008DEE E0                MOVX     A,@DPTR
B1:008DEF FD                MOV      R5,A
B1:008DF0 F1D9              ACALL    ?L?COM0586
B1:008DF2 FC                MOV      R4,A
B1:008DF3 ED                MOV      A,R5
B1:008DF4 4C                ORL      A,R4
B1:008DF5 D082              POP      DPL
B1:008DF7 D083              POP      DPH
B1:008DF9 F0                MOVX     @DPTR,A
B1:008DFA EE                MOV      A,R6
B1:008DFB 602D              JZ       ?C0061?ZW_ROUTING_ALL
;---- Variable 'i' assigned to Register 'R5' ----
B1:008DFD E4                CLR      A
B1:008DFE FD                MOV      R5,A
B1:008DFF         ?C0062?ZW_ROUTING_ALL:
B1:008DFF AC06              MOV      R4,AR6
B1:008E01 1E                DEC      R6
B1:008E02 EC                MOV      A,R4
B1:008E03 602B              JZ       ?C0066?ZW_ROUTING_ALL
B1:008E05 9045D4            MOV      DPTR,#pRoute
B1:008E08 E4                CLR      A
B1:008E09 75F001            MOV      B,#01H
B1:008E0C 30390D            JNB      bRouteNoneInverted,?C0064?ZW_ROUTING_ALL
B1:008E0F F1AA              ACALL    ?L?COM033A
B1:008E11 AB05              MOV      R3,AR5
B1:008E13 0D                INC      R5
B1:008E14 E9                MOV      A,R1
B1:008E15 D151              ACALL    ?L?COM00D1
B1:008E17 E582              MOV      A,DPL
B1:008E19 2B                ADD      A,R3
B1:008E1A 8008              SJMP     ?C0095?ZW_ROUTING_ALL
B1:008E1C         ?C0064?ZW_ROUTING_ALL:
B1:008E1C F1AA              ACALL    ?L?COM033A
B1:008E1E E9                MOV      A,R1
B1:008E1F D151              ACALL    ?L?COM00D1
B1:008E21 E582              MOV      A,DPL
B1:008E23 2E                ADD      A,R6
B1:008E24         
B1:008E24 D162              ACALL    ?L?COM0192
B1:008E26 EC                MOV      A,R4
B1:008E27 F0                MOVX     @DPTR,A
B1:008E28 80D5              SJMP     ?C0062?ZW_ROUTING_ALL
B1:008E2A         ?C0061?ZW_ROUTING_ALL:
B1:008E2A E9                MOV      A,R1
B1:008E2B D151              ACALL    ?L?COM00D1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 218


B1:008E2D 74FE              MOV      A,#0FEH
B1:008E2F F0                MOVX     @DPTR,A
B1:008E30         ?C0066?ZW_ROUTING_ALL:
B1:008E30 901220            MOV      DPTR,#responseRouteSpeedModified
B1:008E33 E0                MOVX     A,@DPTR
B1:008E34 FE                MOV      R6,A
B1:008E35 AF01              MOV      R7,AR1
B1:008E37 7401              MOV      A,#01H
B1:008E39 A807              MOV      R0,AR7
B1:008E3B 08                INC      R0
B1:008E3C 8002              SJMP     ?C0089?ZW_ROUTING_ALL
B1:008E3E         ?C0088?ZW_ROUTING_ALL:
B1:008E3E C3                CLR      C
B1:008E3F 33                RLC      A
B1:008E40         ?C0089?ZW_ROUTING_ALL:
B1:008E40 D8FC              DJNZ     R0,?C0088?ZW_ROUTING_ALL
B1:008E42 F4                CPL      A
B1:008E43 5E                ANL      A,R6
B1:008E44 901220            MOV      DPTR,#responseRouteSpeedModified
B1:008E47 F0                MOVX     @DPTR,A
B1:008E48 D21B              SETB     bRouteCached
B1:008E4A         ?C0050?ZW_ROUTING_ALL:
B1:008E4A AF01              MOV      R7,AR1
B1:008E4C 22                RET      
----- FUNCTION _StoreRouteExplore (END) -------


----- FUNCTION ?L?COM00CF (BEGIN) -----
B1:008E4D 904504            MOV      DPTR,#routetmp
B1:008E50         ?L?COM00D0:
B1:008E50 E0                MOVX     A,@DPTR
B1:008E51         ?L?COM00D1:
B1:008E51 25E0              ADD      A,ACC
B1:008E53 25E0              ADD      A,ACC
B1:008E55 2441              ADD      A,#LOW responseRouteRepeaterList
B1:008E57         ?L?COM00D2:
B1:008E57 F582              MOV      DPL,A
B1:008E59 E4                CLR      A
B1:008E5A 3412              ADDC     A,#HIGH responseRouteRepeaterList
B1:008E5C F583              MOV      DPH,A
B1:008E5E 22                RET      
----- FUNCTION ?L?COM00CF (END) -------


----- FUNCTION ?L?COM0191 (BEGIN) -----
B1:008E5F E582              MOV      A,DPL
B1:008E61 2D                ADD      A,R5
B1:008E62         ?L?COM0192:
B1:008E62 F582              MOV      DPL,A
B1:008E64 E4                CLR      A
B1:008E65 3583              ADDC     A,DPH
B1:008E67 F583              MOV      DPH,A
B1:008E69 22                RET      
----- FUNCTION ?L?COM0191 (END) -------


----- FUNCTION ?L?COM026A (BEGIN) -----
B1:008E6A E0                MOVX     A,@DPTR
B1:008E6B 241E              ADD      A,#LOW responseRouteNodeID
B1:008E6D         ?L?COM026B:
B1:008E6D F582              MOV      DPL,A
B1:008E6F E4                CLR      A
B1:008E70 3412              ADDC     A,#HIGH responseRouteNodeID
B1:008E72 F583              MOV      DPH,A
B1:008E74 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 219


----- FUNCTION ?L?COM026A (END) -------


----- FUNCTION ?L?COM020D (BEGIN) -----
B1:008E75 904504            MOV      DPTR,#routetmp
B1:008E78 E0                MOVX     A,@DPTR
B1:008E79         ?L?COM020E:
B1:008E79 241C              ADD      A,#LOW responseRouteRFOption
B1:008E7B         ?L?COM020F:
B1:008E7B F582              MOV      DPL,A
B1:008E7D E4                CLR      A
B1:008E7E 3412              ADDC     A,#HIGH responseRouteRFOption
B1:008E80 F583              MOV      DPH,A
B1:008E82 22                RET      
----- FUNCTION ?L?COM020D (END) -------


----- FUNCTION ?L?COM03C8 (BEGIN) -----
B1:008E83 FA                MOV      R2,A
B1:008E84 E9                MOV      A,R1
B1:008E85 2D                ADD      A,R5
B1:008E86 F9                MOV      R1,A
B1:008E87 EA                MOV      A,R2
B1:008E88 3C                ADDC     A,R4
B1:008E89 22                RET      
----- FUNCTION ?L?COM03C8 (END) -------


----- FUNCTION ?L?COM040D (BEGIN) -----
B1:008E8A 741D              MOV      A,#LOW NVM_RETURN_ROUTE_START_far+012H
B1:008E8C 2F                ADD      A,R7
B1:008E8D F9                MOV      R1,A
B1:008E8E 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+012H
B1:008E90 3E                ADDC     A,R6
B1:008E91 22                RET      
----- FUNCTION ?L?COM040D (END) -------


----- FUNCTION ?L?COM0537 (BEGIN) -----
B1:008E92 E0                MOVX     A,@DPTR
B1:008E93 04                INC      A
B1:008E94 F0                MOVX     @DPTR,A
B1:008E95 E0                MOVX     A,@DPTR
B1:008E96 C3                CLR      C
B1:008E97 9404              SUBB     A,#04H
B1:008E99 22                RET      
----- FUNCTION ?L?COM0537 (END) -------


----- FUNCTION ?L?COM0591 (BEGIN) -----
B1:008E9A 900AD6            MOV      DPTR,#bStartRouteNo
B1:008E9D E0                MOVX     A,@DPTR
B1:008E9E C3                CLR      C
B1:008E9F 9404              SUBB     A,#04H
B1:008EA1 22                RET      
----- FUNCTION ?L?COM0591 (END) -------


----- FUNCTION ?L?COM0517 (BEGIN) -----
B1:008EA2 90339C            MOV      DPTR,#temp
B1:008EA5 E0                MOVX     A,@DPTR
B1:008EA6 FF                MOV      R7,A
B1:008EA7 90456B            MOV      DPTR,#t
B1:008EAA 22                RET      
----- FUNCTION ?L?COM0517 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 220




----- FUNCTION ?L?COM012F (BEGIN) -----
B1:008EAB 240B              ADD      A,#0BH
B1:008EAD F9                MOV      R1,A
B1:008EAE E4                CLR      A
B1:008EAF 3A                ADDC     A,R2
B1:008EB0 FA                MOV      R2,A
B1:008EB1 ED                MOV      A,R5
B1:008EB2         ?L?COM0130:
B1:008EB2 7E00              MOV      R6,#00H
B1:008EB4 29                ADD      A,R1
B1:008EB5 F9                MOV      R1,A
B1:008EB6 EE                MOV      A,R6
B1:008EB7 3A                ADDC     A,R2
B1:008EB8 22                RET      
----- FUNCTION ?L?COM012F (END) -------


----- FUNCTION _HandleSUCReturnRoute (BEGIN) -----
B1:008EB9 904508            MOV      DPTR,#cmdLength
B1:008EBC ED                MOV      A,R5
B1:008EBD F0                MOVX     @DPTR,A
B1:008EBE 904505            MOV      DPTR,#pCmd
B1:008EC1 122572            LCALL    ?C?PSTXDATA
B1:008EC4 1285F2            LCALL    ?L?COM0003
B1:008EC7 FF                MOV      R7,A
B1:008EC8 C4                SWAP     A
B1:008EC9 5407              ANL      A,#07H
B1:008ECB FE                MOV      R6,A
B1:008ECC 904509            MOV      DPTR,#n
B1:008ECF F0                MOVX     @DPTR,A
B1:008ED0 EF                MOV      A,R7
B1:008ED1 5407              ANL      A,#07H
B1:008ED3 90339C            MOV      DPTR,#temp
B1:008ED6 F0                MOVX     @DPTR,A
B1:008ED7 EE                MOV      A,R6
B1:008ED8 7019              JNZ      ?C0158?ZW_SLAVE
B1:008EDA 7FE8              MOV      R7,#0E8H
B1:008EDC 11AE              ACALL    _ReturnRouteClearPriority
B1:008EDE 904505            MOV      DPTR,#pCmd
B1:008EE1 129557            LCALL    ?L?COM003C
B1:008EE4 1285F5            LCALL    ?L?COM0004
B1:008EE7 9033A5            MOV      DPTR,#sucNodeID
B1:008EEA F0                MOVX     @DPTR,A
B1:008EEB FD                MOV      R5,A
B1:008EEC 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far
B1:008EEE 7F0B              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far
B1:008EF0 12444A            LCALL    _NVM_ext_write_byte
B1:008EF3         ?C0158?ZW_SLAVE:
B1:008EF3 904509            MOV      DPTR,#n
B1:008EF6 E0                MOVX     A,@DPTR
B1:008EF7 FF                MOV      R7,A
B1:008EF8 C3                CLR      C
B1:008EF9 9404              SUBB     A,#04H
B1:008EFB 5079              JNC      ?C0166?ZW_SLAVE
B1:008EFD 90339C            MOV      DPTR,#temp
B1:008F00 E0                MOVX     A,@DPTR
B1:008F01 6020              JZ       ?C0160?ZW_SLAVE
B1:008F03 EF                MOV      A,R7
B1:008F04 75F004            MOV      B,#04H
B1:008F07 910A              ACALL    ?L?COM009E
B1:008F09 FE                MOV      R6,A
B1:008F0A AF01              MOV      R7,AR1
B1:008F0C 904505            MOV      DPTR,#pCmd
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 221


B1:008F0F 129549            LCALL    ?L?COM0058
B1:008F12 F9                MOV      R1,A
B1:008F13 E4                CLR      A
B1:008F14 3A                ADDC     A,R2
B1:008F15 FA                MOV      R2,A
B1:008F16 90339C            MOV      DPTR,#temp
B1:008F19 E0                MOVX     A,@DPTR
B1:008F1A FD                MOV      R5,A
B1:008F1B 12ADB3            LCALL    ?L?COM0175
B1:008F1E ED                MOV      A,R5
B1:008F1F F0                MOVX     @DPTR,A
B1:008F20 1239FB            LCALL    _NVM_ext_write_buffer
B1:008F23         ?C0160?ZW_SLAVE:
B1:008F23 90339C            MOV      DPTR,#temp
B1:008F26 E0                MOVX     A,@DPTR
B1:008F27 700E              JNZ      ?C0161?ZW_SLAVE
B1:008F29 904509            MOV      DPTR,#n
B1:008F2C E0                MOVX     A,@DPTR
B1:008F2D 7008              JNZ      ?C0161?ZW_SLAVE
B1:008F2F 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far+01H
B1:008F31 7F0C              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far+01H
B1:008F33 7DFE              MOV      R5,#0FEH
B1:008F35 801E              SJMP     ?C0316?ZW_SLAVE
B1:008F37         ?C0161?ZW_SLAVE:
B1:008F37 90339C            MOV      DPTR,#temp
B1:008F3A E0                MOVX     A,@DPTR
B1:008F3B C3                CLR      C
B1:008F3C 9404              SUBB     A,#04H
B1:008F3E 5018              JNC      ?C0162?ZW_SLAVE
B1:008F40 904509            MOV      DPTR,#n
B1:008F43 E0                MOVX     A,@DPTR
B1:008F44 75F004            MOV      B,#04H
B1:008F47 910A              ACALL    ?L?COM009E
B1:008F49 FA                MOV      R2,A
B1:008F4A 90339C            MOV      DPTR,#temp
B1:008F4D E0                MOVX     A,@DPTR
B1:008F4E D1B2              ACALL    ?L?COM0130
B1:008F50 FE                MOV      R6,A
B1:008F51 AF01              MOV      R7,AR1
B1:008F53 E4                CLR      A
B1:008F54 FD                MOV      R5,A
B1:008F55         
B1:008F55 12444A            LCALL    _NVM_ext_write_byte
B1:008F58         ?C0162?ZW_SLAVE:
B1:008F58 9033A5            MOV      DPTR,#sucNodeID
B1:008F5B E0                MOVX     A,@DPTR
B1:008F5C 6013              JZ       ?C0165?ZW_SLAVE
B1:008F5E 904505            MOV      DPTR,#pCmd
B1:008F61 122552            LCALL    ?C?PLDXDATA
B1:008F64 904508            MOV      DPTR,#cmdLength
B1:008F67 E0                MOVX     A,@DPTR
B1:008F68 904400            MOV      DPTR,#?_StoreReturnRouteSpeed?BYTE+04H
B1:008F6B F0                MOVX     @DPTR,A
B1:008F6C E4                CLR      A
B1:008F6D FD                MOV      R5,A
B1:008F6E 12E8F6            LCALL    _StoreReturnRouteSpeed
B1:008F71         ?C0165?ZW_SLAVE:
B1:008F71 7F03              MOV      R7,#03H
B1:008F73 12EF1F            LCALL    _AssignTimerStart
B1:008F76         ?C0166?ZW_SLAVE:
B1:008F76 22                RET      
----- FUNCTION _HandleSUCReturnRoute (END) -------


----- FUNCTION ?L?COM03EE (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 222


B1:008F77 F0                MOVX     @DPTR,A
B1:008F78         ?L?COM03EF:
B1:008F78 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far
B1:008F7A 7F0B              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far
B1:008F7C 0239F2            LJMP     _NVM_ext_read_byte
----- FUNCTION ?L?COM03EE (END) -------


----- FUNCTION ?L?COM044D (BEGIN) -----
B1:008F7F 903327            MOV      DPTR,#tempwi
B1:008F82 F0                MOVX     @DPTR,A
B1:008F83 A3                INC      DPTR
B1:008F84 EF                MOV      A,R7
B1:008F85 F0                MOVX     @DPTR,A
B1:008F86 22                RET      
----- FUNCTION ?L?COM044D (END) -------


----- FUNCTION ?L?COM04CB (BEGIN) -----
B1:008F87 FF                MOV      R7,A
B1:008F88 9138              ACALL    _ReturnRouteFindNext
B1:008F8A 90076A            MOV      DPTR,#activeTransmit+01H
B1:008F8D EF                MOV      A,R7
B1:008F8E F0                MOVX     @DPTR,A
B1:008F8F 22                RET      
----- FUNCTION ?L?COM04CB (END) -------


----- FUNCTION ?L?COM032B (BEGIN) -----
B1:008F90 E0                MOVX     A,@DPTR
B1:008F91         ?L?COM032C:
B1:008F91 75F002            MOV      B,#02H
B1:008F94 A4                MUL      AB
B1:008F95 2484              ADD      A,#LOW NVM_RETURN_ROUTE_SPEED_START_far
B1:008F97 F9                MOV      R1,A
B1:008F98 740F              MOV      A,#HIGH NVM_RETURN_ROUTE_SPEED_START_far
B1:008F9A 22                RET      
----- FUNCTION ?L?COM032B (END) -------


----- FUNCTION ?L?COM00EA (BEGIN) -----
B1:008F9B 903327            MOV      DPTR,#tempwi
B1:008F9E E0                MOVX     A,@DPTR
B1:008F9F FE                MOV      R6,A
B1:008FA0 A3                INC      DPTR
B1:008FA1 E0                MOVX     A,@DPTR
B1:008FA2 FF                MOV      R7,A
B1:008FA3         ?L?COM00EB:
B1:008FA3 7C00              MOV      R4,#00H
B1:008FA5 7D11              MOV      R5,#011H
B1:008FA7 02206F            LJMP     ?C?IMUL
----- FUNCTION ?L?COM00EA (END) -------


----- FUNCTION ?L?COM033A (BEGIN) -----
B1:008FAA 12210C            LCALL    ?C?IILDX
B1:008FAD 9045D4            MOV      DPTR,#pRoute
B1:008FB0 E0                MOVX     A,@DPTR
B1:008FB1 FA                MOV      R2,A
B1:008FB2 A3                INC      DPTR
B1:008FB3 E0                MOVX     A,@DPTR
B1:008FB4 F582              MOV      DPL,A
B1:008FB6 8A83              MOV      DPH,R2
B1:008FB8 E0                MOVX     A,@DPTR
B1:008FB9 FC                MOV      R4,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 223


B1:008FBA 22                RET      
----- FUNCTION ?L?COM033A (END) -------


----- FUNCTION ?L?COM0379 (BEGIN) -----
B1:008FBB 903329            MOV      DPTR,#tempi
B1:008FBE E0                MOVX     A,@DPTR
B1:008FBF 04                INC      A
B1:008FC0 F0                MOVX     @DPTR,A
B1:008FC1 22                RET      
----- FUNCTION ?L?COM0379 (END) -------


----- FUNCTION ?L?COM04CC (BEGIN) -----
B1:008FC2 7B00              MOV      R3,#00H
B1:008FC4 7A00              MOV      R2,#HIGH returnRoute+02H
B1:008FC6 7960              MOV      R1,#LOW returnRoute+02H
B1:008FC8 22                RET      
----- FUNCTION ?L?COM04CC (END) -------


----- FUNCTION ?L?COM02A1 (BEGIN) -----
B1:008FC9 FE                MOV      R6,A
B1:008FCA AF01              MOV      R7,AR1
B1:008FCC E4                CLR      A
B1:008FCD FD                MOV      R5,A
B1:008FCE 02444A            LJMP     _NVM_ext_write_byte
----- FUNCTION ?L?COM02A1 (END) -------


----- FUNCTION ?L?COM04E6 (BEGIN) -----
B1:008FD1 FE                MOV      R6,A
B1:008FD2 AF01              MOV      R7,AR1
B1:008FD4 E0                MOVX     A,@DPTR
B1:008FD5 FD                MOV      R5,A
B1:008FD6 02444A            LJMP     _NVM_ext_write_byte
----- FUNCTION ?L?COM04E6 (END) -------


----- FUNCTION ?L?COM0586 (BEGIN) -----
B1:008FD9 900666            MOV      DPTR,#bRxCurrentSpeed
B1:008FDC E0                MOVX     A,@DPTR
B1:008FDD C4                SWAP     A
B1:008FDE 54F0              ANL      A,#0F0H
B1:008FE0 22                RET      
----- FUNCTION ?L?COM0586 (END) -------


----- FUNCTION ?L?COM0587 (BEGIN) -----
B1:008FE1 901216            MOV      DPTR,#responseRouteCount
B1:008FE4 E0                MOVX     A,@DPTR
B1:008FE5 C3                CLR      C
B1:008FE6 9402              SUBB     A,#02H
B1:008FE8 22                RET      
----- FUNCTION ?L?COM0587 (END) -------


----- FUNCTION ?L?COM0209 (BEGIN) -----
B1:008FE9 E0                MOVX     A,@DPTR
B1:008FEA FC                MOV      R4,A
B1:008FEB         ?L?COM020A:
B1:008FEB A3                INC      DPTR
B1:008FEC E0                MOVX     A,@DPTR
B1:008FED F582              MOV      DPL,A
B1:008FEF 8C83              MOV      DPH,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 224


B1:008FF1 22                RET      
----- FUNCTION ?L?COM0209 (END) -------


----- FUNCTION TxRandom (BEGIN) -----
B1:008FF2 12418F            LCALL    ZW_Random
;---- Variable 'delay' assigned to Register 'R7' ----
B1:008FF5 EF                MOV      A,R7
B1:008FF6 C4                SWAP     A
B1:008FF7 540F              ANL      A,#0FH
B1:008FF9 6F                XRL      A,R7
B1:008FFA FE                MOV      R6,A
B1:008FFB EF                MOV      A,R7
B1:008FFC C4                SWAP     A
B1:008FFD 13                RRC      A
B1:008FFE 5407              ANL      A,#07H
B1:009000 6E                XRL      A,R6
B1:009001 FE                MOV      R6,A
B1:009002 EF                MOV      A,R7
B1:009003 C4                SWAP     A
B1:009004 13                RRC      A
B1:009005 13                RRC      A
B1:009006 13                RRC      A
B1:009007 5401              ANL      A,#01H
B1:009009 6E                XRL      A,R6
B1:00900A 5403              ANL      A,#03H
B1:00900C FF                MOV      R7,A
B1:00900D 22                RET      
----- FUNCTION TxRandom (END) -------


----- FUNCTION _SetTransmitSpeedOptions (BEGIN) -----
;---- Variable 'pFrame' assigned to Register 'R1/R2/R3' ----
;---- Variable 'speedOptions' assigned to Register 'R6/R7' ----
B1:00900E 125D38            LCALL    ?L?COM00E5
B1:009011 EE                MOV      A,R6
B1:009012 8FF0              MOV      B,R7
B1:009014 0221E8            LJMP     ?C?ISTPTR
----- FUNCTION _SetTransmitSpeedOptions (END) -------


----- FUNCTION _GetResponseRoute (BEGIN) -----
B1:009017 90447A            MOV      DPTR,#pFrame
B1:00901A 122572            LCALL    ?C?PSTXDATA
B1:00901D 904479            MOV      DPTR,#bNodeID
B1:009020 EF                MOV      A,R7
B1:009021 F0                MOVX     @DPTR,A
B1:009022 90447D            MOV      DPTR,#rtmp
B1:009025 7402              MOV      A,#02H
B1:009027 F0                MOVX     @DPTR,A
B1:009028 EF                MOV      A,R7
B1:009029 7002              JNZ      $ + 4H
B1:00902B 2127              AJMP     ?C0014?ZW_ROUTING_ALL
B1:00902D 901216            MOV      DPTR,#responseRouteCount
B1:009030 E0                MOVX     A,@DPTR
B1:009031 7002              JNZ      $ + 4H
B1:009033 2127              AJMP     ?C0014?ZW_ROUTING_ALL
B1:009035         ?C0017?ZW_ROUTING_ALL:
B1:009035 90447D            MOV      DPTR,#rtmp
B1:009038 E0                MOVX     A,@DPTR
B1:009039 FF                MOV      R7,A
B1:00903A 241D              ADD      A,#LOW responseRouteNodeID-01H
B1:00903C 12D776            LCALL    ?L?COM0424
B1:00903F E0                MOVX     A,@DPTR
B1:009040 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 225


B1:009041 904479            MOV      DPTR,#bNodeID
B1:009044 E0                MOVX     A,@DPTR
B1:009045 6E                XRL      A,R6
B1:009046 6002              JZ       $ + 4H
B1:009048 211D              AJMP     ?C0015?ZW_ROUTING_ALL
B1:00904A 12FE59            LCALL    ?L?COM033B
B1:00904D FE                MOV      R6,A
B1:00904E 540F              ANL      A,#0FH
B1:009050 90447E            MOV      DPTR,#repeaterCount
B1:009053 F0                MOVX     @DPTR,A
B1:009054 90447A            MOV      DPTR,#pFrame
B1:009057 1252EE            LCALL    ?L?COM001E
B1:00905A 54F8              ANL      A,#0F8H
B1:00905C FD                MOV      R5,A
B1:00905D EE                MOV      A,R6
B1:00905E C4                SWAP     A
B1:00905F 540F              ANL      A,#0FH
B1:009061 FF                MOV      R7,A
B1:009062 E5F0              MOV      A,B
B1:009064 FE                MOV      R6,A
B1:009065 ED                MOV      A,R5
B1:009066 4F                ORL      A,R7
B1:009067 FF                MOV      R7,A
B1:009068 12C951            LCALL    ?L?COM00B9
B1:00906B 71CF              ACALL    ?L?COM038E
B1:00906D 129F89            LCALL    _GetTransmitSpeedOptions
B1:009070 EF                MOV      A,R7
B1:009071 549F              ANL      A,#09FH
B1:009073 FF                MOV      R7,A
B1:009074 90447D            MOV      DPTR,#rtmp
B1:009077 E0                MOVX     A,@DPTR
B1:009078 241B              ADD      A,#LOW responseRouteRFOption-01H
B1:00907A F582              MOV      DPL,A
B1:00907C E4                CLR      A
B1:00907D 3412              ADDC     A,#HIGH responseRouteRFOption-01H
B1:00907F F583              MOV      DPH,A
B1:009081 E0                MOVX     A,@DPTR
B1:009082 5460              ANL      A,#060H
B1:009084 FD                MOV      R5,A
B1:009085 EF                MOV      A,R7
B1:009086 4D                ORL      A,R5
B1:009087 71CE              ACALL    ?L?COM038D
B1:009089 110E              ACALL    _SetTransmitSpeedOptions
B1:00908B 71CF              ACALL    ?L?COM038E
B1:00908D 1287DE            LCALL    ?L?COM02B7
B1:009090 C003              PUSH     AR3
B1:009092 C002              PUSH     AR2
B1:009094 C001              PUSH     AR1
B1:009096 90447D            MOV      DPTR,#rtmp
B1:009099 E0                MOVX     A,@DPTR
B1:00909A 75F004            MOV      B,#04H
B1:00909D A4                MUL      AB
B1:00909E 243D              ADD      A,#LOW responseRouteRepeaterList-04H
B1:0090A0 F9                MOV      R1,A
B1:0090A1 7412              MOV      A,#HIGH responseRouteRepeaterList-04H
B1:0090A3 35F0              ADDC     A,B
B1:0090A5 FA                MOV      R2,A
B1:0090A6 7B01              MOV      R3,#01H
B1:0090A8 1287B9            LCALL    ?L?COM003F
B1:0090AB 90447E            MOV      DPTR,#repeaterCount
B1:0090AE E0                MOVX     A,@DPTR
B1:0090AF FF                MOV      R7,A
B1:0090B0 D001              POP      AR1
B1:0090B2 D002              POP      AR2
B1:0090B4 D003              POP      AR3
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 226


B1:0090B6 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:0090B9 90447E            MOV      DPTR,#repeaterCount
B1:0090BC E0                MOVX     A,@DPTR
B1:0090BD C4                SWAP     A
B1:0090BE 54F0              ANL      A,#0F0H
B1:0090C0 71CE              ACALL    ?L?COM038D
B1:0090C2 E9                MOV      A,R1
B1:0090C3 24BC              ADD      A,#0BCH
B1:0090C5 1287AB            LCALL    ?L?COM0015
B1:0090C8 90447D            MOV      DPTR,#rtmp
B1:0090CB E0                MOVX     A,@DPTR
B1:0090CC 14                DEC      A
B1:0090CD 126D9E            LCALL    ?L?COM016A
B1:0090D0 8005              SJMP     ?C0081?ZW_ROUTING_ALL
B1:0090D2         ?C0080?ZW_ROUTING_ALL:
B1:0090D2 C3                CLR      C
B1:0090D3 33                RLC      A
B1:0090D4 CE                XCH      A,R6
B1:0090D5 33                RLC      A
B1:0090D6 CE                XCH      A,R6
B1:0090D7         ?C0081?ZW_ROUTING_ALL:
B1:0090D7 D8F9              DJNZ     R0,?C0080?ZW_ROUTING_ALL
B1:0090D9 FF                MOV      R7,A
B1:0090DA 901220            MOV      DPTR,#responseRouteSpeedModified
B1:0090DD E0                MOVX     A,@DPTR
B1:0090DE FD                MOV      R5,A
B1:0090DF EF                MOV      A,R7
B1:0090E0 5D                ANL      A,R5
B1:0090E1 6037              JZ       ?C0019?ZW_ROUTING_ALL
B1:0090E3 90447A            MOV      DPTR,#pFrame
B1:0090E6 1285EF            LCALL    ?L?COM0002
B1:0090E9 4404              ORL      A,#04H
B1:0090EB 12203B            LCALL    ?C?CSTPTR
B1:0090EE 90447D            MOV      DPTR,#rtmp
B1:0090F1 E0                MOVX     A,@DPTR
B1:0090F2 FF                MOV      R7,A
B1:0090F3 243A              ADD      A,#LOW responseRouteSpeedNumHops-01H
B1:0090F5 12FE5C            LCALL    ?L?COM033C
B1:0090F8 548F              ANL      A,#08FH
B1:0090FA F0                MOVX     @DPTR,A
B1:0090FB 12FE59            LCALL    ?L?COM033B
B1:0090FE 4430              ORL      A,#030H
B1:009100 F0                MOVX     @DPTR,A
B1:009101 901220            MOV      DPTR,#responseRouteSpeedModified
B1:009104 E0                MOVX     A,@DPTR
B1:009105 FF                MOV      R7,A
B1:009106 90447D            MOV      DPTR,#rtmp
B1:009109 E0                MOVX     A,@DPTR
B1:00910A 14                DEC      A
B1:00910B 126E42            LCALL    ?L?COM01FE
B1:00910E 8002              SJMP     ?C0083?ZW_ROUTING_ALL
B1:009110         ?C0082?ZW_ROUTING_ALL:
B1:009110 C3                CLR      C
B1:009111 33                RLC      A
B1:009112         ?C0083?ZW_ROUTING_ALL:
B1:009112 D8FC              DJNZ     R0,?C0082?ZW_ROUTING_ALL
B1:009114 F4                CPL      A
B1:009115 5F                ANL      A,R7
B1:009116 901220            MOV      DPTR,#responseRouteSpeedModified
B1:009119 F0                MOVX     @DPTR,A
B1:00911A         ?C0019?ZW_ROUTING_ALL:
B1:00911A 7F01              MOV      R7,#01H
B1:00911C 22                RET      
B1:00911D         ?C0015?ZW_ROUTING_ALL:
B1:00911D 90447D            MOV      DPTR,#rtmp
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 227


B1:009120 E0                MOVX     A,@DPTR
B1:009121 14                DEC      A
B1:009122 F0                MOVX     @DPTR,A
B1:009123 6002              JZ       $ + 4H
B1:009125 0135              AJMP     ?C0017?ZW_ROUTING_ALL
B1:009127         ?C0014?ZW_ROUTING_ALL:
B1:009127 7F00              MOV      R7,#00H
B1:009129 22                RET      
----- FUNCTION _GetResponseRoute (END) -------


----- FUNCTION _EnqueueSingleDataPtr (BEGIN) -----
B1:00912A 9009C2            MOV      DPTR,#srcNodeID
B1:00912D ED                MOV      A,R5
B1:00912E F0                MOVX     @DPTR,A
B1:00912F A3                INC      DPTR
B1:009130 EB                MOV      A,R3
B1:009131 F0                MOVX     @DPTR,A
;---- Variable 'rfSpeed' assigned to Register 'R7' ----
B1:009132 9009CF            MOV      DPTR,#frameType
B1:009135 7401              MOV      A,#01H
B1:009137 F0                MOVX     @DPTR,A
B1:009138 9009D1            MOV      DPTR,#speed
B1:00913B EF                MOV      A,R7
B1:00913C F0                MOVX     @DPTR,A
;---- Variable 'engage_transport_service' assigned to Register 'R7' ----
B1:00913D E4                CLR      A
B1:00913E FF                MOV      R7,A
B1:00913F 9009C9            MOV      DPTR,#txOptions1
B1:009142 E0                MOVX     A,@DPTR
B1:009143 FE                MOV      R6,A
B1:009144 9009CC            MOV      DPTR,#pFreeTxElement
B1:009147 125D4E            LCALL    ?L?COM00AF
B1:00914A EE                MOV      A,R6
B1:00914B 12203B            LCALL    ?C?CSTPTR
B1:00914E 9009C8            MOV      DPTR,#txOptions
B1:009151 E0                MOVX     A,@DPTR
B1:009152 54C0              ANL      A,#0C0H
B1:009154 6002              JZ       $ + 4H
B1:009156 413A              AJMP     ?C0154?ZW_TRANSPORT
B1:009158 9009C7            MOV      DPTR,#dataLength
B1:00915B E0                MOVX     A,@DPTR
B1:00915C FE                MOV      R6,A
B1:00915D D3                SETB     C
B1:00915E 949F              SUBB     A,#09FH
B1:009160 4002              JC       ?C0155?ZW_TRANSPORT
B1:009162 61BF              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:009164         ?C0155?ZW_TRANSPORT:
B1:009164 9009C3            MOV      DPTR,#destNodeID
B1:009167 E0                MOVX     A,@DPTR
B1:009168 B4FF08            CJNE     A,#0FFH,?C0158?ZW_TRANSPORT
B1:00916B EE                MOV      A,R6
B1:00916C D3                SETB     C
B1:00916D 9436              SUBB     A,#036H
B1:00916F 4002              JC       ?C0158?ZW_TRANSPORT
B1:009171         
B1:009171 61BF              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:009173         ?C0158?ZW_TRANSPORT:
B1:009173 300A12            JNB      bUseExploreAsRouteResolution,?C0157?ZW_TRANSPORT
B1:009176 12FEE1            LCALL    ?L?COM058F
B1:009179 400D              JC       ?C0157?ZW_TRANSPORT
B1:00917B 121F7C            LCALL    ?C?CLDPTR
B1:00917E 30E604            JNB      ACC.6,?C0161?ZW_TRANSPORT
B1:009181 7F01              MOV      R7,#01H
B1:009183 8003              SJMP     ?C0157?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 228


B1:009185         ?C0161?ZW_TRANSPORT:
B1:009185 7F00              MOV      R7,#00H
B1:009187 22                RET      
B1:009188         ?C0157?ZW_TRANSPORT:
B1:009188 9009CC            MOV      DPTR,#pFreeTxElement
B1:00918B 1285EF            LCALL    ?L?COM0002
B1:00918E FE                MOV      R6,A
B1:00918F 20E612            JB       ACC.6,?C0164?ZW_TRANSPORT
B1:009192 9009C8            MOV      DPTR,#txOptions
B1:009195 E0                MOVX     A,@DPTR
B1:009196 20E40B            JB       ACC.4,?C0164?ZW_TRANSPORT
B1:009199 9009C7            MOV      DPTR,#dataLength
B1:00919C E0                MOVX     A,@DPTR
B1:00919D D3                SETB     C
B1:00919E 9497              SUBB     A,#097H
B1:0091A0 4002              JC       ?C0164?ZW_TRANSPORT
B1:0091A2         
B1:0091A2 61BF              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:0091A4         ?C0164?ZW_TRANSPORT:
B1:0091A4 EE                MOV      A,R6
B1:0091A5 30E607            JNB      ACC.6,?C0165?ZW_TRANSPORT
B1:0091A8 12FEE1            LCALL    ?L?COM058F
B1:0091AB 4002              JC       ?C0165?ZW_TRANSPORT
B1:0091AD 7F01              MOV      R7,#01H
B1:0091AF         ?C0165?ZW_TRANSPORT:
B1:0091AF EF                MOV      A,R7
B1:0091B0 7002              JNZ      $ + 4H
B1:0091B2 413A              AJMP     ?C0154?ZW_TRANSPORT
B1:0091B4 9009CC            MOV      DPTR,#pFreeTxElement
B1:0091B7 1285EF            LCALL    ?L?COM0002
B1:0091BA 20E602            JB       ACC.6,$ + 5H
B1:0091BD 61BF              AJMP     clean_up_and_exit?ZW_TRANSPORT
B1:0091BF         ?C0168?ZW_TRANSPORT:
B1:0091BF 7A09              MOV      R2,#HIGH proto_ts_param
B1:0091C1 79D2              MOV      R1,#LOW proto_ts_param
B1:0091C3 7D07              MOV      R5,#07H
B1:0091C5 12FE0B            LCALL    ?L?COM00E7
B1:0091C8 9009C2            MOV      DPTR,#srcNodeID
B1:0091CB E0                MOVX     A,@DPTR
B1:0091CC 9009D2            MOV      DPTR,#proto_ts_param
B1:0091CF F0                MOVX     @DPTR,A
B1:0091D0 9009C3            MOV      DPTR,#destNodeID
B1:0091D3 E0                MOVX     A,@DPTR
B1:0091D4 9009D3            MOV      DPTR,#proto_ts_param+01H
B1:0091D7 F0                MOVX     @DPTR,A
B1:0091D8 9009C8            MOV      DPTR,#txOptions
B1:0091DB E0                MOVX     A,@DPTR
B1:0091DC 54DF              ANL      A,#0DFH
B1:0091DE F0                MOVX     @DPTR,A
B1:0091DF 300A06            JNB      bUseExploreAsRouteResolution,?C0169?ZW_TRANSPORT
B1:0091E2 E0                MOVX     A,@DPTR
B1:0091E3 4420              ORL      A,#020H
B1:0091E5 FF                MOV      R7,A
B1:0091E6 8005              SJMP     ?C0170?ZW_TRANSPORT
B1:0091E8         ?C0169?ZW_TRANSPORT:
B1:0091E8 9009C8            MOV      DPTR,#txOptions
B1:0091EB E0                MOVX     A,@DPTR
B1:0091EC FF                MOV      R7,A
B1:0091ED         ?C0170?ZW_TRANSPORT:
B1:0091ED 9009D6            MOV      DPTR,#proto_ts_param+04H
B1:0091F0 EF                MOV      A,R7
B1:0091F1 F0                MOVX     @DPTR,A
B1:0091F2 9009CA            MOV      DPTR,#completedFunc
B1:0091F5 E0                MOVX     A,@DPTR
B1:0091F6 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 229


B1:0091F7 A3                INC      DPTR
B1:0091F8 E0                MOVX     A,@DPTR
B1:0091F9 900785            MOV      DPTR,#_ts_stored_callback
B1:0091FC CF                XCH      A,R7
B1:0091FD F0                MOVX     @DPTR,A
B1:0091FE EF                MOV      A,R7
B1:0091FF 71C6              ACALL    ?L?COM014B
B1:009201 D151              ACALL    _TxQueueReleaseElement
B1:009203 C20A              CLR      bUseExploreAsRouteResolution
B1:009205 9009C4            MOV      DPTR,#pData
B1:009208 122552            LCALL    ?C?PLDXDATA
B1:00920B 903F3E            MOV      DPTR,#?_ZW_TransportService_SendData?BYTE+03H
B1:00920E 122572            LCALL    ?C?PSTXDATA
B1:009211 9009C7            MOV      DPTR,#dataLength
B1:009214 E0                MOVX     A,@DPTR
B1:009215 903F41            MOV      DPTR,#?_ZW_TransportService_SendData?BYTE+06H
B1:009218 12FDEA            LCALL    ?L?COM034C
B1:00921B A3                INC      DPTR
B1:00921C 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_TsCallbackFunc
B1:00921E F0                MOVX     @DPTR,A
B1:00921F A3                INC      DPTR
B1:009220 7458              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_TsCallbackFunc
B1:009222 F0                MOVX     @DPTR,A
B1:009223 7B01              MOV      R3,#01H
B1:009225 7A09              MOV      R2,#HIGH proto_ts_param
B1:009227 79D2              MOV      R1,#LOW proto_ts_param
B1:009229 121D9F            LCALL    ?INTERBANK_TABLE?_ZW_TransportService_SendData
B1:00922C 4009              JC       ?C0171?ZW_TRANSPORT
B1:00922E E4                CLR      A
B1:00922F 900785            MOV      DPTR,#_ts_stored_callback
B1:009232 F0                MOVX     @DPTR,A
B1:009233 A3                INC      DPTR
B1:009234 F0                MOVX     @DPTR,A
B1:009235 FF                MOV      R7,A
B1:009236 22                RET      
B1:009237         ?C0171?ZW_TRANSPORT:
B1:009237 7F01              MOV      R7,#01H
B1:009239 22                RET      
B1:00923A         ?C0154?ZW_TRANSPORT:
B1:00923A 9009C2            MOV      DPTR,#srcNodeID
B1:00923D E0                MOVX     A,@DPTR
B1:00923E FF                MOV      R7,A
B1:00923F 71C8              ACALL    ?L?COM014D
B1:009241 E9                MOV      A,R1
B1:009242 24B6              ADD      A,#0B6H
B1:009244 1287AB            LCALL    ?L?COM0015
B1:009247 9009C3            MOV      DPTR,#destNodeID
B1:00924A E0                MOVX     A,@DPTR
B1:00924B FF                MOV      R7,A
B1:00924C 71C8              ACALL    ?L?COM014D
B1:00924E E9                MOV      A,R1
B1:00924F 24BA              ADD      A,#0BAH
B1:009251 1287AB            LCALL    ?L?COM0015
B1:009254 71C8              ACALL    ?L?COM014D
B1:009256 E9                MOV      A,R1
B1:009257 24DF              ADD      A,#0DFH
B1:009259 12D1A7            LCALL    ?L?COM00E3
B1:00925C 300A0C            JNB      bUseExploreAsRouteResolution,?C0172?ZW_TRANSPORT
B1:00925F C20A              CLR      bUseExploreAsRouteResolution
B1:009261 9009CC            MOV      DPTR,#pFreeTxElement
B1:009264 1285EF            LCALL    ?L?COM0002
B1:009267 4401              ORL      A,#01H
B1:009269 8013              SJMP     ?C0592?ZW_TRANSPORT
B1:00926B         ?C0172?ZW_TRANSPORT:
B1:00926B 9009C8            MOV      DPTR,#txOptions
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 230


B1:00926E E0                MOVX     A,@DPTR
B1:00926F 30E60F            JNB      ACC.6,?C0173?ZW_TRANSPORT
B1:009272 9009CF            MOV      DPTR,#frameType
B1:009275 7404              MOV      A,#04H
B1:009277 71C7              ACALL    ?L?COM014C
B1:009279 12E007            LCALL    ?L?COM02F6
B1:00927C 7407              MOV      A,#07H
B1:00927E         
B1:00927E 12203B            LCALL    ?C?CSTPTR
B1:009281         ?C0173?ZW_TRANSPORT:
B1:009281 9009C8            MOV      DPTR,#txOptions
B1:009284 E0                MOVX     A,@DPTR
B1:009285 5490              ANL      A,#090H
B1:009287 7058              JNZ      ?C0175?ZW_TRANSPORT
B1:009289 9009CF            MOV      DPTR,#frameType
B1:00928C E0                MOVX     A,@DPTR
B1:00928D 6401              XRL      A,#01H
B1:00928F 7050              JNZ      ?C0175?ZW_TRANSPORT
B1:009291 71C8              ACALL    ?L?COM014D
B1:009293 1117              ACALL    _GetResponseRoute
B1:009295 EF                MOV      A,R7
B1:009296 6049              JZ       ?C0175?ZW_TRANSPORT
B1:009298 9009CC            MOV      DPTR,#pFreeTxElement
B1:00929B 1252EE            LCALL    ?L?COM001E
B1:00929E 5460              ANL      A,#060H
B1:0092A0 600B              JZ       ?C0177?ZW_TRANSPORT
B1:0092A2 9009CC            MOV      DPTR,#pFreeTxElement
B1:0092A5 1285EF            LCALL    ?L?COM0002
B1:0092A8 4410              ORL      A,#010H
B1:0092AA 12203B            LCALL    ?C?CSTPTR
B1:0092AD         ?C0177?ZW_TRANSPORT:
B1:0092AD 71C8              ACALL    ?L?COM014D
B1:0092AF E9                MOV      A,R1
B1:0092B0 24BC              ADD      A,#0BCH
B1:0092B2 1285F5            LCALL    ?L?COM0004
B1:0092B5 54F0              ANL      A,#0F0H
B1:0092B7 6006              JZ       ?C0178?ZW_TRANSPORT
B1:0092B9 9009CF            MOV      DPTR,#frameType
B1:0092BC 7404              MOV      A,#04H
B1:0092BE F0                MOVX     @DPTR,A
B1:0092BF         ?C0178?ZW_TRANSPORT:
B1:0092BF 71C8              ACALL    ?L?COM014D
B1:0092C1 12E007            LCALL    ?L?COM02F6
B1:0092C4 7403              MOV      A,#03H
B1:0092C6 12203B            LCALL    ?C?CSTPTR
B1:0092C9 9009D1            MOV      DPTR,#speed
B1:0092CC E0                MOVX     A,@DPTR
B1:0092CD 5498              ANL      A,#098H
B1:0092CF F0                MOVX     @DPTR,A
B1:0092D0 E0                MOVX     A,@DPTR
B1:0092D1 FF                MOV      R7,A
B1:0092D2 9009CC            MOV      DPTR,#pFreeTxElement
B1:0092D5 1252EE            LCALL    ?L?COM001E
B1:0092D8 5467              ANL      A,#067H
B1:0092DA FE                MOV      R6,A
B1:0092DB EF                MOV      A,R7
B1:0092DC 4E                ORL      A,R6
B1:0092DD 9009D1            MOV      DPTR,#speed
B1:0092E0 F0                MOVX     @DPTR,A
B1:0092E1         ?C0175?ZW_TRANSPORT:
B1:0092E1 9009C3            MOV      DPTR,#destNodeID
B1:0092E4 E0                MOVX     A,@DPTR
B1:0092E5 FD                MOV      R5,A
B1:0092E6 B4FF07            CJNE     A,#0FFH,?C0179?ZW_TRANSPORT
B1:0092E9 9009C8            MOV      DPTR,#txOptions
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 231


B1:0092EC E0                MOVX     A,@DPTR
B1:0092ED 54FA              ANL      A,#0FAH
B1:0092EF F0                MOVX     @DPTR,A
B1:0092F0         ?C0179?ZW_TRANSPORT:
B1:0092F0 71C8              ACALL    ?L?COM014D
B1:0092F2 E9                MOV      A,R1
B1:0092F3 24DF              ADD      A,#0DFH
B1:0092F5 1285F5            LCALL    ?L?COM0004
B1:0092F8 707B              JNZ      ?C0180?ZW_TRANSPORT
B1:0092FA 9009C8            MOV      DPTR,#txOptions
B1:0092FD E0                MOVX     A,@DPTR
B1:0092FE 5405              ANL      A,#05H
B1:009300 6405              XRL      A,#05H
B1:009302 7071              JNZ      ?C0180?ZW_TRANSPORT
B1:009304 AF05              MOV      R7,AR5
B1:009306 128D0F            LCALL    _ReturnRouteFindFirst
B1:009309 5063              JNC      ?C0181?ZW_TRANSPORT
B1:00930B AF64              MOV      R7,returnRoute+06H
B1:00930D 12CF95            LCALL    _ReturnRouteGetSpeed
B1:009310 9009D1            MOV      DPTR,#speed
B1:009313 EF                MOV      A,R7
B1:009314 F0                MOVX     @DPTR,A
B1:009315 E55F              MOV      A,returnRoute+01H
B1:009317 540F              ANL      A,#0FH
B1:009319 9009D0            MOV      DPTR,#bRepeaterCountInRoute
B1:00931C F0                MOVX     @DPTR,A
B1:00931D 6038              JZ       ?C0182?ZW_TRANSPORT
B1:00931F E0                MOVX     A,@DPTR
B1:009320 FF                MOV      R7,A
B1:009321 7404              MOV      A,#04H
B1:009323 C3                CLR      C
B1:009324 9F                SUBB     A,R7
B1:009325 4030              JC       ?C0182?ZW_TRANSPORT
B1:009327 71C8              ACALL    ?L?COM014D
B1:009329 1287DE            LCALL    ?L?COM02B7
B1:00932C C003              PUSH     AR3
B1:00932E C002              PUSH     AR2
B1:009330 C001              PUSH     AR1
B1:009332 128FC2            LCALL    ?L?COM04CC
B1:009335 1287B9            LCALL    ?L?COM003F
B1:009338 D001              POP      AR1
B1:00933A D002              POP      AR2
B1:00933C D003              POP      AR3
B1:00933E 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:009341 9009D0            MOV      DPTR,#bRepeaterCountInRoute
B1:009344 E0                MOVX     A,@DPTR
B1:009345 C4                SWAP     A
B1:009346 54F0              ANL      A,#0F0H
B1:009348 FF                MOV      R7,A
B1:009349 71C8              ACALL    ?L?COM014D
B1:00934B E9                MOV      A,R1
B1:00934C 24BC              ADD      A,#0BCH
B1:00934E 1287AB            LCALL    ?L?COM0015
B1:009351 9009CF            MOV      DPTR,#frameType
B1:009354 7404              MOV      A,#04H
B1:009356 F0                MOVX     @DPTR,A
B1:009357         ?C0182?ZW_TRANSPORT:
B1:009357 71C8              ACALL    ?L?COM014D
B1:009359 12E007            LCALL    ?L?COM02F6
B1:00935C 7405              MOV      A,#05H
B1:00935E 12203B            LCALL    ?C?CSTPTR
B1:009361 71C8              ACALL    ?L?COM014D
B1:009363 E9                MOV      A,R1
B1:009364 12D092            LCALL    ?L?COM035A
B1:009367 E55E              MOV      A,returnRoute
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 232


B1:009369 12203B            LCALL    ?C?CSTPTR
B1:00936C 8007              SJMP     ?C0180?ZW_TRANSPORT
B1:00936E         ?C0181?ZW_TRANSPORT:
B1:00936E 9009C8            MOV      DPTR,#txOptions
B1:009371 E0                MOVX     A,@DPTR
B1:009372 54FB              ANL      A,#0FBH
B1:009374 F0                MOVX     @DPTR,A
B1:009375         ?C0180?ZW_TRANSPORT:
B1:009375 71C8              ACALL    ?L?COM014D
B1:009377 E9                MOV      A,R1
B1:009378 24DF              ADD      A,#0DFH
B1:00937A 1285F5            LCALL    ?L?COM0004
B1:00937D 7005              JNZ      ?C0184?ZW_TRANSPORT
B1:00937F 7406              MOV      A,#06H
B1:009381 12203B            LCALL    ?C?CSTPTR
B1:009384         ?C0184?ZW_TRANSPORT:
B1:009384 9009D1            MOV      DPTR,#speed
B1:009387 E0                MOVX     A,@DPTR
B1:009388 FF                MOV      R7,A
B1:009389 9009CF            MOV      DPTR,#frameType
B1:00938C E0                MOVX     A,@DPTR
B1:00938D FD                MOV      R5,A
B1:00938E 9009C7            MOV      DPTR,#dataLength
B1:009391 E0                MOVX     A,@DPTR
B1:009392 900A19            MOV      DPTR,#?_EnQueueCommon?BYTE+05H
B1:009395 F0                MOVX     @DPTR,A
B1:009396 9009C8            MOV      DPTR,#txOptions
B1:009399 E0                MOVX     A,@DPTR
B1:00939A 900A1A            MOV      DPTR,#?_EnQueueCommon?BYTE+06H
B1:00939D F0                MOVX     @DPTR,A
B1:00939E 9009CA            MOV      DPTR,#completedFunc
B1:0093A1 E0                MOVX     A,@DPTR
B1:0093A2 FB                MOV      R3,A
B1:0093A3 A3                INC      DPTR
B1:0093A4 E0                MOVX     A,@DPTR
B1:0093A5 900A1B            MOV      DPTR,#?_EnQueueCommon?BYTE+07H
B1:0093A8 CB                XCH      A,R3
B1:0093A9 F0                MOVX     @DPTR,A
B1:0093AA EB                MOV      A,R3
B1:0093AB 71C6              ACALL    ?L?COM014B
B1:0093AD 900A1D            MOV      DPTR,#?_EnQueueCommon?BYTE+09H
B1:0093B0 122572            LCALL    ?C?PSTXDATA
B1:0093B3 9009C4            MOV      DPTR,#pData
B1:0093B6 122552            LCALL    ?C?PLDXDATA
B1:0093B9 12C7A3            LCALL    _EnQueueCommon
B1:0093BC 7F01              MOV      R7,#01H
B1:0093BE 22                RET      
B1:0093BF         clean_up_and_exit:
B1:0093BF 71C8              ACALL    ?L?COM014D
B1:0093C1 D151              ACALL    _TxQueueReleaseElement
B1:0093C3 7F00              MOV      R7,#00H
B1:0093C5 22                RET      
----- FUNCTION _EnqueueSingleDataPtr (END) -------


----- FUNCTION ?L?COM014B (BEGIN) -----
B1:0093C6 A3                INC      DPTR
B1:0093C7         ?L?COM014C:
B1:0093C7 F0                MOVX     @DPTR,A
B1:0093C8         ?L?COM014D:
B1:0093C8 9009CC            MOV      DPTR,#pFreeTxElement
B1:0093CB 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM014B (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 233


----- FUNCTION ?L?COM038D (BEGIN) -----
B1:0093CE FF                MOV      R7,A
B1:0093CF         ?L?COM038E:
B1:0093CF 90447A            MOV      DPTR,#pFrame
B1:0093D2 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM038D (END) -------


----- FUNCTION _ZW_SendDataEx (BEGIN) -----
B1:0093D5 900A2C            MOV      DPTR,#pData
B1:0093D8 122572            LCALL    ?C?PSTXDATA
B1:0093DB 900A2F            MOV      DPTR,#dataLength
B1:0093DE ED                MOV      A,R5
B1:0093DF F0                MOVX     @DPTR,A
B1:0093E0 E4                CLR      A
B1:0093E1 900671            MOV      DPTR,#eErrcode
B1:0093E4 F0                MOVX     @DPTR,A
B1:0093E5 900A30            MOV      DPTR,#pTxOptionsEx
B1:0093E8 B157              ACALL    ?L?COM003C
B1:0093EA 1285F5            LCALL    ?L?COM0004
B1:0093ED 5437              ANL      A,#037H
B1:0093EF 12203B            LCALL    ?C?CSTPTR
B1:0093F2 B146              ACALL    ?L?COM0057
B1:0093F4 1285F5            LCALL    ?L?COM0004
B1:0093F7 FF                MOV      R7,A
B1:0093F8 12DFC0            LCALL    _IsKeySupported
B1:0093FB 4009              JC       ?C0383?ZW_TRANSPORT
B1:0093FD 900671            MOV      DPTR,#eErrcode
B1:009400 7402              MOV      A,#02H
B1:009402 F0                MOVX     @DPTR,A
B1:009403 7F00              MOV      R7,#00H
B1:009405 22                RET      
B1:009406         ?C0383?ZW_TRANSPORT:
B1:009406 B146              ACALL    ?L?COM0057
B1:009408 1285F5            LCALL    ?L?COM0004
B1:00940B 6002              JZ       $ + 4H
B1:00940D 81C4              AJMP     ?C0385?ZW_TRANSPORT
B1:00940F 900A30            MOV      DPTR,#pTxOptionsEx
B1:009412 B157              ACALL    ?L?COM003C
B1:009414 1285F5            LCALL    ?L?COM0004
B1:009417 FF                MOV      R7,A
B1:009418 C3                CLR      C
B1:009419 30E501            JNB      ACC.5,?C0386?ZW_TRANSPORT
B1:00941C D3                SETB     C
B1:00941D         ?C0386?ZW_TRANSPORT:
B1:00941D         ?C0387?ZW_TRANSPORT:
B1:00941D 920A              MOV      bUseExploreAsRouteResolution,C
B1:00941F 900A30            MOV      DPTR,#pTxOptionsEx
B1:009422 B157              ACALL    ?L?COM003C
B1:009424 F9                MOV      R1,A
B1:009425 E4                CLR      A
B1:009426 3A                ADDC     A,R2
B1:009427 FA                MOV      R2,A
B1:009428 EF                MOV      A,R7
B1:009429 4420              ORL      A,#020H
B1:00942B 12203B            LCALL    ?C?CSTPTR
B1:00942E C206              CLR      bApplicationTxAbort
B1:009430 7F02              MOV      R7,#02H
B1:009432 12834D            LCALL    _TxQueueGetElement
B1:009435 900A35            MOV      DPTR,#pFreeTxElement
B1:009438 12D134            LCALL    ?L?COM0287
B1:00943B 7002              JNZ      $ + 4H
B1:00943D 81BE              AJMP     ?C0388?ZW_TRANSPORT
B1:00943F 12593A            LCALL    getTickTime
B1:009442 900A35            MOV      DPTR,#pFreeTxElement
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 234


B1:009445 12C947            LCALL    ?L?COM00B7
B1:009448 900A35            MOV      DPTR,#pFreeTxElement
B1:00944B 12D768            LCALL    ?L?COM0460
B1:00944E 12D1A7            LCALL    ?L?COM00E3
B1:009451 900A30            MOV      DPTR,#pTxOptionsEx
B1:009454 125D40            LCALL    ?L?COM034F
B1:009457 1285F5            LCALL    ?L?COM0004
B1:00945A 30E00B            JNB      ACC.0,?C0389?ZW_TRANSPORT
B1:00945D 900A35            MOV      DPTR,#pFreeTxElement
B1:009460 1285EF            LCALL    ?L?COM0002
B1:009463 4440              ORL      A,#040H
B1:009465 12203B            LCALL    ?C?CSTPTR
B1:009468         ?C0389?ZW_TRANSPORT:
B1:009468 900A30            MOV      DPTR,#pTxOptionsEx
B1:00946B 12C941            LCALL    ?L?COM0048
B1:00946E FF                MOV      R7,A
B1:00946F 12D22A            LCALL    _ChooseSpeedForDestination_slave
B1:009472 901221            MOV      DPTR,#nodeID
B1:009475 E0                MOVX     A,@DPTR
B1:009476 FD                MOV      R5,A
B1:009477 900A30            MOV      DPTR,#pTxOptionsEx
B1:00947A 12C941            LCALL    ?L?COM0048
B1:00947D FB                MOV      R3,A
B1:00947E C003              PUSH     AR3
B1:009480 12FE93            LCALL    ?L?COM0426
B1:009483 12D6FC            LCALL    ?L?COM0354
B1:009486 900A2F            MOV      DPTR,#dataLength
B1:009489 E0                MOVX     A,@DPTR
B1:00948A 9009C7            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+06H
B1:00948D F0                MOVX     @DPTR,A
B1:00948E 900A30            MOV      DPTR,#pTxOptionsEx
B1:009491 B157              ACALL    ?L?COM003C
B1:009493 1285F5            LCALL    ?L?COM0004
B1:009496 9009C8            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+07H
B1:009499 F0                MOVX     @DPTR,A
B1:00949A 900A35            MOV      DPTR,#pFreeTxElement
B1:00949D 1285EF            LCALL    ?L?COM0002
B1:0094A0 9009C9            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:0094A3 F0                MOVX     @DPTR,A
B1:0094A4 900A33            MOV      DPTR,#completedFunc
B1:0094A7 12FDA7            LCALL    ?L?COM03F4
B1:0094AA 900A35            MOV      DPTR,#pFreeTxElement
B1:0094AD 12D77E            LCALL    ?L?COM027B
B1:0094B0 D003              POP      AR3
B1:0094B2 312A              ACALL    _EnqueueSingleDataPtr
;---- Variable 'return_val' assigned to Register 'R7' ----
B1:0094B4 EF                MOV      A,R7
B1:0094B5 6002              JZ       ?C0390?ZW_TRANSPORT
B1:0094B7 A13D              AJMP     ?C0618?ZW_TRANSPORT
B1:0094B9         ?C0390?ZW_TRANSPORT:
B1:0094B9 900A35            MOV      DPTR,#pFreeTxElement
B1:0094BC D14E              ACALL    ?L?COM0461
B1:0094BE         ?C0388?ZW_TRANSPORT:
B1:0094BE 12D6F7            LCALL    CleanUpAfterFailedTxElemAlloc
B1:0094C1 7F00              MOV      R7,#00H
B1:0094C3 22                RET      
B1:0094C4         ?C0385?ZW_TRANSPORT:
B1:0094C4 B146              ACALL    ?L?COM0057
B1:0094C6 1285F5            LCALL    ?L?COM0004
B1:0094C9 6404              XRL      A,#04H
B1:0094CB 7036              JNZ      ?C0392?ZW_TRANSPORT
B1:0094CD 12FED8            LCALL    ?L?COM051F
B1:0094D0 12C941            LCALL    ?L?COM0048
B1:0094D3 FD                MOV      R5,A
B1:0094D4 900A2F            MOV      DPTR,#dataLength
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 235


B1:0094D7 E0                MOVX     A,@DPTR
B1:0094D8 9042FD            MOV      DPTR,#?_sec0_send_data?BYTE+05H
B1:0094DB F0                MOVX     @DPTR,A
B1:0094DC 900A30            MOV      DPTR,#pTxOptionsEx
B1:0094DF B157              ACALL    ?L?COM003C
B1:0094E1 1285F5            LCALL    ?L?COM0004
B1:0094E4 9042FE            MOV      DPTR,#?_sec0_send_data?BYTE+06H
B1:0094E7 F0                MOVX     @DPTR,A
B1:0094E8 900A33            MOV      DPTR,#completedFunc
B1:0094EB E0                MOVX     A,@DPTR
B1:0094EC FB                MOV      R3,A
B1:0094ED A3                INC      DPTR
B1:0094EE E0                MOVX     A,@DPTR
B1:0094EF 9042FF            MOV      DPTR,#?_sec0_send_data?BYTE+07H
B1:0094F2 CB                XCH      A,R3
B1:0094F3 F0                MOVX     @DPTR,A
B1:0094F4 EB                MOV      A,R3
B1:0094F5 12FE91            LCALL    ?L?COM0425
B1:0094F8 121C82            LCALL    ?INTERBANK_TABLE?_sec0_send_data
B1:0094FB EF                MOV      A,R7
B1:0094FC 6002              JZ       ?C0393?ZW_TRANSPORT
B1:0094FE         
B1:0094FE 803D              SJMP     ?C0618?ZW_TRANSPORT
B1:009500         ?C0393?ZW_TRANSPORT:
B1:009500 7F00              MOV      R7,#00H
B1:009502 22                RET      
B1:009503         ?C0392?ZW_TRANSPORT:
B1:009503 B146              ACALL    ?L?COM0057
B1:009505 1285F5            LCALL    ?L?COM0004
B1:009508 D3                SETB     C
B1:009509 9403              SUBB     A,#03H
B1:00950B 5036              JNC      ?C0391?ZW_TRANSPORT
B1:00950D 12FED8            LCALL    ?L?COM051F
B1:009510 12E012            LCALL    ?L?COM00B3
B1:009513 1287AB            LCALL    ?L?COM0015
B1:009516 900A2F            MOV      DPTR,#dataLength
B1:009519 E0                MOVX     A,@DPTR
B1:00951A FD                MOV      R5,A
B1:00951B 7C00              MOV      R4,#00H
B1:00951D A3                INC      DPTR
B1:00951E 122552            LCALL    ?C?PLDXDATA
B1:009521 9040A3            MOV      DPTR,#?_sec2_send_data?BYTE+05H
B1:009524 122572            LCALL    ?C?PSTXDATA
B1:009527 900A33            MOV      DPTR,#completedFunc
B1:00952A E0                MOVX     A,@DPTR
B1:00952B FF                MOV      R7,A
B1:00952C A3                INC      DPTR
B1:00952D E0                MOVX     A,@DPTR
B1:00952E 9040A6            MOV      DPTR,#?_sec2_send_data?BYTE+08H
B1:009531 CF                XCH      A,R7
B1:009532 F0                MOVX     @DPTR,A
B1:009533 EF                MOV      A,R7
B1:009534 12FE91            LCALL    ?L?COM0425
B1:009537 121CAA            LCALL    ?INTERBANK_TABLE?_sec2_send_data
B1:00953A EF                MOV      A,R7
B1:00953B 6003              JZ       ?C0397?ZW_TRANSPORT
B1:00953D         
B1:00953D 02FDF1            LJMP     ?L?COM058B
B1:009540         ?C0397?ZW_TRANSPORT:
B1:009540 7F00              MOV      R7,#00H
B1:009542 22                RET      
B1:009543         ?C0391?ZW_TRANSPORT:
B1:009543 7F00              MOV      R7,#00H
B1:009545 22                RET      
----- FUNCTION _ZW_SendDataEx (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 236




----- FUNCTION ?L?COM0057 (BEGIN) -----
B1:009546 900A30            MOV      DPTR,#pTxOptionsEx
B1:009549         ?L?COM0058:
B1:009549 122552            LCALL    ?C?PLDXDATA
B1:00954C E9                MOV      A,R1
B1:00954D 2404              ADD      A,#04H
B1:00954F 22                RET      
----- FUNCTION ?L?COM0057 (END) -------


----- FUNCTION ?L?COM0039 (BEGIN) -----
B1:009550 9041A2            MOV      DPTR,#n
B1:009553         ?L?COM003A:
B1:009553 F0                MOVX     @DPTR,A
B1:009554         ?L?COM003B:
B1:009554 904197            MOV      DPTR,#pCmd
B1:009557         ?L?COM003C:
B1:009557 122552            LCALL    ?C?PLDXDATA
B1:00955A E9                MOV      A,R1
B1:00955B 2402              ADD      A,#02H
B1:00955D 22                RET      
----- FUNCTION ?L?COM0039 (END) -------


----- FUNCTION _ZCB_ProtocolTransmitComplete (BEGIN) -----
B1:00955E 904572            MOV      DPTR,#pTransmittedFrame
B1:009561 122572            LCALL    ?C?PSTXDATA
B1:009564 E9                MOV      A,R1
B1:009565 4A                ORL      A,R2
B1:009566 C3                CLR      C
B1:009567 6001              JZ       ?C0036?ZW_TXQ_PROTOCOL
B1:009569 D3                SETB     C
B1:00956A         ?C0036?ZW_TXQ_PROTOCOL:
B1:00956A         ?C0037?ZW_TXQ_PROTOCOL:
B1:00956A 4002              JC       $ + 4H
B1:00956C C144              AJMP     ?C0038?ZW_TXQ_PROTOCOL
B1:00956E         ?C0035?ZW_TXQ_PROTOCOL:
B1:00956E 904572            MOV      DPTR,#pTransmittedFrame
B1:009571 B157              ACALL    ?L?COM003C
B1:009573 1285F5            LCALL    ?L?COM0004
B1:009576 30E019            JNB      ACC.0,?C0039?ZW_TXQ_PROTOCOL
B1:009579 D146              ACALL    ?L?COM012E
B1:00957B 24B7              ADD      A,#0B7H
B1:00957D 1285F5            LCALL    ?L?COM0004
B1:009580 540F              ANL      A,#0FH
B1:009582 FF                MOV      R7,A
B1:009583 BF0503            CJNE     R7,#05H,?C0040?ZW_TXQ_PROTOCOL
B1:009586 D3                SETB     C
B1:009587 8001              SJMP     ?C0041?ZW_TXQ_PROTOCOL
B1:009589         ?C0040?ZW_TXQ_PROTOCOL:
B1:009589 C3                CLR      C
B1:00958A         ?C0041?ZW_TXQ_PROTOCOL:
B1:00958A 4006              JC       ?C0039?ZW_TXQ_PROTOCOL
B1:00958C 12D978            LCALL    ?L?COM0483
B1:00958F 02852C            LJMP     _ProtocolWaitForACK
B1:009592         ?C0039?ZW_TXQ_PROTOCOL:
B1:009592 12C554            LCALL    ClearSendDataTxStatus
B1:009595 12D978            LCALL    ?L?COM0483
B1:009598 12F6B9            LCALL    ?L?COM0421
B1:00959B 5015              JNC      ?C0042?ZW_TXQ_PROTOCOL
B1:00959D E0                MOVX     A,@DPTR
B1:00959E FF                MOV      R7,A
B1:00959F 9404              SUBB     A,#04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 237


B1:0095A1 5002              JNC      ?C0043?ZW_TXQ_PROTOCOL
B1:0095A3 8002              SJMP     ?C0044?ZW_TXQ_PROTOCOL
B1:0095A5         ?C0043?ZW_TXQ_PROTOCOL:
B1:0095A5 7F04              MOV      R7,#04H
B1:0095A7         ?C0044?ZW_TXQ_PROTOCOL:
B1:0095A7 D146              ACALL    ?L?COM012E
B1:0095A9 1287DF            LCALL    ?L?COM02B8
B1:0095AC 1287B9            LCALL    ?L?COM003F
B1:0095AF 12FE99            LCALL    ?L?COM0478
B1:0095B2         ?C0042?ZW_TXQ_PROTOCOL:
B1:0095B2 904572            MOV      DPTR,#pTransmittedFrame
B1:0095B5 1252EE            LCALL    ?L?COM001E
B1:0095B8 5467              ANL      A,#067H
B1:0095BA 904027            MOV      DPTR,#tx_status+0FH
B1:0095BD D145              ACALL    ?L?COM012D
B1:0095BF 24DF              ADD      A,#0DFH
B1:0095C1 1285F5            LCALL    ?L?COM0004
B1:0095C4 904022            MOV      DPTR,#tx_status+0AH
B1:0095C7 D145              ACALL    ?L?COM012D
B1:0095C9 24E6              ADD      A,#0E6H
B1:0095CB 1285F5            LCALL    ?L?COM0004
B1:0095CE 904028            MOV      DPTR,#tx_status+010H
B1:0095D1 D145              ACALL    ?L?COM012D
B1:0095D3 24E7              ADD      A,#0E7H
B1:0095D5 1285F5            LCALL    ?L?COM0004
B1:0095D8 904029            MOV      DPTR,#tx_status+011H
B1:0095DB D145              ACALL    ?L?COM012D
B1:0095DD 24E8              ADD      A,#0E8H
B1:0095DF 1285F5            LCALL    ?L?COM0004
B1:0095E2 90402A            MOV      DPTR,#tx_status+012H
B1:0095E5 D145              ACALL    ?L?COM012D
B1:0095E7 24E4              ADD      A,#0E4H
B1:0095E9 1285F5            LCALL    ?L?COM0004
B1:0095EC 904020            MOV      DPTR,#tx_status+08H
B1:0095EF D145              ACALL    ?L?COM012D
B1:0095F1 24E5              ADD      A,#0E5H
B1:0095F3 1285F5            LCALL    ?L?COM0004
B1:0095F6 904021            MOV      DPTR,#tx_status+09H
B1:0095F9 D145              ACALL    ?L?COM012D
B1:0095FB 24E9              ADD      A,#0E9H
B1:0095FD 1252F4            LCALL    ?L?COM0021
B1:009600 12FE65            LCALL    ?L?COM038B
B1:009603 D145              ACALL    ?L?COM012D
B1:009605 24E3              ADD      A,#0E3H
B1:009607 1285F5            LCALL    ?L?COM0004
B1:00960A 904575            MOV      DPTR,#bCallbackStatus
B1:00960D 7003              JNZ      ?C0045?ZW_TXQ_PROTOCOL
B1:00960F F0                MOVX     @DPTR,A
B1:009610 8003              SJMP     ?C0046?ZW_TXQ_PROTOCOL
B1:009612         ?C0045?ZW_TXQ_PROTOCOL:
B1:009612 7401              MOV      A,#01H
B1:009614 F0                MOVX     @DPTR,A
B1:009615         ?C0046?ZW_TXQ_PROTOCOL:
B1:009615 D146              ACALL    ?L?COM012E
B1:009617 24DC              ADD      A,#0DCH
B1:009619 1252F4            LCALL    ?L?COM0021
B1:00961C 45F0              ORL      A,B
B1:00961E 601F              JZ       ?C0047?ZW_TXQ_PROTOCOL
B1:009620 904575            MOV      DPTR,#bCallbackStatus
B1:009623 12FEAB            LCALL    ?L?COM04DE
B1:009626 C003              PUSH     AR3
B1:009628 C002              PUSH     AR2
B1:00962A C001              PUSH     AR1
B1:00962C D146              ACALL    ?L?COM012E
B1:00962E 24DC              ADD      A,#0DCH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 238


B1:009630 1252F4            LCALL    ?L?COM0021
B1:009633 12FEB4            LCALL    ?L?COM04E9
B1:009636 D001              POP      AR1
B1:009638 D002              POP      AR2
B1:00963A D003              POP      AR3
B1:00963C 1226E3            LCALL    ?C?ICALL2
B1:00963F         ?C0047?ZW_TXQ_PROTOCOL:
B1:00963F 12D978            LCALL    ?L?COM0483
B1:009642 D151              ACALL    _TxQueueReleaseElement
B1:009644         ?C0038?ZW_TXQ_PROTOCOL:
B1:009644 22                RET      
----- FUNCTION _ZCB_ProtocolTransmitComplete (END) -------


----- FUNCTION ?L?COM012D (BEGIN) -----
B1:009645 F0                MOVX     @DPTR,A
B1:009646         ?L?COM012E:
B1:009646 904572            MOV      DPTR,#pTransmittedFrame
B1:009649 122552            LCALL    ?C?PLDXDATA
B1:00964C E9                MOV      A,R1
B1:00964D 22                RET      
----- FUNCTION ?L?COM012D (END) -------


----- FUNCTION ?L?COM0461 (BEGIN) -----
B1:00964E 122552            LCALL    ?C?PLDXDATA
----- FUNCTION _TxQueueReleaseElement (BEGIN) -----
;---- Variable 'pFreeTxElement' assigned to Register 'R1/R2/R3' ----
B1:009651 E4                CLR      A
B1:009652 12203B            LCALL    ?C?CSTPTR
B1:009655 12F70B            LCALL    TxQueueIsEmpty
B1:009658 EF                MOV      A,R7
B1:009659 6401              XRL      A,#01H
B1:00965B 703F              JNZ      ?C0053?ZW_TX_QUEUE
B1:00965D 12F6FE            LCALL    ?L?COM03EB
B1:009660 12DF85            LCALL    _list_head
B1:009663 802F              SJMP     ?C0059?ZW_TX_QUEUE
B1:009665         ?C0049?ZW_TX_QUEUE:
B1:009665 12D917            LCALL    ?L?COM0462
B1:009668 E9                MOV      A,R1
B1:009669 4A                ORL      A,R2
B1:00966A 6030              JZ       ?C0053?ZW_TX_QUEUE
B1:00966C 12D917            LCALL    ?L?COM0462
B1:00966F 90420B            MOV      DPTR,#?_list_remove?BYTE+03H
B1:009672 12F6FB            LCALL    ?L?COM03EA
B1:009675 12AC6F            LCALL    _list_remove
B1:009678 12F1E2            LCALL    ?L?COM014E
B1:00967B 1252F4            LCALL    ?L?COM0021
B1:00967E 45F0              ORL      A,B
B1:009680 600C              JZ       ?C0051?ZW_TX_QUEUE
B1:009682 12F1E2            LCALL    ?L?COM014E
B1:009685 1252F4            LCALL    ?L?COM0021
B1:009688 AAF0              MOV      R2,B
B1:00968A F9                MOV      R1,A
B1:00968B 1226DF            LCALL    ?C?ICALL
B1:00968E         ?C0051?ZW_TX_QUEUE:
B1:00968E 12D917            LCALL    ?L?COM0462
B1:009691 122587            LCALL    ?C?PLDPTR
B1:009694         
B1:009694 900ACA            MOV      DPTR,#elm
B1:009697 122572            LCALL    ?C?PSTXDATA
B1:00969A 80C9              SJMP     ?C0049?ZW_TX_QUEUE
B1:00969C         ?C0053?ZW_TX_QUEUE:
B1:00969C 22                RET      
----- FUNCTION _TxQueueReleaseElement (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 239




----- FUNCTION _IsMyFrame (BEGIN) -----
B1:00969D 900A07            MOV      DPTR,#pRxFrame
B1:0096A0 126ECE            LCALL    ?L?COM035B
B1:0096A3 900A11            MOV      DPTR,#fr
B1:0096A6 122572            LCALL    ?C?PSTXDATA
B1:0096A9 12D90D            LCALL    ?L?COM0055
B1:0096AC 12D1A7            LCALL    ?L?COM00E3
B1:0096AF 900768            MOV      DPTR,#myFrame
B1:0096B2 F0                MOVX     @DPTR,A
B1:0096B3 900679            MOV      DPTR,#sACK
B1:0096B6 F0                MOVX     @DPTR,A
B1:0096B7 900A11            MOV      DPTR,#fr
B1:0096BA 1287B6            LCALL    ?L?COM003E
B1:0096BD 12DA72            LCALL    ?L?COM0343
B1:0096C0 7F04              MOV      R7,#04H
B1:0096C2 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:0096C5 203A19            JB       productionTest,?C0256?ZW_TRANSPORT
B1:0096C8 7B01              MOV      R3,#01H
B1:0096CA 126E5B            LCALL    ?L?COM0280
B1:0096CD 7A06              MOV      R2,#HIGH crH
B1:0096CF 7968              MOV      R1,#LOW crH
B1:0096D1 12DA6B            LCALL    ?L?COM016E
B1:0096D4 600B              JZ       ?C0256?ZW_TRANSPORT
B1:0096D6 12D90D            LCALL    ?L?COM0055
B1:0096D9 1285F5            LCALL    ?L?COM0004
B1:0096DC 4480              ORL      A,#080H
B1:0096DE 12203B            LCALL    ?C?CSTPTR
B1:0096E1         ?C0256?ZW_TRANSPORT:
B1:0096E1 12D90D            LCALL    ?L?COM0055
B1:0096E4 1285F5            LCALL    ?L?COM0004
B1:0096E7 20E702            JB       ACC.7,$ + 5H
B1:0096EA E189              AJMP     ?C0258?ZW_TRANSPORT
B1:0096EC 901221            MOV      DPTR,#nodeID
B1:0096EF E0                MOVX     A,@DPTR
B1:0096F0 605D              JZ       ?C0259?ZW_TRANSPORT
B1:0096F2 30115A            JNB      exploreInclusionModeRepeat,?C0259?ZW_TRANSPORT
B1:0096F5 129F81            LCALL    ?L?COM000E
B1:0096F8 2405              ADD      A,#05H
B1:0096FA 1285F5            LCALL    ?L?COM0004
B1:0096FD 540F              ANL      A,#0FH
B1:0096FF FF                MOV      R7,A
B1:009700 6405              XRL      A,#05H
B1:009702 7002              JNZ      $ + 4H
B1:009704 E189              AJMP     ?C0258?ZW_TRANSPORT
B1:009706 EF                MOV      A,R7
B1:009707 6401              XRL      A,#01H
B1:009709 7044              JNZ      ?C0259?ZW_TRANSPORT
B1:00970B 121F7C            LCALL    ?C?CLDPTR
B1:00970E 30E73E            JNB      ACC.7,?C0259?ZW_TRANSPORT
B1:009711 129F81            LCALL    ?L?COM000E
B1:009714 2409              ADD      A,#09H
B1:009716 1285F5            LCALL    ?L?COM0004
B1:009719 30E316            JNB      ACC.3,?C0262?ZW_TRANSPORT
B1:00971C 129F81            LCALL    ?L?COM000E
B1:00971F 240A              ADD      A,#0AH
B1:009721 1285F5            LCALL    ?L?COM0004
B1:009724 12BBF5            LCALL    ?L?COM01E2
B1:009727 129F81            LCALL    ?L?COM000E
B1:00972A 12B8C2            LCALL    ?L?COM002C
B1:00972D 12D98E            LCALL    ?L?COM0138
B1:009730 8002              SJMP     ?C0263?ZW_TRANSPORT
B1:009732         ?C0262?ZW_TRANSPORT:
B1:009732 7F00              MOV      R7,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 240


B1:009734         ?C0263?ZW_TRANSPORT:
B1:009734 7E00              MOV      R6,#00H
B1:009736 129F81            LCALL    ?L?COM000E
B1:009739 240A              ADD      A,#0AH
B1:00973B 1285F5            LCALL    ?L?COM0004
B1:00973E 129F7B            LCALL    ?L?COM000D
B1:009741 12D9BA            LCALL    ?L?COM0088
B1:009744 12B8C6            LCALL    ?L?COM002E
B1:009747 125D51            LCALL    ?L?COM00B0
B1:00974A 12DA5F            LCALL    ?L?COM016C
B1:00974D 603A              JZ       ?C0258?ZW_TRANSPORT
B1:00974F         ?C0259?ZW_TRANSPORT:
B1:00974F 200103            JB       learnMode,$ + 6H
B1:009752 029E56            LJMP     ?C0257?ZW_TRANSPORT
B1:009755 200431            JB       learnModeClassic,?C0258?ZW_TRANSPORT
B1:009758 129F81            LCALL    ?L?COM000E
B1:00975B 2405              ADD      A,#05H
B1:00975D 1285F5            LCALL    ?L?COM0004
B1:009760 20E726            JB       ACC.7,?C0258?ZW_TRANSPORT
B1:009763 129F81            LCALL    ?L?COM000E
B1:009766 126E30            LCALL    ?L?COM01DE
B1:009769 E9                MOV      A,R1
B1:00976A 2401              ADD      A,#01H
B1:00976C 1285F5            LCALL    ?L?COM0004
B1:00976F B40317            CJNE     A,#03H,?C0258?ZW_TRANSPORT
B1:009772 129F81            LCALL    ?L?COM000E
B1:009775 126E30            LCALL    ?L?COM01DE
B1:009778 125D51            LCALL    ?L?COM00B0
B1:00977B 126E5F            LCALL    ?L?COM0281
B1:00977E 12DA72            LCALL    ?L?COM0343
B1:009781 12DA6B            LCALL    ?L?COM016E
B1:009784 7003              JNZ      $ + 5H
B1:009786 029E56            LJMP     ?C0257?ZW_TRANSPORT
B1:009789         ?C0258?ZW_TRANSPORT:
B1:009789 129F81            LCALL    ?L?COM000E
B1:00978C 2406              ADD      A,#06H
B1:00978E 1285F5            LCALL    ?L?COM0004
B1:009791 540F              ANL      A,#0FH
B1:009793 FF                MOV      R7,A
B1:009794 900666            MOV      DPTR,#bRxCurrentSpeed
B1:009797 E0                MOVX     A,@DPTR
B1:009798 7E00              MOV      R6,#00H
B1:00979A B40202            CJNE     A,#02H,?C0265?ZW_TRANSPORT
B1:00979D 7E80              MOV      R6,#080H
B1:00979F         ?C0265?ZW_TRANSPORT:
B1:00979F         ?C0266?ZW_TRANSPORT:
B1:00979F EF                MOV      A,R7
B1:0097A0 4E                ORL      A,R6
B1:0097A1 900787            MOV      DPTR,#currentSeqNo
B1:0097A4 12851A            LCALL    ?L?COM000B
B1:0097A7 4A                ORL      A,R2
B1:0097A8 6047              JZ       ?C0267?ZW_TRANSPORT
B1:0097AA E9                MOV      A,R1
B1:0097AB 24B7              ADD      A,#0B7H
B1:0097AD 1285F5            LCALL    ?L?COM0004
B1:0097B0 FF                MOV      R7,A
B1:0097B1 7B01              MOV      R3,#01H
B1:0097B3 7A0A              MOV      R2,#HIGH bFrameType
B1:0097B5 790D              MOV      R1,#LOW bFrameType
B1:0097B7 12D791            LCALL    _ConvertHeaderInfoToFrameType
B1:0097BA 12851B            LCALL    ?L?COM000C
B1:0097BD 1252F2            LCALL    ?L?COM0020
B1:0097C0 5407              ANL      A,#07H
B1:0097C2 FF                MOV      R7,A
;---- Variable 'bFrameSpeed' assigned to Register 'R7' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 241


B1:0097C3 12851B            LCALL    ?L?COM000C
B1:0097C6 24B8              ADD      A,#0B8H
B1:0097C8 1285F5            LCALL    ?L?COM0004
B1:0097CB 540F              ANL      A,#0FH
B1:0097CD FE                MOV      R6,A
B1:0097CE 900A0D            MOV      DPTR,#bFrameType
B1:0097D1 E0                MOVX     A,@DPTR
B1:0097D2 540F              ANL      A,#0FH
B1:0097D4 FD                MOV      R5,A
B1:0097D5 BD0404            CJNE     R5,#04H,?C0268?ZW_TRANSPORT
B1:0097D8 7D40              MOV      R5,#040H
B1:0097DA 8002              SJMP     ?C0269?ZW_TRANSPORT
B1:0097DC         ?C0268?ZW_TRANSPORT:
B1:0097DC 7D00              MOV      R5,#00H
B1:0097DE         ?C0269?ZW_TRANSPORT:
B1:0097DE EE                MOV      A,R6
B1:0097DF 4D                ORL      A,R5
B1:0097E0 FE                MOV      R6,A
B1:0097E1 EF                MOV      A,R7
B1:0097E2 7F00              MOV      R7,#00H
B1:0097E4 B40202            CJNE     A,#02H,?C0270?ZW_TRANSPORT
B1:0097E7 7F80              MOV      R7,#080H
B1:0097E9         ?C0270?ZW_TRANSPORT:
B1:0097E9         ?C0271?ZW_TRANSPORT:
B1:0097E9 EE                MOV      A,R6
B1:0097EA 4F                ORL      A,R7
B1:0097EB 90066D            MOV      DPTR,#currentSeqNoToMatch
B1:0097EE F0                MOVX     @DPTR,A
B1:0097EF 8006              SJMP     ?C0272?ZW_TRANSPORT
B1:0097F1         ?C0267?ZW_TRANSPORT:
B1:0097F1 90066D            MOV      DPTR,#currentSeqNoToMatch
B1:0097F4 74FF              MOV      A,#0FFH
B1:0097F6 F0                MOVX     @DPTR,A
B1:0097F7         ?C0272?ZW_TRANSPORT:
B1:0097F7 129F81            LCALL    ?L?COM000E
B1:0097FA 2405              ADD      A,#05H
B1:0097FC 1285F5            LCALL    ?L?COM0004
B1:0097FF FF                MOV      R7,A
B1:009800 540F              ANL      A,#0FH
B1:009802 24FE              ADD      A,#0FEH
B1:009804 7003              JNZ      $ + 5H
B1:009806 029D5F            LJMP     ?C0340?ZW_TRANSPORT
B1:009809 14                DEC      A
B1:00980A 7003              JNZ      $ + 5H
B1:00980C 029E09            LJMP     ?C0343?ZW_TRANSPORT
B1:00980F 24FE              ADD      A,#0FEH
B1:009811 7002              JNZ      $ + 4H
B1:009813 C130              AJMP     ?C0347?ZW_TRANSPORT
B1:009815 2404              ADD      A,#04H
B1:009817 6002              JZ       $ + 4H
B1:009819 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:00981B         ?C0274?ZW_TRANSPORT:
B1:00981B F181              ACALL    ?L?COM000E
B1:00981D 2407              ADD      A,#07H
B1:00981F 1285F5            LCALL    ?L?COM0004
B1:009822 FE                MOV      R6,A
B1:009823 740A              MOV      A,#0AH
B1:009825 D3                SETB     C
B1:009826 9E                SUBB     A,R6
B1:009827 4002              JC       ?C0275?ZW_TRANSPORT
B1:009829 8029              SJMP     ?C0606?ZW_TRANSPORT
B1:00982B         ?C0275?ZW_TRANSPORT:
B1:00982B EF                MOV      A,R7
B1:00982C 20E702            JB       ACC.7,$ + 5H
B1:00982F 81FF              AJMP     ?C0277?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 242


B1:009831 900787            MOV      DPTR,#currentSeqNo
B1:009834 E0                MOVX     A,@DPTR
B1:009835 4440              ORL      A,#040H
B1:009837 F0                MOVX     @DPTR,A
B1:009838 F181              ACALL    ?L?COM000E
B1:00983A 240A              ADD      A,#0AH
B1:00983C 1285F5            LCALL    ?L?COM0004
B1:00983F C4                SWAP     A
B1:009840 540F              ANL      A,#0FH
B1:009842 900A0E            MOV      DPTR,#hopFirst1
B1:009845 F0                MOVX     @DPTR,A
B1:009846 600C              JZ       ?C0279?ZW_TRANSPORT
B1:009848 E0                MOVX     A,@DPTR
B1:009849 FF                MOV      R7,A
B1:00984A D3                SETB     C
B1:00984B 9404              SUBB     A,#04H
B1:00984D 5005              JNC      ?C0279?ZW_TRANSPORT
B1:00984F 740B              MOV      A,#0BH
B1:009851 9E                SUBB     A,R6
B1:009852 400B              JC       ?C0278?ZW_TRANSPORT
B1:009854         ?C0279?ZW_TRANSPORT:
B1:009854         
B1:009854 12D90D            LCALL    ?L?COM0055
B1:009857 F9                MOV      R1,A
B1:009858 E4                CLR      A
B1:009859 3A                ADDC     A,R2
B1:00985A FA                MOV      R2,A
B1:00985B E4                CLR      A
B1:00985C 02203B            LJMP     ?C?CSTPTR
B1:00985F         ?C0278?ZW_TRANSPORT:
B1:00985F F181              ACALL    ?L?COM000E
B1:009861 2409              ADD      A,#09H
B1:009863 1285F5            LCALL    ?L?COM0004
B1:009866 30E125            JNB      ACC.1,?C0280?ZW_TRANSPORT
B1:009869 30E322            JNB      ACC.3,?C0280?ZW_TRANSPORT
B1:00986C F181              ACALL    ?L?COM000E
B1:00986E 2407              ADD      A,#07H
B1:009870 1285F5            LCALL    ?L?COM0004
B1:009873 FD                MOV      R5,A
B1:009874 EF                MOV      A,R7
B1:009875 240D              ADD      A,#0DH
B1:009877 FF                MOV      R7,A
B1:009878 E4                CLR      A
B1:009879 33                RLC      A
B1:00987A FE                MOV      R6,A
B1:00987B C3                CLR      C
B1:00987C ED                MOV      A,R5
B1:00987D 12533F            LCALL    ?L?COM011E
B1:009880 500C              JNC      ?C0280?ZW_TRANSPORT
B1:009882 F181              ACALL    ?L?COM000E
B1:009884 2409              ADD      A,#09H
B1:009886 1285F5            LCALL    ?L?COM0004
B1:009889 54F7              ANL      A,#0F7H
B1:00988B 12203B            LCALL    ?C?CSTPTR
B1:00988E         ?C0280?ZW_TRANSPORT:
B1:00988E F181              ACALL    ?L?COM000E
B1:009890 2409              ADD      A,#09H
B1:009892 1285F5            LCALL    ?L?COM0004
B1:009895 30E314            JNB      ACC.3,?C0283?ZW_TRANSPORT
B1:009898 F181              ACALL    ?L?COM000E
B1:00989A 240A              ADD      A,#0AH
B1:00989C 1285F5            LCALL    ?L?COM0004
B1:00989F 12BBF5            LCALL    ?L?COM01E2
B1:0098A2 F181              ACALL    ?L?COM000E
B1:0098A4 12B8C2            LCALL    ?L?COM002C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 243


B1:0098A7 12D98E            LCALL    ?L?COM0138
B1:0098AA 8002              SJMP     ?C0284?ZW_TRANSPORT
B1:0098AC         ?C0283?ZW_TRANSPORT:
B1:0098AC 7F00              MOV      R7,#00H
B1:0098AE         ?C0284?ZW_TRANSPORT:
B1:0098AE 7E00              MOV      R6,#00H
B1:0098B0 F181              ACALL    ?L?COM000E
B1:0098B2 240A              ADD      A,#0AH
B1:0098B4 1285F5            LCALL    ?L?COM0004
B1:0098B7 F17B              ACALL    ?L?COM000D
B1:0098B9 12D9BA            LCALL    ?L?COM0088
B1:0098BC 12B8C6            LCALL    ?L?COM002E
B1:0098BF C003              PUSH     AR3
B1:0098C1 C002              PUSH     AR2
B1:0098C3 C001              PUSH     AR1
B1:0098C5 900A07            MOV      DPTR,#pRxFrame
B1:0098C8 125D4E            LCALL    ?L?COM00AF
B1:0098CB 1225A7            LCALL    ?C?PSTPTR
B1:0098CE F181              ACALL    ?L?COM000E
B1:0098D0 2409              ADD      A,#09H
B1:0098D2 1285F5            LCALL    ?L?COM0004
B1:0098D5 30E315            JNB      ACC.3,?C0285?ZW_TRANSPORT
B1:0098D8 F181              ACALL    ?L?COM000E
B1:0098DA 240A              ADD      A,#0AH
B1:0098DC 1285F5            LCALL    ?L?COM0004
B1:0098DF C4                SWAP     A
B1:0098E0 540F              ANL      A,#0FH
B1:0098E2 FF                MOV      R7,A
B1:0098E3 F181              ACALL    ?L?COM000E
B1:0098E5 12B8C2            LCALL    ?L?COM002C
B1:0098E8 12D98E            LCALL    ?L?COM0138
B1:0098EB 8002              SJMP     ?C0286?ZW_TRANSPORT
B1:0098ED         ?C0285?ZW_TRANSPORT:
B1:0098ED 7F00              MOV      R7,#00H
B1:0098EF         ?C0286?ZW_TRANSPORT:
B1:0098EF F181              ACALL    ?L?COM000E
B1:0098F1 240A              ADD      A,#0AH
B1:0098F3 1285F5            LCALL    ?L?COM0004
B1:0098F6 C4                SWAP     A
B1:0098F7 540F              ANL      A,#0FH
B1:0098F9 FE                MOV      R6,A
B1:0098FA F181              ACALL    ?L?COM000E
B1:0098FC 2407              ADD      A,#07H
B1:0098FE 1285F5            LCALL    ?L?COM0004
B1:009901 24F4              ADD      A,#0F4H
B1:009903 C3                CLR      C
B1:009904 9E                SUBB     A,R6
B1:009905 C3                CLR      C
B1:009906 9F                SUBB     A,R7
B1:009907 12DBF4            LCALL    ?L?COM01F2
B1:00990A 1287AB            LCALL    ?L?COM0015
B1:00990D F181              ACALL    ?L?COM000E
B1:00990F 2408              ADD      A,#08H
B1:009911 1285F5            LCALL    ?L?COM0004
B1:009914 12D707            LCALL    ?L?COM0183
B1:009917 6002              JZ       $ + 4H
B1:009919 41C1              AJMP     ?C0287?ZW_TRANSPORT
B1:00991B F181              ACALL    ?L?COM000E
B1:00991D 240A              ADD      A,#0AH
B1:00991F 1285F5            LCALL    ?L?COM0004
B1:009922 540F              ANL      A,#0FH
B1:009924 FF                MOV      R7,A
;---- Variable 'hopFirst4' assigned to Register 'R7' ----
B1:009925 900A0E            MOV      DPTR,#hopFirst1
B1:009928 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 244


B1:009929 6F                XRL      A,R7
B1:00992A 6002              JZ       $ + 4H
B1:00992C 4143              AJMP     ?C0288?ZW_TRANSPORT
B1:00992E F181              ACALL    ?L?COM000E
B1:009930 2405              ADD      A,#05H
B1:009932 1285F5            LCALL    ?L?COM0004
B1:009935 900A07            MOV      DPTR,#pRxFrame
B1:009938 30E60A            JNB      ACC.6,?C0289?ZW_TRANSPORT
B1:00993B 12D910            LCALL    ?L?COM0056
B1:00993E 1285F5            LCALL    ?L?COM0004
B1:009941 440D              ORL      A,#0DH
B1:009943 8008              SJMP     ?C0607?ZW_TRANSPORT
B1:009945         ?C0289?ZW_TRANSPORT:
B1:009945 12D910            LCALL    ?L?COM0056
B1:009948 1285F5            LCALL    ?L?COM0004
B1:00994B 4409              ORL      A,#09H
B1:00994D         
B1:00994D 12203B            LCALL    ?C?CSTPTR
B1:009950         ?C0290?ZW_TRANSPORT:
B1:009950 F181              ACALL    ?L?COM000E
B1:009952 240B              ADD      A,#0BH
B1:009954 F9                MOV      R1,A
B1:009955 E4                CLR      A
B1:009956 3A                ADDC     A,R2
B1:009957 FA                MOV      R2,A
B1:009958 7E00              MOV      R6,#00H
B1:00995A 12B8C8            LCALL    ?L?COM002F
B1:00995D 12DC3F            LCALL    ?L?COM0530
B1:009960 12879D            LCALL    ?L?COM0012
B1:009963 12D90D            LCALL    ?L?COM0055
B1:009966 1285F5            LCALL    ?L?COM0004
B1:009969 30E702            JNB      ACC.7,$ + 5H
B1:00996C 813D              AJMP     ?C0307?ZW_TRANSPORT
B1:00996E F181              ACALL    ?L?COM000E
B1:009970 2405              ADD      A,#05H
B1:009972 1285F5            LCALL    ?L?COM0004
B1:009975 20E702            JB       ACC.7,$ + 5H
B1:009978 813D              AJMP     ?C0307?ZW_TRANSPORT
B1:00997A F181              ACALL    ?L?COM000E
B1:00997C 2409              ADD      A,#09H
B1:00997E 1285F5            LCALL    ?L?COM0004
B1:009981 30E315            JNB      ACC.3,?C0292?ZW_TRANSPORT
B1:009984 F181              ACALL    ?L?COM000E
B1:009986 240A              ADD      A,#0AH
B1:009988 1285F5            LCALL    ?L?COM0004
B1:00998B C4                SWAP     A
B1:00998C 540F              ANL      A,#0FH
B1:00998E FF                MOV      R7,A
B1:00998F F181              ACALL    ?L?COM000E
B1:009991 12B8C2            LCALL    ?L?COM002C
B1:009994 12D98E            LCALL    ?L?COM0138
B1:009997 8002              SJMP     ?C0293?ZW_TRANSPORT
B1:009999         ?C0292?ZW_TRANSPORT:
B1:009999 7F00              MOV      R7,#00H
B1:00999B         ?C0293?ZW_TRANSPORT:
B1:00999B 7E00              MOV      R6,#00H
B1:00999D F181              ACALL    ?L?COM000E
B1:00999F 240A              ADD      A,#0AH
B1:0099A1 1285F5            LCALL    ?L?COM0004
B1:0099A4 F17B              ACALL    ?L?COM000D
B1:0099A6 12D9BA            LCALL    ?L?COM0088
B1:0099A9 12B8C6            LCALL    ?L?COM002E
B1:0099AC 121F7C            LCALL    ?C?CLDPTR
B1:0099AF D3                SETB     C
B1:0099B0 9401              SUBB     A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 245


B1:0099B2 4002              JC       $ + 4H
B1:0099B4 813D              AJMP     ?C0307?ZW_TRANSPORT
B1:0099B6 F181              ACALL    ?L?COM000E
B1:0099B8 2409              ADD      A,#09H
B1:0099BA 1285F5            LCALL    ?L?COM0004
B1:0099BD 30E315            JNB      ACC.3,?C0294?ZW_TRANSPORT
B1:0099C0 F181              ACALL    ?L?COM000E
B1:0099C2 240A              ADD      A,#0AH
B1:0099C4 1285F5            LCALL    ?L?COM0004
B1:0099C7 C4                SWAP     A
B1:0099C8 540F              ANL      A,#0FH
B1:0099CA FF                MOV      R7,A
B1:0099CB F181              ACALL    ?L?COM000E
B1:0099CD 12B8C2            LCALL    ?L?COM002C
B1:0099D0 12D98E            LCALL    ?L?COM0138
B1:0099D3 8002              SJMP     ?C0295?ZW_TRANSPORT
B1:0099D5         ?C0294?ZW_TRANSPORT:
B1:0099D5 7F00              MOV      R7,#00H
B1:0099D7         ?C0295?ZW_TRANSPORT:
B1:0099D7 7E00              MOV      R6,#00H
B1:0099D9 F181              ACALL    ?L?COM000E
B1:0099DB 240A              ADD      A,#0AH
B1:0099DD 1285F5            LCALL    ?L?COM0004
B1:0099E0 F17B              ACALL    ?L?COM000D
B1:0099E2 12D9BA            LCALL    ?L?COM0088
B1:0099E5 12B8C6            LCALL    ?L?COM002E
B1:0099E8 E9                MOV      A,R1
B1:0099E9 2401              ADD      A,#01H
B1:0099EB 1285F5            LCALL    ?L?COM0004
B1:0099EE 6403              XRL      A,#03H
B1:0099F0 6002              JZ       $ + 4H
B1:0099F2 813D              AJMP     ?C0307?ZW_TRANSPORT
B1:0099F4 E550              MOV      A,bNetworkWideInclusion
B1:0099F6 6402              XRL      A,#02H
B1:0099F8 603C              JZ       ?C0296?ZW_TRANSPORT
B1:0099FA F181              ACALL    ?L?COM000E
B1:0099FC 2409              ADD      A,#09H
B1:0099FE 1285F5            LCALL    ?L?COM0004
B1:009A01 30E315            JNB      ACC.3,?C0297?ZW_TRANSPORT
B1:009A04 F181              ACALL    ?L?COM000E
B1:009A06 240A              ADD      A,#0AH
B1:009A08 1285F5            LCALL    ?L?COM0004
B1:009A0B C4                SWAP     A
B1:009A0C 540F              ANL      A,#0FH
B1:009A0E FF                MOV      R7,A
B1:009A0F F181              ACALL    ?L?COM000E
B1:009A11 12B8C2            LCALL    ?L?COM002C
B1:009A14 12D98E            LCALL    ?L?COM0138
B1:009A17 8002              SJMP     ?C0298?ZW_TRANSPORT
B1:009A19         ?C0297?ZW_TRANSPORT:
B1:009A19 7F00              MOV      R7,#00H
B1:009A1B         ?C0298?ZW_TRANSPORT:
B1:009A1B 7E00              MOV      R6,#00H
B1:009A1D F181              ACALL    ?L?COM000E
B1:009A1F 240A              ADD      A,#0AH
B1:009A21 1285F5            LCALL    ?L?COM0004
B1:009A24 F17B              ACALL    ?L?COM000D
B1:009A26 12D9BA            LCALL    ?L?COM0088
B1:009A29 12B8C6            LCALL    ?L?COM002E
B1:009A2C 125D51            LCALL    ?L?COM00B0
B1:009A2F 1287B9            LCALL    ?L?COM003F
B1:009A32 7B01              MOV      R3,#01H
B1:009A34 8006              SJMP     ?C0608?ZW_TRANSPORT
B1:009A36         ?C0296?ZW_TRANSPORT:
B1:009A36 12DA72            LCALL    ?L?COM0343
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 246


B1:009A39 1287B9            LCALL    ?L?COM003F
B1:009A3C         
B1:009A3C 12FEA2            LCALL    ?L?COM04C8
B1:009A3F         ?C0299?ZW_TRANSPORT:
B1:009A3F D209              SETB     inclusionHomeIDActive
B1:009A41 813D              AJMP     ?C0307?ZW_TRANSPORT
B1:009A43         ?C0288?ZW_TRANSPORT:
B1:009A43 F181              ACALL    ?L?COM000E
B1:009A45 240A              ADD      A,#0AH
B1:009A47 1285F5            LCALL    ?L?COM0004
B1:009A4A 540F              ANL      A,#0FH
B1:009A4C 640F              XRL      A,#0FH
B1:009A4E 6002              JZ       $ + 4H
B1:009A50 813D              AJMP     ?C0307?ZW_TRANSPORT
B1:009A52 F181              ACALL    ?L?COM000E
B1:009A54 2405              ADD      A,#05H
B1:009A56 1285F5            LCALL    ?L?COM0004
B1:009A59 30E60B            JNB      ACC.6,?C0302?ZW_TRANSPORT
B1:009A5C 12D90D            LCALL    ?L?COM0055
B1:009A5F 1285F5            LCALL    ?L?COM0004
B1:009A62 4404              ORL      A,#04H
B1:009A64 12203B            LCALL    ?C?CSTPTR
B1:009A67         ?C0302?ZW_TRANSPORT:
B1:009A67 12D9C5            LCALL    CheckSeqNo
B1:009A6A 5021              JNC      ?C0303?ZW_TRANSPORT
B1:009A6C F181              ACALL    ?L?COM000E
B1:009A6E 240A              ADD      A,#0AH
B1:009A70 1285F5            LCALL    ?L?COM0004
B1:009A73 C4                SWAP     A
B1:009A74 540F              ANL      A,#0FH
B1:009A76 FF                MOV      R7,A
B1:009A77 900A11            MOV      DPTR,#fr
B1:009A7A 122552            LCALL    ?C?PLDXDATA
B1:009A7D 12D7D5            LCALL    _RouteMatchesActive
B1:009A80 500B              JNC      ?C0303?ZW_TRANSPORT
B1:009A82 12D90D            LCALL    ?L?COM0055
B1:009A85 1285F5            LCALL    ?L?COM0004
B1:009A88 4401              ORL      A,#01H
B1:009A8A 12203B            LCALL    ?C?CSTPTR
B1:009A8D         ?C0303?ZW_TRANSPORT:
B1:009A8D F181              ACALL    ?L?COM000E
B1:009A8F 2409              ADD      A,#09H
B1:009A91 1285F5            LCALL    ?L?COM0004
B1:009A94 FF                MOV      R7,A
B1:009A95 30E10A            JNB      ACC.1,?C0304?ZW_TRANSPORT
B1:009A98 12D90D            LCALL    ?L?COM0055
B1:009A9B 1285F5            LCALL    ?L?COM0004
B1:009A9E 4420              ORL      A,#020H
B1:009AA0 800C              SJMP     ?C0609?ZW_TRANSPORT
B1:009AA2         ?C0304?ZW_TRANSPORT:
B1:009AA2 EF                MOV      A,R7
B1:009AA3 30E20B            JNB      ACC.2,?C0305?ZW_TRANSPORT
B1:009AA6 12D90D            LCALL    ?L?COM0055
B1:009AA9 1285F5            LCALL    ?L?COM0004
B1:009AAC 4440              ORL      A,#040H
B1:009AAE         
B1:009AAE 12203B            LCALL    ?C?CSTPTR
B1:009AB1         ?C0305?ZW_TRANSPORT:
B1:009AB1 F181              ACALL    ?L?COM000E
B1:009AB3 240B              ADD      A,#0BH
B1:009AB5 1285F5            LCALL    ?L?COM0004
B1:009AB8 900A07            MOV      DPTR,#pRxFrame
B1:009ABB 12BBFC            LCALL    ?L?COM0120
B1:009ABE EF                MOV      A,R7
B1:009ABF 61CC              AJMP     ?C0612?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 247


B1:009AC1         ?C0287?ZW_TRANSPORT:
B1:009AC1 F181              ACALL    ?L?COM000E
B1:009AC3 240A              ADD      A,#0AH
B1:009AC5 1285F5            LCALL    ?L?COM0004
B1:009AC8 FF                MOV      R7,A
B1:009AC9 540F              ANL      A,#0FH
;---- Variable 'hopFirst2' assigned to Register 'R5' ----
B1:009ACB FD                MOV      R5,A
B1:009ACC EF                MOV      A,R7
B1:009ACD C4                SWAP     A
B1:009ACE 540F              ANL      A,#0FH
;---- Variable 'hopFirst3' assigned to Register 'R4' ----
B1:009AD0 FC                MOV      R4,A
B1:009AD1 ED                MOV      A,R5
B1:009AD2 C3                CLR      C
B1:009AD3 9C                SUBB     A,R4
B1:009AD4 4002              JC       $ + 4H
B1:009AD6 61D1              AJMP     ?C0308?ZW_TRANSPORT
B1:009AD8 F181              ACALL    ?L?COM000E
B1:009ADA 128EAB            LCALL    ?L?COM012F
B1:009ADD FA                MOV      R2,A
B1:009ADE 121F7C            LCALL    ?C?CLDPTR
B1:009AE1 12D707            LCALL    ?L?COM0183
B1:009AE4 6002              JZ       $ + 4H
B1:009AE6 61D1              AJMP     ?C0308?ZW_TRANSPORT
B1:009AE8 F181              ACALL    ?L?COM000E
B1:009AEA 2409              ADD      A,#09H
B1:009AEC 1285F5            LCALL    ?L?COM0004
B1:009AEF 30E065            JNB      ACC.0,?C0309?ZW_TRANSPORT
B1:009AF2 12D9C5            LCALL    CheckSeqNo
B1:009AF5 5011              JNC      ?C0310?ZW_TRANSPORT
B1:009AF7 12D90D            LCALL    ?L?COM0055
B1:009AFA 1285F5            LCALL    ?L?COM0004
B1:009AFD 4403              ORL      A,#03H
B1:009AFF 12203B            LCALL    ?C?CSTPTR
B1:009B02 900679            MOV      DPTR,#sACK
B1:009B05 7405              MOV      A,#05H
B1:009B07 F0                MOVX     @DPTR,A
B1:009B08         ?C0310?ZW_TRANSPORT:
B1:009B08 EC                MOV      A,R4
B1:009B09 14                DEC      A
B1:009B0A 900A11            MOV      DPTR,#fr
B1:009B0D B50505            CJNE     A,AR5,?C0311?ZW_TRANSPORT
B1:009B10 129549            LCALL    ?L?COM0058
B1:009B13 800B              SJMP     ?C0604?ZW_TRANSPORT
B1:009B15         ?C0311?ZW_TRANSPORT:
B1:009B15 122552            LCALL    ?C?PLDXDATA
B1:009B18 E9                MOV      A,R1
B1:009B19 128EAB            LCALL    ?L?COM012F
B1:009B1C FA                MOV      R2,A
B1:009B1D E9                MOV      A,R1
B1:009B1E 2401              ADD      A,#01H
B1:009B20         
B1:009B20 1285F5            LCALL    ?L?COM0004
B1:009B23 1287A1            LCALL    ?L?COM0013
B1:009B26         ?C0312?ZW_TRANSPORT:
B1:009B26 ED                MOV      A,R5
B1:009B27 6002              JZ       $ + 4H
B1:009B29 61AD              AJMP     ?C0314?ZW_TRANSPORT
B1:009B2B F181              ACALL    ?L?COM000E
B1:009B2D 2409              ADD      A,#09H
B1:009B2F 1285F5            LCALL    ?L?COM0004
B1:009B32 30E378            JNB      ACC.3,?C0314?ZW_TRANSPORT
B1:009B35 F181              ACALL    ?L?COM000E
B1:009B37 240A              ADD      A,#0AH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 248


B1:009B39 1285F5            LCALL    ?L?COM0004
B1:009B3C 12BBF5            LCALL    ?L?COM01E2
B1:009B3F F181              ACALL    ?L?COM000E
B1:009B41 12B8C2            LCALL    ?L?COM002C
B1:009B44 121F7C            LCALL    ?C?CLDPTR
B1:009B47 540F              ANL      A,#0FH
B1:009B49 7062              JNZ      ?C0314?ZW_TRANSPORT
B1:009B4B E9                MOV      A,R1
B1:009B4C 2401              ADD      A,#01H
B1:009B4E 1285F5            LCALL    ?L?COM0004
B1:009B51 5418              ANL      A,#018H
B1:009B53 6058              JZ       ?C0314?ZW_TRANSPORT
B1:009B55 804B              SJMP     ?C0611?ZW_TRANSPORT
B1:009B57         ?C0309?ZW_TRANSPORT:
B1:009B57 ED                MOV      A,R5
B1:009B58 900A11            MOV      DPTR,#fr
B1:009B5B 7008              JNZ      ?C0315?ZW_TRANSPORT
B1:009B5D 129549            LCALL    ?L?COM0058
B1:009B60 F9                MOV      R1,A
B1:009B61 E4                CLR      A
B1:009B62 3A                ADDC     A,R2
B1:009B63 800B              SJMP     ?C0605?ZW_TRANSPORT
B1:009B65         ?C0315?ZW_TRANSPORT:
B1:009B65 122552            LCALL    ?C?PLDXDATA
B1:009B68 E9                MOV      A,R1
B1:009B69 128EAB            LCALL    ?L?COM012F
B1:009B6C FA                MOV      R2,A
B1:009B6D 12DC3F            LCALL    ?L?COM0530
B1:009B70         
B1:009B70 12879D            LCALL    ?L?COM0012
B1:009B73         ?C0316?ZW_TRANSPORT:
B1:009B73 EC                MOV      A,R4
B1:009B74 14                DEC      A
B1:009B75 6D                XRL      A,R5
B1:009B76 7035              JNZ      ?C0314?ZW_TRANSPORT
B1:009B78 F181              ACALL    ?L?COM000E
B1:009B7A 2409              ADD      A,#09H
B1:009B7C 1285F5            LCALL    ?L?COM0004
B1:009B7F 30E32B            JNB      ACC.3,?C0314?ZW_TRANSPORT
B1:009B82 F181              ACALL    ?L?COM000E
B1:009B84 240A              ADD      A,#0AH
B1:009B86 1285F5            LCALL    ?L?COM0004
B1:009B89 12BBF5            LCALL    ?L?COM01E2
B1:009B8C F181              ACALL    ?L?COM000E
B1:009B8E 12B8C2            LCALL    ?L?COM002C
B1:009B91 121F7C            LCALL    ?C?CLDPTR
B1:009B94 540F              ANL      A,#0FH
B1:009B96 7015              JNZ      ?C0314?ZW_TRANSPORT
B1:009B98 E9                MOV      A,R1
B1:009B99 2401              ADD      A,#01H
B1:009B9B 1285F5            LCALL    ?L?COM0004
B1:009B9E 5460              ANL      A,#060H
B1:009BA0 600B              JZ       ?C0314?ZW_TRANSPORT
B1:009BA2         
B1:009BA2 12D90D            LCALL    ?L?COM0055
B1:009BA5 1285F5            LCALL    ?L?COM0004
B1:009BA8 4404              ORL      A,#04H
B1:009BAA 12203B            LCALL    ?C?CSTPTR
B1:009BAD         ?C0314?ZW_TRANSPORT:
B1:009BAD F181              ACALL    ?L?COM000E
B1:009BAF 2405              ADD      A,#05H
B1:009BB1 1285F5            LCALL    ?L?COM0004
B1:009BB4 900A07            MOV      DPTR,#pRxFrame
B1:009BB7 30E60A            JNB      ACC.6,?C0318?ZW_TRANSPORT
B1:009BBA 12D910            LCALL    ?L?COM0056
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 249


B1:009BBD 1285F5            LCALL    ?L?COM0004
B1:009BC0 4414              ORL      A,#014H
B1:009BC2         
B1:009BC2 8008              SJMP     ?C0612?ZW_TRANSPORT
B1:009BC4         ?C0318?ZW_TRANSPORT:
B1:009BC4 12D910            LCALL    ?L?COM0056
B1:009BC7 1285F5            LCALL    ?L?COM0004
B1:009BCA 4410              ORL      A,#010H
B1:009BCC         
B1:009BCC 12203B            LCALL    ?C?CSTPTR
B1:009BCF 806C              SJMP     ?C0307?ZW_TRANSPORT
B1:009BD1         ?C0308?ZW_TRANSPORT:
B1:009BD1 F181              ACALL    ?L?COM000E
B1:009BD3 240A              ADD      A,#0AH
B1:009BD5 1285F5            LCALL    ?L?COM0004
B1:009BD8 540F              ANL      A,#0FH
;---- Variable 'hopFirst' assigned to Register 'R5' ----
B1:009BDA FD                MOV      R5,A
B1:009BDB 12D9C5            LCALL    CheckSeqNo
B1:009BDE 505D              JNC      ?C0307?ZW_TRANSPORT
B1:009BE0 F181              ACALL    ?L?COM000E
B1:009BE2 2409              ADD      A,#09H
B1:009BE4 1285F5            LCALL    ?L?COM0004
B1:009BE7 30E026            JNB      ACC.0,?C0322?ZW_TRANSPORT
B1:009BEA ED                MOV      A,R5
B1:009BEB 2402              ADD      A,#02H
B1:009BED 540F              ANL      A,#0FH
B1:009BEF FD                MOV      R5,A
B1:009BF0 F181              ACALL    ?L?COM000E
B1:009BF2 240A              ADD      A,#0AH
B1:009BF4 1285F5            LCALL    ?L?COM0004
B1:009BF7 C4                SWAP     A
B1:009BF8 540F              ANL      A,#0FH
B1:009BFA FF                MOV      R7,A
B1:009BFB ED                MOV      A,R5
B1:009BFC C3                CLR      C
B1:009BFD 9F                SUBB     A,R7
B1:009BFE 503D              JNC      ?C0307?ZW_TRANSPORT
B1:009C00 F181              ACALL    ?L?COM000E
B1:009C02 128EAB            LCALL    ?L?COM012F
B1:009C05 FA                MOV      R2,A
B1:009C06 121F7C            LCALL    ?C?CLDPTR
B1:009C09 12D707            LCALL    ?L?COM0183
B1:009C0C 702F              JNZ      ?C0307?ZW_TRANSPORT
B1:009C0E 8024              SJMP     ?C0613?ZW_TRANSPORT
B1:009C10         ?C0322?ZW_TRANSPORT:
B1:009C10 ED                MOV      A,R5
B1:009C11 C3                CLR      C
B1:009C12 9402              SUBB     A,#02H
B1:009C14 4027              JC       ?C0307?ZW_TRANSPORT
B1:009C16 F181              ACALL    ?L?COM000E
B1:009C18 240B              ADD      A,#0BH
B1:009C1A F9                MOV      R1,A
B1:009C1B E4                CLR      A
B1:009C1C 3A                ADDC     A,R2
B1:009C1D FA                MOV      R2,A
B1:009C1E ED                MOV      A,R5
B1:009C1F 24FE              ADD      A,#0FEH
B1:009C21 FF                MOV      R7,A
B1:009C22 E4                CLR      A
B1:009C23 34FF              ADDC     A,#0FFH
B1:009C25 FE                MOV      R6,A
B1:009C26 12E59B            LCALL    ?L?COM007A
B1:009C29 121F7C            LCALL    ?C?CLDPTR
B1:009C2C FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 250


B1:009C2D 901221            MOV      DPTR,#nodeID
B1:009C30 E0                MOVX     A,@DPTR
B1:009C31 B50709            CJNE     A,AR7,?C0307?ZW_TRANSPORT
B1:009C34         
B1:009C34 12D90D            LCALL    ?L?COM0055
B1:009C37 1285F5            LCALL    ?L?COM0004
B1:009C3A 12FE85            LCALL    ?L?COM040A
B1:009C3D         ?C0307?ZW_TRANSPORT:
B1:009C3D F181              ACALL    ?L?COM000E
B1:009C3F 2404              ADD      A,#04H
B1:009C41 1285F5            LCALL    ?L?COM0004
B1:009C44 12D707            LCALL    ?L?COM0183
B1:009C47 6033              JZ       ?C0328?ZW_TRANSPORT
B1:009C49 12851B            LCALL    ?L?COM000C
B1:009C4C 4A                ORL      A,R2
B1:009C4D 7002              JNZ      $ + 4H
B1:009C4F C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009C51 12851B            LCALL    ?L?COM000C
B1:009C54 1256E7            LCALL    ?L?COM018E
B1:009C57 126E5F            LCALL    ?L?COM0281
B1:009C5A 900A11            MOV      DPTR,#fr
B1:009C5D 122552            LCALL    ?C?PLDXDATA
B1:009C60 12DA6B            LCALL    ?L?COM016E
B1:009C63 6002              JZ       $ + 4H
B1:009C65 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009C67 12851B            LCALL    ?L?COM000C
B1:009C6A 24B6              ADD      A,#0B6H
B1:009C6C 1285F5            LCALL    ?L?COM0004
B1:009C6F FF                MOV      R7,A
B1:009C70 F181              ACALL    ?L?COM000E
B1:009C72 2404              ADD      A,#04H
B1:009C74 1285F5            LCALL    ?L?COM0004
B1:009C77 6F                XRL      A,R7
B1:009C78 6002              JZ       $ + 4H
B1:009C7A C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009C7C         ?C0328?ZW_TRANSPORT:
B1:009C7C 12D9C5            LCALL    CheckSeqNo
B1:009C7F 4002              JC       $ + 4H
B1:009C81 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009C83 F181              ACALL    ?L?COM000E
B1:009C85 240A              ADD      A,#0AH
B1:009C87 1285F5            LCALL    ?L?COM0004
B1:009C8A 540F              ANL      A,#0FH
B1:009C8C FF                MOV      R7,A
;---- Variable 'hopNext' assigned to Register 'R7' ----
B1:009C8D 12851B            LCALL    ?L?COM000C
B1:009C90 4A                ORL      A,R2
B1:009C91 7002              JNZ      $ + 4H
B1:009C93 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009C95 E9                MOV      A,R1
B1:009C96 24BA              ADD      A,#0BAH
B1:009C98 1285F5            LCALL    ?L?COM0004
B1:009C9B FE                MOV      R6,A
B1:009C9C F181              ACALL    ?L?COM000E
B1:009C9E 2408              ADD      A,#08H
B1:009CA0 1285F5            LCALL    ?L?COM0004
B1:009CA3 6E                XRL      A,R6
B1:009CA4 6002              JZ       $ + 4H
B1:009CA6 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009CA8 F181              ACALL    ?L?COM000E
B1:009CAA 2409              ADD      A,#09H
B1:009CAC 1285F5            LCALL    ?L?COM0004
B1:009CAF FE                MOV      R6,A
B1:009CB0 30E03A            JNB      ACC.0,?C0331?ZW_TRANSPORT
B1:009CB3 12851B            LCALL    ?L?COM000C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 251


B1:009CB6 24BB              ADD      A,#0BBH
B1:009CB8 1285F5            LCALL    ?L?COM0004
B1:009CBB 5406              ANL      A,#06H
B1:009CBD FD                MOV      R5,A
B1:009CBE EE                MOV      A,R6
B1:009CBF 5406              ANL      A,#06H
B1:009CC1 6D                XRL      A,R5
B1:009CC2 6002              JZ       $ + 4H
B1:009CC4 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009CC6 F181              ACALL    ?L?COM000E
B1:009CC8 240A              ADD      A,#0AH
B1:009CCA 1285F5            LCALL    ?L?COM0004
B1:009CCD FE                MOV      R6,A
B1:009CCE C4                SWAP     A
B1:009CCF 540F              ANL      A,#0FH
B1:009CD1 24FE              ADD      A,#0FEH
B1:009CD3 540F              ANL      A,#0FH
B1:009CD5 6F                XRL      A,R7
B1:009CD6 6002              JZ       $ + 4H
B1:009CD8 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009CDA 12D90D            LCALL    ?L?COM0055
B1:009CDD 1285F5            LCALL    ?L?COM0004
B1:009CE0 4403              ORL      A,#03H
B1:009CE2 12203B            LCALL    ?C?CSTPTR
B1:009CE5 900679            MOV      DPTR,#sACK
B1:009CE8 7403              MOV      A,#03H
B1:009CEA F0                MOVX     @DPTR,A
B1:009CEB C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009CED         ?C0331?ZW_TRANSPORT:
B1:009CED EF                MOV      A,R7
B1:009CEE 6401              XRL      A,#01H
B1:009CF0 6002              JZ       $ + 4H
B1:009CF2 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009CF4 12D90D            LCALL    ?L?COM0055
B1:009CF7 1285F5            LCALL    ?L?COM0004
B1:009CFA 12FE85            LCALL    ?L?COM040A
B1:009CFD C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009CFF         ?C0277?ZW_TRANSPORT:
B1:009CFF F181              ACALL    ?L?COM000E
B1:009D01 2408              ADD      A,#08H
B1:009D03 1285F5            LCALL    ?L?COM0004
B1:009D06 12D707            LCALL    ?L?COM0183
B1:009D09 6006              JZ       ?C0338?ZW_TRANSPORT
B1:009D0B EF                MOV      A,R7
B1:009D0C F4                CPL      A
B1:009D0D 6002              JZ       $ + 4H
B1:009D0F C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009D11         ?C0338?ZW_TRANSPORT:
B1:009D11 12D90D            LCALL    ?L?COM0055
B1:009D14 1285F5            LCALL    ?L?COM0004
B1:009D17 4401              ORL      A,#01H
B1:009D19 12203B            LCALL    ?C?CSTPTR
B1:009D1C F181              ACALL    ?L?COM000E
B1:009D1E 2404              ADD      A,#04H
B1:009D20 1285F5            LCALL    ?L?COM0004
B1:009D23 1287A1            LCALL    ?L?COM0013
B1:009D26 F181              ACALL    ?L?COM000E
B1:009D28 126E30            LCALL    ?L?COM01DE
B1:009D2B C003              PUSH     AR3
B1:009D2D C002              PUSH     AR2
B1:009D2F C001              PUSH     AR1
B1:009D31 900A07            MOV      DPTR,#pRxFrame
B1:009D34 125D4E            LCALL    ?L?COM00AF
B1:009D37 1225A7            LCALL    ?C?PSTPTR
B1:009D3A F181              ACALL    ?L?COM000E
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 252


B1:009D3C 2407              ADD      A,#07H
B1:009D3E 1285F5            LCALL    ?L?COM0004
B1:009D41 24F6              ADD      A,#0F6H
B1:009D43 12DBF4            LCALL    ?L?COM01F2
B1:009D46 1287AB            LCALL    ?L?COM0015
B1:009D49 F181              ACALL    ?L?COM000E
B1:009D4B 2405              ADD      A,#05H
B1:009D4D 1285F5            LCALL    ?L?COM0004
B1:009D50 20E602            JB       ACC.6,$ + 5H
B1:009D53 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009D55 12D90D            LCALL    ?L?COM0055
B1:009D58 1285F5            LCALL    ?L?COM0004
B1:009D5B 4404              ORL      A,#04H
B1:009D5D C12B              AJMP     ?C0615?ZW_TRANSPORT
B1:009D5F         ?C0340?ZW_TRANSPORT:
B1:009D5F F181              ACALL    ?L?COM000E
B1:009D61 2408              ADD      A,#08H
B1:009D63 1285F5            LCALL    ?L?COM0004
B1:009D66 FF                MOV      R7,A
B1:009D67 54E0              ANL      A,#0E0H
B1:009D69 FD                MOV      R5,A
B1:009D6A 901221            MOV      DPTR,#nodeID
B1:009D6D E0                MOVX     A,@DPTR
B1:009D6E D3                SETB     C
B1:009D6F 9D                SUBB     A,R5
B1:009D70 5002              JNC      $ + 4H
B1:009D72 C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009D74 EF                MOV      A,R7
B1:009D75 541F              ANL      A,#01FH
B1:009D77 75F008            MOV      B,#08H
B1:009D7A A4                MUL      AB
B1:009D7B 7C00              MOV      R4,#00H
B1:009D7D 2D                ADD      A,R5
B1:009D7E FF                MOV      R7,A
B1:009D7F EC                MOV      A,R4
B1:009D80 35F0              ADDC     A,B
B1:009D82 FE                MOV      R6,A
B1:009D83 E0                MOVX     A,@DPTR
B1:009D84 D3                SETB     C
B1:009D85 12533F            LCALL    ?L?COM011E
B1:009D88 4002              JC       $ + 4H
B1:009D8A C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009D8C F181              ACALL    ?L?COM000E
B1:009D8E 2408              ADD      A,#08H
B1:009D90 1285F5            LCALL    ?L?COM0004
B1:009D93 54E0              ANL      A,#0E0H
B1:009D95 FF                MOV      R7,A
B1:009D96 901221            MOV      DPTR,#nodeID
B1:009D99 E0                MOVX     A,@DPTR
B1:009D9A C3                CLR      C
B1:009D9B 9F                SUBB     A,R7
B1:009D9C 14                DEC      A
B1:009D9D FF                MOV      R7,A
;---- Variable 'bBit' assigned to Register 'R7' ----
B1:009D9E F181              ACALL    ?L?COM000E
B1:009DA0 126E30            LCALL    ?L?COM01DE
B1:009DA3 EF                MOV      A,R7
B1:009DA4 13                RRC      A
B1:009DA5 13                RRC      A
B1:009DA6 13                RRC      A
B1:009DA7 541F              ANL      A,#01FH
B1:009DA9 29                ADD      A,R1
B1:009DAA 12705E            LCALL    ?L?COM0533
B1:009DAD FE                MOV      R6,A
B1:009DAE 126C9F            LCALL    ?L?COM0090
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 253


B1:009DB1 08                INC      R0
B1:009DB2 8002              SJMP     ?C0574?ZW_TRANSPORT
B1:009DB4         ?C0573?ZW_TRANSPORT:
B1:009DB4 C3                CLR      C
B1:009DB5 33                RLC      A
B1:009DB6         ?C0574?ZW_TRANSPORT:
B1:009DB6 D8FC              DJNZ     R0,?C0573?ZW_TRANSPORT
B1:009DB8 5E                ANL      A,R6
B1:009DB9 7002              JNZ      $ + 4H
B1:009DBB C156              AJMP     ?C0257?ZW_TRANSPORT
B1:009DBD 12D90D            LCALL    ?L?COM0055
B1:009DC0 1285F5            LCALL    ?L?COM0004
B1:009DC3 4401              ORL      A,#01H
B1:009DC5 12203B            LCALL    ?C?CSTPTR
B1:009DC8 F181              ACALL    ?L?COM000E
B1:009DCA 2408              ADD      A,#08H
B1:009DCC 1285F5            LCALL    ?L?COM0004
B1:009DCF 541F              ANL      A,#01FH
B1:009DD1 FF                MOV      R7,A
B1:009DD2 7E00              MOV      R6,#00H
B1:009DD4 F181              ACALL    ?L?COM000E
B1:009DD6 2409              ADD      A,#09H
B1:009DD8 12B8C4            LCALL    ?L?COM002D
B1:009DDB C003              PUSH     AR3
B1:009DDD C002              PUSH     AR2
B1:009DDF C001              PUSH     AR1
B1:009DE1 900A07            MOV      DPTR,#pRxFrame
B1:009DE4 125D4E            LCALL    ?L?COM00AF
B1:009DE7 1225A7            LCALL    ?C?PSTPTR
B1:009DEA F181              ACALL    ?L?COM000E
B1:009DEC 2408              ADD      A,#08H
B1:009DEE 1285F5            LCALL    ?L?COM0004
B1:009DF1 541F              ANL      A,#01FH
B1:009DF3 FF                MOV      R7,A
B1:009DF4 F181              ACALL    ?L?COM000E
B1:009DF6 2407              ADD      A,#07H
B1:009DF8 1285F5            LCALL    ?L?COM0004
B1:009DFB 24F6              ADD      A,#0F6H
B1:009DFD C3                CLR      C
B1:009DFE 9F                SUBB     A,R7
B1:009DFF 12DBF4            LCALL    ?L?COM01F2
B1:009E02 F9                MOV      R1,A
B1:009E03 E4                CLR      A
B1:009E04 3A                ADDC     A,R2
B1:009E05 FA                MOV      R2,A
B1:009E06 EF                MOV      A,R7
B1:009E07         
B1:009E07 8022              SJMP     ?C0615?ZW_TRANSPORT
B1:009E09         ?C0343?ZW_TRANSPORT:
B1:009E09 12FDE2            LCALL    ?L?COM058D
B1:009E0C 6009              JZ       ?C0345?ZW_TRANSPORT
B1:009E0E 90066D            MOV      DPTR,#currentSeqNoToMatch
B1:009E11 E0                MOVX     A,@DPTR
B1:009E12 54BF              ANL      A,#0BFH
B1:009E14 6F                XRL      A,R7
B1:009E15 703F              JNZ      ?C0257?ZW_TRANSPORT
B1:009E17         ?C0345?ZW_TRANSPORT:
B1:009E17 F181              ACALL    ?L?COM000E
B1:009E19 2408              ADD      A,#08H
B1:009E1B 1285F5            LCALL    ?L?COM0004
B1:009E1E 12D707            LCALL    ?L?COM0183
B1:009E21 7033              JNZ      ?C0257?ZW_TRANSPORT
B1:009E23 12D90D            LCALL    ?L?COM0055
B1:009E26 1285F5            LCALL    ?L?COM0004
B1:009E29 4403              ORL      A,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 254


B1:009E2B         
B1:009E2B 12203B            LCALL    ?C?CSTPTR
B1:009E2E 8026              SJMP     ?C0257?ZW_TRANSPORT
B1:009E30         ?C0347?ZW_TRANSPORT:
B1:009E30 900768            MOV      DPTR,#myFrame
B1:009E33 E0                MOVX     A,@DPTR
B1:009E34 FF                MOV      R7,A
B1:009E35 C007              PUSH     AR7
B1:009E37 900A0A            MOV      DPTR,#pRssiArray
B1:009E3A 122552            LCALL    ?C?PLDXDATA
B1:009E3D 900A5E            MOV      DPTR,#?_IsMyExploreFrame?BYTE+03H
B1:009E40 122572            LCALL    ?C?PSTXDATA
B1:009E43 900A07            MOV      DPTR,#pRxFrame
B1:009E46 122552            LCALL    ?C?PLDXDATA
B1:009E49 121BDD            LCALL    ?INTERBANK_TABLE?_IsMyExploreFrame
B1:009E4C E4                CLR      A
B1:009E4D 33                RLC      A
B1:009E4E FE                MOV      R6,A
B1:009E4F D0E0              POP      ACC
B1:009E51 4E                ORL      A,R6
B1:009E52 900768            MOV      DPTR,#myFrame
B1:009E55 F0                MOVX     @DPTR,A
B1:009E56         ?C0257?ZW_TRANSPORT:
B1:009E56 F181              ACALL    ?L?COM000E
B1:009E58 2405              ADD      A,#05H
B1:009E5A 1285F5            LCALL    ?L?COM0004
B1:009E5D FF                MOV      R7,A
B1:009E5E 540F              ANL      A,#0FH
B1:009E60 6401              XRL      A,#01H
B1:009E62 6002              JZ       $ + 4H
B1:009E64 E16A              AJMP     ?C0348?ZW_TRANSPORT
B1:009E66 EF                MOV      A,R7
B1:009E67 30E76C            JNB      ACC.7,?C0349?ZW_TRANSPORT
B1:009E6A F181              ACALL    ?L?COM000E
B1:009E6C 2409              ADD      A,#09H
B1:009E6E 1285F5            LCALL    ?L?COM0004
B1:009E71 30E314            JNB      ACC.3,?C0350?ZW_TRANSPORT
B1:009E74 F181              ACALL    ?L?COM000E
B1:009E76 240A              ADD      A,#0AH
B1:009E78 1285F5            LCALL    ?L?COM0004
B1:009E7B 12BBF5            LCALL    ?L?COM01E2
B1:009E7E F181              ACALL    ?L?COM000E
B1:009E80 12B8C2            LCALL    ?L?COM002C
B1:009E83 12D98E            LCALL    ?L?COM0138
B1:009E86 8002              SJMP     ?C0351?ZW_TRANSPORT
B1:009E88         ?C0350?ZW_TRANSPORT:
B1:009E88 7F00              MOV      R7,#00H
B1:009E8A         ?C0351?ZW_TRANSPORT:
B1:009E8A 7E00              MOV      R6,#00H
B1:009E8C F181              ACALL    ?L?COM000E
B1:009E8E 240A              ADD      A,#0AH
B1:009E90 1285F5            LCALL    ?L?COM0004
B1:009E93 F17B              ACALL    ?L?COM000D
B1:009E95 12D9BA            LCALL    ?L?COM0088
B1:009E98 12B8C6            LCALL    ?L?COM002E
B1:009E9B 121F7C            LCALL    ?C?CLDPTR
B1:009E9E 12DC51            LCALL    ?L?COM046F
B1:009EA1 2409              ADD      A,#09H
B1:009EA3 1285F5            LCALL    ?L?COM0004
B1:009EA6 30E315            JNB      ACC.3,?C0352?ZW_TRANSPORT
B1:009EA9 F181              ACALL    ?L?COM000E
B1:009EAB 240A              ADD      A,#0AH
B1:009EAD 1285F5            LCALL    ?L?COM0004
B1:009EB0 C4                SWAP     A
B1:009EB1 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 255


B1:009EB3 FF                MOV      R7,A
B1:009EB4 F181              ACALL    ?L?COM000E
B1:009EB6 12B8C2            LCALL    ?L?COM002C
B1:009EB9 12D98E            LCALL    ?L?COM0138
B1:009EBC 8002              SJMP     ?C0353?ZW_TRANSPORT
B1:009EBE         ?C0352?ZW_TRANSPORT:
B1:009EBE 7F00              MOV      R7,#00H
B1:009EC0         ?C0353?ZW_TRANSPORT:
B1:009EC0 7E00              MOV      R6,#00H
B1:009EC2 F181              ACALL    ?L?COM000E
B1:009EC4 240A              ADD      A,#0AH
B1:009EC6 1285F5            LCALL    ?L?COM0004
B1:009EC9 F17B              ACALL    ?L?COM000D
B1:009ECB 12D9BA            LCALL    ?L?COM0088
B1:009ECE 3A                ADDC     A,R2
B1:009ECF FA                MOV      R2,A
B1:009ED0 E9                MOV      A,R1
B1:009ED1 2F                ADD      A,R7
B1:009ED2 F9                MOV      R1,A
B1:009ED3 EE                MOV      A,R6
B1:009ED4 800E              SJMP     ?C0616?ZW_TRANSPORT
B1:009ED6         ?C0349?ZW_TRANSPORT:
B1:009ED6 F181              ACALL    ?L?COM000E
B1:009ED8 2409              ADD      A,#09H
B1:009EDA 1285F5            LCALL    ?L?COM0004
B1:009EDD 12DC51            LCALL    ?L?COM046F
B1:009EE0 2409              ADD      A,#09H
B1:009EE2 F9                MOV      R1,A
B1:009EE3 E4                CLR      A
B1:009EE4         
B1:009EE4 3A                ADDC     A,R2
B1:009EE5 FA                MOV      R2,A
B1:009EE6 E9                MOV      A,R1
B1:009EE7 2401              ADD      A,#01H
B1:009EE9 1285F5            LCALL    ?L?COM0004
B1:009EEC 900A0F            MOV      DPTR,#btmpCmd
B1:009EEF F0                MOVX     @DPTR,A
B1:009EF0         ?C0354?ZW_TRANSPORT:
B1:009EF0 12D90D            LCALL    ?L?COM0055
B1:009EF3 1285F5            LCALL    ?L?COM0004
B1:009EF6 FF                MOV      R7,A
;---- Variable 'btmpStatus' assigned to Register 'R7' ----
B1:009EF7 300170            JNB      learnMode,?C0348?ZW_TRANSPORT
B1:009EFA 54E2              ANL      A,#0E2H
B1:009EFC 6480              XRL      A,#080H
B1:009EFE 706A              JNZ      ?C0348?ZW_TRANSPORT
B1:009F00 900A10            MOV      DPTR,#btmpCmdClass
B1:009F03 E0                MOVX     A,@DPTR
B1:009F04 6401              XRL      A,#01H
B1:009F06 7057              JNZ      ?C0356?ZW_TRANSPORT
B1:009F08 900A0F            MOV      DPTR,#btmpCmd
B1:009F0B E0                MOVX     A,@DPTR
B1:009F0C 6408              XRL      A,#08H
B1:009F0E 605A              JZ       ?C0348?ZW_TRANSPORT
B1:009F10 300413            JNB      learnModeClassic,?C0359?ZW_TRANSPORT
B1:009F13 F181              ACALL    ?L?COM000E
B1:009F15 126E30            LCALL    ?L?COM01DE
B1:009F18 125D51            LCALL    ?L?COM00B0
B1:009F1B 126E5F            LCALL    ?L?COM0281
B1:009F1E 12DA72            LCALL    ?L?COM0343
B1:009F21 12DA6B            LCALL    ?L?COM016E
B1:009F24 6031              JZ       ?C0358?ZW_TRANSPORT
B1:009F26         ?C0359?ZW_TRANSPORT:
B1:009F26 F181              ACALL    ?L?COM000E
B1:009F28 126E30            LCALL    ?L?COM01DE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 256


B1:009F2B E9                MOV      A,R1
B1:009F2C 2404              ADD      A,#04H
B1:009F2E 1285F5            LCALL    ?L?COM0004
B1:009F31 FF                MOV      R7,A
B1:009F32 F181              ACALL    ?L?COM000E
B1:009F34 126E30            LCALL    ?L?COM01DE
B1:009F37 1285F2            LCALL    ?L?COM0003
B1:009F3A 4F                ORL      A,R7
B1:009F3B FF                MOV      R7,A
B1:009F3C F181              ACALL    ?L?COM000E
B1:009F3E 126E30            LCALL    ?L?COM01DE
B1:009F41 E9                MOV      A,R1
B1:009F42 2405              ADD      A,#05H
B1:009F44 1285F5            LCALL    ?L?COM0004
B1:009F47 4F                ORL      A,R7
B1:009F48 FF                MOV      R7,A
B1:009F49 F181              ACALL    ?L?COM000E
B1:009F4B 126E30            LCALL    ?L?COM01DE
B1:009F4E E9                MOV      A,R1
B1:009F4F 2406              ADD      A,#06H
B1:009F51 1285F5            LCALL    ?L?COM0004
B1:009F54 4F                ORL      A,R7
B1:009F55 7008              JNZ      ?C0356?ZW_TRANSPORT
B1:009F57         ?C0358?ZW_TRANSPORT:
B1:009F57 900A0F            MOV      DPTR,#btmpCmd
B1:009F5A E0                MOVX     A,@DPTR
B1:009F5B 6403              XRL      A,#03H
B1:009F5D 600B              JZ       ?C0348?ZW_TRANSPORT
B1:009F5F         ?C0356?ZW_TRANSPORT:
B1:009F5F 12D90D            LCALL    ?L?COM0055
B1:009F62 1285F5            LCALL    ?L?COM0004
B1:009F65 54EA              ANL      A,#0EAH
B1:009F67 12203B            LCALL    ?C?CSTPTR
B1:009F6A         ?C0348?ZW_TRANSPORT:
B1:009F6A 12D90D            LCALL    ?L?COM0055
B1:009F6D 1285F5            LCALL    ?L?COM0004
B1:009F70 30E007            JNB      ACC.0,?C0276?ZW_TRANSPORT
B1:009F73 900768            MOV      DPTR,#myFrame
B1:009F76 E0                MOVX     A,@DPTR
B1:009F77 4401              ORL      A,#01H
B1:009F79 F0                MOVX     @DPTR,A
B1:009F7A         ?C0276?ZW_TRANSPORT:
B1:009F7A 22                RET      
----- FUNCTION _IsMyFrame (END) -------


----- FUNCTION ?L?COM000D (BEGIN) -----
B1:009F7B C4                SWAP     A
B1:009F7C 540F              ANL      A,#0FH
B1:009F7E FD                MOV      R5,A
B1:009F7F 7C00              MOV      R4,#00H
B1:009F81         ?L?COM000E:
B1:009F81 900A11            MOV      DPTR,#fr
B1:009F84 122552            LCALL    ?C?PLDXDATA
B1:009F87 E9                MOV      A,R1
B1:009F88 22                RET      
----- FUNCTION ?L?COM000D (END) -------


----- FUNCTION _GetTransmitSpeedOptions (BEGIN) -----
;---- Variable 'pFrame' assigned to Register 'R1/R2/R3' ----
B1:009F89 1252F1            LCALL    ?L?COM001F
B1:009F8C FF                MOV      R7,A
B1:009F8D AEF0              MOV      R6,B
B1:009F8F 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 257


----- FUNCTION _GetTransmitSpeedOptions (END) -------


----- FUNCTION ?L?COM027A (BEGIN) -----
B1:009F90 900A8F            MOV      DPTR,#pFrame
B1:009F93 122552            LCALL    ?C?PLDXDATA
----- FUNCTION _SetTransmitHomeID (BEGIN) -----
B1:009F96 900AC4            MOV      DPTR,#ptrFrame
B1:009F99 122572            LCALL    ?C?PSTXDATA
B1:009F9C 300923            JNB      inclusionHomeIDActive,?C0060?ZW_TRANSPORT
B1:009F9F 12DFFA            LCALL    ?L?COM04CE
B1:009FA2 1256E6            LCALL    ?L?COM018D
B1:009FA5 C003              PUSH     AR3
B1:009FA7 C002              PUSH     AR2
B1:009FA9 C001              PUSH     AR1
B1:009FAB 7B01              MOV      R3,#01H
B1:009FAD 7A07              MOV      R2,#HIGH inclusionHomeID
B1:009FAF 798D              MOV      R1,#LOW inclusionHomeID
B1:009FB1 1287B9            LCALL    ?L?COM003F
B1:009FB4 D001              POP      AR1
B1:009FB6 D002              POP      AR2
B1:009FB8 D003              POP      AR3
B1:009FBA 7F04              MOV      R7,#04H
B1:009FBC 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:009FBF C209              CLR      inclusionHomeIDActive
B1:009FC1 22                RET      
B1:009FC2         ?C0060?ZW_TRANSPORT:
B1:009FC2 300322            JNB      learnModeDsk,?C0062?ZW_TRANSPORT
B1:009FC5 7B01              MOV      R3,#01H
B1:009FC7 7A33              MOV      R2,#HIGH Dsk+0CH
B1:009FC9 7938              MOV      R1,#LOW Dsk+0CH
B1:009FCB 126E5F            LCALL    ?L?COM0281
B1:009FCE 12DA67            LCALL    ?L?COM016D
B1:009FD1 7014              JNZ      ?C0062?ZW_TRANSPORT
B1:009FD3 12DFFA            LCALL    ?L?COM04CE
B1:009FD6 1256E6            LCALL    ?L?COM018D
B1:009FD9 C003              PUSH     AR3
B1:009FDB C002              PUSH     AR2
B1:009FDD C001              PUSH     AR1
B1:009FDF 7B01              MOV      R3,#01H
B1:009FE1 7A33              MOV      R2,#HIGH Dsk+08H
B1:009FE3 7934              MOV      R1,#LOW Dsk+08H
B1:009FE5 800F              SJMP     ?C0577?ZW_TRANSPORT
B1:009FE7         ?C0062?ZW_TRANSPORT:
B1:009FE7 12DFFA            LCALL    ?L?COM04CE
B1:009FEA 1256E6            LCALL    ?L?COM018D
B1:009FED C003              PUSH     AR3
B1:009FEF C002              PUSH     AR2
B1:009FF1 C001              PUSH     AR1
B1:009FF3 124FD6            LCALL    ?L?COM02D2
B1:009FF6         
B1:009FF6 1287B9            LCALL    ?L?COM003F
B1:009FF9 D001              POP      AR1
B1:009FFB D002              POP      AR2
B1:009FFD D003              POP      AR3
B1:009FFF 7F04              MOV      R7,#04H
B1:00A001 021BAB            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION _SetTransmitHomeID (END) -------


----- FUNCTION ?L?COM0200 (BEGIN) -----
B1:00A004 FF                MOV      R7,A
B1:00A005 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00A008 122552            LCALL    ?C?PLDXDATA
----- FUNCTION _BuildTxHeader (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 258


B1:00A00B 900A8F            MOV      DPTR,#pFrame
B1:00A00E 122572            LCALL    ?C?PSTXDATA
;---- Variable 'frameType' assigned to Register 'R7' ----
B1:00A011 EF                MOV      A,R7
B1:00A012 540F              ANL      A,#0FH
B1:00A014 FE                MOV      R6,A
;---- Variable 'bframeType' assigned to Register 'R6' ----
B1:00A015 9137              ACALL    ?L?COM0011
B1:00A017 24B8              ADD      A,#0B8H
B1:00A019 1285F5            LCALL    ?L?COM0004
B1:00A01C 54F0              ANL      A,#0F0H
B1:00A01E FD                MOV      R5,A
B1:00A01F EF                MOV      A,R7
B1:00A020 54F0              ANL      A,#0F0H
B1:00A022 FF                MOV      R7,A
B1:00A023 C4                SWAP     A
B1:00A024 540F              ANL      A,#0FH
B1:00A026 4D                ORL      A,R5
B1:00A027 12203B            LCALL    ?C?CSTPTR
B1:00A02A EE                MOV      A,R6
B1:00A02B 14                DEC      A
B1:00A02C 605F              JZ       ?C0070?ZW_TRANSPORT
B1:00A02E 14                DEC      A
B1:00A02F 7002              JNZ      $ + 4H
B1:00A031 6125              AJMP     ?C0096?ZW_TRANSPORT
B1:00A033 24FE              ADD      A,#0FEH
B1:00A035 7002              JNZ      $ + 4H
B1:00A037 2160              AJMP     ?C0082?ZW_TRANSPORT
B1:00A039 24FE              ADD      A,#0FEH
B1:00A03B 7002              JNZ      $ + 4H
B1:00A03D 6190              AJMP     ?C0098?ZW_TRANSPORT
B1:00A03F 2403              ADD      A,#03H
B1:00A041 6002              JZ       $ + 4H
B1:00A043 8120              AJMP     ?C0103?ZW_TRANSPORT
B1:00A045         ?C0069?ZW_TRANSPORT:
B1:00A045 9137              ACALL    ?L?COM0011
B1:00A047 1256E7            LCALL    ?L?COM018E
B1:00A04A C003              PUSH     AR3
B1:00A04C C002              PUSH     AR2
B1:00A04E C001              PUSH     AR1
B1:00A050 124FD6            LCALL    ?L?COM02D2
B1:00A053 1287B9            LCALL    ?L?COM003F
B1:00A056 D001              POP      AR1
B1:00A058 D002              POP      AR2
B1:00A05A D003              POP      AR3
B1:00A05C 7F04              MOV      R7,#04H
B1:00A05E 127028            LCALL    ?L?COM04E3
B1:00A061 9137              ACALL    ?L?COM0011
B1:00A063 24B6              ADD      A,#0B6H
B1:00A065 F9                MOV      R1,A
B1:00A066 E4                CLR      A
B1:00A067 3A                ADDC     A,R2
B1:00A068 FA                MOV      R2,A
B1:00A069 EF                MOV      A,R7
B1:00A06A 9134              ACALL    ?L?COM0010
B1:00A06C 24B7              ADD      A,#0B7H
B1:00A06E 12E45A            LCALL    ?L?COM03B3
B1:00A071 9134              ACALL    ?L?COM0010
B1:00A073 24B8              ADD      A,#0B8H
B1:00A075 1285F5            LCALL    ?L?COM0004
B1:00A078 54F0              ANL      A,#0F0H
B1:00A07A 12FD77            LCALL    ?L?COM0590
B1:00A07D 4F                ORL      A,R7
B1:00A07E 9134              ACALL    ?L?COM0010
B1:00A080 12E000            LCALL    ?L?COM0484
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 259


B1:00A083 740A              MOV      A,#0AH
B1:00A085 9134              ACALL    ?L?COM0010
B1:00A087 9148              ACALL    ?L?COM02DD
B1:00A089 7409              MOV      A,#09H
B1:00A08B 811D              AJMP     ?C0584?ZW_TRANSPORT
B1:00A08D         ?C0070?ZW_TRANSPORT:
B1:00A08D 129F90            LCALL    ?L?COM027A
B1:00A090 9137              ACALL    ?L?COM0011
B1:00A092 24B7              ADD      A,#0B7H
B1:00A094 9141              ACALL    ?L?COM0182
B1:00A096 9134              ACALL    ?L?COM0010
B1:00A098 2402              ADD      A,#02H
B1:00A09A 1285F5            LCALL    ?L?COM0004
B1:00A09D 30E034            JNB      ACC.0,?C0071?ZW_TRANSPORT
B1:00A0A0 900A8F            MOV      DPTR,#pFrame
B1:00A0A3 1285EF            LCALL    ?L?COM0002
B1:00A0A6 30E70C            JNB      ACC.7,?C0072?ZW_TRANSPORT
B1:00A0A9 9137              ACALL    ?L?COM0011
B1:00A0AB 24B8              ADD      A,#0B8H
B1:00A0AD 1285F5            LCALL    ?L?COM0004
B1:00A0B0 4480              ORL      A,#080H
B1:00A0B2 12203B            LCALL    ?C?CSTPTR
B1:00A0B5         ?C0072?ZW_TRANSPORT:
B1:00A0B5 9137              ACALL    ?L?COM0011
B1:00A0B7 2402              ADD      A,#02H
B1:00A0B9 1285F5            LCALL    ?L?COM0004
B1:00A0BC 20E70C            JB       ACC.7,?C0073?ZW_TRANSPORT
B1:00A0BF 9137              ACALL    ?L?COM0011
B1:00A0C1 24B7              ADD      A,#0B7H
B1:00A0C3 1285F5            LCALL    ?L?COM0004
B1:00A0C6 4440              ORL      A,#040H
B1:00A0C8 12203B            LCALL    ?C?CSTPTR
B1:00A0CB         ?C0073?ZW_TRANSPORT:
B1:00A0CB 9137              ACALL    ?L?COM0011
B1:00A0CD 1257E3            LCALL    ?L?COM0222
B1:00A0D0 7403              MOV      A,#03H
B1:00A0D2 8004              SJMP     ?C0579?ZW_TRANSPORT
B1:00A0D4         ?C0071?ZW_TRANSPORT:
B1:00A0D4 9137              ACALL    ?L?COM0011
B1:00A0D6 913F              ACALL    ?L?COM0181
B1:00A0D8         
B1:00A0D8 12203B            LCALL    ?C?CSTPTR
B1:00A0DB         ?C0074?ZW_TRANSPORT:
B1:00A0DB 9137              ACALL    ?L?COM0011
B1:00A0DD 2402              ADD      A,#02H
B1:00A0DF 1285F5            LCALL    ?L?COM0004
B1:00A0E2 30E10C            JNB      ACC.1,?C0075?ZW_TRANSPORT
B1:00A0E5 9137              ACALL    ?L?COM0011
B1:00A0E7 24B7              ADD      A,#0B7H
B1:00A0E9 1285F5            LCALL    ?L?COM0004
B1:00A0EC 4420              ORL      A,#020H
B1:00A0EE 12203B            LCALL    ?C?CSTPTR
B1:00A0F1         ?C0075?ZW_TRANSPORT:
B1:00A0F1 900A8F            MOV      DPTR,#pFrame
B1:00A0F4 1285EF            LCALL    ?L?COM0002
B1:00A0F7 30E20C            JNB      ACC.2,?C0076?ZW_TRANSPORT
B1:00A0FA 9137              ACALL    ?L?COM0011
B1:00A0FC 24B7              ADD      A,#0B7H
B1:00A0FE 1285F5            LCALL    ?L?COM0004
B1:00A101 4410              ORL      A,#010H
B1:00A103 12203B            LCALL    ?C?CSTPTR
B1:00A106         ?C0076?ZW_TRANSPORT:
B1:00A106 9137              ACALL    ?L?COM0011
B1:00A108 2402              ADD      A,#02H
B1:00A10A 1285F5            LCALL    ?L?COM0004
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 260


B1:00A10D 30E70C            JNB      ACC.7,?C0077?ZW_TRANSPORT
B1:00A110 9137              ACALL    ?L?COM0011
B1:00A112 24B7              ADD      A,#0B7H
B1:00A114 1285F5            LCALL    ?L?COM0004
B1:00A117 4480              ORL      A,#080H
B1:00A119 12203B            LCALL    ?C?CSTPTR
B1:00A11C         ?C0077?ZW_TRANSPORT:
B1:00A11C 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00A11F E0                MOVX     A,@DPTR
B1:00A120 FF                MOV      R7,A
B1:00A121 7E00              MOV      R6,#00H
B1:00A123 30E502            JNB      ACC.5,?C0078?ZW_TRANSPORT
B1:00A126 7E20              MOV      R6,#020H
B1:00A128         ?C0078?ZW_TRANSPORT:
B1:00A128         ?C0079?ZW_TRANSPORT:
B1:00A128 EF                MOV      A,R7
B1:00A129 7F00              MOV      R7,#00H
B1:00A12B 30E402            JNB      ACC.4,?C0080?ZW_TRANSPORT
B1:00A12E 7F40              MOV      R7,#040H
B1:00A130         ?C0080?ZW_TRANSPORT:
B1:00A130         ?C0081?ZW_TRANSPORT:
B1:00A130 EF                MOV      A,R7
B1:00A131 4E                ORL      A,R6
B1:00A132 FF                MOV      R7,A
;---- Variable 'transmitRFSpeedOption' assigned to Register 'R7' ----
B1:00A133 9137              ACALL    ?L?COM0011
B1:00A135 24B8              ADD      A,#0B8H
B1:00A137 1285F5            LCALL    ?L?COM0004
B1:00A13A 549F              ANL      A,#09FH
B1:00A13C FE                MOV      R6,A
B1:00A13D EF                MOV      A,R7
B1:00A13E 5460              ANL      A,#060H
B1:00A140 4E                ORL      A,R6
B1:00A141 9134              ACALL    ?L?COM0010
B1:00A143 24BA              ADD      A,#0BAH
B1:00A145 1285F5            LCALL    ?L?COM0004
B1:00A148 FF                MOV      R7,A
B1:00A149 9137              ACALL    ?L?COM0011
B1:00A14B 24D9              ADD      A,#0D9H
B1:00A14D 1287AB            LCALL    ?L?COM0015
;---- Variable 'headerLength1' assigned to Register 'R7' ----
B1:00A150 7F09              MOV      R7,#09H
B1:00A152 9137              ACALL    ?L?COM0011
B1:00A154 24B1              ADD      A,#0B1H
B1:00A156 1285F5            LCALL    ?L?COM0004
B1:00A159 9121              ACALL    ?L?COM000F
B1:00A15B 9148              ACALL    ?L?COM02DD
B1:00A15D EF                MOV      A,R7
B1:00A15E         
B1:00A15E 811D              AJMP     ?C0584?ZW_TRANSPORT
B1:00A160         ?C0082?ZW_TRANSPORT:
B1:00A160 9137              ACALL    ?L?COM0011
B1:00A162 2402              ADD      A,#02H
B1:00A164 1285F5            LCALL    ?L?COM0004
B1:00A167 20E602            JB       ACC.6,$ + 5H
B1:00A16A 4108              AJMP     ?C0083?ZW_TRANSPORT
B1:00A16C 9137              ACALL    ?L?COM0011
B1:00A16E 2409              ADD      A,#09H
B1:00A170 1285F5            LCALL    ?L?COM0004
B1:00A173 12707C            LCALL    ?L?COM0571
B1:00A176 900A93            MOV      DPTR,#bRepeaterCount
B1:00A179 F0                MOVX     @DPTR,A
B1:00A17A 7404              MOV      A,#04H
B1:00A17C C3                CLR      C
B1:00A17D 9E                SUBB     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 261


B1:00A17E 500B              JNC      ?C0084?ZW_TRANSPORT
B1:00A180 7404              MOV      A,#04H
B1:00A182 F0                MOVX     @DPTR,A
B1:00A183 EF                MOV      A,R7
B1:00A184 540F              ANL      A,#0FH
B1:00A186 4440              ORL      A,#040H
B1:00A188 12203B            LCALL    ?C?CSTPTR
B1:00A18B         ?C0084?ZW_TRANSPORT:
B1:00A18B 900A93            MOV      DPTR,#bRepeaterCount
B1:00A18E E0                MOVX     A,@DPTR
B1:00A18F 2402              ADD      A,#02H
B1:00A191 FF                MOV      R7,A
B1:00A192 9137              ACALL    ?L?COM0011
B1:00A194 24BB              ADD      A,#0BBH
B1:00A196 F9                MOV      R1,A
B1:00A197 E4                CLR      A
B1:00A198 3A                ADDC     A,R2
B1:00A199 FA                MOV      R2,A
B1:00A19A C003              PUSH     AR3
B1:00A19C C002              PUSH     AR2
B1:00A19E C001              PUSH     AR1
B1:00A1A0 9137              ACALL    ?L?COM0011
B1:00A1A2 12BC01            LCALL    ?L?COM0123
B1:00A1A5 1287B9            LCALL    ?L?COM003F
B1:00A1A8 D001              POP      AR1
B1:00A1AA D002              POP      AR2
B1:00A1AC D003              POP      AR3
B1:00A1AE 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A1B1 9137              ACALL    ?L?COM0011
B1:00A1B3 24B1              ADD      A,#0B1H
B1:00A1B5 1285F5            LCALL    ?L?COM0004
B1:00A1B8 FF                MOV      R7,A
B1:00A1B9 900A93            MOV      DPTR,#bRepeaterCount
B1:00A1BC E0                MOVX     A,@DPTR
B1:00A1BD 2403              ADD      A,#03H
B1:00A1BF FD                MOV      R5,A
B1:00A1C0 E4                CLR      A
B1:00A1C1 33                RLC      A
B1:00A1C2 FC                MOV      R4,A
B1:00A1C3 D3                SETB     C
B1:00A1C4 EF                MOV      A,R7
B1:00A1C5 9D                SUBB     A,R5
B1:00A1C6 EC                MOV      A,R4
B1:00A1C7 125341            LCALL    ?L?COM011F
B1:00A1CA 4037              JC       ?C0085?ZW_TRANSPORT
B1:00A1CC 121F7C            LCALL    ?C?CLDPTR
B1:00A1CF FF                MOV      R7,A
B1:00A1D0 900A93            MOV      DPTR,#bRepeaterCount
B1:00A1D3 E0                MOVX     A,@DPTR
B1:00A1D4 FE                MOV      R6,A
B1:00A1D5 2403              ADD      A,#03H
B1:00A1D7 FD                MOV      R5,A
B1:00A1D8 C3                CLR      C
B1:00A1D9 EF                MOV      A,R7
B1:00A1DA 9D                SUBB     A,R5
B1:00A1DB FF                MOV      R7,A
B1:00A1DC 9134              ACALL    ?L?COM0010
B1:00A1DE 12BC01            LCALL    ?L?COM0123
B1:00A1E1 C003              PUSH     AR3
B1:00A1E3 C002              PUSH     AR2
B1:00A1E5 C001              PUSH     AR1
B1:00A1E7 EE                MOV      A,R6
B1:00A1E8 240A              ADD      A,#0AH
B1:00A1EA FD                MOV      R5,A
B1:00A1EB E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 262


B1:00A1EC 33                RLC      A
B1:00A1ED FC                MOV      R4,A
B1:00A1EE 9137              ACALL    ?L?COM0011
B1:00A1F0 2D                ADD      A,R5
B1:00A1F1 F9                MOV      R1,A
B1:00A1F2 EA                MOV      A,R2
B1:00A1F3 3C                ADDC     A,R4
B1:00A1F4 FA                MOV      R2,A
B1:00A1F5 1287B9            LCALL    ?L?COM003F
B1:00A1F8 D001              POP      AR1
B1:00A1FA D002              POP      AR2
B1:00A1FC D003              POP      AR3
B1:00A1FE 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A201 8005              SJMP     ?C0083?ZW_TRANSPORT
B1:00A203         ?C0085?ZW_TRANSPORT:
B1:00A203 9137              ACALL    ?L?COM0011
B1:00A205 12D1A5            LCALL    ?L?COM00E2
B1:00A208         ?C0083?ZW_TRANSPORT:
B1:00A208 129F90            LCALL    ?L?COM027A
B1:00A20B 9137              ACALL    ?L?COM0011
B1:00A20D 24B7              ADD      A,#0B7H
B1:00A20F 9141              ACALL    ?L?COM0182
B1:00A211 12203B            LCALL    ?C?CSTPTR
B1:00A214 4480              ORL      A,#080H
B1:00A216 9134              ACALL    ?L?COM0010
B1:00A218 2402              ADD      A,#02H
B1:00A21A 1285F5            LCALL    ?L?COM0004
B1:00A21D 900A8F            MOV      DPTR,#pFrame
B1:00A220 30E008            JNB      ACC.0,?C0087?ZW_TRANSPORT
B1:00A223 12E012            LCALL    ?L?COM00B3
B1:00A226 12E45A            LCALL    ?L?COM03B3
B1:00A229 8005              SJMP     ?C0581?ZW_TRANSPORT
B1:00A22B         ?C0087?ZW_TRANSPORT:
B1:00A22B 12E012            LCALL    ?L?COM00B3
B1:00A22E 9141              ACALL    ?L?COM0182
B1:00A230         
B1:00A230 12203B            LCALL    ?C?CSTPTR
B1:00A233         ?C0088?ZW_TRANSPORT:
B1:00A233 9137              ACALL    ?L?COM0011
B1:00A235 24BB              ADD      A,#0BBH
B1:00A237 12D1A7            LCALL    ?L?COM00E3
B1:00A23A 900A8F            MOV      DPTR,#pFrame
B1:00A23D 1285EF            LCALL    ?L?COM0002
B1:00A240 30E20C            JNB      ACC.2,?C0089?ZW_TRANSPORT
B1:00A243 9137              ACALL    ?L?COM0011
B1:00A245 24BB              ADD      A,#0BBH
B1:00A247 1285F5            LCALL    ?L?COM0004
B1:00A24A 4410              ORL      A,#010H
B1:00A24C 12203B            LCALL    ?C?CSTPTR
B1:00A24F         ?C0089?ZW_TRANSPORT:
B1:00A24F 9137              ACALL    ?L?COM0011
B1:00A251 1252F2            LCALL    ?L?COM0020
B1:00A254 5460              ANL      A,#060H
B1:00A256 7002              JNZ      $ + 4H
B1:00A258 41DB              AJMP     ?C0090?ZW_TRANSPORT
B1:00A25A 9137              ACALL    ?L?COM0011
B1:00A25C 24B6              ADD      A,#0B6H
B1:00A25E 1285F5            LCALL    ?L?COM0004
B1:00A261 12D707            LCALL    ?L?COM0183
B1:00A264 7075              JNZ      ?C0582?ZW_TRANSPORT
B1:00A266 9137              ACALL    ?L?COM0011
B1:00A268 24BB              ADD      A,#0BBH
B1:00A26A 1285F5            LCALL    ?L?COM0004
B1:00A26D FF                MOV      R7,A
B1:00A26E 20E06A            JB       ACC.0,?C0582?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 263


B1:00A271 900A8F            MOV      DPTR,#pFrame
B1:00A274 1285EF            LCALL    ?L?COM0002
B1:00A277 20E461            JB       ACC.4,?C0582?ZW_TRANSPORT
B1:00A27A 9137              ACALL    ?L?COM0011
B1:00A27C 24BB              ADD      A,#0BBH
B1:00A27E F9                MOV      R1,A
B1:00A27F E4                CLR      A
B1:00A280 3A                ADDC     A,R2
B1:00A281 FA                MOV      R2,A
B1:00A282 EF                MOV      A,R7
B1:00A283 4408              ORL      A,#08H
B1:00A285 9134              ACALL    ?L?COM0010
B1:00A287 24BC              ADD      A,#0BCH
B1:00A289 1285F5            LCALL    ?L?COM0004
B1:00A28C 12BBF5            LCALL    ?L?COM01E2
B1:00A28F 9137              ACALL    ?L?COM0011
B1:00A291 24BD              ADD      A,#0BDH
B1:00A293 12B8C4            LCALL    ?L?COM002D
B1:00A296 E4                CLR      A
B1:00A297 9134              ACALL    ?L?COM0010
B1:00A299 24BC              ADD      A,#0BCH
B1:00A29B 1285F5            LCALL    ?L?COM0004
B1:00A29E C4                SWAP     A
B1:00A29F 540F              ANL      A,#0FH
B1:00A2A1 FF                MOV      R7,A
B1:00A2A2 9137              ACALL    ?L?COM0011
B1:00A2A4 24BD              ADD      A,#0BDH
B1:00A2A6 12B8C4            LCALL    ?L?COM002D
B1:00A2A9 121F7C            LCALL    ?C?CLDPTR
B1:00A2AC 4410              ORL      A,#010H
B1:00A2AE 9134              ACALL    ?L?COM0010
B1:00A2B0 1252F2            LCALL    ?L?COM0020
B1:00A2B3 5460              ANL      A,#060H
B1:00A2B5 FF                MOV      R7,A
B1:00A2B6 9137              ACALL    ?L?COM0011
B1:00A2B8 24BC              ADD      A,#0BCH
B1:00A2BA 1285F5            LCALL    ?L?COM0004
B1:00A2BD 12F704            LCALL    ?L?COM03BF
B1:00A2C0 9137              ACALL    ?L?COM0011
B1:00A2C2 2D                ADD      A,R5
B1:00A2C3 F9                MOV      R1,A
B1:00A2C4 EC                MOV      A,R4
B1:00A2C5 3A                ADDC     A,R2
B1:00A2C6 FA                MOV      R2,A
B1:00A2C7 E9                MOV      A,R1
B1:00A2C8 24BE              ADD      A,#0BEH
B1:00A2CA F9                MOV      R1,A
B1:00A2CB E4                CLR      A
B1:00A2CC 3A                ADDC     A,R2
B1:00A2CD FA                MOV      R2,A
B1:00A2CE EF                MOV      A,R7
B1:00A2CF 9134              ACALL    ?L?COM0010
B1:00A2D1 1252F2            LCALL    ?L?COM0020
B1:00A2D4 549F              ANL      A,#09FH
B1:00A2D6 12D08A            LCALL    ?L?COM0240
B1:00A2D9 800C              SJMP     ?C0093?ZW_TRANSPORT
B1:00A2DB         ?C0090?ZW_TRANSPORT:
B1:00A2DB         
B1:00A2DB 9137              ACALL    ?L?COM0011
B1:00A2DD 24BB              ADD      A,#0BBH
B1:00A2DF 1285F5            LCALL    ?L?COM0004
B1:00A2E2 54F7              ANL      A,#0F7H
B1:00A2E4 12203B            LCALL    ?C?CSTPTR
B1:00A2E7         ?C0093?ZW_TRANSPORT:
B1:00A2E7 9137              ACALL    ?L?COM0011
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 264


B1:00A2E9 24BB              ADD      A,#0BBH
B1:00A2EB 1285F5            LCALL    ?L?COM0004
B1:00A2EE 30E316            JNB      ACC.3,?C0094?ZW_TRANSPORT
B1:00A2F1 9137              ACALL    ?L?COM0011
B1:00A2F3 24BC              ADD      A,#0BCH
B1:00A2F5 1285F5            LCALL    ?L?COM0004
B1:00A2F8 12BBF5            LCALL    ?L?COM01E2
B1:00A2FB 9137              ACALL    ?L?COM0011
B1:00A2FD 24BD              ADD      A,#0BDH
B1:00A2FF 12B8C4            LCALL    ?L?COM002D
B1:00A302 12D98E            LCALL    ?L?COM0138
B1:00A305 8002              SJMP     ?C0095?ZW_TRANSPORT
B1:00A307         ?C0094?ZW_TRANSPORT:
B1:00A307 7F00              MOV      R7,#00H
B1:00A309         ?C0095?ZW_TRANSPORT:
B1:00A309 9137              ACALL    ?L?COM0011
B1:00A30B 24BC              ADD      A,#0BCH
B1:00A30D 1285F5            LCALL    ?L?COM0004
B1:00A310 C4                SWAP     A
B1:00A311 540F              ANL      A,#0FH
B1:00A313 240B              ADD      A,#0BH
B1:00A315 2F                ADD      A,R7
B1:00A316 FF                MOV      R7,A
;---- Variable 'headerLength2' assigned to Register 'R7' ----
B1:00A317 9137              ACALL    ?L?COM0011
B1:00A319 24B1              ADD      A,#0B1H
B1:00A31B 1285F5            LCALL    ?L?COM0004
B1:00A31E 9121              ACALL    ?L?COM000F
B1:00A320 9148              ACALL    ?L?COM02DD
B1:00A322 EF                MOV      A,R7
B1:00A323         
B1:00A323 811D              AJMP     ?C0584?ZW_TRANSPORT
B1:00A325         ?C0096?ZW_TRANSPORT:
B1:00A325 129F90            LCALL    ?L?COM027A
B1:00A328 9137              ACALL    ?L?COM0011
B1:00A32A 24B7              ADD      A,#0B7H
B1:00A32C F9                MOV      R1,A
B1:00A32D E4                CLR      A
B1:00A32E 3A                ADDC     A,R2
B1:00A32F FA                MOV      R2,A
B1:00A330 7402              MOV      A,#02H
B1:00A332 9134              ACALL    ?L?COM0010
B1:00A334 2402              ADD      A,#02H
B1:00A336 1285F5            LCALL    ?L?COM0004
B1:00A339 30E10C            JNB      ACC.1,?C0097?ZW_TRANSPORT
B1:00A33C 9137              ACALL    ?L?COM0011
B1:00A33E 24B7              ADD      A,#0B7H
B1:00A340 1285F5            LCALL    ?L?COM0004
B1:00A343 4420              ORL      A,#020H
B1:00A345 12203B            LCALL    ?C?CSTPTR
B1:00A348         ?C0097?ZW_TRANSPORT:
B1:00A348 9137              ACALL    ?L?COM0011
B1:00A34A 12D092            LCALL    ?L?COM035A
B1:00A34D 741D              MOV      A,#01DH
B1:00A34F 9134              ACALL    ?L?COM0010
B1:00A351 24BB              ADD      A,#0BBH
B1:00A353 F9                MOV      R1,A
B1:00A354 E4                CLR      A
B1:00A355 3A                ADDC     A,R2
B1:00A356 FA                MOV      R2,A
B1:00A357 C003              PUSH     AR3
B1:00A359 C002              PUSH     AR2
B1:00A35B C001              PUSH     AR1
B1:00A35D 90066E            MOV      DPTR,#pMultiNodeList
B1:00A360 1287B6            LCALL    ?L?COM003E
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 265


B1:00A363 D001              POP      AR1
B1:00A365 D002              POP      AR2
B1:00A367 D003              POP      AR3
B1:00A369 7F1D              MOV      R7,#01DH
B1:00A36B 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A36E 9137              ACALL    ?L?COM0011
B1:00A370 913F              ACALL    ?L?COM0181
B1:00A372 12203B            LCALL    ?C?CSTPTR
;---- Variable 'headerLength3' assigned to Register 'R7' ----
B1:00A375 7F26              MOV      R7,#026H
B1:00A377 9137              ACALL    ?L?COM0011
B1:00A379 9148              ACALL    ?L?COM02DD
B1:00A37B EF                MOV      A,R7
B1:00A37C 9134              ACALL    ?L?COM0010
B1:00A37E 24B1              ADD      A,#0B1H
B1:00A380 1285F5            LCALL    ?L?COM0004
B1:00A383 FE                MOV      R6,A
B1:00A384 EF                MOV      A,R7
B1:00A385 04                INC      A
B1:00A386 2E                ADD      A,R6
B1:00A387 FF                MOV      R7,A
B1:00A388 9137              ACALL    ?L?COM0011
B1:00A38A 12E000            LCALL    ?L?COM0484
B1:00A38D EF                MOV      A,R7
B1:00A38E         
B1:00A38E 811D              AJMP     ?C0584?ZW_TRANSPORT
B1:00A390         ?C0098?ZW_TRANSPORT:
B1:00A390 9137              ACALL    ?L?COM0011
B1:00A392 24B8              ADD      A,#0B8H
B1:00A394 1285F5            LCALL    ?L?COM0004
B1:00A397 540F              ANL      A,#0FH
B1:00A399 900A92            MOV      DPTR,#bSeqNo
B1:00A39C F0                MOVX     @DPTR,A
B1:00A39D 9137              ACALL    ?L?COM0011
B1:00A39F 2402              ADD      A,#02H
B1:00A3A1 1285F5            LCALL    ?L?COM0004
B1:00A3A4 20E64A            JB       ACC.6,?C0099?ZW_TRANSPORT
B1:00A3A7 129F90            LCALL    ?L?COM027A
B1:00A3AA 9137              ACALL    ?L?COM0011
B1:00A3AC 24B7              ADD      A,#0B7H
B1:00A3AE F9                MOV      R1,A
B1:00A3AF E4                CLR      A
B1:00A3B0 3A                ADDC     A,R2
B1:00A3B1 FA                MOV      R2,A
B1:00A3B2 7405              MOV      A,#05H
B1:00A3B4 9134              ACALL    ?L?COM0010
B1:00A3B6 2402              ADD      A,#02H
B1:00A3B8 1285F5            LCALL    ?L?COM0004
B1:00A3BB 30E10C            JNB      ACC.1,?C0100?ZW_TRANSPORT
B1:00A3BE 9137              ACALL    ?L?COM0011
B1:00A3C0 24B7              ADD      A,#0B7H
B1:00A3C2 1285F5            LCALL    ?L?COM0004
B1:00A3C5 4420              ORL      A,#020H
B1:00A3C7 12203B            LCALL    ?C?CSTPTR
B1:00A3CA         ?C0100?ZW_TRANSPORT:
B1:00A3CA 9137              ACALL    ?L?COM0011
B1:00A3CC 24B8              ADD      A,#0B8H
B1:00A3CE 1285F5            LCALL    ?L?COM0004
B1:00A3D1 54F0              ANL      A,#0F0H
B1:00A3D3 FF                MOV      R7,A
B1:00A3D4 900A92            MOV      DPTR,#bSeqNo
B1:00A3D7 E0                MOVX     A,@DPTR
B1:00A3D8 4F                ORL      A,R7
B1:00A3D9 9134              ACALL    ?L?COM0010
B1:00A3DB 2402              ADD      A,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 266


B1:00A3DD 1285F5            LCALL    ?L?COM0004
B1:00A3E0 30E018            JNB      ACC.0,?C0102?ZW_TRANSPORT
B1:00A3E3 9137              ACALL    ?L?COM0011
B1:00A3E5 24B7              ADD      A,#0B7H
B1:00A3E7 1285F5            LCALL    ?L?COM0004
B1:00A3EA 4440              ORL      A,#040H
B1:00A3EC 12203B            LCALL    ?C?CSTPTR
B1:00A3EF 800A              SJMP     ?C0102?ZW_TRANSPORT
B1:00A3F1         ?C0099?ZW_TRANSPORT:
B1:00A3F1 9137              ACALL    ?L?COM0011
B1:00A3F3 12DFF3            LCALL    ?L?COM034E
B1:00A3F6 74FF              MOV      A,#0FFH
B1:00A3F8 121FE6            LCALL    ?C?CILDPTR
B1:00A3FB         ?C0102?ZW_TRANSPORT:
B1:00A3FB 9137              ACALL    ?L?COM0011
B1:00A3FD 913F              ACALL    ?L?COM0181
B1:00A3FF 9134              ACALL    ?L?COM0010
B1:00A401 9148              ACALL    ?L?COM02DD
B1:00A403 7411              MOV      A,#011H
B1:00A405 9134              ACALL    ?L?COM0010
B1:00A407 24B1              ADD      A,#0B1H
B1:00A409 1285F5            LCALL    ?L?COM0004
B1:00A40C FF                MOV      R7,A
B1:00A40D 9137              ACALL    ?L?COM0011
B1:00A40F 24D8              ADD      A,#0D8H
B1:00A411 1285F5            LCALL    ?L?COM0004
B1:00A414 2F                ADD      A,R7
B1:00A415 04                INC      A
B1:00A416 FF                MOV      R7,A
B1:00A417 9137              ACALL    ?L?COM0011
B1:00A419 12E000            LCALL    ?L?COM0484
B1:00A41C EF                MOV      A,R7
B1:00A41D         
B1:00A41D 12203B            LCALL    ?C?CSTPTR
B1:00A420         ?C0103?ZW_TRANSPORT:
B1:00A420 22                RET      
----- FUNCTION _BuildTxHeader (END) -------


----- FUNCTION ?L?COM000F (BEGIN) -----
B1:00A421 FE                MOV      R6,A
B1:00A422 EF                MOV      A,R7
B1:00A423 04                INC      A
B1:00A424 2E                ADD      A,R6
B1:00A425 FE                MOV      R6,A
B1:00A426 900A8F            MOV      DPTR,#pFrame
B1:00A429 122552            LCALL    ?C?PLDXDATA
B1:00A42C E9                MOV      A,R1
B1:00A42D 24B9              ADD      A,#0B9H
B1:00A42F F9                MOV      R1,A
B1:00A430 E4                CLR      A
B1:00A431 3A                ADDC     A,R2
B1:00A432 FA                MOV      R2,A
B1:00A433 EE                MOV      A,R6
B1:00A434         ?L?COM0010:
B1:00A434 12203B            LCALL    ?C?CSTPTR
B1:00A437         ?L?COM0011:
B1:00A437 900A8F            MOV      DPTR,#pFrame
B1:00A43A 122552            LCALL    ?C?PLDXDATA
B1:00A43D E9                MOV      A,R1
B1:00A43E 22                RET      
----- FUNCTION ?L?COM000F (END) -------


----- FUNCTION ?L?COM0181 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 267


B1:00A43F 2401              ADD      A,#01H
B1:00A441         ?L?COM0182:
B1:00A441 F9                MOV      R1,A
B1:00A442 E4                CLR      A
B1:00A443 3A                ADDC     A,R2
B1:00A444 FA                MOV      R2,A
B1:00A445 7401              MOV      A,#01H
B1:00A447 22                RET      
----- FUNCTION ?L?COM0181 (END) -------


----- FUNCTION ?L?COM02DD (BEGIN) -----
B1:00A448 24D8              ADD      A,#0D8H
B1:00A44A F9                MOV      R1,A
B1:00A44B E4                CLR      A
B1:00A44C 3A                ADDC     A,R2
B1:00A44D FA                MOV      R2,A
B1:00A44E 22                RET      
----- FUNCTION ?L?COM02DD (END) -------


----- FUNCTION RetransmitFail (BEGIN) -----
B1:00A44F 12851B            LCALL    ?L?COM000C
B1:00A452 4A                ORL      A,R2
B1:00A453 C3                CLR      C
B1:00A454 6001              JZ       ?C0204?ZW_TRANSPORT
B1:00A456 D3                SETB     C
B1:00A457         ?C0204?ZW_TRANSPORT:
B1:00A457         ?C0205?ZW_TRANSPORT:
B1:00A457 4002              JC       $ + 4H
B1:00A459 E198              AJMP     ?C0206?ZW_TRANSPORT
B1:00A45B         ?C0203?ZW_TRANSPORT:
B1:00A45B E9                MOV      A,R1
B1:00A45C 24B7              ADD      A,#0B7H
B1:00A45E 1285F5            LCALL    ?L?COM0004
B1:00A461 FF                MOV      R7,A
B1:00A462 7B01              MOV      R3,#01H
B1:00A464 7A0A              MOV      R2,#HIGH frameType
B1:00A466 79E6              MOV      R1,#LOW frameType
B1:00A468 12D791            LCALL    _ConvertHeaderInfoToFrameType
B1:00A46B 30060D            JNB      bApplicationTxAbort,?C0207?ZW_TRANSPORT
B1:00A46E 12851B            LCALL    ?L?COM000C
B1:00A471 2402              ADD      A,#02H
B1:00A473 1285F5            LCALL    ?L?COM0004
B1:00A476 30E502            JNB      ACC.5,$ + 5H
B1:00A479 A1E9              AJMP     ?C0208?ZW_TRANSPORT
B1:00A47B         ?C0207?ZW_TRANSPORT:
B1:00A47B 12851B            LCALL    ?L?COM000C
B1:00A47E 24B6              ADD      A,#0B6H
B1:00A480 1285F5            LCALL    ?L?COM0004
B1:00A483 12D707            LCALL    ?L?COM0183
B1:00A486 7046              JNZ      ?C0209?ZW_TRANSPORT
B1:00A488 12851B            LCALL    ?L?COM000C
B1:00A48B 24B7              ADD      A,#0B7H
B1:00A48D 1285F5            LCALL    ?L?COM0004
B1:00A490 30E73B            JNB      ACC.7,?C0209?ZW_TRANSPORT
B1:00A493 12851B            LCALL    ?L?COM000C
B1:00A496 1252F2            LCALL    ?L?COM0020
B1:00A499 12F677            LCALL    ?L?COM0542
B1:00A49C 7030              JNZ      ?C0209?ZW_TRANSPORT
B1:00A49E 12851B            LCALL    ?L?COM000C
B1:00A4A1 24B9              ADD      A,#0B9H
B1:00A4A3 1285F5            LCALL    ?L?COM0004
B1:00A4A6 D3                SETB     C
B1:00A4A7 9440              SUBB     A,#040H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 268


B1:00A4A9 5023              JNC      ?C0209?ZW_TRANSPORT
B1:00A4AB 12851B            LCALL    ?L?COM000C
B1:00A4AE 125D39            LCALL    ?L?COM00E6
B1:00A4B1 EF                MOV      A,R7
B1:00A4B2 54F8              ANL      A,#0F8H
B1:00A4B4 4402              ORL      A,#02H
B1:00A4B6 FF                MOV      R7,A
B1:00A4B7 12C951            LCALL    ?L?COM00B9
B1:00A4BA 12C746            LCALL    ?L?COM0427
B1:00A4BD EF                MOV      A,R7
B1:00A4BE 4404              ORL      A,#04H
B1:00A4C0 1104              ACALL    ?L?COM0200
B1:00A4C2 12851B            LCALL    ?L?COM000C
B1:00A4C5 24BB              ADD      A,#0BBH
B1:00A4C7 1285F5            LCALL    ?L?COM0004
B1:00A4CA 4410              ORL      A,#010H
B1:00A4CC A1E4              AJMP     ?C0598?ZW_TRANSPORT
B1:00A4CE         ?C0209?ZW_TRANSPORT:
B1:00A4CE 12851B            LCALL    ?L?COM000C
B1:00A4D1 24B7              ADD      A,#0B7H
B1:00A4D3 1285F5            LCALL    ?L?COM0004
B1:00A4D6 30E723            JNB      ACC.7,?C0211?ZW_TRANSPORT
B1:00A4D9 540F              ANL      A,#0FH
B1:00A4DB 6401              XRL      A,#01H
B1:00A4DD 701D              JNZ      ?C0211?ZW_TRANSPORT
B1:00A4DF 121F7C            LCALL    ?C?CLDPTR
B1:00A4E2 30E711            JNB      ACC.7,?C0213?ZW_TRANSPORT
B1:00A4E5 12851B            LCALL    ?L?COM000C
B1:00A4E8 24BB              ADD      A,#0BBH
B1:00A4EA 1285F5            LCALL    ?L?COM0004
B1:00A4ED 30E406            JNB      ACC.4,?C0213?ZW_TRANSPORT
B1:00A4F0 7E00              MOV      R6,#00H
B1:00A4F2 7F01              MOV      R7,#01H
B1:00A4F4 8013              SJMP     ?C0212?ZW_TRANSPORT
B1:00A4F6         ?C0213?ZW_TRANSPORT:
B1:00A4F6 7E00              MOV      R6,#00H
B1:00A4F8 7F00              MOV      R7,#00H
B1:00A4FA         ?C0214?ZW_TRANSPORT:
B1:00A4FA 800D              SJMP     ?C0212?ZW_TRANSPORT
B1:00A4FC         ?C0211?ZW_TRANSPORT:
B1:00A4FC 12851B            LCALL    ?L?COM000C
B1:00A4FF 24B7              ADD      A,#0B7H
B1:00A501 1285F5            LCALL    ?L?COM0004
B1:00A504 5410              ANL      A,#010H
B1:00A506 FF                MOV      R7,A
B1:00A507 7E00              MOV      R6,#00H
B1:00A509         ?C0212?ZW_TRANSPORT:
B1:00A509 EF                MOV      A,R7
B1:00A50A 4E                ORL      A,R6
B1:00A50B 6018              JZ       ?C0210?ZW_TRANSPORT
B1:00A50D 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00A510 1285EF            LCALL    ?L?COM0002
B1:00A513 54FB              ANL      A,#0FBH
B1:00A515 12203B            LCALL    ?C?CSTPTR
B1:00A518 12851B            LCALL    ?L?COM000C
B1:00A51B 1252F2            LCALL    ?L?COM0020
B1:00A51E 54F8              ANL      A,#0F8H
B1:00A520 4403              ORL      A,#03H
B1:00A522 12D08A            LCALL    ?L?COM0240
B1:00A525         ?C0210?ZW_TRANSPORT:
B1:00A525 12851B            LCALL    ?L?COM000C
B1:00A528 2402              ADD      A,#02H
B1:00A52A 1285F5            LCALL    ?L?COM0004
B1:00A52D 20E202            JB       ACC.2,$ + 5H
B1:00A530 A1E9              AJMP     ?C0208?ZW_TRANSPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 269


B1:00A532 12851B            LCALL    ?L?COM000C
B1:00A535 24DF              ADD      A,#0DFH
B1:00A537 1285F5            LCALL    ?L?COM0004
B1:00A53A D3                SETB     C
B1:00A53B 9405              SUBB     A,#05H
B1:00A53D 4002              JC       $ + 4H
B1:00A53F A1E9              AJMP     ?C0208?ZW_TRANSPORT
B1:00A541 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00A544 1285EF            LCALL    ?L?COM0002
B1:00A547 FF                MOV      R7,A
B1:00A548 30E432            JNB      ACC.4,?C0217?ZW_TRANSPORT
B1:00A54B 12851B            LCALL    ?L?COM000C
B1:00A54E 125D52            LCALL    ?L?COM00B1
B1:00A551 EF                MOV      A,R7
B1:00A552 54EF              ANL      A,#0EFH
B1:00A554 12203B            LCALL    ?C?CSTPTR
B1:00A557 12851B            LCALL    ?L?COM000C
B1:00A55A 2406              ADD      A,#06H
B1:00A55C 1252F4            LCALL    ?L?COM0021
B1:00A55F FF                MOV      R7,A
B1:00A560 AEF0              MOV      R6,B
B1:00A562 12851B            LCALL    ?L?COM000C
B1:00A565 2404              ADD      A,#04H
B1:00A567 12C94D            LCALL    ?L?COM00B8
B1:00A56A EF                MOV      A,R7
B1:00A56B 5407              ANL      A,#07H
B1:00A56D 6402              XRL      A,#02H
B1:00A56F C3                CLR      C
B1:00A570 7001              JNZ      ?C0218?ZW_TRANSPORT
B1:00A572 D3                SETB     C
B1:00A573         ?C0218?ZW_TRANSPORT:
B1:00A573         ?C0219?ZW_TRANSPORT:
B1:00A573 12FC9B            LCALL    ?L?COM058E
B1:00A576 900AE6            MOV      DPTR,#frameType
B1:00A579 E0                MOVX     A,@DPTR
B1:00A57A 4F                ORL      A,R7
B1:00A57B E186              AJMP     ?C0599?ZW_TRANSPORT
B1:00A57D         ?C0217?ZW_TRANSPORT:
B1:00A57D 12851B            LCALL    ?L?COM000C
B1:00A580 24DF              ADD      A,#0DFH
B1:00A582 1285F5            LCALL    ?L?COM0004
B1:00A585 D3                SETB     C
B1:00A586 9403              SUBB     A,#03H
B1:00A588 500E              JNC      ?C0220?ZW_TRANSPORT
B1:00A58A 12851B            LCALL    ?L?COM000C
B1:00A58D 24BA              ADD      A,#0BAH
B1:00A58F 1285F5            LCALL    ?L?COM0004
B1:00A592 FF                MOV      R7,A
B1:00A593 128D0F            LCALL    _ReturnRouteFindFirst
B1:00A596 8008              SJMP     ?C0221?ZW_TRANSPORT
B1:00A598         ?C0220?ZW_TRANSPORT:
B1:00A598 90076A            MOV      DPTR,#activeTransmit+01H
B1:00A59B E0                MOVX     A,@DPTR
B1:00A59C 04                INC      A
B1:00A59D 128F87            LCALL    ?L?COM04CB
B1:00A5A0         ?C0221?ZW_TRANSPORT:
B1:00A5A0 12851B            LCALL    ?L?COM000C
B1:00A5A3 12E008            LCALL    ?L?COM02F7
B1:00A5A6 7405              MOV      A,#05H
B1:00A5A8 12203B            LCALL    ?C?CSTPTR
B1:00A5AB 90076A            MOV      DPTR,#activeTransmit+01H
B1:00A5AE E0                MOVX     A,@DPTR
B1:00A5AF F4                CPL      A
B1:00A5B0 6007              JZ       ?C0222?ZW_TRANSPORT
B1:00A5B2 12CFBE            LCALL    TransmitReturnRouteSetup
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 270


B1:00A5B5 5002              JNC      ?C0222?ZW_TRANSPORT
B1:00A5B7 E188              AJMP     ?C0601?ZW_TRANSPORT
B1:00A5B9         ?C0222?ZW_TRANSPORT:
B1:00A5B9 12851B            LCALL    ?L?COM000C
B1:00A5BC 24DF              ADD      A,#0DFH
B1:00A5BE 1285F5            LCALL    ?L?COM0004
B1:00A5C1 C3                CLR      C
B1:00A5C2 9406              SUBB     A,#06H
B1:00A5C4 5023              JNC      ?C0208?ZW_TRANSPORT
B1:00A5C6 12851B            LCALL    ?L?COM000C
B1:00A5C9 1252F2            LCALL    ?L?COM0020
B1:00A5CC 5407              ANL      A,#07H
B1:00A5CE 6402              XRL      A,#02H
B1:00A5D0 C3                CLR      C
B1:00A5D1 7001              JNZ      ?C0225?ZW_TRANSPORT
B1:00A5D3 D3                SETB     C
B1:00A5D4         ?C0225?ZW_TRANSPORT:
B1:00A5D4         ?C0226?ZW_TRANSPORT:
B1:00A5D4 12FC9B            LCALL    ?L?COM058E
B1:00A5D7 EF                MOV      A,R7
B1:00A5D8 4401              ORL      A,#01H
B1:00A5DA 1104              ACALL    ?L?COM0200
B1:00A5DC 12851B            LCALL    ?L?COM000C
B1:00A5DF 12E008            LCALL    ?L?COM02F7
B1:00A5E2 7406              MOV      A,#06H
B1:00A5E4         
B1:00A5E4 12203B            LCALL    ?C?CSTPTR
B1:00A5E7         
B1:00A5E7 E188              AJMP     ?C0601?ZW_TRANSPORT
B1:00A5E9         ?C0208?ZW_TRANSPORT:
B1:00A5E9 300602            JNB      bApplicationTxAbort,$ + 5H
B1:00A5EC E191              AJMP     ?C0227?ZW_TRANSPORT
B1:00A5EE 12851B            LCALL    ?L?COM000C
B1:00A5F1 24DF              ADD      A,#0DFH
B1:00A5F3 1285F5            LCALL    ?L?COM0004
B1:00A5F6 C3                CLR      C
B1:00A5F7 9407              SUBB     A,#07H
B1:00A5F9 4002              JC       $ + 4H
B1:00A5FB E191              AJMP     ?C0227?ZW_TRANSPORT
B1:00A5FD 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00A600 1285EF            LCALL    ?L?COM0002
B1:00A603 20E002            JB       ACC.0,$ + 5H
B1:00A606 E191              AJMP     ?C0227?ZW_TRANSPORT
B1:00A608 12851B            LCALL    ?L?COM000C
B1:00A60B 24B6              ADD      A,#0B6H
B1:00A60D 1285F5            LCALL    ?L?COM0004
B1:00A610 FF                MOV      R7,A
B1:00A611 C007              PUSH     AR7
B1:00A613 12851B            LCALL    ?L?COM000C
B1:00A616 24BA              ADD      A,#0BAH
B1:00A618 1285F5            LCALL    ?L?COM0004
B1:00A61B FD                MOV      R5,A
B1:00A61C 12851B            LCALL    ?L?COM000C
B1:00A61F 12BC01            LCALL    ?L?COM0123
B1:00A622 C003              PUSH     AR3
B1:00A624 C002              PUSH     AR2
B1:00A626 C001              PUSH     AR1
B1:00A628 12851B            LCALL    ?L?COM000C
B1:00A62B 24B1              ADD      A,#0B1H
B1:00A62D 1285F5            LCALL    ?L?COM0004
B1:00A630 900A4F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B1:00A633 12851A            LCALL    ?L?COM000B
B1:00A636 2402              ADD      A,#02H
B1:00A638 1285F5            LCALL    ?L?COM0004
B1:00A63B 5403              ANL      A,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 271


B1:00A63D 4401              ORL      A,#01H
B1:00A63F 900A50            MOV      DPTR,#?_ExploreQueueFrame?BYTE+06H
B1:00A642 12851A            LCALL    ?L?COM000B
B1:00A645 24DC              ADD      A,#0DCH
B1:00A647 1252F4            LCALL    ?L?COM0021
B1:00A64A FF                MOV      R7,A
B1:00A64B 900A51            MOV      DPTR,#?_ExploreQueueFrame?BYTE+07H
B1:00A64E E5F0              MOV      A,B
B1:00A650 F0                MOVX     @DPTR,A
B1:00A651 A3                INC      DPTR
B1:00A652 EF                MOV      A,R7
B1:00A653 F0                MOVX     @DPTR,A
B1:00A654 D001              POP      AR1
B1:00A656 D002              POP      AR2
B1:00A658 D003              POP      AR3
B1:00A65A D007              POP      AR7
B1:00A65C 121BC9            LCALL    ?INTERBANK_TABLE?_ExploreQueueFrame
B1:00A65F EF                MOV      A,R7
B1:00A660 7002              JNZ      $ + 4H
B1:00A662 E191              AJMP     ?C0227?ZW_TRANSPORT
B1:00A664 126DF1            LCALL    ?L?COM0072
B1:00A667 2405              ADD      A,#05H
B1:00A669 1285F5            LCALL    ?L?COM0004
B1:00A66C 4420              ORL      A,#020H
B1:00A66E 126DF0            LCALL    ?L?COM0071
B1:00A671 2429              ADD      A,#029H
B1:00A673 1287AB            LCALL    ?L?COM0015
B1:00A676 126DF1            LCALL    ?L?COM0072
B1:00A679 126F71            LCALL    ?L?COM0405
B1:00A67C 126DF1            LCALL    ?L?COM0072
B1:00A67F 126F0E            LCALL    ?L?COM0382
B1:00A682 12851B            LCALL    ?L?COM000C
B1:00A685 24E9              ADD      A,#0E9H
B1:00A687 1252F4            LCALL    ?L?COM0021
B1:00A68A 126DF0            LCALL    ?L?COM0071
B1:00A68D 126E30            LCALL    ?L?COM01DE
B1:00A690 12D08B            LCALL    ?L?COM0241
B1:00A693 900854            MOV      DPTR,#pExploreQueueElement
B1:00A696 122552            LCALL    ?C?PLDXDATA
B1:00A699 7405              MOV      A,#05H
B1:00A69B 126FF1            LCALL    ?L?COM0475
B1:00A69E 12D910            LCALL    ?L?COM0056
B1:00A6A1 F9                MOV      R1,A
B1:00A6A2 E4                CLR      A
B1:00A6A3 3A                ADDC     A,R2
B1:00A6A4 FA                MOV      R2,A
B1:00A6A5 7407              MOV      A,#07H
B1:00A6A7 75F0D0            MOV      B,#0D0H
B1:00A6AA 1221E8            LCALL    ?C?ISTPTR
B1:00A6AD 12851B            LCALL    ?L?COM000C
B1:00A6B0 12FC5E            LCALL    ?L?COM025D
B1:00A6B3 75F052            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00A6B6 1221E8            LCALL    ?C?ISTPTR
B1:00A6B9 12851B            LCALL    ?L?COM000C
B1:00A6BC 24DC              ADD      A,#0DCH
B1:00A6BE F9                MOV      R1,A
B1:00A6BF E4                CLR      A
B1:00A6C0 3A                ADDC     A,R2
B1:00A6C1 FA                MOV      R2,A
B1:00A6C2 741B              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ExploreComplete
B1:00A6C4 75F0CE            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ExploreComplete
B1:00A6C7 1221E8            LCALL    ?C?ISTPTR
B1:00A6CA 12851B            LCALL    ?L?COM000C
B1:00A6CD 1252F2            LCALL    ?L?COM0020
B1:00A6D0 AEF0              MOV      R6,B
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 272


B1:00A6D2 54F8              ANL      A,#0F8H
B1:00A6D4 FF                MOV      R7,A
B1:00A6D5 12C951            LCALL    ?L?COM00B9
B1:00A6D8 EF                MOV      A,R7
B1:00A6D9 4402              ORL      A,#02H
B1:00A6DB FF                MOV      R7,A
B1:00A6DC 12C951            LCALL    ?L?COM00B9
B1:00A6DF 900854            MOV      DPTR,#pExploreQueueElement
B1:00A6E2 129549            LCALL    ?L?COM0058
B1:00A6E5 1285F5            LCALL    ?L?COM0004
B1:00A6E8 FF                MOV      R7,A
B1:00A6E9 12851B            LCALL    ?L?COM000C
B1:00A6EC 2402              ADD      A,#02H
B1:00A6EE 1287AB            LCALL    ?L?COM0015
B1:00A6F1 126DF1            LCALL    ?L?COM0072
B1:00A6F4 2406              ADD      A,#06H
B1:00A6F6 1285F5            LCALL    ?L?COM0004
B1:00A6F9 FF                MOV      R7,A
B1:00A6FA 7440              MOV      A,#040H
B1:00A6FC C3                CLR      C
B1:00A6FD 9F                SUBB     A,R7
B1:00A6FE 500A              JNC      ?C0229?ZW_TRANSPORT
B1:00A700 12851B            LCALL    ?L?COM000C
B1:00A703 12DFF3            LCALL    ?L?COM034E
B1:00A706 742F              MOV      A,#02FH
B1:00A708 801A              SJMP     ?C0603?ZW_TRANSPORT
B1:00A70A         ?C0229?ZW_TRANSPORT:
B1:00A70A 7411              MOV      A,#011H
B1:00A70C D3                SETB     C
B1:00A70D 9F                SUBB     A,R7
B1:00A70E 500D              JNC      ?C0231?ZW_TRANSPORT
B1:00A710 EF                MOV      A,R7
B1:00A711 24EF              ADD      A,#0EFH
B1:00A713 FF                MOV      R7,A
B1:00A714 12851B            LCALL    ?L?COM000C
B1:00A717 12DFF3            LCALL    ?L?COM034E
B1:00A71A EF                MOV      A,R7
B1:00A71B         
B1:00A71B 8007              SJMP     ?C0603?ZW_TRANSPORT
B1:00A71D         ?C0231?ZW_TRANSPORT:
B1:00A71D 12851B            LCALL    ?L?COM000C
B1:00A720 12DFF3            LCALL    ?L?COM034E
B1:00A723 E4                CLR      A
B1:00A724         
B1:00A724 12203B            LCALL    ?C?CSTPTR
B1:00A727         ?C0230?ZW_TRANSPORT:
B1:00A727 12851B            LCALL    ?L?COM000C
B1:00A72A 24B1              ADD      A,#0B1H
B1:00A72C 1285F5            LCALL    ?L?COM0004
B1:00A72F FF                MOV      R7,A
B1:00A730 12851B            LCALL    ?L?COM000C
B1:00A733 12BC01            LCALL    ?L?COM0123
B1:00A736 C003              PUSH     AR3
B1:00A738 C002              PUSH     AR2
B1:00A73A C001              PUSH     AR1
B1:00A73C 126DF1            LCALL    ?L?COM0072
B1:00A73F 2431              ADD      A,#031H
B1:00A741 F9                MOV      R1,A
B1:00A742 E4                CLR      A
B1:00A743 3A                ADDC     A,R2
B1:00A744 FA                MOV      R2,A
B1:00A745 1287B9            LCALL    ?L?COM003F
B1:00A748 D001              POP      AR1
B1:00A74A D002              POP      AR2
B1:00A74C D003              POP      AR3
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 273


B1:00A74E 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A751 12851B            LCALL    ?L?COM000C
B1:00A754 1256E7            LCALL    ?L?COM018E
B1:00A757 7B01              MOV      R3,#01H
B1:00A759 C003              PUSH     AR3
B1:00A75B C002              PUSH     AR2
B1:00A75D C001              PUSH     AR1
B1:00A75F 126DF1            LCALL    ?L?COM0072
B1:00A762 126F43            LCALL    ?L?COM03B6
B1:00A765 7B01              MOV      R3,#01H
B1:00A767 1287B9            LCALL    ?L?COM003F
B1:00A76A D001              POP      AR1
B1:00A76C D002              POP      AR2
B1:00A76E D003              POP      AR3
B1:00A770 7F11              MOV      R7,#011H
B1:00A772 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00A775 12851B            LCALL    ?L?COM000C
B1:00A778 12E008            LCALL    ?L?COM02F7
B1:00A77B 7407              MOV      A,#07H
B1:00A77D 12203B            LCALL    ?C?CSTPTR
B1:00A780 12C746            LCALL    ?L?COM0427
B1:00A783 EF                MOV      A,R7
B1:00A784 4406              ORL      A,#06H
B1:00A786         
B1:00A786 1104              ACALL    ?L?COM0200
B1:00A788         
B1:00A788 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00A78B 122552            LCALL    ?C?PLDXDATA
B1:00A78E 02C91F            LJMP     _TxQueueQueueElement
B1:00A791         ?C0227?ZW_TRANSPORT:
B1:00A791 F19C              ACALL    ?L?COM00A4
B1:00A793 E4                CLR      A
B1:00A794 FF                MOV      R7,A
B1:00A795 1286C6            LCALL    _TxPermanentlyDone
B1:00A798         ?C0206?ZW_TRANSPORT:
B1:00A798 22                RET      
----- FUNCTION RetransmitFail (END) -------


----- FUNCTION ?L?COM00A3 (BEGIN) -----
B1:00A799 12AAAD            LCALL    _keystore_network_key_write
B1:00A79C         ?L?COM00A4:
B1:00A79C 7B00              MOV      R3,#00H
B1:00A79E 7A00              MOV      R2,#00H
B1:00A7A0 7900              MOV      R1,#00H
B1:00A7A2 22                RET      
----- FUNCTION ?L?COM00A3 (END) -------


----- FUNCTION RearrangeNVMmodules (BEGIN) -----
B1:00A7A3 7E7F              MOV      R6,#HIGH nvmDescriptorUpdate
B1:00A7A5 7FA6              MOV      R7,#LOW nvmDescriptorUpdate
B1:00A7A7 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A7AA EE                MOV      A,R6
B1:00A7AB F0                MOVX     @DPTR,A
B1:00A7AC A3                INC      DPTR
B1:00A7AD EF                MOV      A,R7
B1:00A7AE F0                MOVX     @DPTR,A
B1:00A7AF F582              MOV      DPL,A
B1:00A7B1 8E83              MOV      DPH,R6
B1:00A7B3 12AD0A            LCALL    ?L?COM020B
B1:00A7B6 607E              JZ       ?C0018?ZW_NVM_REARRANGE
B1:00A7B8 123877            LCALL    ?L?COM0099
B1:00A7BB 90403B            MOV      DPTR,#dataLengthOld
B1:00A7BE E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 274


B1:00A7BF FE                MOV      R6,A
B1:00A7C0 A3                INC      DPTR
B1:00A7C1 E0                MOVX     A,@DPTR
B1:00A7C2 90402C            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00A7C5 126EFE            LCALL    ?L?COM0376
B1:00A7C8 E4                CLR      A
B1:00A7C9 3A                ADDC     A,R2
B1:00A7CA FA                MOV      R2,A
B1:00A7CB 904035            MOV      DPTR,#nvmDescriptorOldPtr
B1:00A7CE 122572            LCALL    ?C?PSTXDATA
B1:00A7D1 12ADA6            LCALL    ?L?COM045E
B1:00A7D4 7A40              MOV      R2,#HIGH wValidation
B1:00A7D6 7943              MOV      R1,#LOW wValidation
B1:00A7D8 123887            LCALL    ?L?COM009A
B1:00A7DB 904043            MOV      DPTR,#wValidation
B1:00A7DE E0                MOVX     A,@DPTR
B1:00A7DF FE                MOV      R6,A
B1:00A7E0 A3                INC      DPTR
B1:00A7E1 E0                MOVX     A,@DPTR
B1:00A7E2 FF                MOV      R7,A
B1:00A7E3 907FC0            MOV      DPTR,#firmwareDescriptor+08H
B1:00A7E6 7401              MOV      A,#01H
B1:00A7E8 93                MOVC     A,@A+DPTR
B1:00A7E9 6F                XRL      A,R7
B1:00A7EA 7003              JNZ      ?C0047?ZW_NVM_REARRANGE
B1:00A7EC E4                CLR      A
B1:00A7ED 93                MOVC     A,@A+DPTR
B1:00A7EE 6E                XRL      A,R6
B1:00A7EF         ?C0047?ZW_NVM_REARRANGE:
B1:00A7EF 7F00              MOV      R7,#00H
B1:00A7F1 6002              JZ       ?C0019?ZW_NVM_REARRANGE
B1:00A7F3 7F01              MOV      R7,#01H
B1:00A7F5         ?C0019?ZW_NVM_REARRANGE:
B1:00A7F5         ?C0020?ZW_NVM_REARRANGE:
B1:00A7F5 90403A            MOV      DPTR,#retVal
B1:00A7F8 EF                MOV      A,R7
B1:00A7F9 F0                MOVX     @DPTR,A
B1:00A7FA 904035            MOV      DPTR,#nvmDescriptorOldPtr
B1:00A7FD 129557            LCALL    ?L?COM003C
B1:00A800 1287D7            LCALL    ?L?COM02D1
B1:00A803 7B01              MOV      R3,#01H
B1:00A805 7A40              MOV      R2,#HIGH wValidation
B1:00A807 7943              MOV      R1,#LOW wValidation
B1:00A809 123887            LCALL    ?L?COM009A
B1:00A80C 90403A            MOV      DPTR,#retVal
B1:00A80F E0                MOVX     A,@DPTR
B1:00A810 FF                MOV      R7,A
B1:00A811 904043            MOV      DPTR,#wValidation
B1:00A814 E0                MOVX     A,@DPTR
B1:00A815 FC                MOV      R4,A
B1:00A816 A3                INC      DPTR
B1:00A817 E0                MOVX     A,@DPTR
B1:00A818 FD                MOV      R5,A
B1:00A819 907FC2            MOV      DPTR,#firmwareDescriptor+0AH
B1:00A81C 7401              MOV      A,#01H
B1:00A81E 93                MOVC     A,@A+DPTR
B1:00A81F 6D                XRL      A,R5
B1:00A820 7003              JNZ      ?C0048?ZW_NVM_REARRANGE
B1:00A822 E4                CLR      A
B1:00A823 93                MOVC     A,@A+DPTR
B1:00A824 6C                XRL      A,R4
B1:00A825         ?C0048?ZW_NVM_REARRANGE:
B1:00A825 7E00              MOV      R6,#00H
B1:00A827 6002              JZ       ?C0021?ZW_NVM_REARRANGE
B1:00A829 7E01              MOV      R6,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 275


B1:00A82B         ?C0021?ZW_NVM_REARRANGE:
B1:00A82B         ?C0022?ZW_NVM_REARRANGE:
B1:00A82B EF                MOV      A,R7
B1:00A82C 4E                ORL      A,R6
B1:00A82D 90403A            MOV      DPTR,#retVal
B1:00A830 F0                MOVX     @DPTR,A
B1:00A831 6003              JZ       ?C0018?ZW_NVM_REARRANGE
B1:00A833 7F00              MOV      R7,#00H
B1:00A835 22                RET      
B1:00A836         ?C0018?ZW_NVM_REARRANGE:
B1:00A836 B1E6              ACALL    ?L?COM0141
B1:00A838 AE02              MOV      R6,AR2
B1:00A83A AF01              MOV      R7,AR1
B1:00A83C AC02              MOV      R4,AR2
B1:00A83E AD01              MOV      R5,AR1
B1:00A840 E0                MOVX     A,@DPTR
B1:00A841 2D                ADD      A,R5
B1:00A842 FD                MOV      R5,A
B1:00A843 90403D            MOV      DPTR,#dataLengthNew
B1:00A846 E0                MOVX     A,@DPTR
B1:00A847 3C                ADDC     A,R4
B1:00A848 CD                XCH      A,R5
B1:00A849 2402              ADD      A,#02H
B1:00A84B CD                XCH      A,R5
B1:00A84C 3400              ADDC     A,#00H
B1:00A84E FC                MOV      R4,A
B1:00A84F 712D              ACALL    _CinitNVMvariables
B1:00A851 B116              ACALL    ?L?COM020C
B1:00A853 7002              JNZ      $ + 4H
B1:00A855 01FC              AJMP     ?C0025?ZW_NVM_REARRANGE
B1:00A857 01EF              AJMP     ?C0031?ZW_NVM_REARRANGE
B1:00A859         ?C0026?ZW_NVM_REARRANGE:
B1:00A859 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A85C 12CF82            LCALL    ?L?COM0327
B1:00A85F 947E              SUBB     A,#LOW nvmZWlibraryUpdate
B1:00A861 EC                MOV      A,R4
B1:00A862 947F              SUBB     A,#HIGH nvmZWlibraryUpdate
B1:00A864 5002              JNC      $ + 4H
B1:00A866 413F              AJMP     ?C0032?ZW_NVM_REARRANGE
B1:00A868 B1E6              ACALL    ?L?COM0141
B1:00A86A 8D82              MOV      DPL,R5
B1:00A86C 8C83              MOV      DPH,R4
B1:00A86E B10A              ACALL    ?L?COM020B
B1:00A870 6039              JZ       ?C0028?ZW_NVM_REARRANGE
B1:00A872 123877            LCALL    ?L?COM0099
B1:00A875 90403B            MOV      DPTR,#dataLengthOld
B1:00A878 E0                MOVX     A,@DPTR
B1:00A879 FE                MOV      R6,A
B1:00A87A A3                INC      DPTR
B1:00A87B E0                MOVX     A,@DPTR
B1:00A87C 90402C            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00A87F 12F31C            LCALL    ?L?COM01B7
B1:00A882 C3                CLR      C
B1:00A883 E9                MOV      A,R1
B1:00A884 9F                SUBB     A,R7
B1:00A885 F9                MOV      R1,A
B1:00A886 EA                MOV      A,R2
B1:00A887 9E                SUBB     A,R6
B1:00A888 FA                MOV      R2,A
B1:00A889 516B              ACALL    ?L?COM02CE
B1:00A88B 904032            MOV      DPTR,#nvmModuleOldPtr
B1:00A88E 122552            LCALL    ?C?PLDXDATA
B1:00A891 C003              PUSH     AR3
B1:00A893 C002              PUSH     AR2
B1:00A895 C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 276


B1:00A897 5163              ACALL    ?L?COM012C
B1:00A899 D3                SETB     C
B1:00A89A D082              POP      DPL
B1:00A89C D083              POP      DPH
B1:00A89E D0E0              POP      ACC
B1:00A8A0 127012            LCALL    ?L?COM04A9
B1:00A8A3         ?C0051?ZW_NVM_REARRANGE:
B1:00A8A3 4011              JC       ?C0030?ZW_NVM_REARRANGE
B1:00A8A5 5151              ACALL    ?L?COM012B
B1:00A8A7 D10F              ACALL    ?L?COM02A2
B1:00A8A9 800B              SJMP     ?C0030?ZW_NVM_REARRANGE
B1:00A8AB         ?C0028?ZW_NVM_REARRANGE:
B1:00A8AB 90403B            MOV      DPTR,#dataLengthOld
B1:00A8AE 126FDC            LCALL    ?L?COM0466
B1:00A8B1 12A79C            LCALL    ?L?COM00A4
B1:00A8B4 516B              ACALL    ?L?COM02CE
B1:00A8B6         ?C0030?ZW_NVM_REARRANGE:
B1:00A8B6 12FE36            LCALL    ?L?COM0315
B1:00A8B9 E0                MOVX     A,@DPTR
B1:00A8BA 9E                SUBB     A,R6
B1:00A8BB 4032              JC       ?C0031?ZW_NVM_REARRANGE
B1:00A8BD 5163              ACALL    ?L?COM012C
B1:00A8BF 12EAAE            LCALL    ?L?COM0401
B1:00A8C2 3A                ADDC     A,R2
B1:00A8C3 CF                XCH      A,R7
B1:00A8C4 24FB              ADD      A,#0FBH
B1:00A8C6 CF                XCH      A,R7
B1:00A8C7 34FF              ADDC     A,#0FFH
B1:00A8C9 FE                MOV      R6,A
B1:00A8CA C006              PUSH     AR6
B1:00A8CC 12A79C            LCALL    ?L?COM00A4
B1:00A8CF 12ED8F            LCALL    ?L?COM0271
B1:00A8D2 D006              POP      AR6
B1:00A8D4 1239FB            LCALL    _NVM_ext_write_buffer
B1:00A8D7 5163              ACALL    ?L?COM012C
B1:00A8D9 12EB1A            LCALL    ?L?COM0403
B1:00A8DC CF                XCH      A,R7
B1:00A8DD 24FB              ADD      A,#0FBH
B1:00A8DF CF                XCH      A,R7
B1:00A8E0 34FF              ADDC     A,#0FFH
B1:00A8E2 7120              ACALL    ?L?COM0338
B1:00A8E4 5163              ACALL    ?L?COM012C
B1:00A8E6 AE02              MOV      R6,AR2
B1:00A8E8 AF01              MOV      R7,AR1
B1:00A8EA B1AD              ACALL    ?L?COM0174
B1:00A8EC 1239F8            LCALL    ?L?COM0481
B1:00A8EF         ?C0031?ZW_NVM_REARRANGE:
B1:00A8EF 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A8F2 74FF              MOV      A,#0FFH
B1:00A8F4 75F0F6            MOV      B,#0F6H
B1:00A8F7 12210C            LCALL    ?C?IILDX
B1:00A8FA 0159              AJMP     ?C0026?ZW_NVM_REARRANGE
B1:00A8FC         ?C0025?ZW_NVM_REARRANGE:
B1:00A8FC 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A8FF 747F              MOV      A,#HIGH nvmZWlibraryUpdate
B1:00A901 F0                MOVX     @DPTR,A
B1:00A902 A3                INC      DPTR
B1:00A903 747E              MOV      A,#LOW nvmZWlibraryUpdate
B1:00A905 F0                MOVX     @DPTR,A
B1:00A906         ?C0033?ZW_NVM_REARRANGE:
B1:00A906 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A909 12CF82            LCALL    ?L?COM0327
B1:00A90C 94A6              SUBB     A,#LOW nvmDescriptorUpdate
B1:00A90E EC                MOV      A,R4
B1:00A90F 947F              SUBB     A,#HIGH nvmDescriptorUpdate
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 277


B1:00A911 4002              JC       $ + 4H
B1:00A913 413F              AJMP     ?C0032?ZW_NVM_REARRANGE
B1:00A915 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A918 12FC74            LCALL    ?L?COM0352
B1:00A91B 12257B            LCALL    ?C?PLDCODE
B1:00A91E 90402F            MOV      DPTR,#nvmModuleNewPtr
B1:00A921 122572            LCALL    ?C?PSTXDATA
B1:00A924 8F82              MOV      DPL,R7
B1:00A926 8E83              MOV      DPH,R6
B1:00A928 7406              MOV      A,#06H
B1:00A92A 93                MOVC     A,@A+DPTR
B1:00A92B 24FE              ADD      A,#0FEH
B1:00A92D FE                MOV      R6,A
B1:00A92E 7405              MOV      A,#05H
B1:00A930 93                MOVC     A,@A+DPTR
B1:00A931 34FF              ADDC     A,#0FFH
B1:00A933 90403D            MOV      DPTR,#dataLengthNew
B1:00A936 F0                MOVX     @DPTR,A
B1:00A937 A3                INC      DPTR
B1:00A938 CE                XCH      A,R6
B1:00A939 F0                MOVX     @DPTR,A
B1:00A93A 12E6EF            LCALL    ?L?COM052D
B1:00A93D FF                MOV      R7,A
B1:00A93E 7404              MOV      A,#04H
B1:00A940 93                MOVC     A,@A+DPTR
B1:00A941 90403B            MOV      DPTR,#dataLengthOld
B1:00A944 CF                XCH      A,R7
B1:00A945 F0                MOVX     @DPTR,A
B1:00A946 A3                INC      DPTR
B1:00A947 EF                MOV      A,R7
B1:00A948 F0                MOVX     @DPTR,A
B1:00A949 90403B            MOV      DPTR,#dataLengthOld
B1:00A94C F128              ACALL    ?L?COM01C2
B1:00A94E 7002              JNZ      $ + 4H
B1:00A950 21E3              AJMP     ?C0035?ZW_NVM_REARRANGE
B1:00A952 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A955 128FE9            LCALL    ?L?COM0209
B1:00A958 7407              MOV      A,#07H
B1:00A95A 93                MOVC     A,@A+DPTR
B1:00A95B 24FC              ADD      A,#0FCH
B1:00A95D 601B              JZ       ?C0038?ZW_NVM_REARRANGE
B1:00A95F 14                DEC      A
B1:00A960 6026              JZ       ?C0039?ZW_NVM_REARRANGE
B1:00A962 2403              ADD      A,#03H
B1:00A964 7039              JNZ      ?C0040?ZW_NVM_REARRANGE
B1:00A966         ?C0037?ZW_NVM_REARRANGE:
B1:00A966 7A00              MOV      R2,#HIGH _FD_ZW_NVM_S_
B1:00A968 7900              MOV      R1,#LOW _FD_ZW_NVM_S_
B1:00A96A 5169              ACALL    ?L?COM02CD
B1:00A96C 5163              ACALL    ?L?COM012C
B1:00A96E C3                CLR      C
B1:00A96F EF                MOV      A,R7
B1:00A970 99                SUBB     A,R1
B1:00A971 FF                MOV      R7,A
B1:00A972 EE                MOV      A,R6
B1:00A973 B1C5              ACALL    ?L?COM02BA
B1:00A975 90403B            MOV      DPTR,#dataLengthOld
B1:00A978 8018              SJMP     ?C0056?ZW_NVM_REARRANGE
B1:00A97A         ?C0038?ZW_NVM_REARRANGE:
B1:00A97A 7B01              MOV      R3,#01H
B1:00A97C 7A60              MOV      R2,#HIGH _FD_ZW_NVM_S_+06000H
B1:00A97E 7900              MOV      R1,#LOW _FD_ZW_NVM_S_+06000H
B1:00A980 516B              ACALL    ?L?COM02CE
B1:00A982 5163              ACALL    ?L?COM012C
B1:00A984 B1BA              ACALL    ?L?COM02B9
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 278


B1:00A986         
B1:00A986 800A              SJMP     ?C0056?ZW_NVM_REARRANGE
B1:00A988         ?C0039?ZW_NVM_REARRANGE:
B1:00A988 7A60              MOV      R2,#HIGH _FD_ZW_NVM_S_+06040H
B1:00A98A 7940              MOV      R1,#LOW _FD_ZW_NVM_S_+06040H
B1:00A98C 5169              ACALL    ?L?COM02CD
B1:00A98E 5163              ACALL    ?L?COM012C
B1:00A990 B1BA              ACALL    ?L?COM02B9
B1:00A992         
B1:00A992 F0                MOVX     @DPTR,A
B1:00A993 A3                INC      DPTR
B1:00A994 EF                MOV      A,R7
B1:00A995 F0                MOVX     @DPTR,A
B1:00A996 125D47            LCALL    ?L?COM03C9
B1:00A999 FA                MOV      R2,A
B1:00A99A 90402F            MOV      DPTR,#nvmModuleNewPtr
B1:00A99D 800D              SJMP     ?C0057?ZW_NVM_REARRANGE
B1:00A99F         ?C0040?ZW_NVM_REARRANGE:
B1:00A99F E4                CLR      A
B1:00A9A0 90403B            MOV      DPTR,#dataLengthOld
B1:00A9A3 F0                MOVX     @DPTR,A
B1:00A9A4 A3                INC      DPTR
B1:00A9A5 F0                MOVX     @DPTR,A
B1:00A9A6 FB                MOV      R3,A
B1:00A9A7 FA                MOV      R2,A
B1:00A9A8 F9                MOV      R1,A
B1:00A9A9 904032            MOV      DPTR,#nvmModuleOldPtr
B1:00A9AC         
B1:00A9AC 122572            LCALL    ?C?PSTXDATA
B1:00A9AF         ?C0036?ZW_NVM_REARRANGE:
B1:00A9AF 904032            MOV      DPTR,#nvmModuleOldPtr
B1:00A9B2 126EC6            LCALL    ?L?COM0353
B1:00A9B5 5163              ACALL    ?L?COM012C
B1:00A9B7 E9                MOV      A,R1
B1:00A9B8 6F                XRL      A,R7
B1:00A9B9 7002              JNZ      ?C0052?ZW_NVM_REARRANGE
B1:00A9BB EA                MOV      A,R2
B1:00A9BC 6E                XRL      A,R6
B1:00A9BD         ?C0052?ZW_NVM_REARRANGE:
B1:00A9BD 6004              JZ       ?C0041?ZW_NVM_REARRANGE
B1:00A9BF 5151              ACALL    ?L?COM012B
B1:00A9C1 D10F              ACALL    ?L?COM02A2
B1:00A9C3         ?C0041?ZW_NVM_REARRANGE:
B1:00A9C3 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00A9C6 B101              ACALL    ?L?COM00CE
B1:00A9C8 7407              MOV      A,#07H
B1:00A9CA 93                MOVC     A,@A+DPTR
B1:00A9CB 6402              XRL      A,#02H
B1:00A9CD 701F              JNZ      ?C0043?ZW_NVM_REARRANGE
B1:00A9CF 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_VALID_far
B1:00A9D1 7F09              MOV      R7,#LOW NVM_CONFIGURATION_VALID_far
B1:00A9D3 7D54              MOV      R5,#054H
B1:00A9D5 12444A            LCALL    _NVM_ext_write_byte
B1:00A9D8 7E00              MOV      R6,#HIGH NVM_CONFIGURATION_REALLYVALID_far
B1:00A9DA 7F0A              MOV      R7,#LOW NVM_CONFIGURATION_REALLYVALID_far
B1:00A9DC 7DA5              MOV      R5,#0A5H
B1:00A9DE 12444A            LCALL    _NVM_ext_write_byte
B1:00A9E1 800B              SJMP     ?C0043?ZW_NVM_REARRANGE
B1:00A9E3         ?C0035?ZW_NVM_REARRANGE:
B1:00A9E3 90403B            MOV      DPTR,#dataLengthOld
B1:00A9E6 126FDC            LCALL    ?L?COM0466
B1:00A9E9 12A79C            LCALL    ?L?COM00A4
B1:00A9EC 516B              ACALL    ?L?COM02CE
B1:00A9EE         ?C0043?ZW_NVM_REARRANGE:
B1:00A9EE 12FE36            LCALL    ?L?COM0315
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 279


B1:00A9F1 E0                MOVX     A,@DPTR
B1:00A9F2 9E                SUBB     A,R6
B1:00A9F3 403E              JC       ?C0044?ZW_NVM_REARRANGE
B1:00A9F5 5163              ACALL    ?L?COM012C
B1:00A9F7 12EAAE            LCALL    ?L?COM0401
B1:00A9FA 3A                ADDC     A,R2
B1:00A9FB FE                MOV      R6,A
B1:00A9FC C006              PUSH     AR6
B1:00A9FE 12A79C            LCALL    ?L?COM00A4
B1:00AA01 12ED8F            LCALL    ?L?COM0271
B1:00AA04 D006              POP      AR6
B1:00AA06 1239FB            LCALL    _NVM_ext_write_buffer
B1:00AA09 5163              ACALL    ?L?COM012C
B1:00AA0B 12EB1A            LCALL    ?L?COM0403
B1:00AA0E 7120              ACALL    ?L?COM0338
B1:00AA10 5163              ACALL    ?L?COM012C
B1:00AA12 E9                MOV      A,R1
B1:00AA13 24FE              ADD      A,#0FEH
B1:00AA15 F9                MOV      R1,A
B1:00AA16 EA                MOV      A,R2
B1:00AA17 34FF              ADDC     A,#0FFH
B1:00AA19 FA                MOV      R2,A
B1:00AA1A 90402F            MOV      DPTR,#nvmModuleNewPtr
B1:00AA1D 122572            LCALL    ?C?PSTXDATA
B1:00AA20 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00AA23 B101              ACALL    ?L?COM00CE
B1:00AA25 B1FF              ACALL    ?L?COM0142
B1:00AA27 AE02              MOV      R6,AR2
B1:00AA29 AF01              MOV      R7,AR1
B1:00AA2B B1AD              ACALL    ?L?COM0174
B1:00AA2D 7402              MOV      A,#02H
B1:00AA2F F0                MOVX     @DPTR,A
B1:00AA30 1239FB            LCALL    _NVM_ext_write_buffer
B1:00AA33         ?C0044?ZW_NVM_REARRANGE:
B1:00AA33 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00AA36 E4                CLR      A
B1:00AA37 75F00A            MOV      B,#0AH
B1:00AA3A 12210C            LCALL    ?C?IILDX
B1:00AA3D 2106              AJMP     ?C0033?ZW_NVM_REARRANGE
B1:00AA3F         ?C0032?ZW_NVM_REARRANGE:
B1:00AA3F 90403D            MOV      DPTR,#dataLengthNew
B1:00AA42 12706C            LCALL    ?L?COM0552
B1:00AA45 7E00              MOV      R6,#HIGH nvmTotalEnd
B1:00AA47 7F00              MOV      R7,#LOW nvmTotalEnd
B1:00AA49 B1AD              ACALL    ?L?COM0174
B1:00AA4B 1239F8            LCALL    ?L?COM0481
B1:00AA4E 7F02              MOV      R7,#02H
B1:00AA50 22                RET      
----- FUNCTION RearrangeNVMmodules (END) -------


----- FUNCTION ?L?COM012B (BEGIN) -----
B1:00AA51 904032            MOV      DPTR,#nvmModuleOldPtr
B1:00AA54 122552            LCALL    ?C?PLDXDATA
B1:00AA57 AE02              MOV      R6,AR2
B1:00AA59 AF01              MOV      R7,AR1
B1:00AA5B 90403F            MOV      DPTR,#NVM_WorkPtrRead
B1:00AA5E EE                MOV      A,R6
B1:00AA5F F0                MOVX     @DPTR,A
B1:00AA60 A3                INC      DPTR
B1:00AA61 EF                MOV      A,R7
B1:00AA62 F0                MOVX     @DPTR,A
B1:00AA63         ?L?COM012C:
B1:00AA63 90402F            MOV      DPTR,#nvmModuleNewPtr
B1:00AA66 022552            LJMP     ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 280


----- FUNCTION ?L?COM012B (END) -------


----- FUNCTION ?L?COM02CD (BEGIN) -----
B1:00AA69 7B01              MOV      R3,#01H
B1:00AA6B         ?L?COM02CE:
B1:00AA6B 904032            MOV      DPTR,#nvmModuleOldPtr
B1:00AA6E 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM02CD (END) -------


----- FUNCTION _keystore_network_key_clear (BEGIN) -----
B1:00AA71 9046A7            MOV      DPTR,#keyclass
B1:00AA74 EF                MOV      A,R7
B1:00AA75 F0                MOVX     @DPTR,A
B1:00AA76 F4                CPL      A
B1:00AA77 7018              JNZ      ?C0024?ZW_KEYSTORE
B1:00AA79 FB                MOV      R3,A
B1:00AA7A FA                MOV      R2,A
B1:00AA7B F9                MOV      R1,A
B1:00AA7C 7F01              MOV      R7,#01H
B1:00AA7E 12A799            LCALL    ?L?COM00A3
B1:00AA81 7F02              MOV      R7,#02H
B1:00AA83 12A799            LCALL    ?L?COM00A3
B1:00AA86 7F04              MOV      R7,#04H
B1:00AA88 12A799            LCALL    ?L?COM00A3
B1:00AA8B 7F80              MOV      R7,#080H
B1:00AA8D 51AD              ACALL    _keystore_network_key_write
B1:00AA8F 800F              SJMP     ?C0025?ZW_KEYSTORE
B1:00AA91         ?C0024?ZW_KEYSTORE:
B1:00AA91 9046A7            MOV      DPTR,#keyclass
B1:00AA94 E0                MOVX     A,@DPTR
B1:00AA95 FF                MOV      R7,A
B1:00AA96 12A79C            LCALL    ?L?COM00A4
B1:00AA99 51AD              ACALL    _keystore_network_key_write
B1:00AA9B EF                MOV      A,R7
B1:00AA9C 7002              JNZ      ?C0025?ZW_KEYSTORE
B1:00AA9E FF                MOV      R7,A
B1:00AA9F 22                RET      
B1:00AAA0         ?C0025?ZW_KEYSTORE:
B1:00AAA0 F12F              ACALL    ?L?COM02EC
B1:00AAA2 9046A7            MOV      DPTR,#keyclass
B1:00AAA5 E0                MOVX     A,@DPTR
B1:00AAA6 F4                CPL      A
B1:00AAA7 5F                ANL      A,R7
B1:00AAA8 F10A              ACALL    ?L?COM03E8
B1:00AAAA 7F01              MOV      R7,#01H
B1:00AAAC 22                RET      
----- FUNCTION _keystore_network_key_clear (END) -------


----- FUNCTION _keystore_network_key_write (BEGIN) -----
B1:00AAAD 904600            MOV      DPTR,#keybuf
B1:00AAB0 122572            LCALL    ?C?PSTXDATA
;---- Variable 'key_class' assigned to Register 'R7' ----
B1:00AAB3 904600            MOV      DPTR,#keybuf
B1:00AAB6 122552            LCALL    ?C?PLDXDATA
B1:00AAB9 90434E            MOV      DPTR,#?_keystore_network_key_write_impl?BYTE+04H
B1:00AABC 12DC47            LCALL    ?L?COM0345
B1:;----                  JMP      _keystore_network_key_write_impl
----- FUNCTION _keystore_network_key_write (END) -------


----- FUNCTION _keystore_network_key_write_impl (BEGIN) -----
B1:00AABF 90434A            MOV      DPTR,#key_class
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 281


B1:00AAC2 12D851            LCALL    ?L?COM01BA
B1:00AAC5 90434A            MOV      DPTR,#key_class
B1:00AAC8 E0                MOVX     A,@DPTR
B1:00AAC9 FF                MOV      R7,A
B1:00AACA 14                DEC      A
B1:00AACB FE                MOV      R6,A
B1:00AACC EF                MOV      A,R7
B1:00AACD 5E                ANL      A,R6
B1:00AACE 7006              JNZ      ?C0016?ZW_KEYSTORE
B1:00AAD0 E0                MOVX     A,@DPTR
B1:00AAD1 FD                MOV      R5,A
B1:00AAD2 5487              ANL      A,#087H
B1:00AAD4 7003              JNZ      ?C0015?ZW_KEYSTORE
B1:00AAD6         ?C0016?ZW_KEYSTORE:
B1:00AAD6 7F00              MOV      R7,#00H
B1:00AAD8 22                RET      
B1:00AAD9         ?C0015?ZW_KEYSTORE:
B1:00AAD9 EE                MOV      A,R6
B1:00AADA C4                SWAP     A
B1:00AADB 13                RRC      A
B1:00AADC 5407              ANL      A,#07H
B1:00AADE FF                MOV      R7,A
B1:00AADF ED                MOV      A,R5
B1:00AAE0 C3                CLR      C
B1:00AAE1 13                RRC      A
B1:00AAE2 4F                ORL      A,R7
B1:00AAE3 5403              ANL      A,#03H
B1:00AAE5 904351            MOV      DPTR,#key_index
B1:00AAE8 F0                MOVX     @DPTR,A
B1:00AAE9 D1F6              ACALL    ?L?COM0512
B1:00AAEB 6008              JZ       ?C0018?ZW_KEYSTORE
B1:00AAED 90434E            MOV      DPTR,#keybuf
B1:00AAF0 D1ED              ACALL    ?L?COM01CA
B1:00AAF2 12DA79            LCALL    ?L?COM03BB
B1:00AAF5         ?C0018?ZW_KEYSTORE:
B1:00AAF5 904351            MOV      DPTR,#key_index
B1:00AAF8 E0                MOVX     A,@DPTR
B1:00AAF9 90434E            MOV      DPTR,#keybuf
B1:00AAFC 12FE48            LCALL    ?L?COM029D
B1:00AAFF 90441D            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B1:00AB02 12CF6E            LCALL    ?L?COM00CC
B1:00AB05 121B9C            LCALL    ?INTERBANK_TABLE?_ZW_MemoryPutBuffer
B1:00AB08 D1F6              ACALL    ?L?COM0512
B1:00AB0A 6008              JZ       ?C0019?ZW_KEYSTORE
B1:00AB0C 90434E            MOV      DPTR,#keybuf
B1:00AB0F D1ED              ACALL    ?L?COM01CA
B1:00AB11 12DA79            LCALL    ?L?COM03BB
B1:00AB14         ?C0019?ZW_KEYSTORE:
B1:00AB14 F12F              ACALL    ?L?COM02EC
B1:00AB16 90434A            MOV      DPTR,#key_class
B1:00AB19 E0                MOVX     A,@DPTR
B1:00AB1A 4F                ORL      A,R7
B1:00AB1B F10A              ACALL    ?L?COM03E8
B1:00AB1D 7F01              MOV      R7,#01H
B1:00AB1F 22                RET      
----- FUNCTION _keystore_network_key_write_impl (END) -------


----- FUNCTION ?L?COM0338 (BEGIN) -----
B1:00AB20 FE                MOV      R6,A
B1:00AB21 90403E            MOV      DPTR,#dataLengthNew+01H
B1:00AB24 E0                MOVX     A,@DPTR
B1:00AB25 29                ADD      A,R1
B1:00AB26 FD                MOV      R5,A
B1:00AB27 90403D            MOV      DPTR,#dataLengthNew
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 282


B1:00AB2A E0                MOVX     A,@DPTR
B1:00AB2B 3A                ADDC     A,R2
B1:00AB2C FC                MOV      R4,A
----- FUNCTION _CinitNVMvariables (BEGIN) -----
B1:00AB2D 904214            MOV      DPTR,#low
B1:00AB30 123C23            LCALL    ?L?COM0146
B1:00AB33 126EBF            LCALL    ?L?COM0349
B1:00AB36 7429              MOV      A,#HIGH _C_INITSEG_S_
B1:00AB38 F0                MOVX     @DPTR,A
B1:00AB39 A3                INC      DPTR
B1:00AB3A 74BC              MOV      A,#LOW _C_INITSEG_S_
B1:00AB3C F0                MOVX     @DPTR,A
B1:00AB3D         ?C0001?ZW_NVM_INIT:
B1:00AB3D 91FE              ACALL    ?L?COM00CD
B1:00AB3F E4                CLR      A
B1:00AB40 93                MOVC     A,@A+DPTR
B1:00AB41 7002              JNZ      $ + 4H
B1:00AB43 8162              AJMP     ?C0017?ZW_NVM_INIT
B1:00AB45 E4                CLR      A
B1:00AB46 93                MOVC     A,@A+DPTR
B1:00AB47 FF                MOV      R7,A
B1:00AB48 541F              ANL      A,#01FH
B1:00AB4A 90421A            MOV      DPTR,#length
B1:00AB4D 12FD42            LCALL    ?L?COM0476
B1:00AB50 EF                MOV      A,R7
B1:00AB51 C4                SWAP     A
B1:00AB52 13                RRC      A
B1:00AB53 5407              ANL      A,#07H
B1:00AB55 12267F            LCALL    ?C?CCASE
B1:00AB58 AB74              DW       ?C0004?ZW_NVM_INIT
B1:00AB5A 00                DB       00H
B1:00AB5B AB76              DW       ?C0005?ZW_NVM_INIT
B1:00AB5D 01                DB       01H
B1:00AB5E AB78              DW       ?C0006?ZW_NVM_INIT
B1:00AB60 02                DB       02H
B1:00AB61 AB80              DW       ?C0007?ZW_NVM_INIT
B1:00AB63 03                DB       03H
B1:00AB64 AB88              DW       ?C0008?ZW_NVM_INIT
B1:00AB66 04                DB       04H
B1:00AB67 AB90              DW       ?C0009?ZW_NVM_INIT
B1:00AB69 05                DB       05H
B1:00AB6A AB9B              DW       ?C0010?ZW_NVM_INIT
B1:00AB6C 06                DB       06H
B1:00AB6D ABA6              DW       ?C0011?ZW_NVM_INIT
B1:00AB6F 07                DB       07H
B1:00AB70 0000              DW       00H
B1:00AB72 AB3D              DW       ?C0001?ZW_NVM_INIT
B1:00AB74         ?C0004?ZW_NVM_INIT:
B1:00AB74 8012              SJMP     ?C0018?ZW_NVM_INIT
B1:00AB76         ?C0005?ZW_NVM_INIT:
B1:00AB76 8018              SJMP     ?C0019?ZW_NVM_INIT
B1:00AB78         ?C0006?ZW_NVM_INIT:
B1:00AB78 90421B            MOV      DPTR,#length+01H
B1:00AB7B E0                MOVX     A,@DPTR
B1:00AB7C 2403              ADD      A,#03H
B1:00AB7E 8021              SJMP     ?C0022?ZW_NVM_INIT
B1:00AB80         ?C0007?ZW_NVM_INIT:
B1:00AB80 91FE              ACALL    ?L?COM00CD
B1:00AB82 B1CD              ACALL    ?L?COM018F
B1:00AB84 2404              ADD      A,#04H
B1:00AB86 800E              SJMP     ?C0021?ZW_NVM_INIT
B1:00AB88         ?C0008?ZW_NVM_INIT:
B1:00AB88         
B1:00AB88 90421B            MOV      DPTR,#length+01H
B1:00AB8B E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 283


B1:00AB8C 2402              ADD      A,#02H
B1:00AB8E         
B1:00AB8E 8011              SJMP     ?C0022?ZW_NVM_INIT
B1:00AB90         ?C0009?ZW_NVM_INIT:
B1:00AB90         
B1:00AB90 91FE              ACALL    ?L?COM00CD
B1:00AB92 B1CD              ACALL    ?L?COM018F
B1:00AB94 2403              ADD      A,#03H
B1:00AB96         
B1:00AB96 FF                MOV      R7,A
B1:00AB97 E4                CLR      A
B1:00AB98 3E                ADDC     A,R6
B1:00AB99 8158              AJMP     ?C0024?ZW_NVM_INIT
B1:00AB9B         ?C0010?ZW_NVM_INIT:
B1:00AB9B 90421B            MOV      DPTR,#length+01H
B1:00AB9E E0                MOVX     A,@DPTR
B1:00AB9F 2401              ADD      A,#01H
B1:00ABA1         
B1:00ABA1 12E866            LCALL    ?L?COM0578
B1:00ABA4         
B1:00ABA4 8158              AJMP     ?C0024?ZW_NVM_INIT
B1:00ABA6         ?C0011?ZW_NVM_INIT:
B1:00ABA6 904218            MOV      DPTR,#initsegPtr
B1:00ABA9 126E13            LCALL    ?L?COM01A3
B1:00ABAC 7401              MOV      A,#01H
B1:00ABAE 93                MOVC     A,@A+DPTR
B1:00ABAF FB                MOV      R3,A
B1:00ABB0 7A00              MOV      R2,#00H
B1:00ABB2 90421B            MOV      DPTR,#length+01H
B1:00ABB5 E0                MOVX     A,@DPTR
B1:00ABB6 FE                MOV      R6,A
B1:00ABB7 E4                CLR      A
B1:00ABB8 2B                ADD      A,R3
B1:00ABB9 FF                MOV      R7,A
B1:00ABBA EA                MOV      A,R2
B1:00ABBB 3E                ADDC     A,R6
B1:00ABBC B1DE              ACALL    ?L?COM0190
B1:00ABBE 12E6EF            LCALL    ?L?COM052D
B1:00ABC1 FE                MOV      R6,A
B1:00ABC2 904218            MOV      DPTR,#initsegPtr
B1:00ABC5 128FEB            LCALL    ?L?COM020A
B1:00ABC8 7404              MOV      A,#04H
B1:00ABCA 93                MOVC     A,@A+DPTR
B1:00ABCB FD                MOV      R5,A
B1:00ABCC ED                MOV      A,R5
B1:00ABCD FF                MOV      R7,A
B1:00ABCE 90421C            MOV      DPTR,#address
B1:00ABD1 125831            LCALL    ?L?COM04C1
B1:00ABD4 904215            MOV      DPTR,#low+01H
B1:00ABD7 E0                MOVX     A,@DPTR
B1:00ABD8 9F                SUBB     A,R7
B1:00ABD9 904214            MOV      DPTR,#low
B1:00ABDC E0                MOVX     A,@DPTR
B1:00ABDD 9E                SUBB     A,R6
B1:00ABDE 506F              JNC      ?C0012?ZW_NVM_INIT
B1:00ABE0 904216            MOV      DPTR,#high
B1:00ABE3 E0                MOVX     A,@DPTR
B1:00ABE4 FE                MOV      R6,A
B1:00ABE5 A3                INC      DPTR
B1:00ABE6 E0                MOVX     A,@DPTR
B1:00ABE7 FF                MOV      R7,A
B1:00ABE8 C3                CLR      C
B1:00ABE9 90421D            MOV      DPTR,#address+01H
B1:00ABEC E0                MOVX     A,@DPTR
B1:00ABED 9F                SUBB     A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 284


B1:00ABEE 90421C            MOV      DPTR,#address
B1:00ABF1 E0                MOVX     A,@DPTR
B1:00ABF2 9E                SUBB     A,R6
B1:00ABF3 505A              JNC      ?C0012?ZW_NVM_INIT
B1:00ABF5 E4                CLR      A
B1:00ABF6 90421E            MOV      DPTR,#index
B1:00ABF9 F0                MOVX     @DPTR,A
B1:00ABFA A3                INC      DPTR
B1:00ABFB F0                MOVX     @DPTR,A
B1:00ABFC         ?C0013?ZW_NVM_INIT:
B1:00ABFC 90421A            MOV      DPTR,#length
B1:00ABFF E0                MOVX     A,@DPTR
B1:00AC00 FE                MOV      R6,A
B1:00AC01 A3                INC      DPTR
B1:00AC02 E0                MOVX     A,@DPTR
B1:00AC03 FF                MOV      R7,A
B1:00AC04 C3                CLR      C
B1:00AC05 90421F            MOV      DPTR,#index+01H
B1:00AC08 E0                MOVX     A,@DPTR
B1:00AC09 9F                SUBB     A,R7
B1:00AC0A 90421E            MOV      DPTR,#index
B1:00AC0D E0                MOVX     A,@DPTR
B1:00AC0E 9E                SUBB     A,R6
B1:00AC0F 503E              JNC      ?C0012?ZW_NVM_INIT
B1:00AC11 E0                MOVX     A,@DPTR
B1:00AC12 FC                MOV      R4,A
B1:00AC13 A3                INC      DPTR
B1:00AC14 E0                MOVX     A,@DPTR
B1:00AC15 FD                MOV      R5,A
B1:00AC16 90421D            MOV      DPTR,#address+01H
B1:00AC19 E0                MOVX     A,@DPTR
B1:00AC1A 2D                ADD      A,R5
B1:00AC1B FF                MOV      R7,A
B1:00AC1C 90421C            MOV      DPTR,#address
B1:00AC1F E0                MOVX     A,@DPTR
B1:00AC20 3C                ADDC     A,R4
B1:00AC21 FE                MOV      R6,A
B1:00AC22 904219            MOV      DPTR,#initsegPtr+01H
B1:00AC25 E0                MOVX     A,@DPTR
B1:00AC26 2405              ADD      A,#05H
B1:00AC28 FB                MOV      R3,A
B1:00AC29 904218            MOV      DPTR,#initsegPtr
B1:00AC2C E0                MOVX     A,@DPTR
B1:00AC2D 3400              ADDC     A,#00H
B1:00AC2F 8B82              MOV      DPL,R3
B1:00AC31 F583              MOV      DPH,A
B1:00AC33 E582              MOV      A,DPL
B1:00AC35 2D                ADD      A,R5
B1:00AC36 F582              MOV      DPL,A
B1:00AC38 E583              MOV      A,DPH
B1:00AC3A 3C                ADDC     A,R4
B1:00AC3B F583              MOV      DPH,A
B1:00AC3D E4                CLR      A
B1:00AC3E 93                MOVC     A,@A+DPTR
B1:00AC3F FD                MOV      R5,A
B1:00AC40 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B1:00AC43 90421E            MOV      DPTR,#index
B1:00AC46 E4                CLR      A
B1:00AC47 75F001            MOV      B,#01H
B1:00AC4A 12210C            LCALL    ?C?IILDX
B1:00AC4D 80AD              SJMP     ?C0013?ZW_NVM_INIT
B1:00AC4F         ?C0012?ZW_NVM_INIT:
B1:00AC4F 90421B            MOV      DPTR,#length+01H
B1:00AC52 E0                MOVX     A,@DPTR
B1:00AC53 2405              ADD      A,#05H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 285


B1:00AC55 12E866            LCALL    ?L?COM0578
B1:00AC58         
B1:00AC58 904218            MOV      DPTR,#initsegPtr
B1:00AC5B 8FF0              MOV      B,R7
B1:00AC5D 12210C            LCALL    ?C?IILDX
B1:00AC60 613D              AJMP     ?C0001?ZW_NVM_INIT
B1:00AC62         ?C0017?ZW_NVM_INIT:
B1:00AC62 22                RET      
----- FUNCTION _CinitNVMvariables (END) -------


----- FUNCTION _ctimer_stop (BEGIN) -----
B1:00AC63 904603            MOV      DPTR,#c
B1:00AC66 122572            LCALL    ?C?PSTXDATA
B1:00AC69 904603            MOV      DPTR,#c
B1:00AC6C 12DD10            LCALL    ?L?COM0258
B1:;----                  JMP      _list_remove
----- FUNCTION _ctimer_stop (END) -------


----- FUNCTION _list_remove (BEGIN) -----
B1:00AC6F 904208            MOV      DPTR,#list
B1:00AC72 126ECE            LCALL    ?L?COM035B
B1:00AC75 E9                MOV      A,R1
B1:00AC76 4A                ORL      A,R2
B1:00AC77 7002              JNZ      $ + 4H
B1:00AC79 81FD              AJMP     ?C0012?LIST
B1:00AC7B         ?C0011?LIST:
B1:00AC7B 12A79C            LCALL    ?L?COM00A4
B1:00AC7E 904211            MOV      DPTR,#r
B1:00AC81 122572            LCALL    ?C?PSTXDATA
B1:00AC84 904208            MOV      DPTR,#list
B1:00AC87 8066              SJMP     ?C0023?LIST
B1:00AC89         ?C0013?LIST:
B1:00AC89 B1A0              ACALL    ?L?COM04C2
B1:00AC8B E9                MOV      A,R1
B1:00AC8C 4A                ORL      A,R2
B1:00AC8D 606E              JZ       ?C0012?LIST
B1:00AC8F 90420B            MOV      DPTR,#item
B1:00AC92 122552            LCALL    ?C?PLDXDATA
B1:00AC95 C003              PUSH     AR3
B1:00AC97 C002              PUSH     AR2
B1:00AC99 C001              PUSH     AR1
B1:00AC9B B1A0              ACALL    ?L?COM04C2
B1:00AC9D D082              POP      DPL
B1:00AC9F D083              POP      DPH
B1:00ACA1 D0E0              POP      ACC
B1:00ACA3 6B                XRL      A,R3
B1:00ACA4 7008              JNZ      ?C0019?LIST
B1:00ACA6 E9                MOV      A,R1
B1:00ACA7 6582              XRL      A,DPL
B1:00ACA9 7003              JNZ      ?C0019?LIST
B1:00ACAB EA                MOV      A,R2
B1:00ACAC 6583              XRL      A,DPH
B1:00ACAE         ?C0019?LIST:
B1:00ACAE 7034              JNZ      ?C0016?LIST
B1:00ACB0 904211            MOV      DPTR,#r
B1:00ACB3 122552            LCALL    ?C?PLDXDATA
B1:00ACB6 E9                MOV      A,R1
B1:00ACB7 4A                ORL      A,R2
B1:00ACB8 90420E            MOV      DPTR,#l
B1:00ACBB 7011              JNZ      ?C0017?LIST
B1:00ACBD 122552            LCALL    ?C?PLDXDATA
B1:00ACC0 122587            LCALL    ?C?PLDPTR
B1:00ACC3 C003              PUSH     AR3
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 286


B1:00ACC5 C002              PUSH     AR2
B1:00ACC7 C001              PUSH     AR1
B1:00ACC9 904208            MOV      DPTR,#list
B1:00ACCC 800F              SJMP     ?C0022?LIST
B1:00ACCE         ?C0017?LIST:
B1:00ACCE 122552            LCALL    ?C?PLDXDATA
B1:00ACD1 122587            LCALL    ?C?PLDPTR
B1:00ACD4 C003              PUSH     AR3
B1:00ACD6 C002              PUSH     AR2
B1:00ACD8 C001              PUSH     AR1
B1:00ACDA 904211            MOV      DPTR,#r
B1:00ACDD         
B1:00ACDD 122552            LCALL    ?C?PLDXDATA
B1:00ACE0 1225A7            LCALL    ?C?PSTPTR
B1:00ACE3 22                RET      
B1:00ACE4         ?C0016?LIST:
B1:00ACE4 B1A0              ACALL    ?L?COM04C2
B1:00ACE6 904211            MOV      DPTR,#r
B1:00ACE9 122572            LCALL    ?C?PSTXDATA
B1:00ACEC 90420E            MOV      DPTR,#l
B1:00ACEF         
B1:00ACEF 122552            LCALL    ?C?PLDXDATA
B1:00ACF2 122587            LCALL    ?C?PLDPTR
B1:00ACF5 90420E            MOV      DPTR,#l
B1:00ACF8 122572            LCALL    ?C?PSTXDATA
B1:00ACFB 808C              SJMP     ?C0013?LIST
B1:00ACFD         ?C0012?LIST:
B1:00ACFD 22                RET      
----- FUNCTION _list_remove (END) -------


----- FUNCTION ?L?COM00CD (BEGIN) -----
B1:00ACFE 904218            MOV      DPTR,#initsegPtr
B1:00AD01         ?L?COM00CE:
B1:00AD01 E0                MOVX     A,@DPTR
B1:00AD02 FE                MOV      R6,A
B1:00AD03 A3                INC      DPTR
B1:00AD04 E0                MOVX     A,@DPTR
B1:00AD05 F582              MOV      DPL,A
B1:00AD07 8E83              MOV      DPH,R6
B1:00AD09 22                RET      
----- FUNCTION ?L?COM00CD (END) -------


----- FUNCTION ?L?COM020B (BEGIN) -----
B1:00AD0A 7407              MOV      A,#07H
B1:00AD0C 93                MOVC     A,@A+DPTR
B1:00AD0D FF                MOV      R7,A
B1:00AD0E B120              ACALL    _FindCorrespondingOldNvmModuleDescriptor
B1:00AD10 90402C            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00AD13 122572            LCALL    ?C?PSTXDATA
B1:00AD16         ?L?COM020C:
B1:00AD16 90402C            MOV      DPTR,#nvmModuleDescriptorOldPtr
B1:00AD19 122552            LCALL    ?C?PLDXDATA
B1:00AD1C E9                MOV      A,R1
B1:00AD1D 4A                ORL      A,R2
B1:00AD1E 4B                ORL      A,R3
B1:00AD1F 22                RET      
----- FUNCTION ?L?COM020B (END) -------


----- FUNCTION _FindCorrespondingOldNvmModuleDescriptor (BEGIN) -----
B1:00AD20 904237            MOV      DPTR,#bNvmModuleType
B1:00AD23 EF                MOV      A,R7
B1:00AD24 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 287


B1:00AD25 7B02              MOV      R3,#MBYTE nvmZWlibrarySize
B1:00AD27 7A00              MOV      R2,#HIGH nvmZWlibrarySize
B1:00AD29 7902              MOV      R1,#LOW nvmZWlibrarySize
B1:00AD2B A3                INC      DPTR
B1:00AD2C 122572            LCALL    ?C?PSTXDATA
B1:00AD2F 8061              SJMP     ?C0053?ZW_NVM_REARRANGE
B1:00AD31         ?C0001?ZW_NVM_REARRANGE:
B1:00AD31 90423E            MOV      DPTR,#nvmModuleSize
B1:00AD34 F128              ACALL    ?L?COM01C2
B1:00AD36 6065              JZ       ?C0002?ZW_NVM_REARRANGE
B1:00AD38 904238            MOV      DPTR,#nvmModuleWorkPtr
B1:00AD3B 12E598            LCALL    ?L?COM0079
B1:00AD3E E9                MOV      A,R1
B1:00AD3F 24FB              ADD      A,#0FBH
B1:00AD41 90423B            MOV      DPTR,#nvmModuleDescriptorWorkPtr
B1:00AD44 126E49            LCALL    ?L?COM0201
B1:00AD47 B1A6              ACALL    ?L?COM045E
B1:00AD49 7A42              MOV      R2,#HIGH nvmModuleSizeInDescriptor
B1:00AD4B 7940              MOV      R1,#LOW nvmModuleSizeInDescriptor
B1:00AD4D 123887            LCALL    ?L?COM009A
B1:00AD50 904240            MOV      DPTR,#nvmModuleSizeInDescriptor
B1:00AD53 E0                MOVX     A,@DPTR
B1:00AD54 FE                MOV      R6,A
B1:00AD55 A3                INC      DPTR
B1:00AD56 E0                MOVX     A,@DPTR
B1:00AD57 FF                MOV      R7,A
B1:00AD58 90423E            MOV      DPTR,#nvmModuleSize
B1:00AD5B E0                MOVX     A,@DPTR
B1:00AD5C B5061E            CJNE     A,AR6,?C0003?ZW_NVM_REARRANGE
B1:00AD5F A3                INC      DPTR
B1:00AD60 E0                MOVX     A,@DPTR
B1:00AD61 B50719            CJNE     A,AR7,?C0003?ZW_NVM_REARRANGE
B1:00AD64 90423B            MOV      DPTR,#nvmModuleDescriptorWorkPtr
B1:00AD67 129557            LCALL    ?L?COM003C
B1:00AD6A F9                MOV      R1,A
B1:00AD6B E4                CLR      A
B1:00AD6C 3A                ADDC     A,R2
B1:00AD6D 128D09            LCALL    ?L?COM0195
;---- Variable 'nvmModuleType' assigned to Register 'R7' ----
B1:00AD70 904237            MOV      DPTR,#bNvmModuleType
B1:00AD73 E0                MOVX     A,@DPTR
B1:00AD74 B50708            CJNE     A,AR7,?C0006?ZW_NVM_REARRANGE
B1:00AD77 90423B            MOV      DPTR,#nvmModuleDescriptorWorkPtr
B1:00AD7A 022552            LJMP     ?C?PLDXDATA
B1:00AD7D         ?C0003?ZW_NVM_REARRANGE:
B1:00AD7D 801E              SJMP     ?C0054?ZW_NVM_REARRANGE
B1:00AD7F         ?C0006?ZW_NVM_REARRANGE:
B1:00AD7F 90423E            MOV      DPTR,#nvmModuleSize
B1:00AD82 E0                MOVX     A,@DPTR
B1:00AD83 FE                MOV      R6,A
B1:00AD84 A3                INC      DPTR
B1:00AD85 E0                MOVX     A,@DPTR
B1:00AD86 FF                MOV      R7,A
B1:00AD87 904239            MOV      DPTR,#nvmModuleWorkPtr+01H
B1:00AD8A D1DF              ACALL    ?L?COM01F1
B1:00AD8C 904238            MOV      DPTR,#nvmModuleWorkPtr
B1:00AD8F 122552            LCALL    ?C?PLDXDATA
B1:00AD92         
B1:00AD92 B1A6              ACALL    ?L?COM045E
B1:00AD94 7A42              MOV      R2,#HIGH nvmModuleSize
B1:00AD96 793E              MOV      R1,#LOW nvmModuleSize
B1:00AD98 123887            LCALL    ?L?COM009A
B1:00AD9B 8094              SJMP     ?C0001?ZW_NVM_REARRANGE
B1:00AD9D         ?C0002?ZW_NVM_REARRANGE:
B1:00AD9D         
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 288


B1:00AD9D 02A79C            LJMP     ?L?COM00A4
----- FUNCTION _FindCorrespondingOldNvmModuleDescriptor (END) -------


----- FUNCTION ?L?COM04C2 (BEGIN) -----
B1:00ADA0 90420E            MOV      DPTR,#l
B1:00ADA3 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04C2 (END) -------


----- FUNCTION ?L?COM045E (BEGIN) -----
B1:00ADA6 AE02              MOV      R6,AR2
B1:00ADA8 AF01              MOV      R7,AR1
B1:00ADAA 7B01              MOV      R3,#01H
B1:00ADAC 22                RET      
----- FUNCTION ?L?COM045E (END) -------


----- FUNCTION ?L?COM0174 (BEGIN) -----
B1:00ADAD 7B01              MOV      R3,#01H
B1:00ADAF 7A40              MOV      R2,#HIGH dataLengthNew
B1:00ADB1 793D              MOV      R1,#LOW dataLengthNew
B1:00ADB3         ?L?COM0175:
B1:00ADB3 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00ADB6 E4                CLR      A
B1:00ADB7 F0                MOVX     @DPTR,A
B1:00ADB8 A3                INC      DPTR
B1:00ADB9 22                RET      
----- FUNCTION ?L?COM0174 (END) -------


----- FUNCTION ?L?COM02B9 (BEGIN) -----
B1:00ADBA C3                CLR      C
B1:00ADBB 90403C            MOV      DPTR,#dataLengthOld+01H
B1:00ADBE E0                MOVX     A,@DPTR
B1:00ADBF 99                SUBB     A,R1
B1:00ADC0 FF                MOV      R7,A
B1:00ADC1 90403B            MOV      DPTR,#dataLengthOld
B1:00ADC4 E0                MOVX     A,@DPTR
B1:00ADC5         ?L?COM02BA:
B1:00ADC5 9A                SUBB     A,R2
B1:00ADC6 CF                XCH      A,R7
B1:00ADC7 24FE              ADD      A,#0FEH
B1:00ADC9 CF                XCH      A,R7
B1:00ADCA 34FF              ADDC     A,#0FFH
B1:00ADCC 22                RET      
----- FUNCTION ?L?COM02B9 (END) -------


----- FUNCTION ?L?COM018F (BEGIN) -----
B1:00ADCD 7401              MOV      A,#01H
B1:00ADCF 93                MOVC     A,@A+DPTR
B1:00ADD0 FD                MOV      R5,A
B1:00ADD1 7C00              MOV      R4,#00H
B1:00ADD3 90421B            MOV      DPTR,#length+01H
B1:00ADD6 E0                MOVX     A,@DPTR
B1:00ADD7 FE                MOV      R6,A
B1:00ADD8 E4                CLR      A
B1:00ADD9 2D                ADD      A,R5
B1:00ADDA FF                MOV      R7,A
B1:00ADDB EC                MOV      A,R4
B1:00ADDC 3E                ADDC     A,R6
B1:00ADDD FE                MOV      R6,A
B1:00ADDE         ?L?COM0190:
B1:00ADDE 90421A            MOV      DPTR,#length
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 289


B1:00ADE1 F0                MOVX     @DPTR,A
B1:00ADE2 A3                INC      DPTR
B1:00ADE3 EF                MOV      A,R7
B1:00ADE4 F0                MOVX     @DPTR,A
B1:00ADE5 22                RET      
----- FUNCTION ?L?COM018F (END) -------


----- FUNCTION ?L?COM0141 (BEGIN) -----
B1:00ADE6 904038            MOV      DPTR,#nvmModuleUpdatePtr
B1:00ADE9 E0                MOVX     A,@DPTR
B1:00ADEA FE                MOV      R6,A
B1:00ADEB A3                INC      DPTR
B1:00ADEC E0                MOVX     A,@DPTR
B1:00ADED FF                MOV      R7,A
B1:00ADEE F582              MOV      DPL,A
B1:00ADF0 8E83              MOV      DPH,R6
B1:00ADF2 12257B            LCALL    ?C?PLDCODE
B1:00ADF5 90402F            MOV      DPTR,#nvmModuleNewPtr
B1:00ADF8 122572            LCALL    ?C?PSTXDATA
B1:00ADFB 8F82              MOV      DPL,R7
B1:00ADFD 8E83              MOV      DPH,R6
B1:00ADFF         ?L?COM0142:
B1:00ADFF 7405              MOV      A,#05H
B1:00AE01 93                MOVC     A,@A+DPTR
B1:00AE02 FF                MOV      R7,A
B1:00AE03 7406              MOV      A,#06H
B1:00AE05 93                MOVC     A,@A+DPTR
B1:00AE06 90403D            MOV      DPTR,#dataLengthNew
B1:00AE09 CF                XCH      A,R7
B1:00AE0A F0                MOVX     @DPTR,A
B1:00AE0B A3                INC      DPTR
B1:00AE0C EF                MOV      A,R7
B1:00AE0D F0                MOVX     @DPTR,A
B1:00AE0E 22                RET      
----- FUNCTION ?L?COM0141 (END) -------


----- FUNCTION ?L?COM02A2 (BEGIN) -----
B1:00AE0F AC02              MOV      R4,AR2
B1:00AE11 AD01              MOV      R5,AR1
B1:00AE13 904041            MOV      DPTR,#NVM_WorkPtrWrite
B1:00AE16 EC                MOV      A,R4
B1:00AE17 F0                MOVX     @DPTR,A
B1:00AE18 A3                INC      DPTR
B1:00AE19 ED                MOV      A,R5
B1:00AE1A F0                MOVX     @DPTR,A
B1:00AE1B 90403B            MOV      DPTR,#dataLengthOld
B1:00AE1E E0                MOVX     A,@DPTR
B1:00AE1F FA                MOV      R2,A
B1:00AE20 A3                INC      DPTR
B1:00AE21 E0                MOVX     A,@DPTR
B1:00AE22 FB                MOV      R3,A
----- FUNCTION _NVM_MoveData (BEGIN) -----
B1:00AE23 903757            MOV      DPTR,#NVM_WorkPtrRead
;---- Variable 'dataLengthOld' assigned to Register 'R2/R3' ----
B1:00AE26 123C23            LCALL    ?L?COM0146
B1:00AE29 EC                MOV      A,R4
B1:00AE2A F0                MOVX     @DPTR,A
B1:00AE2B A3                INC      DPTR
B1:00AE2C ED                MOV      A,R5
B1:00AE2D F0                MOVX     @DPTR,A
B1:00AE2E A3                INC      DPTR
B1:00AE2F 127074            LCALL    ?L?COM056E
B1:00AE32 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 290


B1:00AE33 903758            MOV      DPTR,#NVM_WorkPtrRead+01H
B1:00AE36 E0                MOVX     A,@DPTR
B1:00AE37 9D                SUBB     A,R5
B1:00AE38 903757            MOV      DPTR,#NVM_WorkPtrRead
B1:00AE3B E0                MOVX     A,@DPTR
B1:00AE3C 9C                SUBB     A,R4
B1:00AE3D 4039              JC       ?C0007?ZW_NVM_REARRANGE
B1:00AE3F         ?C0008?ZW_NVM_REARRANGE:
B1:00AE3F D1CA              ACALL    ?L?COM03A8
B1:00AE41 D3                SETB     C
B1:00AE42 9400              SUBB     A,#00H
B1:00AE44 EE                MOV      A,R6
B1:00AE45 9400              SUBB     A,#00H
B1:00AE47 5002              JNC      $ + 4H
B1:00AE49 C1C9              AJMP     ?C0017?ZW_NVM_REARRANGE
B1:00AE4B D1E5              ACALL    ?L?COM0579
B1:00AE4D 4004              JC       ?C0010?ZW_NVM_REARRANGE
B1:00AE4F 7F80              MOV      R7,#080H
B1:00AE51 8006              SJMP     ?C0011?ZW_NVM_REARRANGE
B1:00AE53         ?C0010?ZW_NVM_REARRANGE:
B1:00AE53 90375B            MOV      DPTR,#dataLength
B1:00AE56 A3                INC      DPTR
B1:00AE57 E0                MOVX     A,@DPTR
B1:00AE58 FF                MOV      R7,A
B1:00AE59         ?C0011?ZW_NVM_REARRANGE:
B1:00AE59 90375D            MOV      DPTR,#dataLengthWork
B1:00AE5C EF                MOV      A,R7
B1:00AE5D F0                MOVX     @DPTR,A
B1:00AE5E 903757            MOV      DPTR,#NVM_WorkPtrRead
B1:00AE61 E0                MOVX     A,@DPTR
B1:00AE62 FE                MOV      R6,A
B1:00AE63 A3                INC      DPTR
B1:00AE64 E0                MOVX     A,@DPTR
B1:00AE65 FF                MOV      R7,A
B1:00AE66 12FE12            LCALL    ?L?COM0134
B1:00AE69 FD                MOV      R5,A
B1:00AE6A B1B3              ACALL    ?L?COM0175
B1:00AE6C D1FF              ACALL    ?L?COM0434
B1:00AE6E 7E00              MOV      R6,#00H
B1:00AE70 F116              ACALL    ?L?COM0420
B1:00AE72 9E                SUBB     A,R6
B1:00AE73 F0                MOVX     @DPTR,A
B1:00AE74 D1D3              ACALL    ?L?COM01F0
B1:00AE76 80C7              SJMP     ?C0008?ZW_NVM_REARRANGE
B1:00AE78         ?C0007?ZW_NVM_REARRANGE:
B1:00AE78 D1CA              ACALL    ?L?COM03A8
B1:00AE7A D1D3              ACALL    ?L?COM01F0
B1:00AE7C         ?C0013?ZW_NVM_REARRANGE:
B1:00AE7C D1CA              ACALL    ?L?COM03A8
B1:00AE7E D3                SETB     C
B1:00AE7F 9400              SUBB     A,#00H
B1:00AE81 EE                MOV      A,R6
B1:00AE82 9400              SUBB     A,#00H
B1:00AE84 4043              JC       ?C0017?ZW_NVM_REARRANGE
B1:00AE86 D1E5              ACALL    ?L?COM0579
B1:00AE88 4004              JC       ?C0015?ZW_NVM_REARRANGE
B1:00AE8A 7F80              MOV      R7,#080H
B1:00AE8C 8006              SJMP     ?C0016?ZW_NVM_REARRANGE
B1:00AE8E         ?C0015?ZW_NVM_REARRANGE:
B1:00AE8E 90375B            MOV      DPTR,#dataLength
B1:00AE91 A3                INC      DPTR
B1:00AE92 E0                MOVX     A,@DPTR
B1:00AE93 FF                MOV      R7,A
B1:00AE94         ?C0016?ZW_NVM_REARRANGE:
B1:00AE94 90375D            MOV      DPTR,#dataLengthWork
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 291


B1:00AE97 EF                MOV      A,R7
B1:00AE98 F0                MOVX     @DPTR,A
B1:00AE99 FD                MOV      R5,A
B1:00AE9A 7C00              MOV      R4,#00H
B1:00AE9C C3                CLR      C
B1:00AE9D 903758            MOV      DPTR,#NVM_WorkPtrRead+01H
B1:00AEA0 E0                MOVX     A,@DPTR
B1:00AEA1 9D                SUBB     A,R5
B1:00AEA2 FF                MOV      R7,A
B1:00AEA3 903757            MOV      DPTR,#NVM_WorkPtrRead
B1:00AEA6 E0                MOVX     A,@DPTR
B1:00AEA7 9C                SUBB     A,R4
B1:00AEA8 FE                MOV      R6,A
B1:00AEA9 F0                MOVX     @DPTR,A
B1:00AEAA A3                INC      DPTR
B1:00AEAB EF                MOV      A,R7
B1:00AEAC F0                MOVX     @DPTR,A
B1:00AEAD C3                CLR      C
B1:00AEAE 90375A            MOV      DPTR,#NVM_WorkPtrWrite+01H
B1:00AEB1 E0                MOVX     A,@DPTR
B1:00AEB2 9D                SUBB     A,R5
B1:00AEB3 F0                MOVX     @DPTR,A
B1:00AEB4 903759            MOV      DPTR,#NVM_WorkPtrWrite
B1:00AEB7 E0                MOVX     A,@DPTR
B1:00AEB8 9C                SUBB     A,R4
B1:00AEB9 F0                MOVX     @DPTR,A
B1:00AEBA 12FE12            LCALL    ?L?COM0134
B1:00AEBD FD                MOV      R5,A
B1:00AEBE B1B3              ACALL    ?L?COM0175
B1:00AEC0 D1FF              ACALL    ?L?COM0434
B1:00AEC2 F116              ACALL    ?L?COM0420
B1:00AEC4 9400              SUBB     A,#00H
B1:00AEC6 F0                MOVX     @DPTR,A
B1:00AEC7 80B3              SJMP     ?C0013?ZW_NVM_REARRANGE
B1:00AEC9         ?C0017?ZW_NVM_REARRANGE:
B1:00AEC9 22                RET      
----- FUNCTION _NVM_MoveData (END) -------


----- FUNCTION ?L?COM03A8 (BEGIN) -----
B1:00AECA 90375B            MOV      DPTR,#dataLength
B1:00AECD E0                MOVX     A,@DPTR
B1:00AECE FE                MOV      R6,A
B1:00AECF A3                INC      DPTR
B1:00AED0 E0                MOVX     A,@DPTR
B1:00AED1 FF                MOV      R7,A
B1:00AED2 22                RET      
----- FUNCTION ?L?COM03A8 (END) -------


----- FUNCTION ?L?COM01F0 (BEGIN) -----
B1:00AED3 903757            MOV      DPTR,#NVM_WorkPtrRead
B1:00AED6 EE                MOV      A,R6
B1:00AED7 8FF0              MOV      B,R7
B1:00AED9 12210C            LCALL    ?C?IILDX
B1:00AEDC 903759            MOV      DPTR,#NVM_WorkPtrWrite
B1:00AEDF         ?L?COM01F1:
B1:00AEDF EE                MOV      A,R6
B1:00AEE0 8FF0              MOV      B,R7
B1:00AEE2 02210C            LJMP     ?C?IILDX
----- FUNCTION ?L?COM01F0 (END) -------


----- FUNCTION ?L?COM0579 (BEGIN) -----
B1:00AEE5 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 292


B1:00AEE6 EF                MOV      A,R7
B1:00AEE7 9480              SUBB     A,#080H
B1:00AEE9 EE                MOV      A,R6
B1:00AEEA 9400              SUBB     A,#00H
B1:00AEEC 22                RET      
----- FUNCTION ?L?COM0579 (END) -------


----- FUNCTION ?L?COM01CA (BEGIN) -----
B1:00AEED 122552            LCALL    ?C?PLDXDATA
B1:00AEF0         ?L?COM01CB:
B1:00AEF0 904414            MOV      DPTR,#?_ZW_s2_key_scrambler_descramble?BYTE+03H
B1:00AEF3 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01CA (END) -------


----- FUNCTION ?L?COM0512 (BEGIN) -----
B1:00AEF6 90434E            MOV      DPTR,#keybuf
B1:00AEF9 122552            LCALL    ?C?PLDXDATA
B1:00AEFC E9                MOV      A,R1
B1:00AEFD 4A                ORL      A,R2
B1:00AEFE 22                RET      
----- FUNCTION ?L?COM0512 (END) -------


----- FUNCTION ?L?COM0434 (BEGIN) -----
B1:00AEFF ED                MOV      A,R5
B1:00AF00 F0                MOVX     @DPTR,A
B1:00AF01 1239FB            LCALL    _NVM_ext_write_buffer
B1:00AF04 90375D            MOV      DPTR,#dataLengthWork
B1:00AF07 E0                MOVX     A,@DPTR
B1:00AF08 FF                MOV      R7,A
B1:00AF09 22                RET      
----- FUNCTION ?L?COM0434 (END) -------


----- FUNCTION ?L?COM03E8 (BEGIN) -----
B1:00AF0A 903C00            MOV      DPTR,#assignedSec_keys
B1:00AF0D F0                MOVX     @DPTR,A
B1:00AF0E FD                MOV      R5,A
B1:00AF0F 7E12              MOV      R6,#HIGH keyclasses_assigned
B1:00AF11 7F13              MOV      R7,#LOW keyclasses_assigned
B1:00AF13 02444A            LJMP     _NVM_ext_write_byte
----- FUNCTION ?L?COM03E8 (END) -------


----- FUNCTION ?L?COM0420 (BEGIN) -----
B1:00AF16 C3                CLR      C
B1:00AF17 90375C            MOV      DPTR,#dataLength+01H
B1:00AF1A E0                MOVX     A,@DPTR
B1:00AF1B 9F                SUBB     A,R7
B1:00AF1C F0                MOVX     @DPTR,A
B1:00AF1D 90375B            MOV      DPTR,#dataLength
B1:00AF20 E0                MOVX     A,@DPTR
B1:00AF21 22                RET      
----- FUNCTION ?L?COM0420 (END) -------


----- FUNCTION ?L?COM01C0 (BEGIN) -----
B1:00AF22 12EF46            LCALL    ResetSUC
B1:00AF25         ?L?COM01C1:
B1:00AF25 90332A            MOV      DPTR,#_routeUpdateDone
B1:00AF28         ?L?COM01C2:
B1:00AF28 E0                MOVX     A,@DPTR
B1:00AF29 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 293


B1:00AF2A A3                INC      DPTR
B1:00AF2B E0                MOVX     A,@DPTR
B1:00AF2C FF                MOV      R7,A
B1:00AF2D 4E                ORL      A,R6
B1:00AF2E 22                RET      
----- FUNCTION ?L?COM01C0 (END) -------


----- FUNCTION ?L?COM02EC (BEGIN) -----
B1:00AF2F 7E12              MOV      R6,#HIGH keyclasses_assigned
B1:00AF31 7F13              MOV      R7,#LOW keyclasses_assigned
B1:00AF33 1239F2            LCALL    _NVM_ext_read_byte
B1:00AF36 903C00            MOV      DPTR,#assignedSec_keys
B1:00AF39 EF                MOV      A,R7
B1:00AF3A F0                MOVX     @DPTR,A
B1:00AF3B 22                RET      
----- FUNCTION ?L?COM02EC (END) -------


----- FUNCTION ZCB_NeighborCompleteFailCall (BEGIN) -----
B1:00AF3C 12A79C            LCALL    ?L?COM00A4
B1:00AF3F E4                CLR      A
B1:00AF40 FF                MOV      R7,A
B1:;----                  JMP      _ZCB_NeighborComplete
----- FUNCTION ZCB_NeighborCompleteFailCall (END) -------


----- FUNCTION _ZCB_NeighborComplete (BEGIN) -----
;---- Variable 'txStatus' assigned to Register 'R7' ----
B1:00AF41 90339A            MOV      DPTR,#bCurrentRangeCheckNodeID
B1:00AF44 E0                MOVX     A,@DPTR
B1:00AF45 9046A2            MOV      DPTR,#destID
B1:00AF48 F0                MOVX     @DPTR,A
B1:00AF49 EF                MOV      A,R7
B1:00AF4A 602E              JZ       ?C0018?ZW_SLAVE
B1:00AF4C E0                MOVX     A,@DPTR
B1:00AF4D FF                MOV      R7,A
B1:00AF4E 13                RRC      A
B1:00AF4F 13                RRC      A
B1:00AF50 13                RRC      A
B1:00AF51 541F              ANL      A,#01FH
B1:00AF53 FE                MOV      R6,A
B1:00AF54 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00AF57 128FE9            LCALL    ?L?COM0209
B1:00AF5A A3                INC      DPTR
B1:00AF5B A3                INC      DPTR
B1:00AF5C A3                INC      DPTR
B1:00AF5D E582              MOV      A,DPL
B1:00AF5F 2E                ADD      A,R6
B1:00AF60 128E62            LCALL    ?L?COM0192
B1:00AF63 C083              PUSH     DPH
B1:00AF65 C082              PUSH     DPL
B1:00AF67 E0                MOVX     A,@DPTR
B1:00AF68 FE                MOV      R6,A
B1:00AF69 126C9F            LCALL    ?L?COM0090
B1:00AF6C 08                INC      R0
B1:00AF6D 8002              SJMP     ?C0295?ZW_SLAVE
B1:00AF6F         ?C0294?ZW_SLAVE:
B1:00AF6F C3                CLR      C
B1:00AF70 33                RLC      A
B1:00AF71         ?C0295?ZW_SLAVE:
B1:00AF71 D8FC              DJNZ     R0,?C0294?ZW_SLAVE
B1:00AF73 F4                CPL      A
B1:00AF74 5E                ANL      A,R6
B1:00AF75 D082              POP      DPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 294


B1:00AF77 D083              POP      DPH
B1:00AF79 F0                MOVX     @DPTR,A
B1:00AF7A         ?C0018?ZW_SLAVE:
B1:00AF7A 9046A2            MOV      DPTR,#destID
B1:00AF7D E0                MOVX     A,@DPTR
B1:00AF7E 04                INC      A
B1:00AF7F FF                MOV      R7,A
B1:;----                  JMP      _FindNeighbors
----- FUNCTION _ZCB_NeighborComplete (END) -------


----- FUNCTION _FindNeighbors (BEGIN) -----
B1:00AF80 904675            MOV      DPTR,#nextNode
B1:00AF83 EF                MOV      A,R7
B1:00AF84 F0                MOVX     @DPTR,A
B1:00AF85 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00AF88 B101              ACALL    ?L?COM00CE
B1:00AF8A A3                INC      DPTR
B1:00AF8B A3                INC      DPTR
B1:00AF8C E0                MOVX     A,@DPTR
B1:00AF8D 33                RLC      A
B1:00AF8E 33                RLC      A
B1:00AF8F 33                RLC      A
B1:00AF90 54F8              ANL      A,#0F8H
B1:00AF92 904676            MOV      DPTR,#max
B1:00AF95 F0                MOVX     @DPTR,A
B1:00AF96 200203            JB       findInProgress,$ + 6H
B1:00AF99 02B04D            LJMP     ?C0030?ZW_SLAVE
B1:00AF9C         ?C0031?ZW_SLAVE:
B1:00AF9C 904676            MOV      DPTR,#max
B1:00AF9F E0                MOVX     A,@DPTR
B1:00AFA0 FF                MOV      R7,A
B1:00AFA1 904675            MOV      DPTR,#nextNode
B1:00AFA4 E0                MOVX     A,@DPTR
B1:00AFA5 FE                MOV      R6,A
B1:00AFA6 C3                CLR      C
B1:00AFA7 9F                SUBB     A,R7
B1:00AFA8 5058              JNC      ?C0032?ZW_SLAVE
B1:00AFAA EE                MOV      A,R6
B1:00AFAB 13                RRC      A
B1:00AFAC 13                RRC      A
B1:00AFAD 13                RRC      A
B1:00AFAE 541F              ANL      A,#01FH
B1:00AFB0 FF                MOV      R7,A
B1:00AFB1 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00AFB4 128FE9            LCALL    ?L?COM0209
B1:00AFB7 A3                INC      DPTR
B1:00AFB8 A3                INC      DPTR
B1:00AFB9 A3                INC      DPTR
B1:00AFBA E582              MOV      A,DPL
B1:00AFBC 2F                ADD      A,R7
B1:00AFBD 128E62            LCALL    ?L?COM0192
B1:00AFC0 E0                MOVX     A,@DPTR
B1:00AFC1 FD                MOV      R5,A
B1:00AFC2 7C00              MOV      R4,#00H
B1:00AFC4 EE                MOV      A,R6
B1:00AFC5 126D9C            LCALL    ?L?COM0169
B1:00AFC8 8005              SJMP     ?C0297?ZW_SLAVE
B1:00AFCA         ?C0296?ZW_SLAVE:
B1:00AFCA C3                CLR      C
B1:00AFCB 33                RLC      A
B1:00AFCC CE                XCH      A,R6
B1:00AFCD 33                RLC      A
B1:00AFCE CE                XCH      A,R6
B1:00AFCF         ?C0297?ZW_SLAVE:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 295


B1:00AFCF D8F9              DJNZ     R0,?C0296?ZW_SLAVE
B1:00AFD1 FF                MOV      R7,A
B1:00AFD2 EE                MOV      A,R6
B1:00AFD3 5C                ANL      A,R4
B1:00AFD4 FE                MOV      R6,A
B1:00AFD5 EF                MOV      A,R7
B1:00AFD6 5D                ANL      A,R5
B1:00AFD7 4E                ORL      A,R6
B1:00AFD8 6020              JZ       ?C0033?ZW_SLAVE
B1:00AFDA 904675            MOV      DPTR,#nextNode
B1:00AFDD E0                MOVX     A,@DPTR
B1:00AFDE 90339A            MOV      DPTR,#bCurrentRangeCheckNodeID
B1:00AFE1 F0                MOVX     @DPTR,A
B1:00AFE2 125A42            LCALL    RFPowerLevelGetReduced
B1:00AFE5 AD07              MOV      R5,AR7
B1:00AFE7 90339A            MOV      DPTR,#bCurrentRangeCheckNodeID
B1:00AFEA E0                MOVX     A,@DPTR
B1:00AFEB 04                INC      A
B1:00AFEC FF                MOV      R7,A
B1:00AFED 7A19              MOV      R2,#HIGH ?INTERBANK_TABLE?_ZCB_NeighborComplete
B1:00AFEF 7BD0              MOV      R3,#LOW ?INTERBANK_TABLE?_ZCB_NeighborComplete
B1:00AFF1 12D2BF            LCALL    _SendTestFrame
B1:00AFF4 EF                MOV      A,R7
B1:00AFF5 7058              JNZ      ?C0036?ZW_SLAVE
B1:00AFF7 02F40E            LJMP     DelayNeighborCompleteFailCall
B1:00AFFA         ?C0033?ZW_SLAVE:
B1:00AFFA 904675            MOV      DPTR,#nextNode
B1:00AFFD E0                MOVX     A,@DPTR
B1:00AFFE 04                INC      A
B1:00AFFF F0                MOVX     @DPTR,A
B1:00B000 809A              SJMP     ?C0031?ZW_SLAVE
B1:00B002         ?C0032?ZW_SLAVE:
B1:00B002 C219              CLR      reducedFindNeighborPower
B1:00B004 C202              CLR      findInProgress
B1:00B006 90339E            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00B009 7401              MOV      A,#01H
B1:00B00B F0                MOVX     @DPTR,A
B1:00B00C 903316            MOV      DPTR,#cmdBuffer
B1:00B00F F0                MOVX     @DPTR,A
B1:00B010 A3                INC      DPTR
B1:00B011 7407              MOV      A,#07H
B1:00B013 F0                MOVX     @DPTR,A
B1:00B014 E4                CLR      A
B1:00B015 A3                INC      DPTR
B1:00B016 F0                MOVX     @DPTR,A
B1:00B017 903315            MOV      DPTR,#assignState
B1:00B01A 7403              MOV      A,#03H
B1:00B01C F0                MOVX     @DPTR,A
B1:00B01D 90339B            MOV      DPTR,#oldSpeed
B1:00B020 1153              ACALL    ?L?COM0177
B1:00B022 7B01              MOV      R3,#01H
B1:00B024 7A33              MOV      R2,#HIGH cmdBuffer
B1:00B026 7916              MOV      R1,#LOW cmdBuffer
B1:00B028 12D224            LCALL    ?L?COM0062
B1:00B02B 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00B02E 7403              MOV      A,#03H
B1:00B030 F0                MOVX     @DPTR,A
B1:00B031 903323            MOV      DPTR,#nodeRange+01H
B1:00B034 12D20D            LCALL    ?L?COM0263
B1:00B037 12FCAB            LCALL    ?L?COM046D
B1:00B03A 903322            MOV      DPTR,#nodeRange
B1:00B03D E0                MOVX     A,@DPTR
B1:00B03E FB                MOV      R3,A
B1:00B03F 12D13B            LCALL    _EnQueueSingleData
B1:00B042 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 296


B1:00B043 700A              JNZ      ?C0036?ZW_SLAVE
B1:00B045 FB                MOV      R3,A
B1:00B046 FA                MOV      R2,A
B1:00B047 F9                MOV      R1,A
B1:00B048 7F02              MOV      R7,#02H
B1:00B04A 02EDBA            LJMP     _ZCB_AssignComplete
B1:00B04D         ?C0030?ZW_SLAVE:
B1:00B04D C219              CLR      reducedFindNeighborPower
B1:00B04F         ?C0036?ZW_SLAVE:
B1:00B04F 22                RET      
----- FUNCTION _FindNeighbors (END) -------


----- FUNCTION ?L?COM0176 (BEGIN) -----
B1:00B050 903B2D            MOV      DPTR,#sourceNode
B1:00B053         ?L?COM0177:
B1:00B053 E0                MOVX     A,@DPTR
B1:00B054 FF                MOV      R7,A
B1:00B055 901221            MOV      DPTR,#nodeID
B1:00B058 E0                MOVX     A,@DPTR
B1:00B059 FD                MOV      R5,A
B1:00B05A 22                RET      
----- FUNCTION ?L?COM0176 (END) -------


----- FUNCTION _SecurityCommandHandler (BEGIN) -----
B1:00B05B 903B22            MOV      DPTR,#pCmd_
B1:00B05E 122572            LCALL    ?C?PSTXDATA
B1:00B061 903B25            MOV      DPTR,#cmdLength
B1:00B064 ED                MOV      A,R5
B1:00B065 F0                MOVX     @DPTR,A
B1:00B066 A3                INC      DPTR
B1:00B067 12E012            LCALL    ?L?COM00B3
B1:00B06A 1285F5            LCALL    ?L?COM0004
B1:00B06D 903B2D            MOV      DPTR,#sourceNode
B1:00B070 F0                MOVX     @DPTR,A
B1:00B071 903B22            MOV      DPTR,#pCmd_
B1:00B074 122552            LCALL    ?C?PLDXDATA
B1:00B077 903B29            MOV      DPTR,#pCmd
B1:00B07A 122572            LCALL    ?C?PSTXDATA
B1:00B07D 903B26            MOV      DPTR,#rxopt
B1:00B080 12C941            LCALL    ?L?COM0048
B1:00B083 7F00              MOV      R7,#00H
B1:00B085 30E102            JNB      ACC.1,?C0021?ZW_SECURE_LEARN_SUPPORT
B1:00B088 7F02              MOV      R7,#02H
B1:00B08A         ?C0021?ZW_SECURE_LEARN_SUPPORT:
B1:00B08A         ?C0022?ZW_SECURE_LEARN_SUPPORT:
B1:00B08A EF                MOV      A,R7
B1:00B08B 4421              ORL      A,#021H
B1:00B08D 903B2C            MOV      DPTR,#txOption
B1:00B090 F0                MOVX     @DPTR,A
B1:00B091 903B29            MOV      DPTR,#pCmd
B1:00B094 12E012            LCALL    ?L?COM00B3
B1:00B097 1285F5            LCALL    ?L?COM0004
B1:00B09A 12267F            LCALL    ?C?CCASE
B1:00B09D B147              DW       ?C0032?ZW_SECURE_LEARN_SUPPORT
B1:00B09F 02                DB       02H
B1:00B0A0 B108              DW       ?C0027?ZW_SECURE_LEARN_SUPPORT
B1:00B0A2 04                DB       04H
B1:00B0A3 B0B6              DW       ?C0024?ZW_SECURE_LEARN_SUPPORT
B1:00B0A5 06                DB       06H
B1:00B0A6 B174              DW       ?C0034?ZW_SECURE_LEARN_SUPPORT
B1:00B0A8 40                DB       040H
B1:00B0A9 B180              DW       ?C0035?ZW_SECURE_LEARN_SUPPORT
B1:00B0AB 80                DB       080H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 297


B1:00B0AC B19A              DW       ?C0038?ZW_SECURE_LEARN_SUPPORT
B1:00B0AE 81                DB       081H
B1:00B0AF B19A              DW       ?C0038?ZW_SECURE_LEARN_SUPPORT
B1:00B0B1 C1                DB       0C1H
B1:00B0B2 0000              DW       00H
B1:00B0B4 B1F7              DW       ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B0B6         ?C0024?ZW_SECURE_LEARN_SUPPORT:
B1:00B0B6 903B26            MOV      DPTR,#rxopt
B1:00B0B9 129549            LCALL    ?L?COM0058
B1:00B0BC 1285F5            LCALL    ?L?COM0004
B1:00B0BF 6404              XRL      A,#04H
B1:00B0C1 6002              JZ       $ + 4H
B1:00B0C3 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B0C5 510D              ACALL    ?L?COM006D
B1:00B0C7 7D02              MOV      R5,#02H
B1:00B0C9 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00B0CC EF                MOV      A,R7
B1:00B0CD 7002              JNZ      $ + 4H
B1:00B0CF 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B0D1 903B25            MOV      DPTR,#cmdLength
B1:00B0D4 E0                MOVX     A,@DPTR
B1:00B0D5 FF                MOV      R7,A
B1:00B0D6 7412              MOV      A,#012H
B1:00B0D8 D3                SETB     C
B1:00B0D9 9F                SUBB     A,R7
B1:00B0DA 4002              JC       $ + 4H
B1:00B0DC 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B0DE 903B29            MOV      DPTR,#pCmd
B1:00B0E1 129557            LCALL    ?L?COM003C
B1:00B0E4 F9                MOV      R1,A
B1:00B0E5 E4                CLR      A
B1:00B0E6 3A                ADDC     A,R2
B1:00B0E7 FA                MOV      R2,A
B1:00B0E8 121C69            LCALL    ?INTERBANK_TABLE?_sec0_persist_netkey
B1:00B0EB 121C8C            LCALL    ?INTERBANK_TABLE?sec0_init
B1:00B0EE 500B              JNC      ?C0026?ZW_SECURE_LEARN_SUPPORT
B1:00B0F0 510D              ACALL    ?L?COM006D
B1:00B0F2 E4                CLR      A
B1:00B0F3 7F01              MOV      R7,#01H
B1:00B0F5 FE                MOV      R6,A
B1:00B0F6 FD                MOV      R5,A
B1:00B0F7 FC                MOV      R4,A
B1:00B0F8 121D4A            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_net_scheme
B1:00B0FB         ?C0026?ZW_SECURE_LEARN_SUPPORT:
B1:00B0FB 31FB              ACALL    ?L?COM006C
B1:00B0FD 903B2D            MOV      DPTR,#sourceNode
B1:00B100 125BD1            LCALL    ?L?COM02DC
B1:00B103 121D22            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_key_set
B1:00B106 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B108         ?C0027?ZW_SECURE_LEARN_SUPPORT:
B1:00B108 510D              ACALL    ?L?COM006D
B1:00B10A 7D01              MOV      R5,#01H
B1:00B10C 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00B10F EF                MOV      A,R7
B1:00B110 700C              JNZ      ?C0029?ZW_SECURE_LEARN_SUPPORT
B1:00B112 510D              ACALL    ?L?COM006D
B1:00B114 7D08              MOV      R5,#08H
B1:00B116 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00B119 EF                MOV      A,R7
B1:00B11A 7002              JNZ      $ + 4H
B1:00B11C 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B11E         ?C0029?ZW_SECURE_LEARN_SUPPORT:
B1:00B11E 903B25            MOV      DPTR,#cmdLength
B1:00B121 E0                MOVX     A,@DPTR
B1:00B122 C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 298


B1:00B123 9403              SUBB     A,#03H
B1:00B125 401B              JC       ?C0030?ZW_SECURE_LEARN_SUPPORT
B1:00B127 121CA5            LCALL    ?INTERBANK_TABLE?sec2_inclusion_abort
B1:00B12A 510D              ACALL    ?L?COM006D
B1:00B12C E4                CLR      A
B1:00B12D 7F01              MOV      R7,#01H
B1:00B12F FE                MOV      R6,A
B1:00B130 FD                MOV      R5,A
B1:00B131 FC                MOV      R4,A
B1:00B132 121D40            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_scheme
B1:00B135 31FB              ACALL    ?L?COM006C
B1:00B137 903B2D            MOV      DPTR,#sourceNode
B1:00B13A 125BD1            LCALL    ?L?COM02DC
B1:00B13D 121D1D            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_scheme_get
B1:00B140 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B142         ?C0030?ZW_SECURE_LEARN_SUPPORT:
B1:00B142 12ECE5            LCALL    security_learn_exit
B1:00B145 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B147         ?C0032?ZW_SECURE_LEARN_SUPPORT:
B1:00B147 903B26            MOV      DPTR,#rxopt
B1:00B14A 129549            LCALL    ?L?COM0058
B1:00B14D 1285F5            LCALL    ?L?COM0004
B1:00B150 6404              XRL      A,#04H
B1:00B152 6002              JZ       $ + 4H
B1:00B154 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B156 31FB              ACALL    ?L?COM006C
B1:00B158 903B2D            MOV      DPTR,#sourceNode
B1:00B15B 125BD1            LCALL    ?L?COM02DC
B1:00B15E 121D36            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_node
B1:00B161 12A79C            LCALL    ?L?COM00A4
B1:00B164 9044DC            MOV      DPTR,#?_secure_learnIface_raise_commandsSupportedRequest?BYTE+03H
B1:00B167 122572            LCALL    ?C?PSTXDATA
B1:00B16A 0B                INC      R3
B1:00B16B 7A36              MOV      R2,#HIGH ctx
B1:00B16D 7931              MOV      R1,#LOW ctx
B1:00B16F 121D0E            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_commandsSupportedRequest
B1:00B172 21F7              AJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B174         ?C0034?ZW_SECURE_LEARN_SUPPORT:
B1:00B174 1150              ACALL    ?L?COM0176
B1:00B176 903B2C            MOV      DPTR,#txOption
B1:00B179 E0                MOVX     A,@DPTR
B1:00B17A FB                MOV      R3,A
B1:00B17B 121C96            LCALL    ?INTERBANK_TABLE?_sec0_send_nonce
B1:00B17E 8077              SJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B180         ?C0035?ZW_SECURE_LEARN_SUPPORT:
B1:00B180 903B25            MOV      DPTR,#cmdLength
B1:00B183 E0                MOVX     A,@DPTR
B1:00B184 C3                CLR      C
B1:00B185 940A              SUBB     A,#0AH
B1:00B187 406E              JC       ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B189         ?C0036?ZW_SECURE_LEARN_SUPPORT:
B1:00B189 1150              ACALL    ?L?COM0176
B1:00B18B 903B29            MOV      DPTR,#pCmd
B1:00B18E 129557            LCALL    ?L?COM003C
B1:00B191 F9                MOV      R1,A
B1:00B192 E4                CLR      A
B1:00B193 3A                ADDC     A,R2
B1:00B194 FA                MOV      R2,A
B1:00B195 121C87            LCALL    ?INTERBANK_TABLE?_sec0_register_nonce
B1:00B198 805D              SJMP     ?C0023?ZW_SECURE_LEARN_SUPPORT
B1:00B19A         ?C0038?ZW_SECURE_LEARN_SUPPORT:
B1:00B19A 1150              ACALL    ?L?COM0176
B1:00B19C 903B25            MOV      DPTR,#cmdLength
B1:00B19F E0                MOVX     A,@DPTR
B1:00B1A0 903D2E            MOV      DPTR,#?_sec0_decrypt_message?BYTE+05H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 299


B1:00B1A3 F0                MOVX     @DPTR,A
B1:00B1A4 7B01              MOV      R3,#01H
B1:00B1A6 7A3B              MOV      R2,#HIGH rxBuffer
B1:00B1A8 792E              MOV      R1,#LOW rxBuffer
B1:00B1AA A3                INC      DPTR
B1:00B1AB 122572            LCALL    ?C?PSTXDATA
B1:00B1AE 903B29            MOV      DPTR,#pCmd
B1:00B1B1 122552            LCALL    ?C?PLDXDATA
B1:00B1B4 121C9B            LCALL    ?INTERBANK_TABLE?_sec0_decrypt_message
B1:00B1B7 903B6E            MOV      DPTR,#len
B1:00B1BA EF                MOV      A,R7
B1:00B1BB F0                MOVX     @DPTR,A
B1:00B1BC 6023              JZ       ?C0039?ZW_SECURE_LEARN_SUPPORT
B1:00B1BE 903B26            MOV      DPTR,#rxopt
B1:00B1C1 129549            LCALL    ?L?COM0058
B1:00B1C4 F9                MOV      R1,A
B1:00B1C5 E4                CLR      A
B1:00B1C6 3A                ADDC     A,R2
B1:00B1C7 FA                MOV      R2,A
B1:00B1C8 7404              MOV      A,#04H
B1:00B1CA 12203B            LCALL    ?C?CSTPTR
B1:00B1CD 903B6E            MOV      DPTR,#len
B1:00B1D0 E0                MOVX     A,@DPTR
B1:00B1D1 FD                MOV      R5,A
B1:00B1D2 903B26            MOV      DPTR,#rxopt
B1:00B1D5 12F2C1            LCALL    ?L?COM0377
B1:00B1D8 7B01              MOV      R3,#01H
B1:00B1DA 7A3B              MOV      R2,#HIGH rxBuffer
B1:00B1DC 792E              MOV      R1,#LOW rxBuffer
B1:00B1DE 12BCFE            LCALL    _CommandHandler
B1:00B1E1         ?C0039?ZW_SECURE_LEARN_SUPPORT:
B1:00B1E1 903B29            MOV      DPTR,#pCmd
B1:00B1E4 12E012            LCALL    ?L?COM00B3
B1:00B1E7 1285F5            LCALL    ?L?COM0004
B1:00B1EA B4C10D            CJNE     A,#0C1H,?C0041?ZW_SECURE_LEARN_SUPPORT
B1:00B1ED 1150              ACALL    ?L?COM0176
B1:00B1EF 903B2C            MOV      DPTR,#txOption
B1:00B1F2 E0                MOVX     A,@DPTR
B1:00B1F3 FB                MOV      R3,A
B1:00B1F4 021C96            LJMP     ?INTERBANK_TABLE?_sec0_send_nonce
B1:00B1F7         ?C0023?ZW_SECURE_LEARN_SUPPORT:
B1:00B1F7 12EEC3            LCALL    runCycle
B1:00B1FA         ?C0041?ZW_SECURE_LEARN_SUPPORT:
B1:00B1FA 22                RET      
----- FUNCTION _SecurityCommandHandler (END) -------


----- FUNCTION ?L?COM006C (BEGIN) -----
B1:00B1FB 7B01              MOV      R3,#01H
B1:00B1FD 7A36              MOV      R2,#HIGH ctx
B1:00B1FF 7931              MOV      R1,#LOW ctx
B1:00B201 903B2C            MOV      DPTR,#txOption
B1:00B204 E0                MOVX     A,@DPTR
B1:00B205 FF                MOV      R7,A
B1:00B206 E4                CLR      A
B1:00B207 FC                MOV      R4,A
B1:00B208 FD                MOV      R5,A
B1:00B209 FE                MOV      R6,A
B1:00B20A 121D2C            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_txOptions
B1:00B20D         ?L?COM006D:
B1:00B20D 7B01              MOV      R3,#01H
B1:00B20F 7A36              MOV      R2,#HIGH ctx
B1:00B211 7931              MOV      R1,#LOW ctx
B1:00B213 22                RET      
----- FUNCTION ?L?COM006C (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 300




----- FUNCTION _ReceiveHandler (BEGIN) -----
B1:00B214 9009D9            MOV      DPTR,#pData
B1:00B217 126560            LCALL    ?L?COM00E8
B1:00B21A 12ECDA            LCALL    ?L?COM021A
B1:00B21D FF                MOV      R7,A
B1:00B21E AA06              MOV      R2,AR6
B1:00B220 F9                MOV      R1,A
B1:00B221 7B01              MOV      R3,#01H
B1:00B223 90076C            MOV      DPTR,#rxFrame
B1:00B226 122572            LCALL    ?C?PSTXDATA
B1:00B229 9009DB            MOV      DPTR,#dataLength
B1:00B22C E0                MOVX     A,@DPTR
B1:00B22D 900775            MOV      DPTR,#rxFrame+09H
B1:00B230 F0                MOVX     @DPTR,A
B1:00B231 D3                SETB     C
B1:00B232 9408              SUBB     A,#08H
B1:00B234 5003              JNC      $ + 5H
B1:00B236 02B896            LJMP     ?C0482?ZW_TRANSPORT
B1:00B239 EF                MOV      A,R7
B1:00B23A 2407              ADD      A,#07H
B1:00B23C 12D5FD            LCALL    ?L?COM008E
B1:00B23F 12F2A1            LCALL    ?L?COM058A
B1:00B242 5003              JNC      $ + 5H
B1:00B244 02B896            LJMP     ?C0482?ZW_TRANSPORT
B1:00B247 E4                CLR      A
B1:00B248 900773            MOV      DPTR,#rxFrame+07H
B1:00B24B F0                MOVX     @DPTR,A
B1:00B24C 900938            MOV      DPTR,#rfRxCurrentSpeed
B1:00B24F E0                MOVX     A,@DPTR
B1:00B250 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00B253 F0                MOVX     @DPTR,A
B1:00B254 12F2CA            LCALL    RouteCachedReset
B1:00B257 12ECDD            LCALL    ?L?COM021B
B1:00B25A 12D5F9            LCALL    ?L?COM008D
B1:00B25D FF                MOV      R7,A
B1:00B25E 540F              ANL      A,#0FH
B1:00B260 6401              XRL      A,#01H
B1:00B262 6002              JZ       $ + 4H
B1:00B264 6100              AJMP     ?C0466?ZW_TRANSPORT
B1:00B266 EF                MOV      A,R7
B1:00B267 30E755            JNB      ACC.7,?C0467?ZW_TRANSPORT
B1:00B26A 9009D9            MOV      DPTR,#pData
B1:00B26D A3                INC      DPTR
B1:00B26E E0                MOVX     A,@DPTR
B1:00B26F FF                MOV      R7,A
B1:00B270 2409              ADD      A,#09H
B1:00B272 12D5FD            LCALL    ?L?COM008E
B1:00B275 30E30E            JNB      ACC.3,?C0468?ZW_TRANSPORT
B1:00B278 EF                MOV      A,R7
B1:00B279 240A              ADD      A,#0AH
B1:00B27B 12D5FD            LCALL    ?L?COM008E
B1:00B27E 12F2A9            LCALL    ?L?COM01CE
B1:00B281 12D98E            LCALL    ?L?COM0138
B1:00B284 8002              SJMP     ?C0469?ZW_TRANSPORT
B1:00B286         ?C0468?ZW_TRANSPORT:
B1:00B286 7F00              MOV      R7,#00H
B1:00B288         ?C0469?ZW_TRANSPORT:
B1:00B288 12D997            LCALL    ?L?COM0087
B1:00B28B 12B8C6            LCALL    ?L?COM002E
B1:00B28E 1257E2            LCALL    ?L?COM0221
B1:00B291 9009E3            MOV      DPTR,#protPayloadCmd
B1:00B294 12ECDA            LCALL    ?L?COM021A
B1:00B297 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 301


B1:00B298 2409              ADD      A,#09H
B1:00B29A 12D5FD            LCALL    ?L?COM008E
B1:00B29D 30E312            JNB      ACC.3,?C0470?ZW_TRANSPORT
B1:00B2A0 EF                MOV      A,R7
B1:00B2A1 240A              ADD      A,#0AH
B1:00B2A3 12D5FD            LCALL    ?L?COM008E
B1:00B2A6 C4                SWAP     A
B1:00B2A7 540F              ANL      A,#0FH
B1:00B2A9 FD                MOV      R5,A
B1:00B2AA 12F2AF            LCALL    ?L?COM01CF
B1:00B2AD 12D98E            LCALL    ?L?COM0138
B1:00B2B0 8002              SJMP     ?C0471?ZW_TRANSPORT
B1:00B2B2         ?C0470?ZW_TRANSPORT:
B1:00B2B2 7F00              MOV      R7,#00H
B1:00B2B4         ?C0471?ZW_TRANSPORT:
B1:00B2B4 12D997            LCALL    ?L?COM0087
B1:00B2B7 3A                ADDC     A,R2
B1:00B2B8 FA                MOV      R2,A
B1:00B2B9 E9                MOV      A,R1
B1:00B2BA 2F                ADD      A,R7
B1:00B2BB F9                MOV      R1,A
B1:00B2BC EE                MOV      A,R6
B1:00B2BD 800C              SJMP     ?C0622?ZW_TRANSPORT
B1:00B2BF         ?C0467?ZW_TRANSPORT:
B1:00B2BF 12B8B0            LCALL    ?L?COM0075
B1:00B2C2 2409              ADD      A,#09H
B1:00B2C4 12B89F            LCALL    ?L?COM0073
B1:00B2C7 2409              ADD      A,#09H
B1:00B2C9 F9                MOV      R1,A
B1:00B2CA E4                CLR      A
B1:00B2CB         
B1:00B2CB 3A                ADDC     A,R2
B1:00B2CC FA                MOV      R2,A
B1:00B2CD 9009E6            MOV      DPTR,#protCmdClass
B1:00B2D0 122572            LCALL    ?C?PSTXDATA
B1:00B2D3         ?C0472?ZW_TRANSPORT:
B1:00B2D3 9009E3            MOV      DPTR,#protPayloadCmd
B1:00B2D6 12C941            LCALL    ?L?COM0048
B1:00B2D9 FF                MOV      R7,A
B1:00B2DA 601D              JZ       ?C0474?ZW_TRANSPORT
B1:00B2DC 6418              XRL      A,#018H
B1:00B2DE 6019              JZ       ?C0474?ZW_TRANSPORT
B1:00B2E0 EF                MOV      A,R7
B1:00B2E1 6407              XRL      A,#07H
B1:00B2E3 6014              JZ       ?C0474?ZW_TRANSPORT
B1:00B2E5 EF                MOV      A,R7
B1:00B2E6 6403              XRL      A,#03H
B1:00B2E8 7069              JNZ      ?C0475?ZW_TRANSPORT
B1:00B2EA 9009E3            MOV      DPTR,#protPayloadCmd
B1:00B2ED 129557            LCALL    ?L?COM003C
B1:00B2F0 F9                MOV      R1,A
B1:00B2F1 E4                CLR      A
B1:00B2F2 3A                ADDC     A,R2
B1:00B2F3 FA                MOV      R2,A
B1:00B2F4 12DA5F            LCALL    ?L?COM016C
B1:00B2F7 705A              JNZ      ?C0475?ZW_TRANSPORT
B1:00B2F9         ?C0474?ZW_TRANSPORT:
B1:00B2F9 7FFE              MOV      R7,#0FEH
B1:00B2FB 121BD8            LCALL    ?INTERBANK_TABLE?_ExplorePurgeQueue
B1:00B2FE 8053              SJMP     ?C0475?ZW_TRANSPORT
B1:00B300         ?C0466?ZW_TRANSPORT:
B1:00B300 12ECDD            LCALL    ?L?COM021B
B1:00B303 12D5F9            LCALL    ?L?COM008D
B1:00B306 540F              ANL      A,#0FH
B1:00B308 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 302


B1:00B309 6405              XRL      A,#05H
B1:00B30B 7019              JNZ      ?C0476?ZW_TRANSPORT
B1:00B30D 12B8B0            LCALL    ?L?COM0075
B1:00B310 2409              ADD      A,#09H
B1:00B312 1285F5            LCALL    ?L?COM0004
B1:00B315 541F              ANL      A,#01FH
B1:00B317 703A              JNZ      ?C0475?ZW_TRANSPORT
B1:00B319 12B8B0            LCALL    ?L?COM0075
B1:00B31C 2411              ADD      A,#011H
B1:00B31E 12B89F            LCALL    ?L?COM0073
B1:00B321 126FEA            LCALL    ?L?COM0474
B1:00B324 8027              SJMP     ?C0623?ZW_TRANSPORT
B1:00B326         ?C0476?ZW_TRANSPORT:
B1:00B326 EF                MOV      A,R7
B1:00B327 6402              XRL      A,#02H
B1:00B329 701F              JNZ      ?C0479?ZW_TRANSPORT
B1:00B32B 12B8B0            LCALL    ?L?COM0075
B1:00B32E 2408              ADD      A,#08H
B1:00B330 1285F5            LCALL    ?L?COM0004
B1:00B333 541F              ANL      A,#01FH
B1:00B335 FF                MOV      R7,A
B1:00B336 7E00              MOV      R6,#00H
B1:00B338 12B8B0            LCALL    ?L?COM0075
B1:00B33B 2409              ADD      A,#09H
B1:00B33D 12B8C4            LCALL    ?L?COM002D
B1:00B340 12B8A3            LCALL    ?L?COM0074
B1:00B343 2409              ADD      A,#09H
B1:00B345 12B8C4            LCALL    ?L?COM002D
B1:00B348 8003              SJMP     ?C0621?ZW_TRANSPORT
B1:00B34A         ?C0479?ZW_TRANSPORT:
B1:00B34A 12A79C            LCALL    ?L?COM00A4
B1:00B34D         
B1:00B34D         
B1:00B34D 9009E6            MOV      DPTR,#protCmdClass
B1:00B350 122572            LCALL    ?C?PSTXDATA
B1:00B353         ?C0475?ZW_TRANSPORT:
B1:00B353 9009E6            MOV      DPTR,#protCmdClass
B1:00B356 122552            LCALL    ?C?PLDXDATA
B1:00B359 900A44            MOV      DPTR,#?_IsFrameIlLegal?BYTE+03H
B1:00B35C 122572            LCALL    ?C?PSTXDATA
B1:00B35F 9009E3            MOV      DPTR,#protPayloadCmd
B1:00B362 122552            LCALL    ?C?PLDXDATA
B1:00B365 900A47            MOV      DPTR,#?_IsFrameIlLegal?BYTE+06H
B1:00B368 122572            LCALL    ?C?PSTXDATA
B1:00B36B 90076C            MOV      DPTR,#rxFrame
B1:00B36E 122552            LCALL    ?C?PLDXDATA
B1:00B371 12E86E            LCALL    _IsFrameIlLegal
B1:00B374 EF                MOV      A,R7
B1:00B375 6003              JZ       $ + 5H
B1:00B377 02B896            LJMP     ?C0482?ZW_TRANSPORT
B1:00B37A         ?C0481?ZW_TRANSPORT:
B1:00B37A 9009DC            MOV      DPTR,#pRssiArray
B1:00B37D 122552            LCALL    ?C?PLDXDATA
B1:00B380 900A0A            MOV      DPTR,#?_IsMyFrame?BYTE+03H
B1:00B383 122572            LCALL    ?C?PSTXDATA
B1:00B386 12ED88            LCALL    ?L?COM04C9
B1:00B389 12969D            LCALL    _IsMyFrame
B1:00B38C 90076C            MOV      DPTR,#rxFrame
B1:00B38F 129549            LCALL    ?L?COM0058
B1:00B392 1285F5            LCALL    ?L?COM0004
B1:00B395 900763            MOV      DPTR,#bNodeLastReceivedFrom
B1:00B398 F0                MOVX     @DPTR,A
B1:00B399 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00B39C E0                MOVX     A,@DPTR
B1:00B39D 6401              XRL      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 303


B1:00B39F 6056              JZ       ?C0483?ZW_TRANSPORT
B1:00B3A1 900773            MOV      DPTR,#rxFrame+07H
B1:00B3A4 E0                MOVX     A,@DPTR
B1:00B3A5 30E04F            JNB      ACC.0,?C0483?ZW_TRANSPORT
B1:00B3A8 E4                CLR      A
B1:00B3A9 900767            MOV      DPTR,#tmp
B1:00B3AC F0                MOVX     @DPTR,A
B1:00B3AD         ?C0484?ZW_TRANSPORT:
B1:00B3AD 900767            MOV      DPTR,#tmp
B1:00B3B0 E0                MOVX     A,@DPTR
B1:00B3B1 FF                MOV      R7,A
B1:00B3B2 C3                CLR      C
B1:00B3B3 9402              SUBB     A,#02H
B1:00B3B5 5020              JNC      ?C0485?ZW_TRANSPORT
B1:00B3B7 EF                MOV      A,R7
B1:00B3B8 12FD9A            LCALL    ?L?COM03F3
B1:00B3BB FF                MOV      R7,A
B1:00B3BC 900763            MOV      DPTR,#bNodeLastReceivedFrom
B1:00B3BF E0                MOVX     A,@DPTR
B1:00B3C0 FE                MOV      R6,A
B1:00B3C1 EF                MOV      A,R7
B1:00B3C2 B5060A            CJNE     A,AR6,?C0486?ZW_TRANSPORT
B1:00B3C5 900767            MOV      DPTR,#tmp
B1:00B3C8 E0                MOVX     A,@DPTR
B1:00B3C9 24FF              ADD      A,#0FFH
B1:00B3CB 9207              MOV      iResponseNodeIndex,C
B1:00B3CD 8008              SJMP     ?C0485?ZW_TRANSPORT
B1:00B3CF         ?C0486?ZW_TRANSPORT:
B1:00B3CF 900767            MOV      DPTR,#tmp
B1:00B3D2 E0                MOVX     A,@DPTR
B1:00B3D3 04                INC      A
B1:00B3D4 F0                MOVX     @DPTR,A
B1:00B3D5 80D6              SJMP     ?C0484?ZW_TRANSPORT
B1:00B3D7         ?C0485?ZW_TRANSPORT:
B1:00B3D7 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00B3DA E0                MOVX     A,@DPTR
B1:00B3DB FD                MOV      R5,A
B1:00B3DC A207              MOV      C,iResponseNodeIndex
B1:00B3DE E4                CLR      A
B1:00B3DF 33                RLC      A
B1:00B3E0 25E0              ADD      A,ACC
B1:00B3E2 FF                MOV      R7,A
B1:00B3E3 E4                CLR      A
B1:00B3E4 33                RLC      A
B1:00B3E5 FE                MOV      R6,A
B1:00B3E6 7482              MOV      A,#LOW abDirectNodesResponseSpeed+01H
B1:00B3E8 2F                ADD      A,R7
B1:00B3E9 F582              MOV      DPL,A
B1:00B3EB 7407              MOV      A,#HIGH abDirectNodesResponseSpeed+01H
B1:00B3ED 3E                ADDC     A,R6
B1:00B3EE F583              MOV      DPH,A
B1:00B3F0 ED                MOV      A,R5
B1:00B3F1 F0                MOVX     @DPTR,A
B1:00B3F2 A207              MOV      C,iResponseNodeIndex
B1:00B3F4 B3                CPL      C
B1:00B3F5 9207              MOV      iResponseNodeIndex,C
B1:00B3F7         ?C0483?ZW_TRANSPORT:
B1:00B3F7 900773            MOV      DPTR,#rxFrame+07H
B1:00B3FA E0                MOVX     A,@DPTR
B1:00B3FB 20E202            JB       ACC.2,$ + 5H
B1:00B3FE 81D5              AJMP     ?C0488?ZW_TRANSPORT
B1:00B400 7F01              MOV      R7,#01H
B1:00B402 12834D            LCALL    _TxQueueGetElement
B1:00B405 9009DF            MOV      DPTR,#pACKFrame
B1:00B408 12D134            LCALL    ?L?COM0287
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 304


B1:00B40B 7002              JNZ      $ + 4H
B1:00B40D 81D5              AJMP     ?C0488?ZW_TRANSPORT
B1:00B40F 9009DF            MOV      DPTR,#pACKFrame
B1:00B412 122552            LCALL    ?C?PLDXDATA
B1:00B415 7F03              MOV      R7,#03H
B1:00B417 12A00B            LCALL    _BuildTxHeader
B1:00B41A 12B8B0            LCALL    ?L?COM0075
B1:00B41D 2405              ADD      A,#05H
B1:00B41F 1285F5            LCALL    ?L?COM0004
B1:00B422 30E40B            JNB      ACC.4,?C0490?ZW_TRANSPORT
B1:00B425 12BBEB            LCALL    ?L?COM02D8
B1:00B428 1285F5            LCALL    ?L?COM0004
B1:00B42B 4410              ORL      A,#010H
B1:00B42D 12203B            LCALL    ?C?CSTPTR
B1:00B430         ?C0490?ZW_TRANSPORT:
B1:00B430 9009DF            MOV      DPTR,#pACKFrame
B1:00B433 12D1A1            LCALL    ?L?COM00E1
B1:00B436 9009DF            MOV      DPTR,#pACKFrame
B1:00B439 12FC5A            LCALL    ?L?COM025C
B1:00B43C 75F052            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00B43F 1221E8            LCALL    ?C?ISTPTR
B1:00B442 9009DF            MOV      DPTR,#pACKFrame
B1:00B445 122552            LCALL    ?C?PLDXDATA
B1:00B448 E9                MOV      A,R1
B1:00B449 24DC              ADD      A,#0DCH
B1:00B44B F9                MOV      R1,A
B1:00B44C E4                CLR      A
B1:00B44D 3A                ADDC     A,R2
B1:00B44E FA                MOV      R2,A
B1:00B44F 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_TransportDummyApplicationCallback
B1:00B451 75F05D            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_TransportDummyApplicationCallback
B1:00B454 1221E8            LCALL    ?C?ISTPTR
B1:00B457 900774            MOV      DPTR,#rxFrame+08H
B1:00B45A E0                MOVX     A,@DPTR
B1:00B45B FF                MOV      R7,A
B1:00B45C 9009DF            MOV      DPTR,#pACKFrame
B1:00B45F 122552            LCALL    ?C?PLDXDATA
B1:00B462 E9                MOV      A,R1
B1:00B463 24BA              ADD      A,#0BAH
B1:00B465 1287AB            LCALL    ?L?COM0015
B1:00B468 9009DF            MOV      DPTR,#pACKFrame
B1:00B46B 1252EE            LCALL    ?L?COM001E
B1:00B46E 54F8              ANL      A,#0F8H
B1:00B470 FF                MOV      R7,A
B1:00B471 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00B474 E0                MOVX     A,@DPTR
B1:00B475 FD                MOV      R5,A
B1:00B476 12D088            LCALL    ?L?COM023F
B1:00B479 12B8B0            LCALL    ?L?COM0075
B1:00B47C 2405              ADD      A,#05H
B1:00B47E 1285F5            LCALL    ?L?COM0004
B1:00B481 30E50D            JNB      ACC.5,?C0491?ZW_TRANSPORT
B1:00B484 12BBEB            LCALL    ?L?COM02D8
B1:00B487 1285F5            LCALL    ?L?COM0004
B1:00B48A 4420              ORL      A,#020H
B1:00B48C 12203B            LCALL    ?C?CSTPTR
B1:00B48F 8035              SJMP     ?C0492?ZW_TRANSPORT
B1:00B491         ?C0491?ZW_TRANSPORT:
B1:00B491 90076F            MOV      DPTR,#rxFrame+03H
B1:00B494 12C941            LCALL    ?L?COM0048
B1:00B497 6401              XRL      A,#01H
B1:00B499 702B              JNZ      ?C0492?ZW_TRANSPORT
B1:00B49B E9                MOV      A,R1
B1:00B49C 2401              ADD      A,#01H
B1:00B49E 1285F5            LCALL    ?L?COM0004
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 305


B1:00B4A1 6418              XRL      A,#018H
B1:00B4A3 7021              JNZ      ?C0492?ZW_TRANSPORT
B1:00B4A5 900772            MOV      DPTR,#rxFrame+06H
B1:00B4A8 E0                MOVX     A,@DPTR
B1:00B4A9 90076F            MOV      DPTR,#rxFrame+03H
B1:00B4AC B4040B            CJNE     A,#04H,?C0494?ZW_TRANSPORT
B1:00B4AF 1285EF            LCALL    ?L?COM0002
B1:00B4B2 FF                MOV      R7,A
B1:00B4B3 1259F7            LCALL    _RFPowerGetTxPwrReg
B1:00B4B6 8F19              MOV      ackPower,R7
B1:00B4B8 800C              SJMP     ?C0492?ZW_TRANSPORT
B1:00B4BA         ?C0494?ZW_TRANSPORT:
B1:00B4BA 129557            LCALL    ?L?COM003C
B1:00B4BD 1285F5            LCALL    ?L?COM0004
B1:00B4C0 FF                MOV      R7,A
B1:00B4C1 125D70            LCALL    _RFPowerConvert
B1:00B4C4 8F19              MOV      ackPower,R7
B1:00B4C6         ?C0492?ZW_TRANSPORT:
B1:00B4C6 9009DF            MOV      DPTR,#pACKFrame
B1:00B4C9 122552            LCALL    ?C?PLDXDATA
B1:00B4CC 12C91F            LCALL    _TxQueueQueueElement
B1:00B4CF 201503            JB       bPauseEnabled,?C0488?ZW_TRANSPORT
B1:00B4D2 1281F1            LCALL    TxQueueServiceTransmit
B1:00B4D5         ?C0488?ZW_TRANSPORT:
B1:00B4D5 900768            MOV      DPTR,#myFrame
B1:00B4D8 E0                MOVX     A,@DPTR
B1:00B4D9 7002              JNZ      $ + 4H
B1:00B4DB C1A0              AJMP     ?C0498?ZW_TRANSPORT
B1:00B4DD 900773            MOV      DPTR,#rxFrame+07H
B1:00B4E0 E0                MOVX     A,@DPTR
B1:00B4E1 5442              ANL      A,#042H
B1:00B4E3 6440              XRL      A,#040H
B1:00B4E5 701E              JNZ      ?C0499?ZW_TRANSPORT
B1:00B4E7 904017            MOV      DPTR,#waitingForRoutedACK
B1:00B4EA E0                MOVX     A,@DPTR
B1:00B4EB 7002              JNZ      $ + 4H
B1:00B4ED C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B4EF E4                CLR      A
B1:00B4F0 12FECF            LCALL    ?L?COM051A
B1:00B4F3 12851B            LCALL    ?L?COM000C
B1:00B4F6 24BC              ADD      A,#0BCH
B1:00B4F8 1285F5            LCALL    ?L?COM0004
B1:00B4FB 54F0              ANL      A,#0F0H
B1:00B4FD FD                MOV      R5,A
B1:00B4FE 7C00              MOV      R4,#00H
B1:00B500 1285C8            LCALL    _TransmitTimerStart
B1:00B503 C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B505         ?C0499?ZW_TRANSPORT:
B1:00B505 900773            MOV      DPTR,#rxFrame+07H
B1:00B508 E0                MOVX     A,@DPTR
B1:00B509 20E102            JB       ACC.1,$ + 5H
B1:00B50C A1E1              AJMP     ?C0502?ZW_TRANSPORT
B1:00B50E E4                CLR      A
B1:00B50F 900767            MOV      DPTR,#tmp
B1:00B512 12851A            LCALL    ?L?COM000B
B1:00B515 4A                ORL      A,R2
B1:00B516 607B              JZ       ?C0503?ZW_TRANSPORT
B1:00B518 E9                MOV      A,R1
B1:00B519 24B7              ADD      A,#0B7H
B1:00B51B 1285F5            LCALL    ?L?COM0004
B1:00B51E FF                MOV      R7,A
B1:00B51F 540F              ANL      A,#0FH
B1:00B521 6401              XRL      A,#01H
B1:00B523 706E              JNZ      ?C0503?ZW_TRANSPORT
B1:00B525 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 306


B1:00B526 30E75E            JNB      ACC.7,?C0504?ZW_TRANSPORT
B1:00B529 12851B            LCALL    ?L?COM000C
B1:00B52C 24D8              ADD      A,#0D8H
B1:00B52E 1285F5            LCALL    ?L?COM0004
B1:00B531 FF                MOV      R7,A
B1:00B532 D3                SETB     C
B1:00B533 940A              SUBB     A,#0AH
B1:00B535 5003              JNC      $ + 5H
B1:00B537 02B896            LJMP     ?C0482?ZW_TRANSPORT
B1:00B53A 12851B            LCALL    ?L?COM000C
B1:00B53D 24BC              ADD      A,#0BCH
B1:00B53F 1285F5            LCALL    ?L?COM0004
B1:00B542 FE                MOV      R6,A
;---- Variable 'activeNumRepeatersNumHops' assigned to Register 'R6' ----
B1:00B543         ?C0506?ZW_TRANSPORT:
B1:00B543 EE                MOV      A,R6
B1:00B544 540F              ANL      A,#0FH
B1:00B546 FD                MOV      R5,A
;---- Variable 'numHops' assigned to Register 'R5' ----
B1:00B547 B40F02            CJNE     A,#0FH,?C0507?ZW_TRANSPORT
B1:00B54A 802A              SJMP     ?C0624?ZW_TRANSPORT
B1:00B54C         ?C0507?ZW_TRANSPORT:
B1:00B54C EF                MOV      A,R7
B1:00B54D D3                SETB     C
B1:00B54E 940A              SUBB     A,#0AH
B1:00B550 5003              JNC      $ + 5H
B1:00B552 02B896            LJMP     ?C0482?ZW_TRANSPORT
B1:00B555 12851B            LCALL    ?L?COM000C
B1:00B558 1287DF            LCALL    ?L?COM02B8
B1:00B55B ED                MOV      A,R5
B1:00B55C 758300            MOV      DPH,#00H
B1:00B55F 29                ADD      A,R1
B1:00B560 F9                MOV      R1,A
B1:00B561 E583              MOV      A,DPH
B1:00B563 3A                ADDC     A,R2
B1:00B564 FA                MOV      R2,A
B1:00B565 121F7C            LCALL    ?C?CLDPTR
B1:00B568 900767            MOV      DPTR,#tmp
B1:00B56B F0                MOVX     @DPTR,A
B1:00B56C         ?C0510?ZW_TRANSPORT:
B1:00B56C EE                MOV      A,R6
B1:00B56D 54F0              ANL      A,#0F0H
B1:00B56F FF                MOV      R7,A
B1:00B570 C4                SWAP     A
B1:00B571 540F              ANL      A,#0FH
B1:00B573 B5050C            CJNE     A,AR5,?C0508?ZW_TRANSPORT
B1:00B576         
B1:00B576 12851B            LCALL    ?L?COM000C
B1:00B579 24BA              ADD      A,#0BAH
B1:00B57B 1285F5            LCALL    ?L?COM0004
B1:00B57E 900767            MOV      DPTR,#tmp
B1:00B581 F0                MOVX     @DPTR,A
B1:00B582         ?C0508?ZW_TRANSPORT:
B1:00B582 12E7A1            LCALL    SetTransmitPause
B1:00B585 800C              SJMP     ?C0503?ZW_TRANSPORT
B1:00B587         ?C0504?ZW_TRANSPORT:
B1:00B587 12851B            LCALL    ?L?COM000C
B1:00B58A 24BA              ADD      A,#0BAH
B1:00B58C 1285F5            LCALL    ?L?COM0004
B1:00B58F 900767            MOV      DPTR,#tmp
B1:00B592 F0                MOVX     @DPTR,A
B1:00B593         ?C0503?ZW_TRANSPORT:
B1:00B593 12851B            LCALL    ?L?COM000C
B1:00B596 4A                ORL      A,R2
B1:00B597 7002              JNZ      $ + 4H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 307


B1:00B599 C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B59B 90076C            MOV      DPTR,#rxFrame
B1:00B59E 129549            LCALL    ?L?COM0058
B1:00B5A1 1285F5            LCALL    ?L?COM0004
B1:00B5A4 FF                MOV      R7,A
B1:00B5A5 900767            MOV      DPTR,#tmp
B1:00B5A8 E0                MOVX     A,@DPTR
B1:00B5A9 6F                XRL      A,R7
B1:00B5AA 6008              JZ       ?C0514?ZW_TRANSPORT
B1:00B5AC 900679            MOV      DPTR,#sACK
B1:00B5AF E0                MOVX     A,@DPTR
B1:00B5B0 7002              JNZ      $ + 4H
B1:00B5B2 C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B5B4         ?C0514?ZW_TRANSPORT:
B1:00B5B4 12B8B0            LCALL    ?L?COM0075
B1:00B5B7 2405              ADD      A,#05H
B1:00B5B9 1285F5            LCALL    ?L?COM0004
B1:00B5BC 30E70E            JNB      ACC.7,?C0515?ZW_TRANSPORT
B1:00B5BF 12B8B0            LCALL    ?L?COM0075
B1:00B5C2 2409              ADD      A,#09H
B1:00B5C4 1285F5            LCALL    ?L?COM0004
B1:00B5C7 5406              ANL      A,#06H
B1:00B5C9 900667            MOV      DPTR,#isRoutedAckErr
B1:00B5CC F0                MOVX     @DPTR,A
B1:00B5CD         ?C0515?ZW_TRANSPORT:
B1:00B5CD 900667            MOV      DPTR,#isRoutedAckErr
B1:00B5D0 E0                MOVX     A,@DPTR
B1:00B5D1 20E206            JB       ACC.2,?C0516?ZW_TRANSPORT
B1:00B5D4 12E7BC            LCALL    ?L?COM025B
B1:00B5D7 1285FC            LCALL    _HandleTransferAck
B1:00B5DA         ?C0516?ZW_TRANSPORT:
B1:00B5DA E4                CLR      A
B1:00B5DB 900667            MOV      DPTR,#isRoutedAckErr
B1:00B5DE F0                MOVX     @DPTR,A
B1:00B5DF C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B5E1         ?C0502?ZW_TRANSPORT:
B1:00B5E1 900773            MOV      DPTR,#rxFrame+07H
B1:00B5E4 E0                MOVX     A,@DPTR
B1:00B5E5 5422              ANL      A,#022H
B1:00B5E7 6420              XRL      A,#020H
B1:00B5E9 701B              JNZ      ?C0518?ZW_TRANSPORT
B1:00B5EB 904017            MOV      DPTR,#waitingForRoutedACK
B1:00B5EE E0                MOVX     A,@DPTR
B1:00B5EF 7002              JNZ      $ + 4H
B1:00B5F1 C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B5F3 12ECDD            LCALL    ?L?COM021B
B1:00B5F6 1289D9            LCALL    ?L?COM0433
B1:00B5F9 12E7BC            LCALL    ?L?COM025B
B1:00B5FC AD07              MOV      R5,AR7
B1:00B5FE 12ED88            LCALL    ?L?COM04C9
B1:00B601 12BB69            LCALL    _HandleRoutedAck
B1:00B604 C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B606         ?C0518?ZW_TRANSPORT:
B1:00B606 900773            MOV      DPTR,#rxFrame+07H
B1:00B609 E0                MOVX     A,@DPTR
B1:00B60A 30E402            JNB      ACC.4,$ + 5H
B1:00B60D C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B60F 900679            MOV      DPTR,#sACK
B1:00B612 E0                MOVX     A,@DPTR
B1:00B613 30E202            JNB      ACC.2,$ + 5H
B1:00B616 C1BA              AJMP     ?C0528?ZW_TRANSPORT
B1:00B618 12B8B0            LCALL    ?L?COM0075
B1:00B61B 2408              ADD      A,#08H
B1:00B61D 1285F5            LCALL    ?L?COM0004
B1:00B620 F4                CPL      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 308


B1:00B621 6026              JZ       ?C0522?ZW_TRANSPORT
B1:00B623 12ECDD            LCALL    ?L?COM021B
B1:00B626 12D5F9            LCALL    ?L?COM008D
B1:00B629 540F              ANL      A,#0FH
B1:00B62B FF                MOV      R7,A
B1:00B62C BF0203            CJNE     R7,#02H,?C0523?ZW_TRANSPORT
B1:00B62F D3                SETB     C
B1:00B630 8001              SJMP     ?C0524?ZW_TRANSPORT
B1:00B632         ?C0523?ZW_TRANSPORT:
B1:00B632 C3                CLR      C
B1:00B633         ?C0524?ZW_TRANSPORT:
B1:00B633 4014              JC       ?C0522?ZW_TRANSPORT
B1:00B635 12B8B0            LCALL    ?L?COM0075
B1:00B638 2406              ADD      A,#06H
B1:00B63A 1285F5            LCALL    ?L?COM0004
B1:00B63D 30E703            JNB      ACC.7,?C0525?ZW_TRANSPORT
B1:00B640 12EFCD            LCALL    ZW_FollowUpReceived
B1:00B643         ?C0525?ZW_TRANSPORT:
B1:00B643 12ECDD            LCALL    ?L?COM021B
B1:00B646 1289D9            LCALL    ?L?COM0433
B1:00B649         ?C0522?ZW_TRANSPORT:
B1:00B649 900773            MOV      DPTR,#rxFrame+07H
B1:00B64C E0                MOVX     A,@DPTR
B1:00B64D 30E306            JNB      ACC.3,?C0526?ZW_TRANSPORT
B1:00B650 12ED88            LCALL    ?L?COM04C9
B1:00B653 12B8CF            LCALL    _SendRouteAck
B1:00B656         ?C0526?ZW_TRANSPORT:
B1:00B656 203A61            JB       productionTest,?C0528?ZW_TRANSPORT
B1:00B659 12BAF2            LCALL    UpdateRxStatus
B1:00B65C 9009E2            MOV      DPTR,#bRxStatus
B1:00B65F EF                MOV      A,R7
B1:00B660 F0                MOVX     @DPTR,A
B1:00B661 7A06              MOV      R2,#HIGH rxopt
B1:00B663 7974              MOV      R1,#LOW rxopt
B1:00B665 7D05              MOV      R5,#05H
B1:00B667 12FE0B            LCALL    ?L?COM00E7
B1:00B66A 9009E2            MOV      DPTR,#bRxStatus
B1:00B66D E0                MOVX     A,@DPTR
B1:00B66E 900674            MOV      DPTR,#rxopt
B1:00B671 F0                MOVX     @DPTR,A
B1:00B672 90076C            MOV      DPTR,#rxFrame
B1:00B675 129549            LCALL    ?L?COM0058
B1:00B678 1285F5            LCALL    ?L?COM0004
B1:00B67B 900675            MOV      DPTR,#rxopt+01H
B1:00B67E F0                MOVX     @DPTR,A
B1:00B67F 12E7BC            LCALL    ?L?COM025B
B1:00B682 900677            MOV      DPTR,#rxopt+03H
B1:00B685 EF                MOV      A,R7
B1:00B686 F0                MOVX     @DPTR,A
B1:00B687 900772            MOV      DPTR,#rxFrame+06H
B1:00B68A E0                MOVX     A,@DPTR
B1:00B68B FD                MOV      R5,A
B1:00B68C 7B01              MOV      R3,#01H
B1:00B68E 7A06              MOV      R2,#HIGH rxopt
B1:00B690 7974              MOV      R1,#LOW rxopt
B1:00B692 12F2C4            LCALL    ?L?COM0378
B1:00B695 90076F            MOV      DPTR,#rxFrame+03H
B1:00B698 122552            LCALL    ?C?PLDXDATA
B1:00B69B 12BCFE            LCALL    _CommandHandler
B1:00B69E 801A              SJMP     ?C0528?ZW_TRANSPORT
B1:00B6A0         ?C0498?ZW_TRANSPORT:
B1:00B6A0 12851B            LCALL    ?L?COM000C
B1:00B6A3 4A                ORL      A,R2
B1:00B6A4 6014              JZ       ?C0528?ZW_TRANSPORT
B1:00B6A6 904013            MOV      DPTR,#bRetransmitTimer
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 309


B1:00B6A9 E0                MOVX     A,@DPTR
B1:00B6AA 600E              JZ       ?C0528?ZW_TRANSPORT
B1:00B6AC 900672            MOV      DPTR,#bRestartAckTimerAllowed
B1:00B6AF E0                MOVX     A,@DPTR
B1:00B6B0 6008              JZ       ?C0528?ZW_TRANSPORT
B1:00B6B2 121C50            LCALL    ?INTERBANK_TABLE?TransportTimerRestart
B1:00B6B5 E4                CLR      A
B1:00B6B6 900672            MOV      DPTR,#bRestartAckTimerAllowed
B1:00B6B9 F0                MOVX     @DPTR,A
B1:00B6BA         ?C0528?ZW_TRANSPORT:
B1:00B6BA 900773            MOV      DPTR,#rxFrame+07H
B1:00B6BD E0                MOVX     A,@DPTR
B1:00B6BE 20E40A            JB       ACC.4,?C0532?ZW_TRANSPORT
B1:00B6C1 900679            MOV      DPTR,#sACK
B1:00B6C4 E0                MOVX     A,@DPTR
B1:00B6C5 20E203            JB       ACC.2,$ + 6H
B1:00B6C8 02B896            LJMP     ?C0482?ZW_TRANSPORT
B1:00B6CB         ?C0532?ZW_TRANSPORT:
B1:00B6CB 7F02              MOV      R7,#02H
B1:00B6CD 12834D            LCALL    _TxQueueGetElement
B1:00B6D0 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B6D3 12D134            LCALL    ?L?COM0287
B1:00B6D6 7003              JNZ      ?C0533?ZW_TRANSPORT
B1:00B6D8 C209              CLR      inclusionHomeIDActive
B1:00B6DA 22                RET      
B1:00B6DB         ?C0533?ZW_TRANSPORT:
B1:00B6DB D209              SETB     inclusionHomeIDActive
B1:00B6DD 12DA72            LCALL    ?L?COM0343
B1:00B6E0 1287B9            LCALL    ?L?COM003F
B1:00B6E3 12FEA2            LCALL    ?L?COM04C8
B1:00B6E6 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00B6E9 E0                MOVX     A,@DPTR
B1:00B6EA 900767            MOV      DPTR,#tmp
B1:00B6ED F0                MOVX     @DPTR,A
B1:00B6EE 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B6F1 12E012            LCALL    ?L?COM00B3
B1:00B6F4 12E45A            LCALL    ?L?COM03B3
B1:00B6F7 12203B            LCALL    ?C?CSTPTR
B1:00B6FA 900772            MOV      DPTR,#rxFrame+06H
B1:00B6FD E0                MOVX     A,@DPTR
B1:00B6FE 12F2A1            LCALL    ?L?COM058A
B1:00B701 14                DEC      A
B1:00B702 FF                MOV      R7,A
B1:00B703 12B897            LCALL    ?L?COM00C9
B1:00B706 24D8              ADD      A,#0D8H
B1:00B708 1287AB            LCALL    ?L?COM0015
B1:00B70B D3                SETB     C
B1:00B70C 9426              SUBB     A,#026H
B1:00B70E 4004              JC       ?C0534?ZW_TRANSPORT
B1:00B710 7F26              MOV      R7,#026H
B1:00B712 8009              SJMP     ?C0535?ZW_TRANSPORT
B1:00B714         ?C0534?ZW_TRANSPORT:
B1:00B714 12B897            LCALL    ?L?COM00C9
B1:00B717 24D8              ADD      A,#0D8H
B1:00B719 1285F5            LCALL    ?L?COM0004
B1:00B71C FF                MOV      R7,A
B1:00B71D         ?C0535?ZW_TRANSPORT:
B1:00B71D 12B897            LCALL    ?L?COM00C9
B1:00B720 1256E7            LCALL    ?L?COM018E
B1:00B723 C003              PUSH     AR3
B1:00B725 C002              PUSH     AR2
B1:00B727 C001              PUSH     AR1
B1:00B729 90076C            MOV      DPTR,#rxFrame
B1:00B72C 1287B6            LCALL    ?L?COM003E
B1:00B72F D001              POP      AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 310


B1:00B731 D002              POP      AR2
B1:00B733 D003              POP      AR3
B1:00B735 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00B738         ?C0536?ZW_TRANSPORT:
B1:00B738 900772            MOV      DPTR,#rxFrame+06H
B1:00B73B E0                MOVX     A,@DPTR
B1:00B73C FF                MOV      R7,A
B1:00B73D 12B897            LCALL    ?L?COM00C9
B1:00B740 24B1              ADD      A,#0B1H
B1:00B742 1287AB            LCALL    ?L?COM0015
B1:00B745 D3                SETB     C
B1:00B746 94A9              SUBB     A,#0A9H
B1:00B748 4004              JC       ?C0537?ZW_TRANSPORT
B1:00B74A 7FA9              MOV      R7,#0A9H
B1:00B74C 8009              SJMP     ?C0538?ZW_TRANSPORT
B1:00B74E         ?C0537?ZW_TRANSPORT:
B1:00B74E 12B897            LCALL    ?L?COM00C9
B1:00B751 24B1              ADD      A,#0B1H
B1:00B753 1285F5            LCALL    ?L?COM0004
B1:00B756 FF                MOV      R7,A
B1:00B757         ?C0538?ZW_TRANSPORT:
B1:00B757 12B897            LCALL    ?L?COM00C9
B1:00B75A 12BC01            LCALL    ?L?COM0123
B1:00B75D C003              PUSH     AR3
B1:00B75F C002              PUSH     AR2
B1:00B761 C001              PUSH     AR1
B1:00B763 90076F            MOV      DPTR,#rxFrame+03H
B1:00B766 1287B6            LCALL    ?L?COM003E
B1:00B769 D001              POP      AR1
B1:00B76B D002              POP      AR2
B1:00B76D D003              POP      AR3
B1:00B76F 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00B772         ?C0539?ZW_TRANSPORT:
B1:00B772 12B897            LCALL    ?L?COM00C9
B1:00B775 24BC              ADD      A,#0BCH
B1:00B777 1285F5            LCALL    ?L?COM0004
B1:00B77A FF                MOV      R7,A
B1:00B77B 540F              ANL      A,#0FH
B1:00B77D FE                MOV      R6,A
;---- Variable 'numHops1' assigned to Register 'R6' ----
B1:00B77E 12B897            LCALL    ?L?COM00C9
B1:00B781 24BB              ADD      A,#0BBH
B1:00B783 1285F5            LCALL    ?L?COM0004
B1:00B786 30E01F            JNB      ACC.0,?C0540?ZW_TRANSPORT
B1:00B789 1E                DEC      R6
B1:00B78A EE                MOV      A,R6
B1:00B78B 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B78E B4FF0A            CJNE     A,#0FFH,?C0541?ZW_TRANSPORT
B1:00B791 12BBEE            LCALL    ?L?COM02D9
B1:00B794 1285F5            LCALL    ?L?COM0004
B1:00B797 4440              ORL      A,#040H
B1:00B799 8008              SJMP     ?C0625?ZW_TRANSPORT
B1:00B79B         ?C0541?ZW_TRANSPORT:
B1:00B79B 12BBEE            LCALL    ?L?COM02D9
B1:00B79E 1285F5            LCALL    ?L?COM0004
B1:00B7A1 54BF              ANL      A,#0BFH
B1:00B7A3         
B1:00B7A3 12203B            LCALL    ?C?CSTPTR
B1:00B7A6 8059              SJMP     ?C0543?ZW_TRANSPORT
B1:00B7A8         ?C0540?ZW_TRANSPORT:
B1:00B7A8 EF                MOV      A,R7
B1:00B7A9 C4                SWAP     A
B1:00B7AA 540F              ANL      A,#0FH
B1:00B7AC 14                DEC      A
B1:00B7AD 6E                XRL      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 311


B1:00B7AE 7050              JNZ      ?C0544?ZW_TRANSPORT
B1:00B7B0 12B8B0            LCALL    ?L?COM0075
B1:00B7B3 2409              ADD      A,#09H
B1:00B7B5 1285F5            LCALL    ?L?COM0004
B1:00B7B8 30E345            JNB      ACC.3,?C0544?ZW_TRANSPORT
B1:00B7BB 12B8B0            LCALL    ?L?COM0075
B1:00B7BE 240A              ADD      A,#0AH
B1:00B7C0 1285F5            LCALL    ?L?COM0004
B1:00B7C3 12F704            LCALL    ?L?COM03BF
B1:00B7C6 12B8B0            LCALL    ?L?COM0075
B1:00B7C9 12D9BA            LCALL    ?L?COM0088
B1:00B7CC 3A                ADDC     A,R2
B1:00B7CD FA                MOV      R2,A
B1:00B7CE 121F7C            LCALL    ?C?CLDPTR
B1:00B7D1 540F              ANL      A,#0FH
B1:00B7D3 702B              JNZ      ?C0544?ZW_TRANSPORT
B1:00B7D5 E9                MOV      A,R1
B1:00B7D6 2401              ADD      A,#01H
B1:00B7D8 1285F5            LCALL    ?L?COM0004
B1:00B7DB 5460              ANL      A,#060H
B1:00B7DD FF                MOV      R7,A
B1:00B7DE 6020              JZ       ?C0544?ZW_TRANSPORT
B1:00B7E0 900767            MOV      DPTR,#tmp
B1:00B7E3 E0                MOVX     A,@DPTR
B1:00B7E4 BF2005            CJNE     R7,#020H,?C0546?ZW_TRANSPORT
B1:00B7E7 4420              ORL      A,#020H
B1:00B7E9 F0                MOVX     @DPTR,A
B1:00B7EA 8003              SJMP     ?C0547?ZW_TRANSPORT
B1:00B7EC         ?C0546?ZW_TRANSPORT:
B1:00B7EC 4440              ORL      A,#040H
B1:00B7EE F0                MOVX     @DPTR,A
B1:00B7EF         ?C0547?ZW_TRANSPORT:
B1:00B7EF 12B897            LCALL    ?L?COM00C9
B1:00B7F2 24BA              ADD      A,#0BAH
B1:00B7F4 1285F5            LCALL    ?L?COM0004
B1:00B7F7 FF                MOV      R7,A
B1:00B7F8 12B897            LCALL    ?L?COM00C9
B1:00B7FB 24D9              ADD      A,#0D9H
B1:00B7FD 1287AB            LCALL    ?L?COM0015
B1:00B800         ?C0544?ZW_TRANSPORT:
B1:00B800 0E                INC      R6
B1:00B801         ?C0543?ZW_TRANSPORT:
B1:00B801 12B897            LCALL    ?L?COM00C9
B1:00B804 24BC              ADD      A,#0BCH
B1:00B806 1285F5            LCALL    ?L?COM0004
B1:00B809 54F0              ANL      A,#0F0H
B1:00B80B FF                MOV      R7,A
B1:00B80C EE                MOV      A,R6
B1:00B80D 540F              ANL      A,#0FH
B1:00B80F 4F                ORL      A,R7
B1:00B810 12203B            LCALL    ?C?CSTPTR
B1:00B813 1197              ACALL    ?L?COM00C9
B1:00B815 24BB              ADD      A,#0BBH
B1:00B817 1285F5            LCALL    ?L?COM0004
B1:00B81A 30E128            JNB      ACC.1,?C0548?ZW_TRANSPORT
B1:00B81D 30E325            JNB      ACC.3,?C0548?ZW_TRANSPORT
B1:00B820 1197              ACALL    ?L?COM00C9
B1:00B822 24BC              ADD      A,#0BCH
B1:00B824 1285F5            LCALL    ?L?COM0004
B1:00B827 71F5              ACALL    ?L?COM01E2
B1:00B829 1197              ACALL    ?L?COM00C9
B1:00B82B 24BD              ADD      A,#0BDH
B1:00B82D 11C4              ACALL    ?L?COM002D
B1:00B82F 121F7C            LCALL    ?C?CLDPTR
B1:00B832 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 312


B1:00B834 FF                MOV      R7,A
B1:00B835 BF010D            CJNE     R7,#01H,?C0548?ZW_TRANSPORT
B1:00B838 12E7BC            LCALL    ?L?COM025B
B1:00B83B AD07              MOV      R5,AR7
B1:00B83D 1197              ACALL    ?L?COM00C9
B1:00B83F 1256E7            LCALL    ?L?COM018E
B1:00B842 12C6FD            LCALL    _UpdateRssiInRepeatedFrame
B1:00B845         ?C0548?ZW_TRANSPORT:
B1:00B845 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B848 1285EF            LCALL    ?L?COM0002
B1:00B84B 4420              ORL      A,#020H
B1:00B84D 12203B            LCALL    ?C?CSTPTR
B1:00B850 900767            MOV      DPTR,#tmp
B1:00B853 E0                MOVX     A,@DPTR
B1:00B854 FF                MOV      R7,A
B1:00B855 1197              ACALL    ?L?COM00C9
B1:00B857 24B6              ADD      A,#0B6H
B1:00B859 1285F5            LCALL    ?L?COM0004
B1:00B85C FD                MOV      R5,A
B1:00B85D 1197              ACALL    ?L?COM00C9
B1:00B85F 24BA              ADD      A,#0BAH
B1:00B861 1285F5            LCALL    ?L?COM0004
B1:00B864 FB                MOV      R3,A
B1:00B865 C003              PUSH     AR3
B1:00B867 1197              ACALL    ?L?COM00C9
B1:00B869 9101              ACALL    ?L?COM0123
B1:00B86B 12D6FC            LCALL    ?L?COM0354
B1:00B86E 1197              ACALL    ?L?COM00C9
B1:00B870 24B1              ADD      A,#0B1H
B1:00B872 1285F5            LCALL    ?L?COM0004
B1:00B875 12F794            LCALL    ?L?COM040E
B1:00B878 F0                MOVX     @DPTR,A
B1:00B879 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B87C 1285EF            LCALL    ?L?COM0002
B1:00B87F 9009C9            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:00B882 F0                MOVX     @DPTR,A
B1:00B883 A3                INC      DPTR
B1:00B884 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ZWRepeatComplete
B1:00B886 F0                MOVX     @DPTR,A
B1:00B887 A3                INC      DPTR
B1:00B888 7476              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ZWRepeatComplete
B1:00B88A F0                MOVX     @DPTR,A
B1:00B88B 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B88E 12D77E            LCALL    ?L?COM027B
B1:00B891 D003              POP      AR3
B1:00B893 12912A            LCALL    _EnqueueSingleDataPtr
B1:00B896         ?C0482?ZW_TRANSPORT:
B1:00B896 22                RET      
----- FUNCTION _ReceiveHandler (END) -------


----- FUNCTION ?L?COM00C9 (BEGIN) -----
B1:00B897 9009E9            MOV      DPTR,#pFrameToRepeat
B1:00B89A 122552            LCALL    ?C?PLDXDATA
B1:00B89D E9                MOV      A,R1
B1:00B89E 22                RET      
----- FUNCTION ?L?COM00C9 (END) -------


----- FUNCTION ?L?COM0073 (BEGIN) -----
B1:00B89F F9                MOV      R1,A
B1:00B8A0 E4                CLR      A
B1:00B8A1 3A                ADDC     A,R2
B1:00B8A2 FA                MOV      R2,A
B1:00B8A3         ?L?COM0074:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 313


B1:00B8A3 E9                MOV      A,R1
B1:00B8A4 2401              ADD      A,#01H
B1:00B8A6 F9                MOV      R1,A
B1:00B8A7 E4                CLR      A
B1:00B8A8 3A                ADDC     A,R2
B1:00B8A9 FA                MOV      R2,A
B1:00B8AA 9009E3            MOV      DPTR,#protPayloadCmd
B1:00B8AD 122572            LCALL    ?C?PSTXDATA
B1:00B8B0         ?L?COM0075:
B1:00B8B0 90076C            MOV      DPTR,#rxFrame
B1:00B8B3 122552            LCALL    ?C?PLDXDATA
B1:00B8B6 E9                MOV      A,R1
B1:00B8B7 22                RET      
----- FUNCTION ?L?COM0073 (END) -------


----- FUNCTION ?L?COM002B (BEGIN) -----
B1:00B8B8 900AA2            MOV      DPTR,#pRxFrame
B1:00B8BB 122552            LCALL    ?C?PLDXDATA
B1:00B8BE 122587            LCALL    ?C?PLDPTR
B1:00B8C1 E9                MOV      A,R1
B1:00B8C2         ?L?COM002C:
B1:00B8C2 240B              ADD      A,#0BH
B1:00B8C4         ?L?COM002D:
B1:00B8C4 F9                MOV      R1,A
B1:00B8C5 E4                CLR      A
B1:00B8C6         ?L?COM002E:
B1:00B8C6 3A                ADDC     A,R2
B1:00B8C7 FA                MOV      R2,A
B1:00B8C8         ?L?COM002F:
B1:00B8C8 E9                MOV      A,R1
B1:00B8C9 2F                ADD      A,R7
B1:00B8CA F9                MOV      R1,A
B1:00B8CB EE                MOV      A,R6
B1:00B8CC 3A                ADDC     A,R2
B1:00B8CD FA                MOV      R2,A
B1:00B8CE 22                RET      
----- FUNCTION ?L?COM002B (END) -------


----- FUNCTION _SendRouteAck (BEGIN) -----
B1:00B8CF 900A6E            MOV      DPTR,#pRx
B1:00B8D2 122572            LCALL    ?C?PSTXDATA
B1:00B8D5 7F02              MOV      R7,#02H
B1:00B8D7 12834D            LCALL    _TxQueueGetElement
B1:00B8DA 900A71            MOV      DPTR,#pFrame
B1:00B8DD 12D134            LCALL    ?L?COM0287
B1:00B8E0 7002              JNZ      $ + 4H
B1:00B8E2 41D7              AJMP     ?C0410?ZW_TRANSPORT
B1:00B8E4         ?C0409?ZW_TRANSPORT:
B1:00B8E4 51E1              ACALL    ?L?COM005B
B1:00B8E6 1257E2            LCALL    ?L?COM0221
B1:00B8E9 7403              MOV      A,#03H
B1:00B8EB 12203B            LCALL    ?C?CSTPTR
B1:00B8EE 900A6E            MOV      DPTR,#pRx
B1:00B8F1 12DBF8            LCALL    ?L?COM01F3
B1:00B8F4 1285F5            LCALL    ?L?COM0004
B1:00B8F7 FF                MOV      R7,A
B1:00B8F8 900A6E            MOV      DPTR,#pRx
B1:00B8FB 122552            LCALL    ?C?PLDXDATA
B1:00B8FE E9                MOV      A,R1
B1:00B8FF 2409              ADD      A,#09H
B1:00B901 1285F5            LCALL    ?L?COM0004
B1:00B904 C3                CLR      C
B1:00B905 9F                SUBB     A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 314


B1:00B906 14                DEC      A
B1:00B907 FF                MOV      R7,A
B1:00B908 51E1              ACALL    ?L?COM005B
B1:00B90A E9                MOV      A,R1
B1:00B90B 24D8              ADD      A,#0D8H
B1:00B90D 1287AB            LCALL    ?L?COM0015
B1:00B910 51E7              ACALL    ?L?COM01C3
B1:00B912 2409              ADD      A,#09H
B1:00B914 1285F5            LCALL    ?L?COM0004
B1:00B917 30E336            JNB      ACC.3,?C0411?ZW_TRANSPORT
B1:00B91A 51E1              ACALL    ?L?COM005B
B1:00B91C E9                MOV      A,R1
B1:00B91D 12A448            LCALL    ?L?COM02DD
B1:00B920 C003              PUSH     AR3
B1:00B922 C002              PUSH     AR2
B1:00B924 C001              PUSH     AR1
B1:00B926 121F7C            LCALL    ?C?CLDPTR
B1:00B929 FF                MOV      R7,A
B1:00B92A 51E7              ACALL    ?L?COM01C3
B1:00B92C 240A              ADD      A,#0AH
B1:00B92E 1285F5            LCALL    ?L?COM0004
B1:00B931 FE                MOV      R6,A
B1:00B932 12F704            LCALL    ?L?COM03BF
B1:00B935 51E7              ACALL    ?L?COM01C3
B1:00B937 12D9BA            LCALL    ?L?COM0088
B1:00B93A 3A                ADDC     A,R2
B1:00B93B FA                MOV      R2,A
B1:00B93C 121F7C            LCALL    ?C?CLDPTR
B1:00B93F C4                SWAP     A
B1:00B940 540F              ANL      A,#0FH
B1:00B942 04                INC      A
B1:00B943 FE                MOV      R6,A
B1:00B944 C3                CLR      C
B1:00B945 EF                MOV      A,R7
B1:00B946 9E                SUBB     A,R6
B1:00B947 D001              POP      AR1
B1:00B949 D002              POP      AR2
B1:00B94B D003              POP      AR3
B1:00B94D 12203B            LCALL    ?C?CSTPTR
B1:00B950         ?C0411?ZW_TRANSPORT:
B1:00B950 51E1              ACALL    ?L?COM005B
B1:00B952 E9                MOV      A,R1
B1:00B953 24D8              ADD      A,#0D8H
B1:00B955 1285F5            LCALL    ?L?COM0004
B1:00B958 FE                MOV      R6,A
B1:00B959 D3                SETB     C
B1:00B95A 9426              SUBB     A,#026H
B1:00B95C AF06              MOV      R7,AR6
B1:00B95E 4002              JC       ?C0412?ZW_TRANSPORT
B1:00B960 7F26              MOV      R7,#026H
B1:00B962         ?C0412?ZW_TRANSPORT:
B1:00B962         ?C0413?ZW_TRANSPORT:
B1:00B962 51E1              ACALL    ?L?COM005B
B1:00B964 1256E6            LCALL    ?L?COM018D
B1:00B967 C003              PUSH     AR3
B1:00B969 C002              PUSH     AR2
B1:00B96B C001              PUSH     AR1
B1:00B96D 900A6E            MOV      DPTR,#pRx
B1:00B970 122552            LCALL    ?C?PLDXDATA
B1:00B973 122587            LCALL    ?C?PLDPTR
B1:00B976 1287B9            LCALL    ?L?COM003F
B1:00B979 D001              POP      AR1
B1:00B97B D002              POP      AR2
B1:00B97D D003              POP      AR3
B1:00B97F 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 315


B1:00B982         ?C0414?ZW_TRANSPORT:
B1:00B982 51E1              ACALL    ?L?COM005B
B1:00B984 E9                MOV      A,R1
B1:00B985 12DFF3            LCALL    ?L?COM034E
B1:00B988 E4                CLR      A
B1:00B989 51DE              ACALL    ?L?COM005A
B1:00B98B E9                MOV      A,R1
B1:00B98C 24BB              ADD      A,#0BBH
B1:00B98E 1285F5            LCALL    ?L?COM0004
B1:00B991 4401              ORL      A,#01H
B1:00B993 12203B            LCALL    ?C?CSTPTR
B1:00B996 4402              ORL      A,#02H
B1:00B998 12FC51            LCALL    ?L?COM051E
B1:00B99B 51E1              ACALL    ?L?COM005B
B1:00B99D E9                MOV      A,R1
B1:00B99E 24B6              ADD      A,#0B6H
B1:00B9A0 1287AB            LCALL    ?L?COM0015
B1:00B9A3 51E7              ACALL    ?L?COM01C3
B1:00B9A5 2404              ADD      A,#04H
B1:00B9A7 1285F5            LCALL    ?L?COM0004
B1:00B9AA FF                MOV      R7,A
B1:00B9AB 51E1              ACALL    ?L?COM005B
B1:00B9AD E9                MOV      A,R1
B1:00B9AE 24BA              ADD      A,#0BAH
B1:00B9B0 1287AB            LCALL    ?L?COM0015
B1:00B9B3 51E1              ACALL    ?L?COM005B
B1:00B9B5 E9                MOV      A,R1
B1:00B9B6 24BC              ADD      A,#0BCH
B1:00B9B8 1285F5            LCALL    ?L?COM0004
B1:00B9BB FF                MOV      R7,A
B1:00B9BC 540F              ANL      A,#0FH
B1:00B9BE FE                MOV      R6,A
;---- Variable 'bTemp' assigned to Register 'R6' ----
B1:00B9BF EF                MOV      A,R7
B1:00B9C0 54F0              ANL      A,#0F0H
B1:00B9C2 12203B            LCALL    ?C?CSTPTR
B1:00B9C5 54F0              ANL      A,#0F0H
B1:00B9C7 FF                MOV      R7,A
B1:00B9C8 EE                MOV      A,R6
B1:00B9C9 14                DEC      A
B1:00B9CA 540F              ANL      A,#0FH
B1:00B9CC 4F                ORL      A,R7
B1:00B9CD 51DE              ACALL    ?L?COM005A
B1:00B9CF E9                MOV      A,R1
B1:00B9D0 24BB              ADD      A,#0BBH
B1:00B9D2 1285F5            LCALL    ?L?COM0004
B1:00B9D5 4408              ORL      A,#08H
B1:00B9D7 51DE              ACALL    ?L?COM005A
B1:00B9D9 E9                MOV      A,R1
B1:00B9DA 24BC              ADD      A,#0BCH
B1:00B9DC 1285F5            LCALL    ?L?COM0004
B1:00B9DF 71F5              ACALL    ?L?COM01E2
B1:00B9E1 51E1              ACALL    ?L?COM005B
B1:00B9E3 E9                MOV      A,R1
B1:00B9E4 24BD              ADD      A,#0BDH
B1:00B9E6 11C4              ACALL    ?L?COM002D
B1:00B9E8 7401              MOV      A,#01H
B1:00B9EA 51DE              ACALL    ?L?COM005A
B1:00B9EC E9                MOV      A,R1
B1:00B9ED 24BC              ADD      A,#0BCH
B1:00B9EF 1285F5            LCALL    ?L?COM0004
B1:00B9F2 C4                SWAP     A
B1:00B9F3 540F              ANL      A,#0FH
B1:00B9F5 FF                MOV      R7,A
B1:00B9F6 51E1              ACALL    ?L?COM005B
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 316


B1:00B9F8 E9                MOV      A,R1
B1:00B9F9 24BD              ADD      A,#0BDH
B1:00B9FB 11C4              ACALL    ?L?COM002D
B1:00B9FD 121F7C            LCALL    ?C?CLDPTR
B1:00BA00 4440              ORL      A,#040H
B1:00BA02 51DE              ACALL    ?L?COM005A
B1:00BA04 E9                MOV      A,R1
B1:00BA05 24BC              ADD      A,#0BCH
B1:00BA07 1285F5            LCALL    ?L?COM0004
B1:00BA0A C4                SWAP     A
B1:00BA0B 540F              ANL      A,#0FH
B1:00BA0D FF                MOV      R7,A
B1:00BA0E 51E1              ACALL    ?L?COM005B
B1:00BA10 11C8              ACALL    ?L?COM002F
B1:00BA12 E9                MOV      A,R1
B1:00BA13 24BE              ADD      A,#0BEH
B1:00BA15 51D8              ACALL    ?L?COM0059
B1:00BA17 E9                MOV      A,R1
B1:00BA18 24BC              ADD      A,#0BCH
B1:00BA1A 1285F5            LCALL    ?L?COM0004
B1:00BA1D C4                SWAP     A
B1:00BA1E 540F              ANL      A,#0FH
B1:00BA20 FF                MOV      R7,A
B1:00BA21 51E1              ACALL    ?L?COM005B
B1:00BA23 11C8              ACALL    ?L?COM002F
B1:00BA25 E9                MOV      A,R1
B1:00BA26 24BF              ADD      A,#0BFH
B1:00BA28 51D8              ACALL    ?L?COM0059
B1:00BA2A E9                MOV      A,R1
B1:00BA2B 24BC              ADD      A,#0BCH
B1:00BA2D 1285F5            LCALL    ?L?COM0004
B1:00BA30 C4                SWAP     A
B1:00BA31 540F              ANL      A,#0FH
B1:00BA33 FF                MOV      R7,A
B1:00BA34 51E1              ACALL    ?L?COM005B
B1:00BA36 11C8              ACALL    ?L?COM002F
B1:00BA38 E9                MOV      A,R1
B1:00BA39 24C0              ADD      A,#0C0H
B1:00BA3B 51D8              ACALL    ?L?COM0059
B1:00BA3D E9                MOV      A,R1
B1:00BA3E 24BC              ADD      A,#0BCH
B1:00BA40 1285F5            LCALL    ?L?COM0004
B1:00BA43 C4                SWAP     A
B1:00BA44 540F              ANL      A,#0FH
B1:00BA46 FF                MOV      R7,A
B1:00BA47 51E1              ACALL    ?L?COM005B
B1:00BA49 11C8              ACALL    ?L?COM002F
B1:00BA4B E9                MOV      A,R1
B1:00BA4C 24C1              ADD      A,#0C1H
B1:00BA4E 51D8              ACALL    ?L?COM0059
B1:00BA50 E9                MOV      A,R1
B1:00BA51 12A448            LCALL    ?L?COM02DD
B1:00BA54 7405              MOV      A,#05H
B1:00BA56 121FE6            LCALL    ?C?CILDPTR
B1:00BA59 51E1              ACALL    ?L?COM005B
B1:00BA5B 1257E2            LCALL    ?L?COM0221
B1:00BA5E 7403              MOV      A,#03H
B1:00BA60 51DE              ACALL    ?L?COM005A
B1:00BA62 E9                MOV      A,R1
B1:00BA63 24B1              ADD      A,#0B1H
B1:00BA65 1285F5            LCALL    ?L?COM0004
B1:00BA68 FF                MOV      R7,A
B1:00BA69 51E1              ACALL    ?L?COM005B
B1:00BA6B E9                MOV      A,R1
B1:00BA6C 24D8              ADD      A,#0D8H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 317


B1:00BA6E 1285F5            LCALL    ?L?COM0004
B1:00BA71 2F                ADD      A,R7
B1:00BA72 04                INC      A
B1:00BA73 FF                MOV      R7,A
B1:00BA74 51E1              ACALL    ?L?COM005B
B1:00BA76 E9                MOV      A,R1
B1:00BA77 24B9              ADD      A,#0B9H
B1:00BA79 1287AB            LCALL    ?L?COM0015
B1:00BA7C 900A71            MOV      DPTR,#pFrame
B1:00BA7F 1285EF            LCALL    ?L?COM0002
B1:00BA82 4420              ORL      A,#020H
B1:00BA84 12203B            LCALL    ?C?CSTPTR
B1:00BA87 300905            JNB      inclusionHomeIDActive,?C0415?ZW_TRANSPORT
B1:00BA8A 51E1              ACALL    ?L?COM005B
B1:00BA8C 129F96            LCALL    _SetTransmitHomeID
B1:00BA8F         ?C0415?ZW_TRANSPORT:
B1:00BA8F 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00BA92 E0                MOVX     A,@DPTR
B1:00BA93 FF                MOV      R7,A
B1:00BA94 51E1              ACALL    ?L?COM005B
B1:00BA96 E9                MOV      A,R1
B1:00BA97 24B6              ADD      A,#0B6H
B1:00BA99 1285F5            LCALL    ?L?COM0004
B1:00BA9C FD                MOV      R5,A
B1:00BA9D 51E1              ACALL    ?L?COM005B
B1:00BA9F E9                MOV      A,R1
B1:00BAA0 24BA              ADD      A,#0BAH
B1:00BAA2 1285F5            LCALL    ?L?COM0004
B1:00BAA5 FB                MOV      R3,A
B1:00BAA6 C003              PUSH     AR3
B1:00BAA8 51E1              ACALL    ?L?COM005B
B1:00BAAA 9100              ACALL    ?L?COM0122
B1:00BAAC 12D6FC            LCALL    ?L?COM0354
B1:00BAAF 51E1              ACALL    ?L?COM005B
B1:00BAB1 E9                MOV      A,R1
B1:00BAB2 24B1              ADD      A,#0B1H
B1:00BAB4 1285F5            LCALL    ?L?COM0004
B1:00BAB7 12F794            LCALL    ?L?COM040E
B1:00BABA F0                MOVX     @DPTR,A
B1:00BABB 900A71            MOV      DPTR,#pFrame
B1:00BABE 1285EF            LCALL    ?L?COM0002
B1:00BAC1 12FC67            LCALL    ?L?COM03C0
B1:00BAC4 51E1              ACALL    ?L?COM005B
B1:00BAC6 12D781            LCALL    ?L?COM027C
B1:00BAC9 D003              POP      AR3
B1:00BACB 12912A            LCALL    _EnqueueSingleDataPtr
B1:00BACE 9003BA            MOV      DPTR,#bPauseTransmitCountdown
B1:00BAD1 E0                MOVX     A,@DPTR
B1:00BAD2 7003              JNZ      ?C0410?ZW_TRANSPORT
B1:00BAD4 1281F1            LCALL    TxQueueServiceTransmit
B1:00BAD7         ?C0410?ZW_TRANSPORT:
B1:00BAD7 22                RET      
----- FUNCTION _SendRouteAck (END) -------


----- FUNCTION ?L?COM0059 (BEGIN) -----
B1:00BAD8 F9                MOV      R1,A
B1:00BAD9 E4                CLR      A
B1:00BADA 3A                ADDC     A,R2
B1:00BADB FA                MOV      R2,A
B1:00BADC 747F              MOV      A,#07FH
B1:00BADE         ?L?COM005A:
B1:00BADE 12203B            LCALL    ?C?CSTPTR
B1:00BAE1         ?L?COM005B:
B1:00BAE1 900A71            MOV      DPTR,#pFrame
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 318


B1:00BAE4 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0059 (END) -------


----- FUNCTION ?L?COM01C3 (BEGIN) -----
B1:00BAE7 900A6E            MOV      DPTR,#pRx
B1:00BAEA         ?L?COM01C4:
B1:00BAEA 122552            LCALL    ?C?PLDXDATA
B1:00BAED 122587            LCALL    ?C?PLDPTR
B1:00BAF0 E9                MOV      A,R1
B1:00BAF1 22                RET      
----- FUNCTION ?L?COM01C3 (END) -------


----- FUNCTION UpdateRxStatus (BEGIN) -----
B1:00BAF2 12EFD2            LCALL    ResponseRouteFull
B1:00BAF5 EF                MOV      A,R7
B1:00BAF6 6004              JZ       ?C0428?ZW_TRANSPORT
B1:00BAF8 7F01              MOV      R7,#01H
B1:00BAFA 8002              SJMP     ?C0429?ZW_TRANSPORT
B1:00BAFC         ?C0428?ZW_TRANSPORT:
B1:00BAFC 7F00              MOV      R7,#00H
B1:00BAFE         ?C0429?ZW_TRANSPORT:
;---- Variable 'tRxStatus' assigned to Register 'R6/R7' ----
B1:00BAFE 11B0              ACALL    ?L?COM0075
B1:00BB00 2405              ADD      A,#05H
B1:00BB02 1285F5            LCALL    ?L?COM0004
B1:00BB05 FD                MOV      R5,A
B1:00BB06 30E504            JNB      ACC.5,?C0430?ZW_TRANSPORT
B1:00BB09 EF                MOV      A,R7
B1:00BB0A 4402              ORL      A,#02H
B1:00BB0C FF                MOV      R7,A
B1:00BB0D         ?C0430?ZW_TRANSPORT:
B1:00BB0D 900773            MOV      DPTR,#rxFrame+07H
B1:00BB10 E0                MOVX     A,@DPTR
B1:00BB11 30E704            JNB      ACC.7,?C0431?ZW_TRANSPORT
B1:00BB14 EF                MOV      A,R7
B1:00BB15 4480              ORL      A,#080H
B1:00BB17 FF                MOV      R7,A
B1:00BB18         ?C0431?ZW_TRANSPORT:
B1:00BB18 900768            MOV      DPTR,#myFrame
B1:00BB1B E0                MOVX     A,@DPTR
B1:00BB1C 30E504            JNB      ACC.5,?C0432?ZW_TRANSPORT
B1:00BB1F EF                MOV      A,R7
B1:00BB20 4420              ORL      A,#020H
B1:00BB22 FF                MOV      R7,A
B1:00BB23         ?C0432?ZW_TRANSPORT:
B1:00BB23 ED                MOV      A,R5
B1:00BB24 540F              ANL      A,#0FH
B1:00BB26 FD                MOV      R5,A
B1:00BB27 BD0510            CJNE     R5,#05H,?C0433?ZW_TRANSPORT
B1:00BB2A EF                MOV      A,R7
B1:00BB2B 4410              ORL      A,#010H
B1:00BB2D FF                MOV      R7,A
B1:00BB2E 11B0              ACALL    ?L?COM0075
B1:00BB30 2408              ADD      A,#08H
B1:00BB32 1285F5            LCALL    ?L?COM0004
B1:00BB35 F4                CPL      A
B1:00BB36 7030              JNZ      ?C0435?ZW_TRANSPORT
B1:00BB38 8017              SJMP     ?C0619?ZW_TRANSPORT
B1:00BB3A         ?C0433?ZW_TRANSPORT:
B1:00BB3A 11B0              ACALL    ?L?COM0075
B1:00BB3C 2405              ADD      A,#05H
B1:00BB3E 1285F5            LCALL    ?L?COM0004
B1:00BB41 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 319


B1:00BB43 FD                MOV      R5,A
B1:00BB44 BD0110            CJNE     R5,#01H,?C0436?ZW_TRANSPORT
B1:00BB47 11B0              ACALL    ?L?COM0075
B1:00BB49 2408              ADD      A,#08H
B1:00BB4B 1285F5            LCALL    ?L?COM0004
B1:00BB4E B4FF17            CJNE     A,#0FFH,?C0435?ZW_TRANSPORT
B1:00BB51         
B1:00BB51 EF                MOV      A,R7
B1:00BB52 4404              ORL      A,#04H
B1:00BB54 FF                MOV      R7,A
B1:00BB55 8011              SJMP     ?C0435?ZW_TRANSPORT
B1:00BB57         ?C0436?ZW_TRANSPORT:
B1:00BB57 11B0              ACALL    ?L?COM0075
B1:00BB59 2405              ADD      A,#05H
B1:00BB5B 1285F5            LCALL    ?L?COM0004
B1:00BB5E 540F              ANL      A,#0FH
B1:00BB60 FD                MOV      R5,A
B1:00BB61 BD0204            CJNE     R5,#02H,?C0435?ZW_TRANSPORT
B1:00BB64 EF                MOV      A,R7
B1:00BB65 4408              ORL      A,#08H
B1:00BB67 FF                MOV      R7,A
B1:00BB68         ?C0435?ZW_TRANSPORT:
B1:00BB68 22                RET      
----- FUNCTION UpdateRxStatus (END) -------


----- FUNCTION _HandleRoutedAck (BEGIN) -----
B1:00BB69 900AA2            MOV      DPTR,#pRxFrame
B1:00BB6C 122572            LCALL    ?C?PSTXDATA
B1:00BB6F 900AA5            MOV      DPTR,#bRoutedAckRSSI
B1:00BB72 ED                MOV      A,R5
B1:00BB73 12851A            LCALL    ?L?COM000B
B1:00BB76 2402              ADD      A,#02H
B1:00BB78 1285F5            LCALL    ?L?COM0004
B1:00BB7B 30E20A            JNB      ACC.2,?C0424?ZW_TRANSPORT
B1:00BB7E 90076A            MOV      DPTR,#activeTransmit+01H
B1:00BB81 E0                MOVX     A,@DPTR
B1:00BB82 F4                CPL      A
B1:00BB83 6003              JZ       ?C0424?ZW_TRANSPORT
B1:00BB85 1288C3            LCALL    ?L?COM051D
B1:00BB88         ?C0424?ZW_TRANSPORT:
B1:00BB88 1287CF            LCALL    TransmitTimerStop
B1:00BB8B 900AA2            MOV      DPTR,#pRxFrame
B1:00BB8E 51EA              ACALL    ?L?COM01C4
B1:00BB90 2409              ADD      A,#09H
B1:00BB92 1285F5            LCALL    ?L?COM0004
B1:00BB95 30E32C            JNB      ACC.3,?C0425?ZW_TRANSPORT
B1:00BB98 900AA2            MOV      DPTR,#pRxFrame
B1:00BB9B 51EA              ACALL    ?L?COM01C4
B1:00BB9D 240A              ADD      A,#0AH
B1:00BB9F 1285F5            LCALL    ?L?COM0004
B1:00BBA2 71F5              ACALL    ?L?COM01E2
B1:00BBA4 11B8              ACALL    ?L?COM002B
B1:00BBA6 121F7C            LCALL    ?C?CLDPTR
B1:00BBA9 540F              ANL      A,#0FH
B1:00BBAB FD                MOV      R5,A
B1:00BBAC BD0115            CJNE     R5,#01H,?C0425?ZW_TRANSPORT
B1:00BBAF 11B8              ACALL    ?L?COM002B
B1:00BBB1 1257E2            LCALL    ?L?COM0221
B1:00BBB4 1287B9            LCALL    ?L?COM003F
B1:00BBB7 7B01              MOV      R3,#01H
B1:00BBB9 7A07              MOV      R2,#HIGH abRoutedRssiFeedback+01H
B1:00BBBB 797D              MOV      R1,#LOW abRoutedRssiFeedback+01H
B1:00BBBD 7F04              MOV      R7,#04H
B1:00BBBF 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 320


B1:00BBC2 8007              SJMP     ?C0426?ZW_TRANSPORT
B1:00BBC4         ?C0425?ZW_TRANSPORT:
B1:00BBC4 7A07              MOV      R2,#HIGH abRoutedRssiFeedback+01H
B1:00BBC6 797D              MOV      R1,#LOW abRoutedRssiFeedback+01H
B1:00BBC8 12FAC3            LCALL    ?L?COM04CA
B1:00BBCB         ?C0426?ZW_TRANSPORT:
B1:00BBCB 900AA5            MOV      DPTR,#bRoutedAckRSSI
B1:00BBCE E0                MOVX     A,@DPTR
B1:00BBCF 90077C            MOV      DPTR,#abRoutedRssiFeedback
B1:00BBD2 F0                MOVX     @DPTR,A
B1:00BBD3 901222            MOV      DPTR,#rfRxCurrentCh
B1:00BBD6 E0                MOVX     A,@DPTR
B1:00BBD7 FF                MOV      R7,A
B1:00BBD8 12851B            LCALL    ?L?COM000C
B1:00BBDB 24E4              ADD      A,#0E4H
B1:00BBDD 1287AB            LCALL    ?L?COM0015
B1:00BBE0 7B01              MOV      R3,#01H
B1:00BBE2 7A07              MOV      R2,#HIGH abRoutedRssiFeedback
B1:00BBE4 797C              MOV      R1,#LOW abRoutedRssiFeedback
B1:00BBE6 7F01              MOV      R7,#01H
B1:00BBE8 0286C6            LJMP     _TxPermanentlyDone
----- FUNCTION _HandleRoutedAck (END) -------


----- FUNCTION ?L?COM02D8 (BEGIN) -----
B1:00BBEB 9009DF            MOV      DPTR,#pACKFrame
B1:00BBEE         ?L?COM02D9:
B1:00BBEE 122552            LCALL    ?C?PLDXDATA
B1:00BBF1 E9                MOV      A,R1
B1:00BBF2 24B7              ADD      A,#0B7H
B1:00BBF4 22                RET      
----- FUNCTION ?L?COM02D8 (END) -------


----- FUNCTION ?L?COM01E2 (BEGIN) -----
B1:00BBF5 C4                SWAP     A
B1:00BBF6 540F              ANL      A,#0FH
B1:00BBF8 FF                MOV      R7,A
B1:00BBF9 7E00              MOV      R6,#00H
B1:00BBFB 22                RET      
----- FUNCTION ?L?COM01E2 (END) -------


----- FUNCTION ?L?COM0120 (BEGIN) -----
B1:00BBFC FF                MOV      R7,A
B1:00BBFD         ?L?COM0121:
B1:00BBFD 122552            LCALL    ?C?PLDXDATA
B1:00BC00         ?L?COM0122:
B1:00BC00 E9                MOV      A,R1
B1:00BC01         ?L?COM0123:
B1:00BC01 2408              ADD      A,#08H
B1:00BC03 F9                MOV      R1,A
B1:00BC04 E4                CLR      A
B1:00BC05 3A                ADDC     A,R2
B1:00BC06 FA                MOV      R2,A
B1:00BC07 22                RET      
----- FUNCTION ?L?COM0120 (END) -------


----- FUNCTION _TransportEnQueueExploreFrame (BEGIN) -----
B1:00BC08 9009FC            MOV      DPTR,#pData
B1:00BC0B 122572            LCALL    ?C?PSTXDATA
;---- Variable 'destNodeID' assigned to Register 'R5' ----
;---- Variable 'srcNodeID' assigned to Register 'R7' ----
B1:00BC0E 900A03            MOV      DPTR,#frameType
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 321


B1:00BC11 7406              MOV      A,#06H
B1:00BC13 F0                MOVX     @DPTR,A
B1:00BC14 9009FF            MOV      DPTR,#dataLength
B1:00BC17 E0                MOVX     A,@DPTR
B1:00BC18 FE                MOV      R6,A
B1:00BC19 7411              MOV      A,#011H
B1:00BC1B D3                SETB     C
B1:00BC1C 9E                SUBB     A,R6
B1:00BC1D 4002              JC       $ + 4H
B1:00BC1F 81F9              AJMP     ?C0136?ZW_TRANSPORT
B1:00BC21 7440              MOV      A,#040H
B1:00BC23 9E                SUBB     A,R6
B1:00BC24 5002              JNC      $ + 4H
B1:00BC26 81F9              AJMP     ?C0136?ZW_TRANSPORT
B1:00BC28 7F02              MOV      R7,#02H
B1:00BC2A 12834D            LCALL    _TxQueueGetElement
B1:00BC2D 900A04            MOV      DPTR,#pFreeTxElement
B1:00BC30 12D134            LCALL    ?L?COM0287
B1:00BC33 7002              JNZ      $ + 4H
B1:00BC35 81F9              AJMP     ?C0136?ZW_TRANSPORT
B1:00BC37 900A03            MOV      DPTR,#frameType
B1:00BC3A E0                MOVX     A,@DPTR
B1:00BC3B 300809            JNB      currentSeqNoUseTX,?C0138?ZW_TRANSPORT
B1:00BC3E FE                MOV      R6,A
B1:00BC3F 12C746            LCALL    ?L?COM0427
B1:00BC42 EE                MOV      A,R6
B1:00BC43 4F                ORL      A,R7
B1:00BC44 F0                MOVX     @DPTR,A
B1:00BC45 8016              SJMP     ?C0139?ZW_TRANSPORT
B1:00BC47         ?C0138?ZW_TRANSPORT:
B1:00BC47 FF                MOV      R7,A
B1:00BC48 9009FC            MOV      DPTR,#pData
B1:00BC4B 12DBF8            LCALL    ?L?COM01F3
B1:00BC4E 1285F5            LCALL    ?L?COM0004
B1:00BC51 540F              ANL      A,#0FH
B1:00BC53 C4                SWAP     A
B1:00BC54 54F0              ANL      A,#0F0H
B1:00BC56 FE                MOV      R6,A
B1:00BC57 EF                MOV      A,R7
B1:00BC58 4E                ORL      A,R6
B1:00BC59 900A03            MOV      DPTR,#frameType
B1:00BC5C F0                MOVX     @DPTR,A
B1:00BC5D         ?C0139?ZW_TRANSPORT:
B1:00BC5D 900A00            MOV      DPTR,#exploreTxOptions
B1:00BC60 E0                MOVX     A,@DPTR
B1:00BC61 FF                MOV      R7,A
B1:00BC62 900A04            MOV      DPTR,#pFreeTxElement
B1:00BC65 129557            LCALL    ?L?COM003C
B1:00BC68 1287AB            LCALL    ?L?COM0015
B1:00BC6B 900A04            MOV      DPTR,#pFreeTxElement
B1:00BC6E 129549            LCALL    ?L?COM0058
B1:00BC71 F9                MOV      R1,A
B1:00BC72 E4                CLR      A
B1:00BC73 3A                ADDC     A,R2
B1:00BC74 FA                MOV      R2,A
B1:00BC75 E4                CLR      A
B1:00BC76 75F002            MOV      B,#02H
B1:00BC79 1221E8            LCALL    ?C?ISTPTR
B1:00BC7C 12F2D5            LCALL    ?L?COM0381
B1:00BC7F 1256E6            LCALL    ?L?COM018D
B1:00BC82 C003              PUSH     AR3
B1:00BC84 C002              PUSH     AR2
B1:00BC86 C001              PUSH     AR1
B1:00BC88 9009FC            MOV      DPTR,#pData
B1:00BC8B 1287B6            LCALL    ?L?COM003E
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 322


B1:00BC8E D001              POP      AR1
B1:00BC90 D002              POP      AR2
B1:00BC92 D003              POP      AR3
B1:00BC94 7F11              MOV      R7,#011H
B1:00BC96 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00BC99 9009FF            MOV      DPTR,#dataLength
B1:00BC9C E0                MOVX     A,@DPTR
B1:00BC9D 24EF              ADD      A,#0EFH
B1:00BC9F 12F2D4            LCALL    ?L?COM0380
B1:00BCA2 E9                MOV      A,R1
B1:00BCA3 24B1              ADD      A,#0B1H
B1:00BCA5 1287AB            LCALL    ?L?COM0015
B1:00BCA8 900A04            MOV      DPTR,#pFreeTxElement
B1:00BCAB 71FD              ACALL    ?L?COM0121
B1:00BCAD C003              PUSH     AR3
B1:00BCAF C002              PUSH     AR2
B1:00BCB1 C001              PUSH     AR1
B1:00BCB3 9009FC            MOV      DPTR,#pData
B1:00BCB6 12FB74            LCALL    ?L?COM02DA
B1:00BCB9 FA                MOV      R2,A
B1:00BCBA 1287B9            LCALL    ?L?COM003F
B1:00BCBD D001              POP      AR1
B1:00BCBF D002              POP      AR2
B1:00BCC1 D003              POP      AR3
B1:00BCC3 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00BCC6 900A04            MOV      DPTR,#pFreeTxElement
B1:00BCC9 12FC5A            LCALL    ?L?COM025C
B1:00BCCC 75F052            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00BCCF 1221E8            LCALL    ?C?ISTPTR
B1:00BCD2 900A01            MOV      DPTR,#completedFunc
B1:00BCD5 E0                MOVX     A,@DPTR
B1:00BCD6 FE                MOV      R6,A
B1:00BCD7 A3                INC      DPTR
B1:00BCD8 E0                MOVX     A,@DPTR
B1:00BCD9 12F2D4            LCALL    ?L?COM0380
B1:00BCDC E9                MOV      A,R1
B1:00BCDD 24DC              ADD      A,#0DCH
B1:00BCDF 12C94D            LCALL    ?L?COM00B8
B1:00BCE2 D208              SETB     currentSeqNoUseTX
B1:00BCE4 900A03            MOV      DPTR,#frameType
B1:00BCE7 E0                MOVX     A,@DPTR
B1:00BCE8 FF                MOV      R7,A
B1:00BCE9 A3                INC      DPTR
B1:00BCEA 122552            LCALL    ?C?PLDXDATA
B1:00BCED 12A00B            LCALL    _BuildTxHeader
B1:00BCF0 12F2D5            LCALL    ?L?COM0381
B1:00BCF3 12C91F            LCALL    _TxQueueQueueElement
B1:00BCF6 7F01              MOV      R7,#01H
B1:00BCF8 22                RET      
B1:00BCF9         ?C0136?ZW_TRANSPORT:
B1:00BCF9 D208              SETB     currentSeqNoUseTX
B1:00BCFB 7F00              MOV      R7,#00H
B1:00BCFD 22                RET      
----- FUNCTION _TransportEnQueueExploreFrame (END) -------


----- FUNCTION _CommandHandler (BEGIN) -----
B1:00BCFE 904197            MOV      DPTR,#pCmd
B1:00BD01 122572            LCALL    ?C?PSTXDATA
B1:00BD04 90419A            MOV      DPTR,#cmdLength
B1:00BD07 ED                MOV      A,R5
B1:00BD08 F0                MOVX     @DPTR,A
B1:00BD09 7401              MOV      A,#01H
B1:00BD0B C3                CLR      C
B1:00BD0C 9D                SUBB     A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 323


B1:00BD0D 4003              JC       $ + 5H
B1:00BD0F 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BD12         ?C0167?ZW_SLAVE:
B1:00BD12 90419B            MOV      DPTR,#rxopt
B1:00BD15 12C941            LCALL    ?L?COM0048
B1:00BD18 90419F            MOV      DPTR,#rxStatus
B1:00BD1B F0                MOVX     @DPTR,A
B1:00BD1C E9                MOV      A,R1
B1:00BD1D 2401              ADD      A,#01H
B1:00BD1F 1285F5            LCALL    ?L?COM0004
B1:00BD22 9041A1            MOV      DPTR,#sourceNode
B1:00BD25 F0                MOVX     @DPTR,A
B1:00BD26 90419B            MOV      DPTR,#rxopt
B1:00BD29 129557            LCALL    ?L?COM003C
B1:00BD2C 1285F5            LCALL    ?L?COM0004
B1:00BD2F 9041A0            MOV      DPTR,#destNode
B1:00BD32 F0                MOVX     @DPTR,A
B1:00BD33 90419B            MOV      DPTR,#rxopt
B1:00BD36 12F2C1            LCALL    ?L?COM0377
B1:00BD39         ?C0169?ZW_SLAVE:
B1:00BD39 1259A7            LCALL    RFIsTransmitting
B1:00BD3C 40FB              JC       ?C0169?ZW_SLAVE
B1:00BD3E         ?C0170?ZW_SLAVE:
B1:00BD3E 124724            LCALL    ZW_Poll
B1:00BD41 904197            MOV      DPTR,#pCmd
B1:00BD44 12C941            LCALL    ?L?COM0048
B1:00BD47 B49F18            CJNE     A,#09FH,?C0171?ZW_SLAVE
B1:00BD4A C003              PUSH     AR3
B1:00BD4C C002              PUSH     AR2
B1:00BD4E C001              PUSH     AR1
B1:00BD50 12F7EA            LCALL    ?L?COM04C7
B1:00BD53 904161            MOV      DPTR,#?_Security2CommandHandler?BYTE+04H
B1:00BD56 122572            LCALL    ?C?PSTXDATA
B1:00BD59 D001              POP      AR1
B1:00BD5B D002              POP      AR2
B1:00BD5D D003              POP      AR3
B1:00BD5F 021CBE            LJMP     ?INTERBANK_TABLE?_Security2CommandHandler
B1:00BD62         ?C0171?ZW_SLAVE:
B1:00BD62 904197            MOV      DPTR,#pCmd
B1:00BD65 12C941            LCALL    ?L?COM0048
B1:00BD68 B49818            CJNE     A,#098H,?C0172?ZW_SLAVE
B1:00BD6B C003              PUSH     AR3
B1:00BD6D C002              PUSH     AR2
B1:00BD6F C001              PUSH     AR1
B1:00BD71 12F7EA            LCALL    ?L?COM04C7
B1:00BD74 903B26            MOV      DPTR,#?_SecurityCommandHandler?BYTE+04H
B1:00BD77 122572            LCALL    ?C?PSTXDATA
B1:00BD7A D001              POP      AR1
B1:00BD7C D002              POP      AR2
B1:00BD7E D003              POP      AR3
B1:00BD80 02B05B            LJMP     _SecurityCommandHandler
B1:00BD83         ?C0172?ZW_SLAVE:
B1:00BD83 904197            MOV      DPTR,#pCmd
B1:00BD86 12C941            LCALL    ?L?COM0048
B1:00BD89 6455              XRL      A,#055H
B1:00BD8B 7052              JNZ      ?C0173?ZW_SLAVE
B1:00BD8D 7B01              MOV      R3,#01H
B1:00BD8F 7A33              MOV      R2,#HIGH sTsParam
B1:00BD91 7990              MOV      R1,#LOW sTsParam
B1:00BD93 7D07              MOV      R5,#07H
B1:00BD95 FF                MOV      R7,A
B1:00BD96 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00BD99 9041A1            MOV      DPTR,#sourceNode
B1:00BD9C E0                MOVX     A,@DPTR
B1:00BD9D 903390            MOV      DPTR,#sTsParam
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 324


B1:00BDA0 F0                MOVX     @DPTR,A
B1:00BDA1 901221            MOV      DPTR,#nodeID
B1:00BDA4 E0                MOVX     A,@DPTR
B1:00BDA5 903391            MOV      DPTR,#sTsParam+01H
B1:00BDA8 F0                MOVX     @DPTR,A
B1:00BDA9 90419F            MOV      DPTR,#rxStatus
B1:00BDAC E0                MOVX     A,@DPTR
B1:00BDAD 903395            MOV      DPTR,#sTsParam+05H
B1:00BDB0 F0                MOVX     @DPTR,A
B1:00BDB1 903394            MOV      DPTR,#sTsParam+04H
B1:00BDB4 7425              MOV      A,#025H
B1:00BDB6 F0                MOVX     @DPTR,A
B1:00BDB7 7B01              MOV      R3,#01H
B1:00BDB9 7A33              MOV      R2,#HIGH sTsParam
B1:00BDBB 7990              MOV      R1,#LOW sTsParam
B1:00BDBD 90331A            MOV      DPTR,#sTsCmdHandler
B1:00BDC0 122572            LCALL    ?C?PSTXDATA
B1:00BDC3 12C547            LCALL    ?L?COM0472
B1:00BDC6 90331D            MOV      DPTR,#sTsCmdHandler+03H
B1:00BDC9 122572            LCALL    ?C?PSTXDATA
B1:00BDCC 90419A            MOV      DPTR,#cmdLength
B1:00BDCF E0                MOVX     A,@DPTR
B1:00BDD0 FF                MOV      R7,A
B1:00BDD1 903320            MOV      DPTR,#sTsCmdHandler+06H
B1:00BDD4 E4                CLR      A
B1:00BDD5 12F937            LCALL    ?L?COM00D5
B1:00BDD8 7A33              MOV      R2,#HIGH sTsCmdHandler
B1:00BDDA 791A              MOV      R1,#LOW sTsCmdHandler
B1:00BDDC 021DC2            LJMP     ?INTERBANK_TABLE?_TransportService_ApplicationCommandHandler
B1:00BDDF         ?C0173?ZW_SLAVE:
B1:00BDDF 904197            MOV      DPTR,#pCmd
B1:00BDE2 12C941            LCALL    ?L?COM0048
B1:00BDE5 FF                MOV      R7,A
B1:00BDE6 C3                CLR      C
B1:00BDE7 9420              SUBB     A,#020H
B1:00BDE9 4028              JC       ?C0174?ZW_SLAVE
B1:00BDEB EF                MOV      A,R7
B1:00BDEC D3                SETB     C
B1:00BDED 94FF              SUBB     A,#0FFH
B1:00BDEF 5022              JNC      ?C0174?ZW_SLAVE
B1:00BDF1 90419A            MOV      DPTR,#cmdLength
B1:00BDF4 E0                MOVX     A,@DPTR
B1:00BDF5 FD                MOV      R5,A
B1:00BDF6 949F              SUBB     A,#09FH
B1:00BDF8 5019              JNC      ?C0174?ZW_SLAVE
B1:00BDFA C003              PUSH     AR3
B1:00BDFC C002              PUSH     AR2
B1:00BDFE C001              PUSH     AR1
B1:00BE00 A3                INC      DPTR
B1:00BE01 122552            LCALL    ?C?PLDXDATA
B1:00BE04 904470            MOV      DPTR,#?_ApplicationCommandHandler?BYTE+04H
B1:00BE07 122572            LCALL    ?C?PSTXDATA
B1:00BE0A D001              POP      AR1
B1:00BE0C D002              POP      AR2
B1:00BE0E D003              POP      AR3
B1:00BE10 021E80            LJMP     ?INTERBANK_TABLE?_ApplicationCommandHandler
B1:00BE13         ?C0174?ZW_SLAVE:
B1:00BE13 904197            MOV      DPTR,#pCmd
B1:00BE16 12C941            LCALL    ?L?COM0048
B1:00BE19 6401              XRL      A,#01H
B1:00BE1B 6003              JZ       $ + 5H
B1:00BE1D 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE20 E9                MOV      A,R1
B1:00BE21 2401              ADD      A,#01H
B1:00BE23 1285F5            LCALL    ?L?COM0004
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 325


B1:00BE26 12267F            LCALL    ?C?CCASE
B1:00BE29 C4E4              DW       ?C0268?ZW_SLAVE
B1:00BE2B 00                DB       00H
B1:00BE2C C3C7              DW       ?C0252?ZW_SLAVE
B1:00BE2E 01                DB       01H
B1:00BE2F BEB4              DW       ?C0187?ZW_SLAVE
B1:00BE31 02                DB       02H
B1:00BE32 BED1              DW       ?C0190?ZW_SLAVE
B1:00BE34 03                DB       03H
B1:00BE35 C1FB              DW       ?C0235?ZW_SLAVE
B1:00BE37 04                DB       04H
B1:00BE38 C304              DW       ?C0243?ZW_SLAVE
B1:00BE3A 05                DB       05H
B1:00BE3B BE5A              DW       ?C0178?ZW_SLAVE
B1:00BE3D 08                DB       08H
B1:00BE3E C1CB              DW       ?C0232?ZW_SLAVE
B1:00BE40 0B                DB       0BH
B1:00BE41 BF9E              DW       ?C0200?ZW_SLAVE
B1:00BE43 0C                DB       0CH
B1:00BE44 C142              DW       ?C0226?ZW_SLAVE
B1:00BE46 14                DB       014H
B1:00BE47 BF50              DW       ?C0196?ZW_SLAVE
B1:00BE49 16                DB       016H
B1:00BE4A C4E4              DW       ?C0268?ZW_SLAVE
B1:00BE4C 18                DB       018H
B1:00BE4D C4B9              DW       ?C0262?ZW_SLAVE
B1:00BE4F 22                DB       022H
B1:00BE50 C14C              DW       ?C0227?ZW_SLAVE
B1:00BE52 24                DB       024H
B1:00BE53 C18F              DW       ?C0230?ZW_SLAVE
B1:00BE55 25                DB       025H
B1:00BE56 0000              DW       00H
B1:00BE58 C4FF              DW       ?C0168?ZW_SLAVE
B1:00BE5A         ?C0178?ZW_SLAVE:
B1:00BE5A 300203            JNB      findInProgress,$ + 6H
B1:00BE5D 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE60 200103            JB       learnMode,$ + 6H
B1:00BE63 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE66 300303            JNB      learnModeDsk,$ + 6H
B1:00BE69 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE6C         ?C0179?ZW_SLAVE:
B1:00BE6C 90419A            MOV      DPTR,#cmdLength
B1:00BE6F E0                MOVX     A,@DPTR
B1:00BE70 C3                CLR      C
B1:00BE71 9403              SUBB     A,#03H
B1:00BE73 5003              JNC      $ + 5H
B1:00BE75 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE78 129554            LCALL    ?L?COM003B
B1:00BE7B 1285F5            LCALL    ?L?COM0004
B1:00BE7E FF                MOV      R7,A
B1:00BE7F 20E003            JB       ACC.0,$ + 6H
B1:00BE82 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE85 E550              MOV      A,bNetworkWideInclusion
B1:00BE87 B40107            CJNE     A,#01H,?C0184?ZW_SLAVE
B1:00BE8A EF                MOV      A,R7
B1:00BE8B 30E103            JNB      ACC.1,$ + 6H
B1:00BE8E 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE91         ?C0184?ZW_SLAVE:
B1:00BE91 E550              MOV      A,bNetworkWideInclusion
B1:00BE93 B40207            CJNE     A,#02H,?C0182?ZW_SLAVE
B1:00BE96 EF                MOV      A,R7
B1:00BE97 30E203            JNB      ACC.2,$ + 6H
B1:00BE9A 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BE9D         ?C0182?ZW_SLAVE:
B1:00BE9D D205              SETB     forceUse40K
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 326


B1:00BE9F 9041A1            MOV      DPTR,#sourceNode
B1:00BEA2 E0                MOVX     A,@DPTR
B1:00BEA3 FF                MOV      R7,A
B1:00BEA4 90419F            MOV      DPTR,#rxStatus
B1:00BEA7 E0                MOVX     A,@DPTR
B1:00BEA8 7D10              MOV      R5,#010H
B1:00BEAA 30E102            JNB      ACC.1,?C0185?ZW_SLAVE
B1:00BEAD 7D12              MOV      R5,#012H
B1:00BEAF         ?C0185?ZW_SLAVE:
B1:00BEAF         ?C0186?ZW_SLAVE:
B1:00BEAF E4                CLR      A
B1:00BEB0 FB                MOV      R3,A
B1:00BEB1 FA                MOV      R2,A
B1:00BEB2 801A              SJMP     ?C0318?ZW_SLAVE
B1:00BEB4         ?C0187?ZW_SLAVE:
B1:00BEB4 90419F            MOV      DPTR,#rxStatus
B1:00BEB7 E0                MOVX     A,@DPTR
B1:00BEB8 9041A1            MOV      DPTR,#sourceNode
B1:00BEBB 30E109            JNB      ACC.1,?C0188?ZW_SLAVE
B1:00BEBE E0                MOVX     A,@DPTR
B1:00BEBF FF                MOV      R7,A
B1:00BEC0 E4                CLR      A
B1:00BEC1 FB                MOV      R3,A
B1:00BEC2 FA                MOV      R2,A
B1:00BEC3 7D07              MOV      R5,#07H
B1:00BEC5         
B1:00BEC5 8007              SJMP     ?C0318?ZW_SLAVE
B1:00BEC7         ?C0188?ZW_SLAVE:
B1:00BEC7 E0                MOVX     A,@DPTR
B1:00BEC8 FF                MOV      R7,A
B1:00BEC9 E4                CLR      A
B1:00BECA FB                MOV      R3,A
B1:00BECB FA                MOV      R2,A
B1:00BECC 7D05              MOV      R5,#05H
B1:00BECE         
B1:00BECE 02D1AF            LJMP     _ZW_SendNodeInformation
B1:00BED1         ?C0190?ZW_SLAVE:
B1:00BED1 300203            JNB      findInProgress,$ + 6H
B1:00BED4 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BED7 200103            JB       learnMode,$ + 6H
B1:00BEDA 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BEDD 90419A            MOV      DPTR,#cmdLength
B1:00BEE0 E0                MOVX     A,@DPTR
B1:00BEE1 C3                CLR      C
B1:00BEE2 9407              SUBB     A,#07H
B1:00BEE4 4003              JC       ?C0193?ZW_SLAVE
B1:00BEE6 D3                SETB     C
B1:00BEE7 8001              SJMP     ?C0194?ZW_SLAVE
B1:00BEE9         ?C0193?ZW_SLAVE:
B1:00BEE9 C3                CLR      C
B1:00BEEA         ?C0194?ZW_SLAVE:
B1:00BEEA 4003              JC       $ + 5H
B1:00BEEC 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BEEF         ?C0192?ZW_SLAVE:
B1:00BEEF 903315            MOV      DPTR,#assignState
B1:00BEF2 7401              MOV      A,#01H
B1:00BEF4 129553            LCALL    ?L?COM003A
B1:00BEF7 1285F5            LCALL    ?L?COM0004
B1:00BEFA 901221            MOV      DPTR,#nodeID
B1:00BEFD F0                MOVX     @DPTR,A
B1:00BEFE 904197            MOV      DPTR,#pCmd
B1:00BF01 125D4E            LCALL    ?L?COM00AF
B1:00BF04 1287B9            LCALL    ?L?COM003F
B1:00BF07 124FD6            LCALL    ?L?COM02D2
B1:00BF0A 7F04              MOV      R7,#04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 327


B1:00BF0C 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00BF0F 124FD6            LCALL    ?L?COM02D2
B1:00BF12 901221            MOV      DPTR,#nodeID
B1:00BF15 E0                MOVX     A,@DPTR
B1:00BF16 FD                MOV      R5,A
B1:00BF17 121B88            LCALL    ?INTERBANK_TABLE?_MemoryPutID
B1:00BF1A 901221            MOV      DPTR,#nodeID
B1:00BF1D E0                MOVX     A,@DPTR
B1:00BF1E 7025              JNZ      ?C0195?ZW_SLAVE
B1:00BF20 12EFE3            LCALL    ResetRoutedResponseRoutes
B1:00BF23 12E9FB            LCALL    FlushResponseSpeeds
B1:00BF26 12F42D            LCALL    RemoveAllReturnRouteDestination
B1:00BF29 7E00              MOV      R6,#HIGH NVM_RETURN_ROUTE_START_far
B1:00BF2B 7F0B              MOV      R7,#LOW NVM_RETURN_ROUTE_START_far
B1:00BF2D 12A79C            LCALL    ?L?COM00A4
B1:00BF30 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00BF33 7411              MOV      A,#011H
B1:00BF35 F0                MOVX     @DPTR,A
B1:00BF36 A3                INC      DPTR
B1:00BF37 744B              MOV      A,#04BH
B1:00BF39 F0                MOVX     @DPTR,A
B1:00BF3A 1239FB            LCALL    _NVM_ext_write_buffer
B1:00BF3D E4                CLR      A
B1:00BF3E 9033A5            MOV      DPTR,#sucNodeID
B1:00BF41 F0                MOVX     @DPTR,A
B1:00BF42 12EB26            LCALL    security_reset
B1:00BF45         ?C0195?ZW_SLAVE:
B1:00BF45 12A79C            LCALL    ?L?COM00A4
B1:00BF48 E4                CLR      A
B1:00BF49 FF                MOV      R7,A
B1:00BF4A 12EDBA            LCALL    _ZCB_AssignComplete
B1:00BF4D 02F080            LJMP     ?L?COM044B
B1:00BF50         ?C0196?ZW_SLAVE:
B1:00BF50 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00BF53 E0                MOVX     A,@DPTR
B1:00BF54 20E003            JB       ACC.0,$ + 6H
B1:00BF57 02C4FF            LJMP     ?C0168?ZW_SLAVE
B1:00BF5A 9033A5            MOV      DPTR,#sucNodeID
B1:00BF5D E0                MOVX     A,@DPTR
B1:00BF5E FF                MOV      R7,A
B1:00BF5F 90339C            MOV      DPTR,#temp
B1:00BF62 7004              JNZ      ?C0198?ZW_SLAVE
B1:00BF64 04                INC      A
B1:00BF65 F0                MOVX     @DPTR,A
B1:00BF66 8002              SJMP     ?C0199?ZW_SLAVE
B1:00BF68         ?C0198?ZW_SLAVE:
B1:00BF68 EF                MOV      A,R7
B1:00BF69 F0                MOVX     @DPTR,A
B1:00BF6A         ?C0199?ZW_SLAVE:
B1:00BF6A 129554            LCALL    ?L?COM003B
B1:00BF6D 1285F5            LCALL    ?L?COM0004
B1:00BF70 90339D            MOV      DPTR,#helpNodeID
B1:00BF73 12D376            LCALL    ?L?COM0318
B1:00BF76 7416              MOV      A,#016H
B1:00BF78 F0                MOVX     @DPTR,A
B1:00BF79 90339D            MOV      DPTR,#helpNodeID
B1:00BF7C E0                MOVX     A,@DPTR
B1:00BF7D 9033AE            MOV      DPTR,#slaveFrameBuffer+02H
B1:00BF80 F0                MOVX     @DPTR,A
B1:00BF81 12D219            LCALL    ?L?COM0060
B1:00BF84 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00BF87 7403              MOV      A,#03H
B1:00BF89 12D3AA            LCALL    ?L?COM022C
B1:00BF8C A3                INC      DPTR
B1:00BF8D 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_CtrlAskedForHelpCallback
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 328


B1:00BF8F F0                MOVX     @DPTR,A
B1:00BF90 A3                INC      DPTR
B1:00BF91 74CB              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_CtrlAskedForHelpCallback
B1:00BF93 F0                MOVX     @DPTR,A
B1:00BF94 90339C            MOV      DPTR,#temp
B1:00BF97 E0                MOVX     A,@DPTR
B1:00BF98 FB                MOV      R3,A
B1:00BF99 7F01              MOV      R7,#01H
B1:00BF9B 02D13B            LJMP     _EnQueueSingleData
B1:00BF9E         ?C0200?ZW_SLAVE:
B1:00BF9E 9033A5            MOV      DPTR,#sucNodeID
B1:00BFA1 E0                MOVX     A,@DPTR
B1:00BFA2 FF                MOV      R7,A
B1:00BFA3 600E              JZ       ?C0201?ZW_SLAVE
B1:00BFA5 129554            LCALL    ?L?COM003B
B1:00BFA8 1285F5            LCALL    ?L?COM0004
B1:00BFAB FE                MOV      R6,A
B1:00BFAC EF                MOV      A,R7
B1:00BFAD B50603            CJNE     A,AR6,?C0201?ZW_SLAVE
B1:00BFB0 02C142            LJMP     ?C0319?ZW_SLAVE
B1:00BFB3         ?C0201?ZW_SLAVE:
B1:00BFB3 C2D5              CLR      F0
B1:00BFB5 90339C            MOV      DPTR,#temp
B1:00BFB8 74FF              MOV      A,#0FFH
B1:00BFBA F0                MOVX     @DPTR,A
B1:00BFBB 1285EC            LCALL    ?L?COM0001
B1:00BFBE FF                MOV      R7,A
B1:00BFBF C4                SWAP     A
B1:00BFC0 5407              ANL      A,#07H
B1:00BFC2 9041A2            MOV      DPTR,#n
B1:00BFC5 F0                MOVX     @DPTR,A
B1:00BFC6 700C              JNZ      ?C0202?ZW_SLAVE
B1:00BFC8 129554            LCALL    ?L?COM003B
B1:00BFCB 1285F5            LCALL    ?L?COM0004
B1:00BFCE 9033A4            MOV      DPTR,#curNodeID
B1:00BFD1 F0                MOVX     @DPTR,A
B1:00BFD2 D2D5              SETB     F0
B1:00BFD4         ?C0202?ZW_SLAVE:
B1:00BFD4 9033A4            MOV      DPTR,#curNodeID
B1:00BFD7 E0                MOVX     A,@DPTR
B1:00BFD8 7003              JNZ      $ + 5H
B1:00BFDA 02C0DC            LJMP     ?C0203?ZW_SLAVE
B1:00BFDD E4                CLR      A
B1:00BFDE 903329            MOV      DPTR,#tempi
B1:00BFE1 F0                MOVX     @DPTR,A
B1:00BFE2         ?C0204?ZW_SLAVE:
B1:00BFE2 12FCA2            LCALL    ?L?COM0516
B1:00BFE5 5025              JNC      ?C0205?ZW_SLAVE
B1:00BFE7 12C508            LCALL    ?L?COM023D
B1:00BFEA E0                MOVX     A,@DPTR
B1:00BFEB FF                MOV      R7,A
B1:00BFEC 9033A4            MOV      DPTR,#curNodeID
B1:00BFEF E0                MOVX     A,@DPTR
B1:00BFF0 FE                MOV      R6,A
B1:00BFF1 EF                MOV      A,R7
B1:00BFF2 6E                XRL      A,R6
B1:00BFF3 6017              JZ       ?C0205?ZW_SLAVE
B1:00BFF5 EF                MOV      A,R7
B1:00BFF6 700F              JNZ      ?C0206?ZW_SLAVE
B1:00BFF8 90339C            MOV      DPTR,#temp
B1:00BFFB E0                MOVX     A,@DPTR
B1:00BFFC B4FF08            CJNE     A,#0FFH,?C0206?ZW_SLAVE
B1:00BFFF 903329            MOV      DPTR,#tempi
B1:00C002 E0                MOVX     A,@DPTR
B1:00C003 90339C            MOV      DPTR,#temp
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 329


B1:00C006 F0                MOVX     @DPTR,A
B1:00C007         ?C0206?ZW_SLAVE:
B1:00C007 128FBB            LCALL    ?L?COM0379
B1:00C00A 80D6              SJMP     ?C0204?ZW_SLAVE
B1:00C00C         ?C0205?ZW_SLAVE:
B1:00C00C 903329            MOV      DPTR,#tempi
B1:00C00F E0                MOVX     A,@DPTR
B1:00C010 C3                CLR      C
B1:00C011 9405              SUBB     A,#05H
B1:00C013 401C              JC       ?C0207?ZW_SLAVE
B1:00C015 90339C            MOV      DPTR,#temp
B1:00C018 E0                MOVX     A,@DPTR
B1:00C019 FF                MOV      R7,A
B1:00C01A 94FF              SUBB     A,#0FFH
B1:00C01C 5013              JNC      ?C0207?ZW_SLAVE
B1:00C01E 9033A4            MOV      DPTR,#curNodeID
B1:00C021 E0                MOVX     A,@DPTR
B1:00C022 FD                MOV      R5,A
B1:00C023 B108              ACALL    ?L?COM023D
B1:00C025 ED                MOV      A,R5
B1:00C026 F0                MOVX     @DPTR,A
B1:00C027 7E00              MOV      R6,#00H
B1:00C029 B185              ACALL    ?L?COM0583
B1:00C02B FE                MOV      R6,A
B1:00C02C AF01              MOV      R7,AR1
B1:00C02E 12444A            LCALL    _NVM_ext_write_byte
B1:00C031         ?C0207?ZW_SLAVE:
B1:00C031 9033A4            MOV      DPTR,#curNodeID
B1:00C034 E0                MOVX     A,@DPTR
B1:00C035 FB                MOV      R3,A
B1:00C036 24FF              ADD      A,#0FFH
B1:00C038 FE                MOV      R6,A
B1:00C039 E4                CLR      A
B1:00C03A 34FF              ADDC     A,#0FFH
B1:00C03C 903327            MOV      DPTR,#tempwi
B1:00C03F F0                MOVX     @DPTR,A
B1:00C040 A3                INC      DPTR
B1:00C041 CE                XCH      A,R6
B1:00C042 F0                MOVX     @DPTR,A
B1:00C043 B17D              ACALL    ?L?COM0582
B1:00C045 4002              JC       $ + 4H
B1:00C047 2134              AJMP     ?C0216?ZW_SLAVE
B1:00C049 30D505            JNB      F0,?C0209?ZW_SLAVE
B1:00C04C AF03              MOV      R7,AR3
B1:00C04E 1288AE            LCALL    _ReturnRouteClearPriority
B1:00C051         ?C0209?ZW_SLAVE:
B1:00C051 30D50B            JNB      F0,?C0210?ZW_SLAVE
B1:00C054 128F9B            LCALL    ?L?COM00EA
B1:00C057 B100              ACALL    ?L?COM0409
B1:00C059 9033A4            MOV      DPTR,#curNodeID
B1:00C05C 128FD1            LCALL    ?L?COM04E6
B1:00C05F         ?C0210?ZW_SLAVE:
B1:00C05F 1285EC            LCALL    ?L?COM0001
B1:00C062 5407              ANL      A,#07H
B1:00C064 90339C            MOV      DPTR,#temp
B1:00C067 F0                MOVX     @DPTR,A
B1:00C068 E4                CLR      A
B1:00C069 9041A3            MOV      DPTR,#repeaterIndex
B1:00C06C F0                MOVX     @DPTR,A
B1:00C06D 30D510            JNB      F0,?C0212?ZW_SLAVE
B1:00C070 90339C            MOV      DPTR,#temp
B1:00C073 E0                MOVX     A,@DPTR
B1:00C074 700A              JNZ      ?C0212?ZW_SLAVE
B1:00C076 128C13            LCALL    ?L?COM007B
B1:00C079 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 330


B1:00C07A AF01              MOV      R7,AR1
B1:00C07C 7DFE              MOV      R5,#0FEH
B1:00C07E 802A              SJMP     ?C0320?ZW_SLAVE
B1:00C080         ?C0212?ZW_SLAVE:
B1:00C080 90339C            MOV      DPTR,#temp
B1:00C083 E0                MOVX     A,@DPTR
B1:00C084 FF                MOV      R7,A
B1:00C085 9041A3            MOV      DPTR,#repeaterIndex
B1:00C088 E0                MOVX     A,@DPTR
B1:00C089 C3                CLR      C
B1:00C08A 9F                SUBB     A,R7
B1:00C08B 5028              JNC      ?C0213?ZW_SLAVE
B1:00C08D 128C13            LCALL    ?L?COM007B
B1:00C090 FA                MOV      R2,A
B1:00C091 A3                INC      DPTR
B1:00C092 E0                MOVX     A,@DPTR
B1:00C093 FD                MOV      R5,A
B1:00C094 29                ADD      A,R1
B1:00C095 F9                MOV      R1,A
B1:00C096 EC                MOV      A,R4
B1:00C097 3A                ADDC     A,R2
B1:00C098 FE                MOV      R6,A
B1:00C099 AF01              MOV      R7,AR1
B1:00C09B 904197            MOV      DPTR,#pCmd
B1:00C09E 129549            LCALL    ?L?COM0058
B1:00C0A1 12D9BC            LCALL    ?L?COM0089
B1:00C0A4 3A                ADDC     A,R2
B1:00C0A5 FA                MOV      R2,A
B1:00C0A6 121F7C            LCALL    ?C?CLDPTR
B1:00C0A9 FD                MOV      R5,A
B1:00C0AA         
B1:00C0AA 12444A            LCALL    _NVM_ext_write_byte
B1:00C0AD 9041A3            MOV      DPTR,#repeaterIndex
B1:00C0B0 E0                MOVX     A,@DPTR
B1:00C0B1 04                INC      A
B1:00C0B2 F0                MOVX     @DPTR,A
B1:00C0B3 80CB              SJMP     ?C0212?ZW_SLAVE
B1:00C0B5         ?C0213?ZW_SLAVE:
B1:00C0B5 9041A3            MOV      DPTR,#repeaterIndex
B1:00C0B8 E0                MOVX     A,@DPTR
B1:00C0B9 C3                CLR      C
B1:00C0BA 9404              SUBB     A,#04H
B1:00C0BC 500C              JNC      ?C0215?ZW_SLAVE
B1:00C0BE 128C13            LCALL    ?L?COM007B
B1:00C0C1 FA                MOV      R2,A
B1:00C0C2 A3                INC      DPTR
B1:00C0C3 E0                MOVX     A,@DPTR
B1:00C0C4 128EB2            LCALL    ?L?COM0130
B1:00C0C7 128FC9            LCALL    ?L?COM02A1
B1:00C0CA         ?C0215?ZW_SLAVE:
B1:00C0CA B147              ACALL    ?L?COM0472
B1:00C0CC 9033A4            MOV      DPTR,#curNodeID
B1:00C0CF E0                MOVX     A,@DPTR
B1:00C0D0 FD                MOV      R5,A
B1:00C0D1 90419A            MOV      DPTR,#cmdLength
B1:00C0D4 E0                MOVX     A,@DPTR
B1:00C0D5 904400            MOV      DPTR,#?_StoreReturnRouteSpeed?BYTE+04H
B1:00C0D8 F0                MOVX     @DPTR,A
B1:00C0D9 02E8F6            LJMP     _StoreReturnRouteSpeed
B1:00C0DC         ?C0203?ZW_SLAVE:
B1:00C0DC 30D555            JNB      F0,?C0216?ZW_SLAVE
B1:00C0DF E4                CLR      A
B1:00C0E0 903327            MOV      DPTR,#tempwi
B1:00C0E3 F0                MOVX     @DPTR,A
B1:00C0E4 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 331


B1:00C0E5 F0                MOVX     @DPTR,A
B1:00C0E6         ?C0218?ZW_SLAVE:
B1:00C0E6 903327            MOV      DPTR,#tempwi
B1:00C0E9 E0                MOVX     A,@DPTR
B1:00C0EA FE                MOV      R6,A
B1:00C0EB A3                INC      DPTR
B1:00C0EC E0                MOVX     A,@DPTR
B1:00C0ED FF                MOV      R7,A
B1:00C0EE C3                CLR      C
B1:00C0EF 94E8              SUBB     A,#0E8H
B1:00C0F1 EE                MOV      A,R6
B1:00C0F2 9400              SUBB     A,#00H
B1:00C0F4 503B              JNC      ?C0219?ZW_SLAVE
B1:00C0F6 128FA3            LCALL    ?L?COM00EB
B1:00C0F9 B100              ACALL    ?L?COM0409
B1:00C0FB 128D09            LCALL    ?L?COM0195
B1:00C0FE EF                MOV      A,R7
B1:00C0FF 6024              JZ       ?C0220?ZW_SLAVE
B1:00C101 128F9B            LCALL    ?L?COM00EA
B1:00C104 B100              ACALL    ?L?COM0409
B1:00C106 128FC9            LCALL    ?L?COM02A1
B1:00C109 E4                CLR      A
B1:00C10A 903329            MOV      DPTR,#tempi
B1:00C10D F0                MOVX     @DPTR,A
B1:00C10E         ?C0222?ZW_SLAVE:
B1:00C10E 128F9B            LCALL    ?L?COM00EA
B1:00C111 128E8A            LCALL    ?L?COM040D
B1:00C114 FA                MOV      R2,A
B1:00C115 A3                INC      DPTR
B1:00C116 128C2D            LCALL    ?L?COM007C
B1:00C119 128FC9            LCALL    ?L?COM02A1
B1:00C11C 128FBB            LCALL    ?L?COM0379
B1:00C11F E0                MOVX     A,@DPTR
B1:00C120 C3                CLR      C
B1:00C121 9404              SUBB     A,#04H
B1:00C123 40E9              JC       ?C0222?ZW_SLAVE
B1:00C125         ?C0220?ZW_SLAVE:
B1:00C125 903327            MOV      DPTR,#tempwi
B1:00C128 E4                CLR      A
B1:00C129 75F001            MOV      B,#01H
B1:00C12C 12210C            LCALL    ?C?IILDX
B1:00C12F 80B5              SJMP     ?C0218?ZW_SLAVE
B1:00C131         ?C0219?ZW_SLAVE:
B1:00C131 12F42D            LCALL    RemoveAllReturnRouteDestination
B1:00C134         ?C0216?ZW_SLAVE:
B1:00C134 B166              ACALL    ?L?COM03ED
B1:00C136 7002              JNZ      $ + 4H
B1:00C138 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C13A 12F3E3            LCALL    ?L?COM0317
B1:00C13D 04                INC      A
B1:00C13E F0                MOVX     @DPTR,A
B1:00C13F 02F387            LJMP     _NetWorkTimerStart
B1:00C142         ?C0226?ZW_SLAVE:
B1:00C142         
B1:00C142 B147              ACALL    ?L?COM0472
B1:00C144 90419A            MOV      DPTR,#cmdLength
B1:00C147 E0                MOVX     A,@DPTR
B1:00C148 FD                MOV      R5,A
B1:00C149 028EB9            LJMP     _HandleSUCReturnRoute
B1:00C14C         ?C0227?ZW_SLAVE:
B1:00C14C 1285EC            LCALL    ?L?COM0001
B1:00C14F 129550            LCALL    ?L?COM0039
B1:00C152 1285F5            LCALL    ?L?COM0004
B1:00C155 9033A4            MOV      DPTR,#curNodeID
B1:00C158 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 332


B1:00C159 7002              JNZ      $ + 4H
B1:00C15B 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C15D E0                MOVX     A,@DPTR
B1:00C15E FF                MOV      R7,A
B1:00C15F 12F0E5            LCALL    _RemoveResponseRoute
B1:00C162 9033A4            MOV      DPTR,#curNodeID
B1:00C165 E0                MOVX     A,@DPTR
B1:00C166 128CFE            LCALL    ?L?COM0194
B1:00C169 9033A4            MOV      DPTR,#curNodeID
B1:00C16C E0                MOVX     A,@DPTR
B1:00C16D FE                MOV      R6,A
B1:00C16E 6F                XRL      A,R7
B1:00C16F 6002              JZ       $ + 4H
B1:00C171 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C173 EE                MOV      A,R6
B1:00C174 1239E2            LCALL    ?L?COM007E
B1:00C177 90339C            MOV      DPTR,#temp
B1:00C17A 12FC89            LCALL    ?L?COM0316
B1:00C17D 4E                ORL      A,R6
B1:00C17E 90339C            MOV      DPTR,#temp
B1:00C181 F0                MOVX     @DPTR,A
B1:00C182 9033A4            MOV      DPTR,#curNodeID
B1:00C185 12E9DA            LCALL    ?L?COM0307
B1:00C188 90339C            MOV      DPTR,#temp
B1:00C18B E0                MOVX     A,@DPTR
B1:00C18C FD                MOV      R5,A
B1:00C18D 8039              SJMP     ?C0321?ZW_SLAVE
B1:00C18F         ?C0230?ZW_SLAVE:
B1:00C18F 1285EC            LCALL    ?L?COM0001
B1:00C192 129550            LCALL    ?L?COM0039
B1:00C195 1285F5            LCALL    ?L?COM0004
B1:00C198 9033A4            MOV      DPTR,#curNodeID
B1:00C19B 128F77            LCALL    ?L?COM03EE
B1:00C19E AE07              MOV      R6,AR7
B1:00C1A0 9033A4            MOV      DPTR,#curNodeID
B1:00C1A3 E0                MOVX     A,@DPTR
B1:00C1A4 FF                MOV      R7,A
B1:00C1A5 6E                XRL      A,R6
B1:00C1A6 6002              JZ       $ + 4H
B1:00C1A8 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C1AA B17D              ACALL    ?L?COM0582
B1:00C1AC 4002              JC       $ + 4H
B1:00C1AE 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C1B0 12F0E5            LCALL    _RemoveResponseRoute
B1:00C1B3 12FC7E            LCALL    ?L?COM044C
B1:00C1B6 1239F2            LCALL    _NVM_ext_read_byte
B1:00C1B9 9033A4            MOV      DPTR,#curNodeID
B1:00C1BC 12FC89            LCALL    ?L?COM0316
B1:00C1BF 4E                ORL      A,R6
B1:00C1C0 9033A4            MOV      DPTR,#curNodeID
B1:00C1C3 F0                MOVX     @DPTR,A
B1:00C1C4 FD                MOV      R5,A
B1:00C1C5 12FC7E            LCALL    ?L?COM044C
B1:00C1C8         
B1:00C1C8 02444A            LJMP     _NVM_ext_write_byte
B1:00C1CB         ?C0232?ZW_SLAVE:
B1:00C1CB B166              ACALL    ?L?COM03ED
B1:00C1CD 7002              JNZ      $ + 4H
B1:00C1CF 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C1D1 12EF46            LCALL    ResetSUC
B1:00C1D4 E4                CLR      A
B1:00C1D5 903315            MOV      DPTR,#assignState
B1:00C1D8 F0                MOVX     @DPTR,A
B1:00C1D9 12EF0D            LCALL    AssignTimerStop
B1:00C1DC B113              ACALL    ReloadRouteDestinations
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 333


B1:00C1DE 90332A            MOV      DPTR,#_routeUpdateDone
B1:00C1E1 E0                MOVX     A,@DPTR
B1:00C1E2 FC                MOV      R4,A
B1:00C1E3 A3                INC      DPTR
B1:00C1E4 E0                MOVX     A,@DPTR
B1:00C1E5 FD                MOV      R5,A
B1:00C1E6 4C                ORL      A,R4
B1:00C1E7 7002              JNZ      $ + 4H
B1:00C1E9 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C1EB 129554            LCALL    ?L?COM003B
B1:00C1EE 1285F5            LCALL    ?L?COM0004
B1:00C1F1 24FE              ADD      A,#0FEH
B1:00C1F3 FF                MOV      R7,A
B1:00C1F4 8D82              MOV      DPL,R5
B1:00C1F6 8C83              MOV      DPH,R4
B1:00C1F8 0226E3            LJMP     ?C?ICALL2
B1:00C1FB         ?C0235?ZW_SLAVE:
B1:00C1FB 300202            JNB      findInProgress,$ + 5H
B1:00C1FE 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C200 90419A            MOV      DPTR,#cmdLength
B1:00C203 E0                MOVX     A,@DPTR
B1:00C204 FF                MOV      R7,A
B1:00C205 D3                SETB     C
B1:00C206 9422              SUBB     A,#022H
B1:00C208 4002              JC       $ + 4H
B1:00C20A 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C20C EF                MOV      A,R7
B1:00C20D 9403              SUBB     A,#03H
B1:00C20F 5002              JNC      $ + 4H
B1:00C211 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C213 129554            LCALL    ?L?COM003B
B1:00C216 1285F5            LCALL    ?L?COM0004
B1:00C219 D3                SETB     C
B1:00C21A 941D              SUBB     A,#01DH
B1:00C21C 4002              JC       $ + 4H
B1:00C21E 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C220 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00C223 E0                MOVX     A,@DPTR
B1:00C224 90339B            MOV      DPTR,#oldSpeed
B1:00C227 F0                MOVX     @DPTR,A
B1:00C228 903315            MOV      DPTR,#assignState
B1:00C22B 7402              MOV      A,#02H
B1:00C22D F0                MOVX     @DPTR,A
B1:00C22E 12A79C            LCALL    ?L?COM00A4
B1:00C231 E4                CLR      A
B1:00C232 FF                MOV      R7,A
B1:00C233 12EDBA            LCALL    _ZCB_AssignComplete
B1:00C236 D202              SETB     findInProgress
B1:00C238 903397            MOV      DPTR,#SUC_Update
B1:00C23B E0                MOVX     A,@DPTR
B1:00C23C B40403            CJNE     A,#04H,?C0237?ZW_SLAVE
B1:00C23F 12F366            LCALL    ?L?COM04C6
B1:00C242         ?C0237?ZW_SLAVE:
B1:00C242 12F080            LCALL    ?L?COM044B
B1:00C245 12D787            LCALL    ?L?COM04C5
B1:00C248 129553            LCALL    ?L?COM003A
B1:00C24B 1285F5            LCALL    ?L?COM0004
B1:00C24E FF                MOV      R7,A
B1:00C24F 541F              ANL      A,#01FH
B1:00C251 2403              ADD      A,#03H
B1:00C253 FD                MOV      R5,A
B1:00C254 E4                CLR      A
B1:00C255 33                RLC      A
B1:00C256 FC                MOV      R4,A
B1:00C257 90419A            MOV      DPTR,#cmdLength
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 334


B1:00C25A E0                MOVX     A,@DPTR
B1:00C25B D3                SETB     C
B1:00C25C 9D                SUBB     A,R5
B1:00C25D EC                MOV      A,R4
B1:00C25E 125341            LCALL    ?L?COM011F
B1:00C261 4012              JC       ?C0238?ZW_SLAVE
B1:00C263 7E00              MOV      R6,#00H
B1:00C265 904197            MOV      DPTR,#pCmd
B1:00C268 12F1E5            LCALL    ?L?COM014F
B1:00C26B 12B8C4            LCALL    ?L?COM002D
B1:00C26E 121F7C            LCALL    ?C?CLDPTR
B1:00C271 90336C            MOV      DPTR,#zensorWakeupTime
B1:00C274 F0                MOVX     @DPTR,A
B1:00C275         ?C0238?ZW_SLAVE:
B1:00C275 90336C            MOV      DPTR,#zensorWakeupTime
B1:00C278 E0                MOVX     A,@DPTR
B1:00C279 7006              JNZ      ?C0239?ZW_SLAVE
B1:00C27B 7E33              MOV      R6,#HIGH nodeNormalRangeFrame
B1:00C27D 7FD7              MOV      R7,#LOW nodeNormalRangeFrame
B1:00C27F 8004              SJMP     ?C0240?ZW_SLAVE
B1:00C281         ?C0239?ZW_SLAVE:
B1:00C281 7E33              MOV      R6,#HIGH nodeFLiRSRangeFrame
B1:00C283 7F6D              MOV      R7,#LOW nodeFLiRSRangeFrame
B1:00C285         ?C0240?ZW_SLAVE:
B1:00C285 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00C288 126FB8            LCALL    ?L?COM0448
B1:00C28B C003              PUSH     AR3
B1:00C28D C002              PUSH     AR2
B1:00C28F C001              PUSH     AR1
B1:00C291 1287B3            LCALL    ?L?COM003D
B1:00C294 D001              POP      AR1
B1:00C296 D002              POP      AR2
B1:00C298 D003              POP      AR3
B1:00C29A 7F21              MOV      R7,#021H
B1:00C29C 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C29F 129554            LCALL    ?L?COM003B
B1:00C2A2 1285F5            LCALL    ?L?COM0004
B1:00C2A5 541F              ANL      A,#01FH
B1:00C2A7 2404              ADD      A,#04H
B1:00C2A9 FF                MOV      R7,A
B1:00C2AA E4                CLR      A
B1:00C2AB 33                RLC      A
B1:00C2AC FE                MOV      R6,A
B1:00C2AD 90419A            MOV      DPTR,#cmdLength
B1:00C2B0 E0                MOVX     A,@DPTR
B1:00C2B1 D3                SETB     C
B1:00C2B2 12533F            LCALL    ?L?COM011E
B1:00C2B5 400D              JC       ?C0241?ZW_SLAVE
B1:00C2B7 904197            MOV      DPTR,#pCmd
B1:00C2BA 12E598            LCALL    ?L?COM0079
B1:00C2BD 121F7C            LCALL    ?C?CLDPTR
B1:00C2C0 90339E            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00C2C3 F0                MOVX     @DPTR,A
B1:00C2C4         ?C0241?ZW_SLAVE:
B1:00C2C4 9041A1            MOV      DPTR,#sourceNode
B1:00C2C7 E0                MOVX     A,@DPTR
B1:00C2C8 903322            MOV      DPTR,#nodeRange
B1:00C2CB F0                MOVX     @DPTR,A
B1:00C2CC A3                INC      DPTR
B1:00C2CD 7401              MOV      A,#01H
B1:00C2CF F0                MOVX     @DPTR,A
B1:00C2D0 90419F            MOV      DPTR,#rxStatus
B1:00C2D3 E0                MOVX     A,@DPTR
B1:00C2D4 30E107            JNB      ACC.1,?C0242?ZW_SLAVE
B1:00C2D7 903323            MOV      DPTR,#nodeRange+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 335


B1:00C2DA E0                MOVX     A,@DPTR
B1:00C2DB 4402              ORL      A,#02H
B1:00C2DD F0                MOVX     @DPTR,A
B1:00C2DE         ?C0242?ZW_SLAVE:
B1:00C2DE D219              SETB     reducedFindNeighborPower
B1:00C2E0 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00C2E3 E0                MOVX     A,@DPTR
B1:00C2E4 FE                MOV      R6,A
B1:00C2E5 A3                INC      DPTR
B1:00C2E6 E0                MOVX     A,@DPTR
B1:00C2E7 FF                MOV      R7,A
B1:00C2E8 2403              ADD      A,#03H
B1:00C2EA FD                MOV      R5,A
B1:00C2EB E4                CLR      A
B1:00C2EC 3E                ADDC     A,R6
B1:00C2ED FA                MOV      R2,A
B1:00C2EE A905              MOV      R1,AR5
B1:00C2F0 7B01              MOV      R3,#01H
B1:00C2F2 B175              ACALL    ?L?COM0580
B1:00C2F4 FD                MOV      R5,A
B1:00C2F5 121BBF            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskBitsIn
B1:00C2F8 EF                MOV      A,R7
B1:00C2F9 2407              ADD      A,#07H
B1:00C2FB 903314            MOV      DPTR,#assignTimeoutCount
B1:00C2FE F0                MOVX     @DPTR,A
B1:00C2FF E4                CLR      A
B1:00C300 FF                MOV      R7,A
B1:00C301 02AF80            LJMP     _FindNeighbors
B1:00C304         ?C0243?ZW_SLAVE:
B1:00C304 903315            MOV      DPTR,#assignState
B1:00C307 7404              MOV      A,#04H
B1:00C309 F0                MOVX     @DPTR,A
B1:00C30A 12EF0D            LCALL    AssignTimerStop
B1:00C30D E4                CLR      A
B1:00C30E 90336C            MOV      DPTR,#zensorWakeupTime
B1:00C311 F0                MOVX     @DPTR,A
B1:00C312 90419A            MOV      DPTR,#cmdLength
B1:00C315 E0                MOVX     A,@DPTR
B1:00C316 D3                SETB     C
B1:00C317 9402              SUBB     A,#02H
B1:00C319 400A              JC       ?C0244?ZW_SLAVE
B1:00C31B 129554            LCALL    ?L?COM003B
B1:00C31E 1285F5            LCALL    ?L?COM0004
B1:00C321 90336C            MOV      DPTR,#zensorWakeupTime
B1:00C324 F0                MOVX     @DPTR,A
B1:00C325         ?C0244?ZW_SLAVE:
B1:00C325 90336C            MOV      DPTR,#zensorWakeupTime
B1:00C328 E0                MOVX     A,@DPTR
B1:00C329 FB                MOV      R3,A
B1:00C32A 7006              JNZ      ?C0245?ZW_SLAVE
B1:00C32C 7C33              MOV      R4,#HIGH nodeNormalRangeFrame
B1:00C32E 7DD7              MOV      R5,#LOW nodeNormalRangeFrame
B1:00C330 8004              SJMP     ?C0246?ZW_SLAVE
B1:00C332         ?C0245?ZW_SLAVE:
B1:00C332 7C33              MOV      R4,#HIGH nodeFLiRSRangeFrame
B1:00C334 7D6D              MOV      R5,#LOW nodeFLiRSRangeFrame
B1:00C336         ?C0246?ZW_SLAVE:
B1:00C336 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00C339 EC                MOV      A,R4
B1:00C33A F0                MOVX     @DPTR,A
B1:00C33B A3                INC      DPTR
B1:00C33C ED                MOV      A,R5
B1:00C33D F0                MOVX     @DPTR,A
B1:00C33E F582              MOV      DPL,A
B1:00C340 8C83              MOV      DPH,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 336


B1:00C342 7401              MOV      A,#01H
B1:00C344 F0                MOVX     @DPTR,A
B1:00C345 A3                INC      DPTR
B1:00C346 7406              MOV      A,#06H
B1:00C348 F0                MOVX     @DPTR,A
B1:00C349 90419E            MOV      DPTR,#txOptions
B1:00C34C 7401              MOV      A,#01H
B1:00C34E F0                MOVX     @DPTR,A
B1:00C34F A3                INC      DPTR
B1:00C350 E0                MOVX     A,@DPTR
B1:00C351 30E107            JNB      ACC.1,?C0247?ZW_SLAVE
B1:00C354 90419E            MOV      DPTR,#txOptions
B1:00C357 E0                MOVX     A,@DPTR
B1:00C358 4402              ORL      A,#02H
B1:00C35A F0                MOVX     @DPTR,A
B1:00C35B         ?C0247?ZW_SLAVE:
B1:00C35B 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00C35E 12FC74            LCALL    ?L?COM0352
B1:00C361 A3                INC      DPTR
B1:00C362 A3                INC      DPTR
B1:00C363 E0                MOVX     A,@DPTR
B1:00C364 7008              JNZ      ?C0248?ZW_SLAVE
B1:00C366 8F82              MOV      DPL,R7
B1:00C368 8E83              MOV      DPH,R6
B1:00C36A A3                INC      DPTR
B1:00C36B A3                INC      DPTR
B1:00C36C 04                INC      A
B1:00C36D F0                MOVX     @DPTR,A
B1:00C36E         ?C0248?ZW_SLAVE:
B1:00C36E 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00C371 12FC74            LCALL    ?L?COM0352
B1:00C374 A3                INC      DPTR
B1:00C375 A3                INC      DPTR
B1:00C376 E0                MOVX     A,@DPTR
B1:00C377 1230E0            LCALL    ?L?COM0581
B1:00C37A 2582              ADD      A,DPL
B1:00C37C 128E62            LCALL    ?L?COM0192
B1:00C37F EB                MOV      A,R3
B1:00C380 F0                MOVX     @DPTR,A
B1:00C381 901221            MOV      DPTR,#nodeID
B1:00C384 E0                MOVX     A,@DPTR
B1:00C385 FD                MOV      R5,A
B1:00C386 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00C389 E0                MOVX     A,@DPTR
B1:00C38A FE                MOV      R6,A
B1:00C38B A3                INC      DPTR
B1:00C38C E0                MOVX     A,@DPTR
B1:00C38D FF                MOV      R7,A
B1:00C38E AA06              MOV      R2,AR6
B1:00C390 F9                MOV      R1,A
B1:00C391 7B01              MOV      R3,#01H
B1:00C393 12D224            LCALL    ?L?COM0062
B1:00C396 B175              ACALL    ?L?COM0580
B1:00C398 2404              ADD      A,#04H
B1:00C39A FF                MOV      R7,A
B1:00C39B 90336C            MOV      DPTR,#zensorWakeupTime
B1:00C39E E0                MOVX     A,@DPTR
B1:00C39F 7E00              MOV      R6,#00H
B1:00C3A1 7002              JNZ      ?C0250?ZW_SLAVE
B1:00C3A3 7E01              MOV      R6,#01H
B1:00C3A5         ?C0250?ZW_SLAVE:
B1:00C3A5         ?C0251?ZW_SLAVE:
B1:00C3A5 C3                CLR      C
B1:00C3A6 EF                MOV      A,R7
B1:00C3A7 9E                SUBB     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 337


B1:00C3A8 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00C3AB F0                MOVX     @DPTR,A
B1:00C3AC 90419E            MOV      DPTR,#txOptions
B1:00C3AF 12D20D            LCALL    ?L?COM0263
B1:00C3B2 12FCAB            LCALL    ?L?COM046D
B1:00C3B5 9041A1            MOV      DPTR,#sourceNode
B1:00C3B8 12D3B3            LCALL    ?L?COM0422
B1:00C3BB 6002              JZ       $ + 4H
B1:00C3BD 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C3BF FB                MOV      R3,A
B1:00C3C0 FA                MOV      R2,A
B1:00C3C1 F9                MOV      R1,A
B1:00C3C2 7F02              MOV      R7,#02H
B1:00C3C4 02EDBA            LJMP     _ZCB_AssignComplete
B1:00C3C7         ?C0252?ZW_SLAVE:
B1:00C3C7 90419A            MOV      DPTR,#cmdLength
B1:00C3CA E0                MOVX     A,@DPTR
B1:00C3CB FF                MOV      R7,A
B1:00C3CC C3                CLR      C
B1:00C3CD 9406              SUBB     A,#06H
B1:00C3CF E4                CLR      A
B1:00C3D0 9400              SUBB     A,#00H
B1:00C3D2 5002              JNC      $ + 4H
B1:00C3D4 81FF              AJMP     ?C0168?ZW_SLAVE
B1:00C3D6         ?C0253?ZW_SLAVE:
B1:00C3D6 903329            MOV      DPTR,#tempi
B1:00C3D9 EF                MOV      A,R7
B1:00C3DA F0                MOVX     @DPTR,A
B1:00C3DB 7A33              MOV      R2,#HIGH nodeInfoFrame+08H
B1:00C3DD 7949              MOV      R1,#LOW nodeInfoFrame+08H
B1:00C3DF 7D23              MOV      R5,#023H
B1:00C3E1 B14D              ACALL    ?L?COM00FD
B1:00C3E3 1285EC            LCALL    ?L?COM0001
B1:00C3E6 FF                MOV      R7,A
B1:00C3E7 20E265            JB       ACC.2,?C0254?ZW_SLAVE
B1:00C3EA 4404              ORL      A,#04H
B1:00C3EC 12203B            LCALL    ?C?CSTPTR
B1:00C3EF 1287B3            LCALL    ?L?COM003D
B1:00C3F2 7B01              MOV      R3,#01H
B1:00C3F4 7A33              MOV      R2,#HIGH nodeInfoFrame
B1:00C3F6 7941              MOV      R1,#LOW nodeInfoFrame
B1:00C3F8 7F06              MOV      R7,#06H
B1:00C3FA 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C3FD 903346            MOV      DPTR,#nodeInfoFrame+05H
B1:00C400 E0                MOVX     A,@DPTR
B1:00C401 A3                INC      DPTR
B1:00C402 F0                MOVX     @DPTR,A
B1:00C403 12C957            LCALL    ?L?COM04C4
B1:00C406 E4                CLR      A
B1:00C407 903348            MOV      DPTR,#nodeInfoFrame+07H
B1:00C40A F0                MOVX     @DPTR,A
B1:00C40B 903329            MOV      DPTR,#tempi
B1:00C40E E0                MOVX     A,@DPTR
B1:00C40F 2402              ADD      A,#02H
B1:00C411 F0                MOVX     @DPTR,A
B1:00C412 B16D              ACALL    ?L?COM057F
B1:00C414 E4                CLR      A
B1:00C415 34FF              ADDC     A,#0FFH
B1:00C417 FE                MOV      R6,A
B1:00C418 D3                SETB     C
B1:00C419 EF                MOV      A,R7
B1:00C41A 9400              SUBB     A,#00H
B1:00C41C EE                MOV      A,R6
B1:00C41D 9400              SUBB     A,#00H
B1:00C41F 407F              JC       ?C0257?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 338


B1:00C421 D3                SETB     C
B1:00C422 EF                MOV      A,R7
B1:00C423 9423              SUBB     A,#023H
B1:00C425 EE                MOV      A,R6
B1:00C426 9400              SUBB     A,#00H
B1:00C428 4003              JC       ?C0256?ZW_SLAVE
B1:00C42A 7429              MOV      A,#029H
B1:00C42C F0                MOVX     @DPTR,A
B1:00C42D         ?C0256?ZW_SLAVE:
B1:00C42D B16D              ACALL    ?L?COM057F
B1:00C42F 904197            MOV      DPTR,#pCmd
B1:00C432 12DBF8            LCALL    ?L?COM01F3
B1:00C435 F9                MOV      R1,A
B1:00C436 E4                CLR      A
B1:00C437 3A                ADDC     A,R2
B1:00C438 FA                MOV      R2,A
B1:00C439 1287B9            LCALL    ?L?COM003F
B1:00C43C 7B01              MOV      R3,#01H
B1:00C43E 7A33              MOV      R2,#HIGH nodeInfoFrame+08H
B1:00C440 7949              MOV      R1,#LOW nodeInfoFrame+08H
B1:00C442 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C445 90419A            MOV      DPTR,#cmdLength
B1:00C448 E0                MOVX     A,@DPTR
B1:00C449 903329            MOV      DPTR,#tempi
B1:00C44C F0                MOVX     @DPTR,A
B1:00C44D 8051              SJMP     ?C0257?ZW_SLAVE
B1:00C44F         ?C0254?ZW_SLAVE:
B1:00C44F 90419A            MOV      DPTR,#cmdLength
B1:00C452 E0                MOVX     A,@DPTR
B1:00C453 D3                SETB     C
B1:00C454 942B              SUBB     A,#02BH
B1:00C456 4007              JC       ?C0258?ZW_SLAVE
B1:00C458 742B              MOV      A,#02BH
B1:00C45A F0                MOVX     @DPTR,A
B1:00C45B 903329            MOV      DPTR,#tempi
B1:00C45E F0                MOVX     @DPTR,A
B1:00C45F         ?C0258?ZW_SLAVE:
B1:00C45F 90419A            MOV      DPTR,#cmdLength
B1:00C462 E0                MOVX     A,@DPTR
B1:00C463 FF                MOV      R7,A
B1:00C464 1287B3            LCALL    ?L?COM003D
B1:00C467 7B01              MOV      R3,#01H
B1:00C469 7A33              MOV      R2,#HIGH nodeInfoFrame
B1:00C46B 7941              MOV      R1,#LOW nodeInfoFrame
B1:00C46D 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C470 903344            MOV      DPTR,#nodeInfoFrame+03H
B1:00C473 E0                MOVX     A,@DPTR
B1:00C474 20E129            JB       ACC.1,?C0257?ZW_SLAVE
B1:00C477 12C957            LCALL    ?L?COM04C4
B1:00C47A 90419A            MOV      DPTR,#cmdLength
B1:00C47D E0                MOVX     A,@DPTR
B1:00C47E B42B04            CJNE     A,#02BH,?C0260?ZW_SLAVE
B1:00C481 14                DEC      A
B1:00C482 F0                MOVX     @DPTR,A
B1:00C483 8003              SJMP     ?C0261?ZW_SLAVE
B1:00C485         ?C0260?ZW_SLAVE:
B1:00C485 128FBB            LCALL    ?L?COM0379
B1:00C488         ?C0261?ZW_SLAVE:
B1:00C488 90419A            MOV      DPTR,#cmdLength
B1:00C48B E0                MOVX     A,@DPTR
B1:00C48C 24FB              ADD      A,#0FBH
B1:00C48E 904197            MOV      DPTR,#pCmd
B1:00C491 12F31C            LCALL    ?L?COM01B7
B1:00C494 1287B9            LCALL    ?L?COM003F
B1:00C497 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 339


B1:00C499 7A33              MOV      R2,#HIGH nodeInfoFrame+06H
B1:00C49B 7947              MOV      R1,#LOW nodeInfoFrame+06H
B1:00C49D 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C4A0         ?C0257?ZW_SLAVE:
B1:00C4A0 9041A1            MOV      DPTR,#sourceNode
B1:00C4A3 E0                MOVX     A,@DPTR
B1:00C4A4 FD                MOV      R5,A
B1:00C4A5 7B01              MOV      R3,#01H
B1:00C4A7 7A33              MOV      R2,#HIGH nodeInfoFrame+05H
B1:00C4A9 7946              MOV      R1,#LOW nodeInfoFrame+05H
B1:00C4AB 903329            MOV      DPTR,#tempi
B1:00C4AE E0                MOVX     A,@DPTR
B1:00C4AF 24FB              ADD      A,#0FBH
B1:00C4B1 9044F0            MOV      DPTR,#?_ApplicationSlaveUpdate?BYTE+05H
B1:00C4B4 F0                MOVX     @DPTR,A
B1:00C4B5 7F84              MOV      R7,#084H
B1:00C4B7 8043              SJMP     ?C0322?ZW_SLAVE
B1:00C4B9         ?C0262?ZW_SLAVE:
B1:00C4B9 200143            JB       learnMode,?C0168?ZW_SLAVE
B1:00C4BC E550              MOV      A,bNetworkWideInclusion
B1:00C4BE 703F              JNZ      ?C0168?ZW_SLAVE
B1:00C4C0 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00C4C3 E0                MOVX     A,@DPTR
B1:00C4C4 5430              ANL      A,#030H
B1:00C4C6 7017              JNZ      ?C0264?ZW_SLAVE
B1:00C4C8 90419A            MOV      DPTR,#cmdLength
B1:00C4CB 126FD5            LCALL    ?L?COM045D
B1:00C4CE 5007              JNC      ?C0265?ZW_SLAVE
B1:00C4D0 1285EC            LCALL    ?L?COM0001
B1:00C4D3 FF                MOV      R7,A
B1:00C4D4 121BE7            LCALL    ?INTERBANK_TABLE?_ExploreSetNWITimeout
B1:00C4D7         ?C0265?ZW_SLAVE:
B1:00C4D7 129554            LCALL    ?L?COM003B
B1:00C4DA 1285F5            LCALL    ?L?COM0004
B1:00C4DD 8001              SJMP     ?C0323?ZW_SLAVE
B1:00C4DF         ?C0264?ZW_SLAVE:
B1:00C4DF E4                CLR      A
B1:00C4E0         
B1:00C4E0 FF                MOV      R7,A
B1:00C4E1 021BEC            LJMP     ?INTERBANK_TABLE?_ExploreSetNWI
B1:00C4E4         ?C0268?ZW_SLAVE:
B1:00C4E4 200118            JB       learnMode,?C0168?ZW_SLAVE
B1:00C4E7 903315            MOV      DPTR,#assignState
B1:00C4EA E0                MOVX     A,@DPTR
B1:00C4EB 7012              JNZ      ?C0168?ZW_SLAVE
B1:00C4ED 9041A1            MOV      DPTR,#sourceNode
B1:00C4F0 E0                MOVX     A,@DPTR
B1:00C4F1 FD                MOV      R5,A
B1:00C4F2 12A79C            LCALL    ?L?COM00A4
B1:00C4F5 E4                CLR      A
B1:00C4F6 9044F0            MOV      DPTR,#?_ApplicationSlaveUpdate?BYTE+05H
B1:00C4F9 F0                MOVX     @DPTR,A
B1:00C4FA 7F83              MOV      R7,#083H
B1:00C4FC         
B1:00C4FC 121E5D            LCALL    ?INTERBANK_TABLE?_ApplicationSlaveUpdate
B1:00C4FF         ?C0168?ZW_SLAVE:
B1:00C4FF 22                RET      
----- FUNCTION _CommandHandler (END) -------


----- FUNCTION ?L?COM0409 (BEGIN) -----
B1:00C500 741C              MOV      A,#LOW NVM_RETURN_ROUTE_START_far+011H
B1:00C502 2F                ADD      A,R7
B1:00C503 F9                MOV      R1,A
B1:00C504 7400              MOV      A,#HIGH NVM_RETURN_ROUTE_START_far+011H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 340


B1:00C506 3E                ADDC     A,R6
B1:00C507 22                RET      
----- FUNCTION ?L?COM0409 (END) -------


----- FUNCTION ?L?COM023D (BEGIN) -----
B1:00C508 743C              MOV      A,#LOW ZW_RouteDestinations
B1:00C50A 2F                ADD      A,R7
B1:00C50B         ?L?COM023E:
B1:00C50B F582              MOV      DPL,A
B1:00C50D E4                CLR      A
B1:00C50E 3433              ADDC     A,#HIGH ZW_RouteDestinations
B1:00C510 F583              MOV      DPH,A
B1:00C512 22                RET      
----- FUNCTION ?L?COM023D (END) -------


----- FUNCTION ReloadRouteDestinations (BEGIN) -----
B1:00C513 7E11              MOV      R6,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C515 7F56              MOV      R7,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C517 7A33              MOV      R2,#HIGH ZW_RouteDestinations
B1:00C519 793C              MOV      R1,#LOW ZW_RouteDestinations
B1:00C51B 7405              MOV      A,#05H
B1:00C51D B18D              ACALL    ?L?COM029A
B1:00C51F E4                CLR      A
B1:00C520 903329            MOV      DPTR,#tempi
B1:00C523 F0                MOVX     @DPTR,A
B1:00C524         ?C0108?ZW_SLAVE:
B1:00C524 12FCA2            LCALL    ?L?COM0516
B1:00C527 501D              JNC      ?C0112?ZW_SLAVE
B1:00C529 B108              ACALL    ?L?COM023D
B1:00C52B E0                MOVX     A,@DPTR
B1:00C52C D3                SETB     C
B1:00C52D 94E8              SUBB     A,#0E8H
B1:00C52F 4010              JC       ?C0110?ZW_SLAVE
B1:00C531 903329            MOV      DPTR,#tempi
B1:00C534 E0                MOVX     A,@DPTR
B1:00C535 243C              ADD      A,#LOW ZW_RouteDestinations
B1:00C537 B10B              ACALL    ?L?COM023E
B1:00C539 E4                CLR      A
B1:00C53A F0                MOVX     @DPTR,A
B1:00C53B FE                MOV      R6,A
B1:00C53C B185              ACALL    ?L?COM0583
B1:00C53E 128FC9            LCALL    ?L?COM02A1
B1:00C541         ?C0110?ZW_SLAVE:
B1:00C541 128FBB            LCALL    ?L?COM0379
B1:00C544 80DE              SJMP     ?C0108?ZW_SLAVE
B1:00C546         ?C0112?ZW_SLAVE:
B1:00C546 22                RET      
----- FUNCTION ReloadRouteDestinations (END) -------


----- FUNCTION ?L?COM0472 (BEGIN) -----
B1:00C547 904197            MOV      DPTR,#pCmd
B1:00C54A 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0472 (END) -------


----- FUNCTION ?L?COM00FD (BEGIN) -----
B1:00C54D 7B01              MOV      R3,#01H
B1:00C54F E4                CLR      A
B1:00C550 FF                MOV      R7,A
B1:00C551 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM00FD (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 341



----- FUNCTION ClearSendDataTxStatus (BEGIN) -----
B1:00C554 7A40              MOV      R2,#HIGH tx_status
B1:00C556 7918              MOV      R1,#LOW tx_status
B1:00C558 126EA7            LCALL    ?L?COM030B
B1:00C55B 7A40              MOV      R2,#HIGH tx_status+03H
B1:00C55D 791B              MOV      R1,#LOW tx_status+03H
B1:00C55F 7D05              MOV      R5,#05H
B1:00C561 7F7F              MOV      R7,#07FH
B1:00C563 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ClearSendDataTxStatus (END) -------


----- FUNCTION ?L?COM03ED (BEGIN) -----
B1:00C566 903397            MOV      DPTR,#SUC_Update
B1:00C569 E0                MOVX     A,@DPTR
B1:00C56A 6401              XRL      A,#01H
B1:00C56C 22                RET      
----- FUNCTION ?L?COM03ED (END) -------


----- FUNCTION ?L?COM057F (BEGIN) -----
B1:00C56D 90419A            MOV      DPTR,#cmdLength
B1:00C570 E0                MOVX     A,@DPTR
B1:00C571 24FA              ADD      A,#0FAH
B1:00C573 FF                MOV      R7,A
B1:00C574 22                RET      
----- FUNCTION ?L?COM057F (END) -------


----- FUNCTION ?L?COM0580 (BEGIN) -----
B1:00C575 8F82              MOV      DPL,R7
B1:00C577 8E83              MOV      DPH,R6
B1:00C579 A3                INC      DPTR
B1:00C57A A3                INC      DPTR
B1:00C57B E0                MOVX     A,@DPTR
B1:00C57C 22                RET      
----- FUNCTION ?L?COM0580 (END) -------


----- FUNCTION ?L?COM0582 (BEGIN) -----
B1:00C57D 9041A2            MOV      DPTR,#n
B1:00C580 E0                MOVX     A,@DPTR
B1:00C581 C3                CLR      C
B1:00C582 9404              SUBB     A,#04H
B1:00C584 22                RET      
----- FUNCTION ?L?COM0582 (END) -------


----- FUNCTION ?L?COM0583 (BEGIN) -----
B1:00C585 7456              MOV      A,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C587 2F                ADD      A,R7
B1:00C588 F9                MOV      R1,A
B1:00C589 EE                MOV      A,R6
B1:00C58A 3411              ADDC     A,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00C58C 22                RET      
----- FUNCTION ?L?COM0583 (END) -------


----- FUNCTION ?L?COM029A (BEGIN) -----
B1:00C58D 7B01              MOV      R3,#01H
B1:00C58F 904478            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B1:00C592 F0                MOVX     @DPTR,A
B1:00C593 02388D            LJMP     _NVM_ext_read_buffer
----- FUNCTION ?L?COM029A (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 342




----- FUNCTION _ZW_KeystoreNvmUpdate (BEGIN) -----
B1:00C596 904491            MOV      DPTR,#scramblingKeyIndex
B1:00C599 1224BA            LCALL    ?C?LSTXDATA
B1:00C59C 903C00            MOV      DPTR,#assignedSec_keys
B1:00C59F E0                MOVX     A,@DPTR
B1:00C5A0 904495            MOV      DPTR,#keys
B1:00C5A3 F0                MOVX     @DPTR,A
B1:00C5A4 7E12              MOV      R6,#HIGH span_mpan_table_valid
B1:00C5A6 7F94              MOV      R7,#LOW span_mpan_table_valid
B1:00C5A8 E4                CLR      A
B1:00C5A9 FD                MOV      R5,A
B1:00C5AA 12444A            LCALL    _NVM_ext_write_byte
B1:00C5AD 904491            MOV      DPTR,#scramblingKeyIndex
B1:00C5B0 122462            LCALL    ?C?LLDXDATA
B1:00C5B3 7A3C              MOV      R2,#HIGH buffer
B1:00C5B5 7901              MOV      R1,#LOW buffer
B1:00C5B7 7410              MOV      A,#010H
B1:00C5B9 B18D              ACALL    ?L?COM029A
B1:00C5BB         ?C0034?ZW_KEYSTORE:
B1:00C5BB 904495            MOV      DPTR,#keys
B1:00C5BE E0                MOVX     A,@DPTR
B1:00C5BF FE                MOV      R6,A
B1:00C5C0 6038              JZ       ?C0036?ZW_KEYSTORE
B1:00C5C2 FF                MOV      R7,A
B1:00C5C3 14                DEC      A
B1:00C5C4 F4                CPL      A
B1:00C5C5 FD                MOV      R5,A
B1:00C5C6 EF                MOV      A,R7
B1:00C5C7 5D                ANL      A,R5
B1:00C5C8 FF                MOV      R7,A
B1:00C5C9 A3                INC      DPTR
B1:00C5CA F0                MOVX     @DPTR,A
B1:00C5CB F4                CPL      A
B1:00C5CC FD                MOV      R5,A
B1:00C5CD EE                MOV      A,R6
B1:00C5CE 5D                ANL      A,R5
B1:00C5CF 904495            MOV      DPTR,#keys
B1:00C5D2 F0                MOVX     @DPTR,A
B1:00C5D3 D10D              ACALL    ?L?COM01A7
B1:00C5D5 12D8FA            LCALL    _keystore_network_key_read
B1:00C5D8 D10D              ACALL    ?L?COM01A7
B1:00C5DA 12AEF0            LCALL    ?L?COM01CB
B1:00C5DD 7A3C              MOV      R2,#HIGH buffer
B1:00C5DF 7901              MOV      R1,#LOW buffer
B1:00C5E1 12DA7F            LCALL    _ZW_s2_key_scrambler_descramble
B1:00C5E4 904496            MOV      DPTR,#key
B1:00C5E7 E0                MOVX     A,@DPTR
B1:00C5E8 FF                MOV      R7,A
B1:00C5E9 14                DEC      A
B1:00C5EA 12FCB5            LCALL    ?L?COM04C0
B1:00C5ED B1FB              ACALL    ?L?COM01A5
B1:00C5EF 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00C5F2 12CF6E            LCALL    ?L?COM00CC
B1:00C5F5 1239FB            LCALL    _NVM_ext_write_buffer
B1:00C5F8 80C1              SJMP     ?C0034?ZW_KEYSTORE
B1:00C5FA         ?C0036?ZW_KEYSTORE:
B1:00C5FA 22                RET      
----- FUNCTION _ZW_KeystoreNvmUpdate (END) -------


----- FUNCTION ?L?COM01A5 (BEGIN) -----
B1:00C5FB 5403              ANL      A,#03H
B1:00C5FD F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 343


B1:00C5FE E0                MOVX     A,@DPTR
B1:00C5FF 75F010            MOV      B,#010H
B1:00C602 A4                MUL      AB
B1:00C603 2495              ADD      A,#LOW span_mpan_table
B1:00C605 F9                MOV      R1,A
B1:00C606 7412              MOV      A,#HIGH span_mpan_table
B1:00C608         ?L?COM01A6:
B1:00C608 35F0              ADDC     A,B
B1:00C60A FE                MOV      R6,A
B1:00C60B AF01              MOV      R7,AR1
B1:00C60D         ?L?COM01A7:
B1:00C60D 7B01              MOV      R3,#01H
B1:00C60F 7A3C              MOV      R2,#HIGH buffer+010H
B1:00C611 7911              MOV      R1,#LOW buffer+010H
B1:00C613 22                RET      
----- FUNCTION ?L?COM01A5 (END) -------


----- FUNCTION _ZW_KeystoreInit (BEGIN) -----
;---- Variable 'nvmLayout' assigned to Register 'R7' ----
B1:00C614 EF                MOV      A,R7
B1:00C615 6402              XRL      A,#02H
B1:00C617 705A              JNZ      ?C0033?ZW_KEYSTORE
B1:00C619 D174              ACALL    keystore_keypair_check_and_generate
B1:00C61B 7E12              MOV      R6,#HIGH keyclasses_assigned
B1:00C61D 7F13              MOV      R7,#LOW keyclasses_assigned
B1:00C61F 1239F2            LCALL    _NVM_ext_read_byte
B1:00C622 904682            MOV      DPTR,#keys
B1:00C625 EF                MOV      A,R7
B1:00C626 F0                MOVX     @DPTR,A
B1:00C627         ?C0031?ZW_KEYSTORE:
B1:00C627 904682            MOV      DPTR,#keys
B1:00C62A E0                MOVX     A,@DPTR
B1:00C62B FC                MOV      R4,A
B1:00C62C 6045              JZ       ?C0033?ZW_KEYSTORE
B1:00C62E FE                MOV      R6,A
B1:00C62F 14                DEC      A
B1:00C630 F4                CPL      A
B1:00C631 FD                MOV      R5,A
B1:00C632 EE                MOV      A,R6
B1:00C633 5D                ANL      A,R5
B1:00C634 904681            MOV      DPTR,#key
B1:00C637 F0                MOVX     @DPTR,A
B1:00C638 E0                MOVX     A,@DPTR
B1:00C639 FD                MOV      R5,A
B1:00C63A F4                CPL      A
B1:00C63B FE                MOV      R6,A
B1:00C63C EC                MOV      A,R4
B1:00C63D 5E                ANL      A,R6
B1:00C63E A3                INC      DPTR
B1:00C63F F0                MOVX     @DPTR,A
B1:00C640 ED                MOV      A,R5
B1:00C641 14                DEC      A
B1:00C642 C4                SWAP     A
B1:00C643 13                RRC      A
B1:00C644 5407              ANL      A,#07H
B1:00C646 FF                MOV      R7,A
B1:00C647 904681            MOV      DPTR,#key
B1:00C64A E0                MOVX     A,@DPTR
B1:00C64B C3                CLR      C
B1:00C64C 13                RRC      A
B1:00C64D 4F                ORL      A,R7
B1:00C64E B1FB              ACALL    ?L?COM01A5
B1:00C650 904478            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B1:00C653 7410              MOV      A,#010H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 344


B1:00C655 F0                MOVX     @DPTR,A
B1:00C656 12388D            LCALL    _NVM_ext_read_buffer
B1:00C659 904681            MOV      DPTR,#key
B1:00C65C E0                MOVX     A,@DPTR
B1:00C65D 75F010            MOV      B,#010H
B1:00C660 A4                MUL      AB
B1:00C661 2454              ADD      A,#LOW s2_network_keys
B1:00C663 F9                MOV      R1,A
B1:00C664 7412              MOV      A,#HIGH s2_network_keys
B1:00C666 D108              ACALL    ?L?COM01A6
B1:00C668 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00C66B 12CF6E            LCALL    ?L?COM00CC
B1:00C66E 1239FB            LCALL    _NVM_ext_write_buffer
B1:00C671 80B4              SJMP     ?C0031?ZW_KEYSTORE
B1:00C673         ?C0033?ZW_KEYSTORE:
B1:00C673 22                RET      
----- FUNCTION _ZW_KeystoreInit (END) -------


----- FUNCTION keystore_keypair_check_and_generate (BEGIN) -----
B1:00C674 12F7FD            LCALL    ?L?COM02EE
B1:00C677 4007              JC       ?C0037?ZW_KEYSTORE
B1:00C679 121C41            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00C67C EF                MOV      A,R7
B1:00C67D F4                CPL      A
B1:00C67E 7069              JNZ      ?C0038?ZW_KEYSTORE
B1:00C680         ?C0037?ZW_KEYSTORE:
B1:00C680 7E12              MOV      R6,#HIGH s2_private_key
B1:00C682 7F14              MOV      R7,#LOW s2_private_key
B1:00C684 D1EA              ACALL    ?L?COM03AE
B1:00C686 F13D              ACALL    ?L?COM0314
;---- Variable 'idx0' assigned to Register 'R7' ----
B1:00C688 E4                CLR      A
B1:00C689 FF                MOV      R7,A
B1:00C68A         ?C0039?ZW_KEYSTORE:
B1:00C68A D1F1              ACALL    ?L?COM041E
B1:00C68C 705B              JNZ      ?C0038?ZW_KEYSTORE
B1:00C68E         ?C0042?ZW_KEYSTORE:
B1:00C68E         ?C0041?ZW_KEYSTORE:
B1:00C68E 0F                INC      R7
B1:00C68F EF                MOV      A,R7
B1:00C690 B420F7            CJNE     A,#020H,?C0039?ZW_KEYSTORE
B1:00C693         ?C0040?ZW_KEYSTORE:
B1:00C693 D1EA              ACALL    ?L?COM03AE
B1:00C695 12F81A            LCALL    _keystore_public_key_read
;---- Variable 'idx1' assigned to Register 'R7' ----
B1:00C698 E4                CLR      A
B1:00C699 FF                MOV      R7,A
B1:00C69A         ?C0043?ZW_KEYSTORE:
B1:00C69A D1F1              ACALL    ?L?COM041E
B1:00C69C 704B              JNZ      ?C0038?ZW_KEYSTORE
B1:00C69E         ?C0046?ZW_KEYSTORE:
B1:00C69E         ?C0045?ZW_KEYSTORE:
B1:00C69E 0F                INC      R7
B1:00C69F EF                MOV      A,R7
B1:00C6A0 B420F7            CJNE     A,#020H,?C0043?ZW_KEYSTORE
B1:00C6A3         ?C0044?ZW_KEYSTORE:
B1:00C6A3 E4                CLR      A
B1:00C6A4 9046A8            MOV      DPTR,#idx2
B1:00C6A7 F0                MOVX     @DPTR,A
B1:00C6A8         ?C0047?ZW_KEYSTORE:
B1:00C6A8 9046A8            MOV      DPTR,#idx2
B1:00C6AB E0                MOVX     A,@DPTR
B1:00C6AC FF                MOV      R7,A
B1:00C6AD C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 345


B1:00C6AE 9420              SUBB     A,#020H
B1:00C6B0 501A              JNC      ?C0048?ZW_KEYSTORE
B1:00C6B2 7401              MOV      A,#LOW buffer
B1:00C6B4 2F                ADD      A,R7
B1:00C6B5 F9                MOV      R1,A
B1:00C6B6 E4                CLR      A
B1:00C6B7 343C              ADDC     A,#HIGH buffer
B1:00C6B9 FA                MOV      R2,A
B1:00C6BA 7B01              MOV      R3,#01H
B1:00C6BC C3                CLR      C
B1:00C6BD 7420              MOV      A,#020H
B1:00C6BF 9F                SUBB     A,R7
B1:00C6C0 FD                MOV      R5,A
B1:00C6C1 125E35            LCALL    _ZW_GetRandomArray
B1:00C6C4 9046A8            MOV      DPTR,#idx2
B1:00C6C7 E0                MOVX     A,@DPTR
B1:00C6C8 2F                ADD      A,R7
B1:00C6C9 F0                MOVX     @DPTR,A
B1:00C6CA 80DC              SJMP     ?C0047?ZW_KEYSTORE
B1:00C6CC         ?C0048?ZW_KEYSTORE:
B1:00C6CC D1EA              ACALL    ?L?COM03AE
B1:00C6CE 9044B2            MOV      DPTR,#?_crypto_scalarmult_curve25519_base?BYTE+03H
B1:00C6D1 122572            LCALL    ?C?PSTXDATA
B1:00C6D4 7A3C              MOV      R2,#HIGH buffer+020H
B1:00C6D6 7921              MOV      R1,#LOW buffer+020H
B1:00C6D8 12FC27            LCALL    _crypto_scalarmult_curve25519_base
B1:00C6DB D1EA              ACALL    ?L?COM03AE
B1:00C6DD 12DADA            LCALL    _keystore_private_key_write
B1:00C6E0 7B01              MOV      R3,#01H
B1:00C6E2 7A3C              MOV      R2,#HIGH buffer+020H
B1:00C6E4 7921              MOV      R1,#LOW buffer+020H
B1:00C6E6 12F805            LCALL    _keystore_public_key_write
B1:00C6E9         ?C0038?ZW_KEYSTORE:
B1:00C6E9 22                RET      
----- FUNCTION keystore_keypair_check_and_generate (END) -------


----- FUNCTION ?L?COM03AE (BEGIN) -----
B1:00C6EA 7B01              MOV      R3,#01H
B1:00C6EC 7A3C              MOV      R2,#HIGH buffer
B1:00C6EE 7901              MOV      R1,#LOW buffer
B1:00C6F0 22                RET      
----- FUNCTION ?L?COM03AE (END) -------


----- FUNCTION ?L?COM041E (BEGIN) -----
B1:00C6F1 7401              MOV      A,#LOW buffer
B1:00C6F3 2F                ADD      A,R7
B1:00C6F4 F582              MOV      DPL,A
B1:00C6F6 E4                CLR      A
B1:00C6F7 343C              ADDC     A,#HIGH buffer
B1:00C6F9 F583              MOV      DPH,A
B1:00C6FB E0                MOVX     A,@DPTR
B1:00C6FC 22                RET      
----- FUNCTION ?L?COM041E (END) -------


----- FUNCTION _UpdateRssiInRepeatedFrame (BEGIN) -----
;---- Variable 'rssiValue' assigned to Register 'R5' ----
B1:00C6FD 900A9E            MOV      DPTR,#pFrame
B1:00C700 122572            LCALL    ?C?PSTXDATA
B1:00C703 E9                MOV      A,R1
B1:00C704 240A              ADD      A,#0AH
B1:00C706 1285F5            LCALL    ?L?COM0004
B1:00C709 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 346


B1:00C70A 540F              ANL      A,#0FH
B1:00C70C FE                MOV      R6,A
B1:00C70D 900AA1            MOV      DPTR,#repeaterIndex
B1:00C710 F0                MOVX     @DPTR,A
B1:00C711 BE0F04            CJNE     R6,#0FH,?C0065?ZW_TRANSPORT
B1:00C714 E4                CLR      A
B1:00C715 F0                MOVX     @DPTR,A
B1:00C716 8006              SJMP     ?C0066?ZW_TRANSPORT
B1:00C718         ?C0065?ZW_TRANSPORT:
B1:00C718 900AA1            MOV      DPTR,#repeaterIndex
B1:00C71B E0                MOVX     A,@DPTR
B1:00C71C 04                INC      A
B1:00C71D F0                MOVX     @DPTR,A
B1:00C71E         ?C0066?ZW_TRANSPORT:
B1:00C71E AE05              MOV      R6,AR5
B1:00C720 EF                MOV      A,R7
B1:00C721 12F704            LCALL    ?L?COM03BF
B1:00C724 900A9E            MOV      DPTR,#pFrame
B1:00C727 122552            LCALL    ?C?PLDXDATA
B1:00C72A 12F2B6            LCALL    ?L?COM01D0
B1:00C72D 126F9C            LCALL    ?L?COM0438
B1:00C730 900AA1            MOV      DPTR,#repeaterIndex
B1:00C733 E0                MOVX     A,@DPTR
B1:00C734 29                ADD      A,R1
B1:00C735 F9                MOV      R1,A
B1:00C736 EC                MOV      A,R4
B1:00C737 3A                ADDC     A,R2
B1:00C738 FA                MOV      R2,A
B1:00C739 EE                MOV      A,R6
B1:00C73A 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _UpdateRssiInRepeatedFrame (END) -------


----- FUNCTION ?L?COM0314 (BEGIN) -----
B1:00C73D 9044C0            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B1:00C740 7420              MOV      A,#020H
B1:00C742 F0                MOVX     @DPTR,A
B1:00C743 021B97            LJMP     ?INTERBANK_TABLE?_MemoryGetBuffer
----- FUNCTION ?L?COM0314 (END) -------


----- FUNCTION ?L?COM0427 (BEGIN) -----
B1:00C746 D222              SETB     ?IncSeqNo?BIT
B1:00C748 D223              SETB     ?IncSeqNo?BIT+01H
----- FUNCTION IncSeqNo (BEGIN) -----
B1:00C74A 20222A            JB       baud40k,?C0104?ZW_TRANSPORT
B1:00C74D 302313            JNB      routed,?C0105?ZW_TRANSPORT
B1:00C750 E567              MOV      A,current9600SeqNosTX
B1:00C752 54F0              ANL      A,#0F0H
B1:00C754 FF                MOV      R7,A
B1:00C755 BFF003            CJNE     R7,#0F0H,?C0106?ZW_TRANSPORT
B1:00C758 53670F            ANL      current9600SeqNosTX,#0FH
B1:00C75B         ?C0106?ZW_TRANSPORT:
B1:00C75B 7410              MOV      A,#010H
B1:00C75D 2567              ADD      A,current9600SeqNosTX
B1:00C75F F567              MOV      current9600SeqNosTX,A
B1:00C761 803C              SJMP     ?C0587?ZW_TRANSPORT
B1:00C763         ?C0105?ZW_TRANSPORT:
B1:00C763 E567              MOV      A,current9600SeqNosTX
B1:00C765 540F              ANL      A,#0FH
B1:00C767 FF                MOV      R7,A
B1:00C768 BF0F03            CJNE     R7,#0FH,?C0109?ZW_TRANSPORT
B1:00C76B 5367F0            ANL      current9600SeqNosTX,#0F0H
B1:00C76E         ?C0109?ZW_TRANSPORT:
B1:00C76E 0567              INC      current9600SeqNosTX
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 347


B1:00C770 E567              MOV      A,current9600SeqNosTX
B1:00C772 540F              ANL      A,#0FH
B1:00C774 C4                SWAP     A
B1:00C775         
B1:00C775 8028              SJMP     ?C0587?ZW_TRANSPORT
B1:00C777         ?C0104?ZW_TRANSPORT:
B1:00C777 302313            JNB      routed,?C0111?ZW_TRANSPORT
B1:00C77A E566              MOV      A,current40kSeqNosTX
B1:00C77C 54F0              ANL      A,#0F0H
B1:00C77E FF                MOV      R7,A
B1:00C77F BFF003            CJNE     R7,#0F0H,?C0112?ZW_TRANSPORT
B1:00C782 53660F            ANL      current40kSeqNosTX,#0FH
B1:00C785         ?C0112?ZW_TRANSPORT:
B1:00C785 7410              MOV      A,#010H
B1:00C787 2566              ADD      A,current40kSeqNosTX
B1:00C789 F566              MOV      current40kSeqNosTX,A
B1:00C78B         
B1:00C78B 8012              SJMP     ?C0587?ZW_TRANSPORT
B1:00C78D         ?C0111?ZW_TRANSPORT:
B1:00C78D E566              MOV      A,current40kSeqNosTX
B1:00C78F 540F              ANL      A,#0FH
B1:00C791 FF                MOV      R7,A
B1:00C792 BF0F03            CJNE     R7,#0FH,?C0114?ZW_TRANSPORT
B1:00C795 5366F0            ANL      current40kSeqNosTX,#0F0H
B1:00C798         ?C0114?ZW_TRANSPORT:
B1:00C798 0566              INC      current40kSeqNosTX
B1:00C79A E566              MOV      A,current40kSeqNosTX
B1:00C79C 540F              ANL      A,#0FH
B1:00C79E C4                SWAP     A
B1:00C79F         
B1:00C79F 54F0              ANL      A,#0F0H
B1:00C7A1 FF                MOV      R7,A
B1:00C7A2 22                RET      
----- FUNCTION IncSeqNo (END) -------


----- FUNCTION _EnQueueCommon (BEGIN) -----
B1:00C7A3 900A14            MOV      DPTR,#rfSpeed
B1:00C7A6 126563            LCALL    ?L?COM00E9
B1:00C7A9 122572            LCALL    ?C?PSTXDATA
B1:00C7AC 900A1A            MOV      DPTR,#txOptions
B1:00C7AF E0                MOVX     A,@DPTR
B1:00C7B0 FF                MOV      R7,A
B1:00C7B1 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C7B4 129557            LCALL    ?L?COM003C
B1:00C7B7 1287AB            LCALL    ?L?COM0015
B1:00C7BA EF                MOV      A,R7
B1:00C7BB 7E00              MOV      R6,#00H
B1:00C7BD 30E104            JNB      ACC.1,?C0115?ZW_TRANSPORT
B1:00C7C0 7F08              MOV      R7,#08H
B1:00C7C2 8002              SJMP     ?C0116?ZW_TRANSPORT
B1:00C7C4         ?C0115?ZW_TRANSPORT:
B1:00C7C4 7F00              MOV      R7,#00H
B1:00C7C6         ?C0116?ZW_TRANSPORT:
B1:00C7C6 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C7C9 129549            LCALL    ?L?COM0058
B1:00C7CC 12C94D            LCALL    ?L?COM00B8
B1:00C7CF 900A19            MOV      DPTR,#dataLength
B1:00C7D2 E0                MOVX     A,@DPTR
B1:00C7D3 FF                MOV      R7,A
B1:00C7D4 74A9              MOV      A,#0A9H
B1:00C7D6 C3                CLR      C
B1:00C7D7 9F                SUBB     A,R7
B1:00C7D8 5003              JNC      ?C0117?ZW_TRANSPORT
B1:00C7DA 74A9              MOV      A,#0A9H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 348


B1:00C7DC F0                MOVX     @DPTR,A
B1:00C7DD         ?C0117?ZW_TRANSPORT:
B1:00C7DD 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C7E0 1285EF            LCALL    ?L?COM0002
B1:00C7E3 20E51F            JB       ACC.5,?C0118?ZW_TRANSPORT
B1:00C7E6 900A19            MOV      DPTR,#dataLength
B1:00C7E9 E0                MOVX     A,@DPTR
B1:00C7EA 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C7ED 12BBFC            LCALL    ?L?COM0120
B1:00C7F0 C003              PUSH     AR3
B1:00C7F2 C002              PUSH     AR2
B1:00C7F4 C001              PUSH     AR1
B1:00C7F6 900A16            MOV      DPTR,#pData
B1:00C7F9 1287B6            LCALL    ?L?COM003E
B1:00C7FC D001              POP      AR1
B1:00C7FE D002              POP      AR2
B1:00C800 D003              POP      AR3
B1:00C802 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00C805         ?C0118?ZW_TRANSPORT:
B1:00C805 900A19            MOV      DPTR,#dataLength
B1:00C808 E0                MOVX     A,@DPTR
B1:00C809 FF                MOV      R7,A
B1:00C80A 12FCE2            LCALL    ?L?COM0541
B1:00C80D 24B1              ADD      A,#0B1H
B1:00C80F 1287AB            LCALL    ?L?COM0015
B1:00C812 900A1B            MOV      DPTR,#completedFunc
B1:00C815 E0                MOVX     A,@DPTR
B1:00C816 FE                MOV      R6,A
B1:00C817 A3                INC      DPTR
B1:00C818 E0                MOVX     A,@DPTR
B1:00C819 FF                MOV      R7,A
B1:00C81A A3                INC      DPTR
B1:00C81B 122552            LCALL    ?C?PLDXDATA
B1:00C81E E9                MOV      A,R1
B1:00C81F 24DC              ADD      A,#0DCH
B1:00C821 314D              ACALL    ?L?COM00B8
B1:00C823 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C826 12FC5A            LCALL    ?L?COM025C
B1:00C829 75F052            MOV      B,#LOW ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00C82C 1221E8            LCALL    ?C?ISTPTR
B1:00C82F 900A14            MOV      DPTR,#rfSpeed
B1:00C832 E0                MOVX     A,@DPTR
;---- Variable 'tmpSpeed' assigned to Register 'R6' ----
B1:00C833 FE                MOV      R6,A
B1:00C834 A3                INC      DPTR
B1:00C835 E0                MOVX     A,@DPTR
B1:00C836 540F              ANL      A,#0FH
B1:00C838 FF                MOV      R7,A
B1:00C839 6402              XRL      A,#02H
B1:00C83B 6033              JZ       ?C0119?ZW_TRANSPORT
B1:00C83D 12FCE2            LCALL    ?L?COM0541
B1:00C840 24BA              ADD      A,#0BAH
B1:00C842 1285F5            LCALL    ?L?COM0004
B1:00C845 FD                MOV      R5,A
B1:00C846 900767            MOV      DPTR,#tmp
B1:00C849 F0                MOVX     @DPTR,A
B1:00C84A BDFF08            CJNE     R5,#0FFH,?C0120?ZW_TRANSPORT
B1:00C84D EE                MOV      A,R6
B1:00C84E 54F8              ANL      A,#0F8H
B1:00C850 4401              ORL      A,#01H
B1:00C852 FE                MOV      R6,A
B1:00C853 801B              SJMP     ?C0119?ZW_TRANSPORT
B1:00C855         ?C0120?ZW_TRANSPORT:
B1:00C855 EE                MOV      A,R6
B1:00C856 5407              ANL      A,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 349


B1:00C858 7016              JNZ      ?C0119?ZW_TRANSPORT
B1:00C85A 900763            MOV      DPTR,#bNodeLastReceivedFrom
B1:00C85D E0                MOVX     A,@DPTR
B1:00C85E FD                MOV      R5,A
B1:00C85F 900767            MOV      DPTR,#tmp
B1:00C862 E0                MOVX     A,@DPTR
B1:00C863 B5050A            CJNE     A,AR5,?C0119?ZW_TRANSPORT
B1:00C866 EE                MOV      A,R6
B1:00C867 54F8              ANL      A,#0F8H
B1:00C869 FE                MOV      R6,A
B1:00C86A 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00C86D E0                MOVX     A,@DPTR
B1:00C86E 4E                ORL      A,R6
B1:00C86F FE                MOV      R6,A
B1:00C870         ?C0119?ZW_TRANSPORT:
B1:00C870 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C873 1252EE            LCALL    ?L?COM001E
B1:00C876 54EF              ANL      A,#0EFH
B1:00C878 FD                MOV      R5,A
B1:00C879 E5F0              MOV      A,B
B1:00C87B 8DF0              MOV      B,R5
B1:00C87D 1221E8            LCALL    ?C?ISTPTR
B1:00C880 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C883 1285EF            LCALL    ?L?COM0002
B1:00C886 20E558            JB       ACC.5,?C0124?ZW_TRANSPORT
B1:00C889 300834            JNB      currentSeqNoUseTX,?C0125?ZW_TRANSPORT
B1:00C88C EF                MOV      A,R7
B1:00C88D 6404              XRL      A,#04H
B1:00C88F 600A              JZ       ?C0127?ZW_TRANSPORT
B1:00C891 900A15            MOV      DPTR,#frameType
B1:00C894 E0                MOVX     A,@DPTR
B1:00C895 540F              ANL      A,#0FH
B1:00C897 6406              XRL      A,#06H
B1:00C899 7010              JNZ      ?C0126?ZW_TRANSPORT
B1:00C89B         ?C0127?ZW_TRANSPORT:
B1:00C89B 12FD22            LCALL    ?L?COM04CD
B1:00C89E BF0203            CJNE     R7,#02H,?C0128?ZW_TRANSPORT
B1:00C8A1 D3                SETB     C
B1:00C8A2 8001              SJMP     ?C0129?ZW_TRANSPORT
B1:00C8A4         ?C0128?ZW_TRANSPORT:
B1:00C8A4 C3                CLR      C
B1:00C8A5         ?C0129?ZW_TRANSPORT:
B1:00C8A5 9222              MOV      ?IncSeqNo?BIT,C
B1:00C8A7 D223              SETB     ?IncSeqNo?BIT+01H
B1:00C8A9 800E              SJMP     ?C0588?ZW_TRANSPORT
B1:00C8AB         ?C0126?ZW_TRANSPORT:
B1:00C8AB 12FD22            LCALL    ?L?COM04CD
B1:00C8AE BF0203            CJNE     R7,#02H,?C0131?ZW_TRANSPORT
B1:00C8B1 D3                SETB     C
B1:00C8B2 8001              SJMP     ?C0132?ZW_TRANSPORT
B1:00C8B4         ?C0131?ZW_TRANSPORT:
B1:00C8B4 C3                CLR      C
B1:00C8B5         ?C0132?ZW_TRANSPORT:
B1:00C8B5 9222              MOV      ?IncSeqNo?BIT,C
B1:00C8B7 C223              CLR      ?IncSeqNo?BIT+01H
B1:00C8B9         
B1:00C8B9 12C74A            LCALL    IncSeqNo
B1:00C8BC ED                MOV      A,R5
B1:00C8BD 4F                ORL      A,R7
B1:00C8BE 800D              SJMP     ?C0589?ZW_TRANSPORT
B1:00C8C0         ?C0125?ZW_TRANSPORT:
B1:00C8C0 900A15            MOV      DPTR,#frameType
B1:00C8C3 E0                MOVX     A,@DPTR
B1:00C8C4 12FD77            LCALL    ?L?COM0590
B1:00C8C7 C4                SWAP     A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 350


B1:00C8C8 54F0              ANL      A,#0F0H
B1:00C8CA FD                MOV      R5,A
B1:00C8CB EF                MOV      A,R7
B1:00C8CC 4D                ORL      A,R5
B1:00C8CD         
B1:00C8CD 900A15            MOV      DPTR,#frameType
B1:00C8D0 F0                MOVX     @DPTR,A
B1:00C8D1         ?C0133?ZW_TRANSPORT:
B1:00C8D1 D208              SETB     currentSeqNoUseTX
B1:00C8D3 12FCFB            LCALL    ?L?COM0520
B1:00C8D6 12BBEE            LCALL    ?L?COM02D9
B1:00C8D9 1287AB            LCALL    ?L?COM0015
B1:00C8DC 540F              ANL      A,#0FH
B1:00C8DE 12203B            LCALL    ?C?CSTPTR
B1:00C8E1         ?C0124?ZW_TRANSPORT:
B1:00C8E1 AF06              MOV      R7,AR6
B1:00C8E3 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C8E6 129549            LCALL    ?L?COM0058
B1:00C8E9 F9                MOV      R1,A
B1:00C8EA E4                CLR      A
B1:00C8EB 3A                ADDC     A,R2
B1:00C8EC FA                MOV      R2,A
B1:00C8ED E4                CLR      A
B1:00C8EE 8FF0              MOV      B,R7
B1:00C8F0 1221E8            LCALL    ?C?ISTPTR
B1:00C8F3 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C8F6 1285EF            LCALL    ?L?COM0002
B1:00C8F9 20E509            JB       ACC.5,?C0134?ZW_TRANSPORT
B1:00C8FC 12FCFB            LCALL    ?L?COM0520
B1:00C8FF 122552            LCALL    ?C?PLDXDATA
B1:00C902 12A00B            LCALL    _BuildTxHeader
B1:00C905         ?C0134?ZW_TRANSPORT:
B1:00C905 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C908 1252EE            LCALL    ?L?COM001E
B1:00C90B FF                MOV      R7,A
B1:00C90C 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C90F 12DBF8            LCALL    ?L?COM01F3
B1:00C912 F9                MOV      R1,A
B1:00C913 E4                CLR      A
B1:00C914 3A                ADDC     A,R2
B1:00C915 FA                MOV      R2,A
B1:00C916 12D08B            LCALL    ?L?COM0241
B1:00C919 900A1D            MOV      DPTR,#pFreeTxElement
B1:00C91C 122552            LCALL    ?C?PLDXDATA
B1:;----                  JMP      _TxQueueQueueElement
----- FUNCTION _EnQueueCommon (END) -------


----- FUNCTION _TxQueueQueueElement (BEGIN) -----
B1:00C91F 900ACD            MOV      DPTR,#pNewTxElement
B1:00C922 122572            LCALL    ?C?PSTXDATA
B1:00C925 900ACD            MOV      DPTR,#pNewTxElement
B1:00C928 3141              ACALL    ?L?COM0048
B1:00C92A 540F              ANL      A,#0FH
B1:00C92C 12203B            LCALL    ?C?CSTPTR
B1:00C92F 900ACD            MOV      DPTR,#pNewTxElement
B1:00C932 12D768            LCALL    ?L?COM0460
B1:00C935 12A441            LCALL    ?L?COM0182
B1:00C938 021FE6            LJMP     ?C?CILDPTR
----- FUNCTION _TxQueueQueueElement (END) -------


----- FUNCTION ?L?COM0046 (BEGIN) -----
B1:00C93B 12203B            LCALL    ?C?CSTPTR
B1:00C93E         ?L?COM0047:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 351


B1:00C93E 9040DB            MOV      DPTR,#first_block
B1:00C941         ?L?COM0048:
B1:00C941 122552            LCALL    ?C?PLDXDATA
B1:00C944 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0046 (END) -------


----- FUNCTION ?L?COM00B7 (BEGIN) -----
B1:00C947 122552            LCALL    ?C?PLDXDATA
B1:00C94A E9                MOV      A,R1
B1:00C94B 24E9              ADD      A,#0E9H
B1:00C94D         ?L?COM00B8:
B1:00C94D F9                MOV      R1,A
B1:00C94E E4                CLR      A
B1:00C94F 3A                ADDC     A,R2
B1:00C950 FA                MOV      R2,A
B1:00C951         ?L?COM00B9:
B1:00C951 EE                MOV      A,R6
B1:00C952 8FF0              MOV      B,R7
B1:00C954 0221E8            LJMP     ?C?ISTPTR
----- FUNCTION ?L?COM00B7 (END) -------


----- FUNCTION ?L?COM04C4 (BEGIN) -----
B1:00C957 7B01              MOV      R3,#01H
B1:00C959 7A33              MOV      R2,#HIGH nodeInfoFrame+02H
B1:00C95B 7943              MOV      R1,#LOW nodeInfoFrame+02H
----- FUNCTION _ZW_GetNodeTypeBasic (BEGIN) -----
B1:00C95D 9045DF            MOV      DPTR,#nodeInfo
B1:00C960 122572            LCALL    ?C?PSTXDATA
B1:00C963 9045DF            MOV      DPTR,#nodeInfo
B1:00C966 12E012            LCALL    ?L?COM00B3
B1:00C969 1285F5            LCALL    ?L?COM0004
B1:00C96C FF                MOV      R7,A
B1:00C96D 30E119            JNB      ACC.1,?C0151?ZW_SLAVE
B1:00C970 9045DF            MOV      DPTR,#nodeInfo
B1:00C973 3141              ACALL    ?L?COM0048
B1:00C975 30E707            JNB      ACC.7,?C0152?ZW_SLAVE
B1:00C978 125D51            LCALL    ?L?COM00B0
B1:00C97B 7402              MOV      A,#02H
B1:00C97D 801D              SJMP     ?C0315?ZW_SLAVE
B1:00C97F         ?C0152?ZW_SLAVE:
B1:00C97F 9045DF            MOV      DPTR,#nodeInfo
B1:00C982 125D4E            LCALL    ?L?COM00AF
B1:00C985 7401              MOV      A,#01H
B1:00C987         
B1:00C987 8013              SJMP     ?C0315?ZW_SLAVE
B1:00C989         ?C0151?ZW_SLAVE:
B1:00C989 EF                MOV      A,R7
B1:00C98A 9045DF            MOV      DPTR,#nodeInfo
B1:00C98D 30E307            JNB      ACC.3,?C0155?ZW_SLAVE
B1:00C990 125D4E            LCALL    ?L?COM00AF
B1:00C993 7404              MOV      A,#04H
B1:00C995         
B1:00C995 8005              SJMP     ?C0315?ZW_SLAVE
B1:00C997         ?C0155?ZW_SLAVE:
B1:00C997 125D4E            LCALL    ?L?COM00AF
B1:00C99A 7403              MOV      A,#03H
B1:00C99C         
B1:00C99C 12203B            LCALL    ?C?CSTPTR
B1:00C99F         ?C0154?ZW_SLAVE:
B1:00C99F 9045DF            MOV      DPTR,#nodeInfo
B1:00C9A2 1285EF            LCALL    ?L?COM0002
B1:00C9A5 FF                MOV      R7,A
B1:00C9A6 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 352


----- FUNCTION _ZW_GetNodeTypeBasic (END) -------


----- FUNCTION _format_b0 (BEGIN) -----
B1:00C9A7 9040D9            MOV      DPTR,#text_to_encrypt_len
B1:00C9AA 126EBF            LCALL    ?L?COM0349
B1:00C9AD 122572            LCALL    ?C?PSTXDATA
;---- Variable 't' assigned to Register 'R7' ----
B1:00C9B0 9040DB            MOV      DPTR,#first_block
B1:00C9B3 122552            LCALL    ?C?PLDXDATA
B1:00C9B6 E4                CLR      A
B1:00C9B7 313B              ACALL    ?L?COM0046
B1:00C9B9 4440              ORL      A,#040H
B1:00C9BB 12203B            LCALL    ?C?CSTPTR
B1:00C9BE EF                MOV      A,R7
B1:00C9BF 24FE              ADD      A,#0FEH
B1:00C9C1 FF                MOV      R7,A
B1:00C9C2 E4                CLR      A
B1:00C9C3 34FF              ADDC     A,#0FFH
B1:00C9C5 C3                CLR      C
B1:00C9C6 13                RRC      A
B1:00C9C7 EF                MOV      A,R7
B1:00C9C8 13                RRC      A
B1:00C9C9 5407              ANL      A,#07H
B1:00C9CB 33                RLC      A
B1:00C9CC 33                RLC      A
B1:00C9CD 33                RLC      A
B1:00C9CE 54F8              ANL      A,#0F8H
B1:00C9D0 FF                MOV      R7,A
B1:00C9D1 313E              ACALL    ?L?COM0047
B1:00C9D3 4F                ORL      A,R7
B1:00C9D4 313B              ACALL    ?L?COM0046
B1:00C9D6 FF                MOV      R7,A
B1:00C9D7 12FD6F            LCALL    ?L?COM0576
B1:00C9DA 4F                ORL      A,R7
B1:00C9DB 12203B            LCALL    ?C?CSTPTR
B1:00C9DE 9040E1            MOV      DPTR,#i
B1:00C9E1 7401              MOV      A,#01H
B1:00C9E3 F0                MOVX     @DPTR,A
B1:00C9E4         ?C0005?CCM:
B1:00C9E4 904606            MOV      DPTR,#n
B1:00C9E7 E0                MOVX     A,@DPTR
B1:00C9E8 2401              ADD      A,#01H
B1:00C9EA FF                MOV      R7,A
B1:00C9EB E4                CLR      A
B1:00C9EC 9040E1            MOV      DPTR,#i
B1:00C9EF 12533B            LCALL    ?L?COM011C
B1:00C9F2 5020              JNC      ?C0006?CCM
B1:00C9F4 E0                MOVX     A,@DPTR
B1:00C9F5 FF                MOV      R7,A
B1:00C9F6 24FF              ADD      A,#0FFH
B1:00C9F8 FD                MOV      R5,A
B1:00C9F9 E4                CLR      A
B1:00C9FA 34FF              ADDC     A,#0FFH
B1:00C9FC FC                MOV      R4,A
B1:00C9FD 9040DE            MOV      DPTR,#nonce
B1:00CA00 126F8C            LCALL    ?L?COM0416
B1:00CA03 121FB9            LCALL    ?C?CLDOPTR
B1:00CA06 9040DB            MOV      DPTR,#first_block
B1:00CA09 12DF88            LCALL    ?L?COM02B1
B1:00CA0C 9040E1            MOV      DPTR,#i
B1:00CA0F E0                MOVX     A,@DPTR
B1:00CA10 04                INC      A
B1:00CA11 F0                MOVX     @DPTR,A
B1:00CA12 80D0              SJMP     ?C0005?CCM
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 353


B1:00CA14         ?C0006?CCM:
B1:00CA14 9040D9            MOV      DPTR,#text_to_encrypt_len
B1:00CA17 126F7C            LCALL    ?L?COM0406
B1:00CA1A 7A40              MOV      R2,#HIGH Q
B1:00CA1C 79E2              MOV      R1,#LOW Q
B1:00CA1E 904607            MOV      DPTR,#q
B1:00CA21 E0                MOVX     A,@DPTR
B1:00CA22 9042C7            MOV      DPTR,#?_convert_to_octet_string?BYTE+05H
B1:00CA25 F0                MOVX     @DPTR,A
B1:00CA26 12F850            LCALL    _convert_to_octet_string
B1:00CA29 904607            MOV      DPTR,#q
B1:00CA2C E0                MOVX     A,@DPTR
B1:00CA2D FF                MOV      R7,A
B1:00CA2E 7E00              MOV      R6,#00H
B1:00CA30 9040DB            MOV      DPTR,#first_block
B1:00CA33 122552            LCALL    ?C?PLDXDATA
B1:00CA36 9040E1            MOV      DPTR,#i
B1:00CA39 E0                MOVX     A,@DPTR
B1:00CA3A 7C00              MOV      R4,#00H
B1:00CA3C 29                ADD      A,R1
B1:00CA3D F9                MOV      R1,A
B1:00CA3E EC                MOV      A,R4
B1:00CA3F 12E322            LCALL    ?L?COM01F5
B1:00CA42 7A40              MOV      R2,#HIGH Q
B1:00CA44 79E2              MOV      R1,#LOW Q
B1:00CA46 121F56            LCALL    ?C?COPY
B1:00CA49 7E00              MOV      R6,#00H
B1:00CA4B 7F01              MOV      R7,#01H
B1:00CA4D 22                RET      
----- FUNCTION _format_b0 (END) -------


----- FUNCTION _CCM_decrypt_and_auth (BEGIN) -----
B1:00CA4E 903BB8            MOV      DPTR,#key
B1:00CA51 12FD67            LCALL    ?L?COM0531
B1:00CA54 FF                MOV      R7,A
B1:00CA55 12FCF2            LCALL    ?L?COM050F
B1:00CA58 122462            LCALL    ?C?LLDXDATA
B1:00CA5B 122241            LCALL    ?C?LSUB
B1:00CA5E E4                CLR      A
B1:00CA5F 7B10              MOV      R3,#010H
B1:00CA61 F8                MOV      R0,A
B1:00CA62 1222DA            LCALL    ?C?ULDIV
B1:00CA65 EF                MOV      A,R7
B1:00CA66 2401              ADD      A,#01H
B1:00CA68 FF                MOV      R7,A
B1:00CA69 E4                CLR      A
B1:00CA6A 3E                ADDC     A,R6
B1:00CA6B 903BEC            MOV      DPTR,#num_counter_blocks
B1:00CA6E F0                MOVX     @DPTR,A
B1:00CA6F A3                INC      DPTR
B1:00CA70 EF                MOV      A,R7
B1:00CA71 F0                MOVX     @DPTR,A
B1:00CA72 904608            MOV      DPTR,#t
B1:00CA75 E0                MOVX     A,@DPTR
B1:00CA76 FF                MOV      R7,A
B1:00CA77 903BFE            MOV      DPTR,#mac_len
B1:00CA7A 12FD42            LCALL    ?L?COM0476
B1:00CA7D 12FCF2            LCALL    ?L?COM050F
B1:00CA80 122462            LCALL    ?C?LLDXDATA
B1:00CA83 122241            LCALL    ?C?LSUB
B1:00CA86 EF                MOV      A,R7
B1:00CA87 540F              ANL      A,#0FH
B1:00CA89 FF                MOV      R7,A
B1:00CA8A EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 354


B1:00CA8B 600A              JZ       ?C0047?CCM
B1:00CA8D 903BEC            MOV      DPTR,#num_counter_blocks
B1:00CA90 E4                CLR      A
B1:00CA91 75F001            MOV      B,#01H
B1:00CA94 12210C            LCALL    ?C?IILDX
B1:00CA97         ?C0047?CCM:
B1:00CA97 904608            MOV      DPTR,#t
B1:00CA9A 125BD1            LCALL    ?L?COM02DC
B1:00CA9D 903BC8            MOV      DPTR,#ciphertext_len
B1:00CAA0 12FCC8            LCALL    ?L?COM015B
B1:00CAA3 5002              JNC      ?C0048?CCM
B1:00CAA5 6194              AJMP     ?C0064?CCM
B1:00CAA7         ?C0048?CCM:
B1:00CAA7 71AA              ACALL    ?L?COM016F
B1:00CAA9 FD                MOV      R5,A
B1:00CAAA EE                MOV      A,R6
B1:00CAAB 9400              SUBB     A,#00H
B1:00CAAD FC                MOV      R4,A
B1:00CAAE 903BEC            MOV      DPTR,#num_counter_blocks
B1:00CAB1 12F92F            LCALL    ?L?COM00D3
B1:00CAB4 7A3B              MOV      R2,#HIGH blocks
B1:00CAB6 79CC              MOV      R1,#LOW blocks
B1:00CAB8 A3                INC      DPTR
B1:00CAB9 122572            LCALL    ?C?PSTXDATA
B1:00CABC 903BBB            MOV      DPTR,#nonce
B1:00CABF 12FDF9            LCALL    ?L?COM04BC
B1:00CAC2 903BFE            MOV      DPTR,#mac_len
B1:00CAC5 12FE02            LCALL    ?L?COM050E
B1:00CAC8 12FCCF            LCALL    ?L?COM037D
B1:00CACB 903DFE            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0FH
B1:00CACE 122572            LCALL    ?C?PSTXDATA
B1:00CAD1 7B01              MOV      R3,#01H
B1:00CAD3 7A3B              MOV      R2,#HIGH mac
B1:00CAD5 79EE              MOV      R1,#LOW mac
B1:00CAD7 903E01            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+012H
B1:00CADA 122572            LCALL    ?C?PSTXDATA
B1:00CADD E4                CLR      A
B1:00CADE 903E04            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+015H
B1:00CAE1 F0                MOVX     @DPTR,A
B1:00CAE2 A3                INC      DPTR
B1:00CAE3 F0                MOVX     @DPTR,A
B1:00CAE4 903BC5            MOV      DPTR,#cipher_plaintext
B1:00CAE7 122552            LCALL    ?C?PLDXDATA
B1:00CAEA 12E461            LCALL    _encrypt_or_decrypt
B1:00CAED 71AA              ACALL    ?L?COM016F
B1:00CAEF FF                MOV      R7,A
B1:00CAF0 EE                MOV      A,R6
B1:00CAF1 9400              SUBB     A,#00H
B1:00CAF3 FE                MOV      R6,A
B1:00CAF4 903BC5            MOV      DPTR,#cipher_plaintext
B1:00CAF7 12E598            LCALL    ?L?COM0079
B1:00CAFA C003              PUSH     AR3
B1:00CAFC C002              PUSH     AR2
B1:00CAFE C001              PUSH     AR1
B1:00CB00 71A3              ACALL    ?L?COM0286
B1:00CB02 12E570            LCALL    ?L?COM03B4
B1:00CB05 904608            MOV      DPTR,#t
B1:00CB08 E0                MOVX     A,@DPTR
B1:00CB09 904358            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00CB0C 126FE3            LCALL    ?L?COM046C
B1:00CB0F D001              POP      AR1
B1:00CB11 D002              POP      AR2
B1:00CB13 D003              POP      AR3
B1:00CB15 B1F1              ACALL    _bit_xor
B1:00CB17 78EE              MOV      R0,#LOW mac
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 355


B1:00CB19 7C3B              MOV      R4,#HIGH mac
B1:00CB1B 12FD04            LCALL    ?L?COM03E5
B1:00CB1E 71A3              ACALL    ?L?COM0286
B1:00CB20 121F56            LCALL    ?C?COPY
B1:00CB23 903BFE            MOV      DPTR,#mac_len
B1:00CB26 A3                INC      DPTR
B1:00CB27 E0                MOVX     A,@DPTR
B1:00CB28 FF                MOV      R7,A
B1:00CB29 C007              PUSH     AR7
B1:00CB2B 71AA              ACALL    ?L?COM016F
B1:00CB2D FD                MOV      R5,A
B1:00CB2E EE                MOV      A,R6
B1:00CB2F 9400              SUBB     A,#00H
B1:00CB31 FC                MOV      R4,A
B1:00CB32 903BBB            MOV      DPTR,#nonce
B1:00CB35 122552            LCALL    ?C?PLDXDATA
B1:00CB38 9040DE            MOV      DPTR,#?_format_b0?BYTE+06H
B1:00CB3B 71A0              ACALL    ?L?COM0285
B1:00CB3D D007              POP      AR7
B1:00CB3F 31A7              ACALL    _format_b0
B1:00CB41 903BB8            MOV      DPTR,#key
B1:00CB44 F156              ACALL    ?L?COM012A
B1:00CB46 71A3              ACALL    ?L?COM0286
B1:00CB48 12E43A            LCALL    _ciph_block
B1:00CB4B 903BBE            MOV      DPTR,#aad
B1:00CB4E 12FD91            LCALL    ?L?COM04BB
B1:00CB51 903BC1            MOV      DPTR,#aad_len
B1:00CB54 12FD88            LCALL    ?L?COM04BA
B1:00CB57 12FCD3            LCALL    ?L?COM037E
B1:00CB5A 90404F            MOV      DPTR,#?_format_aad?BYTE+0AH
B1:00CB5D 71A0              ACALL    ?L?COM0285
B1:00CB5F 71B9              ACALL    _format_aad
B1:00CB61 EF                MOV      A,R7
B1:00CB62 4E                ORL      A,R6
B1:00CB63 7003              JNZ      ?C0050?CCM
B1:00CB65 FE                MOV      R6,A
B1:00CB66 FF                MOV      R7,A
B1:00CB67 22                RET      
B1:00CB68         ?C0050?CCM:
B1:00CB68 903BC5            MOV      DPTR,#cipher_plaintext
B1:00CB6B 12FD7F            LCALL    ?L?COM04B9
B1:00CB6E 71AA              ACALL    ?L?COM016F
B1:00CB70 FF                MOV      R7,A
B1:00CB71 EE                MOV      A,R6
B1:00CB72 9400              SUBB     A,#00H
B1:00CB74 904102            MOV      DPTR,#?_format_payload_block?BYTE+06H
B1:00CB77 12FCCF            LCALL    ?L?COM037D
B1:00CB7A 904104            MOV      DPTR,#?_format_payload_block?BYTE+08H
B1:00CB7D 71A0              ACALL    ?L?COM0285
B1:00CB7F D131              ACALL    _format_payload_block
B1:00CB81 78CC              MOV      R0,#LOW blocks
B1:00CB83 7C3B              MOV      R4,#HIGH blocks
B1:00CB85 12FD04            LCALL    ?L?COM03E5
B1:00CB88 7B01              MOV      R3,#01H
B1:00CB8A 7A3B              MOV      R2,#HIGH mac
B1:00CB8C 79EE              MOV      R1,#LOW mac
B1:00CB8E 1228BC            LCALL    ?C?MEMCMP
B1:00CB91 EF                MOV      A,R7
B1:00CB92 6004              JZ       ?C0051?CCM
B1:00CB94         
B1:00CB94 E4                CLR      A
B1:00CB95 FE                MOV      R6,A
B1:00CB96 FF                MOV      R7,A
B1:00CB97 22                RET      
B1:00CB98         ?C0051?CCM:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 356


B1:00CB98 71AA              ACALL    ?L?COM016F
B1:00CB9A FF                MOV      R7,A
B1:00CB9B EE                MOV      A,R6
B1:00CB9C 9400              SUBB     A,#00H
B1:00CB9E FE                MOV      R6,A
B1:00CB9F 22                RET      
----- FUNCTION _CCM_decrypt_and_auth (END) -------


----- FUNCTION ?L?COM0285 (BEGIN) -----
B1:00CBA0 122572            LCALL    ?C?PSTXDATA
B1:00CBA3         ?L?COM0286:
B1:00CBA3 7B01              MOV      R3,#01H
B1:00CBA5 7A3B              MOV      R2,#HIGH blocks
B1:00CBA7 79CC              MOV      R1,#LOW blocks
B1:00CBA9 22                RET      
----- FUNCTION ?L?COM0285 (END) -------


----- FUNCTION ?L?COM016F (BEGIN) -----
B1:00CBAA 903BC8            MOV      DPTR,#ciphertext_len
B1:00CBAD 122462            LCALL    ?C?LLDXDATA
B1:00CBB0 904608            MOV      DPTR,#t
B1:00CBB3 E0                MOVX     A,@DPTR
B1:00CBB4 FD                MOV      R5,A
B1:00CBB5 C3                CLR      C
B1:00CBB6 EF                MOV      A,R7
B1:00CBB7 9D                SUBB     A,R5
B1:00CBB8 22                RET      
----- FUNCTION ?L?COM016F (END) -------


----- FUNCTION _format_aad (BEGIN) -----
B1:00CBB9 904045            MOV      DPTR,#blocks
B1:00CBBC 122572            LCALL    ?C?PSTXDATA
B1:00CBBF E4                CLR      A
B1:00CBC0 904056            MOV      DPTR,#new_aad_len
B1:00CBC3 126F69            LCALL    ?L?COM0404
B1:00CBC6 90405C            MOV      DPTR,#aad_start
B1:00CBC9 F0                MOVX     @DPTR,A
B1:00CBCA A3                INC      DPTR
B1:00CBCB 7402              MOV      A,#02H
B1:00CBCD F0                MOVX     @DPTR,A
B1:00CBCE 12FCBF            LCALL    ?L?COM0159
B1:00CBD1 5017              JNC      ?C0014?CCM
B1:00CBD3 B1EB              ACALL    ?L?COM0357
B1:00CBD5 900010            MOV      DPTR,#010H
B1:00CBD8 E4                CLR      A
B1:00CBD9 12204D            LCALL    ?C?CSTOPTR
B1:00CBDC F175              ACALL    ?L?COM03E7
B1:00CBDE 900011            MOV      DPTR,#011H
B1:00CBE1 EF                MOV      A,R7
B1:00CBE2 12FD18            LCALL    ?L?COM04BF
B1:00CBE5 740E              MOV      A,#0EH
B1:00CBE7 F0                MOVX     @DPTR,A
B1:00CBE8 804D              SJMP     ?C0015?CCM
B1:00CBEA         ?C0014?CCM:
B1:00CBEA 12FCBF            LCALL    ?L?COM0159
B1:00CBED 4044              JC       ?C0016?CCM
B1:00CBEF 74FF              MOV      A,#0FFH
B1:00CBF1 FF                MOV      R7,A
B1:00CBF2 FE                MOV      R6,A
B1:00CBF3 12FD49            LCALL    ?L?COM0328
B1:00CBF6 503B              JNC      ?C0016?CCM
B1:00CBF8 B1EB              ACALL    ?L?COM0357
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 357


B1:00CBFA 900010            MOV      DPTR,#010H
B1:00CBFD 74FF              MOV      A,#0FFH
B1:00CBFF 12204D            LCALL    ?C?CSTOPTR
B1:00CC02 900011            MOV      DPTR,#011H
B1:00CC05 74FE              MOV      A,#0FEH
B1:00CC07 12204D            LCALL    ?C?CSTOPTR
B1:00CC0A 900012            MOV      DPTR,#012H
B1:00CC0D E4                CLR      A
B1:00CC0E 12204D            LCALL    ?C?CSTOPTR
B1:00CC11 900013            MOV      DPTR,#013H
B1:00CC14 7401              MOV      A,#01H
B1:00CC16 12204D            LCALL    ?C?CSTOPTR
B1:00CC19 900014            MOV      DPTR,#014H
B1:00CC1C E4                CLR      A
B1:00CC1D 12204D            LCALL    ?C?CSTOPTR
B1:00CC20 900015            MOV      DPTR,#015H
B1:00CC23 E4                CLR      A
B1:00CC24 12FD18            LCALL    ?L?COM04BF
B1:00CC27 740A              MOV      A,#0AH
B1:00CC29 F0                MOVX     @DPTR,A
B1:00CC2A A3                INC      DPTR
B1:00CC2B E4                CLR      A
B1:00CC2C F0                MOVX     @DPTR,A
B1:00CC2D A3                INC      DPTR
B1:00CC2E 7406              MOV      A,#06H
B1:00CC30 F0                MOVX     @DPTR,A
B1:00CC31 8004              SJMP     ?C0015?CCM
B1:00CC33         ?C0016?CCM:
B1:00CC33 E4                CLR      A
B1:00CC34 FE                MOV      R6,A
B1:00CC35 FF                MOV      R7,A
B1:00CC36 22                RET      
B1:00CC37         ?C0015?CCM:
B1:00CC37 12FCD9            LCALL    ?L?COM03A7
B1:00CC3A 904045            MOV      DPTR,#blocks
B1:00CC3D B1E1              ACALL    ?L?COM0083
B1:00CC3F FA                MOV      R2,A
B1:00CC40 90405C            MOV      DPTR,#aad_start
B1:00CC43 126E37            LCALL    ?L?COM01E7
B1:00CC46 A801              MOV      R0,AR1
B1:00CC48 FC                MOV      R4,A
B1:00CC49 AD03              MOV      R5,AR3
B1:00CC4B F17B              ACALL    ?L?COM047A
B1:00CC4D 121F56            LCALL    ?C?COPY
B1:00CC50 12FCD9            LCALL    ?L?COM03A7
B1:00CC53 EE                MOV      A,R6
B1:00CC54 33                RLC      A
B1:00CC55 95E0              SUBB     A,ACC
B1:00CC57 12FCC3            LCALL    ?L?COM015A
B1:00CC5A 5033              JNC      ?C0019?CCM
B1:00CC5C F175              ACALL    ?L?COM03E7
B1:00CC5E C3                CLR      C
B1:00CC5F 90405B            MOV      DPTR,#aad_bytes_in_first_block+01H
B1:00CC62 E0                MOVX     A,@DPTR
B1:00CC63 9F                SUBB     A,R7
B1:00CC64 FF                MOV      R7,A
B1:00CC65 90405A            MOV      DPTR,#aad_bytes_in_first_block
B1:00CC68 E0                MOVX     A,@DPTR
B1:00CC69 9E                SUBB     A,R6
B1:00CC6A FE                MOV      R6,A
B1:00CC6B C006              PUSH     AR6
B1:00CC6D C007              PUSH     AR7
B1:00CC6F 7F00              MOV      R7,#00H
B1:00CC71 C007              PUSH     AR7
B1:00CC73 904045            MOV      DPTR,#blocks
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 358


B1:00CC76 B1E1              ACALL    ?L?COM0083
B1:00CC78 FA                MOV      R2,A
B1:00CC79 90405C            MOV      DPTR,#aad_start
B1:00CC7C 126E51            LCALL    ?L?COM0252
B1:00CC7F F175              ACALL    ?L?COM03E7
B1:00CC81 12E59B            LCALL    ?L?COM007A
B1:00CC84 EB                MOV      A,R3
B1:00CC85 3D                ADDC     A,R5
B1:00CC86 FB                MOV      R3,A
B1:00CC87 D005              POP      AR5
B1:00CC89 D007              POP      AR7
B1:00CC8B D006              POP      AR6
B1:00CC8D A167              AJMP     ?C0061?CCM
B1:00CC8F         ?C0019?CCM:
B1:00CC8F 12FCD9            LCALL    ?L?COM03A7
B1:00CC92 EE                MOV      A,R6
B1:00CC93 33                RLC      A
B1:00CC94 95E0              SUBB     A,ACC
B1:00CC96 12FD49            LCALL    ?L?COM0328
B1:00CC99 5002              JNC      $ + 4H
B1:00CC9B A1BE              AJMP     ?C0021?CCM
B1:00CC9D 904045            MOV      DPTR,#blocks
B1:00CCA0 B1E1              ACALL    ?L?COM0083
B1:00CCA2 FA                MOV      R2,A
B1:00CCA3 C003              PUSH     AR3
B1:00CCA5 C002              PUSH     AR2
B1:00CCA7 C001              PUSH     AR1
B1:00CCA9 F15F              ACALL    ?L?COM00CA
B1:00CCAB D001              POP      AR1
B1:00CCAD D002              POP      AR2
B1:00CCAF D003              POP      AR3
B1:00CCB1 F151              ACALL    ?L?COM0129
B1:00CCB3 B1EB              ACALL    ?L?COM0357
B1:00CCB5 12E43A            LCALL    _ciph_block
B1:00CCB8 F175              ACALL    ?L?COM03E7
B1:00CCBA 90405A            MOV      DPTR,#aad_bytes_in_first_block
B1:00CCBD F182              ACALL    ?L?COM0327
B1:00CCBF 904056            MOV      DPTR,#new_aad_len
B1:00CCC2 127002            LCALL    ?L?COM049F
B1:00CCC5 12FD55            LCALL    ?L?COM0219
B1:00CCC8 A3                INC      DPTR
B1:00CCC9 EE                MOV      A,R6
B1:00CCCA F0                MOVX     @DPTR,A
B1:00CCCB A3                INC      DPTR
B1:00CCCC EF                MOV      A,R7
B1:00CCCD F0                MOVX     @DPTR,A
B1:00CCCE 12FD2C            LCALL    ?L?COM0407
B1:00CCD1 ED                MOV      A,R5
B1:00CCD2 4C                ORL      A,R4
B1:00CCD3 600A              JZ       ?C0022?CCM
B1:00CCD5 904058            MOV      DPTR,#no_of_blocks_for_aad
B1:00CCD8 E4                CLR      A
B1:00CCD9 75F001            MOV      B,#01H
B1:00CCDC 12210C            LCALL    ?C?IILDX
B1:00CCDF         ?C0022?CCM:
B1:00CCDF 90405A            MOV      DPTR,#aad_bytes_in_first_block
B1:00CCE2 E0                MOVX     A,@DPTR
B1:00CCE3 FF                MOV      R7,A
B1:00CCE4 A3                INC      DPTR
B1:00CCE5 E0                MOVX     A,@DPTR
B1:00CCE6 904054            MOV      DPTR,#offset
B1:00CCE9 1247CE            LCALL    ?L?COM04BE
B1:00CCEC 904052            MOV      DPTR,#i
B1:00CCEF F0                MOVX     @DPTR,A
B1:00CCF0 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 359


B1:00CCF1 F0                MOVX     @DPTR,A
B1:00CCF2         ?C0023?CCM:
B1:00CCF2 904058            MOV      DPTR,#no_of_blocks_for_aad
B1:00CCF5 E0                MOVX     A,@DPTR
B1:00CCF6 FE                MOV      R6,A
B1:00CCF7 A3                INC      DPTR
B1:00CCF8 E0                MOVX     A,@DPTR
B1:00CCF9 904052            MOV      DPTR,#i
B1:00CCFC F181              ACALL    ?L?COM0326
B1:00CCFE F18B              ACALL    ?L?COM046E
B1:00CD00 4002              JC       $ + 4H
B1:00CD02 A1D9              AJMP     ?C0020?CCM
B1:00CD04 12FD37            LCALL    ?L?COM044A
B1:00CD07 7002              JNZ      ?C0055?CCM
B1:00CD09 EC                MOV      A,R4
B1:00CD0A 6E                XRL      A,R6
B1:00CD0B         ?C0055?CCM:
B1:00CD0B 705F              JNZ      ?C0026?CCM
B1:00CD0D 12FD55            LCALL    ?L?COM0219
B1:00CD10 ED                MOV      A,R5
B1:00CD11 4C                ORL      A,R4
B1:00CD12 6058              JZ       ?C0026?CCM
B1:00CD14 12FD2C            LCALL    ?L?COM0407
B1:00CD17 AE04              MOV      R6,AR4
B1:00CD19 AF05              MOV      R7,AR5
B1:00CD1B F17B              ACALL    ?L?COM047A
B1:00CD1D 904054            MOV      DPTR,#offset
B1:00CD20 126E37            LCALL    ?L?COM01E7
B1:00CD23 FA                MOV      R2,A
B1:00CD24 C003              PUSH     AR3
B1:00CD26 C002              PUSH     AR2
B1:00CD28 C001              PUSH     AR1
B1:00CD2A 904045            MOV      DPTR,#blocks
B1:00CD2D B1E1              ACALL    ?L?COM0083
B1:00CD2F A801              MOV      R0,AR1
B1:00CD31 FC                MOV      R4,A
B1:00CD32 AD03              MOV      R5,AR3
B1:00CD34 D001              POP      AR1
B1:00CD36 D002              POP      AR2
B1:00CD38 D003              POP      AR3
B1:00CD3A 121F56            LCALL    ?C?COPY
B1:00CD3D 904056            MOV      DPTR,#new_aad_len
B1:00CD40 E0                MOVX     A,@DPTR
B1:00CD41 FE                MOV      R6,A
B1:00CD42 A3                INC      DPTR
B1:00CD43 E0                MOVX     A,@DPTR
B1:00CD44 FF                MOV      R7,A
B1:00CD45 7C00              MOV      R4,#00H
B1:00CD47 7D10              MOV      R5,#010H
B1:00CD49 1220D6            LCALL    ?C?SIDIV
B1:00CD4C C3                CLR      C
B1:00CD4D 7410              MOV      A,#010H
B1:00CD4F 9D                SUBB     A,R5
B1:00CD50 FF                MOV      R7,A
B1:00CD51 E4                CLR      A
B1:00CD52 9C                SUBB     A,R4
B1:00CD53 FE                MOV      R6,A
B1:00CD54 C007              PUSH     AR7
B1:00CD56 7F00              MOV      R7,#00H
B1:00CD58 C007              PUSH     AR7
B1:00CD5A 904045            MOV      DPTR,#blocks
B1:00CD5D B1E1              ACALL    ?L?COM0083
B1:00CD5F 128E83            LCALL    ?L?COM03C8
B1:00CD62 FA                MOV      R2,A
B1:00CD63 D005              POP      AR5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 360


B1:00CD65 D007              POP      AR7
B1:00CD67         
B1:00CD67 1228E0            LCALL    ?C?MEMSET
B1:00CD6A 8052              SJMP     ?C0062?CCM
B1:00CD6C         ?C0026?CCM:
B1:00CD6C F17B              ACALL    ?L?COM047A
B1:00CD6E 904054            MOV      DPTR,#offset
B1:00CD71 126E51            LCALL    ?L?COM0252
B1:00CD74 C003              PUSH     AR3
B1:00CD76 C002              PUSH     AR2
B1:00CD78 C001              PUSH     AR1
B1:00CD7A 904045            MOV      DPTR,#blocks
B1:00CD7D B1E1              ACALL    ?L?COM0083
B1:00CD7F A801              MOV      R0,AR1
B1:00CD81 FC                MOV      R4,A
B1:00CD82 AD03              MOV      R5,AR3
B1:00CD84 D001              POP      AR1
B1:00CD86 D002              POP      AR2
B1:00CD88 D003              POP      AR3
B1:00CD8A 12DF7E            LCALL    ?L?COM0086
B1:00CD8D 904045            MOV      DPTR,#blocks
B1:00CD90 B1E1              ACALL    ?L?COM0083
B1:00CD92 FA                MOV      R2,A
B1:00CD93 C003              PUSH     AR3
B1:00CD95 C002              PUSH     AR2
B1:00CD97 C001              PUSH     AR1
B1:00CD99 F15F              ACALL    ?L?COM00CA
B1:00CD9B D001              POP      AR1
B1:00CD9D D002              POP      AR2
B1:00CD9F D003              POP      AR3
B1:00CDA1 F151              ACALL    ?L?COM0129
B1:00CDA3 B1EB              ACALL    ?L?COM0357
B1:00CDA5 12E43A            LCALL    _ciph_block
B1:00CDA8 904054            MOV      DPTR,#offset
B1:00CDAB E4                CLR      A
B1:00CDAC 75F010            MOV      B,#010H
B1:00CDAF 12210C            LCALL    ?C?IILDX
B1:00CDB2 904052            MOV      DPTR,#i
B1:00CDB5 E4                CLR      A
B1:00CDB6 75F001            MOV      B,#01H
B1:00CDB9 12210C            LCALL    ?C?IILDX
B1:00CDBC 81F2              AJMP     ?C0023?CCM
B1:00CDBE         ?C0021?CCM:
B1:00CDBE         
B1:00CDBE 904045            MOV      DPTR,#blocks
B1:00CDC1 B1E1              ACALL    ?L?COM0083
B1:00CDC3 FA                MOV      R2,A
B1:00CDC4 C003              PUSH     AR3
B1:00CDC6 C002              PUSH     AR2
B1:00CDC8 C001              PUSH     AR1
B1:00CDCA F15F              ACALL    ?L?COM00CA
B1:00CDCC D001              POP      AR1
B1:00CDCE D002              POP      AR2
B1:00CDD0 D003              POP      AR3
B1:00CDD2 F151              ACALL    ?L?COM0129
B1:00CDD4 B1EB              ACALL    ?L?COM0357
B1:00CDD6 12E43A            LCALL    _ciph_block
B1:00CDD9         ?C0020?CCM:
B1:00CDD9 7E00              MOV      R6,#00H
B1:00CDDB 7F01              MOV      R7,#01H
B1:00CDDD 22                RET      
----- FUNCTION _format_aad (END) -------


----- FUNCTION ?L?COM0082 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 361


B1:00CDDE 903DC9            MOV      DPTR,#nonce_pstring
B1:00CDE1         ?L?COM0083:
B1:00CDE1 122552            LCALL    ?C?PLDXDATA
B1:00CDE4 E9                MOV      A,R1
B1:00CDE5 2410              ADD      A,#010H
B1:00CDE7 F9                MOV      R1,A
B1:00CDE8 E4                CLR      A
B1:00CDE9 3A                ADDC     A,R2
B1:00CDEA 22                RET      
----- FUNCTION ?L?COM0082 (END) -------


----- FUNCTION ?L?COM0357 (BEGIN) -----
B1:00CDEB 904045            MOV      DPTR,#blocks
B1:00CDEE 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0357 (END) -------


----- FUNCTION _bit_xor (BEGIN) -----
B1:00CDF1 904352            MOV      DPTR,#block
;---- Variable 'i' assigned to Register 'R6/R7' ----
B1:00CDF4 127019            LCALL    ?L?COM04AB
B1:00CDF7         ?C0010?CCM:
B1:00CDF7 D3                SETB     C
B1:00CDF8 904359            MOV      DPTR,#size+01H
B1:00CDFB E0                MOVX     A,@DPTR
B1:00CDFC 9F                SUBB     A,R7
B1:00CDFD EE                MOV      A,R6
B1:00CDFE 6480              XRL      A,#080H
B1:00CE00 F8                MOV      R0,A
B1:00CE01 904358            MOV      DPTR,#size
B1:00CE04 E0                MOVX     A,@DPTR
B1:00CE05 6480              XRL      A,#080H
B1:00CE07 98                SUBB     A,R0
B1:00CE08 4026              JC       ?C0013?CCM
B1:00CE0A 904355            MOV      DPTR,#next_block
B1:00CE0D 12E19F            LCALL    ?L?COM0140
B1:00CE10 121FB9            LCALL    ?C?CLDOPTR
B1:00CE13 FD                MOV      R5,A
B1:00CE14 904352            MOV      DPTR,#block
B1:00CE17 12E19F            LCALL    ?L?COM0140
B1:00CE1A 121FB9            LCALL    ?C?CLDOPTR
B1:00CE1D 6D                XRL      A,R5
B1:00CE1E FD                MOV      R5,A
B1:00CE1F 904355            MOV      DPTR,#next_block
B1:00CE22 12E19F            LCALL    ?L?COM0140
B1:00CE25 ED                MOV      A,R5
B1:00CE26 12204D            LCALL    ?C?CSTOPTR
B1:00CE29 0F                INC      R7
B1:00CE2A BF0001            CJNE     R7,#00H,?C0054?CCM
B1:00CE2D 0E                INC      R6
B1:00CE2E         ?C0054?CCM:
B1:00CE2E 80C7              SJMP     ?C0010?CCM
B1:00CE30         ?C0013?CCM:
B1:00CE30 22                RET      
----- FUNCTION _bit_xor (END) -------


----- FUNCTION _format_payload_block (BEGIN) -----
B1:00CE31 9040FC            MOV      DPTR,#blocks
B1:00CE34 122572            LCALL    ?C?PSTXDATA
B1:00CE37 904102            MOV      DPTR,#text_to_encrypt_len
B1:00CE3A 12653F            LCALL    ?L?COM03C6
B1:00CE3D 126F95            LCALL    ?L?COM0430
B1:00CE40 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 362


B1:00CE41 ED                MOV      A,R5
B1:00CE42 C4                SWAP     A
B1:00CE43 540F              ANL      A,#0FH
B1:00CE45 48                ORL      A,R0
B1:00CE46 904109            MOV      DPTR,#no_blocks_payload
B1:00CE49 1247CE            LCALL    ?L?COM04BE
B1:00CE4C A3                INC      DPTR
B1:00CE4D F0                MOVX     @DPTR,A
B1:00CE4E A3                INC      DPTR
B1:00CE4F F0                MOVX     @DPTR,A
B1:00CE50 ED                MOV      A,R5
B1:00CE51 540F              ANL      A,#0FH
B1:00CE53 600A              JZ       ?C0028?CCM
B1:00CE55 904109            MOV      DPTR,#no_blocks_payload
B1:00CE58 E4                CLR      A
B1:00CE59 75F001            MOV      B,#01H
B1:00CE5C 12210C            LCALL    ?C?IILDX
B1:00CE5F         ?C0028?CCM:
B1:00CE5F E4                CLR      A
B1:00CE60 904107            MOV      DPTR,#i
B1:00CE63 F0                MOVX     @DPTR,A
B1:00CE64 A3                INC      DPTR
B1:00CE65 F0                MOVX     @DPTR,A
B1:00CE66         ?C0029?CCM:
B1:00CE66 904109            MOV      DPTR,#no_blocks_payload
B1:00CE69 E0                MOVX     A,@DPTR
B1:00CE6A FE                MOV      R6,A
B1:00CE6B A3                INC      DPTR
B1:00CE6C E0                MOVX     A,@DPTR
B1:00CE6D 904107            MOV      DPTR,#i
B1:00CE70 F181              ACALL    ?L?COM0326
B1:00CE72 F18B              ACALL    ?L?COM046E
B1:00CE74 4002              JC       $ + 4H
B1:00CE76 E150              AJMP     ?C0033?CCM
B1:00CE78 12FD37            LCALL    ?L?COM044A
B1:00CE7B 7002              JNZ      ?C0056?CCM
B1:00CE7D EC                MOV      A,R4
B1:00CE7E 6E                XRL      A,R6
B1:00CE7F         ?C0056?CCM:
B1:00CE7F 7073              JNZ      ?C0032?CCM
B1:00CE81 FE                MOV      R6,A
B1:00CE82 12FCEA            LCALL    ?L?COM0577
B1:00CE85 606D              JZ       ?C0032?CCM
B1:00CE87 12FD0E            LCALL    ?L?COM04BD
B1:00CE8A 126E37            LCALL    ?L?COM01E7
B1:00CE8D FA                MOV      R2,A
B1:00CE8E C003              PUSH     AR3
B1:00CE90 C002              PUSH     AR2
B1:00CE92 C001              PUSH     AR1
B1:00CE94 9040FC            MOV      DPTR,#blocks
B1:00CE97 B1E1              ACALL    ?L?COM0083
B1:00CE99 A801              MOV      R0,AR1
B1:00CE9B FC                MOV      R4,A
B1:00CE9C AD03              MOV      R5,AR3
B1:00CE9E D001              POP      AR1
B1:00CEA0 D002              POP      AR2
B1:00CEA2 D003              POP      AR3
B1:00CEA4 121F56            LCALL    ?C?COPY
B1:00CEA7 12FCEA            LCALL    ?L?COM0577
B1:00CEAA C3                CLR      C
B1:00CEAB 7410              MOV      A,#010H
B1:00CEAD 125A69            LCALL    ?L?COM03E6
B1:00CEB0 7D00              MOV      R5,#00H
B1:00CEB2 9040FC            MOV      DPTR,#blocks
B1:00CEB5 B1E1              ACALL    ?L?COM0083
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 363


B1:00CEB7 FA                MOV      R2,A
B1:00CEB8 904102            MOV      DPTR,#text_to_encrypt_len
B1:00CEBB E0                MOVX     A,@DPTR
B1:00CEBC F8                MOV      R0,A
B1:00CEBD A3                INC      DPTR
B1:00CEBE E0                MOVX     A,@DPTR
B1:00CEBF 758300            MOV      DPH,#00H
B1:00CEC2 540F              ANL      A,#0FH
B1:00CEC4 29                ADD      A,R1
B1:00CEC5 F9                MOV      R1,A
B1:00CEC6 E583              MOV      A,DPH
B1:00CEC8 3A                ADDC     A,R2
B1:00CEC9 FA                MOV      R2,A
B1:00CECA 1228E0            LCALL    ?C?MEMSET
B1:00CECD 9040FC            MOV      DPTR,#blocks
B1:00CED0 B1E1              ACALL    ?L?COM0083
B1:00CED2 FA                MOV      R2,A
B1:00CED3 C003              PUSH     AR3
B1:00CED5 C002              PUSH     AR2
B1:00CED7 C001              PUSH     AR1
B1:00CED9 9040FC            MOV      DPTR,#blocks
B1:00CEDC F162              ACALL    ?L?COM00CB
B1:00CEDE D001              POP      AR1
B1:00CEE0 D002              POP      AR2
B1:00CEE2 D003              POP      AR3
B1:00CEE4 B1F1              ACALL    _bit_xor
B1:00CEE6 904104            MOV      DPTR,#key
B1:00CEE9 F156              ACALL    ?L?COM012A
B1:00CEEB 9040FC            MOV      DPTR,#blocks
B1:00CEEE 122552            LCALL    ?C?PLDXDATA
B1:00CEF1 02E43A            LJMP     _ciph_block
B1:00CEF4         ?C0032?CCM:
B1:00CEF4 12FD0E            LCALL    ?L?COM04BD
B1:00CEF7 126E51            LCALL    ?L?COM0252
B1:00CEFA C003              PUSH     AR3
B1:00CEFC C002              PUSH     AR2
B1:00CEFE C001              PUSH     AR1
B1:00CF00 9040FC            MOV      DPTR,#blocks
B1:00CF03 B1E1              ACALL    ?L?COM0083
B1:00CF05 A801              MOV      R0,AR1
B1:00CF07 FC                MOV      R4,A
B1:00CF08 AD03              MOV      R5,AR3
B1:00CF0A D001              POP      AR1
B1:00CF0C D002              POP      AR2
B1:00CF0E D003              POP      AR3
B1:00CF10 12DF7E            LCALL    ?L?COM0086
B1:00CF13 9040FC            MOV      DPTR,#blocks
B1:00CF16 B1E1              ACALL    ?L?COM0083
B1:00CF18 FA                MOV      R2,A
B1:00CF19 C003              PUSH     AR3
B1:00CF1B C002              PUSH     AR2
B1:00CF1D C001              PUSH     AR1
B1:00CF1F 9040FC            MOV      DPTR,#blocks
B1:00CF22 F162              ACALL    ?L?COM00CB
B1:00CF24 D001              POP      AR1
B1:00CF26 D002              POP      AR2
B1:00CF28 D003              POP      AR3
B1:00CF2A B1F1              ACALL    _bit_xor
B1:00CF2C 904104            MOV      DPTR,#key
B1:00CF2F F156              ACALL    ?L?COM012A
B1:00CF31 9040FC            MOV      DPTR,#blocks
B1:00CF34 122552            LCALL    ?C?PLDXDATA
B1:00CF37 12E43A            LCALL    _ciph_block
B1:00CF3A 90410B            MOV      DPTR,#offset
B1:00CF3D E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 364


B1:00CF3E 75F010            MOV      B,#010H
B1:00CF41 12210C            LCALL    ?C?IILDX
B1:00CF44 904107            MOV      DPTR,#i
B1:00CF47 E4                CLR      A
B1:00CF48 75F001            MOV      B,#01H
B1:00CF4B 12210C            LCALL    ?C?IILDX
B1:00CF4E C166              AJMP     ?C0029?CCM
B1:00CF50         ?C0033?CCM:
B1:00CF50 22                RET      
----- FUNCTION _format_payload_block (END) -------


----- FUNCTION ?L?COM0129 (BEGIN) -----
B1:00CF51 B1F1              ACALL    _bit_xor
B1:00CF53 90404F            MOV      DPTR,#key
B1:00CF56         ?L?COM012A:
B1:00CF56 122552            LCALL    ?C?PLDXDATA
B1:00CF59 9044A0            MOV      DPTR,#?_ciph_block?BYTE+03H
B1:00CF5C 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0129 (END) -------


----- FUNCTION ?L?COM00CA (BEGIN) -----
B1:00CF5F 904045            MOV      DPTR,#blocks
B1:00CF62         ?L?COM00CB:
B1:00CF62 122552            LCALL    ?C?PLDXDATA
B1:00CF65 904355            MOV      DPTR,#?_bit_xor?BYTE+03H
B1:00CF68 122572            LCALL    ?C?PSTXDATA
B1:00CF6B 904358            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00CF6E         ?L?COM00CC:
B1:00CF6E E4                CLR      A
B1:00CF6F F0                MOVX     @DPTR,A
B1:00CF70 A3                INC      DPTR
B1:00CF71 7410              MOV      A,#010H
B1:00CF73 F0                MOVX     @DPTR,A
B1:00CF74 22                RET      
----- FUNCTION ?L?COM00CA (END) -------


----- FUNCTION ?L?COM03E7 (BEGIN) -----
B1:00CF75 90404B            MOV      DPTR,#aad_len
B1:00CF78 022462            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM03E7 (END) -------


----- FUNCTION ?L?COM047A (BEGIN) -----
B1:00CF7B 904048            MOV      DPTR,#aad
B1:00CF7E 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM047A (END) -------


----- FUNCTION ?L?COM0326 (BEGIN) -----
B1:00CF81 FF                MOV      R7,A
B1:00CF82         ?L?COM0327:
B1:00CF82 E0                MOVX     A,@DPTR
B1:00CF83 FC                MOV      R4,A
B1:00CF84 A3                INC      DPTR
B1:00CF85 E0                MOVX     A,@DPTR
B1:00CF86 FD                MOV      R5,A
B1:00CF87 C3                CLR      C
B1:00CF88 22                RET      
----- FUNCTION ?L?COM0326 (END) -------


----- FUNCTION _TxQueueReQueueElement (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 365


;---- Variable 'pElement' assigned to Register 'R1/R2/R3' ----
B1:00CF89 211F              AJMP     _TxQueueQueueElement
----- FUNCTION _TxQueueReQueueElement (END) -------


----- FUNCTION ?L?COM046E (BEGIN) -----
B1:00CF8B 9F                SUBB     A,R7
B1:00CF8C EE                MOV      A,R6
B1:00CF8D 6480              XRL      A,#080H
B1:00CF8F F8                MOV      R0,A
B1:00CF90 EC                MOV      A,R4
B1:00CF91 6480              XRL      A,#080H
B1:00CF93 98                SUBB     A,R0
B1:00CF94 22                RET      
----- FUNCTION ?L?COM046E (END) -------


----- FUNCTION _ReturnRouteGetSpeed (BEGIN) -----
;---- Variable 'bReturnSpeed' assigned to Register 'R7' ----
;---- Variable 'beamInfo' assigned to Register 'R6' ----
B1:00CF95 E4                CLR      A
B1:00CF96 FE                MOV      R6,A
B1:00CF97 EF                MOV      A,R7
B1:00CF98 30E205            JNB      ACC.2,?C0141?ZW_TRANSPORT
B1:00CF9B 7440              MOV      A,#040H
B1:00CF9D FE                MOV      R6,A
B1:00CF9E 8008              SJMP     ?C0142?ZW_TRANSPORT
B1:00CFA0         ?C0141?ZW_TRANSPORT:
B1:00CFA0 EF                MOV      A,R7
B1:00CFA1 30E104            JNB      ACC.1,?C0142?ZW_TRANSPORT
B1:00CFA4 EE                MOV      A,R6
B1:00CFA5 4420              ORL      A,#020H
B1:00CFA7 FE                MOV      R6,A
B1:00CFA8         ?C0142?ZW_TRANSPORT:
B1:00CFA8 EF                MOV      A,R7
B1:00CFA9 5438              ANL      A,#038H
B1:00CFAB 24F0              ADD      A,#0F0H
B1:00CFAD 6007              JZ       ?C0147?ZW_TRANSPORT
B1:00CFAF 24F0              ADD      A,#0F0H
B1:00CFB1 7008              JNZ      ?C0149?ZW_TRANSPORT
B1:00CFB3         ?C0145?ZW_TRANSPORT:
B1:00CFB3 7F03              MOV      R7,#03H
B1:00CFB5 22                RET      
B1:00CFB6         ?C0147?ZW_TRANSPORT:
B1:00CFB6 EE                MOV      A,R6
B1:00CFB7 4402              ORL      A,#02H
B1:00CFB9 FF                MOV      R7,A
B1:00CFBA 22                RET      
B1:00CFBB         ?C0149?ZW_TRANSPORT:
B1:00CFBB 7F01              MOV      R7,#01H
B1:00CFBD 22                RET      
----- FUNCTION _ReturnRouteGetSpeed (END) -------


----- FUNCTION TransmitReturnRouteSetup (BEGIN) -----
B1:00CFBE 90076A            MOV      DPTR,#activeTransmit+01H
B1:00CFC1 E0                MOVX     A,@DPTR
B1:00CFC2 F4                CPL      A
B1:00CFC3 7003              JNZ      $ + 5H
B1:00CFC5 02D086            LJMP     ?C0193?ZW_TRANSPORT
B1:00CFC8 12851B            LCALL    ?L?COM000C
B1:00CFCB 12D092            LCALL    ?L?COM035A
B1:00CFCE E55E              MOV      A,returnRoute
B1:00CFD0 12203B            LCALL    ?C?CSTPTR
B1:00CFD3 12851B            LCALL    ?L?COM000C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 366


B1:00CFD6 1252F2            LCALL    ?L?COM0020
B1:00CFD9 5418              ANL      A,#018H
;---- Variable 'tmpRFOptions' assigned to Register 'R5' ----
B1:00CFDB FD                MOV      R5,A
B1:00CFDC AF64              MOV      R7,returnRoute+06H
B1:00CFDE F195              ACALL    _ReturnRouteGetSpeed
B1:00CFE0 12851B            LCALL    ?L?COM000C
B1:00CFE3 125D39            LCALL    ?L?COM00E6
B1:00CFE6 E4                CLR      A
B1:00CFE7 8FF0              MOV      B,R7
B1:00CFE9 1221E8            LCALL    ?C?ISTPTR
B1:00CFEC 122138            LCALL    ?C?ILDPTR
B1:00CFEF FF                MOV      R7,A
B1:00CFF0 12D088            LCALL    ?L?COM023F
B1:00CFF3 E55F              MOV      A,returnRoute+01H
B1:00CFF5 540F              ANL      A,#0FH
B1:00CFF7 900AD9            MOV      DPTR,#bRepeaterCountInReturnRoute
B1:00CFFA F0                MOVX     @DPTR,A
B1:00CFFB 603A              JZ       ?C0194?ZW_TRANSPORT
B1:00CFFD E0                MOVX     A,@DPTR
B1:00CFFE FF                MOV      R7,A
B1:00CFFF 7404              MOV      A,#04H
B1:00D001 C3                CLR      C
B1:00D002 9F                SUBB     A,R7
B1:00D003 4032              JC       ?C0194?ZW_TRANSPORT
B1:00D005 900AD8            MOV      DPTR,#tmpFrameType
B1:00D008 7404              MOV      A,#04H
B1:00D00A 12851A            LCALL    ?L?COM000B
B1:00D00D 1287DF            LCALL    ?L?COM02B8
B1:00D010 C003              PUSH     AR3
B1:00D012 C002              PUSH     AR2
B1:00D014 C001              PUSH     AR1
B1:00D016 128FC2            LCALL    ?L?COM04CC
B1:00D019 1287B9            LCALL    ?L?COM003F
B1:00D01C D001              POP      AR1
B1:00D01E D002              POP      AR2
B1:00D020 D003              POP      AR3
B1:00D022 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00D025 900AD9            MOV      DPTR,#bRepeaterCountInReturnRoute
B1:00D028 E0                MOVX     A,@DPTR
B1:00D029 C4                SWAP     A
B1:00D02A 54F0              ANL      A,#0F0H
B1:00D02C FF                MOV      R7,A
B1:00D02D 12851B            LCALL    ?L?COM000C
B1:00D030 24BC              ADD      A,#0BCH
B1:00D032 1287AB            LCALL    ?L?COM0015
B1:00D035 8006              SJMP     ?C0195?ZW_TRANSPORT
B1:00D037         ?C0194?ZW_TRANSPORT:
B1:00D037 900AD8            MOV      DPTR,#tmpFrameType
B1:00D03A 7401              MOV      A,#01H
B1:00D03C F0                MOVX     @DPTR,A
B1:00D03D         ?C0195?ZW_TRANSPORT:
B1:00D03D 900AD8            MOV      DPTR,#tmpFrameType
B1:00D040 E0                MOVX     A,@DPTR
B1:00D041 6404              XRL      A,#04H
B1:00D043 7016              JNZ      ?C0196?ZW_TRANSPORT
B1:00D045 E0                MOVX     A,@DPTR
B1:00D046 FE                MOV      R6,A
B1:00D047 12851B            LCALL    ?L?COM000C
B1:00D04A 1252F2            LCALL    ?L?COM0020
B1:00D04D 5407              ANL      A,#07H
B1:00D04F 6402              XRL      A,#02H
B1:00D051 C3                CLR      C
B1:00D052 7001              JNZ      ?C0197?ZW_TRANSPORT
B1:00D054 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 367


B1:00D055         ?C0197?ZW_TRANSPORT:
B1:00D055         ?C0198?ZW_TRANSPORT:
B1:00D055 9222              MOV      ?IncSeqNo?BIT,C
B1:00D057 D223              SETB     ?IncSeqNo?BIT+01H
B1:00D059 8017              SJMP     ?C0597?ZW_TRANSPORT
B1:00D05B         ?C0196?ZW_TRANSPORT:
B1:00D05B 900AD8            MOV      DPTR,#tmpFrameType
B1:00D05E E0                MOVX     A,@DPTR
B1:00D05F FE                MOV      R6,A
B1:00D060 12851B            LCALL    ?L?COM000C
B1:00D063 1252F2            LCALL    ?L?COM0020
B1:00D066 5407              ANL      A,#07H
B1:00D068 6402              XRL      A,#02H
B1:00D06A C3                CLR      C
B1:00D06B 7001              JNZ      ?C0200?ZW_TRANSPORT
B1:00D06D D3                SETB     C
B1:00D06E         ?C0200?ZW_TRANSPORT:
B1:00D06E         ?C0201?ZW_TRANSPORT:
B1:00D06E 9222              MOV      ?IncSeqNo?BIT,C
B1:00D070 C223              CLR      ?IncSeqNo?BIT+01H
B1:00D072         
B1:00D072 12C74A            LCALL    IncSeqNo
B1:00D075 EE                MOV      A,R6
B1:00D076 4F                ORL      A,R7
B1:00D077 900AD8            MOV      DPTR,#tmpFrameType
B1:00D07A F0                MOVX     @DPTR,A
B1:00D07B         ?C0199?ZW_TRANSPORT:
B1:00D07B D208              SETB     currentSeqNoUseTX
B1:00D07D 900AD8            MOV      DPTR,#tmpFrameType
B1:00D080 E0                MOVX     A,@DPTR
B1:00D081 12A004            LCALL    ?L?COM0200
B1:00D084 D3                SETB     C
B1:00D085 22                RET      
B1:00D086         ?C0193?ZW_TRANSPORT:
B1:00D086 C3                CLR      C
B1:00D087 22                RET      
----- FUNCTION TransmitReturnRouteSetup (END) -------


----- FUNCTION ?L?COM023F (BEGIN) -----
B1:00D088 EF                MOV      A,R7
B1:00D089 4D                ORL      A,R5
B1:00D08A         ?L?COM0240:
B1:00D08A FF                MOV      R7,A
B1:00D08B         ?L?COM0241:
B1:00D08B E5F0              MOV      A,B
B1:00D08D 8FF0              MOV      B,R7
B1:00D08F 0221E8            LJMP     ?C?ISTPTR
----- FUNCTION ?L?COM023F (END) -------


----- FUNCTION ?L?COM035A (BEGIN) -----
B1:00D092 24BA              ADD      A,#0BAH
B1:00D094 F9                MOV      R1,A
B1:00D095 E4                CLR      A
B1:00D096 3A                ADDC     A,R2
B1:00D097 FA                MOV      R2,A
B1:00D098 22                RET      
----- FUNCTION ?L?COM035A (END) -------


----- FUNCTION _SendMulticastFrame (BEGIN) -----
B1:00D099 9041F0            MOV      DPTR,#speed
B1:00D09C 126563            LCALL    ?L?COM00E9
B1:00D09F 128349            LCALL    ?L?COM0431
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 368


B1:00D0A2 9041F9            MOV      DPTR,#pFreeTxElement
B1:00D0A5 3134              ACALL    ?L?COM0287
B1:00D0A7 604F              JZ       ?C0001?ZW_TRANSPORT_MULTI
B1:00D0A9 9041F1            MOV      DPTR,#bSrcNodeID
B1:00D0AC E0                MOVX     A,@DPTR
B1:00D0AD FF                MOV      R7,A
B1:00D0AE 11FB              ACALL    ?L?COM0589
B1:00D0B0 24B6              ADD      A,#0B6H
B1:00D0B2 1287AB            LCALL    ?L?COM0015
B1:00D0B5 E4                CLR      A
B1:00D0B6 900769            MOV      DPTR,#activeTransmit
B1:00D0B9 F0                MOVX     @DPTR,A
B1:00D0BA 9041F0            MOV      DPTR,#speed
B1:00D0BD 7402              MOV      A,#02H
B1:00D0BF F0                MOVX     @DPTR,A
B1:00D0C0 9041F2            MOV      DPTR,#txOptions
B1:00D0C3 E0                MOVX     A,@DPTR
B1:00D0C4 FF                MOV      R7,A
B1:00D0C5 30E11E            JNB      ACC.1,?C0002?ZW_TRANSPORT_MULTI
B1:00D0C8 11FB              ACALL    ?L?COM0589
B1:00D0CA 1192              ACALL    ?L?COM035A
B1:00D0CC 74FF              MOV      A,#0FFH
B1:00D0CE 12203B            LCALL    ?C?CSTPTR
B1:00D0D1 EF                MOV      A,R7
B1:00D0D2 54FC              ANL      A,#0FCH
B1:00D0D4 9041F2            MOV      DPTR,#txOptions
B1:00D0D7 F0                MOVX     @DPTR,A
B1:00D0D8 FE                MOV      R6,A
B1:00D0D9 904264            MOV      DPTR,#bMultiTxOptions
B1:00D0DC E0                MOVX     A,@DPTR
B1:00D0DD 54FD              ANL      A,#0FDH
B1:00D0DF F0                MOVX     @DPTR,A
B1:00D0E0 3103              ACALL    ?L?COM016B
B1:00D0E2 7D01              MOV      R5,#01H
B1:00D0E4 800C              SJMP     ?C0018?ZW_TRANSPORT_MULTI
B1:00D0E6         ?C0002?ZW_TRANSPORT_MULTI:
B1:00D0E6 9041F2            MOV      DPTR,#txOptions
B1:00D0E9 E0                MOVX     A,@DPTR
B1:00D0EA 54FE              ANL      A,#0FEH
B1:00D0EC F0                MOVX     @DPTR,A
B1:00D0ED FE                MOV      R6,A
B1:00D0EE 3103              ACALL    ?L?COM016B
B1:00D0F0 7D02              MOV      R5,#02H
B1:00D0F2         
B1:00D0F2 12C7A3            LCALL    _EnQueueCommon
B1:00D0F5         ?C0003?ZW_TRANSPORT_MULTI:
B1:00D0F5 7F01              MOV      R7,#01H
B1:00D0F7 22                RET      
B1:00D0F8         ?C0001?ZW_TRANSPORT_MULTI:
B1:00D0F8 7F00              MOV      R7,#00H
B1:00D0FA 22                RET      
----- FUNCTION _SendMulticastFrame (END) -------


----- FUNCTION ?L?COM0589 (BEGIN) -----
B1:00D0FB 9041F9            MOV      DPTR,#pFreeTxElement
B1:00D0FE 122552            LCALL    ?C?PLDXDATA
B1:00D101 E9                MOV      A,R1
B1:00D102 22                RET      
----- FUNCTION ?L?COM0589 (END) -------


----- FUNCTION ?L?COM016B (BEGIN) -----
B1:00D103 9041F0            MOV      DPTR,#speed
B1:00D106 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 369


B1:00D107 FF                MOV      R7,A
B1:00D108 9041F6            MOV      DPTR,#dataLength
B1:00D10B E0                MOVX     A,@DPTR
B1:00D10C 900A19            MOV      DPTR,#?_EnQueueCommon?BYTE+05H
B1:00D10F F0                MOVX     @DPTR,A
B1:00D110 A3                INC      DPTR
B1:00D111 EE                MOV      A,R6
B1:00D112 F0                MOVX     @DPTR,A
B1:00D113 9041F7            MOV      DPTR,#completedFunc
B1:00D116 E0                MOVX     A,@DPTR
B1:00D117 FD                MOV      R5,A
B1:00D118 A3                INC      DPTR
B1:00D119 E0                MOVX     A,@DPTR
B1:00D11A 900A1B            MOV      DPTR,#?_EnQueueCommon?BYTE+07H
B1:00D11D CD                XCH      A,R5
B1:00D11E F0                MOVX     @DPTR,A
B1:00D11F A3                INC      DPTR
B1:00D120 ED                MOV      A,R5
B1:00D121 F0                MOVX     @DPTR,A
B1:00D122 9041F9            MOV      DPTR,#pFreeTxElement
B1:00D125 122552            LCALL    ?C?PLDXDATA
B1:00D128 900A1D            MOV      DPTR,#?_EnQueueCommon?BYTE+09H
B1:00D12B 122572            LCALL    ?C?PSTXDATA
B1:00D12E 9041F3            MOV      DPTR,#pData
B1:00D131 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM016B (END) -------


----- FUNCTION ?L?COM0287 (BEGIN) -----
B1:00D134 122572            LCALL    ?C?PSTXDATA
B1:00D137 EA                MOV      A,R2
B1:00D138 49                ORL      A,R1
B1:00D139 4B                ORL      A,R3
B1:00D13A 22                RET      
----- FUNCTION ?L?COM0287 (END) -------


----- FUNCTION _EnQueueSingleData (BEGIN) -----
B1:00D13B 9009EC            MOV      DPTR,#rfSpeed
B1:00D13E 126563            LCALL    ?L?COM00E9
B1:00D141 128349            LCALL    ?L?COM0431
B1:00D144 9009F7            MOV      DPTR,#pFreeTxElement
B1:00D147 3134              ACALL    ?L?COM0287
B1:00D149 6051              JZ       ?C0151?ZW_TRANSPORT
B1:00D14B 12593A            LCALL    getTickTime
B1:00D14E 9009F7            MOV      DPTR,#pFreeTxElement
B1:00D151 12C947            LCALL    ?L?COM00B7
B1:00D154 9009F7            MOV      DPTR,#pFreeTxElement
B1:00D157 F168              ACALL    ?L?COM0460
B1:00D159 31A7              ACALL    ?L?COM00E3
B1:00D15B 9009EC            MOV      DPTR,#rfSpeed
B1:00D15E E0                MOVX     A,@DPTR
B1:00D15F FF                MOV      R7,A
B1:00D160 A3                INC      DPTR
B1:00D161 E0                MOVX     A,@DPTR
B1:00D162 FD                MOV      R5,A
B1:00D163 9009EF            MOV      DPTR,#pData
B1:00D166 122552            LCALL    ?C?PLDXDATA
B1:00D169 D1FC              ACALL    ?L?COM0354
B1:00D16B 9009F2            MOV      DPTR,#dataLength
B1:00D16E E0                MOVX     A,@DPTR
B1:00D16F 9009C7            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+06H
B1:00D172 F0                MOVX     @DPTR,A
B1:00D173 9009F3            MOV      DPTR,#txOptions
B1:00D176 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 370


B1:00D177 9009C8            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+07H
B1:00D17A F0                MOVX     @DPTR,A
B1:00D17B 9009F4            MOV      DPTR,#txOptions1
B1:00D17E E0                MOVX     A,@DPTR
B1:00D17F 9009C9            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:00D182 F0                MOVX     @DPTR,A
B1:00D183 9009F5            MOV      DPTR,#completedFunc
B1:00D186 12FDA7            LCALL    ?L?COM03F4
B1:00D189 9009F7            MOV      DPTR,#pFreeTxElement
B1:00D18C F17E              ACALL    ?L?COM027B
B1:00D18E 9009EE            MOV      DPTR,#destNodeID
B1:00D191 E0                MOVX     A,@DPTR
B1:00D192 FB                MOV      R3,A
B1:00D193 12912A            LCALL    _EnqueueSingleDataPtr
B1:00D196 EF                MOV      A,R7
B1:00D197 6003              JZ       ?C0151?ZW_TRANSPORT
B1:00D199 7F01              MOV      R7,#01H
B1:00D19B 22                RET      
B1:00D19C         ?C0151?ZW_TRANSPORT:
B1:00D19C D1F7              ACALL    CleanUpAfterFailedTxElemAlloc
B1:00D19E 7F00              MOV      R7,#00H
B1:00D1A0 22                RET      
----- FUNCTION _EnQueueSingleData (END) -------


----- FUNCTION ?L?COM00E1 (BEGIN) -----
B1:00D1A1 122552            LCALL    ?C?PLDXDATA
B1:00D1A4 E9                MOV      A,R1
B1:00D1A5         ?L?COM00E2:
B1:00D1A5 24B1              ADD      A,#0B1H
B1:00D1A7         ?L?COM00E3:
B1:00D1A7 F9                MOV      R1,A
B1:00D1A8 E4                CLR      A
B1:00D1A9 3A                ADDC     A,R2
B1:00D1AA FA                MOV      R2,A
B1:00D1AB E4                CLR      A
B1:00D1AC 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM00E1 (END) -------


----- FUNCTION _ZW_SendNodeInformation (BEGIN) -----
B1:00D1AF 904566            MOV      DPTR,#destNode
B1:00D1B2 126563            LCALL    ?L?COM00E9
B1:00D1B5 EA                MOV      A,R2
B1:00D1B6 F0                MOVX     @DPTR,A
B1:00D1B7 A3                INC      DPTR
B1:00D1B8 EB                MOV      A,R3
B1:00D1B9 F0                MOVX     @DPTR,A
B1:00D1BA 7B01              MOV      R3,#01H
B1:00D1BC 7A33              MOV      R2,#HIGH slaveFrameBuffer
B1:00D1BE 79AC              MOV      R1,#LOW slaveFrameBuffer
B1:00D1C0 12F12A            LCALL    _GenerateNodeInformation
B1:00D1C3 904567            MOV      DPTR,#txOptions
B1:00D1C6 E0                MOVX     A,@DPTR
B1:00D1C7 5437              ANL      A,#037H
B1:00D1C9 F0                MOVX     @DPTR,A
B1:00D1CA 30E502            JNB      ACC.5,?C0049?ZW_SLAVE
B1:00D1CD D20A              SETB     bUseExploreAsRouteResolution
B1:00D1CF         ?C0049?ZW_SLAVE:
B1:00D1CF 904567            MOV      DPTR,#txOptions
B1:00D1D2 E0                MOVX     A,@DPTR
B1:00D1D3 54DF              ANL      A,#0DFH
B1:00D1D5 F0                MOVX     @DPTR,A
B1:00D1D6 300515            JNB      forceUse40K,?C0050?ZW_SLAVE
B1:00D1D9 C205              CLR      forceUse40K
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 371


B1:00D1DB 5119              ACALL    ?L?COM0060
B1:00D1DD 5102              ACALL    ?L?COM0262
B1:00D1DF F0                MOVX     @DPTR,A
B1:00D1E0 904568            MOV      DPTR,#completedFunc
B1:00D1E3 912D              ACALL    ?L?COM03EC
B1:00D1E5 904566            MOV      DPTR,#destNode
B1:00D1E8 E0                MOVX     A,@DPTR
B1:00D1E9 FB                MOV      R3,A
B1:00D1EA 7F02              MOV      R7,#02H
B1:00D1EC 8012              SJMP     ?C0306?ZW_SLAVE
B1:00D1EE         ?C0050?ZW_SLAVE:
B1:00D1EE 904566            MOV      DPTR,#destNode
B1:00D1F1 5115              ACALL    ?L?COM005F
B1:00D1F3 5102              ACALL    ?L?COM0262
B1:00D1F5 F0                MOVX     @DPTR,A
B1:00D1F6 904568            MOV      DPTR,#completedFunc
B1:00D1F9 7142              ACALL    ?L?COM03F2
B1:00D1FB 904566            MOV      DPTR,#destNode
B1:00D1FE E0                MOVX     A,@DPTR
B1:00D1FF FB                MOV      R3,A
B1:00D200         
B1:00D200 213B              AJMP     _EnQueueSingleData
----- FUNCTION _ZW_SendNodeInformation (END) -------


----- FUNCTION ?L?COM0262 (BEGIN) -----
B1:00D202 9033D6            MOV      DPTR,#blnodeInfoLength
B1:00D205 E0                MOVX     A,@DPTR
B1:00D206 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00D209 F0                MOVX     @DPTR,A
B1:00D20A 904567            MOV      DPTR,#txOptions
B1:00D20D         ?L?COM0263:
B1:00D20D E0                MOVX     A,@DPTR
B1:00D20E 9009F3            MOV      DPTR,#?_EnQueueSingleData?BYTE+07H
B1:00D211 F0                MOVX     @DPTR,A
B1:00D212 E4                CLR      A
B1:00D213 A3                INC      DPTR
B1:00D214 22                RET      
----- FUNCTION ?L?COM0262 (END) -------


----- FUNCTION ?L?COM005F (BEGIN) -----
B1:00D215 E0                MOVX     A,@DPTR
B1:00D216 FF                MOV      R7,A
B1:00D217 512A              ACALL    _ChooseSpeedForDestination_slave
B1:00D219         ?L?COM0060:
B1:00D219 901221            MOV      DPTR,#nodeID
B1:00D21C E0                MOVX     A,@DPTR
B1:00D21D FD                MOV      R5,A
B1:00D21E         ?L?COM0061:
B1:00D21E 7B01              MOV      R3,#01H
B1:00D220 7A33              MOV      R2,#HIGH slaveFrameBuffer
B1:00D222 79AC              MOV      R1,#LOW slaveFrameBuffer
B1:00D224         ?L?COM0062:
B1:00D224 9009EF            MOV      DPTR,#?_EnQueueSingleData?BYTE+03H
B1:00D227 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM005F (END) -------


----- FUNCTION _ChooseSpeedForDestination_slave (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
;---- Variable 'idx' assigned to Register 'R6' ----
B1:00D22A E4                CLR      A
B1:00D22B FE                MOV      R6,A
B1:00D22C         ?C0363?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 372


B1:00D22C EE                MOV      A,R6
B1:00D22D 12FD9A            LCALL    ?L?COM03F3
B1:00D230 B5070F            CJNE     A,AR7,?C0365?ZW_TRANSPORT
B1:00D233 EE                MOV      A,R6
B1:00D234 25E0              ADD      A,ACC
B1:00D236 2482              ADD      A,#LOW abDirectNodesResponseSpeed+01H
B1:00D238 F582              MOV      DPL,A
B1:00D23A E4                CLR      A
B1:00D23B 3407              ADDC     A,#HIGH abDirectNodesResponseSpeed+01H
B1:00D23D F583              MOV      DPH,A
B1:00D23F E0                MOVX     A,@DPTR
B1:00D240 FF                MOV      R7,A
B1:00D241 22                RET      
B1:00D242         ?C0365?ZW_TRANSPORT:
B1:00D242 0E                INC      R6
B1:00D243 EE                MOV      A,R6
B1:00D244 B402E5            CJNE     A,#02H,?C0363?ZW_TRANSPORT
B1:00D247         ?C0364?ZW_TRANSPORT:
B1:00D247 7F01              MOV      R7,#01H
B1:00D249 22                RET      
----- FUNCTION _ChooseSpeedForDestination_slave (END) -------


----- FUNCTION _ZW_RequestNetworkUpdateInternal (BEGIN) -----
B1:00D24A 904677            MOV      DPTR,#force
B1:00D24D EF                MOV      A,R7
B1:00D24E F0                MOVX     @DPTR,A
;---- Variable 'completedFunc' assigned to Register 'R4/R5' ----
B1:00D24F A3                INC      DPTR
B1:00D250 7407              MOV      A,#07H
B1:00D252 F0                MOVX     @DPTR,A
B1:00D253 9033A5            MOV      DPTR,#sucNodeID
B1:00D256 E0                MOVX     A,@DPTR
B1:00D257 6005              JZ       ?C0271?ZW_SLAVE
B1:00D259 12C566            LCALL    ?L?COM03ED
B1:00D25C 6003              JZ       ?C0270?ZW_SLAVE
B1:00D25E         ?C0271?ZW_SLAVE:
B1:00D25E 7F00              MOV      R7,#00H
B1:00D260 22                RET      
B1:00D261         ?C0270?ZW_SLAVE:
B1:00D261 903397            MOV      DPTR,#SUC_Update
B1:00D264 7402              MOV      A,#02H
B1:00D266 F0                MOVX     @DPTR,A
B1:00D267 90332A            MOV      DPTR,#_routeUpdateDone
B1:00D26A F16F              ACALL    ?L?COM046A
B1:00D26C 7176              ACALL    ?L?COM0318
B1:00D26E 7415              MOV      A,#015H
B1:00D270 F0                MOVX     @DPTR,A
B1:00D271 F10E              ACALL    ?L?COM0454
B1:00D273 1287B9            LCALL    ?L?COM003F
B1:00D276 7A33              MOV      R2,#HIGH slaveFrameBuffer+02H
B1:00D278 79AE              MOV      R1,#LOW slaveFrameBuffer+02H
B1:00D27A 7F05              MOV      R7,#05H
B1:00D27C 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00D27F 904677            MOV      DPTR,#force
B1:00D282 E0                MOVX     A,@DPTR
B1:00D283 600C              JZ       ?C0273?ZW_SLAVE
B1:00D285 9033B3            MOV      DPTR,#slaveFrameBuffer+07H
B1:00D288 74FF              MOV      A,#0FFH
B1:00D28A F0                MOVX     @DPTR,A
B1:00D28B 904678            MOV      DPTR,#frameSize
B1:00D28E E0                MOVX     A,@DPTR
B1:00D28F 04                INC      A
B1:00D290 F0                MOVX     @DPTR,A
B1:00D291         ?C0273?ZW_SLAVE:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 373


B1:00D291 9033A5            MOV      DPTR,#sucNodeID
B1:00D294 5115              ACALL    ?L?COM005F
B1:00D296 904678            MOV      DPTR,#frameSize
B1:00D299 E0                MOVX     A,@DPTR
B1:00D29A 71A7              ACALL    ?L?COM022B
B1:00D29C A3                INC      DPTR
B1:00D29D 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ReqUpdateCallback
B1:00D29F F0                MOVX     @DPTR,A
B1:00D2A0 A3                INC      DPTR
B1:00D2A1 74C6              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ReqUpdateCallback
B1:00D2A3 F0                MOVX     @DPTR,A
B1:00D2A4 9033A5            MOV      DPTR,#sucNodeID
B1:00D2A7 E0                MOVX     A,@DPTR
B1:00D2A8 FB                MOV      R3,A
B1:00D2A9 313B              ACALL    _EnQueueSingleData
B1:00D2AB EF                MOV      A,R7
B1:00D2AC 700E              JNZ      ?C0274?ZW_SLAVE
B1:00D2AE 903397            MOV      DPTR,#SUC_Update
B1:00D2B1 04                INC      A
B1:00D2B2 F0                MOVX     @DPTR,A
B1:00D2B3 E4                CLR      A
B1:00D2B4 90332A            MOV      DPTR,#_routeUpdateDone
B1:00D2B7 F0                MOVX     @DPTR,A
B1:00D2B8 A3                INC      DPTR
B1:00D2B9 F0                MOVX     @DPTR,A
B1:00D2BA FF                MOV      R7,A
B1:00D2BB 22                RET      
B1:00D2BC         ?C0274?ZW_SLAVE:
B1:00D2BC 7F01              MOV      R7,#01H
B1:00D2BE 22                RET      
----- FUNCTION _ZW_RequestNetworkUpdateInternal (END) -------


----- FUNCTION _SendTestFrame (BEGIN) -----
B1:00D2BF 904562            MOV      DPTR,#bNodeID
B1:00D2C2 126563            LCALL    ?L?COM00E9
B1:00D2C5 EA                MOV      A,R2
B1:00D2C6 F0                MOVX     @DPTR,A
B1:00D2C7 A3                INC      DPTR
B1:00D2C8 EB                MOV      A,R3
B1:00D2C9 F0                MOVX     @DPTR,A
B1:00D2CA 903316            MOV      DPTR,#cmdBuffer
B1:00D2CD 7401              MOV      A,#01H
B1:00D2CF F0                MOVX     @DPTR,A
B1:00D2D0 A3                INC      DPTR
B1:00D2D1 7418              MOV      A,#018H
B1:00D2D3 F0                MOVX     @DPTR,A
B1:00D2D4 904563            MOV      DPTR,#powerLevel
B1:00D2D7 E0                MOVX     A,@DPTR
B1:00D2D8 FF                MOV      R7,A
B1:00D2D9 125D59            LCALL    _RFPowerGetTxPwrReg_100
B1:00D2DC 903318            MOV      DPTR,#cmdBuffer+02H
B1:00D2DF EF                MOV      A,R7
B1:00D2E0 F0                MOVX     @DPTR,A
B1:00D2E1 904563            MOV      DPTR,#powerLevel
B1:00D2E4 E0                MOVX     A,@DPTR
B1:00D2E5 903319            MOV      DPTR,#cmdBuffer+03H
B1:00D2E8 F0                MOVX     @DPTR,A
B1:00D2E9 90339C            MOV      DPTR,#temp
B1:00D2EC 7401              MOV      A,#01H
B1:00D2EE F0                MOVX     @DPTR,A
B1:00D2EF 90339E            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00D2F2 E0                MOVX     A,@DPTR
B1:00D2F3 FF                MOV      R7,A
B1:00D2F4 B40206            CJNE     A,#02H,?C0020?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 374


B1:00D2F7 90339C            MOV      DPTR,#temp
B1:00D2FA 7402              MOV      A,#02H
B1:00D2FC F0                MOVX     @DPTR,A
B1:00D2FD         ?C0020?ZW_SLAVE:
B1:00D2FD EF                MOV      A,R7
B1:00D2FE B40306            CJNE     A,#03H,?C0021?ZW_SLAVE
B1:00D301 90339C            MOV      DPTR,#temp
B1:00D304 7403              MOV      A,#03H
B1:00D306 F0                MOVX     @DPTR,A
B1:00D307         ?C0021?ZW_SLAVE:
B1:00D307 90336C            MOV      DPTR,#zensorWakeupTime
B1:00D30A E0                MOVX     A,@DPTR
B1:00D30B 600E              JZ       ?C0022?ZW_SLAVE
B1:00D30D 7F40              MOV      R7,#040H
B1:00D30F B40202            CJNE     A,#02H,?C0023?ZW_SLAVE
B1:00D312 7F20              MOV      R7,#020H
B1:00D314         ?C0023?ZW_SLAVE:
B1:00D314         ?C0024?ZW_SLAVE:
B1:00D314 EF                MOV      A,R7
B1:00D315 4402              ORL      A,#02H
B1:00D317 90339C            MOV      DPTR,#temp
B1:00D31A F0                MOVX     @DPTR,A
B1:00D31B         ?C0022?ZW_SLAVE:
B1:00D31B 90339C            MOV      DPTR,#temp
B1:00D31E 12B053            LCALL    ?L?COM0177
B1:00D321 7B01              MOV      R3,#01H
B1:00D323 7A33              MOV      R2,#HIGH cmdBuffer
B1:00D325 7916              MOV      R1,#LOW cmdBuffer
B1:00D327 5124              ACALL    ?L?COM0062
B1:00D329 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00D32C 7404              MOV      A,#04H
B1:00D32E F0                MOVX     @DPTR,A
B1:00D32F A3                INC      DPTR
B1:00D330 7411              MOV      A,#011H
B1:00D332 F0                MOVX     @DPTR,A
B1:00D333 E4                CLR      A
B1:00D334 A3                INC      DPTR
B1:00D335 F0                MOVX     @DPTR,A
B1:00D336 904564            MOV      DPTR,#func
B1:00D339 7142              ACALL    ?L?COM03F2
B1:00D33B 904562            MOV      DPTR,#bNodeID
B1:00D33E E0                MOVX     A,@DPTR
B1:00D33F FB                MOV      R3,A
B1:00D340 213B              AJMP     _EnQueueSingleData
----- FUNCTION _SendTestFrame (END) -------


----- FUNCTION ?L?COM03F2 (BEGIN) -----
B1:00D342 E0                MOVX     A,@DPTR
B1:00D343 FB                MOV      R3,A
B1:00D344 A3                INC      DPTR
B1:00D345 E0                MOVX     A,@DPTR
B1:00D346 9009F5            MOV      DPTR,#?_EnQueueSingleData?BYTE+09H
B1:00D349 CB                XCH      A,R3
B1:00D34A F0                MOVX     @DPTR,A
B1:00D34B A3                INC      DPTR
B1:00D34C EB                MOV      A,R3
B1:00D34D F0                MOVX     @DPTR,A
B1:00D34E 22                RET      
----- FUNCTION ?L?COM03F2 (END) -------


----- FUNCTION _ZCB_CtrlAskedForHelpCallback (BEGIN) -----
;---- Variable 'txStatus' assigned to Register 'R7' ----
B1:00D34F 7177              ACALL    ?L?COM0319
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 375


B1:00D351 7417              MOV      A,#017H
B1:00D353 F0                MOVX     @DPTR,A
B1:00D354 EF                MOV      A,R7
B1:00D355 7006              JNZ      ?C0015?ZW_SLAVE
B1:00D357 A3                INC      DPTR
B1:00D358 7405              MOV      A,#05H
B1:00D35A F0                MOVX     @DPTR,A
B1:00D35B 8006              SJMP     ?C0016?ZW_SLAVE
B1:00D35D         ?C0015?ZW_SLAVE:
B1:00D35D 9033AE            MOV      DPTR,#slaveFrameBuffer+02H
B1:00D360 7404              MOV      A,#04H
B1:00D362 F0                MOVX     @DPTR,A
B1:00D363         ?C0016?ZW_SLAVE:
B1:00D363 5119              ACALL    ?L?COM0060
B1:00D365 7403              MOV      A,#03H
B1:00D367 71A7              ACALL    ?L?COM022B
B1:00D369 A3                INC      DPTR
B1:00D36A F0                MOVX     @DPTR,A
B1:00D36B A3                INC      DPTR
B1:00D36C F0                MOVX     @DPTR,A
B1:00D36D 90339D            MOV      DPTR,#helpNodeID
B1:00D370 E0                MOVX     A,@DPTR
B1:00D371 FB                MOV      R3,A
B1:00D372 7F01              MOV      R7,#01H
B1:00D374 213B              AJMP     _EnQueueSingleData
----- FUNCTION _ZCB_CtrlAskedForHelpCallback (END) -------


----- FUNCTION ?L?COM0318 (BEGIN) -----
B1:00D376 F0                MOVX     @DPTR,A
B1:00D377         ?L?COM0319:
B1:00D377 9033AC            MOV      DPTR,#slaveFrameBuffer
B1:00D37A 7401              MOV      A,#01H
B1:00D37C F0                MOVX     @DPTR,A
B1:00D37D A3                INC      DPTR
B1:00D37E 22                RET      
----- FUNCTION ?L?COM0318 (END) -------


----- FUNCTION _ZW_RequestNodeInfo (BEGIN) -----
B1:00D37F 90467B            MOV      DPTR,#completedFunc
B1:00D382 EC                MOV      A,R4
B1:00D383 F0                MOVX     @DPTR,A
B1:00D384 A3                INC      DPTR
B1:00D385 ED                MOV      A,R5
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00D386 7176              ACALL    ?L?COM0318
B1:00D388 04                INC      A
B1:00D389 F0                MOVX     @DPTR,A
B1:00D38A D20A              SETB     bUseExploreAsRouteResolution
B1:00D38C 901221            MOV      DPTR,#nodeID
B1:00D38F E0                MOVX     A,@DPTR
B1:00D390 FD                MOV      R5,A
B1:00D391 AB07              MOV      R3,AR7
B1:00D393 C003              PUSH     AR3
B1:00D395 511E              ACALL    ?L?COM0061
B1:00D397 7402              MOV      A,#02H
B1:00D399 71A7              ACALL    ?L?COM022B
B1:00D39B 90467B            MOV      DPTR,#completedFunc
B1:00D39E 912D              ACALL    ?L?COM03EC
B1:00D3A0 D003              POP      AR3
B1:00D3A2 71B5              ACALL    ?L?COM0423
B1:00D3A4 24FF              ADD      A,#0FFH
B1:00D3A6 22                RET      
----- FUNCTION _ZW_RequestNodeInfo (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 376




----- FUNCTION ?L?COM022B (BEGIN) -----
B1:00D3A7 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00D3AA         ?L?COM022C:
B1:00D3AA F0                MOVX     @DPTR,A
B1:00D3AB A3                INC      DPTR
B1:00D3AC 7405              MOV      A,#05H
B1:00D3AE F0                MOVX     @DPTR,A
B1:00D3AF E4                CLR      A
B1:00D3B0 A3                INC      DPTR
B1:00D3B1 F0                MOVX     @DPTR,A
B1:00D3B2 22                RET      
----- FUNCTION ?L?COM022B (END) -------


----- FUNCTION ?L?COM0422 (BEGIN) -----
B1:00D3B3 E0                MOVX     A,@DPTR
B1:00D3B4 FB                MOV      R3,A
B1:00D3B5         ?L?COM0423:
B1:00D3B5 E4                CLR      A
B1:00D3B6 FF                MOV      R7,A
B1:00D3B7 313B              ACALL    _EnQueueSingleData
B1:00D3B9 EF                MOV      A,R7
B1:00D3BA 22                RET      
----- FUNCTION ?L?COM0422 (END) -------


----- FUNCTION _ZCB_MulticastCompletedFunc (BEGIN) -----
;---- Variable 'bStatus' assigned to Register 'R7' ----
B1:00D3BB EF                MOV      A,R7
B1:00D3BC 6004              JZ       ?C0005?ZW_TRANSPORT_MULTI
B1:00D3BE 904268            MOV      DPTR,#bMultiStatus
B1:00D3C1 F0                MOVX     @DPTR,A
B1:00D3C2         ?C0005?ZW_TRANSPORT_MULTI:
B1:00D3C2 900769            MOV      DPTR,#activeTransmit
B1:00D3C5 E0                MOVX     A,@DPTR
B1:00D3C6 FF                MOV      R7,A
B1:00D3C7 90066E            MOV      DPTR,#pMultiNodeList
B1:00D3CA 122552            LCALL    ?C?PLDXDATA
B1:00D3CD 121BC4            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskGetNextNode
B1:00D3D0 900769            MOV      DPTR,#activeTransmit
B1:00D3D3 EF                MOV      A,R7
B1:00D3D4 F0                MOVX     @DPTR,A
B1:00D3D5 6048              JZ       ?C0006?ZW_TRANSPORT_MULTI
B1:00D3D7 200645            JB       bApplicationTxAbort,?C0006?ZW_TRANSPORT_MULTI
B1:00D3DA 904266            MOV      DPTR,#bMultiFrameOptions
B1:00D3DD E0                MOVX     A,@DPTR
B1:00D3DE C3                CLR      C
B1:00D3DF 30E501            JNB      ACC.5,?C0007?ZW_TRANSPORT_MULTI
B1:00D3E2 D3                SETB     C
B1:00D3E3         ?C0007?ZW_TRANSPORT_MULTI:
B1:00D3E3         ?C0008?ZW_TRANSPORT_MULTI:
B1:00D3E3 920A              MOV      bUseExploreAsRouteResolution,C
B1:00D3E5 904265            MOV      DPTR,#bMultiSrcNodeID
B1:00D3E8 E0                MOVX     A,@DPTR
B1:00D3E9 FD                MOV      R5,A
B1:00D3EA 904269            MOV      DPTR,#pMultiData
B1:00D3ED 122552            LCALL    ?C?PLDXDATA
B1:00D3F0 5124              ACALL    ?L?COM0062
B1:00D3F2 904267            MOV      DPTR,#bMultiDataLength
B1:00D3F5 E0                MOVX     A,@DPTR
B1:00D3F6 9009F2            MOV      DPTR,#?_EnQueueSingleData?BYTE+06H
B1:00D3F9 F0                MOVX     @DPTR,A
B1:00D3FA 904264            MOV      DPTR,#bMultiTxOptions
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 377


B1:00D3FD E0                MOVX     A,@DPTR
B1:00D3FE 9009F3            MOV      DPTR,#?_EnQueueSingleData?BYTE+07H
B1:00D401 F0                MOVX     @DPTR,A
B1:00D402 A3                INC      DPTR
B1:00D403 7480              MOV      A,#080H
B1:00D405 F0                MOVX     @DPTR,A
B1:00D406 D1EE              ACALL    ?L?COM04DA
B1:00D408 900769            MOV      DPTR,#activeTransmit
B1:00D40B 71B3              ACALL    ?L?COM0422
B1:00D40D 701D              JNZ      ?C0011?ZW_TRANSPORT_MULTI
B1:00D40F 904268            MOV      DPTR,#bMultiStatus
B1:00D412 7402              MOV      A,#02H
B1:00D414 F0                MOVX     @DPTR,A
B1:00D415 904262            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00D418 12AD01            LCALL    ?L?COM00CE
B1:00D41B 7F02              MOV      R7,#02H
B1:00D41D 800A              SJMP     ?C0019?ZW_TRANSPORT_MULTI
B1:00D41F         ?C0006?ZW_TRANSPORT_MULTI:
B1:00D41F 904268            MOV      DPTR,#bMultiStatus
B1:00D422 E0                MOVX     A,@DPTR
B1:00D423 904262            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00D426 126E12            LCALL    ?L?COM01A2
B1:00D429         
B1:00D429 1226E3            LCALL    ?C?ICALL2
B1:00D42C         ?C0011?ZW_TRANSPORT_MULTI:
B1:00D42C 22                RET      
----- FUNCTION _ZCB_MulticastCompletedFunc (END) -------


----- FUNCTION ?L?COM03EC (BEGIN) -----
B1:00D42D E0                MOVX     A,@DPTR
B1:00D42E FF                MOV      R7,A
B1:00D42F A3                INC      DPTR
B1:00D430 E0                MOVX     A,@DPTR
B1:00D431 9009F5            MOV      DPTR,#?_EnQueueSingleData?BYTE+09H
B1:00D434 CF                XCH      A,R7
B1:00D435 F0                MOVX     @DPTR,A
B1:00D436 A3                INC      DPTR
B1:00D437 EF                MOV      A,R7
B1:00D438 F0                MOVX     @DPTR,A
B1:00D439 22                RET      
----- FUNCTION ?L?COM03EC (END) -------


----- FUNCTION _StoreRoute (BEGIN) -----
B1:00D43A 904500            MOV      DPTR,#pData
B1:00D43D EE                MOV      A,R6
B1:00D43E F0                MOVX     @DPTR,A
B1:00D43F A3                INC      DPTR
B1:00D440 EF                MOV      A,R7
B1:00D441 F0                MOVX     @DPTR,A
B1:00D442 201B0F            JB       bRouteCached,?C0022?ZW_ROUTING_ALL
B1:00D445 900666            MOV      DPTR,#bRxCurrentSpeed
B1:00D448 E0                MOVX     A,@DPTR
B1:00D449 B4010B            CJNE     A,#01H,?C0021?ZW_ROUTING_ALL
B1:00D44C D104              ACALL    ?L?COM0344
B1:00D44E E0                MOVX     A,@DPTR
B1:00D44F B1F9              ACALL    ?L?COM008D
B1:00D451 20E703            JB       ACC.7,?C0021?ZW_ROUTING_ALL
B1:00D454         ?C0022?ZW_ROUTING_ALL:
B1:00D454 7FFF              MOV      R7,#0FFH
B1:00D456 22                RET      
B1:00D457         ?C0021?ZW_ROUTING_ALL:
B1:00D457 D104              ACALL    ?L?COM0344
B1:00D459 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 378


B1:00D45A 7B01              MOV      R3,#01H
B1:00D45C 2404              ADD      A,#04H
B1:00D45E B1FD              ACALL    ?L?COM008E
B1:00D460 F107              ACALL    ?L?COM0183
B1:00D462 6002              JZ       ?C0024?ZW_ROUTING_ALL
B1:00D464 800A              SJMP     ?C0025?ZW_ROUTING_ALL
B1:00D466         ?C0024?ZW_ROUTING_ALL:
B1:00D466 D104              ACALL    ?L?COM0344
B1:00D468 E0                MOVX     A,@DPTR
B1:00D469 7B01              MOV      R3,#01H
B1:00D46B 2408              ADD      A,#08H
B1:00D46D B1FD              ACALL    ?L?COM008E
B1:00D46F FF                MOV      R7,A
B1:00D470         ?C0025?ZW_ROUTING_ALL:
;---- Variable 'bNodeID' assigned to Register 'R5' ----
B1:00D470 AD07              MOV      R5,AR7
B1:00D472 D114              ACALL    _GetResponseRouteIndex
B1:00D474 904504            MOV      DPTR,#routetmp
B1:00D477 EF                MOV      A,R7
B1:00D478 F0                MOVX     @DPTR,A
B1:00D479 F4                CPL      A
B1:00D47A 7051              JNZ      ?C0026?ZW_ROUTING_ALL
B1:00D47C 128FE1            LCALL    ?L?COM0587
B1:00D47F 5037              JNC      ?C0027?ZW_ROUTING_ALL
B1:00D481 E0                MOVX     A,@DPTR
B1:00D482 04                INC      A
B1:00D483 F0                MOVX     @DPTR,A
B1:00D484 E4                CLR      A
B1:00D485 904504            MOV      DPTR,#routetmp
B1:00D488 F0                MOVX     @DPTR,A
B1:00D489         ?C0028?ZW_ROUTING_ALL:
B1:00D489 904504            MOV      DPTR,#routetmp
B1:00D48C E0                MOVX     A,@DPTR
B1:00D48D FF                MOV      R7,A
B1:00D48E C3                CLR      C
B1:00D48F 9402              SUBB     A,#02H
B1:00D491 5011              JNC      ?C0029?ZW_ROUTING_ALL
B1:00D493 741E              MOV      A,#LOW responseRouteNodeID
B1:00D495 2F                ADD      A,R7
B1:00D496 128E6D            LCALL    ?L?COM026B
B1:00D499 E0                MOVX     A,@DPTR
B1:00D49A 6008              JZ       ?C0029?ZW_ROUTING_ALL
B1:00D49C         ?C0031?ZW_ROUTING_ALL:
B1:00D49C         ?C0030?ZW_ROUTING_ALL:
B1:00D49C 904504            MOV      DPTR,#routetmp
B1:00D49F E0                MOVX     A,@DPTR
B1:00D4A0 04                INC      A
B1:00D4A1 F0                MOVX     @DPTR,A
B1:00D4A2 80E5              SJMP     ?C0028?ZW_ROUTING_ALL
B1:00D4A4         ?C0029?ZW_ROUTING_ALL:
B1:00D4A4 904504            MOV      DPTR,#routetmp
B1:00D4A7 E0                MOVX     A,@DPTR
B1:00D4A8 B40203            CJNE     A,#02H,?C0032?ZW_ROUTING_ALL
B1:00D4AB 7401              MOV      A,#01H
B1:00D4AD F0                MOVX     @DPTR,A
B1:00D4AE         ?C0032?ZW_ROUTING_ALL:
B1:00D4AE 904504            MOV      DPTR,#routetmp
B1:00D4B1 E0                MOVX     A,@DPTR
B1:00D4B2 24FF              ADD      A,#0FFH
B1:00D4B4 921A              MOV      responseRouteLI,C
B1:00D4B6 8015              SJMP     ?C0026?ZW_ROUTING_ALL
B1:00D4B8         ?C0027?ZW_ROUTING_ALL:
B1:00D4B8 201C0C            JB       routesLocked,?C0034?ZW_ROUTING_ALL
B1:00D4BB B21A              CPL      responseRouteLI
B1:00D4BD A21A              MOV      C,responseRouteLI
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 379


B1:00D4BF E4                CLR      A
B1:00D4C0 33                RLC      A
B1:00D4C1 904504            MOV      DPTR,#routetmp
B1:00D4C4 F0                MOVX     @DPTR,A
B1:00D4C5 8006              SJMP     ?C0026?ZW_ROUTING_ALL
B1:00D4C7         ?C0034?ZW_ROUTING_ALL:
B1:00D4C7 904504            MOV      DPTR,#routetmp
B1:00D4CA 7401              MOV      A,#01H
B1:00D4CC F0                MOVX     @DPTR,A
B1:00D4CD         ?C0026?ZW_ROUTING_ALL:
B1:00D4CD 904504            MOV      DPTR,#routetmp
B1:00D4D0 128E6A            LCALL    ?L?COM026A
B1:00D4D3 ED                MOV      A,R5
B1:00D4D4 B1F0              ACALL    ?L?COM008C
B1:00D4D6 20E702            JB       ACC.7,$ + 5H
B1:00D4D9 A17D              AJMP     ?C0036?ZW_ROUTING_ALL
B1:00D4DB EF                MOV      A,R7
B1:00D4DC 2409              ADD      A,#09H
B1:00D4DE B1FD              ACALL    ?L?COM008E
B1:00D4E0 30E31C            JNB      ACC.3,?C0037?ZW_ROUTING_ALL
B1:00D4E3 904500            MOV      DPTR,#pData
B1:00D4E6 A3                INC      DPTR
B1:00D4E7 E0                MOVX     A,@DPTR
B1:00D4E8 240A              ADD      A,#0AH
B1:00D4EA B1FD              ACALL    ?L?COM008E
B1:00D4EC 12F2A9            LCALL    ?L?COM01CE
B1:00D4EF E9                MOV      A,R1
B1:00D4F0 2401              ADD      A,#01H
B1:00D4F2 1285F5            LCALL    ?L?COM0004
B1:00D4F5 5418              ANL      A,#018H
B1:00D4F7 FF                MOV      R7,A
B1:00D4F8 128E75            LCALL    ?L?COM020D
B1:00D4FB EF                MOV      A,R7
B1:00D4FC F0                MOVX     @DPTR,A
B1:00D4FD 8005              SJMP     ?C0038?ZW_ROUTING_ALL
B1:00D4FF         ?C0037?ZW_ROUTING_ALL:
B1:00D4FF 128E75            LCALL    ?L?COM020D
B1:00D502 E4                CLR      A
B1:00D503 F0                MOVX     @DPTR,A
B1:00D504         ?C0038?ZW_ROUTING_ALL:
B1:00D504 D104              ACALL    ?L?COM0344
B1:00D506 E0                MOVX     A,@DPTR
B1:00D507 7B01              MOV      R3,#01H
B1:00D509 240A              ADD      A,#0AH
B1:00D50B B1FD              ACALL    ?L?COM008E
B1:00D50D C4                SWAP     A
B1:00D50E 540F              ANL      A,#0FH
B1:00D510 FF                MOV      R7,A
;---- Variable 'routeLen' assigned to Register 'R7' ----
B1:00D511 128BF0            LCALL    ?L?COM010B
B1:00D514 EF                MOV      A,R7
B1:00D515 F0                MOVX     @DPTR,A
B1:00D516 904500            MOV      DPTR,#pData
B1:00D519 E0                MOVX     A,@DPTR
B1:00D51A FC                MOV      R4,A
B1:00D51B A3                INC      DPTR
B1:00D51C E0                MOVX     A,@DPTR
B1:00D51D 240B              ADD      A,#0BH
B1:00D51F F9                MOV      R1,A
B1:00D520 E4                CLR      A
B1:00D521 3C                ADDC     A,R4
B1:00D522 AD01              MOV      R5,AR1
B1:00D524 A3                INC      DPTR
B1:00D525 F0                MOVX     @DPTR,A
B1:00D526 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 380


B1:00D527 ED                MOV      A,R5
B1:00D528 F0                MOVX     @DPTR,A
B1:00D529 904500            MOV      DPTR,#pData
B1:00D52C A3                INC      DPTR
B1:00D52D E0                MOVX     A,@DPTR
B1:00D52E 2409              ADD      A,#09H
B1:00D530 F9                MOV      R1,A
B1:00D531 E4                CLR      A
B1:00D532 3C                ADDC     A,R4
B1:00D533 FA                MOV      R2,A
B1:00D534 121F7C            LCALL    ?C?CLDPTR
B1:00D537 20E01F            JB       ACC.0,?C0039?ZW_ROUTING_ALL
B1:00D53A         ?C0040?ZW_ROUTING_ALL:
B1:00D53A AE07              MOV      R6,AR7
B1:00D53C 1F                DEC      R7
B1:00D53D EE                MOV      A,R6
B1:00D53E 6056              JZ       ?C0045?ZW_ROUTING_ALL
B1:00D540 904502            MOV      DPTR,#bPtr
B1:00D543 128FE9            LCALL    ?L?COM0209
B1:00D546 E0                MOVX     A,@DPTR
B1:00D547 FE                MOV      R6,A
B1:00D548 128E4D            LCALL    ?L?COM00CF
B1:00D54B E582              MOV      A,DPL
B1:00D54D 2F                ADD      A,R7
B1:00D54E 128E62            LCALL    ?L?COM0192
B1:00D551 EE                MOV      A,R6
B1:00D552 D10B              ACALL    ?L?COM0519
B1:00D554 12210C            LCALL    ?C?IILDX
B1:00D557 80E1              SJMP     ?C0040?ZW_ROUTING_ALL
B1:00D559         ?C0039?ZW_ROUTING_ALL:
;---- Variable 'i' assigned to Register 'R6' ----
B1:00D559 E4                CLR      A
B1:00D55A FE                MOV      R6,A
B1:00D55B         ?C0043?ZW_ROUTING_ALL:
B1:00D55B AD07              MOV      R5,AR7
B1:00D55D 1F                DEC      R7
B1:00D55E ED                MOV      A,R5
B1:00D55F 6035              JZ       ?C0045?ZW_ROUTING_ALL
B1:00D561 904502            MOV      DPTR,#bPtr
B1:00D564 128FE9            LCALL    ?L?COM0209
B1:00D567 E0                MOVX     A,@DPTR
B1:00D568 FD                MOV      R5,A
B1:00D569 AC06              MOV      R4,AR6
B1:00D56B 0E                INC      R6
B1:00D56C 128E4D            LCALL    ?L?COM00CF
B1:00D56F E582              MOV      A,DPL
B1:00D571 2C                ADD      A,R4
B1:00D572 128E62            LCALL    ?L?COM0192
B1:00D575 ED                MOV      A,R5
B1:00D576 D10B              ACALL    ?L?COM0519
B1:00D578 12210C            LCALL    ?C?IILDX
B1:00D57B 80DE              SJMP     ?C0043?ZW_ROUTING_ALL
B1:00D57D         ?C0036?ZW_ROUTING_ALL:
B1:00D57D 904504            MOV      DPTR,#routetmp
B1:00D580 E0                MOVX     A,@DPTR
B1:00D581 FF                MOV      R7,A
B1:00D582 128BF4            LCALL    ?L?COM010D
B1:00D585 E4                CLR      A
B1:00D586 F0                MOVX     @DPTR,A
B1:00D587 741C              MOV      A,#LOW responseRouteRFOption
B1:00D589 2F                ADD      A,R7
B1:00D58A 128E7B            LCALL    ?L?COM020F
B1:00D58D E4                CLR      A
B1:00D58E F0                MOVX     @DPTR,A
B1:00D58F EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 381


B1:00D590 128E51            LCALL    ?L?COM00D1
B1:00D593 74FE              MOV      A,#0FEH
B1:00D595 F0                MOVX     @DPTR,A
B1:00D596         ?C0045?ZW_ROUTING_ALL:
B1:00D596 128BF0            LCALL    ?L?COM010B
B1:00D599 C083              PUSH     DPH
B1:00D59B C082              PUSH     DPL
B1:00D59D E0                MOVX     A,@DPTR
B1:00D59E FF                MOV      R7,A
B1:00D59F 128FD9            LCALL    ?L?COM0586
B1:00D5A2 FE                MOV      R6,A
B1:00D5A3 EF                MOV      A,R7
B1:00D5A4 4E                ORL      A,R6
B1:00D5A5 D082              POP      DPL
B1:00D5A7 D083              POP      DPH
B1:00D5A9 B1F0              ACALL    ?L?COM008C
B1:00D5AB 30E708            JNB      ACC.7,?C0048?ZW_ROUTING_ALL
B1:00D5AE EF                MOV      A,R7
B1:00D5AF 2409              ADD      A,#09H
B1:00D5B1 B1FD              ACALL    ?L?COM008E
B1:00D5B3 20E408            JB       ACC.4,?C0047?ZW_ROUTING_ALL
B1:00D5B6         ?C0048?ZW_ROUTING_ALL:
B1:00D5B6 D104              ACALL    ?L?COM0344
B1:00D5B8 E0                MOVX     A,@DPTR
B1:00D5B9 B1F9              ACALL    ?L?COM008D
B1:00D5BB 30E413            JNB      ACC.4,?C0046?ZW_ROUTING_ALL
B1:00D5BE         ?C0047?ZW_ROUTING_ALL:
B1:00D5BE 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00D5C1 E0                MOVX     A,@DPTR
B1:00D5C2 904504            MOV      DPTR,#routetmp
B1:00D5C5 126E40            LCALL    ?L?COM01FC
B1:00D5C8 8002              SJMP     ?C0085?ZW_ROUTING_ALL
B1:00D5CA         ?C0084?ZW_ROUTING_ALL:
B1:00D5CA C3                CLR      C
B1:00D5CB 33                RLC      A
B1:00D5CC         ?C0085?ZW_ROUTING_ALL:
B1:00D5CC D8FC              DJNZ     R0,?C0084?ZW_ROUTING_ALL
B1:00D5CE 4F                ORL      A,R7
B1:00D5CF 8013              SJMP     ?C0094?ZW_ROUTING_ALL
B1:00D5D1         ?C0046?ZW_ROUTING_ALL:
B1:00D5D1 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00D5D4 E0                MOVX     A,@DPTR
B1:00D5D5 FF                MOV      R7,A
B1:00D5D6 904504            MOV      DPTR,#routetmp
B1:00D5D9 126E41            LCALL    ?L?COM01FD
B1:00D5DC 8002              SJMP     ?C0087?ZW_ROUTING_ALL
B1:00D5DE         ?C0086?ZW_ROUTING_ALL:
B1:00D5DE C3                CLR      C
B1:00D5DF 33                RLC      A
B1:00D5E0         ?C0087?ZW_ROUTING_ALL:
B1:00D5E0 D8FC              DJNZ     R0,?C0086?ZW_ROUTING_ALL
B1:00D5E2 F4                CPL      A
B1:00D5E3 5F                ANL      A,R7
B1:00D5E4         
B1:00D5E4 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00D5E7 F0                MOVX     @DPTR,A
B1:00D5E8         ?C0049?ZW_ROUTING_ALL:
B1:00D5E8 D21B              SETB     bRouteCached
B1:00D5EA 904504            MOV      DPTR,#routetmp
B1:00D5ED E0                MOVX     A,@DPTR
B1:00D5EE FF                MOV      R7,A
B1:00D5EF 22                RET      
----- FUNCTION _StoreRoute (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 382


----- FUNCTION ?L?COM008C (BEGIN) -----
B1:00D5F0 F0                MOVX     @DPTR,A
B1:00D5F1 904500            MOV      DPTR,#pData
B1:00D5F4 E0                MOVX     A,@DPTR
B1:00D5F5 FE                MOV      R6,A
B1:00D5F6 A3                INC      DPTR
B1:00D5F7 E0                MOVX     A,@DPTR
B1:00D5F8 FF                MOV      R7,A
B1:00D5F9         ?L?COM008D:
B1:00D5F9 7B01              MOV      R3,#01H
B1:00D5FB 2405              ADD      A,#05H
B1:00D5FD         ?L?COM008E:
B1:00D5FD F9                MOV      R1,A
B1:00D5FE E4                CLR      A
B1:00D5FF 3E                ADDC     A,R6
B1:00D600 FA                MOV      R2,A
B1:00D601 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM008C (END) -------


----- FUNCTION ?L?COM0344 (BEGIN) -----
B1:00D604 904500            MOV      DPTR,#pData
B1:00D607 E0                MOVX     A,@DPTR
B1:00D608 FE                MOV      R6,A
B1:00D609 A3                INC      DPTR
B1:00D60A 22                RET      
----- FUNCTION ?L?COM0344 (END) -------


----- FUNCTION ?L?COM0519 (BEGIN) -----
B1:00D60B F0                MOVX     @DPTR,A
B1:00D60C 904502            MOV      DPTR,#bPtr
B1:00D60F E4                CLR      A
B1:00D610 75F001            MOV      B,#01H
B1:00D613 22                RET      
----- FUNCTION ?L?COM0519 (END) -------


----- FUNCTION _GetResponseRouteIndex (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
;---- Variable 'rtmp' assigned to Register 'R6' ----
B1:00D614 7E02              MOV      R6,#02H
B1:00D616 EF                MOV      A,R7
B1:00D617 6017              JZ       ?C0001?ZW_ROUTING_ALL
B1:00D619 901216            MOV      DPTR,#responseRouteCount
B1:00D61C E0                MOVX     A,@DPTR
B1:00D61D 6011              JZ       ?C0001?ZW_ROUTING_ALL
B1:00D61F         ?C0004?ZW_ROUTING_ALL:
B1:00D61F 741D              MOV      A,#LOW responseRouteNodeID-01H
B1:00D621 2E                ADD      A,R6
B1:00D622 F176              ACALL    ?L?COM0424
B1:00D624 E0                MOVX     A,@DPTR
B1:00D625 B50706            CJNE     A,AR7,?C0002?ZW_ROUTING_ALL
B1:00D628 C3                CLR      C
B1:00D629 EE                MOV      A,R6
B1:00D62A 9401              SUBB     A,#01H
B1:00D62C FF                MOV      R7,A
B1:00D62D 22                RET      
B1:00D62E         ?C0002?ZW_ROUTING_ALL:
B1:00D62E DEEF              DJNZ     R6,?C0004?ZW_ROUTING_ALL
B1:00D630         ?C0001?ZW_ROUTING_ALL:
B1:00D630 7FFF              MOV      R7,#0FFH
B1:00D632 22                RET      
----- FUNCTION _GetResponseRouteIndex (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 383



----- FUNCTION _ZW_SendDataMultiWorker (BEGIN) -----
B1:00D633 9041FD            MOV      DPTR,#pNodeIDList
B1:00D636 122572            LCALL    ?C?PSTXDATA
B1:00D639 9041FC            MOV      DPTR,#bSrcNodeID
B1:00D63C EF                MOV      A,R7
B1:00D63D F0                MOVX     @DPTR,A
B1:00D63E FC                MOV      R4,A
B1:00D63F 904207            MOV      DPTR,#speed
B1:00D642 7402              MOV      A,#02H
B1:00D644 F0                MOVX     @DPTR,A
B1:00D645 904204            MOV      DPTR,#txOptions
B1:00D648 E0                MOVX     A,@DPTR
B1:00D649 5437              ANL      A,#037H
B1:00D64B F0                MOVX     @DPTR,A
B1:00D64C E0                MOVX     A,@DPTR
B1:00D64D FF                MOV      R7,A
B1:00D64E 5420              ANL      A,#020H
B1:00D650 904266            MOV      DPTR,#bMultiFrameOptions
B1:00D653 F0                MOVX     @DPTR,A
B1:00D654 904265            MOV      DPTR,#bMultiSrcNodeID
B1:00D657 EC                MOV      A,R4
B1:00D658 F0                MOVX     @DPTR,A
B1:00D659 904205            MOV      DPTR,#completedFunc
B1:00D65C E0                MOVX     A,@DPTR
B1:00D65D FD                MOV      R5,A
B1:00D65E A3                INC      DPTR
B1:00D65F E0                MOVX     A,@DPTR
B1:00D660 904262            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00D663 CD                XCH      A,R5
B1:00D664 F0                MOVX     @DPTR,A
B1:00D665 A3                INC      DPTR
B1:00D666 ED                MOV      A,R5
B1:00D667 F0                MOVX     @DPTR,A
B1:00D668 904200            MOV      DPTR,#pData
B1:00D66B 122552            LCALL    ?C?PLDXDATA
B1:00D66E 904269            MOV      DPTR,#pMultiData
B1:00D671 122572            LCALL    ?C?PSTXDATA
B1:00D674 904203            MOV      DPTR,#dataLength
B1:00D677 E0                MOVX     A,@DPTR
B1:00D678 FE                MOV      R6,A
B1:00D679 904267            MOV      DPTR,#bMultiDataLength
B1:00D67C F0                MOVX     @DPTR,A
B1:00D67D 9041FD            MOV      DPTR,#pNodeIDList
B1:00D680 122552            LCALL    ?C?PLDXDATA
B1:00D683 90066E            MOV      DPTR,#pMultiNodeList
B1:00D686 122572            LCALL    ?C?PSTXDATA
B1:00D689 EF                MOV      A,R7
B1:00D68A 4420              ORL      A,#020H
B1:00D68C 904264            MOV      DPTR,#bMultiTxOptions
B1:00D68F F0                MOVX     @DPTR,A
B1:00D690 E4                CLR      A
B1:00D691 904268            MOV      DPTR,#bMultiStatus
B1:00D694 F0                MOVX     @DPTR,A
B1:00D695 C206              CLR      bApplicationTxAbort
B1:00D697 EE                MOV      A,R6
B1:00D698 D3                SETB     C
B1:00D699 9482              SUBB     A,#082H
B1:00D69B 4003              JC       ?C0012?ZW_TRANSPORT_MULTI
B1:00D69D 7F00              MOV      R7,#00H
B1:00D69F 22                RET      
B1:00D6A0         ?C0012?ZW_TRANSPORT_MULTI:
B1:00D6A0 904204            MOV      DPTR,#txOptions
B1:00D6A3 E0                MOVX     A,@DPTR
B1:00D6A4 FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 384


B1:00D6A5 904207            MOV      DPTR,#speed
B1:00D6A8 30E00C            JNB      ACC.0,?C0014?ZW_TRANSPORT_MULTI
B1:00D6AB D1D1              ACALL    ?L?COM0588
B1:00D6AD C003              PUSH     AR3
B1:00D6AF D1D9              ACALL    ?L?COM0300
B1:00D6B1 D1EE              ACALL    ?L?COM04DA
B1:00D6B3 D003              POP      AR3
B1:00D6B5 8018              SJMP     ?C0020?ZW_TRANSPORT_MULTI
B1:00D6B7         ?C0014?ZW_TRANSPORT_MULTI:
B1:00D6B7 D1D1              ACALL    ?L?COM0588
B1:00D6B9 D1D9              ACALL    ?L?COM0300
B1:00D6BB 904262            MOV      DPTR,#_zcbp_multiApplCompletedFunc
B1:00D6BE E0                MOVX     A,@DPTR
B1:00D6BF FB                MOV      R3,A
B1:00D6C0 A3                INC      DPTR
B1:00D6C1 E0                MOVX     A,@DPTR
B1:00D6C2 9041F7            MOV      DPTR,#?_SendMulticastFrame?BYTE+07H
B1:00D6C5 CB                XCH      A,R3
B1:00D6C6 F0                MOVX     @DPTR,A
B1:00D6C7 A3                INC      DPTR
B1:00D6C8 EB                MOV      A,R3
B1:00D6C9 F0                MOVX     @DPTR,A
B1:00D6CA 904204            MOV      DPTR,#txOptions
B1:00D6CD E0                MOVX     A,@DPTR
B1:00D6CE FB                MOV      R3,A
B1:00D6CF         
B1:00D6CF 0199              AJMP     _SendMulticastFrame
----- FUNCTION _ZW_SendDataMultiWorker (END) -------


----- FUNCTION ?L?COM0588 (BEGIN) -----
B1:00D6D1 E0                MOVX     A,@DPTR
B1:00D6D2 FF                MOV      R7,A
B1:00D6D3 9041FC            MOV      DPTR,#bSrcNodeID
B1:00D6D6 E0                MOVX     A,@DPTR
B1:00D6D7 FD                MOV      R5,A
B1:00D6D8 22                RET      
----- FUNCTION ?L?COM0588 (END) -------


----- FUNCTION ?L?COM0300 (BEGIN) -----
B1:00D6D9 904200            MOV      DPTR,#pData
B1:00D6DC 122552            LCALL    ?C?PLDXDATA
B1:00D6DF 9041F3            MOV      DPTR,#?_SendMulticastFrame?BYTE+03H
B1:00D6E2 122572            LCALL    ?C?PSTXDATA
B1:00D6E5 904203            MOV      DPTR,#dataLength
B1:00D6E8 E0                MOVX     A,@DPTR
B1:00D6E9 9041F6            MOV      DPTR,#?_SendMulticastFrame?BYTE+06H
B1:00D6EC F0                MOVX     @DPTR,A
B1:00D6ED 22                RET      
----- FUNCTION ?L?COM0300 (END) -------


----- FUNCTION ?L?COM04DA (BEGIN) -----
B1:00D6EE A3                INC      DPTR
B1:00D6EF 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_MulticastCompletedFunc
B1:00D6F1 F0                MOVX     @DPTR,A
B1:00D6F2 A3                INC      DPTR
B1:00D6F3 74A8              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_MulticastCompletedFunc
B1:00D6F5 F0                MOVX     @DPTR,A
B1:00D6F6 22                RET      
----- FUNCTION ?L?COM04DA (END) -------


----- FUNCTION CleanUpAfterFailedTxElemAlloc (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 385


B1:00D6F7 C20A              CLR      bUseExploreAsRouteResolution
B1:00D6F9 D208              SETB     currentSeqNoUseTX
B1:00D6FB 22                RET      
----- FUNCTION CleanUpAfterFailedTxElemAlloc (END) -------


----- FUNCTION ?L?COM0354 (BEGIN) -----
B1:00D6FC 9009C4            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+03H
B1:00D6FF 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0354 (END) -------


----- FUNCTION _ZW_SendTestFrame (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
;---- Variable 'func' assigned to Register 'R2/R3' ----
;---- Variable 'powerLevel' assigned to Register 'R5' ----
B1:00D702 F187              ACALL    ?L?COM04C5
B1:00D704 F0                MOVX     @DPTR,A
B1:00D705 41BF              AJMP     _SendTestFrame
----- FUNCTION _ZW_SendTestFrame (END) -------


----- FUNCTION ?L?COM0183 (BEGIN) -----
B1:00D707 FF                MOV      R7,A
B1:00D708 901221            MOV      DPTR,#nodeID
B1:00D70B E0                MOVX     A,@DPTR
B1:00D70C 6F                XRL      A,R7
B1:00D70D 22                RET      
----- FUNCTION ?L?COM0183 (END) -------


----- FUNCTION ?L?COM0454 (BEGIN) -----
B1:00D70E 7B01              MOV      R3,#01H
B1:00D710 7A33              MOV      R2,#HIGH ZW_RouteDestinations
B1:00D712 793C              MOV      R1,#LOW ZW_RouteDestinations
B1:00D714 22                RET      
----- FUNCTION ?L?COM0454 (END) -------


----- FUNCTION _ZW_RequestNewRouteDestinations (BEGIN) -----
B1:00D715 90447F            MOV      DPTR,#destList
B1:00D718 122572            LCALL    ?C?PSTXDATA
;---- Variable 'destListLen' assigned to Register 'R5' ----
;---- Variable 'i' assigned to Register 'R7' ----
B1:00D71B 9033A5            MOV      DPTR,#sucNodeID
B1:00D71E E0                MOVX     A,@DPTR
B1:00D71F 6005              JZ       ?C0284?ZW_SLAVE
B1:00D721 12C566            LCALL    ?L?COM03ED
B1:00D724 6002              JZ       ?C0283?ZW_SLAVE
B1:00D726         ?C0284?ZW_SLAVE:
B1:00D726 C3                CLR      C
B1:00D727 22                RET      
B1:00D728         ?C0283?ZW_SLAVE:
B1:00D728 E4                CLR      A
B1:00D729 FF                MOV      R7,A
B1:00D72A         ?C0286?ZW_SLAVE:
B1:00D72A EF                MOV      A,R7
B1:00D72B C3                CLR      C
B1:00D72C 9D                SUBB     A,R5
B1:00D72D 500E              JNC      ?C0289?ZW_SLAVE
B1:00D72F 90447F            MOV      DPTR,#destList
B1:00D732 122552            LCALL    ?C?PLDXDATA
B1:00D735 E9                MOV      A,R1
B1:00D736 2F                ADD      A,R7
B1:00D737 1285F5            LCALL    ?L?COM0004
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 386


B1:00D73A FE                MOV      R6,A
B1:00D73B 8002              SJMP     ?C0290?ZW_SLAVE
B1:00D73D         ?C0289?ZW_SLAVE:
B1:00D73D 7E00              MOV      R6,#00H
B1:00D73F         ?C0290?ZW_SLAVE:
B1:00D73F 12C508            LCALL    ?L?COM023D
B1:00D742 EE                MOV      A,R6
B1:00D743 F0                MOVX     @DPTR,A
B1:00D744 0F                INC      R7
B1:00D745 EF                MOV      A,R7
B1:00D746 B405E1            CJNE     A,#05H,?C0286?ZW_SLAVE
B1:00D749         ?C0287?ZW_SLAVE:
B1:00D749 7E11              MOV      R6,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00D74B 7F56              MOV      R7,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00D74D F10E              ACALL    ?L?COM0454
B1:00D74F 12ADB3            LCALL    ?L?COM0175
B1:00D752 7405              MOV      A,#05H
B1:00D754 F0                MOVX     @DPTR,A
B1:00D755 1239FB            LCALL    _NVM_ext_write_buffer
B1:00D758 904483            MOV      DPTR,#completedFunc
B1:00D75B E0                MOVX     A,@DPTR
B1:00D75C FC                MOV      R4,A
B1:00D75D A3                INC      DPTR
B1:00D75E E0                MOVX     A,@DPTR
B1:00D75F FD                MOV      R5,A
B1:00D760 7F01              MOV      R7,#01H
B1:00D762 514A              ACALL    _ZW_RequestNetworkUpdateInternal
B1:00D764 EF                MOV      A,R7
B1:00D765 24FF              ADD      A,#0FFH
B1:00D767 22                RET      
----- FUNCTION _ZW_RequestNewRouteDestinations (END) -------


----- FUNCTION ?L?COM0460 (BEGIN) -----
B1:00D768 122552            LCALL    ?C?PLDXDATA
B1:00D76B E9                MOV      A,R1
B1:00D76C 24E6              ADD      A,#0E6H
B1:00D76E 22                RET      
----- FUNCTION ?L?COM0460 (END) -------


----- FUNCTION ?L?COM046A (BEGIN) -----
B1:00D76F AF05              MOV      R7,AR5
B1:00D771 EC                MOV      A,R4
B1:00D772 F0                MOVX     @DPTR,A
B1:00D773 A3                INC      DPTR
B1:00D774 EF                MOV      A,R7
B1:00D775 22                RET      
----- FUNCTION ?L?COM046A (END) -------


----- FUNCTION ?L?COM0424 (BEGIN) -----
B1:00D776 F582              MOV      DPL,A
B1:00D778 E4                CLR      A
B1:00D779 3412              ADDC     A,#HIGH responseRouteNodeID-01H
B1:00D77B F583              MOV      DPH,A
B1:00D77D 22                RET      
----- FUNCTION ?L?COM0424 (END) -------


----- FUNCTION ?L?COM027B (BEGIN) -----
B1:00D77E 122552            LCALL    ?C?PLDXDATA
B1:00D781         ?L?COM027C:
B1:00D781 9009CC            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+0BH
B1:00D784 022572            LJMP     ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 387


----- FUNCTION ?L?COM027B (END) -------


----- FUNCTION ?L?COM04C5 (BEGIN) -----
B1:00D787 E4                CLR      A
B1:00D788 90336C            MOV      DPTR,#zensorWakeupTime
B1:00D78B F0                MOVX     @DPTR,A
B1:00D78C 90339E            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00D78F 04                INC      A
B1:00D790 22                RET      
----- FUNCTION ?L?COM04C5 (END) -------


----- FUNCTION _ConvertHeaderInfoToFrameType (BEGIN) -----
;---- Variable 'frameType' assigned to Register 'R1/R2/R3' ----
;---- Variable 'hdrInfo' assigned to Register 'R7' ----
B1:00D791 EF                MOV      A,R7
B1:00D792 540F              ANL      A,#0FH
B1:00D794 24FE              ADD      A,#0FEH
B1:00D796 6016              JZ       ?C0189?ZW_TRANSPORT
B1:00D798 14                DEC      A
B1:00D799 6017              JZ       ?C0190?ZW_TRANSPORT
B1:00D79B 14                DEC      A
B1:00D79C 6018              JZ       ?C0191?ZW_TRANSPORT
B1:00D79E 2403              ADD      A,#03H
B1:00D7A0 7019              JNZ      ?C0192?ZW_TRANSPORT
B1:00D7A2         ?C0186?ZW_TRANSPORT:
B1:00D7A2 EF                MOV      A,R7
B1:00D7A3 30E704            JNB      ACC.7,?C0187?ZW_TRANSPORT
B1:00D7A6 7404              MOV      A,#04H
B1:00D7A8 800E              SJMP     ?C0596?ZW_TRANSPORT
B1:00D7AA         ?C0187?ZW_TRANSPORT:
B1:00D7AA 7401              MOV      A,#01H
B1:00D7AC         
B1:00D7AC 800A              SJMP     ?C0596?ZW_TRANSPORT
B1:00D7AE         ?C0189?ZW_TRANSPORT:
B1:00D7AE 7402              MOV      A,#02H
B1:00D7B0         
B1:00D7B0 8006              SJMP     ?C0596?ZW_TRANSPORT
B1:00D7B2         ?C0190?ZW_TRANSPORT:
B1:00D7B2 7403              MOV      A,#03H
B1:00D7B4         
B1:00D7B4 8002              SJMP     ?C0596?ZW_TRANSPORT
B1:00D7B6         ?C0191?ZW_TRANSPORT:
B1:00D7B6 7405              MOV      A,#05H
B1:00D7B8         
B1:00D7B8 12203B            LCALL    ?C?CSTPTR
B1:00D7BB         ?C0192?ZW_TRANSPORT:
B1:00D7BB 22                RET      
----- FUNCTION _ConvertHeaderInfoToFrameType (END) -------


----- FUNCTION ZCB_DelayedRetransmitFail (BEGIN) -----
B1:00D7BC 90066C            MOV      DPTR,#delayCount
B1:00D7BF E0                MOVX     A,@DPTR
B1:00D7C0 D3                SETB     C
B1:00D7C1 9400              SUBB     A,#00H
B1:00D7C3 4008              JC       ?C0233?ZW_TRANSPORT
B1:00D7C5 E0                MOVX     A,@DPTR
B1:00D7C6 14                DEC      A
B1:00D7C7 F0                MOVX     @DPTR,A
B1:00D7C8 D3                SETB     C
B1:00D7C9 9400              SUBB     A,#00H
B1:00D7CB 5006              JNC      ?C0234?ZW_TRANSPORT
B1:00D7CD         ?C0233?ZW_TRANSPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 388


B1:00D7CD 1287CF            LCALL    TransmitTimerStop
B1:00D7D0 12A44F            LCALL    RetransmitFail
B1:00D7D3         ?C0234?ZW_TRANSPORT:
B1:00D7D3 22                RET      
----- FUNCTION ZCB_DelayedRetransmitFail (END) -------


----- FUNCTION _ZCB_ZWTransmitComplete (BEGIN) -----
B1:00D7D4 22                RET      
----- FUNCTION _ZCB_ZWTransmitComplete (END) -------


----- FUNCTION _RouteMatchesActive (BEGIN) -----
B1:00D7D5 900A94            MOV      DPTR,#repLen
B1:00D7D8 12D851            LCALL    ?L?COM01BA
B1:00D7DB 12851B            LCALL    ?L?COM000C
B1:00D7DE 4A                ORL      A,R2
B1:00D7DF C3                CLR      C
B1:00D7E0 6001              JZ       ?C0245?ZW_TRANSPORT
B1:00D7E2 D3                SETB     C
B1:00D7E3         ?C0245?ZW_TRANSPORT:
B1:00D7E3         ?C0246?ZW_TRANSPORT:
B1:00D7E3 5026              JNC      ?C0244?ZW_TRANSPORT
B1:00D7E5 E9                MOV      A,R1
B1:00D7E6 24BC              ADD      A,#0BCH
B1:00D7E8 1285F5            LCALL    ?L?COM0004
B1:00D7EB C4                SWAP     A
B1:00D7EC 540F              ANL      A,#0FH
B1:00D7EE FF                MOV      R7,A
B1:00D7EF 900A94            MOV      DPTR,#repLen
B1:00D7F2 E0                MOVX     A,@DPTR
B1:00D7F3 B50715            CJNE     A,AR7,?C0244?ZW_TRANSPORT
B1:00D7F6 12851B            LCALL    ?L?COM000C
B1:00D7F9 24BA              ADD      A,#0BAH
B1:00D7FB 1285F5            LCALL    ?L?COM0004
B1:00D7FE FF                MOV      R7,A
B1:00D7FF 900A95            MOV      DPTR,#fr
B1:00D802 129549            LCALL    ?L?COM0058
B1:00D805 1285F5            LCALL    ?L?COM0004
B1:00D808 6F                XRL      A,R7
B1:00D809 6002              JZ       ?C0243?ZW_TRANSPORT
B1:00D80B         ?C0244?ZW_TRANSPORT:
B1:00D80B C3                CLR      C
B1:00D80C 22                RET      
B1:00D80D         ?C0243?ZW_TRANSPORT:
B1:00D80D E4                CLR      A
B1:00D80E 900A98            MOV      DPTR,#i
B1:00D811 F0                MOVX     @DPTR,A
B1:00D812         ?C0248?ZW_TRANSPORT:
B1:00D812 900A94            MOV      DPTR,#repLen
B1:00D815 E0                MOVX     A,@DPTR
B1:00D816 FF                MOV      R7,A
B1:00D817 900A98            MOV      DPTR,#i
B1:00D81A E0                MOVX     A,@DPTR
B1:00D81B FE                MOV      R6,A
B1:00D81C C3                CLR      C
B1:00D81D 9F                SUBB     A,R7
B1:00D81E 502F              JNC      ?C0249?ZW_TRANSPORT
B1:00D820 900A95            MOV      DPTR,#fr
B1:00D823 122552            LCALL    ?C?PLDXDATA
B1:00D826 E9                MOV      A,R1
B1:00D827 240B              ADD      A,#0BH
B1:00D829 F9                MOV      R1,A
B1:00D82A E4                CLR      A
B1:00D82B 3A                ADDC     A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 389


B1:00D82C FA                MOV      R2,A
B1:00D82D EE                MOV      A,R6
B1:00D82E FF                MOV      R7,A
B1:00D82F 128EB2            LCALL    ?L?COM0130
B1:00D832 FA                MOV      R2,A
B1:00D833 121F7C            LCALL    ?C?CLDPTR
B1:00D836 FD                MOV      R5,A
B1:00D837 12851B            LCALL    ?L?COM000C
B1:00D83A 24BD              ADD      A,#0BDH
B1:00D83C 12B8C4            LCALL    ?L?COM002D
B1:00D83F 121F7C            LCALL    ?C?CLDPTR
B1:00D842 6D                XRL      A,R5
B1:00D843 6002              JZ       ?C0250?ZW_TRANSPORT
B1:00D845 C3                CLR      C
B1:00D846 22                RET      
B1:00D847         ?C0250?ZW_TRANSPORT:
B1:00D847 900A98            MOV      DPTR,#i
B1:00D84A E0                MOVX     A,@DPTR
B1:00D84B 04                INC      A
B1:00D84C F0                MOVX     @DPTR,A
B1:00D84D 80C3              SJMP     ?C0248?ZW_TRANSPORT
B1:00D84F         ?C0249?ZW_TRANSPORT:
B1:00D84F D3                SETB     C
B1:00D850 22                RET      
----- FUNCTION _RouteMatchesActive (END) -------


----- FUNCTION ?L?COM01BA (BEGIN) -----
B1:00D851 EF                MOV      A,R7
B1:00D852 F0                MOVX     @DPTR,A
B1:00D853 A3                INC      DPTR
B1:00D854 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01BA (END) -------


----- FUNCTION _send_and_raise (BEGIN) -----
B1:00D857 90448B            MOV      DPTR,#node
B1:00D85A 1151              ACALL    ?L?COM01BA
B1:00D85C 7A36              MOV      R2,#HIGH txopt
B1:00D85E 7911              MOV      R1,#LOW txopt
B1:00D860 12EA5A            LCALL    ?L?COM0097
B1:00D863 90448B            MOV      DPTR,#node
B1:00D866 E0                MOVX     A,@DPTR
B1:00D867 903611            MOV      DPTR,#txopt
B1:00D86A F0                MOVX     @DPTR,A
B1:00D86B 904490            MOV      DPTR,#txOptions
B1:00D86E E0                MOVX     A,@DPTR
B1:00D86F 903613            MOV      DPTR,#txopt+02H
B1:00D872 F0                MOVX     @DPTR,A
B1:00D873 7F00              MOV      R7,#00H
B1:00D875 303B02            JNB      secure,?C0054?ZW_SECURE_LEARN_SUPPORT
B1:00D878 7F04              MOV      R7,#04H
B1:00D87A         ?C0054?ZW_SECURE_LEARN_SUPPORT:
B1:00D87A         ?C0055?ZW_SECURE_LEARN_SUPPORT:
B1:00D87A 903615            MOV      DPTR,#txopt+04H
B1:00D87D EF                MOV      A,R7
B1:00D87E F0                MOVX     @DPTR,A
B1:00D87F 90448F            MOV      DPTR,#dataLength
B1:00D882 E0                MOVX     A,@DPTR
B1:00D883 FD                MOV      R5,A
B1:00D884 7A36              MOV      R2,#HIGH txopt
B1:00D886 7911              MOV      R1,#LOW txopt
B1:00D888 12EABA            LCALL    ?L?COM0150
B1:00D88B 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B1:00D88E 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_send_data_callback
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 390


B1:00D890 F0                MOVX     @DPTR,A
B1:00D891 A3                INC      DPTR
B1:00D892 7493              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_send_data_callback
B1:00D894 F0                MOVX     @DPTR,A
B1:00D895 90448C            MOV      DPTR,#pBufData
B1:00D898 122552            LCALL    ?C?PLDXDATA
B1:00D89B 1293D5            LCALL    _ZW_SendDataEx
B1:00D89E EF                MOV      A,R7
B1:00D89F 7006              JNZ      ?C0057?ZW_SECURE_LEARN_SUPPORT
B1:00D8A1 12B20D            LCALL    ?L?COM006D
B1:00D8A4 121D18            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00D8A7         ?C0057?ZW_SECURE_LEARN_SUPPORT:
B1:00D8A7 22                RET      
----- FUNCTION _send_and_raise (END) -------


----- FUNCTION _keystore_network_key_read_impl (BEGIN) -----
B1:00D8A8 904403            MOV      DPTR,#key_class
B1:00D8AB 1151              ACALL    ?L?COM01BA
B1:00D8AD 12AF2F            LCALL    ?L?COM02EC
B1:00D8B0 904403            MOV      DPTR,#key_class
B1:00D8B3 E0                MOVX     A,@DPTR
B1:00D8B4 FE                MOV      R6,A
B1:00D8B5 5F                ANL      A,R7
B1:00D8B6 7002              JNZ      ?C0020?ZW_KEYSTORE
B1:00D8B8 FF                MOV      R7,A
B1:00D8B9 22                RET      
B1:00D8BA         ?C0020?ZW_KEYSTORE:
B1:00D8BA 904403            MOV      DPTR,#key_class
B1:00D8BD E0                MOVX     A,@DPTR
B1:00D8BE FF                MOV      R7,A
B1:00D8BF 14                DEC      A
B1:00D8C0 FD                MOV      R5,A
B1:00D8C1 EF                MOV      A,R7
B1:00D8C2 5D                ANL      A,R5
B1:00D8C3 7005              JNZ      ?C0023?ZW_KEYSTORE
B1:00D8C5 EE                MOV      A,R6
B1:00D8C6 5487              ANL      A,#087H
B1:00D8C8 7003              JNZ      ?C0022?ZW_KEYSTORE
B1:00D8CA         ?C0023?ZW_KEYSTORE:
B1:00D8CA 7F00              MOV      R7,#00H
B1:00D8CC 22                RET      
B1:00D8CD         ?C0022?ZW_KEYSTORE:
B1:00D8CD 904403            MOV      DPTR,#key_class
B1:00D8D0 E0                MOVX     A,@DPTR
B1:00D8D1 FF                MOV      R7,A
B1:00D8D2 ED                MOV      A,R5
B1:00D8D3 12FCB5            LCALL    ?L?COM04C0
B1:00D8D6 5403              ANL      A,#03H
B1:00D8D8 F0                MOVX     @DPTR,A
B1:00D8D9 E0                MOVX     A,@DPTR
B1:00D8DA 904407            MOV      DPTR,#buf
B1:00D8DD 12FE48            LCALL    ?L?COM029D
B1:00D8E0 9044C0            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B1:00D8E3 7410              MOV      A,#010H
B1:00D8E5 F0                MOVX     @DPTR,A
B1:00D8E6 121B97            LCALL    ?INTERBANK_TABLE?_MemoryGetBuffer
B1:00D8E9 904407            MOV      DPTR,#buf
B1:00D8EC 12AEED            LCALL    ?L?COM01CA
B1:00D8EF 904404            MOV      DPTR,#p_scramble_key
B1:00D8F2 122552            LCALL    ?C?PLDXDATA
B1:00D8F5 517F              ACALL    _ZW_s2_key_scrambler_descramble
B1:00D8F7 7F01              MOV      R7,#01H
B1:00D8F9 22                RET      
----- FUNCTION _keystore_network_key_read_impl (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 391




----- FUNCTION _keystore_network_key_read (BEGIN) -----
B1:00D8FA 9045FD            MOV      DPTR,#buf
B1:00D8FD 122572            LCALL    ?C?PSTXDATA
;---- Variable 'key_class' assigned to Register 'R7' ----
B1:00D900 9045FD            MOV      DPTR,#buf
B1:00D903 122552            LCALL    ?C?PLDXDATA
B1:00D906 904407            MOV      DPTR,#?_keystore_network_key_read_impl?BYTE+04H
B1:00D909 9147              ACALL    ?L?COM0345
B1:00D90B 809B              SJMP     _keystore_network_key_read_impl
----- FUNCTION _keystore_network_key_read (END) -------


----- FUNCTION ?L?COM0055 (BEGIN) -----
B1:00D90D 900A07            MOV      DPTR,#pRxFrame
B1:00D910         ?L?COM0056:
B1:00D910 122552            LCALL    ?C?PLDXDATA
B1:00D913 E9                MOV      A,R1
B1:00D914 2407              ADD      A,#07H
B1:00D916 22                RET      
----- FUNCTION ?L?COM0055 (END) -------


----- FUNCTION ?L?COM0462 (BEGIN) -----
B1:00D917 900ACA            MOV      DPTR,#elm
B1:00D91A 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0462 (END) -------


----- FUNCTION _secure_learnIfaceL_send_scheme_report (BEGIN) -----
B1:00D91D 9041B1            MOV      DPTR,#node
B1:00D920 1224BA            LCALL    ?C?LSTXDATA
B1:00D923 12B20D            LCALL    ?L?COM006D
B1:00D926 121D3B            LCALL    ?INTERBANK_TABLE?_secure_learnIface_get_scheme
B1:00D929 9041BD            MOV      DPTR,#ctrlScheme
B1:00D92C EF                MOV      A,R7
B1:00D92D F0                MOVX     @DPTR,A
B1:00D92E 12B20D            LCALL    ?L?COM006D
B1:00D931 121D27            LCALL    ?INTERBANK_TABLE?_secure_learnIface_get_supported_schemes
B1:00D934 12703A            LCALL    ?L?COM04ED
B1:00D937 9041BD            MOV      DPTR,#ctrlScheme
B1:00D93A 125BD1            LCALL    ?L?COM02DC
B1:00D93D 12236C            LCALL    ?C?LAND
;---- Variable 'my_schemes' assigned to Register 'R7' ----
B1:00D940 514E              ACALL    ?L?COM057B
B1:00D942 7405              MOV      A,#05H
B1:00D944 F0                MOVX     @DPTR,A
B1:00D945 EF                MOV      A,R7
B1:00D946 30E003            JNB      ACC.0,?C0064?ZW_SECURE_LEARN_SUPPORT
B1:00D949 54FE              ANL      A,#0FEH
B1:00D94B FF                MOV      R7,A
B1:00D94C         ?C0064?ZW_SECURE_LEARN_SUPPORT:
B1:00D94C 903679            MOV      DPTR,#tx+02H
B1:00D94F EF                MOV      A,R7
B1:00D950 F0                MOVX     @DPTR,A
B1:00D951 9041B1            MOV      DPTR,#node
B1:00D954 122462            LCALL    ?C?LLDXDATA
B1:00D957 C007              PUSH     AR7
B1:00D959 7B01              MOV      R3,#01H
B1:00D95B 7A36              MOV      R2,#HIGH tx
B1:00D95D 7977              MOV      R1,#LOW tx
B1:00D95F 90448F            MOV      DPTR,#?_send_and_raise?BYTE+04H
B1:00D962 7403              MOV      A,#03H
B1:00D964 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 392


B1:00D965 9041B5            MOV      DPTR,#txOptions
B1:00D968 5156              ACALL    ?L?COM0513
B1:00D96A 9041B9            MOV      DPTR,#secure
B1:00D96D 1247EC            LCALL    ?L?COM057A
B1:00D970 24FF              ADD      A,#0FFH
B1:00D972 923B              MOV      ?_send_and_raise?BIT,C
B1:00D974 D007              POP      AR7
B1:00D976 0157              AJMP     _send_and_raise
----- FUNCTION _secure_learnIfaceL_send_scheme_report (END) -------


----- FUNCTION ?L?COM0483 (BEGIN) -----
B1:00D978 904572            MOV      DPTR,#pTransmittedFrame
B1:00D97B 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0483 (END) -------


----- FUNCTION secure_learnIface_update_callback (BEGIN) -----
B1:00D97E 22                RET      
----- FUNCTION secure_learnIface_update_callback (END) -------


----- FUNCTION _secure_learn_unsetTimer (BEGIN) -----
B1:00D97F 9045EB            MOV      DPTR,#evid
B1:00D982 122572            LCALL    ?C?PSTXDATA
B1:00D985         ?C0018?ZW_SECURE_LEARN_SUPPORT:
B1:00D985 7B01              MOV      R3,#01H
B1:00D987 7A36              MOV      R2,#HIGH timer
B1:00D989 791F              MOV      R1,#LOW timer
B1:00D98B 02AC63            LJMP     _ctimer_stop
----- FUNCTION _secure_learn_unsetTimer (END) -------


----- FUNCTION ?L?COM0138 (BEGIN) -----
B1:00D98E 121F7C            LCALL    ?C?CLDPTR
B1:00D991 C4                SWAP     A
B1:00D992 540F              ANL      A,#0FH
B1:00D994 04                INC      A
B1:00D995 FF                MOV      R7,A
B1:00D996 22                RET      
----- FUNCTION ?L?COM0138 (END) -------


----- FUNCTION ?L?COM0087 (BEGIN) -----
B1:00D997 7E00              MOV      R6,#00H
B1:00D999 9009D9            MOV      DPTR,#pData
B1:00D99C E0                MOVX     A,@DPTR
B1:00D99D FC                MOV      R4,A
B1:00D99E A3                INC      DPTR
B1:00D99F E0                MOVX     A,@DPTR
B1:00D9A0 7B01              MOV      R3,#01H
B1:00D9A2 240A              ADD      A,#0AH
B1:00D9A4 F9                MOV      R1,A
B1:00D9A5 E4                CLR      A
B1:00D9A6 3C                ADDC     A,R4
B1:00D9A7 FA                MOV      R2,A
B1:00D9A8 121F7C            LCALL    ?C?CLDPTR
B1:00D9AB C4                SWAP     A
B1:00D9AC 540F              ANL      A,#0FH
B1:00D9AE FD                MOV      R5,A
B1:00D9AF 7C00              MOV      R4,#00H
B1:00D9B1 9009D9            MOV      DPTR,#pData
B1:00D9B4 E0                MOVX     A,@DPTR
B1:00D9B5 FA                MOV      R2,A
B1:00D9B6 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 393


B1:00D9B7 E0                MOVX     A,@DPTR
B1:00D9B8 7B01              MOV      R3,#01H
B1:00D9BA         ?L?COM0088:
B1:00D9BA 240B              ADD      A,#0BH
B1:00D9BC         ?L?COM0089:
B1:00D9BC F9                MOV      R1,A
B1:00D9BD E4                CLR      A
B1:00D9BE 3A                ADDC     A,R2
B1:00D9BF FA                MOV      R2,A
B1:00D9C0 E9                MOV      A,R1
B1:00D9C1 2D                ADD      A,R5
B1:00D9C2 F9                MOV      R1,A
B1:00D9C3 EC                MOV      A,R4
B1:00D9C4 22                RET      
----- FUNCTION ?L?COM0087 (END) -------


----- FUNCTION CheckSeqNo (BEGIN) -----
B1:00D9C5 12FDE2            LCALL    ?L?COM058D
B1:00D9C8 6021              JZ       ?C0254?ZW_TRANSPORT
B1:00D9CA 90066D            MOV      DPTR,#currentSeqNoToMatch
B1:00D9CD E0                MOVX     A,@DPTR
B1:00D9CE FE                MOV      R6,A
B1:00D9CF EF                MOV      A,R7
B1:00D9D0 6E                XRL      A,R6
B1:00D9D1 6018              JZ       ?C0254?ZW_TRANSPORT
B1:00D9D3 12851B            LCALL    ?L?COM000C
B1:00D9D6 4A                ORL      A,R2
B1:00D9D7 6015              JZ       ?C0252?ZW_TRANSPORT
B1:00D9D9 E9                MOV      A,R1
B1:00D9DA 24B7              ADD      A,#0B7H
B1:00D9DC 1285F5            LCALL    ?L?COM0004
B1:00D9DF 30E70C            JNB      ACC.7,?C0252?ZW_TRANSPORT
B1:00D9E2 900787            MOV      DPTR,#currentSeqNo
B1:00D9E5 E0                MOVX     A,@DPTR
B1:00D9E6 54BF              ANL      A,#0BFH
B1:00D9E8 B50603            CJNE     A,AR6,?C0252?ZW_TRANSPORT
B1:00D9EB         ?C0254?ZW_TRANSPORT:
B1:00D9EB D3                SETB     C
B1:00D9EC 8001              SJMP     ?C0253?ZW_TRANSPORT
B1:00D9EE         ?C0252?ZW_TRANSPORT:
B1:00D9EE C3                CLR      C
B1:00D9EF         ?C0253?ZW_TRANSPORT:
B1:00D9EF 22                RET      
----- FUNCTION CheckSeqNo (END) -------


----- FUNCTION _secure_learnIface_send_commands_supported (BEGIN) -----
B1:00D9F0 9041A4            MOV      DPTR,#node
B1:00D9F3 1224BA            LCALL    ?C?LSTXDATA
B1:00D9F6 E4                CLR      A
B1:00D9F7 9041AC            MOV      DPTR,#scheme
B1:00D9FA F0                MOVX     @DPTR,A
B1:00D9FB A3                INC      DPTR
B1:00D9FC F0                MOVX     @DPTR,A
B1:00D9FD 514E              ACALL    ?L?COM057B
B1:00D9FF 7403              MOV      A,#03H
B1:00DA01 F0                MOVX     @DPTR,A
B1:00DA02 E4                CLR      A
B1:00DA03 A3                INC      DPTR
B1:00DA04 F0                MOVX     @DPTR,A
B1:00DA05 7B01              MOV      R3,#01H
B1:00DA07 7A41              MOV      R2,#HIGH cls_count
B1:00DA09 79AD              MOV      R1,#LOW cls_count
B1:00DA0B 904298            MOV      DPTR,#?_ApplicationSecureCommandsSupported?BYTE+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 394


B1:00DA0E 122572            LCALL    ?C?PSTXDATA
B1:00DA11 7A41              MOV      R2,#HIGH p
B1:00DA13 09                INC      R1
B1:00DA14 7F04              MOV      R7,#04H
B1:00DA16 121E7B            LCALL    ?INTERBANK_TABLE?_ApplicationSecureCommandsSupported
B1:00DA19 9041AD            MOV      DPTR,#cls_count
B1:00DA1C E0                MOVX     A,@DPTR
B1:00DA1D FF                MOV      R7,A
B1:00DA1E A3                INC      DPTR
B1:00DA1F 1287B6            LCALL    ?L?COM003E
B1:00DA22 7B01              MOV      R3,#01H
B1:00DA24 7A36              MOV      R2,#HIGH tx+03H
B1:00DA26 797A              MOV      R1,#LOW tx+03H
B1:00DA28 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00DA2B 9041A4            MOV      DPTR,#node
B1:00DA2E 122462            LCALL    ?C?LLDXDATA
B1:00DA31 C007              PUSH     AR7
B1:00DA33 7B01              MOV      R3,#01H
B1:00DA35 7A36              MOV      R2,#HIGH tx
B1:00DA37 7977              MOV      R1,#LOW tx
B1:00DA39 9041AD            MOV      DPTR,#cls_count
B1:00DA3C E0                MOVX     A,@DPTR
B1:00DA3D 2403              ADD      A,#03H
B1:00DA3F 90448F            MOV      DPTR,#?_send_and_raise?BYTE+04H
B1:00DA42 F0                MOVX     @DPTR,A
B1:00DA43 9041A8            MOV      DPTR,#txOptions
B1:00DA46 5156              ACALL    ?L?COM0513
B1:00DA48 D23B              SETB     ?_send_and_raise?BIT
B1:00DA4A D007              POP      AR7
B1:00DA4C 0157              AJMP     _send_and_raise
----- FUNCTION _secure_learnIface_send_commands_supported (END) -------


----- FUNCTION ?L?COM057B (BEGIN) -----
B1:00DA4E 903677            MOV      DPTR,#tx
B1:00DA51 7498              MOV      A,#098H
B1:00DA53 F0                MOVX     @DPTR,A
B1:00DA54 A3                INC      DPTR
B1:00DA55 22                RET      
----- FUNCTION ?L?COM057B (END) -------


----- FUNCTION ?L?COM0513 (BEGIN) -----
B1:00DA56 122462            LCALL    ?C?LLDXDATA
B1:00DA59 904490            MOV      DPTR,#?_send_and_raise?BYTE+05H
B1:00DA5C EF                MOV      A,R7
B1:00DA5D F0                MOVX     @DPTR,A
B1:00DA5E 22                RET      
----- FUNCTION ?L?COM0513 (END) -------


----- FUNCTION ?L?COM016C (BEGIN) -----
B1:00DA5F 90442A            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B1:00DA62 122572            LCALL    ?C?PSTXDATA
B1:00DA65 7B01              MOV      R3,#01H
B1:00DA67         ?L?COM016D:
B1:00DA67 7A12              MOV      R2,#HIGH homeID
B1:00DA69 7923              MOV      R1,#LOW homeID
B1:00DA6B         ?L?COM016E:
B1:00DA6B 7F04              MOV      R7,#04H
B1:00DA6D 121BB0            LCALL    ?INTERBANK_TABLE?___ZW_memcmp
B1:00DA70 EF                MOV      A,R7
B1:00DA71 22                RET      
----- FUNCTION ?L?COM016C (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 395



----- FUNCTION ?L?COM0343 (BEGIN) -----
B1:00DA72 7B01              MOV      R3,#01H
B1:00DA74 7A06              MOV      R2,#HIGH crH
B1:00DA76 7968              MOV      R1,#LOW crH
B1:00DA78 22                RET      
----- FUNCTION ?L?COM0343 (END) -------


----- FUNCTION ?L?COM03BB (BEGIN) -----
B1:00DA79 90434B            MOV      DPTR,#p_scramble_key
B1:00DA7C 122552            LCALL    ?C?PLDXDATA
----- FUNCTION _ZW_s2_key_scrambler_descramble (BEGIN) -----
;---- Variable 'p_scramble_key' assigned to Register 'R1/R2/R3' ----
B1:00DA7F C003              PUSH     AR3
B1:00DA81 C002              PUSH     AR2
B1:00DA83 C001              PUSH     AR1
B1:00DA85 7B01              MOV      R3,#01H
B1:00DA87 7A3E              MOV      R2,#HIGH random_aes_input
B1:00DA89 79DD              MOV      R1,#LOW random_aes_input
B1:00DA8B 12E31A            LCALL    ?L?COM00F1
B1:00DA8E 7A3E              MOV      R2,#HIGH aes_output
B1:00DA90 79ED              MOV      R1,#LOW aes_output
B1:00DA92 126E65            LCALL    ?L?COM0282
B1:00DA95 D001              POP      AR1
B1:00DA97 D002              POP      AR2
B1:00DA99 D003              POP      AR3
B1:00DA9B 121D77            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
B1:00DA9E E4                CLR      A
B1:00DA9F 904417            MOV      DPTR,#count_scram
B1:00DAA2 F0                MOVX     @DPTR,A
B1:00DAA3         ?C0001?ZW_S2_KEY_SCRAMBLER:
B1:00DAA3 904417            MOV      DPTR,#count_scram
B1:00DAA6 E0                MOVX     A,@DPTR
B1:00DAA7 FF                MOV      R7,A
B1:00DAA8 C3                CLR      C
B1:00DAA9 9410              SUBB     A,#010H
B1:00DAAB 502C              JNC      ?C0004?ZW_S2_KEY_SCRAMBLER
B1:00DAAD 904414            MOV      DPTR,#p_key
B1:00DAB0 122552            LCALL    ?C?PLDXDATA
B1:00DAB3 904417            MOV      DPTR,#count_scram
B1:00DAB6 E0                MOVX     A,@DPTR
B1:00DAB7 FE                MOV      R6,A
B1:00DAB8 F582              MOV      DPL,A
B1:00DABA B13F              ACALL    ?L?COM015E
B1:00DABC FD                MOV      R5,A
B1:00DABD 74ED              MOV      A,#LOW aes_output
B1:00DABF 2E                ADD      A,R6
B1:00DAC0 F582              MOV      DPL,A
B1:00DAC2 E4                CLR      A
B1:00DAC3 343E              ADDC     A,#HIGH aes_output
B1:00DAC5 F583              MOV      DPH,A
B1:00DAC7 E0                MOVX     A,@DPTR
B1:00DAC8 6D                XRL      A,R5
B1:00DAC9 8F82              MOV      DPL,R7
B1:00DACB 758300            MOV      DPH,#00H
B1:00DACE 12204D            LCALL    ?C?CSTOPTR
B1:00DAD1 904417            MOV      DPTR,#count_scram
B1:00DAD4 E0                MOVX     A,@DPTR
B1:00DAD5 04                INC      A
B1:00DAD6 F0                MOVX     @DPTR,A
B1:00DAD7 80CA              SJMP     ?C0001?ZW_S2_KEY_SCRAMBLER
B1:00DAD9         ?C0004?ZW_S2_KEY_SCRAMBLER:
B1:00DAD9 22                RET      
----- FUNCTION _ZW_s2_key_scrambler_descramble (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 396




----- FUNCTION _keystore_private_key_write (BEGIN) -----
B1:00DADA 9045FA            MOV      DPTR,#buf
B1:00DADD 122572            LCALL    ?C?PSTXDATA
B1:00DAE0 9045FA            MOV      DPTR,#buf
B1:00DAE3 12AEED            LCALL    ?L?COM01CA
B1:00DAE6 914A              ACALL    ?L?COM0346
B1:00DAE8 517F              ACALL    _ZW_s2_key_scrambler_descramble
B1:00DAEA 9045FA            MOV      DPTR,#buf
B1:00DAED 12CDE1            LCALL    ?L?COM0083
B1:00DAF0 FA                MOV      R2,A
B1:00DAF1 12AEF0            LCALL    ?L?COM01CB
B1:00DAF4 7BFF              MOV      R3,#0FFH
B1:00DAF6 7A40              MOV      R2,#040H
B1:00DAF8 790C              MOV      R1,#0CH
B1:00DAFA 517F              ACALL    _ZW_s2_key_scrambler_descramble
B1:00DAFC 9045FA            MOV      DPTR,#buf
B1:00DAFF 915B              ACALL    ?L?COM0432
B1:00DB01 90441D            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B1:00DB04 F16B              ACALL    ?L?COM00A8
B1:00DB06 021B9C            LJMP     ?INTERBANK_TABLE?_ZW_MemoryPutBuffer
----- FUNCTION _keystore_private_key_write (END) -------


----- FUNCTION _secure_learn_setTimer (BEGIN) -----
B1:00DB09 90431A            MOV      DPTR,#evid
B1:00DB0C 122572            LCALL    ?C?PSTXDATA
;---- Variable 'time_ms' assigned to Register 'R4/R5/R6/R7' ----
B1:00DB0F         ?C0016?ZW_SECURE_LEARN_SUPPORT:
B1:00DB0F 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B1:00DB12 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_timeout
B1:00DB14 F0                MOVX     @DPTR,A
B1:00DB15 A3                INC      DPTR
B1:00DB16 7498              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_timeout
B1:00DB18 F0                MOVX     @DPTR,A
B1:00DB19 90431A            MOV      DPTR,#evid
B1:00DB1C 122552            LCALL    ?C?PLDXDATA
B1:00DB1F 126F24            LCALL    ?L?COM0389
B1:00DB22 7A36              MOV      R2,#HIGH timer
B1:00DB24 791F              MOV      R1,#LOW timer
B1:;----                  JMP      _ctimer_set
----- FUNCTION _secure_learn_setTimer (END) -------


----- FUNCTION _ctimer_set (BEGIN) -----
B1:00DB26 904220            MOV      DPTR,#c
B1:00DB29 122572            LCALL    ?C?PSTXDATA
B1:00DB2C 904223            MOV      DPTR,#t
B1:00DB2F 1224BA            LCALL    ?C?LSTXDATA
B1:00DB32 904227            MOV      DPTR,#f
B1:00DB35 E0                MOVX     A,@DPTR
B1:00DB36 FE                MOV      R6,A
B1:00DB37 A3                INC      DPTR
B1:00DB38 E0                MOVX     A,@DPTR
B1:00DB39 FF                MOV      R7,A
B1:00DB3A 904220            MOV      DPTR,#c
B1:00DB3D 9165              ACALL    ?L?COM03BD
B1:00DB3F EE                MOV      A,R6
B1:00DB40 8FF0              MOV      B,R7
B1:00DB42 122207            LCALL    ?C?ISTOPTR
B1:00DB45 904229            MOV      DPTR,#ptr
B1:00DB48 122552            LCALL    ?C?PLDXDATA
B1:00DB4B C003              PUSH     AR3
B1:00DB4D C002              PUSH     AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 397


B1:00DB4F C001              PUSH     AR1
B1:00DB51 71EE              ACALL    ?L?COM0455
B1:00DB53 90000D            MOV      DPTR,#0DH
B1:00DB56 122626            LCALL    ?C?PSTOPTR
B1:00DB59 900000            MOV      DPTR,#timerCount
B1:00DB5C 1247AF            LCALL    ?L?COM0358
B1:00DB5F FD                MOV      R5,A
B1:00DB60 904223            MOV      DPTR,#t
B1:00DB63 12247E            LCALL    ?C?LLDXDATA0
B1:00DB66 122234            LCALL    ?C?LADD
B1:00DB69 71EE              ACALL    ?L?COM0455
B1:00DB6B 900003            MOV      DPTR,#03H
B1:00DB6E 12243E            LCALL    ?C?LSTOPTR
B1:00DB71 904223            MOV      DPTR,#t
B1:00DB74 122462            LCALL    ?C?LLDXDATA
B1:00DB77 900007            MOV      DPTR,#07H
B1:00DB7A 12243E            LCALL    ?C?LSTOPTR
B1:00DB7D 71EE              ACALL    ?L?COM0455
B1:00DB7F 9042BC            MOV      DPTR,#?_list_add?BYTE+03H
B1:00DB82 B116              ACALL    ?L?COM0259
B1:;----                  JMP      _list_add
----- FUNCTION _ctimer_set (END) -------


----- FUNCTION _list_add (BEGIN) -----
B1:00DB84 9042B9            MOV      DPTR,#list
B1:00DB87 122572            LCALL    ?C?PSTXDATA
B1:00DB8A C003              PUSH     AR3
B1:00DB8C C002              PUSH     AR2
B1:00DB8E C001              PUSH     AR1
B1:00DB90 9042BC            MOV      DPTR,#item
B1:00DB93 122552            LCALL    ?C?PLDXDATA
B1:00DB96 90420B            MOV      DPTR,#?_list_remove?BYTE+03H
B1:00DB99 122572            LCALL    ?C?PSTXDATA
B1:00DB9C D001              POP      AR1
B1:00DB9E D002              POP      AR2
B1:00DBA0 D003              POP      AR3
B1:00DBA2 12AC6F            LCALL    _list_remove
B1:00DBA5 12A79C            LCALL    ?L?COM00A4
B1:00DBA8 C003              PUSH     AR3
B1:00DBAA C002              PUSH     AR2
B1:00DBAC C001              PUSH     AR1
B1:00DBAE 9042BC            MOV      DPTR,#item
B1:00DBB1 122552            LCALL    ?C?PLDXDATA
B1:00DBB4 1225A7            LCALL    ?C?PSTPTR
B1:00DBB7 9042B9            MOV      DPTR,#list
B1:00DBBA 122552            LCALL    ?C?PLDXDATA
B1:00DBBD 12F740            LCALL    _list_tail
B1:00DBC0 9042BF            MOV      DPTR,#l
B1:00DBC3 122572            LCALL    ?C?PSTXDATA
B1:00DBC6 E9                MOV      A,R1
B1:00DBC7 4A                ORL      A,R2
B1:00DBC8 9042BC            MOV      DPTR,#item
B1:00DBCB 700E              JNZ      ?C0008?LIST
B1:00DBCD 122552            LCALL    ?C?PLDXDATA
B1:00DBD0 C003              PUSH     AR3
B1:00DBD2 C002              PUSH     AR2
B1:00DBD4 C001              PUSH     AR1
B1:00DBD6 9042B9            MOV      DPTR,#list
B1:00DBD9 800C              SJMP     ?C0021?LIST
B1:00DBDB         ?C0008?LIST:
B1:00DBDB 122552            LCALL    ?C?PLDXDATA
B1:00DBDE C003              PUSH     AR3
B1:00DBE0 C002              PUSH     AR2
B1:00DBE2 C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 398


B1:00DBE4 9042BF            MOV      DPTR,#l
B1:00DBE7         
B1:00DBE7 122552            LCALL    ?C?PLDXDATA
B1:00DBEA 1225A7            LCALL    ?C?PSTPTR
B1:00DBED 22                RET      
----- FUNCTION _list_add (END) -------


----- FUNCTION ?L?COM0455 (BEGIN) -----
B1:00DBEE 904220            MOV      DPTR,#c
B1:00DBF1 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0455 (END) -------


----- FUNCTION ?L?COM01F2 (BEGIN) -----
B1:00DBF4 FF                MOV      R7,A
B1:00DBF5 900A07            MOV      DPTR,#pRxFrame
B1:00DBF8         ?L?COM01F3:
B1:00DBF8 122552            LCALL    ?C?PLDXDATA
B1:00DBFB E9                MOV      A,R1
B1:00DBFC 2406              ADD      A,#06H
B1:00DBFE 22                RET      
----- FUNCTION ?L?COM01F2 (END) -------


----- FUNCTION _keystore_private_key_read (BEGIN) -----
B1:00DBFF 9045F4            MOV      DPTR,#buf
B1:00DC02 12F7FA            LCALL    ?L?COM02ED
B1:00DC05 4007              JC       ?C0010?ZW_KEYSTORE
B1:00DC07 121C41            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00DC0A EF                MOV      A,R7
B1:00DC0B F4                CPL      A
B1:00DC0C 7024              JNZ      ?C0009?ZW_KEYSTORE
B1:00DC0E         ?C0010?ZW_KEYSTORE:
B1:00DC0E 9045F4            MOV      DPTR,#buf
B1:00DC11 915B              ACALL    ?L?COM0432
B1:00DC13 12C73D            LCALL    ?L?COM0314
B1:00DC16 9045F4            MOV      DPTR,#buf
B1:00DC19 12AEED            LCALL    ?L?COM01CA
B1:00DC1C 914A              ACALL    ?L?COM0346
B1:00DC1E 517F              ACALL    _ZW_s2_key_scrambler_descramble
B1:00DC20 9045F4            MOV      DPTR,#buf
B1:00DC23 12CDE1            LCALL    ?L?COM0083
B1:00DC26 FA                MOV      R2,A
B1:00DC27 12AEF0            LCALL    ?L?COM01CB
B1:00DC2A 7BFF              MOV      R3,#0FFH
B1:00DC2C 7A40              MOV      R2,#040H
B1:00DC2E 790C              MOV      R1,#0CH
B1:00DC30 417F              AJMP     _ZW_s2_key_scrambler_descramble
B1:00DC32         ?C0009?ZW_KEYSTORE:
B1:00DC32 9045F4            MOV      DPTR,#buf
B1:00DC35 122552            LCALL    ?C?PLDXDATA
B1:00DC38 7D20              MOV      R5,#020H
B1:00DC3A 7F43              MOV      R7,#043H
B1:00DC3C 021C32            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION _keystore_private_key_read (END) -------


----- FUNCTION ?L?COM0530 (BEGIN) -----
B1:00DC3F E9                MOV      A,R1
B1:00DC40 24FF              ADD      A,#0FFH
B1:00DC42 F9                MOV      R1,A
B1:00DC43 EA                MOV      A,R2
B1:00DC44 34FF              ADDC     A,#0FFH
B1:00DC46 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 399


----- FUNCTION ?L?COM0530 (END) -------


----- FUNCTION ?L?COM0345 (BEGIN) -----
B1:00DC47 122572            LCALL    ?C?PSTXDATA
B1:00DC4A         ?L?COM0346:
B1:00DC4A 7BFF              MOV      R3,#0FFH
B1:00DC4C 7A3F              MOV      R2,#03FH
B1:00DC4E 79FC              MOV      R1,#0FCH
B1:00DC50 22                RET      
----- FUNCTION ?L?COM0345 (END) -------


----- FUNCTION ?L?COM046F (BEGIN) -----
B1:00DC51 900A10            MOV      DPTR,#btmpCmdClass
B1:00DC54 F0                MOVX     @DPTR,A
B1:00DC55 A3                INC      DPTR
B1:00DC56 122552            LCALL    ?C?PLDXDATA
B1:00DC59 E9                MOV      A,R1
B1:00DC5A 22                RET      
----- FUNCTION ?L?COM046F (END) -------


----- FUNCTION ?L?COM0432 (BEGIN) -----
B1:00DC5B 7E12              MOV      R6,#HIGH s2_private_key
B1:00DC5D 7F14              MOV      R7,#LOW s2_private_key
B1:00DC5F 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0432 (END) -------


----- FUNCTION ?L?COM03BC (BEGIN) -----
B1:00DC62 904511            MOV      DPTR,#c
B1:00DC65         ?L?COM03BD:
B1:00DC65 122552            LCALL    ?C?PLDXDATA
B1:00DC68 90000B            MOV      DPTR,#0BH
B1:00DC6B 22                RET      
----- FUNCTION ?L?COM03BC (END) -------


----- FUNCTION _ctimer_poll (BEGIN) -----
B1:00DC6C 90450F            MOV      DPTR,#bTicks
B1:00DC6F EE                MOV      A,R6
B1:00DC70 F0                MOVX     @DPTR,A
B1:00DC71 A3                INC      DPTR
B1:00DC72 EF                MOV      A,R7
B1:00DC73 F0                MOVX     @DPTR,A
B1:00DC74 B119              ACALL    ?L?COM025A
B1:00DC76 F185              ACALL    _list_head
B1:00DC78 A107              AJMP     ?C0012?ZW_CTIMER
B1:00DC7A         ?C0001?ZW_CTIMER:
B1:00DC7A 904511            MOV      DPTR,#c
B1:00DC7D 122552            LCALL    ?C?PLDXDATA
B1:00DC80 E9                MOV      A,R1
B1:00DC81 4A                ORL      A,R2
B1:00DC82 7002              JNZ      $ + 4H
B1:00DC84 A10F              AJMP     ?C0008?ZW_CTIMER
B1:00DC86 12700C            LCALL    ?L?COM04A8
B1:00DC89 EC                MOV      A,R4
B1:00DC8A 4D                ORL      A,R5
B1:00DC8B 4E                ORL      A,R6
B1:00DC8C 4F                ORL      A,R7
B1:00DC8D 606F              JZ       ?C0003?ZW_CTIMER
B1:00DC8F 900003            MOV      DPTR,#03H
B1:00DC92 12248A            LCALL    ?C?LLDOPTR0
B1:00DC95 90450F            MOV      DPTR,#bTicks
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 400


B1:00DC98 1247AF            LCALL    ?L?COM0358
B1:00DC9B FD                MOV      R5,A
B1:00DC9C D3                SETB     C
B1:00DC9D 12239D            LCALL    ?C?ULCMP
B1:00DCA0 5033              JNC      ?C0005?ZW_CTIMER
B1:00DCA2 904511            MOV      DPTR,#c
B1:00DCA5 B110              ACALL    ?L?COM0258
B1:00DCA7 12AC6F            LCALL    _list_remove
B1:00DCAA 9162              ACALL    ?L?COM03BC
B1:00DCAC 122163            LCALL    ?C?ILDOPTR
B1:00DCAF 45F0              ORL      A,B
B1:00DCB1 601D              JZ       ?C0006?ZW_CTIMER
B1:00DCB3 90000D            MOV      DPTR,#0DH
B1:00DCB6 1225F6            LCALL    ?C?PLDOPTR
B1:00DCB9 C003              PUSH     AR3
B1:00DCBB C002              PUSH     AR2
B1:00DCBD C001              PUSH     AR1
B1:00DCBF 9162              ACALL    ?L?COM03BC
B1:00DCC1 122163            LCALL    ?C?ILDOPTR
B1:00DCC4 12FEC6            LCALL    ?L?COM0511
B1:00DCC7 D001              POP      AR1
B1:00DCC9 D002              POP      AR2
B1:00DCCB D003              POP      AR3
B1:00DCCD 1226E3            LCALL    ?C?ICALL2
B1:00DCD0         ?C0006?ZW_CTIMER:
B1:00DCD0 124724            LCALL    ZW_Poll
B1:00DCD3 8029              SJMP     ?C0003?ZW_CTIMER
B1:00DCD5         ?C0005?ZW_CTIMER:
B1:00DCD5 904511            MOV      DPTR,#c
B1:00DCD8 125D4E            LCALL    ?L?COM00AF
B1:00DCDB C003              PUSH     AR3
B1:00DCDD C002              PUSH     AR2
B1:00DCDF C001              PUSH     AR1
B1:00DCE1 1223D4            LCALL    ?C?LLDPTR
B1:00DCE4 C006              PUSH     AR6
B1:00DCE6 C007              PUSH     AR7
B1:00DCE8 90450F            MOV      DPTR,#bTicks
B1:00DCEB 12652A            LCALL    ?L?COM01DC
B1:00DCEE D007              POP      AR7
B1:00DCF0 D006              POP      AR6
B1:00DCF2 122241            LCALL    ?C?LSUB
B1:00DCF5 D001              POP      AR1
B1:00DCF7 D002              POP      AR2
B1:00DCF9 D003              POP      AR3
B1:00DCFB 122424            LCALL    ?C?LSTPTR
B1:00DCFE         ?C0003?ZW_CTIMER:
B1:00DCFE 904511            MOV      DPTR,#c
B1:00DD01 122552            LCALL    ?C?PLDXDATA
B1:00DD04 122587            LCALL    ?C?PLDPTR
B1:00DD07         
B1:00DD07 904511            MOV      DPTR,#c
B1:00DD0A 122572            LCALL    ?C?PSTXDATA
B1:00DD0D 817A              AJMP     ?C0001?ZW_CTIMER
B1:00DD0F         ?C0008?ZW_CTIMER:
B1:00DD0F 22                RET      
----- FUNCTION _ctimer_poll (END) -------


----- FUNCTION ?L?COM0258 (BEGIN) -----
B1:00DD10 122552            LCALL    ?C?PLDXDATA
B1:00DD13 90420B            MOV      DPTR,#?_list_remove?BYTE+03H
B1:00DD16         ?L?COM0259:
B1:00DD16 122572            LCALL    ?C?PSTXDATA
B1:00DD19         ?L?COM025A:
B1:00DD19 904497            MOV      DPTR,#ctimer_list
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 401


B1:00DD1C 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0258 (END) -------


----- FUNCTION ctimer_init (BEGIN) -----
B1:00DD1F B119              ACALL    ?L?COM025A
B1:;----                  JMP      _list_init
----- FUNCTION ctimer_init (END) -------


----- FUNCTION _list_init (BEGIN) -----
B1:00DD21 9045E5            MOV      DPTR,#list
B1:00DD24 122572            LCALL    ?C?PSTXDATA
B1:00DD27 12A79C            LCALL    ?L?COM00A4
B1:00DD2A C003              PUSH     AR3
B1:00DD2C C002              PUSH     AR2
B1:00DD2E C001              PUSH     AR1
B1:00DD30 9045E5            MOV      DPTR,#list
B1:00DD33 122552            LCALL    ?C?PLDXDATA
B1:00DD36 1225A7            LCALL    ?C?PSTPTR
B1:00DD39 22                RET      
----- FUNCTION _list_init (END) -------


----- FUNCTION ?L?COM015C (BEGIN) -----
B1:00DD3A 122552            LCALL    ?C?PLDXDATA
B1:00DD3D         ?L?COM015D:
B1:00DD3D 8F82              MOV      DPL,R7
B1:00DD3F         ?L?COM015E:
B1:00DD3F 758300            MOV      DPH,#00H
B1:00DD42 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM015C (END) -------


----- FUNCTION _xor_128 (BEGIN) -----
B1:00DD45 9042D4            MOV      DPTR,#a
B1:00DD48 122572            LCALL    ?C?PSTXDATA
;---- Variable 'count' assigned to Register 'R7' ----
B1:00DD4B E4                CLR      A
B1:00DD4C FF                MOV      R7,A
B1:00DD4D         ?C0001?AES_CMAC:
B1:00DD4D 9042D7            MOV      DPTR,#b
B1:00DD50 B13A              ACALL    ?L?COM015C
B1:00DD52 FE                MOV      R6,A
B1:00DD53 9042D4            MOV      DPTR,#a
B1:00DD56 B13A              ACALL    ?L?COM015C
B1:00DD58 6E                XRL      A,R6
B1:00DD59 FE                MOV      R6,A
B1:00DD5A 9042DA            MOV      DPTR,#out
B1:00DD5D F189              ACALL    ?L?COM02B2
B1:00DD5F 0F                INC      R7
B1:00DD60 EF                MOV      A,R7
B1:00DD61 B410E9            CJNE     A,#010H,?C0001?AES_CMAC
B1:00DD64 22                RET      
----- FUNCTION _xor_128 (END) -------


----- FUNCTION ?L?COM0157 (BEGIN) -----
B1:00DD65 122552            LCALL    ?C?PLDXDATA
B1:00DD68         ?L?COM0158:
B1:00DD68 9038E1            MOV      DPTR,#?_aes_cmac_calculate?BYTE+08H
B1:00DD6B 122572            LCALL    ?C?PSTXDATA
B1:00DD6E 903DC0            MOV      DPTR,#network_key
B1:00DD71 122552            LCALL    ?C?PLDXDATA
----- FUNCTION _aes_cmac_calculate (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 402


B1:00DD74 9038D9            MOV      DPTR,#key
B1:00DD77 122572            LCALL    ?C?PSTXDATA
B1:00DD7A C003              PUSH     AR3
B1:00DD7C C002              PUSH     AR2
B1:00DD7E C001              PUSH     AR1
B1:00DD80 7B01              MOV      R3,#01H
B1:00DD82 7A39              MOV      R2,#HIGH K1
B1:00DD84 7924              MOV      R1,#LOW K1
B1:00DD86 903B72            MOV      DPTR,#?_generate_subkey?BYTE+03H
B1:00DD89 122572            LCALL    ?C?PSTXDATA
B1:00DD8C 7A39              MOV      R2,#HIGH K2
B1:00DD8E 7934              MOV      R1,#LOW K2
B1:00DD90 903B75            MOV      DPTR,#?_generate_subkey?BYTE+06H
B1:00DD93 122572            LCALL    ?C?PSTXDATA
B1:00DD96 D001              POP      AR1
B1:00DD98 D002              POP      AR2
B1:00DD9A D003              POP      AR3
B1:00DD9C 12E257            LCALL    _generate_subkey
B1:00DD9F 9038DF            MOV      DPTR,#message_length
B1:00DDA2 E0                MOVX     A,@DPTR
B1:00DDA3 FC                MOV      R4,A
B1:00DDA4 A3                INC      DPTR
B1:00DDA5 E0                MOVX     A,@DPTR
B1:00DDA6 FD                MOV      R5,A
B1:00DDA7 240F              ADD      A,#0FH
B1:00DDA9 FF                MOV      R7,A
B1:00DDAA E4                CLR      A
B1:00DDAB 3C                ADDC     A,R4
B1:00DDAC C4                SWAP     A
B1:00DDAD F8                MOV      R0,A
B1:00DDAE 54F0              ANL      A,#0F0H
B1:00DDB0 C8                XCH      A,R0
B1:00DDB1 EF                MOV      A,R7
B1:00DDB2 C4                SWAP     A
B1:00DDB3 540F              ANL      A,#0FH
B1:00DDB5 48                ORL      A,R0
B1:00DDB6 903945            MOV      DPTR,#n
B1:00DDB9 F0                MOVX     @DPTR,A
B1:00DDBA 7004              JNZ      ?C0024?AES_CMAC
B1:00DDBC 04                INC      A
B1:00DDBD F0                MOVX     @DPTR,A
B1:00DDBE 800C              SJMP     ?C0049?AES_CMAC
B1:00DDC0         ?C0024?AES_CMAC:
B1:00DDC0 ED                MOV      A,R5
B1:00DDC1 540F              ANL      A,#0FH
B1:00DDC3 7007              JNZ      ?C0026?AES_CMAC
B1:00DDC5 903944            MOV      DPTR,#flag
B1:00DDC8 04                INC      A
B1:00DDC9 F0                MOVX     @DPTR,A
B1:00DDCA 8005              SJMP     ?C0025?AES_CMAC
B1:00DDCC         ?C0026?AES_CMAC:
B1:00DDCC         
B1:00DDCC E4                CLR      A
B1:00DDCD 903944            MOV      DPTR,#flag
B1:00DDD0 F0                MOVX     @DPTR,A
B1:00DDD1         ?C0025?AES_CMAC:
B1:00DDD1 903944            MOV      DPTR,#flag
B1:00DDD4 E0                MOVX     A,@DPTR
B1:00DDD5 6028              JZ       ?C0028?AES_CMAC
B1:00DDD7 A3                INC      DPTR
B1:00DDD8 12FDCD            LCALL    ?L?COM0215
B1:00DDDB 48                ORL      A,R0
B1:00DDDC FE                MOV      R6,A
B1:00DDDD 9038DC            MOV      DPTR,#message
B1:00DDE0 12E598            LCALL    ?L?COM0079
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 403


B1:00DDE3 C003              PUSH     AR3
B1:00DDE5 C002              PUSH     AR2
B1:00DDE7 C001              PUSH     AR1
B1:00DDE9 7B01              MOV      R3,#01H
B1:00DDEB 7A39              MOV      R2,#HIGH K1
B1:00DDED 7924              MOV      R1,#LOW K1
B1:00DDEF F13F              ACALL    ?L?COM01EF
B1:00DDF1 12FDB4            LCALL    ?L?COM0538
B1:00DDF4 122572            LCALL    ?C?PSTXDATA
B1:00DDF7 D001              POP      AR1
B1:00DDF9 D002              POP      AR2
B1:00DDFB D003              POP      AR3
B1:00DDFD 8045              SJMP     ?C0050?AES_CMAC
B1:00DDFF         ?C0028?AES_CMAC:
B1:00DDFF 903945            MOV      DPTR,#n
B1:00DE02 12FDCD            LCALL    ?L?COM0215
B1:00DE05 48                ORL      A,R0
B1:00DE06 FE                MOV      R6,A
B1:00DE07 9038DC            MOV      DPTR,#message
B1:00DE0A 12E598            LCALL    ?L?COM0079
B1:00DE0D C003              PUSH     AR3
B1:00DE0F C002              PUSH     AR2
B1:00DE11 C001              PUSH     AR1
B1:00DE13 7B01              MOV      R3,#01H
B1:00DE15 7A39              MOV      R2,#HIGH padded
B1:00DE17 7914              MOV      R1,#LOW padded
B1:00DE19 90440D            MOV      DPTR,#?_padding?BYTE+03H
B1:00DE1C 122572            LCALL    ?C?PSTXDATA
B1:00DE1F 9038E0            MOV      DPTR,#message_length+01H
B1:00DE22 E0                MOVX     A,@DPTR
B1:00DE23 540F              ANL      A,#0FH
B1:00DE25 904410            MOV      DPTR,#?_padding?BYTE+06H
B1:00DE28 F0                MOVX     @DPTR,A
B1:00DE29 D001              POP      AR1
B1:00DE2B D002              POP      AR2
B1:00DE2D D003              POP      AR3
B1:00DE2F 12E1A7            LCALL    _padding
B1:00DE32 7B01              MOV      R3,#01H
B1:00DE34 7A39              MOV      R2,#HIGH K2
B1:00DE36 7934              MOV      R1,#LOW K2
B1:00DE38 F13F              ACALL    ?L?COM01EF
B1:00DE3A 12FDB4            LCALL    ?L?COM0538
B1:00DE3D 122572            LCALL    ?C?PSTXDATA
B1:00DE40 7A39              MOV      R2,#HIGH padded
B1:00DE42 7914              MOV      R1,#LOW padded
B1:00DE44         
B1:00DE44 B145              ACALL    _xor_128
B1:00DE46         ?C0029?AES_CMAC:
B1:00DE46 E4                CLR      A
B1:00DE47 903946            MOV      DPTR,#i
B1:00DE4A F0                MOVX     @DPTR,A
B1:00DE4B         ?C0030?AES_CMAC:
B1:00DE4B 903946            MOV      DPTR,#i
B1:00DE4E E0                MOVX     A,@DPTR
B1:00DE4F FF                MOV      R7,A
B1:00DE50 C3                CLR      C
B1:00DE51 9410              SUBB     A,#010H
B1:00DE53 500C              JNC      ?C0031?AES_CMAC
B1:00DE55 74E4              MOV      A,#LOW X
B1:00DE57 2F                ADD      A,R7
B1:00DE58 12FDBC            LCALL    ?L?COM0574
B1:00DE5B E4                CLR      A
B1:00DE5C F0                MOVX     @DPTR,A
B1:00DE5D F172              ACALL    ?L?COM04B8
B1:00DE5F 80EA              SJMP     ?C0030?AES_CMAC
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 404


B1:00DE61         ?C0031?AES_CMAC:
B1:00DE61 E4                CLR      A
B1:00DE62 903946            MOV      DPTR,#i
B1:00DE65 F0                MOVX     @DPTR,A
B1:00DE66         ?C0033?AES_CMAC:
B1:00DE66 903945            MOV      DPTR,#n
B1:00DE69 E0                MOVX     A,@DPTR
B1:00DE6A 14                DEC      A
B1:00DE6B FF                MOV      R7,A
B1:00DE6C A3                INC      DPTR
B1:00DE6D E0                MOVX     A,@DPTR
B1:00DE6E FE                MOV      R6,A
B1:00DE6F C3                CLR      C
B1:00DE70 9F                SUBB     A,R7
B1:00DE71 5028              JNC      ?C0034?AES_CMAC
B1:00DE73 EE                MOV      A,R6
B1:00DE74 75F010            MOV      B,#010H
B1:00DE77 A4                MUL      AB
B1:00DE78 FF                MOV      R7,A
B1:00DE79 9038DC            MOV      DPTR,#message
B1:00DE7C 122552            LCALL    ?C?PLDXDATA
B1:00DE7F E9                MOV      A,R1
B1:00DE80 2F                ADD      A,R7
B1:00DE81 F9                MOV      R1,A
B1:00DE82 EA                MOV      A,R2
B1:00DE83 35F0              ADDC     A,B
B1:00DE85 FA                MOV      R2,A
B1:00DE86 F13F              ACALL    ?L?COM01EF
B1:00DE88 7B01              MOV      R3,#01H
B1:00DE8A 12E303            LCALL    ?L?COM00F0
B1:00DE8D 7A38              MOV      R2,#HIGH X
B1:00DE8F 79E4              MOV      R1,#LOW X
B1:00DE91 126E65            LCALL    ?L?COM0282
B1:00DE94 12FDC4            LCALL    ?L?COM03B9
B1:00DE97 F172              ACALL    ?L?COM04B8
B1:00DE99 80CB              SJMP     ?C0033?AES_CMAC
B1:00DE9B         ?C0034?AES_CMAC:
B1:00DE9B 7B01              MOV      R3,#01H
B1:00DE9D 7A39              MOV      R2,#HIGH M_last
B1:00DE9F 7904              MOV      R1,#LOW M_last
B1:00DEA1 F13F              ACALL    ?L?COM01EF
B1:00DEA3 12E303            LCALL    ?L?COM00F0
B1:00DEA6 7A38              MOV      R2,#HIGH X
B1:00DEA8 79E4              MOV      R1,#LOW X
B1:00DEAA 126E65            LCALL    ?L?COM0282
B1:00DEAD 12FDC4            LCALL    ?L?COM03B9
B1:00DEB0 E4                CLR      A
B1:00DEB1 903946            MOV      DPTR,#i
B1:00DEB4 F0                MOVX     @DPTR,A
B1:00DEB5         ?C0036?AES_CMAC:
B1:00DEB5 903946            MOV      DPTR,#i
B1:00DEB8 E0                MOVX     A,@DPTR
B1:00DEB9 FF                MOV      R7,A
B1:00DEBA 24E4              ADD      A,#LOW X
B1:00DEBC 12FDBC            LCALL    ?L?COM0574
B1:00DEBF E0                MOVX     A,@DPTR
B1:00DEC0 9038E1            MOV      DPTR,#mac
B1:00DEC3 F188              ACALL    ?L?COM02B1
B1:00DEC5 F172              ACALL    ?L?COM04B8
B1:00DEC7 E0                MOVX     A,@DPTR
B1:00DEC8 B410EA            CJNE     A,#010H,?C0036?AES_CMAC
B1:00DECB 22                RET      
----- FUNCTION _aes_cmac_calculate (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 405


----- FUNCTION _generic_expand (BEGIN) -----
B1:00DECC 903DC0            MOV      DPTR,#network_key
B1:00DECF 122572            LCALL    ?C?PSTXDATA
B1:00DED2 78CF              MOV      R0,#LOW temp
B1:00DED4 7C3D              MOV      R4,#HIGH temp
B1:00DED6 F149              ACALL    ?L?COM0110
B1:00DED8 903DDE            MOV      DPTR,#temp+0FH
B1:00DEDB 7401              MOV      A,#01H
B1:00DEDD F0                MOVX     @DPTR,A
B1:00DEDE FB                MOV      R3,A
B1:00DEDF 7A3D              MOV      R2,#HIGH temp
B1:00DEE1 79CF              MOV      R1,#LOW temp
B1:00DEE3 12F929            LCALL    ?L?COM047B
B1:00DEE6 9038DF            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00DEE9 12CF6E            LCALL    ?L?COM00CC
B1:00DEEC 903DC6            MOV      DPTR,#ccm_key
B1:00DEEF B165              ACALL    ?L?COM0157
B1:00DEF1 78CF              MOV      R0,#LOW temp
B1:00DEF3 7C3D              MOV      R4,#HIGH temp
B1:00DEF5 903DC6            MOV      DPTR,#ccm_key
B1:00DEF8 F179              ACALL    ?L?COM0084
B1:00DEFA F145              ACALL    ?L?COM010F
B1:00DEFC 7402              MOV      A,#02H
B1:00DEFE F158              ACALL    ?L?COM00A5
B1:00DF00 903DC9            MOV      DPTR,#nonce_pstring
B1:00DF03 B165              ACALL    ?L?COM0157
B1:00DF05 78CF              MOV      R0,#LOW temp
B1:00DF07 7C3D              MOV      R4,#HIGH temp
B1:00DF09 7D01              MOV      R5,#01H
B1:00DF0B 903DC9            MOV      DPTR,#nonce_pstring
B1:00DF0E F17B              ACALL    ?L?COM0085
B1:00DF10 F145              ACALL    ?L?COM010F
B1:00DF12 903DEE            MOV      DPTR,#temp+01FH
B1:00DF15 7403              MOV      A,#03H
B1:00DF17 F15B              ACALL    ?L?COM00A6
B1:00DF19 12CDDE            LCALL    ?L?COM0082
B1:00DF1C FA                MOV      R2,A
B1:00DF1D B168              ACALL    ?L?COM0158
B1:00DF1F 12CDDE            LCALL    ?L?COM0082
B1:00DF22 FA                MOV      R2,A
B1:00DF23 78CF              MOV      R0,#LOW temp
B1:00DF25 7C3D              MOV      R4,#HIGH temp
B1:00DF27 7D01              MOV      R5,#01H
B1:00DF29 F17E              ACALL    ?L?COM0086
B1:00DF2B F145              ACALL    ?L?COM010F
B1:00DF2D 7404              MOV      A,#04H
B1:00DF2F F158              ACALL    ?L?COM00A5
B1:00DF31 903DCC            MOV      DPTR,#mpan_key
B1:00DF34 A165              AJMP     ?L?COM0157
----- FUNCTION _generic_expand (END) -------


----- FUNCTION ?L?COM01EE (BEGIN) -----
B1:00DF36 12E1ED            LCALL    _leftshift_onebit
B1:00DF39 7B01              MOV      R3,#01H
B1:00DF3B 7A3B              MOV      R2,#HIGH const_Rb
B1:00DF3D 79A8              MOV      R1,#LOW const_Rb
B1:00DF3F         ?L?COM01EF:
B1:00DF3F 9042D7            MOV      DPTR,#?_xor_128?BYTE+03H
B1:00DF42 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01EE (END) -------


----- FUNCTION ?L?COM010F (BEGIN) -----
B1:00DF45 78DF              MOV      R0,#LOW temp+010H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 406


B1:00DF47 7C3D              MOV      R4,#HIGH temp+010H
B1:00DF49         ?L?COM0110:
B1:00DF49 7D01              MOV      R5,#01H
B1:00DF4B 903DC3            MOV      DPTR,#constant_nk
B1:00DF4E 122552            LCALL    ?C?PLDXDATA
B1:00DF51         ?L?COM0111:
B1:00DF51 7E00              MOV      R6,#00H
B1:00DF53 7F0F              MOV      R7,#0FH
B1:00DF55 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM010F (END) -------


----- FUNCTION ?L?COM00A5 (BEGIN) -----
B1:00DF58 903DEE            MOV      DPTR,#temp+01FH
B1:00DF5B         ?L?COM00A6:
B1:00DF5B F0                MOVX     @DPTR,A
B1:00DF5C 7B01              MOV      R3,#01H
B1:00DF5E 7A3D              MOV      R2,#HIGH temp
B1:00DF60 79CF              MOV      R1,#LOW temp
B1:00DF62         ?L?COM00A7:
B1:00DF62 9038DC            MOV      DPTR,#?_aes_cmac_calculate?BYTE+03H
B1:00DF65 122572            LCALL    ?C?PSTXDATA
B1:00DF68 9038DF            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00DF6B         ?L?COM00A8:
B1:00DF6B E4                CLR      A
B1:00DF6C F0                MOVX     @DPTR,A
B1:00DF6D A3                INC      DPTR
B1:00DF6E 7420              MOV      A,#020H
B1:00DF70 F0                MOVX     @DPTR,A
B1:00DF71 22                RET      
----- FUNCTION ?L?COM00A5 (END) -------


----- FUNCTION ?L?COM04B8 (BEGIN) -----
B1:00DF72 903946            MOV      DPTR,#i
B1:00DF75 E0                MOVX     A,@DPTR
B1:00DF76 04                INC      A
B1:00DF77 F0                MOVX     @DPTR,A
B1:00DF78 22                RET      
----- FUNCTION ?L?COM04B8 (END) -------


----- FUNCTION ?L?COM0084 (BEGIN) -----
B1:00DF79 7D01              MOV      R5,#01H
B1:00DF7B         ?L?COM0085:
B1:00DF7B 122552            LCALL    ?C?PLDXDATA
B1:00DF7E         ?L?COM0086:
B1:00DF7E 7E00              MOV      R6,#00H
B1:00DF80 7F10              MOV      R7,#010H
B1:00DF82 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM0084 (END) -------


----- FUNCTION _list_head (BEGIN) -----
;---- Variable 'list' assigned to Register 'R1/R2/R3' ----
B1:00DF85 022587            LJMP     ?C?PLDPTR
----- FUNCTION _list_head (END) -------


----- FUNCTION ?L?COM02B1 (BEGIN) -----
B1:00DF88 FE                MOV      R6,A
B1:00DF89         ?L?COM02B2:
B1:00DF89 122552            LCALL    ?C?PLDXDATA
B1:00DF8C 8F82              MOV      DPL,R7
B1:00DF8E 758300            MOV      DPH,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 407


B1:00DF91 EE                MOV      A,R6
B1:00DF92 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM02B1 (END) -------


----- FUNCTION _ZW_SetListenBeforeTalkThreshold (BEGIN) -----
;---- Variable 'bChannel' assigned to Register 'R7' ----
;---- Variable 'bThreshold' assigned to Register 'R5' ----
B1:00DF95 EF                MOV      A,R7
B1:00DF96 C3                CLR      C
B1:00DF97 9403              SUBB     A,#03H
B1:00DF99 5008              JNC      ?C0362?ZW_TRANSPORT
B1:00DF9B 7464              MOV      A,#LOW bListenRSSIThreshold
B1:00DF9D 2F                ADD      A,R7
B1:00DF9E 127084            LCALL    ?L?COM058C
B1:00DFA1 ED                MOV      A,R5
B1:00DFA2 F0                MOVX     @DPTR,A
B1:00DFA3         ?C0362?ZW_TRANSPORT:
B1:00DFA3 22                RET      
----- FUNCTION _ZW_SetListenBeforeTalkThreshold (END) -------


----- FUNCTION _SetSpeedOptions (BEGIN) -----
;---- Variable 'bOldOptions' assigned to Register 'R7' ----
;---- Variable 'bNewOption' assigned to Register 'R5' ----
B1:00DFA4 EF                MOV      A,R7
B1:00DFA5 54F8              ANL      A,#0F8H
B1:00DFA7 4D                ORL      A,R5
B1:00DFA8 FF                MOV      R7,A
B1:00DFA9 22                RET      
----- FUNCTION _SetSpeedOptions (END) -------


----- FUNCTION _ZW_Transport_CommandClassVersionGet (BEGIN) -----
;---- Variable 'commandClass' assigned to Register 'R7' ----
B1:00DFAA EF                MOV      A,R7
B1:00DFAB 24AB              ADD      A,#0ABH
B1:00DFAD 600B              JZ       ?C0373?ZW_TRANSPORT
B1:00DFAF 24B6              ADD      A,#0B6H
B1:00DFB1 6004              JZ       ?C0370?ZW_TRANSPORT
B1:00DFB3 2407              ADD      A,#07H
B1:00DFB5 7006              JNZ      ?C0374?ZW_TRANSPORT
B1:00DFB7         ?C0370?ZW_TRANSPORT:
B1:00DFB7 7F01              MOV      R7,#01H
B1:00DFB9 22                RET      
B1:00DFBA         ?C0373?ZW_TRANSPORT:
B1:00DFBA 7F02              MOV      R7,#02H
B1:00DFBC 22                RET      
B1:00DFBD         ?C0374?ZW_TRANSPORT:
B1:00DFBD 7F00              MOV      R7,#00H
B1:00DFBF 22                RET      
----- FUNCTION _ZW_Transport_CommandClassVersionGet (END) -------


----- FUNCTION _IsKeySupported (BEGIN) -----
B1:00DFC0 900AE7            MOV      DPTR,#sc
B1:00DFC3 EF                MOV      A,R7
B1:00DFC4 F0                MOVX     @DPTR,A
B1:00DFC5 F1ED              ACALL    ZW_GetSecurityKeys
;---- Variable 'bSecKeyMask' assigned to Register 'R7' ----
B1:00DFC7 900AE7            MOV      DPTR,#sc
B1:00DFCA E0                MOVX     A,@DPTR
B1:00DFCB 14                DEC      A
B1:00DFCC 600F              JZ       ?C0378?ZW_TRANSPORT
B1:00DFCE 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 408


B1:00DFCF 600F              JZ       ?C0379?ZW_TRANSPORT
B1:00DFD1 14                DEC      A
B1:00DFD2 6010              JZ       ?C0380?ZW_TRANSPORT
B1:00DFD4 14                DEC      A
B1:00DFD5 6011              JZ       ?C0381?ZW_TRANSPORT
B1:00DFD7 2404              ADD      A,#04H
B1:00DFD9 7010              JNZ      ?C0375?ZW_TRANSPORT
B1:00DFDB         ?C0376?ZW_TRANSPORT:
B1:00DFDB D3                SETB     C
B1:00DFDC 22                RET      
B1:00DFDD         ?C0378?ZW_TRANSPORT:
B1:00DFDD EF                MOV      A,R7
B1:00DFDE 13                RRC      A
B1:00DFDF 22                RET      
B1:00DFE0         ?C0379?ZW_TRANSPORT:
B1:00DFE0 EF                MOV      A,R7
B1:00DFE1 A2E1              MOV      C,ACC.1
B1:00DFE3 22                RET      
B1:00DFE4         ?C0380?ZW_TRANSPORT:
B1:00DFE4 EF                MOV      A,R7
B1:00DFE5 A2E2              MOV      C,ACC.2
B1:00DFE7 22                RET      
B1:00DFE8         ?C0381?ZW_TRANSPORT:
B1:00DFE8 EF                MOV      A,R7
B1:00DFE9 33                RLC      A
B1:00DFEA 22                RET      
B1:00DFEB         ?C0375?ZW_TRANSPORT:
B1:00DFEB C3                CLR      C
B1:00DFEC 22                RET      
----- FUNCTION _IsKeySupported (END) -------


----- FUNCTION ZW_GetSecurityKeys (BEGIN) -----
B1:00DFED 903C00            MOV      DPTR,#assignedSec_keys
B1:00DFF0 E0                MOVX     A,@DPTR
B1:00DFF1 FF                MOV      R7,A
B1:00DFF2 22                RET      
----- FUNCTION ZW_GetSecurityKeys (END) -------


----- FUNCTION ?L?COM034E (BEGIN) -----
B1:00DFF3 24B1              ADD      A,#0B1H
B1:00DFF5 F9                MOV      R1,A
B1:00DFF6 E4                CLR      A
B1:00DFF7 3A                ADDC     A,R2
B1:00DFF8 FA                MOV      R2,A
B1:00DFF9 22                RET      
----- FUNCTION ?L?COM034E (END) -------


----- FUNCTION ?L?COM04CE (BEGIN) -----
B1:00DFFA 900AC4            MOV      DPTR,#ptrFrame
B1:00DFFD 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04CE (END) -------


----- FUNCTION ?L?COM0484 (BEGIN) -----
B1:00E000 24B9              ADD      A,#0B9H
B1:00E002 F9                MOV      R1,A
B1:00E003 E4                CLR      A
B1:00E004 3A                ADDC     A,R2
B1:00E005 FA                MOV      R2,A
B1:00E006 22                RET      
----- FUNCTION ?L?COM0484 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 409



----- FUNCTION ?L?COM02F6 (BEGIN) -----
B1:00E007 E9                MOV      A,R1
B1:00E008         ?L?COM02F7:
B1:00E008 24DF              ADD      A,#0DFH
B1:00E00A F9                MOV      R1,A
B1:00E00B E4                CLR      A
B1:00E00C 3A                ADDC     A,R2
B1:00E00D FA                MOV      R2,A
B1:00E00E 22                RET      
----- FUNCTION ?L?COM02F6 (END) -------


----- FUNCTION ?L?COM00B2 (BEGIN) -----
B1:00E00F 903E1A            MOV      DPTR,#ctx
B1:00E012         ?L?COM00B3:
B1:00E012 122552            LCALL    ?C?PLDXDATA
B1:00E015 E9                MOV      A,R1
B1:00E016 2401              ADD      A,#01H
B1:00E018 22                RET      
----- FUNCTION ?L?COM00B2 (END) -------


----- FUNCTION _AES_CTR_DRBG_Update (BEGIN) -----
B1:00E019 903E1A            MOV      DPTR,#ctx
B1:00E01C 11DD              ACALL    ?L?COM03E3
B1:00E01E F0                MOVX     @DPTR,A
B1:00E01F 7B01              MOV      R3,#01H
B1:00E021 7A3E              MOV      R2,#HIGH tmp
B1:00E023 7922              MOV      R1,#LOW tmp
B1:00E025 903E42            MOV      DPTR,#t
B1:00E028 11DD              ACALL    ?L?COM03E3
B1:00E02A F0                MOVX     @DPTR,A
B1:00E02B         ?C0005?CTR_DRBG:
B1:00E02B C3                CLR      C
B1:00E02C 903E21            MOV      DPTR,#i+01H
B1:00E02F E0                MOVX     A,@DPTR
B1:00E030 9420              SUBB     A,#020H
B1:00E032 903E20            MOV      DPTR,#i
B1:00E035 E0                MOVX     A,@DPTR
B1:00E036 9400              SUBB     A,#00H
B1:00E038 5042              JNC      ?C0006?CTR_DRBG
B1:00E03A 110F              ACALL    ?L?COM00B2
B1:00E03C 12F99B            LCALL    ?L?COM0402
B1:00E03F 903E1A            MOV      DPTR,#ctx
B1:00E042 12FB74            LCALL    ?L?COM02DA
B1:00E045 FA                MOV      R2,A
B1:00E046 C003              PUSH     AR3
B1:00E048 C002              PUSH     AR2
B1:00E04A C001              PUSH     AR1
B1:00E04C 110F              ACALL    ?L?COM00B2
B1:00E04E F9                MOV      R1,A
B1:00E04F E4                CLR      A
B1:00E050 3A                ADDC     A,R2
B1:00E051 FA                MOV      R2,A
B1:00E052 711A              ACALL    ?L?COM00F1
B1:00E054 903E42            MOV      DPTR,#t
B1:00E057 122552            LCALL    ?C?PLDXDATA
B1:00E05A 126E65            LCALL    ?L?COM0282
B1:00E05D D001              POP      AR1
B1:00E05F D002              POP      AR2
B1:00E061 D003              POP      AR3
B1:00E063 121D77            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
B1:00E066 903E43            MOV      DPTR,#t+01H
B1:00E069 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 410


B1:00E06A 75F010            MOV      B,#010H
B1:00E06D 12210C            LCALL    ?C?IILDX
B1:00E070 903E20            MOV      DPTR,#i
B1:00E073 E4                CLR      A
B1:00E074 75F010            MOV      B,#010H
B1:00E077 12210C            LCALL    ?C?IILDX
B1:00E07A 80AF              SJMP     ?C0005?CTR_DRBG
B1:00E07C         ?C0006?CTR_DRBG:
B1:00E07C 11E0              ACALL    ?L?COM03E4
B1:00E07E F0                MOVX     @DPTR,A
B1:00E07F         ?C0008?CTR_DRBG:
B1:00E07F 903E20            MOV      DPTR,#i
B1:00E082 E0                MOVX     A,@DPTR
B1:00E083 FE                MOV      R6,A
B1:00E084 A3                INC      DPTR
B1:00E085 E0                MOVX     A,@DPTR
B1:00E086 FF                MOV      R7,A
B1:00E087 2422              ADD      A,#LOW tmp
B1:00E089 F582              MOV      DPL,A
B1:00E08B 743E              MOV      A,#HIGH tmp
B1:00E08D 3E                ADDC     A,R6
B1:00E08E F583              MOV      DPH,A
B1:00E090 C083              PUSH     DPH
B1:00E092 C082              PUSH     DPL
B1:00E094 E0                MOVX     A,@DPTR
B1:00E095 FD                MOV      R5,A
B1:00E096 903E1D            MOV      DPTR,#__data
B1:00E099 319F              ACALL    ?L?COM0140
B1:00E09B 121FB9            LCALL    ?C?CLDOPTR
B1:00E09E FF                MOV      R7,A
B1:00E09F ED                MOV      A,R5
B1:00E0A0 6F                XRL      A,R7
B1:00E0A1 D082              POP      DPL
B1:00E0A3 D083              POP      DPH
B1:00E0A5 F0                MOVX     @DPTR,A
B1:00E0A6 903E20            MOV      DPTR,#i
B1:00E0A9 E4                CLR      A
B1:00E0AA 75F001            MOV      B,#01H
B1:00E0AD 12210C            LCALL    ?C?IILDX
B1:00E0B0 903E20            MOV      DPTR,#i
B1:00E0B3 E0                MOVX     A,@DPTR
B1:00E0B4 7004              JNZ      ?C0023?CTR_DRBG
B1:00E0B6 A3                INC      DPTR
B1:00E0B7 E0                MOVX     A,@DPTR
B1:00E0B8 6420              XRL      A,#020H
B1:00E0BA         ?C0023?CTR_DRBG:
B1:00E0BA 70C3              JNZ      ?C0008?CTR_DRBG
B1:00E0BC         ?C0009?CTR_DRBG:
B1:00E0BC 903E1A            MOV      DPTR,#ctx
B1:00E0BF 122552            LCALL    ?C?PLDXDATA
B1:00E0C2 E9                MOV      A,R1
B1:00E0C3 2411              ADD      A,#011H
B1:00E0C5 7120              ACALL    ?L?COM01F4
B1:00E0C7 7A3E              MOV      R2,#HIGH tmp
B1:00E0C9 7922              MOV      R1,#LOW tmp
B1:00E0CB 12DF7E            LCALL    ?L?COM0086
B1:00E0CE 110F              ACALL    ?L?COM00B2
B1:00E0D0 7120              ACALL    ?L?COM01F4
B1:00E0D2 7A3E              MOV      R2,#HIGH tmp+010H
B1:00E0D4 7932              MOV      R1,#LOW tmp+010H
B1:00E0D6 7E00              MOV      R6,#00H
B1:00E0D8 7F10              MOV      R7,#010H
B1:00E0DA 021F56            LJMP     ?C?COPY
----- FUNCTION _AES_CTR_DRBG_Update (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 411



----- FUNCTION ?L?COM03E3 (BEGIN) -----
B1:00E0DD 122572            LCALL    ?C?PSTXDATA
B1:00E0E0         ?L?COM03E4:
B1:00E0E0 E4                CLR      A
B1:00E0E1 903E20            MOV      DPTR,#i
B1:00E0E4 F0                MOVX     @DPTR,A
B1:00E0E5 A3                INC      DPTR
B1:00E0E6 22                RET      
----- FUNCTION ?L?COM03E3 (END) -------


----- FUNCTION _AES_CTR_DRBG_Generate (BEGIN) -----
B1:00E0E7 903E6F            MOV      DPTR,#ctx
B1:00E0EA 122572            LCALL    ?C?PSTXDATA
B1:00E0ED 903E97            MOV      DPTR,#size
B1:00E0F0 12CF6E            LCALL    ?L?COM00CC
B1:00E0F3         ?C0017?CTR_DRBG:
B1:00E0F3 903E97            MOV      DPTR,#size
B1:00E0F6 E0                MOVX     A,@DPTR
B1:00E0F7 7002              JNZ      ?C0024?CTR_DRBG
B1:00E0F9 A3                INC      DPTR
B1:00E0FA E0                MOVX     A,@DPTR
B1:00E0FB         ?C0024?CTR_DRBG:
B1:00E0FB 6071              JZ       ?C0018?CTR_DRBG
B1:00E0FD 903E6F            MOV      DPTR,#ctx
B1:00E100 1112              ACALL    ?L?COM00B3
B1:00E102 12F99B            LCALL    ?L?COM0402
B1:00E105 903E6F            MOV      DPTR,#ctx
B1:00E108 12FB74            LCALL    ?L?COM02DA
B1:00E10B FA                MOV      R2,A
B1:00E10C C003              PUSH     AR3
B1:00E10E C002              PUSH     AR2
B1:00E110 C001              PUSH     AR1
B1:00E112 903E6F            MOV      DPTR,#ctx
B1:00E115 1112              ACALL    ?L?COM00B3
B1:00E117 F9                MOV      R1,A
B1:00E118 E4                CLR      A
B1:00E119 3A                ADDC     A,R2
B1:00E11A FA                MOV      R2,A
B1:00E11B 711A              ACALL    ?L?COM00F1
B1:00E11D 904307            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B1:00E120 318A              ACALL    ?L?COM01B9
B1:00E122 D001              POP      AR1
B1:00E124 D002              POP      AR2
B1:00E126 D003              POP      AR3
B1:00E128 121D77            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
B1:00E12B 903E97            MOV      DPTR,#size
B1:00E12E E0                MOVX     A,@DPTR
B1:00E12F FE                MOV      R6,A
B1:00E130 A3                INC      DPTR
B1:00E131 E0                MOVX     A,@DPTR
B1:00E132 FF                MOV      R7,A
B1:00E133 C3                CLR      C
B1:00E134 9410              SUBB     A,#010H
B1:00E136 EE                MOV      A,R6
B1:00E137 9400              SUBB     A,#00H
B1:00E139 5002              JNC      ?C0019?CTR_DRBG
B1:00E13B 8004              SJMP     ?C0020?CTR_DRBG
B1:00E13D         ?C0019?CTR_DRBG:
B1:00E13D 7E00              MOV      R6,#00H
B1:00E13F 7F10              MOV      R7,#010H
B1:00E141         ?C0020?CTR_DRBG:
B1:00E141 903E95            MOV      DPTR,#copy
B1:00E144 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 412


B1:00E145 F0                MOVX     @DPTR,A
B1:00E146 A3                INC      DPTR
B1:00E147 EF                MOV      A,R7
B1:00E148 F0                MOVX     @DPTR,A
B1:00E149 3193              ACALL    ?L?COM050D
B1:00E14B 903E72            MOV      DPTR,#rand
B1:00E14E B1B3              ACALL    ?L?COM0104
B1:00E150 7A3E              MOV      R2,#HIGH __data
B1:00E152 7975              MOV      R1,#LOW __data
B1:00E154 121F56            LCALL    ?C?COPY
B1:00E157 3193              ACALL    ?L?COM050D
B1:00E159 903E73            MOV      DPTR,#rand+01H
B1:00E15C 12AEDF            LCALL    ?L?COM01F1
B1:00E15F C3                CLR      C
B1:00E160 903E98            MOV      DPTR,#size+01H
B1:00E163 E0                MOVX     A,@DPTR
B1:00E164 9F                SUBB     A,R7
B1:00E165 F0                MOVX     @DPTR,A
B1:00E166 903E97            MOV      DPTR,#size
B1:00E169 E0                MOVX     A,@DPTR
B1:00E16A 9E                SUBB     A,R6
B1:00E16B F0                MOVX     @DPTR,A
B1:00E16C 8085              SJMP     ?C0017?CTR_DRBG
B1:00E16E         ?C0018?CTR_DRBG:
B1:00E16E 7E00              MOV      R6,#00H
B1:00E170 7F20              MOV      R7,#020H
B1:00E172 7D00              MOV      R5,#00H
B1:00E174 7B01              MOV      R3,#01H
B1:00E176 7A3E              MOV      R2,#HIGH __data
B1:00E178 7975              MOV      R1,#LOW __data
B1:00E17A 1228E0            LCALL    ?C?MEMSET
B1:00E17D 903E1D            MOV      DPTR,#?_AES_CTR_DRBG_Update?BYTE+03H
B1:00E180 318A              ACALL    ?L?COM01B9
B1:00E182 903E6F            MOV      DPTR,#ctx
B1:00E185 122552            LCALL    ?C?PLDXDATA
B1:00E188 0119              AJMP     _AES_CTR_DRBG_Update
----- FUNCTION _AES_CTR_DRBG_Generate (END) -------


----- FUNCTION ?L?COM01B9 (BEGIN) -----
B1:00E18A 7B01              MOV      R3,#01H
B1:00E18C 7A3E              MOV      R2,#HIGH __data
B1:00E18E 7975              MOV      R1,#LOW __data
B1:00E190 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01B9 (END) -------


----- FUNCTION ?L?COM050D (BEGIN) -----
B1:00E193 903E95            MOV      DPTR,#copy
B1:00E196 E0                MOVX     A,@DPTR
B1:00E197 FE                MOV      R6,A
B1:00E198 A3                INC      DPTR
B1:00E199 E0                MOVX     A,@DPTR
B1:00E19A FF                MOV      R7,A
B1:00E19B 22                RET      
----- FUNCTION ?L?COM050D (END) -------


----- FUNCTION ?L?COM013F (BEGIN) -----
B1:00E19C 90440D            MOV      DPTR,#pad
B1:00E19F         ?L?COM0140:
B1:00E19F 122552            LCALL    ?C?PLDXDATA
B1:00E1A2 8F82              MOV      DPL,R7
B1:00E1A4 8E83              MOV      DPH,R6
B1:00E1A6 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 413


----- FUNCTION ?L?COM013F (END) -------


----- FUNCTION _padding (BEGIN) -----
B1:00E1A7 90440A            MOV      DPTR,#lastb
;---- Variable 'j' assigned to Register 'R6/R7' ----
B1:00E1AA 127019            LCALL    ?L?COM04AB
B1:00E1AD         ?C0016?AES_CMAC:
B1:00E1AD 904410            MOV      DPTR,#length
B1:00E1B0 E0                MOVX     A,@DPTR
B1:00E1B1 FD                MOV      R5,A
B1:00E1B2 C3                CLR      C
B1:00E1B3 EF                MOV      A,R7
B1:00E1B4 9D                SUBB     A,R5
B1:00E1B5 7480              MOV      A,#080H
B1:00E1B7 F8                MOV      R0,A
B1:00E1B8 6E                XRL      A,R6
B1:00E1B9 98                SUBB     A,R0
B1:00E1BA 500E              JNC      ?C0019?AES_CMAC
B1:00E1BC 90440A            MOV      DPTR,#lastb
B1:00E1BF 319F              ACALL    ?L?COM0140
B1:00E1C1 121FB9            LCALL    ?C?CLDOPTR
B1:00E1C4 FD                MOV      R5,A
B1:00E1C5 319C              ACALL    ?L?COM013F
B1:00E1C7 ED                MOV      A,R5
B1:00E1C8 8014              SJMP     ?C0048?AES_CMAC
B1:00E1CA         ?C0019?AES_CMAC:
B1:00E1CA 904410            MOV      DPTR,#length
B1:00E1CD E0                MOVX     A,@DPTR
B1:00E1CE B5070A            CJNE     A,AR7,?C0021?AES_CMAC
B1:00E1D1 E4                CLR      A
B1:00E1D2 B50606            CJNE     A,AR6,?C0021?AES_CMAC
B1:00E1D5 319C              ACALL    ?L?COM013F
B1:00E1D7 7480              MOV      A,#080H
B1:00E1D9         
B1:00E1D9 8003              SJMP     ?C0048?AES_CMAC
B1:00E1DB         ?C0021?AES_CMAC:
B1:00E1DB 319C              ACALL    ?L?COM013F
B1:00E1DD E4                CLR      A
B1:00E1DE         
B1:00E1DE 12204D            LCALL    ?C?CSTOPTR
B1:00E1E1         ?C0018?AES_CMAC:
B1:00E1E1 0F                INC      R7
B1:00E1E2 BF0001            CJNE     R7,#00H,?C0046?AES_CMAC
B1:00E1E5 0E                INC      R6
B1:00E1E6         ?C0046?AES_CMAC:
B1:00E1E6 EF                MOV      A,R7
B1:00E1E7 6410              XRL      A,#010H
B1:00E1E9 4E                ORL      A,R6
B1:00E1EA 70C1              JNZ      ?C0016?AES_CMAC
B1:00E1EC 22                RET      
----- FUNCTION _padding (END) -------


----- FUNCTION _leftshift_onebit (BEGIN) -----
B1:00E1ED 90435A            MOV      DPTR,#input
B1:00E1F0 122572            LCALL    ?C?PSTXDATA
B1:00E1F3 E4                CLR      A
B1:00E1F4 904361            MOV      DPTR,#overflow
B1:00E1F7 F0                MOVX     @DPTR,A
B1:00E1F8 904360            MOV      DPTR,#count
B1:00E1FB 740F              MOV      A,#0FH
B1:00E1FD F0                MOVX     @DPTR,A
B1:00E1FE         ?C0005?AES_CMAC:
B1:00E1FE 904360            MOV      DPTR,#count
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 414


B1:00E201 F187              ACALL    ?L?COM0573
B1:00E203 4051              JC       ?C0010?AES_CMAC
B1:00E205 90435A            MOV      DPTR,#input
B1:00E208 122552            LCALL    ?C?PLDXDATA
B1:00E20B EF                MOV      A,R7
B1:00E20C 33                RLC      A
B1:00E20D 95E0              SUBB     A,ACC
B1:00E20F FE                MOV      R6,A
B1:00E210 8F82              MOV      DPL,R7
B1:00E212 F583              MOV      DPH,A
B1:00E214 121FB9            LCALL    ?C?CLDOPTR
B1:00E217 25E0              ADD      A,ACC
B1:00E219 FD                MOV      R5,A
B1:00E21A 90435D            MOV      DPTR,#output
B1:00E21D 319F              ACALL    ?L?COM0140
B1:00E21F ED                MOV      A,R5
B1:00E220 12204D            LCALL    ?C?CSTOPTR
B1:00E223 904360            MOV      DPTR,#count
B1:00E226 E0                MOVX     A,@DPTR
B1:00E227 FF                MOV      R7,A
B1:00E228 33                RLC      A
B1:00E229 95E0              SUBB     A,ACC
B1:00E22B FE                MOV      R6,A
B1:00E22C B19B              ACALL    ?L?COM007A
B1:00E22E 121F7C            LCALL    ?C?CLDPTR
B1:00E231 FD                MOV      R5,A
B1:00E232 904361            MOV      DPTR,#overflow
B1:00E235 E0                MOVX     A,@DPTR
B1:00E236 4D                ORL      A,R5
B1:00E237 12203B            LCALL    ?C?CSTPTR
B1:00E23A 90435A            MOV      DPTR,#input
B1:00E23D 319F              ACALL    ?L?COM0140
B1:00E23F 121FB9            LCALL    ?C?CLDOPTR
B1:00E242 7F00              MOV      R7,#00H
B1:00E244 30E702            JNB      ACC.7,?C0008?AES_CMAC
B1:00E247 7F01              MOV      R7,#01H
B1:00E249         ?C0008?AES_CMAC:
B1:00E249         ?C0009?AES_CMAC:
B1:00E249 904361            MOV      DPTR,#overflow
B1:00E24C EF                MOV      A,R7
B1:00E24D F0                MOVX     @DPTR,A
B1:00E24E 904360            MOV      DPTR,#count
B1:00E251 E0                MOVX     A,@DPTR
B1:00E252 14                DEC      A
B1:00E253 F0                MOVX     @DPTR,A
B1:00E254 80A8              SJMP     ?C0005?AES_CMAC
B1:00E256         ?C0010?AES_CMAC:
B1:00E256 22                RET      
----- FUNCTION _leftshift_onebit (END) -------


----- FUNCTION _generate_subkey (BEGIN) -----
B1:00E257 903B6F            MOV      DPTR,#key
B1:00E25A 122572            LCALL    ?C?PSTXDATA
B1:00E25D 7898              MOV      R0,#LOW const_Zero
B1:00E25F 7C3B              MOV      R4,#HIGH const_Zero
B1:00E261 7D01              MOV      R5,#01H
B1:00E263 7BFF              MOV      R3,#0FFH
B1:00E265 7A2F              MOV      R2,#HIGH _?ix1000
B1:00E267 79F3              MOV      R1,#LOW _?ix1000
B1:00E269 12DF7E            LCALL    ?L?COM0086
B1:00E26C 78A8              MOV      R0,#LOW const_Rb
B1:00E26E 7C3B              MOV      R4,#HIGH const_Rb
B1:00E270 7D01              MOV      R5,#01H
B1:00E272 7BFF              MOV      R3,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 415


B1:00E274 7A30              MOV      R2,#HIGH _?ix1001
B1:00E276 7903              MOV      R1,#LOW _?ix1001
B1:00E278 12DF7E            LCALL    ?L?COM0086
B1:00E27B 7B01              MOV      R3,#01H
B1:00E27D 7A3B              MOV      R2,#HIGH const_Zero
B1:00E27F 7998              MOV      R1,#LOW const_Zero
B1:00E281 711A              ACALL    ?L?COM00F1
B1:00E283 7A3B              MOV      R2,#HIGH L
B1:00E285 7978              MOV      R1,#LOW L
B1:00E287 126E65            LCALL    ?L?COM0282
B1:00E28A 903B6F            MOV      DPTR,#key
B1:00E28D 12FDC7            LCALL    ?L?COM03BA
B1:00E290 903B78            MOV      DPTR,#L
B1:00E293 E0                MOVX     A,@DPTR
B1:00E294 20E70F            JB       ACC.7,?C0011?AES_CMAC
B1:00E297 903B72            MOV      DPTR,#K1
B1:00E29A 51EA              ACALL    ?L?COM0374
B1:00E29C 7B01              MOV      R3,#01H
B1:00E29E 7A3B              MOV      R2,#HIGH L
B1:00E2A0 7978              MOV      R1,#LOW L
B1:00E2A2 31ED              ACALL    _leftshift_onebit
B1:00E2A4 8013              SJMP     ?C0012?AES_CMAC
B1:00E2A6         ?C0011?AES_CMAC:
B1:00E2A6 51FC              ACALL    ?L?COM02EB
B1:00E2A8 51ED              ACALL    ?L?COM0375
B1:00E2AA 7A3B              MOV      R2,#HIGH L
B1:00E2AC 7978              MOV      R1,#LOW L
B1:00E2AE 12DF36            LCALL    ?L?COM01EE
B1:00E2B1 903B72            MOV      DPTR,#K1
B1:00E2B4 51F3              ACALL    ?L?COM02EA
B1:00E2B6 12DD45            LCALL    _xor_128
B1:00E2B9         ?C0012?AES_CMAC:
B1:00E2B9 903B72            MOV      DPTR,#K1
B1:00E2BC 12C941            LCALL    ?L?COM0048
B1:00E2BF 20E713            JB       ACC.7,?C0013?AES_CMAC
B1:00E2C2 C003              PUSH     AR3
B1:00E2C4 C002              PUSH     AR2
B1:00E2C6 C001              PUSH     AR1
B1:00E2C8 903B75            MOV      DPTR,#K2
B1:00E2CB 51EA              ACALL    ?L?COM0374
B1:00E2CD D001              POP      AR1
B1:00E2CF D002              POP      AR2
B1:00E2D1 D003              POP      AR3
B1:00E2D3 21ED              AJMP     _leftshift_onebit
B1:00E2D5         ?C0013?AES_CMAC:
B1:00E2D5 51FC              ACALL    ?L?COM02EB
B1:00E2D7 51ED              ACALL    ?L?COM0375
B1:00E2D9 903B72            MOV      DPTR,#K1
B1:00E2DC 122552            LCALL    ?C?PLDXDATA
B1:00E2DF 12DF36            LCALL    ?L?COM01EE
B1:00E2E2 903B75            MOV      DPTR,#K2
B1:00E2E5 51F3              ACALL    ?L?COM02EA
B1:00E2E7 02DD45            LJMP     _xor_128
----- FUNCTION _generate_subkey (END) -------


----- FUNCTION ?L?COM0374 (BEGIN) -----
B1:00E2EA 122552            LCALL    ?C?PLDXDATA
B1:00E2ED         ?L?COM0375:
B1:00E2ED 90435D            MOV      DPTR,#?_leftshift_onebit?BYTE+03H
B1:00E2F0 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0374 (END) -------


----- FUNCTION ?L?COM02EA (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 416


B1:00E2F3 122552            LCALL    ?C?PLDXDATA
B1:00E2F6 9042DA            MOV      DPTR,#?_xor_128?BYTE+06H
B1:00E2F9 122572            LCALL    ?C?PSTXDATA
B1:00E2FC         ?L?COM02EB:
B1:00E2FC 7B01              MOV      R3,#01H
B1:00E2FE 7A3B              MOV      R2,#HIGH tmp
B1:00E300 7988              MOV      R1,#LOW tmp
B1:00E302 22                RET      
----- FUNCTION ?L?COM02EA (END) -------


----- FUNCTION ?L?COM00F0 (BEGIN) -----
B1:00E303 7A38              MOV      R2,#HIGH Y
B1:00E305 79F4              MOV      R1,#LOW Y
B1:00E307 9042DA            MOV      DPTR,#?_xor_128?BYTE+06H
B1:00E30A 122572            LCALL    ?C?PSTXDATA
B1:00E30D 7A38              MOV      R2,#HIGH X
B1:00E30F 79E4              MOV      R1,#LOW X
B1:00E311 12DD45            LCALL    _xor_128
B1:00E314 7B01              MOV      R3,#01H
B1:00E316 7A38              MOV      R2,#HIGH Y
B1:00E318 79F4              MOV      R1,#LOW Y
B1:00E31A         ?L?COM00F1:
B1:00E31A 904304            MOV      DPTR,#?_ZW_AES_ecb?BYTE+03H
B1:00E31D 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM00F0 (END) -------


----- FUNCTION ?L?COM01F4 (BEGIN) -----
B1:00E320 F9                MOV      R1,A
B1:00E321 E4                CLR      A
B1:00E322         ?L?COM01F5:
B1:00E322 3A                ADDC     A,R2
B1:00E323         ?L?COM01F6:
B1:00E323 A801              MOV      R0,AR1
B1:00E325 FC                MOV      R4,A
B1:00E326 AD03              MOV      R5,AR3
B1:00E328 7B01              MOV      R3,#01H
B1:00E32A 22                RET      
----- FUNCTION ?L?COM01F4 (END) -------


----- FUNCTION _CCM_encrypt_and_auth (BEGIN) -----
B1:00E32B 903CF3            MOV      DPTR,#key
B1:00E32E 12FD67            LCALL    ?L?COM0531
B1:00E331 903D25            MOV      DPTR,#mac_len
B1:00E334 12FDEA            LCALL    ?L?COM034C
B1:00E337 9131              ACALL    ?L?COM017D
B1:00E339 126F94            LCALL    ?L?COM042F
B1:00E33C FE                MOV      R6,A
B1:00E33D ED                MOV      A,R5
B1:00E33E C4                SWAP     A
B1:00E33F 540F              ANL      A,#0FH
B1:00E341 48                ORL      A,R0
B1:00E342 2401              ADD      A,#01H
B1:00E344 FF                MOV      R7,A
B1:00E345 E4                CLR      A
B1:00E346 3E                ADDC     A,R6
B1:00E347 903D27            MOV      DPTR,#counter_blocks
B1:00E34A F0                MOVX     @DPTR,A
B1:00E34B A3                INC      DPTR
B1:00E34C EF                MOV      A,R7
B1:00E34D F0                MOVX     @DPTR,A
B1:00E34E ED                MOV      A,R5
B1:00E34F 540F              ANL      A,#0FH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 417


B1:00E351 600A              JZ       ?C0044?CCM
B1:00E353 903D27            MOV      DPTR,#counter_blocks
B1:00E356 E4                CLR      A
B1:00E357 75F001            MOV      B,#01H
B1:00E35A 12210C            LCALL    ?C?IILDX
B1:00E35D         ?C0044?CCM:
B1:00E35D 903D25            MOV      DPTR,#mac_len
B1:00E360 A3                INC      DPTR
B1:00E361 E0                MOVX     A,@DPTR
B1:00E362 FF                MOV      R7,A
B1:00E363 9131              ACALL    ?L?COM017D
B1:00E365 903CF6            MOV      DPTR,#nonce
B1:00E368 122552            LCALL    ?C?PLDXDATA
B1:00E36B 9040DE            MOV      DPTR,#?_format_b0?BYTE+06H
B1:00E36E 9121              ACALL    ?L?COM0283
B1:00E370 12C9A7            LCALL    _format_b0
B1:00E373 903CF3            MOV      DPTR,#key
B1:00E376 12CF56            LCALL    ?L?COM012A
B1:00E379 9124              ACALL    ?L?COM0284
B1:00E37B 913A              ACALL    _ciph_block
B1:00E37D 903CF9            MOV      DPTR,#aad
B1:00E380 12FD91            LCALL    ?L?COM04BB
B1:00E383 903CFC            MOV      DPTR,#aad_len
B1:00E386 12FD88            LCALL    ?L?COM04BA
B1:00E389 912B              ACALL    ?L?COM0456
B1:00E38B 90404F            MOV      DPTR,#?_format_aad?BYTE+0AH
B1:00E38E 9121              ACALL    ?L?COM0283
B1:00E390 12CBB9            LCALL    _format_aad
B1:00E393 EF                MOV      A,R7
B1:00E394 4E                ORL      A,R6
B1:00E395 7005              JNZ      ?C0045?CCM
B1:00E397 FF                MOV      R7,A
B1:00E398 FE                MOV      R6,A
B1:00E399 FD                MOV      R5,A
B1:00E39A FC                MOV      R4,A
B1:00E39B 22                RET      
B1:00E39C         ?C0045?CCM:
B1:00E39C 903D00            MOV      DPTR,#plain_ciphertext
B1:00E39F 12FD7F            LCALL    ?L?COM04B9
B1:00E3A2 903D03            MOV      DPTR,#text_to_encrypt_len
B1:00E3A5 E0                MOVX     A,@DPTR
B1:00E3A6 FF                MOV      R7,A
B1:00E3A7 A3                INC      DPTR
B1:00E3A8 E0                MOVX     A,@DPTR
B1:00E3A9 904102            MOV      DPTR,#?_format_payload_block?BYTE+06H
B1:00E3AC CF                XCH      A,R7
B1:00E3AD F0                MOVX     @DPTR,A
B1:00E3AE A3                INC      DPTR
B1:00E3AF EF                MOV      A,R7
B1:00E3B0 F0                MOVX     @DPTR,A
B1:00E3B1 912B              ACALL    ?L?COM0456
B1:00E3B3 904104            MOV      DPTR,#?_format_payload_block?BYTE+08H
B1:00E3B6 9121              ACALL    ?L?COM0283
B1:00E3B8 12CE31            LCALL    _format_payload_block
B1:00E3BB 9131              ACALL    ?L?COM017D
B1:00E3BD 903D27            MOV      DPTR,#counter_blocks
B1:00E3C0 12F92F            LCALL    ?L?COM00D3
B1:00E3C3 7A3D              MOV      R2,#HIGH blocks
B1:00E3C5 7905              MOV      R1,#LOW blocks
B1:00E3C7 A3                INC      DPTR
B1:00E3C8 122572            LCALL    ?C?PSTXDATA
B1:00E3CB 903CF6            MOV      DPTR,#nonce
B1:00E3CE 12FDF9            LCALL    ?L?COM04BC
B1:00E3D1 903D25            MOV      DPTR,#mac_len
B1:00E3D4 12FE02            LCALL    ?L?COM050E
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 418


B1:00E3D7 F0                MOVX     @DPTR,A
B1:00E3D8 A3                INC      DPTR
B1:00E3D9 EF                MOV      A,R7
B1:00E3DA F0                MOVX     @DPTR,A
B1:00E3DB 912B              ACALL    ?L?COM0456
B1:00E3DD 903DFE            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0FH
B1:00E3E0 9121              ACALL    ?L?COM0283
B1:00E3E2 903E01            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+012H
B1:00E3E5 122572            LCALL    ?C?PSTXDATA
B1:00E3E8 903E04            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+015H
B1:00E3EB E4                CLR      A
B1:00E3EC F0                MOVX     @DPTR,A
B1:00E3ED A3                INC      DPTR
B1:00E3EE 04                INC      A
B1:00E3EF F0                MOVX     @DPTR,A
B1:00E3F0 903D00            MOV      DPTR,#plain_ciphertext
B1:00E3F3 122552            LCALL    ?C?PLDXDATA
B1:00E3F6 9161              ACALL    _encrypt_or_decrypt
B1:00E3F8 B1AA              ACALL    ?L?COM0510
B1:00E3FA 903D00            MOV      DPTR,#plain_ciphertext
B1:00E3FD 122552            LCALL    ?C?PLDXDATA
B1:00E400 903D03            MOV      DPTR,#text_to_encrypt_len
B1:00E403 126E37            LCALL    ?L?COM01E7
B1:00E406 7123              ACALL    ?L?COM01F6
B1:00E408 7A3D              MOV      R2,#HIGH blocks
B1:00E40A 7905              MOV      R1,#LOW blocks
B1:00E40C 121F56            LCALL    ?C?COPY
B1:00E40F B1AA              ACALL    ?L?COM0510
B1:00E411 903D04            MOV      DPTR,#text_to_encrypt_len+01H
B1:00E414 E0                MOVX     A,@DPTR
B1:00E415 2F                ADD      A,R7
B1:00E416 FF                MOV      R7,A
B1:00E417 903D03            MOV      DPTR,#text_to_encrypt_len
B1:00E41A E0                MOVX     A,@DPTR
B1:00E41B 3E                ADDC     A,R6
B1:00E41C FE                MOV      R6,A
B1:00E41D E4                CLR      A
B1:00E41E FC                MOV      R4,A
B1:00E41F FD                MOV      R5,A
B1:00E420 22                RET      
----- FUNCTION _CCM_encrypt_and_auth (END) -------


----- FUNCTION ?L?COM0283 (BEGIN) -----
B1:00E421 122572            LCALL    ?C?PSTXDATA
B1:00E424         ?L?COM0284:
B1:00E424 7B01              MOV      R3,#01H
B1:00E426 7A3D              MOV      R2,#HIGH blocks
B1:00E428 7905              MOV      R1,#LOW blocks
B1:00E42A 22                RET      
----- FUNCTION ?L?COM0283 (END) -------


----- FUNCTION ?L?COM0456 (BEGIN) -----
B1:00E42B 903CF3            MOV      DPTR,#key
B1:00E42E 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0456 (END) -------


----- FUNCTION ?L?COM017D (BEGIN) -----
B1:00E431 903D03            MOV      DPTR,#text_to_encrypt_len
B1:00E434 E0                MOVX     A,@DPTR
B1:00E435 FC                MOV      R4,A
B1:00E436 A3                INC      DPTR
B1:00E437 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 419


B1:00E438 FD                MOV      R5,A
B1:00E439 22                RET      
----- FUNCTION ?L?COM017D (END) -------


----- FUNCTION _ciph_block (BEGIN) -----
B1:00E43A 90449D            MOV      DPTR,#blocks
B1:00E43D 122572            LCALL    ?C?PSTXDATA
B1:00E440 90449D            MOV      DPTR,#blocks
B1:00E443 122552            LCALL    ?C?PLDXDATA
B1:00E446 711A              ACALL    ?L?COM00F1
B1:00E448 90449D            MOV      DPTR,#blocks
B1:00E44B 122552            LCALL    ?C?PLDXDATA
B1:00E44E 126E65            LCALL    ?L?COM0282
B1:00E451 9044A0            MOV      DPTR,#key
B1:00E454 122552            LCALL    ?C?PLDXDATA
B1:00E457 021D77            LJMP     ?INTERBANK_TABLE?_ZW_AES_ecb
----- FUNCTION _ciph_block (END) -------


----- FUNCTION ?L?COM03B3 (BEGIN) -----
B1:00E45A F9                MOV      R1,A
B1:00E45B E4                CLR      A
B1:00E45C 3A                ADDC     A,R2
B1:00E45D FA                MOV      R2,A
B1:00E45E 7403              MOV      A,#03H
B1:00E460 22                RET      
----- FUNCTION ?L?COM03B3 (END) -------


----- FUNCTION _encrypt_or_decrypt (BEGIN) -----
B1:00E461 903DEF            MOV      DPTR,#data_array
B1:00E464 122572            LCALL    ?C?PSTXDATA
;---- Variable 'data_len' assigned to Register 'R4/R5' ----
B1:00E467 AF05              MOV      R7,AR5
B1:00E469 903E18            MOV      DPTR,#length
B1:00E46C EC                MOV      A,R4
B1:00E46D F0                MOVX     @DPTR,A
B1:00E46E A3                INC      DPTR
B1:00E46F EF                MOV      A,R7
B1:00E470 F0                MOVX     @DPTR,A
B1:00E471 E4                CLR      A
B1:00E472 903E06            MOV      DPTR,#i
B1:00E475 F0                MOVX     @DPTR,A
B1:00E476 A3                INC      DPTR
B1:00E477 F0                MOVX     @DPTR,A
B1:00E478         ?C0034?CCM:
B1:00E478 903DF4            MOV      DPTR,#num_ctr_blks
B1:00E47B E0                MOVX     A,@DPTR
B1:00E47C FE                MOV      R6,A
B1:00E47D A3                INC      DPTR
B1:00E47E E0                MOVX     A,@DPTR
B1:00E47F FF                MOV      R7,A
B1:00E480 C3                CLR      C
B1:00E481 903E07            MOV      DPTR,#i+01H
B1:00E484 E0                MOVX     A,@DPTR
B1:00E485 9F                SUBB     A,R7
B1:00E486 903E06            MOV      DPTR,#i
B1:00E489 E0                MOVX     A,@DPTR
B1:00E48A 9E                SUBB     A,R6
B1:00E48B 4002              JC       $ + 4H
B1:00E48D A16F              AJMP     ?C0043?CCM
B1:00E48F 7E00              MOV      R6,#00H
B1:00E491 7F10              MOV      R7,#010H
B1:00E493 7D00              MOV      R5,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 420


B1:00E495 B176              ACALL    ?L?COM0464
B1:00E497 1228E0            LCALL    ?C?MEMSET
B1:00E49A E4                CLR      A
B1:00E49B 903E08            MOV      DPTR,#ctr
B1:00E49E F0                MOVX     @DPTR,A
B1:00E49F 12FD6F            LCALL    ?L?COM0576
B1:00E4A2 903E08            MOV      DPTR,#ctr
B1:00E4A5 F0                MOVX     @DPTR,A
B1:00E4A6 904606            MOV      DPTR,#n
B1:00E4A9 E0                MOVX     A,@DPTR
B1:00E4AA FF                MOV      R7,A
B1:00E4AB 7E00              MOV      R6,#00H
B1:00E4AD 7809              MOV      R0,#LOW ctr+01H
B1:00E4AF 7C3E              MOV      R4,#HIGH ctr+01H
B1:00E4B1 7D01              MOV      R5,#01H
B1:00E4B3 903DF9            MOV      DPTR,#nonce
B1:00E4B6 122552            LCALL    ?C?PLDXDATA
B1:00E4B9 121F56            LCALL    ?C?COPY
B1:00E4BC 903E06            MOV      DPTR,#i
B1:00E4BF 12653F            LCALL    ?L?COM03C6
B1:00E4C2 903E16            MOV      DPTR,#ctr+0EH
B1:00E4C5 F0                MOVX     @DPTR,A
B1:00E4C6 ED                MOV      A,R5
B1:00E4C7 A3                INC      DPTR
B1:00E4C8 F0                MOVX     @DPTR,A
B1:00E4C9 903DFE            MOV      DPTR,#key
B1:00E4CC 12CF56            LCALL    ?L?COM012A
B1:00E4CF B176              ACALL    ?L?COM0464
B1:00E4D1 913A              ACALL    _ciph_block
B1:00E4D3 903E06            MOV      DPTR,#i
B1:00E4D6 E0                MOVX     A,@DPTR
B1:00E4D7 7002              JNZ      ?C0057?CCM
B1:00E4D9 A3                INC      DPTR
B1:00E4DA E0                MOVX     A,@DPTR
B1:00E4DB         ?C0057?CCM:
B1:00E4DB 7025              JNZ      ?C0037?CCM
B1:00E4DD 903E04            MOV      DPTR,#mode
B1:00E4E0 E0                MOVX     A,@DPTR
B1:00E4E1 7004              JNZ      ?C0058?CCM
B1:00E4E3 A3                INC      DPTR
B1:00E4E4 E0                MOVX     A,@DPTR
B1:00E4E5 6401              XRL      A,#01H
B1:00E4E7         ?C0058?CCM:
B1:00E4E7 7019              JNZ      ?C0037?CCM
B1:00E4E9 903E01            MOV      DPTR,#mac
B1:00E4EC 122552            LCALL    ?C?PLDXDATA
B1:00E4EF B170              ACALL    ?L?COM03B4
B1:00E4F1 903DFC            MOV      DPTR,#mac_len
B1:00E4F4 B1A2              ACALL    ?L?COM0575
B1:00E4F6 12F936            LCALL    ?L?COM00D4
B1:00E4F9 7A3E              MOV      R2,#HIGH ctr
B1:00E4FB 7908              MOV      R1,#LOW ctr
B1:00E4FD 12CDF1            LCALL    _bit_xor
B1:00E500 8061              SJMP     ?C0036?CCM
B1:00E502         ?C0037?CCM:
B1:00E502 903E06            MOV      DPTR,#i
B1:00E505 E0                MOVX     A,@DPTR
B1:00E506 7002              JNZ      ?C0059?CCM
B1:00E508 A3                INC      DPTR
B1:00E509 E0                MOVX     A,@DPTR
B1:00E50A         ?C0059?CCM:
B1:00E50A 7018              JNZ      ?C0039?CCM
B1:00E50C 903E04            MOV      DPTR,#mode
B1:00E50F E0                MOVX     A,@DPTR
B1:00E510 7002              JNZ      ?C0060?CCM
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 421


B1:00E512 A3                INC      DPTR
B1:00E513 E0                MOVX     A,@DPTR
B1:00E514         ?C0060?CCM:
B1:00E514 700E              JNZ      ?C0039?CCM
B1:00E516 903DF6            MOV      DPTR,#block
B1:00E519 B1B3              ACALL    ?L?COM0104
B1:00E51B 7A3E              MOV      R2,#HIGH ctr
B1:00E51D 7908              MOV      R1,#LOW ctr
B1:00E51F 12DF7E            LCALL    ?L?COM0086
B1:00E522 803F              SJMP     ?C0036?CCM
B1:00E524         ?C0039?CCM:
B1:00E524 C3                CLR      C
B1:00E525 903E19            MOV      DPTR,#length+01H
B1:00E528 E0                MOVX     A,@DPTR
B1:00E529 9410              SUBB     A,#010H
B1:00E52B 903E18            MOV      DPTR,#length
B1:00E52E E0                MOVX     A,@DPTR
B1:00E52F 9400              SUBB     A,#00H
B1:00E531 903E07            MOV      DPTR,#i+01H
B1:00E534 E0                MOVX     A,@DPTR
B1:00E535 400E              JC       ?C0041?CCM
B1:00E537 B17D              ACALL    ?L?COM0078
B1:00E539 B170              ACALL    ?L?COM03B4
B1:00E53B 904358            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00E53E E4                CLR      A
B1:00E53F F0                MOVX     @DPTR,A
B1:00E540 A3                INC      DPTR
B1:00E541 7410              MOV      A,#010H
B1:00E543 800D              SJMP     ?C0063?CCM
B1:00E545         ?C0041?CCM:
B1:00E545 B17D              ACALL    ?L?COM0078
B1:00E547 B170              ACALL    ?L?COM03B4
B1:00E549 903E18            MOV      DPTR,#length
B1:00E54C B1A2              ACALL    ?L?COM0575
B1:00E54E CF                XCH      A,R7
B1:00E54F F0                MOVX     @DPTR,A
B1:00E550 A3                INC      DPTR
B1:00E551 EF                MOV      A,R7
B1:00E552         
B1:00E552 F0                MOVX     @DPTR,A
B1:00E553 B176              ACALL    ?L?COM0464
B1:00E555 12CDF1            LCALL    _bit_xor
B1:00E558         ?C0042?CCM:
B1:00E558 903E18            MOV      DPTR,#length
B1:00E55B 74FF              MOV      A,#0FFH
B1:00E55D 75F0F0            MOV      B,#0F0H
B1:00E560 12210C            LCALL    ?C?IILDX
B1:00E563         ?C0036?CCM:
B1:00E563 903E06            MOV      DPTR,#i
B1:00E566 E4                CLR      A
B1:00E567 75F001            MOV      B,#01H
B1:00E56A 12210C            LCALL    ?C?IILDX
B1:00E56D 8178              AJMP     ?C0034?CCM
B1:00E56F         ?C0043?CCM:
B1:00E56F 22                RET      
----- FUNCTION _encrypt_or_decrypt (END) -------


----- FUNCTION ?L?COM03B4 (BEGIN) -----
B1:00E570 904355            MOV      DPTR,#?_bit_xor?BYTE+03H
B1:00E573 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM03B4 (END) -------


----- FUNCTION ?L?COM0464 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 422


B1:00E576 7B01              MOV      R3,#01H
B1:00E578 7A3E              MOV      R2,#HIGH ctr
B1:00E57A 7908              MOV      R1,#LOW ctr
B1:00E57C 22                RET      
----- FUNCTION ?L?COM0464 (END) -------


----- FUNCTION ?L?COM0078 (BEGIN) -----
B1:00E57D 24FF              ADD      A,#0FFH
B1:00E57F FF                MOV      R7,A
B1:00E580 903E06            MOV      DPTR,#i
B1:00E583 E0                MOVX     A,@DPTR
B1:00E584 34FF              ADDC     A,#0FFH
B1:00E586 FE                MOV      R6,A
B1:00E587 EF                MOV      A,R7
B1:00E588 C4                SWAP     A
B1:00E589 F8                MOV      R0,A
B1:00E58A 540F              ANL      A,#0FH
B1:00E58C C8                XCH      A,R0
B1:00E58D 68                XRL      A,R0
B1:00E58E FF                MOV      R7,A
B1:00E58F EE                MOV      A,R6
B1:00E590 C4                SWAP     A
B1:00E591 54F0              ANL      A,#0F0H
B1:00E593 48                ORL      A,R0
B1:00E594 FE                MOV      R6,A
B1:00E595 903DEF            MOV      DPTR,#data_array
B1:00E598         ?L?COM0079:
B1:00E598 122552            LCALL    ?C?PLDXDATA
B1:00E59B         ?L?COM007A:
B1:00E59B E9                MOV      A,R1
B1:00E59C 2F                ADD      A,R7
B1:00E59D F9                MOV      R1,A
B1:00E59E EA                MOV      A,R2
B1:00E59F 3E                ADDC     A,R6
B1:00E5A0 FA                MOV      R2,A
B1:00E5A1 22                RET      
----- FUNCTION ?L?COM0078 (END) -------


----- FUNCTION ?L?COM0575 (BEGIN) -----
B1:00E5A2 E0                MOVX     A,@DPTR
B1:00E5A3 FF                MOV      R7,A
B1:00E5A4 A3                INC      DPTR
B1:00E5A5 E0                MOVX     A,@DPTR
B1:00E5A6 904358            MOV      DPTR,#?_bit_xor?BYTE+06H
B1:00E5A9 22                RET      
----- FUNCTION ?L?COM0575 (END) -------


----- FUNCTION ?L?COM0510 (BEGIN) -----
B1:00E5AA 903D25            MOV      DPTR,#mac_len
B1:00E5AD E0                MOVX     A,@DPTR
B1:00E5AE FE                MOV      R6,A
B1:00E5AF A3                INC      DPTR
B1:00E5B0 E0                MOVX     A,@DPTR
B1:00E5B1 FF                MOV      R7,A
B1:00E5B2 22                RET      
----- FUNCTION ?L?COM0510 (END) -------


----- FUNCTION ?L?COM0104 (BEGIN) -----
B1:00E5B3 122552            LCALL    ?C?PLDXDATA
B1:00E5B6 A801              MOV      R0,AR1
B1:00E5B8         ?L?COM0105:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 423


B1:00E5B8 AC02              MOV      R4,AR2
B1:00E5BA AD03              MOV      R5,AR3
B1:00E5BC 7B01              MOV      R3,#01H
B1:00E5BE 22                RET      
----- FUNCTION ?L?COM0104 (END) -------


----- FUNCTION _mladder (BEGIN) -----
B1:00E5BF 9034BB            MOV      DPTR,#xr
B1:00E5C2 EB                MOV      A,R3
B1:00E5C3 D191              ACALL    ?L?COM0148
B1:00E5C5 E4                CLR      A
B1:00E5C6 903565            MOV      DPTR,#prevbit
B1:00E5C9 F0                MOVX     @DPTR,A
B1:00E5CA 78C4              MOV      R0,#LOW work
B1:00E5CC 7C34              MOV      R4,#HIGH work
B1:00E5CE D17B              ACALL    ?L?COM0154
B1:00E5D0 D188              ACALL    ?L?COM0329
B1:00E5D2 7E34              MOV      R6,#HIGH work+020H
B1:00E5D4 7FE4              MOV      R7,#LOW work+020H
B1:00E5D6 121DE5            LCALL    ?INTERBANK_TABLE?_fe25519_setone
B1:00E5D9 7E35              MOV      R6,#HIGH work+040H
B1:00E5DB 7F04              MOV      R7,#LOW work+040H
B1:00E5DD 121DE0            LCALL    ?INTERBANK_TABLE?_fe25519_setzero
B1:00E5E0 7824              MOV      R0,#LOW work+060H
B1:00E5E2 7C35              MOV      R4,#HIGH work+060H
B1:00E5E4 D17B              ACALL    ?L?COM0154
B1:00E5E6 D188              ACALL    ?L?COM0329
B1:00E5E8 7E35              MOV      R6,#HIGH work+080H
B1:00E5EA 7F44              MOV      R7,#LOW work+080H
B1:00E5EC 121DE5            LCALL    ?INTERBANK_TABLE?_fe25519_setone
B1:00E5EF 903567            MOV      DPTR,#j
B1:00E5F2 7406              MOV      A,#06H
B1:00E5F4 F0                MOVX     @DPTR,A
B1:00E5F5 A3                INC      DPTR
B1:00E5F6 741F              MOV      A,#01FH
B1:00E5F8 F0                MOVX     @DPTR,A
B1:00E5F9         ?C0003?CURVE25519:
B1:00E5F9         ?C0006?CURVE25519:
B1:00E5F9 903567            MOV      DPTR,#j
B1:00E5FC F187              ACALL    ?L?COM0573
B1:00E5FE 404B              JC       ?C0007?CURVE25519
B1:00E600 9034C1            MOV      DPTR,#s
B1:00E603 D180              ACALL    ?L?COM0156
B1:00E605 F9                MOV      R1,A
B1:00E606 903568            MOV      DPTR,#i
B1:00E609 E0                MOVX     A,@DPTR
B1:00E60A FD                MOV      R5,A
B1:00E60B 33                RLC      A
B1:00E60C 95E0              SUBB     A,ACC
B1:00E60E 8D82              MOV      DPL,R5
B1:00E610 F583              MOV      DPH,A
B1:00E612 121FB9            LCALL    ?C?CLDOPTR
B1:00E615 FE                MOV      R6,A
B1:00E616 A807              MOV      R0,AR7
B1:00E618 08                INC      R0
B1:00E619 8002              SJMP     ?C0015?CURVE25519
B1:00E61B         ?C0014?CURVE25519:
B1:00E61B C3                CLR      C
B1:00E61C 13                RRC      A
B1:00E61D         ?C0015?CURVE25519:
B1:00E61D D8FC              DJNZ     R0,?C0014?CURVE25519
B1:00E61F 5401              ANL      A,#01H
B1:00E621 FF                MOV      R7,A
B1:00E622 903564            MOV      DPTR,#bit_
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 424


B1:00E625 F0                MOVX     @DPTR,A
B1:00E626 A3                INC      DPTR
B1:00E627 E0                MOVX     A,@DPTR
B1:00E628 6F                XRL      A,R7
B1:00E629 FE                MOV      R6,A
B1:00E62A A3                INC      DPTR
B1:00E62B F0                MOVX     @DPTR,A
B1:00E62C FD                MOV      R5,A
B1:00E62D 903565            MOV      DPTR,#prevbit
B1:00E630 EF                MOV      A,R7
B1:00E631 F0                MOVX     @DPTR,A
B1:00E632 7B01              MOV      R3,#01H
B1:00E634 7A34              MOV      R2,#HIGH work
B1:00E636 79C4              MOV      R1,#LOW work
B1:00E638 D199              ACALL    _work_cswap
B1:00E63A 7B01              MOV      R3,#01H
B1:00E63C 7A34              MOV      R2,#HIGH work
B1:00E63E 79C4              MOV      R1,#LOW work
B1:00E640 12EB6B            LCALL    _ladderstep
B1:00E643 903567            MOV      DPTR,#j
B1:00E646 E0                MOVX     A,@DPTR
B1:00E647 14                DEC      A
B1:00E648 F0                MOVX     @DPTR,A
B1:00E649 80AE              SJMP     ?C0006?CURVE25519
B1:00E64B         ?C0007?CURVE25519:
B1:00E64B 903567            MOV      DPTR,#j
B1:00E64E 7407              MOV      A,#07H
B1:00E650 F0                MOVX     @DPTR,A
B1:00E651 A3                INC      DPTR
B1:00E652 E0                MOVX     A,@DPTR
B1:00E653 14                DEC      A
B1:00E654 F0                MOVX     @DPTR,A
B1:00E655 E0                MOVX     A,@DPTR
B1:00E656 C3                CLR      C
B1:00E657 6480              XRL      A,#080H
B1:00E659 9480              SUBB     A,#080H
B1:00E65B 509C              JNC      ?C0003?CURVE25519
B1:00E65D         ?C0004?CURVE25519:
B1:00E65D D17D              ACALL    ?L?COM0155
B1:00E65F F8                MOV      R0,A
B1:00E660 B1B8              ACALL    ?L?COM0105
B1:00E662 7A34              MOV      R2,#HIGH work+020H
B1:00E664 79E4              MOV      R1,#LOW work+020H
B1:00E666 D189              ACALL    ?L?COM032A
B1:00E668 9034BE            MOV      DPTR,#zr
B1:00E66B D180              ACALL    ?L?COM0156
B1:00E66D F8                MOV      R0,A
B1:00E66E B1B8              ACALL    ?L?COM0105
B1:00E670 7A35              MOV      R2,#HIGH work+040H
B1:00E672 7904              MOV      R1,#LOW work+040H
B1:00E674 7E00              MOV      R6,#00H
B1:00E676 7F20              MOV      R7,#020H
B1:00E678 021F56            LJMP     ?C?COPY
----- FUNCTION _mladder (END) -------


----- FUNCTION ?L?COM0154 (BEGIN) -----
B1:00E67B 7D01              MOV      R5,#01H
B1:00E67D         ?L?COM0155:
B1:00E67D 9034BB            MOV      DPTR,#xr
B1:00E680         ?L?COM0156:
B1:00E680 E0                MOVX     A,@DPTR
B1:00E681 FB                MOV      R3,A
B1:00E682 A3                INC      DPTR
B1:00E683 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 425


B1:00E684 FA                MOV      R2,A
B1:00E685 A3                INC      DPTR
B1:00E686 E0                MOVX     A,@DPTR
B1:00E687 22                RET      
----- FUNCTION ?L?COM0154 (END) -------


----- FUNCTION ?L?COM0329 (BEGIN) -----
B1:00E688 F9                MOV      R1,A
B1:00E689         ?L?COM032A:
B1:00E689 7E00              MOV      R6,#00H
B1:00E68B 7F20              MOV      R7,#020H
B1:00E68D 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM0329 (END) -------


----- FUNCTION ?L?COM0147 (BEGIN) -----
B1:00E690 C9                XCH      A,R1
B1:00E691         ?L?COM0148:
B1:00E691 F0                MOVX     @DPTR,A
B1:00E692 A3                INC      DPTR
B1:00E693 EA                MOV      A,R2
B1:00E694 F0                MOVX     @DPTR,A
B1:00E695 A3                INC      DPTR
B1:00E696 E9                MOV      A,R1
B1:00E697 F0                MOVX     @DPTR,A
B1:00E698 22                RET      
----- FUNCTION ?L?COM0147 (END) -------


----- FUNCTION _work_cswap (BEGIN) -----
B1:00E699 903E99            MOV      DPTR,#work
B1:00E69C EB                MOV      A,R3
B1:00E69D D191              ACALL    ?L?COM0148
B1:00E69F A3                INC      DPTR
B1:00E6A0 ED                MOV      A,R5
B1:00E6A1 F0                MOVX     @DPTR,A
B1:00E6A2 7E3E              MOV      R6,#HIGH t
B1:00E6A4 7F9D              MOV      R7,#LOW t
B1:00E6A6 121DE0            LCALL    ?INTERBANK_TABLE?_fe25519_setzero
B1:00E6A9 7E3E              MOV      R6,#HIGH t
B1:00E6AB 7F9D              MOV      R7,#LOW t
B1:00E6AD F103              ACALL    ?L?COM010A
B1:00E6AF 2420              ADD      A,#020H
B1:00E6B1 D1F7              ACALL    ?L?COM0109
B1:00E6B3 2420              ADD      A,#020H
B1:00E6B5 1287D7            LCALL    ?L?COM02D1
B1:00E6B8 903E99            MOV      DPTR,#work
B1:00E6BB A3                INC      DPTR
B1:00E6BC A3                INC      DPTR
B1:00E6BD E0                MOVX     A,@DPTR
B1:00E6BE 2460              ADD      A,#060H
B1:00E6C0 D1F7              ACALL    ?L?COM0109
B1:00E6C2 2460              ADD      A,#060H
B1:00E6C4 1287D7            LCALL    ?L?COM02D1
B1:00E6C7 F10C              ACALL    ?L?COM0536
B1:00E6C9 121DEA            LCALL    ?INTERBANK_TABLE?_fe25519_cmov
B1:00E6CC 7E3E              MOV      R6,#HIGH t
B1:00E6CE 7F9D              MOV      R7,#LOW t
B1:00E6D0 F103              ACALL    ?L?COM010A
B1:00E6D2 2440              ADD      A,#040H
B1:00E6D4 D1F7              ACALL    ?L?COM0109
B1:00E6D6 2440              ADD      A,#040H
B1:00E6D8 1287D7            LCALL    ?L?COM02D1
B1:00E6DB 903E99            MOV      DPTR,#work
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 426


B1:00E6DE A3                INC      DPTR
B1:00E6DF A3                INC      DPTR
B1:00E6E0 E0                MOVX     A,@DPTR
B1:00E6E1 2480              ADD      A,#080H
B1:00E6E3 D1F7              ACALL    ?L?COM0109
B1:00E6E5 2480              ADD      A,#080H
B1:00E6E7 1287D7            LCALL    ?L?COM02D1
B1:00E6EA F10C              ACALL    ?L?COM0536
B1:00E6EC 021DEA            LJMP     ?INTERBANK_TABLE?_fe25519_cmov
----- FUNCTION _work_cswap (END) -------


----- FUNCTION ?L?COM052D (BEGIN) -----
B1:00E6EF 8D82              MOV      DPL,R5
B1:00E6F1 8C83              MOV      DPH,R4
B1:00E6F3 7403              MOV      A,#03H
B1:00E6F5 93                MOVC     A,@A+DPTR
B1:00E6F6 22                RET      
----- FUNCTION ?L?COM052D (END) -------


----- FUNCTION ?L?COM0109 (BEGIN) -----
B1:00E6F7 F9                MOV      R1,A
B1:00E6F8 E4                CLR      A
B1:00E6F9 3A                ADDC     A,R2
B1:00E6FA FC                MOV      R4,A
B1:00E6FB AD01              MOV      R5,AR1
B1:00E6FD A3                INC      DPTR
B1:00E6FE E0                MOVX     A,@DPTR
B1:00E6FF FB                MOV      R3,A
B1:00E700 121DEA            LCALL    ?INTERBANK_TABLE?_fe25519_cmov
B1:00E703         ?L?COM010A:
B1:00E703 903E99            MOV      DPTR,#work
B1:00E706 A3                INC      DPTR
B1:00E707 E0                MOVX     A,@DPTR
B1:00E708 FA                MOV      R2,A
B1:00E709 A3                INC      DPTR
B1:00E70A E0                MOVX     A,@DPTR
B1:00E70B 22                RET      
----- FUNCTION ?L?COM0109 (END) -------


----- FUNCTION ?L?COM0536 (BEGIN) -----
B1:00E70C 7C3E              MOV      R4,#HIGH t
B1:00E70E 7D9D              MOV      R5,#LOW t
B1:00E710 A3                INC      DPTR
B1:00E711 E0                MOVX     A,@DPTR
B1:00E712 FB                MOV      R3,A
B1:00E713 22                RET      
----- FUNCTION ?L?COM0536 (END) -------


----- FUNCTION _ZW_SendDataMultiEx (BEGIN) -----
B1:00E714 900A38            MOV      DPTR,#pData
B1:00E717 122572            LCALL    ?C?PSTXDATA
;---- Variable 'dataLength' assigned to Register 'R5' ----
B1:00E71A E4                CLR      A
B1:00E71B 900671            MOV      DPTR,#eErrcode
B1:00E71E F0                MOVX     @DPTR,A
B1:00E71F 900A3C            MOV      DPTR,#pTxOptionsMultiEx
B1:00E722 1285EF            LCALL    ?L?COM0002
B1:00E725 6003              JZ       ?C0400?ZW_TRANSPORT
B1:00E727 B40409            CJNE     A,#04H,?C0399?ZW_TRANSPORT
B1:00E72A         ?C0400?ZW_TRANSPORT:
B1:00E72A 900671            MOV      DPTR,#eErrcode
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 427


B1:00E72D 7403              MOV      A,#03H
B1:00E72F F0                MOVX     @DPTR,A
B1:00E730 7F00              MOV      R7,#00H
B1:00E732 22                RET      
B1:00E733         ?C0399?ZW_TRANSPORT:
B1:00E733 7401              MOV      A,#01H
B1:00E735 D3                SETB     C
B1:00E736 9D                SUBB     A,R5
B1:00E737 5005              JNC      ?C0403?ZW_TRANSPORT
B1:00E739 ED                MOV      A,R5
B1:00E73A 9472              SUBB     A,#072H
B1:00E73C 4003              JC       ?C0402?ZW_TRANSPORT
B1:00E73E         ?C0403?ZW_TRANSPORT:
B1:00E73E 7F00              MOV      R7,#00H
B1:00E740 22                RET      
B1:00E741         ?C0402?ZW_TRANSPORT:
B1:00E741 900A3C            MOV      DPTR,#pTxOptionsMultiEx
B1:00E744 129557            LCALL    ?L?COM003C
B1:00E747 F9                MOV      R1,A
B1:00E748 E4                CLR      A
B1:00E749 3A                ADDC     A,R2
B1:00E74A FA                MOV      R2,A
B1:00E74B 7420              MOV      A,#020H
B1:00E74D 12FC51            LCALL    ?L?COM051E
B1:00E750 900A3C            MOV      DPTR,#pTxOptionsMultiEx
B1:00E753 1112              ACALL    ?L?COM00B3
B1:00E755 1287AB            LCALL    ?L?COM0015
B1:00E758 7C00              MOV      R4,#00H
B1:00E75A 900A3C            MOV      DPTR,#pTxOptionsMultiEx
B1:00E75D 122552            LCALL    ?C?PLDXDATA
B1:00E760 9040EF            MOV      DPTR,#?_sec2_send_data_multi?BYTE+05H
B1:00E763 122572            LCALL    ?C?PSTXDATA
B1:00E766 900A3F            MOV      DPTR,#completedFunc
B1:00E769 E0                MOVX     A,@DPTR
B1:00E76A FF                MOV      R7,A
B1:00E76B A3                INC      DPTR
B1:00E76C E0                MOVX     A,@DPTR
B1:00E76D 9040F2            MOV      DPTR,#?_sec2_send_data_multi?BYTE+08H
B1:00E770 CF                XCH      A,R7
B1:00E771 F0                MOVX     @DPTR,A
B1:00E772 A3                INC      DPTR
B1:00E773 EF                MOV      A,R7
B1:00E774 F0                MOVX     @DPTR,A
B1:00E775 900A38            MOV      DPTR,#pData
B1:00E778 122552            LCALL    ?C?PLDXDATA
B1:00E77B 121CB4            LCALL    ?INTERBANK_TABLE?_sec2_send_data_multi
B1:00E77E EF                MOV      A,R7
B1:00E77F 6003              JZ       ?C0404?ZW_TRANSPORT
B1:00E781 02FDF1            LJMP     ?L?COM058B
B1:00E784         ?C0404?ZW_TRANSPORT:
B1:00E784 7F00              MOV      R7,#00H
B1:00E786 22                RET      
----- FUNCTION _ZW_SendDataMultiEx (END) -------


----- FUNCTION ?L?COM0573 (BEGIN) -----
B1:00E787 E0                MOVX     A,@DPTR
B1:00E788 FF                MOV      R7,A
B1:00E789 C3                CLR      C
B1:00E78A 6480              XRL      A,#080H
B1:00E78C 9480              SUBB     A,#080H
B1:00E78E 22                RET      
----- FUNCTION ?L?COM0573 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 428


----- FUNCTION ZW_SendDataAbort (BEGIN) -----
B1:00E78F 12851B            LCALL    ?L?COM000C
B1:00E792 4A                ORL      A,R2
B1:00E793 600B              JZ       ?C0408?ZW_TRANSPORT
B1:00E795 E9                MOV      A,R1
B1:00E796 2402              ADD      A,#02H
B1:00E798 1285F5            LCALL    ?L?COM0004
B1:00E79B 30E502            JNB      ACC.5,?C0408?ZW_TRANSPORT
B1:00E79E D206              SETB     bApplicationTxAbort
B1:00E7A0         ?C0408?ZW_TRANSPORT:
B1:00E7A0 22                RET      
----- FUNCTION ZW_SendDataAbort (END) -------


----- FUNCTION SetTransmitPause (BEGIN) -----
B1:00E7A1 900679            MOV      DPTR,#sACK
B1:00E7A4 E0                MOVX     A,@DPTR
B1:00E7A5 30E10A            JNB      ACC.1,?C0442?ZW_TRANSPORT
B1:00E7A8 D215              SETB     bPauseEnabled
B1:00E7AA 12593A            LCALL    getTickTime
B1:00E7AD EF                MOV      A,R7
B1:00E7AE 9003BA            MOV      DPTR,#bPauseTransmitCountdown
B1:00E7B1 F0                MOVX     @DPTR,A
B1:00E7B2         ?C0442?ZW_TRANSPORT:
B1:00E7B2 22                RET      
----- FUNCTION SetTransmitPause (END) -------


----- FUNCTION _IsSpecialRssiValue (BEGIN) -----
;---- Variable 'rssi_sample' assigned to Register 'R7' ----
B1:00E7B3 EF                MOV      A,R7
B1:00E7B4 B47F03            CJNE     A,#07FH,?C0443?ZW_TRANSPORT
B1:00E7B7 D3                SETB     C
B1:00E7B8 8001              SJMP     ?C0444?ZW_TRANSPORT
B1:00E7BA         ?C0443?ZW_TRANSPORT:
B1:00E7BA C3                CLR      C
B1:00E7BB         ?C0444?ZW_TRANSPORT:
B1:00E7BB 22                RET      
----- FUNCTION _IsSpecialRssiValue (END) -------


----- FUNCTION ?L?COM025B (BEGIN) -----
B1:00E7BC 9009DC            MOV      DPTR,#pRssiArray
B1:00E7BF 122552            LCALL    ?C?PLDXDATA
B1:00E7C2 7D02              MOV      R5,#02H
----- FUNCTION _CalculateRssi (BEGIN) -----
B1:00E7C4 900A99            MOV      DPTR,#rssi_array
B1:00E7C7 122572            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R5' ----
B1:00E7CA E4                CLR      A
B1:00E7CB 900A9C            MOV      DPTR,#sum
B1:00E7CE F0                MOVX     @DPTR,A
B1:00E7CF A3                INC      DPTR
B1:00E7D0 F0                MOVX     @DPTR,A
;---- Variable 'i' assigned to Register 'R6' ----
B1:00E7D1 FE                MOV      R6,A
B1:00E7D2         ?C0446?ZW_TRANSPORT:
B1:00E7D2 EE                MOV      A,R6
B1:00E7D3 C3                CLR      C
B1:00E7D4 9D                SUBB     A,R5
B1:00E7D5 5025              JNC      ?C0447?ZW_TRANSPORT
B1:00E7D7 12E85D            LCALL    ?L?COM051C
B1:00E7DA 1285F5            LCALL    ?L?COM0004
B1:00E7DD FF                MOV      R7,A
B1:00E7DE FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 429


B1:00E7DF 900A9C            MOV      DPTR,#sum
B1:00E7E2 E4                CLR      A
B1:00E7E3 8BF0              MOV      B,R3
B1:00E7E5 12210C            LCALL    ?C?IILDX
B1:00E7E8 F1B3              ACALL    _IsSpecialRssiValue
B1:00E7EA 500D              JNC      ?C0448?ZW_TRANSPORT
B1:00E7EC 12E85D            LCALL    ?L?COM051C
B1:00E7EF 1285F5            LCALL    ?L?COM0004
B1:00E7F2 FF                MOV      R7,A
B1:00E7F3 900A9C            MOV      DPTR,#sum
B1:00E7F6 E4                CLR      A
B1:00E7F7 8050              SJMP     ?C0620?ZW_TRANSPORT
B1:00E7F9         ?C0448?ZW_TRANSPORT:
B1:00E7F9 0E                INC      R6
B1:00E7FA 80D6              SJMP     ?C0446?ZW_TRANSPORT
B1:00E7FC         ?C0447?ZW_TRANSPORT:
B1:00E7FC 12E854            LCALL    ?L?COM051B
B1:00E7FF 7C00              MOV      R4,#00H
B1:00E801 122081            LCALL    ?C?UIDIV
B1:00E804 900A9C            MOV      DPTR,#sum
B1:00E807 125831            LCALL    ?L?COM04C1
B1:00E80A 9450              SUBB     A,#050H
B1:00E80C EE                MOV      A,R6
B1:00E80D 9400              SUBB     A,#00H
B1:00E80F 400B              JC       ?C0451?ZW_TRANSPORT
B1:00E811 900A9C            MOV      DPTR,#sum
B1:00E814 E4                CLR      A
B1:00E815 F0                MOVX     @DPTR,A
B1:00E816 A3                INC      DPTR
B1:00E817 747E              MOV      A,#07EH
B1:00E819 F0                MOVX     @DPTR,A
B1:00E81A 8031              SJMP     return_now?ZW_TRANSPORT
B1:00E81C         ?C0451?ZW_TRANSPORT:
B1:00E81C 1154              ACALL    ?L?COM051B
B1:00E81E C3                CLR      C
B1:00E81F 9428              SUBB     A,#028H
B1:00E821 EE                MOV      A,R6
B1:00E822 9400              SUBB     A,#00H
B1:00E824 500B              JNC      ?C0452?ZW_TRANSPORT
B1:00E826 900A9C            MOV      DPTR,#sum
B1:00E829 E4                CLR      A
B1:00E82A F0                MOVX     @DPTR,A
B1:00E82B A3                INC      DPTR
B1:00E82C 747D              MOV      A,#07DH
B1:00E82E F0                MOVX     @DPTR,A
B1:00E82F 801C              SJMP     return_now?ZW_TRANSPORT
B1:00E831         ?C0452?ZW_TRANSPORT:
B1:00E831 7C00              MOV      R4,#00H
B1:00E833 7D9B              MOV      R5,#09BH
B1:00E835 12206F            LCALL    ?C?IMUL
B1:00E838 EF                MOV      A,R7
B1:00E839 24DA              ADD      A,#0DAH
B1:00E83B FF                MOV      R7,A
B1:00E83C EE                MOV      A,R6
B1:00E83D 34C2              ADDC     A,#0C2H
B1:00E83F FE                MOV      R6,A
B1:00E840 7D64              MOV      R5,#064H
B1:00E842 1220D6            LCALL    ?C?SIDIV
B1:00E845 900A9C            MOV      DPTR,#sum
B1:00E848 EE                MOV      A,R6
B1:00E849         
B1:00E849 F0                MOVX     @DPTR,A
B1:00E84A A3                INC      DPTR
B1:00E84B EF                MOV      A,R7
B1:00E84C F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 430


B1:00E84D         return_now:
B1:00E84D 900A9C            MOV      DPTR,#sum
B1:00E850 A3                INC      DPTR
B1:00E851 E0                MOVX     A,@DPTR
B1:00E852 FF                MOV      R7,A
B1:00E853 22                RET      
----- FUNCTION _CalculateRssi (END) -------


----- FUNCTION ?L?COM051B (BEGIN) -----
B1:00E854 900A9C            MOV      DPTR,#sum
B1:00E857 E0                MOVX     A,@DPTR
B1:00E858 FE                MOV      R6,A
B1:00E859 A3                INC      DPTR
B1:00E85A E0                MOVX     A,@DPTR
B1:00E85B FF                MOV      R7,A
B1:00E85C 22                RET      
----- FUNCTION ?L?COM051B (END) -------


----- FUNCTION ?L?COM051C (BEGIN) -----
B1:00E85D 900A99            MOV      DPTR,#rssi_array
B1:00E860 122552            LCALL    ?C?PLDXDATA
B1:00E863 E9                MOV      A,R1
B1:00E864 2E                ADD      A,R6
B1:00E865 22                RET      
----- FUNCTION ?L?COM051C (END) -------


----- FUNCTION ?L?COM0578 (BEGIN) -----
B1:00E866 FF                MOV      R7,A
B1:00E867 90421A            MOV      DPTR,#length
B1:00E86A E0                MOVX     A,@DPTR
B1:00E86B 3400              ADDC     A,#00H
B1:00E86D 22                RET      
----- FUNCTION ?L?COM0578 (END) -------


----- FUNCTION _IsFrameIlLegal (BEGIN) -----
B1:00E86E 900A41            MOV      DPTR,#pRxFrame
B1:00E871 122572            LCALL    ?C?PSTXDATA
;---- Variable 'frameState' assigned to Register 'R7' ----
B1:00E874 E4                CLR      A
B1:00E875 FF                MOV      R7,A
B1:00E876 900A41            MOV      DPTR,#pRxFrame
B1:00E879 129549            LCALL    ?L?COM0058
B1:00E87C 1285F5            LCALL    ?L?COM0004
B1:00E87F FE                MOV      R6,A
B1:00E880 901221            MOV      DPTR,#nodeID
B1:00E883 E0                MOVX     A,@DPTR
B1:00E884 FD                MOV      R5,A
B1:00E885 6E                XRL      A,R6
B1:00E886 7026              JNZ      ?C0455?ZW_TRANSPORT
B1:00E888 900A41            MOV      DPTR,#pRxFrame
B1:00E88B 125D40            LCALL    ?L?COM034F
B1:00E88E 1285F5            LCALL    ?L?COM0004
B1:00E891 FE                MOV      R6,A
B1:00E892 540F              ANL      A,#0FH
B1:00E894 FC                MOV      R4,A
B1:00E895 BC0112            CJNE     R4,#01H,?C0456?ZW_TRANSPORT
B1:00E898 EE                MOV      A,R6
B1:00E899 30E70E            JNB      ACC.7,?C0456?ZW_TRANSPORT
B1:00E89C 121F7C            LCALL    ?C?CLDPTR
B1:00E89F 30E70C            JNB      ACC.7,?C0455?ZW_TRANSPORT
B1:00E8A2 11EC              ACALL    ?L?COM034A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 431


B1:00E8A4 1285F5            LCALL    ?L?COM0004
B1:00E8A7 B50504            CJNE     A,AR5,?C0455?ZW_TRANSPORT
B1:00E8AA         ?C0456?ZW_TRANSPORT:
B1:00E8AA EF                MOV      A,R7
B1:00E8AB 4401              ORL      A,#01H
B1:00E8AD FF                MOV      R7,A
B1:00E8AE         ?C0455?ZW_TRANSPORT:
B1:00E8AE 900A44            MOV      DPTR,#pCmdClass
B1:00E8B1 122552            LCALL    ?C?PLDXDATA
B1:00E8B4 E9                MOV      A,R1
B1:00E8B5 4A                ORL      A,R2
B1:00E8B6 6025              JZ       ?C0457?ZW_TRANSPORT
B1:00E8B8 121F7C            LCALL    ?C?CLDPTR
B1:00E8BB FE                MOV      R6,A
B1:00E8BC 649F              XRL      A,#09FH
B1:00E8BE 6005              JZ       ?C0458?ZW_TRANSPORT
B1:00E8C0 EE                MOV      A,R6
B1:00E8C1 6498              XRL      A,#098H
B1:00E8C3 7018              JNZ      ?C0457?ZW_TRANSPORT
B1:00E8C5         ?C0458?ZW_TRANSPORT:
B1:00E8C5 EF                MOV      A,R7
B1:00E8C6 30E003            JNB      ACC.0,?C0459?ZW_TRANSPORT
B1:00E8C9 7F01              MOV      R7,#01H
B1:00E8CB 22                RET      
B1:00E8CC         ?C0459?ZW_TRANSPORT:
B1:00E8CC 121F7C            LCALL    ?C?CLDPTR
B1:00E8CF B4980B            CJNE     A,#098H,?C0457?ZW_TRANSPORT
B1:00E8D2 11EC              ACALL    ?L?COM034A
B1:00E8D4 1285F5            LCALL    ?L?COM0004
B1:00E8D7 B4FF03            CJNE     A,#0FFH,?C0457?ZW_TRANSPORT
B1:00E8DA 7F01              MOV      R7,#01H
B1:00E8DC 22                RET      
B1:00E8DD         ?C0457?ZW_TRANSPORT:
B1:00E8DD 200107            JB       learnMode,?C0464?ZW_TRANSPORT
B1:00E8E0 EF                MOV      A,R7
B1:00E8E1 30E003            JNB      ACC.0,?C0464?ZW_TRANSPORT
B1:00E8E4 7F01              MOV      R7,#01H
B1:00E8E6 22                RET      
B1:00E8E7         ?C0464?ZW_TRANSPORT:
B1:00E8E7 EF                MOV      A,R7
B1:00E8E8 5402              ANL      A,#02H
B1:00E8EA FF                MOV      R7,A
B1:00E8EB 22                RET      
----- FUNCTION _IsFrameIlLegal (END) -------


----- FUNCTION ?L?COM034A (BEGIN) -----
B1:00E8EC 900A41            MOV      DPTR,#pRxFrame
B1:00E8EF         ?L?COM034B:
B1:00E8EF 122552            LCALL    ?C?PLDXDATA
B1:00E8F2 E9                MOV      A,R1
B1:00E8F3 2408              ADD      A,#08H
B1:00E8F5 22                RET      
----- FUNCTION ?L?COM034A (END) -------


----- FUNCTION _StoreReturnRouteSpeed (BEGIN) -----
B1:00E8F6 9043FF            MOV      DPTR,#destIndex
B1:00E8F9 ED                MOV      A,R5
B1:00E8FA F0                MOVX     @DPTR,A
B1:00E8FB 9043FC            MOV      DPTR,#returnRoute
B1:00E8FE 122572            LCALL    ?C?PSTXDATA
B1:00E901 E4                CLR      A
B1:00E902 904402            MOV      DPTR,#beamInfo
B1:00E905 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 432


B1:00E906 E9                MOV      A,R1
B1:00E907 2402              ADD      A,#02H
B1:00E909 1285F5            LCALL    ?L?COM0004
B1:00E90C 7002              JNZ      $ + 4H
B1:00E90E 21D9              AJMP     ?C0147?ZW_SLAVE
B1:00E910         ?C0146?ZW_SLAVE:
B1:00E910 9043FF            MOV      DPTR,#destIndex
B1:00E913 128F90            LCALL    ?L?COM032B
B1:00E916 1239EB            LCALL    ?L?COM007F
B1:00E919 90339C            MOV      DPTR,#temp
B1:00E91C EF                MOV      A,R7
B1:00E91D F0                MOVX     @DPTR,A
B1:00E91E 9043FC            MOV      DPTR,#returnRoute
B1:00E921 1285EF            LCALL    ?L?COM0002
B1:00E924 FF                MOV      R7,A
B1:00E925 C4                SWAP     A
B1:00E926 540F              ANL      A,#0FH
B1:00E928 903329            MOV      DPTR,#tempi
B1:00E92B F0                MOVX     @DPTR,A
B1:00E92C EF                MOV      A,R7
B1:00E92D 540F              ANL      A,#0FH
B1:00E92F FF                MOV      R7,A
B1:00E930 904400            MOV      DPTR,#bPayloadSize
B1:00E933 E0                MOVX     A,@DPTR
B1:00E934 C3                CLR      C
B1:00E935 9F                SUBB     A,R7
B1:00E936 C3                CLR      C
B1:00E937 9405              SUBB     A,#05H
B1:00E939 4049              JC       ?C0148?ZW_SLAVE
B1:00E93B 7E00              MOV      R6,#00H
B1:00E93D 9043FC            MOV      DPTR,#returnRoute
B1:00E940 129549            LCALL    ?L?COM0058
B1:00E943 12B8C4            LCALL    ?L?COM002D
B1:00E946 121F7C            LCALL    ?C?CLDPTR
B1:00E949 FF                MOV      R7,A
B1:00E94A 9043FC            MOV      DPTR,#returnRoute
B1:00E94D 1287A5            LCALL    ?L?COM0014
B1:00E950 904401            MOV      DPTR,#n
B1:00E953 F0                MOVX     @DPTR,A
B1:00E954 903329            MOV      DPTR,#tempi
B1:00E957 E0                MOVX     A,@DPTR
B1:00E958 703F              JNZ      ?C0150?ZW_SLAVE
B1:00E95A 9043FF            MOV      DPTR,#destIndex
B1:00E95D 1239E1            LCALL    ?L?COM007D
B1:00E960 904402            MOV      DPTR,#beamInfo
B1:00E963 EF                MOV      A,R7
B1:00E964 F0                MOVX     @DPTR,A
B1:00E965 E0                MOVX     A,@DPTR
B1:00E966 54FC              ANL      A,#0FCH
B1:00E968 FF                MOV      R7,A
B1:00E969 F0                MOVX     @DPTR,A
B1:00E96A 904401            MOV      DPTR,#n
B1:00E96D E0                MOVX     A,@DPTR
B1:00E96E 5406              ANL      A,#06H
B1:00E970 C3                CLR      C
B1:00E971 13                RRC      A
B1:00E972 4F                ORL      A,R7
B1:00E973 A3                INC      DPTR
B1:00E974 F0                MOVX     @DPTR,A
B1:00E975 9043FF            MOV      DPTR,#destIndex
B1:00E978 31DA              ACALL    ?L?COM0307
B1:00E97A 904402            MOV      DPTR,#beamInfo
B1:00E97D E0                MOVX     A,@DPTR
B1:00E97E FD                MOV      R5,A
B1:00E97F 12444A            LCALL    _NVM_ext_write_byte
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 433


B1:00E982 8015              SJMP     ?C0150?ZW_SLAVE
B1:00E984         ?C0148?ZW_SLAVE:
B1:00E984 90339C            MOV      DPTR,#temp
B1:00E987 E0                MOVX     A,@DPTR
B1:00E988 54FC              ANL      A,#0FCH
B1:00E98A F0                MOVX     @DPTR,A
B1:00E98B 4401              ORL      A,#01H
B1:00E98D F0                MOVX     @DPTR,A
B1:00E98E 9043FC            MOV      DPTR,#returnRoute
B1:00E991 12BBFD            LCALL    ?L?COM0121
B1:00E994 7408              MOV      A,#08H
B1:00E996 12203B            LCALL    ?C?CSTPTR
B1:00E999         ?C0150?ZW_SLAVE:
B1:00E999 90339C            MOV      DPTR,#temp
B1:00E99C E0                MOVX     A,@DPTR
B1:00E99D FF                MOV      R7,A
B1:00E99E 903329            MOV      DPTR,#tempi
B1:00E9A1 E0                MOVX     A,@DPTR
B1:00E9A2 25E0              ADD      A,ACC
B1:00E9A4 FE                MOV      R6,A
B1:00E9A5 7403              MOV      A,#03H
B1:00E9A7 A806              MOV      R0,AR6
B1:00E9A9 08                INC      R0
B1:00E9AA 8002              SJMP     ?C0303?ZW_SLAVE
B1:00E9AC         ?C0302?ZW_SLAVE:
B1:00E9AC C3                CLR      C
B1:00E9AD 33                RLC      A
B1:00E9AE         ?C0303?ZW_SLAVE:
B1:00E9AE D8FC              DJNZ     R0,?C0302?ZW_SLAVE
B1:00E9B0 F4                CPL      A
B1:00E9B1 5F                ANL      A,R7
B1:00E9B2 FF                MOV      R7,A
B1:00E9B3 90339C            MOV      DPTR,#temp
B1:00E9B6 F0                MOVX     @DPTR,A
B1:00E9B7 9043FC            MOV      DPTR,#returnRoute
B1:00E9BA 11EF              ACALL    ?L?COM034B
B1:00E9BC 1285F5            LCALL    ?L?COM0004
B1:00E9BF 13                RRC      A
B1:00E9C0 13                RRC      A
B1:00E9C1 13                RRC      A
B1:00E9C2 5403              ANL      A,#03H
B1:00E9C4 FD                MOV      R5,A
B1:00E9C5 A806              MOV      R0,AR6
B1:00E9C7 08                INC      R0
B1:00E9C8 8002              SJMP     ?C0305?ZW_SLAVE
B1:00E9CA         ?C0304?ZW_SLAVE:
B1:00E9CA C3                CLR      C
B1:00E9CB 33                RLC      A
B1:00E9CC         ?C0305?ZW_SLAVE:
B1:00E9CC D8FC              DJNZ     R0,?C0304?ZW_SLAVE
B1:00E9CE 4F                ORL      A,R7
B1:00E9CF 90339C            MOV      DPTR,#temp
B1:00E9D2 F0                MOVX     @DPTR,A
B1:00E9D3 9043FF            MOV      DPTR,#destIndex
B1:00E9D6 124434            LCALL    ?L?COM0178
B1:00E9D9         ?C0147?ZW_SLAVE:
B1:00E9D9 22                RET      
----- FUNCTION _StoreReturnRouteSpeed (END) -------


----- FUNCTION ?L?COM0307 (BEGIN) -----
B1:00E9DA E0                MOVX     A,@DPTR
B1:00E9DB 75F002            MOV      B,#02H
B1:00E9DE A4                MUL      AB
B1:00E9DF 2485              ADD      A,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 434


B1:00E9E1 F9                MOV      R1,A
B1:00E9E2 740F              MOV      A,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00E9E4 35F0              ADDC     A,B
B1:00E9E6 7B02              MOV      R3,#MBYTE NVM_RETURN_ROUTE_SPEED_START_far
B1:00E9E8 FE                MOV      R6,A
B1:00E9E9 AF01              MOV      R7,AR1
B1:00E9EB 22                RET      
----- FUNCTION ?L?COM0307 (END) -------


----- FUNCTION TransportInit (BEGIN) -----
B1:00E9EC 31FB              ACALL    FlushResponseSpeeds
B1:00E9EE C215              CLR      bPauseEnabled
B1:00E9F0 E4                CLR      A
B1:00E9F1 9003BA            MOV      DPTR,#bPauseTransmitCountdown
B1:00E9F4 F0                MOVX     @DPTR,A
B1:00E9F5 900673            MOV      DPTR,#bRoutedRssiFeedbackEnabled
B1:00E9F8 04                INC      A
B1:00E9F9 F0                MOVX     @DPTR,A
B1:00E9FA 22                RET      
----- FUNCTION TransportInit (END) -------


----- FUNCTION FlushResponseSpeeds (BEGIN) -----
B1:00E9FB 7B01              MOV      R3,#01H
B1:00E9FD 7A07              MOV      R2,#HIGH abDirectNodesResponseSpeed
B1:00E9FF 7981              MOV      R1,#LOW abDirectNodesResponseSpeed
B1:00EA01 7D04              MOV      R5,#04H
B1:00EA03 E4                CLR      A
B1:00EA04 FF                MOV      R7,A
B1:00EA05 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION FlushResponseSpeeds (END) -------


----- FUNCTION transportVarInit (BEGIN) -----
B1:00EA08 C206              CLR      bApplicationTxAbort
B1:00EA0A C209              CLR      inclusionHomeIDActive
B1:00EA0C D208              SETB     currentSeqNoUseTX
B1:00EA0E E4                CLR      A
B1:00EA0F 90077A            MOV      DPTR,#bReturnRoutePriorityIndex
B1:00EA12 F0                MOVX     @DPTR,A
B1:00EA13 C207              CLR      iResponseNodeIndex
B1:00EA15 900785            MOV      DPTR,#_ts_stored_callback
B1:00EA18 F0                MOVX     @DPTR,A
B1:00EA19 A3                INC      DPTR
B1:00EA1A F0                MOVX     @DPTR,A
B1:00EA1B 22                RET      
----- FUNCTION transportVarInit (END) -------


----- FUNCTION _ZW_RxToTxOptions (BEGIN) -----
B1:00EA1C 900A74            MOV      DPTR,#rxopt
B1:00EA1F 122572            LCALL    ?C?PSTXDATA
B1:00EA22 900A77            MOV      DPTR,#txopt
B1:00EA25 122552            LCALL    ?C?PLDXDATA
B1:00EA28 515C              ACALL    ?L?COM0098
B1:00EA2A 900A74            MOV      DPTR,#rxopt
B1:00EA2D 12E012            LCALL    ?L?COM00B3
B1:00EA30 1285F5            LCALL    ?L?COM0004
B1:00EA33 900A77            MOV      DPTR,#txopt
B1:00EA36 1256DE            LCALL    ?L?COM0124
B1:00EA39 900A77            MOV      DPTR,#txopt
B1:00EA3C 129557            LCALL    ?L?COM003C
B1:00EA3F 12D1A7            LCALL    ?L?COM00E3
B1:00EA42 900A74            MOV      DPTR,#rxopt
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 435


B1:00EA45 129549            LCALL    ?L?COM0058
B1:00EA48 1285F5            LCALL    ?L?COM0004
B1:00EA4B FF                MOV      R7,A
B1:00EA4C 900A77            MOV      DPTR,#txopt
B1:00EA4F 129549            LCALL    ?L?COM0058
B1:00EA52 F9                MOV      R1,A
B1:00EA53 E4                CLR      A
B1:00EA54 3A                ADDC     A,R2
B1:00EA55 FA                MOV      R2,A
B1:00EA56 EF                MOV      A,R7
B1:00EA57 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_RxToTxOptions (END) -------


----- FUNCTION ?L?COM0097 (BEGIN) -----
B1:00EA5A 7B01              MOV      R3,#01H
B1:00EA5C         ?L?COM0098:
B1:00EA5C 7D06              MOV      R5,#06H
B1:00EA5E E4                CLR      A
B1:00EA5F FF                MOV      R7,A
B1:00EA60 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM0097 (END) -------


----- FUNCTION _secure_learnIfaceL_send_key_verify (BEGIN) -----
B1:00EA63 904322            MOV      DPTR,#node
B1:00EA66 1224BA            LCALL    ?C?LSTXDATA
B1:00EA69 7A36              MOV      R2,#HIGH txopt
B1:00EA6B 7917              MOV      R1,#LOW txopt
B1:00EA6D 515A              ACALL    ?L?COM0097
B1:00EA6F 904322            MOV      DPTR,#node
B1:00EA72 122462            LCALL    ?C?LLDXDATA
B1:00EA75 903617            MOV      DPTR,#txopt
B1:00EA78 EF                MOV      A,R7
B1:00EA79 F0                MOVX     @DPTR,A
B1:00EA7A 904326            MOV      DPTR,#txOptions
B1:00EA7D 122462            LCALL    ?C?LLDXDATA
B1:00EA80 903619            MOV      DPTR,#txopt+02H
B1:00EA83 EF                MOV      A,R7
B1:00EA84 F0                MOVX     @DPTR,A
B1:00EA85 90361B            MOV      DPTR,#txopt+04H
B1:00EA88 7404              MOV      A,#04H
B1:00EA8A F0                MOVX     @DPTR,A
B1:00EA8B 7A36              MOV      R2,#HIGH txopt
B1:00EA8D 7917              MOV      R1,#LOW txopt
B1:00EA8F 51BA              ACALL    ?L?COM0150
B1:00EA91 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B1:00EA94 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_send_key_verify_callback
B1:00EA96 F0                MOVX     @DPTR,A
B1:00EA97 A3                INC      DPTR
B1:00EA98 74CF              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_send_key_verify_callback
B1:00EA9A F0                MOVX     @DPTR,A
B1:00EA9B 7A36              MOV      R2,#HIGH key_verify
B1:00EA9D 792F              MOV      R1,#LOW key_verify
B1:00EA9F 7D02              MOV      R5,#02H
B1:00EAA1 1293D5            LCALL    _ZW_SendDataEx
B1:00EAA4 EF                MOV      A,R7
B1:00EAA5 7006              JNZ      ?C0071?ZW_SECURE_LEARN_SUPPORT
B1:00EAA7 12B20D            LCALL    ?L?COM006D
B1:00EAAA 121D18            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00EAAD         ?C0071?ZW_SECURE_LEARN_SUPPORT:
B1:00EAAD 22                RET      
----- FUNCTION _secure_learnIfaceL_send_key_verify (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 436


----- FUNCTION ?L?COM0401 (BEGIN) -----
B1:00EAAE 90403B            MOV      DPTR,#dataLengthOld
B1:00EAB1 E0                MOVX     A,@DPTR
B1:00EAB2 FC                MOV      R4,A
B1:00EAB3 A3                INC      DPTR
B1:00EAB4 E0                MOVX     A,@DPTR
B1:00EAB5 FD                MOV      R5,A
B1:00EAB6 29                ADD      A,R1
B1:00EAB7 FF                MOV      R7,A
B1:00EAB8 EC                MOV      A,R4
B1:00EAB9 22                RET      
----- FUNCTION ?L?COM0401 (END) -------


----- FUNCTION ?L?COM0150 (BEGIN) -----
B1:00EABA 7B01              MOV      R3,#01H
B1:00EABC 900A30            MOV      DPTR,#?_ZW_SendDataEx?BYTE+04H
B1:00EABF 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0150 (END) -------


----- FUNCTION _ZW_EnableRoutedRssiFeedback (BEGIN) -----
;---- Variable 'bEnabled' assigned to Register 'R7' ----
B1:00EAC2 900673            MOV      DPTR,#bRoutedRssiFeedbackEnabled
B1:00EAC5 EF                MOV      A,R7
B1:00EAC6 F0                MOVX     @DPTR,A
B1:00EAC7 22                RET      
----- FUNCTION _ZW_EnableRoutedRssiFeedback (END) -------


----- FUNCTION ZW_SetDefault (BEGIN) -----
B1:00EAC8 7F01              MOV      R7,#01H
B1:00EACA 12F08B            LCALL    _SlaveInit
B1:00EACD E4                CLR      A
B1:00EACE FF                MOV      R7,A
B1:00EACF FE                MOV      R6,A
B1:00EAD0 FD                MOV      R5,A
B1:00EAD1 FC                MOV      R4,A
B1:00EAD2 901223            MOV      DPTR,#homeID
B1:00EAD5 1224BA            LCALL    ?C?LSTXDATA
B1:00EAD8 124FD6            LCALL    ?L?COM02D2
B1:00EADB E4                CLR      A
B1:00EADC FD                MOV      R5,A
B1:00EADD 121B88            LCALL    ?INTERBANK_TABLE?_MemoryPutID
B1:00EAE0 F1E3              ACALL    ResetRoutedResponseRoutes
B1:00EAE2 7E00              MOV      R6,#HIGH NVM_HOMEID_far
B1:00EAE4 7F04              MOV      R7,#LOW NVM_HOMEID_far
B1:00EAE6 C006              PUSH     AR6
B1:00EAE8 C3                CLR      C
B1:00EAE9 7411              MOV      A,#LOW _FD_ZW_NVM_L_
B1:00EAEB 9404              SUBB     A,#LOW NVM_HOMEID_far
B1:00EAED FE                MOV      R6,A
B1:00EAEE 7412              MOV      A,#HIGH _FD_ZW_NVM_L_
B1:00EAF0 9400              SUBB     A,#HIGH NVM_HOMEID_far
B1:00EAF2 B199              ACALL    ?L?COM0272
B1:00EAF4 12A79C            LCALL    ?L?COM00A4
B1:00EAF7 D006              POP      AR6
B1:00EAF9 123FF4            LCALL    ?L?COM057E
B1:00EAFC E4                CLR      A
B1:00EAFD FF                MOV      R7,A
B1:00EAFE FE                MOV      R6,A
B1:00EAFF 12AB2D            LCALL    _CinitNVMvariables
B1:00EB02 B1A1              ACALL    SlaveInitDone
B1:00EB04 12F6C4            LCALL    TxQueueInit
B1:00EB07 7126              ACALL    security_reset
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 437


B1:00EB09 126E1D            LCALL    ?L?COM01CC
B1:00EB0C 7A12              MOV      R2,#HIGH homeID
B1:00EB0E 7923              MOV      R1,#LOW homeID
B1:00EB10 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetID
B1:00EB13 7F01              MOV      R7,#01H
B1:00EB15 51C2              ACALL    _ZW_EnableRoutedRssiFeedback
B1:00EB17 021C23            LJMP     ?INTERBANK_TABLE?NoiseDetectSetDefault
----- FUNCTION ZW_SetDefault (END) -------


----- FUNCTION ?L?COM0403 (BEGIN) -----
B1:00EB1A 90403C            MOV      DPTR,#dataLengthOld+01H
B1:00EB1D E0                MOVX     A,@DPTR
B1:00EB1E 29                ADD      A,R1
B1:00EB1F FF                MOV      R7,A
B1:00EB20 90403B            MOV      DPTR,#dataLengthOld
B1:00EB23 E0                MOVX     A,@DPTR
B1:00EB24 3A                ADDC     A,R2
B1:00EB25 22                RET      
----- FUNCTION ?L?COM0403 (END) -------


----- FUNCTION security_reset (BEGIN) -----
B1:00EB26 7FFF              MOV      R7,#0FFH
B1:00EB28 12AA71            LCALL    _keystore_network_key_clear
B1:00EB2B 7E12              MOV      R6,#HIGH span_mpan_table_valid
B1:00EB2D 7F94              MOV      R7,#LOW span_mpan_table_valid
B1:00EB2F E4                CLR      A
B1:00EB30 FD                MOV      R5,A
B1:00EB31 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B1:;----                  JMP      security_init
----- FUNCTION security_reset (END) -------


----- FUNCTION security_init (BEGIN) -----
B1:00EB34 12B20D            LCALL    ?L?COM006D
B1:00EB37 121CEB            LCALL    ?INTERBANK_TABLE?_secure_learn_init
B1:00EB3A 12B20D            LCALL    ?L?COM006D
B1:00EB3D 121CF0            LCALL    ?INTERBANK_TABLE?_secure_learn_enter
B1:00EB40 121C8C            LCALL    ?INTERBANK_TABLE?sec0_init
B1:00EB43 12B20D            LCALL    ?L?COM006D
B1:00EB46 E4                CLR      A
B1:00EB47 5004              JNC      ?C0006?ZW_SECURE_LEARN_SUPPORT
B1:00EB49 7F01              MOV      R7,#01H
B1:00EB4B 8001              SJMP     ?C0087?ZW_SECURE_LEARN_SUPPORT
B1:00EB4D         ?C0006?ZW_SECURE_LEARN_SUPPORT:
B1:00EB4D FF                MOV      R7,A
B1:00EB4E         
B1:00EB4E FE                MOV      R6,A
B1:00EB4F FD                MOV      R5,A
B1:00EB50 FC                MOV      R4,A
B1:00EB51 121D4A            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_net_scheme
B1:00EB54         ?C0007?ZW_SECURE_LEARN_SUPPORT:
B1:00EB54 121CA0            LCALL    ?INTERBANK_TABLE?sec2_init
B1:00EB57 12B20D            LCALL    ?L?COM006D
B1:00EB5A E4                CLR      A
B1:00EB5B FD                MOV      R5,A
B1:00EB5C 121D31            LCALL    ?INTERBANK_TABLE?_secure_learnIface_set_isController
B1:00EB5F 121E6C            LCALL    ?INTERBANK_TABLE?ApplicationSecureKeysRequested
B1:00EB62 AB07              MOV      R3,AR7
B1:00EB64 7D01              MOV      R5,#01H
B1:00EB66 7F02              MOV      R7,#02H
B1:00EB68 021D95            LJMP     ?INTERBANK_TABLE?_s2_inclusion_init
----- FUNCTION security_init (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 438



----- FUNCTION _ladderstep (BEGIN) -----
B1:00EB6B 903222            MOV      DPTR,#work
B1:00EB6E EB                MOV      A,R3
B1:00EB6F 12E691            LCALL    ?L?COM0148
B1:00EB72 903222            MOV      DPTR,#work
B1:00EB75 12FC49            LCALL    ?L?COM0545
B1:00EB78 903305            MOV      DPTR,#x0
B1:00EB7B 12E690            LCALL    ?L?COM0147
B1:00EB7E 903222            MOV      DPTR,#work
B1:00EB81 E0                MOVX     A,@DPTR
B1:00EB82 FB                MOV      R3,A
B1:00EB83 A3                INC      DPTR
B1:00EB84 A3                INC      DPTR
B1:00EB85 E0                MOVX     A,@DPTR
B1:00EB86 126F43            LCALL    ?L?COM03B6
B1:00EB89 903308            MOV      DPTR,#xp
B1:00EB8C EB                MOV      A,R3
B1:00EB8D 12E691            LCALL    ?L?COM0148
B1:00EB90 91D1              ACALL    ?L?COM038F
B1:00EB92 2440              ADD      A,#040H
B1:00EB94 F9                MOV      R1,A
B1:00EB95 E4                CLR      A
B1:00EB96 3A                ADDC     A,R2
B1:00EB97 FA                MOV      R2,A
B1:00EB98 90330B            MOV      DPTR,#zp
B1:00EB9B EB                MOV      A,R3
B1:00EB9C 12E691            LCALL    ?L?COM0148
B1:00EB9F 91D1              ACALL    ?L?COM038F
B1:00EBA1 2460              ADD      A,#060H
B1:00EBA3 F9                MOV      R1,A
B1:00EBA4 E4                CLR      A
B1:00EBA5 3A                ADDC     A,R2
B1:00EBA6 FA                MOV      R2,A
B1:00EBA7 90330E            MOV      DPTR,#xq
B1:00EBAA EB                MOV      A,R3
B1:00EBAB 12E691            LCALL    ?L?COM0148
B1:00EBAE 91D1              ACALL    ?L?COM038F
B1:00EBB0 2480              ADD      A,#080H
B1:00EBB2 F9                MOV      R1,A
B1:00EBB3 E4                CLR      A
B1:00EBB4 3A                ADDC     A,R2
B1:00EBB5 FA                MOV      R2,A
B1:00EBB6 903311            MOV      DPTR,#zq
B1:00EBB9 EB                MOV      A,R3
B1:00EBBA 12E691            LCALL    ?L?COM0148
B1:00EBBD 7E32              MOV      R6,#HIGH t1
B1:00EBBF 7F25              MOV      R7,#LOW t1
B1:00EBC1 903308            MOV      DPTR,#xp
B1:00EBC4 91BC              ACALL    ?L?COM0128
B1:00EBC6 A3                INC      DPTR
B1:00EBC7 124E64            LCALL    ?L?COM01AD
B1:00EBCA 121DCC            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00EBCD 7E32              MOV      R6,#HIGH t2
B1:00EBCF 7F45              MOV      R7,#LOW t2
B1:00EBD1 903308            MOV      DPTR,#xp
B1:00EBD4 91BC              ACALL    ?L?COM0128
B1:00EBD6 A3                INC      DPTR
B1:00EBD7 124E64            LCALL    ?L?COM01AD
B1:00EBDA 121DD1            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00EBDD 7E32              MOV      R6,#HIGH t7
B1:00EBDF 7FE5              MOV      R7,#LOW t7
B1:00EBE1 7C32              MOV      R4,#HIGH t2
B1:00EBE3 7D45              MOV      R5,#LOW t2
B1:00EBE5 121DDB            LCALL    ?INTERBANK_TABLE?_fe25519_square
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 439


B1:00EBE8 7E32              MOV      R6,#HIGH t6
B1:00EBEA 7FC5              MOV      R7,#LOW t6
B1:00EBEC 7C32              MOV      R4,#HIGH t1
B1:00EBEE 7D25              MOV      R5,#LOW t1
B1:00EBF0 121DDB            LCALL    ?INTERBANK_TABLE?_fe25519_square
B1:00EBF3 7E32              MOV      R6,#HIGH t5
B1:00EBF5 7FA5              MOV      R7,#LOW t5
B1:00EBF7 7C32              MOV      R4,#HIGH t6
B1:00EBF9 7DC5              MOV      R5,#LOW t6
B1:00EBFB 7A32              MOV      R2,#HIGH t7
B1:00EBFD 7BE5              MOV      R3,#LOW t7
B1:00EBFF 121DD1            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00EC02 7E32              MOV      R6,#HIGH t3
B1:00EC04 7F65              MOV      R7,#LOW t3
B1:00EC06 90330E            MOV      DPTR,#xq
B1:00EC09 91BC              ACALL    ?L?COM0128
B1:00EC0B A3                INC      DPTR
B1:00EC0C 124E64            LCALL    ?L?COM01AD
B1:00EC0F 121DCC            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00EC12 7E32              MOV      R6,#HIGH t4
B1:00EC14 7F85              MOV      R7,#LOW t4
B1:00EC16 90330E            MOV      DPTR,#xq
B1:00EC19 91BC              ACALL    ?L?COM0128
B1:00EC1B A3                INC      DPTR
B1:00EC1C 124E64            LCALL    ?L?COM01AD
B1:00EC1F 121DD1            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00EC22 7A32              MOV      R2,#HIGH t2
B1:00EC24 7B45              MOV      R3,#LOW t2
B1:00EC26 AF03              MOV      R7,AR3
B1:00EC28 AE02              MOV      R6,AR2
B1:00EC2A 7C32              MOV      R4,#HIGH t3
B1:00EC2C 7D65              MOV      R5,#LOW t3
B1:00EC2E 121DD6            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00EC31 7E32              MOV      R6,#HIGH t3
B1:00EC33 7F65              MOV      R7,#LOW t3
B1:00EC35 7C32              MOV      R4,#HIGH t4
B1:00EC37 7D85              MOV      R5,#LOW t4
B1:00EC39 7A32              MOV      R2,#HIGH t1
B1:00EC3B 7B25              MOV      R3,#LOW t1
B1:00EC3D 121DD6            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00EC40 90330E            MOV      DPTR,#xq
B1:00EC43 91C8              ACALL    ?L?COM02B0
B1:00EC45 7C32              MOV      R4,#HIGH t3
B1:00EC47 7D65              MOV      R5,#LOW t3
B1:00EC49 7A32              MOV      R2,#HIGH t2
B1:00EC4B 7B45              MOV      R3,#LOW t2
B1:00EC4D 121DCC            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00EC50 903311            MOV      DPTR,#zq
B1:00EC53 91C8              ACALL    ?L?COM02B0
B1:00EC55 7C32              MOV      R4,#HIGH t3
B1:00EC57 7D65              MOV      R5,#LOW t3
B1:00EC59 7A32              MOV      R2,#HIGH t2
B1:00EC5B 7B45              MOV      R3,#LOW t2
B1:00EC5D 121DD1            LCALL    ?INTERBANK_TABLE?_fe25519_sub
B1:00EC60 90330E            MOV      DPTR,#xq
B1:00EC63 91BC              ACALL    ?L?COM0128
B1:00EC65 91B3              ACALL    ?L?COM0127
B1:00EC67 91B3              ACALL    ?L?COM0127
B1:00EC69 FF                MOV      R7,A
B1:00EC6A AE04              MOV      R6,AR4
B1:00EC6C 903305            MOV      DPTR,#x0
B1:00EC6F 124E64            LCALL    ?L?COM01AD
B1:00EC72 121DD6            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00EC75 903308            MOV      DPTR,#xp
B1:00EC78 91C8              ACALL    ?L?COM02B0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 440


B1:00EC7A 7C32              MOV      R4,#HIGH t6
B1:00EC7C 7DC5              MOV      R5,#LOW t6
B1:00EC7E 7A32              MOV      R2,#HIGH t7
B1:00EC80 7BE5              MOV      R3,#LOW t7
B1:00EC82 121DD6            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00EC85 90330B            MOV      DPTR,#zp
B1:00EC88 91C8              ACALL    ?L?COM02B0
B1:00EC8A 7C32              MOV      R4,#HIGH t5
B1:00EC8C 7DA5              MOV      R5,#LOW t5
B1:00EC8E 7A3C              MOV      R2,#HIGH _121666
B1:00EC90 7B41              MOV      R3,#LOW _121666
B1:00EC92 121DD6            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00EC95 90330B            MOV      DPTR,#zp
B1:00EC98 91BC              ACALL    ?L?COM0128
B1:00EC9A FF                MOV      R7,A
B1:00EC9B AE04              MOV      R6,AR4
B1:00EC9D 7A32              MOV      R2,#HIGH t7
B1:00EC9F 7BE5              MOV      R3,#LOW t7
B1:00ECA1 121DCC            LCALL    ?INTERBANK_TABLE?_fe25519_add
B1:00ECA4 90330B            MOV      DPTR,#zp
B1:00ECA7 91BC              ACALL    ?L?COM0128
B1:00ECA9 FF                MOV      R7,A
B1:00ECAA AE04              MOV      R6,AR4
B1:00ECAC 7A32              MOV      R2,#HIGH t5
B1:00ECAE 7BA5              MOV      R3,#LOW t5
B1:00ECB0 021DD6            LJMP     ?INTERBANK_TABLE?_fe25519_mul
----- FUNCTION _ladderstep (END) -------


----- FUNCTION ?L?COM0127 (BEGIN) -----
B1:00ECB3 FF                MOV      R7,A
B1:00ECB4 AE04              MOV      R6,AR4
B1:00ECB6 121DDB            LCALL    ?INTERBANK_TABLE?_fe25519_square
B1:00ECB9 903311            MOV      DPTR,#zq
B1:00ECBC         ?L?COM0128:
B1:00ECBC A3                INC      DPTR
B1:00ECBD E0                MOVX     A,@DPTR
B1:00ECBE FA                MOV      R2,A
B1:00ECBF A3                INC      DPTR
B1:00ECC0 E0                MOVX     A,@DPTR
B1:00ECC1 AC02              MOV      R4,AR2
B1:00ECC3 FD                MOV      R5,A
B1:00ECC4 22                RET      
----- FUNCTION ?L?COM0127 (END) -------


----- FUNCTION ZW_GetMaxPayloadSize (BEGIN) -----
B1:00ECC5 7F2E              MOV      R7,#02EH
B1:00ECC7 22                RET      
----- FUNCTION ZW_GetMaxPayloadSize (END) -------


----- FUNCTION ?L?COM02B0 (BEGIN) -----
B1:00ECC8 A3                INC      DPTR
B1:00ECC9 E0                MOVX     A,@DPTR
B1:00ECCA FA                MOV      R2,A
B1:00ECCB A3                INC      DPTR
B1:00ECCC E0                MOVX     A,@DPTR
B1:00ECCD AE02              MOV      R6,AR2
B1:00ECCF FF                MOV      R7,A
B1:00ECD0 22                RET      
----- FUNCTION ?L?COM02B0 (END) -------


----- FUNCTION ?L?COM038F (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 441


B1:00ECD1 903222            MOV      DPTR,#work
B1:00ECD4 A3                INC      DPTR
B1:00ECD5 E0                MOVX     A,@DPTR
B1:00ECD6 FA                MOV      R2,A
B1:00ECD7 A3                INC      DPTR
B1:00ECD8 E0                MOVX     A,@DPTR
B1:00ECD9 22                RET      
----- FUNCTION ?L?COM038F (END) -------


----- FUNCTION ?L?COM021A (BEGIN) -----
B1:00ECDA 122572            LCALL    ?C?PSTXDATA
B1:00ECDD         ?L?COM021B:
B1:00ECDD 9009D9            MOV      DPTR,#pData
B1:00ECE0 E0                MOVX     A,@DPTR
B1:00ECE1 FE                MOV      R6,A
B1:00ECE2 A3                INC      DPTR
B1:00ECE3 E0                MOVX     A,@DPTR
B1:00ECE4 22                RET      
----- FUNCTION ?L?COM021A (END) -------


----- FUNCTION security_learn_exit (BEGIN) -----
B1:00ECE5 12B20D            LCALL    ?L?COM006D
B1:00ECE8 7D09              MOV      R5,#09H
B1:00ECEA 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00ECED EF                MOV      A,R7
B1:00ECEE 700C              JNZ      ?C0010?ZW_SECURE_LEARN_SUPPORT
B1:00ECF0 12B20D            LCALL    ?L?COM006D
B1:00ECF3 121CEB            LCALL    ?INTERBANK_TABLE?_secure_learn_init
B1:00ECF6 12B20D            LCALL    ?L?COM006D
B1:00ECF9 121CF0            LCALL    ?INTERBANK_TABLE?_secure_learn_enter
B1:00ECFC         ?C0010?ZW_SECURE_LEARN_SUPPORT:
B1:00ECFC 22                RET      
----- FUNCTION security_learn_exit (END) -------


----- FUNCTION _crypto_scalarmult_curve25519 (BEGIN) -----
B1:00ECFD 9039B3            MOV      DPTR,#r
B1:00ED00 EB                MOV      A,R3
B1:00ED01 12E691            LCALL    ?L?COM0148
;---- Variable 'i' assigned to Register 'R7' ----
B1:00ED04 E4                CLR      A
B1:00ED05 FF                MOV      R7,A
B1:00ED06         ?C0009?CURVE25519:
B1:00ED06 9039B6            MOV      DPTR,#s
B1:00ED09 12E680            LCALL    ?L?COM0156
B1:00ED0C F9                MOV      R1,A
B1:00ED0D 12DD3D            LCALL    ?L?COM015D
B1:00ED10 FE                MOV      R6,A
B1:00ED11 74FC              MOV      A,#LOW e
B1:00ED13 2F                ADD      A,R7
B1:00ED14 F582              MOV      DPL,A
B1:00ED16 E4                CLR      A
B1:00ED17 3439              ADDC     A,#HIGH e
B1:00ED19 F583              MOV      DPH,A
B1:00ED1B EE                MOV      A,R6
B1:00ED1C F0                MOVX     @DPTR,A
B1:00ED1D 0F                INC      R7
B1:00ED1E EF                MOV      A,R7
B1:00ED1F B420E4            CJNE     A,#020H,?C0009?CURVE25519
B1:00ED22         ?C0010?CURVE25519:
B1:00ED22 9039FC            MOV      DPTR,#e
B1:00ED25 E0                MOVX     A,@DPTR
B1:00ED26 54F8              ANL      A,#0F8H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 442


B1:00ED28 F0                MOVX     @DPTR,A
B1:00ED29 903A1B            MOV      DPTR,#e+01FH
B1:00ED2C E0                MOVX     A,@DPTR
B1:00ED2D 547F              ANL      A,#07FH
B1:00ED2F F0                MOVX     @DPTR,A
B1:00ED30 4440              ORL      A,#040H
B1:00ED32 F0                MOVX     @DPTR,A
B1:00ED33 7E39              MOV      R6,#HIGH t
B1:00ED35 7FBC              MOV      R7,#LOW t
B1:00ED37 9039B9            MOV      DPTR,#p
B1:00ED3A 91BC              ACALL    ?L?COM0128
B1:00ED3C 121DEF            LCALL    ?INTERBANK_TABLE?_fe25519_unpack
B1:00ED3F 9034BE            MOV      DPTR,#?_mladder?BYTE+03H
B1:00ED42 7401              MOV      A,#01H
B1:00ED44 F0                MOVX     @DPTR,A
B1:00ED45 A3                INC      DPTR
B1:00ED46 7439              MOV      A,#HIGH z
B1:00ED48 F0                MOVX     @DPTR,A
B1:00ED49 A3                INC      DPTR
B1:00ED4A 74DC              MOV      A,#LOW z
B1:00ED4C F0                MOVX     @DPTR,A
B1:00ED4D A3                INC      DPTR
B1:00ED4E 7401              MOV      A,#01H
B1:00ED50 F0                MOVX     @DPTR,A
B1:00ED51 A3                INC      DPTR
B1:00ED52 7439              MOV      A,#HIGH e
B1:00ED54 F0                MOVX     @DPTR,A
B1:00ED55 A3                INC      DPTR
B1:00ED56 74FC              MOV      A,#LOW e
B1:00ED58 F0                MOVX     @DPTR,A
B1:00ED59 7B01              MOV      R3,#01H
B1:00ED5B 7A39              MOV      R2,#HIGH t
B1:00ED5D 79BC              MOV      R1,#LOW t
B1:00ED5F 12E5BF            LCALL    _mladder
B1:00ED62 7C39              MOV      R4,#HIGH z
B1:00ED64 7DDC              MOV      R5,#LOW z
B1:00ED66 AF05              MOV      R7,AR5
B1:00ED68 AE04              MOV      R6,AR4
B1:00ED6A 121DF9            LCALL    ?INTERBANK_TABLE?_fe25519_invert
B1:00ED6D 7C39              MOV      R4,#HIGH t
B1:00ED6F 7DBC              MOV      R5,#LOW t
B1:00ED71 AF05              MOV      R7,AR5
B1:00ED73 AE04              MOV      R6,AR4
B1:00ED75 7A39              MOV      R2,#HIGH z
B1:00ED77 7BDC              MOV      R3,#LOW z
B1:00ED79 121DD6            LCALL    ?INTERBANK_TABLE?_fe25519_mul
B1:00ED7C 9039B3            MOV      DPTR,#r
B1:00ED7F 91C8              ACALL    ?L?COM02B0
B1:00ED81 7C39              MOV      R4,#HIGH t
B1:00ED83 7DBC              MOV      R5,#LOW t
B1:00ED85 021DF4            LJMP     ?INTERBANK_TABLE?_fe25519_pack
----- FUNCTION _crypto_scalarmult_curve25519 (END) -------


----- FUNCTION ?L?COM04C9 (BEGIN) -----
B1:00ED88 7B01              MOV      R3,#01H
B1:00ED8A 7A07              MOV      R2,#HIGH rxFrame
B1:00ED8C 796C              MOV      R1,#LOW rxFrame
B1:00ED8E 22                RET      
----- FUNCTION ?L?COM04C9 (END) -------


----- FUNCTION ?L?COM0271 (BEGIN) -----
B1:00ED8F A3                INC      DPTR
B1:00ED90 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 443


B1:00ED91 F8                MOV      R0,A
B1:00ED92 A3                INC      DPTR
B1:00ED93 E0                MOVX     A,@DPTR
B1:00ED94 C3                CLR      C
B1:00ED95 9D                SUBB     A,R5
B1:00ED96 FE                MOV      R6,A
B1:00ED97 E8                MOV      A,R0
B1:00ED98 9C                SUBB     A,R4
B1:00ED99         ?L?COM0272:
B1:00ED99 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B1:00ED9C F0                MOVX     @DPTR,A
B1:00ED9D A3                INC      DPTR
B1:00ED9E CE                XCH      A,R6
B1:00ED9F F0                MOVX     @DPTR,A
B1:00EDA0 22                RET      
----- FUNCTION ?L?COM0271 (END) -------


----- FUNCTION SlaveInitDone (BEGIN) -----
B1:00EDA1 D200              SETB     slaveInitialized
B1:00EDA3 126E1D            LCALL    ?L?COM01CC
B1:00EDA6 7A12              MOV      R2,#HIGH homeID
B1:00EDA8 7923              MOV      R1,#LOW homeID
B1:00EDAA 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetID
B1:00EDAD F146              ACALL    ResetSUC
B1:00EDAF 128F78            LCALL    ?L?COM03EF
B1:00EDB2 9033A5            MOV      DPTR,#sucNodeID
B1:00EDB5 EF                MOV      A,R7
B1:00EDB6 F0                MOVX     @DPTR,A
B1:00EDB7 02C513            LJMP     ReloadRouteDestinations
----- FUNCTION SlaveInitDone (END) -------


----- FUNCTION _ZCB_AssignComplete (BEGIN) -----
B1:00EDBA D1E5              ACALL    ?L?COM0584
B1:00EDBC FF                MOV      R7,A
B1:00EDBD 6404              XRL      A,#04H
B1:00EDBF 606A              JZ       ?C0308?ZW_SLAVE
B1:00EDC1 EF                MOV      A,R7
B1:00EDC2 B40302            CJNE     A,#03H,?C0063?ZW_SLAVE
B1:00EDC5         ?C0064?ZW_SLAVE:
B1:00EDC5 8064              SJMP     ?C0308?ZW_SLAVE
B1:00EDC7         ?C0063?ZW_SLAVE:
B1:00EDC7 903315            MOV      DPTR,#assignState
B1:00EDCA E0                MOVX     A,@DPTR
B1:00EDCB B4010E            CJNE     A,#01H,?C0066?ZW_SLAVE
B1:00EDCE C201              CLR      learnMode
B1:00EDD0 C203              CLR      learnModeDsk
B1:00EDD2 901221            MOV      DPTR,#nodeID
B1:00EDD5 E0                MOVX     A,@DPTR
B1:00EDD6 7004              JNZ      ?C0066?ZW_SLAVE
B1:00EDD8 903315            MOV      DPTR,#assignState
B1:00EDDB F0                MOVX     @DPTR,A
B1:00EDDC         ?C0066?ZW_SLAVE:
B1:00EDDC 903315            MOV      DPTR,#assignState
B1:00EDDF E0                MOVX     A,@DPTR
B1:00EDE0 7022              JNZ      ?C0068?ZW_SLAVE
B1:00EDE2 FF                MOV      R7,A
B1:00EDE3 F1F5              ACALL    _ZW_LockRoute
B1:00EDE5 C201              CLR      learnMode
B1:00EDE7 C203              CLR      learnModeDsk
B1:00EDE9 E4                CLR      A
B1:00EDEA 90336C            MOV      DPTR,#zensorWakeupTime
B1:00EDED F0                MOVX     @DPTR,A
B1:00EDEE 200411            JB       learnModeClassic,?C0069?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 444


B1:00EDF1 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00EDF4 E0                MOVX     A,@DPTR
B1:00EDF5 5430              ANL      A,#030H
B1:00EDF7 7004              JNZ      ?C0070?ZW_SLAVE
B1:00EDF9 7F01              MOV      R7,#01H
B1:00EDFB 8002              SJMP     ?C0309?ZW_SLAVE
B1:00EDFD         ?C0070?ZW_SLAVE:
B1:00EDFD E4                CLR      A
B1:00EDFE FF                MOV      R7,A
B1:00EDFF         
B1:00EDFF 121BEC            LCALL    ?INTERBANK_TABLE?_ExploreSetNWI
B1:00EE02         ?C0069?ZW_SLAVE:
B1:00EE02 C204              CLR      learnModeClassic
B1:00EE04         ?C0068?ZW_SLAVE:
B1:00EE04 90338E            MOV      DPTR,#_learnNodeFunc
B1:00EE07 12F294            LCALL    ?L?COM03F1
B1:00EE0A 6015              JZ       ?C0072?ZW_SLAVE
B1:00EE0C 903315            MOV      DPTR,#assignState
B1:00EE0F 12B053            LCALL    ?L?COM0177
B1:00EE12 12F2CD            LCALL    ?L?COM0534
B1:00EE15 903315            MOV      DPTR,#assignState
B1:00EE18 E0                MOVX     A,@DPTR
B1:00EE19 7006              JNZ      ?C0072?ZW_SLAVE
B1:00EE1B 90338E            MOV      DPTR,#_learnNodeFunc
B1:00EE1E F0                MOVX     @DPTR,A
B1:00EE1F A3                INC      DPTR
B1:00EE20 F0                MOVX     @DPTR,A
B1:00EE21         ?C0072?ZW_SLAVE:
B1:00EE21 903315            MOV      DPTR,#assignState
B1:00EE24 E0                MOVX     A,@DPTR
B1:00EE25 B40107            CJNE     A,#01H,?C0075?ZW_SLAVE
B1:00EE28 7403              MOV      A,#03H
B1:00EE2A F0                MOVX     @DPTR,A
B1:00EE2B         
B1:00EE2B 7F04              MOV      R7,#04H
B1:00EE2D F11F              ACALL    _AssignTimerStart
B1:00EE2F         ?C0075?ZW_SLAVE:
B1:00EE2F 22                RET      
----- FUNCTION _ZCB_AssignComplete (END) -------


----- FUNCTION _InternSetLearnMode (BEGIN) -----
B1:00EE30 9046A4            MOV      DPTR,#mode
B1:00EE33 EF                MOV      A,R7
B1:00EE34 F0                MOVX     @DPTR,A
;---- Variable 'learnFunc' assigned to Register 'R4/R5' ----
B1:00EE35 903315            MOV      DPTR,#assignState
B1:00EE38 E0                MOVX     A,@DPTR
B1:00EE39 6002              JZ       $ + 4H
B1:00EE3B C1BC              AJMP     ?C0085?ZW_SLAVE
B1:00EE3D 9046A4            MOV      DPTR,#mode
B1:00EE40 E0                MOVX     A,@DPTR
B1:00EE41 FF                MOV      R7,A
B1:00EE42 C3                CLR      C
B1:00EE43 6001              JZ       ?C0086?ZW_SLAVE
B1:00EE45 D3                SETB     C
B1:00EE46         ?C0086?ZW_SLAVE:
B1:00EE46         ?C0087?ZW_SLAVE:
B1:00EE46 9201              MOV      learnMode,C
B1:00EE48 EF                MOV      A,R7
B1:00EE49 B40103            CJNE     A,#01H,?C0088?ZW_SLAVE
B1:00EE4C D3                SETB     C
B1:00EE4D 8001              SJMP     ?C0089?ZW_SLAVE
B1:00EE4F         ?C0088?ZW_SLAVE:
B1:00EE4F C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 445


B1:00EE50         ?C0089?ZW_SLAVE:
B1:00EE50 9204              MOV      learnModeClassic,C
B1:00EE52 9046A4            MOV      DPTR,#mode
B1:00EE55 E0                MOVX     A,@DPTR
B1:00EE56 B40403            CJNE     A,#04H,?C0090?ZW_SLAVE
B1:00EE59 D3                SETB     C
B1:00EE5A 8001              SJMP     ?C0091?ZW_SLAVE
B1:00EE5C         ?C0090?ZW_SLAVE:
B1:00EE5C C3                CLR      C
B1:00EE5D         ?C0091?ZW_SLAVE:
B1:00EE5D 9203              MOV      learnModeDsk,C
B1:00EE5F E4                CLR      A
B1:00EE60 F550              MOV      bNetworkWideInclusion,A
B1:00EE62 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B1:00EE65 12D76F            LCALL    ?L?COM046A
B1:00EE68 F0                MOVX     @DPTR,A
B1:00EE69 90338E            MOV      DPTR,#_learnNodeFunc
B1:00EE6C 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_SecureLearnProtocolCallback
B1:00EE6E F0                MOVX     @DPTR,A
B1:00EE6F A3                INC      DPTR
B1:00EE70 74F8              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_SecureLearnProtocolCallback
B1:00EE72 F0                MOVX     @DPTR,A
B1:00EE73 300141            JNB      learnMode,zw_setlearnmode_abort?ZW_SLAVE
B1:00EE76 12C674            LCALL    keystore_keypair_check_and_generate
B1:00EE79 200435            JB       learnModeClassic,?C0093?ZW_SLAVE
B1:00EE7C 9046A4            MOV      DPTR,#mode
B1:00EE7F E0                MOVX     A,@DPTR
B1:00EE80 24FE              ADD      A,#0FEH
B1:00EE82 601B              JZ       ?C0096?ZW_SLAVE
B1:00EE84 14                DEC      A
B1:00EE85 601E              JZ       ?C0097?ZW_SLAVE
B1:00EE87 14                DEC      A
B1:00EE88 7021              JNZ      ?C0098?ZW_SLAVE
B1:00EE8A         ?C0095?ZW_SLAVE:
B1:00EE8A 125F73            LCALL    NetworkManagementGenerateDskpart
B1:00EE8D 7B01              MOV      R3,#01H
B1:00EE8F 7A33              MOV      R2,#HIGH Dsk+0CH
B1:00EE91 7938              MOV      R1,#LOW Dsk+0CH
B1:00EE93 1287B9            LCALL    ?L?COM003F
B1:00EE96 7A12              MOV      R2,#HIGH homeID
B1:00EE98 7923              MOV      R1,#LOW homeID
B1:00EE9A 7F04              MOV      R7,#04H
B1:00EE9C 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
B1:00EE9F         ?C0096?ZW_SLAVE:
B1:00EE9F 755001            MOV      bNetworkWideInclusion,#01H
B1:00EEA2 C211              CLR      exploreInclusionModeRepeat
B1:00EEA4 22                RET      
B1:00EEA5         ?C0097?ZW_SLAVE:
B1:00EEA5 755002            MOV      bNetworkWideInclusion,#02H
B1:00EEA8 C211              CLR      exploreInclusionModeRepeat
B1:00EEAA 22                RET      
B1:00EEAB         ?C0098?ZW_SLAVE:
B1:00EEAB C203              CLR      learnModeDsk
B1:00EEAD C201              CLR      learnMode
B1:00EEAF 8006              SJMP     zw_setlearnmode_abort?ZW_SLAVE
B1:00EEB1         ?C0093?ZW_SLAVE:
B1:00EEB1 E4                CLR      A
B1:00EEB2 F550              MOV      bNetworkWideInclusion,A
B1:00EEB4 C211              CLR      exploreInclusionModeRepeat
B1:00EEB6 22                RET      
B1:00EEB7         zw_setlearnmode_abort:
B1:00EEB7 91E5              ACALL    security_learn_exit
B1:00EEB9 021CA5            LJMP     ?INTERBANK_TABLE?sec2_inclusion_abort
B1:00EEBC         ?C0085?ZW_SLAVE:
B1:00EEBC 12A79C            LCALL    ?L?COM00A4
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 446


B1:00EEBF E4                CLR      A
B1:00EEC0 FF                MOV      R7,A
B1:00EEC1 A1BA              AJMP     _ZCB_AssignComplete
----- FUNCTION _InternSetLearnMode (END) -------


----- FUNCTION runCycle (BEGIN) -----
B1:00EEC3 903631            MOV      DPTR,#ctx
B1:00EEC6 E0                MOVX     A,@DPTR
B1:00EEC7 9046A6            MOV      DPTR,#oldState
B1:00EECA F0                MOVX     @DPTR,A
B1:00EECB 12B20D            LCALL    ?L?COM006D
B1:00EECE 021CF5            LJMP     ?INTERBANK_TABLE?_secure_learn_runCycle
----- FUNCTION runCycle (END) -------


----- FUNCTION _ZCB_send_data_callback (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B1:00EED1 EF                MOV      A,R7
B1:00EED2 12B20D            LCALL    ?L?COM006D
B1:00EED5 7005              JNZ      ?C0012?ZW_SECURE_LEARN_SUPPORT
B1:00EED7 121D13            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_done
B1:00EEDA 8003              SJMP     ?C0013?ZW_SECURE_LEARN_SUPPORT
B1:00EEDC         ?C0012?ZW_SECURE_LEARN_SUPPORT:
B1:00EEDC 121D18            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
B1:00EEDF         ?C0013?ZW_SECURE_LEARN_SUPPORT:
B1:00EEDF D1C3              ACALL    runCycle
B1:00EEE1 D1C3              ACALL    runCycle
B1:00EEE3 80DE              SJMP     runCycle
----- FUNCTION _ZCB_send_data_callback (END) -------


----- FUNCTION ?L?COM0584 (BEGIN) -----
B1:00EEE5 F10D              ACALL    AssignTimerStop
B1:00EEE7 903315            MOV      DPTR,#assignState
B1:00EEEA E0                MOVX     A,@DPTR
B1:00EEEB 22                RET      
----- FUNCTION ?L?COM0584 (END) -------


----- FUNCTION ZCB_AssignTimeout (BEGIN) -----
B1:00EEEC 903314            MOV      DPTR,#assignTimeoutCount
B1:00EEEF E0                MOVX     A,@DPTR
B1:00EEF0 FF                MOV      R7,A
B1:00EEF1 14                DEC      A
B1:00EEF2 F0                MOVX     @DPTR,A
B1:00EEF3 EF                MOV      A,R7
B1:00EEF4 7016              JNZ      ?C0059?ZW_SLAVE
B1:00EEF6 D1E5              ACALL    ?L?COM0584
B1:00EEF8 B40302            CJNE     A,#03H,?C0056?ZW_SLAVE
B1:00EEFB 8007              SJMP     ?C0307?ZW_SLAVE
B1:00EEFD         ?C0056?ZW_SLAVE:
B1:00EEFD 903315            MOV      DPTR,#assignState
B1:00EF00 E0                MOVX     A,@DPTR
B1:00EF01 B40408            CJNE     A,#04H,?C0059?ZW_SLAVE
B1:00EF04         
B1:00EF04 E4                CLR      A
B1:00EF05 F0                MOVX     @DPTR,A
B1:00EF06 FB                MOV      R3,A
B1:00EF07 FA                MOV      R2,A
B1:00EF08 F9                MOV      R1,A
B1:00EF09 FF                MOV      R7,A
B1:00EF0A B1BA              ACALL    _ZCB_AssignComplete
B1:00EF0C         ?C0059?ZW_SLAVE:
B1:00EF0C 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 447


----- FUNCTION ZCB_AssignTimeout (END) -------


----- FUNCTION AssignTimerStop (BEGIN) -----
B1:00EF0D 9033A3            MOV      DPTR,#assignTimerHandle
B1:00EF10 E0                MOVX     A,@DPTR
B1:00EF11 FF                MOV      R7,A
B1:00EF12 F4                CPL      A
B1:00EF13 6003              JZ       ?C0053?ZW_SLAVE
B1:00EF15 1244EE            LCALL    _TimerCancel
B1:00EF18         ?C0053?ZW_SLAVE:
B1:00EF18 9033A3            MOV      DPTR,#assignTimerHandle
B1:00EF1B 74FF              MOV      A,#0FFH
B1:00EF1D F0                MOVX     @DPTR,A
B1:00EF1E 22                RET      
----- FUNCTION AssignTimerStop (END) -------


----- FUNCTION _AssignTimerStart (BEGIN) -----
B1:00EF1F 9046A3            MOV      DPTR,#count
B1:00EF22 EF                MOV      A,R7
B1:00EF23 F0                MOVX     @DPTR,A
B1:00EF24 F10D              ACALL    AssignTimerStop
B1:00EF26 9046A3            MOV      DPTR,#count
B1:00EF29 E0                MOVX     A,@DPTR
B1:00EF2A 6004              JZ       ?C0060?ZW_SLAVE
B1:00EF2C 903314            MOV      DPTR,#assignTimeoutCount
B1:00EF2F F0                MOVX     @DPTR,A
B1:00EF30         ?C0060?ZW_SLAVE:
B1:00EF30 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_AssignTimeout
B1:00EF32 7FEE              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_AssignTimeout
B1:00EF34 7BFF              MOV      R3,#0FFH
B1:00EF36 7D2F              MOV      R5,#02FH
B1:00EF38 1257A8            LCALL    _TimerSysStart
B1:00EF3B 9033A3            MOV      DPTR,#assignTimerHandle
B1:00EF3E EF                MOV      A,R7
B1:00EF3F F0                MOVX     @DPTR,A
B1:00EF40 BFFF02            CJNE     R7,#0FFH,?C0062?ZW_SLAVE
B1:00EF43 D1EC              ACALL    ZCB_AssignTimeout
B1:00EF45         ?C0062?ZW_SLAVE:
B1:00EF45 22                RET      
----- FUNCTION _AssignTimerStart (END) -------


----- FUNCTION ResetSUC (BEGIN) -----
B1:00EF46 12F366            LCALL    ?L?COM04C6
B1:00EF49 903397            MOV      DPTR,#SUC_Update
B1:00EF4C 7401              MOV      A,#01H
B1:00EF4E F0                MOVX     @DPTR,A
B1:00EF4F E4                CLR      A
B1:00EF50 903399            MOV      DPTR,#SUC_Update+02H
B1:00EF53 F0                MOVX     @DPTR,A
B1:00EF54 22                RET      
----- FUNCTION ResetSUC (END) -------


----- FUNCTION _ZCB_send_key_verify_callback (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B1:00EF55 EF                MOV      A,R7
B1:00EF56 12B20D            LCALL    ?L?COM006D
B1:00EF59 7005              JNZ      ?C0067?ZW_SECURE_LEARN_SUPPORT
B1:00EF5B 121D13            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_done
B1:00EF5E 8003              SJMP     ?C0068?ZW_SECURE_LEARN_SUPPORT
B1:00EF60         ?C0067?ZW_SECURE_LEARN_SUPPORT:
B1:00EF60 121D18            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_tx_fail
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 448


B1:00EF63         ?C0068?ZW_SECURE_LEARN_SUPPORT:
B1:00EF63 D1C3              ACALL    runCycle
B1:00EF65 C1C3              AJMP     runCycle
----- FUNCTION _ZCB_send_key_verify_callback (END) -------


----- FUNCTION _security_learn_begin (BEGIN) -----
B1:00EF67 90467D            MOV      DPTR,#__cb
B1:00EF6A EE                MOV      A,R6
B1:00EF6B F0                MOVX     @DPTR,A
B1:00EF6C A3                INC      DPTR
B1:00EF6D EF                MOV      A,R7
B1:00EF6E F0                MOVX     @DPTR,A
B1:00EF6F 12B20D            LCALL    ?L?COM006D
B1:00EF72 7D08              MOV      R5,#08H
B1:00EF74 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00EF77 BF0113            CJNE     R7,#01H,?C0061?ZW_SECURE_LEARN_SUPPORT
B1:00EF7A E4                CLR      A
B1:00EF7B FF                MOV      R7,A
B1:00EF7C 12F29B            LCALL    _secure_learn_set_errno
B1:00EF7F 90467D            MOV      DPTR,#__cb
B1:00EF82 12F328            LCALL    ?L?COM0339
B1:00EF85 12B20D            LCALL    ?L?COM006D
B1:00EF88 121D04            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_learnRequest
B1:00EF8B D1C3              ACALL    runCycle
B1:00EF8D         ?C0061?ZW_SECURE_LEARN_SUPPORT:
B1:00EF8D 22                RET      
----- FUNCTION _security_learn_begin (END) -------


----- FUNCTION _ZW_SendDataMulti (BEGIN) -----
;---- Variable 'pNodeIDList' assigned to Register 'R1/R2/R3' ----
B1:00EF8E 901221            MOV      DPTR,#nodeID
B1:00EF91 E0                MOVX     A,@DPTR
B1:00EF92 FF                MOV      R7,A
B1:00EF93 C003              PUSH     AR3
B1:00EF95 C002              PUSH     AR2
B1:00EF97 C001              PUSH     AR1
B1:00EF99 90425B            MOV      DPTR,#pData
B1:00EF9C 122552            LCALL    ?C?PLDXDATA
B1:00EF9F 904200            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+04H
B1:00EFA2 122572            LCALL    ?C?PSTXDATA
B1:00EFA5 90425E            MOV      DPTR,#dataLength
B1:00EFA8 E0                MOVX     A,@DPTR
B1:00EFA9 904203            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+07H
B1:00EFAC F0                MOVX     @DPTR,A
B1:00EFAD 90425F            MOV      DPTR,#txOptions
B1:00EFB0 E0                MOVX     A,@DPTR
B1:00EFB1 904204            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+08H
B1:00EFB4 F0                MOVX     @DPTR,A
B1:00EFB5 904260            MOV      DPTR,#completedFunc
B1:00EFB8 E0                MOVX     A,@DPTR
B1:00EFB9 FD                MOV      R5,A
B1:00EFBA A3                INC      DPTR
B1:00EFBB E0                MOVX     A,@DPTR
B1:00EFBC 904205            MOV      DPTR,#?_ZW_SendDataMultiWorker?BYTE+09H
B1:00EFBF CD                XCH      A,R5
B1:00EFC0 F0                MOVX     @DPTR,A
B1:00EFC1 A3                INC      DPTR
B1:00EFC2 ED                MOV      A,R5
B1:00EFC3 F0                MOVX     @DPTR,A
B1:00EFC4 D001              POP      AR1
B1:00EFC6 D002              POP      AR2
B1:00EFC8 D003              POP      AR3
B1:00EFCA 02D633            LJMP     _ZW_SendDataMultiWorker
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 449


----- FUNCTION _ZW_SendDataMulti (END) -------


----- FUNCTION ZW_FollowUpReceived (BEGIN) -----
B1:00EFCD D22B              SETB     ?RF_EnableFLiRSBroadcast?BIT
B1:00EFCF 025E1E            LJMP     RF_EnableFLiRSBroadcast
----- FUNCTION ZW_FollowUpReceived (END) -------


----- FUNCTION ResponseRouteFull (BEGIN) -----
B1:00EFD2 901216            MOV      DPTR,#responseRouteCount
B1:00EFD5 E0                MOVX     A,@DPTR
B1:00EFD6 B40207            CJNE     A,#02H,?C0007?ZW_ROUTING_ALL
B1:00EFD9 301C04            JNB      routesLocked,?C0007?ZW_ROUTING_ALL
B1:00EFDC 7F01              MOV      R7,#01H
B1:00EFDE 8002              SJMP     ?C0008?ZW_ROUTING_ALL
B1:00EFE0         ?C0007?ZW_ROUTING_ALL:
B1:00EFE0 7F00              MOV      R7,#00H
B1:00EFE2         ?C0008?ZW_ROUTING_ALL:
B1:00EFE2 22                RET      
----- FUNCTION ResponseRouteFull (END) -------


----- FUNCTION ResetRoutedResponseRoutes (BEGIN) -----
;---- Variable 'rtmp' assigned to Register 'R7' ----
B1:00EFE3 7F02              MOV      R7,#02H
B1:00EFE5 E4                CLR      A
B1:00EFE6 901216            MOV      DPTR,#responseRouteCount
B1:00EFE9 F0                MOVX     @DPTR,A
B1:00EFEA         ?C0012?ZW_ROUTING_ALL:
B1:00EFEA 741D              MOV      A,#LOW responseRouteNodeID-01H
B1:00EFEC 2F                ADD      A,R7
B1:00EFED 12D776            LCALL    ?L?COM0424
B1:00EFF0 E4                CLR      A
B1:00EFF1 F0                MOVX     @DPTR,A
B1:00EFF2 DFF6              DJNZ     R7,?C0012?ZW_ROUTING_ALL
B1:00EFF4 22                RET      
----- FUNCTION ResetRoutedResponseRoutes (END) -------


----- FUNCTION _ZW_LockRoute (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00EFF5 EF                MOV      A,R7
B1:00EFF6 7003              JNZ      $ + 5H
B1:00EFF8 02F07D            LJMP     ?C0068?ZW_ROUTING_ALL
B1:00EFFB D21C              SETB     routesLocked
B1:00EFFD 12D614            LCALL    _GetResponseRouteIndex
;---- Variable 'routetmp' assigned to Register 'R5' ----
B1:00F000 AD07              MOV      R5,AR7
B1:00F002 ED                MOV      A,R5
B1:00F003 6401              XRL      A,#01H
B1:00F005 7078              JNZ      ?C0076?ZW_ROUTING_ALL
B1:00F007 90121F            MOV      DPTR,#responseRouteNodeID+01H
B1:00F00A E0                MOVX     A,@DPTR
B1:00F00B 90121E            MOV      DPTR,#responseRouteNodeID
B1:00F00E F0                MOVX     @DPTR,A
B1:00F00F E4                CLR      A
B1:00F010 A3                INC      DPTR
B1:00F011 F0                MOVX     @DPTR,A
B1:00F012 90123C            MOV      DPTR,#responseRouteSpeedNumHops+01H
B1:00F015 E0                MOVX     A,@DPTR
B1:00F016 90123B            MOV      DPTR,#responseRouteSpeedNumHops
B1:00F019 F0                MOVX     @DPTR,A
B1:00F01A 90121D            MOV      DPTR,#responseRouteRFOption+01H
B1:00F01D E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 450


B1:00F01E 90121C            MOV      DPTR,#responseRouteRFOption
B1:00F021 11DD              ACALL    ?L?COM0585
B1:00F023 7401              MOV      A,#01H
B1:00F025 7E00              MOV      R6,#00H
B1:00F027 A805              MOV      R0,AR5
B1:00F029 08                INC      R0
B1:00F02A 8005              SJMP     ?C0091?ZW_ROUTING_ALL
B1:00F02C         ?C0090?ZW_ROUTING_ALL:
B1:00F02C C3                CLR      C
B1:00F02D 33                RLC      A
B1:00F02E CE                XCH      A,R6
B1:00F02F 33                RLC      A
B1:00F030 CE                XCH      A,R6
B1:00F031         ?C0091?ZW_ROUTING_ALL:
B1:00F031 D8F9              DJNZ     R0,?C0090?ZW_ROUTING_ALL
B1:00F033 FF                MOV      R7,A
B1:00F034 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00F037 E0                MOVX     A,@DPTR
B1:00F038 FC                MOV      R4,A
B1:00F039 FB                MOV      R3,A
B1:00F03A EF                MOV      A,R7
B1:00F03B 5B                ANL      A,R3
B1:00F03C 6006              JZ       ?C0070?ZW_ROUTING_ALL
B1:00F03E EC                MOV      A,R4
B1:00F03F 4401              ORL      A,#01H
B1:00F041 F0                MOVX     @DPTR,A
B1:00F042 8007              SJMP     ?C0071?ZW_ROUTING_ALL
B1:00F044         ?C0070?ZW_ROUTING_ALL:
B1:00F044 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00F047 E0                MOVX     A,@DPTR
B1:00F048 54FE              ANL      A,#0FEH
B1:00F04A F0                MOVX     @DPTR,A
B1:00F04B         ?C0071?ZW_ROUTING_ALL:
B1:00F04B 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00F04E E0                MOVX     A,@DPTR
B1:00F04F FF                MOV      R7,A
B1:00F050 7401              MOV      A,#01H
B1:00F052 A805              MOV      R0,AR5
B1:00F054 08                INC      R0
B1:00F055 8002              SJMP     ?C0093?ZW_ROUTING_ALL
B1:00F057         ?C0092?ZW_ROUTING_ALL:
B1:00F057 C3                CLR      C
B1:00F058 33                RLC      A
B1:00F059         ?C0093?ZW_ROUTING_ALL:
B1:00F059 D8FC              DJNZ     R0,?C0092?ZW_ROUTING_ALL
B1:00F05B F4                CPL      A
B1:00F05C 5F                ANL      A,R7
B1:00F05D 901220            MOV      DPTR,#responseRouteSpeedModified
B1:00F060 F0                MOVX     @DPTR,A
B1:00F061 E4                CLR      A
B1:00F062 FD                MOV      R5,A
B1:00F063         ?C0072?ZW_ROUTING_ALL:
B1:00F063 7445              MOV      A,#LOW responseRouteRepeaterList+04H
B1:00F065 2D                ADD      A,R5
B1:00F066 F582              MOV      DPL,A
B1:00F068 E4                CLR      A
B1:00F069 3412              ADDC     A,#HIGH responseRouteRepeaterList+04H
B1:00F06B F583              MOV      DPH,A
B1:00F06D E0                MOVX     A,@DPTR
B1:00F06E FF                MOV      R7,A
B1:00F06F 7441              MOV      A,#LOW responseRouteRepeaterList
B1:00F071 2D                ADD      A,R5
B1:00F072 128E57            LCALL    ?L?COM00D2
B1:00F075 EF                MOV      A,R7
B1:00F076 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 451


B1:00F077 0D                INC      R5
B1:00F078 ED                MOV      A,R5
B1:00F079 B404E7            CJNE     A,#04H,?C0072?ZW_ROUTING_ALL
B1:00F07C 22                RET      
B1:00F07D         ?C0068?ZW_ROUTING_ALL:
B1:00F07D C21C              CLR      routesLocked
B1:00F07F         ?C0076?ZW_ROUTING_ALL:
B1:00F07F 22                RET      
----- FUNCTION _ZW_LockRoute (END) -------


----- FUNCTION ?L?COM044B (BEGIN) -----
B1:00F080 9041A1            MOV      DPTR,#sourceNode
B1:00F083 E0                MOVX     A,@DPTR
B1:00F084 FF                MOV      R7,A
B1:00F085 12EFF5            LCALL    _ZW_LockRoute
B1:00F088 D216              SETB     protocolLockedCachedRoute
B1:00F08A 22                RET      
----- FUNCTION ?L?COM044B (END) -------


----- FUNCTION _SlaveInit (BEGIN) -----
;---- Variable 'bLoadNodeInformation' assigned to Register 'R7' ----
B1:00F08B 9033D9            MOV      DPTR,#nodeNormalRangeFrame+02H
B1:00F08E 7401              MOV      A,#01H
B1:00F090 F0                MOVX     @DPTR,A
B1:00F091 E4                CLR      A
B1:00F092 A3                INC      DPTR
B1:00F093 F0                MOVX     @DPTR,A
B1:00F094 90336F            MOV      DPTR,#nodeFLiRSRangeFrame+02H
B1:00F097 04                INC      A
B1:00F098 F0                MOVX     @DPTR,A
B1:00F099 E4                CLR      A
B1:00F09A A3                INC      DPTR
B1:00F09B F0                MOVX     @DPTR,A
B1:00F09C 90339F            MOV      DPTR,#pNodeRangeFrame
B1:00F09F 7433              MOV      A,#HIGH nodeNormalRangeFrame
B1:00F0A1 F0                MOVX     @DPTR,A
B1:00F0A2 A3                INC      DPTR
B1:00F0A3 74D7              MOV      A,#LOW nodeNormalRangeFrame
B1:00F0A5 F0                MOVX     @DPTR,A
B1:00F0A6 90339E            MOV      DPTR,#bNeighborDiscoverySpeed
B1:00F0A9 7401              MOV      A,#01H
B1:00F0AB F0                MOVX     @DPTR,A
B1:00F0AC EF                MOV      A,R7
B1:00F0AD 6018              JZ       ?C0105?ZW_SLAVE
B1:00F0AF 901215            MOV      DPTR,#bFLiRSStatus
B1:00F0B2 E0                MOVX     A,@DPTR
B1:00F0B3 54FD              ANL      A,#0FDH
B1:00F0B5 F0                MOVX     @DPTR,A
B1:00F0B6 7B01              MOV      R3,#01H
B1:00F0B8 7A33              MOV      R2,#HIGH slaveFrameBuffer+05H
B1:00F0BA 79B1              MOV      R1,#LOW slaveFrameBuffer+05H
B1:00F0BC 90416F            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+03H
B1:00F0BF 122572            LCALL    ?C?PSTXDATA
B1:00F0C2 11F9              ACALL    ?L?COM0293
B1:00F0C4 121E76            LCALL    ?INTERBANK_TABLE?_ApplicationNodeInformation
B1:00F0C7         ?C0105?ZW_SLAVE:
B1:00F0C7 12EF0D            LCALL    AssignTimerStop
B1:00F0CA E4                CLR      A
B1:00F0CB 903315            MOV      DPTR,#assignState
B1:00F0CE F0                MOVX     @DPTR,A
B1:00F0CF C201              CLR      learnMode
B1:00F0D1 C203              CLR      learnModeDsk
B1:00F0D3 C202              CLR      findInProgress
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 452


B1:00F0D5 C204              CLR      learnModeClassic
B1:00F0D7 C205              CLR      forceUse40K
B1:00F0D9 FF                MOV      R7,A
B1:00F0DA 02EFF5            LJMP     _ZW_LockRoute
----- FUNCTION _SlaveInit (END) -------


----- FUNCTION ?L?COM0585 (BEGIN) -----
B1:00F0DD F0                MOVX     @DPTR,A
B1:00F0DE 901216            MOV      DPTR,#responseRouteCount
B1:00F0E1 E0                MOVX     A,@DPTR
B1:00F0E2 14                DEC      A
B1:00F0E3 F0                MOVX     @DPTR,A
B1:00F0E4 22                RET      
----- FUNCTION ?L?COM0585 (END) -------


----- FUNCTION _RemoveResponseRoute (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R7' ----
B1:00F0E5 12D614            LCALL    _GetResponseRouteIndex
;---- Variable 'routetmp' assigned to Register 'R7' ----
B1:00F0E8 EF                MOV      A,R7
B1:00F0E9 F4                CPL      A
B1:00F0EA 600C              JZ       ?C0078?ZW_ROUTING_ALL
B1:00F0EC 201C09            JB       routesLocked,?C0078?ZW_ROUTING_ALL
B1:00F0EF 741E              MOV      A,#LOW responseRouteNodeID
B1:00F0F1 2F                ADD      A,R7
B1:00F0F2 128E6D            LCALL    ?L?COM026B
B1:00F0F5 E4                CLR      A
B1:00F0F6 11DD              ACALL    ?L?COM0585
B1:00F0F8         ?C0078?ZW_ROUTING_ALL:
B1:00F0F8 22                RET      
----- FUNCTION _RemoveResponseRoute (END) -------


----- FUNCTION ?L?COM0293 (BEGIN) -----
B1:00F0F9 7A33              MOV      R2,#HIGH plnodeParm
B1:00F0FB 7924              MOV      R1,#LOW plnodeParm
B1:00F0FD 904172            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+06H
B1:00F100 122572            LCALL    ?C?PSTXDATA
B1:00F103 7A33              MOV      R2,#HIGH blparmLength
B1:00F105 79AB              MOV      R1,#LOW blparmLength
B1:00F107 904175            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+09H
B1:00F10A 122572            LCALL    ?C?PSTXDATA
B1:00F10D 7A12              MOV      R2,#HIGH bldeviceOptionsMask
B1:00F10F 792A              MOV      R1,#LOW bldeviceOptionsMask
B1:00F111 22                RET      
----- FUNCTION ?L?COM0293 (END) -------


----- FUNCTION _UpdateNodeInformation (BEGIN) -----
B1:00F112 9045D9            MOV      DPTR,#pnodeInfo
B1:00F115 122572            LCALL    ?C?PSTXDATA
B1:00F118 9045D9            MOV      DPTR,#pnodeInfo
B1:00F11B 711D              ACALL    ?L?COM01B8
B1:00F11D 90416F            MOV      DPTR,#?_ApplicationNodeInformation?BYTE+03H
B1:00F120 122572            LCALL    ?C?PSTXDATA
B1:00F123 7B01              MOV      R3,#01H
B1:00F125 11F9              ACALL    ?L?COM0293
B1:00F127 021E76            LJMP     ?INTERBANK_TABLE?_ApplicationNodeInformation
----- FUNCTION _UpdateNodeInformation (END) -------


----- FUNCTION _GenerateNodeInformation (BEGIN) -----
B1:00F12A 9045DC            MOV      DPTR,#pnodeInfo
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 453


B1:00F12D 122572            LCALL    ?C?PSTXDATA
B1:00F130 7D2A              MOV      R5,#02AH
B1:00F132 E4                CLR      A
B1:00F133 FF                MOV      R7,A
B1:00F134 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
B1:00F137 9045DC            MOV      DPTR,#pnodeInfo
B1:00F13A 122552            LCALL    ?C?PLDXDATA
B1:00F13D 3112              ACALL    _UpdateNodeInformation
B1:00F13F 9045DC            MOV      DPTR,#pnodeInfo
B1:00F142 126F2D            LCALL    ?L?COM03A2
B1:00F145 9045DC            MOV      DPTR,#pnodeInfo
B1:00F148 12E012            LCALL    ?L?COM00B3
B1:00F14B 12A441            LCALL    ?L?COM0182
B1:00F14E 12203B            LCALL    ?C?CSTPTR
B1:00F151 9045DC            MOV      DPTR,#pnodeInfo
B1:00F154 129557            LCALL    ?L?COM003C
B1:00F157 F9                MOV      R1,A
B1:00F158 E4                CLR      A
B1:00F159 3A                ADDC     A,R2
B1:00F15A FA                MOV      R2,A
B1:00F15B 7453              MOV      A,#053H
B1:00F15D 12203B            LCALL    ?C?CSTPTR
B1:00F160 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00F163 E0                MOVX     A,@DPTR
B1:00F164 FF                MOV      R7,A
B1:00F165 30E008            JNB      ACC.0,?C0040?ZW_SLAVE
B1:00F168 121F7C            LCALL    ?C?CLDPTR
B1:00F16B 4480              ORL      A,#080H
B1:00F16D 12203B            LCALL    ?C?CSTPTR
B1:00F170         ?C0040?ZW_SLAVE:
B1:00F170 EF                MOV      A,R7
B1:00F171 7F00              MOV      R7,#00H
B1:00F173 30E102            JNB      ACC.1,?C0041?ZW_SLAVE
B1:00F176 7F80              MOV      R7,#080H
B1:00F178         ?C0041?ZW_SLAVE:
B1:00F178         ?C0042?ZW_SLAVE:
B1:00F178 EF                MOV      A,R7
B1:00F179 441C              ORL      A,#01CH
B1:00F17B FF                MOV      R7,A
B1:00F17C 90122A            MOV      DPTR,#bldeviceOptionsMask
B1:00F17F E0                MOVX     A,@DPTR
B1:00F180 FE                MOV      R6,A
B1:00F181 7D00              MOV      R5,#00H
B1:00F183 30E402            JNB      ACC.4,?C0043?ZW_SLAVE
B1:00F186 7D40              MOV      R5,#040H
B1:00F188         ?C0043?ZW_SLAVE:
B1:00F188         ?C0044?ZW_SLAVE:
B1:00F188 EF                MOV      A,R7
B1:00F189 4D                ORL      A,R5
B1:00F18A FF                MOV      R7,A
B1:00F18B EE                MOV      A,R6
B1:00F18C 7E00              MOV      R6,#00H
B1:00F18E 30E502            JNB      ACC.5,?C0045?ZW_SLAVE
B1:00F191 7E20              MOV      R6,#020H
B1:00F193         ?C0045?ZW_SLAVE:
B1:00F193         ?C0046?ZW_SLAVE:
B1:00F193 EF                MOV      A,R7
B1:00F194 4E                ORL      A,R6
B1:00F195 FF                MOV      R7,A
B1:00F196 9045DC            MOV      DPTR,#pnodeInfo
B1:00F199 31E5              ACALL    ?L?COM014F
B1:00F19B 1287AB            LCALL    ?L?COM0015
B1:00F19E 9045DC            MOV      DPTR,#pnodeInfo
B1:00F1A1 129549            LCALL    ?L?COM0058
B1:00F1A4 12A441            LCALL    ?L?COM0182
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 454


B1:00F1A7 12203B            LCALL    ?C?CSTPTR
B1:00F1AA 9033AB            MOV      DPTR,#blparmLength
B1:00F1AD E0                MOVX     A,@DPTR
B1:00F1AE D3                SETB     C
B1:00F1AF 9423              SUBB     A,#023H
B1:00F1B1 4003              JC       ?C0047?ZW_SLAVE
B1:00F1B3 7423              MOV      A,#023H
B1:00F1B5 F0                MOVX     @DPTR,A
B1:00F1B6         ?C0047?ZW_SLAVE:
B1:00F1B6 9033AB            MOV      DPTR,#blparmLength
B1:00F1B9 E0                MOVX     A,@DPTR
B1:00F1BA FE                MOV      R6,A
B1:00F1BB 2407              ADD      A,#07H
B1:00F1BD 9033D6            MOV      DPTR,#blnodeInfoLength
B1:00F1C0 F0                MOVX     @DPTR,A
B1:00F1C1 AF06              MOV      R7,AR6
B1:00F1C3 9045DC            MOV      DPTR,#pnodeInfo
B1:00F1C6 12D910            LCALL    ?L?COM0056
B1:00F1C9 F9                MOV      R1,A
B1:00F1CA E4                CLR      A
B1:00F1CB 3A                ADDC     A,R2
B1:00F1CC FA                MOV      R2,A
B1:00F1CD C003              PUSH     AR3
B1:00F1CF C002              PUSH     AR2
B1:00F1D1 C001              PUSH     AR1
B1:00F1D3 903324            MOV      DPTR,#plnodeParm
B1:00F1D6 1287B6            LCALL    ?L?COM003E
B1:00F1D9 D001              POP      AR1
B1:00F1DB D002              POP      AR2
B1:00F1DD D003              POP      AR3
B1:00F1DF 021BAB            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION _GenerateNodeInformation (END) -------


----- FUNCTION ?L?COM014E (BEGIN) -----
B1:00F1E2 900ACA            MOV      DPTR,#elm
B1:00F1E5         ?L?COM014F:
B1:00F1E5 122552            LCALL    ?C?PLDXDATA
B1:00F1E8 E9                MOV      A,R1
B1:00F1E9 2403              ADD      A,#03H
B1:00F1EB 22                RET      
----- FUNCTION ?L?COM014E (END) -------


----- FUNCTION _security_learn_begin_early (BEGIN) -----
B1:00F1EC 90467F            MOV      DPTR,#__cb
B1:00F1EF EE                MOV      A,R6
B1:00F1F0 F0                MOVX     @DPTR,A
B1:00F1F1 A3                INC      DPTR
B1:00F1F2 EF                MOV      A,R7
B1:00F1F3 F0                MOVX     @DPTR,A
B1:00F1F4 12B20D            LCALL    ?L?COM006D
B1:00F1F7 7D09              MOV      R5,#09H
B1:00F1F9 121CFF            LCALL    ?INTERBANK_TABLE?_secure_learn_isActive
B1:00F1FC BF0112            CJNE     R7,#01H,?C0063?ZW_SECURE_LEARN_SUPPORT
B1:00F1FF E4                CLR      A
B1:00F200 FF                MOV      R7,A
B1:00F201 519B              ACALL    _secure_learn_set_errno
B1:00F203 90467F            MOV      DPTR,#__cb
B1:00F206 7128              ACALL    ?L?COM0339
B1:00F208 12B20D            LCALL    ?L?COM006D
B1:00F20B 121D09            LCALL    ?INTERBANK_TABLE?_secure_learnIface_raise_assignIdDone
B1:00F20E 12EEC3            LCALL    runCycle
B1:00F211         ?C0063?ZW_SECURE_LEARN_SUPPORT:
B1:00F211 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 455


----- FUNCTION _security_learn_begin_early (END) -------


----- FUNCTION _ZCB_SecureLearnProtocolCallback (BEGIN) -----
B1:00F212 9042B0            MOV      DPTR,#txStatus
B1:00F215 126FCE            LCALL    ?L?COM0453
B1:00F218 701C              JNZ      ?C0076?ZW_SLAVE
B1:00F21A 12EB26            LCALL    security_reset
B1:00F21D 5191              ACALL    ?L?COM03F0
B1:00F21F 600D              JZ       ?C0077?ZW_SLAVE
B1:00F221 9042B0            MOV      DPTR,#txStatus
B1:00F224 12B053            LCALL    ?L?COM0177
B1:00F227 8B82              MOV      DPL,R3
B1:00F229 8A83              MOV      DPH,R2
B1:00F22B 51DB              ACALL    ?L?COM03E9
B1:00F22D F0                MOVX     @DPTR,A
B1:00F22E         ?C0077?ZW_SLAVE:
B1:00F22E E4                CLR      A
B1:00F22F 90338E            MOV      DPTR,#_learnNodeFunc
B1:00F232 F0                MOVX     @DPTR,A
B1:00F233 A3                INC      DPTR
B1:00F234 F0                MOVX     @DPTR,A
B1:00F235 22                RET      
B1:00F236         ?C0076?ZW_SLAVE:
B1:00F236 9042B0            MOV      DPTR,#txStatus
B1:00F239 E0                MOVX     A,@DPTR
B1:00F23A 700A              JNZ      ?C0079?ZW_SLAVE
B1:00F23C 126F84            LCALL    ?L?COM0408
B1:00F23F FF                MOV      R7,A
B1:00F240 12EF67            LCALL    _security_learn_begin
B1:00F243 021D8B            LJMP     ?INTERBANK_TABLE?s2_inclusion_neighbor_discovery_complete
B1:00F246         ?C0079?ZW_SLAVE:
B1:00F246 9042B0            MOV      DPTR,#txStatus
B1:00F249 E0                MOVX     A,@DPTR
B1:00F24A 6401              XRL      A,#01H
B1:00F24C 7036              JNZ      ?C0081?ZW_SLAVE
B1:00F24E 126F84            LCALL    ?L?COM0408
B1:00F251 FF                MOV      R7,A
B1:00F252 31EC              ACALL    _security_learn_begin_early
B1:00F254 E4                CLR      A
B1:00F255 FF                MOV      R7,A
B1:00F256 519B              ACALL    _secure_learn_set_errno
B1:00F258 901223            MOV      DPTR,#homeID
B1:00F25B 122462            LCALL    ?C?LLDXDATA
B1:00F25E 121D7C            LCALL    ?INTERBANK_TABLE?_S2_init_ctx
B1:00F261 903CB4            MOV      DPTR,#s2_ctx
B1:00F264 122572            LCALL    ?C?PSTXDATA
B1:00F267 7A42              MOV      R2,#HIGH peer
B1:00F269 79B1              MOV      R1,#LOW peer
B1:00F26B 7D08              MOV      R5,#08H
B1:00F26D 12C54D            LCALL    ?L?COM00FD
B1:00F270 9042B5            MOV      DPTR,#peer+04H
B1:00F273 7425              MOV      A,#025H
B1:00F275 F0                MOVX     @DPTR,A
B1:00F276 121E71            LCALL    ?INTERBANK_TABLE?ApplicationSecureAuthenticationRequested
B1:00F279 AD07              MOV      R5,AR7
B1:00F27B 7B01              MOV      R3,#01H
B1:00F27D 7A42              MOV      R2,#HIGH peer
B1:00F27F 79B1              MOV      R1,#LOW peer
B1:00F281 121D86            LCALL    ?INTERBANK_TABLE?_s2_inclusion_joining_start
B1:00F284         ?C0081?ZW_SLAVE:
B1:00F284 5191              ACALL    ?L?COM03F0
B1:00F286 6008              JZ       ?C0078?ZW_SLAVE
B1:00F288 9042B0            MOV      DPTR,#txStatus
B1:00F28B 12B053            LCALL    ?L?COM0177
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 456


B1:00F28E 51CD              ACALL    ?L?COM0534
B1:00F290         ?C0078?ZW_SLAVE:
B1:00F290 22                RET      
----- FUNCTION _ZCB_SecureLearnProtocolCallback (END) -------


----- FUNCTION ?L?COM03F0 (BEGIN) -----
B1:00F291 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F294         ?L?COM03F1:
B1:00F294 E0                MOVX     A,@DPTR
B1:00F295 FA                MOV      R2,A
B1:00F296 A3                INC      DPTR
B1:00F297 E0                MOVX     A,@DPTR
B1:00F298 FB                MOV      R3,A
B1:00F299 4A                ORL      A,R2
B1:00F29A 22                RET      
----- FUNCTION ?L?COM03F0 (END) -------


----- FUNCTION _secure_learn_set_errno (BEGIN) -----
;---- Variable 'errno' assigned to Register 'R7' ----
B1:00F29B 90361D            MOV      DPTR,#secureLearnErrno
B1:00F29E EF                MOV      A,R7
B1:00F29F F0                MOVX     @DPTR,A
B1:00F2A0 22                RET      
----- FUNCTION _secure_learn_set_errno (END) -------


----- FUNCTION ?L?COM058A (BEGIN) -----
B1:00F2A1 FF                MOV      R7,A
B1:00F2A2 9009DB            MOV      DPTR,#dataLength
B1:00F2A5 E0                MOVX     A,@DPTR
B1:00F2A6 C3                CLR      C
B1:00F2A7 9F                SUBB     A,R7
B1:00F2A8 22                RET      
----- FUNCTION ?L?COM058A (END) -------


----- FUNCTION ?L?COM01CE (BEGIN) -----
B1:00F2A9 C4                SWAP     A
B1:00F2AA 540F              ANL      A,#0FH
B1:00F2AC FD                MOV      R5,A
B1:00F2AD 7C00              MOV      R4,#00H
B1:00F2AF         ?L?COM01CF:
B1:00F2AF EF                MOV      A,R7
B1:00F2B0 240B              ADD      A,#0BH
B1:00F2B2 F9                MOV      R1,A
B1:00F2B3 E4                CLR      A
B1:00F2B4 3E                ADDC     A,R6
B1:00F2B5 FA                MOV      R2,A
B1:00F2B6         ?L?COM01D0:
B1:00F2B6 E9                MOV      A,R1
B1:00F2B7 2D                ADD      A,R5
B1:00F2B8 F9                MOV      R1,A
B1:00F2B9 EC                MOV      A,R4
B1:00F2BA 3A                ADDC     A,R2
B1:00F2BB FA                MOV      R2,A
B1:00F2BC 22                RET      
----- FUNCTION ?L?COM01CE (END) -------


----- FUNCTION secure_learnIface_state_start_timeout (BEGIN) -----
B1:00F2BD 7F01              MOV      R7,#01H
B1:00F2BF 80DA              SJMP     _secure_learn_set_errno
----- FUNCTION secure_learnIface_state_start_timeout (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 457




----- FUNCTION ?L?COM0377 (BEGIN) -----
B1:00F2C1 122552            LCALL    ?C?PLDXDATA
B1:00F2C4         ?L?COM0378:
B1:00F2C4 90419B            MOV      DPTR,#?_CommandHandler?BYTE+04H
B1:00F2C7 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0377 (END) -------


----- FUNCTION RouteCachedReset (BEGIN) -----
B1:00F2CA C21B              CLR      bRouteCached
B1:00F2CC 22                RET      
----- FUNCTION RouteCachedReset (END) -------


----- FUNCTION ?L?COM0534 (BEGIN) -----
B1:00F2CD 8B82              MOV      DPL,R3
B1:00F2CF 8A83              MOV      DPH,R2
B1:00F2D1 0226E3            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0534 (END) -------


----- FUNCTION ?L?COM0380 (BEGIN) -----
B1:00F2D4 FF                MOV      R7,A
B1:00F2D5         ?L?COM0381:
B1:00F2D5 900A04            MOV      DPTR,#pFreeTxElement
B1:00F2D8 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0380 (END) -------


----- FUNCTION ?L?COM03E9 (BEGIN) -----
B1:00F2DB 1226E3            LCALL    ?C?ICALL2
B1:00F2DE E4                CLR      A
B1:00F2DF 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F2E2 F0                MOVX     @DPTR,A
B1:00F2E3 A3                INC      DPTR
B1:00F2E4 22                RET      
----- FUNCTION ?L?COM03E9 (END) -------


----- FUNCTION _secure_learnIface_complete (BEGIN) -----
B1:00F2E5 904576            MOV      DPTR,#scheme_mask
B1:00F2E8 1224BA            LCALL    ?C?LSTXDATA
B1:00F2EB         ?C0045?ZW_SECURE_LEARN_SUPPORT:
B1:00F2EB         ?C0046?ZW_SECURE_LEARN_SUPPORT:
B1:00F2EB 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F2EE E0                MOVX     A,@DPTR
B1:00F2EF 7002              JNZ      ?C0086?ZW_SECURE_LEARN_SUPPORT
B1:00F2F1 A3                INC      DPTR
B1:00F2F2 E0                MOVX     A,@DPTR
B1:00F2F3         ?C0086?ZW_SECURE_LEARN_SUPPORT:
B1:00F2F3 601A              JZ       ?C0053?ZW_SECURE_LEARN_SUPPORT
B1:00F2F5 7110              ACALL    secure_learn_get_errno
B1:00F2F7 EF                MOV      A,R7
B1:00F2F8 6401              XRL      A,#01H
B1:00F2FA 6011              JZ       ?C0051?ZW_SECURE_LEARN_SUPPORT
B1:00F2FC 901221            MOV      DPTR,#nodeID
B1:00F2FF E0                MOVX     A,@DPTR
B1:00F300 FD                MOV      R5,A
B1:00F301 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F304 12AD01            LCALL    ?L?COM00CE
B1:00F307 E4                CLR      A
B1:00F308 FF                MOV      R7,A
B1:00F309 51DB              ACALL    ?L?COM03E9
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 458


B1:00F30B F0                MOVX     @DPTR,A
B1:00F30C 22                RET      
B1:00F30D         ?C0051?ZW_SECURE_LEARN_SUPPORT:
B1:00F30D 7116              ACALL    secure_learn_set_errno_reset
B1:00F30F         ?C0053?ZW_SECURE_LEARN_SUPPORT:
B1:00F30F 22                RET      
----- FUNCTION _secure_learnIface_complete (END) -------


----- FUNCTION secure_learn_get_errno (BEGIN) -----
B1:00F310 90361D            MOV      DPTR,#secureLearnErrno
B1:00F313 E0                MOVX     A,@DPTR
B1:00F314 FF                MOV      R7,A
B1:00F315 22                RET      
----- FUNCTION secure_learn_get_errno (END) -------


----- FUNCTION secure_learn_set_errno_reset (BEGIN) -----
B1:00F316 E4                CLR      A
B1:00F317 90361D            MOV      DPTR,#secureLearnErrno
B1:00F31A F0                MOVX     @DPTR,A
B1:00F31B 22                RET      
----- FUNCTION secure_learn_set_errno_reset (END) -------


----- FUNCTION ?L?COM01B7 (BEGIN) -----
B1:00F31C FF                MOV      R7,A
B1:00F31D         ?L?COM01B8:
B1:00F31D 122552            LCALL    ?C?PLDXDATA
B1:00F320 E9                MOV      A,R1
B1:00F321 2405              ADD      A,#05H
B1:00F323 F9                MOV      R1,A
B1:00F324 E4                CLR      A
B1:00F325 3A                ADDC     A,R2
B1:00F326 FA                MOV      R2,A
B1:00F327 22                RET      
----- FUNCTION ?L?COM01B7 (END) -------


----- FUNCTION ?L?COM0339 (BEGIN) -----
B1:00F328 E0                MOVX     A,@DPTR
B1:00F329 FF                MOV      R7,A
B1:00F32A A3                INC      DPTR
B1:00F32B E0                MOVX     A,@DPTR
B1:00F32C 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B1:00F32F CF                XCH      A,R7
B1:00F330 F0                MOVX     @DPTR,A
B1:00F331 A3                INC      DPTR
B1:00F332 EF                MOV      A,R7
B1:00F333 F0                MOVX     @DPTR,A
B1:00F334 22                RET      
----- FUNCTION ?L?COM0339 (END) -------


----- FUNCTION _TransportService_msg_received_event (BEGIN) -----
;---- Variable 'cmdLen' assigned to Register 'R5' ----
;---- Variable 'pCmd' assigned to Register 'R1/R2/R3' ----
B1:00F335 E4                CLR      A
B1:00F336 9033A6            MOV      DPTR,#ts_rxOpt
B1:00F339 F0                MOVX     @DPTR,A
B1:00F33A 90450E            MOV      DPTR,#srcNode
B1:00F33D E0                MOVX     A,@DPTR
B1:00F33E 9033A7            MOV      DPTR,#ts_rxOpt+01H
B1:00F341 F0                MOVX     @DPTR,A
B1:00F342 901221            MOV      DPTR,#nodeID
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 459


B1:00F345 E0                MOVX     A,@DPTR
B1:00F346 9033A8            MOV      DPTR,#ts_rxOpt+02H
B1:00F349 F0                MOVX     @DPTR,A
B1:00F34A E4                CLR      A
B1:00F34B A3                INC      DPTR
B1:00F34C F0                MOVX     @DPTR,A
B1:00F34D A3                INC      DPTR
B1:00F34E F0                MOVX     @DPTR,A
B1:00F34F C003              PUSH     AR3
B1:00F351 C002              PUSH     AR2
B1:00F353 C001              PUSH     AR1
B1:00F355 7B01              MOV      R3,#01H
B1:00F357 7A33              MOV      R2,#HIGH ts_rxOpt
B1:00F359 79A6              MOV      R1,#LOW ts_rxOpt
B1:00F35B 51C4              ACALL    ?L?COM0378
B1:00F35D D001              POP      AR1
B1:00F35F D002              POP      AR2
B1:00F361 D003              POP      AR3
B1:00F363 02BCFE            LJMP     _CommandHandler
----- FUNCTION _TransportService_msg_received_event (END) -------


----- FUNCTION ?L?COM04C6 (BEGIN) -----
B1:00F366 7B01              MOV      R3,#01H
B1:00F368 7A33              MOV      R2,#HIGH SUC_Update+01H
B1:00F36A 7998              MOV      R1,#LOW SUC_Update+01H
----- FUNCTION _NetWorkTimerStop (BEGIN) -----
B1:00F36C 9045D6            MOV      DPTR,#timerHandle
B1:00F36F 122572            LCALL    ?C?PSTXDATA
B1:00F372 9045D6            MOV      DPTR,#timerHandle
B1:00F375 12C941            LCALL    ?L?COM0048
B1:00F378 FF                MOV      R7,A
B1:00F379 1244EE            LCALL    _TimerCancel
B1:00F37C 9045D6            MOV      DPTR,#timerHandle
B1:00F37F 122552            LCALL    ?C?PLDXDATA
B1:00F382 74FF              MOV      A,#0FFH
B1:00F384 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _NetWorkTimerStop (END) -------


----- FUNCTION _NetWorkTimerStart (BEGIN) -----
B1:00F387 9043F8            MOV      DPTR,#timeOutFunc
B1:00F38A EC                MOV      A,R4
B1:00F38B F0                MOVX     @DPTR,A
B1:00F38C A3                INC      DPTR
B1:00F38D ED                MOV      A,R5
B1:00F38E F0                MOVX     @DPTR,A
B1:00F38F 9043F5            MOV      DPTR,#timeoutHandle
B1:00F392 122572            LCALL    ?C?PSTXDATA
B1:00F395 121F7C            LCALL    ?C?CLDPTR
B1:00F398 FF                MOV      R7,A
B1:00F399 F4                CPL      A
B1:00F39A 6003              JZ       ?C0003?ZW_SLAVE
B1:00F39C 02477E            LJMP     _TimerRestart
B1:00F39F         ?C0003?ZW_SLAVE:
B1:00F39F 9043F8            MOV      DPTR,#timeOutFunc
B1:00F3A2 126EB3            LCALL    ?L?COM031A
B1:00F3A5 1257A8            LCALL    _TimerSysStart
B1:00F3A8 9043F5            MOV      DPTR,#timeoutHandle
B1:00F3AB 1256DF            LCALL    ?L?COM0125
B1:00F3AE 9043F5            MOV      DPTR,#timeoutHandle
B1:00F3B1 12C941            LCALL    ?L?COM0048
B1:00F3B4 B4FF0A            CJNE     A,#0FFH,?C0007?ZW_SLAVE
B1:00F3B7 12AF22            LCALL    ?L?COM01C0
B1:00F3BA 6005              JZ       ?C0007?ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 460


B1:00F3BC 8F82              MOV      DPL,R7
B1:00F3BE 126EED            LCALL    ?L?COM0372
B1:00F3C1         ?C0007?ZW_SLAVE:
B1:00F3C1 22                RET      
----- FUNCTION _NetWorkTimerStart (END) -------


----- FUNCTION _ZCB_ReqUpdateCallback (BEGIN) -----
B1:00F3C2 9046A1            MOV      DPTR,#txStatus
B1:00F3C5 EF                MOV      A,R7
B1:00F3C6 F0                MOVX     @DPTR,A
B1:00F3C7 7F01              MOV      R7,#01H
B1:00F3C9 125006            LCALL    _ZW_SetRFReceiveMode
B1:00F3CC 9046A1            MOV      DPTR,#txStatus
B1:00F3CF E0                MOVX     A,@DPTR
B1:00F3D0 7006              JNZ      ?C0011?ZW_SLAVE
B1:00F3D2 71E3              ACALL    ?L?COM0317
B1:00F3D4 04                INC      A
B1:00F3D5 F0                MOVX     @DPTR,A
B1:00F3D6 80AF              SJMP     _NetWorkTimerStart
B1:00F3D8         ?C0011?ZW_SLAVE:
B1:00F3D8 12AF22            LCALL    ?L?COM01C0
B1:00F3DB 6005              JZ       ?C0014?ZW_SLAVE
B1:00F3DD 8F82              MOV      DPL,R7
B1:00F3DF 126EED            LCALL    ?L?COM0372
B1:00F3E2         ?C0014?ZW_SLAVE:
B1:00F3E2 22                RET      
----- FUNCTION _ZCB_ReqUpdateCallback (END) -------


----- FUNCTION ?L?COM0317 (BEGIN) -----
B1:00F3E3 7B01              MOV      R3,#01H
B1:00F3E5 7A33              MOV      R2,#HIGH SUC_Update+01H
B1:00F3E7 7998              MOV      R1,#LOW SUC_Update+01H
B1:00F3E9 7C19              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_RequestUpdateTimeout
B1:00F3EB 7DC1              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_RequestUpdateTimeout
B1:00F3ED 9043FA            MOV      DPTR,#?_NetWorkTimerStart?BYTE+05H
B1:00F3F0 74FE              MOV      A,#0FEH
B1:00F3F2 F0                MOVX     @DPTR,A
B1:00F3F3 A3                INC      DPTR
B1:00F3F4 22                RET      
----- FUNCTION ?L?COM0317 (END) -------


----- FUNCTION ZCB_RequestUpdateTimeout (BEGIN) -----
B1:00F3F5 903399            MOV      DPTR,#SUC_Update+02H
B1:00F3F8 E0                MOVX     A,@DPTR
B1:00F3F9 04                INC      A
B1:00F3FA F0                MOVX     @DPTR,A
B1:00F3FB D3                SETB     C
B1:00F3FC 9414              SUBB     A,#014H
B1:00F3FE 400D              JC       ?C0010?ZW_SLAVE
B1:00F400 12AF25            LCALL    ?L?COM01C1
B1:00F403 6005              JZ       ?C0009?ZW_SLAVE
B1:00F405 8F82              MOV      DPL,R7
B1:00F407 126EED            LCALL    ?L?COM0372
B1:00F40A         ?C0009?ZW_SLAVE:
B1:00F40A 12EF46            LCALL    ResetSUC
B1:00F40D         ?C0010?ZW_SLAVE:
B1:00F40D 22                RET      
----- FUNCTION ZCB_RequestUpdateTimeout (END) -------


----- FUNCTION DelayNeighborCompleteFailCall (BEGIN) -----
B1:00F40E 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_NeighborCompleteFailCall
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 461


B1:00F410 7FDA              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_NeighborCompleteFailCall
B1:00F412 1257A4            LCALL    ?L?COM02AD
B1:00F415 BFFF03            CJNE     R7,#0FFH,?C0029?ZW_SLAVE
B1:00F418 12AF3C            LCALL    ZCB_NeighborCompleteFailCall
B1:00F41B         ?C0029?ZW_SLAVE:
B1:00F41B 22                RET      
----- FUNCTION DelayNeighborCompleteFailCall (END) -------


----- FUNCTION _ZW_SetLearnMode (BEGIN) -----
;---- Variable 'mode' assigned to Register 'R7' ----
;---- Variable 'learnFunc' assigned to Register 'R4/R5' ----
B1:00F41C 7403              MOV      A,#03H
B1:00F41E C3                CLR      C
B1:00F41F 9F                SUBB     A,R7
B1:00F420 5002              JNC      ?C0083?ZW_SLAVE
B1:00F422 E4                CLR      A
B1:00F423 FF                MOV      R7,A
B1:00F424         ?C0083?ZW_SLAVE:
B1:00F424 02EE30            LJMP     _InternSetLearnMode
----- FUNCTION _ZW_SetLearnMode (END) -------


----- FUNCTION ZW_GetSUCNodeID (BEGIN) -----
B1:00F427 9033A5            MOV      DPTR,#sucNodeID
B1:00F42A E0                MOVX     A,@DPTR
B1:00F42B FF                MOV      R7,A
B1:00F42C 22                RET      
----- FUNCTION ZW_GetSUCNodeID (END) -------


----- FUNCTION RemoveAllReturnRouteDestination (BEGIN) -----
B1:00F42D 7E11              MOV      R6,#HIGH NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00F42F 7F56              MOV      R7,#LOW NVM_RETURN_ROUTE_DESTINATIONS_CACHED_far
B1:00F431 12A79C            LCALL    ?L?COM00A4
B1:00F434 12ADB3            LCALL    ?L?COM0175
B1:00F437 7405              MOV      A,#05H
B1:00F439 F0                MOVX     @DPTR,A
B1:00F43A 1239FB            LCALL    _NVM_ext_write_buffer
B1:00F43D 12D70E            LCALL    ?L?COM0454
B1:00F440 7D05              MOV      R5,#05H
B1:00F442 E4                CLR      A
B1:00F443 FF                MOV      R7,A
B1:00F444 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION RemoveAllReturnRouteDestination (END) -------


----- FUNCTION _ZW_RequestNetWorkUpdate (BEGIN) -----
B1:00F447 904679            MOV      DPTR,#completedFunc
B1:00F44A EE                MOV      A,R6
B1:00F44B F0                MOVX     @DPTR,A
B1:00F44C A3                INC      DPTR
B1:00F44D EF                MOV      A,R7
B1:00F44E F0                MOVX     @DPTR,A
B1:00F44F 12C513            LCALL    ReloadRouteDestinations
B1:00F452 904679            MOV      DPTR,#completedFunc
B1:00F455 E0                MOVX     A,@DPTR
B1:00F456 FC                MOV      R4,A
B1:00F457 A3                INC      DPTR
B1:00F458 E0                MOVX     A,@DPTR
B1:00F459 FD                MOV      R5,A
B1:00F45A E4                CLR      A
B1:00F45B FF                MOV      R7,A
B1:00F45C 02D24A            LJMP     _ZW_RequestNetworkUpdateInternal
----- FUNCTION _ZW_RequestNetWorkUpdate (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 462




----- FUNCTION Init_ZW_HW (BEGIN) -----
B1:00F45F E4                CLR      A
B1:00F460 F56C              MOV      P0Shadow,A
B1:00F462 F56D              MOV      P1Shadow,A
B1:00F464 F56E              MOV      P2Shadow,A
B1:00F466 F56F              MOV      P3Shadow,A
B1:00F468 75FF01            MOV      SFRPAGE,#01H
B1:00F46B 85FD68            MOV      P0ShadowDIR,P0DIR
B1:00F46E 75FF01            MOV      SFRPAGE,#01H
B1:00F471 85C969            MOV      P1ShadowDIR,P1DIR
B1:00F474 75FF01            MOV      SFRPAGE,#01H
B1:00F477 85CA6A            MOV      P2ShadowDIR,P2DIR
B1:00F47A 75FF01            MOV      SFRPAGE,#01H
B1:00F47D 85CB6B            MOV      P3ShadowDIR,P3DIR
B1:00F480 22                RET      
----- FUNCTION Init_ZW_HW (END) -------


----- FUNCTION _ZW_SoftReset (BEGIN) -----
;---- Variable 'reason' assigned to Register 'R7' ----
B1:00F481 EF                MOV      A,R7
B1:00F482 9188              ACALL    ?L?COM057D
B1:00F484 F0                MOVX     @DPTR,A
B1:00F485 020000            LJMP     00H
----- FUNCTION _ZW_SoftReset (END) -------


----- FUNCTION ?L?COM057D (BEGIN) -----
B1:00F488 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F48B F0                MOVX     @DPTR,A
B1:00F48C 9046A5            MOV      DPTR,#wakeUpReason
B1:00F48F 22                RET      
----- FUNCTION ?L?COM057D (END) -------


----- FUNCTION ZW_getSwWakeupReason (BEGIN) -----
B1:00F490 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F493 E0                MOVX     A,@DPTR
B1:00F494 FF                MOV      R7,A
B1:00F495 F4                CPL      A
B1:00F496 6005              JZ       ?C0003?ZW_HW_INIT
B1:00F498 9046A5            MOV      DPTR,#wakeUpReason
B1:00F49B EF                MOV      A,R7
B1:00F49C F0                MOVX     @DPTR,A
B1:00F49D         ?C0003?ZW_HW_INIT:
B1:00F49D 74FF              MOV      A,#0FFH
B1:00F49F 9188              ACALL    ?L?COM057D
B1:00F4A1 E0                MOVX     A,@DPTR
B1:00F4A2 FF                MOV      R7,A
B1:00F4A3 22                RET      
----- FUNCTION ZW_getSwWakeupReason (END) -------


----- FUNCTION _ZW_setSwWakeupReason (BEGIN) -----
;---- Variable 'reason' assigned to Register 'R7' ----
B1:00F4A4 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F4A7 E0                MOVX     A,@DPTR
B1:00F4A8 FE                MOV      R6,A
B1:00F4A9 6406              XRL      A,#06H
B1:00F4AB 601A              JZ       ?C0005?ZW_HW_INIT
B1:00F4AD EF                MOV      A,R7
B1:00F4AE B4010F            CJNE     A,#01H,?C0006?ZW_HW_INIT
B1:00F4B1 901217            MOV      DPTR,#eSystemTypeState
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 463


B1:00F4B4 E0                MOVX     A,@DPTR
B1:00F4B5 30E208            JNB      ACC.2,?C0006?ZW_HW_INIT
B1:00F4B8 9046A5            MOV      DPTR,#wakeUpReason
B1:00F4BB 7407              MOV      A,#07H
B1:00F4BD F0                MOVX     @DPTR,A
B1:00F4BE 8012              SJMP     ?C0008?ZW_HW_INIT
B1:00F4C0         ?C0006?ZW_HW_INIT:
B1:00F4C0 9046A5            MOV      DPTR,#wakeUpReason
B1:00F4C3 EF                MOV      A,R7
B1:00F4C4 F0                MOVX     @DPTR,A
B1:00F4C5 800B              SJMP     ?C0008?ZW_HW_INIT
B1:00F4C7         ?C0005?ZW_HW_INIT:
B1:00F4C7 9046A5            MOV      DPTR,#wakeUpReason
B1:00F4CA EE                MOV      A,R6
B1:00F4CB F0                MOVX     @DPTR,A
B1:00F4CC 90123E            MOV      DPTR,#criticalMemWakeupReason
B1:00F4CF 74FF              MOV      A,#0FFH
B1:00F4D1 F0                MOVX     @DPTR,A
B1:00F4D2         ?C0008?ZW_HW_INIT:
B1:00F4D2 9046A5            MOV      DPTR,#wakeUpReason
B1:00F4D5 E0                MOVX     A,@DPTR
B1:00F4D6 FF                MOV      R7,A
B1:00F4D7 22                RET      
----- FUNCTION _ZW_setSwWakeupReason (END) -------


----- FUNCTION RFDriverInitHWFLiRS (BEGIN) -----
B1:00F4D8         ?C0001?ZW_RF_DRIVER_INIT:
B1:00F4D8 901832            MOV      DPTR,#rf_table+04H
B1:00F4DB 12246E            LCALL    ?C?LLDCODE
B1:00F4DE 903EC1            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+04H
B1:00F4E1 B11A              ACALL    ?L?COM04C3
B1:00F4E3 903EC5            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+08H
B1:00F4E6 B1B1              ACALL    ?L?COM0515
B1:00F4E8 903EC9            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0CH
B1:00F4EB F0                MOVX     @DPTR,A
B1:00F4EC 90183B            MOV      DPTR,#rf_table+0DH
B1:00F4EF E4                CLR      A
B1:00F4F0 93                MOVC     A,@A+DPTR
B1:00F4F1 903ECA            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0DH
B1:00F4F4 F0                MOVX     @DPTR,A
B1:00F4F5 90183C            MOV      DPTR,#rf_table+0EH
B1:00F4F8 E4                CLR      A
B1:00F4F9 93                MOVC     A,@A+DPTR
B1:00F4FA 903ECB            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0EH
B1:00F4FD F0                MOVX     @DPTR,A
B1:00F4FE 90183D            MOV      DPTR,#rf_table+0FH
B1:00F501 E4                CLR      A
B1:00F502 93                MOVC     A,@A+DPTR
B1:00F503 903ECC            MOV      DPTR,#?_RF_onetime_init_and_rx?BYTE+0FH
B1:00F506 F0                MOVX     @DPTR,A
B1:00F507 D234              SETB     ?_RF_onetime_init_and_rx?BIT
B1:00F509 90182E            MOV      DPTR,#rf_table
B1:00F50C 12246E            LCALL    ?C?LLDCODE
B1:00F50F 124ABC            LCALL    _RF_onetime_init_and_rx
B1:00F512 50C4              JNC      ?C0001?ZW_RF_DRIVER_INIT
B1:00F514         ?C0002?ZW_RF_DRIVER_INIT:
B1:00F514 E4                CLR      A
B1:00F515 F510              MOV      demodState,A
B1:00F517 F514              MOV      RF_state,A
B1:00F519 22                RET      
----- FUNCTION RFDriverInitHWFLiRS (END) -------


----- FUNCTION ?L?COM04C3 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 464


B1:00F51A 1224BA            LCALL    ?C?LSTXDATA
B1:00F51D 901836            MOV      DPTR,#rf_table+08H
B1:00F520 02246E            LJMP     ?C?LLDCODE
----- FUNCTION ?L?COM04C3 (END) -------


----- FUNCTION RFDriverInitHW (BEGIN) -----
B1:00F523 C2EB              CLR      ERF
B1:00F525 D2FB              SETB     PRF
B1:00F527 901832            MOV      DPTR,#rf_table+04H
B1:00F52A 12246E            LCALL    ?C?LLDCODE
B1:00F52D 903FC9            MOV      DPTR,#?_RF_onetime_init?BYTE+04H
B1:00F530 B11A              ACALL    ?L?COM04C3
B1:00F532 903FCD            MOV      DPTR,#?_RF_onetime_init?BYTE+08H
B1:00F535 B1B1              ACALL    ?L?COM0515
B1:00F537 903FD1            MOV      DPTR,#?_RF_onetime_init?BYTE+0CH
B1:00F53A F0                MOVX     @DPTR,A
B1:00F53B 90183B            MOV      DPTR,#rf_table+0DH
B1:00F53E E4                CLR      A
B1:00F53F 93                MOVC     A,@A+DPTR
B1:00F540 903FD2            MOV      DPTR,#?_RF_onetime_init?BYTE+0DH
B1:00F543 F0                MOVX     @DPTR,A
B1:00F544 90183C            MOV      DPTR,#rf_table+0EH
B1:00F547 E4                CLR      A
B1:00F548 93                MOVC     A,@A+DPTR
B1:00F549 903FD3            MOV      DPTR,#?_RF_onetime_init?BYTE+0EH
B1:00F54C F0                MOVX     @DPTR,A
B1:00F54D 90183D            MOV      DPTR,#rf_table+0FH
B1:00F550 E4                CLR      A
B1:00F551 93                MOVC     A,@A+DPTR
B1:00F552 903FD4            MOV      DPTR,#?_RF_onetime_init?BYTE+0FH
B1:00F555 F0                MOVX     @DPTR,A
B1:00F556 D233              SETB     ?_RF_onetime_init?BIT
B1:00F558 90182E            MOV      DPTR,#rf_table
B1:00F55B 12246E            LCALL    ?C?LLDCODE
B1:00F55E 124C5A            LCALL    _RF_onetime_init
B1:;----                  JMP      ?L?COM0514
----- FUNCTION RFDriverInitHW (END) -------


----- FUNCTION ?L?COM0514 (BEGIN) -----
B1:00F561 E4                CLR      A
B1:00F562 F510              MOV      demodState,A
B1:00F564 F514              MOV      RF_state,A
B1:00F566 751520            MOV      RF_status,#020H
B1:00F569 22                RET      
----- FUNCTION ?L?COM0514 (END) -------


----- FUNCTION RFDriverInitSW (BEGIN) -----
B1:00F56A B161              ACALL    ?L?COM0514
B1:00F56C 90183E            MOV      DPTR,#rf_table+010H
B1:00F56F 93                MOVC     A,@A+DPTR
B1:00F570 F51B              MOV      normal_PA_POW,A
B1:00F572 901841            MOV      DPTR,#rf_table+013H
B1:00F575 E4                CLR      A
B1:00F576 93                MOVC     A,@A+DPTR
B1:00F577 F513              MOV      low_PA_POW,A
B1:00F579 907FB2            MOV      DPTR,#sFlashApplTable+02H
B1:00F57C E4                CLR      A
B1:00F57D 93                MOVC     A,@A+DPTR
B1:00F57E FF                MOV      R7,A
B1:00F57F F4                CPL      A
B1:00F580 6002              JZ       ?C0012?ZW_RF_DRIVER_INIT
B1:00F582 8F1B              MOV      normal_PA_POW,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 465


B1:00F584         ?C0012?ZW_RF_DRIVER_INIT:
B1:00F584 907FB5            MOV      DPTR,#sFlashApplTable+05H
B1:00F587 E4                CLR      A
B1:00F588 93                MOVC     A,@A+DPTR
B1:00F589 FF                MOV      R7,A
B1:00F58A F4                CPL      A
B1:00F58B 6002              JZ       ?C0013?ZW_RF_DRIVER_INIT
B1:00F58D 8F13              MOV      low_PA_POW,R7
B1:00F58F         ?C0013?ZW_RF_DRIVER_INIT:
B1:00F58F AF1B              MOV      R7,normal_PA_POW
B1:00F591 B1BA              ACALL    _RFDriverPowerToIndex
B1:00F593 901844            MOV      DPTR,#rf_table+016H
B1:00F596 E4                CLR      A
B1:00F597 93                MOVC     A,@A+DPTR
B1:00F598 900764            MOV      DPTR,#bListenRSSIThreshold
B1:00F59B F0                MOVX     @DPTR,A
B1:00F59C 901845            MOV      DPTR,#rf_table+017H
B1:00F59F E4                CLR      A
B1:00F5A0 93                MOVC     A,@A+DPTR
B1:00F5A1 900765            MOV      DPTR,#bListenRSSIThreshold+01H
B1:00F5A4 F0                MOVX     @DPTR,A
B1:00F5A5 901846            MOV      DPTR,#rf_table+018H
B1:00F5A8 E4                CLR      A
B1:00F5A9 93                MOVC     A,@A+DPTR
B1:00F5AA 900766            MOV      DPTR,#bListenRSSIThreshold+02H
B1:00F5AD F0                MOVX     @DPTR,A
B1:00F5AE 025E91            LJMP     ZW_ClearTxTimers
----- FUNCTION RFDriverInitSW (END) -------


----- FUNCTION ?L?COM0515 (BEGIN) -----
B1:00F5B1 1224BA            LCALL    ?C?LSTXDATA
B1:00F5B4 90183A            MOV      DPTR,#rf_table+0CH
B1:00F5B7 E4                CLR      A
B1:00F5B8 93                MOVC     A,@A+DPTR
B1:00F5B9 22                RET      
----- FUNCTION ?L?COM0515 (END) -------


----- FUNCTION _RFDriverPowerToIndex (BEGIN) -----
;---- Variable 'bPower' assigned to Register 'R7' ----
B1:00F5BA E4                CLR      A
B1:00F5BB F517              MOV      powerIndex,A
B1:00F5BD         ?C0005?ZW_RF_DRIVER_INIT:
B1:00F5BD E517              MOV      A,powerIndex
B1:00F5BF 902FC6            MOV      DPTR,#rf_power_table
B1:00F5C2 93                MOVC     A,@A+DPTR
B1:00F5C3 D3                SETB     C
B1:00F5C4 9F                SUBB     A,R7
B1:00F5C5 4007              JC       ?C0006?ZW_RF_DRIVER_INIT
B1:00F5C7         ?C0008?ZW_RF_DRIVER_INIT:
B1:00F5C7         ?C0007?ZW_RF_DRIVER_INIT:
B1:00F5C7 0517              INC      powerIndex
B1:00F5C9 E517              MOV      A,powerIndex
B1:00F5CB B40EEF            CJNE     A,#0EH,?C0005?ZW_RF_DRIVER_INIT
B1:00F5CE         ?C0006?ZW_RF_DRIVER_INIT:
B1:00F5CE E517              MOV      A,powerIndex
B1:00F5D0 C3                CLR      C
B1:00F5D1 940E              SUBB     A,#0EH
B1:00F5D3 4004              JC       ?C0009?ZW_RF_DRIVER_INIT
B1:00F5D5 7517FF            MOV      powerIndex,#0FFH
B1:00F5D8 22                RET      
B1:00F5D9         ?C0009?ZW_RF_DRIVER_INIT:
B1:00F5D9 E517              MOV      A,powerIndex
B1:00F5DB C4                SWAP     A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 466


B1:00F5DC 54F0              ANL      A,#0F0H
B1:00F5DE F517              MOV      powerIndex,A
B1:00F5E0 22                RET      
----- FUNCTION _RFDriverPowerToIndex (END) -------


----- FUNCTION ProtocolWaitACKTimeout (BEGIN) -----
B1:00F5E1 12851B            LCALL    ?L?COM000C
B1:00F5E4 4A                ORL      A,R2
B1:00F5E5 C3                CLR      C
B1:00F5E6 6001              JZ       ?C0002?ZW_TXQ_PROTOCOL
B1:00F5E8 D3                SETB     C
B1:00F5E9         ?C0002?ZW_TXQ_PROTOCOL:
B1:00F5E9         ?C0003?ZW_TXQ_PROTOCOL:
B1:00F5E9 4002              JC       $ + 4H
B1:00F5EB C176              AJMP     ?C0004?ZW_TXQ_PROTOCOL
B1:00F5ED         ?C0001?ZW_TXQ_PROTOCOL:
B1:00F5ED 12851B            LCALL    ?L?COM000C
B1:00F5F0 1257E3            LCALL    ?L?COM0222
B1:00F5F3 74FF              MOV      A,#0FFH
B1:00F5F5 121FE6            LCALL    ?C?CILDPTR
B1:00F5F8 121F7C            LCALL    ?C?CLDPTR
B1:00F5FB FF                MOV      R7,A
B1:00F5FC D3                SETB     C
B1:00F5FD 9401              SUBB     A,#01H
B1:00F5FF 4007              JC       ?C0005?ZW_TXQ_PROTOCOL
B1:00F601 EF                MOV      A,R7
B1:00F602 9403              SUBB     A,#03H
B1:00F604 5002              JNC      ?C0005?ZW_TXQ_PROTOCOL
B1:00F606 805D              SJMP     ?C0048?ZW_TXQ_PROTOCOL
B1:00F608         ?C0005?ZW_TXQ_PROTOCOL:
B1:00F608 12851B            LCALL    ?L?COM000C
B1:00F60B 2401              ADD      A,#01H
B1:00F60D 1285F5            LCALL    ?L?COM0004
B1:00F610 6401              XRL      A,#01H
B1:00F612 705A              JNZ      ?C0007?ZW_TXQ_PROTOCOL
B1:00F614 12851B            LCALL    ?L?COM000C
B1:00F617 1252F2            LCALL    ?L?COM0020
B1:00F61A D177              ACALL    ?L?COM0542
B1:00F61C 7047              JNZ      ?C0008?ZW_TXQ_PROTOCOL
B1:00F61E 12851B            LCALL    ?L?COM000C
B1:00F621 24B6              ADD      A,#0B6H
B1:00F623 1285F5            LCALL    ?L?COM0004
B1:00F626 FD                MOV      R5,A
B1:00F627 901221            MOV      DPTR,#nodeID
B1:00F62A E0                MOVX     A,@DPTR
B1:00F62B 6D                XRL      A,R5
B1:00F62C 7037              JNZ      ?C0008?ZW_TXQ_PROTOCOL
B1:00F62E 12851B            LCALL    ?L?COM000C
B1:00F631 24B7              ADD      A,#0B7H
B1:00F633 1285F5            LCALL    ?L?COM0004
B1:00F636 20E72C            JB       ACC.7,?C0008?ZW_TXQ_PROTOCOL
B1:00F639 12851B            LCALL    ?L?COM000C
B1:00F63C 24B9              ADD      A,#0B9H
B1:00F63E 1285F5            LCALL    ?L?COM0004
B1:00F641 D3                SETB     C
B1:00F642 9440              SUBB     A,#040H
B1:00F644 501F              JNC      ?C0008?ZW_TXQ_PROTOCOL
B1:00F646 20021C            JB       findInProgress,?C0008?ZW_TXQ_PROTOCOL
B1:00F649 12851B            LCALL    ?L?COM000C
B1:00F64C 125D39            LCALL    ?L?COM00E6
B1:00F64F EF                MOV      A,R7
B1:00F650 54F8              ANL      A,#0F8H
B1:00F652 4402              ORL      A,#02H
B1:00F654 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 467


B1:00F655 12C951            LCALL    ?L?COM00B9
B1:00F658 12851B            LCALL    ?L?COM000C
B1:00F65B 24B7              ADD      A,#0B7H
B1:00F65D 1285F5            LCALL    ?L?COM0004
B1:00F660 4410              ORL      A,#010H
B1:00F662 12203B            LCALL    ?C?CSTPTR
B1:00F665         ?C0008?ZW_TXQ_PROTOCOL:
B1:00F665         
B1:00F665 904014            MOV      DPTR,#pFrameWaitingForACK
B1:00F668 122552            LCALL    ?C?PLDXDATA
B1:00F66B 02C91F            LJMP     _TxQueueQueueElement
B1:00F66E         ?C0007?ZW_TXQ_PROTOCOL:
B1:00F66E E4                CLR      A
B1:00F66F 904017            MOV      DPTR,#waitingForRoutedACK
B1:00F672 F0                MOVX     @DPTR,A
B1:00F673 12A44F            LCALL    RetransmitFail
B1:00F676         ?C0004?ZW_TXQ_PROTOCOL:
B1:00F676 22                RET      
----- FUNCTION ProtocolWaitACKTimeout (END) -------


----- FUNCTION ?L?COM0542 (BEGIN) -----
B1:00F677 FF                MOV      R7,A
B1:00F678 AEF0              MOV      R6,B
B1:00F67A 5407              ANL      A,#07H
B1:00F67C 6403              XRL      A,#03H
B1:00F67E 22                RET      
----- FUNCTION ?L?COM0542 (END) -------


----- FUNCTION ZCB_RetransmitDelay (BEGIN) -----
B1:00F67F 90402B            MOV      DPTR,#delayCountProtocol
B1:00F682 E0                MOVX     A,@DPTR
B1:00F683 6003              JZ       ?C0010?ZW_TXQ_PROTOCOL
B1:00F685 14                DEC      A
B1:00F686 F0                MOVX     @DPTR,A
B1:00F687 22                RET      
B1:00F688         ?C0010?ZW_TXQ_PROTOCOL:
B1:00F688 1287CF            LCALL    TransmitTimerStop
B1:00F68B A1E1              AJMP     ProtocolWaitACKTimeout
----- FUNCTION ZCB_RetransmitDelay (END) -------


----- FUNCTION _GetRepeaters (BEGIN) -----
B1:00F68D 9045E2            MOV      DPTR,#elem
B1:00F690 122572            LCALL    ?C?PSTXDATA
B1:00F693 9045E2            MOV      DPTR,#elem
B1:00F696 12BBEE            LCALL    ?L?COM02D9
B1:00F699 1285F5            LCALL    ?L?COM0004
B1:00F69C 30E717            JNB      ACC.7,?C0020?ZW_TXQ_PROTOCOL
B1:00F69F 540F              ANL      A,#0FH
B1:00F6A1 FF                MOV      R7,A
B1:00F6A2 BF0111            CJNE     R7,#01H,?C0020?ZW_TXQ_PROTOCOL
B1:00F6A5 9045E2            MOV      DPTR,#elem
B1:00F6A8 122552            LCALL    ?C?PLDXDATA
B1:00F6AB E9                MOV      A,R1
B1:00F6AC 24BC              ADD      A,#0BCH
B1:00F6AE 1285F5            LCALL    ?L?COM0004
B1:00F6B1 C4                SWAP     A
B1:00F6B2 540F              ANL      A,#0FH
B1:00F6B4 FF                MOV      R7,A
B1:00F6B5 22                RET      
B1:00F6B6         ?C0020?ZW_TXQ_PROTOCOL:
B1:00F6B6 7F00              MOV      R7,#00H
B1:00F6B8 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 468


----- FUNCTION _GetRepeaters (END) -------


----- FUNCTION ?L?COM0421 (BEGIN) -----
B1:00F6B9 D18D              ACALL    _GetRepeaters
B1:00F6BB 90401A            MOV      DPTR,#tx_status+02H
B1:00F6BE EF                MOV      A,R7
B1:00F6BF F0                MOVX     @DPTR,A
B1:00F6C0 E4                CLR      A
B1:00F6C1 C3                CLR      C
B1:00F6C2 9F                SUBB     A,R7
B1:00F6C3 22                RET      
----- FUNCTION ?L?COM0421 (END) -------


----- FUNCTION TxQueueInit (BEGIN) -----
;---- Variable 'bCount' assigned to Register 'R7' ----
B1:00F6C4 E4                CLR      A
B1:00F6C5 FF                MOV      R7,A
B1:00F6C6         ?C0001?ZW_TX_QUEUE:
B1:00F6C6 12833F            LCALL    ?L?COM00EC
B1:00F6C9 E4                CLR      A
B1:00F6CA F0                MOVX     @DPTR,A
B1:00F6CB 0F                INC      R7
B1:00F6CC EF                MOV      A,R7
B1:00F6CD B404F6            CJNE     A,#04H,?C0001?ZW_TX_QUEUE
B1:00F6D0         ?C0002?ZW_TX_QUEUE:
B1:00F6D0 E4                CLR      A
B1:00F6D1 9003B3            MOV      DPTR,#bCurrentTransmit
B1:00F6D4 F0                MOVX     @DPTR,A
B1:00F6D5 A3                INC      DPTR
B1:00F6D6 122552            LCALL    ?C?PLDXDATA
B1:00F6D9 02DD21            LJMP     _list_init
----- FUNCTION TxQueueInit (END) -------


----- FUNCTION _TxQueueEmptyEvent_Add (BEGIN) -----
;---- Variable 'EmptyEventCallback' assigned to Register 'R4/R5' ----
B1:00F6DC 900AC7            MOV      DPTR,#elm
B1:00F6DF 122572            LCALL    ?C?PSTXDATA
B1:00F6E2 AF05              MOV      R7,AR5
B1:00F6E4 125D51            LCALL    ?L?COM00B0
B1:00F6E7 EC                MOV      A,R4
B1:00F6E8 8FF0              MOV      B,R7
B1:00F6EA 1221E8            LCALL    ?C?ISTPTR
B1:00F6ED 900AC7            MOV      DPTR,#elm
B1:00F6F0 122552            LCALL    ?C?PLDXDATA
B1:00F6F3 9042BC            MOV      DPTR,#?_list_add?BYTE+03H
B1:00F6F6 D1FB              ACALL    ?L?COM03EA
B1:00F6F8 02DB84            LJMP     _list_add
----- FUNCTION _TxQueueEmptyEvent_Add (END) -------


----- FUNCTION ?L?COM03EA (BEGIN) -----
B1:00F6FB 122572            LCALL    ?C?PSTXDATA
B1:00F6FE         ?L?COM03EB:
B1:00F6FE 9003B4            MOV      DPTR,#txQueueEmptyEvent_list
B1:00F701 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03EA (END) -------


----- FUNCTION ?L?COM03BF (BEGIN) -----
B1:00F704 C4                SWAP     A
B1:00F705 540F              ANL      A,#0FH
B1:00F707 FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 469


B1:00F708 7C00              MOV      R4,#00H
B1:00F70A 22                RET      
----- FUNCTION ?L?COM03BF (END) -------


----- FUNCTION TxQueueIsEmpty (BEGIN) -----
;---- Variable 'bCount' assigned to Register 'R7' ----
B1:00F70B E4                CLR      A
B1:00F70C FF                MOV      R7,A
B1:00F70D         ?C0038?ZW_TX_QUEUE:
B1:00F70D 12833F            LCALL    ?L?COM00EC
B1:00F710 E0                MOVX     A,@DPTR
B1:00F711 6003              JZ       ?C0040?ZW_TX_QUEUE
B1:00F713 7F00              MOV      R7,#00H
B1:00F715 22                RET      
B1:00F716         ?C0040?ZW_TX_QUEUE:
B1:00F716 0F                INC      R7
B1:00F717 EF                MOV      A,R7
B1:00F718 B404F2            CJNE     A,#04H,?C0038?ZW_TX_QUEUE
B1:00F71B         ?C0039?ZW_TX_QUEUE:
B1:00F71B 7F01              MOV      R7,#01H
B1:00F71D 22                RET      
----- FUNCTION TxQueueIsEmpty (END) -------


----- FUNCTION TxQueueIsIdle (BEGIN) -----
;---- Variable 'bCount' assigned to Register 'R7' ----
B1:00F71E E4                CLR      A
B1:00F71F FF                MOV      R7,A
B1:00F720         ?C0043?ZW_TX_QUEUE:
B1:00F720 12833F            LCALL    ?L?COM00EC
B1:00F723 E0                MOVX     A,@DPTR
B1:00F724 54F0              ANL      A,#0F0H
B1:00F726 FE                MOV      R6,A
B1:00F727 BE4003            CJNE     R6,#040H,?C0045?ZW_TX_QUEUE
B1:00F72A 7F00              MOV      R7,#00H
B1:00F72C 22                RET      
B1:00F72D         ?C0045?ZW_TX_QUEUE:
B1:00F72D 0F                INC      R7
B1:00F72E EF                MOV      A,R7
B1:00F72F B404EE            CJNE     A,#04H,?C0043?ZW_TX_QUEUE
B1:00F732         ?C0044?ZW_TX_QUEUE:
B1:00F732 7F01              MOV      R7,#01H
B1:00F734 22                RET      
----- FUNCTION TxQueueIsIdle (END) -------


----- FUNCTION TxQueueWaitForIdle (BEGIN) -----
B1:00F735         ?C0055?ZW_TX_QUEUE:
B1:00F735 F11E              ACALL    TxQueueIsIdle
B1:00F737 EF                MOV      A,R7
B1:00F738 7005              JNZ      ?C0057?ZW_TX_QUEUE
B1:00F73A 1281F1            LCALL    TxQueueServiceTransmit
B1:00F73D 80F6              SJMP     ?C0055?ZW_TX_QUEUE
B1:00F73F         ?C0057?ZW_TX_QUEUE:
B1:00F73F 22                RET      
----- FUNCTION TxQueueWaitForIdle (END) -------


----- FUNCTION _list_tail (BEGIN) -----
B1:00F740 904485            MOV      DPTR,#list
B1:00F743 126ECE            LCALL    ?L?COM035B
B1:00F746 E9                MOV      A,R1
B1:00F747 4A                ORL      A,R2
B1:00F748 7004              JNZ      ?C0003?LIST
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 470


B1:00F74A FB                MOV      R3,A
B1:00F74B FA                MOV      R2,A
B1:00F74C F9                MOV      R1,A
B1:00F74D 22                RET      
B1:00F74E         ?C0003?LIST:
B1:00F74E 904485            MOV      DPTR,#list
B1:00F751 122552            LCALL    ?C?PLDXDATA
B1:00F754 122587            LCALL    ?C?PLDPTR
B1:00F757 8009              SJMP     ?C0020?LIST
B1:00F759         ?C0005?LIST:
B1:00F759 904488            MOV      DPTR,#l
B1:00F75C 12BAEA            LCALL    ?L?COM01C4
B1:00F75F 4A                ORL      A,R2
B1:00F760 6008              JZ       ?C0006?LIST
B1:00F762         
B1:00F762 904488            MOV      DPTR,#l
B1:00F765 122572            LCALL    ?C?PSTXDATA
B1:00F768 80EF              SJMP     ?C0005?LIST
B1:00F76A         ?C0006?LIST:
B1:00F76A 904488            MOV      DPTR,#l
B1:00F76D 022552            LJMP     ?C?PLDXDATA
----- FUNCTION _list_tail (END) -------


----- FUNCTION security_save_state (BEGIN) -----
B1:00F770 22                RET      
----- FUNCTION security_save_state (END) -------


----- FUNCTION _ZCB_timeout (BEGIN) -----
B1:00F771 9045E8            MOV      DPTR,#user
B1:00F774 122572            LCALL    ?C?PSTXDATA
B1:00F777 9045E8            MOV      DPTR,#user
B1:00F77A 122552            LCALL    ?C?PLDXDATA
B1:00F77D 9044D6            MOV      DPTR,#?_secure_learn_raiseTimeEvent?BYTE+03H
B1:00F780 122572            LCALL    ?C?PSTXDATA
B1:00F783 12B20D            LCALL    ?L?COM006D
B1:00F786 121CFA            LCALL    ?INTERBANK_TABLE?_secure_learn_raiseTimeEvent
B1:00F789 02EEC3            LJMP     runCycle
----- FUNCTION _ZCB_timeout (END) -------


----- FUNCTION secure_learnIfaceL_save_state (BEGIN) -----
B1:00F78C 22                RET      
----- FUNCTION secure_learnIfaceL_save_state (END) -------


----- FUNCTION secure_learnIfaceL_new_keys (BEGIN) -----
B1:00F78D 22                RET      
----- FUNCTION secure_learnIfaceL_new_keys (END) -------


----- FUNCTION get_net_scheme (BEGIN) -----
B1:00F78E 12B20D            LCALL    ?L?COM006D
B1:00F791 021D45            LJMP     ?INTERBANK_TABLE?_secure_learnIface_get_net_scheme
----- FUNCTION get_net_scheme (END) -------


----- FUNCTION ?L?COM040E (BEGIN) -----
B1:00F794 9009C7            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+06H
B1:00F797 F0                MOVX     @DPTR,A
B1:00F798 A3                INC      DPTR
B1:00F799 7481              MOV      A,#081H
B1:00F79B 22                RET      
----- FUNCTION ?L?COM040E (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 471




----- FUNCTION secure_learnIfaceL_set_inclusion_key (BEGIN) -----
B1:00F79C 7F80              MOV      R7,#080H
B1:00F79E 12AA71            LCALL    _keystore_network_key_clear
B1:00F7A1 021C64            LJMP     ?INTERBANK_TABLE?sec0_unpersist_netkey
----- FUNCTION secure_learnIfaceL_set_inclusion_key (END) -------


----- FUNCTION _security_add_begin (BEGIN) -----
B1:00F7A4 A23C              MOV      C,controller
B1:00F7A6 923C              MOV      controller,C
B1:00F7A8 22                RET      
----- FUNCTION _security_add_begin (END) -------


----- FUNCTION _secure_learnIfaceI_send_scheme_get (BEGIN) -----
B1:00F7A9 90432A            MOV      DPTR,#node
B1:00F7AC 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_send_scheme_get (END) -------


----- FUNCTION _secure_learnIfaceI_send_key (BEGIN) -----
B1:00F7AF 904332            MOV      DPTR,#node
B1:00F7B2 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_send_key (END) -------


----- FUNCTION _secure_learnIfaceI_send_scheme_inherit (BEGIN) -----
B1:00F7B5 90433A            MOV      DPTR,#node
B1:00F7B8 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_send_scheme_inherit (END) -------


----- FUNCTION secure_learnIfaceI_restore_key (BEGIN) -----
B1:00F7BB 22                RET      
----- FUNCTION secure_learnIfaceI_restore_key (END) -------


----- FUNCTION _secure_learnIfaceI_register_scheme (BEGIN) -----
B1:00F7BC 904342            MOV      DPTR,#node
B1:00F7BF 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION _secure_learnIfaceI_register_scheme (END) -------


----- FUNCTION _keystore_public_dsk_read (BEGIN) -----
B1:00F7C2 9045EE            MOV      DPTR,#buf
B1:00F7C5 F1FA              ACALL    ?L?COM02ED
B1:00F7C7 4006              JC       ?C0002?ZW_KEYSTORE
B1:00F7C9 121C41            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00F7CC BFFF0E            CJNE     R7,#0FFH,?C0001?ZW_KEYSTORE
B1:00F7CF         ?C0002?ZW_KEYSTORE:
B1:00F7CF 9045EE            MOV      DPTR,#buf
B1:00F7D2 F1F3              ACALL    ?L?COM041F
B1:00F7D4 9044C0            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B1:00F7D7 7410              MOV      A,#010H
B1:00F7D9 F0                MOVX     @DPTR,A
B1:00F7DA 021B97            LJMP     ?INTERBANK_TABLE?_MemoryGetBuffer
B1:00F7DD         ?C0001?ZW_KEYSTORE:
B1:00F7DD 9045EE            MOV      DPTR,#buf
B1:00F7E0 122552            LCALL    ?C?PLDXDATA
B1:00F7E3 7D10              MOV      R5,#010H
B1:00F7E5 7F23              MOV      R7,#023H
B1:00F7E7 021C32            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION _keystore_public_dsk_read (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 472




----- FUNCTION ?L?COM04C7 (BEGIN) -----
B1:00F7EA 90419A            MOV      DPTR,#cmdLength
B1:00F7ED E0                MOVX     A,@DPTR
B1:00F7EE FD                MOV      R5,A
B1:00F7EF A3                INC      DPTR
B1:00F7F0 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04C7 (END) -------


----- FUNCTION ?L?COM041F (BEGIN) -----
B1:00F7F3 7E12              MOV      R6,#HIGH s2_public_key
B1:00F7F5 7F34              MOV      R7,#LOW s2_public_key
B1:00F7F7 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM041F (END) -------


----- FUNCTION ?L?COM02ED (BEGIN) -----
B1:00F7FA 122572            LCALL    ?C?PSTXDATA
B1:00F7FD         ?L?COM02EE:
B1:00F7FD 121C41            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00F800 EF                MOV      A,R7
B1:00F801 C3                CLR      C
B1:00F802 9402              SUBB     A,#02H
B1:00F804 22                RET      
----- FUNCTION ?L?COM02ED (END) -------


----- FUNCTION _keystore_public_key_write (BEGIN) -----
B1:00F805 9045F7            MOV      DPTR,#buf
B1:00F808 122572            LCALL    ?C?PSTXDATA
B1:00F80B 9045F7            MOV      DPTR,#buf
B1:00F80E 12F7F3            LCALL    ?L?COM041F
B1:00F811 90441D            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B1:00F814 12DF6B            LCALL    ?L?COM00A8
B1:00F817 021B9C            LJMP     ?INTERBANK_TABLE?_ZW_MemoryPutBuffer
----- FUNCTION _keystore_public_key_write (END) -------


----- FUNCTION _keystore_public_key_read (BEGIN) -----
B1:00F81A 9045F1            MOV      DPTR,#buf
B1:00F81D 12F7FA            LCALL    ?L?COM02ED
B1:00F820 4006              JC       ?C0006?ZW_KEYSTORE
B1:00F822 121C41            LCALL    ?INTERBANK_TABLE?ZW_GetNVRRevision
B1:00F825 BFFF13            CJNE     R7,#0FFH,?C0005?ZW_KEYSTORE
B1:00F828         ?C0006?ZW_KEYSTORE:
B1:00F828 7E12              MOV      R6,#HIGH s2_public_key
B1:00F82A 7F34              MOV      R7,#LOW s2_public_key
B1:00F82C 9045F1            MOV      DPTR,#buf
B1:00F82F 122552            LCALL    ?C?PLDXDATA
B1:00F832 9044C0            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B1:00F835 7420              MOV      A,#020H
B1:00F837 F0                MOVX     @DPTR,A
B1:00F838 021B97            LJMP     ?INTERBANK_TABLE?_MemoryGetBuffer
B1:00F83B         ?C0005?ZW_KEYSTORE:
B1:00F83B 9045F1            MOV      DPTR,#buf
B1:00F83E 122552            LCALL    ?C?PLDXDATA
B1:00F841 7D20              MOV      R5,#020H
B1:00F843 7F23              MOV      R7,#023H
B1:00F845 021C32            LJMP     ?INTERBANK_TABLE?_ZW_NVRGetValue
----- FUNCTION _keystore_public_key_read (END) -------


----- FUNCTION _ZW_SetSecurityS0NetworkKey (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 473


;---- Variable 'network_key' assigned to Register 'R1/R2/R3' ----
B1:00F848 7F80              MOV      R7,#080H
B1:00F84A 12AAAD            LCALL    _keystore_network_key_write
B1:00F84D 02EB34            LJMP     security_init
----- FUNCTION _ZW_SetSecurityS0NetworkKey (END) -------


----- FUNCTION _convert_to_octet_string (BEGIN) -----
B1:00F850 9042C4            MOV      DPTR,#Q
B1:00F853 122572            LCALL    ?C?PSTXDATA
;---- Variable 'text_to_encrypt_len' assigned to Register 'R4/R5' ----
B1:00F856 AD07              MOV      R5,AR7
B1:00F858 AC06              MOV      R4,AR6
B1:00F85A 9042C9            MOV      DPTR,#bitmask
B1:00F85D 74FF              MOV      A,#0FFH
B1:00F85F F0                MOVX     @DPTR,A
B1:00F860 A3                INC      DPTR
B1:00F861 E4                CLR      A
B1:00F862 F0                MOVX     @DPTR,A
B1:00F863 9042C8            MOV      DPTR,#i
B1:00F866 F0                MOVX     @DPTR,A
B1:00F867         ?C0001?CCM:
B1:00F867 9042C7            MOV      DPTR,#q
B1:00F86A E0                MOVX     A,@DPTR
B1:00F86B 24FE              ADD      A,#0FEH
B1:00F86D FF                MOV      R7,A
B1:00F86E A3                INC      DPTR
B1:00F86F E0                MOVX     A,@DPTR
B1:00F870 FE                MOV      R6,A
B1:00F871 C3                CLR      C
B1:00F872 9F                SUBB     A,R7
B1:00F873 5012              JNC      ?C0002?CCM
B1:00F875 9042C4            MOV      DPTR,#Q
B1:00F878 127031            LCALL    ?L?COM04E5
B1:00F87B E4                CLR      A
B1:00F87C 12204D            LCALL    ?C?CSTOPTR
B1:00F87F 9042C8            MOV      DPTR,#i
B1:00F882 E0                MOVX     A,@DPTR
B1:00F883 04                INC      A
B1:00F884 F0                MOVX     @DPTR,A
B1:00F885 80E0              SJMP     ?C0001?CCM
B1:00F887         ?C0002?CCM:
B1:00F887 9042C9            MOV      DPTR,#bitmask
B1:00F88A E0                MOVX     A,@DPTR
B1:00F88B 5C                ANL      A,R4
B1:00F88C FE                MOV      R6,A
B1:00F88D EE                MOV      A,R6
B1:00F88E FF                MOV      R7,A
B1:00F88F 9042C4            MOV      DPTR,#Q
B1:00F892 122552            LCALL    ?C?PLDXDATA
B1:00F895 11AA              ACALL    ?L?COM0463
B1:00F897 EF                MOV      A,R7
B1:00F898 12204D            LCALL    ?C?CSTOPTR
B1:00F89B 9042C9            MOV      DPTR,#bitmask
B1:00F89E 126FF8            LCALL    ?L?COM0498
B1:00F8A1 5D                ANL      A,R5
B1:00F8A2 FF                MOV      R7,A
B1:00F8A3 11AA              ACALL    ?L?COM0463
B1:00F8A5 A3                INC      DPTR
B1:00F8A6 EF                MOV      A,R7
B1:00F8A7 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _convert_to_octet_string (END) -------


----- FUNCTION ?L?COM0463 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 474


B1:00F8AA 9042C8            MOV      DPTR,#i
B1:00F8AD E0                MOVX     A,@DPTR
B1:00F8AE F582              MOV      DPL,A
B1:00F8B0 758300            MOV      DPH,#00H
B1:00F8B3 22                RET      
----- FUNCTION ?L?COM0463 (END) -------


----- FUNCTION _get_q_n_t (BEGIN) -----
;---- Variable 'q_out' assigned to Register 'R1/R2/R3' ----
B1:00F8B4 904607            MOV      DPTR,#q
B1:00F8B7 E0                MOVX     A,@DPTR
B1:00F8B8 12203B            LCALL    ?C?CSTPTR
B1:00F8BB 904606            MOV      DPTR,#n
B1:00F8BE E0                MOVX     A,@DPTR
B1:00F8BF FF                MOV      R7,A
B1:00F8C0 9042CE            MOV      DPTR,#n_out
B1:00F8C3 1256DF            LCALL    ?L?COM0125
B1:00F8C6 904608            MOV      DPTR,#t
B1:00F8C9 E0                MOVX     A,@DPTR
B1:00F8CA FF                MOV      R7,A
B1:00F8CB 9042D1            MOV      DPTR,#t_out
B1:00F8CE 122552            LCALL    ?C?PLDXDATA
B1:00F8D1 EF                MOV      A,R7
B1:00F8D2 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _get_q_n_t (END) -------


----- FUNCTION _get_q (BEGIN) -----
;---- Variable 'q_out' assigned to Register 'R1/R2/R3' ----
B1:00F8D5 904607            MOV      DPTR,#q
B1:00F8D8 E0                MOVX     A,@DPTR
B1:00F8D9 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _get_q (END) -------


----- FUNCTION _aes_cmac_verify (BEGIN) -----
;---- Variable 'key' assigned to Register 'R1/R2/R3' ----
B1:00F8DC C003              PUSH     AR3
B1:00F8DE C002              PUSH     AR2
B1:00F8E0 C001              PUSH     AR1
B1:00F8E2 903F77            MOV      DPTR,#message
B1:00F8E5 122552            LCALL    ?C?PLDXDATA
B1:00F8E8 3129              ACALL    ?L?COM047B
B1:00F8EA 903F7A            MOV      DPTR,#message_length
B1:00F8ED E0                MOVX     A,@DPTR
B1:00F8EE FF                MOV      R7,A
B1:00F8EF A3                INC      DPTR
B1:00F8F0 E0                MOVX     A,@DPTR
B1:00F8F1 9038DF            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00F8F4 3136              ACALL    ?L?COM00D4
B1:00F8F6 7A3F              MOV      R2,#HIGH calculated_mac
B1:00F8F8 797F              MOV      R1,#LOW calculated_mac
B1:00F8FA A3                INC      DPTR
B1:00F8FB 122572            LCALL    ?C?PSTXDATA
B1:00F8FE D001              POP      AR1
B1:00F900 D002              POP      AR2
B1:00F902 D003              POP      AR3
B1:00F904 12DD74            LCALL    _aes_cmac_calculate
;---- Variable 'count' assigned to Register 'R7' ----
B1:00F907 E4                CLR      A
B1:00F908 FF                MOV      R7,A
B1:00F909         ?C0040?AES_CMAC:
B1:00F909 903F7C            MOV      DPTR,#mac
B1:00F90C 12DD3A            LCALL    ?L?COM015C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 475


B1:00F90F FE                MOV      R6,A
B1:00F910 747F              MOV      A,#LOW calculated_mac
B1:00F912 2F                ADD      A,R7
B1:00F913 F582              MOV      DPL,A
B1:00F915 E4                CLR      A
B1:00F916 343F              ADDC     A,#HIGH calculated_mac
B1:00F918 F583              MOV      DPH,A
B1:00F91A E0                MOVX     A,@DPTR
B1:00F91B 6E                XRL      A,R6
B1:00F91C 6003              JZ       ?C0042?AES_CMAC
B1:00F91E 7F01              MOV      R7,#01H
B1:00F920 22                RET      
B1:00F921         ?C0042?AES_CMAC:
B1:00F921 0F                INC      R7
B1:00F922 EF                MOV      A,R7
B1:00F923 B410E3            CJNE     A,#010H,?C0040?AES_CMAC
B1:00F926         ?C0041?AES_CMAC:
B1:00F926 7F00              MOV      R7,#00H
B1:00F928 22                RET      
----- FUNCTION _aes_cmac_verify (END) -------


----- FUNCTION ?L?COM047B (BEGIN) -----
B1:00F929 9038DC            MOV      DPTR,#?_aes_cmac_calculate?BYTE+03H
B1:00F92C 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM047B (END) -------


----- FUNCTION ?L?COM00D3 (BEGIN) -----
B1:00F92F E0                MOVX     A,@DPTR
B1:00F930 FF                MOV      R7,A
B1:00F931 A3                INC      DPTR
B1:00F932 E0                MOVX     A,@DPTR
B1:00F933 903DF4            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+05H
B1:00F936         ?L?COM00D4:
B1:00F936 CF                XCH      A,R7
B1:00F937         ?L?COM00D5:
B1:00F937 F0                MOVX     @DPTR,A
B1:00F938 A3                INC      DPTR
B1:00F939 EF                MOV      A,R7
B1:00F93A F0                MOVX     @DPTR,A
B1:00F93B 7B01              MOV      R3,#01H
B1:00F93D 22                RET      
----- FUNCTION ?L?COM00D3 (END) -------


----- FUNCTION _tempkey_extract (BEGIN) -----
B1:00F93E 903860            MOV      DPTR,#ecdh_share_secret
B1:00F941 122572            LCALL    ?C?PSTXDATA
B1:00F944 78C9              MOV      R0,#LOW constant_prk
B1:00F946 7C38              MOV      R4,#HIGH constant_prk
B1:00F948 7D01              MOV      R5,#01H
B1:00F94A 7BFF              MOV      R3,#0FFH
B1:00F94C 7A2F              MOV      R2,#HIGH _?ix1001
B1:00F94E 79A7              MOV      R1,#LOW _?ix1001
B1:00F950 12DF7E            LCALL    ?L?COM0086
B1:00F953 7869              MOV      R0,#LOW temp
B1:00F955 7C38              MOV      R4,#HIGH temp
B1:00F957 7D01              MOV      R5,#01H
B1:00F959 903860            MOV      DPTR,#ecdh_share_secret
B1:00F95C 122552            LCALL    ?C?PLDXDATA
B1:00F95F 12E689            LCALL    ?L?COM032A
B1:00F962 7889              MOV      R0,#LOW temp+020H
B1:00F964 7C38              MOV      R4,#HIGH temp+020H
B1:00F966 7D01              MOV      R5,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 476


B1:00F968 903863            MOV      DPTR,#auth_tag
B1:00F96B 122552            LCALL    ?C?PLDXDATA
B1:00F96E 7E00              MOV      R6,#00H
B1:00F970 7F40              MOV      R7,#040H
B1:00F972 121F56            LCALL    ?C?COPY
B1:00F975 7B01              MOV      R3,#01H
B1:00F977 7A38              MOV      R2,#HIGH temp
B1:00F979 7969              MOV      R1,#LOW temp
B1:00F97B 3129              ACALL    ?L?COM047B
B1:00F97D 9038DF            MOV      DPTR,#?_aes_cmac_calculate?BYTE+06H
B1:00F980 E4                CLR      A
B1:00F981 F0                MOVX     @DPTR,A
B1:00F982 A3                INC      DPTR
B1:00F983 7460              MOV      A,#060H
B1:00F985 F0                MOVX     @DPTR,A
B1:00F986 903866            MOV      DPTR,#pseudo_random_keymat_output
B1:00F989 122552            LCALL    ?C?PLDXDATA
B1:00F98C 9038E1            MOV      DPTR,#?_aes_cmac_calculate?BYTE+08H
B1:00F98F 122572            LCALL    ?C?PSTXDATA
B1:00F992 7B01              MOV      R3,#01H
B1:00F994 7A38              MOV      R2,#HIGH constant_prk
B1:00F996 79C9              MOV      R1,#LOW constant_prk
B1:00F998 02DD74            LJMP     _aes_cmac_calculate
----- FUNCTION _tempkey_extract (END) -------


----- FUNCTION ?L?COM0402 (BEGIN) -----
B1:00F99B F9                MOV      R1,A
B1:00F99C E4                CLR      A
B1:00F99D 3A                ADDC     A,R2
B1:00F99E FA                MOV      R2,A
B1:00F99F 7D10              MOV      R5,#010H
B1:00F9A1 7C00              MOV      R4,#00H
----- FUNCTION _AES_CTR_DRBG_Increment (BEGIN) -----
B1:00F9A3 904609            MOV      DPTR,#__data
B1:00F9A6 122572            LCALL    ?C?PSTXDATA
;---- Variable 'size' assigned to Register 'R4/R5' ----
B1:00F9A9         ?C0001?CTR_DRBG:
B1:00F9A9 ED                MOV      A,R5
B1:00F9AA 1D                DEC      R5
B1:00F9AB AE04              MOV      R6,AR4
B1:00F9AD 7001              JNZ      ?C0022?CTR_DRBG
B1:00F9AF 1C                DEC      R4
B1:00F9B0         ?C0022?CTR_DRBG:
B1:00F9B0 4E                ORL      A,R6
B1:00F9B1 6015              JZ       ?C0004?CTR_DRBG
B1:00F9B3 904609            MOV      DPTR,#__data
B1:00F9B6 126F8C            LCALL    ?L?COM0416
B1:00F9B9 7401              MOV      A,#01H
B1:00F9BB 122008            LCALL    ?C?CILDOPTR
B1:00F9BE 8D82              MOV      DPL,R5
B1:00F9C0 8C83              MOV      DPH,R4
B1:00F9C2 121FB9            LCALL    ?C?CLDOPTR
B1:00F9C5 60E2              JZ       ?C0001?CTR_DRBG
B1:00F9C7 22                RET      
B1:00F9C8         ?C0004?CTR_DRBG:
B1:00F9C8 22                RET      
----- FUNCTION _AES_CTR_DRBG_Increment (END) -------


----- FUNCTION _AES_CTR_DRBG_Reseed (BEGIN) -----
;---- Variable 'ctx' assigned to Register 'R1/R2/R3' ----
B1:00F9C9 C003              PUSH     AR3
B1:00F9CB C002              PUSH     AR2
B1:00F9CD C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 477


B1:00F9CF 9044A6            MOV      DPTR,#seed
B1:00F9D2 122552            LCALL    ?C?PLDXDATA
B1:00F9D5 903E1D            MOV      DPTR,#?_AES_CTR_DRBG_Update?BYTE+03H
B1:00F9D8 122572            LCALL    ?C?PSTXDATA
B1:00F9DB D001              POP      AR1
B1:00F9DD D002              POP      AR2
B1:00F9DF D003              POP      AR3
B1:00F9E1 02E019            LJMP     _AES_CTR_DRBG_Update
----- FUNCTION _AES_CTR_DRBG_Reseed (END) -------


----- FUNCTION _AES_CTR_DRBG_Instantiate (BEGIN) -----
B1:00F9E4 9042DD            MOV      DPTR,#ctx
B1:00F9E7 122572            LCALL    ?C?PSTXDATA
;---- Variable 'i' assigned to Register 'R7' ----
B1:00F9EA E4                CLR      A
B1:00F9EB FF                MOV      R7,A
B1:00F9EC         ?C0013?CTR_DRBG:
B1:00F9EC 9042E0            MOV      DPTR,#entropy
B1:00F9EF 122552            LCALL    ?C?PLDXDATA
B1:00F9F2 E9                MOV      A,R1
B1:00F9F3 2F                ADD      A,R7
B1:00F9F4 F9                MOV      R1,A
B1:00F9F5 E4                CLR      A
B1:00F9F6 3A                ADDC     A,R2
B1:00F9F7 FA                MOV      R2,A
B1:00F9F8 C003              PUSH     AR3
B1:00F9FA C002              PUSH     AR2
B1:00F9FC C001              PUSH     AR1
B1:00F9FE 121F7C            LCALL    ?C?CLDPTR
B1:00FA01 FE                MOV      R6,A
B1:00FA02 9042E3            MOV      DPTR,#personal
B1:00FA05 12DD3A            LCALL    ?L?COM015C
B1:00FA08 6E                XRL      A,R6
B1:00FA09 D001              POP      AR1
B1:00FA0B D002              POP      AR2
B1:00FA0D D003              POP      AR3
B1:00FA0F 12203B            LCALL    ?C?CSTPTR
B1:00FA12 0F                INC      R7
B1:00FA13 EF                MOV      A,R7
B1:00FA14 B420D5            CJNE     A,#020H,?C0013?CTR_DRBG
B1:00FA17         ?C0014?CTR_DRBG:
B1:00FA17 5149              ACALL    ?L?COM04B7
B1:00FA19 7174              ACALL    ?L?COM02DA
B1:00FA1B FA                MOV      R2,A
B1:00FA1C 1228E0            LCALL    ?C?MEMSET
B1:00FA1F 5149              ACALL    ?L?COM04B7
B1:00FA21 12E012            LCALL    ?L?COM00B3
B1:00FA24 F9                MOV      R1,A
B1:00FA25 E4                CLR      A
B1:00FA26 3A                ADDC     A,R2
B1:00FA27 FA                MOV      R2,A
B1:00FA28 1228E0            LCALL    ?C?MEMSET
B1:00FA2B 9042DD            MOV      DPTR,#ctx
B1:00FA2E 122552            LCALL    ?C?PLDXDATA
B1:00FA31 E4                CLR      A
B1:00FA32 12203B            LCALL    ?C?CSTPTR
B1:00FA35 9042E0            MOV      DPTR,#entropy
B1:00FA38 122552            LCALL    ?C?PLDXDATA
B1:00FA3B 9044A6            MOV      DPTR,#?_AES_CTR_DRBG_Reseed?BYTE+03H
B1:00FA3E 122572            LCALL    ?C?PSTXDATA
B1:00FA41 9042DD            MOV      DPTR,#ctx
B1:00FA44 122552            LCALL    ?C?PLDXDATA
B1:00FA47 8080              SJMP     _AES_CTR_DRBG_Reseed
----- FUNCTION _AES_CTR_DRBG_Instantiate (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 478




----- FUNCTION ?L?COM04B7 (BEGIN) -----
B1:00FA49 7E00              MOV      R6,#00H
B1:00FA4B 7F10              MOV      R7,#010H
B1:00FA4D 7D00              MOV      R5,#00H
B1:00FA4F 9042DD            MOV      DPTR,#ctx
B1:00FA52 22                RET      
----- FUNCTION ?L?COM04B7 (END) -------


----- FUNCTION _next_nonce_instantiate (BEGIN) -----
B1:00FA53 903947            MOV      DPTR,#ctx
B1:00FA56 122572            LCALL    ?C?PSTXDATA
B1:00FA59 7853              MOV      R0,#LOW constant_nonce
B1:00FA5B 7C39              MOV      R4,#HIGH constant_nonce
B1:00FA5D 7D01              MOV      R5,#01H
B1:00FA5F 7BFF              MOV      R3,#0FFH
B1:00FA61 7A30              MOV      R2,#HIGH _?ix1001
B1:00FA63 7922              MOV      R1,#LOW _?ix1001
B1:00FA65 12DF7E            LCALL    ?L?COM0086
B1:00FA68 7863              MOV      R0,#LOW temp
B1:00FA6A 7C39              MOV      R4,#HIGH temp
B1:00FA6C 90394A            MOV      DPTR,#ei_sender
B1:00FA6F 12DF79            LCALL    ?L?COM0084
B1:00FA72 7873              MOV      R0,#LOW temp+010H
B1:00FA74 7C39              MOV      R4,#HIGH temp+010H
B1:00FA76 7D01              MOV      R5,#01H
B1:00FA78 90394D            MOV      DPTR,#ei_receiver
B1:00FA7B 12DF7B            LCALL    ?L?COM0085
B1:00FA7E 7B01              MOV      R3,#01H
B1:00FA80 7A39              MOV      R2,#HIGH temp
B1:00FA82 7963              MOV      R1,#LOW temp
B1:00FA84 12DF62            LCALL    ?L?COM00A7
B1:00FA87 7A39              MOV      R2,#HIGH X
B1:00FA89 7983              MOV      R1,#LOW X
B1:00FA8B A3                INC      DPTR
B1:00FA8C 122572            LCALL    ?C?PSTXDATA
B1:00FA8F 7A39              MOV      R2,#HIGH constant_nonce
B1:00FA91 7953              MOV      R1,#LOW constant_nonce
B1:00FA93 12DD74            LCALL    _aes_cmac_calculate
B1:00FA96 903A81            MOV      DPTR,#?_ckdf_nonce0_expand?BYTE+03H
B1:00FA99 51BA              ACALL    ?L?COM04B3
B1:00FA9B 7A39              MOV      R2,#HIGH X
B1:00FA9D 7983              MOV      R1,#LOW X
B1:00FA9F 51CC              ACALL    _ckdf_nonce0_expand
B1:00FAA1 9042E0            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+03H
B1:00FAA4 51BA              ACALL    ?L?COM04B3
B1:00FAA6 903950            MOV      DPTR,#k_nonce
B1:00FAA9 122552            LCALL    ?C?PLDXDATA
B1:00FAAC 9042E3            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+06H
B1:00FAAF 122572            LCALL    ?C?PSTXDATA
B1:00FAB2 903947            MOV      DPTR,#ctx
B1:00FAB5 122552            LCALL    ?C?PLDXDATA
B1:00FAB8 21E4              AJMP     _AES_CTR_DRBG_Instantiate
----- FUNCTION _next_nonce_instantiate (END) -------


----- FUNCTION ?L?COM04B3 (BEGIN) -----
B1:00FABA 7B01              MOV      R3,#01H
B1:00FABC 7A39              MOV      R2,#HIGH mei
B1:00FABE 7993              MOV      R1,#LOW mei
B1:00FAC0 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04B3 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 479



----- FUNCTION ?L?COM04CA (BEGIN) -----
B1:00FAC3 7B01              MOV      R3,#01H
B1:00FAC5 7D04              MOV      R5,#04H
B1:00FAC7 7F7F              MOV      R7,#07FH
B1:00FAC9 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM04CA (END) -------


----- FUNCTION _ckdf_nonce0_expand (BEGIN) -----
B1:00FACC 903A7E            MOV      DPTR,#prk
B1:00FACF 122572            LCALL    ?C?PSTXDATA
B1:00FAD2 7884              MOV      R0,#LOW constant_ei
B1:00FAD4 7C3A              MOV      R4,#HIGH constant_ei
B1:00FAD6 7D01              MOV      R5,#01H
B1:00FAD8 7BFF              MOV      R3,#0FFH
B1:00FADA 7A30              MOV      R2,#HIGH _?ix1000
B1:00FADC 7913              MOV      R1,#LOW _?ix1000
B1:00FADE 12DF51            LCALL    ?L?COM0111
B1:00FAE1 7A3A              MOV      R2,#HIGH constant_ei
B1:00FAE3 7984              MOV      R1,#LOW constant_ei
B1:00FAE5 7F0F              MOV      R7,#0FH
B1:00FAE7 714D              ACALL    ?L?COM004F
B1:00FAE9 E4                CLR      A
B1:00FAEA 903AA2            MOV      DPTR,#t0+0FH
B1:00FAED F0                MOVX     @DPTR,A
B1:00FAEE 7167              ACALL    ?L?COM03B5
B1:00FAF0 FE                MOV      R6,A
B1:00FAF1 7F0F              MOV      R7,#0FH
B1:00FAF3 121F56            LCALL    ?C?COPY
B1:00FAF6 903AB2            MOV      DPTR,#t0+01FH
B1:00FAF9 7401              MOV      A,#01H
B1:00FAFB F0                MOVX     @DPTR,A
B1:00FAFC FB                MOV      R3,A
B1:00FAFD 7A3A              MOV      R2,#HIGH t0
B1:00FAFF 7993              MOV      R1,#LOW t0
B1:00FB01 12DF62            LCALL    ?L?COM00A7
B1:00FB04 7A3A              MOV      R2,#HIGH t1
B1:00FB06 79B3              MOV      R1,#LOW t1
B1:00FB08 715A              ACALL    ?L?COM038A
B1:00FB0A 7A3A              MOV      R2,#HIGH t1
B1:00FB0C 79B3              MOV      R1,#LOW t1
B1:00FB0E 7F10              MOV      R7,#010H
B1:00FB10 714D              ACALL    ?L?COM004F
B1:00FB12 7167              ACALL    ?L?COM03B5
B1:00FB14 12DF51            LCALL    ?L?COM0111
B1:00FB17 903AB2            MOV      DPTR,#t0+01FH
B1:00FB1A 7402              MOV      A,#02H
B1:00FB1C F0                MOVX     @DPTR,A
B1:00FB1D 7B01              MOV      R3,#01H
B1:00FB1F 7A3A              MOV      R2,#HIGH t0
B1:00FB21 7993              MOV      R1,#LOW t0
B1:00FB23 12DF62            LCALL    ?L?COM00A7
B1:00FB26 7A3A              MOV      R2,#HIGH t2
B1:00FB28 79C3              MOV      R1,#LOW t2
B1:00FB2A 715A              ACALL    ?L?COM038A
B1:00FB2C 903A81            MOV      DPTR,#mei
B1:00FB2F 12E5B3            LCALL    ?L?COM0104
B1:00FB32 7A3A              MOV      R2,#HIGH t1
B1:00FB34 79B3              MOV      R1,#LOW t1
B1:00FB36 12DF7E            LCALL    ?L?COM0086
B1:00FB39 903A81            MOV      DPTR,#mei
B1:00FB3C 12CDE1            LCALL    ?L?COM0083
B1:00FB3F 12E323            LCALL    ?L?COM01F6
B1:00FB42 7A3A              MOV      R2,#HIGH t2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 480


B1:00FB44 79C3              MOV      R1,#LOW t2
B1:00FB46 7E00              MOV      R6,#00H
B1:00FB48 7F10              MOV      R7,#010H
B1:00FB4A 021F56            LJMP     ?C?COPY
----- FUNCTION _ckdf_nonce0_expand (END) -------


----- FUNCTION ?L?COM004F (BEGIN) -----
B1:00FB4D 7893              MOV      R0,#LOW t0
B1:00FB4F 7C3A              MOV      R4,#HIGH t0
B1:00FB51 7D01              MOV      R5,#01H
B1:00FB53 7B01              MOV      R3,#01H
B1:00FB55 7E00              MOV      R6,#00H
B1:00FB57 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM004F (END) -------


----- FUNCTION ?L?COM038A (BEGIN) -----
B1:00FB5A A3                INC      DPTR
B1:00FB5B 122572            LCALL    ?C?PSTXDATA
B1:00FB5E 903A7E            MOV      DPTR,#prk
B1:00FB61 122552            LCALL    ?C?PLDXDATA
B1:00FB64 02DD74            LJMP     _aes_cmac_calculate
----- FUNCTION ?L?COM038A (END) -------


----- FUNCTION ?L?COM03B5 (BEGIN) -----
B1:00FB67 78A3              MOV      R0,#LOW t0+010H
B1:00FB69 7C3A              MOV      R4,#HIGH t0+010H
B1:00FB6B 7D01              MOV      R5,#01H
B1:00FB6D 7B01              MOV      R3,#01H
B1:00FB6F 7A3A              MOV      R2,#HIGH constant_ei
B1:00FB71 7984              MOV      R1,#LOW constant_ei
B1:00FB73 22                RET      
----- FUNCTION ?L?COM03B5 (END) -------


----- FUNCTION ?L?COM02DA (BEGIN) -----
B1:00FB74 122552            LCALL    ?C?PLDXDATA
B1:00FB77 E9                MOV      A,R1
B1:00FB78 2411              ADD      A,#011H
B1:00FB7A F9                MOV      R1,A
B1:00FB7B E4                CLR      A
B1:00FB7C 3A                ADDC     A,R2
B1:00FB7D 22                RET      
----- FUNCTION ?L?COM02DA (END) -------


----- FUNCTION _networkkey_expand (BEGIN) -----
B1:00FB7E 903F8F            MOV      DPTR,#network_key
B1:00FB81 122572            LCALL    ?C?PSTXDATA
B1:00FB84 789B              MOV      R0,#LOW constant_nk
B1:00FB86 7C3F              MOV      R4,#HIGH constant_nk
B1:00FB88 7D01              MOV      R5,#01H
B1:00FB8A 7BFF              MOV      R3,#0FFH
B1:00FB8C 7A2F              MOV      R2,#HIGH _?ix1000
B1:00FB8E 7998              MOV      R1,#LOW _?ix1000
B1:00FB90 12DF51            LCALL    ?L?COM0111
B1:00FB93 7A3F              MOV      R2,#HIGH constant_nk
B1:00FB95 799B              MOV      R1,#LOW constant_nk
B1:00FB97 71E4              ACALL    ?L?COM050C
B1:00FB99 903F92            MOV      DPTR,#ccm_key
B1:00FB9C 71FE              ACALL    ?L?COM04B6
B1:00FB9E 903F95            MOV      DPTR,#nonce_pstring
B1:00FBA1 71F5              ACALL    ?L?COM04B5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 481


B1:00FBA3 903F98            MOV      DPTR,#mpan_key
B1:00FBA6 71EC              ACALL    ?L?COM04B4
B1:00FBA8 903F8F            MOV      DPTR,#network_key
B1:00FBAB 122552            LCALL    ?C?PLDXDATA
B1:00FBAE 02DECC            LJMP     _generic_expand
----- FUNCTION _networkkey_expand (END) -------


----- FUNCTION _tempkey_expand (BEGIN) -----
B1:00FBB1 903FAA            MOV      DPTR,#prk
B1:00FBB4 122572            LCALL    ?C?PSTXDATA
B1:00FBB7 78B6              MOV      R0,#LOW constant_TE
B1:00FBB9 7C3F              MOV      R4,#HIGH constant_TE
B1:00FBBB 7D01              MOV      R5,#01H
B1:00FBBD 7BFF              MOV      R3,#0FFH
B1:00FBBF 7A2F              MOV      R2,#HIGH _?ix1002
B1:00FBC1 79B7              MOV      R1,#LOW _?ix1002
B1:00FBC3 12DF51            LCALL    ?L?COM0111
B1:00FBC6 7A3F              MOV      R2,#HIGH constant_TE
B1:00FBC8 79B6              MOV      R1,#LOW constant_TE
B1:00FBCA 71E4              ACALL    ?L?COM050C
B1:00FBCC 903FAD            MOV      DPTR,#temp_ccm_key
B1:00FBCF 71FE              ACALL    ?L?COM04B6
B1:00FBD1 903FB0            MOV      DPTR,#temp_nonce_pstring
B1:00FBD4 71F5              ACALL    ?L?COM04B5
B1:00FBD6 903FB3            MOV      DPTR,#temp_mpan_key
B1:00FBD9 71EC              ACALL    ?L?COM04B4
B1:00FBDB 903FAA            MOV      DPTR,#prk
B1:00FBDE 122552            LCALL    ?C?PLDXDATA
B1:00FBE1 02DECC            LJMP     _generic_expand
----- FUNCTION _tempkey_expand (END) -------


----- FUNCTION ?L?COM050C (BEGIN) -----
B1:00FBE4 7B01              MOV      R3,#01H
B1:00FBE6 903DC3            MOV      DPTR,#?_generic_expand?BYTE+03H
B1:00FBE9 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM050C (END) -------


----- FUNCTION ?L?COM04B4 (BEGIN) -----
B1:00FBEC 122552            LCALL    ?C?PLDXDATA
B1:00FBEF 903DCC            MOV      DPTR,#?_generic_expand?BYTE+0CH
B1:00FBF2 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04B4 (END) -------


----- FUNCTION ?L?COM04B5 (BEGIN) -----
B1:00FBF5 122552            LCALL    ?C?PLDXDATA
B1:00FBF8 903DC9            MOV      DPTR,#?_generic_expand?BYTE+09H
B1:00FBFB 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04B5 (END) -------


----- FUNCTION ?L?COM04B6 (BEGIN) -----
B1:00FBFE 122552            LCALL    ?C?PLDXDATA
B1:00FC01 903DC6            MOV      DPTR,#?_generic_expand?BYTE+06H
B1:00FC04 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04B6 (END) -------


----- FUNCTION _next_nonce_generate (BEGIN) -----
;---- Variable 'ctx' assigned to Register 'R1/R2/R3' ----
B1:00FC07 C003              PUSH     AR3
B1:00FC09 C002              PUSH     AR2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 482


B1:00FC0B C001              PUSH     AR1
B1:00FC0D 9044AC            MOV      DPTR,#rand
B1:00FC10 122552            LCALL    ?C?PLDXDATA
B1:00FC13 903E72            MOV      DPTR,#?_AES_CTR_DRBG_Generate?BYTE+03H
B1:00FC16 122572            LCALL    ?C?PSTXDATA
B1:00FC19 D001              POP      AR1
B1:00FC1B D002              POP      AR2
B1:00FC1D D003              POP      AR3
B1:00FC1F 12E0E7            LCALL    _AES_CTR_DRBG_Generate
B1:00FC22 7E00              MOV      R6,#00H
B1:00FC24 7F01              MOV      R7,#01H
B1:00FC26 22                RET      
----- FUNCTION _next_nonce_generate (END) -------


----- FUNCTION _crypto_scalarmult_curve25519_base (BEGIN) -----
;---- Variable 'q' assigned to Register 'R1/R2/R3' ----
B1:00FC27 C002              PUSH     AR2
B1:00FC29 C001              PUSH     AR1
B1:00FC2B 9044B2            MOV      DPTR,#n
B1:00FC2E 9149              ACALL    ?L?COM0545
B1:00FC30 9039B6            MOV      DPTR,#?_crypto_scalarmult_curve25519?BYTE+03H
B1:00FC33 12E690            LCALL    ?L?COM0147
B1:00FC36 A3                INC      DPTR
B1:00FC37 7401              MOV      A,#01H
B1:00FC39 F0                MOVX     @DPTR,A
B1:00FC3A A3                INC      DPTR
B1:00FC3B 743C              MOV      A,#HIGH base
B1:00FC3D F0                MOVX     @DPTR,A
B1:00FC3E A3                INC      DPTR
B1:00FC3F 7461              MOV      A,#LOW base
B1:00FC41 F0                MOVX     @DPTR,A
B1:00FC42 D001              POP      AR1
B1:00FC44 D002              POP      AR2
B1:00FC46 02ECFD            LJMP     _crypto_scalarmult_curve25519
----- FUNCTION _crypto_scalarmult_curve25519_base (END) -------


----- FUNCTION ?L?COM0545 (BEGIN) -----
B1:00FC49 E0                MOVX     A,@DPTR
B1:00FC4A F9                MOV      R1,A
B1:00FC4B A3                INC      DPTR
B1:00FC4C E0                MOVX     A,@DPTR
B1:00FC4D FA                MOV      R2,A
B1:00FC4E A3                INC      DPTR
B1:00FC4F E0                MOVX     A,@DPTR
B1:00FC50 22                RET      
----- FUNCTION ?L?COM0545 (END) -------


----- FUNCTION ?L?COM051E (BEGIN) -----
B1:00FC51 12203B            LCALL    ?C?CSTPTR
B1:00FC54 901221            MOV      DPTR,#nodeID
B1:00FC57 E0                MOVX     A,@DPTR
B1:00FC58 FF                MOV      R7,A
B1:00FC59 22                RET      
----- FUNCTION ?L?COM051E (END) -------


----- FUNCTION ?L?COM025C (BEGIN) -----
B1:00FC5A 122552            LCALL    ?C?PLDXDATA
B1:00FC5D E9                MOV      A,R1
B1:00FC5E         ?L?COM025D:
B1:00FC5E 24DA              ADD      A,#0DAH
B1:00FC60 F9                MOV      R1,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 483


B1:00FC61 E4                CLR      A
B1:00FC62 3A                ADDC     A,R2
B1:00FC63 FA                MOV      R2,A
B1:00FC64 741A              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ProtocolTransmitComplete
B1:00FC66 22                RET      
----- FUNCTION ?L?COM025C (END) -------


----- FUNCTION ?L?COM03C0 (BEGIN) -----
B1:00FC67 9009C9            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+08H
B1:00FC6A F0                MOVX     @DPTR,A
B1:00FC6B A3                INC      DPTR
B1:00FC6C 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ZWTransmitComplete
B1:00FC6E F0                MOVX     @DPTR,A
B1:00FC6F A3                INC      DPTR
B1:00FC70 7471              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ZWTransmitComplete
B1:00FC72 F0                MOVX     @DPTR,A
B1:00FC73 22                RET      
----- FUNCTION ?L?COM03C0 (END) -------


----- FUNCTION ?L?COM0352 (BEGIN) -----
B1:00FC74 E0                MOVX     A,@DPTR
B1:00FC75 FE                MOV      R6,A
B1:00FC76 A3                INC      DPTR
B1:00FC77 E0                MOVX     A,@DPTR
B1:00FC78 FF                MOV      R7,A
B1:00FC79 F582              MOV      DPL,A
B1:00FC7B 8E83              MOV      DPH,R6
B1:00FC7D 22                RET      
----- FUNCTION ?L?COM0352 (END) -------


----- FUNCTION ?L?COM044C (BEGIN) -----
B1:00FC7E 7B02              MOV      R3,#MBYTE NVM_RETURN_ROUTE_SPEED_START_far
B1:00FC80 7A0F              MOV      R2,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FC82 7985              MOV      R1,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FC84 7E0F              MOV      R6,#HIGH NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FC86 7F85              MOV      R7,#LOW NVM_RETURN_ROUTE_SPEED_START_far+01H
B1:00FC88 22                RET      
----- FUNCTION ?L?COM044C (END) -------


----- FUNCTION ?L?COM0316 (BEGIN) -----
B1:00FC89 EF                MOV      A,R7
B1:00FC8A 5403              ANL      A,#03H
B1:00FC8C F0                MOVX     @DPTR,A
B1:00FC8D E0                MOVX     A,@DPTR
B1:00FC8E FF                MOV      R7,A
B1:00FC8F 9041A2            MOV      DPTR,#n
B1:00FC92 E0                MOVX     A,@DPTR
B1:00FC93 04                INC      A
B1:00FC94 25E0              ADD      A,ACC
B1:00FC96 25E0              ADD      A,ACC
B1:00FC98 FE                MOV      R6,A
B1:00FC99 EF                MOV      A,R7
B1:00FC9A 22                RET      
----- FUNCTION ?L?COM0316 (END) -------


----- FUNCTION ?L?COM058E (BEGIN) -----
B1:00FC9B 9222              MOV      ?IncSeqNo?BIT,C
B1:00FC9D C223              CLR      ?IncSeqNo?BIT+01H
B1:00FC9F 02C74A            LJMP     IncSeqNo
----- FUNCTION ?L?COM058E (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 484




----- FUNCTION ?L?COM0516 (BEGIN) -----
B1:00FCA2 903329            MOV      DPTR,#tempi
B1:00FCA5 E0                MOVX     A,@DPTR
B1:00FCA6 FF                MOV      R7,A
B1:00FCA7 C3                CLR      C
B1:00FCA8 9405              SUBB     A,#05H
B1:00FCAA 22                RET      
----- FUNCTION ?L?COM0516 (END) -------


----- FUNCTION ?L?COM046D (BEGIN) -----
B1:00FCAB F0                MOVX     @DPTR,A
B1:00FCAC A3                INC      DPTR
B1:00FCAD 7419              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_AssignComplete
B1:00FCAF F0                MOVX     @DPTR,A
B1:00FCB0 A3                INC      DPTR
B1:00FCB1 74F3              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_AssignComplete
B1:00FCB3 F0                MOVX     @DPTR,A
B1:00FCB4 22                RET      
----- FUNCTION ?L?COM046D (END) -------


----- FUNCTION ?L?COM04C0 (BEGIN) -----
B1:00FCB5 C4                SWAP     A
B1:00FCB6 13                RRC      A
B1:00FCB7 5407              ANL      A,#07H
B1:00FCB9 FE                MOV      R6,A
B1:00FCBA EF                MOV      A,R7
B1:00FCBB C3                CLR      C
B1:00FCBC 13                RRC      A
B1:00FCBD 4E                ORL      A,R6
B1:00FCBE 22                RET      
----- FUNCTION ?L?COM04C0 (END) -------


----- FUNCTION ?L?COM0159 (BEGIN) -----
B1:00FCBF E4                CLR      A
B1:00FCC0 FF                MOV      R7,A
B1:00FCC1 7EFF              MOV      R6,#0FFH
B1:00FCC3         ?L?COM015A:
B1:00FCC3 FD                MOV      R5,A
B1:00FCC4 FC                MOV      R4,A
B1:00FCC5 90404B            MOV      DPTR,#aad_len
B1:00FCC8         ?L?COM015B:
B1:00FCC8 12247E            LCALL    ?C?LLDXDATA0
B1:00FCCB C3                CLR      C
B1:00FCCC 02239D            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM0159 (END) -------


----- FUNCTION ?L?COM037D (BEGIN) -----
B1:00FCCF F0                MOVX     @DPTR,A
B1:00FCD0 A3                INC      DPTR
B1:00FCD1 EF                MOV      A,R7
B1:00FCD2 F0                MOVX     @DPTR,A
B1:00FCD3         ?L?COM037E:
B1:00FCD3 903BB8            MOV      DPTR,#key
B1:00FCD6 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM037D (END) -------


----- FUNCTION ?L?COM03A7 (BEGIN) -----
B1:00FCD9 90405A            MOV      DPTR,#aad_bytes_in_first_block
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 485


B1:00FCDC E0                MOVX     A,@DPTR
B1:00FCDD FE                MOV      R6,A
B1:00FCDE A3                INC      DPTR
B1:00FCDF E0                MOVX     A,@DPTR
B1:00FCE0 FF                MOV      R7,A
B1:00FCE1 22                RET      
----- FUNCTION ?L?COM03A7 (END) -------


----- FUNCTION ?L?COM0541 (BEGIN) -----
B1:00FCE2 900A1D            MOV      DPTR,#pFreeTxElement
B1:00FCE5 122552            LCALL    ?C?PLDXDATA
B1:00FCE8 E9                MOV      A,R1
B1:00FCE9 22                RET      
----- FUNCTION ?L?COM0541 (END) -------


----- FUNCTION ?L?COM0577 (BEGIN) -----
B1:00FCEA 904103            MOV      DPTR,#text_to_encrypt_len+01H
B1:00FCED E0                MOVX     A,@DPTR
B1:00FCEE 540F              ANL      A,#0FH
B1:00FCF0 FF                MOV      R7,A
B1:00FCF1 22                RET      
----- FUNCTION ?L?COM0577 (END) -------


----- FUNCTION ?L?COM050F (BEGIN) -----
B1:00FCF2 FB                MOV      R3,A
B1:00FCF3 E4                CLR      A
B1:00FCF4 FA                MOV      R2,A
B1:00FCF5 F9                MOV      R1,A
B1:00FCF6 F8                MOV      R0,A
B1:00FCF7 903BC8            MOV      DPTR,#ciphertext_len
B1:00FCFA 22                RET      
----- FUNCTION ?L?COM050F (END) -------


----- FUNCTION ?L?COM0520 (BEGIN) -----
B1:00FCFB 900A15            MOV      DPTR,#frameType
B1:00FCFE E0                MOVX     A,@DPTR
B1:00FCFF FF                MOV      R7,A
B1:00FD00 900A1D            MOV      DPTR,#pFreeTxElement
B1:00FD03 22                RET      
----- FUNCTION ?L?COM0520 (END) -------


----- FUNCTION ?L?COM03E5 (BEGIN) -----
B1:00FD04 904608            MOV      DPTR,#t
B1:00FD07 E0                MOVX     A,@DPTR
B1:00FD08 FF                MOV      R7,A
B1:00FD09 7E00              MOV      R6,#00H
B1:00FD0B 7D01              MOV      R5,#01H
B1:00FD0D 22                RET      
----- FUNCTION ?L?COM03E5 (END) -------


----- FUNCTION ?L?COM04BD (BEGIN) -----
B1:00FD0E 9040FF            MOV      DPTR,#P
B1:00FD11 122552            LCALL    ?C?PLDXDATA
B1:00FD14 90410B            MOV      DPTR,#offset
B1:00FD17 22                RET      
----- FUNCTION ?L?COM04BD (END) -------


----- FUNCTION ?L?COM04BF (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 486


B1:00FD18 12204D            LCALL    ?C?CSTOPTR
B1:00FD1B 90405A            MOV      DPTR,#aad_bytes_in_first_block
B1:00FD1E E4                CLR      A
B1:00FD1F F0                MOVX     @DPTR,A
B1:00FD20 A3                INC      DPTR
B1:00FD21 22                RET      
----- FUNCTION ?L?COM04BF (END) -------


----- FUNCTION ?L?COM04CD (BEGIN) -----
B1:00FD22 900A15            MOV      DPTR,#frameType
B1:00FD25 E0                MOVX     A,@DPTR
B1:00FD26 FD                MOV      R5,A
B1:00FD27 EE                MOV      A,R6
B1:00FD28 5407              ANL      A,#07H
B1:00FD2A FF                MOV      R7,A
B1:00FD2B 22                RET      
----- FUNCTION ?L?COM04CD (END) -------


----- FUNCTION ?L?COM0407 (BEGIN) -----
B1:00FD2C 7C00              MOV      R4,#00H
B1:00FD2E 7D10              MOV      R5,#010H
B1:00FD30 AF03              MOV      R7,AR3
B1:00FD32 AE02              MOV      R6,AR2
B1:00FD34 0220D6            LJMP     ?C?SIDIV
----- FUNCTION ?L?COM0407 (END) -------


----- FUNCTION ?L?COM044A (BEGIN) -----
B1:00FD37 EF                MOV      A,R7
B1:00FD38 24FF              ADD      A,#0FFH
B1:00FD3A FF                MOV      R7,A
B1:00FD3B EE                MOV      A,R6
B1:00FD3C 34FF              ADDC     A,#0FFH
B1:00FD3E FE                MOV      R6,A
B1:00FD3F ED                MOV      A,R5
B1:00FD40 6F                XRL      A,R7
B1:00FD41 22                RET      
----- FUNCTION ?L?COM044A (END) -------


----- FUNCTION ?L?COM0476 (BEGIN) -----
B1:00FD42 FD                MOV      R5,A
B1:00FD43 E4                CLR      A
B1:00FD44 F0                MOVX     @DPTR,A
B1:00FD45 A3                INC      DPTR
B1:00FD46 ED                MOV      A,R5
B1:00FD47 F0                MOVX     @DPTR,A
B1:00FD48 22                RET      
----- FUNCTION ?L?COM0476 (END) -------


----- FUNCTION ?L?COM0328 (BEGIN) -----
B1:00FD49 FD                MOV      R5,A
B1:00FD4A FC                MOV      R4,A
B1:00FD4B 90404B            MOV      DPTR,#aad_len
B1:00FD4E 12247E            LCALL    ?C?LLDXDATA0
B1:00FD51 D3                SETB     C
B1:00FD52 02239D            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM0328 (END) -------


----- FUNCTION ?L?COM0219 (BEGIN) -----
B1:00FD55 904056            MOV      DPTR,#new_aad_len
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 487


B1:00FD58 E0                MOVX     A,@DPTR
B1:00FD59 FA                MOV      R2,A
B1:00FD5A A3                INC      DPTR
B1:00FD5B E0                MOVX     A,@DPTR
B1:00FD5C FB                MOV      R3,A
B1:00FD5D 7C00              MOV      R4,#00H
B1:00FD5F 7D10              MOV      R5,#010H
B1:00FD61 FF                MOV      R7,A
B1:00FD62 AE02              MOV      R6,AR2
B1:00FD64 0220D6            LJMP     ?C?SIDIV
----- FUNCTION ?L?COM0219 (END) -------


----- FUNCTION ?L?COM0531 (BEGIN) -----
B1:00FD67 122572            LCALL    ?C?PSTXDATA
B1:00FD6A 904608            MOV      DPTR,#t
B1:00FD6D E0                MOVX     A,@DPTR
B1:00FD6E 22                RET      
----- FUNCTION ?L?COM0531 (END) -------


----- FUNCTION ?L?COM0576 (BEGIN) -----
B1:00FD6F 904607            MOV      DPTR,#q
B1:00FD72 E0                MOVX     A,@DPTR
B1:00FD73 14                DEC      A
B1:00FD74 5407              ANL      A,#07H
B1:00FD76 22                RET      
----- FUNCTION ?L?COM0576 (END) -------


----- FUNCTION ?L?COM0590 (BEGIN) -----
B1:00FD77 FF                MOV      R7,A
B1:00FD78 900787            MOV      DPTR,#currentSeqNo
B1:00FD7B E0                MOVX     A,@DPTR
B1:00FD7C 540F              ANL      A,#0FH
B1:00FD7E 22                RET      
----- FUNCTION ?L?COM0590 (END) -------


----- FUNCTION ?L?COM04B9 (BEGIN) -----
B1:00FD7F 122552            LCALL    ?C?PLDXDATA
B1:00FD82 9040FF            MOV      DPTR,#?_format_payload_block?BYTE+03H
B1:00FD85 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04B9 (END) -------


----- FUNCTION ?L?COM04BA (BEGIN) -----
B1:00FD88 122462            LCALL    ?C?LLDXDATA
B1:00FD8B 90404B            MOV      DPTR,#?_format_aad?BYTE+06H
B1:00FD8E 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM04BA (END) -------


----- FUNCTION ?L?COM04BB (BEGIN) -----
B1:00FD91 122552            LCALL    ?C?PLDXDATA
B1:00FD94 904048            MOV      DPTR,#?_format_aad?BYTE+03H
B1:00FD97 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04BB (END) -------


----- FUNCTION ?L?COM03F3 (BEGIN) -----
B1:00FD9A 25E0              ADD      A,ACC
B1:00FD9C 2481              ADD      A,#LOW abDirectNodesResponseSpeed
B1:00FD9E F582              MOV      DPL,A
B1:00FDA0 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 488


B1:00FDA1 3407              ADDC     A,#HIGH abDirectNodesResponseSpeed
B1:00FDA3 F583              MOV      DPH,A
B1:00FDA5 E0                MOVX     A,@DPTR
B1:00FDA6 22                RET      
----- FUNCTION ?L?COM03F3 (END) -------


----- FUNCTION ?L?COM03F4 (BEGIN) -----
B1:00FDA7 E0                MOVX     A,@DPTR
B1:00FDA8 FB                MOV      R3,A
B1:00FDA9 A3                INC      DPTR
B1:00FDAA E0                MOVX     A,@DPTR
B1:00FDAB 9009CA            MOV      DPTR,#?_EnqueueSingleDataPtr?BYTE+09H
B1:00FDAE CB                XCH      A,R3
B1:00FDAF F0                MOVX     @DPTR,A
B1:00FDB0 A3                INC      DPTR
B1:00FDB1 EB                MOV      A,R3
B1:00FDB2 F0                MOVX     @DPTR,A
B1:00FDB3 22                RET      
----- FUNCTION ?L?COM03F4 (END) -------


----- FUNCTION ?L?COM0538 (BEGIN) -----
B1:00FDB4 7A39              MOV      R2,#HIGH M_last
B1:00FDB6 7904              MOV      R1,#LOW M_last
B1:00FDB8 9042DA            MOV      DPTR,#?_xor_128?BYTE+06H
B1:00FDBB 22                RET      
----- FUNCTION ?L?COM0538 (END) -------


----- FUNCTION ?L?COM0574 (BEGIN) -----
B1:00FDBC F582              MOV      DPL,A
B1:00FDBE E4                CLR      A
B1:00FDBF 3438              ADDC     A,#HIGH X
B1:00FDC1 F583              MOV      DPH,A
B1:00FDC3 22                RET      
----- FUNCTION ?L?COM0574 (END) -------


----- FUNCTION ?L?COM03B9 (BEGIN) -----
B1:00FDC4 9038D9            MOV      DPTR,#key
B1:00FDC7         ?L?COM03BA:
B1:00FDC7 122552            LCALL    ?C?PLDXDATA
B1:00FDCA 021D77            LJMP     ?INTERBANK_TABLE?_ZW_AES_ecb
----- FUNCTION ?L?COM03B9 (END) -------


----- FUNCTION ?L?COM0215 (BEGIN) -----
B1:00FDCD E0                MOVX     A,@DPTR
B1:00FDCE 24FF              ADD      A,#0FFH
B1:00FDD0 FF                MOV      R7,A
B1:00FDD1 E4                CLR      A
B1:00FDD2 34FF              ADDC     A,#0FFH
B1:00FDD4 FE                MOV      R6,A
B1:00FDD5 EF                MOV      A,R7
B1:00FDD6 C4                SWAP     A
B1:00FDD7 F8                MOV      R0,A
B1:00FDD8 540F              ANL      A,#0FH
B1:00FDDA C8                XCH      A,R0
B1:00FDDB 68                XRL      A,R0
B1:00FDDC FF                MOV      R7,A
B1:00FDDD EE                MOV      A,R6
B1:00FDDE C4                SWAP     A
B1:00FDDF 54F0              ANL      A,#0F0H
B1:00FDE1 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 489


----- FUNCTION ?L?COM0215 (END) -------


----- FUNCTION ?L?COM058D (BEGIN) -----
B1:00FDE2 900787            MOV      DPTR,#currentSeqNo
B1:00FDE5 E0                MOVX     A,@DPTR
B1:00FDE6 FF                MOV      R7,A
B1:00FDE7 540F              ANL      A,#0FH
B1:00FDE9 22                RET      
----- FUNCTION ?L?COM058D (END) -------


----- FUNCTION ?L?COM034C (BEGIN) -----
B1:00FDEA FF                MOV      R7,A
B1:00FDEB E4                CLR      A
B1:00FDEC F0                MOVX     @DPTR,A
B1:00FDED A3                INC      DPTR
B1:00FDEE EF                MOV      A,R7
B1:00FDEF F0                MOVX     @DPTR,A
B1:00FDF0 22                RET      
----- FUNCTION ?L?COM034C (END) -------


----- FUNCTION ?L?COM058B (BEGIN) -----
B1:00FDF1 900671            MOV      DPTR,#eErrcode
B1:00FDF4 7401              MOV      A,#01H
B1:00FDF6 F0                MOVX     @DPTR,A
B1:00FDF7 FF                MOV      R7,A
B1:00FDF8 22                RET      
----- FUNCTION ?L?COM058B (END) -------


----- FUNCTION ?L?COM04BC (BEGIN) -----
B1:00FDF9 122552            LCALL    ?C?PLDXDATA
B1:00FDFC 903DF9            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0AH
B1:00FDFF 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04BC (END) -------


----- FUNCTION ?L?COM050E (BEGIN) -----
B1:00FE02 E0                MOVX     A,@DPTR
B1:00FE03 FF                MOV      R7,A
B1:00FE04 A3                INC      DPTR
B1:00FE05 E0                MOVX     A,@DPTR
B1:00FE06 903DFC            MOV      DPTR,#?_encrypt_or_decrypt?BYTE+0DH
B1:00FE09 CF                XCH      A,R7
B1:00FE0A 22                RET      
----- FUNCTION ?L?COM050E (END) -------


----- FUNCTION ?L?COM00E7 (BEGIN) -----
B1:00FE0B 7B01              MOV      R3,#01H
B1:00FE0D E4                CLR      A
B1:00FE0E FF                MOV      R7,A
B1:00FE0F 021B79            LJMP     ?INTERBANK_TABLE?___ZW_memset
----- FUNCTION ?L?COM00E7 (END) -------


----- FUNCTION ?L?COM0134 (BEGIN) -----
B1:00FE12 7B01              MOV      R3,#01H
B1:00FE14 7A37              MOV      R2,#HIGH workbuf
B1:00FE16 795E              MOV      R1,#LOW workbuf
B1:00FE18 90375D            MOV      DPTR,#dataLengthWork
B1:00FE1B E0                MOVX     A,@DPTR
B1:00FE1C 904478            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 490


B1:00FE1F F0                MOVX     @DPTR,A
B1:00FE20 12388D            LCALL    _NVM_ext_read_buffer
B1:00FE23 903759            MOV      DPTR,#NVM_WorkPtrWrite
B1:00FE26 E0                MOVX     A,@DPTR
B1:00FE27 FE                MOV      R6,A
B1:00FE28 A3                INC      DPTR
B1:00FE29 E0                MOVX     A,@DPTR
B1:00FE2A FF                MOV      R7,A
B1:00FE2B 7B01              MOV      R3,#01H
B1:00FE2D 7A37              MOV      R2,#HIGH workbuf
B1:00FE2F 795E              MOV      R1,#LOW workbuf
B1:00FE31 90375D            MOV      DPTR,#dataLengthWork
B1:00FE34 E0                MOVX     A,@DPTR
B1:00FE35 22                RET      
----- FUNCTION ?L?COM0134 (END) -------


----- FUNCTION ?L?COM0315 (BEGIN) -----
B1:00FE36 90403B            MOV      DPTR,#dataLengthOld
B1:00FE39 E0                MOVX     A,@DPTR
B1:00FE3A FE                MOV      R6,A
B1:00FE3B A3                INC      DPTR
B1:00FE3C E0                MOVX     A,@DPTR
B1:00FE3D FF                MOV      R7,A
B1:00FE3E D3                SETB     C
B1:00FE3F 90403E            MOV      DPTR,#dataLengthNew+01H
B1:00FE42 E0                MOVX     A,@DPTR
B1:00FE43 9F                SUBB     A,R7
B1:00FE44 90403D            MOV      DPTR,#dataLengthNew
B1:00FE47 22                RET      
----- FUNCTION ?L?COM0315 (END) -------


----- FUNCTION ?L?COM029D (BEGIN) -----
B1:00FE48 75F010            MOV      B,#010H
B1:00FE4B A4                MUL      AB
B1:00FE4C 2454              ADD      A,#LOW s2_network_keys
B1:00FE4E F9                MOV      R1,A
B1:00FE4F 7412              MOV      A,#HIGH s2_network_keys
B1:00FE51 35F0              ADDC     A,B
B1:00FE53 FE                MOV      R6,A
B1:00FE54 AF01              MOV      R7,AR1
B1:00FE56 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM029D (END) -------


----- FUNCTION ?L?COM033B (BEGIN) -----
B1:00FE59 743A              MOV      A,#LOW responseRouteSpeedNumHops-01H
B1:00FE5B 2F                ADD      A,R7
B1:00FE5C         ?L?COM033C:
B1:00FE5C F582              MOV      DPL,A
B1:00FE5E E4                CLR      A
B1:00FE5F 3412              ADDC     A,#HIGH responseRouteSpeedNumHops-01H
B1:00FE61 F583              MOV      DPH,A
B1:00FE63 E0                MOVX     A,@DPTR
B1:00FE64 22                RET      
----- FUNCTION ?L?COM033B (END) -------


----- FUNCTION ?L?COM038B (BEGIN) -----
B1:00FE65 FF                MOV      R7,A
B1:00FE66 AEF0              MOV      R6,B
B1:00FE68 125949            LCALL    _getTickTimePassed
B1:00FE6B 904018            MOV      DPTR,#tx_status
B1:00FE6E EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 491


B1:00FE6F F0                MOVX     @DPTR,A
B1:00FE70 A3                INC      DPTR
B1:00FE71 EF                MOV      A,R7
B1:00FE72 22                RET      
----- FUNCTION ?L?COM038B (END) -------


----- FUNCTION ?L?COM038C (BEGIN) -----
B1:00FE73 FF                MOV      R7,A
B1:00FE74 75F0EB            MOV      B,#0EBH
B1:00FE77 122546            LCALL    ?C?OFFXADD
B1:00FE7A E0                MOVX     A,@DPTR
B1:00FE7B 22                RET      
----- FUNCTION ?L?COM038C (END) -------


----- FUNCTION ?L?COM0392 (BEGIN) -----
B1:00FE7C 75F0EB            MOV      B,#0EBH
B1:00FE7F EF                MOV      A,R7
B1:00FE80 122546            LCALL    ?C?OFFXADD
B1:00FE83 E0                MOVX     A,@DPTR
B1:00FE84 22                RET      
----- FUNCTION ?L?COM0392 (END) -------


----- FUNCTION ?L?COM040A (BEGIN) -----
B1:00FE85 4403              ORL      A,#03H
B1:00FE87 12203B            LCALL    ?C?CSTPTR
B1:00FE8A 900679            MOV      DPTR,#sACK
B1:00FE8D 7401              MOV      A,#01H
B1:00FE8F F0                MOVX     @DPTR,A
B1:00FE90 22                RET      
----- FUNCTION ?L?COM040A (END) -------


----- FUNCTION ?L?COM0425 (BEGIN) -----
B1:00FE91 A3                INC      DPTR
B1:00FE92 F0                MOVX     @DPTR,A
B1:00FE93         ?L?COM0426:
B1:00FE93 900A2C            MOV      DPTR,#pData
B1:00FE96 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0425 (END) -------


----- FUNCTION ?L?COM0478 (BEGIN) -----
B1:00FE99 7B01              MOV      R3,#01H
B1:00FE9B 7A40              MOV      R2,#HIGH tx_status+0BH
B1:00FE9D 7923              MOV      R1,#LOW tx_status+0BH
B1:00FE9F 021BAB            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION ?L?COM0478 (END) -------


----- FUNCTION ?L?COM04C8 (BEGIN) -----
B1:00FEA2 7A07              MOV      R2,#HIGH inclusionHomeID
B1:00FEA4 798D              MOV      R1,#LOW inclusionHomeID
B1:00FEA6 7F04              MOV      R7,#04H
B1:00FEA8 021BAB            LJMP     ?INTERBANK_TABLE?___ZW_memcpy
----- FUNCTION ?L?COM04C8 (END) -------


----- FUNCTION ?L?COM04DE (BEGIN) -----
B1:00FEAB E0                MOVX     A,@DPTR
B1:00FEAC FF                MOV      R7,A
B1:00FEAD 7B01              MOV      R3,#01H
B1:00FEAF 7A40              MOV      R2,#HIGH tx_status
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 492


B1:00FEB1 7918              MOV      R1,#LOW tx_status
B1:00FEB3 22                RET      
----- FUNCTION ?L?COM04DE (END) -------


----- FUNCTION ?L?COM04E9 (BEGIN) -----
B1:00FEB4 FD                MOV      R5,A
B1:00FEB5 ACF0              MOV      R4,B
B1:00FEB7 F582              MOV      DPL,A
B1:00FEB9 85F083            MOV      DPH,B
B1:00FEBC 22                RET      
----- FUNCTION ?L?COM04E9 (END) -------


----- FUNCTION ?L?COM04EB (BEGIN) -----
B1:00FEBD FD                MOV      R5,A
B1:00FEBE C4                SWAP     A
B1:00FEBF 540F              ANL      A,#0FH
B1:00FEC1 FC                MOV      R4,A
B1:00FEC2 ED                MOV      A,R5
B1:00FEC3 540F              ANL      A,#0FH
B1:00FEC5 22                RET      
----- FUNCTION ?L?COM04EB (END) -------


----- FUNCTION ?L?COM0511 (BEGIN) -----
B1:00FEC6 FF                MOV      R7,A
B1:00FEC7 AEF0              MOV      R6,B
B1:00FEC9 F582              MOV      DPL,A
B1:00FECB 85F083            MOV      DPH,B
B1:00FECE 22                RET      
----- FUNCTION ?L?COM0511 (END) -------


----- FUNCTION ?L?COM051A (BEGIN) -----
B1:00FECF 90066C            MOV      DPTR,#delayCount
B1:00FED2 F0                MOVX     @DPTR,A
B1:00FED3 7E19              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:00FED5 7F6C              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_DelayedRetransmitFail
B1:00FED7 22                RET      
----- FUNCTION ?L?COM051A (END) -------


----- FUNCTION ?L?COM051F (BEGIN) -----
B1:00FED8 901221            MOV      DPTR,#nodeID
B1:00FEDB E0                MOVX     A,@DPTR
B1:00FEDC FF                MOV      R7,A
B1:00FEDD 900A30            MOV      DPTR,#pTxOptionsEx
B1:00FEE0 22                RET      
----- FUNCTION ?L?COM051F (END) -------


----- FUNCTION ?L?COM058F (BEGIN) -----
B1:00FEE1 9009C7            MOV      DPTR,#dataLength
B1:00FEE4 E0                MOVX     A,@DPTR
B1:00FEE5 D3                SETB     C
B1:00FEE6 942E              SUBB     A,#02EH
B1:00FEE8 22                RET      
----- FUNCTION ?L?COM058F (END) -------


----- FUNCTION _ApplicationPoll (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2244: ApplicationPoll(
 2245:   E_PROTOCOL_STATE bProtocolState) /* IN Protocol current state - If FALSE, ready to shutdown */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 493


 2246: #else
 2247: void                  /*RET Nothing */
 2248: ApplicationPoll(void) /*IN  Nothing */
 2249: #endif
 2250: {
 2251:   BYTE conVal;
 2252: #if SUPPORT_SERIAL_API_EXT
 2253:   register BYTE in0, in1;
 2254: #endif
 2255: #if SUPPORT_ZW_GET_RANDOM
 2256:   BYTE noRndBytes;
 2257:   WORD rndWord;
 2258: #endif
 2259: 
 2260: #ifdef ZW_SMARTSTART_ENABLED
 2261:   bProtocolState = bProtocolState;
 2262: #endif
 2263: 
 2264: #ifdef ZW_ISD51_DEBUG         /* init ISD51 only when the uVision2 Debugger tries to connect */
 2265:     ISDcheck();               /* initialize uVision2 Debugger and continue program run */
 2266: #endif
 2267:   /* ApplicationPoll is controlled by a statemachine with the four states:
 2268:       stateIdle, stateFrameParse, stateTxSerial, stateCbTxSerial.
 2269: 
 2270:       stateIdle: If there is anything to transmit do so. -> stateCbTxSerial
 2271:                  If not, check if anything is received. -> stateFrameParse
 2272:                  If neither, stay in the state
 2273:                  Note: frames received while we are transmitting are lost
 2274:                  and must be retransmitted by PC
 2275: 
 2276:       stateFrameParse: Parse received frame.
 2277:                  If the request has no response -> stateIdle
 2278:                  If there is an immediate response send it. -> stateTxSerial
 2279: 
 2280:       stateTxSerial:  Waits for ack on responses send in stateFrameParse.
 2281:                  Retransmit frame as needed.
 2282:                  -> stateIdle
 2283: 
 2284:       stateCbTxSerial:  Waits for ack on requests send in stateIdle
 2285:                   (callback, ApplicationCommandHandler etc).
 2286:                  Retransmit frame as needed and remove from callbackqueue when done.
 2287:                  -> stateIdle
 2288: 
 2289:       The serialapi sample code uses the LEDs as indicator for state (if ENABLE_LEDS is defined)
 2290:       and the following are defined:
 2291:       LED1 ON, LED2 OFF, LED3 ON - Idle (waiting for action) - stateIdle.
 2292:       LED1 OFF, LED2 ON, LED3 OFF - A command has been received from HOST
 2293:                 and this is being executed (a Response frame will also be send if needed) - stateFrameParse.
 2294:       LED1 OFF, LED2 OFF, LED3 ON - Waiting for ACK for Response frame transmitted - stateTxSerial.
 2295:       LED1 ON, LED2 ON, LED3 OFF - A Request is transmitted to HOST (next state is
 2296:                 Waiting for ACK for Request - in stateIdle if any Requests in queue)
 2297:       LED1 OFF, LED2 ON, LED3 ON - Waiting for ACK for Request frame transmitted - stateCbTxSerial.
 2298: 
 2299:   */
 2300: 
 2301: #ifdef NO_UART_INTERRUPT
 2302:   /* Background handler for buffered receive/transmit - alternative to interrupt handling */
 2303:   SerialBackgroundHandler();
 2304: #endif
 2305: #ifdef ZW_ENABLE_RTC
 2306:   ZW_RTC_TIMER_ACTION();
 2307: #endif
 2308: 
 2309: #if SUPPORT_ZW_WATCHDOG_START || SUPPORT_ZW_WATCHDOG_STOP
 2310:   if (bWatchdogStarted)
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 494


B2:008000 9027A3            MOV      DPTR,#bWatchdogStarted
B2:008003 E0                MOVX     A,@DPTR
B2:008004 6003              JZ       ?C0106?SERIALAPPL
 2311:   {
 2312:     /* If watchdog enabled - kick it... */
 2313:     ZW_WATCHDOG_KICK;
B2:008006 1237E6            LCALL    ZW_WatchDogKick
 2314:   }
B2:008009         ?C0106?SERIALAPPL:
 2315: #endif
 2316: 
 2317: #if SUPPORT_SERIAL_API_POWER_MANAGEMENT
 2318:   PowerManagementCheck();
B2:008009 12A368            LCALL    PowerManagementCheck
 2319: #endif
 2320: #if SUPPORT_ZW_PORT_STATUS
 2321:   EventScheduler();
 2322: #endif
 2323: 
 2324:   switch (state)
B2:00800C 902162            MOV      DPTR,#state
B2:00800F E0                MOVX     A,@DPTR
B2:008010 14                DEC      A
B2:008011 7003              JNZ      $ + 5H
B2:008013 029336            LJMP     ?C0426?SERIALAPPL
B2:008016 14                DEC      A
B2:008017 7002              JNZ      $ + 4H
B2:008019 019E              AJMP     ?C0114?SERIALAPPL
B2:00801B 14                DEC      A
B2:00801C 7003              JNZ      $ + 5H
B2:00801E 029356            LJMP     ?C0432?SERIALAPPL
B2:008021 14                DEC      A
B2:008022 7003              JNZ      $ + 5H
B2:008024 029374            LJMP     ?C0438?SERIALAPPL
B2:008027 2404              ADD      A,#04H
B2:008029 6003              JZ       $ + 5H
B2:00802B 02939D            LJMP     ?C0444?SERIALAPPL
 2325:   {
 2326:     case stateIdle :
B2:00802E         ?C0108?SERIALAPPL:
 2327:     {
 2328: #if SUPPORT_SERIAL_API_READY
 2329:       /* Only empty callback queue for HOST if SERIAL LINK has been established  */
 2330:       if (callbackQueue.requestCnt && (SERIAL_LINK_DETACHED != serialLinkState))
B2:00802E 902176            MOV      DPTR,#callbackQueue+02H
B2:008031 E0                MOVX     A,@DPTR
B2:008032 6025              JZ       ?C0109?SERIALAPPL
B2:008034 90215F            MOV      DPTR,#serialLinkState
B2:008037 E0                MOVX     A,@DPTR
B2:008038 601F              JZ       ?C0109?SERIALAPPL
 2331: #else
 2332:       /* Check if there is anything to transmit. If so do it */
 2333:       if (callbackQueue.requestCnt)
 2334: #endif
 2335:       {
 2336: #ifdef ENABLE_LEDS
 2337:         LedOn(1);
 2338:         LedOn(2);
 2339:         LedOff(3);
 2340: #endif
 2341:         ConTxFrame(callbackQueue.requestQueue[callbackQueue.requestOut].wCmd, REQUEST, (XBYTE*)callbackQueue.requ
>> estQueue[callbackQueue.requestOut].wBuf, callbackQueue.requestQueue[callbackQueue.requestOut].wLen);
B2:00803A 902174            MOV      DPTR,#callbackQueue
B2:00803D E0                MOVX     A,@DPTR
B2:00803E FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 495


B2:00803F 12A91C            LCALL    ?L?COM0324
B2:008042 E0                MOVX     A,@DPTR
B2:008043 902179            MOV      DPTR,#callbackQueue+05H
B2:008046 12A9C3            LCALL    ?L?COM03D0
B2:008049 902174            MOV      DPTR,#callbackQueue
B2:00804C E0                MOVX     A,@DPTR
B2:00804D 12A8D5            LCALL    ?L?COM029E
B2:008050 12A51C            LCALL    ?L?COM0322
B2:008053 7403              MOV      A,#03H
B2:008055 F0                MOVX     @DPTR,A
 2342:         set_state(stateCallbackTxSerial);
 2343:         /* callbackCnt decremented when frame is acknowledged from PC - or timed out after retries */
 2344:       }
B2:008056 0293A2            LJMP     ?C0107?SERIALAPPL
B2:008059         ?C0109?SERIALAPPL:
 2345:       else
 2346:       {
 2347: #if SUPPORT_SERIAL_API_READY
 2348:         /* Only empty command queue for HOST if SERIAL LINK has been established  */
 2349:         if (commandQueue.requestCnt && (SERIAL_LINK_DETACHED != serialLinkState))
B2:008059 9024CC            MOV      DPTR,#commandQueue+02H
B2:00805C E0                MOVX     A,@DPTR
B2:00805D 6025              JZ       ?C0111?SERIALAPPL
B2:00805F 90215F            MOV      DPTR,#serialLinkState
B2:008062 E0                MOVX     A,@DPTR
B2:008063 601F              JZ       ?C0111?SERIALAPPL
 2350: #else
 2351:         /* Check if there is anything to transmit. If so do it */
 2352:         if (commandQueue.requestCnt)
 2353: #endif
 2354:         {
 2355: #ifdef ENABLE_LEDS
 2356:           LedOn(1);
 2357:           LedOn(2);
 2358:           LedOff(3);
 2359: #endif
 2360:           ConTxFrame(commandQueue.requestQueue[commandQueue.requestOut].wCmd, REQUEST, (XBYTE*)commandQueue.reque
>> stQueue[commandQueue.requestOut].wBuf, commandQueue.requestQueue[commandQueue.requestOut].wLen);
B2:008065 9024CA            MOV      DPTR,#commandQueue
B2:008068 E0                MOVX     A,@DPTR
B2:008069 FE                MOV      R6,A
B2:00806A 12A860            LCALL    ?L?COM0213
B2:00806D E0                MOVX     A,@DPTR
B2:00806E 9024CF            MOV      DPTR,#commandQueue+05H
B2:008071 12A9C3            LCALL    ?L?COM03D0
B2:008074 9024CA            MOV      DPTR,#commandQueue
B2:008077 E0                MOVX     A,@DPTR
B2:008078 12AA1E            LCALL    ?L?COM046B
B2:00807B 12A51C            LCALL    ?L?COM0322
B2:00807E 7404              MOV      A,#04H
B2:008080 F0                MOVX     @DPTR,A
 2361:           set_state(stateCommandTxSerial);
 2362:           /* commandCnt decremented when frame is acknowledged from PC - or timed out after retries */
 2363:         }
B2:008081 0293A2            LJMP     ?C0107?SERIALAPPL
B2:008084         ?C0111?SERIALAPPL:
 2364:         else
 2365:         {
 2366: #ifdef ENABLE_LEDS
 2367:           LedOn(1);
 2368:           LedOff(2);
 2369:           LedOn(3);
 2370: #endif
 2371:           /* Nothing to transmit. Check if we received anything */
 2372:           if (ConUpdate(TRUE) == conFrameReceived)
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 496


B2:008084 7F01              MOV      R7,#01H
B2:008086 12A534            LCALL    _ConUpdate
B2:008089 EF                MOV      A,R7
B2:00808A 6401              XRL      A,#01H
B2:00808C 6003              JZ       $ + 5H
B2:00808E 0293A2            LJMP     ?C0107?SERIALAPPL
 2373:           {
 2374: #if SUPPORT_SERIAL_API_READY
 2375:             /* We have received a frame from HOST so we must assume we are connected */
 2376:             serialLinkState = SERIAL_LINK_CONNECTED;
B2:008091 90215F            MOV      DPTR,#serialLinkState
B2:008094 04                INC      A
B2:008095 F0                MOVX     @DPTR,A
 2377: #endif
 2378:             /* We got a frame... */
 2379:             set_state(stateFrameParse);
B2:008096 902162            MOV      DPTR,#state
B2:008099 04                INC      A
B2:00809A F0                MOVX     @DPTR,A
 2380:           }
 2381:         }
 2382:       }
 2383:     }
 2384:     break;
B2:00809B 0293A2            LJMP     ?C0107?SERIALAPPL
 2385: 
 2386:     case stateFrameParse :
B2:00809E         ?C0114?SERIALAPPL:
 2387:     {
 2388: #ifdef ENABLE_LEDS
 2389:       LedOff(1);
 2390:       LedOn(2);
 2391:       LedOff(3);
 2392: #endif
 2393:       /* Parse received frame */
 2394:       switch (serFrameCmd)
B2:00809E 903409            MOV      DPTR,#serBuf+02H
B2:0080A1 E0                MOVX     A,@DPTR
B2:0080A2 12267F            LCALL    ?C?CCASE
B2:0080A5 8C71              DW       ?C0292?SERIALAPPL
B2:0080A7 02                DB       02H
B2:0080A8 8AC4              DW       ?C0262?SERIALAPPL
B2:0080AA 03                DB       03H
B2:0080AB 8C9C              DW       ?C0294?SERIALAPPL
B2:0080AD 06                DB       06H
B2:0080AE 8DDB              DW       ?C0314?SERIALAPPL
B2:0080B0 07                DB       07H
B2:0080B1 8CC1              DW       ?C0295?SERIALAPPL
B2:0080B3 08                DB       08H
B2:0080B4 8AB8              DW       ?C0261?SERIALAPPL
B2:0080B6 09                DB       09H
B2:0080B7 8CC6              DW       ?C0298?SERIALAPPL
B2:0080B9 0B                DB       0BH
B2:0080BA 8B48              DW       ?C0270?SERIALAPPL
B2:0080BC 0C                DB       0CH
B2:0080BD 8319              DW       ?C0145?SERIALAPPL
B2:0080BF 0E                DB       0EH
B2:0080C0 846F              DW       ?C0165?SERIALAPPL
B2:0080C2 0F                DB       0FH
B2:0080C3 81AF              DW       ?C0120?SERIALAPPL
B2:0080C5 10                DB       010H
B2:0080C6 91F4              DW       ?C0396?SERIALAPPL
B2:0080C8 11                DB       011H
B2:0080C9 81BA              DW       ?C0121?SERIALAPPL
B2:0080CB 12                DB       012H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 497


B2:0080CC 82A9              DW       ?C0138?SERIALAPPL
B2:0080CE 13                DB       013H
B2:0080CF 83AD              DW       ?C0152?SERIALAPPL
B2:0080D1 14                DB       014H
B2:0080D2 8AA7              DW       ?C0260?SERIALAPPL
B2:0080D4 15                DB       015H
B2:0080D5 84E7              DW       ?C0172?SERIALAPPL
B2:0080D7 16                DB       016H
B2:0080D8 90B2              DW       ?C0368?SERIALAPPL
B2:0080DA 17                DB       017H
B2:0080DB 9225              DW       ?C0400?SERIALAPPL
B2:0080DD 1C                DB       01CH
B2:0080DE 84ED              DW       ?C0173?SERIALAPPL
B2:0080E0 20                DB       020H
B2:0080E1 8500              DW       ?C0174?SERIALAPPL
B2:0080E3 21                DB       021H
B2:0080E4 850C              DW       ?C0175?SERIALAPPL
B2:0080E6 22                DB       022H
B2:0080E7 8541              DW       ?C0180?SERIALAPPL
B2:0080E9 23                DB       023H
B2:0080EA 8568              DW       ?C0182?SERIALAPPL
B2:0080EC 24                DB       024H
B2:0080ED 92FE              DW       ?C0419?SERIALAPPL
B2:0080EF 27                DB       027H
B2:0080F0 89FB              DW       ?C0243?SERIALAPPL
B2:0080F2 28                DB       028H
B2:0080F3 871D              DW       ?C0210?SERIALAPPL
B2:0080F5 29                DB       029H
B2:0080F6 87C3              DW       ?C0215?SERIALAPPL
B2:0080F8 2A                DB       02AH
B2:0080F9 881F              DW       ?C0218?SERIALAPPL
B2:0080FB 2B                DB       02BH
B2:0080FC 875B              DW       ?C0211?SERIALAPPL
B2:0080FE 2C                DB       02CH
B2:0080FF 878D              DW       ?C0213?SERIALAPPL
B2:008101 2D                DB       02DH
B2:008102 8607              DW       ?C0191?SERIALAPPL
B2:008104 2E                DB       02EH
B2:008105 89DE              DW       ?C0240?SERIALAPPL
B2:008107 2F                DB       02FH
B2:008108 8169              DW       ?C0116?SERIALAPPL
B2:00810A 37                DB       037H
B2:00810B 816F              DW       ?C0117?SERIALAPPL
B2:00810D 38                DB       038H
B2:00810E 818F              DW       ?C0118?SERIALAPPL
B2:008110 39                DB       039H
B2:008111 8195              DW       ?C0119?SERIALAPPL
B2:008113 3A                DB       03AH
B2:008114 9303              DW       ?C0420?SERIALAPPL
B2:008116 3B                DB       03BH
B2:008117 9319              DW       ?C0423?SERIALAPPL
B2:008119 3C                DB       03CH
B2:00811A 8A39              DW       ?C0249?SERIALAPPL
B2:00811C 42                DB       042H
B2:00811D 8A4F              DW       ?C0251?SERIALAPPL
B2:00811F 50                DB       050H
B2:008120 8A15              DW       ?C0246?SERIALAPPL
B2:008122 53                DB       053H
B2:008123 8A96              DW       ?C0258?SERIALAPPL
B2:008125 56                DB       056H
B2:008126 8A8A              DW       ?C0256?SERIALAPPL
B2:008128 5E                DB       05EH
B2:008129 8A90              DW       ?C0257?SERIALAPPL
B2:00812B 5F                DB       05FH
B2:00812C 8C8B              DW       ?C0293?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 498


B2:00812E 60                DB       060H
B2:00812F 92E0              DW       ?C0418?SERIALAPPL
B2:008131 67                DB       067H
B2:008132 88A5              DW       ?C0225?SERIALAPPL
B2:008134 78                DB       078H
B2:008135 8A9C              DW       ?C0259?SERIALAPPL
B2:008137 90                DB       090H
B2:008138 910F              DW       ?C0378?SERIALAPPL
B2:00813A 98                DB       098H
B2:00813B 81D7              DW       ?C0124?SERIALAPPL
B2:00813D 9C                DB       09CH
B2:00813E 90DD              DW       ?C0372?SERIALAPPL
B2:008140 B4                DB       0B4H
B2:008141 90E7              DW       ?C0373?SERIALAPPL
B2:008143 B6                DB       0B6H
B2:008144 90EC              DW       ?C0374?SERIALAPPL
B2:008146 B7                DB       0B7H
B2:008147 90F1              DW       ?C0375?SERIALAPPL
B2:008149 B8                DB       0B8H
B2:00814A 90D5              DW       ?C0371?SERIALAPPL
B2:00814C B9                DB       0B9H
B2:00814D 90C1              DW       ?C0369?SERIALAPPL
B2:00814F BA                DB       0BAH
B2:008150 90CB              DW       ?C0370?SERIALAPPL
B2:008152 BD                DB       0BDH
B2:008153 8C54              DW       ?C0289?SERIALAPPL
B2:008155 BE                DB       0BEH
B2:008156 90F6              DW       ?C0376?SERIALAPPL
B2:008158 D2                DB       0D2H
B2:008159 9103              DW       ?C0377?SERIALAPPL
B2:00815B D3                DB       0D3H
B2:00815C 9324              DW       ?C0424?SERIALAPPL
B2:00815E D6                DB       0D6H
B2:00815F 8DEC              DW       ?C0315?SERIALAPPL
B2:008161 EE                DB       0EEH
B2:008162 9094              DW       ?C0365?SERIALAPPL
B2:008164 EF                DB       0EFH
B2:008165 0000              DW       00H
B2:008167 9334              DW       ?C0425?SERIALAPPL
 2395:       {
 2396: #if SUPPORT_FUNC_ID_CLEAR_TX_TIMERS
 2397:         case FUNC_ID_CLEAR_TX_TIMERS:
B2:008169         ?C0116?SERIALAPPL:
 2398:           /* HOST->ZW: */
 2399:           ZW_ClearTxTimers();
B2:008169 125E91            LCALL    ZW_ClearTxTimers
 2400:           state = stateIdle;
 2401:           break;
B2:00816C 028E95            LJMP     ?C0589?SERIALAPPL
 2402: #endif  /* SUPPORT_FUNC_ID_CLEAR_TX_TIMERS */
 2403: 
 2404: #if SUPPORT_FUNC_ID_GET_TX_TIMERS
 2405:         case FUNC_ID_GET_TX_TIMERS:
B2:00816F         ?C0117?SERIALAPPL:
 2406:           /* HOST->ZW: */
 2407:           /* ZW->HOST: channel0TxTimer_MSB | channel0TxTimer_Next_MSB | channel0TxTimer_Next_LSB | channel0TxTime
>> rLSB | */
 2408:           /*           channel1TxTimer_MSB | channel1TxTimer_Next_MSB | channel1TxTimer_Next_LSB | channel1TxTime
>> rLSB | */
 2409:           /*           channel2TxTimer_MSB | channel2TxTimer_Next_MSB | channel2TxTimer_Next_LSB | channel2TxTime
>> rLSB */
 2410:           ZW_GetTxTimer(0, (DWORD_P)compl_workbuf);
B2:00816F 12A87C            LCALL    ?L?COM0234
B2:008172 E4                CLR      A
B2:008173 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 499


B2:008174 125EAF            LCALL    _ZW_GetTxTimer
 2411:           ZW_GetTxTimer(1, (DWORD_P)(compl_workbuf + sizeof(DWORD)));
B2:008177 7B01              MOV      R3,#01H
B2:008179 7A20              MOV      R2,#HIGH compl_workbuf+04H
B2:00817B 7905              MOV      R1,#LOW compl_workbuf+04H
B2:00817D 7F01              MOV      R7,#01H
B2:00817F 125EAF            LCALL    _ZW_GetTxTimer
 2412:           ZW_GetTxTimer(2, (DWORD_P)(compl_workbuf + (2 * sizeof(DWORD))));
B2:008182 7B01              MOV      R3,#01H
B2:008184 7A20              MOV      R2,#HIGH compl_workbuf+08H
B2:008186 7909              MOV      R1,#LOW compl_workbuf+08H
B2:008188 7F02              MOV      R7,#02H
B2:00818A 125EAF            LCALL    _ZW_GetTxTimer
 2413: 
 2414:           DoRespond_workbuf(3*sizeof(DWORD));
 2415: 
 2416:           break;
B2:00818D 801B              SJMP     ?C0549?SERIALAPPL
 2417: #endif  /* SUPPORT_FUNC_ID_GET_TX_TIMERS */
 2418: 
 2419: #if SUPPORT_ZW_CLEAR_NETWORK_STATS
 2420:         case FUNC_ID_ZW_CLEAR_NETWORK_STATS:
B2:00818F         ?C0118?SERIALAPPL:
 2421:           /* HOST->ZW: */
 2422:           /* ZW->HOST: 0x01 */
 2423:           ZW_ClearNetworkStats();
B2:00818F 125EC6            LCALL    ZW_ClearNetworkStats
 2424:           retVal = TRUE;
 2425:           DoRespond();
 2426:           break;
B2:008192 02931F            LJMP     ?C0598?SERIALAPPL
 2427: #endif  /* SUPPORT_ZW_CLEAR_NETWORK_STATS */
 2428: 
 2429: #if SUPPORT_ZW_GET_NETWORK_STATS
 2430:         case FUNC_ID_ZW_GET_NETWORK_STATS:
B2:008195         ?C0119?SERIALAPPL:
 2431:           /* HOST->ZW: */
 2432:           /* ZW->HOST: wRFTxFrames_MSB | wRFTxFrames_LSB | */
 2433:           /*           wRFTxLBTBackOffs_MSB | wRFTxLBTBackOffs_LSB | */
 2434:           /*           wRFRxFrames_MSB | wRFRxFrames_LSB */
 2435:           /*           wRFRxLRCErrors_MSB | wRFRxLRCErrors_LSB */
 2436:           /*           wRFRxCRC16Errors_MSB | wRFRxCRC16Errors_LSB */
 2437:           /*           wRFRxForeignHomeID_MSB | wRFRxForeignHomeID_LSB */
 2438:           {
 2439:             S_NETWORK_STATISTICS sNetSats;
 2440:             ZW_GetNetworkStats(&sNetSats);
B2:008195 12AA17            LCALL    ?L?COM045F
B2:008198 125EDE            LCALL    _ZW_GetNetworkStats
 2441:             memcpy(compl_workbuf, (BYTE*)&sNetSats, sizeof(S_NETWORK_STATISTICS));
B2:00819B 904423            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
B2:00819E 12A81B            LCALL    ?L?COM0198
B2:0081A1 7A20              MOV      R2,#HIGH compl_workbuf
B2:0081A3 7901              MOV      R1,#LOW compl_workbuf
B2:0081A5 7F0C              MOV      R7,#0CH
B2:0081A7 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
 2442:             DoRespond_workbuf(sizeof(S_NETWORK_STATISTICS));
B2:0081AA         
B2:0081AA 7F0C              MOV      R7,#0CH
 2443:           }
 2444:           break;
B2:0081AC 029314            LJMP     ?C0554?SERIALAPPL
 2445: #endif  /* SUPPORT_ZW_GET_NETWORK_STATS */
 2446: 
 2447: #if SUPPORT_ZW_SET_RF_RECEIVE_MODE
 2448:         case FUNC_ID_ZW_SET_RF_RECEIVE_MODE:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 500


B2:0081AF         ?C0120?SERIALAPPL:
 2449:           /* HOST->ZW: mode */
 2450:           /* ZW->HOST: retVal */
 2451:           retVal = ZW_SetRFReceiveMode(serFrameDataPtr[0]);
B2:0081AF 90340A            MOV      DPTR,#serBuf+03H
B2:0081B2 E0                MOVX     A,@DPTR
B2:0081B3 FF                MOV      R7,A
B2:0081B4 125006            LCALL    _ZW_SetRFReceiveMode
 2452:           DoRespond();
 2453:           break;
B2:0081B7 0290BA            LJMP     ?C0599?SERIALAPPL
 2454: #endif  /* SUPPORT_ZW_SET_RF_RECEIVE_MODE */
 2455: 
 2456: #if SUPPORT_ZW_REQUEST_NEW_ROUTE_DESTINATIONS
 2457:         case FUNC_ID_ZW_REQUEST_NEW_ROUTE_DESTINATIONS:
 2458:           /* HOST->ZW: destList[5] | funcID */
 2459:           /* destList zero terminated if less than ZW_MAX_RETURN_ROUTE_DESTINATIONS */
 2460:           funcID_ComplHandler_ZW_RequestNewRouteDestinations = serFrameDataPtr[5];
 2461:           for (i = 0; i < 5; i++)
 2462:           {
 2463:             if (serFrameDataPtr[i])
 2464:             {
 2465:               returnRouteDests[i] = serFrameDataPtr[i];
 2466:             }
 2467:             else
 2468:             {
 2469:               break;
 2470:             }
 2471:           }
 2472:           retVal = ZW_REQUEST_NEW_ROUTE_DESTINATIONS(returnRouteDests, i,
 2473:                                                      serFrameDataPtr[5] ? ZCB_ComplHandler_ZW_RequestNewRouteDest
>> inations : NULL);
 2474:           DoRespond();
 2475:           break;
 2476: #endif  /* SUPPORT_ZW_REQUEST_NEW_ROUTE_DESTINATIONS */
 2477: 
 2478: #if SUPPORT_ZW_IS_NODE_WITHIN_DIRECT_RANGE
 2479:         case FUNC_ID_ZW_IS_NODE_WITHIN_DIRECT_RANGE:
 2480:           /* HOST->ZW: bNodeID */
 2481:           /* ZW->HOST: retVal */
 2482:           retVal = ZW_IS_NODE_WITHIN_DIRECT_RANGE(serFrameDataPtr[0]);
 2483:           DoRespond();
 2484:           break;
 2485: #endif
 2486: 
 2487: #if SUPPORT_ZW_SEND_NODE_INFORMATION
 2488:         case FUNC_ID_ZW_SEND_NODE_INFORMATION:
B2:0081BA         ?C0121?SERIALAPPL:
 2489:           /* HOST->ZW: destNode | txOptions | funcID */
 2490:           /* ZW->HOST: retVal */
 2491:           funcID_ComplHandler_ZW_SendNodeInformation = serFrameDataPtr[2];
B2:0081BA 90340C            MOV      DPTR,#serBuf+05H
B2:0081BD E0                MOVX     A,@DPTR
B2:0081BE 9027A4            MOV      DPTR,#funcID_ComplHandler_ZW_SendNodeInformation
B2:0081C1 12A8A3            LCALL    ?L?COM0264
B2:0081C4 EE                MOV      A,R6
B2:0081C5 6006              JZ       ?C0122?SERIALAPPL
B2:0081C7 7A1D              MOV      R2,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendNodeInformation
B2:0081C9 7BFE              MOV      R3,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendNodeInformation
B2:0081CB 8004              SJMP     ?C0123?SERIALAPPL
B2:0081CD         ?C0122?SERIALAPPL:
B2:0081CD 7A00              MOV      R2,#00H
B2:0081CF 7B00              MOV      R3,#00H
B2:0081D1         ?C0123?SERIALAPPL:
B2:0081D1 1219E9            LCALL    ?INTERBANK_TABLE?_ZW_SendNodeInformation
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 501


B2:0081D4         
 2492:           retVal = ZW_SendNodeInformation(serFrameDataPtr[0], serFrameDataPtr[1],
 2493:                                           (serFrameDataPtr[2] != 0) ? ZCB_ComplHandler_ZW_SendNodeInformation : N
>> ULL);
 2494:           DoRespond();
 2495:           break;
B2:0081D4 0290BA            LJMP     ?C0599?SERIALAPPL
 2496: #endif /* SUPPORT_ZW_SEND_NODE_INFORMATION */
 2497: 
 2498: #if SUPPORT_ZW_SECURITY_SETUP
 2499:         case FUNC_ID_ZW_SECURITY_SETUP:
B2:0081D7         ?C0124?SERIALAPPL:
 2500:           /* HOST->ZW: securityFuncID [| bDataLen | abData[bDataLen]] */
 2501:           /* ZW->HOST: securityFuncID | bretValLen | retVal[bretValLen] */
 2502:           compl_workbuf[0] = serFrameDataPtr[0];
B2:0081D7 12AAA3            LCALL    ?L?COM04F1
 2503:           switch ((eSecuritySetupCmd_t)serFrameDataPtr[0])
B2:0081DA 12267F            LCALL    ?C?CCASE
B2:0081DD 81F6              DW       ?C0126?SERIALAPPL
B2:0081DF 00                DB       00H
B2:0081E0 8234              DW       ?C0131?SERIALAPPL
B2:0081E2 01                DB       01H
B2:0081E3 8255              DW       ?C0133?SERIALAPPL
B2:0081E5 02                DB       02H
B2:0081E6 8269              DW       ?C0134?SERIALAPPL
B2:0081E8 04                DB       04H
B2:0081E9 8204              DW       ?C0127?SERIALAPPL
B2:0081EB 05                DB       05H
B2:0081EC 821C              DW       ?C0129?SERIALAPPL
B2:0081EE 06                DB       06H
B2:0081EF 8289              DW       ?C0136?SERIALAPPL
B2:0081F1 FE                DB       0FEH
B2:0081F2 0000              DW       00H
B2:0081F4 8295              DW       ?C0137?SERIALAPPL
 2504:           {
 2505: #if SUPPORT_ZW_GET_SECURITY_KEYS
 2506:             case E_SECURITY_SETUP_CMD_ZW_GET_SECURITY_KEYS:
B2:0081F6         ?C0126?SERIALAPPL:
 2507:               /* HOST->ZW: */
 2508:               /* ZW->HOST: securityKeys_bitmaskLen(1) | securityKeys_bitmask[securityKeys_bitmaskLen] */
 2509:               retVal = ZW_GetSecurityKeys();
B2:0081F6 121B15            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:0081F9 90279F            MOV      DPTR,#retVal
B2:0081FC EF                MOV      A,R7
B2:0081FD F0                MOVX     @DPTR,A
 2510:               compl_workbuf[1] = 1;
B2:0081FE 12A936            LCALL    ?L?COM032F
B2:008201         
 2511:               compl_workbuf[2] = retVal;
 2512:               DoRespond_workbuf(3);
 2513:               break;
B2:008201 029314            LJMP     ?C0554?SERIALAPPL
 2514: 
 2515:             case E_SECURITY_SETUP_CMD_SET_SECURITY_INCLUSION_REQUESTED_KEYS:
B2:008204         ?C0127?SERIALAPPL:
 2516:               /* HOST->ZW: registeredSecurityKeysLen(1) | registeredSecurityKeys */
 2517:               /* ZW->HOST: retValLen(1) | retVal[retValLen] */
 2518:               retVal = FALSE;
B2:008204 12A857            LCALL    ?L?COM01E4
B2:008207 E0                MOVX     A,@DPTR
B2:008208 B4060F            CJNE     A,#06H,?C0128?SERIALAPPL
B2:00820B 90340B            MOV      DPTR,#serBuf+04H
B2:00820E E0                MOVX     A,@DPTR
B2:00820F B40108            CJNE     A,#01H,?C0128?SERIALAPPL
 2519:               if (((FRAME_LENGTH_MIN + 1 + 1 + 1) == serFrameLen) &&
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 502


 2520:                   (1 == serFrameDataPtr[1]))
 2521:               {
 2522:                 /* Set the requestedSecurityKeysBits requested by protocol when doing S2 inclusion */
 2523:                 sRequestedSecuritySettings.requestedSecurityKeysBits = serFrameDataPtr[2];
B2:008212 A3                INC      DPTR
B2:008213 E0                MOVX     A,@DPTR
B2:008214 90247D            MOV      DPTR,#sRequestedSecuritySettings
B2:008217 129D7B            LCALL    ?L?COM0203
 2524:                 /* sRequestedSecuritySettings.requestedSecurityKeysBits are either the initialized */
 2525:                 /* value (REQUESTED_SECURITY_KEYS) or the value set through the FUNC_ID_ZW_SECURITY_SETUP */
 2526:                 /* function E_SECURITY_SETUP_CMD_SET_SECURITY_INCLUSION_REQUESTED_KEYS */
 2527:                 /* As requestedSecurityKeyBits has been changed we MUST call ZW_s2_inclusion_init */
 2528:                 ZW_s2_inclusion_init();
 2529:                 retVal = TRUE;
 2530:               }
B2:00821A         ?C0128?SERIALAPPL:
 2531:               compl_workbuf[1] = 1;
 2532:               compl_workbuf[2] = retVal;
 2533:               DoRespond_workbuf(3);
 2534:               break;
B2:00821A 8067              SJMP     ?C0557?SERIALAPPL
 2535: 
 2536:             case E_SECURITY_SETUP_CMD_SET_SECURITY_INCLUSION_REQUESTED_AUTHENTICATION:
B2:00821C         ?C0129?SERIALAPPL:
 2537:               /* HOST->ZW: registeredSecurityAuthenticationLen(1) | registeredSecurityAuthentication */
 2538:               /* ZW->HOST: retValLen(1) | retVal[retValLen] */
 2539:               retVal = FALSE;
B2:00821C 12A857            LCALL    ?L?COM01E4
B2:00821F E0                MOVX     A,@DPTR
B2:008220 B4060F            CJNE     A,#06H,?C0130?SERIALAPPL
B2:008223 90340B            MOV      DPTR,#serBuf+04H
B2:008226 E0                MOVX     A,@DPTR
B2:008227 B40108            CJNE     A,#01H,?C0130?SERIALAPPL
 2540:               if (((FRAME_LENGTH_MIN + 1 + 1 + 1) == serFrameLen) &&
 2541:                   (1 == serFrameDataPtr[1]))
 2542:               {
 2543:                 /* Set the requestedSecurityAuthentication requested by protocol when doing S2 inclusion */
 2544:                 sRequestedSecuritySettings.requestedSecurityAuthentication = serFrameDataPtr[2];
B2:00822A A3                INC      DPTR
B2:00822B E0                MOVX     A,@DPTR
B2:00822C 90247E            MOV      DPTR,#sRequestedSecuritySettings+01H
B2:00822F 129D7B            LCALL    ?L?COM0203
 2545:                 /* sRequestedSecuritySettings.requestedSecurityAuthentication are either the initialized */
 2546:                 /* value (REQUESTED_SECURITY_AUTHENTICATION) or the value set through the FUNC_ID_ZW_SECURITY_SET
>> UP */
 2547:                 /* function E_SECURITY_SETUP_CMD_SET_SECURITY_INCLUSION_REQUESTED_AUTHENTICATION */
 2548:                 /* As requestedSecurityAuthentication has been changed we MUST call ZW_s2_inclusion_init */
 2549:                 ZW_s2_inclusion_init();
 2550:                 retVal = TRUE;
 2551:               }
B2:008232         ?C0130?SERIALAPPL:
 2552:               compl_workbuf[1] = 1;
B2:008232         
 2553:               compl_workbuf[2] = retVal;
 2554:               DoRespond_workbuf(3);
 2555:               break;
B2:008232 804F              SJMP     ?C0557?SERIALAPPL
 2556: #endif
 2557: 
 2558: 
 2559: #if SUPPORT_ZW_SET_SECURITY_S0_NETWORK_KEY
 2560:             case E_SECURITY_SETUP_CMD_ZW_SET_SECURITY_S0_NETWORK_KEY:
B2:008234         ?C0131?SERIALAPPL:
 2561:               /* HOST->ZW: networkkeyLen(16) | network_key[networkkeyLen] */
 2562:               /* ZW->HOST: retValLen(1) | retVal[retValLen] */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 503


 2563:               retVal = FALSE;
B2:008234 E4                CLR      A
B2:008235 90279F            MOV      DPTR,#retVal
B2:008238 F0                MOVX     @DPTR,A
 2564:               if ((NETWORK_KEY_LENGTH == serFrameDataPtr[1]) &&
B2:008239 90340B            MOV      DPTR,#serBuf+04H
B2:00823C E0                MOVX     A,@DPTR
B2:00823D B41013            CJNE     A,#010H,?C0132?SERIALAPPL
B2:008240 903407            MOV      DPTR,#serBuf
B2:008243 E0                MOVX     A,@DPTR
B2:008244 B4150C            CJNE     A,#015H,?C0132?SERIALAPPL
 2565:                   ((FRAME_LENGTH_MIN + 1 + 1 + NETWORK_KEY_LENGTH) == serFrameLen))
 2566:               {
 2567:                 ZW_SetSecurityS0NetworkKey(&serFrameDataPtr[2]);
B2:008247 7B01              MOV      R3,#01H
B2:008249 7A34              MOV      R2,#HIGH serBuf+05H
B2:00824B 790C              MOV      R1,#LOW serBuf+05H
B2:00824D 121B1A            LCALL    ?INTERBANK_TABLE?_ZW_SetSecurityS0NetworkKey
 2568:                 retVal = TRUE;
B2:008250 129D7F            LCALL    ?L?COM0204
 2569:               }
B2:008253         ?C0132?SERIALAPPL:
 2570:               compl_workbuf[1] = 1;
B2:008253         
 2571:               compl_workbuf[2] = retVal;
 2572:               DoRespond_workbuf(3);
 2573:               break;
B2:008253 802E              SJMP     ?C0557?SERIALAPPL
 2574: #endif
 2575: 
 2576: #if SUPPORT_ZW_GET_SECURITY_S2_PUBLIC_DSK
 2577:             case E_SECURITY_SETUP_CMD_ZW_GET_SECURITY_S2_PUBLIC_DSK:
B2:008255         ?C0133?SERIALAPPL:
 2578:               /* HOST->ZW: */
 2579:               /* ZW->HOST: retValLen(SECURITY_KEY_S2_PUBLIC_DSK_LENGTH) | retVal[retValLen] */
 2580:               compl_workbuf[1] = SECURITY_KEY_S2_PUBLIC_DSK_LENGTH;
B2:008255 902002            MOV      DPTR,#compl_workbuf+01H
B2:008258 7410              MOV      A,#010H
B2:00825A F0                MOVX     @DPTR,A
 2581:               ZW_GetSecurityS2PublicDSK(&compl_workbuf[2]);
B2:00825B 7B01              MOV      R3,#01H
B2:00825D 7A20              MOV      R2,#HIGH compl_workbuf+02H
B2:00825F 7903              MOV      R1,#LOW compl_workbuf+02H
B2:008261 121CD2            LCALL    ?INTERBANK_TABLE?_ZW_GetSecurityS2PublicDSK
 2582:               DoRespond_workbuf(2 + SECURITY_KEY_S2_PUBLIC_DSK_LENGTH);
B2:008264 7F12              MOV      R7,#012H
 2583:               break;
B2:008266 029314            LJMP     ?C0559?SERIALAPPL
 2584: #endif
 2585: 
 2586: #if SUPPORT_ZW_SET_SECURITY_S2_CRITICAL_NODE_ID
 2587:             case E_SECURITY_SETUP_CMD_ZW_SET_SECURITY_S2_CRITICAL_NODE_ID:
 2588:               /* HOST->ZW: bNodeIDLen(1) | nodeID[bNodeIDLen] */
 2589:               /* ZW->HOST: retValLen(1) | retVal[retValLen] */
 2590:               retVal = FALSE;
 2591:               if (((FRAME_LENGTH_MIN + 1 + 1 + 1) == serFrameLen) &&
 2592:                   (1 == serFrameDataPtr[1]))
 2593:               {
 2594:                 ZW_SetSecurityS2CriticalNodeID(serFrameDataPtr[2]);
 2595:                 retVal = TRUE;
 2596:               }
 2597:               compl_workbuf[1] = 1;
 2598:               compl_workbuf[2] = retVal;
 2599:               DoRespond_workbuf(3);
 2600:               break;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 504


 2601: #endif
 2602: 
 2603: #if SUPPORT_ZW_SET_SECURITY_S2_INCLUSION_PUBLIC_DSK_CSA
 2604:             case E_SECURITY_SETUP_CMD_ZW_SET_SECURITY_S2_INCLUSION_PUBLIC_DSK_CSA:
B2:008269         ?C0134?SERIALAPPL:
 2605:               /* HOST->ZW: bCSA_DSKLen(SECURITY_KEY_S2_PUBLIC_CSA_DSK_LENGTH) | aCSA_DSK[bCSA_DSKLen] */
 2606:               /* ZW->HOST: retValLen(1) | retVal[retValLen] */
 2607:               {
 2608:                 retVal = FALSE;
B2:008269 12A857            LCALL    ?L?COM01E4
B2:00826C E0                MOVX     A,@DPTR
B2:00826D B40913            CJNE     A,#09H,?C0135?SERIALAPPL
B2:008270 90340B            MOV      DPTR,#serBuf+04H
B2:008273 E0                MOVX     A,@DPTR
B2:008274 B4040C            CJNE     A,#04H,?C0135?SERIALAPPL
 2609:                 if (((FRAME_LENGTH_MIN + 1 + 1 + SECURITY_KEY_S2_PUBLIC_CSA_DSK_LENGTH) == serFrameLen) &&
 2610:                     (SECURITY_KEY_S2_PUBLIC_CSA_DSK_LENGTH == serFrameDataPtr[1]))
 2611:                 {
 2612:                   ZW_SetSecurityS2InclusionPublicDSK_CSA((s_SecurityS2InclusionCSAPublicDSK_t*)&serFrameDataPtr[2
>> ]);
B2:008277 7B01              MOV      R3,#01H
B2:008279 7A34              MOV      R2,#HIGH serBuf+05H
B2:00827B 790C              MOV      R1,#LOW serBuf+05H
B2:00827D 121CCD            LCALL    ?INTERBANK_TABLE?_ZW_SetSecurityS2InclusionPublicDSK_CSA
 2613:                   retVal = TRUE;
B2:008280 129D7F            LCALL    ?L?COM0204
 2614:                 }
B2:008283         ?C0135?SERIALAPPL:
 2615:                 compl_workbuf[1] = 1;
B2:008283         
B2:008283 12A936            LCALL    ?L?COM032F
B2:008286         
 2616:                 compl_workbuf[2] = retVal;
 2617:                 DoRespond_workbuf(3);
 2618:               }
 2619:               break;
B2:008286 029314            LJMP     ?C0559?SERIALAPPL
 2620: #endif  /* SUPPORT_ZW_SET_SECURITY_S2_INCLUSION_PUBLIC_DSK_CSA */
 2621: 
 2622:             case E_SECURITY_SETUP_CMD_GET_SECURITY_CAPABILITIES:
B2:008289         ?C0136?SERIALAPPL:
 2623:               {
 2624:                 /* HOST->ZW: */
 2625:                 /* ZW->HOST: securitySetup_bitmaskLen | securityKeys_bitmask[securitySetup_bitmaskLen] */
 2626:                 compl_workbuf[1] = 1;
B2:008289 902002            MOV      DPTR,#compl_workbuf+01H
B2:00828C 7401              MOV      A,#01H
B2:00828E F0                MOVX     @DPTR,A
 2627:               /* LSB first if more than one byte in securityKeys_bitmask[] */
 2628:                 compl_workbuf[2] = 0
B2:00828F A3                INC      DPTR
B2:008290 7477              MOV      A,#077H
 2629: #if SUPPORT_ZW_GET_SECURITY_KEYS
 2630:                                    | E_SECURITY_SETUP_SUPPORT_CMD_ZW_GET_SECURITY_KEYS
 2631:                                    | E_SECURITY_SETUP_SUPPORT_CMD_SET_SECURITY_INCLUSION_REQUESTED_KEYS
 2632:                                    | E_SECURITY_SETUP_SUPPORT_CMD_SET_SECURITY_INCLUSION_REQUESTED_AUTHENTICATION
>> 
 2633: #endif
 2634: #if SUPPORT_ZW_SET_SECURITY_S0_NETWORK_KEY
 2635:                                    | E_SECURITY_SETUP_SUPPORT_CMD_ZW_SET_SECURITY_S0_NETWORK_KEY
 2636: #endif
 2637: #if SUPPORT_ZW_GET_SECURITY_S2_PUBLIC_DSK
 2638:                                    | E_SECURITY_SETUP_SUPPORT_CMD_ZW_GET_SECURITY_S2_PUBLIC_DSK
 2639: #endif
 2640: #if SUPPORT_ZW_SET_SECURITY_S2_CRITICAL_NODE_ID
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 505


 2641:                                    | E_SECURITY_SETUP_SUPPORT_CMD_ZW_SET_SECURITY_S2_CRITICAL_NODE_ID
 2642: #endif
 2643: #if SUPPORT_ZW_SET_SECURITY_S2_INCLUSION_PUBLIC_DSK_CSA
 2644:                                    | E_SECURITY_SETUP_SUPPORT_CMD_ZW_SET_SECURITY_S2_INCLUSION_PUBLIC_DSK_CSA
 2645: #endif
 2646:                                    ;
 2647:                 DoRespond_workbuf(3);
 2648:               }
 2649:               break;
B2:008292 028937            LJMP     ?C0561?SERIALAPPL
 2650: 
 2651:             default:
B2:008295         ?C0137?SERIALAPPL:
 2652:               {
 2653:                 /* ZW->HOST: E_SECURITY_SETUP_UNKNOWN_COMMAND | retValLen | securityFuncID(called)[retValLen] */
 2654:                 compl_workbuf[0] = E_SECURITY_SETUP_CMD_UNKNOWN;
B2:008295 902001            MOV      DPTR,#compl_workbuf
B2:008298 74FF              MOV      A,#0FFH
B2:00829A F0                MOVX     @DPTR,A
 2655:                 compl_workbuf[1] = 1;
B2:00829B A3                INC      DPTR
B2:00829C 7401              MOV      A,#01H
B2:00829E F0                MOVX     @DPTR,A
 2656:                 /* Return the called Unknown FUNC_ID_ZW_SECURITY_SETUP Command */
 2657:                 compl_workbuf[2] = serFrameDataPtr[0];
B2:00829F 90340A            MOV      DPTR,#serBuf+03H
B2:0082A2 E0                MOVX     A,@DPTR
B2:0082A3 902003            MOV      DPTR,#compl_workbuf+02H
B2:0082A6         
 2658:                 DoRespond_workbuf(3);
 2659:               }
 2660:               break;
B2:0082A6 028937            LJMP     ?C0561?SERIALAPPL
 2661:           }
 2662:           break;
 2663: #endif
 2664: 
 2665: #if SUPPORT_ZW_SEND_DATA
 2666:         case FUNC_ID_ZW_SEND_DATA:
B2:0082A9         ?C0138?SERIALAPPL:
 2667:           /* HOST->ZW: nodeID | dataLength | pData[] | txOptions | funcID */
 2668:           /* ZW->HOST: RetVal */
 2669:           /* If RetVal == FALSE -> no callback */
 2670:           /* If RetVal == TRUE then callback returns with */
 2671:           /* ZW->HOST: txStatus | wTransmitTicksMSB | wTransmitTicksLSB | bRepeaters | rssi_values.incoming[0] | 
>> */
 2672:           /*           rssi_values.incoming[1] | rssi_values.incoming[2] | rssi_values.incoming[3] | rssi_values.
>> incoming[4] | */
 2673:           /*           bRouteSchemeState | repeater0 | repeater1 | repeater2 | repeater3 | routespeed | */
 2674:           /*           bRouteTries | bLastFailedLink.from | bLastFailedLink.to */
 2675:           {
 2676:             BYTE dataLength = serFrameDataPtr[1];
B2:0082A9 12A98F            LCALL    ?L?COM0398
 2677: 
 2678:             if (dataLength > BUF_SIZE_RX)
B2:0082AC D3                SETB     C
B2:0082AD 94A8              SUBB     A,#0A8H
B2:0082AF 4003              JC       ?C0139?SERIALAPPL
 2679:             {
 2680:               dataLength = BUF_SIZE_RX;
B2:0082B1 74A8              MOV      A,#0A8H
B2:0082B3 F0                MOVX     @DPTR,A
 2681:             }
B2:0082B4         ?C0139?SERIALAPPL:
 2682:             for (i = 0; i < dataLength; i++)
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 506


B2:0082B4 E4                CLR      A
B2:0082B5 9024C6            MOV      DPTR,#i
B2:0082B8 F0                MOVX     @DPTR,A
B2:0082B9         ?C0140?SERIALAPPL:
B2:0082B9 904142            MOV      DPTR,#dataLength
B2:0082BC 1298EB            LCALL    ?L?COM0080
B2:0082BF 5012              JNC      ?C0141?SERIALAPPL
 2683:             {
 2684:               workbuf[i] = serFrameDataPtr[2 + i];
B2:0082C1 740C              MOV      A,#LOW serBuf+05H
B2:0082C3 2E                ADD      A,R6
B2:0082C4 12A7D7            LCALL    ?L?COM00FA
B2:0082C7 FD                MOV      R5,A
B2:0082C8 12AAD0            LCALL    ?L?COM04F6
B2:0082CB F583              MOV      DPH,A
B2:0082CD ED                MOV      A,R5
B2:0082CE 1293B9            LCALL    ?L?COM0033
B2:0082D1 80E6              SJMP     ?C0140?SERIALAPPL
B2:0082D3         ?C0141?SERIALAPPL:
 2685:             }
 2686:             funcID_ComplHandler_ZW_SendData = serFrameDataPtr[3 + dataLength];
B2:0082D3 740D              MOV      A,#LOW serBuf+06H
B2:0082D5 2F                ADD      A,R7
B2:0082D6 12A7F7            LCALL    ?L?COM0133
B2:0082D9 90246A            MOV      DPTR,#funcID_ComplHandler_ZW_SendData
B2:0082DC F0                MOVX     @DPTR,A
 2687: #ifndef ZW_SECURITY_PROTOCOL
 2688:             retVal = ZW_SendData(serFrameDataPtr[0], workbuf, dataLength, serFrameDataPtr[2 + dataLength],
 2689:               (serFrameDataPtr[3+dataLength] != 0) ? ZCB_ComplHandler_ZW_SendData : NULL);
 2690: #else
 2691:             {
 2692:               TRANSMIT_OPTIONS_TYPE ltTxOptions2;
 2693:               memset((BYTE*)&ltTxOptions2, 0, sizeof(ltTxOptions2));
B2:0082DD 7A41              MOV      R2,#HIGH ltTxOptions2
B2:0082DF 7943              MOV      R1,#LOW ltTxOptions2
B2:0082E1 12A998            LCALL    ?L?COM0399
B2:0082E4 904143            MOV      DPTR,#ltTxOptions2
B2:0082E7 F0                MOVX     @DPTR,A
 2694:               ltTxOptions2.destNode = serFrameDataPtr[0];
 2695:               ltTxOptions2.txOptions = serFrameDataPtr[2 + dataLength];
B2:0082E8 904142            MOV      DPTR,#dataLength
B2:0082EB E0                MOVX     A,@DPTR
B2:0082EC FD                MOV      R5,A
B2:0082ED 12A7D5            LCALL    ?L?COM00F9
B2:0082F0 904145            MOV      DPTR,#ltTxOptions2+02H
B2:0082F3 F0                MOVX     @DPTR,A
 2696:               retVal = (BYTE)ZW_SendDataEx(workbuf, dataLength, &ltTxOptions2,
B2:0082F4 7B01              MOV      R3,#01H
B2:0082F6 7A41              MOV      R2,#HIGH ltTxOptions2
B2:0082F8 7943              MOV      R1,#LOW ltTxOptions2
B2:0082FA 900A30            MOV      DPTR,#?_ZW_SendDataEx?BYTE+04H
B2:0082FD 122572            LCALL    ?C?PSTXDATA
B2:008300 90246A            MOV      DPTR,#funcID_ComplHandler_ZW_SendData
B2:008303 E0                MOVX     A,@DPTR
B2:008304 6006              JZ       ?C0143?SERIALAPPL
B2:008306 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendData
B2:008308 7F03              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendData
B2:00830A 8004              SJMP     ?C0144?SERIALAPPL
B2:00830C         ?C0143?SERIALAPPL:
B2:00830C 7E00              MOV      R6,#00H
B2:00830E 7F00              MOV      R7,#00H
B2:008310         ?C0144?SERIALAPPL:
B2:008310 12A848            LCALL    ?L?COM019C
B2:008313 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B2:008316         
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 507


 2697:                                           (funcID_ComplHandler_ZW_SendData != 0) ? ZCB_ComplHandler_ZW_SendData :
>>  NULL);
 2698:             }
 2699: #endif /* !ZW_SECURITY_PROTOCOL */
 2700:             DoRespond();
 2701:           }
 2702:           break;
B2:008316 0290BA            LJMP     ?C0599?SERIALAPPL
 2703: #endif
 2704: 
 2705: #if SUPPORT_ZW_SEND_DATA_EX
 2706:         case FUNC_ID_ZW_SEND_DATA_EX:
B2:008319         ?C0145?SERIALAPPL:
 2707: 
 2708:           /* HOST->ZW: nodeID | dataLength | pData[] | txOptions | txSecOptions | securityKey | txOptions2 | func
>> ID */
 2709:           /* ZW->HOST: RetVal */
 2710:           /* If "RetVal != 1" -> no callback */
 2711:           /* If "RetVal == 1" and "funcID != 0" then callback returns with */
 2712:           /* ZW->HOST: txStatus | wTransmitTicksMSB | wTransmitTicksLSB | bRepeaters | rssi_values.incoming[0] | 
>> */
 2713:           /*           rssi_values.incoming[1] | rssi_values.incoming[2] | rssi_values.incoming[3] | rssi_values.
>> incoming[4] | */
 2714:           /*           bACKChannelNo | bLastTxChannelNo | */
 2715:           /*           bRouteSchemeState | repeater0 | repeater1 | repeater2 | repeater3 | routespeed | */
 2716:           /*           bRouteTries | bLastFailedLink.from | bLastFailedLink.to */
 2717:           {
 2718:             TRANSMIT_OPTIONS_TYPE ltTxOptions;
 2719:             BYTE dataLength;
 2720: 
 2721:             dataLength = serFrameDataPtr[1];
B2:008319 90340B            MOV      DPTR,#serBuf+04H
B2:00831C E0                MOVX     A,@DPTR
B2:00831D 904148            MOV      DPTR,#dataLength
B2:008320 F0                MOVX     @DPTR,A
 2722:             if (dataLength > BUF_SIZE_RX)
B2:008321 D3                SETB     C
B2:008322 94A8              SUBB     A,#0A8H
B2:008324 4003              JC       ?C0146?SERIALAPPL
 2723:             {
 2724:               dataLength = BUF_SIZE_RX;
B2:008326 74A8              MOV      A,#0A8H
B2:008328 F0                MOVX     @DPTR,A
 2725:             }
B2:008329         ?C0146?SERIALAPPL:
 2726:             for (i = 0; i < dataLength; i++)
B2:008329 E4                CLR      A
B2:00832A 9024C6            MOV      DPTR,#i
B2:00832D F0                MOVX     @DPTR,A
B2:00832E         ?C0147?SERIALAPPL:
B2:00832E 904148            MOV      DPTR,#dataLength
B2:008331 1298EB            LCALL    ?L?COM0080
B2:008334 5012              JNC      ?C0148?SERIALAPPL
 2727:             {
 2728:               workbuf[i] = serFrameDataPtr[2 + i];
B2:008336 740C              MOV      A,#LOW serBuf+05H
B2:008338 2E                ADD      A,R6
B2:008339 12A7D7            LCALL    ?L?COM00FA
B2:00833C FF                MOV      R7,A
B2:00833D 12AAD0            LCALL    ?L?COM04F6
B2:008340 F583              MOV      DPH,A
B2:008342 EF                MOV      A,R7
B2:008343 1293B9            LCALL    ?L?COM0033
B2:008346 80E6              SJMP     ?C0147?SERIALAPPL
B2:008348         ?C0148?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 508


 2729:             }
 2730:             memset((BYTE*)&ltTxOptions, 0, sizeof(ltTxOptions));
B2:008348 7A41              MOV      R2,#HIGH ltTxOptions
B2:00834A 7942              MOV      R1,#LOW ltTxOptions
B2:00834C 12A998            LCALL    ?L?COM0399
B2:00834F 904142            MOV      DPTR,#ltTxOptions
B2:008352 F0                MOVX     @DPTR,A
 2731:             ltTxOptions.destNode = serFrameDataPtr[0];
 2732:             ltTxOptions.txOptions = serFrameDataPtr[2 + dataLength];
B2:008353 904148            MOV      DPTR,#dataLength
B2:008356 E0                MOVX     A,@DPTR
B2:008357 FF                MOV      R7,A
B2:008358 12A7D5            LCALL    ?L?COM00F9
B2:00835B 904144            MOV      DPTR,#ltTxOptions+02H
B2:00835E F0                MOVX     @DPTR,A
 2733:             ltTxOptions.txSecOptions = serFrameDataPtr[3 + dataLength];
B2:00835F 740D              MOV      A,#LOW serBuf+06H
B2:008361 2F                ADD      A,R7
B2:008362 12A7F7            LCALL    ?L?COM0133
B2:008365 904145            MOV      DPTR,#ltTxOptions+03H
B2:008368 F0                MOVX     @DPTR,A
 2734:             ltTxOptions.securityKey = serFrameDataPtr[4 + dataLength];
B2:008369 904148            MOV      DPTR,#dataLength
B2:00836C E0                MOVX     A,@DPTR
B2:00836D 12A8CA            LCALL    ?L?COM028B
B2:008370 904146            MOV      DPTR,#ltTxOptions+04H
B2:008373 F0                MOVX     @DPTR,A
 2735:             ltTxOptions.txOptions2 = serFrameDataPtr[5 + dataLength];
B2:008374 740F              MOV      A,#LOW serBuf+08H
B2:008376 2F                ADD      A,R7
B2:008377 F582              MOV      DPL,A
B2:008379 E4                CLR      A
B2:00837A 3434              ADDC     A,#HIGH serBuf+08H
B2:00837C F583              MOV      DPH,A
B2:00837E E0                MOVX     A,@DPTR
B2:00837F 904147            MOV      DPTR,#ltTxOptions+05H
B2:008382 F0                MOVX     @DPTR,A
 2736:             funcID_ComplHandler_ZW_SendDataEx = serFrameDataPtr[6 + dataLength];
B2:008383 A3                INC      DPTR
B2:008384 E0                MOVX     A,@DPTR
B2:008385 FD                MOV      R5,A
B2:008386 12AAF1            LCALL    ?L?COM054F
B2:008389 F583              MOV      DPH,A
B2:00838B E0                MOVX     A,@DPTR
B2:00838C FF                MOV      R7,A
B2:00838D 90215E            MOV      DPTR,#funcID_ComplHandler_ZW_SendDataEx
B2:008390 F0                MOVX     @DPTR,A
 2737:             retVal = (BYTE)ZW_SendDataEx(workbuf, dataLength, &ltTxOptions,
B2:008391 900A30            MOV      DPTR,#?_ZW_SendDataEx?BYTE+04H
B2:008394 12A81B            LCALL    ?L?COM0198
B2:008397 EF                MOV      A,R7
B2:008398 6006              JZ       ?C0150?SERIALAPPL
B2:00839A 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendDataEx
B2:00839C 7F08              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendDataEx
B2:00839E 8004              SJMP     ?C0151?SERIALAPPL
B2:0083A0         ?C0150?SERIALAPPL:
B2:0083A0 7E00              MOV      R6,#00H
B2:0083A2 7F00              MOV      R7,#00H
B2:0083A4         ?C0151?SERIALAPPL:
B2:0083A4 12A848            LCALL    ?L?COM019C
B2:0083A7 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B2:0083AA         
 2738:                                          (funcID_ComplHandler_ZW_SendDataEx != 0) ? ZCB_ComplHandler_ZW_SendDataE
>> x : NULL);
 2739:             DoRespond();
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 509


 2740:           }
 2741:           break;
B2:0083AA 0290BA            LJMP     ?C0599?SERIALAPPL
 2742: #endif
 2743: 
 2744: #if SUPPORT_ZW_SEND_DATA_MULTI
 2745:         case FUNC_ID_ZW_SEND_DATA_MULTI:
B2:0083AD         ?C0152?SERIALAPPL:
 2746:           /* numberNodes | pNodeIDList[] | dataLength | pData[] | txOptions | funcId */
 2747:           {
 2748:             BYTE numberNodes, dataLength, txOptions;
 2749: 
 2750:             retVal = 0;
B2:0083AD E4                CLR      A
B2:0083AE 90279F            MOV      DPTR,#retVal
B2:0083B1 F0                MOVX     @DPTR,A
 2751:             numberNodes = serFrameDataPtr[0];
B2:0083B2 90340A            MOV      DPTR,#serBuf+03H
B2:0083B5 E0                MOVX     A,@DPTR
B2:0083B6 904142            MOV      DPTR,#numberNodes
B2:0083B9 129CC2            LCALL    ?L?COM01E3
B2:0083BC         ?C0153?SERIALAPPL:
B2:0083BC 12994B            LCALL    ?L?COM0162
B2:0083BF 941D              SUBB     A,#01DH
B2:0083C1 5010              JNC      ?C0154?SERIALAPPL
 2752:             /* clear the destination node mask */
 2753:             for (i = 0; i < MAX_NODEMASK_LENGTH; i++)
 2754:             {
 2755:               groupMask[i] = 0;
B2:0083C3 741F              MOV      A,#LOW groupMask
B2:0083C5 2F                ADD      A,R7
B2:0083C6 F582              MOV      DPL,A
B2:0083C8 E4                CLR      A
B2:0083C9 3424              ADDC     A,#HIGH groupMask
B2:0083CB F583              MOV      DPH,A
B2:0083CD E4                CLR      A
B2:0083CE 1293B9            LCALL    ?L?COM0033
B2:0083D1 80E9              SJMP     ?C0153?SERIALAPPL
B2:0083D3         ?C0154?SERIALAPPL:
 2756:             }
 2757:             /* Set the destination node mask bits */
 2758:             for (i = 0; i < numberNodes && i < MAX_GROUP_NODES; i++)
B2:0083D3 E4                CLR      A
B2:0083D4 9024C6            MOV      DPTR,#i
B2:0083D7 F0                MOVX     @DPTR,A
B2:0083D8         ?C0156?SERIALAPPL:
B2:0083D8 904142            MOV      DPTR,#numberNodes
B2:0083DB 1298EB            LCALL    ?L?COM0080
B2:0083DE 5018              JNC      ?C0157?SERIALAPPL
B2:0083E0 EE                MOV      A,R6
B2:0083E1 C3                CLR      C
B2:0083E2 9440              SUBB     A,#040H
B2:0083E4 5012              JNC      ?C0157?SERIALAPPL
 2759:             {
 2760:               ZW_NodeMaskSetBit(groupMask, serFrameDataPtr[1+i]);
B2:0083E6 7B01              MOV      R3,#01H
B2:0083E8 7A24              MOV      R2,#HIGH groupMask
B2:0083EA 791F              MOV      R1,#LOW groupMask
B2:0083EC 12A897            LCALL    ?L?COM0260
B2:0083EF FD                MOV      R5,A
B2:0083F0 121BBA            LCALL    ?INTERBANK_TABLE?_ZW_NodeMaskSetBit
 2761:             }
B2:0083F3 1293BA            LCALL    ?L?COM0034
B2:0083F6 80E0              SJMP     ?C0156?SERIALAPPL
B2:0083F8         ?C0157?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 510


 2762:             dataLength = serFrameDataPtr[1 + numberNodes];
B2:0083F8 904142            MOV      DPTR,#numberNodes
B2:0083FB E0                MOVX     A,@DPTR
B2:0083FC 240B              ADD      A,#LOW serBuf+04H
B2:0083FE 12A89A            LCALL    ?L?COM0261
B2:008401 904143            MOV      DPTR,#dataLength
B2:008404 F0                MOVX     @DPTR,A
 2763:             if (dataLength > BUF_SIZE_RX)
B2:008405 D3                SETB     C
B2:008406 94A8              SUBB     A,#0A8H
B2:008408 4003              JC       ?C0159?SERIALAPPL
 2764:             {
 2765:               dataLength = BUF_SIZE_RX;
B2:00840A 74A8              MOV      A,#0A8H
B2:00840C F0                MOVX     @DPTR,A
 2766:             }
B2:00840D         ?C0159?SERIALAPPL:
 2767:             for (i = 0; i < dataLength; i++)
B2:00840D E4                CLR      A
B2:00840E 9024C6            MOV      DPTR,#i
B2:008411 F0                MOVX     @DPTR,A
B2:008412         ?C0160?SERIALAPPL:
B2:008412 904143            MOV      DPTR,#dataLength
B2:008415 12AAAC            LCALL    ?L?COM04F2
B2:008418 500F              JNC      ?C0161?SERIALAPPL
 2768:             {
 2769:               workbuf[i] = serFrameDataPtr[2 + numberNodes + i];
B2:00841A 12AB11            LCALL    ?L?COM0554
B2:00841D 240C              ADD      A,#LOW serBuf+05H
B2:00841F F582              MOV      DPL,A
B2:008421 E4                CLR      A
B2:008422 3434              ADDC     A,#HIGH serBuf+05H
B2:008424 1293AA            LCALL    ?L?COM0031
B2:008427 80E9              SJMP     ?C0160?SERIALAPPL
B2:008429         ?C0161?SERIALAPPL:
 2770:             }
 2771:             txOptions = serFrameDataPtr[2 + numberNodes + dataLength];
B2:008429 904143            MOV      DPTR,#dataLength
B2:00842C 12AB11            LCALL    ?L?COM0554
B2:00842F 12A7D4            LCALL    ?L?COM00F8
B2:008432 FD                MOV      R5,A
B2:008433 904144            MOV      DPTR,#txOptions
B2:008436 12A7F3            LCALL    ?L?COM0132
B2:008439 FE                MOV      R6,A
B2:00843A 9024C7            MOV      DPTR,#funcID_ComplHandler_ZW_SendDataMulti
B2:00843D 12A84F            LCALL    ?L?COM019E
B2:008440 90425B            MOV      DPTR,#?_ZW_SendDataMulti?BYTE+03H
B2:008443 122572            LCALL    ?C?PSTXDATA
B2:008446 90425E            MOV      DPTR,#?_ZW_SendDataMulti?BYTE+06H
B2:008449 EF                MOV      A,R7
B2:00844A F0                MOVX     @DPTR,A
B2:00844B A3                INC      DPTR
B2:00844C ED                MOV      A,R5
B2:00844D F0                MOVX     @DPTR,A
B2:00844E EE                MOV      A,R6
B2:00844F 6006              JZ       ?C0163?SERIALAPPL
B2:008451 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendDataMulti
B2:008453 7F12              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendDataMulti
B2:008455 8004              SJMP     ?C0164?SERIALAPPL
B2:008457         ?C0163?SERIALAPPL:
B2:008457 7E00              MOV      R6,#00H
B2:008459 7F00              MOV      R7,#00H
B2:00845B         ?C0164?SERIALAPPL:
B2:00845B 904260            MOV      DPTR,#?_ZW_SendDataMulti?BYTE+08H
B2:00845E EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 511


B2:00845F F0                MOVX     @DPTR,A
B2:008460 A3                INC      DPTR
B2:008461 EF                MOV      A,R7
B2:008462 F0                MOVX     @DPTR,A
B2:008463 7B01              MOV      R3,#01H
B2:008465 7A24              MOV      R2,#HIGH groupMask
B2:008467 791F              MOV      R1,#LOW groupMask
B2:008469 1219AD            LCALL    ?INTERBANK_TABLE?_ZW_SendDataMulti
B2:00846C         
 2772: 
 2773:             funcID_ComplHandler_ZW_SendDataMulti = serFrameDataPtr[3 + numberNodes + dataLength];
 2774:             retVal = ZW_SendDataMulti(groupMask, workbuf, dataLength, txOptions,
 2775:                                       (serFrameDataPtr[3 + numberNodes + dataLength] != 0) ? ZCB_ComplHandler_ZW_
>> SendDataMulti : NULL);
 2776:             DoRespond();
 2777:           }
 2778:           break;
B2:00846C 0290BA            LJMP     ?C0599?SERIALAPPL
 2779: #endif
 2780: 
 2781: #if SUPPORT_ZW_SEND_DATA_MULTI_EX
 2782:         case FUNC_ID_ZW_SEND_DATA_MULTI_EX:
B2:00846F         ?C0165?SERIALAPPL:
 2783:           /* dataLength | pData[] | txOptions | securityKey | groupId | funcId */
 2784:           {
 2785:             TRANSMIT_MULTI_OPTIONS_TYPE ltTxOptionsMultiEx;
 2786:             BYTE dataLength;
 2787: 
 2788:             dataLength = serFrameDataPtr[0];
B2:00846F 12AAB5            LCALL    ?L?COM04F3
 2789:             if (dataLength > BUF_SIZE_RX)
B2:008472 D3                SETB     C
B2:008473 94A8              SUBB     A,#0A8H
B2:008475 4003              JC       ?C0166?SERIALAPPL
 2790:             {
 2791:               dataLength = BUF_SIZE_RX;
B2:008477 74A8              MOV      A,#0A8H
B2:008479 F0                MOVX     @DPTR,A
 2792:             }
B2:00847A         ?C0166?SERIALAPPL:
 2793:             for (i = 0; i < dataLength; i++)
B2:00847A E4                CLR      A
B2:00847B 9024C6            MOV      DPTR,#i
B2:00847E F0                MOVX     @DPTR,A
B2:00847F         ?C0167?SERIALAPPL:
B2:00847F 904146            MOV      DPTR,#dataLength
B2:008482 129949            LCALL    ?L?COM0161
B2:008485 9D                SUBB     A,R5
B2:008486 500D              JNC      ?C0168?SERIALAPPL
 2794:             {
 2795:               workbuf[i] = serFrameDataPtr[1 + i];
B2:008488 740B              MOV      A,#LOW serBuf+04H
B2:00848A 2F                ADD      A,R7
B2:00848B F582              MOV      DPL,A
B2:00848D E4                CLR      A
B2:00848E 3434              ADDC     A,#HIGH serBuf+04H
B2:008490 1293AA            LCALL    ?L?COM0031
B2:008493 80EA              SJMP     ?C0167?SERIALAPPL
B2:008495         ?C0168?SERIALAPPL:
 2796:             }
 2797:             /* txOptions */
 2798:             ltTxOptionsMultiEx.txOptions = serFrameDataPtr[1 + serFrameDataPtr[0]];
B2:008495 90340A            MOV      DPTR,#serBuf+03H
B2:008498 E0                MOVX     A,@DPTR
B2:008499 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 512


B2:00849A 240B              ADD      A,#LOW serBuf+04H
B2:00849C 12A89A            LCALL    ?L?COM0261
B2:00849F 904144            MOV      DPTR,#ltTxOptionsMultiEx+02H
B2:0084A2 F0                MOVX     @DPTR,A
 2799:             /* securityKey */
 2800:             ltTxOptionsMultiEx.securityKey = serFrameDataPtr[2 + serFrameDataPtr[0]];
B2:0084A3 740C              MOV      A,#LOW serBuf+05H
B2:0084A5 2F                ADD      A,R7
B2:0084A6 12A7D7            LCALL    ?L?COM00FA
B2:0084A9 904145            MOV      DPTR,#ltTxOptionsMultiEx+03H
B2:0084AC F0                MOVX     @DPTR,A
 2801:             /* groupID */
 2802:             ltTxOptionsMultiEx.groupID = serFrameDataPtr[3 + serFrameDataPtr[0]];
B2:0084AD 90340A            MOV      DPTR,#serBuf+03H
B2:0084B0 E0                MOVX     A,@DPTR
B2:0084B1 240D              ADD      A,#LOW serBuf+06H
B2:0084B3 12A7F7            LCALL    ?L?COM0133
B2:0084B6 904142            MOV      DPTR,#ltTxOptionsMultiEx
B2:0084B9 F0                MOVX     @DPTR,A
 2803:             /* funcID */
 2804:             funcID_ComplHandler_ZW_SendDataMultiEx = serFrameDataPtr[4 + serFrameDataPtr[0]];
B2:0084BA 740E              MOV      A,#LOW serBuf+07H
B2:0084BC 2F                ADD      A,R7
B2:0084BD 12A8CC            LCALL    ?L?COM028C
B2:0084C0 FF                MOV      R7,A
B2:0084C1 902163            MOV      DPTR,#funcID_ComplHandler_ZW_SendDataMultiEx
B2:0084C4 F0                MOVX     @DPTR,A
 2805:             retVal = ZW_SendDataMultiEx(workbuf, dataLength, &ltTxOptionsMultiEx,
B2:0084C5 12AA17            LCALL    ?L?COM045F
B2:0084C8 900A3C            MOV      DPTR,#?_ZW_SendDataMultiEx?BYTE+04H
B2:0084CB 122572            LCALL    ?C?PSTXDATA
B2:0084CE EF                MOV      A,R7
B2:0084CF 6006              JZ       ?C0170?SERIALAPPL
B2:0084D1 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendDataMultiEx
B2:0084D3 7F0D              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendDataMultiEx
B2:0084D5 8004              SJMP     ?C0171?SERIALAPPL
B2:0084D7         ?C0170?SERIALAPPL:
B2:0084D7 7E00              MOV      R6,#00H
B2:0084D9 7F00              MOV      R7,#00H
B2:0084DB         ?C0171?SERIALAPPL:
B2:0084DB 900A3F            MOV      DPTR,#?_ZW_SendDataMultiEx?BYTE+07H
B2:0084DE 12A84B            LCALL    ?L?COM019D
B2:0084E1 121985            LCALL    ?INTERBANK_TABLE?_ZW_SendDataMultiEx
B2:0084E4         
 2806:                                       (serFrameDataPtr[4 + serFrameDataPtr[0]] != 0) ? ZCB_ComplHandler_ZW_SendDa
>> taMultiEx : NULL);
 2807:             DoRespond();
 2808:           }
 2809:           break;
B2:0084E4 0290BA            LJMP     ?C0599?SERIALAPPL
 2810: #endif
 2811: 
 2812: #if SUPPORT_ZW_SEND_DATA_ABORT
 2813:         case FUNC_ID_ZW_SEND_DATA_ABORT:
B2:0084E7         ?C0172?SERIALAPPL:
 2814:           /* */
 2815:           ZW_SendDataAbort(); /* If we are in middle of transmitting an application frame then STOP that. */
B2:0084E7 12198A            LCALL    ?INTERBANK_TABLE?ZW_SendDataAbort
 2816:           set_state(stateIdle);
B2:0084EA         
 2817:           break;
B2:0084EA 028E95            LJMP     ?C0589?SERIALAPPL
 2818: #endif
 2819: 
 2820: #if SUPPORT_ZW_SEND_DATA_META
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 513


 2821:         case FUNC_ID_ZW_SEND_DATA_META:
 2822:           /* nodeID | dataLength | pData[] | txOptions | funcID */
 2823:           {
 2824:             BYTE dataLength = serFrameDataPtr[1];
 2825:             if (dataLength > BUF_SIZE_RX)
 2826:             {
 2827:               dataLength = BUF_SIZE_RX;
 2828:             }
 2829:             for (i = 0; i < dataLength; i++)
 2830:             {
 2831:               workbuf[i] = serFrameDataPtr[2 + i];
 2832:             }
 2833:             funcID_ComplHandler_ZW_SendDataMeta = serFrameDataPtr[3 + dataLength];
 2834:             retVal = ZW_SEND_DATA_META(serFrameDataPtr[0], workbuf, dataLength, serFrameDataPtr[2 + dataLength],
 2835:                                        (serFrameDataPtr[3 + dataLength] != 0) ? ZCB_ComplHandler_ZW_SendDataMeta 
>> : NULL);
 2836:             DoRespond();
 2837:           }
 2838:           break;
 2839: #endif
 2840: 
 2841: #if SUPPORT_ZW_SEND_DATA_BRIDGE
 2842:         case FUNC_ID_ZW_SEND_DATA_BRIDGE:
 2843:           /* HOST->ZW: srcNodeID | destNodeID | dataLength | pData[] | txOptions | pRoute[4] | funcID */
 2844:           /* Devkit 6.0x pRoute[4] not used... Use [0,0,0,0] */
 2845:           {
 2846:             BYTE dataLength = serFrameDataPtr[2];
 2847:             if (dataLength > BUF_SIZE_RX)
 2848:             {
 2849:               dataLength = BUF_SIZE_RX;
 2850:             }
 2851:             for (i = 0; i < dataLength; i++)
 2852:             {
 2853:               workbuf[i] = serFrameDataPtr[3 + i];
 2854:             }
 2855:             funcID_ComplHandler_ZW_SendData = serFrameDataPtr[3 + 1 + 4 + dataLength];
 2856:             retVal = ZW_SEND_DATA_BRIDGE(serFrameDataPtr[0], serFrameDataPtr[1], workbuf, dataLength,
 2857:                                          serFrameDataPtr[3 + dataLength],
 2858:                                          (serFrameDataPtr[3 + 1 + 4 + dataLength] != 0) ? ZCB_ComplHandler_ZW_Sen
>> dData_Bridge : NULL);
 2859:             DoRespond();
 2860:           }
 2861:           break;
 2862: #endif
 2863: 
 2864: #if SUPPORT_ZW_SEND_DATA_META_BRIDGE
 2865:         case FUNC_ID_ZW_SEND_DATA_META_BRIDGE:
 2866:           /* HOST->ZW: srcNodeID | destNodeID | dataLength | pData[] | txOptions | pRoute[4] | funcID */
 2867:           /* Devkit 6.0x pRoute[4] not used... Use [0,0,0,0] */
 2868:           {
 2869:             BYTE dataLength = serFrameDataPtr[2];
 2870:             if (dataLength > BUF_SIZE_RX)
 2871:             {
 2872:               dataLength = BUF_SIZE_RX;
 2873:             }
 2874:             for (i = 0; i < dataLength; i++)
 2875:             {
 2876:               workbuf[i] = serFrameDataPtr[3 + i];
 2877:             }
 2878:             funcID_ComplHandler_ZW_SendDataMeta = serFrameDataPtr[3 + 1 + 4 + dataLength];
 2879:             retVal = ZW_SEND_DATA_META_BRIDGE(serFrameDataPtr[0], serFrameDataPtr[1], workbuf, dataLength,
 2880:                                               serFrameDataPtr[3 + dataLength],
 2881:                                               (serFrameDataPtr[3 + 1 + 4 + dataLength] != 0) ? ZCB_ComplHandler_Z
>> W_SendDataMeta_Bridge : NULL);
 2882:             DoRespond();
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 514


 2883:           }
 2884:           break;
 2885: #endif
 2886: 
 2887: #if SUPPORT_ZW_SEND_DATA_MULTI_BRIDGE
 2888:         case FUNC_ID_ZW_SEND_DATA_MULTI_BRIDGE:
 2889:           /* HOST->ZW: srcNodeID | numberNodes | pNodeIDList[] | dataLength | pData[] | txOptions | funcId */
 2890:           {
 2891:             BYTE numberNodes, dataLength, txOptions;
 2892: 
 2893:             numberNodes = serFrameDataPtr[1];
 2894:             /* clear the destination node mask */
 2895:             for (i = 0; i < MAX_NODEMASK_LENGTH; i++)
 2896:             {
 2897:               groupMask[i] = 0;
 2898:             }
 2899:             /* Set the destination node mask bits */
 2900:             for (i = 0; i < numberNodes && i < MAX_GROUP_NODES; i++)
 2901:             {
 2902:               ZW_NodeMaskSetBit(groupMask, serFrameDataPtr[2 + i]);
 2903:             }
 2904:             dataLength = serFrameDataPtr[2 + numberNodes];
 2905:             if (dataLength > BUF_SIZE_RX)
 2906:             {
 2907:               dataLength = BUF_SIZE_RX;
 2908:             }
 2909:             for (i = 0; i < dataLength; i++)
 2910:             {
 2911:               workbuf[i] = serFrameDataPtr[2 + 1 + numberNodes + i];
 2912:             }
 2913:             txOptions = serFrameDataPtr[2 + 1 + numberNodes + dataLength];
 2914: 
 2915:             funcID_ComplHandler_ZW_SendDataMulti = serFrameDataPtr[2 + 1 + 1 + numberNodes + dataLength];
 2916:             retVal = ZW_SEND_DATA_MULTI_BRIDGE(serFrameDataPtr[0], groupMask, workbuf, dataLength, txOptions,
 2917:                                                (serFrameDataPtr[2 + 1 + 1 + numberNodes + dataLength] != 0) ?
 2918:                                                  ZCB_ComplHandler_ZW_SendDataMulti_Bridge : NULL);
 2919:             DoRespond();
 2920:           }
 2921:           break;
 2922: #endif
 2923: 
 2924: #if SUPPORT_MEMORY_GET_ID
 2925:         case FUNC_ID_MEMORY_GET_ID:
B2:0084ED         ?C0173?SERIALAPPL:
 2926:           /*  */
 2927:           ZW_MEMORY_GET_ID(compl_workbuf, compl_workbuf + 4);
B2:0084ED 7B01              MOV      R3,#01H
B2:0084EF 7A20              MOV      R2,#HIGH compl_workbuf+04H
B2:0084F1 7905              MOV      R1,#LOW compl_workbuf+04H
B2:0084F3 126E23            LCALL    ?L?COM01CD
B2:0084F6 7A20              MOV      R2,#HIGH compl_workbuf
B2:0084F8 7901              MOV      R1,#LOW compl_workbuf
B2:0084FA 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetID
 2928:           DoRespond_workbuf(5);
 2929:           break;
B2:0084FD 028C86            LJMP     ?C0567?SERIALAPPL
 2930: #endif
 2931: 
 2932: #if SUPPORT_MEMORY_GET_BYTE
 2933:         case FUNC_ID_MEMORY_GET_BYTE:
B2:008500         ?C0174?SERIALAPPL:
 2934:           /* offset (MSB) | offset (LSB) */
 2935:           retVal = MemoryGetByte(((WORD)&EEOFFSET_HOST_OFFSET_START_far)+
 2936:                                  (((WORD)serFrameDataPtr[0] << 8) + serFrameDataPtr[1]));
B2:008500 12A7E0            LCALL    ?L?COM00FB
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 515


B2:008503 12AA91            LCALL    ?L?COM04EA
B2:008506 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:008509         
 2937:           DoRespond();
 2938:           break;
B2:008509 0290BA            LJMP     ?C0599?SERIALAPPL
 2939: #endif
 2940: 
 2941: #if SUPPORT_MEMORY_PUT_BYTE
 2942:         case FUNC_ID_MEMORY_PUT_BYTE:
B2:00850C         ?C0175?SERIALAPPL:
 2943:           /* HOST->ZW:
 2944:              offset(MSB)        offset into host application NVM memory array
 2945:              offset(LSB)
 2946:              data
 2947:            */
 2948:           /* ZW->HOST:
 2949:              retVal             [retVal=0 ==> error|
 2950:                                  retVal=1 ==> OK (NVM no change)|
 2951:                                  retVal>=2 ==> OK (NVM data bytes written + 1)]
 2952:            */
 2953:           {
 2954:             WORD NVM_WorkPtr;
 2955:             NVM_WorkPtr = ((WORD)&EEOFFSET_HOST_OFFSET_START_far) +
 2956:                            (((WORD)serFrameDataPtr[0] << 8) + serFrameDataPtr[1]);
B2:00850C 12A7E0            LCALL    ?L?COM00FB
B2:00850F 12AA27            LCALL    ?L?COM0477
B2:008512 12A961            LCALL    ?L?COM0361
 2957:             /* Don't go beyond reserved NVM area for host application [sizeof(EEOFFSET_HOST_OFFSET_START_far)] */
>> 
 2958:             if (NVM_WorkPtr >= ((WORD)&EEOFFSET_HOST_OFFSET_START_far) + sizeof(EEOFFSET_HOST_OFFSET_START_far))
B2:008515 12AB09            LCALL    ?L?COM0553
B2:008518 C3                CLR      C
B2:008519 EF                MOV      A,R7
B2:00851A 9D                SUBB     A,R5
B2:00851B EE                MOV      A,R6
B2:00851C 9C                SUBB     A,R4
B2:00851D 4008              JC       ?C0176?SERIALAPPL
 2959:             {
 2960:               retVal = 0;
B2:00851F E4                CLR      A
B2:008520 90279F            MOV      DPTR,#retVal
B2:008523 F0                MOVX     @DPTR,A
 2961:             }
B2:008524 02932F            LJMP     ?C0634?SERIALAPPL
B2:008527         ?C0176?SERIALAPPL:
 2962:             else
 2963:             {
 2964:               /* For external SPI NVM: */
 2965:               /* MemoryPutByte() does not return as it says "RET Number of bytes written +1" */
 2966:               /* instead it returns "RET FALSE if value is identical to value in EEPROM else TRUE" */
 2967:               /* i.e. it will be assumed, that the operation always succeeds */
 2968:               /* For internal FLASH/MTP NVM: */
 2969:               /* MemoryPutByte() does return as it says "RET Number of bytes written +1" */
 2970:               /* i.e. it will be assumed, that the operation always succeeds */
 2971:               retVal = (MemoryPutByte(NVM_WorkPtr, serFrameDataPtr[2]) ? 2 : 1);
B2:008527 12AAC7            LCALL    ?L?COM04F5
B2:00852A 90340C            MOV      DPTR,#serBuf+05H
B2:00852D E0                MOVX     A,@DPTR
B2:00852E FD                MOV      R5,A
B2:00852F 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B2:008532 EF                MOV      A,R7
B2:008533 7F01              MOV      R7,#01H
B2:008535 6002              JZ       ?C0178?SERIALAPPL
B2:008537 7F02              MOV      R7,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 516


B2:008539         ?C0178?SERIALAPPL:
B2:008539         ?C0179?SERIALAPPL:
B2:008539 90279F            MOV      DPTR,#retVal
B2:00853C EF                MOV      A,R7
B2:00853D F0                MOVX     @DPTR,A
 2972:             }
B2:00853E         ?C0177?SERIALAPPL:
 2973:             DoRespond();
 2974:           }
 2975:           break;
B2:00853E 02932F            LJMP     ?C0634?SERIALAPPL
 2976: #endif
 2977: 
 2978: #if SUPPORT_MEMORY_GET_BUFFER
 2979:         case FUNC_ID_MEMORY_GET_BUFFER:
B2:008541         ?C0180?SERIALAPPL:
 2980:           /* offset(MSB) | offset (LSB) | length */
 2981:           {
 2982:             BYTE dataLength = serFrameDataPtr[2];
B2:008541 90340C            MOV      DPTR,#serBuf+05H
B2:008544 E0                MOVX     A,@DPTR
B2:008545 904142            MOV      DPTR,#dataLength
B2:008548 F0                MOVX     @DPTR,A
 2983:             /* Make sure the length isn't larger than the available buffer size */
 2984:             if (dataLength > BUF_SIZE_TX)
B2:008549 D3                SETB     C
B2:00854A 94A8              SUBB     A,#0A8H
B2:00854C 4003              JC       ?C0181?SERIALAPPL
 2985:             {
 2986:               dataLength = BUF_SIZE_TX;
B2:00854E 74A8              MOV      A,#0A8H
B2:008550 F0                MOVX     @DPTR,A
 2987:             }
B2:008551         ?C0181?SERIALAPPL:
 2988:             MemoryGetBuffer(((WORD)&EEOFFSET_HOST_OFFSET_START_far)+
 2989:                             (((WORD)serFrameDataPtr[0] << 8) + serFrameDataPtr[1]), compl_workbuf, dataLength);
B2:008551 12A7E0            LCALL    ?L?COM00FB
B2:008554 12AA91            LCALL    ?L?COM04EA
B2:008557 12A87C            LCALL    ?L?COM0234
B2:00855A 904142            MOV      DPTR,#dataLength
B2:00855D E0                MOVX     A,@DPTR
B2:00855E 9044C0            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B2:008561 F0                MOVX     @DPTR,A
B2:008562 121B97            LCALL    ?INTERBANK_TABLE?_MemoryGetBuffer
 2990:             DoRespond_workbuf(dataLength);
 2991:           }
 2992:           break;
B2:008565 0289F3            LJMP     ?C0570?SERIALAPPL
 2993: #endif
 2994: 
 2995: #if SUPPORT_MEMORY_PUT_BUFFER
 2996:         case FUNC_ID_MEMORY_PUT_BUFFER:
B2:008568         ?C0182?SERIALAPPL:
 2997:           /* HOST->ZW:
 2998:              offset(MSB)        offset into host application NVM memory array
 2999:              offset(LSB)
 3000:              length(MSB)        desired length of write operation
 3001:              length(LSB)
 3002:              buffer[]           buffer
 3003:              funcID
 3004:            */
 3005:           /* ZW->HOST:
 3006:              retVal             [retVal=0 ==> error|
 3007:                                  retVal=1 ==> OK (NVM no change)|
 3008:                                  retVal>=2 ==> OK (NVM data bytes written + 1)]
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 517


 3009:            */
 3010:           {
 3011:             WORD NVM_WorkPtr;
 3012:             WORD length;
 3013:             NVM_WorkPtr = ((WORD)&EEOFFSET_HOST_OFFSET_START_far) +
 3014:                           (((WORD)serFrameDataPtr[0] << 8) + serFrameDataPtr[1]);
B2:008568 12A7E0            LCALL    ?L?COM00FB
B2:00856B 12AA27            LCALL    ?L?COM0477
B2:00856E 12A962            LCALL    ?L?COM0362
 3015:             length = ((WORD)(serFrameDataPtr[2] << 8)) + serFrameDataPtr[3];
B2:008571 90340C            MOV      DPTR,#serBuf+05H
B2:008574 12AB01            LCALL    ?L?COM0551
B2:008577 FE                MOV      R6,A
B2:008578 904144            MOV      DPTR,#length
B2:00857B F0                MOVX     @DPTR,A
B2:00857C A3                INC      DPTR
B2:00857D EF                MOV      A,R7
B2:00857E F0                MOVX     @DPTR,A
 3016:             retVal = 0;
B2:00857F E4                CLR      A
B2:008580 90279F            MOV      DPTR,#retVal
B2:008583 F0                MOVX     @DPTR,A
 3017:             {
 3018:               /* Don't go beyond serial buffer size */
 3019:               /* and don't go beyond reserved NVM area for host application [sizeof(EEOFFSET_HOST_OFFSET_START_fa
>> r)] */
 3020:               if ((length > BUF_SIZE_RX) ||
 3021:                   ((NVM_WorkPtr + length) > ((WORD)&EEOFFSET_HOST_OFFSET_START_far) + sizeof(EEOFFSET_HOST_OFFSET
>> _START_far))
B2:008584 D3                SETB     C
B2:008585 EF                MOV      A,R7
B2:008586 94A8              SUBB     A,#0A8H
B2:008588 EE                MOV      A,R6
B2:008589 9400              SUBB     A,#00H
B2:00858B 501E              JNC      ?C0184?SERIALAPPL
B2:00858D 904144            MOV      DPTR,#length
B2:008590 E0                MOVX     A,@DPTR
B2:008591 FE                MOV      R6,A
B2:008592 A3                INC      DPTR
B2:008593 E0                MOVX     A,@DPTR
B2:008594 FF                MOV      R7,A
B2:008595 904143            MOV      DPTR,#NVM_WorkPtr+01H
B2:008598 E0                MOVX     A,@DPTR
B2:008599 2F                ADD      A,R7
B2:00859A FF                MOV      R7,A
B2:00859B 904142            MOV      DPTR,#NVM_WorkPtr
B2:00859E E0                MOVX     A,@DPTR
B2:00859F 3E                ADDC     A,R6
B2:0085A0 FE                MOV      R6,A
B2:0085A1 12AB09            LCALL    ?L?COM0553
B2:0085A4 D3                SETB     C
B2:0085A5 EF                MOV      A,R7
B2:0085A6 9D                SUBB     A,R5
B2:0085A7 EE                MOV      A,R6
B2:0085A8 9C                SUBB     A,R4
B2:0085A9 4007              JC       ?C0183?SERIALAPPL
B2:0085AB         ?C0184?SERIALAPPL:
 3022:                  )
 3023:               {
 3024:                 retVal = FALSE; /* ignore request if length is larger than available buffer */
B2:0085AB E4                CLR      A
B2:0085AC 90279F            MOV      DPTR,#retVal
B2:0085AF F0                MOVX     @DPTR,A
 3025:               }
B2:0085B0 8052              SJMP     ?C0185?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 518


B2:0085B2         ?C0183?SERIALAPPL:
 3026:               else
 3027:               {
 3028:                 for (i = 0; i <length; i++)
B2:0085B2 E4                CLR      A
B2:0085B3 9024C6            MOV      DPTR,#i
B2:0085B6 F0                MOVX     @DPTR,A
B2:0085B7         ?C0186?SERIALAPPL:
B2:0085B7 9024C6            MOV      DPTR,#i
B2:0085BA E0                MOVX     A,@DPTR
B2:0085BB FF                MOV      R7,A
B2:0085BC 12A869            LCALL    ?L?COM0220
B2:0085BF D3                SETB     C
B2:0085C0 9F                SUBB     A,R7
B2:0085C1 EC                MOV      A,R4
B2:0085C2 9400              SUBB     A,#00H
B2:0085C4 400B              JC       ?C0187?SERIALAPPL
 3029:                 {
 3030:                   workbuf[i] = serFrameDataPtr[4+i];
B2:0085C6 9024C6            MOV      DPTR,#i
B2:0085C9 E0                MOVX     A,@DPTR
B2:0085CA 240E              ADD      A,#LOW serBuf+07H
B2:0085CC 1293A5            LCALL    ?L?COM0030
B2:0085CF 80E6              SJMP     ?C0186?SERIALAPPL
B2:0085D1         ?C0187?SERIALAPPL:
 3031:                 }
 3032:                 funcID_ComplHandler_MemoryPutBuffer = serFrameDataPtr[4+length];
B2:0085D1 740E              MOV      A,#LOW serBuf+07H
B2:0085D3 2D                ADD      A,R5
B2:0085D4 12AABE            LCALL    ?L?COM04F4
B2:0085D7 902460            MOV      DPTR,#funcID_ComplHandler_MemoryPutBuffer
B2:0085DA F0                MOVX     @DPTR,A
 3033:                 retVal = ZW_MEM_PUT_BUFFER(NVM_WorkPtr,
B2:0085DB 12AAC7            LCALL    ?L?COM04F5
B2:0085DE 12A850            LCALL    ?L?COM019F
B2:0085E1 90427B            MOV      DPTR,#?_MemoryPutBuffer?BYTE+05H
B2:0085E4 EC                MOV      A,R4
B2:0085E5 F0                MOVX     @DPTR,A
B2:0085E6 A3                INC      DPTR
B2:0085E7 ED                MOV      A,R5
B2:0085E8 F0                MOVX     @DPTR,A
B2:0085E9 240E              ADD      A,#LOW serBuf+07H
B2:0085EB 12AABE            LCALL    ?L?COM04F4
B2:0085EE 6006              JZ       ?C0189?SERIALAPPL
B2:0085F0 7C1E              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_ComplHandler_MemoryPutBuffer
B2:0085F2 7D30              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_ComplHandler_MemoryPutBuffer
B2:0085F4 8004              SJMP     ?C0190?SERIALAPPL
B2:0085F6         ?C0189?SERIALAPPL:
B2:0085F6 7C00              MOV      R4,#00H
B2:0085F8 7D00              MOV      R5,#00H
B2:0085FA         ?C0190?SERIALAPPL:
B2:0085FA 90427D            MOV      DPTR,#?_MemoryPutBuffer?BYTE+07H
B2:0085FD EC                MOV      A,R4
B2:0085FE F0                MOVX     @DPTR,A
B2:0085FF A3                INC      DPTR
B2:008600 ED                MOV      A,R5
B2:008601 129D71            LCALL    ?L?COM0497
 3034:                                            workbuf, length,
 3035:                                            (serFrameDataPtr[4 + length] != 0) ? ZCB_ComplHandler_MemoryPutBuffer 
>> : NULL);
 3036:               }
B2:008604         ?C0185?SERIALAPPL:
 3037:             }
 3038:             DoRespond();
B2:008604         
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 519


 3039:           }
 3040:           break;
B2:008604 02932F            LJMP     ?C0634?SERIALAPPL
 3041: #endif
 3042: 
 3043: #if SUPPORT_NVM_BACKUP_RESTORE
 3044:         case FUNC_ID_NVM_BACKUP_RESTORE:
B2:008607         ?C0191?SERIALAPPL:
 3045:           /* HOST->ZW:
 3046:              operation          [open=0|read=1|write=2|close=3]
 3047:              length             desired length of read/write operation
 3048:              offset(MSB)        pointer to NVM memory
 3049:              offset(LSB)
 3050:              buffer[]           buffer only sent for operation=write
 3051:            */
 3052:           /* ZW->HOST:
 3053:              retVal             [OK=0|error=1|EOF=-1]
 3054:              length             actual length of read/written data
 3055:              offset(MSB)        pointer to NVM memory (EOF ptr for operation=open)
 3056:              offset(LSB)
 3057:              buffer[]           buffer only returned for operation=read
 3058:            */
 3059:           {
 3060:             eNVMBackupRestoreOperation NVMBackupRestoreOperationInProgress;
 3061:             WORD NVM_WorkPtr;
 3062:             BYTE dataLength;
 3063: 
 3064:             dataLength = 0; /* Assume nothing is read or written */
B2:008607 E4                CLR      A
B2:008608 904145            MOV      DPTR,#dataLength
B2:00860B F0                MOVX     @DPTR,A
 3065:             compl_workbuf[0] = NVMBackupRestoreReturnValueOK;   /* Assume not at EOF and no ERROR */
B2:00860C 902001            MOV      DPTR,#compl_workbuf
B2:00860F 126F69            LCALL    ?L?COM0404
 3066:             compl_workbuf[1] = 0;                               /* Assume no data */
 3067:             compl_workbuf[2] = 0;
 3068:             compl_workbuf[3] = 0;
 3069:             switch (serFrameDataPtr[0]) /* operation */
B2:008612 90340A            MOV      DPTR,#serBuf+03H
B2:008615 E0                MOVX     A,@DPTR
B2:008616 14                DEC      A
B2:008617 6022              JZ       ?C0194?SERIALAPPL
B2:008619 14                DEC      A
B2:00861A 6070              JZ       ?C0199?SERIALAPPL
B2:00861C 14                DEC      A
B2:00861D 7002              JNZ      $ + 4H
B2:00861F C1F7              AJMP     ?C0207?SERIALAPPL
B2:008621 2403              ADD      A,#03H
B2:008623 6002              JZ       $ + 4H
B2:008625 E114              AJMP     ?C0192?SERIALAPPL
 3070:             {
 3071:               case NVMBackupRestoreOperationOpen: /* open */
B2:008627         ?C0193?SERIALAPPL:
 3072:                 /* Lock everyone else out from making changes to the NVM content */
 3073:                 /* Remember to have some kind of dead-mans-pedal to release lock again. */
 3074:                 /* TODO */
 3075:                 NVMBackupRestoreOperationInProgress = NVMBackupRestoreOperationOpen;
B2:008627 12A951            LCALL    ?L?COM035F
B2:00862A A3                INC      DPTR
B2:00862B F0                MOVX     @DPTR,A
 3076:                 NVM_WorkPtr = 0;
 3077:                 /* Tell him the expected size of backup/restore */
 3078:                 compl_workbuf[2] = (NVM_STORAGE_END >> 8) & 0xFF;
B2:00862C 741C              MOV      A,#HIGH _HDATA_E_
B2:00862E 902003            MOV      DPTR,#compl_workbuf+02H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 520


B2:008631 F0                MOVX     @DPTR,A
 3079:                 compl_workbuf[3] = NVM_STORAGE_END & 0xFF;
B2:008632 7484              MOV      A,#LOW _HDATA_E_
B2:008634 A3                INC      DPTR
B2:008635 F0                MOVX     @DPTR,A
 3080:                 MemoryClearStatus();
B2:008636 121BA6            LCALL    ?INTERBANK_TABLE?MemoryClearStatus
 3081:                 break;
B2:008639 E114              AJMP     ?C0192?SERIALAPPL
 3082: 
 3083:               case NVMBackupRestoreOperationRead: /* read */
B2:00863B         ?C0194?SERIALAPPL:
 3084:                 /* Validate input */
 3085:                 if ((NVMBackupRestoreOperationInProgress != NVMBackupRestoreOperationRead) &&
B2:00863B 904142            MOV      DPTR,#NVMBackupRestoreOperationInProgress
B2:00863E E0                MOVX     A,@DPTR
B2:00863F FF                MOV      R7,A
B2:008640 6401              XRL      A,#01H
B2:008642 6005              JZ       ?C0195?SERIALAPPL
B2:008644 EF                MOV      A,R7
B2:008645 6002              JZ       ?C0195?SERIALAPPL
 3086:                     (NVMBackupRestoreOperationInProgress != NVMBackupRestoreOperationOpen))
 3087:                 {
 3088:                   compl_workbuf[0] = NVMBackupRestoreReturnValueOperationMismatch;
 3089:                   break;
B2:008647 804F              SJMP     ?C0572?SERIALAPPL
 3090:                 }
B2:008649         ?C0195?SERIALAPPL:
 3091:                 NVMBackupRestoreOperationInProgress = NVMBackupRestoreOperationRead;
B2:008649 7401              MOV      A,#01H
B2:00864B 12A824            LCALL    ?L?COM019B
B2:00864E D3                SETB     C
B2:00864F 94A4              SUBB     A,#0A4H
B2:008651 4004              JC       ?C0196?SERIALAPPL
 3092:                 dataLength = serFrameDataPtr[1];                /* Requested dataLength */
 3093:                 NVM_WorkPtr = (((WORD)serFrameDataPtr[2] << 8) + serFrameDataPtr[3]);
 3094:                 /* Make sure that length isn't larger than the available buffer size */
 3095:                 if (dataLength > BUF_SIZE_TX - 4)
 3096:                 {
 3097:                   dataLength = BUF_SIZE_TX - 4;
B2:008653 A3                INC      DPTR
B2:008654 74A4              MOV      A,#0A4H
B2:008656 F0                MOVX     @DPTR,A
 3098:                 }
B2:008657         ?C0196?SERIALAPPL:
 3099:                 /* Make sure that we don't go beyond valid NVM content */
 3100:                 if ((NVM_WorkPtr + dataLength) > NVM_STORAGE_END)
B2:008657 12A8AE            LCALL    ?L?COM0273
B2:00865A 4006              JC       ?C0197?SERIALAPPL
 3101:                 {
 3102:                   dataLength = NVM_STORAGE_END - NVM_WorkPtr + 1;
B2:00865C 12A9B6            LCALL    ?L?COM03CF
B2:00865F 74FF              MOV      A,#0FFH
B2:008661 F0                MOVX     @DPTR,A
 3103:                   compl_workbuf[0] = NVMBackupRestoreReturnValueEOF;        /* Indicate at EOF */
 3104:                 }
B2:008662         ?C0197?SERIALAPPL:
 3105:                 compl_workbuf[1] = dataLength;
B2:008662 904145            MOV      DPTR,#dataLength
B2:008665 E0                MOVX     A,@DPTR
B2:008666 FD                MOV      R5,A
B2:008667 12A907            LCALL    ?L?COM02FA
 3106:                 compl_workbuf[2] = serFrameDataPtr[2];
 3107:                 compl_workbuf[3] = serFrameDataPtr[3];
 3108:                 MemoryGetBuffer(NVM_WorkPtr, &compl_workbuf[4], dataLength);
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 521


B2:00866A 904143            MOV      DPTR,#NVM_WorkPtr
B2:00866D 126F7C            LCALL    ?L?COM0406
B2:008670 7A20              MOV      R2,#HIGH compl_workbuf+04H
B2:008672 7905              MOV      R1,#LOW compl_workbuf+04H
B2:008674 9044C0            MOV      DPTR,#?_MemoryGetBuffer?BYTE+05H
B2:008677 ED                MOV      A,R5
B2:008678 F0                MOVX     @DPTR,A
B2:008679 121B97            LCALL    ?INTERBANK_TABLE?_MemoryGetBuffer
 3109:                 if (MemoryGetStatus())
B2:00867C 121BA1            LCALL    ?INTERBANK_TABLE?MemoryGetStatus
B2:00867F EF                MOV      A,R7
B2:008680 7002              JNZ      $ + 4H
B2:008682 E114              AJMP     ?C0192?SERIALAPPL
 3110:                 {
 3111:                   compl_workbuf[0] = NVMBackupRestoreReturnValueOperationDisturbed;
B2:008684 902001            MOV      DPTR,#compl_workbuf
B2:008687 7403              MOV      A,#03H
B2:008689 F0                MOVX     @DPTR,A
 3112:                 }
 3113:                 break;
B2:00868A E114              AJMP     ?C0192?SERIALAPPL
 3114: 
 3115:               case NVMBackupRestoreOperationWrite: /* write */
B2:00868C         ?C0199?SERIALAPPL:
 3116:                 /* Validate input */
 3117:                 if ((NVMBackupRestoreOperationInProgress != NVMBackupRestoreOperationWrite) &&
B2:00868C 904142            MOV      DPTR,#NVMBackupRestoreOperationInProgress
B2:00868F E0                MOVX     A,@DPTR
B2:008690 FF                MOV      R7,A
B2:008691 6402              XRL      A,#02H
B2:008693 600B              JZ       ?C0200?SERIALAPPL
B2:008695 EF                MOV      A,R7
B2:008696 6008              JZ       ?C0200?SERIALAPPL
 3118:                     (NVMBackupRestoreOperationInProgress != NVMBackupRestoreOperationOpen))
 3119:                 {
 3120:                   compl_workbuf[0] = NVMBackupRestoreReturnValueOperationMismatch;
B2:008698         
B2:008698 902001            MOV      DPTR,#compl_workbuf
B2:00869B 7402              MOV      A,#02H
B2:00869D F0                MOVX     @DPTR,A
 3121:                   break;
B2:00869E 8074              SJMP     ?C0192?SERIALAPPL
 3122:                 }
B2:0086A0         ?C0200?SERIALAPPL:
 3123:                 NVMBackupRestoreOperationInProgress = NVMBackupRestoreOperationWrite;
B2:0086A0 7402              MOV      A,#02H
B2:0086A2 12A824            LCALL    ?L?COM019B
B2:0086A5 D3                SETB     C
B2:0086A6 94A8              SUBB     A,#0A8H
B2:0086A8 4008              JC       ?C0201?SERIALAPPL
 3124:                 dataLength = serFrameDataPtr[1];                /* Requested dataLength */
 3125:                 NVM_WorkPtr = (((WORD)serFrameDataPtr[2] << 8) + serFrameDataPtr[3]);
 3126: 
 3127:                 if (dataLength > BUF_SIZE_RX)
 3128:                 {
 3129:                   compl_workbuf[0] = TRUE; /* ERROR: ignore request if length is larger than available buffer */
B2:0086AA 902001            MOV      DPTR,#compl_workbuf
B2:0086AD 7401              MOV      A,#01H
B2:0086AF F0                MOVX     @DPTR,A
 3130:                 }
B2:0086B0 8062              SJMP     ?C0192?SERIALAPPL
B2:0086B2         ?C0201?SERIALAPPL:
 3131:                 else
 3132:                 {
 3133:                   /* Make sure that we don't go beyond valid NVM content */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 522


 3134:                   if ((NVM_WorkPtr + dataLength) > NVM_STORAGE_END)
B2:0086B2 12A8AE            LCALL    ?L?COM0273
B2:0086B5 4006              JC       ?C0203?SERIALAPPL
 3135:                   {
 3136:                     dataLength = NVM_STORAGE_END - NVM_WorkPtr + 1;
B2:0086B7 12A9B6            LCALL    ?L?COM03CF
B2:0086BA 74FF              MOV      A,#0FFH
B2:0086BC F0                MOVX     @DPTR,A
 3137:                     compl_workbuf[0] = EOF;                       /* Indicate at EOF */
 3138:                   }
B2:0086BD         ?C0203?SERIALAPPL:
 3139:                   for (i = 0; i < dataLength; i++)
B2:0086BD E4                CLR      A
B2:0086BE 9024C6            MOV      DPTR,#i
B2:0086C1 F0                MOVX     @DPTR,A
B2:0086C2         ?C0204?SERIALAPPL:
B2:0086C2 904145            MOV      DPTR,#dataLength
B2:0086C5 129949            LCALL    ?L?COM0161
B2:0086C8 9D                SUBB     A,R5
B2:0086C9 5008              JNC      ?C0205?SERIALAPPL
 3140:                   {
 3141:                     workbuf[i] = serFrameDataPtr[4+i];
B2:0086CB 740E              MOV      A,#LOW serBuf+07H
B2:0086CD 2F                ADD      A,R7
B2:0086CE 1293A5            LCALL    ?L?COM0030
B2:0086D1 80EF              SJMP     ?C0204?SERIALAPPL
B2:0086D3         ?C0205?SERIALAPPL:
 3142:                   }
 3143:                   retVal = ZW_MEM_PUT_BUFFER(NVM_WorkPtr, workbuf, dataLength, NULL);
B2:0086D3 904143            MOV      DPTR,#NVM_WorkPtr
B2:0086D6 E0                MOVX     A,@DPTR
B2:0086D7 FE                MOV      R6,A
B2:0086D8 A3                INC      DPTR
B2:0086D9 E0                MOVX     A,@DPTR
B2:0086DA FF                MOV      R7,A
B2:0086DB 12A850            LCALL    ?L?COM019F
B2:0086DE 90427B            MOV      DPTR,#?_MemoryPutBuffer?BYTE+05H
B2:0086E1 E4                CLR      A
B2:0086E2 126E7C            LCALL    ?L?COM02C2
B2:0086E5 A3                INC      DPTR
B2:0086E6 129D71            LCALL    ?L?COM0497
 3144:                   compl_workbuf[1] = dataLength;                /* Data written */
B2:0086E9 904145            MOV      DPTR,#dataLength
B2:0086EC E0                MOVX     A,@DPTR
B2:0086ED 12A907            LCALL    ?L?COM02FA
 3145:                   compl_workbuf[2] = serFrameDataPtr[2];
 3146:                   compl_workbuf[3] = serFrameDataPtr[3];
 3147:                   dataLength = 0;                               /* No data returned */
B2:0086F0 E4                CLR      A
B2:0086F1 904145            MOV      DPTR,#dataLength
B2:0086F4 F0                MOVX     @DPTR,A
 3148:                 }
 3149:                 break;
B2:0086F5 801D              SJMP     ?C0192?SERIALAPPL
 3150: 
 3151:               case NVMBackupRestoreOperationClose: /* close */
B2:0086F7         ?C0207?SERIALAPPL:
 3152:                 /* Unlock NVM content, so everyone else can make changes again */
 3153:                 /* TODO */
 3154:                 if ((NVMBackupRestoreOperationInProgress == NVMBackupRestoreOperationRead) &&
B2:0086F7 904142            MOV      DPTR,#NVMBackupRestoreOperationInProgress
B2:0086FA E0                MOVX     A,@DPTR
B2:0086FB B4010C            CJNE     A,#01H,?C0208?SERIALAPPL
B2:0086FE 121BA1            LCALL    ?INTERBANK_TABLE?MemoryGetStatus
B2:008701 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 523


B2:008702 6006              JZ       ?C0208?SERIALAPPL
 3155:                     MemoryGetStatus())
 3156:                 {
 3157:                   compl_workbuf[0] = NVMBackupRestoreReturnValueOperationDisturbed;
B2:008704 902001            MOV      DPTR,#compl_workbuf
B2:008707 7403              MOV      A,#03H
B2:008709 F0                MOVX     @DPTR,A
 3158:                 }
B2:00870A         ?C0208?SERIALAPPL:
 3159:                 NVMBackupRestoreOperationInProgress = NVMBackupRestoreOperationClose;
B2:00870A 904142            MOV      DPTR,#NVMBackupRestoreOperationInProgress
B2:00870D 7403              MOV      A,#03H
B2:00870F F0                MOVX     @DPTR,A
 3160:                 NVM_WorkPtr = NVM_STORAGE_END;
B2:008710 A3                INC      DPTR
B2:008711 12706C            LCALL    ?L?COM0552
 3161:                 break;
 3162: 
 3163:               default:
 3164:                 break;
 3165:             }
B2:008714         ?C0192?SERIALAPPL:
 3166:             DoRespond_workbuf(dataLength + 4);
B2:008714 904145            MOV      DPTR,#dataLength
B2:008717 E0                MOVX     A,@DPTR
B2:008718 2404              ADD      A,#04H
 3167:           }
 3168:           break;
B2:00871A 0289F7            LJMP     ?C0577?SERIALAPPL
 3169: #endif
 3170: 
 3171: #if SUPPORT_NVM_GET_ID
 3172:         case FUNC_ID_NVM_GET_ID:
B2:00871D         ?C0210?SERIALAPPL:
 3173:           /* HOST->ZW: */
 3174:           /* ZW->HOST: length | manufacturerID | memoryType | memoryCapacity */
 3175:           {
 3176:             NVM_TYPE_T nvmTypeT;
 3177: 
 3178:             NVM_get_id(&nvmTypeT);
B2:00871D 12AA17            LCALL    ?L?COM045F
B2:008720 126B51            LCALL    _NVM_get_id
 3179:             i = 0;
B2:008723 E4                CLR      A
B2:008724 9024C6            MOV      DPTR,#i
B2:008727 F0                MOVX     @DPTR,A
 3180:             compl_workbuf[++i] = nvmTypeT.manufacturerID;
B2:008728 904142            MOV      DPTR,#nvmTypeT
B2:00872B E0                MOVX     A,@DPTR
B2:00872C FF                MOV      R7,A
B2:00872D 1293BA            LCALL    ?L?COM0034
B2:008730 2401              ADD      A,#LOW compl_workbuf
B2:008732 129A59            LCALL    ?L?COM0052
B2:008735 EF                MOV      A,R7
B2:008736 F0                MOVX     @DPTR,A
 3181:             compl_workbuf[++i] = nvmTypeT.memoryType;
B2:008737 904143            MOV      DPTR,#nvmTypeT+01H
B2:00873A E0                MOVX     A,@DPTR
B2:00873B FF                MOV      R7,A
B2:00873C 1293BA            LCALL    ?L?COM0034
B2:00873F 2401              ADD      A,#LOW compl_workbuf
B2:008741 129A59            LCALL    ?L?COM0052
B2:008744 EF                MOV      A,R7
B2:008745 F0                MOVX     @DPTR,A
 3182:             compl_workbuf[++i] = nvmTypeT.memoryCapacity;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 524


B2:008746 904144            MOV      DPTR,#nvmTypeT+02H
B2:008749 E0                MOVX     A,@DPTR
B2:00874A FF                MOV      R7,A
B2:00874B 1293BA            LCALL    ?L?COM0034
B2:00874E 2401              ADD      A,#LOW compl_workbuf
B2:008750 129A59            LCALL    ?L?COM0052
B2:008753 EF                MOV      A,R7
B2:008754 F0                MOVX     @DPTR,A
 3183:             compl_workbuf[0] = i;
B2:008755 12A9AC            LCALL    ?L?COM03CD
B2:008758         
 3184:             DoRespond_workbuf(i + 1);
 3185:           }
 3186:           break;
B2:008758 0289F7            LJMP     ?C0577?SERIALAPPL
 3187: #endif
 3188: 
 3189: #if SUPPORT_NVM_EXT_READ_LONG_BYTE
 3190:         case FUNC_ID_NVM_EXT_READ_LONG_BYTE:
B2:00875B         ?C0211?SERIALAPPL:
 3191:           /* HOST->ZW: offset3byte(MSB) | offset3byte | offset3byte(LSB) */
 3192:           /* ZW->HOST: dataread */
 3193:           {
 3194:             retVal = FALSE;
B2:00875B 12A857            LCALL    ?L?COM01E4
B2:00875E E0                MOVX     A,@DPTR
B2:00875F FF                MOV      R7,A
B2:008760 7405              MOV      A,#05H
B2:008762 C3                CLR      C
B2:008763 9F                SUBB     A,R7
B2:008764 5024              JNC      ?C0212?SERIALAPPL
 3195:             if ((FRAME_LENGTH_MIN + 2) < serFrameLen)
 3196:             {
 3197:               retVal = NVM_ext_read_long_byte((DWORD)(((DWORD)serFrameDataPtr[0] << 16) + ((WORD)serFrameDataPtr[
>> 1] << 8) + serFrameDataPtr[2]));
B2:008766 90340A            MOV      DPTR,#serBuf+03H
B2:008769 12A7CD            LCALL    ?L?COM0069
B2:00876C 7810              MOV      R0,#010H
B2:00876E 1223C1            LCALL    ?C?LSHL
B2:008771 C006              PUSH     AR6
B2:008773 C007              PUSH     AR7
B2:008775 12A883            LCALL    ?L?COM0235
B2:008778 D007              POP      AR7
B2:00877A D006              POP      AR6
B2:00877C 12A7C1            LCALL    ?L?COM0068
B2:00877F 122234            LCALL    ?C?LADD
B2:008782 12371B            LCALL    _NVM_ext_read_long_byte
B2:008785 90279F            MOV      DPTR,#retVal
B2:008788 EF                MOV      A,R7
B2:008789 F0                MOVX     @DPTR,A
 3198:             }
B2:00878A         ?C0212?SERIALAPPL:
 3199:             DoRespond();
B2:00878A         
 3200:           }
 3201:           break;
B2:00878A 02932F            LJMP     ?C0634?SERIALAPPL
 3202: #endif
 3203: 
 3204: #if SUPPORT_NVM_EXT_WRITE_LONG_BYTE
 3205:         case FUNC_ID_NVM_EXT_WRITE_LONG_BYTE:
B2:00878D         ?C0213?SERIALAPPL:
 3206:           /* HOST->ZW: offset3byte(MSB) | offset3byte | offset3byte(LSB) | data */
 3207:           /* ZW->HOST: writestatus */
 3208:           {
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 525


 3209:             retVal = FALSE;
B2:00878D 12A857            LCALL    ?L?COM01E4
B2:008790 E0                MOVX     A,@DPTR
B2:008791 FF                MOV      R7,A
B2:008792 7406              MOV      A,#06H
B2:008794 C3                CLR      C
B2:008795 9F                SUBB     A,R7
B2:008796 5028              JNC      ?C0214?SERIALAPPL
 3210:             if ((FRAME_LENGTH_MIN + 3) < serFrameLen)
 3211:             {
 3212:               retVal = NVM_ext_write_long_byte((DWORD)(((DWORD)serFrameDataPtr[0] << 16) + ((WORD)serFrameDataPtr
>> [1] << 8) + serFrameDataPtr[2]),
B2:008798 90340A            MOV      DPTR,#serBuf+03H
B2:00879B 12A7CD            LCALL    ?L?COM0069
B2:00879E 7810              MOV      R0,#010H
B2:0087A0 1223C1            LCALL    ?C?LSHL
B2:0087A3 C006              PUSH     AR6
B2:0087A5 C007              PUSH     AR7
B2:0087A7 12A883            LCALL    ?L?COM0235
B2:0087AA D007              POP      AR7
B2:0087AC D006              POP      AR6
B2:0087AE 12A7C1            LCALL    ?L?COM0068
B2:0087B1 122234            LCALL    ?C?LADD
B2:0087B4 A3                INC      DPTR
B2:0087B5 E0                MOVX     A,@DPTR
B2:0087B6 9044FF            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
B2:0087B9 F0                MOVX     @DPTR,A
B2:0087BA 1236CE            LCALL    _NVM_ext_write_long_byte
B2:0087BD 12AA81            LCALL    ?L?COM0494
 3213:                                                serFrameDataPtr[3]);
 3214:             }
B2:0087C0         ?C0214?SERIALAPPL:
 3215:             DoRespond();
B2:0087C0         
 3216:           }
 3217:           break;
B2:0087C0 02932F            LJMP     ?C0634?SERIALAPPL
 3218: #endif
 3219: 
 3220: #if SUPPORT_NVM_EXT_READ_LONG_BUFFER
 3221:         case FUNC_ID_NVM_EXT_READ_LONG_BUFFER:
B2:0087C3         ?C0215?SERIALAPPL:
 3222:           /* HOST->ZW: offset3byte(MSB) | offset3byte | offset3byte(LSB) | length2byte(MSB) | length2byte(LSB) */
>> 
 3223:           /* ZW->HOST: data[] */
 3224:           {
 3225:             WORD dataLength = 0;
B2:0087C3 12A951            LCALL    ?L?COM035F
 3226:             /* Ignore if frame is to short */
 3227:             if ((FRAME_LENGTH_MIN + 3 + 1) < serFrameLen)
B2:0087C6 903407            MOV      DPTR,#serBuf
B2:0087C9 E0                MOVX     A,@DPTR
B2:0087CA FF                MOV      R7,A
B2:0087CB 7407              MOV      A,#07H
B2:0087CD C3                CLR      C
B2:0087CE 9F                SUBB     A,R7
B2:0087CF 5047              JNC      ?C0216?SERIALAPPL
 3228:             {
 3229:               dataLength = ((WORD)(serFrameDataPtr[3] << 8)) + serFrameDataPtr[4];
B2:0087D1 90340D            MOV      DPTR,#serBuf+06H
B2:0087D4 12AB01            LCALL    ?L?COM0551
B2:0087D7 12A961            LCALL    ?L?COM0361
 3230:               /* Make sure the length isn't larger than the available buffer size */
 3231:               if (dataLength > BUF_SIZE_TX)
B2:0087DA D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 526


B2:0087DB 94A8              SUBB     A,#0A8H
B2:0087DD EE                MOV      A,R6
B2:0087DE 9400              SUBB     A,#00H
B2:0087E0 4009              JC       ?C0217?SERIALAPPL
 3232:               {
 3233:                 dataLength = BUF_SIZE_TX;
B2:0087E2 904142            MOV      DPTR,#dataLength
B2:0087E5 E4                CLR      A
B2:0087E6 F0                MOVX     @DPTR,A
B2:0087E7 A3                INC      DPTR
B2:0087E8 74A8              MOV      A,#0A8H
B2:0087EA F0                MOVX     @DPTR,A
 3234:               }
B2:0087EB         ?C0217?SERIALAPPL:
 3235:               NVM_ext_read_long_buffer((DWORD)(((DWORD)serFrameDataPtr[0] << 16) + ((WORD)serFrameDataPtr[1] << 8
>> ) + serFrameDataPtr[2]), compl_workbuf, dataLength);
B2:0087EB 90340A            MOV      DPTR,#serBuf+03H
B2:0087EE 12A7CD            LCALL    ?L?COM0069
B2:0087F1 7810              MOV      R0,#010H
B2:0087F3 1223C1            LCALL    ?C?LSHL
B2:0087F6 C006              PUSH     AR6
B2:0087F8 C007              PUSH     AR7
B2:0087FA 12A883            LCALL    ?L?COM0235
B2:0087FD D007              POP      AR7
B2:0087FF D006              POP      AR6
B2:008801 12A7C1            LCALL    ?L?COM0068
B2:008804 122234            LCALL    ?C?LADD
B2:008807 C007              PUSH     AR7
B2:008809 12A87C            LCALL    ?L?COM0234
B2:00880C 904142            MOV      DPTR,#dataLength
B2:00880F 126F51            LCALL    ?L?COM03FD
B2:008812 F0                MOVX     @DPTR,A
B2:008813 D007              POP      AR7
B2:008815 123817            LCALL    _NVM_ext_read_long_buffer
 3236:             }
B2:008818         ?C0216?SERIALAPPL:
 3237:             DoRespond_workbuf(dataLength);
B2:008818 904142            MOV      DPTR,#dataLength
B2:00881B A3                INC      DPTR
B2:00881C E0                MOVX     A,@DPTR
B2:00881D         
 3238:           }
 3239:           break;
B2:00881D 21F7              AJMP     ?C0577?SERIALAPPL
 3240: #endif
 3241: 
 3242: #if SUPPORT_NVM_EXT_WRITE_LONG_BUFFER
 3243:         case FUNC_ID_NVM_EXT_WRITE_LONG_BUFFER:
B2:00881F         ?C0218?SERIALAPPL:
 3244:           /* HOST->ZW: offset3byte(MSB) | offset3byte | offset2byte(LSB) | length2byte(MSB) | length2byte(LSB) | 
>> buffer[] */
 3245:           /* ZW->HOST: retVal */
 3246:           {
 3247:             WORD length;
 3248:             retVal = FALSE;
B2:00881F 12A857            LCALL    ?L?COM01E4
B2:008822 E0                MOVX     A,@DPTR
B2:008823 FF                MOV      R7,A
B2:008824 7409              MOV      A,#09H
B2:008826 C3                CLR      C
B2:008827 9F                SUBB     A,R7
B2:008828 5078              JNC      ?C0219?SERIALAPPL
 3249:             /* Ignore if frame has no data to write */
 3250:             if ((FRAME_LENGTH_MIN + 6) < serFrameLen)
 3251:             {
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 527


 3252:               length = ((WORD)(serFrameDataPtr[3] << 8)) + serFrameDataPtr[4];
B2:00882A 90340D            MOV      DPTR,#serBuf+06H
B2:00882D 12AA02            LCALL    ?L?COM043D
B2:008830 904142            MOV      DPTR,#length
B2:008833 F0                MOVX     @DPTR,A
B2:008834 A3                INC      DPTR
B2:008835 ED                MOV      A,R5
B2:008836 F0                MOVX     @DPTR,A
 3253:               /* Ignore write if length exceeds specified data-array */
 3254:               if (length <= serFrameLen - FRAME_LENGTH_MIN)
B2:008837 EF                MOV      A,R7
B2:008838 24FD              ADD      A,#0FDH
B2:00883A 12AAF9            LCALL    ?L?COM0550
B2:00883D 5063              JNC      ?C0219?SERIALAPPL
 3255:               {
 3256:                 /* ignore request if length is larger than available buffer */
 3257:                 if (length < BUF_SIZE_RX)
B2:00883F C3                CLR      C
B2:008840 E0                MOVX     A,@DPTR
B2:008841 94A8              SUBB     A,#0A8H
B2:008843 904142            MOV      DPTR,#length
B2:008846 E0                MOVX     A,@DPTR
B2:008847 9400              SUBB     A,#00H
B2:008849 5057              JNC      ?C0219?SERIALAPPL
 3258:                 {
 3259:                   for (i = 0; i < length; i++)
B2:00884B E4                CLR      A
B2:00884C 9024C6            MOV      DPTR,#i
B2:00884F F0                MOVX     @DPTR,A
B2:008850         ?C0222?SERIALAPPL:
B2:008850 9024C6            MOV      DPTR,#i
B2:008853 E0                MOVX     A,@DPTR
B2:008854 FF                MOV      R7,A
B2:008855 D3                SETB     C
B2:008856 904143            MOV      DPTR,#length+01H
B2:008859 E0                MOVX     A,@DPTR
B2:00885A 9F                SUBB     A,R7
B2:00885B 904142            MOV      DPTR,#length
B2:00885E E0                MOVX     A,@DPTR
B2:00885F 9400              SUBB     A,#00H
B2:008861 4010              JC       ?C0223?SERIALAPPL
 3260:                   {
 3261:                     workbuf[i] = serFrameDataPtr[5+i];
B2:008863 9024C6            MOV      DPTR,#i
B2:008866 E0                MOVX     A,@DPTR
B2:008867 240F              ADD      A,#LOW serBuf+08H
B2:008869 F582              MOV      DPL,A
B2:00886B E4                CLR      A
B2:00886C 3434              ADDC     A,#HIGH serBuf+08H
B2:00886E 1293AA            LCALL    ?L?COM0031
B2:008871 80DD              SJMP     ?C0222?SERIALAPPL
B2:008873         ?C0223?SERIALAPPL:
 3262:                   }
 3263:                   retVal = NVM_ext_write_long_buffer((DWORD)(((DWORD)serFrameDataPtr[0] << 16) + ((WORD)serFrameD
>> ataPtr[1] << 8) + serFrameDataPtr[2]),
B2:008873 90340A            MOV      DPTR,#serBuf+03H
B2:008876 12A7CD            LCALL    ?L?COM0069
B2:008879 7810              MOV      R0,#010H
B2:00887B 1223C1            LCALL    ?C?LSHL
B2:00887E C006              PUSH     AR6
B2:008880 C007              PUSH     AR7
B2:008882 12A883            LCALL    ?L?COM0235
B2:008885 D007              POP      AR7
B2:008887 D006              POP      AR6
B2:008889 12A7C1            LCALL    ?L?COM0068
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 528


B2:00888C 122234            LCALL    ?C?LADD
B2:00888F C007              PUSH     AR7
B2:008891 12A850            LCALL    ?L?COM019F
B2:008894 904142            MOV      DPTR,#length
B2:008897 126E91            LCALL    ?L?COM02DE
B2:00889A D007              POP      AR7
B2:00889C 123A14            LCALL    _NVM_ext_write_long_buffer
B2:00889F 12AA81            LCALL    ?L?COM0494
 3264:                                              workbuf, length);
 3265:                 }
 3266:               }
 3267:             }
B2:0088A2         ?C0219?SERIALAPPL:
 3268:             DoRespond();
B2:0088A2         
 3269:           }
 3270:           break;
B2:0088A2 02932F            LJMP     ?C0634?SERIALAPPL
 3271: #endif
 3272: 
 3273: #if SUPPORT_ZW_FIRMWARE_UPDATE_NVM
 3274:         case FUNC_ID_ZW_FIRMWARE_UPDATE_NVM:
B2:0088A5         ?C0225?SERIALAPPL:
 3275:           /* HOST->ZW: firmwareUpdateFunction [| data[...]] */
 3276:           /* ZW->HOST: firmwareUpdateFunction [| retVal[...]] */
 3277:           {
 3278:             WORD fw_crc;
 3279:             WORD length;
 3280:             FIRMWARE_UPDATE_NVM_T bFirmwareUpdateFunction = (FIRMWARE_UPDATE_NVM_T)serFrameDataPtr[0];
B2:0088A5 12AAB5            LCALL    ?L?COM04F3
 3281:             BYTE_IN_AR(compl_workbuf, 0) = bFirmwareUpdateFunction;
B2:0088A8 902001            MOV      DPTR,#compl_workbuf
B2:0088AB F0                MOVX     @DPTR,A
 3282:             switch (bFirmwareUpdateFunction)
B2:0088AC 14                DEC      A
B2:0088AD 601B              JZ       ?C0228?SERIALAPPL
B2:0088AF 14                DEC      A
B2:0088B0 6022              JZ       ?C0229?SERIALAPPL
B2:0088B2 14                DEC      A
B2:0088B3 6028              JZ       ?C0230?SERIALAPPL
B2:0088B5 14                DEC      A
B2:0088B6 7002              JNZ      $ + 4H
B2:0088B8 213D              AJMP     ?C0231?SERIALAPPL
B2:0088BA 14                DEC      A
B2:0088BB 7002              JNZ      $ + 4H
B2:0088BD 2150              AJMP     ?C0232?SERIALAPPL
B2:0088BF 2405              ADD      A,#05H
B2:0088C1 6002              JZ       $ + 4H
B2:0088C3 21D9              AJMP     ?C0239?SERIALAPPL
 3283:             {
 3284:               case FIRMWARE_UPDATE_NVM_INIT:
B2:0088C5         ?C0227?SERIALAPPL:
 3285:                 /* HOST->ZW: FIRMWARE_UPDATE_NVM_INIT */
 3286:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_INIT | retVal */
 3287:                 {
 3288:                   // BYTE /*RET NVM_FIRMWARE_UPDATE_SUPPORTED if NVM is Firmware Update compatible */
 3289:                   //      /*    NVM_FIRMWARE_UPDATE_NOT_SUPPORTED if NVM is NOT Firmware Update compatible */
 3290:                   // ZW_FirmwareUpdate_NVM_Init();
 3291: 
 3292:                   BYTE_IN_AR(compl_workbuf, 1) = ZW_FirmwareUpdate_NVM_Init();
B2:0088C5 121D4F            LCALL    ?INTERBANK_TABLE?ZW_FirmwareUpdate_NVM_Init
 3293:                   DoRespond_workbuf(2);
 3294:                 }
 3295:                 break;
B2:0088C8 800D              SJMP     ?C0580?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 529


 3296: 
 3297:               case FIRMWARE_UPDATE_NVM_SET_NEW_IMAGE:
B2:0088CA         ?C0228?SERIALAPPL:
 3298:                 /* HOST->ZW: FIRMWARE_UPDATE_NVM_SET_NEW_IMAGE | value */
 3299:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_SET_NEW_IMAGE | retVal */
 3300:                 {
 3301:                   // BYTE  /* RET  TRUE if specified bValue has been written to NVM */
 3302:                   //       /*      FALSE if either NVM is not firmware update capable or */
 3303:                   //       /*      the Firmware_NEWIMAGE value is allready set to bValue */
 3304:                   // ZW_FirmwareUpdate_NVM_Set_NEWIMAGE(
 3305:                   //   BYTE bValue);
 3306: 
 3307:                   BYTE_IN_AR(compl_workbuf, 1) = ZW_FirmwareUpdate_NVM_Set_NEWIMAGE(serFrameDataPtr[1]);
B2:0088CA 90340B            MOV      DPTR,#serBuf+04H
B2:0088CD E0                MOVX     A,@DPTR
B2:0088CE FF                MOV      R7,A
B2:0088CF 121D54            LCALL    ?INTERBANK_TABLE?_ZW_FirmwareUpdate_NVM_Set_NEWIMAGE
B2:0088D2         
 3308:                   DoRespond_workbuf(2);
 3309:                 }
 3310:                 break;
B2:0088D2 8003              SJMP     ?C0580?SERIALAPPL
 3311: 
 3312:               case FIRMWARE_UPDATE_NVM_GET_NEW_IMAGE:
B2:0088D4         ?C0229?SERIALAPPL:
 3313:                 /* HOST->ZW: FIRMWARE_UPDATE_NVM_GET_NEW_IMAGE */
 3314:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_GET_NEW_IMAGE | retVal */
 3315:                 {
 3316:                   // BYTE  /* RET 0 if either NVM not capable or Indicator indicates NO NEW image */
 3317:                   //       /*     1 if Indicator indicates NEW image present */
 3318:                   // ZW_FirmwareUpdate_NVM_Get_NEWIMAGE();
 3319: 
 3320:                   BYTE_IN_AR(compl_workbuf, 1) = ZW_FirmwareUpdate_NVM_Get_NEWIMAGE();
B2:0088D4 121D63            LCALL    ?INTERBANK_TABLE?ZW_FirmwareUpdate_NVM_Get_NEWIMAGE
B2:0088D7         
B2:0088D7 902002            MOV      DPTR,#compl_workbuf+01H
B2:0088DA EF                MOV      A,R7
 3321:                   DoRespond_workbuf(2);
 3322:                 }
 3323:                 break;
B2:0088DB 81BB              AJMP     ?C0581?SERIALAPPL
 3324: 
 3325:               case FIRMWARE_UPDATE_NVM_UPDATE_CRC16:
B2:0088DD         ?C0230?SERIALAPPL:
 3326:                 /* HOST->ZW: FIRMWARE_UPDATE_NVM_UPDATE_CRC16 |
 3327:                              offset3byte(MSB) |
 3328:                              offset3byte |
 3329:                              offset2byte(LSB) |
 3330:                              length2byte(MSB) |
 3331:                              length2byte(LSB) |
 3332:                              seedCRC16_high |
 3333:                              seedCRC16_low */
 3334:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_UPDATE_CRC16 | resCRC16_high | resCRC16_low */
 3335:                 {
 3336:                   // WORD  /* RET  Resulting CRC16 value after doing CRC16 calculation */
 3337:                   //       /*      on specified block of data in extrnal NVM */
 3338:                   // ZW_firmwareUpdate_NVM_UpdateCRC16(
 3339:                   //   WORD crc,
 3340:                   //   DWORD nvmOffset,
 3341:                   //   WORD blockSize);
 3342: 
 3343:                   fw_crc = ZW_firmwareUpdate_NVM_UpdateCRC16((WORD)(((WORD)serFrameDataPtr[6] << 8) + serFrameDat
>> aPtr[7]),
 3344:                                                              (DWORD)(((DWORD)serFrameDataPtr[1] << 16) +
 3345:                                                                      ((WORD)serFrameDataPtr[2] << 8) +
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 530


 3346:                                                                      serFrameDataPtr[3]),
 3347:                                                              (WORD)(((WORD)(serFrameDataPtr[4] << 8)) + serFrameD
>> ataPtr[5]));
B2:0088DD 903410            MOV      DPTR,#serBuf+09H
B2:0088E0 12A7E3            LCALL    ?L?COM00FC
B2:0088E3 C006              PUSH     AR6
B2:0088E5 C007              PUSH     AR7
B2:0088E7 90340B            MOV      DPTR,#serBuf+04H
B2:0088EA E0                MOVX     A,@DPTR
B2:0088EB FF                MOV      R7,A
B2:0088EC E4                CLR      A
B2:0088ED FD                MOV      R5,A
B2:0088EE FE                MOV      R6,A
B2:0088EF 7810              MOV      R0,#010H
B2:0088F1 1223C1            LCALL    ?C?LSHL
B2:0088F4 C006              PUSH     AR6
B2:0088F6 C007              PUSH     AR7
B2:0088F8 12A883            LCALL    ?L?COM0235
B2:0088FB D007              POP      AR7
B2:0088FD D006              POP      AR6
B2:0088FF 12A7C1            LCALL    ?L?COM0068
B2:008902 122234            LCALL    ?C?LADD
B2:008905 903AD5            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+02H
B2:008908 1224BA            LCALL    ?C?LSTXDATA
B2:00890B 90340E            MOV      DPTR,#serBuf+07H
B2:00890E A3                INC      DPTR
B2:00890F E0                MOVX     A,@DPTR
B2:008910 2400              ADD      A,#00H
B2:008912 FE                MOV      R6,A
B2:008913 E4                CLR      A
B2:008914 33                RLC      A
B2:008915 903AD9            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B2:008918 F0                MOVX     @DPTR,A
B2:008919 A3                INC      DPTR
B2:00891A CE                XCH      A,R6
B2:00891B F0                MOVX     @DPTR,A
B2:00891C D007              POP      AR7
B2:00891E D006              POP      AR6
B2:008920 121D59            LCALL    ?INTERBANK_TABLE?_ZW_firmwareUpdate_NVM_UpdateCRC16
B2:008923 904142            MOV      DPTR,#fw_crc
B2:008926 EE                MOV      A,R6
B2:008927 F0                MOVX     @DPTR,A
B2:008928 A3                INC      DPTR
B2:008929 EF                MOV      A,R7
B2:00892A F0                MOVX     @DPTR,A
 3348:                   BYTE_IN_AR(compl_workbuf, 1) = (BYTE)(((fw_crc & 0xFF00) >> 8) & 0xFF);
B2:00892B 904142            MOV      DPTR,#fw_crc
B2:00892E 12653F            LCALL    ?L?COM03C6
B2:008931 902002            MOV      DPTR,#compl_workbuf+01H
B2:008934 F0                MOVX     @DPTR,A
 3349:                   BYTE_IN_AR(compl_workbuf, 2) = (BYTE)(fw_crc & 0xFF);
B2:008935 ED                MOV      A,R5
B2:008936 A3                INC      DPTR
B2:008937         
B2:008937 F0                MOVX     @DPTR,A
 3350:                   DoRespond_workbuf(3);
B2:008938 7F03              MOV      R7,#03H
 3351:                 }
 3352:                 break;
B2:00893A 029314            LJMP     ?C0583?SERIALAPPL
 3353: 
 3354:               case FIRMWARE_UPDATE_NVM_IS_VALID_CRC16:
B2:00893D         ?C0231?SERIALAPPL:
 3355:                 /* HOST->ZW: FIRMWARE_UPDATE_NVM_IS_VALID_CRC16 */
 3356:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_IS_VALID_CRC16 | retVal | deprecated | deprecated */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 531


 3357:                 {
 3358:                   // BOOL  /* RET  TRUE if NVM contains is a valid Z-Wave Bootloader upgradeable Firmware */
 3359:                   //       /*      FALSE if NVM do NOT contain a valid Z-Wave Bootloader upgradeable Firmware */
 3360:                   // ZW_FirmwareUpdate_NVM_isValidCRC16(void);
 3361: 
 3362:                   BYTE_IN_AR(compl_workbuf, 1) = (BYTE)ZW_FirmwareUpdate_NVM_isValidCRC16();
B2:00893D 121D5E            LCALL    ?INTERBANK_TABLE?ZW_FirmwareUpdate_NVM_isValidCRC16
B2:008940 E4                CLR      A
B2:008941 33                RLC      A
B2:008942 902002            MOV      DPTR,#compl_workbuf+01H
B2:008945 F0                MOVX     @DPTR,A
 3363:                   BYTE_IN_AR(compl_workbuf, 2) = 0;
B2:008946 E4                CLR      A
B2:008947 A3                INC      DPTR
B2:008948 F0                MOVX     @DPTR,A
 3364:                   BYTE_IN_AR(compl_workbuf, 3) = 0;
B2:008949 A3                INC      DPTR
B2:00894A F0                MOVX     @DPTR,A
 3365:                   DoRespond_workbuf(4);
B2:00894B 7F04              MOV      R7,#04H
B2:00894D         
 3366:                 }
 3367:                 break;
B2:00894D 029314            LJMP     ?C0583?SERIALAPPL
 3368: 
 3369:               case FIRMWARE_UPDATE_NVM_WRITE:
B2:008950         ?C0232?SERIALAPPL:
 3370:                 /* HOST->ZW: FIRMWARE_UPDATE_NVM_WRITE |
 3371:                              offset3byte(MSB) |
 3372:                              offset3byte |
 3373:                              offset2byte(LSB) |
 3374:                              length2byte(MSB) |
 3375:                              length2byte(LSB) |
 3376:                              buffer[] */
 3377:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_WRITE | retVal */
 3378:                 {
 3379:                   // BYTE  /* RET  TRUE if specified buffer has been written to NVM */
 3380:                   //       /*      FALSE if either NVM is not firmware update capable or */
 3381:                   //       /*      the sourceBuffer contents allready are present at */
 3382:                   //       /*      specified offset in external NVM */
 3383:                   // ZW_FirmwareUpdate_NVM_Write(
 3384:                   //   BYTE *sourceBuffer,
 3385:                   //   WORD fw_bufSize,
 3386:                   //   DWORD firmwareOffset);
 3387: 
 3388:                   /* Assume failed */
 3389:                   BYTE_IN_AR(compl_workbuf, 1) = FALSE;
B2:008950 E4                CLR      A
B2:008951 902002            MOV      DPTR,#compl_workbuf+01H
B2:008954 F0                MOVX     @DPTR,A
 3390:                   /* Ignore if frame has no data to write */
 3391:                   if ((FRAME_LENGTH_MIN + 7) < serFrameLen)
B2:008955 12AAE9            LCALL    ?L?COM054E
B2:008958 C3                CLR      C
B2:008959 9F                SUBB     A,R7
B2:00895A 4002              JC       $ + 4H
B2:00895C 81BC              AJMP     ?C0584?SERIALAPPL
 3392:                   {
 3393:                     length = ((WORD)(serFrameDataPtr[4] << 8)) + serFrameDataPtr[5];
B2:00895E 90340E            MOV      DPTR,#serBuf+07H
B2:008961 12AA02            LCALL    ?L?COM043D
B2:008964 904144            MOV      DPTR,#length
B2:008967 F0                MOVX     @DPTR,A
B2:008968 A3                INC      DPTR
B2:008969 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 532


B2:00896A F0                MOVX     @DPTR,A
 3394:                     /* Ignore write if length exceeds receive data-array length */
 3395:                     if (length <= serFrameLen - FRAME_LENGTH_MIN - 1)
B2:00896B EF                MOV      A,R7
B2:00896C 24FC              ADD      A,#0FCH
B2:00896E 12AAF9            LCALL    ?L?COM0550
B2:008971 4002              JC       $ + 4H
B2:008973 81BC              AJMP     ?C0584?SERIALAPPL
 3396:                     {
 3397:                       /* ignore request if length is larger than available buffer */
 3398:                       if (length < BUF_SIZE_RX)
B2:008975 C3                CLR      C
B2:008976 E0                MOVX     A,@DPTR
B2:008977 94A8              SUBB     A,#0A8H
B2:008979 904144            MOV      DPTR,#length
B2:00897C E0                MOVX     A,@DPTR
B2:00897D 9400              SUBB     A,#00H
B2:00897F 4002              JC       $ + 4H
B2:008981 81BC              AJMP     ?C0584?SERIALAPPL
 3399:                       {
 3400:                         for (i = 0; i < length; i++)
B2:008983 E4                CLR      A
B2:008984 9024C6            MOV      DPTR,#i
B2:008987 F0                MOVX     @DPTR,A
B2:008988         ?C0236?SERIALAPPL:
B2:008988 9024C6            MOV      DPTR,#i
B2:00898B E0                MOVX     A,@DPTR
B2:00898C FF                MOV      R7,A
B2:00898D D3                SETB     C
B2:00898E 904145            MOV      DPTR,#length+01H
B2:008991 E0                MOVX     A,@DPTR
B2:008992 9F                SUBB     A,R7
B2:008993 904144            MOV      DPTR,#length
B2:008996 E0                MOVX     A,@DPTR
B2:008997 9400              SUBB     A,#00H
B2:008999 400C              JC       ?C0237?SERIALAPPL
 3401:                         {
 3402:                           workbuf[i] = serFrameDataPtr[6+i];
B2:00899B 9024C6            MOV      DPTR,#i
B2:00899E E0                MOVX     A,@DPTR
B2:00899F 12AAF1            LCALL    ?L?COM054F
B2:0089A2 1293AA            LCALL    ?L?COM0031
B2:0089A5 80E1              SJMP     ?C0236?SERIALAPPL
B2:0089A7         ?C0237?SERIALAPPL:
 3403:                         }
 3404:                         BYTE_IN_AR(compl_workbuf, 1) = ZW_FirmwareUpdate_NVM_Write(workbuf, length,
 3405:                                                                                    (DWORD)(((DWORD)serFrameDataPt
>> r[1] << 16) +
 3406:                                                                                            ((WORD)serFrameDataPtr
>> [2] << 8) +
B2:0089A7 90340B            MOV      DPTR,#serBuf+04H
B2:0089AA 12A7CD            LCALL    ?L?COM0069
B2:0089AD 7810              MOV      R0,#010H
B2:0089AF 1223C1            LCALL    ?C?LSHL
B2:0089B2 C006              PUSH     AR6
B2:0089B4 C007              PUSH     AR7
B2:0089B6 12A883            LCALL    ?L?COM0235
B2:0089B9 D007              POP      AR7
B2:0089BB D006              POP      AR6
B2:0089BD 12A7C1            LCALL    ?L?COM0068
B2:0089C0 122234            LCALL    ?C?LADD
B2:0089C3 904285            MOV      DPTR,#?_ZW_FirmwareUpdate_NVM_Write?BYTE+05H
B2:0089C6 1224BA            LCALL    ?C?LSTXDATA
B2:0089C9 12A869            LCALL    ?L?COM0220
B2:0089CC 12A850            LCALL    ?L?COM019F
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 533


B2:0089CF 121D68            LCALL    ?INTERBANK_TABLE?_ZW_FirmwareUpdate_NVM_Write
B2:0089D2 902002            MOV      DPTR,#compl_workbuf+01H
B2:0089D5 EF                MOV      A,R7
B2:0089D6 F0                MOVX     @DPTR,A
 3407:                                                                                            serFrameDataPtr[3]));
 3408:                       }
 3409:                     }
 3410:                   }
B2:0089D7         ?C0233?SERIALAPPL:
 3411:                   DoRespond_workbuf(2);
 3412:                 }
 3413:                 break;
B2:0089D7 81BC              AJMP     ?C0584?SERIALAPPL
 3414: 
 3415:               default:
B2:0089D9         ?C0239?SERIALAPPL:
 3416:                 /* ZW->HOST: FIRMWARE_UPDATE_NVM_UNKNOWN */
 3417:                 DoRespond_workbuf(1);
B2:0089D9 7F01              MOV      R7,#01H
 3418:                 break;
B2:0089DB 029314            LJMP     ?C0586?SERIALAPPL
 3419:             }
 3420:           }
 3421:           break;
 3422: #endif
 3423: 
 3424: #if SUPPORT_ZW_NVR_GET_APP_VALUE
 3425:         case FUNC_ID_ZW_NVR_GET_APP_VALUE:
B2:0089DE         ?C0240?SERIALAPPL:
 3426:           /* HOST->ZW: appNVROffset | length */
 3427:           /* ZW->HOST: appNVRdata[] */
 3428:           {
 3429:             BYTE dataLength = 0;
B2:0089DE 12A8DE            LCALL    ?L?COM02A8
B2:0089E1 5010              JNC      ?C0241?SERIALAPPL
 3430:             /* Ignore if frame is to short */
 3431:             if ((FRAME_LENGTH_MIN + 1) < serFrameLen)
 3432:             {
 3433:               dataLength = serFrameDataPtr[1];
B2:0089E3 12A98F            LCALL    ?L?COM0398
 3434:               /* Make sure the length isn't larger than the available buffer size */
 3435:               if (dataLength > BUF_SIZE_TX)
B2:0089E6 94A8              SUBB     A,#0A8H
B2:0089E8 4003              JC       ?C0242?SERIALAPPL
 3436:               {
 3437:                 dataLength = BUF_SIZE_TX;
B2:0089EA 74A8              MOV      A,#0A8H
B2:0089EC F0                MOVX     @DPTR,A
 3438:               }
B2:0089ED         ?C0242?SERIALAPPL:
 3439:               ZW_NVRGetAppValue(serFrameDataPtr[0], dataLength, compl_workbuf);
B2:0089ED 12A872            LCALL    ?L?COM0233
B2:0089F0 12A75A            LCALL    _ZW_NVRGetAppValue
 3440:             }
B2:0089F3         ?C0241?SERIALAPPL:
 3441:             DoRespond_workbuf(dataLength);
B2:0089F3         
B2:0089F3 904142            MOV      DPTR,#dataLength
B2:0089F6 E0                MOVX     A,@DPTR
B2:0089F7         
B2:0089F7 FF                MOV      R7,A
B2:0089F8         
 3442:           }
 3443:           break;
B2:0089F8 029314            LJMP     ?C0586?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 534


 3444: #endif
 3445: 
 3446: #if SUPPORT_ZW_NVR_GET_VALUE
 3447:         case FUNC_ID_NVR_GET_VALUE:
B2:0089FB         ?C0243?SERIALAPPL:
 3448:           /* HOST->ZW: offset | length */
 3449:           /* ZW->HOST: NVRdata[] */
 3450:           {
 3451:             BYTE dataLength = 0;
B2:0089FB 12A8DE            LCALL    ?L?COM02A8
B2:0089FE 5010              JNC      ?C0244?SERIALAPPL
 3452:             /* Ignore if frame is to short */
 3453:             if ((FRAME_LENGTH_MIN + 1) < serFrameLen)
 3454:             {
 3455:               dataLength = serFrameDataPtr[1];
B2:008A00 12A98F            LCALL    ?L?COM0398
 3456:               /* Make sure the length isn't larger than the available buffer size */
 3457:               if (dataLength > BUF_SIZE_TX)
B2:008A03 94A8              SUBB     A,#0A8H
B2:008A05 4003              JC       ?C0245?SERIALAPPL
 3458:               {
 3459:                 dataLength = BUF_SIZE_TX;
B2:008A07 74A8              MOV      A,#0A8H
B2:008A09 F0                MOVX     @DPTR,A
 3460:               }
B2:008A0A         ?C0245?SERIALAPPL:
 3461:               ZW_NVRGetValue(serFrameDataPtr[0], dataLength, compl_workbuf);
B2:008A0A 12A872            LCALL    ?L?COM0233
B2:008A0D 121C32            LCALL    ?INTERBANK_TABLE?_ZW_NVRGetValue
 3462:             }
B2:008A10         ?C0244?SERIALAPPL:
 3463:             DoRespond_workbuf(dataLength);
B2:008A10 904142            MOV      DPTR,#dataLength
 3464:           }
 3465:           break;
B2:008A13 A1D4              AJMP     ?C0587?SERIALAPPL
 3466: #endif
 3467: 
 3468: #if SUPPORT_SERIAL_API_GET_APPL_HOST_MEMORY_OFFSET
 3469:         case FUNC_ID_SERIAL_API_GET_APPL_HOST_MEMORY_OFFSET:
 3470:           retVal =
 3471:           break;
 3472: #endif
 3473: 
 3474: #if SUPPORT_ZW_REQUEST_NETWORK_UPDATE
 3475:         case FUNC_ID_ZW_REQUEST_NETWORK_UPDATE:
B2:008A15         ?C0246?SERIALAPPL:
 3476:           /* funcID */
 3477:           funcID_ComplHandler_netWork_Management = serFrameDataPtr[0];
B2:008A15 90340A            MOV      DPTR,#serBuf+03H
B2:008A18 E0                MOVX     A,@DPTR
B2:008A19 FF                MOV      R7,A
B2:008A1A 902156            MOV      DPTR,#funcID_ComplHandler_netWork_Management
B2:008A1D F0                MOVX     @DPTR,A
 3478:           management_Func_ID = serFrameCmd;
B2:008A1E 903409            MOV      DPTR,#serBuf+02H
B2:008A21 E0                MOVX     A,@DPTR
B2:008A22 902000            MOV      DPTR,#management_Func_ID
B2:008A25 F0                MOVX     @DPTR,A
 3479:           retVal = ZW_REQUEST_NETWORK_UPDATE((serFrameDataPtr[0] != 0) ? ZCB_ComplHandler_ZW_netWork_Management :
>>  NULL);
B2:008A26 EF                MOV      A,R7
B2:008A27 6006              JZ       ?C0247?SERIALAPPL
B2:008A29 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_netWork_Management
B2:008A2B 7F21              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_netWork_Management
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 535


B2:008A2D 8004              SJMP     ?C0248?SERIALAPPL
B2:008A2F         ?C0247?SERIALAPPL:
B2:008A2F 7E00              MOV      R6,#00H
B2:008A31 7F00              MOV      R7,#00H
B2:008A33         ?C0248?SERIALAPPL:
B2:008A33 121A1B            LCALL    ?INTERBANK_TABLE?_ZW_RequestNetWorkUpdate
B2:008A36         
 3480:           DoRespond();
 3481:           break;
B2:008A36 0290BA            LJMP     ?C0599?SERIALAPPL
 3482: #endif /* SUPPORT_ZW_REQUEST_NETWORK_UPDATE */
 3483: 
 3484: #if SUPPORT_ZW_ENABLE_SUC
 3485:         case FUNC_ID_ZW_ENABLE_SUC:
 3486:           /* HOST->ZW: state | capabilities */
 3487:           retVal = ZW_ENABLE_SUC(serFrameDataPtr[0], serFrameDataPtr[1]);
 3488:           DoRespond();
 3489:           break;
 3490: #endif
 3491: 
 3492: #if SUPPORT_ZW_REQUEST_NODE_NEIGHBOR_UPDATE
 3493:         case FUNC_ID_ZW_REQUEST_NODE_NEIGHBOR_UPDATE:
 3494:           /* nodeID | funcID */
 3495:           funcID_ComplHandler_ZW_RequestNodeNeighborUpdate = serFrameDataPtr[1];
 3496:           if (!ZW_REQUEST_NODE_NEIGHBOR_UPDATE(serFrameDataPtr[0], serFrameDataPtr[1] ? ZCB_ComplHandler_ZW_Reque
>> stNodeNeighborUpdate : NULL))
 3497:           { /* It did not kick off, no nodes to ask? */
 3498:             if (serFrameDataPtr[1])
 3499:             {
 3500:               ZCB_ComplHandler_ZW_RequestNodeNeighborUpdate(REQUEST_NEIGHBOR_UPDATE_FAILED);
 3501:             }
 3502:           }
 3503:           set_state(stateIdle);
 3504:           break;
 3505: #endif
 3506: 
 3507: #ifdef ZW_CONTROLLER
 3508: #if SUPPORT_ZW_GET_NEIGHBOR_COUNT
 3509:         case FUNC_ID_ZW_GET_NEIGHBOR_COUNT:
 3510:           retVal = ZW_GET_NEIGHBOR_COUNT(serFrameDataPtr[0]);
 3511:           DoRespond();
 3512:           break;
 3513: #endif
 3514: #endif /* ZW_CONTROLLER */
 3515: 
 3516: #ifdef ZW_CONTROLLER
 3517: #if SUPPORT_ZW_ARE_NODES_NEIGHBOURS
 3518:         case FUNC_ID_ZW_ARE_NODES_NEIGHBOURS:
 3519:           retVal = ZW_ARE_NODES_NEIGHBOURS(serFrameDataPtr[0], serFrameDataPtr[1]);
 3520:           DoRespond();
 3521:           break;
 3522: #endif
 3523: #endif /* ZW_CONTROLLER */
 3524: 
 3525: #if SUPPORT_ZW_SET_LEARN_NODE_STATE
 3526:         case FUNC_ID_ZW_SET_LEARN_NODE_STATE:
 3527:           /* mode | funcID */
 3528:           funcID_ComplHandler_ZW_SetLearnNodeState = serFrameDataPtr[1];
 3529:           ZW_SetLearnNodeState(serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_SetLearnNodeSt
>> ate : NULL);
 3530:           set_state(stateIdle);
 3531:           break;
 3532: #endif
 3533: 
 3534: #if SUPPORT_ZW_GET_NODE_PROTOCOL_INFO
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 536


 3535:         case FUNC_ID_ZW_GET_NODE_PROTOCOL_INFO:
 3536:           /* bNodeID */
 3537:           ZW_GET_NODE_STATE(serFrameDataPtr[0], (NODEINFO *) compl_workbuf);
 3538:           DoRespond_workbuf(6);
 3539:           break;
 3540: #endif
 3541: 
 3542: #if SUPPORT_ZW_SET_DEFAULT
 3543:         case FUNC_ID_ZW_SET_DEFAULT:
B2:008A39         ?C0249?SERIALAPPL:
 3544:           /* funcID */
 3545:           funcID_ComplHandler_ZW_SetDefault = serFrameDataPtr[0];
B2:008A39 90340A            MOV      DPTR,#serBuf+03H
B2:008A3C E0                MOVX     A,@DPTR
B2:008A3D 902441            MOV      DPTR,#funcID_ComplHandler_ZW_SetDefault
B2:008A40 F0                MOVX     @DPTR,A
 3546: 
 3547: #ifdef ZW_CONTROLLER
 3548:           ZW_SET_DEFAULT((serFrameDataPtr[0] != 0) ? ZCB_ComplHandler_ZW_SetDefault : NULL);
 3549: #endif  /* ZW_CONTROLLER */
 3550: #ifdef ZW_SLAVE
 3551:           ZW_SET_DEFAULT();
B2:008A41 121A20            LCALL    ?INTERBANK_TABLE?ZW_SetDefault
 3552:           if (serFrameDataPtr[0] != 0)
B2:008A44 90340A            MOV      DPTR,#serBuf+03H
B2:008A47 E0                MOVX     A,@DPTR
B2:008A48 6003              JZ       ?C0250?SERIALAPPL
 3553:           {
 3554:             ZCB_ComplHandler_ZW_SetDefault(); //To make sure that controllers and slaves behave identically
B2:008A4A 12A082            LCALL    ZCB_ComplHandler_ZW_SetDefault
 3555:           }
B2:008A4D         ?C0250?SERIALAPPL:
 3556: #endif  /* ZW_SLAVE */
 3557:           set_state(stateIdle);
B2:008A4D         
 3558:           break;
B2:008A4D C195              AJMP     ?C0589?SERIALAPPL
 3559: #endif
 3560: 
 3561: #if SUPPORT_ZW_NEW_CONTROLLER
 3562:         case FUNC_ID_ZW_NEW_CONTROLLER:
 3563:           /* state | funcID */
 3564:           funcID_ComplHandler_ZW_NewController = serFrameDataPtr[1];
 3565:           ZW_NEW_CONTROLLER( serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ComplHandler_ZW_NewController : NULL
>> );
 3566:           set_state(stateIdle);
 3567:           break;
 3568: #endif
 3569: 
 3570: #ifdef ZW_CONTROLLER
 3571: #if SUPPORT_ADD_REMOVE_PROTECT
 3572:         case FUNC_ID_PROPRIETARY_1:
 3573:           addState = 0;
 3574:           set_state(stateIdle);
 3575:           break;
 3576: #endif
 3577: #endif
 3578: 
 3579: #if SUPPORT_ZW_ADD_NODE_TO_NETWORK
 3580:         case FUNC_ID_ZW_ADD_NODE_TO_NETWORK:
 3581:           /* HOST->ZW: mode | funcID */
 3582:           /* HOST->ZW: mode = 0x07 | funcID | DSK[0] | DSK[1] | DSK[2] | DSK[3] | DSK[4] | DSK[5] | DSK[6] | DSK[
>> 7] */
 3583: #if SUPPORT_ADD_REMOVE_PROTECT
 3584:           if (ZW_NodeManagementRunning())
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 537


 3585:           {
 3586:             break;
 3587:           }
 3588: #endif
 3589:           SetupNodeManagement(1);
 3590: #if SUPPORT_ZW_ADD_NODE_DSK_TO_NETWORK
 3591:           if ((serFrameDataPtr[0] & ADD_NODE_MODE_MASK) == ADD_NODE_HOME_ID)
 3592:           {
 3593:             ZW_ADD_NODE_DSK_TO_NETWORK(serFrameDataPtr[0], &serFrameDataPtr[2], (serFrameDataPtr[1] != 0) ? ZCB_C
>> omplHandler_ZW_NodeManagement : NULL);
 3594:           }
 3595:           else
 3596: #endif
 3597:           {
 3598:             ZW_ADD_NODE_TO_NETWORK(serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_NodeManage
>> ment : NULL);
 3599:           }
 3600:           break;
 3601: #endif
 3602: 
 3603: #if SUPPORT_ZW_REMOVE_NODE_FROM_NETWORK
 3604:         case FUNC_ID_ZW_REMOVE_NODE_FROM_NETWORK:
 3605:           /* HOST->ZW: mode | funcID */
 3606: #if SUPPORT_ADD_REMOVE_PROTECT
 3607:           if (ZW_NodeManagementRunning())
 3608:           {
 3609:             break;
 3610:           }
 3611: #endif
 3612:           SetupNodeManagement(1);
 3613:           ZW_REMOVE_NODE_FROM_NETWORK(serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_NodeMan
>> agement : NULL);
 3614:           break;
 3615: #endif
 3616: 
 3617: 
 3618: #if SUPPORT_ZW_REMOVE_NODE_ID_FROM_NETWORK
 3619:         case FUNC_ID_ZW_REMOVE_NODE_ID_FROM_NETWORK:
 3620:           /* HOST->ZW: mode | nodeID | funcID */
 3621: #if SUPPORT_ADD_REMOVE_PROTECT
 3622:           if (ZW_NodeManagementRunning())
 3623:           {
 3624:             break;
 3625:           }
 3626: #endif
 3627:           SetupNodeManagement(2);
 3628:           ZW_REMOVE_NODE_ID_FROM_NETWORK(serFrameDataPtr[0], serFrameDataPtr[1], (serFrameDataPtr[2] != 0) ? ZCB_
>> ComplHandler_ZW_NodeManagement : NULL);
 3629:           break;
 3630: #endif
 3631: 
 3632: #if SUPPORT_ZW_CREATE_NEW_PRIMARY
 3633:         case FUNC_ID_ZW_CREATE_NEW_PRIMARY:
 3634:           /* HOST->ZW: mode | funcID */
 3635: #if SUPPORT_ADD_REMOVE_PROTECT
 3636:           if (ZW_NodeManagementRunning())
 3637:           {
 3638:             break;
 3639:           }
 3640: #endif
 3641:           SetupNodeManagement(1);
 3642:           ZW_CREATE_NEW_PRIMARY_CTRL(serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_NodeMana
>> gement : NULL);
 3643:           break;
 3644: #endif
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 538


 3645: 
 3646: #if SUPPORT_ZW_CONTROLLER_CHANGE
 3647:         case FUNC_ID_ZW_CONTROLLER_CHANGE:
 3648:           /* HOST->ZW: mode | funcID */
 3649: #if SUPPORT_ADD_REMOVE_PROTECT
 3650:           if (ZW_NodeManagementRunning())
 3651:           {
 3652:             break;
 3653:           }
 3654: #endif
 3655:           SetupNodeManagement(1);
 3656:           ZW_CONTROLLER_CHANGE(serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_NodeManagement
>>  : NULL);
 3657:           break;
 3658: #endif
 3659: 
 3660: #if SUPPORT_ZW_SET_LEARN_MODE
 3661:         case FUNC_ID_ZW_SET_LEARN_MODE:
B2:008A4F         ?C0251?SERIALAPPL:
 3662:           /* HOST->ZW: mode | funcID */
 3663:           /* ZW->HOST: retVal */
 3664:           retVal = TRUE;
B2:008A4F 129D7F            LCALL    ?L?COM0204
 3665: #ifdef ZW_CONTROLLER
 3666:           SetupNodeManagement(1);
 3667: #endif  /* ZW_CONTROLLER */
 3668: #ifdef ZW_SLAVE
 3669:           funcID_ComplHandler_ZW_SetLearnMode = serFrameDataPtr[1];
B2:008A52 90340B            MOV      DPTR,#serBuf+04H
B2:008A55 E0                MOVX     A,@DPTR
B2:008A56 FE                MOV      R6,A
B2:008A57 9027CD            MOV      DPTR,#funcID_ComplHandler_ZW_SetLearnMode
B2:008A5A F0                MOVX     @DPTR,A
 3670: #endif
 3671: #ifdef ZW_CONTROLLER_SINGLE
 3672:           ZW_SET_LEARN_MODE(serFrameDataPtr[0], (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_NodeManagement : 
>> NULL);
 3673: #else
 3674:           if (SERIALPI_SET_LEARN_MODE_LEARN_PLUS_OFFSET > serFrameDataPtr[0])
B2:008A5B 90340A            MOV      DPTR,#serBuf+03H
B2:008A5E E0                MOVX     A,@DPTR
B2:008A5F FF                MOV      R7,A
B2:008A60 7480              MOV      A,#080H
B2:008A62 D3                SETB     C
B2:008A63 9F                SUBB     A,R7
B2:008A64 4012              JC       ?C0252?SERIALAPPL
 3675:           {
 3676:             /* Plain ZW_SetLearnMode */
 3677:             /* ZW_SET_LEARN_MODE_DISABLE          0x00 */
 3678:             /* ZW_SET_LEARN_MODE_CLASSIC          0x01 */
 3679:             /* ZW_SET_LEARN_MODE_NWI              0x02 */
 3680:             /* ZW_SET_LEARN_MODE_NWE              0x03 */
 3681: #ifdef ZW_CONTROLLER
 3682:             ZW_SET_LEARN_MODE(serFrameDataPtr[0],
 3683:                               (serFrameDataPtr[1] != 0) ?
 3684:                                ZCB_ComplHandler_ZW_NodeManagement :
 3685:                                NULL);
 3686: #else
 3687:             ZW_SET_LEARN_MODE(serFrameDataPtr[0],
 3688:                               (serFrameDataPtr[1] != 0) ?
 3689:                                ZCB_ComplHandler_ZW_SetLearnMode :
 3690:                                NULL);
B2:008A66 EE                MOV      A,R6
B2:008A67 6006              JZ       ?C0253?SERIALAPPL
B2:008A69 7C1E              MOV      R4,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SetLearnMode
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 539


B2:008A6B 7D26              MOV      R5,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SetLearnMode
B2:008A6D 8004              SJMP     ?C0254?SERIALAPPL
B2:008A6F         ?C0253?SERIALAPPL:
B2:008A6F 7C00              MOV      R4,#00H
B2:008A71 7D00              MOV      R5,#00H
B2:008A73         ?C0254?SERIALAPPL:
B2:008A73 1219FD            LCALL    ?INTERBANK_TABLE?_ZW_SetLearnMode
 3691: #endif
 3692:           }
B2:008A76 800F              SJMP     ?C0255?SERIALAPPL
B2:008A78         ?C0252?SERIALAPPL:
 3693:           else
 3694:           {
 3695:             /* HOST want to use Network Management for inclusion/exclusion */
 3696:             /* We need to substract the SERIALPI_SET_LEARN_MODE_LEARN_PLUS_OFFSET to get: */
 3697:             /* E_NETWORK_LEARN_MODE_DISABLE =  0,      Disable learn process */
 3698:             /* E_NETWORK_LEARN_MODE_INCLUSION  = 1,    Enable the learn process to do an inclusion */
 3699:             /* E_NETWORK_LEARN_MODE_EXCLUSION  = 2,    Enable the learn process to do an exclusion */
 3700:             /* E_NETWORK_LEARN_MODE_EXCLUSION_NWE = 3  Enable the learn process to do a network wide exclusion */
>> 
 3701:             /* E_NETWORK_LEARN_MODE_INCLUSION_SMARTSTART = 4 Enable the learn process to initiate SMARTSTART incl
>> usion */
 3702:             retVal = ZW_NetworkLearnModeStart(serFrameDataPtr[0] - SERIALPI_SET_LEARN_MODE_LEARN_PLUS_OFFSET);
B2:008A78 90340A            MOV      DPTR,#serBuf+03H
B2:008A7B E0                MOVX     A,@DPTR
B2:008A7C 2480              ADD      A,#080H
B2:008A7E FF                MOV      R7,A
B2:008A7F 124349            LCALL    _ZW_NetworkLearnModeStart
B2:008A82 90279F            MOV      DPTR,#retVal
B2:008A85 EF                MOV      A,R7
B2:008A86 F0                MOVX     @DPTR,A
 3703:           }
B2:008A87         ?C0255?SERIALAPPL:
 3704: #endif  /* ZW_CONTROLLER_SINGLE */
 3705:           DoRespond();
B2:008A87         
 3706:           break;
B2:008A87 02932F            LJMP     ?C0634?SERIALAPPL
 3707: #endif  /* SUPPORT_ZW_SET_LEARN_MODE */
 3708: 
 3709: #if SUPPORT_ZW_EXPLORE_REQUEST_INCLUSION
 3710:         case FUNC_ID_ZW_EXPLORE_REQUEST_INCLUSION:
B2:008A8A         ?C0256?SERIALAPPL:
 3711:           retVal = ZW_EXPLORE_REQUEST_INCLUSION();
B2:008A8A 121BF6            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestInclusion
B2:008A8D         
 3712:           DoRespond();
 3713:           break;
B2:008A8D 0290BA            LJMP     ?C0599?SERIALAPPL
 3714: #endif
 3715: 
 3716: #if SUPPORT_ZW_EXPLORE_REQUEST_EXCLUSION
 3717:         case FUNC_ID_ZW_EXPLORE_REQUEST_EXCLUSION:
B2:008A90         ?C0257?SERIALAPPL:
 3718:           retVal = ZW_EXPLORE_REQUEST_EXCLUSION();
B2:008A90 121BFB            LCALL    ?INTERBANK_TABLE?ZW_ExploreRequestExclusion
B2:008A93         
 3719:           DoRespond();
 3720:           break;
B2:008A93 0290BA            LJMP     ?C0599?SERIALAPPL
 3721: #endif
 3722: 
 3723: #if SUPPORT_ZW_REPLICATION_COMMAND_COMPLETE
 3724:         case FUNC_ID_ZW_REPLICATION_COMMAND_COMPLETE:
 3725:           /*  */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 540


 3726:           ZW_REPLICATION_COMMAND_COMPLETE();
 3727:           set_state(stateIdle);
 3728:           break;
 3729: #endif
 3730: 
 3731: #if SUPPORT_ZW_REPLICATION_SEND_DATA
 3732:         case FUNC_ID_ZW_REPLICATION_SEND_DATA:
 3733:           /* nodeID | dataLength | pData[] | txOptions | funcID */
 3734:           {
 3735:             BYTE dataLength;
 3736:             retVal = 0;
 3737:             dataLength = serFrameDataPtr[1];
 3738:             if (dataLength > BUF_SIZE_RX)
 3739:             {
 3740:               dataLength = BUF_SIZE_RX;
 3741:             }
 3742:             for (i = 0; i < dataLength; i++)
 3743:             {
 3744:               workbuf[i] = serFrameDataPtr[2+i];
 3745:             }
 3746:             funcID_ComplHandler_ZW_ReplicationSendData = serFrameDataPtr[3 + dataLength];
 3747:             retVal = ZW_REPLICATION_SEND_DATA(serFrameDataPtr[0], workbuf, dataLength, serFrameDataPtr[2 + dataLe
>> ngth],
 3748:                                               (serFrameDataPtr[3 + dataLength] != 0) ? ZCB_ComplHandler_ZW_Replic
>> ationSendData : NULL);
 3749:             DoRespond();
 3750:           }
 3751:           break;
 3752: #endif  /* SUPPORT_ZW_REPLICATION_SEND_DATA */
 3753: 
 3754: #if SUPPORT_ZW_ASSIGN_RETURN_ROUTE
 3755:         case FUNC_ID_ZW_ASSIGN_RETURN_ROUTE:
 3756:           /* srcNodeID | destNodeID | funcID */
 3757:           funcID_ComplHandler_ZW_AssignReturnRoute = serFrameDataPtr[2];
 3758:           retVal = ZW_ASSIGN_RETURN_ROUTE(serFrameDataPtr[0], serFrameDataPtr[1],
 3759:                                           (serFrameDataPtr[2] != 0) ? ZCB_ComplHandler_ZW_AssignReturnRoute : NUL
>> L);
 3760:           DoRespond();
 3761:           break;
 3762: #endif  /* SUPPORT_ZW_ASSIGN_RETURN_ROUTE */
 3763: 
 3764: #if SUPPORT_ZW_ASSIGN_PRIORITY_RETURN_ROUTE
 3765:         case FUNC_ID_ZW_ASSIGN_PRIORITY_RETURN_ROUTE:
 3766:           /* srcNodeID | destNodeID | route[5] | funcID */
 3767:           funcID_ComplHandler_ZW_AssignPriorityReturnRoute = serFrameDataPtr[7];
 3768:           retVal = ZW_AssignPriorityReturnRoute(serFrameDataPtr[0], serFrameDataPtr[1],
 3769:                                                 &serFrameDataPtr[2],
 3770:                                                 (serFrameDataPtr[7] != 0) ? ZCB_ComplHandler_ZW_AssignPriorityRet
>> urnRoute : NULL);
 3771:           DoRespond();
 3772:           break;
 3773: #endif  /* SUPPORT_ZW_ASSIGN_PRIORITY_RETURN_ROUTE */
 3774: 
 3775: #if SUPPORT_ZW_DELETE_RETURN_ROUTE
 3776:         case FUNC_ID_ZW_DELETE_RETURN_ROUTE:
 3777:           /* nodeID | funcID */
 3778:           funcID_ComplHandler_ZW_DeleteReturnRoute = serFrameDataPtr[1];
 3779:           retVal = ZW_DELETE_RETURN_ROUTE(serFrameDataPtr[0],
 3780:                                           (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_DeleteReturnRoute : NUL
>> L);
 3781:           DoRespond();
 3782:           break;
 3783: #endif  /* SUPPORT_ZW_DELETE_RETURN_ROUTE */
 3784: 
 3785: #if SUPPORT_ZW_ASSIGN_SUC_RETURN_ROUTE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 541


 3786:         case FUNC_ID_ZW_ASSIGN_SUC_RETURN_ROUTE:
 3787:           /* srcNodeID | funcID */
 3788:           funcID_ComplHandler_netWork_Management = serFrameDataPtr[1];
 3789:           retVal = ZW_ASSIGN_SUC_RETURN_ROUTE(serFrameDataPtr[0],
 3790:                                               (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_netWork_Management 
>> : NULL);
 3791:           management_Func_ID = serFrameCmd;
 3792:           DoRespond();
 3793:           break;
 3794: #endif  /* SUPPORT_ZW_ASSIGN_SUC_RETURN_ROUTE */
 3795: 
 3796: #if SUPPORT_ZW_ASSIGN_PRIORITY_SUC_RETURN_ROUTE
 3797:         case FUNC_ID_ZW_ASSIGN_PRIORITY_SUC_RETURN_ROUTE:
 3798:           /* srcNodeID | route[5] | funcID */
 3799:           funcID_ComplHandler_netWork_Management = serFrameDataPtr[6];
 3800:           retVal = ZW_AssignPrioritySUCReturnRoute(serFrameDataPtr[0],
 3801:                                                    &serFrameDataPtr[1],
 3802:                                                    (serFrameDataPtr[6] != 0) ? ZCB_ComplHandler_ZW_netWork_Manage
>> ment : NULL);
 3803:           management_Func_ID = serFrameCmd;
 3804:           DoRespond();
 3805:           break;
 3806: #endif  /* SUPPORT_ZW_ASSIGN_SUC_RETURN_ROUTE */
 3807: 
 3808: #if SUPPORT_ZW_DELETE_SUC_RETURN_ROUTE
 3809:         case FUNC_ID_ZW_DELETE_SUC_RETURN_ROUTE:
 3810:           /* srcNodeID | funcID */
 3811:           funcID_ComplHandler_netWork_Management = serFrameDataPtr[1];
 3812:           retVal = ZW_DELETE_SUC_RETURN_ROUTE(serFrameDataPtr[0],
 3813:                                               (serFrameDataPtr[1] != 0) ? ZCB_ComplHandler_ZW_netWork_Management 
>> : NULL);
 3814:           management_Func_ID = serFrameCmd;
 3815:           DoRespond();
 3816:           break;
 3817: #endif  /* SUPPORT_ZW_DELETE_SUC_RETURN_ROUTE */
 3818: 
 3819: #if SUPPORT_ZW_SEND_SUC_ID
 3820:         case FUNC_ID_ZW_SEND_SUC_ID:
 3821:           /* destNodeID | txOptions | funcID */
 3822:           funcID_ComplHandler_ZW_SendSUC_ID = serFrameDataPtr[2];
 3823:           retVal = ZW_SEND_SUC_ID(serFrameDataPtr[0], serFrameDataPtr[1], (serFrameDataPtr[2] != 0) ? ZCB_ComplHa
>> ndler_ZW_SendSUC_ID : NULL);
 3824:           DoRespond();
 3825:           break;
 3826: #endif  /* SUPPORT_ZW_SEND_SUC_ID */
 3827: 
 3828: #if SUPPORT_ZW_SET_SUC_NODE_ID
 3829:         case FUNC_ID_ZW_SET_SUC_NODE_ID:
 3830:           /* nodeID | SUCState | txOptions | capabilities | funcID */
 3831:           funcID_ComplHandler_ZW_SetSUCNodeID = serFrameDataPtr[4];
 3832:           retVal = ZW_SET_SUC_NODEID(serFrameDataPtr[0],
 3833:                                      serFrameDataPtr[1],
 3834:                                      serFrameDataPtr[2],
 3835:                                      serFrameDataPtr[3],
 3836:                                      (serFrameDataPtr[4] != 0) ? ZCB_ComplHandler_ZW_SetSUCNodeID : NULL);
 3837:           DoRespond();
 3838:           break;
 3839: #endif  /* SUPPORT_ZW_SET_SUC_NODE_ID */
 3840: 
 3841: #if SUPPORT_ZW_GET_SUC_NODE_ID
 3842:         case FUNC_ID_ZW_GET_SUC_NODE_ID:
B2:008A96         ?C0258?SERIALAPPL:
 3843:           /* */
 3844:           retVal = ZW_GET_SUC_NODEID();
B2:008A96 121A07            LCALL    ?INTERBANK_TABLE?ZW_GetSUCNodeID
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 542


B2:008A99         
 3845:           DoRespond();
 3846:           break;
B2:008A99 0290BA            LJMP     ?C0599?SERIALAPPL
 3847: #endif  /* SUPPORT_ZW_GET_SUC_NODE_ID */
 3848: 
 3849: #if SUPPORT_ZW_REMOVE_FAILED_NODE_ID
 3850:         case FUNC_ID_ZW_REMOVE_FAILED_NODE_ID:
 3851:           /* nodeID | funcID */
 3852:           funcID_ComplHandler_ZW_RemoveFailedNodeID = serFrameDataPtr[1];
 3853:           retVal = ZW_REMOVE_FAILED_NODE_ID(serFrameDataPtr[0],
 3854:                                             (serFrameDataPtr[1] != 0) ?
 3855:                                             ZCB_ComplHandler_ZW_RemoveFailedNodeID : NULL);
 3856:           DoRespond();
 3857:           break;
 3858: #endif  /* SUPPORT_ZW_REMOVE_FAILED_NODE_ID */
 3859: 
 3860: #if SUPPORT_ZW_IS_FAILED_NODE_ID
 3861:         case FUNC_ID_ZW_IS_FAILED_NODE_ID:
 3862:           /* nodeID */
 3863:           retVal = ZW_IS_FAILED_NODE_ID(serFrameDataPtr[0]);
 3864:           DoRespond();
 3865:           break;
 3866: #endif  /* SUPPORT_ZW_IS_FAILED_NODE_ID */
 3867: 
 3868: #if SUPPORT_ZW_REPLACE_FAILED_NODE
 3869:         case FUNC_ID_ZW_REPLACE_FAILED_NODE:
 3870:           /* nodeID | funcID */
 3871:           funcID_ComplHandler_ZW_ReplaceFailedNode = serFrameDataPtr[1];
 3872:           retVal = ZW_REPLACE_FAILED_NODE(serFrameDataPtr[0],
 3873:                                           /* Use NormalPower for including the replacement */
 3874:                                           TRUE,
 3875:                                           (serFrameDataPtr[1] != 0) ?
 3876:                                           ZCB_ComplHandler_ZW_ReplaceFailedNode : NULL);
 3877:           DoRespond();
 3878:           break;
 3879: #endif  /* SUPPORT_ZW_REPLACE_FAILED_NODE */
 3880: 
 3881: #if SUPPORT_GET_ROUTING_TABLE_LINE
 3882:         case FUNC_ID_GET_ROUTING_TABLE_LINE:
 3883:           /* HOST->ZW: bLine | bRemoveBad | bRemoveNonReps | funcID */
 3884:           ZW_GET_ROUTING_INFO(serFrameDataPtr[0], compl_workbuf,
 3885:                               ((serFrameDataPtr[1]) ? GET_ROUTING_INFO_REMOVE_BAD : 0) |
 3886:                               ((serFrameDataPtr[2]) ? GET_ROUTING_INFO_REMOVE_NON_REPS : 0));
 3887:           DoRespond_workbuf(MAX_NODEMASK_LENGTH);
 3888:           break;
 3889: #endif  /* SUPPORT_GET_ROUTING_TABLE_LINE */
 3890: 
 3891: #if SUPPORT_ZW_SET_ROUTING_INFO
 3892:         case FUNC_ID_ZW_SET_ROUTING_INFO:
 3893:           /* HOST->ZW: nodeId | NodeMask[29] */
 3894:           retVal = ZW_SetRoutingInfo(serFrameDataPtr[0], MAX_NODEMASK_LENGTH, &serFrameDataPtr[1]);
 3895:           DoRespond();
 3896:           break;
 3897: #endif
 3898: 
 3899: #if SUPPORT_GET_TX_COUNTER
 3900:         case FUNC_ID_GET_TX_COUNTER:
 3901:           /* */
 3902:           /* Get the transmit counter */
 3903:           BYTE_IN_AR(compl_workbuf, 0) = ZW_TX_COUNTER;
 3904:           DoRespond_workbuf(1);
 3905:           break;
 3906: #endif  /* SUPPORT_GET_TX_COUNTER */
 3907: 
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 543


 3908: #if SUPPORT_RESET_TX_COUNTER
 3909:        case FUNC_ID_RESET_TX_COUNTER:
 3910:           {
 3911:             /* */
 3912:             /* Reset the transmit counter */
 3913:             ZW_TX_COUNTER = 0;
 3914:             set_state(stateIdle);
 3915:           }
 3916:           break;
 3917: #endif  /* SUPPORT_RESET_TX_COUNTER */
 3918: 
 3919: #if SUPPORT_STORE_NODEINFO
 3920:        case FUNC_ID_STORE_NODEINFO:
 3921:           /*0         1                   2                   3                 4               5               6
>> 
 3922:           /* nodeID | nodeInfo.capability|nodeInfo.security|nodeInfo.reserved|nodeInfo.basic|nodeInfo.generic|nod
>> eInfo.specific|funcId*/
 3923:           funcID_ComplHandler_ZW_StoreNodeInfo = serFrameDataPtr[7];
 3924: 
 3925:           retVal = ZW_STORE_NODE_INFO(serFrameDataPtr[0], &serFrameDataPtr[1],
 3926:                                       (serFrameDataPtr[7] != 0) ? ZCB_ComplHandler_ZW_StoreNodeInfo : NULL);
 3927:           DoRespond();
 3928:           break;
 3929: #endif  /* SUPPORT_STORE_NODEINFO */
 3930: 
 3931: #if SUPPORT_STORE_HOMEID
 3932:        case FUNC_ID_STORE_HOMEID:
 3933:           /* homeID1 | homeID2 | homeID3 | homeID4 | nodeID */
 3934:           /* Store homeID and Node ID. */
 3935:           ZW_STORE_HOME_ID(&serFrameDataPtr[0], serFrameDataPtr[4]);
 3936:           set_state(stateIdle);
 3937:           break;
 3938: #endif /* SUPPORT_STORE_HOMEID */
 3939: 
 3940: #if SUPPORT_LOCK_ROUTE_RESPONSE
 3941:        case FUNC_ID_LOCK_ROUTE_RESPONSE:
B2:008A9C         ?C0259?SERIALAPPL:
 3942:           /* HOST->ZW: lockID */
 3943:           /* Lock response routes / Last Working Routes. lockID == nodeID for locking. lockID == 0x00 to unlock *
>> /
 3944:           ZW_LOCK_RESPONSE_ROUTE(serFrameDataPtr[0]);
B2:008A9C 90340A            MOV      DPTR,#serBuf+03H
B2:008A9F E0                MOVX     A,@DPTR
B2:008AA0 FF                MOV      R7,A
B2:008AA1 1219BC            LCALL    ?INTERBANK_TABLE?_ZW_LockRoute
 3945:           set_state(stateIdle);
 3946:           break;
B2:008AA4 029334            LJMP     ?C0617?SERIALAPPL
 3947: #endif
 3948: 
 3949: #if SUPPORT_ZW_GET_PRIORITY_ROUTE
 3950:        case FUNC_ID_ZW_GET_PRIORITY_ROUTE:
 3951:           /* HOST->ZW: nodeID */
 3952:           /* ZW->HOST: nodeID | anyRouteFound | repeater0 | repeater1 | repeater2 | repeater3 | routespeed */
 3953:           BYTE_IN_AR(compl_workbuf, 0) = serFrameDataPtr[0];
 3954:           BYTE_IN_AR(compl_workbuf, 1) = ZW_GET_PRIORITY_ROUTE(serFrameDataPtr[0], &compl_workbuf[2]);
 3955:           DoRespond_workbuf(7);
 3956:           break;
 3957: #endif
 3958: 
 3959: #if SUPPORT_ZW_SET_PRIORITY_ROUTE
 3960:        case FUNC_ID_ZW_SET_PRIORITY_ROUTE:
 3961:           /* HOST->ZW: nodeID | repeater0 | repeater1 | repeater2 | repeater3 | routespeed */
 3962:           /* ZW->HOST: nodeID | routeUpdated */
 3963:           BYTE_IN_AR(compl_workbuf, 0) = serFrameDataPtr[0];
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 544


 3964:           if (9 <= serFrameLen)
 3965:           {
 3966:             /* Set Priority Route Devkit 6.6x */
 3967:             BYTE_IN_AR(compl_workbuf, 1) = ZW_SET_PRIORITY_ROUTE(serFrameDataPtr[0], &serFrameDataPtr[1]);
 3968:           }
 3969:           else
 3970:           {
 3971:             /* Clear/Release Golden Route - Devkit 6.6x+ */
 3972:             BYTE_IN_AR(compl_workbuf, 1) = ZW_SET_PRIORITY_ROUTE(serFrameDataPtr[0], NULL);
 3973:           }
 3974:           DoRespond_workbuf(2);
 3975:           break;
 3976: #endif
 3977: 
 3978: #ifdef ZW_ENABLE_RTC
 3979:         case FUNC_ID_CLOCK_SET:
 3980:           /* pNewTime.weekday | pNewTime.hour | pNewTime.minute */
 3981:           clkTime.weekday = serFrameDataPtr[0];
 3982:           clkTime.hour = serFrameDataPtr[1];
 3983:           clkTime.minute = serFrameDataPtr[2];
 3984:           retVal = ClockSet(&clkTime);
 3985:           DoRespond();
 3986:           break;
 3987: 
 3988:         case FUNC_ID_CLOCK_GET:
 3989:           /* */
 3990:           ClockGet(&clkTime);
 3991:           BYTE_IN_AR(compl_workbuf, 0) = clkTime.weekday;
 3992:           BYTE_IN_AR(compl_workbuf, 1) = clkTime.hour;
 3993:           BYTE_IN_AR(compl_workbuf, 2) = clkTime.minute;
 3994:           DoRespond_workbuf(3);
 3995:           break;
 3996: 
 3997:         case FUNC_ID_CLOCK_CMP:
 3998:           /* pNewTime.weekday | pNewTime.hour | pNewTime.minute */
 3999:           clkTime.weekday = serFrameDataPtr[0];
 4000:           clkTime.hour = serFrameDataPtr[1];
 4001:           clkTime.minute = serFrameDataPtr[2];
 4002:           retVal = ClockCmp(&clkTime);
 4003:           DoRespond();
 4004:           break;
 4005: 
 4006:         case FUNC_ID_RTC_TIMER_CREATE:
 4007:           /* RTC_TIMER.status | RTC_TIMER.timeOn (3 bytes) | RTC_TIMER.timeOff (3 bytes) | RTC_TIMER.repeats | RT
>> C_TIMER.parm | RTC_TIMER.funcID | funcID */
 4008:           timer.status = serFrameDataPtr[0];
 4009:           timer.timeOn.weekday = serFrameDataPtr[1];
 4010:           timer.timeOn.hour = serFrameDataPtr[2];
 4011:           timer.timeOn.minute = serFrameDataPtr[3];
 4012:           timer.timeOff.weekday = serFrameDataPtr[4];
 4013:           timer.timeOff.hour = serFrameDataPtr[5];
 4014:           timer.timeOff.minute = serFrameDataPtr[6];
 4015:           timer.repeats = serFrameDataPtr[7];
 4016:           timer.parm = serFrameDataPtr[8];
 4017:           timer.func = rtcArray[serFrameDataPtr[9]];
 4018: 
 4019:           retVal = (BYTE)-1;
 4020:           if (serFrameDataPtr[9] < RTC_TIMER_MAX)
 4021:           {
 4022:             funcID_ComplHandler_RTCTimerCreate = serFrameDataPtr[10];
 4023:             retVal = RTCTimerCreate(&timer, (serFrameDataPtr[10] != 0) ? ComplHandler_RTCTimerCreate : NULL);
 4024:           }
 4025:           DoRespond();
 4026:           break;
 4027: 
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 545


 4028:         case FUNC_ID_RTC_TIMER_READ:
 4029:           /* timerHandle */
 4030:           RespondRTCTimer();
 4031:           break;
 4032: 
 4033:         case FUNC_ID_RTC_TIMER_DELETE:
 4034:           /* timerHandle */
 4035:           RTCTimerDelete(serFrameDataPtr[0]);
 4036:           set_state(stateIdle);
 4037:           break;
 4038: #endif
 4039: 
 4040: #if SUPPORT_ZW_GET_VERSION
 4041:         case FUNC_ID_ZW_GET_VERSION:
B2:008AA7         ?C0260?SERIALAPPL:
 4042:           /* */
 4043:           BYTE_IN_AR(compl_workbuf, 12) = ZW_Version((BYTE *)compl_workbuf);
B2:008AA7 7E20              MOV      R6,#HIGH compl_workbuf
B2:008AA9 7F01              MOV      R7,#LOW compl_workbuf
B2:008AAB 12309E            LCALL    _ZW_Version
B2:008AAE 90200D            MOV      DPTR,#compl_workbuf+0CH
B2:008AB1 EF                MOV      A,R7
B2:008AB2 F0                MOVX     @DPTR,A
 4044:           DoRespond_workbuf(13);
B2:008AB3 7F0D              MOV      R7,#0DH
 4045:           break;
B2:008AB5 029314            LJMP     ?C0596?SERIALAPPL
 4046: #endif
 4047: 
 4048: #if SUPPORT_ZW_GET_PROTOCOL_VERSION
 4049:         case FUNC_ID_ZW_GET_PROTOCOL_VERSION:
B2:008AB8         ?C0261?SERIALAPPL:
 4050:           /*  */
 4051:           ZW_GetProtocolVersion((PROTOCOL_VERSION *)compl_workbuf);
B2:008AB8 7E20              MOV      R6,#HIGH compl_workbuf
B2:008ABA 7F01              MOV      R7,#LOW compl_workbuf
B2:008ABC 1230B9            LCALL    _ZW_GetProtocolVersion
 4052:           DoRespond_workbuf(sizeof(PROTOCOL_VERSION));
B2:008ABF 7F06              MOV      R7,#06H
B2:008AC1         
 4053:           break;
B2:008AC1 029314            LJMP     ?C0596?SERIALAPPL
 4054: #endif
 4055: 
 4056: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION
 4057:         case FUNC_ID_SERIAL_API_APPL_NODE_INFORMATION:
B2:008AC4         ?C0262?SERIALAPPL:
 4058:           /* listening | generic | specific | parmLength | nodeParms[] */
 4059:           applNodeInfo_deviceOptionsMask = serFrameDataPtr[0];
B2:008AC4 90340A            MOV      DPTR,#serBuf+03H
B2:008AC7 E0                MOVX     A,@DPTR
B2:008AC8 902160            MOV      DPTR,#applNodeInfo_deviceOptionsMask
B2:008ACB F0                MOVX     @DPTR,A
 4060:           applNodeInfo_nodeType_generic = serFrameDataPtr[1];
B2:008ACC 90340B            MOV      DPTR,#serBuf+04H
B2:008ACF E0                MOVX     A,@DPTR
B2:008AD0 902165            MOV      DPTR,#applNodeInfo_nodeType_generic
B2:008AD3 F0                MOVX     @DPTR,A
 4061:           applNodeInfo_nodeType_specific = serFrameDataPtr[2];
B2:008AD4 90340C            MOV      DPTR,#serBuf+05H
B2:008AD7 E0                MOVX     A,@DPTR
B2:008AD8 902161            MOV      DPTR,#applNodeInfo_nodeType_specific
B2:008ADB F0                MOVX     @DPTR,A
 4062:           applNodeInfo_parmLength = (serFrameDataPtr[3] < sizeof(applNodeInfo_nodeParm)) ? serFrameDataPtr[3] : s
>> izeof(applNodeInfo_nodeParm);
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 546


B2:008ADC 90340D            MOV      DPTR,#serBuf+06H
B2:008ADF E0                MOVX     A,@DPTR
B2:008AE0 FF                MOV      R7,A
B2:008AE1 C3                CLR      C
B2:008AE2 9423              SUBB     A,#023H
B2:008AE4 5002              JNC      ?C0263?SERIALAPPL
B2:008AE6 8002              SJMP     ?C0264?SERIALAPPL
B2:008AE8         ?C0263?SERIALAPPL:
B2:008AE8 7F23              MOV      R7,#023H
B2:008AEA         ?C0264?SERIALAPPL:
B2:008AEA 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:008AED EF                MOV      A,R7
B2:008AEE 129CC2            LCALL    ?L?COM01E3
B2:008AF1         ?C0265?SERIALAPPL:
B2:008AF1 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:008AF4 12AAAC            LCALL    ?L?COM04F2
B2:008AF7 5020              JNC      ?C0268?SERIALAPPL
 4063:           for (i = 0; i < applNodeInfo_parmLength; i++)
 4064:           {
 4065:             applNodeInfo_nodeParm[i] = serFrameDataPtr[4+i];
B2:008AF9 12A8C8            LCALL    ?L?COM028A
B2:008AFC FE                MOV      R6,A
B2:008AFD 74A2              MOV      A,#LOW applNodeInfo_nodeParm
B2:008AFF 2F                ADD      A,R7
B2:008B00 12A8F0            LCALL    ?L?COM02C0
B2:008B03 EE                MOV      A,R6
B2:008B04 F0                MOVX     @DPTR,A
 4066: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 4067:             applNodeInfo_unincluded_nodeParm[i] = serFrameDataPtr[4+i];
B2:008B05 9024C6            MOV      DPTR,#i
B2:008B08 12A8C8            LCALL    ?L?COM028A
B2:008B0B FE                MOV      R6,A
B2:008B0C 74A5              MOV      A,#LOW applNodeInfo_unincluded_nodeParm
B2:008B0E 2F                ADD      A,R7
B2:008B0F F582              MOV      DPL,A
B2:008B11 E4                CLR      A
B2:008B12 3427              ADDC     A,#HIGH applNodeInfo_unincluded_nodeParm
B2:008B14 1293B6            LCALL    ?L?COM0032
B2:008B17 80D8              SJMP     ?C0265?SERIALAPPL
B2:008B19         ?C0268?SERIALAPPL:
 4068: #endif
 4069:           }
 4070:           while (i < sizeof(applNodeInfo_nodeParm))
B2:008B19 12994B            LCALL    ?L?COM0162
B2:008B1C 9423              SUBB     A,#023H
B2:008B1E 5014              JNC      ?C0269?SERIALAPPL
 4071:           {
 4072:             applNodeInfo_nodeParm[i] = 0;
B2:008B20 74A2              MOV      A,#LOW applNodeInfo_nodeParm
B2:008B22 2F                ADD      A,R7
B2:008B23 12A8F0            LCALL    ?L?COM02C0
B2:008B26 E4                CLR      A
B2:008B27 F0                MOVX     @DPTR,A
 4073: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 4074:             applNodeInfo_unincluded_nodeParm[i] = 0;
B2:008B28 74A5              MOV      A,#LOW applNodeInfo_unincluded_nodeParm
B2:008B2A 2F                ADD      A,R7
B2:008B2B 12A88F            LCALL    ?L?COM025F
B2:008B2E E4                CLR      A
B2:008B2F 1293B9            LCALL    ?L?COM0033
 4075: #endif
 4076:             i++;
 4077:           }
B2:008B32 80E5              SJMP     ?C0268?SERIALAPPL
B2:008B34         ?C0269?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 547


 4078: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 4079:           applNodeInfo_unincluded_parmLength = applNodeInfo_parmLength;
B2:008B34 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:008B37 E0                MOVX     A,@DPTR
B2:008B38 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008B3B F0                MOVX     @DPTR,A
 4080:           m_AppNIF.cmdClassListNonSecureCount = applNodeInfo_unincluded_parmLength;
B2:008B3C 902453            MOV      DPTR,#m_AppNIF+03H
B2:008B3F 12A792            LCALL    ?L?COM00FE
 4081:           m_AppNIF.deviceOptionsMask = applNodeInfo_deviceOptionsMask;
 4082:           m_AppNIF.nodeType.generic = applNodeInfo_nodeType_generic;
 4083:           m_AppNIF.nodeType.specific = applNodeInfo_nodeType_specific;
 4084:           Transport_OnApplicationInitSW( &m_AppNIF);
 4085: #endif
 4086:           SaveApplicationSettings();
B2:008B42 129751            LCALL    SaveApplicationSettings
 4087:           set_state(stateIdle);
B2:008B45         
 4088:           break;
B2:008B45 029334            LJMP     ?C0617?SERIALAPPL
 4089: #endif
 4090: 
 4091: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 4092:         case FUNC_ID_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES:
B2:008B48         ?C0270?SERIALAPPL:
 4093:           /* unincluded_parmLength | unincluded_nodeParm[] | */
 4094:           /* included_unsecure_parmLength | included_unsecure_nodeParm[] |
 4095:           /* included_secure_parmLength | included_secure_nodeParm[] */
 4096:           for (i = 0; i < APPL_NODEPARM_MAX; i++)
B2:008B48 E4                CLR      A
B2:008B49 9024C6            MOV      DPTR,#i
B2:008B4C F0                MOVX     @DPTR,A
B2:008B4D         ?C0271?SERIALAPPL:
B2:008B4D 12994B            LCALL    ?L?COM0162
B2:008B50 9423              SUBB     A,#023H
B2:008B52 501C              JNC      ?C0272?SERIALAPPL
 4097:           {
 4098:             applNodeInfo_unincluded_nodeParm[i] = 0;
B2:008B54 74A5              MOV      A,#LOW applNodeInfo_unincluded_nodeParm
B2:008B56 2F                ADD      A,R7
B2:008B57 12A88F            LCALL    ?L?COM025F
B2:008B5A E4                CLR      A
B2:008B5B F0                MOVX     @DPTR,A
 4099:             applNodeInfo_included_unsecure_nodeParm[i] = 0;
B2:008B5C 747F              MOV      A,#LOW applNodeInfo_included_unsecure_nodeParm
B2:008B5E 2F                ADD      A,R7
B2:008B5F 12A959            LCALL    ?L?COM0360
B2:008B62 E4                CLR      A
B2:008B63 F0                MOVX     @DPTR,A
 4100:             applNodeInfo_included_secure_nodeParm[i] = 0;
B2:008B64 74CE              MOV      A,#LOW applNodeInfo_included_secure_nodeParm
B2:008B66 2F                ADD      A,R7
B2:008B67 12A9D0            LCALL    ?L?COM03FF
B2:008B6A E4                CLR      A
B2:008B6B 1293B9            LCALL    ?L?COM0033
B2:008B6E 80DD              SJMP     ?C0271?SERIALAPPL
B2:008B70         ?C0272?SERIALAPPL:
 4101:           }
 4102:           applNodeInfo_unincluded_parmLength = serFrameDataPtr[0];
B2:008B70 90340A            MOV      DPTR,#serBuf+03H
B2:008B73 E0                MOVX     A,@DPTR
B2:008B74 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008B77 129CC2            LCALL    ?L?COM01E3
B2:008B7A         ?C0274?SERIALAPPL:
B2:008B7A 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 548


B2:008B7D 1298EB            LCALL    ?L?COM0080
B2:008B80 5015              JNC      ?C0275?SERIALAPPL
B2:008B82 7423              MOV      A,#023H
B2:008B84 9E                SUBB     A,R6
B2:008B85 4010              JC       ?C0275?SERIALAPPL
 4103:           for (i = 0; ((i < applNodeInfo_unincluded_parmLength) && (APPL_NODEPARM_MAX > i)); i++)
 4104:           {
 4105:             applNodeInfo_unincluded_nodeParm[i] = serFrameDataPtr[1 + i];
B2:008B87 12A897            LCALL    ?L?COM0260
B2:008B8A FD                MOV      R5,A
B2:008B8B 74A5              MOV      A,#LOW applNodeInfo_unincluded_nodeParm
B2:008B8D 2E                ADD      A,R6
B2:008B8E 12A88F            LCALL    ?L?COM025F
B2:008B91 ED                MOV      A,R5
B2:008B92 1293B9            LCALL    ?L?COM0033
B2:008B95 80E3              SJMP     ?C0274?SERIALAPPL
B2:008B97         ?C0275?SERIALAPPL:
 4106:           }
 4107:           applNodeInfo_included_unsecure_parmLength = serFrameDataPtr[applNodeInfo_unincluded_parmLength + 1];
B2:008B97 740B              MOV      A,#LOW serBuf+04H
B2:008B99 2F                ADD      A,R7
B2:008B9A 12A89A            LCALL    ?L?COM0261
B2:008B9D 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:008BA0 129CC2            LCALL    ?L?COM01E3
B2:008BA3         ?C0277?SERIALAPPL:
B2:008BA3 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:008BA6 1298EB            LCALL    ?L?COM0080
B2:008BA9 501A              JNC      ?C0278?SERIALAPPL
B2:008BAB 7423              MOV      A,#023H
B2:008BAD 9E                SUBB     A,R6
B2:008BAE 4015              JC       ?C0278?SERIALAPPL
 4108:           for (i = 0; ((i < applNodeInfo_included_unsecure_parmLength) && (APPL_NODEPARM_MAX > i)); i++)
 4109:           {
 4110:             applNodeInfo_included_unsecure_nodeParm[i] = serFrameDataPtr[applNodeInfo_unincluded_parmLength + 1 +
>>  1 + i];
B2:008BB0 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008BB3 E0                MOVX     A,@DPTR
B2:008BB4 2E                ADD      A,R6
B2:008BB5 12A7D5            LCALL    ?L?COM00F9
B2:008BB8 FD                MOV      R5,A
B2:008BB9 747F              MOV      A,#LOW applNodeInfo_included_unsecure_nodeParm
B2:008BBB 2E                ADD      A,R6
B2:008BBC 12A959            LCALL    ?L?COM0360
B2:008BBF ED                MOV      A,R5
B2:008BC0 1293B9            LCALL    ?L?COM0033
B2:008BC3 80DE              SJMP     ?C0277?SERIALAPPL
B2:008BC5         ?C0278?SERIALAPPL:
 4111:           }
 4112:           applNodeInfo_included_secure_parmLength = serFrameDataPtr[applNodeInfo_unincluded_parmLength + applNode
>> Info_included_unsecure_parmLength + 1 + 1];
B2:008BC5 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008BC8 E0                MOVX     A,@DPTR
B2:008BC9 2F                ADD      A,R7
B2:008BCA 12A7D5            LCALL    ?L?COM00F9
B2:008BCD 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:008BD0 129CC2            LCALL    ?L?COM01E3
B2:008BD3         ?C0280?SERIALAPPL:
B2:008BD3 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:008BD6 1298EB            LCALL    ?L?COM0080
B2:008BD9 5029              JNC      ?C0281?SERIALAPPL
B2:008BDB 7423              MOV      A,#023H
B2:008BDD 9E                SUBB     A,R6
B2:008BDE 4024              JC       ?C0281?SERIALAPPL
 4113:           for (i = 0; ((i < applNodeInfo_included_secure_parmLength) && (APPL_NODEPARM_MAX > i)); i++)
 4114:           {
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 549


 4115:             applNodeInfo_included_secure_nodeParm[i] = serFrameDataPtr[applNodeInfo_unincluded_parmLength + applN
>> odeInfo_included_unsecure_parmLength + 1 + 1 + 1 + i];
B2:008BE0 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:008BE3 E0                MOVX     A,@DPTR
B2:008BE4 FE                MOV      R6,A
B2:008BE5 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008BE8 E0                MOVX     A,@DPTR
B2:008BE9 2E                ADD      A,R6
B2:008BEA FE                MOV      R6,A
B2:008BEB 9024C6            MOV      DPTR,#i
B2:008BEE E0                MOVX     A,@DPTR
B2:008BEF FD                MOV      R5,A
B2:008BF0 2E                ADD      A,R6
B2:008BF1 240D              ADD      A,#LOW serBuf+06H
B2:008BF3 12A7F7            LCALL    ?L?COM0133
B2:008BF6 FE                MOV      R6,A
B2:008BF7 74CE              MOV      A,#LOW applNodeInfo_included_secure_nodeParm
B2:008BF9 2D                ADD      A,R5
B2:008BFA F582              MOV      DPL,A
B2:008BFC E4                CLR      A
B2:008BFD 3427              ADDC     A,#HIGH applNodeInfo_included_secure_nodeParm
B2:008BFF 1293B6            LCALL    ?L?COM0032
B2:008C02 80CF              SJMP     ?C0280?SERIALAPPL
B2:008C04         ?C0281?SERIALAPPL:
 4116:           }
 4117:           applNodeInfo_unincluded_parmLength = ((APPL_NODEPARM_MAX < applNodeInfo_unincluded_parmLength) ?  APPL_
>> NODEPARM_MAX : applNodeInfo_unincluded_parmLength);
B2:008C04 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008C07 E0                MOVX     A,@DPTR
B2:008C08 FE                MOV      R6,A
B2:008C09 7423              MOV      A,#023H
B2:008C0B C3                CLR      C
B2:008C0C 9E                SUBB     A,R6
B2:008C0D 5006              JNC      ?C0283?SERIALAPPL
B2:008C0F 7D23              MOV      R5,#023H
B2:008C11 7E23              MOV      R6,#023H
B2:008C13 8000              SJMP     ?C0284?SERIALAPPL
B2:008C15         ?C0283?SERIALAPPL:
B2:008C15         ?C0284?SERIALAPPL:
B2:008C15 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:008C18 EE                MOV      A,R6
B2:008C19 F0                MOVX     @DPTR,A
 4118:           applNodeInfo_included_unsecure_parmLength = ((APPL_NODEPARM_MAX < applNodeInfo_included_unsecure_parmLe
>> ngth) ?  APPL_NODEPARM_MAX : applNodeInfo_included_unsecure_parmLength);
B2:008C1A 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:008C1D E0                MOVX     A,@DPTR
B2:008C1E FE                MOV      R6,A
B2:008C1F 7423              MOV      A,#023H
B2:008C21 C3                CLR      C
B2:008C22 9E                SUBB     A,R6
B2:008C23 5006              JNC      ?C0285?SERIALAPPL
B2:008C25 7D23              MOV      R5,#023H
B2:008C27 7E23              MOV      R6,#023H
B2:008C29 8000              SJMP     ?C0286?SERIALAPPL
B2:008C2B         ?C0285?SERIALAPPL:
B2:008C2B         ?C0286?SERIALAPPL:
B2:008C2B 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:008C2E EE                MOV      A,R6
B2:008C2F F0                MOVX     @DPTR,A
 4119:           applNodeInfo_included_secure_parmLength = ((APPL_NODEPARM_MAX < applNodeInfo_included_secure_parmLength
>> ) ?  APPL_NODEPARM_MAX : applNodeInfo_included_secure_parmLength);
B2:008C30 7423              MOV      A,#023H
B2:008C32 C3                CLR      C
B2:008C33 9F                SUBB     A,R7
B2:008C34 5004              JNC      ?C0287?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 550


B2:008C36 7F23              MOV      R7,#023H
B2:008C38 8005              SJMP     ?C0288?SERIALAPPL
B2:008C3A         ?C0287?SERIALAPPL:
B2:008C3A 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:008C3D E0                MOVX     A,@DPTR
B2:008C3E FF                MOV      R7,A
B2:008C3F         ?C0288?SERIALAPPL:
B2:008C3F 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:008C42 EF                MOV      A,R7
B2:008C43 F0                MOVX     @DPTR,A
 4120:           m_AppNIF.cmdClassListNonSecureCount = applNodeInfo_unincluded_parmLength;
B2:008C44 12A925            LCALL    ?L?COM032E
 4121:           m_AppNIF.cmdClassListNonSecureIncludedSecureCount = applNodeInfo_included_unsecure_parmLength;
 4122:           m_AppNIF.cmdClassListSecureCount = applNodeInfo_included_secure_parmLength;
B2:008C47 90245B            MOV      DPTR,#m_AppNIF+0BH
B2:008C4A EF                MOV      A,R7
B2:008C4B 12A792            LCALL    ?L?COM00FE
 4123:           m_AppNIF.deviceOptionsMask = applNodeInfo_deviceOptionsMask;
 4124:           m_AppNIF.nodeType.generic = applNodeInfo_nodeType_generic;
 4125:           m_AppNIF.nodeType.specific = applNodeInfo_nodeType_specific;
 4126:           Transport_OnApplicationInitSW( &m_AppNIF);
 4127:           SaveApplicationSettings();
B2:008C4E 129751            LCALL    SaveApplicationSettings
 4128:           retVal = TRUE;
B2:008C51         
 4129:           DoRespond();
 4130:           break;
B2:008C51 02931F            LJMP     ?C0598?SERIALAPPL
 4131: #endif
 4132: 
 4133: #if SUPPORT_ZW_SEND_SLAVE_NODE_INFORMATION
 4134:         case FUNC_ID_ZW_SEND_SLAVE_NODE_INFORMATION:
 4135:           /* srcNode | destNode | txOptions | funcID */
 4136:           funcID_ComplHandler_ZW_SendSlaveNodeInformation = serFrameDataPtr[3];
 4137:           retVal = ZW_SendSlaveNodeInformation(serFrameDataPtr[0], serFrameDataPtr[1], serFrameDataPtr[2],
 4138:                                                (serFrameDataPtr[3] != 0) ? ZCB_ComplHandler_ZW_SendSlaveNodeInfor
>> mation : NULL);
 4139:           DoRespond();
 4140:           break;
 4141: #endif
 4142: 
 4143: #if SUPPORT_ZW_SEND_SLAVE_DATA
 4144:         case FUNC_ID_ZW_SEND_SLAVE_DATA:
 4145:           /* srcID | destID | dataLength | pData[] | txOptions | funcID */
 4146:           {
 4147:             BYTE dataLength = serFrameDataPtr[2];
 4148:             if (dataLength > BUF_SIZE_RX)
 4149:             {
 4150:               dataLength = BUF_SIZE_RX;
 4151:             }
 4152:             for (i = 0; i < dataLength; i++)
 4153:             {
 4154:               workbuf[i] = serFrameDataPtr[3+i];
 4155:             }
 4156:             funcID_ComplHandler_ZW_SendSlaveData = serFrameDataPtr[4+dataLength];
 4157:             retVal = ZW_SendSlaveData(serFrameDataPtr[0], serFrameDataPtr[1], workbuf, dataLength, serFrameDataPt
>> r[3 + dataLength],
 4158:                                       (serFrameDataPtr[4 + dataLength] != 0) ? ComplHandler_ZW_SendSlaveData : NU
>> LL);
 4159:             DoRespond();
 4160:           }
 4161:           break;
 4162: #endif
 4163: 
 4164: #if SUPPORT_ZW_SET_SLAVE_LEARN_MODE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 551


 4165:         case FUNC_ID_ZW_SET_SLAVE_LEARN_MODE:
 4166:           /* node | mode | funcID */
 4167:           funcID_ComplHandler_ZW_SetSlaveLearnMode = serFrameDataPtr[2];
 4168:           retVal = ZW_SET_SLAVE_LEARN_MODE(serFrameDataPtr[0], serFrameDataPtr[1],
 4169:                                            (serFrameDataPtr[2] != 0) ? ZCB_ComplHandler_ZW_SetSlaveLearnMode : NU
>> LL);
 4170:           DoRespond();
 4171:           break;
 4172: #endif
 4173: 
 4174: #if SUPPORT_ZW_SEND_TEST_FRAME
 4175:         case FUNC_ID_ZW_SEND_TEST_FRAME:
B2:008C54         ?C0289?SERIALAPPL:
 4176:           /* node | powerlevel | funcID */
 4177:           funcID_ComplHandler_ZW_SendTestFrame = serFrameDataPtr[2];
B2:008C54 90340C            MOV      DPTR,#serBuf+05H
B2:008C57 E0                MOVX     A,@DPTR
B2:008C58 90279E            MOV      DPTR,#funcID_ComplHandler_ZW_SendTestFrame
B2:008C5B 12A8A3            LCALL    ?L?COM0264
B2:008C5E EE                MOV      A,R6
B2:008C5F 6006              JZ       ?C0290?SERIALAPPL
B2:008C61 7A1E              MOV      R2,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendTestFrame
B2:008C63 7B2B              MOV      R3,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_SendTestFrame
B2:008C65 8004              SJMP     ?C0291?SERIALAPPL
B2:008C67         ?C0290?SERIALAPPL:
B2:008C67 7A00              MOV      R2,#00H
B2:008C69 7B00              MOV      R3,#00H
B2:008C6B         ?C0291?SERIALAPPL:
B2:008C6B 1219D5            LCALL    ?INTERBANK_TABLE?_ZW_SendTestFrame
B2:008C6E         
 4178:           retVal = ZW_SEND_TEST_FRAME(serFrameDataPtr[0], serFrameDataPtr[1],
 4179:                                        (serFrameDataPtr[2] != 0) ? ZCB_ComplHandler_ZW_SendTestFrame : NULL);
 4180:           DoRespond();
 4181:           break;
B2:008C6E 0290BA            LJMP     ?C0599?SERIALAPPL
 4182: #endif
 4183: 
 4184: #if SUPPORT_SERIAL_API_APPL_SLAVE_NODE_INFORMATION
 4185:         case FUNC_ID_SERIAL_API_APPL_SLAVE_NODE_INFORMATION:
 4186:           /* srcNodeID | listening | generic | specific | parmLength | nodeParms[] */
 4187:           /* serFrameDataPtr[0] = srcNodeID */
 4188:           applSlaveNodeInfo_deviceOptionsMask = serFrameDataPtr[1];
 4189:           applSlaveNodeInfo_nodeType_generic = serFrameDataPtr[2];
 4190:           applSlaveNodeInfo_nodeType_specific = serFrameDataPtr[3];
 4191:           applSlaveNodeInfo_parmLength = (serFrameDataPtr[4] < sizeof(applSlaveNodeInfo_nodeParm)) ? serFrameData
>> Ptr[4] : sizeof(applSlaveNodeInfo_nodeParm);
 4192:           for (i = 0; (i < applSlaveNodeInfo_parmLength); i++)
 4193:           {
 4194:             applSlaveNodeInfo_nodeParm[i] = serFrameDataPtr[5 + i];
 4195:           }
 4196:           while (i < sizeof(applSlaveNodeInfo_nodeParm))
 4197:           {
 4198:             applSlaveNodeInfo_nodeParm[i] = 0;
 4199:             i++;
 4200:           }
 4201:           set_state(stateIdle);
 4202:           break;
 4203: #endif
 4204: 
 4205: #if SUPPORT_ZW_IS_VIRTUAL_NODE
 4206:         case FUNC_ID_ZW_IS_VIRTUAL_NODE:
 4207:           /* */
 4208:           retVal = ZW_IS_VIRTUAL_NODE(serFrameDataPtr[0]);
 4209:           DoRespond();
 4210:           break;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 552


 4211: #endif
 4212: 
 4213: #if SUPPORT_ZW_GET_VIRTUAL_NODES
 4214:         case FUNC_ID_ZW_GET_VIRTUAL_NODES:
 4215:           /* */
 4216:           ZW_GET_VIRTUAL_NODES(compl_workbuf);
 4217:           DoRespond_workbuf(ZW_MAX_NODES / 8);
 4218:           break;
 4219: #endif
 4220: 
 4221: #if SUPPORT_SERIAL_API_GET_INIT_DATA
 4222:         case FUNC_ID_SERIAL_API_GET_INIT_DATA:
B2:008C71         ?C0292?SERIALAPPL:
 4223:           /*  */
 4224:           BYTE_IN_AR(compl_workbuf, 0) = SERIAL_API_VER;
B2:008C71 902001            MOV      DPTR,#compl_workbuf
B2:008C74 7408              MOV      A,#08H
B2:008C76 F0                MOVX     @DPTR,A
 4225:           BYTE_IN_AR(compl_workbuf, 1) = 0; /* Flag byte - default: controller api, no timer support, no primary,
>>  no SUC */
B2:008C77 E4                CLR      A
B2:008C78 A3                INC      DPTR
B2:008C79 F0                MOVX     @DPTR,A
 4226: #ifdef ZW_CONTROLLER
 4227:           if (!ZW_PRIMARYCTRL())
 4228:           {
 4229:             BYTE_IN_AR(compl_workbuf, 1) |= GET_INIT_DATA_FLAG_SECONDARY_CTRL; /* Set Primary/secondary bit */
 4230:           }
 4231: #ifdef ZW_CONTROLLER_STATIC
 4232:           if (ZW_GET_CONTROLLER_CAPABILITIES() & CONTROLLER_IS_SUC)    /* if (ZW_IS_SUC_ACTIVE()) */
 4233:           {
 4234:             BYTE_IN_AR(compl_workbuf, 1) |= GET_INIT_DATA_FLAG_IS_SUC; /* Set SUC bit if active */
 4235:           }
 4236: #endif /*ZW_CONTROLLER_STATIC*/
 4237:           {
 4238:             NODEINFO nodeInfo;
 4239: 
 4240:             /* compl_workbuf[1] is already set to controller api*/
 4241:             BYTE_IN_AR(compl_workbuf, 2) = ZW_MAX_NODES / 8;     /* node bitmask length */
 4242:             /* Remember to clear the buffer!! */
 4243:             for (i = 3; i < (ZW_MAX_NODES / 8) + 3; i++)
 4244:             {
 4245:               BYTE_IN_AR(compl_workbuf, i) = 0;
 4246:             }
 4247:             /* Next ZW_MAX_NODES/8 = 29 bytes of compl_workbuf reserved for node bitmask */
 4248:             for (i = 1; i <= ZW_MAX_NODES; i++)
 4249:             {
 4250:               ZW_GetNodeProtocolInfo(i, &nodeInfo);
 4251:               if (nodeInfo.nodeType.generic)
 4252:               {
 4253:                 ZW_NodeMaskSetBit(compl_workbuf + 3, i);
 4254:               }
 4255:               ZW_POLL();
 4256:             }
 4257:           }
 4258:           BYTE_IN_AR(compl_workbuf, 3 + (ZW_MAX_NODES/8)) = ZW_CHIP_TYPE;
 4259:           BYTE_IN_AR(compl_workbuf, 4 + (ZW_MAX_NODES/8)) = ZW_CHIP_REVISION;
 4260:           DoRespond_workbuf(5 + (ZW_MAX_NODES/8));
 4261: #endif
 4262: #ifdef ZW_SLAVE
 4263:           BYTE_IN_AR(compl_workbuf, 1) |= GET_INIT_DATA_FLAG_SLAVE_API;  /* Flag byte */
B2:008C7A 04                INC      A
B2:008C7B F0                MOVX     @DPTR,A
 4264:           BYTE_IN_AR(compl_workbuf, 2) = 0;     /* node bitmask length */
B2:008C7C E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 553


B2:008C7D A3                INC      DPTR
B2:008C7E F0                MOVX     @DPTR,A
 4265:           BYTE_IN_AR(compl_workbuf, 3) = ZW_CHIP_TYPE;
B2:008C7F A3                INC      DPTR
B2:008C80 7405              MOV      A,#05H
B2:008C82 F0                MOVX     @DPTR,A
 4266:           BYTE_IN_AR(compl_workbuf, 4) = ZW_CHIP_REVISION;
B2:008C83 E4                CLR      A
B2:008C84 A3                INC      DPTR
B2:008C85 F0                MOVX     @DPTR,A
 4267:           DoRespond_workbuf(5);
B2:008C86         
B2:008C86 7F05              MOV      R7,#05H
 4268: #endif /*ZW_SLAVE*/
 4269:           break;
B2:008C88 029314            LJMP     ?C0602?SERIALAPPL
 4270: #endif
 4271: 
 4272: #if SUPPORT_ZW_GET_CONTROLLER_CAPABILITIES
 4273:         case FUNC_ID_ZW_GET_CONTROLLER_CAPABILITIES:
 4274:           /* HOST->ZW: no params defined */
 4275:           retVal = ZW_GET_CONTROLLER_CAPABILITIES();
 4276:           DoRespond();
 4277:           break;
 4278: #endif
 4279: 
 4280: #if SUPPORT_ZW_REQUEST_NODE_INFO
 4281:         case FUNC_ID_ZW_REQUEST_NODE_INFO:
B2:008C8B         ?C0293?SERIALAPPL:
 4282:           /* HOST->ZW: nodeID */
 4283:           retVal = ZW_RequestNodeInfo(serFrameDataPtr[0], ZCB_ComplHandler_ZW_RequestNodeInfo);
B2:008C8B 90340A            MOV      DPTR,#serBuf+03H
B2:008C8E E0                MOVX     A,@DPTR
B2:008C8F FF                MOV      R7,A
B2:008C90 7C1E              MOV      R4,#HIGH ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_RequestNodeInfo
B2:008C92 7D17              MOV      R5,#LOW ?INTERBANK_TABLE?_ZCB_ComplHandler_ZW_RequestNodeInfo
B2:008C94 121A25            LCALL    ?INTERBANK_TABLE?_ZW_RequestNodeInfo
B2:008C97 E4                CLR      A
B2:008C98 33                RLC      A
 4284:           DoRespond();
 4285:           break;
B2:008C99 0291EE            LJMP     ?C0601?SERIALAPPL
 4286: #endif
 4287: 
 4288: #if SUPPORT_SERIAL_API_SET_TIMEOUTS
 4289:         case FUNC_ID_SERIAL_API_SET_TIMEOUTS:
B2:008C9C         ?C0294?SERIALAPPL:
 4290:           /* HOST->ZW: RX_ACK_timeout | RX_BYTE_timeout */
 4291:           /* ZW->HOST: RES | oldRX_ACK_timeout | oldRX_BYTE_timeout */
 4292:           BYTE_IN_AR(compl_workbuf, 0) = timeOutRX_ACK;     /* Respond with the old timeout settings */
B2:008C9C 903404            MOV      DPTR,#timeOutRX_ACK
B2:008C9F E0                MOVX     A,@DPTR
B2:008CA0 902001            MOV      DPTR,#compl_workbuf
B2:008CA3 F0                MOVX     @DPTR,A
 4293:           BYTE_IN_AR(compl_workbuf, 1) = timeOutRX_BYTE;
B2:008CA4 903400            MOV      DPTR,#timeOutRX_BYTE
B2:008CA7 E0                MOVX     A,@DPTR
B2:008CA8 902002            MOV      DPTR,#compl_workbuf+01H
B2:008CAB F0                MOVX     @DPTR,A
 4294:           timeOutRX_ACK = serFrameDataPtr[0];   /* Max time to wait for ACK after frame transmission in 10ms tick
>> s */
B2:008CAC 90340A            MOV      DPTR,#serBuf+03H
B2:008CAF E0                MOVX     A,@DPTR
B2:008CB0 903404            MOV      DPTR,#timeOutRX_ACK
B2:008CB3 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 554


 4295:           timeOutRX_BYTE = serFrameDataPtr[1];  /* Max time to wait for next byte when collecting a new frame in 
>> 10ms ticks */
B2:008CB4 90340B            MOV      DPTR,#serBuf+04H
B2:008CB7 E0                MOVX     A,@DPTR
B2:008CB8 903400            MOV      DPTR,#timeOutRX_BYTE
B2:008CBB         
B2:008CBB F0                MOVX     @DPTR,A
 4296:           /* Respond with the old timeout settings */
 4297:           DoRespond_workbuf(2);
B2:008CBC         
B2:008CBC 7F02              MOV      R7,#02H
B2:008CBE         
 4298:           break;
B2:008CBE 029314            LJMP     ?C0602?SERIALAPPL
 4299: #endif
 4300: 
 4301: #if SUPPORT_SERIAL_API_SOFT_RESET
 4302:         case FUNC_ID_SERIAL_API_SOFT_RESET:
B2:008CC1         ?C0295?SERIALAPPL:
 4303:           /* HOST->ZW: No params defined */
 4304:           ZW_WATCHDOG_ENABLE;
B2:008CC1 12403E            LCALL    ZW_WatchDogEnable
B2:008CC4         ?C0296?SERIALAPPL:
 4305:           while (1)
 4306:           {
 4307:             ;
 4308:           }
B2:008CC4 80FE              SJMP     ?C0296?SERIALAPPL
 4309:           break;
 4310: #endif
 4311: 
 4312: #if SUPPORT_SERIAL_API_STARTUP_NOTIFICATION
 4313: #endif
 4314: 
 4315: #if SUPPORT_SERIAL_API_SETUP
 4316:         case FUNC_ID_SERIAL_API_SETUP:
B2:008CC6         ?C0298?SERIALAPPL:
 4317:           /**
 4318:            *  HOST->ZW: Cmd | [CmdData[]]
 4319:            *  ZW->HOST: Cmd | CmdRes[]
 4320:            *  We assume operation is nonesuccessful
 4321:            */
 4322:           retVal = FALSE;
B2:008CC6 12A857            LCALL    ?L?COM01E4
B2:008CC9 126FD5            LCALL    ?L?COM045D
B2:008CCC 4002              JC       $ + 4H
B2:008CCE A1D8              AJMP     ?C0299?SERIALAPPL
 4323:           if ((FRAME_LENGTH_MIN + 1) <= serFrameLen)
 4324:           {
 4325:             i = 1;
B2:008CD0 9024C6            MOV      DPTR,#i
B2:008CD3 7401              MOV      A,#01H
B2:008CD5 F0                MOVX     @DPTR,A
 4326:             BYTE_IN_AR(compl_workbuf, 0) = serFrameDataPtr[0];
B2:008CD6 12AAA3            LCALL    ?L?COM04F1
 4327:             switch (serFrameDataPtr[0])
B2:008CD9 24FE              ADD      A,#0FEH
B2:008CDB 6021              JZ       ?C0302?SERIALAPPL
B2:008CDD 24FE              ADD      A,#0FEH
B2:008CDF 6033              JZ       ?C0306?SERIALAPPL
B2:008CE1 24FC              ADD      A,#0FCH
B2:008CE3 7002              JNZ      $ + 4H
B2:008CE5 A17A              AJMP     ?C0308?SERIALAPPL
B2:008CE7 24F8              ADD      A,#0F8H
B2:008CE9 7002              JNZ      $ + 4H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 555


B2:008CEB A1BA              AJMP     ?C0311?SERIALAPPL
B2:008CED 240F              ADD      A,#0FH
B2:008CEF 6002              JZ       $ + 4H
B2:008CF1 A1BF              AJMP     ?C0312?SERIALAPPL
 4328:             {
 4329:               /**
 4330:                *  Report which SerialAPI Setup commands are supported beside the SERIAL_API_SETUP_CMD_SUPPORTED
 4331:                */
 4332:               case SERIAL_API_SETUP_CMD_SUPPORTED:
B2:008CF3         ?C0301?SERIALAPPL:
 4333:                 /**
 4334:                  *  HOST->ZW: SERIAL_API_SETUP_CMD_SUPPORTED
 4335:                  *  ZW->HOST: SERIAL_API_SETUP_CMD_SUPPORTED | supportedSerialAPISetupCmds
 4336:                  */
 4337:                 BYTE_IN_AR(compl_workbuf, i++) = (SERIAL_API_SETUP_CMD_TX_STATUS_REPORT |
B2:008CF3 9024C6            MOV      DPTR,#i
B2:008CF6 129A52            LCALL    ?L?COM0051
B2:008CF9 741E              MOV      A,#01EH
B2:008CFB F0                MOVX     @DPTR,A
 4338: #ifndef slave_routing
 4339:                                                   SERIAL_API_SETUP_CMD_TX_POWERLEVEL_SET |
 4340:                                                   SERIAL_API_SETUP_CMD_TX_POWERLEVEL_GET |
 4341: #endif
 4342:                                                   SERIAL_API_SETUP_CMD_TX_GET_MAX_PAYLOAD_SIZE);
 4343:                 break;
B2:008CFC A1D1              AJMP     ?C0300?SERIALAPPL
 4344: 
 4345:               case SERIAL_API_SETUP_CMD_TX_STATUS_REPORT:
B2:008CFE         ?C0302?SERIALAPPL:
 4346:                 /**
 4347:                  *  HOST->ZW: SERIAL_API_SETUP_CMD_TX_STATUS_REPORT | EnableTxStatusReport
 4348:                  *  ZW->HOST: SERIAL_API_SETUP_CMD_TX_STATUS_REPORT | retVal
 4349:                  */
 4350:                 if ((FRAME_LENGTH_MIN + 2) <= serFrameLen)
B2:008CFE 7405              MOV      A,#05H
B2:008D00 D3                SETB     C
B2:008D01 9F                SUBB     A,R7
B2:008D02 5071              JNC      ?C0603?SERIALAPPL
 4351:                 {
 4352:                   /* Do we enable or disable */
 4353:                   bTxStatusReportEnabled = (0 != serFrameDataPtr[1]);
B2:008D04 90340B            MOV      DPTR,#serBuf+04H
B2:008D07 E0                MOVX     A,@DPTR
B2:008D08 6002              JZ       ?C0304?SERIALAPPL
B2:008D0A 8001              SJMP     ?C0305?SERIALAPPL
B2:008D0C         ?C0304?SERIALAPPL:
B2:008D0C C3                CLR      C
B2:008D0D         ?C0305?SERIALAPPL:
B2:008D0D 920E              MOV      bTxStatusReportEnabled,C
 4354:                   /* Operation successful */
 4355:                   retVal = TRUE;
B2:008D0F 129D7F            LCALL    ?L?COM0204
 4356:                 }
B2:008D12         ?C0303?SERIALAPPL:
 4357:                 BYTE_IN_AR(compl_workbuf, i++) = retVal;
 4358:                 break;
B2:008D12 8061              SJMP     ?C0603?SERIALAPPL
 4359: 
 4360: #ifndef slave_routing
 4361:               case SERIAL_API_SETUP_CMD_TX_POWERLEVEL_SET:
B2:008D14         ?C0306?SERIALAPPL:
 4362:                 /**
 4363:                  *  HOST->ZW: SERIAL_API_SETUP_CMD_TX_POWER_SET | NormalPowerCh0 | NormalPowerCh1 |
 4364:                  *            NormalPowerCh2 | LowPowerCh0 |  LowPowerCh1 |  LowPowerCh2
 4365:                  *  ZW->HOST: SERIAL_API_SETUP_CMD_TX_POWER_SET | retVal
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 556


 4366:                  */
 4367:                 if ((FRAME_LENGTH_MIN + 7) <= serFrameLen)
B2:008D14 12AAE9            LCALL    ?L?COM054E
B2:008D17 D3                SETB     C
B2:008D18 9F                SUBB     A,R7
B2:008D19 5054              JNC      ?C0307?SERIALAPPL
 4368:                 {
 4369:                   sPowerlevels.normal[0] = CheckPowerlevel(serFrameDataPtr[1]);
B2:008D1B 90340B            MOV      DPTR,#serBuf+04H
B2:008D1E E0                MOVX     A,@DPTR
B2:008D1F FF                MOV      R7,A
B2:008D20 12A43E            LCALL    _CheckPowerlevel
B2:008D23 902157            MOV      DPTR,#sPowerlevels
B2:008D26 EF                MOV      A,R7
B2:008D27 F0                MOVX     @DPTR,A
 4370:                   sPowerlevels.normal[1] = CheckPowerlevel(serFrameDataPtr[2]);
B2:008D28 90340C            MOV      DPTR,#serBuf+05H
B2:008D2B E0                MOVX     A,@DPTR
B2:008D2C FF                MOV      R7,A
B2:008D2D 12A43E            LCALL    _CheckPowerlevel
B2:008D30 902158            MOV      DPTR,#sPowerlevels+01H
B2:008D33 EF                MOV      A,R7
B2:008D34 F0                MOVX     @DPTR,A
 4371:                   sPowerlevels.normal[2] = CheckPowerlevel(serFrameDataPtr[3]);
B2:008D35 90340D            MOV      DPTR,#serBuf+06H
B2:008D38 E0                MOVX     A,@DPTR
B2:008D39 FF                MOV      R7,A
B2:008D3A 12A43E            LCALL    _CheckPowerlevel
B2:008D3D 902159            MOV      DPTR,#sPowerlevels+02H
B2:008D40 EF                MOV      A,R7
B2:008D41 F0                MOVX     @DPTR,A
 4372:                   sPowerlevels.low[0] = CheckPowerlevel(serFrameDataPtr[4]);
B2:008D42 90340E            MOV      DPTR,#serBuf+07H
B2:008D45 E0                MOVX     A,@DPTR
B2:008D46 FF                MOV      R7,A
B2:008D47 12A43E            LCALL    _CheckPowerlevel
B2:008D4A 90215A            MOV      DPTR,#sPowerlevels+03H
B2:008D4D EF                MOV      A,R7
B2:008D4E F0                MOVX     @DPTR,A
 4373:                   sPowerlevels.low[1] = CheckPowerlevel(serFrameDataPtr[5]);
B2:008D4F 90340F            MOV      DPTR,#serBuf+08H
B2:008D52 E0                MOVX     A,@DPTR
B2:008D53 FF                MOV      R7,A
B2:008D54 12A43E            LCALL    _CheckPowerlevel
B2:008D57 90215B            MOV      DPTR,#sPowerlevels+04H
B2:008D5A EF                MOV      A,R7
B2:008D5B F0                MOVX     @DPTR,A
 4374:                   sPowerlevels.low[2] = CheckPowerlevel(serFrameDataPtr[6]);
B2:008D5C 903410            MOV      DPTR,#serBuf+09H
B2:008D5F E0                MOVX     A,@DPTR
B2:008D60 FF                MOV      R7,A
B2:008D61 12A43E            LCALL    _CheckPowerlevel
B2:008D64 90215C            MOV      DPTR,#sPowerlevels+05H
B2:008D67 EF                MOV      A,R7
B2:008D68 F0                MOVX     @DPTR,A
 4375: 
 4376:                   SaveApplicationSettings();
B2:008D69 129751            LCALL    SaveApplicationSettings
 4377:                   retVal = TRUE;
B2:008D6C 129D7F            LCALL    ?L?COM0204
 4378:                 }
B2:008D6F         ?C0307?SERIALAPPL:
 4379:                 i = 1;
B2:008D6F 9024C6            MOV      DPTR,#i
B2:008D72 7401              MOV      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 557


B2:008D74 F0                MOVX     @DPTR,A
 4380:                 BYTE_IN_AR(compl_workbuf, i++) = retVal;
B2:008D75         
B2:008D75 90279F            MOV      DPTR,#retVal
 4381:                 break;
B2:008D78 804D              SJMP     ?C0604?SERIALAPPL
 4382: 
 4383:               case SERIAL_API_SETUP_CMD_TX_POWERLEVEL_GET:
B2:008D7A         ?C0308?SERIALAPPL:
 4384:                 /**
 4385:                  *  HOST->ZW: SERIAL_API_SETUP_CMD_TX_POWER_GET
 4386:                  *  ZW->HOST: SERIAL_API_SETUP_CMD_TX_POWER_GET | config |
 4387:                  *            NormalPowerCh0 | NormalPowerCh1 | NormalPowerCh2 |
 4388:                  *            LowPowerCh0 |  LowPowerCh1 |  LowPowerCh2
 4389:                  */
 4390:                 if (sPowerlevels.normal[0])
B2:008D7A 902157            MOV      DPTR,#sPowerlevels
B2:008D7D E0                MOVX     A,@DPTR
B2:008D7E 9024C6            MOV      DPTR,#i
B2:008D81 6021              JZ       ?C0309?SERIALAPPL
 4391:                 {
 4392:                   /* SerialAPI has a host configured Tx power setting */
 4393:                   BYTE_IN_AR(compl_workbuf, i++) = POWERLEVEL_HOST_CONFIG;
B2:008D83 12A9E4            LCALL    ?L?COM0411
B2:008D86 129A59            LCALL    ?L?COM0052
B2:008D89 7401              MOV      A,#01H
B2:008D8B 12A0FE            LCALL    ?L?COM01D1
B2:008D8E C002              PUSH     AR2
B2:008D90 C001              PUSH     AR1
B2:008D92 7A21              MOV      R2,#HIGH sPowerlevels
B2:008D94 7957              MOV      R1,#LOW sPowerlevels
B2:008D96 129FC9            LCALL    ?L?COM021E
B2:008D99 D001              POP      AR1
B2:008D9B D002              POP      AR2
B2:008D9D 7F06              MOV      R7,#06H
B2:008D9F 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
 4394:                   memcpy(&compl_workbuf[i], (BYTE*)&sPowerlevels, sizeof(sPowerlevels));
 4395:                 }
B2:008DA2 800D              SJMP     ?C0310?SERIALAPPL
B2:008DA4         ?C0309?SERIALAPPL:
 4396:                 else
 4397:                 {
 4398:                   /* Tx power setting in the Z-Wave firmware are used */
 4399:                   BYTE_IN_AR(compl_workbuf, i++) = POWERLEVEL_FIRMWARE_CONFIG;
B2:008DA4 12A9E4            LCALL    ?L?COM0411
B2:008DA7 129A59            LCALL    ?L?COM0052
B2:008DAA E4                CLR      A
B2:008DAB 12A0FE            LCALL    ?L?COM01D1
B2:008DAE 125CF9            LCALL    _ZW_GetDefaultPowerLevels
 4400:                   ZW_GetDefaultPowerLevels(&compl_workbuf[i]);
 4401:                 }
B2:008DB1         ?C0310?SERIALAPPL:
 4402:                 i+=sizeof(sPowerlevels);
B2:008DB1 9024C6            MOV      DPTR,#i
B2:008DB4 E0                MOVX     A,@DPTR
B2:008DB5 2406              ADD      A,#06H
B2:008DB7 F0                MOVX     @DPTR,A
 4403:                 break;
B2:008DB8 8017              SJMP     ?C0300?SERIALAPPL
 4404: #endif
 4405: 
 4406:               case SERIAL_API_SETUP_CMD_TX_GET_MAX_PAYLOAD_SIZE:
B2:008DBA         ?C0311?SERIALAPPL:
 4407:                 /**
 4408:                  *  HOST->ZW: SERIAL_API_SETUP_CMD_TX_GET_MAX_PAYLOAD_SIZE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 558


 4409:                  *  ZW->HOST: SERIAL_API_SETUP_CMD_TX_GET_MAX_PAYLOAD_SIZE | txMaxPayloadSize
 4410:                  */
 4411:                 BYTE_IN_AR(compl_workbuf, i++) = ZW_GetMaxPayloadSize();
B2:008DBA 1219A3            LCALL    ?INTERBANK_TABLE?ZW_GetMaxPayloadSize
 4412:                 break;
B2:008DBD 800A              SJMP     ?C0605?SERIALAPPL
 4413: 
 4414:                 /* All other commands are unsupported */
 4415:               default:
B2:008DBF         ?C0312?SERIALAPPL:
 4416:                 /**
 4417:                  *  HOST->ZW: [SomeUnsupportedCmd] | [SomeData]
 4418:                  *  ZW->HOST: SERIAL_API_SETUP_CMD_UNSUPPORTED | [SomeUnsupportedCmd]
 4419:                  */
 4420:                 BYTE_IN_AR(compl_workbuf, 0) = SERIAL_API_SETUP_CMD_UNSUPPORTED;
B2:008DBF E4                CLR      A
B2:008DC0 902001            MOV      DPTR,#compl_workbuf
B2:008DC3 F0                MOVX     @DPTR,A
 4421:                 BYTE_IN_AR(compl_workbuf, i++) = serFrameDataPtr[0];
B2:008DC4 90340A            MOV      DPTR,#serBuf+03H
B2:008DC7         
B2:008DC7 E0                MOVX     A,@DPTR
B2:008DC8 FF                MOV      R7,A
B2:008DC9         
B2:008DC9 9024C6            MOV      DPTR,#i
B2:008DCC 129A52            LCALL    ?L?COM0051
B2:008DCF EF                MOV      A,R7
B2:008DD0 F0                MOVX     @DPTR,A
 4422:                 break;
 4423:             }
B2:008DD1         ?C0300?SERIALAPPL:
 4424:             DoRespond_workbuf(i);
B2:008DD1 9024C6            MOV      DPTR,#i
B2:008DD4         
B2:008DD4 E0                MOVX     A,@DPTR
 4425:           }
B2:008DD5 0291EA            LJMP     ?C0628?SERIALAPPL
B2:008DD8         ?C0299?SERIALAPPL:
 4426:           else
 4427:           {
 4428:             DoRespond();
B2:008DD8         
 4429:           }
 4430:           break;
B2:008DD8 02932F            LJMP     ?C0634?SERIALAPPL
 4431: #endif
 4432: 
 4433: #if SUPPORT_SERIAL_API_GET_CAPABILITIES
 4434:         case FUNC_ID_SERIAL_API_GET_CAPABILITIES:
B2:008DDB         ?C0314?SERIALAPPL:
 4435:           /* HOST->ZW: no params defined */
 4436:           /* ZW->HOST: RES | 0x07 | */
 4437:           /*  SERIAL_APPL_VERSION | SERIAL_APPL_REVISION | SERIALAPI_MANUFACTURER_ID1 | SERIALAPI_MANUFACTURER_ID
>> 2 | */
 4438:           /*  SERIALAPI_MANUFACTURER_PRODUCT_TYPE1 | SERIALAPI_MANUFACTURER_PRODUCT_TYPE2 | */
 4439:           /*  SERIALAPI_MANUFACTURER_PRODUCT_ID1 | SERIALAPI_MANUFACTURER_PRODUCT_ID2 | FUNCID_SUPPORTED_BITMASK[
>> ] */
 4440:           Respond(serFrameCmd, SERIALAPI_CAPABILITIES, sizeof(SERIALAPI_CAPABILITIES));
B2:008DDB 903409            MOV      DPTR,#serBuf+02H
B2:008DDE E0                MOVX     A,@DPTR
B2:008DDF FF                MOV      R7,A
B2:008DE0 7C27              MOV      R4,#HIGH SERIALAPI_CAPABILITIES
B2:008DE2 7D76              MOV      R5,#LOW SERIALAPI_CAPABILITIES
B2:008DE4 7B28              MOV      R3,#028H
B2:008DE6 129E40            LCALL    _Respond
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 559


 4441:           break;
B2:008DE9 0293A2            LJMP     ?C0107?SERIALAPPL
 4442: #endif
 4443: 
 4444: #if SUPPORT_SERIAL_API_POWER_MANAGEMENT
 4445:         case FUNC_ID_SERIAL_API_POWER_MANAGEMENT:
B2:008DEC         ?C0315?SERIALAPPL:
 4446:           /* HOST-ZW: */
 4447:           if ((FRAME_LENGTH_MIN + 1) <= serFrameLen)
B2:008DEC 903407            MOV      DPTR,#serBuf
B2:008DEF 126FD5            LCALL    ?L?COM045D
B2:008DF2 4003              JC       $ + 5H
B2:008DF4 029092            LJMP     ?C0316?SERIALAPPL
 4448:           {
 4449:             switch (serFrameDataPtr[0])
B2:008DF7 90340A            MOV      DPTR,#serBuf+03H
B2:008DFA E0                MOVX     A,@DPTR
B2:008DFB 12267F            LCALL    ?C?CCASE
B2:008DFE 8E17              DW       ?C0318?SERIALAPPL
B2:008E00 01                DB       01H
B2:008E01 8E98              DW       ?C0325?SERIALAPPL
B2:008E03 02                DB       02H
B2:008E04 8F2A              DW       ?C0337?SERIALAPPL
B2:008E06 03                DB       03H
B2:008E07 8FA8              DW       ?C0345?SERIALAPPL
B2:008E09 04                DB       04H
B2:008E0A 8FD7              DW       ?C0347?SERIALAPPL
B2:008E0C 05                DB       05H
B2:008E0D 9015              DW       ?C0353?SERIALAPPL
B2:008E0F 06                DB       06H
B2:008E10 9083              DW       ?C0362?SERIALAPPL
B2:008E12 07                DB       07H
B2:008E13 0000              DW       00H
B2:008E15 9090              DW       ?C0363?SERIALAPPL
 4450:             {
 4451:               case PM_PIN_UP_CONFIGURATION_CMD:
B2:008E17         ?C0318?SERIALAPPL:
 4452:                 /* HOST-ZW: */
 4453:                 if ((PM_PHYSICAL_PIN_UNDEFINED != powerManagementPoweredUp.bPin)
B2:008E17 902463            MOV      DPTR,#powerManagementPoweredUp
B2:008E1A E0                MOVX     A,@DPTR
B2:008E1B F4                CPL      A
B2:008E1C 6016              JZ       ?C0319?SERIALAPPL
B2:008E1E 90215D            MOV      DPTR,#poweredUpTimerHandle
B2:008E21 E0                MOVX     A,@DPTR
B2:008E22 FF                MOV      R7,A
B2:008E23 F4                CPL      A
B2:008E24 600E              JZ       ?C0319?SERIALAPPL
 4454:                     && (-1 != poweredUpTimerHandle))
 4455:                 {
 4456:                   poweredUpTransition = 0;
B2:008E26 E4                CLR      A
B2:008E27 9027A1            MOV      DPTR,#poweredUpTransition
B2:008E2A F0                MOVX     @DPTR,A
 4457:                   ZW_TIMER_CANCEL(poweredUpTimerHandle);
B2:008E2B 1244EE            LCALL    _TimerCancel
 4458:                   poweredUpTimerHandle = -1;
B2:008E2E 90215D            MOV      DPTR,#poweredUpTimerHandle
B2:008E31 74FF              MOV      A,#0FFH
B2:008E33 F0                MOVX     @DPTR,A
 4459:                 }
B2:008E34         ?C0319?SERIALAPPL:
 4460:                 /* Reset current PoweredUp pin to UNDEFINED */
 4461:                 powerManagementPoweredUp.bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:008E34 902463            MOV      DPTR,#powerManagementPoweredUp
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 560


B2:008E37 74FF              MOV      A,#0FFH
B2:008E39 F0                MOVX     @DPTR,A
 4462:                 /* First check if pin selected is inside the defined pin range */
 4463:                 /* values 0x20, 0x21, 0x25, 0x26, 0x27, 0x32 and 0x33 are inside */
 4464:                 /* range but should not be used. */
 4465:                 if (((FRAME_LENGTH_MIN + 2) <= serFrameLen)
B2:008E3A 903407            MOV      DPTR,#serBuf
B2:008E3D E0                MOVX     A,@DPTR
B2:008E3E FD                MOV      R5,A
B2:008E3F 7405              MOV      A,#05H
B2:008E41 D3                SETB     C
B2:008E42 9D                SUBB     A,R5
B2:008E43 5050              JNC      ?C0320?SERIALAPPL
B2:008E45 90340B            MOV      DPTR,#serBuf+04H
B2:008E48 E0                MOVX     A,@DPTR
B2:008E49 FE                MOV      R6,A
B2:008E4A 7437              MOV      A,#037H
B2:008E4C C3                CLR      C
B2:008E4D 9E                SUBB     A,R6
B2:008E4E 4045              JC       ?C0320?SERIALAPPL
B2:008E50 EE                MOV      A,R6
B2:008E51 540F              ANL      A,#0FH
B2:008E53 FE                MOV      R6,A
B2:008E54 7407              MOV      A,#07H
B2:008E56 9E                SUBB     A,R6
B2:008E57 403C              JC       ?C0320?SERIALAPPL
 4466:                     && (PM_PHYSICAL_PIN_MAX >= serFrameDataPtr[1])
 4467:                     && (0x07 >= (serFrameDataPtr[1] & 0x0F)))
 4468:                 {
 4469:                   powerManagementPoweredUp.bPin = serFrameDataPtr[1] + PM_PHYSICAL_PIN_OFFSET;
B2:008E59 E0                MOVX     A,@DPTR
B2:008E5A 2480              ADD      A,#080H
B2:008E5C 902463            MOV      DPTR,#powerManagementPoweredUp
B2:008E5F F0                MOVX     @DPTR,A
 4470:                   /* Any parameter for setting PoweredUp pin active level */
 4471:                   if ((FRAME_LENGTH_MIN + 3) <= serFrameLen)
B2:008E60 7406              MOV      A,#06H
B2:008E62 D3                SETB     C
B2:008E63 9D                SUBB     A,R5
B2:008E64 5011              JNC      ?C0321?SERIALAPPL
 4472:                   {
 4473:                     /* Set PoweredUp pin active level according to received setting */
 4474:                     powerManagementPoweredUp.bEnableLevel = (0 != serFrameDataPtr[2]) ? 1 : 0;
B2:008E66 90340C            MOV      DPTR,#serBuf+05H
B2:008E69 E0                MOVX     A,@DPTR
B2:008E6A 7F00              MOV      R7,#00H
B2:008E6C 6002              JZ       ?C0322?SERIALAPPL
B2:008E6E 7F01              MOV      R7,#01H
B2:008E70         ?C0322?SERIALAPPL:
B2:008E70         ?C0323?SERIALAPPL:
B2:008E70 902464            MOV      DPTR,#powerManagementPoweredUp+01H
B2:008E73 EF                MOV      A,R7
B2:008E74 F0                MOVX     @DPTR,A
 4475:                   }
B2:008E75 8005              SJMP     ?C0324?SERIALAPPL
B2:008E77         ?C0321?SERIALAPPL:
 4476:                   else
 4477:                   {
 4478:                     /* PoweredUp pin is Default active LOW */
 4479:                     powerManagementPoweredUp.bEnableLevel = 0;
B2:008E77 E4                CLR      A
B2:008E78 902464            MOV      DPTR,#powerManagementPoweredUp+01H
B2:008E7B F0                MOVX     @DPTR,A
 4480:                   }
B2:008E7C         ?C0324?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 561


 4481:                   /* Set Powered Up pin to input */
 4482:                   ZW_PortPinIn(powerManagementPoweredUp.bPin);
B2:008E7C 902463            MOV      DPTR,#powerManagementPoweredUp
B2:008E7F E0                MOVX     A,@DPTR
B2:008E80 FF                MOV      R7,A
B2:008E81 126CA8            LCALL    _ZW_PortPinIn
 4483:                   poweredUpTransition = 0;
B2:008E84 E4                CLR      A
B2:008E85 9027A1            MOV      DPTR,#poweredUpTransition
B2:008E88 F0                MOVX     @DPTR,A
 4484:                   poweredUpTimerHandle = ZW_TIMER_START(ZCB_powerManagementPoweredUpPinActive, 1, TIMER_FOREVER);
>> 
B2:008E89 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_powerManagementPoweredUpPinActive
B2:008E8B 7F35              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_powerManagementPoweredUpPinActive
B2:008E8D 1258DF            LCALL    ?L?COM054D
B2:008E90 90215D            MOV      DPTR,#poweredUpTimerHandle
B2:008E93 EF                MOV      A,R7
B2:008E94 F0                MOVX     @DPTR,A
 4485:                 }
B2:008E95         ?C0320?SERIALAPPL:
 4486:                 set_state(stateIdle);
B2:008E95         
B2:008E95         
 4487:                 break;
B2:008E95 029334            LJMP     ?C0617?SERIALAPPL
 4488: 
 4489:               case PM_MODE_CONFIGURATION_CMD:
B2:008E98         ?C0325?SERIALAPPL:
 4490:                 /* HOST-ZW: */
 4491:                 /* For now input pull-Ups are not set */
 4492:                 /* Reset all powerManagement WakeUp Pins to UNDEFINED. */
 4493:                 for (i = 0; i < PM_IO_PIN_MAX; i++)
B2:008E98 E4                CLR      A
B2:008E99 9024C6            MOV      DPTR,#i
B2:008E9C F0                MOVX     @DPTR,A
B2:008E9D         ?C0326?SERIALAPPL:
B2:008E9D 12994B            LCALL    ?L?COM0162
B2:008EA0 9404              SUBB     A,#04H
B2:008EA2 501A              JNC      ?C0327?SERIALAPPL
 4494:                 {
 4495:                   if (PM_PHYSICAL_PIN_UNDEFINED != powerManagementWakeUpPinConf[i].bPin)
B2:008EA4 EF                MOV      A,R7
B2:008EA5 12A353            LCALL    ?L?COM0179
B2:008EA8 E0                MOVX     A,@DPTR
B2:008EA9 FF                MOV      R7,A
B2:008EAA F4                CPL      A
B2:008EAB 6003              JZ       ?C0329?SERIALAPPL
 4496:                   {
 4497:                     /* Reset pin to Tri-state */
 4498:                     ZW_PortPinIn(powerManagementWakeUpPinConf[i].bPin);
B2:008EAD 126CA8            LCALL    _ZW_PortPinIn
 4499:                   }
B2:008EB0         ?C0329?SERIALAPPL:
 4500:                   powerManagementWakeUpPinConf[i].bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:008EB0 9024C6            MOV      DPTR,#i
B2:008EB3 E0                MOVX     A,@DPTR
B2:008EB4 12A353            LCALL    ?L?COM0179
B2:008EB7 74FF              MOV      A,#0FFH
B2:008EB9 1293B9            LCALL    ?L?COM0033
B2:008EBC 80DF              SJMP     ?C0326?SERIALAPPL
B2:008EBE         ?C0327?SERIALAPPL:
 4501:                 }
 4502:                 /* No HOST Wakeup IO pins are defined -> no Power Management mode active */
 4503:                 powerManagementState = POWER_MODE_IDLE;
B2:008EBE E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 562


B2:008EBF 902173            MOV      DPTR,#powerManagementState
B2:008EC2 F0                MOVX     @DPTR,A
 4504:                 /* Number of Power Management pins. */
 4505:                 i = serFrameDataPtr[1];
B2:008EC3 90340B            MOV      DPTR,#serBuf+04H
B2:008EC6 E0                MOVX     A,@DPTR
B2:008EC7 FF                MOV      R7,A
B2:008EC8 9024C6            MOV      DPTR,#i
B2:008ECB F0                MOVX     @DPTR,A
 4506:                 if ((0 < i)
B2:008ECC E4                CLR      A
B2:008ECD C3                CLR      C
B2:008ECE 9F                SUBB     A,R7
B2:008ECF 5056              JNC      ?C0330?SERIALAPPL
B2:008ED1 12A8E6            LCALL    ?L?COM02A9
B2:008ED4 4051              JC       ?C0330?SERIALAPPL
B2:008ED6 12A9F7            LCALL    ?L?COM043C
B2:008ED9 C3                CLR      C
B2:008EDA 9F                SUBB     A,R7
B2:008EDB 404A              JC       ?C0330?SERIALAPPL
 4507:                     && (PM_IO_PIN_MAX >= i)
 4508:                     && (serFrameLen >= (FRAME_LENGTH_MIN + 2 + (i << 1))))
 4509:                 {
B2:008EDD         ?C0331?SERIALAPPL:
 4510:                   while (i--)
B2:008EDD 12A986            LCALL    ?L?COM0396
B2:008EE0 603F              JZ       ?C0332?SERIALAPPL
 4511:                   {
 4512:                     /* Check if pin selected is inside the defined pin range */
 4513:                     /* values 0x20, 0x21, 0x25, 0x26, 0x27, 0x32 and 0x33 are inside */
 4514:                     /* range but should not be used. */
 4515:                     if ((PM_PHYSICAL_PIN_MAX >= serFrameDataPtr[2 + (i << 1)])
B2:008EE2 E0                MOVX     A,@DPTR
B2:008EE3 25E0              ADD      A,ACC
B2:008EE5 12A7D5            LCALL    ?L?COM00F9
B2:008EE8 FF                MOV      R7,A
B2:008EE9 7437              MOV      A,#037H
B2:008EEB C3                CLR      C
B2:008EEC 9F                SUBB     A,R7
B2:008EED 4032              JC       ?C0332?SERIALAPPL
B2:008EEF 12AAE1            LCALL    ?L?COM054C
B2:008EF2 402D              JC       ?C0332?SERIALAPPL
 4516:                         && (0x07 >= (serFrameDataPtr[2 + (i << 1)] & 0x0F)))
 4517:                     {
 4518:                       powerManagementWakeUpPinConf[i].bPin = serFrameDataPtr[2 + (i << 1)] + PM_PHYSICAL_PIN_OFFS
>> ET;
B2:008EF4 9024C6            MOV      DPTR,#i
B2:008EF7 E0                MOVX     A,@DPTR
B2:008EF8 FF                MOV      R7,A
B2:008EF9 25E0              ADD      A,ACC
B2:008EFB 12A7D4            LCALL    ?L?COM00F8
B2:008EFE 2480              ADD      A,#080H
B2:008F00 FD                MOV      R5,A
B2:008F01 EF                MOV      A,R7
B2:008F02 75F003            MOV      B,#03H
B2:008F05 A4                MUL      AB
B2:008F06 2466              ADD      A,#LOW powerManagementWakeUpPinConf
B2:008F08 F582              MOV      DPL,A
B2:008F0A E4                CLR      A
B2:008F0B 3421              ADDC     A,#HIGH powerManagementWakeUpPinConf
B2:008F0D 12A7F0            LCALL    ?L?COM0131
B2:008F10 7F00              MOV      R7,#00H
B2:008F12 6002              JZ       ?C0334?SERIALAPPL
B2:008F14 7F01              MOV      R7,#01H
B2:008F16         ?C0334?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 563


B2:008F16         ?C0335?SERIALAPPL:
B2:008F16 9024C6            MOV      DPTR,#i
B2:008F19 E0                MOVX     A,@DPTR
B2:008F1A 12A3C4            LCALL    ?L?COM02A7
B2:008F1D EF                MOV      A,R7
B2:008F1E F0                MOVX     @DPTR,A
 4519:                       powerManagementWakeUpPinConf[i].bEnableLevel = (0 != serFrameDataPtr[2 + 1 + (i << 1)]) ? 1
>>  : 0;
 4520:                     }
B2:008F1F 80BC              SJMP     ?C0331?SERIALAPPL
 4521:                     else
 4522:                     {
 4523:                       /* Undefined IO Pin - */
 4524:                       break;
 4525:                     }
 4526:                   }
B2:008F21         ?C0332?SERIALAPPL:
 4527:                   /* We have now defined HOST WakeUp IO Pins -> In Power Management RUNNING state */
 4528:                   powerManagementState = POWER_MODE_RUNNING;
B2:008F21 902173            MOV      DPTR,#powerManagementState
B2:008F24 7402              MOV      A,#02H
B2:008F26 F0                MOVX     @DPTR,A
 4529:                 }
B2:008F27         ?C0330?SERIALAPPL:
 4530:                 set_state(stateIdle);
B2:008F27         
 4531:                 break;
B2:008F27 029334            LJMP     ?C0617?SERIALAPPL
 4532: 
 4533:               case PM_POWERUP_ZWAVE_CONFIGURATION_CMD:
B2:008F2A         ?C0337?SERIALAPPL:
 4534:                 /* HOST-ZW: */
 4535:                 powerManagementWakeUpOnRFMode = PM_WAKEUP_UNDEFINED;
B2:008F2A 12AAD9            LCALL    ?L?COM054A
B2:008F2D         ?C0338?SERIALAPPL:
B2:008F2D 12994B            LCALL    ?L?COM0162
B2:008F30 9408              SUBB     A,#08H
B2:008F32 5009              JNC      ?C0339?SERIALAPPL
 4536:                 for (i = 0; i < PM_WAKEUP_MAX_BYTES; i++)
 4537:                 {
 4538:                   powerManagementWakeUpOnRF[i].bValue = 0;
B2:008F34 12A800            LCALL    ?L?COM017A
B2:008F37 E4                CLR      A
B2:008F38 1293B9            LCALL    ?L?COM0033
B2:008F3B 80F0              SJMP     ?C0338?SERIALAPPL
B2:008F3D         ?C0339?SERIALAPPL:
 4539:                   powerManagementWakeUpOnRF[i].bMask = PM_MASK_DONTCARE;
 4540:                 }
 4541:                 /* Valid WakeUp Match Mode */
 4542:                 if (((FRAME_LENGTH_MIN + 3) <= serFrameLen)
B2:008F3D 903407            MOV      DPTR,#serBuf
B2:008F40 E0                MOVX     A,@DPTR
B2:008F41 FF                MOV      R7,A
B2:008F42 7406              MOV      A,#06H
B2:008F44 D3                SETB     C
B2:008F45 9F                SUBB     A,R7
B2:008F46 505D              JNC      ?C0341?SERIALAPPL
B2:008F48 90340B            MOV      DPTR,#serBuf+04H
B2:008F4B E0                MOVX     A,@DPTR
B2:008F4C FE                MOV      R6,A
B2:008F4D 7403              MOV      A,#03H
B2:008F4F C3                CLR      C
B2:008F50 9E                SUBB     A,R6
B2:008F51 4052              JC       ?C0341?SERIALAPPL
 4543:                     && (PM_WAKEUP_MODE_MAX >= serFrameDataPtr[1]))
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 564


 4544:                 {
 4545:                   /* WakeUp Match Mode */
 4546:                   powerManagementWakeUpOnRFMode = serFrameDataPtr[1];
B2:008F53 9024C5            MOV      DPTR,#powerManagementWakeUpOnRFMode
B2:008F56 EE                MOV      A,R6
B2:008F57 F0                MOVX     @DPTR,A
 4547:                   /* Number of match bytes */
 4548:                   i = serFrameDataPtr[2];
B2:008F58 90340C            MOV      DPTR,#serBuf+05H
B2:008F5B E0                MOVX     A,@DPTR
B2:008F5C FE                MOV      R6,A
B2:008F5D 9024C6            MOV      DPTR,#i
B2:008F60 F0                MOVX     @DPTR,A
 4549:                   /* Check if valid */
 4550:                   if ((0 < i)
B2:008F61 E4                CLR      A
B2:008F62 9E                SUBB     A,R6
B2:008F63 5040              JNC      ?C0341?SERIALAPPL
B2:008F65 E0                MOVX     A,@DPTR
B2:008F66 FE                MOV      R6,A
B2:008F67 7408              MOV      A,#08H
B2:008F69 C3                CLR      C
B2:008F6A 9E                SUBB     A,R6
B2:008F6B 4038              JC       ?C0341?SERIALAPPL
B2:008F6D EE                MOV      A,R6
B2:008F6E 25E0              ADD      A,ACC
B2:008F70 2406              ADD      A,#06H
B2:008F72 D3                SETB     C
B2:008F73 9F                SUBB     A,R7
B2:008F74 502F              JNC      ?C0341?SERIALAPPL
 4551:                       && (PM_WAKEUP_MAX_BYTES >= i)
 4552:                       && ((FRAME_LENGTH_MIN + 3 + (i << 1)) <= serFrameLen))
 4553:                   {
 4554:                     powerManagementWakeUpOnRFCount = i;
B2:008F76 E0                MOVX     A,@DPTR
B2:008F77 9024C9            MOV      DPTR,#powerManagementWakeUpOnRFCount
B2:008F7A F0                MOVX     @DPTR,A
B2:008F7B         ?C0343?SERIALAPPL:
 4555:                     while (i--)
B2:008F7B 12A986            LCALL    ?L?COM0396
B2:008F7E 6025              JZ       ?C0341?SERIALAPPL
 4556:                     {
 4557:                       powerManagementWakeUpOnRF[i].bValue = serFrameDataPtr[3 + i];
B2:008F80 E0                MOVX     A,@DPTR
B2:008F81 FF                MOV      R7,A
B2:008F82 240D              ADD      A,#LOW serBuf+06H
B2:008F84 12A7F7            LCALL    ?L?COM0133
B2:008F87 FE                MOV      R6,A
B2:008F88 EF                MOV      A,R7
B2:008F89 12A9D8            LCALL    ?L?COM040B
B2:008F8C EE                MOV      A,R6
B2:008F8D F0                MOVX     @DPTR,A
 4558:                       powerManagementWakeUpOnRF[i].bMask = serFrameDataPtr[3 + powerManagementWakeUpOnRFCount + i
>> ];
B2:008F8E 9024C6            MOV      DPTR,#i
B2:008F91 E0                MOVX     A,@DPTR
B2:008F92 FF                MOV      R7,A
B2:008F93 9024C9            MOV      DPTR,#powerManagementWakeUpOnRFCount
B2:008F96 E0                MOVX     A,@DPTR
B2:008F97 2F                ADD      A,R7
B2:008F98 240D              ADD      A,#LOW serBuf+06H
B2:008F9A 12A7F7            LCALL    ?L?COM0133
B2:008F9D FE                MOV      R6,A
B2:008F9E 12A80E            LCALL    ?L?COM017B
B2:008FA1 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 565


B2:008FA2 F0                MOVX     @DPTR,A
 4559:                     }
B2:008FA3 80D6              SJMP     ?C0343?SERIALAPPL
 4560:                   }
 4561:                   /* If powerManagementWakeUpOnRFCount is ZERO all frames will wakeup HOST */
 4562:                 }
B2:008FA5         ?C0341?SERIALAPPL:
 4563:                 set_state(stateIdle);
B2:008FA5         
 4564:                 break;
B2:008FA5 029334            LJMP     ?C0617?SERIALAPPL
 4565: 
 4566:               case PM_POWERUP_TIMER_CONFIGURATION_CMD:
B2:008FA8         ?C0345?SERIALAPPL:
 4567:                 /* HOST-ZW: */
 4568:                 powerManagementWakeUpOnTimer = PM_TIMER_UNDEFINED;
B2:008FA8 E4                CLR      A
B2:008FA9 12A9EC            LCALL    ?L?COM043A
 4569:                 powerManagementWakeUpOnTimerCount = 0;
 4570:                 if ((PM_TIMER_MODE_MAX >= serFrameDataPtr[1])
B2:008FAC 90340B            MOV      DPTR,#serBuf+04H
B2:008FAF E0                MOVX     A,@DPTR
B2:008FB0 FF                MOV      R7,A
B2:008FB1 7402              MOV      A,#02H
B2:008FB3 C3                CLR      C
B2:008FB4 9F                SUBB     A,R7
B2:008FB5 401D              JC       ?C0346?SERIALAPPL
B2:008FB7 903407            MOV      DPTR,#serBuf
B2:008FBA E0                MOVX     A,@DPTR
B2:008FBB 9407              SUBB     A,#07H
B2:008FBD 4015              JC       ?C0346?SERIALAPPL
 4571:                     && (serFrameLen >= (FRAME_LENGTH_MIN + 4)))
 4572:                 {
 4573:                   powerManagementWakeUpOnTimer = serFrameDataPtr[1];
B2:008FBF 902442            MOV      DPTR,#powerManagementWakeUpOnTimer
B2:008FC2 EF                MOV      A,R7
B2:008FC3 F0                MOVX     @DPTR,A
 4574:                   WORD_SET_HIGH_LOW_BYTES(powerManagementWakeUpOnTimerCount, serFrameDataPtr[2], serFrameDataPtr[
>> 3]);
B2:008FC4 90340C            MOV      DPTR,#serBuf+05H
B2:008FC7 E0                MOVX     A,@DPTR
B2:008FC8 902461            MOV      DPTR,#powerManagementWakeUpOnTimerCount
B2:008FCB F0                MOVX     @DPTR,A
B2:008FCC 90340D            MOV      DPTR,#serBuf+06H
B2:008FCF E0                MOVX     A,@DPTR
B2:008FD0 902462            MOV      DPTR,#powerManagementWakeUpOnTimerCount+01H
B2:008FD3 F0                MOVX     @DPTR,A
 4575:                 }
B2:008FD4         ?C0346?SERIALAPPL:
 4576:                 set_state(stateIdle);
B2:008FD4         
 4577:                 break;
B2:008FD4 029334            LJMP     ?C0617?SERIALAPPL
 4578: 
 4579:               case PM_POWERUP_EXTERNAL_CONFIGURATION_CMD:
B2:008FD7         ?C0347?SERIALAPPL:
 4580:                 /* HOST-ZW: */
 4581:                 if (-1 != wakeUpOnExternalTimerHandle)
B2:008FD7 12A361            LCALL    ?L?COM0496
B2:008FDA 6004              JZ       ?C0348?SERIALAPPL
 4582:                 {
 4583:                   ZW_TIMER_CANCEL(wakeUpOnExternalTimerHandle);
B2:008FDC 12A212            LCALL    ?L?COM0397
B2:008FDF F0                MOVX     @DPTR,A
 4584:                   wakeUpOnExternalTimerHandle = -1;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 566


 4585:                 }
B2:008FE0         ?C0348?SERIALAPPL:
 4586:                 wakeUpOnExternal = 0;
B2:008FE0 C20F              CLR      wakeUpOnExternal
 4587:                 powerManagementWakeUpOnExternal.bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:008FE2 12AA77            LCALL    ?L?COM0492
 4588:                 powerManagementWakeUpOnExternal.bEnableLevel = 0;
 4589:                 if (serFrameLen >= (FRAME_LENGTH_MIN + 3))
B2:008FE5 903407            MOV      DPTR,#serBuf
B2:008FE8 E0                MOVX     A,@DPTR
B2:008FE9 C3                CLR      C
B2:008FEA 9406              SUBB     A,#06H
B2:008FEC 4025              JC       ?C0349?SERIALAPPL
 4590:                 {
 4591:                   if ((PM_PHYSICAL_PIN_MAX >= serFrameDataPtr[1])
B2:008FEE 90340B            MOV      DPTR,#serBuf+04H
B2:008FF1 E0                MOVX     A,@DPTR
B2:008FF2 FF                MOV      R7,A
B2:008FF3 7437              MOV      A,#037H
B2:008FF5 9F                SUBB     A,R7
B2:008FF6 401B              JC       ?C0349?SERIALAPPL
B2:008FF8 12AAE1            LCALL    ?L?COM054C
B2:008FFB 4016              JC       ?C0349?SERIALAPPL
 4592:                       && (0x07 >= (serFrameDataPtr[1] & 0x0F)))
 4593:                   {
 4594:                     powerManagementWakeUpOnExternal.bPin = serFrameDataPtr[1] + PM_PHYSICAL_PIN_OFFSET;
B2:008FFD E0                MOVX     A,@DPTR
B2:008FFE 2480              ADD      A,#080H
B2:009000 902153            MOV      DPTR,#powerManagementWakeUpOnExternal
B2:009003 F0                MOVX     @DPTR,A
 4595:                     powerManagementWakeUpOnExternal.bEnableLevel = (0 != serFrameDataPtr[2]) ? 1 : 0;
B2:009004 90340C            MOV      DPTR,#serBuf+05H
B2:009007 E0                MOVX     A,@DPTR
B2:009008 7F00              MOV      R7,#00H
B2:00900A 6002              JZ       ?C0351?SERIALAPPL
B2:00900C 7F01              MOV      R7,#01H
B2:00900E         ?C0351?SERIALAPPL:
B2:00900E         ?C0352?SERIALAPPL:
B2:00900E 902154            MOV      DPTR,#powerManagementWakeUpOnExternal+01H
B2:009011 EF                MOV      A,R7
B2:009012 F0                MOVX     @DPTR,A
 4596:                   }
 4597:                 }
B2:009013         ?C0349?SERIALAPPL:
 4598:                 set_state(stateIdle);
B2:009013         
 4599:                 break;
B2:009013 6134              AJMP     ?C0617?SERIALAPPL
 4600: 
 4601:               case PM_SET_POWER_MODE_CMD:
B2:009015         ?C0353?SERIALAPPL:
 4602:                 /* HOST-ZW: */
 4603:                 /* Reset Power Management state to IDLE */
 4604:                 powerManagementState = POWER_MODE_IDLE;
B2:009015 E4                CLR      A
B2:009016 902173            MOV      DPTR,#powerManagementState
B2:009019 F0                MOVX     @DPTR,A
 4605:                 /* Reset all Power down IO Pins to UNDEFINED. */
 4606:                 for (i = 0; i < PM_IO_PIN_MAX; i++)
B2:00901A 9024C6            MOV      DPTR,#i
B2:00901D F0                MOVX     @DPTR,A
B2:00901E         ?C0354?SERIALAPPL:
B2:00901E 12994B            LCALL    ?L?COM0162
B2:009021 9404              SUBB     A,#04H
B2:009023 500B              JNC      ?C0355?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 567


 4607:                 {
 4608:                   powerManagementPowerMode[i].bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:009025 12A300            LCALL    ?L?COM0199
B2:009028 F583              MOV      DPH,A
B2:00902A 74FF              MOV      A,#0FFH
B2:00902C 71B9              ACALL    ?L?COM0033
B2:00902E 80EE              SJMP     ?C0354?SERIALAPPL
B2:009030         ?C0355?SERIALAPPL:
 4609:                 }
 4610:                 /* Check if Frame contains valid data for command */
 4611:                 if ((0 < serFrameDataPtr[1])
B2:009030 90340B            MOV      DPTR,#serBuf+04H
B2:009033 E0                MOVX     A,@DPTR
B2:009034 FF                MOV      R7,A
B2:009035 E4                CLR      A
B2:009036 C3                CLR      C
B2:009037 9F                SUBB     A,R7
B2:009038 5047              JNC      ?C0357?SERIALAPPL
B2:00903A 7404              MOV      A,#04H
B2:00903C C3                CLR      C
B2:00903D 9F                SUBB     A,R7
B2:00903E 4041              JC       ?C0357?SERIALAPPL
B2:009040 12A9F7            LCALL    ?L?COM043C
B2:009043 FE                MOV      R6,A
B2:009044 EF                MOV      A,R7
B2:009045 D3                SETB     C
B2:009046 9E                SUBB     A,R6
B2:009047 5038              JNC      ?C0357?SERIALAPPL
 4612:                     && (PM_IO_PIN_MAX >= serFrameDataPtr[1])
 4613:                     && ((FRAME_LENGTH_MIN + 2 + (serFrameDataPtr[1] << 1)) <= serFrameLen))
 4614:                 {
 4615:                   /* Number of Power down IO Pins */
 4616:                   i = serFrameDataPtr[1];
B2:009049 90340B            MOV      DPTR,#serBuf+04H
B2:00904C E0                MOVX     A,@DPTR
B2:00904D 9024C6            MOV      DPTR,#i
B2:009050 F0                MOVX     @DPTR,A
B2:009051         ?C0358?SERIALAPPL:
 4617:                   /* Power Down IO Pin configuration */
 4618:                   while (i--)
B2:009051 12A986            LCALL    ?L?COM0396
B2:009054 6021              JZ       ?C0359?SERIALAPPL
 4619:                   {
 4620:                     powerManagementPowerMode[i].bPin = serFrameDataPtr[2 + (i << 1)] + PM_PHYSICAL_PIN_OFFSET;
B2:009056 E0                MOVX     A,@DPTR
B2:009057 FF                MOV      R7,A
B2:009058 25E0              ADD      A,ACC
B2:00905A 12A7D4            LCALL    ?L?COM00F8
B2:00905D 2480              ADD      A,#080H
B2:00905F FD                MOV      R5,A
B2:009060 12A300            LCALL    ?L?COM0199
B2:009063 12A7F0            LCALL    ?L?COM0131
B2:009066 7F00              MOV      R7,#00H
B2:009068 6002              JZ       ?C0360?SERIALAPPL
B2:00906A 7F01              MOV      R7,#01H
B2:00906C         ?C0360?SERIALAPPL:
B2:00906C         ?C0361?SERIALAPPL:
B2:00906C 9024C6            MOV      DPTR,#i
B2:00906F E0                MOVX     A,@DPTR
B2:009070 12A3B6            LCALL    ?L?COM02A6
B2:009073 EF                MOV      A,R7
B2:009074 F0                MOVX     @DPTR,A
 4621:                     powerManagementPowerMode[i].bEnableLevel = (0 != serFrameDataPtr[2 + 1 + (i << 1)]) ? 1 : 0;
 4622:                   }
B2:009075 80DA              SJMP     ?C0358?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 568


B2:009077         ?C0359?SERIALAPPL:
 4623:                   /* We should now initiate the Powerdown of HOST */
 4624:                   powerManagementState = POWER_MODE_POWERDOWN_TRANSITION;
B2:009077 902173            MOV      DPTR,#powerManagementState
B2:00907A 7403              MOV      A,#03H
B2:00907C F0                MOVX     @DPTR,A
 4625:                   /* Serial Link is now detached */
 4626:                   serialLinkState = SERIAL_LINK_DETACHED;
B2:00907D E4                CLR      A
B2:00907E 129E2C            LCALL    ?L?COM043B
 4627:                   /* Purge Callback queue */
 4628:                   PurgeCallbackQueue();
 4629:                   PurgeCommandQueue();
 4630:                 }
B2:009081         ?C0357?SERIALAPPL:
 4631:                 set_state(stateIdle);
B2:009081         
 4632:                 break;
B2:009081 6134              AJMP     ?C0617?SERIALAPPL
 4633: 
 4634:               case PM_GET_STATUS:
B2:009083         ?C0362?SERIALAPPL:
 4635:                 /* HOST->ZW:*/
 4636:                 /* ZW-HOST:*/
 4637:                 retVal = powerManagementWakeUpReason;
B2:009083 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:009086 E0                MOVX     A,@DPTR
B2:009087 90279F            MOV      DPTR,#retVal
B2:00908A F0                MOVX     @DPTR,A
 4638:                 powerManagementWakeUpReason = PM_WAKEUP_REASON_NONE;
B2:00908B E4                CLR      A
B2:00908C A3                INC      DPTR
B2:00908D F0                MOVX     @DPTR,A
 4639:                 DoRespond();
B2:00908E         
 4640:                 break;
B2:00908E 612F              AJMP     ?C0634?SERIALAPPL
 4641: 
 4642:               default:
B2:009090         ?C0363?SERIALAPPL:
 4643:                 set_state(stateIdle);
B2:009090         
 4644:                 break;
B2:009090 6134              AJMP     ?C0617?SERIALAPPL
 4645:             }
 4646:           }
B2:009092         ?C0316?SERIALAPPL:
 4647:           else
 4648:           {
 4649:             set_state(stateIdle);
B2:009092         
 4650:           }
 4651:           break;
B2:009092 6134              AJMP     ?C0617?SERIALAPPL
 4652: #endif
 4653: 
 4654: #if SUPPORT_ZW_RF_POWER_LEVEL_REDISCOVERY_SET
 4655:         case FUNC_ID_ZW_RF_POWER_LEVEL_REDISCOVERY_SET:
 4656:           /* HOST->ZW: powerLevel */
 4657:           ZW_RF_POWER_LEVEL_REDISCOVERY_SET(serFrameDataPtr[0]);
 4658:           state = stateIdle;
 4659:           break;
 4660: #endif
 4661: 
 4662: #if SUPPORT_SERIAL_API_READY
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 569


 4663:         case FUNC_ID_SERIAL_API_READY:
B2:009094         ?C0365?SERIALAPPL:
 4664:           /* HOST->ZW: [serialLinkState] */
 4665:           /* serialLinkState is OPTIONAL, if not present then the READY command, means "READY" */
 4666:           if ((FRAME_LENGTH_MIN < serFrameLen) && (SERIAL_LINK_DETACHED == serFrameDataPtr[0]))
B2:009094 903407            MOV      DPTR,#serBuf
B2:009097 E0                MOVX     A,@DPTR
B2:009098 FF                MOV      R7,A
B2:009099 7403              MOV      A,#03H
B2:00909B C3                CLR      C
B2:00909C 9F                SUBB     A,R7
B2:00909D 500B              JNC      ?C0366?SERIALAPPL
B2:00909F 90340A            MOV      DPTR,#serBuf+03H
B2:0090A2 E0                MOVX     A,@DPTR
B2:0090A3 7005              JNZ      ?C0366?SERIALAPPL
 4667:           {
 4668:             /* HOST want Serial link to be shutdown - SerialAPI will not transmit anything */
 4669:             /* via serial link as long as HOST do not reestablish the Serial Link by */
 4670:             /* transmitting a valid SerialAPI frame. */
 4671:             serialLinkState = SERIAL_LINK_DETACHED;
B2:0090A5 129E2C            LCALL    ?L?COM043B
 4672:             /* Purge Callback queue */
 4673:             PurgeCallbackQueue();
 4674:             PurgeCommandQueue();
 4675:           }
B2:0090A8 8006              SJMP     ?C0367?SERIALAPPL
B2:0090AA         ?C0366?SERIALAPPL:
 4676:           else
 4677:           {
 4678:             /* Missing serialLinkState parameter or Every other serialLinkState value means */
 4679:             /* HOST Ready for Serial Communication */
 4680:             serialLinkState = SERIAL_LINK_CONNECTED;
B2:0090AA 90215F            MOV      DPTR,#serialLinkState
B2:0090AD 7401              MOV      A,#01H
B2:0090AF F0                MOVX     @DPTR,A
 4681:           }
B2:0090B0         ?C0367?SERIALAPPL:
 4682:           set_state(stateIdle);
B2:0090B0         
 4683:           break;
B2:0090B0 6134              AJMP     ?C0617?SERIALAPPL
 4684: #endif
 4685: 
 4686: #if SUPPORT_ZW_RF_POWER_LEVEL_SET
 4687:         case FUNC_ID_ZW_RF_POWER_LEVEL_SET:
B2:0090B2         ?C0368?SERIALAPPL:
 4688:           /* powerLevel */
 4689:           retVal = ZW_RF_POWERLEVEL_SET(serFrameDataPtr[0]);
B2:0090B2 90340A            MOV      DPTR,#serBuf+03H
B2:0090B5 E0                MOVX     A,@DPTR
B2:0090B6 FF                MOV      R7,A
B2:0090B7 1259C1            LCALL    _ZW_RFPowerLevelSet
B2:0090BA         
B2:0090BA 90279F            MOV      DPTR,#retVal
B2:0090BD EF                MOV      A,R7
B2:0090BE F0                MOVX     @DPTR,A
 4690:           DoRespond();
B2:0090BF         
 4691:           break;
B2:0090BF 612F              AJMP     ?C0634?SERIALAPPL
 4692: #endif
 4693: 
 4694: #if SUPPORT_ZW_RF_POWER_LEVEL_GET
 4695:         case FUNC_ID_ZW_RF_POWER_LEVEL_GET:
B2:0090C1         ?C0369?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 570


 4696:           /* return powerlevel */
 4697:           retVal = ZW_RF_POWERLEVEL_GET();
B2:0090C1 1259BB            LCALL    ZW_RFPowerLevelGet
B2:0090C4 90279F            MOV      DPTR,#retVal
B2:0090C7 EF                MOV      A,R7
B2:0090C8 F0                MOVX     @DPTR,A
 4698:           DoRespond();
B2:0090C9         
 4699:           break;
B2:0090C9 612F              AJMP     ?C0634?SERIALAPPL
 4700: #endif
 4701: 
 4702: #if SUPPORT_ZW_TYPE_LIBRARY
 4703:         case FUNC_ID_ZW_TYPE_LIBRARY:
B2:0090CB         ?C0370?SERIALAPPL:
 4704:           retVal = ZW_TYPE_LIBRARY();
B2:0090CB 1230B6            LCALL    ZW_Type_Library
B2:0090CE 90279F            MOV      DPTR,#retVal
B2:0090D1 EF                MOV      A,R7
B2:0090D2 F0                MOVX     @DPTR,A
 4705:           DoRespond();
B2:0090D3         
 4706:           break;
B2:0090D3 612F              AJMP     ?C0634?SERIALAPPL
 4707: #endif
 4708: 
 4709: #if SUPPORT_ZW_SET_EXT_INT_LEVEL
 4710:         case FUNC_ID_ZW_SET_EXT_INT_LEVEL:
B2:0090D5         ?C0371?SERIALAPPL:
 4711:           ZW_SET_EXT_INT_LEVEL(serFrameDataPtr[0], serFrameDataPtr[1]);
B2:0090D5 12A8A5            LCALL    ?L?COM0266
B2:0090D8 125FB4            LCALL    _ZW_SetExtIntLevel
 4712:           set_state(stateIdle);
 4713:           break;
B2:0090DB 6134              AJMP     ?C0622?SERIALAPPL
 4714: #endif
 4715: 
 4716: #if SUPPORT_PWR_SETSTOPMODE
 4717:         case FUNC_ID_PWR_SETSTOPMODE:
 4718:           ZW_PWR_SET_STOP_MODE;
 4719:           set_state(stateIdle);
 4720:           break;
 4721: #endif
 4722: 
 4723: #if SUPPORT_PWR_CLK_PD
 4724:         case FUNC_ID_PWR_CLK_PD:
 4725:           ZW_PWR_CLK_POWERDOWN(serFrameDataPtr[0]);
 4726:           set_state(stateIdle);
 4727:           break;
 4728: #endif
 4729: 
 4730: #if SUPPORT_PWR_CLK_PUP
 4731:         case FUNC_ID_PWR_CLK_PUP:
 4732:           ZW_PWR_CLK_POWERUP(serFrameDataPtr[0]);
 4733:           set_state(stateIdle);
 4734:           break;
 4735: #endif
 4736: 
 4737: #if SUPPORT_PWR_SELECT_CLK
 4738:         case FUNC_ID_PWR_SELECT_CLK:
 4739:           ZW_PWR_SELECT_CLK(serFrameDataPtr[0]);
 4740:           set_state(stateIdle);
 4741:           break;
 4742: #endif
 4743: 
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 571


 4744: #if SUPPORT_ZW_SET_WUT_TIMEOUT
 4745:         case FUNC_ID_ZW_SET_WUT_TIMEOUT:
B2:0090DD         ?C0372?SERIALAPPL:
 4746:           ZW_SET_WUT_TIMEOUT(serFrameDataPtr[0]);
B2:0090DD 90340A            MOV      DPTR,#serBuf+03H
B2:0090E0 E0                MOVX     A,@DPTR
B2:0090E1 FF                MOV      R7,A
B2:0090E2 1248DA            LCALL    _ZW_SetWutTimeout
 4747:           set_state(stateIdle);
B2:0090E5         
 4748:           break;
B2:0090E5 6134              AJMP     ?C0622?SERIALAPPL
 4749: #endif
 4750: 
 4751: #if SUPPORT_ZW_IS_WUT_KICKED
 4752:         case FUNC_ID_ZW_IS_WUT_KICKED:
 4753:           retVal = ZW_IS_WUT_KICKED();
 4754:           DoRespond();
 4755:           break;
 4756: #endif
 4757: 
 4758: #if SUPPORT_ZW_GET_PROTOCOL_STATUS
 4759:         case FUNC_ID_ZW_GET_PROTOCOL_STATUS:
 4760:           retVal = ZW_GET_PROTOCOL_STATUS();
 4761:           DoRespond();
 4762:           break;
 4763: #endif
 4764: 
 4765: #if SUPPORT_ZW_WATCHDOG_ENABLE
 4766:         case FUNC_ID_ZW_WATCHDOG_ENABLE:
B2:0090E7         ?C0373?SERIALAPPL:
 4767:           ZW_WATCHDOG_ENABLE;
B2:0090E7 12403E            LCALL    ZW_WatchDogEnable
 4768:           set_state(stateIdle);
 4769:           break;
B2:0090EA 6134              AJMP     ?C0624?SERIALAPPL
 4770: #endif
 4771: 
 4772: #if SUPPORT_ZW_WATCHDOG_DISABLE
 4773:         case FUNC_ID_ZW_WATCHDOG_DISABLE:
B2:0090EC         ?C0374?SERIALAPPL:
 4774:           ZW_WATCHDOG_DISABLE;
B2:0090EC 12404B            LCALL    ZW_WatchDogDisable
 4775:           set_state(stateIdle);
B2:0090EF         
 4776:           break;
B2:0090EF 6134              AJMP     ?C0624?SERIALAPPL
 4777: #endif
 4778: 
 4779: #if SUPPORT_ZW_WATCHDOG_KICK
 4780:         case FUNC_ID_ZW_WATCHDOG_KICK:
B2:0090F1         ?C0375?SERIALAPPL:
 4781:           ZW_WATCHDOG_KICK;
B2:0090F1 1237E6            LCALL    ZW_WatchDogKick
 4782:           set_state(stateIdle);
 4783:           break;
B2:0090F4 6134              AJMP     ?C0626?SERIALAPPL
 4784: #endif
 4785: 
 4786: #if SUPPORT_ZW_WATCHDOG_START
 4787:         case FUNC_ID_ZW_WATCHDOG_START:
B2:0090F6         ?C0376?SERIALAPPL:
 4788:           ZW_WATCHDOG_ENABLE;
B2:0090F6 12403E            LCALL    ZW_WatchDogEnable
 4789:           bWatchdogStarted = TRUE;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 572


B2:0090F9 9027A3            MOV      DPTR,#bWatchdogStarted
B2:0090FC 7401              MOV      A,#01H
B2:0090FE 12AA88            LCALL    ?L?COM0495
 4790:           ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_WATCHDOG_STARTED_far, bWatchdogStarted);
 4791:           set_state(stateIdle);
B2:009101         
 4792:           break;
B2:009101 6134              AJMP     ?C0626?SERIALAPPL
 4793: #endif
 4794: 
 4795: #if SUPPORT_ZW_WATCHDOG_STOP
 4796:         case FUNC_ID_ZW_WATCHDOG_STOP:
B2:009103         ?C0377?SERIALAPPL:
 4797:           ZW_WATCHDOG_DISABLE;
B2:009103 12404B            LCALL    ZW_WatchDogDisable
 4798:           bWatchdogStarted = FALSE;
B2:009106 E4                CLR      A
B2:009107 9027A3            MOV      DPTR,#bWatchdogStarted
B2:00910A 12AA88            LCALL    ?L?COM0495
 4799:           ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_WATCHDOG_STARTED_far, bWatchdogStarted);
 4800:           set_state(stateIdle);
 4801:           break;
B2:00910D 619D              AJMP     ?C0635?SERIALAPPL
 4802: #endif
 4803: 
 4804: #if SUPPORT_ZW_NUNIT
 4805:         case FUNC_ID_ZW_NUNIT_CMD:
 4806:           state = stateIdle;
 4807:           break;
 4808: 
 4809:         case FUNC_ID_ZW_NUNIT_INIT:
 4810:           ZW_UnitTestInit(ZCB_NUnitCmd, ZCB_GetCallbackCnt);
 4811:           state = stateIdle;
 4812:           break;
 4813: 
 4814:         case FUNC_ID_ZW_NUNIT_LIST:
 4815:           ZW_UnitTestList();
 4816:           state = stateIdle;
 4817:           break;
 4818: 
 4819:         case FUNC_ID_ZW_NUNIT_RUN:
 4820:           ZW_UnitTestTcRun(serFrameDataPtr[0]);
 4821:           state = stateIdle;
 4822:           break;
 4823: 
 4824:         case FUNC_ID_ZW_NUNIT_END:
 4825:           ZW_UnitTestEnd();
 4826:           state = stateIdle;
 4827:           break;
 4828: #endif /* SUPPORT_ZW_SEND_DATA */
 4829: 
 4830: 
 4831: #if SUPPORT_ZW_PORT_STATUS
 4832:         case FUNC_ID_IO_PORT_STATUS:
 4833:           /*Enable Port Monitor. See function EventHandler()*/
 4834:           if(TRUE == serFrameDataPtr[0])
 4835:           {
 4836:             ZW_PortMonitorInit(&EventHandler);
 4837:           }
 4838:           else /*Disable Port Monitor*/
 4839:           {
 4840:             ZW_PortMonitorInit(NULL);
 4841:           }
 4842:           state = stateIdle;
 4843:           break;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 573


 4844: 
 4845:         case FUNC_ID_IO_PORT:
 4846:           retVal = TRUE;
 4847:           switch(serFrameDataPtr[0])
 4848:           {
 4849:             case ID_PORT_PIN_SET:
 4850:               ZW_PortPinSet(PM_PHYSICAL_PIN_OFFSET + serFrameDataPtr[1], serFrameDataPtr[2]);
 4851:               break;
 4852:             case ID_PORT_PIN_GET:
 4853:               retVal = ZW_PortPinGet(PM_PHYSICAL_PIN_OFFSET + serFrameDataPtr[1]);
 4854:               break;
 4855:             case ID_PORT_GET:
 4856:               retVal = ZW_PortGet(PM_PHYSICAL_PIN_OFFSET + serFrameDataPtr[1]);
 4857:               break;
 4858:             case ID_PORT_PIN_IN:
 4859:               ZW_PortMonitorPinIn(PM_PHYSICAL_PIN_OFFSET + serFrameDataPtr[1]);
 4860:               //ZW_PortPinIn(serFrameDataPtr[1]);
 4861:               break;
 4862:             case ID_PORT_PIN_OUT:
 4863:               ZW_PortMonitorPinOut(PM_PHYSICAL_PIN_OFFSET + serFrameDataPtr[1]);
 4864:               //ZW_PortPinOut(serFrameDataPtr[1]);
 4865:               break;
 4866:             default: break;
 4867: 
 4868:           }
 4869:           BYTE_IN_AR(compl_workbuf, 0) = serFrameDataPtr[0];
 4870:           BYTE_IN_AR(compl_workbuf, 1) = retVal;
 4871:           DoRespond_workbuf(2);
 4872:           break;
 4873: 
 4874: #endif /*SUPPORT_ZW_PORT_STATUS*/
 4875: 
 4876: 
 4877: 
 4878: #if SUPPORT_ZW_SET_PROMISCUOUS_MODE
 4879:         case FUNC_ID_ZW_SET_PROMISCUOUS_MODE:
 4880:           /* HOST->ZW: promiscuousMode */
 4881:           ZW_SET_PROMISCUOUS_MODE(serFrameDataPtr[0]);
 4882:           set_state(stateIdle);
 4883:         break;
 4884: #endif
 4885: 
 4886: #ifdef ZW_CONTROLLER_SINGLE
 4887: #if SUPPORT_SERIAL_API_TEST
 4888:         case FUNC_ID_SERIAL_API_TEST:
 4889:           /* HOST->ZW: testCmd | testDelay(MSB) | testDelay(LSB) | testPayloadLen | */
 4890:           /*           testCount(MSB) | testCount(LSB) | testTxOptions | nodemasklen | testnodemask[] | funcID */
>> 
 4891:           /* testCmd = 0x01 - use sendData */
 4892:           /* testCmd = 0x02 - use sendDataMeta */
 4893:           /* testCmd = 0x03 - use sendData with Basic Set toggle ON/OFF between rounds */
 4894:           /* testCmd = 0x04 - use sendDataMeta with Basic Set toggle ON/OFF between rounds */
 4895:           /* testCmd = 0x05 - use sendData with one group result frame (serial) at every round end */
 4896:           /* testCmd = 0x06 - use sendDataMeta with one group result frame (serial) at every round end */
 4897:           /* testCmd = 0x07 - use sendData with Basic Set toggle ON/OFF and one group result frame (serial) betwe
>> en rounds */
 4898:           /* testCmd = 0x08 - use sendDataMeta with Basic Set toggle ON/OFF and one group result frame (serial) b
>> etween rounds */
 4899:           /* ZW->HOST: RES | testStarted */
 4900:           retVal = FALSE;
 4901:           testCmd = serFrameDataPtr[0];
 4902:           if (testCmd && (testState != POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_INPROGRESS))
 4903:           {
 4904:             WORD_SET_HIGH_LOW_BYTES(testDelay, serFrameDataPtr[1], serFrameDataPtr[2]);
 4905:             testPayloadLen = serFrameDataPtr[3];
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 574


 4906:             WORD_SET_HIGH_LOW_BYTES(testCount, serFrameDataPtr[4], serFrameDataPtr[5]);
 4907:             testTxOptions = serFrameDataPtr[6];
 4908:             testnodemasklen = serFrameDataPtr[7];
 4909:             /*  - Boundary Check */
 4910:             if (testnodemasklen > MAX_NODEMASK_LENGTH)
 4911:             {
 4912:               testnodemasklen = MAX_NODEMASK_LENGTH;
 4913:             }
 4914:             ZW_NODE_MASK_CLEAR(testnodemask, MAX_NODEMASK_LENGTH);
 4915:             for (i = 0; i < testnodemasklen; i++)
 4916:             {
 4917:               BYTE_IN_AR(testnodemask, i) = serFrameDataPtr[i + 8];
 4918:             }
 4919:             funcID_ComplHandler_Serial_API_Test = serFrameDataPtr[serFrameDataPtr[7] + 8];
 4920:             if (testCount != 0)
 4921:             {
 4922:               testFailedCount = 0;
 4923:               testSuccessCount = 0;
 4924:               testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_INPROGRESS;
 4925:               TestStartRound();
 4926:               retVal = TRUE;
 4927:             }
 4928:             else
 4929:             {
 4930:               testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_FAILED;
 4931:               SendTestReport(0);
 4932:               break;
 4933:             }
 4934:           }
 4935:           else
 4936:           {
 4937:             /* STOP test ??? */
 4938:             if (!testCmd)
 4939:             {
 4940:               testState = POWERLEVEL_TEST_NODE_REPORT_ZW_TEST_FAILED;
 4941:               SendTestReport(0);
 4942:               retVal = TRUE;
 4943:             }
 4944:           }
 4945:           DoRespond();
 4946:           break;
 4947: #endif
 4948: #endif
 4949: 
 4950: #if SUPPORT_SERIAL_API_EXT
 4951:         case FUNC_ID_SERIAL_API_EXT:
B2:00910F         ?C0378?SERIALAPPL:
 4952:           /* HOST->ZW: mode | data */
 4953:           if (serFrameLen > FRAME_LENGTH_MIN)
B2:00910F 903407            MOV      DPTR,#serBuf
B2:009112 E0                MOVX     A,@DPTR
B2:009113 FF                MOV      R7,A
B2:009114 D3                SETB     C
B2:009115 9403              SUBB     A,#03H
B2:009117 5002              JNC      $ + 4H
B2:009119 61A2              AJMP     ?C0107?SERIALAPPL
 4954:           {
 4955:             switch (serFrameDataPtr[0])
B2:00911B 90340A            MOV      DPTR,#serBuf+03H
B2:00911E E0                MOVX     A,@DPTR
B2:00911F 14                DEC      A
B2:009120 605E              JZ       ?C0388?SERIALAPPL
B2:009122 04                INC      A
B2:009123 6002              JZ       $ + 4H
B2:009125 21ED              AJMP     ?C0395?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 575


 4956:             {
 4957:               case 0:
B2:009127         ?C0381?SERIALAPPL:
 4958:                 {
 4959:                   IBYTE *startIAdr = 0;
B2:009127 12A951            LCALL    ?L?COM035F
 4960:                   XBYTE IAdrIndex = 0;
 4961:                   XBYTE x = 0x40;
B2:00912A A3                INC      DPTR
B2:00912B 7440              MOV      A,#040H
B2:00912D F0                MOVX     @DPTR,A
 4962:                   if (serFrameLen > FRAME_LENGTH_MIN + 1)
B2:00912E EF                MOV      A,R7
B2:00912F D3                SETB     C
B2:009130 9404              SUBB     A,#04H
B2:009132 4019              JC       ?C0382?SERIALAPPL
 4963:                   {
 4964:                     IAdrIndex = serFrameDataPtr[1];
B2:009134 90340B            MOV      DPTR,#serBuf+04H
B2:009137 E0                MOVX     A,@DPTR
B2:009138 904143            MOV      DPTR,#IAdrIndex
B2:00913B F0                MOVX     @DPTR,A
 4965:                     if (serFrameLen > FRAME_LENGTH_MIN + 2)
B2:00913C 903407            MOV      DPTR,#serBuf
B2:00913F E0                MOVX     A,@DPTR
B2:009140 D3                SETB     C
B2:009141 9405              SUBB     A,#05H
B2:009143 4008              JC       ?C0382?SERIALAPPL
 4966:                     {
 4967:                       x = serFrameDataPtr[2];
B2:009145 90340C            MOV      DPTR,#serBuf+05H
B2:009148 E0                MOVX     A,@DPTR
B2:009149 904144            MOV      DPTR,#x
B2:00914C F0                MOVX     @DPTR,A
 4968:                     }
 4969:                   }
B2:00914D         ?C0382?SERIALAPPL:
 4970:                   if (x > BUF_SIZE_TX - 1)
B2:00914D 904144            MOV      DPTR,#x
B2:009150 E0                MOVX     A,@DPTR
B2:009151 D3                SETB     C
B2:009152 94A7              SUBB     A,#0A7H
B2:009154 4003              JC       ?C0384?SERIALAPPL
 4971:                   {
 4972:                     x = BUF_SIZE_TX - 1;
B2:009156 74A7              MOV      A,#0A7H
B2:009158 F0                MOVX     @DPTR,A
 4973:                   }
B2:009159         ?C0384?SERIALAPPL:
 4974:                   for (in0 = 0; in0 < x; in0++)
;---- Variable 'in0' assigned to Register 'R7' ----
B2:009159 E4                CLR      A
B2:00915A FF                MOV      R7,A
B2:00915B         ?C0385?SERIALAPPL:
B2:00915B 904144            MOV      DPTR,#x
B2:00915E E0                MOVX     A,@DPTR
B2:00915F FE                MOV      R6,A
B2:009160 EF                MOV      A,R7
B2:009161 C3                CLR      C
B2:009162 9E                SUBB     A,R6
B2:009163 5013              JNC      ?C0386?SERIALAPPL
 4975:                   {
 4976:                     BYTE_IN_AR(compl_workbuf, in0 + 1) = startIAdr[(BYTE)(IAdrIndex + in0)];
B2:009165 904143            MOV      DPTR,#IAdrIndex
B2:009168 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 576


B2:009169 2F                ADD      A,R7
B2:00916A FE                MOV      R6,A
B2:00916B 904142            MOV      DPTR,#startIAdr
B2:00916E E0                MOVX     A,@DPTR
B2:00916F 2E                ADD      A,R6
B2:009170 F8                MOV      R0,A
B2:009171 E6                MOV      A,@R0
B2:009172 12A978            LCALL    ?L?COM0395
 4977:                   }
B2:009175 0F                INC      R7
B2:009176 80E3              SJMP     ?C0385?SERIALAPPL
B2:009178         ?C0386?SERIALAPPL:
 4978:                   BYTE_IN_AR(compl_workbuf, 0) = x;
B2:009178 904144            MOV      DPTR,#x
B2:00917B 12A9AF            LCALL    ?L?COM03CE
B2:00917E         
 4979:                   DoRespond_workbuf(x + 1);
 4980:                 }
 4981:                 break;
B2:00917E 806A              SJMP     ?C0628?SERIALAPPL
 4982: 
 4983:               case 1:
B2:009180         ?C0388?SERIALAPPL:
 4984:                 {
 4985:                   XBYTE *startXAdr = 0;
B2:009180 12A951            LCALL    ?L?COM035F
 4986:                   IWORD XAdrIndex = 0;
B2:009183 F578              MOV      XAdrIndex,A
B2:009185 F579              MOV      XAdrIndex+01H,A
 4987:                   i = 0x40;
B2:009187 9024C6            MOV      DPTR,#i
B2:00918A 7440              MOV      A,#040H
B2:00918C F0                MOVX     @DPTR,A
 4988:                   if (serFrameLen > FRAME_LENGTH_MIN + 2)
B2:00918D 903407            MOV      DPTR,#serBuf
B2:009190 E0                MOVX     A,@DPTR
B2:009191 FD                MOV      R5,A
B2:009192 D3                SETB     C
B2:009193 9405              SUBB     A,#05H
B2:009195 401D              JC       ?C0389?SERIALAPPL
 4989:                   {
 4990:                     XAdrIndex = ((WORD)serFrameDataPtr[1] << 8) + serFrameDataPtr[2];
B2:009197 90340B            MOV      DPTR,#serBuf+04H
B2:00919A E0                MOVX     A,@DPTR
B2:00919B FE                MOV      R6,A
B2:00919C A3                INC      DPTR
B2:00919D E0                MOVX     A,@DPTR
B2:00919E 7A00              MOV      R2,#00H
B2:0091A0 2400              ADD      A,#00H
B2:0091A2 F579              MOV      XAdrIndex+01H,A
B2:0091A4 EA                MOV      A,R2
B2:0091A5 3E                ADDC     A,R6
B2:0091A6 F578              MOV      XAdrIndex,A
 4991:                     if (serFrameLen > FRAME_LENGTH_MIN + 3)
B2:0091A8 ED                MOV      A,R5
B2:0091A9 D3                SETB     C
B2:0091AA 9406              SUBB     A,#06H
B2:0091AC 4006              JC       ?C0389?SERIALAPPL
 4992:                     {
 4993:                       i = serFrameDataPtr[3];
B2:0091AE A3                INC      DPTR
B2:0091AF E0                MOVX     A,@DPTR
B2:0091B0 9024C6            MOV      DPTR,#i
B2:0091B3 F0                MOVX     @DPTR,A
 4994:                     }
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 577


 4995:                   }
B2:0091B4         ?C0389?SERIALAPPL:
 4996:                   if (i > BUF_SIZE_TX - 1)
B2:0091B4 9024C6            MOV      DPTR,#i
B2:0091B7 E0                MOVX     A,@DPTR
B2:0091B8 D3                SETB     C
B2:0091B9 94A7              SUBB     A,#0A7H
B2:0091BB 4003              JC       ?C0391?SERIALAPPL
 4997:                   {
 4998:                     i = BUF_SIZE_TX - 1;
B2:0091BD 74A7              MOV      A,#0A7H
B2:0091BF F0                MOVX     @DPTR,A
 4999:                   }
B2:0091C0         ?C0391?SERIALAPPL:
 5000:                   for (in1 = 0; in1 < i; in1++)
;---- Variable 'in1' assigned to Register 'R7' ----
B2:0091C0 E4                CLR      A
B2:0091C1 FF                MOV      R7,A
B2:0091C2         ?C0392?SERIALAPPL:
B2:0091C2 9024C6            MOV      DPTR,#i
B2:0091C5 E0                MOVX     A,@DPTR
B2:0091C6 FE                MOV      R6,A
B2:0091C7 EF                MOV      A,R7
B2:0091C8 C3                CLR      C
B2:0091C9 9E                SUBB     A,R6
B2:0091CA 501B              JNC      ?C0393?SERIALAPPL
 5001:                   {
 5002:                     BYTE_IN_AR(compl_workbuf, in1 + 1) = startXAdr[(WORD)(XAdrIndex + in1)];
B2:0091CC EF                MOV      A,R7
B2:0091CD 7C00              MOV      R4,#00H
B2:0091CF 2579              ADD      A,XAdrIndex+01H
B2:0091D1 FD                MOV      R5,A
B2:0091D2 EC                MOV      A,R4
B2:0091D3 3578              ADDC     A,XAdrIndex
B2:0091D5 FC                MOV      R4,A
B2:0091D6 904142            MOV      DPTR,#startXAdr
B2:0091D9 E0                MOVX     A,@DPTR
B2:0091DA FA                MOV      R2,A
B2:0091DB A3                INC      DPTR
B2:0091DC E0                MOVX     A,@DPTR
B2:0091DD 126546            LCALL    ?L?COM054B
B2:0091E0 E0                MOVX     A,@DPTR
B2:0091E1 12A978            LCALL    ?L?COM0395
 5003:                   }
B2:0091E4 0F                INC      R7
B2:0091E5 80DB              SJMP     ?C0392?SERIALAPPL
B2:0091E7         ?C0393?SERIALAPPL:
 5004:                   BYTE_IN_AR(compl_workbuf, 0) = i;
B2:0091E7 12A9AC            LCALL    ?L?COM03CD
B2:0091EA         
B2:0091EA FF                MOV      R7,A
 5005:                   DoRespond_workbuf(i + 1);
 5006:                 }
 5007:                 break;
B2:0091EB 6114              AJMP     ?C0632?SERIALAPPL
 5008: 
 5009:               default:
B2:0091ED         ?C0395?SERIALAPPL:
 5010:                 retVal = 0;
B2:0091ED E4                CLR      A
B2:0091EE         
B2:0091EE 90279F            MOV      DPTR,#retVal
B2:0091F1 F0                MOVX     @DPTR,A
 5011:                 DoRespond();
B2:0091F2         
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 578


 5012:                 break;
B2:0091F2 612F              AJMP     ?C0634?SERIALAPPL
 5013:             }
 5014:           }
 5015:           break;
 5016: #endif
 5017: 
 5018: #if SUPPORT_ZW_SET_SLEEP_MODE
 5019:         case FUNC_ID_ZW_SET_SLEEP_MODE:
B2:0091F4         ?C0396?SERIALAPPL:
 5020:           /* HOST->ZW: mode | intEnable */
 5021:           /* ZW->HOST: retVal */
 5022:           state = stateIdle;
B2:0091F4 E4                CLR      A
B2:0091F5 902162            MOV      DPTR,#state
B2:0091F8 12A8A4            LCALL    ?L?COM0265
B2:0091FB E4                CLR      A
B2:0091FC FB                MOV      R3,A
B2:0091FD 124829            LCALL    _ZW_SetSleepMode
B2:009200 12AA81            LCALL    ?L?COM0494
 5023:           retVal = ZW_SET_SLEEP_MODE(serFrameDataPtr[0], serFrameDataPtr[1]);
 5024: #ifdef ZW_SMARTSTART_ENABLED
 5025:           applPowerModeExtIntEnable = serFrameDataPtr[1];
B2:009203 90340B            MOV      DPTR,#serBuf+04H
B2:009206 E0                MOVX     A,@DPTR
B2:009207 9027A2            MOV      DPTR,#applPowerModeExtIntEnable
B2:00920A F0                MOVX     @DPTR,A
 5026:           SaveApplicationSettings();
B2:00920B F151              ACALL    SaveApplicationSettings
 5027: #endif
 5028:           DoRespond();
B2:00920D 12A169            LCALL    DoRespond
 5029:           if (retVal)
B2:009210 90279F            MOV      DPTR,#retVal
B2:009213 E0                MOVX     A,@DPTR
B2:009214 7002              JNZ      $ + 4H
B2:009216 61A2              AJMP     ?C0107?SERIALAPPL
 5030:           {
B2:009218         ?C0398?SERIALAPPL:
 5031:             /* Busy loop a bit to allow serial communication to progress */
 5032:             while (ConTxActive())
B2:009218 12A531            LCALL    ConTxActive
B2:00921B EF                MOV      A,R7
B2:00921C 7002              JNZ      $ + 4H
B2:00921E 61A2              AJMP     ?C0107?SERIALAPPL
 5033:             {
 5034:               ZW_POLL();
B2:009220 124724            LCALL    ZW_Poll
 5035:             }
B2:009223 80F3              SJMP     ?C0398?SERIALAPPL
 5036:           }
 5037:           break;
 5038: #endif
 5039: 
 5040: #if SUPPORT_ZW_GET_RANDOM
 5041:         case FUNC_ID_ZW_GET_RANDOM:
B2:009225         ?C0400?SERIALAPPL:
 5042:           /* HOST->ZW: noRandomBytes - Optional if not present or equal ZERO then  */
 5043:           /*                           2 random bytes are returned.                */
 5044:           /*                           Range 1..32 random bytes are supported      */
 5045:           /* ZW->HOST: RES | randomGenerationSuccess | noRandomBytesGenerated | noRandomGenerated[] */
 5046:           noRndBytes = serFrameDataPtr[0];
B2:009225 90340A            MOV      DPTR,#serBuf+03H
B2:009228 E0                MOVX     A,@DPTR
B2:009229 90413F            MOV      DPTR,#noRndBytes
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 579


B2:00922C F0                MOVX     @DPTR,A
 5047:           if ((serFrameLen > FRAME_LENGTH_MIN) && (noRndBytes != 0))
B2:00922D 903407            MOV      DPTR,#serBuf
B2:009230 E0                MOVX     A,@DPTR
B2:009231 D3                SETB     C
B2:009232 9403              SUBB     A,#03H
B2:009234 4010              JC       ?C0401?SERIALAPPL
B2:009236 90413F            MOV      DPTR,#noRndBytes
B2:009239 E0                MOVX     A,@DPTR
B2:00923A 600A              JZ       ?C0401?SERIALAPPL
 5048:           {
 5049:             if (noRndBytes > 32)
B2:00923C D3                SETB     C
B2:00923D 9420              SUBB     A,#020H
B2:00923F 400B              JC       ?C0403?SERIALAPPL
 5050:             {
 5051:               noRndBytes = 32;
B2:009241 7420              MOV      A,#020H
B2:009243 F0                MOVX     @DPTR,A
 5052:             }
 5053:           }
B2:009244 8006              SJMP     ?C0403?SERIALAPPL
B2:009246         ?C0401?SERIALAPPL:
 5054:           else
 5055:           {
 5056:             noRndBytes = 2;
B2:009246 90413F            MOV      DPTR,#noRndBytes
B2:009249 7402              MOV      A,#02H
B2:00924B F0                MOVX     @DPTR,A
 5057:           }
B2:00924C         ?C0403?SERIALAPPL:
 5058:           if (ZW_SetRFReceiveMode(FALSE))
B2:00924C E4                CLR      A
B2:00924D FF                MOV      R7,A
B2:00924E 125006            LCALL    _ZW_SetRFReceiveMode
B2:009251 EF                MOV      A,R7
B2:009252 6038              JZ       ?C0404?SERIALAPPL
 5059:           {
 5060:             i = 2;
B2:009254 9024C6            MOV      DPTR,#i
B2:009257 7402              MOV      A,#02H
B2:009259 F0                MOVX     @DPTR,A
B2:00925A         ?C0407?SERIALAPPL:
 5061:             do
 5062:             {
 5063:               if (!(ZW_GET_RANDOM_WORD((BYTE_P)&rndWord)))
B2:00925A 7B01              MOV      R3,#01H
B2:00925C 7A41              MOV      R2,#HIGH rndWord
B2:00925E 7940              MOV      R1,#LOW rndWord
B2:009260 125E87            LCALL    _ZW_GetRandomWord
B2:009263 5027              JNC      ?C0404?SERIALAPPL
 5064:               {
 5065:                 break;
 5066:               }
B2:009265         ?C0408?SERIALAPPL:
 5067:               BYTE_IN_AR(compl_workbuf, i++) = BYTE_GET_HIGH_BYTE_IN_WORD(rndWord);
B2:009265 904140            MOV      DPTR,#rndWord
B2:009268 E0                MOVX     A,@DPTR
B2:009269 FF                MOV      R7,A
B2:00926A 9024C6            MOV      DPTR,#i
B2:00926D 129A52            LCALL    ?L?COM0051
B2:009270 EF                MOV      A,R7
B2:009271 F0                MOVX     @DPTR,A
 5068:               BYTE_IN_AR(compl_workbuf, i++) = BYTE_GET_LOW_BYTE_IN_WORD(rndWord);
B2:009272 904141            MOV      DPTR,#rndWord+01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 580


B2:009275 E0                MOVX     A,@DPTR
B2:009276 FF                MOV      R7,A
B2:009277 9024C6            MOV      DPTR,#i
B2:00927A 129A52            LCALL    ?L?COM0051
B2:00927D EF                MOV      A,R7
B2:00927E F0                MOVX     @DPTR,A
 5069:             } while (--noRndBytes && --noRndBytes);
B2:00927F 90413F            MOV      DPTR,#noRndBytes
B2:009282 E0                MOVX     A,@DPTR
B2:009283 14                DEC      A
B2:009284 F0                MOVX     @DPTR,A
B2:009285 6005              JZ       ?C0404?SERIALAPPL
B2:009287 E0                MOVX     A,@DPTR
B2:009288 14                DEC      A
B2:009289 F0                MOVX     @DPTR,A
B2:00928A 70CE              JNZ      ?C0407?SERIALAPPL
 5070:           }
B2:00928C         ?C0404?SERIALAPPL:
 5071:           i -= 2;
B2:00928C 9024C6            MOV      DPTR,#i
B2:00928F E0                MOVX     A,@DPTR
B2:009290 24FE              ADD      A,#0FEH
B2:009292 F0                MOVX     @DPTR,A
 5072:           /* Number of random bytes returned */
 5073:           if (noRndBytes == 0xff)
B2:009293 90413F            MOV      DPTR,#noRndBytes
B2:009296 E0                MOVX     A,@DPTR
B2:009297 B4FF0C            CJNE     A,#0FFH,?C0410?SERIALAPPL
 5074:           {
 5075:             i--;
B2:00929A 9024C6            MOV      DPTR,#i
B2:00929D E0                MOVX     A,@DPTR
B2:00929E 14                DEC      A
B2:00929F F0                MOVX     @DPTR,A
 5076:             noRndBytes++;
B2:0092A0 90413F            MOV      DPTR,#noRndBytes
B2:0092A3 E0                MOVX     A,@DPTR
B2:0092A4 04                INC      A
B2:0092A5 F0                MOVX     @DPTR,A
 5077:           }
B2:0092A6         ?C0410?SERIALAPPL:
 5078:           if (noRndBytes)
B2:0092A6 90413F            MOV      DPTR,#noRndBytes
B2:0092A9 E0                MOVX     A,@DPTR
B2:0092AA FF                MOV      R7,A
B2:0092AB 6005              JZ       ?C0411?SERIALAPPL
 5079:           {
 5080:             /* Could not generate the needed number of random bytes */
 5081:             i = 0;
B2:0092AD E4                CLR      A
B2:0092AE 9024C6            MOV      DPTR,#i
B2:0092B1 F0                MOVX     @DPTR,A
 5082:           }
B2:0092B2         ?C0411?SERIALAPPL:
 5083:           BYTE_IN_AR(compl_workbuf, 0) = (!noRndBytes);
B2:0092B2 EF                MOV      A,R7
B2:0092B3 7F00              MOV      R7,#00H
B2:0092B5 7002              JNZ      ?C0412?SERIALAPPL
B2:0092B7 7F01              MOV      R7,#01H
B2:0092B9         ?C0412?SERIALAPPL:
B2:0092B9         ?C0413?SERIALAPPL:
B2:0092B9 902001            MOV      DPTR,#compl_workbuf
B2:0092BC EF                MOV      A,R7
B2:0092BD F0                MOVX     @DPTR,A
 5084:           BYTE_IN_AR(compl_workbuf, 1) = i;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 581


B2:0092BE 9024C6            MOV      DPTR,#i
B2:0092C1 12AA31            LCALL    ?L?COM048B
B2:0092C4 30E004            JNB      ACC.0,?C0414?SERIALAPPL
 5085:           /* Check if RF should be set in Receive mode. */
 5086:           if (applNodeInfo_deviceOptionsMask & APPLICATION_NODEINFO_LISTENING)
 5087:           {
 5088:             /* We are a listening device so lets return to RF Receive */
 5089:             ZW_SetRFReceiveMode(TRUE);
B2:0092C7 7F01              MOV      R7,#01H
 5090:           }
B2:0092C9 8002              SJMP     ?C0631?SERIALAPPL
B2:0092CB         ?C0414?SERIALAPPL:
 5091:           else
 5092:           {
 5093:             /* Set RF in powerdown mode */
 5094:             ZW_SetRFReceiveMode(FALSE);
B2:0092CB E4                CLR      A
B2:0092CC FF                MOV      R7,A
B2:0092CD         
B2:0092CD 125006            LCALL    _ZW_SetRFReceiveMode
 5095:           }
B2:0092D0         ?C0415?SERIALAPPL:
 5096:           DoRespond_workbuf((i ? 2 : 1) + i);
B2:0092D0 9024C6            MOV      DPTR,#i
B2:0092D3 E0                MOVX     A,@DPTR
B2:0092D4 FF                MOV      R7,A
B2:0092D5 7E01              MOV      R6,#01H
B2:0092D7 6002              JZ       ?C0416?SERIALAPPL
B2:0092D9 7E02              MOV      R6,#02H
B2:0092DB         ?C0416?SERIALAPPL:
B2:0092DB         ?C0417?SERIALAPPL:
B2:0092DB EF                MOV      A,R7
B2:0092DC 2E                ADD      A,R6
B2:0092DD FF                MOV      R7,A
B2:0092DE         
 5097:           break;
B2:0092DE 8034              SJMP     ?C0632?SERIALAPPL
 5098: #endif
 5099: 
 5100: #if SUPPORT_ZW_SET_ROUTING_MAX
 5101:         case FUNC_ID_ZW_SET_ROUTING_MAX:
 5102:         case FUNC_ID_ZW_SET_ROUTING_MAX_6_00:
 5103:           /* HOST->ZW: maxRouteTries */
 5104:           /* ZW->HOST: RES | isRoutingMAXSet */
 5105:           ZW_SetRoutingMAX(serFrameDataPtr[0]);
 5106:           retVal = TRUE;
 5107:           DoRespond();
 5108:           break;
 5109: #endif
 5110: 
 5111: #if SUPPORT_ZW_IS_PRIMARY_CTRL
 5112:         case FUNC_ID_ZW_IS_PRIMARY_CTRL:
 5113:           /* HOST->ZW: no params defined */
 5114:           /* ZW->HOST: RES | isPrimary */
 5115:           retVal = ZW_PRIMARYCTRL();
 5116:           DoRespond();
 5117:           break;
 5118: #endif
 5119: 
 5120: #if SUPPORT_ZW_AES_ECB
 5121:         case FUNC_ID_ZW_AES_ECB:
B2:0092E0         ?C0418?SERIALAPPL:
 5122:           /* HOST->ZW: key[] (16 bytes) | inputDat[] (16 bytes) */
 5123:           /* ZW->HOST: RES | outdata[] (16 bytes) */
 5124:           ZW_AES_ECB(&serFrameDataPtr[0], &serFrameDataPtr[16], compl_workbuf);
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 582


B2:0092E0 7B01              MOV      R3,#01H
B2:0092E2 7A34              MOV      R2,#HIGH serBuf+013H
B2:0092E4 791A              MOV      R1,#LOW serBuf+013H
B2:0092E6 904304            MOV      DPTR,#?_ZW_AES_ecb?BYTE+03H
B2:0092E9 122572            LCALL    ?C?PSTXDATA
B2:0092EC 7A20              MOV      R2,#HIGH compl_workbuf
B2:0092EE 7901              MOV      R1,#LOW compl_workbuf
B2:0092F0 126E65            LCALL    ?L?COM0282
B2:0092F3 7A34              MOV      R2,#HIGH serBuf+03H
B2:0092F5 790A              MOV      R1,#LOW serBuf+03H
B2:0092F7 121D77            LCALL    ?INTERBANK_TABLE?_ZW_AES_ecb
 5125:           DoRespond_workbuf(16);
B2:0092FA 7F10              MOV      R7,#010H
 5126:           break;
B2:0092FC 8016              SJMP     ?C0633?SERIALAPPL
 5127: #endif
 5128: 
 5129: #if SUPPORT_ZW_AUTO_PROGRAMMING
 5130:       case FUNC_ID_AUTO_PROGRAMMING:
B2:0092FE         ?C0419?SERIALAPPL:
 5131:         ZW_FLASH_auto_prog_set();
B2:0092FE 121D72            LCALL    ?INTERBANK_TABLE?ZW_FLASH_auto_prog_set
 5132:         break;
B2:009301 61A2              AJMP     ?C0107?SERIALAPPL
 5133: #endif
 5134: 
 5135: #if SUPPORT_ZW_GET_BACKGROUND_RSSI
 5136:         case FUNC_ID_ZW_GET_BACKGROUND_RSSI:
B2:009303         ?C0420?SERIALAPPL:
 5137:           /* HOST->ZW: (no arguments) */
 5138:           /* ZW->HOST: RES | RSSI Ch0 | RSSI Ch1 | RSSI Ch2 (3CH systems only) */
 5139:           ZW_GetBackgroundRSSI((RSSI_LEVELS*)compl_workbuf);
B2:009303 12A87C            LCALL    ?L?COM0234
B2:009306 121C19            LCALL    ?INTERBANK_TABLE?_ZW_GetBackgroundRSSI
 5140:           /* Respond with the old timeout settings */
 5141:           DoRespond_workbuf(ZW_3CH_Build ? sizeof(RSSI_LEVELS_3CH) : sizeof(RSSI_LEVELS_2CH));
B2:009309 901807            MOV      DPTR,#ZW_3CH_Build
B2:00930C E4                CLR      A
B2:00930D 93                MOVC     A,@A+DPTR
B2:00930E 7F02              MOV      R7,#02H
B2:009310 6002              JZ       ?C0421?SERIALAPPL
B2:009312 7F03              MOV      R7,#03H
B2:009314         ?C0421?SERIALAPPL:
B2:009314         ?C0422?SERIALAPPL:
B2:009314         
B2:009314         
B2:009314         
B2:009314         
B2:009314         
B2:009314         
B2:009314         
B2:009314         
B2:009314 12A177            LCALL    _DoRespond_workbuf
 5142:           break;
B2:009317 61A2              AJMP     ?C0107?SERIALAPPL
 5143: #endif
 5144: 
 5145: #if SUPPORT_ZW_SET_LISTEN_BEFORE_TALK_THRESHOLD
 5146:         case FUNC_ID_ZW_SET_LISTEN_BEFORE_TALK_THRESHOLD:
B2:009319         ?C0423?SERIALAPPL:
 5147:           /* HOST->ZW: bChannel | bThreshold */
 5148:           /* ZW->HOST: RES | TRUE */
 5149:           ZW_SetListenBeforeTalkThreshold(serFrameDataPtr[0], serFrameDataPtr[1]);
B2:009319 12A8A5            LCALL    ?L?COM0266
B2:00931C 12197B            LCALL    ?INTERBANK_TABLE?_ZW_SetListenBeforeTalkThreshold
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 583


 5150:           retVal = TRUE;
B2:00931F         
B2:00931F 129D7F            LCALL    ?L?COM0204
 5151:           DoRespond();
B2:009322         
 5152:           break;
B2:009322 800B              SJMP     ?C0634?SERIALAPPL
 5153: #endif
 5154: 
 5155: #if SUPPORT_ZW_NETWORK_MANAGEMENT_SET_MAX_INCLUSION_REQUEST_INTERVALS
 5156:         case FUNC_ID_ZW_NETWORK_MANAGEMENT_SET_MAX_INCLUSION_REQUEST_INTERVALS:
B2:009324         ?C0424?SERIALAPPL:
 5157:           /* HOST->ZW: bInclRequestIntervals */
 5158:           /* ZW->HOST: RES | TRUE */
 5159:           ZW_NetworkManagementSetMaxInclusionRequestIntervals(serFrameDataPtr[0]);
B2:009324 90340A            MOV      DPTR,#serBuf+03H
B2:009327 E0                MOVX     A,@DPTR
B2:009328 FF                MOV      R7,A
B2:009329 125F9D            LCALL    _ZW_NetworkManagementSetMaxInclusionRequestIntervals
 5160:           retVal = TRUE;
B2:00932C 129D7F            LCALL    ?L?COM0204
 5161:           DoRespond();
B2:00932F         
B2:00932F 12A169            LCALL    DoRespond
 5162:           break;
B2:009332 806E              SJMP     ?C0107?SERIALAPPL
 5163: #endif
 5164: 
 5165:         default :
B2:009334         ?C0425?SERIALAPPL:
 5166:           /* TODO - send a "Not Supported" respond frame */
 5167:           /* UNKNOWN - just drop it */
 5168:           set_state(stateIdle);
B2:009334         
B2:009334         
B2:009334         
B2:009334         
B2:009334         
 5169:           break;
B2:009334 8067              SJMP     ?C0635?SERIALAPPL
 5170:       }
 5171:     }
 5172:     break;
 5173: 
 5174:     case stateTxSerial :
B2:009336         ?C0426?SERIALAPPL:
 5175:     {
 5176:       /* Wait for ACK on send respond. Retransmit as needed */
 5177: #ifdef ENABLE_LEDS
 5178:       LedOff(1);
 5179:       LedOff(2);
 5180:       LedOn(3);
 5181: #endif
 5182:       if ((conVal = ConUpdate(FALSE)) == conFrameSent)
B2:009336 12A6A0            LCALL    ?L?COM030A
B2:009339 BF0202            CJNE     R7,#02H,?C0427?SERIALAPPL
 5183:       {
 5184:         /* One more RES transmitted succesfully */
 5185:         retry = 0;
 5186:         set_state(stateIdle);
 5187:       }
B2:00933C 8011              SJMP     ?C0636?SERIALAPPL
B2:00933E         ?C0427?SERIALAPPL:
 5188:       else if (conVal == conTxTimeout)
B2:00933E 90413E            MOV      DPTR,#conVal
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 584


B2:009341 E0                MOVX     A,@DPTR
B2:009342 6405              XRL      A,#05H
B2:009344 705C              JNZ      ?C0107?SERIALAPPL
 5189:       {
 5190:         /* Either a NAK has been received or we timed out waiting for ACK */
 5191:         if (retry++ < MAX_SERIAL_RETRY)
B2:009346 12A947            LCALL    ?L?COM035E
B2:009349 9403              SUBB     A,#03H
B2:00934B 5002              JNC      ?C0430?SERIALAPPL
 5192:         {
 5193:           ConTxFrame(0, REQUEST, NULL, 0);  /* Retry... */
 5194:         }
B2:00934D 803B              SJMP     ?C0640?SERIALAPPL
B2:00934F         ?C0430?SERIALAPPL:
 5195:         else
 5196:         {
 5197:           /* Drop RES as HOST could not be reached */
 5198:           retry = 0;
B2:00934F         
B2:00934F E4                CLR      A
B2:009350 902172            MOV      DPTR,#retry
B2:009353 F0                MOVX     @DPTR,A
 5199:           set_state(stateIdle);
 5200:         }
 5201:       }
 5202:       /* All other states are ignored, as for now the only thing we are looking for is ACK/NAK! */
 5203:     }
 5204:     break;
B2:009354 8048              SJMP     ?C0638?SERIALAPPL
 5205: 
 5206:     case stateCallbackTxSerial:
B2:009356         ?C0432?SERIALAPPL:
 5207:     {
 5208:       /* Wait for ack on unsolicited event (callback etc.) */
 5209:       /* Retransmit as needed. Remove frame from callbackQueue when done */
 5210: #ifdef ENABLE_LEDS
 5211:       LedOff(1);
 5212:       LedOn(2);
 5213:       LedOn(3);
 5214: #endif
 5215:       if ((conVal = ConUpdate(FALSE)) == conFrameSent)
B2:009356 12A6A0            LCALL    ?L?COM030A
B2:009359 BF0202            CJNE     R7,#02H,?C0433?SERIALAPPL
 5216:       {
 5217:         /* One more REQ transmitted succesfully */
 5218:         PopCallBackQueue();
 5219:       }
B2:00935C 8011              SJMP     ?C0639?SERIALAPPL
B2:00935E         ?C0433?SERIALAPPL:
 5220:       else if (conVal == conTxTimeout)
B2:00935E 90413E            MOV      DPTR,#conVal
B2:009361 E0                MOVX     A,@DPTR
B2:009362 6405              XRL      A,#05H
B2:009364 703C              JNZ      ?C0107?SERIALAPPL
 5221:       {
 5222:         /* Either a NAK has been received or we timed out waiting for ACK */
 5223:         if (retry++ < MAX_SERIAL_RETRY)
B2:009366 12A947            LCALL    ?L?COM035E
B2:009369 9403              SUBB     A,#03H
B2:00936B 5002              JNC      ?C0436?SERIALAPPL
 5224:         {
 5225:           ConTxFrame(0, REQUEST, NULL, 0);  /* Retry... */
B2:00936D         
 5226:         }
B2:00936D 801B              SJMP     ?C0640?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 585


B2:00936F         ?C0436?SERIALAPPL:
 5227:         else
 5228:         {
 5229:           /* Drop REQ as HOST could not be reached */
 5230:           PopCallBackQueue();
B2:00936F         
B2:00936F 12A3D2            LCALL    PopCallBackQueue
 5231:         }
 5232:       }
 5233:       /* All other states are ignored, as for now the only thing we are looking for is ACK/NAK! */
 5234:     }
 5235:     break;
B2:009372 802E              SJMP     ?C0107?SERIALAPPL
 5236: 
 5237:     case stateCommandTxSerial:
B2:009374         ?C0438?SERIALAPPL:
 5238:     {
 5239:       /* Wait for ack on unsolicited ApplicationCommandHandler event */
 5240:       /* Retransmit as needed. Remove frame from comamndQueue when done */
 5241: #ifdef ENABLE_LEDS
 5242:       LedOff(1);
 5243:       LedOn(2);
 5244:       LedOn(3);
 5245: #endif
 5246:       if ((conVal = ConUpdate(FALSE)) == conFrameSent)
B2:009374 12A6A0            LCALL    ?L?COM030A
B2:009377 BF0202            CJNE     R7,#02H,?C0439?SERIALAPPL
 5247:       {
 5248:         /* One more REQ transmitted succesfully */
 5249:         PopCommandQueue();
 5250:       }
B2:00937A 801C              SJMP     ?C0641?SERIALAPPL
B2:00937C         ?C0439?SERIALAPPL:
 5251:       else if (conVal == conTxTimeout)
B2:00937C 90413E            MOV      DPTR,#conVal
B2:00937F E0                MOVX     A,@DPTR
B2:009380 B4051F            CJNE     A,#05H,?C0107?SERIALAPPL
 5252:       {
 5253:         /* Either a NAK has been received or we timed out waiting for ACK */
 5254:         if (retry++ < MAX_SERIAL_RETRY)
B2:009383 12A947            LCALL    ?L?COM035E
B2:009386 9403              SUBB     A,#03H
B2:009388 500E              JNC      ?C0442?SERIALAPPL
 5255:         {
 5256:           ConTxFrame(0, REQUEST, NULL, 0);  /* Retry... */
B2:00938A         
B2:00938A E4                CLR      A
B2:00938B 904469            MOV      DPTR,#?_ConTxFrame?BYTE+04H
B2:00938E F0                MOVX     @DPTR,A
B2:00938F FB                MOV      R3,A
B2:009390 FA                MOV      R2,A
B2:009391 FD                MOV      R5,A
B2:009392 FF                MOV      R7,A
B2:009393 12A46F            LCALL    _ConTxFrame
 5257:         }
B2:009396 800A              SJMP     ?C0107?SERIALAPPL
B2:009398         ?C0442?SERIALAPPL:
 5258:         else
 5259:         {
 5260:           /* Drop REQ as HOST could not be reached */
 5261:           PopCommandQueue();
B2:009398         
B2:009398 12A3F8            LCALL    PopCommandQueue
 5262:         }
 5263:       }
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 586


 5264:       /* All other states are ignored, as for now the only thing we are looking for is ACK/NAK! */
 5265:     }
 5266:     break;
B2:00939B 8005              SJMP     ?C0107?SERIALAPPL
 5267: 
 5268:     default:
B2:00939D         ?C0444?SERIALAPPL:
 5269:       set_state(stateIdle);
B2:00939D         
B2:00939D E4                CLR      A
B2:00939E         
B2:00939E 902162            MOV      DPTR,#state
B2:0093A1 F0                MOVX     @DPTR,A
 5270:       break;
 5271:   }
B2:0093A2         ?C0107?SERIALAPPL:
 5272: #ifdef ZW_SMARTSTART_ENABLED
 5273:   /* Return E_APPLICATION_STATE_READY_FOR_POWERDOWN for system power down */
 5274:   return E_APPLICATION_STATE_ACTIVE;
B2:0093A2 7F00              MOV      R7,#00H
 5275: #endif
 5276: }
B2:0093A4 22                RET      
----- FUNCTION _ApplicationPoll (END) -------


----- FUNCTION ?L?COM0030 (BEGIN) -----
B2:0093A5 F582              MOV      DPL,A
B2:0093A7 E4                CLR      A
B2:0093A8 3434              ADDC     A,#HIGH serBuf+07H
B2:0093AA         ?L?COM0031:
B2:0093AA F583              MOV      DPH,A
B2:0093AC E0                MOVX     A,@DPTR
B2:0093AD FE                MOV      R6,A
B2:0093AE 74AA              MOV      A,#LOW workbuf
B2:0093B0 2F                ADD      A,R7
B2:0093B1 F582              MOV      DPL,A
B2:0093B3 E4                CLR      A
B2:0093B4 3420              ADDC     A,#HIGH workbuf
B2:0093B6         ?L?COM0032:
B2:0093B6 F583              MOV      DPH,A
B2:0093B8 EE                MOV      A,R6
B2:0093B9         ?L?COM0033:
B2:0093B9 F0                MOVX     @DPTR,A
B2:0093BA         ?L?COM0034:
B2:0093BA 9024C6            MOV      DPTR,#i
B2:0093BD E0                MOVX     A,@DPTR
B2:0093BE 04                INC      A
B2:0093BF F0                MOVX     @DPTR,A
B2:0093C0 22                RET      
----- FUNCTION ?L?COM0030 (END) -------


----- FUNCTION _ApplicationInitSW (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5473: ApplicationInitSW(
 5474:   ZW_NVM_STATUS nvmStatus)
B2:0093C1 9046C2            MOV      DPTR,#nvmStatus
B2:0093C4 EF                MOV      A,R7
B2:0093C5 F0                MOVX     @DPTR,A
 5475: {
 5476: #ifdef ZW_ENABLE_RTC
 5477:   ZW_CLOCK_INIT();
 5478:   ZW_RTC_INIT();
 5479: #endif
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 587


 5480:   ConInit(1152);   /* 115200 baud */
B2:0093C6 7F80              MOV      R7,#080H
B2:0093C8 7E04              MOV      R6,#04H
B2:0093CA 12A6AA            LCALL    _ConInit
 5481: 
 5482: #if SUPPORT_SERIAL_API_POWER_MANAGEMENT
 5483:   /* Reset Power Management Mode */
 5484:   powerManagementState = POWER_MODE_IDLE;
B2:0093CD E4                CLR      A
B2:0093CE 902173            MOV      DPTR,#powerManagementState
B2:0093D1 F0                MOVX     @DPTR,A
 5485:   powerManagementWakeUpReason = PM_WAKEUP_REASON_NONE;
B2:0093D2 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:0093D5 F0                MOVX     @DPTR,A
 5486: 
 5487:   /* Reset Power Management Powered Up IO Pin */
 5488:   powerManagementPoweredUp.bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:0093D6 902463            MOV      DPTR,#powerManagementPoweredUp
B2:0093D9 74FF              MOV      A,#0FFH
B2:0093DB F0                MOVX     @DPTR,A
 5489:   poweredUpTimerHandle = -1;
B2:0093DC 90215D            MOV      DPTR,#poweredUpTimerHandle
B2:0093DF F0                MOVX     @DPTR,A
 5490:   poweredUpTransition = FALSE;
B2:0093E0 E4                CLR      A
B2:0093E1 9027A1            MOV      DPTR,#poweredUpTransition
B2:0093E4 F0                MOVX     @DPTR,A
 5491:   poweredUp = FALSE;
B2:0093E5 C20C              CLR      poweredUp
 5492: 
 5493:   /* Reset Power Management Wakeup HOST IO Pin configuration */
 5494:   for (i = 0; i < PM_IO_PIN_MAX; i++)
B2:0093E7 9024C6            MOV      DPTR,#i
B2:0093EA F0                MOVX     @DPTR,A
B2:0093EB         ?C0462?SERIALAPPL:
B2:0093EB 12994B            LCALL    ?L?COM0162
B2:0093EE 9404              SUBB     A,#04H
B2:0093F0 5010              JNC      ?C0463?SERIALAPPL
 5495:   {
 5496:     /* Set Power Management pins to undefined */
 5497:     powerManagementWakeUpPinConf[i].bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:0093F2 EF                MOV      A,R7
B2:0093F3 12A353            LCALL    ?L?COM0179
B2:0093F6 74FF              MOV      A,#0FFH
B2:0093F8 F0                MOVX     @DPTR,A
 5498:     /* Set Power Management pin Enabel Level to 0 */
 5499:     powerManagementWakeUpPinConf[i].bEnableLevel = 0;
B2:0093F9 EF                MOV      A,R7
B2:0093FA 12A3C4            LCALL    ?L?COM02A7
B2:0093FD E4                CLR      A
B2:0093FE 71B9              ACALL    ?L?COM0033
B2:009400 80E9              SJMP     ?C0462?SERIALAPPL
B2:009402         ?C0463?SERIALAPPL:
 5500:   }
 5501: 
 5502:   /* Reset Power Management Powerdown IO Pin configuration */
 5503:   for (i = 0; i < PM_IO_PIN_MAX; i++)
B2:009402 E4                CLR      A
B2:009403 9024C6            MOV      DPTR,#i
B2:009406 F0                MOVX     @DPTR,A
B2:009407         ?C0465?SERIALAPPL:
B2:009407 12994B            LCALL    ?L?COM0162
B2:00940A 9404              SUBB     A,#04H
B2:00940C 5011              JNC      ?C0466?SERIALAPPL
 5504:   {
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 588


 5505:     powerManagementPowerMode[i].bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:00940E 12A300            LCALL    ?L?COM0199
B2:009411 F583              MOV      DPH,A
B2:009413 74FF              MOV      A,#0FFH
B2:009415 F0                MOVX     @DPTR,A
 5506:     powerManagementPowerMode[i].bEnableLevel = 0;
B2:009416 EF                MOV      A,R7
B2:009417 12A3B6            LCALL    ?L?COM02A6
B2:00941A E4                CLR      A
B2:00941B 71B9              ACALL    ?L?COM0033
B2:00941D 80E8              SJMP     ?C0465?SERIALAPPL
B2:00941F         ?C0466?SERIALAPPL:
 5507:   }
 5508: 
 5509:   /* Reset Power Management Wakeup on RF Mode */
 5510:   powerManagementWakeUpOnRFMode = PM_WAKEUP_UNDEFINED;
B2:00941F 12AAD9            LCALL    ?L?COM054A
B2:009422         ?C0468?SERIALAPPL:
B2:009422 12994B            LCALL    ?L?COM0162
B2:009425 9408              SUBB     A,#08H
B2:009427 5008              JNC      ?C0469?SERIALAPPL
 5511:   /* Reset Power Management Wakeup on RF Frame mask configuration */
 5512:   for (i = 0; i < PM_WAKEUP_MAX_BYTES; i++)
 5513:   {
 5514:     powerManagementWakeUpOnRF[i].bValue = PM_WAKEUP_UNDEFINED;
B2:009429 12A800            LCALL    ?L?COM017A
B2:00942C E4                CLR      A
B2:00942D 71B9              ACALL    ?L?COM0033
B2:00942F 80F1              SJMP     ?C0468?SERIALAPPL
B2:009431         ?C0469?SERIALAPPL:
 5515:     powerManagementWakeUpOnRF[i].bMask = PM_MASK_DONTCARE;
 5516:   }
 5517:   powerManagementWakeUpOnRFCount = 0;
B2:009431 E4                CLR      A
B2:009432 9024C9            MOV      DPTR,#powerManagementWakeUpOnRFCount
B2:009435 F0                MOVX     @DPTR,A
 5518:   wakeUpOnRF = FALSE;
B2:009436 C20D              CLR      wakeUpOnRF
 5519: 
 5520:   /* Reset Power Management Timer WakeUp configuration */
 5521:   powerManagementWakeUpOnTimer = PM_TIMER_UNDEFINED;
B2:009438 12A9EC            LCALL    ?L?COM043A
 5522:   powerManagementWakeUpOnTimerCount = 0;
 5523:   wakeUpOnTimerHandle = -1;
B2:00943B 12A258            LCALL    ?L?COM03D2
 5524:   wakeUpOnTimerCount = 0;
B2:00943E E4                CLR      A
B2:00943F 90243D            MOV      DPTR,#wakeUpOnTimerCount
B2:009442 F0                MOVX     @DPTR,A
B2:009443 A3                INC      DPTR
B2:009444 F0                MOVX     @DPTR,A
 5525:   wakeUpOnTimerRes = 0;
B2:009445 90247C            MOV      DPTR,#wakeUpOnTimerRes
B2:009448 F0                MOVX     @DPTR,A
 5526:   wakeUpOnTimer = FALSE;
B2:009449 C20B              CLR      wakeUpOnTimer
 5527: 
 5528:   /* Reset Power Management External PowerUp IO Pin configuration */
 5529:   powerManagementWakeUpOnExternal.bPin = PM_PHYSICAL_PIN_UNDEFINED;
B2:00944B 12AA77            LCALL    ?L?COM0492
 5530:   powerManagementWakeUpOnExternal.bEnableLevel = 0;
 5531:   wakeUpOnExternalTimerHandle = -1;
B2:00944E 90244F            MOV      DPTR,#wakeUpOnExternalTimerHandle
B2:009451 74FF              MOV      A,#0FFH
B2:009453 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 589


 5532:   wakeUpOnExternalTransition = 0;
B2:009454 E4                CLR      A
B2:009455 902164            MOV      DPTR,#wakeUpOnExternalTransition
B2:009458 F0                MOVX     @DPTR,A
 5533:   wakeUpOnExternal = FALSE;
B2:009459 C20F              CLR      wakeUpOnExternal
 5534: #endif
 5535: 
 5536: #ifdef ZW_ENABLE_RTC
 5537:   /* Init RTC timer callback functions array */
 5538:   for (i = 0; i < RTC_TIMER_MAX; i++)
 5539:   {
 5540:     switch(i)
 5541:     {
 5542:       case 0: rtcArray[i] = RTCHandler1; break;
 5543:       case 1: rtcArray[i] = RTCHandler2; break;
 5544:       case 2: rtcArray[i] = RTCHandler3; break;
 5545:       case 3: rtcArray[i] = RTCHandler4; break;
 5546:       case 4: rtcArray[i] = RTCHandler5; break;
 5547:       case 5: rtcArray[i] = RTCHandler6; break;
 5548:       case 6: rtcArray[i] = RTCHandler7; break;
 5549:       case 7: rtcArray[i] = RTCHandler8; break;
 5550:       case 8: rtcArray[i] = RTCHandler9; break;
 5551:       case 9: rtcArray[i] = RTCHandler10; break;
 5552:     }
 5553:   }
 5554: #endif
 5555: //  ZW_DEBUG_INIT(ZW_DEBUG_BAUD_RATE);
 5556: #ifndef ZW_ISD51_DEBUG
 5557:   ZW_DEBUG_INIT(1152);
 5558: #endif
 5559:   ZW_MEMORY_GET_ID(appHomeId, &appNodeId);
B2:00945B 7B01              MOV      R3,#01H
B2:00945D 7A27              MOV      R2,#HIGH appNodeId
B2:00945F 79C8              MOV      R1,#LOW appNodeId
B2:009461 126E23            LCALL    ?L?COM01CD
B2:009464 7A27              MOV      R2,#HIGH appHomeId
B2:009466 09                INC      R1
B2:009467 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetID
 5560:   if (ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MAGIC_far) == MAGIC_VALUE)
B2:00946A 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_far
B2:00946C 7FC3              MOV      R7,#LOW EEOFFSET_MAGIC_far
B2:00946E 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009471 EF                MOV      A,R7
B2:009472 6442              XRL      A,#042H
B2:009474 6002              JZ       $ + 4H
B2:009476 C17F              AJMP     ?C0471?SERIALAPPL
 5561:   {
 5562: #ifdef ZW_SLAVE
 5563:     applNodeInfo_deviceOptionsMask = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_LISTENING_far);
B2:009478 7E13              MOV      R6,#HIGH EEOFFSET_LISTENING_far
B2:00947A 7FC4              MOV      R7,#LOW EEOFFSET_LISTENING_far
B2:00947C 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00947F 902160            MOV      DPTR,#applNodeInfo_deviceOptionsMask
B2:009482 EF                MOV      A,R7
B2:009483 F0                MOVX     @DPTR,A
 5564:     applNodeInfo_nodeType_generic = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_GENERIC_far);
B2:009484 7E13              MOV      R6,#HIGH EEOFFSET_GENERIC_far
B2:009486 7FC5              MOV      R7,#LOW EEOFFSET_GENERIC_far
B2:009488 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00948B 902165            MOV      DPTR,#applNodeInfo_nodeType_generic
B2:00948E EF                MOV      A,R7
B2:00948F F0                MOVX     @DPTR,A
 5565:     applNodeInfo_nodeType_specific = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_SPECIFIC_far);
B2:009490 7E13              MOV      R6,#HIGH EEOFFSET_SPECIFIC_far
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 590


B2:009492 7FC6              MOV      R7,#LOW EEOFFSET_SPECIFIC_far
B2:009494 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009497 902161            MOV      DPTR,#applNodeInfo_nodeType_specific
B2:00949A EF                MOV      A,R7
B2:00949B F0                MOVX     @DPTR,A
 5566: #endif
 5567: #ifdef ZW_CONTROLLER
 5568:     ZW_GET_NODE_STATE(appNodeId, (NODEINFO *)compl_workbuf);
 5569:     /* Update application level nodetype variables */
 5570:     applNodeInfo_deviceOptionsMask = ((((NODEINFO *)compl_workbuf)->capability & NODEINFO_LISTENING_SUPPORT) ? AP
>> PLICATION_NODEINFO_LISTENING : 0)|
 5571:                                       ((((NODEINFO *)compl_workbuf)->security & NODEINFO_OPTIONAL_FUNC_SUPPORT ) 
>> ? APPLICATION_NODEINFO_OPTIONAL_FUNCTIONALITY : 0);
 5572:     applNodeInfo_nodeType_generic = ((NODEINFO *)compl_workbuf)->nodeType.generic;
 5573:     applNodeInfo_nodeType_specific = ((NODEINFO *)compl_workbuf)->nodeType.specific;
 5574: #endif
 5575:     /* Update command class membership */
 5576:     applNodeInfo_parmLength = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_LEN_far);
B2:00949C 7E13              MOV      R6,#HIGH EEOFFSET_CMDCLASS_LEN_far
B2:00949E 7FC7              MOV      R7,#LOW EEOFFSET_CMDCLASS_LEN_far
B2:0094A0 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:0094A3 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:0094A6 EF                MOV      A,R7
B2:0094A7 F0                MOVX     @DPTR,A
 5577:     if (applNodeInfo_parmLength > APPL_NODEPARM_MAX)
B2:0094A8 D3                SETB     C
B2:0094A9 9423              SUBB     A,#023H
B2:0094AB 4003              JC       ?C0472?SERIALAPPL
 5578:     {
 5579:       applNodeInfo_parmLength = APPL_NODEPARM_MAX;
B2:0094AD 7423              MOV      A,#023H
B2:0094AF F0                MOVX     @DPTR,A
 5580:     }
B2:0094B0         ?C0472?SERIALAPPL:
 5581:     for (i = 0; i < applNodeInfo_parmLength; i++)
B2:0094B0 E4                CLR      A
B2:0094B1 9024C6            MOV      DPTR,#i
B2:0094B4 F0                MOVX     @DPTR,A
B2:0094B5         ?C0473?SERIALAPPL:
B2:0094B5 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:0094B8 1298EB            LCALL    ?L?COM0080
B2:0094BB 500E              JNC      ?C0474?SERIALAPPL
 5582:     {
 5583:       applNodeInfo_nodeParm[i] = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_far + i);
B2:0094BD 12AA6D            LCALL    ?L?COM0491
B2:0094C0 129A61            LCALL    ?L?COM035D
B2:0094C3 12A8ED            LCALL    ?L?COM02BF
B2:0094C6 EF                MOV      A,R7
B2:0094C7 71B9              ACALL    ?L?COM0033
B2:0094C9 80EA              SJMP     ?C0473?SERIALAPPL
B2:0094CB         ?C0474?SERIALAPPL:
 5584:     }
 5585: 
 5586: #if SUPPORT_ZW_WATCHDOG_START || SUPPORT_ZW_WATCHDOG_STOP
 5587: 
 5588:     bWatchdogStarted = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_WATCHDOG_STARTED_far);
B2:0094CB 7E13              MOV      R6,#HIGH EEOFFSET_WATCHDOG_STARTED_far
B2:0094CD 7FEB              MOV      R7,#LOW EEOFFSET_WATCHDOG_STARTED_far
B2:0094CF 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:0094D2 9027A3            MOV      DPTR,#bWatchdogStarted
B2:0094D5 EF                MOV      A,R7
B2:0094D6 F0                MOVX     @DPTR,A
 5589: 
 5590: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 5591:     /* Unincluded Supported Command Classes */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 591


 5592:     applNodeInfo_unincluded_parmLength = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_UNINCLUDED_LEN_far);
B2:0094D7 7E13              MOV      R6,#HIGH EEOFFSET_CMDCLASS_UNINCLUDED_LEN_far
B2:0094D9 7FEC              MOV      R7,#LOW EEOFFSET_CMDCLASS_UNINCLUDED_LEN_far
B2:0094DB 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:0094DE 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0094E1 EF                MOV      A,R7
B2:0094E2 F0                MOVX     @DPTR,A
 5593:     if (applNodeInfo_unincluded_parmLength > APPL_NODEPARM_MAX)
B2:0094E3 D3                SETB     C
B2:0094E4 9423              SUBB     A,#023H
B2:0094E6 4003              JC       ?C0476?SERIALAPPL
 5594:     {
 5595:       applNodeInfo_unincluded_parmLength = APPL_NODEPARM_MAX;
B2:0094E8 7423              MOV      A,#023H
B2:0094EA F0                MOVX     @DPTR,A
 5596:     }
B2:0094EB         ?C0476?SERIALAPPL:
 5597:     for (i = 0; i < applNodeInfo_unincluded_parmLength; i++)
B2:0094EB E4                CLR      A
B2:0094EC 9024C6            MOV      DPTR,#i
B2:0094EF F0                MOVX     @DPTR,A
B2:0094F0         ?C0477?SERIALAPPL:
B2:0094F0 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0094F3 1298EB            LCALL    ?L?COM0080
B2:0094F6 500E              JNC      ?C0478?SERIALAPPL
 5598:     {
 5599:       applNodeInfo_unincluded_nodeParm[i] = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_UNINCLUDED_far + i);
B2:0094F8 12AA63            LCALL    ?L?COM0490
B2:0094FB 129A61            LCALL    ?L?COM035D
B2:0094FE 12A88C            LCALL    ?L?COM025E
B2:009501 EF                MOV      A,R7
B2:009502 71B9              ACALL    ?L?COM0033
B2:009504 80EA              SJMP     ?C0477?SERIALAPPL
B2:009506         ?C0478?SERIALAPPL:
 5600:     }
 5601:     /* Included Unsecure Supported Command Classes */
 5602:     applNodeInfo_included_unsecure_parmLength = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_LEN_fa
>> r);
B2:009506 7E14              MOV      R6,#HIGH EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_LEN_far
B2:009508 7F10              MOV      R7,#LOW EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_LEN_far
B2:00950A 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00950D 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:009510 EF                MOV      A,R7
B2:009511 F0                MOVX     @DPTR,A
 5603:     if (applNodeInfo_included_unsecure_parmLength > APPL_NODEPARM_MAX)
B2:009512 D3                SETB     C
B2:009513 9423              SUBB     A,#023H
B2:009515 4003              JC       ?C0480?SERIALAPPL
 5604:     {
 5605:       applNodeInfo_included_unsecure_parmLength = APPL_NODEPARM_MAX;
B2:009517 7423              MOV      A,#023H
B2:009519 F0                MOVX     @DPTR,A
 5606:     }
B2:00951A         ?C0480?SERIALAPPL:
 5607:     for (i = 0; i < applNodeInfo_included_unsecure_parmLength; i++)
B2:00951A E4                CLR      A
B2:00951B 9024C6            MOV      DPTR,#i
B2:00951E F0                MOVX     @DPTR,A
B2:00951F         ?C0481?SERIALAPPL:
B2:00951F 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:009522 1298EB            LCALL    ?L?COM0080
B2:009525 5011              JNC      ?C0482?SERIALAPPL
 5608:     {
 5609:       applNodeInfo_included_unsecure_nodeParm[i] = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_far
>>  + i);
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 592


B2:009527 12AA59            LCALL    ?L?COM048F
B2:00952A 129A61            LCALL    ?L?COM035D
B2:00952D E0                MOVX     A,@DPTR
B2:00952E 247F              ADD      A,#LOW applNodeInfo_included_unsecure_nodeParm
B2:009530 12A959            LCALL    ?L?COM0360
B2:009533 EF                MOV      A,R7
B2:009534 71B9              ACALL    ?L?COM0033
B2:009536 80E7              SJMP     ?C0481?SERIALAPPL
B2:009538         ?C0482?SERIALAPPL:
 5610:     }
 5611:     /* Included Secure Supported Command Classes */
 5612:     applNodeInfo_included_secure_parmLength = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_SECURE_LEN_far);
B2:009538 7E14              MOV      R6,#HIGH EEOFFSET_CMDCLASS_INCLUDED_SECURE_LEN_far
B2:00953A 7F34              MOV      R7,#LOW EEOFFSET_CMDCLASS_INCLUDED_SECURE_LEN_far
B2:00953C 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00953F 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:009542 EF                MOV      A,R7
B2:009543 F0                MOVX     @DPTR,A
 5613:     if (applNodeInfo_included_secure_parmLength > APPL_NODEPARM_MAX)
B2:009544 D3                SETB     C
B2:009545 9423              SUBB     A,#023H
B2:009547 4003              JC       ?C0484?SERIALAPPL
 5614:     {
 5615:       applNodeInfo_included_secure_parmLength = APPL_NODEPARM_MAX;
B2:009549 7423              MOV      A,#023H
B2:00954B F0                MOVX     @DPTR,A
 5616:     }
B2:00954C         ?C0484?SERIALAPPL:
 5617:     for (i = 0; i < applNodeInfo_included_secure_parmLength; i++)
B2:00954C E4                CLR      A
B2:00954D 9024C6            MOV      DPTR,#i
B2:009550 F0                MOVX     @DPTR,A
B2:009551         ?C0485?SERIALAPPL:
B2:009551 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:009554 1298EB            LCALL    ?L?COM0080
B2:009557 5011              JNC      ?C0486?SERIALAPPL
 5618:     {
 5619:       applNodeInfo_included_secure_nodeParm[i] = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_SECURE_far + i
>> );
B2:009559 12AA4F            LCALL    ?L?COM048E
B2:00955C 129A61            LCALL    ?L?COM035D
B2:00955F E0                MOVX     A,@DPTR
B2:009560 24CE              ADD      A,#LOW applNodeInfo_included_secure_nodeParm
B2:009562 12A9D0            LCALL    ?L?COM03FF
B2:009565 EF                MOV      A,R7
B2:009566 71B9              ACALL    ?L?COM0033
B2:009568 80E7              SJMP     ?C0485?SERIALAPPL
B2:00956A         ?C0486?SERIALAPPL:
 5620:     }
 5621: #endif
 5622: #ifndef slave_routing
 5623:     for (i = 0; i < POWERLEVEL_CHANNELS; i++)
B2:00956A E4                CLR      A
B2:00956B 9024C6            MOV      DPTR,#i
B2:00956E F0                MOVX     @DPTR,A
B2:00956F         ?C0488?SERIALAPPL:
B2:00956F 12994B            LCALL    ?L?COM0162
B2:009572 9403              SUBB     A,#03H
B2:009574 501B              JNC      ?C0489?SERIALAPPL
 5624:     {
 5625:       sPowerlevels.normal[i] = CheckPowerlevel(ZW_MEM_GET_BYTE((WORD)&EEOFFSET_POWERLEVEL_NORMAL_far + i));
B2:009576 12AA45            LCALL    ?L?COM048D
B2:009579 12A44E            LCALL    ?L?COM0412
B2:00957C FE                MOV      R6,A
B2:00957D 12AA3B            LCALL    ?L?COM048C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 593


B2:009580 EF                MOV      A,R7
B2:009581 F0                MOVX     @DPTR,A
 5626:       sPowerlevels.low[i] = CheckPowerlevel(ZW_MEM_GET_BYTE((WORD)&EEOFFSET_POWERLEVEL_LOW_far + i));
B2:009582 EE                MOV      A,R6
B2:009583 12AA9A            LCALL    ?L?COM04F0
B2:009586 12A44E            LCALL    ?L?COM0412
B2:009589 12AA0D            LCALL    ?L?COM0450
B2:00958C EF                MOV      A,R7
B2:00958D 71B9              ACALL    ?L?COM0033
B2:00958F 80DE              SJMP     ?C0488?SERIALAPPL
B2:009591         ?C0489?SERIALAPPL:
 5627:     }
 5628: #ifdef ZW_SMARTSTART_ENABLED
 5629:     applPowerModeExtIntEnable = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_EXTINT_ENABLE_far);
B2:009591 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_EXTINT_ENABLE_far
B2:009593 7F5E              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_EXTINT_ENABLE_far
B2:009595 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009598 9027A2            MOV      DPTR,#applPowerModeExtIntEnable
B2:00959B EF                MOV      A,R7
B2:00959C F0                MOVX     @DPTR,A
 5630:     if (applPowerModeExtIntEnable == 0xFF)
B2:00959D BFFF02            CJNE     R7,#0FFH,?C0491?SERIALAPPL
 5631:     {
 5632:       applPowerModeExtIntEnable = 0;
B2:0095A0 E4                CLR      A
B2:0095A1 F0                MOVX     @DPTR,A
 5633:     }
B2:0095A2         ?C0491?SERIALAPPL:
 5634:     applPowerMode = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_far);
B2:0095A2 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_far
B2:0095A4 7F5F              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_far
B2:0095A6 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:0095A9 902440            MOV      DPTR,#applPowerMode
B2:0095AC EF                MOV      A,R7
B2:0095AD F0                MOVX     @DPTR,A
 5635:     if (applPowerMode == 0xFF)
B2:0095AE BFFF02            CJNE     R7,#0FFH,?C0492?SERIALAPPL
 5636:     {
 5637:       applPowerMode = 0;
B2:0095B1 E4                CLR      A
B2:0095B2 F0                MOVX     @DPTR,A
 5638:     }
B2:0095B3         ?C0492?SERIALAPPL:
 5639:     applPowerModeWutTimeOut = ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far) << 24;
B2:0095B3 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:0095B5 7F60              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:0095B7 12A8FD            LCALL    ?L?COM02F9
B2:0095BA 1298F7            LCALL    ?L?COM0188
 5640:     applPowerModeWutTimeOut += ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far + 1) << 16;
B2:0095BD 12A9A6            LCALL    ?L?COM03BE
B2:0095C0 C000              PUSH     AR0
B2:0095C2 C001              PUSH     AR1
B2:0095C4 C002              PUSH     AR2
B2:0095C6 C003              PUSH     AR3
B2:0095C8 7460              MOV      A,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:0095CA 2401              ADD      A,#01H
B2:0095CC 12A8F8            LCALL    ?L?COM02F8
B2:0095CF D003              POP      AR3
B2:0095D1 D002              POP      AR2
B2:0095D3 D001              POP      AR1
B2:0095D5 D000              POP      AR0
B2:0095D7 122234            LCALL    ?C?LADD
B2:0095DA 1298F7            LCALL    ?L?COM0188
 5641:     applPowerModeWutTimeOut += ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far + 2) << 8;
B2:0095DD 12A9A6            LCALL    ?L?COM03BE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 594


B2:0095E0 C000              PUSH     AR0
B2:0095E2 C001              PUSH     AR1
B2:0095E4 C002              PUSH     AR2
B2:0095E6 C003              PUSH     AR3
B2:0095E8 7460              MOV      A,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:0095EA 2402              ADD      A,#02H
B2:0095EC 12A8F8            LCALL    ?L?COM02F8
B2:0095EF D003              POP      AR3
B2:0095F1 D002              POP      AR2
B2:0095F3 D001              POP      AR1
B2:0095F5 D000              POP      AR0
B2:0095F7 122234            LCALL    ?C?LADD
B2:0095FA 1298F7            LCALL    ?L?COM0188
 5642:     applPowerModeWutTimeOut += ZW_MEM_GET_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far + 3);
B2:0095FD 12A9A6            LCALL    ?L?COM03BE
B2:009600 C000              PUSH     AR0
B2:009602 C001              PUSH     AR1
B2:009604 C002              PUSH     AR2
B2:009606 C003              PUSH     AR3
B2:009608 7460              MOV      A,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:00960A 2403              ADD      A,#03H
B2:00960C FF                MOV      R7,A
B2:00960D E4                CLR      A
B2:00960E 3414              ADDC     A,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:009610 FE                MOV      R6,A
B2:009611 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009614 E4                CLR      A
B2:009615 FC                MOV      R4,A
B2:009616 FD                MOV      R5,A
B2:009617 FE                MOV      R6,A
B2:009618 D003              POP      AR3
B2:00961A D002              POP      AR2
B2:00961C D001              POP      AR1
B2:00961E D000              POP      AR0
B2:009620 122234            LCALL    ?C?LADD
B2:009623 1298F7            LCALL    ?L?COM0188
 5643:     if ((0 == applPowerModeWutTimeOut) || (applPowerModeWutTimeOut = 0xFFFFFFFF))
B2:009626 E4                CLR      A
B2:009627 FF                MOV      R7,A
B2:009628 FE                MOV      R6,A
B2:009629 FD                MOV      R5,A
B2:00962A FC                MOV      R4,A
B2:00962B 12A9A6            LCALL    ?L?COM03BE
B2:00962E C3                CLR      C
B2:00962F 12239D            LCALL    ?C?ULCMP
B2:009632 6007              JZ       ?C0494?SERIALAPPL
B2:009634 74FF              MOV      A,#0FFH
B2:009636 FF                MOV      R7,A
B2:009637 FE                MOV      R6,A
B2:009638 1298F5            LCALL    ?L?COM0187
B2:00963B         ?C0494?SERIALAPPL:
 5644:     {
 5645:       applPowerModeWutTimeOut = 360;  /* For now 6 minutes */
B2:00963B E4                CLR      A
B2:00963C 7F68              MOV      R7,#068H
B2:00963E 7E01              MOV      R6,#01H
B2:009640 1298F5            LCALL    ?L?COM0187
 5646:     }
 5647:     ZW_Power_Management_Init(applPowerModeWutTimeOut, applPowerModeExtIntEnable);
B2:009643 1298FD            LCALL    ?L?COM035C
B2:009646 9027A2            MOV      DPTR,#applPowerModeExtIntEnable
B2:009649 E0                MOVX     A,@DPTR
B2:00964A 90451D            MOV      DPTR,#?_ZW_Power_Management_Init?BYTE+04H
B2:00964D F0                MOVX     @DPTR,A
B2:00964E 121C14            LCALL    ?INTERBANK_TABLE?_ZW_Power_Management_Init
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 595


 5648: 
 5649: #endif
 5650:     /* If powerlevel is set, then call protocol to change powerlevel */
 5651:     if (sPowerlevels.normal[0] != 0)
B2:009651 902157            MOV      DPTR,#sPowerlevels
B2:009654 E0                MOVX     A,@DPTR
B2:009655 FF                MOV      R7,A
B2:009656 601C              JZ       ?C0495?SERIALAPPL
 5652:     {
 5653:       ZW_SetDefaultPowerLevels( sPowerlevels.normal[0],
B2:009658 126EB8            LCALL    ?L?COM031B
B2:00965B A3                INC      DPTR
B2:00965C E0                MOVX     A,@DPTR
B2:00965D 900A65            MOV      DPTR,#?_ZW_SetDefaultPowerLevels?BYTE+03H
B2:009660 F0                MOVX     @DPTR,A
B2:009661 90215B            MOV      DPTR,#sPowerlevels+04H
B2:009664 E0                MOVX     A,@DPTR
B2:009665 900A66            MOV      DPTR,#?_ZW_SetDefaultPowerLevels?BYTE+04H
B2:009668 F0                MOVX     @DPTR,A
B2:009669 90215C            MOV      DPTR,#sPowerlevels+05H
B2:00966C E0                MOVX     A,@DPTR
B2:00966D 900A67            MOV      DPTR,#?_ZW_SetDefaultPowerLevels?BYTE+05H
B2:009670 F0                MOVX     @DPTR,A
B2:009671 125CE3            LCALL    _ZW_SetDefaultPowerLevels
 5654:                                 sPowerlevels.normal[1],
 5655:                                 sPowerlevels.normal[2],
 5656:                                 sPowerlevels.low[0],
 5657:                                 sPowerlevels.low[1],
 5658:                                 sPowerlevels.low[2]);
 5659:     }
B2:009674         ?C0495?SERIALAPPL:
 5660: #endif
 5661: 
 5662:     /* Check if host has started the watchdog, and if it has */
 5663:     /* then enable the watchdog again */
 5664:     if (bWatchdogStarted)
B2:009674 9027A3            MOV      DPTR,#bWatchdogStarted
B2:009677 E0                MOVX     A,@DPTR
B2:009678 6046              JZ       ?C0497?SERIALAPPL
 5665:     {
 5666:       ZW_WATCHDOG_ENABLE;
B2:00967A 12403E            LCALL    ZW_WatchDogEnable
 5667:     }
 5668: #endif
 5669:   }
B2:00967D 8041              SJMP     ?C0497?SERIALAPPL
B2:00967F         ?C0471?SERIALAPPL:
 5670:   else
 5671:   {
 5672:     /* Probably first time we start after a reset */
 5673:     applNodeInfo_parmLength = 1;
B2:00967F 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:009682 7401              MOV      A,#01H
B2:009684 F0                MOVX     @DPTR,A
 5674: #ifdef ZW_CONTROLLER
 5675:     /* Controllers are members of the COMMAND_CLASS_CONTROLLER_REPLICATION command class */
 5676:     applNodeInfo_nodeParm[0] = COMMAND_CLASS_CONTROLLER_REPLICATION;
 5677: #else
 5678:     /* Slaves are members of the COMMAND_CLASS_SWITCH_MULTILEVEL command class */
 5679:     applNodeInfo_nodeParm[0] = COMMAND_CLASS_SWITCH_MULTILEVEL;
B2:009685 9024A2            MOV      DPTR,#applNodeInfo_nodeParm
B2:009688 7426              MOV      A,#026H
B2:00968A F0                MOVX     @DPTR,A
 5680: #endif
 5681: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 596


 5682:     applNodeInfo_unincluded_parmLength = 0;
B2:00968B E4                CLR      A
B2:00968C 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:00968F F0                MOVX     @DPTR,A
 5683:     applNodeInfo_unincluded_nodeParm[0] = 0;
B2:009690 9027A5            MOV      DPTR,#applNodeInfo_unincluded_nodeParm
B2:009693 F0                MOVX     @DPTR,A
 5684:     applNodeInfo_included_unsecure_parmLength = 0;
B2:009694 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:009697 F0                MOVX     @DPTR,A
 5685:     applNodeInfo_included_unsecure_nodeParm[0] = 0;
B2:009698 90247F            MOV      DPTR,#applNodeInfo_included_unsecure_nodeParm
B2:00969B F0                MOVX     @DPTR,A
 5686:     applNodeInfo_included_secure_parmLength = 0;
B2:00969C 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:00969F F0                MOVX     @DPTR,A
 5687:     applNodeInfo_included_secure_nodeParm[0] = 0;
B2:0096A0 9027CE            MOV      DPTR,#applNodeInfo_included_secure_nodeParm
B2:0096A3 F0                MOVX     @DPTR,A
 5688: #endif
 5689: #ifndef slave_routing
 5690:     memset((BYTE*)&sPowerlevels, 0, sizeof(sPowerlevels));
B2:0096A4 7B01              MOV      R3,#01H
B2:0096A6 7A21              MOV      R2,#HIGH sPowerlevels
B2:0096A8 7957              MOV      R1,#LOW sPowerlevels
B2:0096AA 7D06              MOV      R5,#06H
B2:0096AC FF                MOV      R7,A
B2:0096AD 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
 5691: #endif
 5692: #ifdef ZW_SMARTSTART_ENABLED
 5693:     applPowerMode = E_SYSTEM_TYPE_LISTENING;
B2:0096B0 902440            MOV      DPTR,#applPowerMode
B2:0096B3 7401              MOV      A,#01H
B2:0096B5 F0                MOVX     @DPTR,A
 5694:     applPowerModeWutTimeOut = 720;
B2:0096B6 E4                CLR      A
B2:0096B7 7FD0              MOV      R7,#0D0H
B2:0096B9 7E02              MOV      R6,#02H
B2:0096BB 1298F5            LCALL    ?L?COM0187
 5695: #endif
 5696:     SaveApplicationSettings();
B2:0096BE F151              ACALL    SaveApplicationSettings
 5697:   }
B2:0096C0         ?C0497?SERIALAPPL:
 5698: 
 5699: #if SUPPORT_SERIAL_API_POWER_MANAGEMENT
 5700: #ifdef POWER_MANAGEMENT_TEST
 5701:   powerManagementWakeUpPinConf[0].bPin = 0x87;
 5702:   powerManagementWakeUpPinConf[1].bPin = 0xB7;
 5703:   powerManagementWakeUpPinConf[2].bPin = 0x90;
 5704:   powerManagementWakeUpPinConf[3].bPin = 0x92;
 5705:   powerManagementWakeUpPinConf[0].bEnableLevel = 0;
 5706:   powerManagementWakeUpPinConf[1].bEnableLevel = 1;
 5707:   powerManagementWakeUpPinConf[2].bEnableLevel = 1;
 5708:   powerManagementWakeUpPinConf[3].bEnableLevel = 1;
 5709: 
 5710:   powerManagementPowerMode[0].bPin = 0x87;
 5711:   powerManagementPowerMode[1].bPin = 0xB7;
 5712:   powerManagementPowerMode[2].bPin = 0x90;
 5713:   powerManagementPowerMode[3].bPin = 0x92;
 5714:   powerManagementPowerMode[0].bEnableLevel = 1;
 5715:   powerManagementPowerMode[1].bEnableLevel = 0;
 5716:   powerManagementPowerMode[2].bEnableLevel = 0;
 5717:   powerManagementPowerMode[3].bEnableLevel = 0;
 5718: 
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 597


 5719:   /* WakeUpOnExternal test - Button (P1.1 = INT1) */
 5720:   powerManagementWakeUpOnExternal.bPin = 0x91;
 5721:   powerManagementWakeUpOnExternal.bEnableLevel = 0;
 5722: 
 5723:   /* Use Button (P1.1 = INT1) as PoweredUp pin */
 5724:   powerManagementPoweredUp.bPin = 0x91;
 5725:   powerManagementPoweredUp.bEnableLevel = 0;
 5726:   ZW_PortPinIn(powerManagementPoweredUp.bPin);
 5727:   poweredUpTransition = 0;
 5728:   poweredUpTimerHandle = ZW_TIMER_START(ZCB_powerManagementPoweredUpPinActive, 1, TIMER_FOREVER);
 5729: 
 5730:   /* WakeUpOnRF test */
 5731:   powerManagementWakeUpOnRFMode = PM_WAKEUP_MASK;
 5732:   powerManagementWakeUpOnRFCount = 8;
 5733:   powerManagementWakeUpOnRF[0].bValue = 0x94;
 5734:   powerManagementWakeUpOnRF[1].bValue = 0x01;
 5735:   powerManagementWakeUpOnRF[2].bValue = 0x00;
 5736:   powerManagementWakeUpOnRF[3].bValue = 0x00;
 5737:   powerManagementWakeUpOnRF[4].bValue = 0x00;
 5738:   powerManagementWakeUpOnRF[5].bValue = 0x00;
 5739:   powerManagementWakeUpOnRF[6].bValue = 0x00;
 5740:   powerManagementWakeUpOnRF[7].bValue = 0x27;
 5741: 
 5742:   powerManagementWakeUpOnRF[0].bMask = 0xFF;
 5743:   powerManagementWakeUpOnRF[1].bMask = 0xFF;
 5744:   powerManagementWakeUpOnRF[2].bMask = 0x00;
 5745:   powerManagementWakeUpOnRF[3].bMask = 0x07;
 5746:   powerManagementWakeUpOnRF[4].bMask = 0x00;
 5747:   powerManagementWakeUpOnRF[5].bMask = 0x00;
 5748:   powerManagementWakeUpOnRF[6].bMask = 0xFF;
 5749:   powerManagementWakeUpOnRF[7].bMask = 0xFF;
 5750: 
 5751:   /* WakeUpOnTimer test */
 5752:   powerManagementWakeUpOnTimer = PM_TIMER_SECONDS;
 5753:   powerManagementWakeUpOnTimerCount = 600;
 5754: 
 5755:   powerManagementState = POWER_MODE_POWERDOWN_TRANSITION;
 5756: #endif
 5757: #endif
 5758: 
 5759: #ifdef JP_DK
 5760:   /* This code is only for testing JP frequency outside of Japan */
 5761:   ZW_SetListenBeforeTalkThreshold(0, JP_DK_RSSI_THRESHOLD);
 5762:   ZW_SetListenBeforeTalkThreshold(1, JP_DK_RSSI_THRESHOLD);
 5763:   ZW_SetListenBeforeTalkThreshold(2, JP_DK_RSSI_THRESHOLD);
 5764: #endif
 5765: 
 5766: /* Do we together with the bTxStatus BYTE also transmit a sTxStatusReport struct on ZW_SendData callback to HOST 
>> */
 5767: #if SUPPORT_SEND_DATA_TIMING
 5768:   bTxStatusReportEnabled = TRUE;
B2:0096C0 D20E              SETB     bTxStatusReportEnabled
 5769: #else
 5770:   bTxStatusReportEnabled = FALSE;
 5771: #endif
 5772: 
 5773: #if SUPPORT_SERIAL_API_STARTUP_NOTIFICATION
 5774:   /* ZW->HOST: bWakeupReason | bWatchdogStarted | deviceOptionMask | */
 5775:   /*           nodeType_generic | nodeType_specific | cmdClassLength | cmdClass[] */
 5776: 
 5777:   compl_workbuf[0] = applWakeupReason;
B2:0096C2 902152            MOV      DPTR,#applWakeupReason
B2:0096C5 E0                MOVX     A,@DPTR
B2:0096C6 902001            MOV      DPTR,#compl_workbuf
B2:0096C9 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 598


 5778: #if SUPPORT_ZW_WATCHDOG_START || SUPPORT_ZW_WATCHDOG_STOP
 5779:   compl_workbuf[1] = bWatchdogStarted;
B2:0096CA 9027A3            MOV      DPTR,#bWatchdogStarted
B2:0096CD 12AA31            LCALL    ?L?COM048B
B2:0096D0 902003            MOV      DPTR,#compl_workbuf+02H
B2:0096D3 F0                MOVX     @DPTR,A
 5780: #else
 5781:   compl_workbuf[1] = FALSE;
 5782: #endif
 5783:   compl_workbuf[2] = applNodeInfo_deviceOptionsMask;
 5784:   compl_workbuf[3] = applNodeInfo_nodeType_generic;
B2:0096D4 902165            MOV      DPTR,#applNodeInfo_nodeType_generic
B2:0096D7 E0                MOVX     A,@DPTR
B2:0096D8 902004            MOV      DPTR,#compl_workbuf+03H
B2:0096DB F0                MOVX     @DPTR,A
 5785:   compl_workbuf[4] = applNodeInfo_nodeType_specific;
B2:0096DC 902161            MOV      DPTR,#applNodeInfo_nodeType_specific
B2:0096DF E0                MOVX     A,@DPTR
B2:0096E0 902005            MOV      DPTR,#compl_workbuf+04H
B2:0096E3 F0                MOVX     @DPTR,A
 5786: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 5787:   if (0 < applNodeInfo_unincluded_parmLength)
B2:0096E4 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0096E7 E0                MOVX     A,@DPTR
B2:0096E8 FF                MOV      R7,A
B2:0096E9 E4                CLR      A
B2:0096EA C3                CLR      C
B2:0096EB 9F                SUBB     A,R7
B2:0096EC 501C              JNC      ?C0498?SERIALAPPL
 5788:   {
 5789:     compl_workbuf[5] = applNodeInfo_unincluded_parmLength;
B2:0096EE 902006            MOV      DPTR,#compl_workbuf+05H
B2:0096F1 EF                MOV      A,R7
B2:0096F2 129CC2            LCALL    ?L?COM01E3
B2:0096F5         ?C0499?SERIALAPPL:
B2:0096F5 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0096F8 1298EB            LCALL    ?L?COM0080
B2:0096FB 502C              JNC      ?C0502?SERIALAPPL
 5790:     for (i = 0; i < applNodeInfo_unincluded_parmLength; i++)
 5791:     {
 5792:       compl_workbuf[6 + i] = applNodeInfo_unincluded_nodeParm[i];
B2:0096FD 74A5              MOV      A,#LOW applNodeInfo_unincluded_nodeParm
B2:0096FF 2E                ADD      A,R6
B2:009700 12A88F            LCALL    ?L?COM025F
B2:009703 12A96A            LCALL    ?L?COM037C
B2:009706 71B9              ACALL    ?L?COM0033
B2:009708 80EB              SJMP     ?C0499?SERIALAPPL
 5793:     }
 5794:   }
B2:00970A         ?C0498?SERIALAPPL:
 5795:   else
 5796: #endif
 5797:   {
 5798:     compl_workbuf[5] = applNodeInfo_parmLength;
B2:00970A 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:00970D E0                MOVX     A,@DPTR
B2:00970E 902006            MOV      DPTR,#compl_workbuf+05H
B2:009711 129CC2            LCALL    ?L?COM01E3
B2:009714         ?C0503?SERIALAPPL:
B2:009714 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:009717 1298EB            LCALL    ?L?COM0080
B2:00971A 500D              JNC      ?C0502?SERIALAPPL
 5799:     for (i = 0; i < applNodeInfo_parmLength; i++)
 5800:     {
 5801:       compl_workbuf[6 + i] = applNodeInfo_nodeParm[i];
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 599


B2:00971C 74A2              MOV      A,#LOW applNodeInfo_nodeParm
B2:00971E 2E                ADD      A,R6
B2:00971F 12A8F0            LCALL    ?L?COM02C0
B2:009722 12A96A            LCALL    ?L?COM037C
B2:009725 71B9              ACALL    ?L?COM0033
B2:009727 80EB              SJMP     ?C0503?SERIALAPPL
 5802:     }
 5803:   }
B2:009729         ?C0502?SERIALAPPL:
 5804:   Request(FUNC_ID_SERIAL_API_STARTED, compl_workbuf, 6 + i);
B2:009729 7C20              MOV      R4,#HIGH compl_workbuf
B2:00972B 7D01              MOV      R5,#LOW compl_workbuf
B2:00972D 9024C6            MOV      DPTR,#i
B2:009730 E0                MOVX     A,@DPTR
B2:009731 2406              ADD      A,#06H
B2:009733 FB                MOV      R3,A
B2:009734 7F0A              MOV      R7,#0AH
B2:009736 129DAD            LCALL    _Request
 5805: 
 5806: #endif /* #if SUPPORT_STARTUP_NOTIFICATION */
 5807: 
 5808: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 5809:   m_AppNIF.cmdClassListNonSecureCount = applNodeInfo_unincluded_parmLength;
B2:009739 12A925            LCALL    ?L?COM032E
 5810:   m_AppNIF.cmdClassListNonSecureIncludedSecureCount = applNodeInfo_included_unsecure_parmLength;
 5811:   m_AppNIF.cmdClassListSecureCount = applNodeInfo_included_secure_parmLength;
B2:00973C 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:00973F E0                MOVX     A,@DPTR
B2:009740 90245B            MOV      DPTR,#m_AppNIF+0BH
B2:009743 12A792            LCALL    ?L?COM00FE
 5812:   m_AppNIF.deviceOptionsMask = applNodeInfo_deviceOptionsMask;
 5813:   m_AppNIF.nodeType.generic = applNodeInfo_nodeType_generic;
 5814:   m_AppNIF.nodeType.specific = applNodeInfo_nodeType_specific;
 5815:   /* Now we are ready for setting up the active nodeinformation */
 5816:   Transport_OnApplicationInitSW( &m_AppNIF);
 5817: #endif
 5818:   UNUSED(nvmStatus);
B2:009746 9046C2            MOV      DPTR,#nvmStatus
B2:009749 E0                MOVX     A,@DPTR
B2:00974A F0                MOVX     @DPTR,A
 5819: 
 5820:   ZW_DEBUG_SEND_BYTE('S');
 5821:   ZW_DEBUG_SEND_BYTE('E');
 5822:   ZW_DEBUG_SEND_BYTE('R');
 5823:   ZW_DEBUG_SEND_BYTE(' ');
 5824: #ifdef ZW_SMARTSTART_ENABLED
 5825:   return applPowerMode;
B2:00974B 902440            MOV      DPTR,#applPowerMode
B2:00974E E0                MOVX     A,@DPTR
B2:00974F FF                MOV      R7,A
 5826: #else
 5827:   return TRUE;
 5828: #endif
 5829: }
B2:009750 22                RET      
----- FUNCTION _ApplicationInitSW (END) -------


----- FUNCTION SaveApplicationSettings (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1945: SaveApplicationSettings(void)
 1946: {
 1947:   /* First make NV-mem app. data invalid */
 1948: //  ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_MAGIC_far, 0);
 1949: #ifdef ZW_SLAVE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 600


 1950:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_LISTENING_far, applNodeInfo_deviceOptionsMask);
B2:009751 7E13              MOV      R6,#HIGH EEOFFSET_LISTENING_far
B2:009753 7FC4              MOV      R7,#LOW EEOFFSET_LISTENING_far
B2:009755 902160            MOV      DPTR,#applNodeInfo_deviceOptionsMask
B2:009758 E0                MOVX     A,@DPTR
B2:009759 FD                MOV      R5,A
B2:00975A 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1951:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_GENERIC_far, applNodeInfo_nodeType_generic);
B2:00975D 7E13              MOV      R6,#HIGH EEOFFSET_GENERIC_far
B2:00975F 7FC5              MOV      R7,#LOW EEOFFSET_GENERIC_far
B2:009761 902165            MOV      DPTR,#applNodeInfo_nodeType_generic
B2:009764 E0                MOVX     A,@DPTR
B2:009765 FD                MOV      R5,A
B2:009766 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1952:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_SPECIFIC_far, applNodeInfo_nodeType_specific);
B2:009769 7E13              MOV      R6,#HIGH EEOFFSET_SPECIFIC_far
B2:00976B 7FC6              MOV      R7,#LOW EEOFFSET_SPECIFIC_far
B2:00976D 902161            MOV      DPTR,#applNodeInfo_nodeType_specific
B2:009770 E0                MOVX     A,@DPTR
B2:009771 FD                MOV      R5,A
B2:009772 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1953: #endif
 1954:   /*  - Buffer boundary check */
 1955:   if (applNodeInfo_parmLength > APPL_NODEPARM_MAX)
B2:009775 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:009778 E0                MOVX     A,@DPTR
B2:009779 D3                SETB     C
B2:00977A 9423              SUBB     A,#023H
B2:00977C 4003              JC       ?C0032?SERIALAPPL
 1956:   {
 1957:     applNodeInfo_parmLength = APPL_NODEPARM_MAX;
B2:00977E 7423              MOV      A,#023H
B2:009780 F0                MOVX     @DPTR,A
 1958:   }
B2:009781         ?C0032?SERIALAPPL:
 1959:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_LEN_far, applNodeInfo_parmLength);
B2:009781 7E13              MOV      R6,#HIGH EEOFFSET_CMDCLASS_LEN_far
B2:009783 7FC7              MOV      R7,#LOW EEOFFSET_CMDCLASS_LEN_far
B2:009785 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:009788 129BBF            LCALL    ?L?COM028D
B2:00978B         ?C0033?SERIALAPPL:
B2:00978B 90243F            MOV      DPTR,#applNodeInfo_parmLength
B2:00978E 1298EB            LCALL    ?L?COM0080
B2:009791 5010              JNC      ?C0034?SERIALAPPL
 1960:   for (i = 0; i < applNodeInfo_parmLength; i++)
 1961:   {
 1962:     ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_far + i, applNodeInfo_nodeParm[i]);
B2:009793 12AA6D            LCALL    ?L?COM0491
B2:009796 FE                MOV      R6,A
B2:009797 12A8ED            LCALL    ?L?COM02BF
B2:00979A E0                MOVX     A,@DPTR
B2:00979B FD                MOV      R5,A
B2:00979C 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1963:   }
B2:00979F 71BA              ACALL    ?L?COM0034
B2:0097A1 80E8              SJMP     ?C0033?SERIALAPPL
B2:0097A3         ?C0034?SERIALAPPL:
 1964: #if SUPPORT_ZW_WATCHDOG_START | SUPPORT_ZW_WATCHDOG_STOP
 1965:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_WATCHDOG_STARTED_far, bWatchdogStarted);
B2:0097A3 7E13              MOV      R6,#HIGH EEOFFSET_WATCHDOG_STARTED_far
B2:0097A5 7FEB              MOV      R7,#LOW EEOFFSET_WATCHDOG_STARTED_far
B2:0097A7 9027A3            MOV      DPTR,#bWatchdogStarted
B2:0097AA E0                MOVX     A,@DPTR
B2:0097AB FD                MOV      R5,A
B2:0097AC 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 601


 1966: #else
 1967:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_WATCHDOG_STARTED_far, FALSE);
 1968: #endif
 1969: #if SUPPORT_SERIAL_API_APPL_NODE_INFORMATION_CMD_CLASSES
 1970:   /* Unincluded Supported Command Classes */
 1971:   if (applNodeInfo_unincluded_parmLength > APPL_NODEPARM_MAX)
B2:0097AF 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0097B2 E0                MOVX     A,@DPTR
B2:0097B3 D3                SETB     C
B2:0097B4 9423              SUBB     A,#023H
B2:0097B6 4003              JC       ?C0036?SERIALAPPL
 1972:   {
 1973:     applNodeInfo_unincluded_parmLength = APPL_NODEPARM_MAX;
B2:0097B8 7423              MOV      A,#023H
B2:0097BA F0                MOVX     @DPTR,A
 1974:   }
B2:0097BB         ?C0036?SERIALAPPL:
 1975:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_UNINCLUDED_LEN_far, applNodeInfo_unincluded_parmLength);
B2:0097BB 7E13              MOV      R6,#HIGH EEOFFSET_CMDCLASS_UNINCLUDED_LEN_far
B2:0097BD 7FEC              MOV      R7,#LOW EEOFFSET_CMDCLASS_UNINCLUDED_LEN_far
B2:0097BF 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0097C2 129BBF            LCALL    ?L?COM028D
B2:0097C5         ?C0037?SERIALAPPL:
B2:0097C5 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:0097C8 1298EB            LCALL    ?L?COM0080
B2:0097CB 5010              JNC      ?C0038?SERIALAPPL
 1976:   for (i = 0; i < applNodeInfo_unincluded_parmLength; i++)
 1977:   {
 1978:     ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_UNINCLUDED_far + i, applNodeInfo_unincluded_nodeParm[i]);
B2:0097CD 12AA63            LCALL    ?L?COM0490
B2:0097D0 FE                MOV      R6,A
B2:0097D1 12A88C            LCALL    ?L?COM025E
B2:0097D4 E0                MOVX     A,@DPTR
B2:0097D5 FD                MOV      R5,A
B2:0097D6 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1979:   }
B2:0097D9 71BA              ACALL    ?L?COM0034
B2:0097DB 80E8              SJMP     ?C0037?SERIALAPPL
B2:0097DD         ?C0038?SERIALAPPL:
 1980:   /* Included unsecure Supported Command Classes */
 1981:   if (applNodeInfo_included_unsecure_parmLength > APPL_NODEPARM_MAX)
B2:0097DD 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:0097E0 E0                MOVX     A,@DPTR
B2:0097E1 D3                SETB     C
B2:0097E2 9423              SUBB     A,#023H
B2:0097E4 4003              JC       ?C0040?SERIALAPPL
 1982:   {
 1983:     applNodeInfo_included_unsecure_parmLength = APPL_NODEPARM_MAX;
B2:0097E6 7423              MOV      A,#023H
B2:0097E8 F0                MOVX     @DPTR,A
 1984:   }
B2:0097E9         ?C0040?SERIALAPPL:
 1985:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_LEN_far, applNodeInfo_included_unsecure_parmLength);
>> 
B2:0097E9 7E14              MOV      R6,#HIGH EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_LEN_far
B2:0097EB 7F10              MOV      R7,#LOW EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_LEN_far
B2:0097ED 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:0097F0 129BBF            LCALL    ?L?COM028D
B2:0097F3         ?C0041?SERIALAPPL:
B2:0097F3 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:0097F6 1298EB            LCALL    ?L?COM0080
B2:0097F9 5014              JNC      ?C0042?SERIALAPPL
 1986:   for (i = 0; i < applNodeInfo_included_unsecure_parmLength; i++)
 1987:   {
 1988:     ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_far + i, applNodeInfo_included_unsecure_nodeParm[i
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 602


>> ]);
B2:0097FB 12AA59            LCALL    ?L?COM048F
B2:0097FE FE                MOV      R6,A
B2:0097FF E0                MOVX     A,@DPTR
B2:009800 247F              ADD      A,#LOW applNodeInfo_included_unsecure_nodeParm
B2:009802 12A959            LCALL    ?L?COM0360
B2:009805 E0                MOVX     A,@DPTR
B2:009806 FD                MOV      R5,A
B2:009807 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1989:   }
B2:00980A 1293BA            LCALL    ?L?COM0034
B2:00980D 80E4              SJMP     ?C0041?SERIALAPPL
B2:00980F         ?C0042?SERIALAPPL:
 1990:   /* Included secure Supported Command Classes */
 1991:   if (applNodeInfo_included_secure_parmLength > APPL_NODEPARM_MAX)
B2:00980F 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:009812 E0                MOVX     A,@DPTR
B2:009813 D3                SETB     C
B2:009814 9423              SUBB     A,#023H
B2:009816 4003              JC       ?C0044?SERIALAPPL
 1992:   {
 1993:     applNodeInfo_included_secure_parmLength = APPL_NODEPARM_MAX;
B2:009818 7423              MOV      A,#023H
B2:00981A F0                MOVX     @DPTR,A
 1994:   }
B2:00981B         ?C0044?SERIALAPPL:
 1995:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_SECURE_LEN_far, applNodeInfo_included_secure_parmLength);
B2:00981B 7E14              MOV      R6,#HIGH EEOFFSET_CMDCLASS_INCLUDED_SECURE_LEN_far
B2:00981D 7F34              MOV      R7,#LOW EEOFFSET_CMDCLASS_INCLUDED_SECURE_LEN_far
B2:00981F 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:009822 71BF              ACALL    ?L?COM028D
B2:009824         ?C0045?SERIALAPPL:
B2:009824 90246B            MOV      DPTR,#applNodeInfo_included_secure_parmLength
B2:009827 11EB              ACALL    ?L?COM0080
B2:009829 5014              JNC      ?C0046?SERIALAPPL
 1996:   for (i = 0; i < applNodeInfo_included_secure_parmLength; i++)
 1997:   {
 1998:     ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_CMDCLASS_INCLUDED_SECURE_far + i, applNodeInfo_included_secure_nodeParm[i]);
B2:00982B 12AA4F            LCALL    ?L?COM048E
B2:00982E FE                MOV      R6,A
B2:00982F E0                MOVX     A,@DPTR
B2:009830 24CE              ADD      A,#LOW applNodeInfo_included_secure_nodeParm
B2:009832 12A9D0            LCALL    ?L?COM03FF
B2:009835 E0                MOVX     A,@DPTR
B2:009836 FD                MOV      R5,A
B2:009837 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 1999:   }
B2:00983A 1293BA            LCALL    ?L?COM0034
B2:00983D 80E5              SJMP     ?C0045?SERIALAPPL
B2:00983F         ?C0046?SERIALAPPL:
 2000: #endif
 2001: #ifndef slave_routing
 2002:   /* Save powerlevel settings (if any has been set) */
 2003:   for (i = 0; i < POWERLEVEL_CHANNELS; i++)
B2:00983F E4                CLR      A
B2:009840 9024C6            MOV      DPTR,#i
B2:009843 F0                MOVX     @DPTR,A
B2:009844         ?C0048?SERIALAPPL:
B2:009844 314B              ACALL    ?L?COM0162
B2:009846 9403              SUBB     A,#03H
B2:009848 5023              JNC      ?C0049?SERIALAPPL
 2004:   {
 2005:     ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_POWERLEVEL_NORMAL_far + i, sPowerlevels.normal[i]);
B2:00984A 12AA45            LCALL    ?L?COM048D
B2:00984D FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 603


B2:00984E E0                MOVX     A,@DPTR
B2:00984F 12AA3B            LCALL    ?L?COM048C
B2:009852 E0                MOVX     A,@DPTR
B2:009853 FD                MOV      R5,A
B2:009854 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2006:     ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_POWERLEVEL_LOW_far + i, sPowerlevels.low[i]);
B2:009857 9024C6            MOV      DPTR,#i
B2:00985A E0                MOVX     A,@DPTR
B2:00985B 12AA9A            LCALL    ?L?COM04F0
B2:00985E FE                MOV      R6,A
B2:00985F E0                MOVX     A,@DPTR
B2:009860 12AA0D            LCALL    ?L?COM0450
B2:009863 E0                MOVX     A,@DPTR
B2:009864 FD                MOV      R5,A
B2:009865 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2007:   }
B2:009868 1293BA            LCALL    ?L?COM0034
B2:00986B 80D7              SJMP     ?C0048?SERIALAPPL
B2:00986D         ?C0049?SERIALAPPL:
 2008: #endif
 2009: #ifdef ZW_SMARTSTART_ENABLED
 2010:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_EXTINT_ENABLE_far, applPowerModeExtIntEnable);
B2:00986D 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_EXTINT_ENABLE_far
B2:00986F 7F5E              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_EXTINT_ENABLE_far
B2:009871 9027A2            MOV      DPTR,#applPowerModeExtIntEnable
B2:009874 E0                MOVX     A,@DPTR
B2:009875 FD                MOV      R5,A
B2:009876 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2011:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_far, applPowerMode);
B2:009879 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_far
B2:00987B 7F5F              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_far
B2:00987D 902440            MOV      DPTR,#applPowerMode
B2:009880 E0                MOVX     A,@DPTR
B2:009881 FD                MOV      R5,A
B2:009882 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2012: 
 2013:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far, (BYTE)((applPowerModeWutTimeOut & 0xFF000000
>> ) >> 24));
B2:009885 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:009887 7F60              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:009889 C006              PUSH     AR6
B2:00988B C007              PUSH     AR7
B2:00988D 11FD              ACALL    ?L?COM035C
B2:00988F E4                CLR      A
B2:009890 FF                MOV      R7,A
B2:009891 FE                MOV      R6,A
B2:009892 FD                MOV      R5,A
B2:009893 EC                MOV      A,R4
B2:009894 7818              MOV      R0,#018H
B2:009896 1223AE            LCALL    ?C?ULSHR
B2:009899 AD07              MOV      R5,AR7
B2:00989B D007              POP      AR7
B2:00989D D006              POP      AR6
B2:00989F 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2014:   ZW_MEM_PUT_BYTE((WORD)(&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far + 1), (BYTE)((applPowerModeWutTimeOut & 0xFF
>> 0000) >> 16));
B2:0098A2 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far+01H
B2:0098A4 7F61              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far+01H
B2:0098A6 C006              PUSH     AR6
B2:0098A8 C007              PUSH     AR7
B2:0098AA 11FD              ACALL    ?L?COM035C
B2:0098AC 126FAE            LCALL    ?L?COM043F
B2:0098AF AD07              MOV      R5,AR7
B2:0098B1 D007              POP      AR7
B2:0098B3 D006              POP      AR6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 604


B2:0098B5 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2015:   ZW_MEM_PUT_BYTE((WORD)(&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far + 2), (BYTE)((applPowerModeWutTimeOut & 0xFF
>> 00) >> 8));
B2:0098B8 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far+02H
B2:0098BA 7F62              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far+02H
B2:0098BC C006              PUSH     AR6
B2:0098BE C007              PUSH     AR7
B2:0098C0 11FD              ACALL    ?L?COM035C
B2:0098C2 126FA4            LCALL    ?L?COM043E
B2:0098C5 AD07              MOV      R5,AR7
B2:0098C7 D007              POP      AR7
B2:0098C9 D006              POP      AR6
B2:0098CB 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2016:   ZW_MEM_PUT_BYTE((WORD)(&EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far + 3), (BYTE)(applPowerModeWutTimeOut & 0xFF)
>> );
B2:0098CE 7E14              MOV      R6,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far+03H
B2:0098D0 7F63              MOV      R7,#LOW EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far+03H
B2:0098D2 C006              PUSH     AR6
B2:0098D4 C007              PUSH     AR7
B2:0098D6 11FD              ACALL    ?L?COM035C
B2:0098D8 E4                CLR      A
B2:0098D9 AD07              MOV      R5,AR7
B2:0098DB D007              POP      AR7
B2:0098DD D006              POP      AR6
B2:0098DF 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
 2017: #endif
 2018:   /* Now app. data is valid! */
 2019:   ZW_MEM_PUT_BYTE((WORD)&EEOFFSET_MAGIC_far, MAGIC_VALUE);
B2:0098E2 7E13              MOV      R6,#HIGH EEOFFSET_MAGIC_far
B2:0098E4 7FC3              MOV      R7,#LOW EEOFFSET_MAGIC_far
B2:0098E6 7D42              MOV      R5,#042H
B2:0098E8 021B92            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION SaveApplicationSettings (END) -------


----- FUNCTION ?L?COM0080 (BEGIN) -----
B2:0098EB E0                MOVX     A,@DPTR
B2:0098EC         ?L?COM0081:
B2:0098EC FF                MOV      R7,A
B2:0098ED 9024C6            MOV      DPTR,#i
B2:0098F0 E0                MOVX     A,@DPTR
B2:0098F1 FE                MOV      R6,A
B2:0098F2 C3                CLR      C
B2:0098F3 9F                SUBB     A,R7
B2:0098F4 22                RET      
----- FUNCTION ?L?COM0080 (END) -------


----- FUNCTION ?L?COM0187 (BEGIN) -----
B2:0098F5 FD                MOV      R5,A
B2:0098F6 FC                MOV      R4,A
B2:0098F7         ?L?COM0188:
B2:0098F7 902466            MOV      DPTR,#applPowerModeWutTimeOut
B2:0098FA 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM0187 (END) -------


----- FUNCTION ?L?COM035C (BEGIN) -----
B2:0098FD 902466            MOV      DPTR,#applPowerModeWutTimeOut
B2:009900 022462            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM035C (END) -------


----- FUNCTION _ApplicationSecureCommandsSupported (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 605


  332: ApplicationSecureCommandsSupported(
B2:009903 904294            MOV      DPTR,#eKey
B2:009906 126E8B            LCALL    ?L?COM02DB
  333:     enum SECURITY_KEY eKey, /* IN Security Scheme to report on */
  334:     BYTE **pCmdClasses,   /* OUT Cmd classes supported by endpoint */
  335:     BYTE *pLength)        /* OUT Length of pCmdClasses, 0 if endpoint does not exist */
  336: {
  337:   CMD_CLASS_LIST *pCmdClassList  = NULL;
B2:009909 1247C7            LCALL    ?L?COM0359
B2:00990C 90429B            MOV      DPTR,#pCmdClassList
B2:00990F 71CA              ACALL    ?L?COM0487
B2:009911 EF                MOV      A,R7
B2:009912 C3                CLR      C
B2:009913 6001              JZ       ?C0032?ZW_TRANSPORTSECPROTOCOL
B2:009915 D3                SETB     C
B2:009916         ?C0032?ZW_TRANSPORTSECPROTOCOL:
B2:009916         ?C0033?ZW_TRANSPORTSECPROTOCOL:
B2:009916 923D              MOV      ?GetCommandClassList?BIT,C
B2:009918 904294            MOV      DPTR,#eKey
B2:00991B E0                MOVX     A,@DPTR
B2:00991C 90466C            MOV      DPTR,#?GetCommandClassList?BYTE
B2:00991F F0                MOVX     @DPTR,A
B2:009920 E4                CLR      A
B2:009921 A3                INC      DPTR
B2:009922 F0                MOVX     @DPTR,A
B2:009923 5171              ACALL    GetCommandClassList
B2:009925 90429B            MOV      DPTR,#pCmdClassList
B2:009928 126ECE            LCALL    ?L?COM035B
B2:00992B C003              PUSH     AR3
B2:00992D C002              PUSH     AR2
B2:00992F C001              PUSH     AR1
B2:009931 904295            MOV      DPTR,#pCmdClasses
B2:009934 122552            LCALL    ?C?PLDXDATA
B2:009937 1225A7            LCALL    ?C?PSTPTR
  338:   pCmdClassList = GetCommandClassList((0 != GetNodeId()), eKey, 0);
  339:   *pCmdClasses = pCmdClassList->pList;
  340:   *pLength = pCmdClassList->size;
B2:00993A 90429B            MOV      DPTR,#pCmdClassList
B2:00993D 91B7              ACALL    ?L?COM0437
B2:00993F 904298            MOV      DPTR,#pLength
B2:009942 122552            LCALL    ?C?PLDXDATA
B2:009945 EF                MOV      A,R7
B2:009946 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ApplicationSecureCommandsSupported (END) -------


----- FUNCTION ?L?COM0161 (BEGIN) -----
B2:009949 E0                MOVX     A,@DPTR
B2:00994A FD                MOV      R5,A
B2:00994B         ?L?COM0162:
B2:00994B 9024C6            MOV      DPTR,#i
B2:00994E E0                MOVX     A,@DPTR
B2:00994F FF                MOV      R7,A
B2:009950 C3                CLR      C
B2:009951 22                RET      
----- FUNCTION ?L?COM0161 (END) -------


----- FUNCTION _Transport_ApplicationCommandHandler (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5889: Transport_ApplicationCommandHandler(
 5890:   ZW_APPLICATION_TX_BUFFER *pCmd, /* IN Payload from the received frame, */
B2:009952 904457            MOV      DPTR,#pCmd
B2:009955 122572            LCALL    ?C?PSTXDATA
;---- Variable 'cmdLength' assigned to Register 'R5' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 606


 5891:                                   /*    the command is the very first byte */
 5892:   BYTE cmdLength,                 /* IN Number of command bytes including the command */
 5893:   RECEIVE_OPTIONS_TYPE *rxOpt)    /* rxOpt struct to use (may be partially filled out if
 5894:                                      parsing encapsulated command */
 5895: #else
 5896: /*==========================   ApplicationCommandHandler   ==================
 5897: **    Handling of received application commands and requests
 5898: **
 5899: **--------------------------------------------------------------------------*/
 5900: void                              /*RET Nothing                  */
 5901: ApplicationCommandHandler(
 5902:   ZW_APPLICATION_TX_BUFFER *pCmd, /* IN Payload from the received frame, */
 5903:                                   /*    the command is the very first byte */
 5904:   BYTE cmdLength,                 /* IN Number of command bytes including the command */
 5905:   RECEIVE_OPTIONS_TYPE *rxOpt)    /* rxOpt struct to use (may be partially filled out if
 5906:                                      parsing encapsulated command */
 5907: #endif
 5908: {
 5909: #if SUPPORT_SERIAL_API_POWER_MANAGEMENT
 5910:   if ((POWER_MODE_POWERDOWN == powerManagementState)
B2:009958 902173            MOV      DPTR,#powerManagementState
B2:00995B E0                MOVX     A,@DPTR
B2:00995C 6404              XRL      A,#04H
B2:00995E 707A              JNZ      ?C0511?SERIALAPPL
B2:009960 200D77            JB       wakeUpOnRF,?C0511?SERIALAPPL
B2:009963 9024C5            MOV      DPTR,#powerManagementWakeUpOnRFMode
B2:009966 E0                MOVX     A,@DPTR
B2:009967 FF                MOV      R7,A
B2:009968 6070              JZ       ?C0511?SERIALAPPL
 5911:       && (!wakeUpOnRF && (PM_WAKEUP_UNDEFINED != powerManagementWakeUpOnRFMode)))
 5912:   {
 5913:     if ((PM_WAKEUP_ALL == powerManagementWakeUpOnRFMode)
B2:00996A 6401              XRL      A,#01H
B2:00996C 600D              JZ       ?C0513?SERIALAPPL
B2:00996E EF                MOV      A,R7
B2:00996F 6402              XRL      A,#02H
B2:009971 701C              JNZ      ?C0512?SERIALAPPL
B2:009973 5148              ACALL    ?L?COM0394
B2:009975 121F7C            LCALL    ?C?CLDPTR
B2:009978 20E214            JB       ACC.2,?C0512?SERIALAPPL
B2:00997B         ?C0513?SERIALAPPL:
 5914:         || ((PM_WAKEUP_ALL_NO_BROADCAST == powerManagementWakeUpOnRFMode) && !(rxOpt->rxStatus & RECEIVE_STATUS_T
>> YPE_BROAD)))
 5915:     {
 5916:       /* Wakeup HOST */
 5917:       wakeUpOnRF = TRUE;
B2:00997B D20D              SETB     wakeUpOnRF
 5918:       powerManagementWakeUpReason = (PM_WAKEUP_ALL == powerManagementWakeUpOnRFMode)
B2:00997D 9024C5            MOV      DPTR,#powerManagementWakeUpOnRFMode
B2:009980 E0                MOVX     A,@DPTR
B2:009981 7F03              MOV      R7,#03H
B2:009983 B40102            CJNE     A,#01H,?C0514?SERIALAPPL
B2:009986 7F02              MOV      R7,#02H
B2:009988         ?C0514?SERIALAPPL:
B2:009988         ?C0515?SERIALAPPL:
B2:009988 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:00998B EF                MOV      A,R7
B2:00998C F0                MOVX     @DPTR,A
 5919:                                     ? PM_WAKEUP_REASON_RF_ALL
 5920:                                     : PM_WAKEUP_REASON_RF_ALL_NO_BROADCAST;
 5921:     }
B2:00998D 804B              SJMP     ?C0511?SERIALAPPL
B2:00998F         ?C0512?SERIALAPPL:
 5922:     else if ((PM_WAKEUP_MASK == powerManagementWakeUpOnRFMode)
B2:00998F 9024C5            MOV      DPTR,#powerManagementWakeUpOnRFMode
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 607


B2:009992 E0                MOVX     A,@DPTR
B2:009993 6403              XRL      A,#03H
B2:009995 7043              JNZ      ?C0511?SERIALAPPL
B2:009997 9024C9            MOV      DPTR,#powerManagementWakeUpOnRFCount
B2:00999A E0                MOVX     A,@DPTR
B2:00999B FF                MOV      R7,A
B2:00999C ED                MOV      A,R5
B2:00999D C3                CLR      C
B2:00999E 9F                SUBB     A,R7
B2:00999F 4039              JC       ?C0511?SERIALAPPL
 5923:              && (cmdLength >= powerManagementWakeUpOnRFCount))
 5924:     {
 5925:       /* Assume Match */
 5926:       wakeUpOnRF = TRUE;
B2:0099A1 D20D              SETB     wakeUpOnRF
 5927:       for (i = 0; i < powerManagementWakeUpOnRFCount; i++)
B2:0099A3 E4                CLR      A
B2:0099A4 9024C6            MOV      DPTR,#i
B2:0099A7 F0                MOVX     @DPTR,A
B2:0099A8         ?C0518?SERIALAPPL:
B2:0099A8 9024C9            MOV      DPTR,#powerManagementWakeUpOnRFCount
B2:0099AB 11EB              ACALL    ?L?COM0080
B2:0099AD 5022              JNC      ?C0519?SERIALAPPL
 5928:       {
 5929:         if ((powerManagementWakeUpOnRF[i].bMask & ((BYTE*)pCmd)[i]) != powerManagementWakeUpOnRF[i].bValue)
B2:0099AF 5169              ACALL    ?L?COM0549
B2:0099B1 2E                ADD      A,R6
B2:0099B2 1252DD            LCALL    ?L?COM0009
B2:0099B5 FF                MOV      R7,A
B2:0099B6 EE                MOV      A,R6
B2:0099B7 12A80F            LCALL    ?L?COM017C
B2:0099BA E0                MOVX     A,@DPTR
B2:0099BB 5F                ANL      A,R7
B2:0099BC FF                MOV      R7,A
B2:0099BD 9024C6            MOV      DPTR,#i
B2:0099C0 E0                MOVX     A,@DPTR
B2:0099C1 12A9D8            LCALL    ?L?COM040B
B2:0099C4 E0                MOVX     A,@DPTR
B2:0099C5 6F                XRL      A,R7
B2:0099C6 6004              JZ       ?C0520?SERIALAPPL
 5930:         {
 5931:           /* No Match */
 5932:           wakeUpOnRF = FALSE;
B2:0099C8 C20D              CLR      wakeUpOnRF
 5933:           break;
B2:0099CA 8005              SJMP     ?C0519?SERIALAPPL
 5934:         }
 5935:       }
B2:0099CC         ?C0520?SERIALAPPL:
B2:0099CC 1293BA            LCALL    ?L?COM0034
B2:0099CF 80D7              SJMP     ?C0518?SERIALAPPL
B2:0099D1         ?C0519?SERIALAPPL:
 5936:       if (wakeUpOnRF)
B2:0099D1 300D06            JNB      wakeUpOnRF,?C0511?SERIALAPPL
 5937:       {
 5938:         powerManagementWakeUpReason = PM_WAKEUP_REASON_RF_MASK;
B2:0099D4 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:0099D7 7404              MOV      A,#04H
B2:0099D9 F0                MOVX     @DPTR,A
 5939:       }
 5940:     }
 5941:   }
B2:0099DA         ?C0511?SERIALAPPL:
 5942: #endif
 5943:   n = 0;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 608


B2:0099DA E4                CLR      A
B2:0099DB 902775            MOV      DPTR,#n
B2:0099DE 5147              ACALL    ?L?COM0393
B2:0099E0 121F7C            LCALL    ?C?CLDPTR
B2:0099E3 514E              ACALL    ?L?COM0050
B2:0099E5 EF                MOV      A,R7
B2:0099E6 F0                MOVX     @DPTR,A
 5944:   BYTE_IN_AR(compl_workbuf, n++) = rxOpt->rxStatus;
 5945:   BYTE_IN_AR(compl_workbuf, n++) = rxOpt->sourceNode;
B2:0099E7 E9                MOV      A,R1
B2:0099E8 2401              ADD      A,#01H
B2:0099EA 1252DD            LCALL    ?L?COM0009
B2:0099ED FE                MOV      R6,A
B2:0099EE 902775            MOV      DPTR,#n
B2:0099F1 E0                MOVX     A,@DPTR
B2:0099F2 FC                MOV      R4,A
B2:0099F3 04                INC      A
B2:0099F4 F0                MOVX     @DPTR,A
B2:0099F5 7401              MOV      A,#LOW compl_workbuf
B2:0099F7 2C                ADD      A,R4
B2:0099F8 5159              ACALL    ?L?COM0052
B2:0099FA EE                MOV      A,R6
B2:0099FB F0                MOVX     @DPTR,A
 5946:   if (0 != (rxOpt->rxStatus & RECEIVE_STATUS_FOREIGN_FRAME))
B2:0099FC EF                MOV      A,R7
B2:0099FD 20E646            JB       ACC.6,?C0529?SERIALAPPL
 5947:   {
 5948: #if SUPPORT_PROMISCUOUS_APPLICATION_COMMAND_HANDLER
 5949:     /* Syntax when a promiscuous frame is received (i.e. RECEIVE_STATUS_FOREIGN_FRAME is set): */
 5950:     /* ZW->PC: REQ | 0xD1 | rxStatus | sourceNode | cmdLength | pCmd[] | destNode | multiNodeMaskLen [| multiNode
>> Mask[multiNodeMaskLen]] | rssiVal */
 5951:     /* For libraries supporting promiscuous mode... */
 5952:     if (cmdLength > BUF_SIZE_TX - 6 - (0 != (rxOpt->rxStatus & RECEIVE_STATUS_TYPE_MULTI)) ? MAX_NODEMASK_LENGTH 
>> : 0)
 5953:     {
 5954:       cmdLength = BUF_SIZE_TX - 6 - (0 != (rxOpt->rxStatus & RECEIVE_STATUS_TYPE_MULTI)) ? MAX_NODEMASK_LENGTH : 
>> 0;
 5955:     }
 5956:     BYTE_IN_AR(compl_workbuf, n++) = cmdLength;
 5957:     for (i = 0; i < cmdLength; i++)
 5958:     {
 5959:       BYTE_IN_AR(compl_workbuf, n++) = *((BYTE_P)pCmd + i);
 5960:     }
 5961:     BYTE_IN_AR(compl_workbuf, n++) = rxOpt->destNode;
 5962:     {
 5963:       /* For now we always have ZERO byte in multicast nodemask even if it is a Multicast frame */
 5964:       /* No Bytes in Multicast nodemask */
 5965:       BYTE_IN_AR(compl_workbuf, n++) = 0;
 5966:     }
 5967:     BYTE_IN_AR(compl_workbuf, n++) = rxOpt->rxRSSIVal;
 5968:     RequestUnsolicited(FUNC_ID_PROMISCUOUS_APPLICATION_COMMAND_HANDLER, compl_workbuf, n);
 5969: #endif
 5970:   }
B2:009A00         ?C0523?SERIALAPPL:
 5971:   else
 5972:   {
 5973:     /* ZW->PC: REQ | 0x04 | rxStatus | sourceNode | cmdLength | pCmd[] | rssiVal | securityKey */
 5974:     if (cmdLength > BUF_SIZE_TX - 5)
B2:009A00 ED                MOV      A,R5
B2:009A01 D3                SETB     C
B2:009A02 94A3              SUBB     A,#0A3H
B2:009A04 4002              JC       ?C0525?SERIALAPPL
 5975:     {
 5976:       cmdLength = BUF_SIZE_TX - 5;
B2:009A06 7DA3              MOV      R5,#0A3H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 609


 5977:     }
B2:009A08         ?C0525?SERIALAPPL:
 5978:     BYTE_IN_AR(compl_workbuf, n++) = cmdLength;
B2:009A08 902775            MOV      DPTR,#n
B2:009A0B 12A9E4            LCALL    ?L?COM0411
B2:009A0E 5159              ACALL    ?L?COM0052
B2:009A10 ED                MOV      A,R5
B2:009A11 91C2              ACALL    ?L?COM01E3
B2:009A13         ?C0526?SERIALAPPL:
B2:009A13 314B              ACALL    ?L?COM0162
B2:009A15 9D                SUBB     A,R5
B2:009A16 500E              JNC      ?C0527?SERIALAPPL
 5979:     for (i = 0; i < cmdLength; i++)
 5980:     {
 5981:       BYTE_IN_AR(compl_workbuf, n++) = *((BYTE_P)pCmd + i);
B2:009A18 5169              ACALL    ?L?COM0549
B2:009A1A 2F                ADD      A,R7
B2:009A1B 1252DD            LCALL    ?L?COM0009
B2:009A1E 514E              ACALL    ?L?COM0050
B2:009A20 EF                MOV      A,R7
B2:009A21 1293B9            LCALL    ?L?COM0033
B2:009A24 80ED              SJMP     ?C0526?SERIALAPPL
B2:009A26         ?C0527?SERIALAPPL:
 5982:     }
 5983:     BYTE_IN_AR(compl_workbuf, n++) = rxOpt->rxRSSIVal;
B2:009A26 5148              ACALL    ?L?COM0394
B2:009A28 E9                MOV      A,R1
B2:009A29 2403              ADD      A,#03H
B2:009A2B 1252DD            LCALL    ?L?COM0009
B2:009A2E 514E              ACALL    ?L?COM0050
B2:009A30 EF                MOV      A,R7
B2:009A31 5147              ACALL    ?L?COM0393
B2:009A33 E9                MOV      A,R1
B2:009A34 2404              ADD      A,#04H
B2:009A36 1252DD            LCALL    ?L?COM0009
B2:009A39 514E              ACALL    ?L?COM0050
B2:009A3B EF                MOV      A,R7
B2:009A3C F0                MOVX     @DPTR,A
 5984:     BYTE_IN_AR(compl_workbuf, n++) = rxOpt->securityKey;
 5985:     RequestUnsolicited(FUNC_ID_APPLICATION_COMMAND_HANDLER, compl_workbuf, n);
B2:009A3D 902775            MOV      DPTR,#n
B2:009A40 F1CF              ACALL    ?L?COM03CB
B2:009A42 7F04              MOV      R7,#04H
B2:009A44 913C              ACALL    _RequestUnsolicited
 5986:   }
 5987: }
B2:009A46         ?C0529?SERIALAPPL:
B2:009A46 22                RET      
----- FUNCTION _Transport_ApplicationCommandHandler (END) -------


----- FUNCTION ?L?COM0393 (BEGIN) -----
B2:009A47 F0                MOVX     @DPTR,A
B2:009A48         ?L?COM0394:
B2:009A48 90445B            MOV      DPTR,#rxOpt
B2:009A4B 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0393 (END) -------


----- FUNCTION ?L?COM0050 (BEGIN) -----
B2:009A4E FF                MOV      R7,A
B2:009A4F 902775            MOV      DPTR,#n
B2:009A52         ?L?COM0051:
B2:009A52 E0                MOVX     A,@DPTR
B2:009A53 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 610


B2:009A54 04                INC      A
B2:009A55 F0                MOVX     @DPTR,A
B2:009A56 7401              MOV      A,#LOW compl_workbuf
B2:009A58 2E                ADD      A,R6
B2:009A59         ?L?COM0052:
B2:009A59 F582              MOV      DPL,A
B2:009A5B E4                CLR      A
B2:009A5C 3420              ADDC     A,#HIGH compl_workbuf
B2:009A5E F583              MOV      DPH,A
B2:009A60 22                RET      
----- FUNCTION ?L?COM0050 (END) -------


----- FUNCTION ?L?COM035D (BEGIN) -----
B2:009A61 FE                MOV      R6,A
B2:009A62 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:009A65 9024C6            MOV      DPTR,#i
B2:009A68 22                RET      
----- FUNCTION ?L?COM035D (END) -------


----- FUNCTION ?L?COM0549 (BEGIN) -----
B2:009A69 904457            MOV      DPTR,#pCmd
B2:009A6C 122552            LCALL    ?C?PLDXDATA
B2:009A6F E9                MOV      A,R1
B2:009A70 22                RET      
----- FUNCTION ?L?COM0549 (END) -------


----- FUNCTION GetCommandClassList (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  195: GetCommandClassList(
  196:     BOOL included,
  197:     security_key_t eKey,
  198:     BYTE endpoint)
  199: {
  200:   static CMD_CLASS_LIST cmd_class_list;
  201:   static CMD_CLASS_LIST* pCmdClassList = NULL;
  202:   ZW_DEBUG_SECURITY_SEND_STR("\r\nCommandsSuppported(");
  203:   ZW_DEBUG_SECURITY_SEND_NUM(included);
  204:   ZW_DEBUG_SECURITY_SEND_NUM(eKey);
  205:   ZW_DEBUG_SECURITY_SEND_NUM(endpoint);
  206:   ZW_DEBUG_SECURITY_SEND_STR(")\r\n");
  207:   if (TRUE == included)
B2:009A71 203D02            JB       included,$ + 5H
B2:009A74 6119              AJMP     ?C0014?ZW_TRANSPORTSECPROTOCOL
  208:   {
  209: 
  210:     if (SECURITY_KEY_NONE == eKey)
B2:009A76 90466C            MOV      DPTR,#eKey
B2:009A79 E0                MOVX     A,@DPTR
B2:009A7A 7021              JNZ      ?C0015?ZW_TRANSPORTSECPROTOCOL
  211:     {
  212:       BYTE keys = ZW_GetSecurityKeys();
B2:009A7C 121B15            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:009A7F 90466E            MOV      DPTR,#keys
B2:009A82 EF                MOV      A,R7
B2:009A83 F0                MOVX     @DPTR,A
  213: 
  214:       /*Check non secure command class list*/
  215:       if(0 == endpoint)
B2:009A84 90466D            MOV      DPTR,#endpoint
B2:009A87 E0                MOVX     A,@DPTR
B2:009A88 6002              JZ       $ + 4H
B2:009A8A 613E              AJMP     ?C0027?ZW_TRANSPORTSECPROTOCOL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 611


  216:       {
  217:         if(SECURITY_KEY_NONE_MASK == keys)
B2:009A8C A3                INC      DPTR
B2:009A8D E0                MOVX     A,@DPTR
B2:009A8E 903D96            MOV      DPTR,#m_AppInfo
B2:009A91 7005              JNZ      ?C0017?ZW_TRANSPORTSECPROTOCOL
  218:         {
  219:           /*Non-secure included, non-secure cmd class list*/
  220:           pCmdClassList =  &(m_AppInfo.u.pCmdLists->unsecList);
B2:009A93 122552            LCALL    ?C?PLDXDATA
  221:         }
B2:009A96 6127              AJMP     ?C0046?ZW_TRANSPORTSECPROTOCOL
B2:009A98         ?C0017?ZW_TRANSPORTSECPROTOCOL:
  222:         else{
  223:           /*secure included, non-secure cmd class list*/
  224:           pCmdClassList =  &(m_AppInfo.u.pCmdLists->sec.unsecList);
B2:009A98 125D35            LCALL    ?L?COM00E4
B2:009A9B         
  225:         }
  226:       }
  227: #ifndef SERIAL_API_APP
  228: 
  229:       else
  230:       {
  231:         pCmdClassList = GetEndpointcmdClassList(FALSE, endpoint);
  232:       }
  233: #endif
  234:       //Copy cmd class list into buffer and only add active CC_SECURITY + CC_SECURITY_2
  235:       /*
  236:       cmd_class_list.pList = cmd_class_buffer;
  237:       cmd_class_list.size = 0;
  238: 
  239: 
  240:       for(i = 0; i < pCmdClassList->size; i++)
  241:       {
  242:         if( ( (COMMAND_CLASS_SECURITY != *(pCmdClassList->pList + i)) &&
  243:               (COMMAND_CLASS_SECURITY_2 != *(pCmdClassList->pList + i))
  244:             ) ||
  245:             (
  246:               (((COMMAND_CLASS_SECURITY == *(pCmdClassList->pList + i)) && (SECURITY_KEY_S0_BIT & keys)) ||
  247:               ((COMMAND_CLASS_SECURITY_2 == *(pCmdClassList->pList + i)) && (SECURITY_KEY_S2_MASK & keys)))
  248:             )
  249:           )
  250:         {
  251:           //Only add security CC if device support it
  252:           cmd_class_buffer[cmd_class_list.size] = *(pCmdClassList->pList + i);
  253:           cmd_class_list.size++;
  254:         }
  255:       }
  256:       pCmdClassList = &cmd_class_list;
  257:       */
  258:     }
B2:009A9B 6127              AJMP     ?C0046?ZW_TRANSPORTSECPROTOCOL
B2:009A9D         ?C0015?ZW_TRANSPORTSECPROTOCOL:
  259:     else
  260:     {
  261:       /*Check secure command class list*/
  262: 
  263:       /*If eKey not is supported, return NULL pointer!!*/
  264:       if(eKey == GetHighestSecureLevel( ZW_GetSecurityKeys()) )
B2:009A9D 121B15            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B2:009AA0 B18F              ACALL    _GetHighestSecureLevel
B2:009AA2 90466C            MOV      DPTR,#eKey
B2:009AA5 E0                MOVX     A,@DPTR
B2:009AA6 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 612


B2:009AA7 6F                XRL      A,R7
B2:009AA8 6002              JZ       $ + 4H
B2:009AAA 612C              AJMP     ?C0047?ZW_TRANSPORTSECPROTOCOL
  265:       {
  266:         if(0 == endpoint)
B2:009AAC A3                INC      DPTR
B2:009AAD E0                MOVX     A,@DPTR
B2:009AAE 700F              JNZ      ?C0021?ZW_TRANSPORTSECPROTOCOL
  267:         {
  268:           pCmdClassList = &(m_AppInfo.u.pCmdLists->sec.secList);
B2:009AB0 714F              ACALL    ?L?COM0245
B2:009AB2 E9                MOV      A,R1
B2:009AB3 2408              ADD      A,#08H
B2:009AB5 F9                MOV      R1,A
B2:009AB6 E4                CLR      A
B2:009AB7 3A                ADDC     A,R2
B2:009AB8 FA                MOV      R2,A
B2:009AB9 903D93            MOV      DPTR,#pCmdClassList
B2:009ABC 122572            LCALL    ?C?PSTXDATA
  269:         }
B2:009ABF         ?C0021?ZW_TRANSPORTSECPROTOCOL:
  270:   #ifndef SERIAL_API_APP
  271:         else
  272:         {
  273:           pCmdClassList = GetEndpointcmdClassList(TRUE, endpoint);
  274:         }
  275:   #endif
  276:         /*Remove marker and commands*/
  277:         if( (SECURITY_KEY_S2_UNAUTHENTICATED == eKey) ||
B2:009ABF EE                MOV      A,R6
B2:009AC0 6401              XRL      A,#01H
B2:009AC2 600A              JZ       ?C0023?ZW_TRANSPORTSECPROTOCOL
B2:009AC4 EE                MOV      A,R6
B2:009AC5 6402              XRL      A,#02H
B2:009AC7 6005              JZ       ?C0023?ZW_TRANSPORTSECPROTOCOL
B2:009AC9 EE                MOV      A,R6
B2:009ACA 6403              XRL      A,#03H
B2:009ACC 7070              JNZ      ?C0027?ZW_TRANSPORTSECPROTOCOL
B2:009ACE         ?C0023?ZW_TRANSPORTSECPROTOCOL:
  278:             (SECURITY_KEY_S2_AUTHENTICATED == eKey) ||
  279:             (SECURITY_KEY_S2_ACCESS == eKey)
  280:           )
  281:         {
  282:           cmd_class_list.pList = cmd_class_buffer;
B2:009ACE 7B01              MOV      R3,#01H
B2:009AD0 7A3D              MOV      R2,#HIGH cmd_class_buffer
B2:009AD2 799D              MOV      R1,#LOW cmd_class_buffer
B2:009AD4 7144              ACALL    ?L?COM0325
B2:009AD6 903D92            MOV      DPTR,#cmd_class_list+03H
B2:009AD9 F0                MOVX     @DPTR,A
B2:009ADA         ?C0024?ZW_TRANSPORTSECPROTOCOL:
  283:           cmd_class_list.size = 0;
  284:           while(((BYTE)*(pCmdClassList->pList + cmd_class_list.size) != COMMAND_CLASS_MARK) &&
B2:009ADA 713E              ACALL    ?L?COM0488
B2:009ADC 122587            LCALL    ?C?PLDPTR
B2:009ADF 903D92            MOV      DPTR,#cmd_class_list+03H
B2:009AE2 E0                MOVX     A,@DPTR
B2:009AE3 FF                MOV      R7,A
B2:009AE4 126E9F            LCALL    ?L?COM02F4
B2:009AE7 FE                MOV      R6,A
B2:009AE8 64EF              XRL      A,#0EFH
B2:009AEA 6025              JZ       ?C0025?ZW_TRANSPORTSECPROTOCOL
B2:009AEC 713E              ACALL    ?L?COM0488
B2:009AEE 900003            MOV      DPTR,#03H
B2:009AF1 121FB9            LCALL    ?C?CLDOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 613


B2:009AF4 FD                MOV      R5,A
B2:009AF5 EF                MOV      A,R7
B2:009AF6 C3                CLR      C
B2:009AF7 9D                SUBB     A,R5
B2:009AF8 5017              JNC      ?C0025?ZW_TRANSPORTSECPROTOCOL
  285:                 (cmd_class_list.size < pCmdClassList->size))
  286:           {
  287:             cmd_class_buffer[cmd_class_list.size] = *(pCmdClassList->pList + cmd_class_list.size);
B2:009AFA 903D92            MOV      DPTR,#cmd_class_list+03H
B2:009AFD E0                MOVX     A,@DPTR
B2:009AFE 249D              ADD      A,#LOW cmd_class_buffer
B2:009B00 F582              MOV      DPL,A
B2:009B02 E4                CLR      A
B2:009B03 343D              ADDC     A,#HIGH cmd_class_buffer
B2:009B05 F583              MOV      DPH,A
B2:009B07 EE                MOV      A,R6
B2:009B08 F0                MOVX     @DPTR,A
  288:             cmd_class_list.size++;
B2:009B09 903D92            MOV      DPTR,#cmd_class_list+03H
B2:009B0C E0                MOVX     A,@DPTR
B2:009B0D 04                INC      A
B2:009B0E F0                MOVX     @DPTR,A
  289:           }
B2:009B0F 80C9              SJMP     ?C0024?ZW_TRANSPORTSECPROTOCOL
B2:009B11         ?C0025?ZW_TRANSPORTSECPROTOCOL:
  290:           pCmdClassList = &cmd_class_list;
B2:009B11 7B01              MOV      R3,#01H
B2:009B13 7A3D              MOV      R2,#HIGH cmd_class_list
B2:009B15 798F              MOV      R1,#LOW cmd_class_list
B2:009B17         
  291:         }
  292:       }
B2:009B17 800E              SJMP     ?C0046?ZW_TRANSPORTSECPROTOCOL
B2:009B19         ?C0014?ZW_TRANSPORTSECPROTOCOL:
  293:       else
  294:       {
  295:         /*not included. Deliver empty list*/
  296:         cmd_class_list.pList = NULL;
  297:         cmd_class_list.size = 0;
  298:         pCmdClassList = &cmd_class_list;
  299:       }
  300:     }
  301:   }
  302:   else
  303:   {
  304:     /*Not included!*/
  305:     if(0 == endpoint)
B2:009B19 90466D            MOV      DPTR,#endpoint
B2:009B1C E0                MOVX     A,@DPTR
B2:009B1D 701F              JNZ      ?C0027?ZW_TRANSPORTSECPROTOCOL
  306:     {
  307:       if (SECURITY_KEY_NONE == eKey)
B2:009B1F 90466C            MOV      DPTR,#eKey
B2:009B22 E0                MOVX     A,@DPTR
B2:009B23 7007              JNZ      ?C0029?ZW_TRANSPORTSECPROTOCOL
  308:       {
  309:         pCmdClassList = &(m_AppInfo.u.pCmdLists->unsecList);
B2:009B25 714F              ACALL    ?L?COM0245
B2:009B27         
B2:009B27 903D93            MOV      DPTR,#pCmdClassList
  310:       }
B2:009B2A 800F              SJMP     ?C0048?ZW_TRANSPORTSECPROTOCOL
B2:009B2C         ?C0029?ZW_TRANSPORTSECPROTOCOL:
  311:       else
  312:       {
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 614


  313:         /*not included. Deliver empty list*/
  314:         cmd_class_list.pList = NULL;
B2:009B2C         
B2:009B2C 1247C7            LCALL    ?L?COM0359
B2:009B2F 7144              ACALL    ?L?COM0325
B2:009B31 903D92            MOV      DPTR,#cmd_class_list+03H
B2:009B34 F0                MOVX     @DPTR,A
  315:         cmd_class_list.size = 0;
  316:         pCmdClassList = &cmd_class_list;
B2:009B35 0B                INC      R3
B2:009B36 7A3D              MOV      R2,#HIGH cmd_class_list
B2:009B38 798F              MOV      R1,#LOW cmd_class_list
B2:009B3A A3                INC      DPTR
B2:009B3B         
B2:009B3B 122572            LCALL    ?C?PSTXDATA
  317:       }
  318:     }
  319: #ifndef SERIAL_API_APP
  320:     else
  321:     {
  322:       pCmdClassList = GetEndpointcmdClassList(FALSE, endpoint);
  323:     }
  324: #endif
  325:   }
B2:009B3E         ?C0027?ZW_TRANSPORTSECPROTOCOL:
B2:;----                  JMP      ?L?COM0488
  326: 
  327:   return pCmdClassList;
----- FUNCTION GetCommandClassList (END) -------


----- FUNCTION ?L?COM0488 (BEGIN) -----
B2:009B3E 903D93            MOV      DPTR,#pCmdClassList
B2:009B41 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0488 (END) -------


----- FUNCTION ?L?COM0325 (BEGIN) -----
B2:009B44 903D8F            MOV      DPTR,#cmd_class_list
B2:009B47 122572            LCALL    ?C?PSTXDATA
B2:009B4A E4                CLR      A
B2:009B4B 22                RET      
----- FUNCTION ?L?COM0325 (END) -------


----- FUNCTION ?L?COM0244 (BEGIN) -----
B2:009B4C 122572            LCALL    ?C?PSTXDATA
B2:009B4F         ?L?COM0245:
B2:009B4F 903D96            MOV      DPTR,#m_AppInfo
B2:009B52 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0244 (END) -------


----- FUNCTION _ApplicationNodeInformation (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  129: ApplicationNodeInformation(
  130:   BYTE *deviceOptionsMask,
B2:009B55 90416C            MOV      DPTR,#deviceOptionsMask
B2:009B58 71CA              ACALL    ?L?COM0487
B2:009B5A EF                MOV      A,R7
B2:009B5B C3                CLR      C
B2:009B5C 6001              JZ       ?C0001?ZW_TRANSPORTSECPROTOCOL
B2:009B5E D3                SETB     C
B2:009B5F         ?C0001?ZW_TRANSPORTSECPROTOCOL:
B2:009B5F         ?C0002?ZW_TRANSPORTSECPROTOCOL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 615


B2:009B5F 923D              MOV      ?GetCommandClassList?BIT,C
B2:009B61 E4                CLR      A
B2:009B62 90466C            MOV      DPTR,#?GetCommandClassList?BYTE
B2:009B65 F0                MOVX     @DPTR,A
B2:009B66 A3                INC      DPTR
B2:009B67 F0                MOVX     @DPTR,A
B2:009B68 5171              ACALL    GetCommandClassList
B2:009B6A 904178            MOV      DPTR,#pCmdClassList
B2:009B6D 714C              ACALL    ?L?COM0244
B2:009B6F 90000C            MOV      DPTR,#0CH
B2:009B72 121FB9            LCALL    ?C?CLDOPTR
B2:009B75 FF                MOV      R7,A
B2:009B76 90416C            MOV      DPTR,#deviceOptionsMask
B2:009B79 1256DF            LCALL    ?L?COM0125
  131:   APPL_NODE_TYPE *nodeType,
  132:   BYTE **nodeParm,
  133:   BYTE *parmLength)
  134: {
  135:   CMD_CLASS_LIST* pCmdClassList = GetCommandClassList((0 != GetNodeId()), SECURITY_KEY_NONE, 0);
  136: 
  137: 
  138:   *deviceOptionsMask  = m_AppInfo.u.pNifs->deviceOptionsMask;  //APPLICATION_NODEINFO_LISTENING | APPLICATION_NOD
>> EINFO_OPTIONAL_FUNCTIONALITY;
  139:   nodeType->generic   = m_AppInfo.u.pNifs->nodeType.generic;  /* Generic device class */
B2:009B7C 714F              ACALL    ?L?COM0245
B2:009B7E 90000D            MOV      DPTR,#0DH
B2:009B81 121FB9            LCALL    ?C?CLDOPTR
B2:009B84 90416F            MOV      DPTR,#nodeType
B2:009B87 1256DE            LCALL    ?L?COM0124
  140:   nodeType->specific  = m_AppInfo.u.pNifs->nodeType.specific; /* Specific device class */
B2:009B8A 714F              ACALL    ?L?COM0245
B2:009B8C 90000E            MOV      DPTR,#0EH
B2:009B8F 121FB9            LCALL    ?C?CLDOPTR
B2:009B92 90416F            MOV      DPTR,#nodeType
B2:009B95 126DF9            LCALL    ?L?COM015F
  141:   *nodeParm = pCmdClassList->pList;
B2:009B98 904178            MOV      DPTR,#pCmdClassList
B2:009B9B 122552            LCALL    ?C?PLDXDATA
B2:009B9E 122587            LCALL    ?C?PLDPTR
B2:009BA1 C003              PUSH     AR3
B2:009BA3 C002              PUSH     AR2
B2:009BA5 C001              PUSH     AR1
B2:009BA7 904172            MOV      DPTR,#nodeParm
B2:009BAA 122552            LCALL    ?C?PLDXDATA
B2:009BAD 1225A7            LCALL    ?C?PSTPTR
  142:   *parmLength = pCmdClassList->size;
B2:009BB0 904178            MOV      DPTR,#pCmdClassList
B2:009BB3 91B7              ACALL    ?L?COM0437
B2:009BB5 904175            MOV      DPTR,#parmLength
B2:009BB8 122552            LCALL    ?C?PLDXDATA
B2:009BBB EF                MOV      A,R7
B2:009BBC 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ApplicationNodeInformation (END) -------


----- FUNCTION ?L?COM028D (BEGIN) -----
B2:009BBF E0                MOVX     A,@DPTR
B2:009BC0 FD                MOV      R5,A
B2:009BC1 121B92            LCALL    ?INTERBANK_TABLE?_MemoryPutByte
B2:009BC4 E4                CLR      A
B2:009BC5 9024C6            MOV      DPTR,#i
B2:009BC8 F0                MOVX     @DPTR,A
B2:009BC9 22                RET      
----- FUNCTION ?L?COM028D (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 616



----- FUNCTION ?L?COM0487 (BEGIN) -----
B2:009BCA 122572            LCALL    ?C?PSTXDATA
----- FUNCTION GetNodeId (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  350: BYTE GetNodeId(void)
  351: {
  352:   BYTE nodeId;
  353:   MemoryGetID(NULL, &nodeId);
B2:009BCD 7B01              MOV      R3,#01H
B2:009BCF 7A46              MOV      R2,#HIGH nodeId
B2:009BD1 79C4              MOV      R1,#LOW nodeId
B2:009BD3 126E23            LCALL    ?L?COM01CD
B2:009BD6 1B                DEC      R3
B2:009BD7 7A00              MOV      R2,#00H
B2:009BD9 7900              MOV      R1,#00H
B2:009BDB 121B83            LCALL    ?INTERBANK_TABLE?_MemoryGetID
  354:   return nodeId;
B2:009BDE 9046C4            MOV      DPTR,#nodeId
B2:009BE1 E0                MOVX     A,@DPTR
B2:009BE2 FF                MOV      R7,A
  355: }
B2:009BE3 22                RET      
----- FUNCTION GetNodeId (END) -------


----- FUNCTION _ApplicationSecurityEvent (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 6267: ApplicationSecurityEvent(
 6268:   s_application_security_event_data_t *securityEvent)
B2:009BE4 904663            MOV      DPTR,#securityEvent
B2:009BE7 122572            LCALL    ?C?PSTXDATA
 6269: {
 6270:   /* ZW->HOST: retValLen(1) | retVal[retValLen] */
 6271:   BYTE_IN_AR(compl_workbuf, 0) = securityEvent->event;
B2:009BEA 904663            MOV      DPTR,#securityEvent
B2:009BED 122552            LCALL    ?C?PLDXDATA
B2:009BF0 121F7C            LCALL    ?C?CLDPTR
B2:009BF3 902001            MOV      DPTR,#compl_workbuf
B2:009BF6 F0                MOVX     @DPTR,A
 6272:   BYTE_IN_AR(compl_workbuf, 1) = securityEvent->eventDataLength;
B2:009BF7 E9                MOV      A,R1
B2:009BF8 2401              ADD      A,#01H
B2:009BFA 1252DD            LCALL    ?L?COM0009
B2:009BFD 902002            MOV      DPTR,#compl_workbuf+01H
B2:009C00 91C2              ACALL    ?L?COM01E3
B2:009C02         ?C0540?SERIALAPPL:
B2:009C02 91AD              ACALL    ?L?COM01E1
B2:009C04 1252DD            LCALL    ?L?COM0009
B2:009C07 11EC              ACALL    ?L?COM0081
B2:009C09 5023              JNC      ?C0541?SERIALAPPL
 6273:   for (i = 0; i < securityEvent->eventDataLength; i++)
 6274:   {
 6275:     BYTE_IN_AR(compl_workbuf, 2 + i) = securityEvent->eventData[i];
B2:009C0B 904663            MOV      DPTR,#securityEvent
B2:009C0E 122552            LCALL    ?C?PLDXDATA
B2:009C11 125D47            LCALL    ?L?COM03C9
B2:009C14 FA                MOV      R2,A
B2:009C15 122587            LCALL    ?C?PLDPTR
B2:009C18 E9                MOV      A,R1
B2:009C19 2E                ADD      A,R6
B2:009C1A 1252DD            LCALL    ?L?COM0009
B2:009C1D FF                MOV      R7,A
B2:009C1E 7403              MOV      A,#LOW compl_workbuf+02H
B2:009C20 2E                ADD      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 617


B2:009C21 F582              MOV      DPL,A
B2:009C23 E4                CLR      A
B2:009C24 3420              ADDC     A,#HIGH compl_workbuf+02H
B2:009C26 F583              MOV      DPH,A
B2:009C28 EF                MOV      A,R7
B2:009C29 1293B9            LCALL    ?L?COM0033
B2:009C2C 80D4              SJMP     ?C0540?SERIALAPPL
B2:009C2E         ?C0541?SERIALAPPL:
 6276:   }
 6277:   RequestUnsolicited(FUNC_ID_APPLICATION_SECURITY_EVENT, compl_workbuf, securityEvent->eventDataLength + 2);
B2:009C2E 7C20              MOV      R4,#HIGH compl_workbuf
B2:009C30 7D01              MOV      R5,#LOW compl_workbuf
B2:009C32 91AD              ACALL    ?L?COM01E1
B2:009C34 1252DD            LCALL    ?L?COM0009
B2:009C37 2402              ADD      A,#02H
B2:009C39 FB                MOV      R3,A
B2:009C3A 7F9D              MOV      R7,#09DH
B2:;----                  JMP      _RequestUnsolicited
----- FUNCTION _ApplicationSecurityEvent (END) -------


----- FUNCTION _RequestUnsolicited (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  753: RequestUnsolicited(
  754:   BYTE cmd,       /*IN   Command                  */
B2:009C3C 904660            MOV      DPTR,#pData
B2:009C3F 126EBF            LCALL    ?L?COM0349
B2:009C42 EB                MOV      A,R3
B2:009C43 F0                MOVX     @DPTR,A
;---- Variable 'cmd' assigned to Register 'R7' ----
  755:   XBYTE *pData,   /*IN   pointer to data          */
  756:   BYTE len        /*IN   Length of data           */
  757: )
  758: {
  759: #if SUPPORT_SERIAL_API_READY
  760:   /* Only queue Request frame for HOST if SERIAL LINK has been established or we need to send the WakeUp Frame */
>> 
  761:   if (((SERIAL_LINK_DETACHED != serialLinkState) || (wakeUpOnRF)) && (commandQueue.requestCnt < MAX_CALLBACK_QUEU
>> E))
B2:009C44 90215F            MOV      DPTR,#serialLinkState
B2:009C47 E0                MOVX     A,@DPTR
B2:009C48 7003              JNZ      ?C0007?SERIALAPPL
B2:009C4A 300D5E            JNB      wakeUpOnRF,?C0006?SERIALAPPL
B2:009C4D         ?C0007?SERIALAPPL:
B2:009C4D 9024CC            MOV      DPTR,#commandQueue+02H
B2:009C50 E0                MOVX     A,@DPTR
B2:009C51 C3                CLR      C
B2:009C52 9404              SUBB     A,#04H
B2:009C54 5055              JNC      ?C0006?SERIALAPPL
  762: #else
  763:   if (commandQueue.requestCnt < MAX_CALLBACK_QUEUE)
  764: #endif
  765:   {
  766:     commandQueue.requestCnt++;
B2:009C56 E0                MOVX     A,@DPTR
B2:009C57 04                INC      A
B2:009C58 F0                MOVX     @DPTR,A
  767:     commandQueue.requestQueue[commandQueue.requestIn].wCmd = cmd;
B2:009C59 9024CB            MOV      DPTR,#commandQueue+01H
B2:009C5C E0                MOVX     A,@DPTR
B2:009C5D 12A860            LCALL    ?L?COM0213
B2:009C60 EF                MOV      A,R7
B2:009C61 F0                MOVX     @DPTR,A
  768:     if (len > BUF_SIZE_TX)
B2:009C62 904662            MOV      DPTR,#len
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 618


B2:009C65 E0                MOVX     A,@DPTR
B2:009C66 D3                SETB     C
B2:009C67 94A8              SUBB     A,#0A8H
B2:009C69 4003              JC       ?C0008?SERIALAPPL
  769:     {
  770:       len = BUF_SIZE_TX;
B2:009C6B 74A8              MOV      A,#0A8H
B2:009C6D F0                MOVX     @DPTR,A
  771:     }
B2:009C6E         ?C0008?SERIALAPPL:
  772:     commandQueue.requestQueue[commandQueue.requestIn].wLen = len;
B2:009C6E 904662            MOV      DPTR,#len
B2:009C71 E0                MOVX     A,@DPTR
B2:009C72 FF                MOV      R7,A
B2:009C73 9024CB            MOV      DPTR,#commandQueue+01H
B2:009C76 E0                MOVX     A,@DPTR
B2:009C77 FE                MOV      R6,A
B2:009C78 12AA1E            LCALL    ?L?COM046B
B2:009C7B EF                MOV      A,R7
B2:009C7C F0                MOVX     @DPTR,A
  773:     memcpy(&commandQueue.requestQueue[commandQueue.requestIn].wBuf[0], pData, len);
B2:009C7D EE                MOV      A,R6
B2:009C7E 75F0AA            MOV      B,#0AAH
B2:009C81 A4                MUL      AB
B2:009C82 24CF              ADD      A,#LOW commandQueue+05H
B2:009C84 F9                MOV      R1,A
B2:009C85 7424              MOV      A,#HIGH commandQueue+05H
B2:009C87 35F0              ADDC     A,B
B2:009C89 FA                MOV      R2,A
B2:009C8A 7B01              MOV      R3,#01H
B2:009C8C C002              PUSH     AR2
B2:009C8E C001              PUSH     AR1
B2:009C90 904662            MOV      DPTR,#len
B2:009C93 E0                MOVX     A,@DPTR
B2:009C94 904660            MOV      DPTR,#pData
B2:009C97 F1C1              ACALL    ?L?COM021D
B2:009C99 D001              POP      AR1
B2:009C9B D002              POP      AR2
B2:009C9D 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  774:     if (++commandQueue.requestIn >= MAX_CALLBACK_QUEUE)
B2:009CA0 9024CB            MOV      DPTR,#commandQueue+01H
B2:009CA3 F1D6              ACALL    ?L?COM03CC
B2:009CA5 4002              JC       ?C0009?SERIALAPPL
  775:     {
  776:       commandQueue.requestIn = 0;
B2:009CA7 E4                CLR      A
B2:009CA8 F0                MOVX     @DPTR,A
  777:     }
B2:009CA9         ?C0009?SERIALAPPL:
  778:     return TRUE;
B2:009CA9 D3                SETB     C
B2:009CAA 22                RET      
  779:   }
B2:009CAB         ?C0006?SERIALAPPL:
  780:   return FALSE;
B2:009CAB C3                CLR      C
  781: }
B2:009CAC 22                RET      
----- FUNCTION _RequestUnsolicited (END) -------


----- FUNCTION ?L?COM01E1 (BEGIN) -----
B2:009CAD 904663            MOV      DPTR,#securityEvent
B2:009CB0 122552            LCALL    ?C?PLDXDATA
B2:009CB3 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 619


B2:009CB4 2401              ADD      A,#01H
B2:009CB6 22                RET      
----- FUNCTION ?L?COM01E1 (END) -------


----- FUNCTION ?L?COM0437 (BEGIN) -----
B2:009CB7 122552            LCALL    ?C?PLDXDATA
B2:009CBA 900003            MOV      DPTR,#03H
B2:009CBD 121FB9            LCALL    ?C?CLDOPTR
B2:009CC0 FF                MOV      R7,A
B2:009CC1 22                RET      
----- FUNCTION ?L?COM0437 (END) -------


----- FUNCTION ?L?COM01E3 (BEGIN) -----
B2:009CC2 F0                MOVX     @DPTR,A
B2:009CC3 E4                CLR      A
B2:009CC4 9024C6            MOV      DPTR,#i
B2:009CC7 F0                MOVX     @DPTR,A
B2:009CC8 22                RET      
----- FUNCTION ?L?COM01E3 (END) -------


----- FUNCTION _SetupActiveNIF (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  434: SetupActiveNIF(BYTE nodeId)
  435: {
;---- Variable 'nodeId' assigned to Register 'R7' ----
  436:   if(0 == nodeId || (SECURITY_KEY_NONE == GetHighestSecureLevel(ZW_GetSecurityKeys())) )
  437:   {
B2:009CC9 EF                MOV      A,R7
B2:009CCA 6005              JZ       ?C0041?ZW_TRANSPORTSECPROTOCOL
B2:009CCC B18C              ACALL    ?L?COM0486
B2:009CCE EF                MOV      A,R7
B2:009CCF 700A              JNZ      ?C0040?ZW_TRANSPORTSECPROTOCOL
B2:009CD1         ?C0041?ZW_TRANSPORTSECPROTOCOL:
  438:     m_AppInfo.activeNonsecureList = m_AppInfo.u.pCmdLists->unsecList;
  439:   }
B2:009CD1 7899              MOV      R0,#LOW m_AppInfo+03H
B2:009CD3 7C3D              MOV      R4,#HIGH m_AppInfo+03H
B2:009CD5 7D01              MOV      R5,#01H
B2:009CD7 714F              ACALL    ?L?COM0245
  440:   else
B2:009CD9 800C              SJMP     ?C0049?ZW_TRANSPORTSECPROTOCOL
B2:009CDB         ?C0040?ZW_TRANSPORTSECPROTOCOL:
  441:   {
  442:     m_AppInfo.activeNonsecureList = m_AppInfo.u.pCmdLists->sec.unsecList;
B2:009CDB 903D96            MOV      DPTR,#m_AppInfo
B2:009CDE 125D35            LCALL    ?L?COM00E4
B2:009CE1 7899              MOV      R0,#LOW m_AppInfo+03H
B2:009CE3 7C3D              MOV      R4,#HIGH m_AppInfo+03H
B2:009CE5 7D01              MOV      R5,#01H
B2:009CE7         
B2:009CE7 7E00              MOV      R6,#00H
B2:009CE9 7F04              MOV      R7,#04H
B2:009CEB 021F56            LJMP     ?C?COPY
  443:   }
----- FUNCTION _SetupActiveNIF (END) -------


----- FUNCTION _CmdClassSupported (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_CMD_CLASS_LIST.C'
   84: CmdClassSupported(security_key_t eKey,
   85:                   BYTE commandClass,
B2:009CEE 90424D            MOV      DPTR,#eKey
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 620


B2:009CF1 126563            LCALL    ?L?COM00E9
B2:009CF4 EB                MOV      A,R3
B2:009CF5 F0                MOVX     @DPTR,A
   86:                   BYTE command,
   87:                   BYTE* pSecurelist,
   88:                   BYTE securelistLen,
   89:                   BYTE* pNonSecurelist,
   90:                   BYTE nonSecurelistLen)
   91: {
   92:   security_key_t device_higest_secure_level = GetHighestSecureLevel(ZW_GetSecurityKeys());
B2:009CF6 B18C              ACALL    ?L?COM0486
;---- Variable 'device_higest_secure_level' assigned to Register 'R4' ----
B2:009CF8 AC07              MOV      R4,AR7
   93:   /*Only allow secure command list if node is securely included.*/
   94:   /*Check if cmd Class are supported in current mode (non-secure or secure)*/
   95:   if((SECURITY_KEY_NONE != device_higest_secure_level) && (eKey == device_higest_secure_level) && NON_NULL( pSecu
>> relist ))
B2:009CFA EC                MOV      A,R4
B2:009CFB 6028              JZ       ?C0006?ZW_CMD_CLASS_LIST
B2:009CFD 90424D            MOV      DPTR,#eKey
B2:009D00 E0                MOVX     A,@DPTR
B2:009D01 6C                XRL      A,R4
B2:009D02 7021              JNZ      ?C0006?ZW_CMD_CLASS_LIST
B2:009D04 904250            MOV      DPTR,#pSecurelist
B2:009D07 122552            LCALL    ?C?PLDXDATA
B2:009D0A E9                MOV      A,R1
B2:009D0B 4A                ORL      A,R2
B2:009D0C 6017              JZ       ?C0006?ZW_CMD_CLASS_LIST
   96:   {
   97:     if ((COMMAND_CLASS_BASIC == commandClass) ||
B2:009D0E 90424E            MOV      DPTR,#commandClass
B2:009D11 E0                MOVX     A,@DPTR
B2:009D12 FF                MOV      R7,A
B2:009D13 6420              XRL      A,#020H
B2:009D15 600C              JZ       ?C0008?ZW_CMD_CLASS_LIST
B2:009D17 904253            MOV      DPTR,#securelistLen
B2:009D1A E0                MOVX     A,@DPTR
B2:009D1B 904545            MOV      DPTR,#?_CheckCmdClass?BYTE+04H
B2:009D1E F0                MOVX     @DPTR,A
B2:009D1F D15F              ACALL    _CheckCmdClass
B2:009D21 5002              JNC      ?C0006?ZW_CMD_CLASS_LIST
B2:009D23         ?C0008?ZW_CMD_CLASS_LIST:
   98:         (TRUE == CheckCmdClass(commandClass, pSecurelist, securelistLen)))
   99:     {
  100:       return TRUE; /*cmd is supported!*/
B2:009D23 D3                SETB     C
B2:009D24 22                RET      
  101:     }
  102:   }
B2:009D25         ?C0006?ZW_CMD_CLASS_LIST:
  103: 
  104:   if ((SECURITY_KEY_S0 == device_higest_secure_level) &&     /* Security S0 */
  105:       (SECURITY_KEY_NONE == eKey) &&                         /* non-secure input */
  106:       (COMMAND_CLASS_MANUFACTURER_SPECIFIC == commandClass) &&
  107:       (MANUFACTURER_SPECIFIC_GET == command) &&
  108:       NON_NULL( pSecurelist ))                               /* Securely included */
B2:009D25 EC                MOV      A,R4
B2:009D26 6404              XRL      A,#04H
B2:009D28 701A              JNZ      ?C0010?ZW_CMD_CLASS_LIST
B2:009D2A 90424D            MOV      DPTR,#eKey
B2:009D2D E0                MOVX     A,@DPTR
B2:009D2E 7014              JNZ      ?C0010?ZW_CMD_CLASS_LIST
B2:009D30 A3                INC      DPTR
B2:009D31 E0                MOVX     A,@DPTR
B2:009D32 B4720F            CJNE     A,#072H,?C0010?ZW_CMD_CLASS_LIST
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 621


B2:009D35 A3                INC      DPTR
B2:009D36 E0                MOVX     A,@DPTR
B2:009D37 B4040A            CJNE     A,#04H,?C0010?ZW_CMD_CLASS_LIST
B2:009D3A A3                INC      DPTR
B2:009D3B 122552            LCALL    ?C?PLDXDATA
B2:009D3E E9                MOV      A,R1
B2:009D3F 4A                ORL      A,R2
B2:009D40 6002              JZ       ?C0010?ZW_CMD_CLASS_LIST
  109:   {
  110:     return TRUE; /*cmd is supported!*/
B2:009D42 D3                SETB     C
B2:009D43 22                RET      
  111:   }
B2:009D44         ?C0010?ZW_CMD_CLASS_LIST:
  112: 
  113:   if ((SECURITY_KEY_NONE == device_higest_secure_level) && (commandClass == COMMAND_CLASS_BASIC))
B2:009D44 EC                MOV      A,R4
B2:009D45 7009              JNZ      ?C0011?ZW_CMD_CLASS_LIST
B2:009D47 90424E            MOV      DPTR,#commandClass
B2:009D4A E0                MOVX     A,@DPTR
B2:009D4B B42002            CJNE     A,#020H,?C0011?ZW_CMD_CLASS_LIST
  114:   {
  115:     /* Non-secure node always support CC Basic. */
  116:     return TRUE;
B2:009D4E D3                SETB     C
B2:009D4F 22                RET      
  117:   }
B2:009D50         ?C0011?ZW_CMD_CLASS_LIST:
  118: 
  119:   /*Check cmdClass is in non-secure list*/
  120:   if(NON_NULL( pNonSecurelist ))
B2:009D50 904254            MOV      DPTR,#pNonSecurelist
B2:009D53 122552            LCALL    ?C?PLDXDATA
B2:009D56 E9                MOV      A,R1
B2:009D57 4A                ORL      A,R2
B2:009D58 600F              JZ       ?C0012?ZW_CMD_CLASS_LIST
  121:   {
  122:     return CheckCmdClass(commandClass, pNonSecurelist, nonSecurelistLen);
B2:009D5A 90424E            MOV      DPTR,#commandClass
B2:009D5D E0                MOVX     A,@DPTR
B2:009D5E FF                MOV      R7,A
B2:009D5F 904257            MOV      DPTR,#nonSecurelistLen
B2:009D62 E0                MOVX     A,@DPTR
B2:009D63 904545            MOV      DPTR,#?_CheckCmdClass?BYTE+04H
B2:009D66 F0                MOVX     @DPTR,A
B2:009D67 C15F              AJMP     _CheckCmdClass
  123:   }
B2:009D69         ?C0012?ZW_CMD_CLASS_LIST:
  124:   return FALSE; /* Cmd not in list*/
B2:009D69 C3                CLR      C
  125: }
B2:009D6A 22                RET      
----- FUNCTION _CmdClassSupported (END) -------


----- FUNCTION ApplicationSecureAuthenticationRequested (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 6316: ApplicationSecureAuthenticationRequested(void)
 6317: {
 6318:   return sRequestedSecuritySettings.requestedSecurityAuthentication;
 6319: }
B2:009D6B 90247E            MOV      DPTR,#sRequestedSecuritySettings+01H
B2:009D6E E0                MOVX     A,@DPTR
B2:009D6F FF                MOV      R7,A
 6320: #endif
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 622


B2:009D70 22                RET      
----- FUNCTION ApplicationSecureAuthenticationRequested (END) -------


----- FUNCTION ?L?COM0497 (BEGIN) -----
B2:009D71 F0                MOVX     @DPTR,A
B2:009D72 121BB5            LCALL    ?INTERBANK_TABLE?_MemoryPutBuffer
B2:009D75 90279F            MOV      DPTR,#retVal
B2:009D78 EF                MOV      A,R7
B2:009D79 F0                MOVX     @DPTR,A
B2:009D7A 22                RET      
----- FUNCTION ?L?COM0497 (END) -------


----- FUNCTION ?L?COM0203 (BEGIN) -----
B2:009D7B F0                MOVX     @DPTR,A
B2:009D7C 121CE6            LCALL    ?INTERBANK_TABLE?ZW_s2_inclusion_init
B2:009D7F         ?L?COM0204:
B2:009D7F 90279F            MOV      DPTR,#retVal
B2:009D82 7401              MOV      A,#01H
B2:009D84 F0                MOVX     @DPTR,A
B2:009D85 22                RET      
----- FUNCTION ?L?COM0203 (END) -------


----- FUNCTION ApplicationSecureKeysRequested (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 6305: ApplicationSecureKeysRequested(void)
 6306: {
 6307:   return sRequestedSecuritySettings.requestedSecurityKeysBits;
 6308: }
B2:009D86 90247D            MOV      DPTR,#sRequestedSecuritySettings
B2:009D89 E0                MOVX     A,@DPTR
B2:009D8A FF                MOV      R7,A
 6309: 
B2:009D8B 22                RET      
----- FUNCTION ApplicationSecureKeysRequested (END) -------


----- FUNCTION ?L?COM0486 (BEGIN) -----
B2:009D8C 121B15            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
----- FUNCTION _GetHighestSecureLevel (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  170: GetHighestSecureLevel(BYTE protocolSecBits)
  171: {
;---- Variable 'protocolSecBits' assigned to Register 'R7' ----
  172:   if(SECURITY_KEY_S2_ACCESS_BIT & protocolSecBits)
  173:   {
B2:009D8F EF                MOV      A,R7
B2:009D90 30E203            JNB      ACC.2,?C0006?ZW_TRANSPORTSECPROTOCOL
  174:     return SECURITY_KEY_S2_ACCESS;
  175:   }
B2:009D93 7F03              MOV      R7,#03H
B2:009D95 22                RET      
  176:   else if(SECURITY_KEY_S2_AUTHENTICATED_BIT & protocolSecBits)
B2:009D96         ?C0006?ZW_TRANSPORTSECPROTOCOL:
  177:   {
B2:009D96 EF                MOV      A,R7
B2:009D97 30E103            JNB      ACC.1,?C0009?ZW_TRANSPORTSECPROTOCOL
  178:     return SECURITY_KEY_S2_AUTHENTICATED;
  179:   }
B2:009D9A 7F02              MOV      R7,#02H
B2:009D9C 22                RET      
  180:   else if(SECURITY_KEY_S2_UNAUTHENTICATED_BIT & protocolSecBits)
B2:009D9D         ?C0009?ZW_TRANSPORTSECPROTOCOL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 623


  181:   {
B2:009D9D EF                MOV      A,R7
B2:009D9E 30E003            JNB      ACC.0,?C0011?ZW_TRANSPORTSECPROTOCOL
  182:     return SECURITY_KEY_S2_UNAUTHENTICATED;
  183:   }
B2:009DA1 7F01              MOV      R7,#01H
B2:009DA3 22                RET      
  184:   else if(SECURITY_KEY_S0_BIT & protocolSecBits)
B2:009DA4         ?C0011?ZW_TRANSPORTSECPROTOCOL:
  185:   {
B2:009DA4 EF                MOV      A,R7
B2:009DA5 7F00              MOV      R7,#00H
B2:009DA7 30E702            JNB      ACC.7,?C0008?ZW_TRANSPORTSECPROTOCOL
  186:     return SECURITY_KEY_S0;
  187:   }
B2:009DAA 7F04              MOV      R7,#04H
  188: 
B2:009DAC         ?C0008?ZW_TRANSPORTSECPROTOCOL:
  189:   return SECURITY_KEY_NONE;
  190: }
B2:009DAC 22                RET      
----- FUNCTION _GetHighestSecureLevel (END) -------


----- FUNCTION _Request (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  716: Request(
  717:   BYTE cmd,       /*IN   Command                  */
B2:009DAD 90465D            MOV      DPTR,#pData
B2:009DB0 126EBF            LCALL    ?L?COM0349
B2:009DB3 EB                MOV      A,R3
B2:009DB4 F0                MOVX     @DPTR,A
;---- Variable 'cmd' assigned to Register 'R7' ----
  718:   XBYTE *pData,   /*IN   pointer to data          */
  719:   BYTE len        /*IN   Length of data           */
  720: )
  721: {
  722: #if SUPPORT_SERIAL_API_READY
  723:   /* Only queue Request frame for HOST if SERIAL LINK has been established or we need to send the WakeUp Frame */
>> 
  724:   if (((SERIAL_LINK_DETACHED != serialLinkState) || (wakeUpOnRF)) && (callbackQueue.requestCnt < MAX_CALLBACK_QUE
>> UE))
B2:009DB5 90215F            MOV      DPTR,#serialLinkState
B2:009DB8 E0                MOVX     A,@DPTR
B2:009DB9 7003              JNZ      ?C0002?SERIALAPPL
B2:009DBB 300D5E            JNB      wakeUpOnRF,?C0001?SERIALAPPL
B2:009DBE         ?C0002?SERIALAPPL:
B2:009DBE 902176            MOV      DPTR,#callbackQueue+02H
B2:009DC1 E0                MOVX     A,@DPTR
B2:009DC2 C3                CLR      C
B2:009DC3 9404              SUBB     A,#04H
B2:009DC5 5055              JNC      ?C0001?SERIALAPPL
  725: #else
  726:   if (callbackQueue.requestCnt < MAX_CALLBACK_QUEUE)
  727: #endif
  728:   {
  729:     callbackQueue.requestCnt++;
B2:009DC7 E0                MOVX     A,@DPTR
B2:009DC8 04                INC      A
B2:009DC9 F0                MOVX     @DPTR,A
  730:     callbackQueue.requestQueue[callbackQueue.requestIn].wCmd = cmd;
B2:009DCA 902175            MOV      DPTR,#callbackQueue+01H
B2:009DCD E0                MOVX     A,@DPTR
B2:009DCE 12A91C            LCALL    ?L?COM0324
B2:009DD1 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 624


B2:009DD2 F0                MOVX     @DPTR,A
  731:     if (len > BUF_SIZE_TX)
B2:009DD3 90465F            MOV      DPTR,#len
B2:009DD6 E0                MOVX     A,@DPTR
B2:009DD7 D3                SETB     C
B2:009DD8 94A8              SUBB     A,#0A8H
B2:009DDA 4003              JC       ?C0003?SERIALAPPL
  732:     {
  733:       len = BUF_SIZE_TX;
B2:009DDC 74A8              MOV      A,#0A8H
B2:009DDE F0                MOVX     @DPTR,A
  734:     }
B2:009DDF         ?C0003?SERIALAPPL:
  735:     callbackQueue.requestQueue[callbackQueue.requestIn].wLen = len;
B2:009DDF 90465F            MOV      DPTR,#len
B2:009DE2 E0                MOVX     A,@DPTR
B2:009DE3 FF                MOV      R7,A
B2:009DE4 902175            MOV      DPTR,#callbackQueue+01H
B2:009DE7 E0                MOVX     A,@DPTR
B2:009DE8 FE                MOV      R6,A
B2:009DE9 12A8D5            LCALL    ?L?COM029E
B2:009DEC EF                MOV      A,R7
B2:009DED F0                MOVX     @DPTR,A
  736:     memcpy(&callbackQueue.requestQueue[callbackQueue.requestIn].wBuf[0], pData, len);
B2:009DEE EE                MOV      A,R6
B2:009DEF 75F0AA            MOV      B,#0AAH
B2:009DF2 A4                MUL      AB
B2:009DF3 2479              ADD      A,#LOW callbackQueue+05H
B2:009DF5 F9                MOV      R1,A
B2:009DF6 7421              MOV      A,#HIGH callbackQueue+05H
B2:009DF8 35F0              ADDC     A,B
B2:009DFA FA                MOV      R2,A
B2:009DFB 7B01              MOV      R3,#01H
B2:009DFD C002              PUSH     AR2
B2:009DFF C001              PUSH     AR1
B2:009E01 90465F            MOV      DPTR,#len
B2:009E04 E0                MOVX     A,@DPTR
B2:009E05 90465D            MOV      DPTR,#pData
B2:009E08 F1C1              ACALL    ?L?COM021D
B2:009E0A D001              POP      AR1
B2:009E0C D002              POP      AR2
B2:009E0E 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  737:     if (++callbackQueue.requestIn >= MAX_CALLBACK_QUEUE)
B2:009E11 902175            MOV      DPTR,#callbackQueue+01H
B2:009E14 F1D6              ACALL    ?L?COM03CC
B2:009E16 4002              JC       ?C0004?SERIALAPPL
  738:     {
  739:       callbackQueue.requestIn = 0;
B2:009E18 E4                CLR      A
B2:009E19 F0                MOVX     @DPTR,A
  740:     }
B2:009E1A         ?C0004?SERIALAPPL:
  741:     return TRUE;
B2:009E1A D3                SETB     C
B2:009E1B 22                RET      
  742:   }
B2:009E1C         ?C0001?SERIALAPPL:
  743:   return FALSE;
B2:009E1C C3                CLR      C
  744: }
B2:009E1D 22                RET      
----- FUNCTION _Request (END) -------


----- FUNCTION PurgeCallbackQueue (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 625


 FILE: 'SERIALAPPL.C'
  784: PurgeCallbackQueue(void)
  785: {
  786:   callbackQueue.requestOut = callbackQueue.requestIn = callbackQueue.requestCnt = 0;
  787: }
B2:009E1E E4                CLR      A
B2:009E1F 902176            MOV      DPTR,#callbackQueue+02H
B2:009E22 F0                MOVX     @DPTR,A
B2:009E23 902175            MOV      DPTR,#callbackQueue+01H
B2:009E26 F0                MOVX     @DPTR,A
B2:009E27 902174            MOV      DPTR,#callbackQueue
B2:009E2A F0                MOVX     @DPTR,A
  788: 
B2:009E2B 22                RET      
----- FUNCTION PurgeCallbackQueue (END) -------


----- FUNCTION ?L?COM043B (BEGIN) -----
B2:009E2C 90215F            MOV      DPTR,#serialLinkState
B2:009E2F F0                MOVX     @DPTR,A
B2:009E30 D11E              ACALL    PurgeCallbackQueue
----- FUNCTION PurgeCommandQueue (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  790: PurgeCommandQueue(void)
  791: {
  792:   commandQueue.requestOut = commandQueue.requestIn = commandQueue.requestCnt = 0;
  793: }
B2:009E32 E4                CLR      A
B2:009E33 9024CC            MOV      DPTR,#commandQueue+02H
B2:009E36 F0                MOVX     @DPTR,A
B2:009E37 9024CB            MOV      DPTR,#commandQueue+01H
B2:009E3A F0                MOVX     @DPTR,A
B2:009E3B 9024CA            MOV      DPTR,#commandQueue
B2:009E3E F0                MOVX     @DPTR,A
  794: 
B2:009E3F 22                RET      
----- FUNCTION PurgeCommandQueue (END) -------


----- FUNCTION _Respond (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  802: Respond(
  803:   BYTE cmd,       /*IN   Command                  */
;---- Variable 'cmd' assigned to Register 'R1' ----
B2:009E40 A907              MOV      R1,AR7
;---- Variable 'len' assigned to Register 'R6' ----
B2:009E42 AE03              MOV      R6,AR3
;---- Variable 'pData' assigned to Register 'R4/R5' ----
  804:   XBYTE *pData,    /*IN   pointer to data          */
  805:   BYTE len        /*IN   Length of data           */
  806: )
  807: {
  808:   /* If there are no data; pData == NULL and len == 0 we must set the data pointer */
  809:   /* to some dummy data. ConTxFrame interprets NULL pointer as retransmit indication */
  810:   if (len == 0)
B2:009E44 EE                MOV      A,R6
B2:009E45 7004              JNZ      ?C0013?SERIALAPPL
  811:   {
  812:     pData = (XBYTE *)0x7ff; /* Just something is not used anyway */
B2:009E47 7C07              MOV      R4,#07H
B2:009E49 7DFF              MOV      R5,#0FFH
  813:   }
B2:009E4B         ?C0013?SERIALAPPL:
  814:   ConTxFrame(cmd, RESPONSE, pData, len);
B2:009E4B AF01              MOV      R7,AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 626


B2:009E4D AB05              MOV      R3,AR5
B2:009E4F AA04              MOV      R2,AR4
B2:009E51 904469            MOV      DPTR,#?_ConTxFrame?BYTE+04H
B2:009E54 EE                MOV      A,R6
B2:009E55 F0                MOVX     @DPTR,A
B2:009E56 7D01              MOV      R5,#01H
B2:009E58 12A523            LCALL    ?L?COM0323
B2:009E5B 7401              MOV      A,#01H
B2:009E5D F0                MOVX     @DPTR,A
  815: 
  816:   set_state(stateTxSerial);  /* We want ACK/NAK...*/
  817: }
B2:009E5E 22                RET      
----- FUNCTION _Respond (END) -------


----- FUNCTION _CheckCmdClass (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_CMD_CLASS_LIST.C'
   61: CheckCmdClass(BYTE cmdClass,
   62:               BYTE *pList,
B2:009E5F 904542            MOV      DPTR,#pList
B2:009E62 122572            LCALL    ?C?PSTXDATA
;---- Variable 'cmdClass' assigned to Register 'R7' ----
   63:               BYTE len)
   64: {
   65:   BYTE i;
   66:   for( i = 0; i < len; i++)
;---- Variable 'i' assigned to Register 'R6' ----
B2:009E65 E4                CLR      A
B2:009E66 FE                MOV      R6,A
B2:009E67         ?C0001?ZW_CMD_CLASS_LIST:
B2:009E67 904545            MOV      DPTR,#len
B2:009E6A E0                MOVX     A,@DPTR
B2:009E6B FD                MOV      R5,A
B2:009E6C EE                MOV      A,R6
B2:009E6D C3                CLR      C
B2:009E6E 9D                SUBB     A,R5
B2:009E6F 5013              JNC      ?C0002?ZW_CMD_CLASS_LIST
   67:   {
   68:     if(*(pList+i) == cmdClass)
B2:009E71 904542            MOV      DPTR,#pList
B2:009E74 122552            LCALL    ?C?PLDXDATA
B2:009E77 8E82              MOV      DPL,R6
B2:009E79 126EA1            LCALL    ?L?COM02F5
B2:009E7C B50702            CJNE     A,AR7,?C0003?ZW_CMD_CLASS_LIST
   69:     {
   70:       ZW_DEBUG_CMDCLIST_SEND_STR("CheckCmdC success ");
   71:       ZW_DEBUG_CMDCLIST_SEND_NUM(cmdClass);
   72:       ZW_DEBUG_CMDCLIST_SEND_NL();
   73:       return TRUE;
B2:009E7F D3                SETB     C
B2:009E80 22                RET      
   74:     }
   75:   }
B2:009E81         ?C0003?ZW_CMD_CLASS_LIST:
B2:009E81 0E                INC      R6
B2:009E82 80E3              SJMP     ?C0001?ZW_CMD_CLASS_LIST
B2:009E84         ?C0002?ZW_CMD_CLASS_LIST:
   76:   ZW_DEBUG_CMDCLIST_SEND_STR("CheckCmdClass fail cmd: ");
   77:   ZW_DEBUG_CMDCLIST_SEND_NUM(cmdClass);
   78:   ZW_DEBUG_CMDCLIST_SEND_NUM(len);
   79:   ZW_DEBUG_CMDCLIST_SEND_NL();
   80:   return FALSE;
B2:009E84 C3                CLR      C
   81: }
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 627


B2:009E85 22                RET      
----- FUNCTION _CheckCmdClass (END) -------


----- FUNCTION _TransportCmdClassSupported (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  416: TransportCmdClassSupported(uint8_t commandClass,
  417:                            uint8_t command,
;---- Variable 'commandClass' assigned to Register 'R6' ----
B2:009E86 AE07              MOV      R6,AR7
;---- Variable 'eKey' assigned to Register 'R3' ----
;---- Variable 'command' assigned to Register 'R4' ----
B2:009E88 AC05              MOV      R4,AR5
  418:                            enum SECURITY_KEY eKey)
  419: {
  420:   return CmdClassSupported(eKey,
B2:009E8A AF03              MOV      R7,AR3
B2:009E8C AD06              MOV      R5,AR6
B2:009E8E AE04              MOV      R6,AR4
B2:009E90 AB06              MOV      R3,AR6
B2:009E92 C003              PUSH     AR3
B2:009E94 714F              ACALL    ?L?COM0245
B2:009E96 900008            MOV      DPTR,#08H
B2:009E99 1225F6            LCALL    ?C?PLDOPTR
B2:009E9C 904250            MOV      DPTR,#?_CmdClassSupported?BYTE+03H
B2:009E9F 714C              ACALL    ?L?COM0244
B2:009EA1 90000B            MOV      DPTR,#0BH
B2:009EA4 121FB9            LCALL    ?C?CLDOPTR
B2:009EA7 904253            MOV      DPTR,#?_CmdClassSupported?BYTE+06H
B2:009EAA F0                MOVX     @DPTR,A
B2:009EAB 903D99            MOV      DPTR,#m_AppInfo+03H
B2:009EAE 122552            LCALL    ?C?PLDXDATA
B2:009EB1 904254            MOV      DPTR,#?_CmdClassSupported?BYTE+07H
B2:009EB4 122572            LCALL    ?C?PSTXDATA
B2:009EB7 903D9C            MOV      DPTR,#m_AppInfo+06H
B2:009EBA E0                MOVX     A,@DPTR
B2:009EBB 904257            MOV      DPTR,#?_CmdClassSupported?BYTE+0AH
B2:009EBE F0                MOVX     @DPTR,A
B2:009EBF D003              POP      AR3
B2:009EC1 81EE              AJMP     _CmdClassSupported
  421:                            commandClass,
  422:                            command,
  423:                            m_AppInfo.u.pNifs->cmdClassListSecure,
  424:                            m_AppInfo.u.pNifs->cmdClassListSecureCount,
  425:                            m_AppInfo.activeNonsecureList.pList,
  426:                            m_AppInfo.activeNonsecureList.size);
----- FUNCTION _TransportCmdClassSupported (END) -------


----- FUNCTION _ApplicationSlaveCommandHandler (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 6139: ApplicationSlaveCommandHandler(
 6140:   BYTE  rxStatus,     /*IN  Frame header info */
;---- Variable 'rxStatus' assigned to Register 'R7' ----
;---- Variable 'sourceNode' assigned to Register 'R3' ----
;---- Variable 'destNode' assigned to Register 'R5' ----
 6141:   BYTE  destNode,     /* To whom it might concern - which node is to receive the frame */
 6142:   BYTE  sourceNode,   /*IN  Command sender Node ID */
 6143:   ZW_APPLICATION_TX_BUFFER  *pCmd, /*IN  Payload from the received frame,
 6144:                                          the command is the very first byte */
 6145:   BYTE   cmdLength)   /*IN  Number of command bytes including the command */
 6146: {
 6147:   /* ZW->PC: REQ | 0xA1 | rxStatus | destNode | sourceNode | cmdLength | pCmd[] */
 6148:   BYTE_IN_AR(compl_workbuf, 0) = rxStatus;
B2:009EC3 902001            MOV      DPTR,#compl_workbuf
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 628


B2:009EC6 126563            LCALL    ?L?COM00E9
B2:009EC9 EB                MOV      A,R3
B2:009ECA F0                MOVX     @DPTR,A
 6149:   BYTE_IN_AR(compl_workbuf, 1) = destNode;
 6150:   BYTE_IN_AR(compl_workbuf, 2) = sourceNode;
 6151:   if (cmdLength > BUF_SIZE_TX - 4)
B2:009ECB 904464            MOV      DPTR,#cmdLength
B2:009ECE E0                MOVX     A,@DPTR
B2:009ECF D3                SETB     C
B2:009ED0 94A4              SUBB     A,#0A4H
B2:009ED2 4003              JC       ?C0530?SERIALAPPL
 6152:   {
 6153:     cmdLength = BUF_SIZE_TX - 4;
B2:009ED4 74A4              MOV      A,#0A4H
B2:009ED6 F0                MOVX     @DPTR,A
 6154:   }
B2:009ED7         ?C0530?SERIALAPPL:
 6155:   BYTE_IN_AR(compl_workbuf, 3) = cmdLength;
B2:009ED7 904464            MOV      DPTR,#cmdLength
B2:009EDA E0                MOVX     A,@DPTR
B2:009EDB 902004            MOV      DPTR,#compl_workbuf+03H
B2:009EDE 91C2              ACALL    ?L?COM01E3
B2:009EE0         ?C0531?SERIALAPPL:
B2:009EE0 904464            MOV      DPTR,#cmdLength
B2:009EE3 11EB              ACALL    ?L?COM0080
B2:009EE5 501C              JNC      ?C0532?SERIALAPPL
 6156:   for (i = 0; i < cmdLength; i++)
 6157:   {
 6158:     BYTE_IN_AR(compl_workbuf, 4 + i) = *((BYTE_P)pCmd + i);
B2:009EE7 904461            MOV      DPTR,#pCmd
B2:009EEA 122552            LCALL    ?C?PLDXDATA
B2:009EED E9                MOV      A,R1
B2:009EEE 2E                ADD      A,R6
B2:009EEF 1252DD            LCALL    ?L?COM0009
B2:009EF2 FF                MOV      R7,A
B2:009EF3 7405              MOV      A,#LOW compl_workbuf+04H
B2:009EF5 2E                ADD      A,R6
B2:009EF6 F582              MOV      DPL,A
B2:009EF8 E4                CLR      A
B2:009EF9 3420              ADDC     A,#HIGH compl_workbuf+04H
B2:009EFB F583              MOV      DPH,A
B2:009EFD EF                MOV      A,R7
B2:009EFE 1293B9            LCALL    ?L?COM0033
B2:009F01 80DD              SJMP     ?C0531?SERIALAPPL
B2:009F03         ?C0532?SERIALAPPL:
 6159:   }
 6160: 
 6161:   RequestUnsolicited(FUNC_ID_APPLICATION_SLAVE_COMMAND_HANDLER, compl_workbuf, 4 + cmdLength);
B2:009F03 7C20              MOV      R4,#HIGH compl_workbuf
B2:009F05 7D01              MOV      R5,#LOW compl_workbuf
B2:009F07 904464            MOV      DPTR,#cmdLength
B2:009F0A E0                MOVX     A,@DPTR
B2:009F0B 2404              ADD      A,#04H
B2:009F0D FB                MOV      R3,A
B2:009F0E 7FA1              MOV      R7,#0A1H
B2:009F10 813C              AJMP     _RequestUnsolicited
----- FUNCTION _ApplicationSlaveCommandHandler (END) -------


----- FUNCTION _ApplicationSlaveUpdate (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 6234: ApplicationSlaveUpdate(
 6235:   BYTE bStatus,                     /* IN   Status of learn mode            */
B2:009F12 9044ED            MOV      DPTR,#pCmd
B2:009F15 122572            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 629


;---- Variable 'bNodeID' assigned to Register 'R5' ----
;---- Variable 'bStatus' assigned to Register 'R7' ----
 6236:   BYTE bNodeID,                     /* IN   Node id of node sending nodeinfo*/
 6237:   BYTE *pCmd,                       /* IN   Pointer to appl. node info      */
 6238:   BYTE bLen)                        /* IN   Node info length                */
 6239: {
 6240:   BYTE_IN_AR(compl_workbuf, 0) = bStatus;
B2:009F18 902001            MOV      DPTR,#compl_workbuf
B2:009F1B EF                MOV      A,R7
B2:009F1C F0                MOVX     @DPTR,A
 6241:   BYTE_IN_AR(compl_workbuf, 1) = bNodeID;
B2:009F1D A3                INC      DPTR
B2:009F1E ED                MOV      A,R5
B2:009F1F F0                MOVX     @DPTR,A
 6242:   /*  - Buffer boundary check */
 6243:   if (bLen > BUF_SIZE_TX - 3)
B2:009F20 9044F0            MOV      DPTR,#bLen
B2:009F23 E0                MOVX     A,@DPTR
B2:009F24 D3                SETB     C
B2:009F25 94A5              SUBB     A,#0A5H
B2:009F27 4003              JC       ?C0535?SERIALAPPL
 6244:   {
 6245:     bLen = BUF_SIZE_TX - 3;
B2:009F29 74A5              MOV      A,#0A5H
B2:009F2B F0                MOVX     @DPTR,A
 6246:   }
B2:009F2C         ?C0535?SERIALAPPL:
 6247:   BYTE_IN_AR(compl_workbuf, 2) = bLen;
B2:009F2C 9044F0            MOV      DPTR,#bLen
B2:009F2F E0                MOVX     A,@DPTR
B2:009F30 902003            MOV      DPTR,#compl_workbuf+02H
B2:009F33 91C2              ACALL    ?L?COM01E3
B2:009F35         ?C0536?SERIALAPPL:
B2:009F35 9044F0            MOV      DPTR,#bLen
B2:009F38 11EB              ACALL    ?L?COM0080
B2:009F3A 501C              JNC      ?C0537?SERIALAPPL
 6248:   for (i = 0; i < bLen; i++)
 6249:   {
 6250:     BYTE_IN_AR(compl_workbuf, 3 + i) = *(pCmd + i);
B2:009F3C 9044ED            MOV      DPTR,#pCmd
B2:009F3F 122552            LCALL    ?C?PLDXDATA
B2:009F42 E9                MOV      A,R1
B2:009F43 2E                ADD      A,R6
B2:009F44 1252DD            LCALL    ?L?COM0009
B2:009F47 FF                MOV      R7,A
B2:009F48 7404              MOV      A,#LOW compl_workbuf+03H
B2:009F4A 2E                ADD      A,R6
B2:009F4B F582              MOV      DPL,A
B2:009F4D E4                CLR      A
B2:009F4E 3420              ADDC     A,#HIGH compl_workbuf+03H
B2:009F50 F583              MOV      DPH,A
B2:009F52 EF                MOV      A,R7
B2:009F53 1293B9            LCALL    ?L?COM0033
B2:009F56 80DD              SJMP     ?C0536?SERIALAPPL
B2:009F58         ?C0537?SERIALAPPL:
 6251:   }
 6252:   RequestUnsolicited(FUNC_ID_ZW_APPLICATION_UPDATE, compl_workbuf, bLen + 3);
B2:009F58 7C20              MOV      R4,#HIGH compl_workbuf
B2:009F5A 7D01              MOV      R5,#LOW compl_workbuf
B2:009F5C 9044F0            MOV      DPTR,#bLen
B2:009F5F E0                MOVX     A,@DPTR
B2:009F60 2403              ADD      A,#03H
B2:009F62 FB                MOV      R3,A
B2:009F63 7F49              MOV      R7,#049H
B2:009F65 813C              AJMP     _RequestUnsolicited
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 630


----- FUNCTION _ApplicationSlaveUpdate (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_SendData (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  877: ZCB_ComplHandler_ZW_SendData(
  878:   BYTE txStatus,
B2:009F67 9045BE            MOV      DPTR,#txStatusReport
B2:009F6A 122572            LCALL    ?C?PSTXDATA
;---- Variable 'txStatus' assigned to Register 'R7' ----
  879:   TX_STATUS_TYPE *txStatusReport)                        /* IN   Transmit completion status  */
  880: {
  881:   BYTE bIdx = 0;
B2:009F6D E4                CLR      A
B2:009F6E 9045C1            MOV      DPTR,#bIdx
B2:009F71 F0                MOVX     @DPTR,A
  882:   BYTE_IN_AR(compl_workbuf, bIdx++) = funcID_ComplHandler_ZW_SendData;
B2:009F72 90246A            MOV      DPTR,#funcID_ComplHandler_ZW_SendData
B2:009F75 E0                MOVX     A,@DPTR
B2:009F76 9045C1            MOV      DPTR,#bIdx
B2:009F79 12A0F5            LCALL    ?L?COM039A
B2:009F7C 5159              ACALL    ?L?COM0052
B2:009F7E EE                MOV      A,R6
B2:009F7F F0                MOVX     @DPTR,A
  883:   BYTE_IN_AR(compl_workbuf, bIdx++) = txStatus;
B2:009F80 9045C1            MOV      DPTR,#bIdx
B2:009F83 5152              ACALL    ?L?COM0051
B2:009F85 EF                MOV      A,R7
B2:009F86 F0                MOVX     @DPTR,A
  884:   if (bTxStatusReportEnabled  /* Do HOST want txStatusReport */
B2:009F87 300E2E            JNB      bTxStatusReportEnabled,?C0016?SERIALAPPL
B2:009F8A 9045BE            MOV      DPTR,#txStatusReport
B2:009F8D 12A08C            LCALL    ?L?COM047D
B2:009F90 6026              JZ       ?C0016?SERIALAPPL
  885:       && txStatusReport)      /* Check if detailed info is available from protocol */
  886:   {
  887:     memcpy(&compl_workbuf[bIdx], (BYTE*)txStatusReport, sizeof(TX_STATUS_TYPE));
B2:009F92 9045C1            MOV      DPTR,#bIdx
B2:009F95 12A102            LCALL    ?L?COM01D2
B2:009F98 C003              PUSH     AR3
B2:009F9A C002              PUSH     AR2
B2:009F9C C001              PUSH     AR1
B2:009F9E 9045BE            MOV      DPTR,#txStatusReport
B2:009FA1 122552            LCALL    ?C?PLDXDATA
B2:009FA4 F1C9              ACALL    ?L?COM021E
B2:009FA6 D001              POP      AR1
B2:009FA8 D002              POP      AR2
B2:009FAA D003              POP      AR3
B2:009FAC 7F13              MOV      R7,#013H
B2:009FAE 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  888:     bIdx += sizeof(TX_STATUS_TYPE);
B2:009FB1 9045C1            MOV      DPTR,#bIdx
B2:009FB4 E0                MOVX     A,@DPTR
B2:009FB5 2413              ADD      A,#013H
B2:009FB7 F0                MOVX     @DPTR,A
  889:   }
B2:009FB8         ?C0016?SERIALAPPL:
  890:   Request(FUNC_ID_ZW_SEND_DATA, compl_workbuf, bIdx);
B2:009FB8 9045C1            MOV      DPTR,#bIdx
B2:009FBB F1CF              ACALL    ?L?COM03CB
B2:009FBD 7F13              MOV      R7,#013H
B2:009FBF A1AD              AJMP     _Request
----- FUNCTION _ZCB_ComplHandler_ZW_SendData (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 631


----- FUNCTION ?L?COM021D (BEGIN) -----
B2:009FC1 FF                MOV      R7,A
B2:009FC2 E0                MOVX     A,@DPTR
B2:009FC3 FC                MOV      R4,A
B2:009FC4 A3                INC      DPTR
B2:009FC5 E0                MOVX     A,@DPTR
B2:009FC6 AA04              MOV      R2,AR4
B2:009FC8 F9                MOV      R1,A
B2:009FC9         ?L?COM021E:
B2:009FC9 904423            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
B2:009FCC 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM021D (END) -------


----- FUNCTION ?L?COM03CB (BEGIN) -----
B2:009FCF 7C20              MOV      R4,#HIGH compl_workbuf
B2:009FD1 7D01              MOV      R5,#LOW compl_workbuf
B2:009FD3 E0                MOVX     A,@DPTR
B2:009FD4 FB                MOV      R3,A
B2:009FD5 22                RET      
----- FUNCTION ?L?COM03CB (END) -------


----- FUNCTION ?L?COM03CC (BEGIN) -----
B2:009FD6 E0                MOVX     A,@DPTR
B2:009FD7 04                INC      A
B2:009FD8 F0                MOVX     @DPTR,A
B2:009FD9 C3                CLR      C
B2:009FDA 9404              SUBB     A,#04H
B2:009FDC 22                RET      
----- FUNCTION ?L?COM03CC (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_SendNodeInformation (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  858: ZCB_ComplHandler_ZW_SendNodeInformation(
;---- Variable 'txStatus' assigned to Register 'R7' ----
B2:009FDD 9027A4            MOV      DPTR,#funcID_ComplHandler_ZW_SendNodeInformation
B2:009FE0 12A061            LCALL    ?L?COM01C5
B2:009FE3 7F12              MOV      R7,#012H
B2:009FE5 A1AD              AJMP     _Request
  859:   BYTE txStatus,                        /* IN   Transmit completion status  */
  860:   TX_STATUS_TYPE *txStatusReport)
  861: {
  862:   UNUSED(txStatusReport);
  863:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_ZW_SendNodeInformation;
  864:   BYTE_IN_AR(compl_workbuf, 1) = txStatus;
----- FUNCTION _ZCB_ComplHandler_ZW_SendNodeInformation (END) -------


----- FUNCTION _Transport_OnLearnCompleted (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  358: uint8_t Transport_OnLearnCompleted(uint8_t nodeID)
  359: {
;---- Variable 'nodeID' assigned to Register 'R7' ----
  360:   SetupActiveNIF(nodeID);
  361: #ifndef NON_BATT
B2:009FE7 91C9              ACALL    _SetupActiveNIF
  362:   ZAF_pm_KeepAwakeAuto();
  363: #endif
  364: 
  365:   return TRUE;
B2:009FE9 7F01              MOV      R7,#01H
  366: }
B2:009FEB 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 632


----- FUNCTION _Transport_OnLearnCompleted (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_SendDataEx (BEGIN) -----
 FILE: 'SERIALAPPL.C'
  902: ZCB_ComplHandler_ZW_SendDataEx(
  903:   BYTE txStatus,
B2:009FEC 9045C2            MOV      DPTR,#txStatusReport
B2:009FEF 122572            LCALL    ?C?PSTXDATA
;---- Variable 'txStatus' assigned to Register 'R7' ----
  904:   TX_STATUS_TYPE *txStatusReport)                        /* IN   Transmit completion status  */
  905: {
  906:   BYTE bIdx = 0;
B2:009FF2 E4                CLR      A
B2:009FF3 9045C5            MOV      DPTR,#bIdx
B2:009FF6 F0                MOVX     @DPTR,A
  907:   BYTE_IN_AR(compl_workbuf, bIdx++) = funcID_ComplHandler_ZW_SendDataEx;
B2:009FF7 90215E            MOV      DPTR,#funcID_ComplHandler_ZW_SendDataEx
B2:009FFA E0                MOVX     A,@DPTR
B2:009FFB FE                MOV      R6,A
B2:009FFC 9045C5            MOV      DPTR,#bIdx
B2:009FFF 12A0F6            LCALL    ?L?COM039B
B2:00A002 129A59            LCALL    ?L?COM0052
B2:00A005 EE                MOV      A,R6
B2:00A006 F0                MOVX     @DPTR,A
  908:   BYTE_IN_AR(compl_workbuf, bIdx++) = txStatus;
B2:00A007 9045C5            MOV      DPTR,#bIdx
B2:00A00A 129A52            LCALL    ?L?COM0051
B2:00A00D EF                MOV      A,R7
B2:00A00E F0                MOVX     @DPTR,A
  909:   if (bTxStatusReportEnabled  /* Do HOST want txStatusReport */
B2:00A00F 300E2D            JNB      bTxStatusReportEnabled,?C0018?SERIALAPPL
B2:00A012 9045C2            MOV      DPTR,#txStatusReport
B2:00A015 118C              ACALL    ?L?COM047D
B2:00A017 6026              JZ       ?C0018?SERIALAPPL
  910:       && txStatusReport)      /* Check if detailed info is available from protocol */
  911:   {
  912:     memcpy(&compl_workbuf[bIdx], (BYTE*)txStatusReport, sizeof(TX_STATUS_TYPE));
B2:00A019 9045C5            MOV      DPTR,#bIdx
B2:00A01C 3102              ACALL    ?L?COM01D2
B2:00A01E C003              PUSH     AR3
B2:00A020 C002              PUSH     AR2
B2:00A022 C001              PUSH     AR1
B2:00A024 9045C2            MOV      DPTR,#txStatusReport
B2:00A027 122552            LCALL    ?C?PLDXDATA
B2:00A02A 129FC9            LCALL    ?L?COM021E
B2:00A02D D001              POP      AR1
B2:00A02F D002              POP      AR2
B2:00A031 D003              POP      AR3
B2:00A033 7F13              MOV      R7,#013H
B2:00A035 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
  913:     bIdx += sizeof(TX_STATUS_TYPE);
B2:00A038 9045C5            MOV      DPTR,#bIdx
B2:00A03B E0                MOVX     A,@DPTR
B2:00A03C 2413              ADD      A,#013H
B2:00A03E F0                MOVX     @DPTR,A
  914:   }
B2:00A03F         ?C0018?SERIALAPPL:
  915:   Request(FUNC_ID_ZW_SEND_DATA_EX, compl_workbuf, bIdx);
B2:00A03F 7C20              MOV      R4,#HIGH compl_workbuf
B2:00A041 7D01              MOV      R5,#LOW compl_workbuf
B2:00A043 9045C5            MOV      DPTR,#bIdx
B2:00A046 E0                MOVX     A,@DPTR
B2:00A047 FB                MOV      R3,A
B2:00A048 7F0E              MOV      R7,#0EH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 633


B2:00A04A 029DAD            LJMP     _Request
----- FUNCTION _ZCB_ComplHandler_ZW_SendDataEx (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_SendDataMultiEx (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1007: ZCB_ComplHandler_ZW_SendDataMultiEx(
 1008:   BYTE txStatus)
;---- Variable 'txStatus' assigned to Register 'R7' ----
 1009: {
 1010:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_ZW_SendDataMultiEx;
B2:00A04D 902163            MOV      DPTR,#funcID_ComplHandler_ZW_SendDataMultiEx
B2:00A050 1161              ACALL    ?L?COM01C5
B2:00A052 7F0F              MOV      R7,#0FH
B2:00A054 029DAD            LJMP     _Request
 1011:   BYTE_IN_AR(compl_workbuf, 1) = txStatus;
----- FUNCTION _ZCB_ComplHandler_ZW_SendDataMultiEx (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_SendDataMulti (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1060: ZCB_ComplHandler_ZW_SendDataMulti(
 1061:   BYTE txStatus)                        /* IN   Transmit completion status  */
;---- Variable 'txStatus' assigned to Register 'R7' ----
 1062: {
 1063:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_ZW_SendDataMulti;
B2:00A057 9024C7            MOV      DPTR,#funcID_ComplHandler_ZW_SendDataMulti
B2:00A05A 1161              ACALL    ?L?COM01C5
B2:00A05C 7F14              MOV      R7,#014H
B2:00A05E 029DAD            LJMP     _Request
 1064:   BYTE_IN_AR(compl_workbuf, 1) = txStatus;
----- FUNCTION _ZCB_ComplHandler_ZW_SendDataMulti (END) -------


----- FUNCTION ?L?COM01C5 (BEGIN) -----
B2:00A061 E0                MOVX     A,@DPTR
B2:00A062 902001            MOV      DPTR,#compl_workbuf
B2:00A065 F0                MOVX     @DPTR,A
B2:00A066 A3                INC      DPTR
B2:00A067 EF                MOV      A,R7
B2:00A068 F0                MOVX     @DPTR,A
B2:00A069 7C20              MOV      R4,#HIGH compl_workbuf
B2:00A06B 7D01              MOV      R5,#LOW compl_workbuf
B2:00A06D 7B02              MOV      R3,#02H
B2:00A06F 22                RET      
----- FUNCTION ?L?COM01C5 (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_RequestNodeInfo (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1077: ZCB_ComplHandler_ZW_RequestNodeInfo(
 1078:   BYTE txStatus,                        /* IN   Transmit completion status  */
;---- Variable 'txStatus' assigned to Register 'R7' ----
 1079:   TX_STATUS_TYPE *txStatusReport)
 1080: {
 1081:   /* */
 1082:   UNUSED(txStatusReport);
 1083:   if (txStatus != TRANSMIT_COMPLETE_OK)
B2:00A070 EF                MOV      A,R7
B2:00A071 600E              JZ       ?C0023?SERIALAPPL
 1084:   {
 1085: #ifdef ZW_CONTROLLER
 1086:     ApplicationControllerUpdate(UPDATE_STATE_NODE_INFO_REQ_FAILED, 0, NULL, 0);
 1087: #else
 1088:     ApplicationSlaveUpdate(UPDATE_STATE_NODE_INFO_REQ_FAILED, 0, NULL, 0);
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 634


B2:00A073 1247C7            LCALL    ?L?COM0359
B2:00A076 E4                CLR      A
B2:00A077 9044F0            MOV      DPTR,#?_ApplicationSlaveUpdate?BYTE+05H
B2:00A07A F0                MOVX     @DPTR,A
B2:00A07B FD                MOV      R5,A
B2:00A07C 7F81              MOV      R7,#081H
B2:00A07E 129F12            LCALL    _ApplicationSlaveUpdate
 1089: #endif
 1090:   }
 1091: }
B2:00A081         ?C0023?SERIALAPPL:
B2:00A081 22                RET      
----- FUNCTION _ZCB_ComplHandler_ZW_RequestNodeInfo (END) -------


----- FUNCTION ZCB_ComplHandler_ZW_SetDefault (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1149: ZCB_ComplHandler_ZW_SetDefault(void)    /* IN   Nothing */
B2:00A082 902441            MOV      DPTR,#funcID_ComplHandler_ZW_SetDefault
B2:00A085 315D              ACALL    ?L?COM0413
B2:00A087 7F42              MOV      R7,#042H
B2:00A089 029DAD            LJMP     _Request
 1150: {
 1151:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_ZW_SetDefault;
----- FUNCTION ZCB_ComplHandler_ZW_SetDefault (END) -------


----- FUNCTION ?L?COM047D (BEGIN) -----
B2:00A08C 122552            LCALL    ?C?PLDXDATA
B2:00A08F EA                MOV      A,R2
B2:00A090 49                ORL      A,R1
B2:00A091 4B                ORL      A,R3
B2:00A092 22                RET      
----- FUNCTION ?L?COM047D (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_netWork_Management (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1352: ZCB_ComplHandler_ZW_netWork_Management(
 1353:   BYTE bStatus,                         /* IN   Transmit completion status  */
B2:00A093 9045C6            MOV      DPTR,#txStatusReport
B2:00A096 122572            LCALL    ?C?PSTXDATA
;---- Variable 'bStatus' assigned to Register 'R7' ----
 1354:   TX_STATUS_TYPE *txStatusReport)       /* IN Detailed transmit information */
 1355: {
 1356:   BYTE bIdx = 0;
B2:00A099 E4                CLR      A
B2:00A09A 9045C9            MOV      DPTR,#bIdx
B2:00A09D F0                MOVX     @DPTR,A
 1357:   BYTE_IN_AR(compl_workbuf, bIdx++) = funcID_ComplHandler_netWork_Management;
B2:00A09E 902156            MOV      DPTR,#funcID_ComplHandler_netWork_Management
B2:00A0A1 E0                MOVX     A,@DPTR
B2:00A0A2 9045C9            MOV      DPTR,#bIdx
B2:00A0A5 11F5              ACALL    ?L?COM039A
B2:00A0A7 129A59            LCALL    ?L?COM0052
B2:00A0AA EE                MOV      A,R6
B2:00A0AB F0                MOVX     @DPTR,A
 1358:   BYTE_IN_AR(compl_workbuf, bIdx++) = bStatus;
B2:00A0AC 9045C9            MOV      DPTR,#bIdx
B2:00A0AF 129A52            LCALL    ?L?COM0051
B2:00A0B2 EF                MOV      A,R7
B2:00A0B3 F0                MOVX     @DPTR,A
 1359:   if (bTxStatusReportEnabled
B2:00A0B4 300E2D            JNB      bTxStatusReportEnabled,?C0025?SERIALAPPL
B2:00A0B7 9045C6            MOV      DPTR,#txStatusReport
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 635


B2:00A0BA 118C              ACALL    ?L?COM047D
B2:00A0BC 6026              JZ       ?C0025?SERIALAPPL
 1360:       && txStatusReport)  /* Check if detailed info is available from protocol */
 1361:   {
 1362:     memcpy(&compl_workbuf[bIdx], (BYTE*)txStatusReport, sizeof(TX_STATUS_TYPE));
B2:00A0BE 9045C9            MOV      DPTR,#bIdx
B2:00A0C1 3102              ACALL    ?L?COM01D2
B2:00A0C3 C003              PUSH     AR3
B2:00A0C5 C002              PUSH     AR2
B2:00A0C7 C001              PUSH     AR1
B2:00A0C9 9045C6            MOV      DPTR,#txStatusReport
B2:00A0CC 122552            LCALL    ?C?PLDXDATA
B2:00A0CF 129FC9            LCALL    ?L?COM021E
B2:00A0D2 D001              POP      AR1
B2:00A0D4 D002              POP      AR2
B2:00A0D6 D003              POP      AR3
B2:00A0D8 7F13              MOV      R7,#013H
B2:00A0DA 121BAB            LCALL    ?INTERBANK_TABLE?___ZW_memcpy
 1363:     bIdx += sizeof(TX_STATUS_TYPE);
B2:00A0DD 9045C9            MOV      DPTR,#bIdx
B2:00A0E0 E0                MOVX     A,@DPTR
B2:00A0E1 2413              ADD      A,#013H
B2:00A0E3 F0                MOVX     @DPTR,A
 1364:   }
B2:00A0E4         ?C0025?SERIALAPPL:
 1365:   Request(management_Func_ID, compl_workbuf, bIdx);
B2:00A0E4 902000            MOV      DPTR,#management_Func_ID
B2:00A0E7 E0                MOVX     A,@DPTR
B2:00A0E8 FF                MOV      R7,A
B2:00A0E9 7C20              MOV      R4,#HIGH compl_workbuf
B2:00A0EB 7D01              MOV      R5,#LOW compl_workbuf
B2:00A0ED 9045C9            MOV      DPTR,#bIdx
B2:00A0F0 E0                MOVX     A,@DPTR
B2:00A0F1 FB                MOV      R3,A
B2:00A0F2 029DAD            LJMP     _Request
----- FUNCTION _ZCB_ComplHandler_ZW_netWork_Management (END) -------


----- FUNCTION ?L?COM039A (BEGIN) -----
B2:00A0F5 FE                MOV      R6,A
B2:00A0F6         ?L?COM039B:
B2:00A0F6 E0                MOVX     A,@DPTR
B2:00A0F7 FD                MOV      R5,A
B2:00A0F8 04                INC      A
B2:00A0F9 F0                MOVX     @DPTR,A
B2:00A0FA 7401              MOV      A,#LOW compl_workbuf
B2:00A0FC 2D                ADD      A,R5
B2:00A0FD 22                RET      
----- FUNCTION ?L?COM039A (END) -------


----- FUNCTION ?L?COM01D1 (BEGIN) -----
B2:00A0FE F0                MOVX     @DPTR,A
B2:00A0FF 9024C6            MOV      DPTR,#i
B2:00A102         ?L?COM01D2:
B2:00A102 E0                MOVX     A,@DPTR
B2:00A103 2401              ADD      A,#LOW compl_workbuf
B2:00A105 F9                MOV      R1,A
B2:00A106 E4                CLR      A
B2:00A107 3420              ADDC     A,#HIGH compl_workbuf
B2:00A109 FA                MOV      R2,A
B2:00A10A 7B01              MOV      R3,#01H
B2:00A10C 22                RET      
----- FUNCTION ?L?COM01D1 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 636



----- FUNCTION _ZCB_ComplHandler_ZW_SetLearnMode (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1378: ZCB_ComplHandler_ZW_SetLearnMode(
 1379:   BYTE bStatus,                         /*IN  ZW_SetLearnMode status        */
;---- Variable 'bNodeID' assigned to Register 'R5' ----
;---- Variable 'bStatus' assigned to Register 'R7' ----
 1380:   BYTE bNodeID)                         /*IN  Node ID                       */
 1381: {
 1382:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_ZW_SetLearnMode;
B2:00A10D 9027CD            MOV      DPTR,#funcID_ComplHandler_ZW_SetLearnMode
B2:00A110 E0                MOVX     A,@DPTR
B2:00A111 902001            MOV      DPTR,#compl_workbuf
B2:00A114 F0                MOVX     @DPTR,A
 1383:   BYTE_IN_AR(compl_workbuf, 1) = bStatus;
B2:00A115 A3                INC      DPTR
B2:00A116 126E7B            LCALL    ?L?COM02C1
 1384:   BYTE_IN_AR(compl_workbuf, 2) = bNodeID;
 1385:   /* For safty we transmit len = 0, to indicate that no data follows */
 1386:   BYTE_IN_AR(compl_workbuf, 3) = 0;
 1387:   Request(FUNC_ID_ZW_SET_LEARN_MODE, compl_workbuf, 4);
B2:00A119 7C20              MOV      R4,#HIGH compl_workbuf
B2:00A11B 7D01              MOV      R5,#LOW compl_workbuf
B2:00A11D 7B04              MOV      R3,#04H
B2:00A11F 7F50              MOV      R7,#050H
B2:00A121 029DAD            LJMP     _Request
----- FUNCTION _ZCB_ComplHandler_ZW_SetLearnMode (END) -------


----- FUNCTION _ApplicationNetworkLearnModeCompleted (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5840: ApplicationNetworkLearnModeCompleted(
 5841:   BYTE bNodeID)                 /*IN The nodeID assigned*/
B2:00A124 9046C3            MOV      DPTR,#bNodeID
B2:00A127 EF                MOV      A,R7
B2:00A128 F0                MOVX     @DPTR,A
 5842: {
 5843:   /* If bNodeID == 0xff.. learn mode failed */
 5844:   if (bNodeID <= ZW_MAX_NODES)
B2:00A129 D3                SETB     C
B2:00A12A 94E8              SUBB     A,#0E8H
B2:00A12C 5005              JNC      ?C0507?SERIALAPPL
 5845:   {
 5846:     appNodeId = bNodeID;
B2:00A12E E0                MOVX     A,@DPTR
B2:00A12F 9027C8            MOV      DPTR,#appNodeId
B2:00A132 F0                MOVX     @DPTR,A
 5847:   }
B2:00A133         ?C0507?SERIALAPPL:
 5848: #if SUPPORT_ZW_SET_LEARN_MODE
 5849:   ZCB_ComplHandler_ZW_SetLearnMode((APPLICATION_NETWORK_LEARN_MODE_COMPLETED_SMART_START_IN_PROGRESS == bNodeID)
B2:00A133 9046C3            MOV      DPTR,#bNodeID
B2:00A136 E0                MOVX     A,@DPTR
B2:00A137 FD                MOV      R5,A
B2:00A138 7F00              MOV      R7,#00H
B2:00A13A B4FE02            CJNE     A,#0FEH,?C0508?SERIALAPPL
B2:00A13D 7F01              MOV      R7,#01H
B2:00A13F         ?C0508?SERIALAPPL:
B2:00A13F         ?C0509?SERIALAPPL:
B2:00A13F 310D              ACALL    _ZCB_ComplHandler_ZW_SetLearnMode
 5850:                                    ? ASSIGN_NODEID_DONE :
 5851:                                      ASSIGN_COMPLETE, bNodeID);
 5852: #endif
 5853:   Transport_OnLearnCompleted(bNodeID);
B2:00A141 9046C3            MOV      DPTR,#bNodeID
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 637


B2:00A144 E0                MOVX     A,@DPTR
B2:00A145 FF                MOV      R7,A
B2:00A146 029FE7            LJMP     _Transport_OnLearnCompleted
----- FUNCTION _ApplicationNetworkLearnModeCompleted (END) -------


----- FUNCTION _ZCB_ComplHandler_ZW_SendTestFrame (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1437: ZCB_ComplHandler_ZW_SendTestFrame(
;---- Variable 'txStatus' assigned to Register 'R7' ----
B2:00A149 90279E            MOV      DPTR,#funcID_ComplHandler_ZW_SendTestFrame
B2:00A14C 1161              ACALL    ?L?COM01C5
B2:00A14E 7FBE              MOV      R7,#0BEH
B2:00A150 029DAD            LJMP     _Request
 1438:   BYTE txStatus,
 1439:   TX_STATUS_TYPE *txStatusReport)
 1440: {
 1441:   UNUSED(txStatusReport);
 1442:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_ZW_SendTestFrame;
 1443:   BYTE_IN_AR(compl_workbuf, 1) = txStatus;
----- FUNCTION _ZCB_ComplHandler_ZW_SendTestFrame (END) -------


----- FUNCTION ZCB_ComplHandler_MemoryPutBuffer (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1490: ZCB_ComplHandler_MemoryPutBuffer(void)  /* IN   Nothing */
B2:00A153 902460            MOV      DPTR,#funcID_ComplHandler_MemoryPutBuffer
B2:00A156 315D              ACALL    ?L?COM0413
B2:00A158 7F24              MOV      R7,#024H
B2:00A15A 029DAD            LJMP     _Request
 1491: {
 1492:   BYTE_IN_AR(compl_workbuf, 0) = funcID_ComplHandler_MemoryPutBuffer;
----- FUNCTION ZCB_ComplHandler_MemoryPutBuffer (END) -------


----- FUNCTION ?L?COM0413 (BEGIN) -----
B2:00A15D E0                MOVX     A,@DPTR
B2:00A15E 902001            MOV      DPTR,#compl_workbuf
B2:00A161 F0                MOVX     @DPTR,A
B2:00A162 7C20              MOV      R4,#HIGH compl_workbuf
B2:00A164 7D01              MOV      R5,#LOW compl_workbuf
B2:00A166 7B01              MOV      R3,#01H
B2:00A168 22                RET      
----- FUNCTION ?L?COM0413 (END) -------


----- FUNCTION DoRespond (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1586: DoRespond(void)
 1587: {
 1588:   Respond(serFrameCmd, &retVal, 1);
 1589: }
B2:00A169 903409            MOV      DPTR,#serBuf+02H
B2:00A16C E0                MOVX     A,@DPTR
B2:00A16D FF                MOV      R7,A
B2:00A16E 7C27              MOV      R4,#HIGH retVal
B2:00A170 7D9F              MOV      R5,#LOW retVal
B2:00A172 7B01              MOV      R3,#01H
B2:00A174 029E40            LJMP     _Respond
----- FUNCTION DoRespond (END) -------


----- FUNCTION _DoRespond_workbuf (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 1593: DoRespond_workbuf(
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 638


 1594:   BYTE cnt
;---- Variable 'cnt' assigned to Register 'R6' ----
B2:00A177 AE07              MOV      R6,AR7
 1595: )
 1596: {
 1597:   Respond(serFrameCmd, compl_workbuf, cnt);
B2:00A179 903409            MOV      DPTR,#serBuf+02H
B2:00A17C E0                MOVX     A,@DPTR
B2:00A17D FF                MOV      R7,A
B2:00A17E 7C20              MOV      R4,#HIGH compl_workbuf
B2:00A180 7D01              MOV      R5,#LOW compl_workbuf
B2:00A182 AB06              MOV      R3,AR6
B2:00A184 029E40            LJMP     _Respond
----- FUNCTION _DoRespond_workbuf (END) -------


----- FUNCTION ZCB_powerManagementPoweredUpPinActive (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2026: ZCB_powerManagementPoweredUpPinActive(void)
 2027: {
 2028:   if (poweredUp)
 2029:   {
B2:00A187 300C0B            JNB      poweredUp,?C0052?SERIALAPPL
 2030:     if (ZW_PortPinGet(powerManagementPoweredUp.bPin) == powerManagementPoweredUp.bEnableLevel)
 2031:     {
B2:00A18A 31BA              ACALL    ?L?COM0330
B2:00A18C 902464            MOV      DPTR,#powerManagementPoweredUp+01H
B2:00A18F E0                MOVX     A,@DPTR
B2:00A190 6F                XRL      A,R7
B2:00A191 7017              JNZ      ?C0054?SERIALAPPL
 2032:       poweredUpTransition = 0;
 2033:     }
 2034:   }
 2035:   else
B2:00A193 8011              SJMP     ?C0547?SERIALAPPL
B2:00A195         ?C0052?SERIALAPPL:
 2036:   {
 2037:     if (ZW_PortPinGet(powerManagementPoweredUp.bPin) == !powerManagementPoweredUp.bEnableLevel)
B2:00A195 31BA              ACALL    ?L?COM0330
B2:00A197 902464            MOV      DPTR,#powerManagementPoweredUp+01H
B2:00A19A E0                MOVX     A,@DPTR
B2:00A19B 7E00              MOV      R6,#00H
B2:00A19D 7002              JNZ      ?C0056?SERIALAPPL
B2:00A19F 7E01              MOV      R6,#01H
B2:00A1A1         ?C0056?SERIALAPPL:
B2:00A1A1         ?C0057?SERIALAPPL:
B2:00A1A1 EE                MOV      A,R6
B2:00A1A2 B50705            CJNE     A,AR7,?C0054?SERIALAPPL
 2038:     {
 2039:       poweredUpTransition = 0;
B2:00A1A5 E4                CLR      A
B2:00A1A6         
B2:00A1A6 9027A1            MOV      DPTR,#poweredUpTransition
B2:00A1A9 F0                MOVX     @DPTR,A
 2040:     }
 2041:   }
B2:00A1AA         ?C0054?SERIALAPPL:
 2042:   if (++poweredUpTransition >= PM_PIN_IN_DEBOUNCE)
B2:00A1AA 9027A1            MOV      DPTR,#poweredUpTransition
B2:00A1AD E0                MOVX     A,@DPTR
B2:00A1AE 04                INC      A
B2:00A1AF F0                MOVX     @DPTR,A
B2:00A1B0 C3                CLR      C
B2:00A1B1 9402              SUBB     A,#02H
B2:00A1B3 4004              JC       ?C0059?SERIALAPPL
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 639


 2043:   {
 2044:     poweredUp = !poweredUp;
B2:00A1B5 B20C              CPL      poweredUp
 2045:     poweredUpTransition = 0;
B2:00A1B7 E4                CLR      A
B2:00A1B8 F0                MOVX     @DPTR,A
 2046:   }
 2047: }
B2:00A1B9         ?C0059?SERIALAPPL:
B2:00A1B9 22                RET      
----- FUNCTION ZCB_powerManagementPoweredUpPinActive (END) -------


----- FUNCTION ?L?COM0330 (BEGIN) -----
B2:00A1BA 902463            MOV      DPTR,#powerManagementPoweredUp
B2:00A1BD         ?L?COM0331:
B2:00A1BD E0                MOVX     A,@DPTR
B2:00A1BE FF                MOV      R7,A
B2:00A1BF 126D32            LCALL    _ZW_PortPinGet
B2:00A1C2 E4                CLR      A
B2:00A1C3 33                RLC      A
B2:00A1C4 FF                MOV      R7,A
B2:00A1C5 22                RET      
----- FUNCTION ?L?COM0330 (END) -------


----- FUNCTION _ApplicationCommandHandler (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  370: ApplicationCommandHandler(
  371:   ZW_APPLICATION_TX_BUFFER *pCmd, /* IN Payload from the received frame, */
;---- Variable 'cmdLength' assigned to Register 'R5' ----
;---- Variable 'pCmd' assigned to Register 'R1/R2/R3' ----
  372:                                   /*    the command is the very first byte */
  373:   BYTE cmdLength,                 /* IN Number of command bytes including the command */
  374:   RECEIVE_OPTIONS_TYPE *rxOpt)    /* rxOpt struct to use (may be partially filled out if
  375:                                      parsing encapsulated command */
  376: {
  377:   ZW_DEBUG_SECURITY_SEND_STR("\r\nAppCmdH ");
  378:   ZW_DEBUG_SECURITY_SEND_BYTE(' ');
  379:   ZW_DEBUG_SECURITY_SEND_NUM(rxOpt->securityKey);
  380:   ZW_DEBUG_SECURITY_SEND_BYTE(' ');
  381:   ZW_DEBUG_SECURITY_SEND_NUM(pCmd->ZW_Common.cmdClass);
  382:   ZW_DEBUG_SECURITY_SEND_NUM(pCmd->ZW_Common.cmd);
  383:   ZW_DEBUG_SECURITY_SEND_STR("\r\nm_AppInfo size");
  384:   ZW_DEBUG_SECURITY_SEND_NUM(m_AppInfo.u.pNifs->cmdClassListSecureCount);
  385:   ZW_DEBUG_SECURITY_SEND_NUM(m_AppInfo.activeNonsecureList.size);
  386:   ZW_DEBUG_SECURITY_SEND_NL();
  387: 
  388: #ifndef ACCEPT_ALL_CMD_CLASSES
  389:   /* Check if cmd Class are supported in current mode (unsecure or secure) */
  390:   if (TRUE == CmdClassSupported(rxOpt->securityKey,
  391:                                 pCmd->ZW_Common.cmdClass,
  392:                                 pCmd->ZW_Common.cmd,
  393:                                 m_AppInfo.u.pNifs->cmdClassListSecure,
  394:                                 m_AppInfo.u.pNifs->cmdClassListSecureCount,
  395:                                 m_AppInfo.activeNonsecureList.pList,
  396:                                 m_AppInfo.activeNonsecureList.size))
  397: #endif /* ACCEPT_ALL_CMD_CLASSES */
  398:   {
  399: 		Transport_ApplicationCommandHandler(pCmd, cmdLength, rxOpt);
B2:00A1C6 C003              PUSH     AR3
B2:00A1C8 C002              PUSH     AR2
B2:00A1CA C001              PUSH     AR1
B2:00A1CC 904470            MOV      DPTR,#rxOpt
B2:00A1CF 122552            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 640


B2:00A1D2 90445B            MOV      DPTR,#?_Transport_ApplicationCommandHandler?BYTE+04H
B2:00A1D5 122572            LCALL    ?C?PSTXDATA
B2:00A1D8 D001              POP      AR1
B2:00A1DA D002              POP      AR2
B2:00A1DC D003              POP      AR3
B2:00A1DE 029952            LJMP     _Transport_ApplicationCommandHandler
----- FUNCTION _ApplicationCommandHandler (END) -------


----- FUNCTION ZCB_PowerManagementWakeUpOnExternalActive (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2052: ZCB_PowerManagementWakeUpOnExternalActive(void)
 2053: {
 2054:   if (!wakeUpOnExternal)
 2055:   {
B2:00A1E1 200F18            JB       wakeUpOnExternal,?C0060?SERIALAPPL
 2056:     if (ZW_PortPinGet(powerManagementWakeUpOnExternal.bPin) == !powerManagementWakeUpOnExternal.bEnableLevel)
 2057:     {
B2:00A1E4 902153            MOV      DPTR,#powerManagementWakeUpOnExternal
B2:00A1E7 31BD              ACALL    ?L?COM0331
B2:00A1E9 902154            MOV      DPTR,#powerManagementWakeUpOnExternal+01H
B2:00A1EC E0                MOVX     A,@DPTR
B2:00A1ED 7E00              MOV      R6,#00H
B2:00A1EF 7002              JNZ      ?C0062?SERIALAPPL
B2:00A1F1 7E01              MOV      R6,#01H
B2:00A1F3         ?C0062?SERIALAPPL:
B2:00A1F3         ?C0063?SERIALAPPL:
B2:00A1F3 EE                MOV      A,R6
B2:00A1F4 B50705            CJNE     A,AR7,?C0060?SERIALAPPL
 2058:       wakeUpOnExternalTransition = 0;
 2059:     }
B2:00A1F7 E4                CLR      A
B2:00A1F8 902164            MOV      DPTR,#wakeUpOnExternalTransition
B2:00A1FB F0                MOVX     @DPTR,A
 2060:   }
 2061:   if (++wakeUpOnExternalTransition >= PM_PIN_IN_DEBOUNCE)
B2:00A1FC         ?C0060?SERIALAPPL:
 2062:   {
B2:00A1FC 902164            MOV      DPTR,#wakeUpOnExternalTransition
B2:00A1FF E0                MOVX     A,@DPTR
B2:00A200 04                INC      A
B2:00A201 F0                MOVX     @DPTR,A
B2:00A202 C3                CLR      C
B2:00A203 9402              SUBB     A,#02H
B2:00A205 400A              JC       ?C0065?SERIALAPPL
 2063:     wakeUpOnExternal = TRUE;
 2064:     ZW_TIMER_CANCEL(wakeUpOnExternalTimerHandle);
B2:00A207 D20F              SETB     wakeUpOnExternal
 2065:     wakeUpOnExternalTimerHandle = -1;
B2:00A209 90244F            MOV      DPTR,#wakeUpOnExternalTimerHandle
B2:00A20C E0                MOVX     A,@DPTR
B2:00A20D FF                MOV      R7,A
B2:00A20E 5112              ACALL    ?L?COM0397
B2:00A210 F0                MOVX     @DPTR,A
 2066:   }
 2067: }
B2:00A211         ?C0065?SERIALAPPL:
B2:00A211 22                RET      
----- FUNCTION ZCB_PowerManagementWakeUpOnExternalActive (END) -------


----- FUNCTION ?L?COM0397 (BEGIN) -----
B2:00A212 1244EE            LCALL    _TimerCancel
B2:00A215 90244F            MOV      DPTR,#wakeUpOnExternalTimerHandle
B2:00A218 74FF              MOV      A,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 641


B2:00A21A 22                RET      
----- FUNCTION ?L?COM0397 (END) -------


----- FUNCTION ZCB_PowerManagementWakeUpOnTimerHandler (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2072: ZCB_PowerManagementWakeUpOnTimerHandler(void)
 2073: {
 2074:   if (0 == --wakeUpOnTimerRes)
 2075:   {
B2:00A21B 90247C            MOV      DPTR,#wakeUpOnTimerRes
B2:00A21E E0                MOVX     A,@DPTR
B2:00A21F 14                DEC      A
B2:00A220 F0                MOVX     @DPTR,A
B2:00A221 7031              JNZ      ?C0073?SERIALAPPL
 2076:     if (0 == --wakeUpOnTimerCount)
 2077:     {
B2:00A223 90243D            MOV      DPTR,#wakeUpOnTimerCount
B2:00A226 126ED4            LCALL    ?L?COM0363
B2:00A229 7019              JNZ      ?C0067?SERIALAPPL
 2078:       wakeUpOnTimer = TRUE;
 2079:       powerManagementWakeUpReason = (PM_TIMER_MINUTES == powerManagementWakeUpOnTimer)
B2:00A22B D20B              SETB     wakeUpOnTimer
 2080:                                     ? PM_WAKEUP_REASON_TIMER_MINUTES
B2:00A22D 902442            MOV      DPTR,#powerManagementWakeUpOnTimer
B2:00A230 E0                MOVX     A,@DPTR
B2:00A231 7F05              MOV      R7,#05H
B2:00A233 B40202            CJNE     A,#02H,?C0068?SERIALAPPL
B2:00A236 7F06              MOV      R7,#06H
B2:00A238         ?C0068?SERIALAPPL:
B2:00A238         ?C0069?SERIALAPPL:
B2:00A238 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:00A23B EF                MOV      A,R7
B2:00A23C F0                MOVX     @DPTR,A
 2081:                                     : PM_WAKEUP_REASON_TIMER_SECONDS;
 2082:       ZW_TIMER_CANCEL(wakeUpOnTimerHandle);
B2:00A23D 9020A9            MOV      DPTR,#wakeUpOnTimerHandle
B2:00A240 E0                MOVX     A,@DPTR
B2:00A241 FF                MOV      R7,A
B2:00A242 8011              SJMP     ?L?COM03D1
 2083:       wakeUpOnTimerHandle = -1;
 2084:     }
B2:00A244         ?C0067?SERIALAPPL:
 2085:     else
 2086:     {
 2087:       wakeUpOnTimerRes = (PM_TIMER_MINUTES == powerManagementWakeUpOnTimer) ? 60 : 1;
B2:00A244 902442            MOV      DPTR,#powerManagementWakeUpOnTimer
B2:00A247 E0                MOVX     A,@DPTR
B2:00A248 7F01              MOV      R7,#01H
B2:00A24A B40202            CJNE     A,#02H,?C0071?SERIALAPPL
B2:00A24D 7F3C              MOV      R7,#03CH
B2:00A24F         ?C0071?SERIALAPPL:
B2:00A24F         ?C0072?SERIALAPPL:
B2:00A24F 90247C            MOV      DPTR,#wakeUpOnTimerRes
B2:00A252 EF                MOV      A,R7
B2:00A253 F0                MOVX     @DPTR,A
 2088:     }
 2089:   }
 2090: }
B2:00A254         ?C0073?SERIALAPPL:
B2:00A254 22                RET      
----- FUNCTION ZCB_PowerManagementWakeUpOnTimerHandler (END) -------


----- FUNCTION ?L?COM03D1 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 642


B2:00A255 1244EE            LCALL    _TimerCancel
B2:00A258         ?L?COM03D2:
B2:00A258 9020A9            MOV      DPTR,#wakeUpOnTimerHandle
B2:00A25B 74FF              MOV      A,#0FFH
B2:00A25D F0                MOVX     @DPTR,A
B2:00A25E 22                RET      
----- FUNCTION ?L?COM03D1 (END) -------


----- FUNCTION PowerManagementSetPowerDown (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2094: PowerManagementSetPowerDown(void)
 2095: {
 2096:   for (i = 0; i < PM_IO_PIN_MAX; i++)
 2097:   {
B2:00A25F E4                CLR      A
B2:00A260 9024C6            MOV      DPTR,#i
B2:00A263 F0                MOVX     @DPTR,A
B2:00A264         ?C0074?SERIALAPPL:
B2:00A264 12994B            LCALL    ?L?COM0162
B2:00A267 9404              SUBB     A,#04H
B2:00A269 501C              JNC      ?C0075?SERIALAPPL
 2098:     if (PM_PHYSICAL_PIN_UNDEFINED != powerManagementPowerMode[i].bPin)
 2099:     {
B2:00A26B 7100              ACALL    ?L?COM0199
B2:00A26D F583              MOV      DPH,A
B2:00A26F E0                MOVX     A,@DPTR
B2:00A270 FF                MOV      R7,A
B2:00A271 F4                CPL      A
B2:00A272 600E              JZ       ?C0076?SERIALAPPL
 2100:       ZW_PortPinOut(powerManagementPowerMode[i].bPin);
 2101:       ZW_PortPinSet(powerManagementPowerMode[i].bPin, powerManagementPowerMode[i].bEnableLevel);
B2:00A274 714A              ACALL    ?L?COM04F7
B2:00A276 7101              ACALL    ?L?COM019A
B2:00A278 F583              MOV      DPH,A
B2:00A27A E0                MOVX     A,@DPTR
B2:00A27B FF                MOV      R7,A
B2:00A27C EE                MOV      A,R6
B2:00A27D 71B6              ACALL    ?L?COM02A6
B2:00A27F 126C14            LCALL    ?L?COM04DC
 2102:     }
 2103:   }
B2:00A282         ?C0076?SERIALAPPL:
B2:00A282 1293BA            LCALL    ?L?COM0034
B2:00A285 80DD              SJMP     ?C0074?SERIALAPPL
B2:00A287         ?C0075?SERIALAPPL:
 2104:   /* Wakeup on External setup */
 2105:   if (PM_PHYSICAL_PIN_UNDEFINED != powerManagementWakeUpOnExternal.bPin)
B2:00A287 902153            MOV      DPTR,#powerManagementWakeUpOnExternal
B2:00A28A E0                MOVX     A,@DPTR
B2:00A28B F4                CPL      A
B2:00A28C 6022              JZ       ?C0078?SERIALAPPL
 2106:   {
 2107:     if (-1 != wakeUpOnExternalTimerHandle)
B2:00A28E 7161              ACALL    ?L?COM0496
B2:00A290 6003              JZ       ?C0079?SERIALAPPL
 2108:     {
 2109:       ZW_TIMER_CANCEL(wakeUpOnExternalTimerHandle);
B2:00A292 1244EE            LCALL    _TimerCancel
 2110:     }
B2:00A295         ?C0079?SERIALAPPL:
 2111:     ZW_PortPinIn(powerManagementWakeUpOnExternal.bPin);
B2:00A295 902153            MOV      DPTR,#powerManagementWakeUpOnExternal
B2:00A298 E0                MOVX     A,@DPTR
B2:00A299 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 643


B2:00A29A 126CA8            LCALL    _ZW_PortPinIn
 2112:     wakeUpOnExternal = 0;
B2:00A29D C20F              CLR      wakeUpOnExternal
 2113:     wakeUpOnExternalTransition = 0;
B2:00A29F E4                CLR      A
B2:00A2A0 902164            MOV      DPTR,#wakeUpOnExternalTransition
B2:00A2A3 F0                MOVX     @DPTR,A
 2114:     wakeUpOnExternalTimerHandle = ZW_TIMER_START(ZCB_PowerManagementWakeUpOnExternalActive, 1, TIMER_FOREVER);
B2:00A2A4 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_PowerManagementWakeUpOnExternalActive
B2:00A2A6 7F3A              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_PowerManagementWakeUpOnExternalActive
B2:00A2A8 1258DF            LCALL    ?L?COM054D
B2:00A2AB 90244F            MOV      DPTR,#wakeUpOnExternalTimerHandle
B2:00A2AE EF                MOV      A,R7
B2:00A2AF F0                MOVX     @DPTR,A
 2115:   }
B2:00A2B0         ?C0078?SERIALAPPL:
 2116: 
 2117:   /* Wakeup on RF setup */
 2118:   if (PM_WAKEUP_UNDEFINED != powerManagementWakeUpOnRFMode)
B2:00A2B0 9024C5            MOV      DPTR,#powerManagementWakeUpOnRFMode
B2:00A2B3 E0                MOVX     A,@DPTR
B2:00A2B4 6002              JZ       ?C0080?SERIALAPPL
 2119:   {
 2120:     wakeUpOnRF = FALSE;
B2:00A2B6 C20D              CLR      wakeUpOnRF
 2121:   }
B2:00A2B8         ?C0080?SERIALAPPL:
 2122: 
 2123:   /* Wakeup on Timer setup */
 2124:   if (PM_TIMER_UNDEFINED != powerManagementWakeUpOnTimer)
B2:00A2B8 902442            MOV      DPTR,#powerManagementWakeUpOnTimer
B2:00A2BB E0                MOVX     A,@DPTR
B2:00A2BC 603C              JZ       ?C0081?SERIALAPPL
 2125:   {
 2126:     if (-1 != wakeUpOnTimerHandle)
B2:00A2BE 9020A9            MOV      DPTR,#wakeUpOnTimerHandle
B2:00A2C1 E0                MOVX     A,@DPTR
B2:00A2C2 FF                MOV      R7,A
B2:00A2C3 F4                CPL      A
B2:00A2C4 6003              JZ       ?C0082?SERIALAPPL
 2127:     {
 2128:       ZW_TIMER_CANCEL(wakeUpOnTimerHandle);
B2:00A2C6 1244EE            LCALL    _TimerCancel
 2129:     }
B2:00A2C9         ?C0082?SERIALAPPL:
 2130:     wakeUpOnTimer = FALSE;
B2:00A2C9 C20B              CLR      wakeUpOnTimer
 2131:     wakeUpOnTimerHandle = ZW_TIMER_START(ZCB_PowerManagementWakeUpOnTimerHandler, TIMER_ONE_SECOND, TIMER_FOREVER
>> );
B2:00A2CB 7E1E              MOV      R6,#HIGH ?INTERBANK_TABLE?ZCB_PowerManagementWakeUpOnTimerHandler
B2:00A2CD 7F3F              MOV      R7,#LOW ?INTERBANK_TABLE?ZCB_PowerManagementWakeUpOnTimerHandler
B2:00A2CF 7BFF              MOV      R3,#0FFH
B2:00A2D1 7D64              MOV      R5,#064H
B2:00A2D3 1258E3            LCALL    _TimerStart
B2:00A2D6 9020A9            MOV      DPTR,#wakeUpOnTimerHandle
B2:00A2D9 EF                MOV      A,R7
B2:00A2DA F0                MOVX     @DPTR,A
 2132:     wakeUpOnTimerRes = (PM_TIMER_MINUTES == powerManagementWakeUpOnTimer) ? 60 : 1;
B2:00A2DB 902442            MOV      DPTR,#powerManagementWakeUpOnTimer
B2:00A2DE E0                MOVX     A,@DPTR
B2:00A2DF 7F01              MOV      R7,#01H
B2:00A2E1 B40202            CJNE     A,#02H,?C0083?SERIALAPPL
B2:00A2E4 7F3C              MOV      R7,#03CH
B2:00A2E6         ?C0083?SERIALAPPL:
B2:00A2E6         ?C0084?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 644


B2:00A2E6 90247C            MOV      DPTR,#wakeUpOnTimerRes
B2:00A2E9 EF                MOV      A,R7
B2:00A2EA F0                MOVX     @DPTR,A
 2133:     wakeUpOnTimerCount = powerManagementWakeUpOnTimerCount;
B2:00A2EB 902461            MOV      DPTR,#powerManagementWakeUpOnTimerCount
B2:00A2EE E0                MOVX     A,@DPTR
B2:00A2EF FF                MOV      R7,A
B2:00A2F0 A3                INC      DPTR
B2:00A2F1 E0                MOVX     A,@DPTR
B2:00A2F2 90243D            MOV      DPTR,#wakeUpOnTimerCount
B2:00A2F5 CF                XCH      A,R7
B2:00A2F6 F0                MOVX     @DPTR,A
B2:00A2F7 A3                INC      DPTR
B2:00A2F8 EF                MOV      A,R7
B2:00A2F9 F0                MOVX     @DPTR,A
 2134:   }
B2:00A2FA         ?C0081?SERIALAPPL:
 2135:   powerManagementWakeUpReason = PM_WAKEUP_REASON_NONE;
B2:00A2FA E4                CLR      A
B2:00A2FB 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:00A2FE F0                MOVX     @DPTR,A
 2136: }
B2:00A2FF 22                RET      
----- FUNCTION PowerManagementSetPowerDown (END) -------


----- FUNCTION ?L?COM0199 (BEGIN) -----
B2:00A300 EF                MOV      A,R7
B2:00A301         ?L?COM019A:
B2:00A301 75F003            MOV      B,#03H
B2:00A304 A4                MUL      AB
B2:00A305 2443              ADD      A,#LOW powerManagementPowerMode
B2:00A307 F582              MOV      DPL,A
B2:00A309 E4                CLR      A
B2:00A30A 3424              ADDC     A,#HIGH powerManagementPowerMode
B2:00A30C 22                RET      
----- FUNCTION ?L?COM0199 (END) -------


----- FUNCTION PowerManagementSetPowerUp (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2140: PowerManagementSetPowerUp(void)
 2141: {
 2142:   /* WakeUp HOST */
 2143:   for (i = 0; i < PM_IO_PIN_MAX; i++)
B2:00A30D E4                CLR      A
B2:00A30E 9024C6            MOV      DPTR,#i
B2:00A311 F0                MOVX     @DPTR,A
B2:00A312         ?C0086?SERIALAPPL:
B2:00A312 12994B            LCALL    ?L?COM0162
B2:00A315 9404              SUBB     A,#04H
B2:00A317 5019              JNC      ?C0087?SERIALAPPL
 2144:   {
 2145:     if (PM_PHYSICAL_PIN_UNDEFINED != powerManagementWakeUpPinConf[i].bPin)
B2:00A319 EF                MOV      A,R7
B2:00A31A 7153              ACALL    ?L?COM0179
B2:00A31C E0                MOVX     A,@DPTR
B2:00A31D FF                MOV      R7,A
B2:00A31E F4                CPL      A
B2:00A31F 600C              JZ       ?C0088?SERIALAPPL
 2146:     {
 2147:       ZW_PortPinOut(powerManagementWakeUpPinConf[i].bPin);
B2:00A321 714A              ACALL    ?L?COM04F7
B2:00A323 7153              ACALL    ?L?COM0179
B2:00A325 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 645


B2:00A326 FF                MOV      R7,A
B2:00A327 EE                MOV      A,R6
B2:00A328 71C4              ACALL    ?L?COM02A7
B2:00A32A 126C14            LCALL    ?L?COM04DC
 2148:       ZW_PortPinSet(powerManagementWakeUpPinConf[i].bPin, powerManagementWakeUpPinConf[i].bEnableLevel);
 2149:     }
 2150:   }
B2:00A32D         ?C0088?SERIALAPPL:
B2:00A32D 1293BA            LCALL    ?L?COM0034
B2:00A330 80E0              SJMP     ?C0086?SERIALAPPL
B2:00A332         ?C0087?SERIALAPPL:
 2151: #ifdef POWER_MANAGEMENT_TEST
 2152:   if (wakeUpOnExternal)
 2153:   {
 2154:     ZW_PortPinSet(powerManagementWakeUpPinConf[1].bPin, 0);
 2155:   }
 2156:   if (wakeUpOnRF)
 2157:   {
 2158:     ZW_PortPinSet(powerManagementWakeUpPinConf[2].bPin, 0);
 2159:   }
 2160:   if (wakeUpOnTimer)
 2161:   {
 2162:     ZW_PortPinSet(powerManagementWakeUpPinConf[3].bPin, 0);
 2163:   }
 2164: #endif
 2165:   if (-1 != wakeUpOnTimerHandle)
B2:00A332 9020A9            MOV      DPTR,#wakeUpOnTimerHandle
B2:00A335 E0                MOVX     A,@DPTR
B2:00A336 FF                MOV      R7,A
B2:00A337 F4                CPL      A
B2:00A338 6002              JZ       ?C0090?SERIALAPPL
 2166:   {
 2167:     ZW_TIMER_CANCEL(wakeUpOnTimerHandle);
B2:00A33A 5155              ACALL    ?L?COM03D1
 2168:     wakeUpOnTimerHandle = -1;
 2169:   }
B2:00A33C         ?C0090?SERIALAPPL:
 2170:   if (-1 != wakeUpOnExternalTimerHandle)
B2:00A33C 7161              ACALL    ?L?COM0496
B2:00A33E 6003              JZ       ?C0091?SERIALAPPL
 2171:   {
 2172:     ZW_TIMER_CANCEL(wakeUpOnExternalTimerHandle);
B2:00A340 5112              ACALL    ?L?COM0397
B2:00A342 F0                MOVX     @DPTR,A
 2173:     wakeUpOnExternalTimerHandle = -1;
 2174:   }
B2:00A343         ?C0091?SERIALAPPL:
 2175:   wakeUpOnExternal = FALSE;
B2:00A343 C20F              CLR      wakeUpOnExternal
 2176:   wakeUpOnRF = FALSE;
B2:00A345 C20D              CLR      wakeUpOnRF
 2177:   wakeUpOnTimer = FALSE;
B2:00A347 C20B              CLR      wakeUpOnTimer
 2178: }
B2:00A349 22                RET      
----- FUNCTION PowerManagementSetPowerUp (END) -------


----- FUNCTION ?L?COM04F7 (BEGIN) -----
B2:00A34A 126CEB            LCALL    _ZW_PortPinOut
B2:00A34D 9024C6            MOV      DPTR,#i
B2:00A350 E0                MOVX     A,@DPTR
B2:00A351 FE                MOV      R6,A
B2:00A352 22                RET      
----- FUNCTION ?L?COM04F7 (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 646




----- FUNCTION ?L?COM0179 (BEGIN) -----
B2:00A353 75F003            MOV      B,#03H
B2:00A356 A4                MUL      AB
B2:00A357 2466              ADD      A,#LOW powerManagementWakeUpPinConf
B2:00A359 F582              MOV      DPL,A
B2:00A35B E4                CLR      A
B2:00A35C 3421              ADDC     A,#HIGH powerManagementWakeUpPinConf
B2:00A35E F583              MOV      DPH,A
B2:00A360 22                RET      
----- FUNCTION ?L?COM0179 (END) -------


----- FUNCTION ?L?COM0496 (BEGIN) -----
B2:00A361 90244F            MOV      DPTR,#wakeUpOnExternalTimerHandle
B2:00A364 E0                MOVX     A,@DPTR
B2:00A365 FF                MOV      R7,A
B2:00A366 F4                CPL      A
B2:00A367 22                RET      
----- FUNCTION ?L?COM0496 (END) -------


----- FUNCTION PowerManagementCheck (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 2182: PowerManagementCheck(void)
 2183: {
 2184:   switch (powerManagementState)
 2185:   {
B2:00A368 902173            MOV      DPTR,#powerManagementState
B2:00A36B E0                MOVX     A,@DPTR
B2:00A36C 14                DEC      A
B2:00A36D 603E              JZ       ?C0102?SERIALAPPL
B2:00A36F 24FD              ADD      A,#0FDH
B2:00A371 6016              JZ       ?C0098?SERIALAPPL
B2:00A373 04                INC      A
B2:00A374 703F              JNZ      ?C0105?SERIALAPPL
 2186:     case POWER_MODE_RUNNING:
 2187:       break;
 2188: 
 2189:     case POWER_MODE_POWERDOWN_TRANSITION:
B2:00A376         ?C0095?SERIALAPPL:
 2190:       /* Set HOST powerdown mode if either PowerUp pin is undefined or */
 2191:       /* Powerup pin is LOW */
 2192:       if ((PM_PHYSICAL_PIN_UNDEFINED == powerManagementPoweredUp.bPin)
B2:00A376 902463            MOV      DPTR,#powerManagementPoweredUp
B2:00A379 E0                MOVX     A,@DPTR
B2:00A37A F4                CPL      A
B2:00A37B 6003              JZ       ?C0097?SERIALAPPL
B2:00A37D 200C35            JB       poweredUp,?C0105?SERIALAPPL
B2:00A380         ?C0097?SERIALAPPL:
 2193:           || !poweredUp)
 2194:       {
 2195:         PowerManagementSetPowerDown();
B2:00A380 515F              ACALL    PowerManagementSetPowerDown
 2196:         powerManagementState = POWER_MODE_POWERDOWN;
B2:00A382 902173            MOV      DPTR,#powerManagementState
B2:00A385 7404              MOV      A,#04H
B2:00A387 F0                MOVX     @DPTR,A
 2197:       }
 2198:       break;
B2:00A388 22                RET      
 2199: 
 2200:     case POWER_MODE_POWERDOWN:
B2:00A389         ?C0098?SERIALAPPL:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 647


 2201:       /* Check if we are to Wakeup HOST again */
 2202:       /* WakeUpOnExternal  */
 2203:       if (wakeUpOnExternal)
B2:00A389 300F0E            JNB      wakeUpOnExternal,?C0099?SERIALAPPL
 2204:       {
 2205:         poweredUpTransition = 0;
B2:00A38C E4                CLR      A
B2:00A38D 9027A1            MOV      DPTR,#poweredUpTransition
B2:00A390 F0                MOVX     @DPTR,A
 2206:         powerManagementWakeUpReason = PM_WAKEUP_REASON_EXTERNAL;
B2:00A391 9027A0            MOV      DPTR,#powerManagementWakeUpReason
B2:00A394 04                INC      A
B2:00A395 F0                MOVX     @DPTR,A
 2207:         powerManagementState = POWER_MODE_RUNNING_TRANSITION;
B2:00A396 902173            MOV      DPTR,#powerManagementState
B2:00A399 F0                MOVX     @DPTR,A
 2208:       }
B2:00A39A         ?C0099?SERIALAPPL:
 2209:       if (wakeUpOnRF)
B2:00A39A 300D06            JNB      wakeUpOnRF,?C0100?SERIALAPPL
 2210:       {
 2211:         powerManagementState = POWER_MODE_RUNNING_TRANSITION;
B2:00A39D 902173            MOV      DPTR,#powerManagementState
B2:00A3A0 7401              MOV      A,#01H
B2:00A3A2 F0                MOVX     @DPTR,A
 2212:       }
B2:00A3A3         ?C0100?SERIALAPPL:
 2213:       if (wakeUpOnTimer)
B2:00A3A3 300B0F            JNB      wakeUpOnTimer,?C0105?SERIALAPPL
 2214:       {
 2215:         powerManagementState = POWER_MODE_RUNNING_TRANSITION;
B2:00A3A6 902173            MOV      DPTR,#powerManagementState
B2:00A3A9 7401              MOV      A,#01H
B2:00A3AB F0                MOVX     @DPTR,A
 2216:       }
 2217:       break;
B2:00A3AC 22                RET      
 2218: 
 2219:     case POWER_MODE_RUNNING_TRANSITION:
B2:00A3AD         ?C0102?SERIALAPPL:
 2220: //      if ((PM_PHYSICAL_PIN_UNDEFINED == powerManagementPoweredUp.bPin)
 2221: //          || poweredUp)
 2222:       {
 2223:         PowerManagementSetPowerUp();
B2:00A3AD 710D              ACALL    PowerManagementSetPowerUp
 2224:         powerManagementState = POWER_MODE_RUNNING;
B2:00A3AF 902173            MOV      DPTR,#powerManagementState
B2:00A3B2 7402              MOV      A,#02H
B2:00A3B4 F0                MOVX     @DPTR,A
 2225:       }
 2226:       break;
 2227: 
 2228:     case POWER_MODE_IDLE:
 2229:     default:
 2230:       break;
 2231:   }
 2232: }
B2:00A3B5         ?C0105?SERIALAPPL:
B2:00A3B5 22                RET      
----- FUNCTION PowerManagementCheck (END) -------


----- FUNCTION ?L?COM02A6 (BEGIN) -----
B2:00A3B6 75F003            MOV      B,#03H
B2:00A3B9 A4                MUL      AB
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 648


B2:00A3BA 2444              ADD      A,#LOW powerManagementPowerMode+01H
B2:00A3BC F582              MOV      DPL,A
B2:00A3BE E4                CLR      A
B2:00A3BF 3424              ADDC     A,#HIGH powerManagementPowerMode+01H
B2:00A3C1 F583              MOV      DPH,A
B2:00A3C3 22                RET      
----- FUNCTION ?L?COM02A6 (END) -------


----- FUNCTION ?L?COM02A7 (BEGIN) -----
B2:00A3C4 75F003            MOV      B,#03H
B2:00A3C7 A4                MUL      AB
B2:00A3C8 2467              ADD      A,#LOW powerManagementWakeUpPinConf+01H
B2:00A3CA F582              MOV      DPL,A
B2:00A3CC E4                CLR      A
B2:00A3CD 3421              ADDC     A,#HIGH powerManagementWakeUpPinConf+01H
B2:00A3CF F583              MOV      DPH,A
B2:00A3D1 22                RET      
----- FUNCTION ?L?COM02A7 (END) -------


----- FUNCTION PopCallBackQueue (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5280: PopCallBackQueue(void)
 5281: {
 5282:   if (callbackQueue.requestCnt)
 5283:   {
B2:00A3D2 902176            MOV      DPTR,#callbackQueue+02H
B2:00A3D5 E0                MOVX     A,@DPTR
B2:00A3D6 600E              JZ       ?C0446?SERIALAPPL
 5284:     callbackQueue.requestCnt--;
 5285:     if (++callbackQueue.requestOut >= MAX_CALLBACK_QUEUE)
B2:00A3D8 14                DEC      A
B2:00A3D9 F0                MOVX     @DPTR,A
 5286:     {
B2:00A3DA 902174            MOV      DPTR,#callbackQueue
B2:00A3DD 129FD6            LCALL    ?L?COM03CC
B2:00A3E0 400C              JC       ?C0448?SERIALAPPL
 5287:       callbackQueue.requestOut = 0;
 5288:     }
B2:00A3E2 E4                CLR      A
B2:00A3E3 F0                MOVX     @DPTR,A
 5289:   }
 5290:   else
B2:00A3E4 8008              SJMP     ?C0448?SERIALAPPL
B2:00A3E6         ?C0446?SERIALAPPL:
 5291:   {
 5292:     callbackQueue.requestOut = callbackQueue.requestIn;
B2:00A3E6 902175            MOV      DPTR,#callbackQueue+01H
B2:00A3E9 E0                MOVX     A,@DPTR
B2:00A3EA 902174            MOV      DPTR,#callbackQueue
B2:00A3ED F0                MOVX     @DPTR,A
 5293:   }
B2:00A3EE         ?C0448?SERIALAPPL:
B2:;----                  JMP      ?L?COM0493
 5294:   retry = 0;
 5295:   set_state(stateIdle);
----- FUNCTION PopCallBackQueue (END) -------


----- FUNCTION ?L?COM0493 (BEGIN) -----
B2:00A3EE E4                CLR      A
B2:00A3EF 902172            MOV      DPTR,#retry
B2:00A3F2 F0                MOVX     @DPTR,A
B2:00A3F3 902162            MOV      DPTR,#state
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 649


B2:00A3F6 F0                MOVX     @DPTR,A
B2:00A3F7 22                RET      
----- FUNCTION ?L?COM0493 (END) -------


----- FUNCTION PopCommandQueue (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5300: PopCommandQueue(void)
 5301: {
 5302:   if (commandQueue.requestCnt)
 5303:   {
B2:00A3F8 9024CC            MOV      DPTR,#commandQueue+02H
B2:00A3FB E0                MOVX     A,@DPTR
B2:00A3FC 600E              JZ       ?C0450?SERIALAPPL
 5304:     commandQueue.requestCnt--;
 5305:     if (++commandQueue.requestOut >= MAX_CALLBACK_QUEUE)
B2:00A3FE 14                DEC      A
B2:00A3FF F0                MOVX     @DPTR,A
 5306:     {
B2:00A400 9024CA            MOV      DPTR,#commandQueue
B2:00A403 129FD6            LCALL    ?L?COM03CC
B2:00A406 400C              JC       ?C0452?SERIALAPPL
 5307:       commandQueue.requestOut = 0;
 5308:     }
B2:00A408 E4                CLR      A
B2:00A409 F0                MOVX     @DPTR,A
 5309:   }
 5310:   else
B2:00A40A 8008              SJMP     ?C0452?SERIALAPPL
B2:00A40C         ?C0450?SERIALAPPL:
 5311:   {
 5312:     commandQueue.requestOut = commandQueue.requestIn;
B2:00A40C 9024CB            MOV      DPTR,#commandQueue+01H
B2:00A40F E0                MOVX     A,@DPTR
B2:00A410 9024CA            MOV      DPTR,#commandQueue
B2:00A413 F0                MOVX     @DPTR,A
 5313:   }
B2:00A414         ?C0452?SERIALAPPL:
 5314:   retry = 0;
B2:00A414 80D8              SJMP     ?L?COM0493
 5315:   set_state(stateIdle);
----- FUNCTION PopCommandQueue (END) -------


----- FUNCTION ApplicationTestPoll (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5334: ApplicationTestPoll(void)
 5335: {
 5336: #ifdef APPL_PROD_TEST
 5337:   /* If ApplicationInitHW returns FALSE this function will be called in place of
 5338:      ApplicationPoll */
 5339:   if (testRun)
 5340:     return;
 5341:   testRun = TRUE; /*it is only zero after reset*/
 5342:   switch (bProdtestState)
 5343:   {
 5344:     case PRODTEST_NR_1:
 5345:       /*Send a carrier on channel 0*/
 5346:       ZW_SendConst(1, 0, ZW_RF_TEST_SIGNAL_CARRIER);
 5347:     break;
 5348:     case PRODTEST_NR_2:
 5349:       /*Send a modulated carrier on channel 0*/
 5350:       ZW_SendConst(1, 0, ZW_RF_TEST_SIGNAL_CARRIER_MODULATED);
 5351:     break;
 5352:     case PRODTEST_NR_3:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 650


 5353:       /*Send a carrier on channel 1*/
 5354:       ZW_SendConst(1, 1, ZW_RF_TEST_SIGNAL_CARRIER);
 5355:     break;
 5356:     case PRODTEST_NR_4:
 5357:       /*Send a modulated carrier on channel 1*/
 5358:       ZW_SendConst(1, 1, ZW_RF_TEST_SIGNAL_CARRIER_MODULATED);
 5359:     break;
 5360:     case PRODTEST_NR_5:
 5361:       /*Send a carrier on channel 2*/
 5362:       ZW_SendConst(1, 2, ZW_RF_TEST_SIGNAL_CARRIER);
 5363:     break;
 5364:     case PRODTEST_NR_6:
 5365:       /*Send a modulated carrier on channel 2*/
 5366:       ZW_SendConst(1, 2, ZW_RF_TEST_SIGNAL_CARRIER_MODULATED);
 5367:     break;
 5368:     case PRODTEST_NR_7:
 5369:       /*Set the chip in rx state*/
 5370:       ZW_SET_RX_MODE(TRUE);
 5371:     break;
 5372:   }
 5373: #endif
 5374: }
B2:00A416 22                RET      
----- FUNCTION ApplicationTestPoll (END) -------


----- FUNCTION _ApplicationInitHW (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5382: ApplicationInitHW(
 5383:   BYTE bWakeupReason)  /* IN Reason for wakeup - ZW_WAKEUP_RESET (RESET)   */
;---- Variable 'bWakeupReason' assigned to Register 'R7' ----
 5384:                        /*                      - ZW_WAKEUP_WUT (WUT)       */
 5385:                        /*                      - ZW_WAKEUP_SENSOR (SENSOR) */
 5386: {
 5387: #ifdef APPL_PROD_TEST
 5388:     /* Enable IO pins */
 5389:     SET_PRODUCTIONTEST_PIN;
 5390:     ZW_IOS_enable(TRUE);
 5391:     for (testRun = 0; testRun < 100; testRun++) ;  /* Short delay in case pin is floating... */
 5392:     testRun = 0; /*set back the var to zero since it used as a flag*/
 5393:     if (IN_PRODUCTIONTEST) /* Anyone forcing it into production test mode ? */
 5394:     {/*bProdTestState is only initialised on ASIC power on*/
 5395:       if (bWakeupReason == ZW_WAKEUP_POR)
 5396:       {
 5397:         bProdtestState = PRODTEST_NR_1; /*Start test 1*/
 5398:       }
 5399:       else
 5400:       {/*if all test is been perform go to test 1*/
 5401:         if (++bProdtestState > PRODTEST_NR_7)
 5402:           bProdtestState = PRODTEST_NR_1;
 5403:       }
 5404:       return(FALSE);  /* Enter production test mode */
 5405:     }
 5406: #endif /* APPL_PROD_TEST */
 5407: #ifdef ZW_ISD51_DEBUG
 5408:   ISD_UART_init();
 5409: #endif
 5410: /* Productiontest pin not connected to a LED - hopefully */
 5411: #ifdef ENABLE_LEDS
 5412:   LedControlInit();
 5413: 
 5414:   LedOff(3);
 5415: #endif /* ENABLE_LEDS */
 5416: #ifdef USBDETECT
 5417:   /* Setup USB detect GPIO to OUT and LOW */
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 651


 5418:   PIN_LOW(USBDetect);
 5419:   PIN_OUT(USBDetect);
 5420: #endif
 5421: #ifdef UZB
 5422:   PIN_HIGH(LEDx);
 5423:   PIN_OUT(LEDx);
 5424: #endif
 5425: 
 5426: #if SUPPORT_SERIAL_API_READY
 5427:   if ((ZW_WAKEUP_WUT == bWakeupReason)
B2:00A417 EF                MOV      A,R7
B2:00A418 6401              XRL      A,#01H
B2:00A41A 6010              JZ       ?C0642?SERIALAPPL
B2:00A41C EF                MOV      A,R7
B2:00A41D 6402              XRL      A,#02H
B2:00A41F 600B              JZ       ?C0642?SERIALAPPL
B2:00A421 EF                MOV      A,R7
B2:00A422 6404              XRL      A,#04H
B2:00A424 6006              JZ       ?C0642?SERIALAPPL
B2:00A426 EF                MOV      A,R7
B2:00A427 B40602            CJNE     A,#06H,?C0455?SERIALAPPL
B2:00A42A         ?C0456?SERIALAPPL:
 5428:       || (ZW_WAKEUP_SENSOR == bWakeupReason)
 5429:       || (ZW_WAKEUP_EXT_INT == bWakeupReason)
 5430:       || (ZW_WAKEUP_USB_SUSPEND == bWakeupReason))
 5431:   {
 5432:     /* We have been waken from sleep by WUT, Beam or EXT_INT event - we must assume we are connected. */
 5433:     serialLinkState = SERIAL_LINK_CONNECTED;
 5434:   }
B2:00A42A 8000              SJMP     ?C0642?SERIALAPPL
B2:00A42C         ?C0455?SERIALAPPL:
 5435:   else
 5436:   {
 5437:     /* We have been waken either by ZW_WAKEUP_RESET or ZW_WAKEUP_POR. Initially we are DETACHED */
 5438:     serialLinkState = SERIAL_LINK_CONNECTED;
B2:00A42C         
B2:00A42C 90215F            MOV      DPTR,#serialLinkState
B2:00A42F 7401              MOV      A,#01H
B2:00A431 F0                MOVX     @DPTR,A
 5439:   }
B2:00A432         ?C0457?SERIALAPPL:
 5440: #endif
 5441:   /* applWakeupReason now contains lastest System Wakeup reason */
 5442:   applWakeupReason = bWakeupReason;
B2:00A432 902152            MOV      DPTR,#applWakeupReason
B2:00A435 EF                MOV      A,R7
B2:00A436 F0                MOVX     @DPTR,A
 5443: #ifdef ZW_SECURITY_PROTOCOL
 5444:   Transport_OnApplicationInitHW(bWakeupReason);
B2:00A437 913C              ACALL    _Transport_OnApplicationInitHW
 5445: #endif
 5446:   return(TRUE); /*Return FALSE to enter production test mode*/
B2:00A439 7F01              MOV      R7,#01H
 5447: }
B2:00A43B 22                RET      
----- FUNCTION _ApplicationInitHW (END) -------


----- FUNCTION _Transport_OnApplicationInitHW (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  145: BOOL Transport_OnApplicationInitHW(uint8_t bStatus)
  146: {
  147:   UNUSED(bStatus);
  148:   return TRUE;
  149: }
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 652


B2:00A43C D3                SETB     C
  150: 
B2:00A43D 22                RET      
----- FUNCTION _Transport_OnApplicationInitHW (END) -------


----- FUNCTION _CheckPowerlevel (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 5457: CheckPowerlevel(
 5458:   BYTE bPower)
;---- Variable 'bPower' assigned to Register 'R7' ----
 5459: {
 5460:   if ((bPower > 0x3F) || (bPower < 0x03))
B2:00A43E EF                MOV      A,R7
B2:00A43F D3                SETB     C
B2:00A440 943F              SUBB     A,#03FH
B2:00A442 5006              JNC      ?C0460?SERIALAPPL
B2:00A444 EF                MOV      A,R7
B2:00A445 C3                CLR      C
B2:00A446 9403              SUBB     A,#03H
B2:00A448 5003              JNC      ?C0459?SERIALAPPL
B2:00A44A         ?C0460?SERIALAPPL:
 5461:   {
 5462:     return 0;
B2:00A44A 7F00              MOV      R7,#00H
B2:00A44C 22                RET      
 5463:   }
B2:00A44D         ?C0459?SERIALAPPL:
 5464:   return bPower;
 5465: }
B2:00A44D 22                RET      
----- FUNCTION _CheckPowerlevel (END) -------


----- FUNCTION ?L?COM0412 (BEGIN) -----
B2:00A44E FE                MOV      R6,A
B2:00A44F 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00A452 913E              ACALL    _CheckPowerlevel
B2:00A454 9024C6            MOV      DPTR,#i
B2:00A457 E0                MOVX     A,@DPTR
B2:00A458 22                RET      
----- FUNCTION ?L?COM0412 (END) -------


----- FUNCTION _ApplicationRfNotify (BEGIN) -----
 FILE: 'SERIALAPPL.C'
 6288: ApplicationRfNotify(
 6289:   BYTE rfState)         /* IN state of the RF, the available values is as follow:
 6290:                                ZW_RF_TX_MODE: The RF switch from the Rx to Tx mode, the modualtor is started and 
>> PA is on
 6291:                                ZW_RF_PA_ON: The RF in the Tx mode, the modualtor PA is turned on
 6292:                                ZW_RF_PA_OFF: the Rf in the Tx mode, the modulator PA is turned off
 6293:                                ZW_RF_RX_MODE: The RF switch from Tx to Rx mode, the demodulator is started.*/
 6294: {
 6295:   UNUSED(rfState);
 6296: }
B2:00A459 22                RET      
----- FUNCTION _ApplicationRfNotify (END) -------


----- FUNCTION _TimerReset (BEGIN) -----
 FILE: 'CONHANDLE.C'
   69: TimerReset(
   70:   WORD *pwTimerStartTick)   /*IN  Nothing */
B2:00A45A 904666            MOV      DPTR,#pwTimerStartTick
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 653


B2:00A45D 122572            LCALL    ?C?PSTXDATA
   71: {
   72:   *pwTimerStartTick = getTickTime();
B2:00A460 12593A            LCALL    getTickTime
B2:00A463 904666            MOV      DPTR,#pwTimerStartTick
B2:00A466 122552            LCALL    ?C?PLDXDATA
B2:00A469 EE                MOV      A,R6
B2:00A46A 8FF0              MOV      B,R7
B2:00A46C 0221E8            LJMP     ?C?ISTPTR
----- FUNCTION _TimerReset (END) -------


----- FUNCTION _ConTxFrame (BEGIN) -----
 FILE: 'CONHANDLE.C'
  120: ConTxFrame(
  121:   BYTE cmd,   /* IN Command */
;---- Variable 'cmd' assigned to Register 'R7' ----
;---- Variable 'Buf' assigned to Register 'R2/R3' ----
;---- Variable 'type' assigned to Register 'R5' ----
  122:   BYTE type,  /* IN frame Type to send (Response or Request) */
  123:   XBYTE *Buf, /* IN pointer to BYTE buffer containing DATA to send */
  124:   BYTE len)   /* IN the length of DATA to transmit */
  125: {
  126:   static BYTE wCmd, wType, wLen, *wBuf;
  127:   BYTE i, bChecksum;
  128: 
  129: 
  130:   if (Buf != NULL)
B2:00A46F EB                MOV      A,R3
B2:00A470 4A                ORL      A,R2
B2:00A471 601A              JZ       ?C0004?CONHANDLE
  131:   {
  132:     wBuf = Buf;
B2:00A473 A903              MOV      R1,AR3
B2:00A475 7B01              MOV      R3,#01H
B2:00A477 9033FB            MOV      DPTR,#wBuf
B2:00A47A 122572            LCALL    ?C?PSTXDATA
  133:     wLen = len;
B2:00A47D 904469            MOV      DPTR,#len
B2:00A480 E0                MOVX     A,@DPTR
B2:00A481 9033FA            MOV      DPTR,#wLen
B2:00A484 F0                MOVX     @DPTR,A
  134:     wCmd = cmd;
B2:00A485 9033F8            MOV      DPTR,#wCmd
B2:00A488 EF                MOV      A,R7
B2:00A489 F0                MOVX     @DPTR,A
  135:     wType = type;
B2:00A48A A3                INC      DPTR
B2:00A48B ED                MOV      A,R5
B2:00A48C F0                MOVX     @DPTR,A
  136:   }
B2:00A48D         ?C0004?CONHANDLE:
  137:   bChecksum = 0xFF; /* Initialize checksum */
B2:00A48D 90446B            MOV      DPTR,#bChecksum
B2:00A490 74FF              MOV      A,#0FFH
B2:00A492 F0                MOVX     @DPTR,A
  138:   ZW_SerialPutByte(SOF);
B2:00A493 7F01              MOV      R7,#01H
B2:00A495 124739            LCALL    _ZW_SerialPutByte_uart
  139:   ZW_SerialPutByte(wLen + 3);  // Remember the 'len', 'type' and 'cmd' bytes
B2:00A498 9033FA            MOV      DPTR,#wLen
B2:00A49B E0                MOVX     A,@DPTR
B2:00A49C 2403              ADD      A,#03H
B2:00A49E B112              ACALL    ?L?COM02BE
B2:00A4A0 9033FA            MOV      DPTR,#wLen
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 654


B2:00A4A3 E0                MOVX     A,@DPTR
B2:00A4A4 2403              ADD      A,#03H
B2:00A4A6 B109              ACALL    ?L?COM0321
  140:   bChecksum ^= wLen + 3;
  141:   ZW_SerialPutByte(wType);
B2:00A4A8 9033F9            MOV      DPTR,#wType
B2:00A4AB B111              ACALL    ?L?COM02BD
B2:00A4AD 9033F9            MOV      DPTR,#wType
B2:00A4B0 B108              ACALL    ?L?COM0320
  142:   bChecksum ^= wType;
  143:   ZW_SerialPutByte(wCmd);
B2:00A4B2 9033F8            MOV      DPTR,#wCmd
B2:00A4B5 B111              ACALL    ?L?COM02BD
B2:00A4B7 9033F8            MOV      DPTR,#wCmd
B2:00A4BA B108              ACALL    ?L?COM0320
  144:   bChecksum ^= wCmd;
  145:   for (i = 0; (wBuf != NULL) && (i < wLen); i++)
B2:00A4BC E4                CLR      A
B2:00A4BD 90446A            MOV      DPTR,#i
B2:00A4C0 F0                MOVX     @DPTR,A
B2:00A4C1         ?C0005?CONHANDLE:
B2:00A4C1 9033FB            MOV      DPTR,#wBuf
B2:00A4C4 122552            LCALL    ?C?PLDXDATA
B2:00A4C7 E9                MOV      A,R1
B2:00A4C8 4A                ORL      A,R2
B2:00A4C9 602B              JZ       ?C0006?CONHANDLE
B2:00A4CB 9033FA            MOV      DPTR,#wLen
B2:00A4CE E0                MOVX     A,@DPTR
B2:00A4CF FF                MOV      R7,A
B2:00A4D0 90446A            MOV      DPTR,#i
B2:00A4D3 E0                MOVX     A,@DPTR
B2:00A4D4 FE                MOV      R6,A
B2:00A4D5 C3                CLR      C
B2:00A4D6 9F                SUBB     A,R7
B2:00A4D7 501D              JNC      ?C0006?CONHANDLE
  146:   {
  147:     ZW_SerialPutByte(wBuf[i]);
B2:00A4D9 8E82              MOV      DPL,R6
B2:00A4DB 126EA1            LCALL    ?L?COM02F5
B2:00A4DE B112              ACALL    ?L?COM02BE
B2:00A4E0 9033FB            MOV      DPTR,#wBuf
B2:00A4E3 122552            LCALL    ?C?PLDXDATA
B2:00A4E6 90446A            MOV      DPTR,#i
B2:00A4E9 126E9E            LCALL    ?L?COM02F3
B2:00A4EC B109              ACALL    ?L?COM0321
  148:     bChecksum ^= wBuf[i];
  149:   }
B2:00A4EE 90446A            MOV      DPTR,#i
B2:00A4F1 E0                MOVX     A,@DPTR
B2:00A4F2 04                INC      A
B2:00A4F3 F0                MOVX     @DPTR,A
B2:00A4F4 80CB              SJMP     ?C0005?CONHANDLE
B2:00A4F6         ?C0006?CONHANDLE:
  150:   ZW_SerialPutByte(bChecksum);       // XOR checksum of
B2:00A4F6 90446B            MOV      DPTR,#bChecksum
B2:00A4F9 E0                MOVX     A,@DPTR
B2:00A4FA FF                MOV      R7,A
B2:00A4FB 1247BE            LCALL    ?L?COM03CA
  151:   ZW_SerialFlush();                //Start sending frame to the host.
  152:   AckNakNeeded = 1;  // Now we need an ACK...
B2:00A4FE D227              SETB     AckNakNeeded
  153:   TimerReset(&timeOutRX_ACKStart); /* Reset ACK timeout */
B2:00A500 7B01              MOV      R3,#01H
B2:00A502 7A34              MOV      R2,#HIGH timeOutRX_ACKStart
B2:00A504 7905              MOV      R1,#LOW timeOutRX_ACKStart
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 655


B2:00A506 815A              AJMP     _TimerReset
----- FUNCTION _ConTxFrame (END) -------


----- FUNCTION ?L?COM0320 (BEGIN) -----
B2:00A508 E0                MOVX     A,@DPTR
B2:00A509         ?L?COM0321:
B2:00A509 FE                MOV      R6,A
B2:00A50A EF                MOV      A,R7
B2:00A50B 6E                XRL      A,R6
B2:00A50C 90446B            MOV      DPTR,#bChecksum
B2:00A50F F0                MOVX     @DPTR,A
B2:00A510 22                RET      
----- FUNCTION ?L?COM0320 (END) -------


----- FUNCTION ?L?COM02BD (BEGIN) -----
B2:00A511 E0                MOVX     A,@DPTR
B2:00A512         ?L?COM02BE:
B2:00A512 FF                MOV      R7,A
B2:00A513 124739            LCALL    _ZW_SerialPutByte_uart
B2:00A516 90446B            MOV      DPTR,#bChecksum
B2:00A519 E0                MOVX     A,@DPTR
B2:00A51A FF                MOV      R7,A
B2:00A51B 22                RET      
----- FUNCTION ?L?COM02BD (END) -------


----- FUNCTION ?L?COM0322 (BEGIN) -----
B2:00A51C E0                MOVX     A,@DPTR
B2:00A51D 904469            MOV      DPTR,#?_ConTxFrame?BYTE+04H
B2:00A520 F0                MOVX     @DPTR,A
B2:00A521 E4                CLR      A
B2:00A522 FD                MOV      R5,A
B2:00A523         ?L?COM0323:
B2:00A523 916F              ACALL    _ConTxFrame
B2:00A525 902162            MOV      DPTR,#state
B2:00A528 22                RET      
----- FUNCTION ?L?COM0322 (END) -------


----- FUNCTION ?L?COM04EF (BEGIN) -----
B2:00A529 E0                MOVX     A,@DPTR
B2:00A52A FE                MOV      R6,A
B2:00A52B A3                INC      DPTR
B2:00A52C E0                MOVX     A,@DPTR
B2:00A52D FF                MOV      R7,A
----- FUNCTION _TimerGetElapsedTime (BEGIN) -----
 FILE: 'CONHANDLE.C'
   81: TimerGetElapsedTime(
   82:   WORD wTimerStartTick)  /* IN   Nothing */
;---- Variable 'wTimerStartTick' assigned to Register 'R6/R7' ----
   83: {
   84:   return getTickTimePassed(wTimerStartTick);
B2:00A52E 025949            LJMP     _getTickTimePassed
   85: }
----- FUNCTION _TimerGetElapsedTime (END) -------


----- FUNCTION ConTxActive (BEGIN) -----
 FILE: 'CONHANDLE.C'
   98: ConTxActive(void)
   99: {
  100:   return ZW_SerialTxActive();
  101: }
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 656


B2:00A531 026DD0            LJMP     ZW_SerialTxActive_uart
----- FUNCTION ConTxActive (END) -------


----- FUNCTION _ConUpdate (BEGIN) -----
 FILE: 'CONHANDLE.C'
  171: ConUpdate(
  172:   BYTE acknowledge) /* IN do we send acknowledge and handle frame if received correctly */
B2:00A534 904669            MOV      DPTR,#acknowledge
B2:00A537 EF                MOV      A,R7
B2:00A538 F0                MOVX     @DPTR,A
  173: {
  174:   BYTE c;
  175:   enum T_CON_TYPE retVal = conIdle;
B2:00A539 E4                CLR      A
B2:00A53A 90466B            MOV      DPTR,#retVal
B2:00A53D F0                MOVX     @DPTR,A
  176: 
  177: 
  178:   if (ZW_SerialCheck())
B2:00A53E 126DCD            LCALL    ZW_SerialCheck_uart
B2:00A541 EF                MOV      A,R7
B2:00A542 7002              JNZ      $ + 4H
B2:00A544 C144              AJMP     ?C0009?CONHANDLE
  179:   {
B2:00A546         ?C0012?CONHANDLE:
  180:     do
  181:     {
  182:       c = ZW_SerialGetByte();
B2:00A546 126909            LCALL    ZW_SerialGetByte_uart
B2:00A549 90466A            MOV      DPTR,#c
B2:00A54C EF                MOV      A,R7
B2:00A54D F0                MOVX     @DPTR,A
  183: 
  184:       switch (con_state)
B2:00A54E 903403            MOV      DPTR,#con_state
B2:00A551 E0                MOVX     A,@DPTR
B2:00A552 14                DEC      A
B2:00A553 604F              JZ       ?C0022?CONHANDLE
B2:00A555 14                DEC      A
B2:00A556 6060              JZ       ?C0025?CONHANDLE
B2:00A558 14                DEC      A
B2:00A559 606E              JZ       ?C0027?CONHANDLE
B2:00A55B 14                DEC      A
B2:00A55C 606D              JZ       ?C0028?CONHANDLE
B2:00A55E 14                DEC      A
B2:00A55F 7002              JNZ      $ + 4H
B2:00A561 C10B              AJMP     ?C0032?CONHANDLE
B2:00A563 2405              ADD      A,#05H
B2:00A565 6002              JZ       $ + 4H
B2:00A567 C134              AJMP     ?C0037?CONHANDLE
  185:       {
  186:         case stateSOFHunt :
B2:00A569         ?C0014?CONHANDLE:
  187:           if (c == SOF)
B2:00A569 90466A            MOV      DPTR,#c
B2:00A56C E0                MOVX     A,@DPTR
B2:00A56D B40111            CJNE     A,#01H,?C0015?CONHANDLE
  188:           {
  189:             bChecksum_RX = 0xff;
B2:00A570 9033FF            MOV      DPTR,#bChecksum_RX
B2:00A573 74FF              MOV      A,#0FFH
B2:00A575 F0                MOVX     @DPTR,A
  190:             serBufLen = 0;
B2:00A576 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 657


B2:00A577 9033FE            MOV      DPTR,#serBufLen
B2:00A57A F0                MOVX     @DPTR,A
  191:             rxActive = 1;  // now we're receiving - check for timeout
B2:00A57B D226              SETB     rxActive
  192:             con_state++;
B2:00A57D D17E              ACALL    ?L?COM048A
  193:             TimerReset(&timeOutRX_BYTEStart); /* Reset Inframe Byte timeout */
  194:           }
B2:00A57F C101              AJMP     ?C0044?CONHANDLE
B2:00A581         ?C0015?CONHANDLE:
  195:           else
  196:           {
  197:             if (AckNakNeeded)
B2:00A581 202702            JB       AckNakNeeded,$ + 5H
B2:00A584 C136              AJMP     ?C0010?CONHANDLE
  198:             {
  199:               if (c == ACK)
B2:00A586 90466A            MOV      DPTR,#c
B2:00A589 E0                MOVX     A,@DPTR
B2:00A58A FF                MOV      R7,A
B2:00A58B B40605            CJNE     A,#06H,?C0018?CONHANDLE
  200:               {
  201:                 retVal = conFrameSent;
B2:00A58E A3                INC      DPTR
B2:00A58F 7402              MOV      A,#02H
  202:                 AckNakNeeded = 0;  // Done
  203:               }
B2:00A591 800C              SJMP     ?C0045?CONHANDLE
B2:00A593         ?C0018?CONHANDLE:
  204:               else if (c == NAK)
B2:00A593 EF                MOV      A,R7
B2:00A594 6415              XRL      A,#015H
B2:00A596 6002              JZ       $ + 4H
B2:00A598 C136              AJMP     ?C0010?CONHANDLE
  205:               {
  206:                 retVal = conTxTimeout;
B2:00A59A 90466B            MOV      DPTR,#retVal
B2:00A59D 7405              MOV      A,#05H
B2:00A59F         
B2:00A59F F0                MOVX     @DPTR,A
  207:                 AckNakNeeded = 0;
B2:00A5A0 C227              CLR      AckNakNeeded
  208:               }
B2:00A5A2 C136              AJMP     ?C0010?CONHANDLE
  209:               else
  210:               {
  211:                 // Bogus character received...
  212:               }
  213:             }
  214:           }
  215:           break;
  216: 
  217:         case stateLen :
B2:00A5A4         ?C0022?CONHANDLE:
  218:           // Check for length to be inside valid range
  219:           if ((c < FRAME_LENGTH_MIN) || (c > FRAME_LENGTH_MAX))
B2:00A5A4 90466A            MOV      DPTR,#c
B2:00A5A7 E0                MOVX     A,@DPTR
B2:00A5A8 FF                MOV      R7,A
B2:00A5A9 C3                CLR      C
B2:00A5AA 9403              SUBB     A,#03H
B2:00A5AC 5002              JNC      $ + 4H
B2:00A5AE C134              AJMP     ?C0047?CONHANDLE
B2:00A5B0 EF                MOV      A,R7
B2:00A5B1 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 658


B2:00A5B2 94B4              SUBB     A,#0B4H
B2:00A5B4 4002              JC       ?C0025?CONHANDLE
B2:00A5B6         ?C0024?CONHANDLE:
  220:           {
  221:             con_state = stateSOFHunt; // Restart looking for SOF
  222:             rxActive = 0;  // Not really active now...
  223:             break;
B2:00A5B6 807C              SJMP     ?C0047?CONHANDLE
  224:           }
  225:           // Drop through...
  226: 
  227:         case stateType :
B2:00A5B8         ?C0025?CONHANDLE:
  228:           if (serBufLen && (c > RESPONSE))
B2:00A5B8 9033FE            MOV      DPTR,#serBufLen
B2:00A5BB E0                MOVX     A,@DPTR
B2:00A5BC 600B              JZ       ?C0027?CONHANDLE
B2:00A5BE 90466A            MOV      DPTR,#c
B2:00A5C1 E0                MOVX     A,@DPTR
B2:00A5C2 D3                SETB     C
B2:00A5C3 9401              SUBB     A,#01H
B2:00A5C5 4002              JC       ?C0027?CONHANDLE
  229:           {
  230:             con_state = stateSOFHunt; // Restart looking for SOF
B2:00A5C7         
  231:             rxActive = 0;  // Not really active now...
  232:             break;
B2:00A5C7 806B              SJMP     ?C0047?CONHANDLE
  233:           }
  234:           // Drop through...
  235: 
  236:         case stateCmd :
B2:00A5C9         ?C0027?CONHANDLE:
  237:           con_state++;
B2:00A5C9 D17E              ACALL    ?L?COM048A
  238:           // Drop through...
  239: 
  240:         case stateData :
B2:00A5CB         ?C0028?CONHANDLE:
  241:           if (serBufLen < SERBUF_MAX)
B2:00A5CB 9033FE            MOV      DPTR,#serBufLen
B2:00A5CE E0                MOVX     A,@DPTR
B2:00A5CF FF                MOV      R7,A
B2:00A5D0 C3                CLR      C
B2:00A5D1 94B4              SUBB     A,#0B4H
B2:00A5D3 502A              JNC      ?C0029?CONHANDLE
  242:           {
  243:             serBuf[serBufLen] = c;
B2:00A5D5 90466A            MOV      DPTR,#c
B2:00A5D8 E0                MOVX     A,@DPTR
B2:00A5D9 FE                MOV      R6,A
B2:00A5DA 7407              MOV      A,#LOW serBuf
B2:00A5DC 2F                ADD      A,R7
B2:00A5DD F582              MOV      DPL,A
B2:00A5DF E4                CLR      A
B2:00A5E0 3434              ADDC     A,#HIGH serBuf
B2:00A5E2 F583              MOV      DPH,A
B2:00A5E4 EE                MOV      A,R6
B2:00A5E5 F0                MOVX     @DPTR,A
  244:             serBufLen++;
B2:00A5E6 9033FE            MOV      DPTR,#serBufLen
B2:00A5E9 E0                MOVX     A,@DPTR
B2:00A5EA 04                INC      A
B2:00A5EB F0                MOVX     @DPTR,A
  245:             bChecksum_RX ^= c;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 659


B2:00A5EC A3                INC      DPTR
B2:00A5ED E0                MOVX     A,@DPTR
B2:00A5EE 6E                XRL      A,R6
B2:00A5EF F0                MOVX     @DPTR,A
  246:             if (serBufLen >= serFrameLen)
B2:00A5F0 903407            MOV      DPTR,#serBuf
B2:00A5F3 E0                MOVX     A,@DPTR
B2:00A5F4 FF                MOV      R7,A
B2:00A5F5 9033FE            MOV      DPTR,#serBufLen
B2:00A5F8 E0                MOVX     A,@DPTR
B2:00A5F9 C3                CLR      C
B2:00A5FA 9F                SUBB     A,R7
B2:00A5FB 4004              JC       ?C0031?CONHANDLE
  247:             {
  248:               con_state++;
  249:             }
  250:           }
B2:00A5FD 8000              SJMP     ?C0048?CONHANDLE
B2:00A5FF         ?C0029?CONHANDLE:
  251:           else
  252:           {
  253:             con_state++;
B2:00A5FF         
B2:00A5FF D17E              ACALL    ?L?COM048A
  254:           }
B2:00A601         ?C0031?CONHANDLE:
  255:           TimerReset(&timeOutRX_BYTEStart); /* Reset Inframe Byte timeout */
B2:00A601         
B2:00A601 7B01              MOV      R3,#01H
B2:00A603 7A34              MOV      R2,#HIGH timeOutRX_BYTEStart
B2:00A605 7901              MOV      R1,#LOW timeOutRX_BYTEStart
B2:00A607 915A              ACALL    _TimerReset
  256:           break;
B2:00A609 802B              SJMP     ?C0010?CONHANDLE
  257: 
  258:         case stateChecksum :
B2:00A60B         ?C0032?CONHANDLE:
  259:           /* Do we send ACK/NAK according to checksum... */
  260:           /* if not then the received frame is dropped! */
  261:           if (acknowledge)
B2:00A60B 904669            MOV      DPTR,#acknowledge
B2:00A60E E0                MOVX     A,@DPTR
B2:00A60F 601E              JZ       ?C0033?CONHANDLE
  262:           {
  263:             if (c == bChecksum_RX)
B2:00A611 9033FF            MOV      DPTR,#bChecksum_RX
B2:00A614 E0                MOVX     A,@DPTR
B2:00A615 FF                MOV      R7,A
B2:00A616 90466A            MOV      DPTR,#c
B2:00A619 E0                MOVX     A,@DPTR
B2:00A61A B50709            CJNE     A,AR7,?C0034?CONHANDLE
  264:             {
  265:               ZW_SerialPutByte(ACK);
B2:00A61D 7F06              MOV      R7,#06H
B2:00A61F D196              ACALL    ?L?COM0489
B2:00A621 7401              MOV      A,#01H
B2:00A623 F0                MOVX     @DPTR,A
  266:               ZW_SerialFlush();                //Start sending frame to the host.
  267:               retVal = conFrameReceived;  // Tell THE world that we got a packet
  268:             }
B2:00A624 800E              SJMP     ?C0037?CONHANDLE
B2:00A626         ?C0034?CONHANDLE:
  269:             else
  270:             {
  271:               ZW_SerialPutByte(NAK);       // Tell them something is wrong...
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 660


B2:00A626 7F15              MOV      R7,#015H
B2:00A628 D196              ACALL    ?L?COM0489
B2:00A62A 7403              MOV      A,#03H
B2:00A62C F0                MOVX     @DPTR,A
  272:               ZW_SerialFlush();                //Start sending frame to the host.
  273:               retVal = conFrameErr;
  274:             }
  275:           }
B2:00A62D 8005              SJMP     ?C0037?CONHANDLE
B2:00A62F         ?C0033?CONHANDLE:
  276:           else
  277:           {
  278:             // We are in the process of looking for an acknowledge to a callback request
  279:             // Drop the new frame we received - we don't have time to handle it.
  280:             // Send a CAN to indicate what is happening...
  281:             ZW_SerialPutByte(CAN);
B2:00A62F 7F18              MOV      R7,#018H
B2:00A631 1247BE            LCALL    ?L?COM03CA
  282:             ZW_SerialFlush();                //Start sending frame to the host.
  283:           }
  284:           // Drop through
  285: 
  286:         default :
B2:00A634         ?C0037?CONHANDLE:
  287:           con_state = stateSOFHunt; // Restart looking for SOF
B2:00A634         
B2:00A634 D185              ACALL    ?L?COM0548
  288:           rxActive = 0;  // Not really active now...
  289:           break;
  290:       }
  291:     } while ((retVal == conIdle) && ZW_SerialCheck());
B2:00A636         ?C0010?CONHANDLE:
B2:00A636 90466B            MOV      DPTR,#retVal
B2:00A639 E0                MOVX     A,@DPTR
B2:00A63A 7008              JNZ      ?C0009?CONHANDLE
B2:00A63C 126DCD            LCALL    ZW_SerialCheck_uart
B2:00A63F EF                MOV      A,R7
B2:00A640 6002              JZ       $ + 4H
B2:00A642 A146              AJMP     ?C0012?CONHANDLE
  292:   }
B2:00A644         ?C0009?CONHANDLE:
  293:   /* Check for timeouts - if no other events detected */
  294:   if (retVal == conIdle)
B2:00A644 90466B            MOV      DPTR,#retVal
B2:00A647 E0                MOVX     A,@DPTR
B2:00A648 702E              JNZ      ?C0039?CONHANDLE
  295:   {
  296:     /* Are we in the middle of collecting a frame and have we timed out? */
  297:     if (rxActive && (TimerGetElapsedTime(timeOutRX_BYTEStart) >= timeOutRX_BYTE))
B2:00A64A 302614            JNB      rxActive,?C0040?CONHANDLE
B2:00A64D 903401            MOV      DPTR,#timeOutRX_BYTEStart
B2:00A650 B129              ACALL    ?L?COM04EF
B2:00A652 903400            MOV      DPTR,#timeOutRX_BYTE
B2:00A655 D18D              ACALL    ?L?COM04EE
B2:00A657 4008              JC       ?C0040?CONHANDLE
  298:     {
  299:       /* Reset to SOF hunting */
  300:       con_state = stateSOFHunt;
B2:00A659 D185              ACALL    ?L?COM0548
  301:       rxActive = 0; /* Not inframe anymore */
  302:       retVal = conRxTimeout;
B2:00A65B 90466B            MOV      DPTR,#retVal
B2:00A65E 7404              MOV      A,#04H
B2:00A660 F0                MOVX     @DPTR,A
  303:     }
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 661


B2:00A661         ?C0040?CONHANDLE:
  304:     /* Are we waiting for ACK and have we timed out? */
  305:     if (AckNakNeeded && (TimerGetElapsedTime(timeOutRX_ACKStart) >= timeOutRX_ACK))
B2:00A661 302714            JNB      AckNakNeeded,?C0039?CONHANDLE
B2:00A664 903405            MOV      DPTR,#timeOutRX_ACKStart
B2:00A667 B129              ACALL    ?L?COM04EF
B2:00A669 903404            MOV      DPTR,#timeOutRX_ACK
B2:00A66C D18D              ACALL    ?L?COM04EE
B2:00A66E 4008              JC       ?C0039?CONHANDLE
  306:     {
  307:       /* Not waiting for ACK anymore */
  308:       AckNakNeeded = 0;
B2:00A670 C227              CLR      AckNakNeeded
  309:       /* Tell upper layer we could not get the frame through */
  310:       retVal = conTxTimeout;
B2:00A672 90466B            MOV      DPTR,#retVal
B2:00A675 7405              MOV      A,#05H
B2:00A677 F0                MOVX     @DPTR,A
  311:     }
  312:   }
B2:00A678         ?C0039?CONHANDLE:
  313:   return retVal;
B2:00A678 90466B            MOV      DPTR,#retVal
B2:00A67B E0                MOVX     A,@DPTR
B2:00A67C FF                MOV      R7,A
  314: }
B2:00A67D 22                RET      
----- FUNCTION _ConUpdate (END) -------


----- FUNCTION ?L?COM048A (BEGIN) -----
B2:00A67E 903403            MOV      DPTR,#con_state
B2:00A681 E0                MOVX     A,@DPTR
B2:00A682 04                INC      A
B2:00A683 F0                MOVX     @DPTR,A
B2:00A684 22                RET      
----- FUNCTION ?L?COM048A (END) -------


----- FUNCTION ?L?COM0548 (BEGIN) -----
B2:00A685 E4                CLR      A
B2:00A686 903403            MOV      DPTR,#con_state
B2:00A689 F0                MOVX     @DPTR,A
B2:00A68A C226              CLR      rxActive
B2:00A68C 22                RET      
----- FUNCTION ?L?COM0548 (END) -------


----- FUNCTION ?L?COM04EE (BEGIN) -----
B2:00A68D E0                MOVX     A,@DPTR
B2:00A68E FD                MOV      R5,A
B2:00A68F C3                CLR      C
B2:00A690 EF                MOV      A,R7
B2:00A691 9D                SUBB     A,R5
B2:00A692 EE                MOV      A,R6
B2:00A693 9400              SUBB     A,#00H
B2:00A695 22                RET      
----- FUNCTION ?L?COM04EE (END) -------


----- FUNCTION ?L?COM0489 (BEGIN) -----
B2:00A696 124739            LCALL    _ZW_SerialPutByte_uart
B2:00A699 1247C0            LCALL    ZW_SerialFlush_uart
B2:00A69C 90466B            MOV      DPTR,#retVal
B2:00A69F 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 662


----- FUNCTION ?L?COM0489 (END) -------


----- FUNCTION ?L?COM030A (BEGIN) -----
B2:00A6A0 E4                CLR      A
B2:00A6A1 FF                MOV      R7,A
B2:00A6A2 B134              ACALL    _ConUpdate
B2:00A6A4 90413E            MOV      DPTR,#conVal
B2:00A6A7 EF                MOV      A,R7
B2:00A6A8 F0                MOVX     @DPTR,A
B2:00A6A9 22                RET      
----- FUNCTION ?L?COM030A (END) -------


----- FUNCTION _ConInit (BEGIN) -----
 FILE: 'CONHANDLE.C'
  323: ConInit(
  324:   WORD bBaudRate)  /* IN  Baud rate / 100 (e.g. 96=>9600baud/s, 1152=>115200baud/s) */
;---- Variable 'bBaudRate' assigned to Register 'R6/R7' ----
  325: {
  326: 
  327:   //0x0658idVendor=sigma. Insert your own idVendor here;
  328:   //0x0200: idProduct=SerialAPI. Insert your own idProduct here;
  329:   //Version 0x001
  330:   //ZW_Init_USB_Vendor(0x0658, 0x0200,0x001);
  331:   ZW_InitSerialIf(bBaudRate);
B2:00A6AA 12659B            LCALL    _ZW_InitSerialIf_uart
  332:   ZW_FinishSerialIf();
B2:00A6AD 126DCB            LCALL    ZW_FinishConfiguration_uart
  333: 
  334:   serBufLen = 0;
B2:00A6B0 E4                CLR      A
B2:00A6B1 9033FE            MOV      DPTR,#serBufLen
B2:00A6B4 F0                MOVX     @DPTR,A
  335:   con_state = stateSOFHunt;
B2:00A6B5 903403            MOV      DPTR,#con_state
B2:00A6B8 F0                MOVX     @DPTR,A
  336: }
B2:00A6B9 22                RET      
----- FUNCTION _ConInit (END) -------


----- FUNCTION _LedOn (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\LED_CONTROL.C'
   57: LedOn( BYTE Led )                       /* LED to turn on. */
   58: 
;---- Variable 'Led' assigned to Register 'R7' ----
   59: {
   60:   switch (Led)
B2:00A6BA EF                MOV      A,R7
B2:00A6BB 24FE              ADD      A,#0FEH
B2:00A6BD 6011              JZ       ?C0003?LED_CONTROL
B2:00A6BF 14                DEC      A
B2:00A6C0 6015              JZ       ?C0004?LED_CONTROL
B2:00A6C2 14                DEC      A
B2:00A6C3 6017              JZ       ?C0005?LED_CONTROL
B2:00A6C5 2403              ADD      A,#03H
B2:00A6C7 7019              JNZ      ?C0007?LED_CONTROL
   61:   {
   62:     case 1:
B2:00A6C9         ?C0002?LED_CONTROL:
   63:       LED_ON(1);
B2:00A6C9 536C7F            ANL      P0Shadow,#07FH
B2:00A6CC 856C80            MOV      P0,P0Shadow
   64:       break;
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 663


B2:00A6CF 22                RET      
   65:     case 2:
B2:00A6D0         ?C0003?LED_CONTROL:
   66:       LED_ON(2);
B2:00A6D0 536F7F            ANL      P3Shadow,#07FH
B2:00A6D3 856FB0            MOV      P3,P3Shadow
   67:       break;
B2:00A6D6 22                RET      
   68: #ifndef ZM5202
   69:     case 3:
B2:00A6D7         ?C0004?LED_CONTROL:
   70:       LED_ON(3);
B2:00A6D7 536DFE            ANL      P1Shadow,#0FEH
   71:       break;
B2:00A6DA 8003              SJMP     ?C0023?LED_CONTROL
   72:     case 4:
B2:00A6DC         ?C0005?LED_CONTROL:
   73:       LED_ON(4);
B2:00A6DC 536DFB            ANL      P1Shadow,#0FBH
B2:00A6DF         
B2:00A6DF 856D90            MOV      P1,P1Shadow
   74:       break;
   75: #endif
   76:     default:
   77:       break;
   78:   }
   79: }
B2:00A6E2         ?C0007?LED_CONTROL:
B2:00A6E2 22                RET      
----- FUNCTION _LedOn (END) -------


----- FUNCTION _LedOff (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\LED_CONTROL.C'
   88: LedOff( BYTE Led )                       /* LED to turn on. */
   89: 
;---- Variable 'Led' assigned to Register 'R7' ----
   90: {
   91:   switch (Led)
B2:00A6E3 EF                MOV      A,R7
B2:00A6E4 24FE              ADD      A,#0FEH
B2:00A6E6 6011              JZ       ?C0010?LED_CONTROL
B2:00A6E8 14                DEC      A
B2:00A6E9 6015              JZ       ?C0011?LED_CONTROL
B2:00A6EB 14                DEC      A
B2:00A6EC 6017              JZ       ?C0012?LED_CONTROL
B2:00A6EE 2403              ADD      A,#03H
B2:00A6F0 7019              JNZ      ?C0014?LED_CONTROL
   92:   {
   93:     case 1:
B2:00A6F2         ?C0009?LED_CONTROL:
   94:       LED_OFF(1);
B2:00A6F2 436C80            ORL      P0Shadow,#080H
B2:00A6F5 856C80            MOV      P0,P0Shadow
   95:       break;
B2:00A6F8 22                RET      
   96:     case 2:
B2:00A6F9         ?C0010?LED_CONTROL:
   97:       LED_OFF(2);
B2:00A6F9 436F80            ORL      P3Shadow,#080H
B2:00A6FC 856FB0            MOV      P3,P3Shadow
   98:       break;
B2:00A6FF 22                RET      
   99: #ifndef ZM5202
  100:     case 3:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 664


B2:00A700         ?C0011?LED_CONTROL:
  101:       LED_OFF(3);
B2:00A700 436D01            ORL      P1Shadow,#01H
  102:       break;
B2:00A703 8003              SJMP     ?C0024?LED_CONTROL
  103:     case 4:
B2:00A705         ?C0012?LED_CONTROL:
  104:       LED_OFF(4);
B2:00A705 436D04            ORL      P1Shadow,#04H
B2:00A708         
B2:00A708 856D90            MOV      P1,P1Shadow
  105:       break;
  106: #endif
  107:     default:
  108:       break;
  109:   }
  110: }
B2:00A70B         ?C0014?LED_CONTROL:
B2:00A70B 22                RET      
----- FUNCTION _LedOff (END) -------


----- FUNCTION _LedToggle (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\LED_CONTROL.C'
  119: LedToggle( BYTE Led )                       /* LED to toggle. */
  120: {
;---- Variable 'Led' assigned to Register 'R7' ----
  121:   switch (Led)
  122:   {
B2:00A70C EF                MOV      A,R7
B2:00A70D 24FE              ADD      A,#0FEH
B2:00A70F 6011              JZ       ?C0017?LED_CONTROL
B2:00A711 14                DEC      A
B2:00A712 6015              JZ       ?C0018?LED_CONTROL
B2:00A714 14                DEC      A
B2:00A715 6017              JZ       ?C0019?LED_CONTROL
B2:00A717 2403              ADD      A,#03H
B2:00A719 7019              JNZ      ?C0021?LED_CONTROL
  123:     case 1:
  124:       LED_TOGGLE(1);
B2:00A71B         ?C0016?LED_CONTROL:
  125:       break;
B2:00A71B 636C80            XRL      P0Shadow,#080H
B2:00A71E 856C80            MOV      P0,P0Shadow
  126:     case 2:
B2:00A721 22                RET      
  127:       LED_TOGGLE(2);
B2:00A722         ?C0017?LED_CONTROL:
  128:       break;
B2:00A722 636F80            XRL      P3Shadow,#080H
B2:00A725 856FB0            MOV      P3,P3Shadow
  129: #ifndef ZM5202
B2:00A728 22                RET      
  130:     case 3:
B2:00A729         ?C0018?LED_CONTROL:
  131:       LED_TOGGLE(3);
B2:00A729 636D01            XRL      P1Shadow,#01H
  132:       break;
B2:00A72C 8003              SJMP     ?C0025?LED_CONTROL
  133:     case 4:
B2:00A72E         ?C0019?LED_CONTROL:
  134:       LED_TOGGLE(4);
B2:00A72E 636D04            XRL      P1Shadow,#04H
B2:00A731         
B2:00A731 856D90            MOV      P1,P1Shadow
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 665


  135:       break;
  136: #endif      
  137:     default:
  138:       break;
  139:   }
  140: }
B2:00A734         ?C0021?LED_CONTROL:
B2:00A734 22                RET      
----- FUNCTION _LedToggle (END) -------


----- FUNCTION LedControlInit (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\LED_CONTROL.C'
  149: LedControlInit(void)
  150: {
  151:   /* Setup specifics for current dim module */
  152:   PIN_OUT(LED1);
B2:00A735 75FF01            MOV      SFRPAGE,#01H
B2:00A738 53687F            ANL      P0ShadowDIR,#07FH
B2:00A73B 8568FD            MOV      P0DIR,P0ShadowDIR
  153:   PIN_OUT(LED2);
B2:00A73E 75FF01            MOV      SFRPAGE,#01H
B2:00A741 536B7F            ANL      P3ShadowDIR,#07FH
B2:00A744 856BCB            MOV      P3DIR,P3ShadowDIR
  154: #ifndef ZM5202
  155:   PIN_OUT(LED3);
B2:00A747 75FF01            MOV      SFRPAGE,#01H
B2:00A74A 5369FE            ANL      P1ShadowDIR,#0FEH
B2:00A74D 8569C9            MOV      P1DIR,P1ShadowDIR
  156:   PIN_OUT(LED4);
B2:00A750 75FF01            MOV      SFRPAGE,#01H
B2:00A753 5369FB            ANL      P1ShadowDIR,#0FBH
B2:00A756 8569C9            MOV      P1DIR,P1ShadowDIR
  157: #endif
  158: }
B2:00A759 22                RET      
----- FUNCTION LedControlInit (END) -------


----- FUNCTION _ZW_NVRGetAppValue (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_NVR_APP_API.C'
   57: ZW_NVRGetAppValue(BYTE bOffset, BYTE bLength, BYTE *bRetBuffer)
   58: {
B2:00A75A 90453C            MOV      DPTR,#bOffset
B2:00A75D 126563            LCALL    ?L?COM00E9
B2:00A760 122572            LCALL    ?C?PSTXDATA
   59:   ZW_DEBUG_NVR_APP_SEND_BYTE('N');
B2:00A763         ?C0001?ZW_NVR_APP_API:
   60:   ZW_DEBUG_NVR_APP_SEND_BYTE('g');
   61:   ZW_DEBUG_NVR_APP_SEND_NUM(NVR_APP_START_ADDRESS + bOffset);
   62:   ZW_DEBUG_NVR_APP_SEND_BYTE(',');
   63:   while (bLength)
B2:00A763 90453D            MOV      DPTR,#bLength
B2:00A766 E0                MOVX     A,@DPTR
B2:00A767 6028              JZ       ?C0003?ZW_NVR_APP_API
   64:   {
   65:     /* NVR is valid, get value from NVR */
   66:     *bRetBuffer = ZW_FLASH_nvr0_get(bOffset + NVR_APP_START_ADDRESS);
B2:00A769 90453C            MOV      DPTR,#bOffset
B2:00A76C E0                MOVX     A,@DPTR
B2:00A76D 2480              ADD      A,#080H
B2:00A76F FF                MOV      R7,A
B2:00A770 121D6D            LCALL    ?INTERBANK_TABLE?_ZW_FLASH_nvr0_get
B2:00A773 90453E            MOV      DPTR,#bRetBuffer
B2:00A776 1256DF            LCALL    ?L?COM0125
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 666


   67: 
   68:     ZW_DEBUG_NVR_APP_SEND_NUM(*bRetBuffer);
   69: 
   70:     bRetBuffer++;
B2:00A779 90453F            MOV      DPTR,#bRetBuffer+01H
B2:00A77C E4                CLR      A
B2:00A77D 75F001            MOV      B,#01H
B2:00A780 12210C            LCALL    ?C?IILDX
   71:     bLength--;
B2:00A783 90453D            MOV      DPTR,#bLength
B2:00A786 E0                MOVX     A,@DPTR
B2:00A787 14                DEC      A
B2:00A788 F0                MOVX     @DPTR,A
   72:     bOffset++;
B2:00A789 90453C            MOV      DPTR,#bOffset
B2:00A78C E0                MOVX     A,@DPTR
B2:00A78D 04                INC      A
B2:00A78E F0                MOVX     @DPTR,A
   73:   }
B2:00A78F 80D2              SJMP     ?C0001?ZW_NVR_APP_API
   74:   ZW_DEBUG_NVR_APP_SEND_NL();
   75: }
B2:00A791         ?C0003?ZW_NVR_APP_API:
B2:00A791 22                RET      
----- FUNCTION _ZW_NVRGetAppValue (END) -------


----- FUNCTION ?L?COM00FE (BEGIN) -----
B2:00A792 F0                MOVX     @DPTR,A
B2:00A793 902160            MOV      DPTR,#applNodeInfo_deviceOptionsMask
B2:00A796 E0                MOVX     A,@DPTR
B2:00A797 90245C            MOV      DPTR,#m_AppNIF+0CH
B2:00A79A F0                MOVX     @DPTR,A
B2:00A79B 902165            MOV      DPTR,#applNodeInfo_nodeType_generic
B2:00A79E E0                MOVX     A,@DPTR
B2:00A79F 90245D            MOV      DPTR,#m_AppNIF+0DH
B2:00A7A2 F0                MOVX     @DPTR,A
B2:00A7A3 902161            MOV      DPTR,#applNodeInfo_nodeType_specific
B2:00A7A6 E0                MOVX     A,@DPTR
B2:00A7A7 90245E            MOV      DPTR,#m_AppNIF+0EH
B2:00A7AA F0                MOVX     @DPTR,A
B2:00A7AB 7B01              MOV      R3,#01H
B2:00A7AD 7A24              MOV      R2,#HIGH m_AppNIF
B2:00A7AF 7950              MOV      R1,#LOW m_AppNIF
----- FUNCTION _Transport_OnApplicationInitSW (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  152: Transport_OnApplicationInitSW(
  153:   APP_NODE_INFORMATION* pAppNode)
;---- Variable 'pAppNode' assigned to Register 'R1/R2/R3' ----
  154: {
  155:   m_AppInfo.u.pNifs = pAppNode;
B2:00A7B1 903D96            MOV      DPTR,#m_AppInfo
B2:00A7B4 122572            LCALL    ?C?PSTXDATA
  156: 
  157:   SetupActiveNIF(GetNodeId());
B2:00A7B7 129BCD            LCALL    GetNodeId
B2:00A7BA 129CC9            LCALL    _SetupActiveNIF
  158: 
  159:   ZW_DEBUG_SECURITY_SEND_STR("SecAppInit ");
  160:   ZW_DEBUG_SECURITY_SEND_NL();
  161: 
  162: #ifndef SERIAL_API_APP
  163:   mutex_init();
  164: #endif
  165: 
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 667


  166:   return TRUE;
B2:00A7BD 7F01              MOV      R7,#01H
  167: }
B2:00A7BF 22                RET      
----- FUNCTION _Transport_OnApplicationInitSW (END) -------


----- FUNCTION Transport_SetDefault (BEGIN) -----
 FILE: '..\APPLICATIONUTILITIES\ZW_TRANSPORTSECPROTOCOL.C'
  345: Transport_SetDefault()
  346: {
  347: }
  348: 
B2:00A7C0 22                RET      
----- FUNCTION Transport_SetDefault (END) -------


----- FUNCTION ?L?COM0068 (BEGIN) -----
B2:00A7C1 122234            LCALL    ?C?LADD
B2:00A7C4 A804              MOV      R0,AR4
B2:00A7C6 A905              MOV      R1,AR5
B2:00A7C8 AA06              MOV      R2,AR6
B2:00A7CA AB07              MOV      R3,AR7
B2:00A7CC A3                INC      DPTR
B2:00A7CD         ?L?COM0069:
B2:00A7CD E0                MOVX     A,@DPTR
B2:00A7CE FF                MOV      R7,A
B2:00A7CF E4                CLR      A
B2:00A7D0 FC                MOV      R4,A
B2:00A7D1 FD                MOV      R5,A
B2:00A7D2 FE                MOV      R6,A
B2:00A7D3 22                RET      
----- FUNCTION ?L?COM0068 (END) -------


----- FUNCTION ?L?COM00F8 (BEGIN) -----
B2:00A7D4 FE                MOV      R6,A
B2:00A7D5         ?L?COM00F9:
B2:00A7D5 240C              ADD      A,#LOW serBuf+05H
B2:00A7D7         ?L?COM00FA:
B2:00A7D7 F582              MOV      DPL,A
B2:00A7D9 E4                CLR      A
B2:00A7DA 3434              ADDC     A,#HIGH serBuf+05H
B2:00A7DC F583              MOV      DPH,A
B2:00A7DE E0                MOVX     A,@DPTR
B2:00A7DF 22                RET      
----- FUNCTION ?L?COM00F8 (END) -------


----- FUNCTION ?L?COM00FB (BEGIN) -----
B2:00A7E0 90340A            MOV      DPTR,#serBuf+03H
B2:00A7E3         ?L?COM00FC:
B2:00A7E3 E0                MOVX     A,@DPTR
B2:00A7E4 FE                MOV      R6,A
B2:00A7E5 A3                INC      DPTR
B2:00A7E6 E0                MOVX     A,@DPTR
B2:00A7E7 7C00              MOV      R4,#00H
B2:00A7E9 2400              ADD      A,#00H
B2:00A7EB FF                MOV      R7,A
B2:00A7EC EC                MOV      A,R4
B2:00A7ED 3E                ADDC     A,R6
B2:00A7EE FE                MOV      R6,A
B2:00A7EF 22                RET      
----- FUNCTION ?L?COM00FB (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 668



----- FUNCTION ?L?COM0131 (BEGIN) -----
B2:00A7F0 F583              MOV      DPH,A
B2:00A7F2 ED                MOV      A,R5
B2:00A7F3         ?L?COM0132:
B2:00A7F3 F0                MOVX     @DPTR,A
B2:00A7F4 740D              MOV      A,#LOW serBuf+06H
B2:00A7F6 2E                ADD      A,R6
B2:00A7F7         ?L?COM0133:
B2:00A7F7 F582              MOV      DPL,A
B2:00A7F9 E4                CLR      A
B2:00A7FA 3434              ADDC     A,#HIGH serBuf+06H
B2:00A7FC F583              MOV      DPH,A
B2:00A7FE E0                MOVX     A,@DPTR
B2:00A7FF 22                RET      
----- FUNCTION ?L?COM0131 (END) -------


----- FUNCTION ?L?COM017A (BEGIN) -----
B2:00A800 EF                MOV      A,R7
B2:00A801 25E0              ADD      A,ACC
B2:00A803 246C              ADD      A,#LOW powerManagementWakeUpOnRF
B2:00A805 F582              MOV      DPL,A
B2:00A807 E4                CLR      A
B2:00A808 3424              ADDC     A,#HIGH powerManagementWakeUpOnRF
B2:00A80A F583              MOV      DPH,A
B2:00A80C E4                CLR      A
B2:00A80D F0                MOVX     @DPTR,A
B2:00A80E         ?L?COM017B:
B2:00A80E EF                MOV      A,R7
B2:00A80F         ?L?COM017C:
B2:00A80F 25E0              ADD      A,ACC
B2:00A811 246D              ADD      A,#LOW powerManagementWakeUpOnRF+01H
B2:00A813 F582              MOV      DPL,A
B2:00A815 E4                CLR      A
B2:00A816 3424              ADDC     A,#HIGH powerManagementWakeUpOnRF+01H
B2:00A818 F583              MOV      DPH,A
B2:00A81A 22                RET      
----- FUNCTION ?L?COM017A (END) -------


----- FUNCTION ?L?COM0198 (BEGIN) -----
B2:00A81B 7B01              MOV      R3,#01H
B2:00A81D 7A41              MOV      R2,#HIGH sNetSats
B2:00A81F 7942              MOV      R1,#LOW sNetSats
B2:00A821 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0198 (END) -------


----- FUNCTION ?L?COM019B (BEGIN) -----
B2:00A824 904142            MOV      DPTR,#NVMBackupRestoreOperationInProgress
B2:00A827 F0                MOVX     @DPTR,A
B2:00A828 90340B            MOV      DPTR,#serBuf+04H
B2:00A82B E0                MOVX     A,@DPTR
B2:00A82C 904145            MOV      DPTR,#dataLength
B2:00A82F F0                MOVX     @DPTR,A
B2:00A830 FD                MOV      R5,A
B2:00A831 90340C            MOV      DPTR,#serBuf+05H
B2:00A834 E0                MOVX     A,@DPTR
B2:00A835 FE                MOV      R6,A
B2:00A836 A3                INC      DPTR
B2:00A837 E0                MOVX     A,@DPTR
B2:00A838 7A00              MOV      R2,#00H
B2:00A83A 2400              ADD      A,#00H
B2:00A83C FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 669


B2:00A83D EA                MOV      A,R2
B2:00A83E 3E                ADDC     A,R6
B2:00A83F 904143            MOV      DPTR,#NVM_WorkPtr
B2:00A842 F0                MOVX     @DPTR,A
B2:00A843 A3                INC      DPTR
B2:00A844 EF                MOV      A,R7
B2:00A845 F0                MOVX     @DPTR,A
B2:00A846 ED                MOV      A,R5
B2:00A847 22                RET      
----- FUNCTION ?L?COM019B (END) -------


----- FUNCTION ?L?COM019C (BEGIN) -----
B2:00A848 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B2:00A84B         ?L?COM019D:
B2:00A84B EE                MOV      A,R6
B2:00A84C F0                MOVX     @DPTR,A
B2:00A84D A3                INC      DPTR
B2:00A84E EF                MOV      A,R7
B2:00A84F         ?L?COM019E:
B2:00A84F F0                MOVX     @DPTR,A
B2:00A850         ?L?COM019F:
B2:00A850 7B01              MOV      R3,#01H
B2:00A852 7A20              MOV      R2,#HIGH workbuf
B2:00A854 79AA              MOV      R1,#LOW workbuf
B2:00A856 22                RET      
----- FUNCTION ?L?COM019C (END) -------


----- FUNCTION ?L?COM01E4 (BEGIN) -----
B2:00A857 E4                CLR      A
B2:00A858 90279F            MOV      DPTR,#retVal
B2:00A85B F0                MOVX     @DPTR,A
B2:00A85C 903407            MOV      DPTR,#serBuf
B2:00A85F 22                RET      
----- FUNCTION ?L?COM01E4 (END) -------


----- FUNCTION ?L?COM0213 (BEGIN) -----
B2:00A860 75F0AA            MOV      B,#0AAH
B2:00A863 9024CD            MOV      DPTR,#commandQueue+03H
B2:00A866 022546            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM0213 (END) -------


----- FUNCTION ?L?COM0220 (BEGIN) -----
B2:00A869 904144            MOV      DPTR,#length
B2:00A86C E0                MOVX     A,@DPTR
B2:00A86D FC                MOV      R4,A
B2:00A86E A3                INC      DPTR
B2:00A86F E0                MOVX     A,@DPTR
B2:00A870 FD                MOV      R5,A
B2:00A871 22                RET      
----- FUNCTION ?L?COM0220 (END) -------


----- FUNCTION ?L?COM0233 (BEGIN) -----
B2:00A872 90340A            MOV      DPTR,#serBuf+03H
B2:00A875 E0                MOVX     A,@DPTR
B2:00A876 FF                MOV      R7,A
B2:00A877 904142            MOV      DPTR,#dataLength
B2:00A87A E0                MOVX     A,@DPTR
B2:00A87B FD                MOV      R5,A
B2:00A87C         ?L?COM0234:
B2:00A87C 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 670


B2:00A87E 7A20              MOV      R2,#HIGH compl_workbuf
B2:00A880 7901              MOV      R1,#LOW compl_workbuf
B2:00A882 22                RET      
----- FUNCTION ?L?COM0233 (END) -------


----- FUNCTION ?L?COM0235 (BEGIN) -----
B2:00A883 A3                INC      DPTR
B2:00A884 E0                MOVX     A,@DPTR
B2:00A885 7B00              MOV      R3,#00H
B2:00A887 FA                MOV      R2,A
B2:00A888 E4                CLR      A
B2:00A889 F9                MOV      R1,A
B2:00A88A F8                MOV      R0,A
B2:00A88B 22                RET      
----- FUNCTION ?L?COM0235 (END) -------


----- FUNCTION ?L?COM025E (BEGIN) -----
B2:00A88C E0                MOVX     A,@DPTR
B2:00A88D 24A5              ADD      A,#LOW applNodeInfo_unincluded_nodeParm
B2:00A88F         ?L?COM025F:
B2:00A88F F582              MOV      DPL,A
B2:00A891 E4                CLR      A
B2:00A892 3427              ADDC     A,#HIGH applNodeInfo_unincluded_nodeParm
B2:00A894 F583              MOV      DPH,A
B2:00A896 22                RET      
----- FUNCTION ?L?COM025E (END) -------


----- FUNCTION ?L?COM0260 (BEGIN) -----
B2:00A897 740B              MOV      A,#LOW serBuf+04H
B2:00A899 2E                ADD      A,R6
B2:00A89A         ?L?COM0261:
B2:00A89A F582              MOV      DPL,A
B2:00A89C E4                CLR      A
B2:00A89D 3434              ADDC     A,#HIGH serBuf+04H
B2:00A89F F583              MOV      DPH,A
B2:00A8A1 E0                MOVX     A,@DPTR
B2:00A8A2 22                RET      
----- FUNCTION ?L?COM0260 (END) -------


----- FUNCTION ?L?COM0264 (BEGIN) -----
B2:00A8A3 FE                MOV      R6,A
B2:00A8A4         ?L?COM0265:
B2:00A8A4 F0                MOVX     @DPTR,A
B2:00A8A5         ?L?COM0266:
B2:00A8A5 90340A            MOV      DPTR,#serBuf+03H
B2:00A8A8 E0                MOVX     A,@DPTR
B2:00A8A9 FF                MOV      R7,A
B2:00A8AA A3                INC      DPTR
B2:00A8AB E0                MOVX     A,@DPTR
B2:00A8AC FD                MOV      R5,A
B2:00A8AD 22                RET      
----- FUNCTION ?L?COM0264 (END) -------


----- FUNCTION ?L?COM0273 (BEGIN) -----
B2:00A8AE 904145            MOV      DPTR,#dataLength
B2:00A8B1 E0                MOVX     A,@DPTR
B2:00A8B2 FF                MOV      R7,A
B2:00A8B3 904144            MOV      DPTR,#NVM_WorkPtr+01H
B2:00A8B6 E0                MOVX     A,@DPTR
B2:00A8B7 2F                ADD      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 671


B2:00A8B8 FF                MOV      R7,A
B2:00A8B9 904143            MOV      DPTR,#NVM_WorkPtr
B2:00A8BC E0                MOVX     A,@DPTR
B2:00A8BD 3400              ADDC     A,#00H
B2:00A8BF FE                MOV      R6,A
B2:00A8C0 D3                SETB     C
B2:00A8C1 EF                MOV      A,R7
B2:00A8C2 9484              SUBB     A,#LOW _HDATA_E_
B2:00A8C4 EE                MOV      A,R6
B2:00A8C5 941C              SUBB     A,#HIGH _HDATA_E_
B2:00A8C7 22                RET      
----- FUNCTION ?L?COM0273 (END) -------


----- FUNCTION ?L?COM028A (BEGIN) -----
B2:00A8C8 E0                MOVX     A,@DPTR
B2:00A8C9 FF                MOV      R7,A
B2:00A8CA         ?L?COM028B:
B2:00A8CA 240E              ADD      A,#LOW serBuf+07H
B2:00A8CC         ?L?COM028C:
B2:00A8CC F582              MOV      DPL,A
B2:00A8CE E4                CLR      A
B2:00A8CF 3434              ADDC     A,#HIGH serBuf+07H
B2:00A8D1 F583              MOV      DPH,A
B2:00A8D3 E0                MOVX     A,@DPTR
B2:00A8D4 22                RET      
----- FUNCTION ?L?COM028A (END) -------


----- FUNCTION ?L?COM029E (BEGIN) -----
B2:00A8D5 75F0AA            MOV      B,#0AAH
B2:00A8D8 902178            MOV      DPTR,#callbackQueue+04H
B2:00A8DB 022546            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM029E (END) -------


----- FUNCTION ?L?COM02A8 (BEGIN) -----
B2:00A8DE E4                CLR      A
B2:00A8DF 904142            MOV      DPTR,#dataLength
B2:00A8E2 F0                MOVX     @DPTR,A
B2:00A8E3 903407            MOV      DPTR,#serBuf
B2:00A8E6         ?L?COM02A9:
B2:00A8E6 E0                MOVX     A,@DPTR
B2:00A8E7 FF                MOV      R7,A
B2:00A8E8 7404              MOV      A,#04H
B2:00A8EA C3                CLR      C
B2:00A8EB 9F                SUBB     A,R7
B2:00A8EC 22                RET      
----- FUNCTION ?L?COM02A8 (END) -------


----- FUNCTION ?L?COM02BF (BEGIN) -----
B2:00A8ED E0                MOVX     A,@DPTR
B2:00A8EE 24A2              ADD      A,#LOW applNodeInfo_nodeParm
B2:00A8F0         ?L?COM02C0:
B2:00A8F0 F582              MOV      DPL,A
B2:00A8F2 E4                CLR      A
B2:00A8F3 3424              ADDC     A,#HIGH applNodeInfo_nodeParm
B2:00A8F5 F583              MOV      DPH,A
B2:00A8F7 22                RET      
----- FUNCTION ?L?COM02BF (END) -------


----- FUNCTION ?L?COM02F8 (BEGIN) -----
B2:00A8F8 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 672


B2:00A8F9 E4                CLR      A
B2:00A8FA 3414              ADDC     A,#HIGH EEOFFSET_MODULE_POWER_MODE_WUT_TIMEOUT_far
B2:00A8FC FE                MOV      R6,A
B2:00A8FD         ?L?COM02F9:
B2:00A8FD 121B8D            LCALL    ?INTERBANK_TABLE?_MemoryGetByte
B2:00A900 7F00              MOV      R7,#00H
B2:00A902 E4                CLR      A
B2:00A903 FC                MOV      R4,A
B2:00A904 FD                MOV      R5,A
B2:00A905 FE                MOV      R6,A
B2:00A906 22                RET      
----- FUNCTION ?L?COM02F8 (END) -------


----- FUNCTION ?L?COM02FA (BEGIN) -----
B2:00A907 902002            MOV      DPTR,#compl_workbuf+01H
B2:00A90A F0                MOVX     @DPTR,A
B2:00A90B 90340C            MOV      DPTR,#serBuf+05H
B2:00A90E E0                MOVX     A,@DPTR
B2:00A90F 902003            MOV      DPTR,#compl_workbuf+02H
B2:00A912 F0                MOVX     @DPTR,A
B2:00A913 90340D            MOV      DPTR,#serBuf+06H
B2:00A916 E0                MOVX     A,@DPTR
B2:00A917 902004            MOV      DPTR,#compl_workbuf+03H
B2:00A91A F0                MOVX     @DPTR,A
B2:00A91B 22                RET      
----- FUNCTION ?L?COM02FA (END) -------


----- FUNCTION ?L?COM0324 (BEGIN) -----
B2:00A91C 75F0AA            MOV      B,#0AAH
B2:00A91F 902177            MOV      DPTR,#callbackQueue+03H
B2:00A922 022546            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM0324 (END) -------


----- FUNCTION ?L?COM032E (BEGIN) -----
B2:00A925 90245F            MOV      DPTR,#applNodeInfo_unincluded_parmLength
B2:00A928 E0                MOVX     A,@DPTR
B2:00A929 902453            MOV      DPTR,#m_AppNIF+03H
B2:00A92C F0                MOVX     @DPTR,A
B2:00A92D 90243C            MOV      DPTR,#applNodeInfo_included_unsecure_parmLength
B2:00A930 E0                MOVX     A,@DPTR
B2:00A931 902457            MOV      DPTR,#m_AppNIF+07H
B2:00A934 F0                MOVX     @DPTR,A
B2:00A935 22                RET      
----- FUNCTION ?L?COM032E (END) -------


----- FUNCTION ?L?COM032F (BEGIN) -----
B2:00A936 902002            MOV      DPTR,#compl_workbuf+01H
B2:00A939 7401              MOV      A,#01H
B2:00A93B F0                MOVX     @DPTR,A
B2:00A93C 90279F            MOV      DPTR,#retVal
B2:00A93F E0                MOVX     A,@DPTR
B2:00A940 902003            MOV      DPTR,#compl_workbuf+02H
B2:00A943 F0                MOVX     @DPTR,A
B2:00A944 7F03              MOV      R7,#03H
B2:00A946 22                RET      
----- FUNCTION ?L?COM032F (END) -------


----- FUNCTION ?L?COM035E (BEGIN) -----
B2:00A947 902172            MOV      DPTR,#retry
B2:00A94A E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 673


B2:00A94B FF                MOV      R7,A
B2:00A94C 04                INC      A
B2:00A94D F0                MOVX     @DPTR,A
B2:00A94E EF                MOV      A,R7
B2:00A94F C3                CLR      C
B2:00A950 22                RET      
----- FUNCTION ?L?COM035E (END) -------


----- FUNCTION ?L?COM035F (BEGIN) -----
B2:00A951 E4                CLR      A
B2:00A952 904142            MOV      DPTR,#startXAdr
B2:00A955 F0                MOVX     @DPTR,A
B2:00A956 A3                INC      DPTR
B2:00A957 F0                MOVX     @DPTR,A
B2:00A958 22                RET      
----- FUNCTION ?L?COM035F (END) -------


----- FUNCTION ?L?COM0360 (BEGIN) -----
B2:00A959 F582              MOV      DPL,A
B2:00A95B E4                CLR      A
B2:00A95C 3424              ADDC     A,#HIGH applNodeInfo_included_unsecure_nodeParm
B2:00A95E F583              MOV      DPH,A
B2:00A960 22                RET      
----- FUNCTION ?L?COM0360 (END) -------


----- FUNCTION ?L?COM0361 (BEGIN) -----
B2:00A961 FE                MOV      R6,A
B2:00A962         ?L?COM0362:
B2:00A962 904142            MOV      DPTR,#dataLength
B2:00A965 F0                MOVX     @DPTR,A
B2:00A966 A3                INC      DPTR
B2:00A967 EF                MOV      A,R7
B2:00A968 F0                MOVX     @DPTR,A
B2:00A969 22                RET      
----- FUNCTION ?L?COM0361 (END) -------


----- FUNCTION ?L?COM037C (BEGIN) -----
B2:00A96A E0                MOVX     A,@DPTR
B2:00A96B FF                MOV      R7,A
B2:00A96C 7407              MOV      A,#LOW compl_workbuf+06H
B2:00A96E 2E                ADD      A,R6
B2:00A96F F582              MOV      DPL,A
B2:00A971 E4                CLR      A
B2:00A972 3420              ADDC     A,#HIGH compl_workbuf+06H
B2:00A974 F583              MOV      DPH,A
B2:00A976 EF                MOV      A,R7
B2:00A977 22                RET      
----- FUNCTION ?L?COM037C (END) -------


----- FUNCTION ?L?COM0395 (BEGIN) -----
B2:00A978 FE                MOV      R6,A
B2:00A979 7402              MOV      A,#LOW compl_workbuf+01H
B2:00A97B 2F                ADD      A,R7
B2:00A97C F582              MOV      DPL,A
B2:00A97E E4                CLR      A
B2:00A97F 3420              ADDC     A,#HIGH compl_workbuf+01H
B2:00A981 F583              MOV      DPH,A
B2:00A983 EE                MOV      A,R6
B2:00A984 F0                MOVX     @DPTR,A
B2:00A985 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 674


----- FUNCTION ?L?COM0395 (END) -------


----- FUNCTION ?L?COM0396 (BEGIN) -----
B2:00A986 9024C6            MOV      DPTR,#i
B2:00A989 E0                MOVX     A,@DPTR
B2:00A98A FF                MOV      R7,A
B2:00A98B 14                DEC      A
B2:00A98C F0                MOVX     @DPTR,A
B2:00A98D EF                MOV      A,R7
B2:00A98E 22                RET      
----- FUNCTION ?L?COM0396 (END) -------


----- FUNCTION ?L?COM0398 (BEGIN) -----
B2:00A98F 90340B            MOV      DPTR,#serBuf+04H
B2:00A992 E0                MOVX     A,@DPTR
B2:00A993 904142            MOV      DPTR,#dataLength
B2:00A996 F0                MOVX     @DPTR,A
B2:00A997 22                RET      
----- FUNCTION ?L?COM0398 (END) -------


----- FUNCTION ?L?COM0399 (BEGIN) -----
B2:00A998 7B01              MOV      R3,#01H
B2:00A99A 7D06              MOV      R5,#06H
B2:00A99C E4                CLR      A
B2:00A99D FF                MOV      R7,A
B2:00A99E 121B79            LCALL    ?INTERBANK_TABLE?___ZW_memset
B2:00A9A1 90340A            MOV      DPTR,#serBuf+03H
B2:00A9A4 E0                MOVX     A,@DPTR
B2:00A9A5 22                RET      
----- FUNCTION ?L?COM0399 (END) -------


----- FUNCTION ?L?COM03BE (BEGIN) -----
B2:00A9A6 902466            MOV      DPTR,#applPowerModeWutTimeOut
B2:00A9A9 02247E            LJMP     ?C?LLDXDATA0
----- FUNCTION ?L?COM03BE (END) -------


----- FUNCTION ?L?COM03CD (BEGIN) -----
B2:00A9AC 9024C6            MOV      DPTR,#i
B2:00A9AF         ?L?COM03CE:
B2:00A9AF E0                MOVX     A,@DPTR
B2:00A9B0 902001            MOV      DPTR,#compl_workbuf
B2:00A9B3 F0                MOVX     @DPTR,A
B2:00A9B4 04                INC      A
B2:00A9B5 22                RET      
----- FUNCTION ?L?COM03CD (END) -------


----- FUNCTION ?L?COM03CF (BEGIN) -----
B2:00A9B6 A3                INC      DPTR
B2:00A9B7 E0                MOVX     A,@DPTR
B2:00A9B8 FF                MOV      R7,A
B2:00A9B9 7484              MOV      A,#LOW _HDATA_E_
B2:00A9BB 9F                SUBB     A,R7
B2:00A9BC 04                INC      A
B2:00A9BD A3                INC      DPTR
B2:00A9BE F0                MOVX     @DPTR,A
B2:00A9BF 902001            MOV      DPTR,#compl_workbuf
B2:00A9C2 22                RET      
----- FUNCTION ?L?COM03CF (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 675



----- FUNCTION ?L?COM03D0 (BEGIN) -----
B2:00A9C3 FF                MOV      R7,A
B2:00A9C4 75F0AA            MOV      B,#0AAH
B2:00A9C7 EE                MOV      A,R6
B2:00A9C8 122546            LCALL    ?C?OFFXADD
B2:00A9CB AB82              MOV      R3,DPL
B2:00A9CD AA83              MOV      R2,DPH
B2:00A9CF 22                RET      
----- FUNCTION ?L?COM03D0 (END) -------


----- FUNCTION ?L?COM03FF (BEGIN) -----
B2:00A9D0 F582              MOV      DPL,A
B2:00A9D2 E4                CLR      A
B2:00A9D3 3427              ADDC     A,#HIGH applNodeInfo_included_secure_nodeParm
B2:00A9D5 F583              MOV      DPH,A
B2:00A9D7 22                RET      
----- FUNCTION ?L?COM03FF (END) -------


----- FUNCTION ?L?COM040B (BEGIN) -----
B2:00A9D8 25E0              ADD      A,ACC
B2:00A9DA 246C              ADD      A,#LOW powerManagementWakeUpOnRF
B2:00A9DC F582              MOV      DPL,A
B2:00A9DE E4                CLR      A
B2:00A9DF 3424              ADDC     A,#HIGH powerManagementWakeUpOnRF
B2:00A9E1 F583              MOV      DPH,A
B2:00A9E3 22                RET      
----- FUNCTION ?L?COM040B (END) -------


----- FUNCTION ?L?COM0411 (BEGIN) -----
B2:00A9E4 E0                MOVX     A,@DPTR
B2:00A9E5 FF                MOV      R7,A
B2:00A9E6 04                INC      A
B2:00A9E7 F0                MOVX     @DPTR,A
B2:00A9E8 7401              MOV      A,#LOW compl_workbuf
B2:00A9EA 2F                ADD      A,R7
B2:00A9EB 22                RET      
----- FUNCTION ?L?COM0411 (END) -------


----- FUNCTION ?L?COM043A (BEGIN) -----
B2:00A9EC 902442            MOV      DPTR,#powerManagementWakeUpOnTimer
B2:00A9EF F0                MOVX     @DPTR,A
B2:00A9F0 902461            MOV      DPTR,#powerManagementWakeUpOnTimerCount
B2:00A9F3 F0                MOVX     @DPTR,A
B2:00A9F4 A3                INC      DPTR
B2:00A9F5 F0                MOVX     @DPTR,A
B2:00A9F6 22                RET      
----- FUNCTION ?L?COM043A (END) -------


----- FUNCTION ?L?COM043C (BEGIN) -----
B2:00A9F7 EF                MOV      A,R7
B2:00A9F8 25E0              ADD      A,ACC
B2:00A9FA 2405              ADD      A,#05H
B2:00A9FC FF                MOV      R7,A
B2:00A9FD 903407            MOV      DPTR,#serBuf
B2:00AA00 E0                MOVX     A,@DPTR
B2:00AA01 22                RET      
----- FUNCTION ?L?COM043C (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 676


----- FUNCTION ?L?COM043D (BEGIN) -----
B2:00AA02 E0                MOVX     A,@DPTR
B2:00AA03 FE                MOV      R6,A
B2:00AA04 A3                INC      DPTR
B2:00AA05 E0                MOVX     A,@DPTR
B2:00AA06 2400              ADD      A,#00H
B2:00AA08 FD                MOV      R5,A
B2:00AA09 E4                CLR      A
B2:00AA0A 33                RLC      A
B2:00AA0B FC                MOV      R4,A
B2:00AA0C 22                RET      
----- FUNCTION ?L?COM043D (END) -------


----- FUNCTION ?L?COM0450 (BEGIN) -----
B2:00AA0D 245A              ADD      A,#LOW sPowerlevels+03H
B2:00AA0F F582              MOV      DPL,A
B2:00AA11 E4                CLR      A
B2:00AA12 3421              ADDC     A,#HIGH sPowerlevels+03H
B2:00AA14 F583              MOV      DPH,A
B2:00AA16 22                RET      
----- FUNCTION ?L?COM0450 (END) -------


----- FUNCTION ?L?COM045F (BEGIN) -----
B2:00AA17 7B01              MOV      R3,#01H
B2:00AA19 7A41              MOV      R2,#HIGH ltTxOptionsMultiEx
B2:00AA1B 7942              MOV      R1,#LOW ltTxOptionsMultiEx
B2:00AA1D 22                RET      
----- FUNCTION ?L?COM045F (END) -------


----- FUNCTION ?L?COM046B (BEGIN) -----
B2:00AA1E 75F0AA            MOV      B,#0AAH
B2:00AA21 9024CE            MOV      DPTR,#commandQueue+04H
B2:00AA24 022546            LJMP     ?C?OFFXADD
----- FUNCTION ?L?COM046B (END) -------


----- FUNCTION ?L?COM0477 (BEGIN) -----
B2:00AA27 7C14              MOV      R4,#HIGH EEOFFSET_HOST_OFFSET_START_far
B2:00AA29 7D6B              MOV      R5,#LOW EEOFFSET_HOST_OFFSET_START_far
B2:00AA2B EF                MOV      A,R7
B2:00AA2C 2D                ADD      A,R5
B2:00AA2D FF                MOV      R7,A
B2:00AA2E EE                MOV      A,R6
B2:00AA2F 3C                ADDC     A,R4
B2:00AA30 22                RET      
----- FUNCTION ?L?COM0477 (END) -------


----- FUNCTION ?L?COM048B (BEGIN) -----
B2:00AA31 E0                MOVX     A,@DPTR
B2:00AA32 902002            MOV      DPTR,#compl_workbuf+01H
B2:00AA35 F0                MOVX     @DPTR,A
B2:00AA36 902160            MOV      DPTR,#applNodeInfo_deviceOptionsMask
B2:00AA39 E0                MOVX     A,@DPTR
B2:00AA3A 22                RET      
----- FUNCTION ?L?COM048B (END) -------


----- FUNCTION ?L?COM048C (BEGIN) -----
B2:00AA3B 2457              ADD      A,#LOW sPowerlevels
B2:00AA3D F582              MOV      DPL,A
B2:00AA3F E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 677


B2:00AA40 3421              ADDC     A,#HIGH sPowerlevels
B2:00AA42 F583              MOV      DPH,A
B2:00AA44 22                RET      
----- FUNCTION ?L?COM048C (END) -------


----- FUNCTION ?L?COM048D (BEGIN) -----
B2:00AA45 7E00              MOV      R6,#00H
B2:00AA47 7458              MOV      A,#LOW EEOFFSET_POWERLEVEL_NORMAL_far
B2:00AA49 2F                ADD      A,R7
B2:00AA4A FF                MOV      R7,A
B2:00AA4B EE                MOV      A,R6
B2:00AA4C 3414              ADDC     A,#HIGH EEOFFSET_POWERLEVEL_NORMAL_far
B2:00AA4E 22                RET      
----- FUNCTION ?L?COM048D (END) -------


----- FUNCTION ?L?COM048E (BEGIN) -----
B2:00AA4F EE                MOV      A,R6
B2:00AA50 7E00              MOV      R6,#00H
B2:00AA52 2435              ADD      A,#LOW EEOFFSET_CMDCLASS_INCLUDED_SECURE_far
B2:00AA54 FF                MOV      R7,A
B2:00AA55 EE                MOV      A,R6
B2:00AA56 3414              ADDC     A,#HIGH EEOFFSET_CMDCLASS_INCLUDED_SECURE_far
B2:00AA58 22                RET      
----- FUNCTION ?L?COM048E (END) -------


----- FUNCTION ?L?COM048F (BEGIN) -----
B2:00AA59 EE                MOV      A,R6
B2:00AA5A 7E00              MOV      R6,#00H
B2:00AA5C 2411              ADD      A,#LOW EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_far
B2:00AA5E FF                MOV      R7,A
B2:00AA5F EE                MOV      A,R6
B2:00AA60 3414              ADDC     A,#HIGH EEOFFSET_CMDCLASS_INCLUDED_UNSECURE_far
B2:00AA62 22                RET      
----- FUNCTION ?L?COM048F (END) -------


----- FUNCTION ?L?COM0490 (BEGIN) -----
B2:00AA63 EE                MOV      A,R6
B2:00AA64 7E00              MOV      R6,#00H
B2:00AA66 24ED              ADD      A,#LOW EEOFFSET_CMDCLASS_UNINCLUDED_far
B2:00AA68 FF                MOV      R7,A
B2:00AA69 EE                MOV      A,R6
B2:00AA6A 3413              ADDC     A,#HIGH EEOFFSET_CMDCLASS_UNINCLUDED_far
B2:00AA6C 22                RET      
----- FUNCTION ?L?COM0490 (END) -------


----- FUNCTION ?L?COM0491 (BEGIN) -----
B2:00AA6D EE                MOV      A,R6
B2:00AA6E 7E00              MOV      R6,#00H
B2:00AA70 24C8              ADD      A,#LOW EEOFFSET_CMDCLASS_far
B2:00AA72 FF                MOV      R7,A
B2:00AA73 EE                MOV      A,R6
B2:00AA74 3413              ADDC     A,#HIGH EEOFFSET_CMDCLASS_far
B2:00AA76 22                RET      
----- FUNCTION ?L?COM0491 (END) -------


----- FUNCTION ?L?COM0492 (BEGIN) -----
B2:00AA77 902153            MOV      DPTR,#powerManagementWakeUpOnExternal
B2:00AA7A 74FF              MOV      A,#0FFH
B2:00AA7C F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 678


B2:00AA7D E4                CLR      A
B2:00AA7E A3                INC      DPTR
B2:00AA7F F0                MOVX     @DPTR,A
B2:00AA80 22                RET      
----- FUNCTION ?L?COM0492 (END) -------


----- FUNCTION ?L?COM0494 (BEGIN) -----
B2:00AA81 E4                CLR      A
B2:00AA82 33                RLC      A
B2:00AA83 90279F            MOV      DPTR,#retVal
B2:00AA86 F0                MOVX     @DPTR,A
B2:00AA87 22                RET      
----- FUNCTION ?L?COM0494 (END) -------


----- FUNCTION ?L?COM0495 (BEGIN) -----
B2:00AA88 F0                MOVX     @DPTR,A
B2:00AA89 7E13              MOV      R6,#HIGH EEOFFSET_WATCHDOG_STARTED_far
B2:00AA8B 7FEB              MOV      R7,#LOW EEOFFSET_WATCHDOG_STARTED_far
B2:00AA8D FD                MOV      R5,A
B2:00AA8E 021B92            LJMP     ?INTERBANK_TABLE?_MemoryPutByte
----- FUNCTION ?L?COM0495 (END) -------


----- FUNCTION ?L?COM04EA (BEGIN) -----
B2:00AA91 EF                MOV      A,R7
B2:00AA92 246B              ADD      A,#LOW EEOFFSET_HOST_OFFSET_START_far
B2:00AA94 FF                MOV      R7,A
B2:00AA95 EE                MOV      A,R6
B2:00AA96 3414              ADDC     A,#HIGH EEOFFSET_HOST_OFFSET_START_far
B2:00AA98 FE                MOV      R6,A
B2:00AA99 22                RET      
----- FUNCTION ?L?COM04EA (END) -------


----- FUNCTION ?L?COM04F0 (BEGIN) -----
B2:00AA9A 7E00              MOV      R6,#00H
B2:00AA9C 245B              ADD      A,#LOW EEOFFSET_POWERLEVEL_LOW_far
B2:00AA9E FF                MOV      R7,A
B2:00AA9F EE                MOV      A,R6
B2:00AAA0 3414              ADDC     A,#HIGH EEOFFSET_POWERLEVEL_LOW_far
B2:00AAA2 22                RET      
----- FUNCTION ?L?COM04F0 (END) -------


----- FUNCTION ?L?COM04F1 (BEGIN) -----
B2:00AAA3 90340A            MOV      DPTR,#serBuf+03H
B2:00AAA6 E0                MOVX     A,@DPTR
B2:00AAA7 902001            MOV      DPTR,#compl_workbuf
B2:00AAAA F0                MOVX     @DPTR,A
B2:00AAAB 22                RET      
----- FUNCTION ?L?COM04F1 (END) -------


----- FUNCTION ?L?COM04F2 (BEGIN) -----
B2:00AAAC E0                MOVX     A,@DPTR
B2:00AAAD FF                MOV      R7,A
B2:00AAAE 9024C6            MOV      DPTR,#i
B2:00AAB1 E0                MOVX     A,@DPTR
B2:00AAB2 C3                CLR      C
B2:00AAB3 9F                SUBB     A,R7
B2:00AAB4 22                RET      
----- FUNCTION ?L?COM04F2 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 679



----- FUNCTION ?L?COM04F3 (BEGIN) -----
B2:00AAB5 90340A            MOV      DPTR,#serBuf+03H
B2:00AAB8 E0                MOVX     A,@DPTR
B2:00AAB9 904146            MOV      DPTR,#bFirmwareUpdateFunction
B2:00AABC F0                MOVX     @DPTR,A
B2:00AABD 22                RET      
----- FUNCTION ?L?COM04F3 (END) -------


----- FUNCTION ?L?COM04F4 (BEGIN) -----
B2:00AABE F582              MOV      DPL,A
B2:00AAC0 7434              MOV      A,#HIGH serBuf+07H
B2:00AAC2 3C                ADDC     A,R4
B2:00AAC3 F583              MOV      DPH,A
B2:00AAC5 E0                MOVX     A,@DPTR
B2:00AAC6 22                RET      
----- FUNCTION ?L?COM04F4 (END) -------


----- FUNCTION ?L?COM04F5 (BEGIN) -----
B2:00AAC7 904142            MOV      DPTR,#NVM_WorkPtr
B2:00AACA E0                MOVX     A,@DPTR
B2:00AACB FE                MOV      R6,A
B2:00AACC A3                INC      DPTR
B2:00AACD E0                MOVX     A,@DPTR
B2:00AACE FF                MOV      R7,A
B2:00AACF 22                RET      
----- FUNCTION ?L?COM04F5 (END) -------


----- FUNCTION ?L?COM04F6 (BEGIN) -----
B2:00AAD0 74AA              MOV      A,#LOW workbuf
B2:00AAD2 2E                ADD      A,R6
B2:00AAD3 F582              MOV      DPL,A
B2:00AAD5 E4                CLR      A
B2:00AAD6 3420              ADDC     A,#HIGH workbuf
B2:00AAD8 22                RET      
----- FUNCTION ?L?COM04F6 (END) -------


----- FUNCTION ?L?COM054A (BEGIN) -----
B2:00AAD9 E4                CLR      A
B2:00AADA 9024C5            MOV      DPTR,#powerManagementWakeUpOnRFMode
B2:00AADD F0                MOVX     @DPTR,A
B2:00AADE A3                INC      DPTR
B2:00AADF F0                MOVX     @DPTR,A
B2:00AAE0 22                RET      
----- FUNCTION ?L?COM054A (END) -------


----- FUNCTION ?L?COM054C (BEGIN) -----
B2:00AAE1 EF                MOV      A,R7
B2:00AAE2 540F              ANL      A,#0FH
B2:00AAE4 FF                MOV      R7,A
B2:00AAE5 7407              MOV      A,#07H
B2:00AAE7 9F                SUBB     A,R7
B2:00AAE8 22                RET      
----- FUNCTION ?L?COM054C (END) -------


----- FUNCTION ?L?COM054E (BEGIN) -----
B2:00AAE9 903407            MOV      DPTR,#serBuf
B2:00AAEC E0                MOVX     A,@DPTR
B2:00AAED FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 680


B2:00AAEE 740A              MOV      A,#0AH
B2:00AAF0 22                RET      
----- FUNCTION ?L?COM054E (END) -------


----- FUNCTION ?L?COM054F (BEGIN) -----
B2:00AAF1 2410              ADD      A,#LOW serBuf+09H
B2:00AAF3 F582              MOV      DPL,A
B2:00AAF5 E4                CLR      A
B2:00AAF6 3434              ADDC     A,#HIGH serBuf+09H
B2:00AAF8 22                RET      
----- FUNCTION ?L?COM054F (END) -------


----- FUNCTION ?L?COM0550 (BEGIN) -----
B2:00AAF9 FF                MOV      R7,A
B2:00AAFA D3                SETB     C
B2:00AAFB ED                MOV      A,R5
B2:00AAFC 9F                SUBB     A,R7
B2:00AAFD EC                MOV      A,R4
B2:00AAFE 9400              SUBB     A,#00H
B2:00AB00 22                RET      
----- FUNCTION ?L?COM0550 (END) -------


----- FUNCTION ?L?COM0551 (BEGIN) -----
B2:00AB01 A3                INC      DPTR
B2:00AB02 E0                MOVX     A,@DPTR
B2:00AB03 2400              ADD      A,#00H
B2:00AB05 FF                MOV      R7,A
B2:00AB06 E4                CLR      A
B2:00AB07 33                RLC      A
B2:00AB08 22                RET      
----- FUNCTION ?L?COM0551 (END) -------


----- FUNCTION ?L?COM0553 (BEGIN) -----
B2:00AB09 E4                CLR      A
B2:00AB0A 2D                ADD      A,R5
B2:00AB0B FD                MOV      R5,A
B2:00AB0C EC                MOV      A,R4
B2:00AB0D 3408              ADDC     A,#08H
B2:00AB0F FC                MOV      R4,A
B2:00AB10 22                RET      
----- FUNCTION ?L?COM0553 (END) -------


----- FUNCTION ?L?COM0554 (BEGIN) -----
B2:00AB11 E0                MOVX     A,@DPTR
B2:00AB12 FF                MOV      R7,A
B2:00AB13 904142            MOV      DPTR,#numberNodes
B2:00AB16 E0                MOVX     A,@DPTR
B2:00AB17 2F                ADD      A,R7
B2:00AB18 22                RET      
----- FUNCTION ?L?COM0554 (END) -------


----- FUNCTION _TransportTimerStart (BEGIN) -----
;---- Variable 'wtimerTicks' assigned to Register 'R4/R5' ----
;---- Variable 'func' assigned to Register 'R2/R3' ----
B3:008000 AB07              MOV      R3,AR7
B3:008002 AA06              MOV      R2,AR6
B3:008004 1280A1            LCALL    ?L?COM0292
B3:008007 ED                MOV      A,R5
B3:008008 4C                ORL      A,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 681


B3:008009 7005              JNZ      ?C0001?ZW_TRANSPORT_TIMER
B3:00800B 0D                INC      R5
B3:00800C BD0001            CJNE     R5,#00H,?C0017?ZW_TRANSPORT_TIMER
B3:00800F 0C                INC      R4
B3:008010         ?C0017?ZW_TRANSPORT_TIMER:
B3:008010         ?C0001?ZW_TRANSPORT_TIMER:
B3:008010 D3                SETB     C
B3:008011 ED                MOV      A,R5
B3:008012 94FF              SUBB     A,#0FFH
B3:008014 EC                MOV      A,R4
B3:008015 9403              SUBB     A,#03H
B3:008017 500D              JNC      ?C0002?ZW_TRANSPORT_TIMER
B3:008019 75FF02            MOV      SFRPAGE,#02H
B3:00801C ED                MOV      A,R5
B3:00801D F586              MOV      SLTCON2,A
B3:00801F EC                MOV      A,R4
B3:008020 4430              ORL      A,#030H
B3:008022 F585              MOV      SLTCON1,A
B3:008024 8057              SJMP     ?C0003?ZW_TRANSPORT_TIMER
B3:008026         ?C0002?ZW_TRANSPORT_TIMER:
B3:008026 D3                SETB     C
B3:008027 ED                MOV      A,R5
B3:008028 94FC              SUBB     A,#0FCH
B3:00802A EC                MOV      A,R4
B3:00802B 940F              SUBB     A,#0FH
B3:00802D 501A              JNC      ?C0004?ZW_TRANSPORT_TIMER
B3:00802F ED                MOV      A,R5
B3:008030 AE04              MOV      R6,AR4
B3:008032 7802              MOV      R0,#02H
B3:008034         ?C0018?ZW_TRANSPORT_TIMER:
B3:008034 CE                XCH      A,R6
B3:008035 C3                CLR      C
B3:008036 13                RRC      A
B3:008037 CE                XCH      A,R6
B3:008038 13                RRC      A
B3:008039 D8F9              DJNZ     R0,?C0018?ZW_TRANSPORT_TIMER
B3:00803B AC06              MOV      R4,AR6
B3:00803D 75FF02            MOV      SFRPAGE,#02H
B3:008040 F586              MOV      SLTCON2,A
B3:008042 EC                MOV      A,R4
B3:008043 4434              ORL      A,#034H
B3:008045 F585              MOV      SLTCON1,A
B3:008047 8034              SJMP     ?C0003?ZW_TRANSPORT_TIMER
B3:008049         ?C0004?ZW_TRANSPORT_TIMER:
B3:008049 D3                SETB     C
B3:00804A ED                MOV      A,R5
B3:00804B 94F0              SUBB     A,#0F0H
B3:00804D EC                MOV      A,R4
B3:00804E 943F              SUBB     A,#03FH
B3:008050 5015              JNC      ?C0006?ZW_TRANSPORT_TIMER
B3:008052 126F94            LCALL    ?L?COM042F
B3:008055 FC                MOV      R4,A
B3:008056 ED                MOV      A,R5
B3:008057 C4                SWAP     A
B3:008058 540F              ANL      A,#0FH
B3:00805A 48                ORL      A,R0
B3:00805B 75FF02            MOV      SFRPAGE,#02H
B3:00805E F586              MOV      SLTCON2,A
B3:008060 EC                MOV      A,R4
B3:008061 4438              ORL      A,#038H
B3:008063 F585              MOV      SLTCON1,A
B3:008065 8016              SJMP     ?C0003?ZW_TRANSPORT_TIMER
B3:008067         ?C0006?ZW_TRANSPORT_TIMER:
B3:008067 ED                MOV      A,R5
B3:008068 AE04              MOV      R6,AR4
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 682


B3:00806A 7806              MOV      R0,#06H
B3:00806C         ?C0019?ZW_TRANSPORT_TIMER:
B3:00806C CE                XCH      A,R6
B3:00806D C3                CLR      C
B3:00806E 13                RRC      A
B3:00806F CE                XCH      A,R6
B3:008070 13                RRC      A
B3:008071 D8F9              DJNZ     R0,?C0019?ZW_TRANSPORT_TIMER
B3:008073 75FF02            MOV      SFRPAGE,#02H
B3:008076 F586              MOV      SLTCON2,A
B3:008078 EE                MOV      A,R6
B3:008079 443C              ORL      A,#03CH
B3:00807B F585              MOV      SLTCON1,A
B3:00807D         ?C0003?ZW_TRANSPORT_TIMER:
B3:00807D 90468B            MOV      DPTR,#Func
B3:008080 127074            LCALL    ?L?COM056E
B3:008083 D225              SETB     slow_timer_running
B3:008085 E4                CLR      A
B3:008086 F57E              MOV      slow_timer_count,A
B3:008088 75FF02            MOV      SFRPAGE,#02H
B3:00808B 438540            ORL      SLTCON1,#040H
B3:00808E 75FF02            MOV      SFRPAGE,#02H
B3:008091 438580            ORL      SLTCON1,#080H
B3:008094 D224              SETB     canRestart
B3:008096 22                RET      
----- FUNCTION _TransportTimerStart (END) -------


----- FUNCTION TransportTimerCancel (BEGIN) -----
B3:008097 11A1              ACALL    ?L?COM0292
B3:008099 C224              CLR      canRestart
B3:00809B E4                CLR      A
B3:00809C F57E              MOV      slow_timer_count,A
B3:00809E C225              CLR      slow_timer_running
B3:0080A0 22                RET      
----- FUNCTION TransportTimerCancel (END) -------


----- FUNCTION ?L?COM0292 (BEGIN) -----
B3:0080A1 75FF02            MOV      SFRPAGE,#02H
B3:0080A4 53857F            ANL      SLTCON1,#07FH
B3:0080A7 75FF02            MOV      SFRPAGE,#02H
B3:0080AA 438510            ORL      SLTCON1,#010H
B3:0080AD 22                RET      
----- FUNCTION ?L?COM0292 (END) -------


----- FUNCTION _?tx_session_state_set (BEGIN) -----
B3:0080AE 90FFFF            MOV      DPTR,#0FFFFH
B3:0080B1 1226E5            LCALL    ?C?ADDXBP
B3:0080B4 EF                MOV      A,R7
B3:0080B5 F0                MOVX     @DPTR,A
B3:0080B6 90FFFF            MOV      DPTR,#0FFFFH
B3:0080B9 1226E5            LCALL    ?C?ADDXBP
B3:0080BC 857A83            MOV      DPH,?C_XBP
B3:0080BF 857B82            MOV      DPL,?C_XBP+01H
B3:0080C2 A3                INC      DPTR
B3:0080C3 E0                MOVX     A,@DPTR
B3:0080C4 902D98            MOV      DPTR,#the_tx_session+0AH
B3:0080C7 F0                MOVX     @DPTR,A
B3:0080C8 12267F            LCALL    ?C?CCASE
B3:0080CB 80E4              DW       ?C0072?ZW_SECURITY_SCHEME0
B3:0080CD 00                DB       00H
B3:0080CE 810B              DW       ?C0075?ZW_SECURITY_SCHEME0
B3:0080D0 02                DB       02H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 683


B3:0080D1 8138              DW       ?C0080?ZW_SECURITY_SCHEME0
B3:0080D3 03                DB       03H
B3:0080D4 8140              DW       ?C0082?ZW_SECURITY_SCHEME0
B3:0080D6 04                DB       04H
B3:0080D7 815E              DW       ?C0085?ZW_SECURITY_SCHEME0
B3:0080D9 05                DB       05H
B3:0080DA 8164              DW       ?C0086?ZW_SECURITY_SCHEME0
B3:0080DC 06                DB       06H
B3:0080DD 8176              DW       ?C0088?ZW_SECURITY_SCHEME0
B3:0080DF 07                DB       07H
B3:0080E0 0000              DW       00H
B3:0080E2 8187              DW       ?C0090?ZW_SECURITY_SCHEME0
B3:0080E4         ?C0072?ZW_SECURITY_SCHEME0:
B3:0080E4 12EE5E            LCALL    ?L?COM0334
B3:0080E7 12B326            LCALL    ?L?COM004A
B3:0080EA 12DCD9            LCALL    ?L?COM03C5
B3:0080ED 31D0              ACALL    ?L?COM03DF
B3:0080EF 31DC              ACALL    ?L?COM00AE
B3:0080F1 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:0080F4 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_noce_get_callback
B3:0080F6 F0                MOVX     @DPTR,A
B3:0080F7 A3                INC      DPTR
B3:0080F8 7473              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_noce_get_callback
B3:0080FA F0                MOVX     @DPTR,A
B3:0080FB 7A2B              MOV      R2,#HIGH nonce_get
B3:0080FD 797D              MOV      R1,#LOW nonce_get
B3:0080FF 7D02              MOV      R5,#02H
B3:008101 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:008104 EF                MOV      A,R7
B3:008105 6002              JZ       $ + 4H
B3:008107 2187              AJMP     ?C0090?ZW_SECURITY_SCHEME0
B3:008109 804F              SJMP     ?C0177?ZW_SECURITY_SCHEME0
B3:00810B         ?C0075?ZW_SECURITY_SCHEME0:
B3:00810B 31E2              ACALL    ?L?COM0351
B3:00810D E4                CLR      A
B3:00810E FF                MOV      R7,A
B3:00810F 12D202            LCALL    ?L?COM01FF
B3:008112 6011              JZ       ?C0077?ZW_SECURITY_SCHEME0
B3:008114 31D0              ACALL    ?L?COM03DF
B3:008116 31DC              ACALL    ?L?COM00AE
B3:008118 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00811B 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_msg1_callback
B3:00811D F0                MOVX     @DPTR,A
B3:00811E 7478              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_msg1_callback
B3:008120 12EEF3            LCALL    ?L?COM0446
B3:008123 7002              JNZ      ?C0076?ZW_SECURITY_SCHEME0
B3:008125         ?C0077?ZW_SECURITY_SCHEME0:
B3:008125         
B3:008125 8033              SJMP     ?C0177?ZW_SECURITY_SCHEME0
B3:008127         ?C0076?ZW_SECURITY_SCHEME0:
B3:008127 902D97            MOV      DPTR,#the_tx_session+09H
B3:00812A E0                MOVX     A,@DPTR
B3:00812B 605A              JZ       ?C0090?ZW_SECURITY_SCHEME0
B3:00812D 12EE5E            LCALL    ?L?COM0334
B3:008130 12B326            LCALL    ?L?COM004A
B3:008133 12DCD9            LCALL    ?L?COM03C5
B3:008136 804F              SJMP     ?C0090?ZW_SECURITY_SCHEME0
B3:008138         ?C0080?ZW_SECURITY_SCHEME0:
B3:008138 902D97            MOV      DPTR,#the_tx_session+09H
B3:00813B E0                MOVX     A,@DPTR
B3:00813C 7049              JNZ      ?C0090?ZW_SECURITY_SCHEME0
B3:00813E 801E              SJMP     ?C0178?ZW_SECURITY_SCHEME0
B3:008140         ?C0082?ZW_SECURITY_SCHEME0:
B3:008140 31E2              ACALL    ?L?COM0351
B3:008142 7F01              MOV      R7,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 684


B3:008144 12D202            LCALL    ?L?COM01FF
B3:008147 6011              JZ       ?C0084?ZW_SECURITY_SCHEME0
B3:008149 31D0              ACALL    ?L?COM03DF
B3:00814B 31DC              ACALL    ?L?COM00AE
B3:00814D 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:008150 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_msg2_callback
B3:008152 F0                MOVX     @DPTR,A
B3:008153 747D              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_msg2_callback
B3:008155 12EEF3            LCALL    ?L?COM0446
B3:008158 702D              JNZ      ?C0090?ZW_SECURITY_SCHEME0
B3:00815A         ?C0084?ZW_SECURITY_SCHEME0:
B3:00815A         
B3:00815A 7F07              MOV      R7,#07H
B3:00815C 8002              SJMP     ?C0179?ZW_SECURITY_SCHEME0
B3:00815E         ?C0085?ZW_SECURITY_SCHEME0:
B3:00815E         
B3:00815E 7F06              MOV      R7,#06H
B3:008160         
B3:008160 11AE              ACALL    _?tx_session_state_set
B3:008162 8023              SJMP     ?C0090?ZW_SECURITY_SCHEME0
B3:008164         ?C0086?ZW_SECURITY_SCHEME0:
B3:008164 12C0A1            LCALL    ?L?COM00C1
B3:008167 601E              JZ       ?C0090?ZW_SECURITY_SCHEME0
B3:008169 7B01              MOV      R3,#01H
B3:00816B 7A2D              MOV      R2,#HIGH the_tx_session+04CH
B3:00816D 79DA              MOV      R1,#LOW the_tx_session+04CH
B3:00816F 12D9AE            LCALL    ?L?COM0212
B3:008172 E4                CLR      A
B3:008173 FF                MOV      R7,A
B3:008174 800E              SJMP     ?C0180?ZW_SECURITY_SCHEME0
B3:008176         ?C0088?ZW_SECURITY_SCHEME0:
B3:008176 12C0A1            LCALL    ?L?COM00C1
B3:008179 600C              JZ       ?C0090?ZW_SECURITY_SCHEME0
B3:00817B 7B01              MOV      R3,#01H
B3:00817D 7A2D              MOV      R2,#HIGH the_tx_session+04CH
B3:00817F 79DA              MOV      R1,#LOW the_tx_session+04CH
B3:008181 12C270            LCALL    ?L?COM0268
B3:008184         
B3:008184 1226E3            LCALL    ?C?ICALL2
B3:008187         ?C0090?ZW_SECURITY_SCHEME0:
B3:008187 900002            MOV      DPTR,#02H
B3:00818A 0226E5            LJMP     ?C?ADDXBP
----- FUNCTION _?tx_session_state_set (END) -------


----- FUNCTION ?L?COM029F (BEGIN) -----
B3:00818D 7B01              MOV      R3,#01H
B3:00818F 7A31              MOV      R2,#HIGH scb+011H
B3:008191 79B7              MOV      R1,#LOW scb+011H
B3:008193 7F13              MOV      R7,#013H
----- FUNCTION ___ZW_memcpy (BEGIN) -----
B3:008195 904420            MOV      DPTR,#dst
B3:008198 122572            LCALL    ?C?PSTXDATA
;---- Variable 'length' assigned to Register 'R7' ----
B3:00819B         ?C0020?ZW_MEM:
B3:00819B AE07              MOV      R6,AR7
B3:00819D 1F                DEC      R7
B3:00819E EE                MOV      A,R6
B3:00819F 6027              JZ       ?C0022?ZW_MEM
B3:0081A1 904423            MOV      DPTR,#src
B3:0081A4 12A3E6            LCALL    ?L?COM0077
B3:0081A7 FE                MOV      R6,A
B3:0081A8 904420            MOV      DPTR,#dst
B3:0081AB 122552            LCALL    ?C?PLDXDATA
B3:0081AE EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 685


B3:0081AF 12203B            LCALL    ?C?CSTPTR
B3:0081B2 904421            MOV      DPTR,#dst+01H
B3:0081B5 E4                CLR      A
B3:0081B6 75F001            MOV      B,#01H
B3:0081B9 12210C            LCALL    ?C?IILDX
B3:0081BC 904424            MOV      DPTR,#src+01H
B3:0081BF E4                CLR      A
B3:0081C0 75F001            MOV      B,#01H
B3:0081C3 12210C            LCALL    ?C?IILDX
B3:0081C6 80D3              SJMP     ?C0020?ZW_MEM
B3:0081C8         ?C0022?ZW_MEM:
B3:0081C8 22                RET      
----- FUNCTION ___ZW_memcpy (END) -------


----- FUNCTION _MemoryPutByte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R5' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:0081C9 12444A            LCALL    _NVM_ext_write_byte
B3:0081CC E4                CLR      A
B3:0081CD 33                RLC      A
B3:0081CE FF                MOV      R7,A
B3:0081CF 22                RET      
----- FUNCTION _MemoryPutByte (END) -------


----- FUNCTION ?L?COM03DF (BEGIN) -----
B3:0081D0 7B01              MOV      R3,#01H
B3:0081D2 7A2D              MOV      R2,#HIGH the_tx_session
B3:0081D4 798E              MOV      R1,#LOW the_tx_session
B3:0081D6 22                RET      
----- FUNCTION ?L?COM03DF (END) -------


----- FUNCTION ?L?COM00AD (BEGIN) -----
B3:0081D7 A3                INC      DPTR
B3:0081D8 E0                MOVX     A,@DPTR
B3:0081D9 FD                MOV      R5,A
B3:0081DA 7B01              MOV      R3,#01H
B3:0081DC         ?L?COM00AE:
B3:0081DC 900A30            MOV      DPTR,#?_ZW_SendDataEx?BYTE+04H
B3:0081DF 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM00AD (END) -------


----- FUNCTION ?L?COM0351 (BEGIN) -----
B3:0081E2 7B01              MOV      R3,#01H
B3:0081E4 7A2D              MOV      R2,#HIGH the_tx_session+0BH
B3:0081E6 7999              MOV      R1,#LOW the_tx_session+0BH
B3:0081E8 021B2E            LJMP     ?INTERBANK_TABLE?_ctimer_stop
----- FUNCTION ?L?COM0351 (END) -------


----- FUNCTION _sec0_decrypt_message (BEGIN) -----
B3:0081EB 903D29            MOV      DPTR,#snode
B3:0081EE 126563            LCALL    ?L?COM00E9
B3:0081F1 122572            LCALL    ?C?PSTXDATA
B3:0081F4 E4                CLR      A
B3:0081F5 903D5D            MOV      DPTR,#i
B3:0081F8 F0                MOVX     @DPTR,A
B3:0081F9 903D2E            MOV      DPTR,#enc_data_length
B3:0081FC E0                MOVX     A,@DPTR
B3:0081FD FE                MOV      R6,A
B3:0081FE C3                CLR      C
B3:0081FF 9413              SUBB     A,#013H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 686


B3:008201 5003              JNC      ?C0144?ZW_SECURITY_SCHEME0
B3:008203 7F00              MOV      R7,#00H
B3:008205 22                RET      
B3:008206         ?C0144?ZW_SECURITY_SCHEME0:
B3:008206 EE                MOV      A,R6
B3:008207 24F7              ADD      A,#0F7H
B3:008209 FF                MOV      R7,A
B3:00820A E4                CLR      A
B3:00820B 34FF              ADDC     A,#0FFH
B3:00820D FE                MOV      R6,A
B3:00820E B17A              ACALL    ?L?COM03B0
B3:008210 E9                MOV      A,R1
B3:008211 2F                ADD      A,R7
B3:008212 F9                MOV      R1,A
B3:008213 EA                MOV      A,R2
B3:008214 3E                ADDC     A,R6
B3:008215 FA                MOV      R2,A
B3:008216 121F7C            LCALL    ?C?CLDPTR
B3:008219 903D58            MOV      DPTR,#ri
B3:00821C F0                MOVX     @DPTR,A
B3:00821D B17A              ACALL    ?L?COM03B0
B3:00821F E9                MOV      A,R1
B3:008220 2402              ADD      A,#02H
B3:008222 B145              ACALL    ?L?COM0017
B3:008224 7B01              MOV      R3,#01H
B3:008226 7A3D              MOV      R2,#HIGH iv
B3:008228 7932              MOV      R1,#LOW iv
B3:00822A 7F08              MOV      R7,#08H
B3:00822C 3195              ACALL    ___ZW_memcpy
B3:00822E 12EF41            LCALL    ?L?COM0506
B3:008231 7A3D              MOV      R2,#HIGH iv+08H
B3:008233 793A              MOV      R1,#LOW iv+08H
B3:008235 12EE3F            LCALL    ?L?COM0256
B3:008238 903D58            MOV      DPTR,#ri
B3:00823B 12D1B7            LCALL    ?L?COM04AE
B3:00823E 7002              JNZ      ?C0146?ZW_SECURITY_SCHEME0
B3:008240 FF                MOV      R7,A
B3:008241 22                RET      
B3:008242         ?C0146?ZW_SECURITY_SCHEME0:
B3:008242 12EF41            LCALL    ?L?COM0506
B3:008245 E0                MOVX     A,@DPTR
B3:008246 FD                MOV      R5,A
B3:008247 12D15D            LCALL    _nonce_clear
B3:00824A         ?C0147?ZW_SECURITY_SCHEME0:
B3:00824A 12EF38            LCALL    ?L?COM0505
B3:00824D 12D368            LCALL    _get_rx_session_by_nodes
B3:008250 12EDF8            LCALL    ?L?COM01C8
B3:008253 7016              JNZ      ?C0148?ZW_SECURITY_SCHEME0
B3:008255 12EF38            LCALL    ?L?COM0505
B3:008258 12D2FE            LCALL    _new_rx_session
B3:00825B 12EDF8            LCALL    ?L?COM01C8
B3:00825E 6008              JZ       ?C0149?ZW_SECURITY_SCHEME0
B3:008260 B18C              ACALL    ?L?COM00A9
B3:008262 E4                CLR      A
B3:008263 12203B            LCALL    ?C?CSTPTR
B3:008266 8003              SJMP     ?C0148?ZW_SECURITY_SCHEME0
B3:008268         ?C0149?ZW_SECURITY_SCHEME0:
B3:008268 7F00              MOV      R7,#00H
B3:00826A 22                RET      
B3:00826B         ?C0148?ZW_SECURITY_SCHEME0:
B3:00826B B17A              ACALL    ?L?COM03B0
B3:00826D E9                MOV      A,R1
B3:00826E 240A              ADD      A,#0AH
B3:008270 F9                MOV      R1,A
B3:008271 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 687


B3:008272 3A                ADDC     A,R2
B3:008273 FA                MOV      R2,A
B3:008274 903D55            MOV      DPTR,#enc_payload
B3:008277 122572            LCALL    ?C?PSTXDATA
B3:00827A B180              ACALL    ?L?COM03B8
B3:00827C 903D59            MOV      DPTR,#auth
B3:00827F 122572            LCALL    ?C?PSTXDATA
B3:008282 903D2B            MOV      DPTR,#enc_data
B3:008285 12CD6D            LCALL    ?L?COM02D3
B3:008288 1252DD            LCALL    ?L?COM0009
B3:00828B FF                MOV      R7,A
B3:00828C 903D59            MOV      DPTR,#auth
B3:00828F 1256DF            LCALL    ?L?COM0125
B3:008292 903D29            MOV      DPTR,#snode
B3:008295 E0                MOVX     A,@DPTR
B3:008296 903D59            MOV      DPTR,#auth
B3:008299 12CD1D            LCALL    ?L?COM0053
B3:00829C EF                MOV      A,R7
B3:00829D 12203B            LCALL    ?C?CSTPTR
B3:0082A0 903D2A            MOV      DPTR,#dnode
B3:0082A3 E0                MOVX     A,@DPTR
B3:0082A4 FF                MOV      R7,A
B3:0082A5 903D59            MOV      DPTR,#auth
B3:0082A8 B18F              ACALL    ?L?COM00AA
B3:0082AA EF                MOV      A,R7
B3:0082AB 12203B            LCALL    ?C?CSTPTR
B3:0082AE 903D2E            MOV      DPTR,#enc_data_length
B3:0082B1 E0                MOVX     A,@DPTR
B3:0082B2 24ED              ADD      A,#0EDH
B3:0082B4 FF                MOV      R7,A
B3:0082B5 903D59            MOV      DPTR,#auth
B3:0082B8 1289B7            LCALL    ?L?COM004D
B3:0082BB EF                MOV      A,R7
B3:0082BC 12203B            LCALL    ?C?CSTPTR
B3:0082BF 903D59            MOV      DPTR,#auth
B3:0082C2 125D35            LCALL    ?L?COM00E4
B3:0082C5 C003              PUSH     AR3
B3:0082C7 C002              PUSH     AR2
B3:0082C9 C001              PUSH     AR1
B3:0082CB 903D55            MOV      DPTR,#enc_payload
B3:0082CE 122552            LCALL    ?C?PLDXDATA
B3:0082D1 B149              ACALL    ?L?COM0019
B3:0082D3 D001              POP      AR1
B3:0082D5 D002              POP      AR2
B3:0082D7 D003              POP      AR3
B3:0082D9 3195              ACALL    ___ZW_memcpy
B3:0082DB 12D0C1            LCALL    ?L?COM02CB
B3:0082DE B1BE              ACALL    ?L?COM053B
B3:0082E0 E4                CLR      A
B3:0082E1 903D5D            MOV      DPTR,#i
B3:0082E4 F0                MOVX     @DPTR,A
B3:0082E5         ?C0151?ZW_SECURITY_SCHEME0:
B3:0082E5 B1A8              ACALL    ?L?COM041B
B3:0082E7 B410FB            CJNE     A,#010H,?C0151?ZW_SECURITY_SCHEME0
B3:0082EA         ?C0152?ZW_SECURITY_SCHEME0:
B3:0082EA B186              ACALL    ?L?COM03C1
B3:0082EC E9                MOV      A,R1
B3:0082ED 2403              ADD      A,#03H
B3:0082EF 1252DD            LCALL    ?L?COM0009
B3:0082F2 2404              ADD      A,#04H
B3:0082F4 FD                MOV      R5,A
B3:0082F5 7B01              MOV      R3,#01H
B3:0082F7 7A3D              MOV      R2,#HIGH mac
B3:0082F9 7942              MOV      R1,#LOW mac
B3:0082FB 90437E            MOV      DPTR,#?_aes_cbc_mac?BYTE+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 688


B3:0082FE 122572            LCALL    ?C?PSTXDATA
B3:008301 B186              ACALL    ?L?COM03C1
B3:008303 12CC07            LCALL    _aes_cbc_mac
B3:008306 E4                CLR      A
B3:008307 903D5D            MOV      DPTR,#i
B3:00830A F0                MOVX     @DPTR,A
B3:00830B         ?C0154?ZW_SECURITY_SCHEME0:
B3:00830B B186              ACALL    ?L?COM03C1
B3:00830D E9                MOV      A,R1
B3:00830E 2403              ADD      A,#03H
B3:008310 1252DD            LCALL    ?L?COM0009
B3:008313 2404              ADD      A,#04H
B3:008315 FF                MOV      R7,A
B3:008316 E4                CLR      A
B3:008317 903D5D            MOV      DPTR,#i
B3:00831A 12533B            LCALL    ?L?COM011C
B3:00831D 5005              JNC      ?C0155?ZW_SECURITY_SCHEME0
B3:00831F E0                MOVX     A,@DPTR
B3:008320 04                INC      A
B3:008321 F0                MOVX     @DPTR,A
B3:008322 80E7              SJMP     ?C0154?ZW_SECURITY_SCHEME0
B3:008324         ?C0155?ZW_SECURITY_SCHEME0:
B3:008324 B17A              ACALL    ?L?COM03B0
B3:008326 903D2E            MOV      DPTR,#enc_data_length
B3:008329 E0                MOVX     A,@DPTR
B3:00832A 7E00              MOV      R6,#00H
B3:00832C 29                ADD      A,R1
B3:00832D F9                MOV      R1,A
B3:00832E EE                MOV      A,R6
B3:00832F 3A                ADDC     A,R2
B3:008330 FA                MOV      R2,A
B3:008331 E9                MOV      A,R1
B3:008332 24F8              ADD      A,#0F8H
B3:008334 90442A            MOV      DPTR,#?___ZW_memcmp?BYTE+04H
B3:008337 126E49            LCALL    ?L?COM0201
B3:00833A 7B01              MOV      R3,#01H
B3:00833C 7A3D              MOV      R2,#HIGH mac
B3:00833E 7942              MOV      R1,#LOW mac
B3:008340 7F08              MOV      R7,#08H
B3:008342 129720            LCALL    ___ZW_memcmp
B3:008345 EF                MOV      A,R7
B3:008346 6017              JZ       ?C0157?ZW_SECURITY_SCHEME0
B3:008348 E4                CLR      A
B3:008349 903D5D            MOV      DPTR,#i
B3:00834C F0                MOVX     @DPTR,A
B3:00834D         ?C0158?ZW_SECURITY_SCHEME0:
B3:00834D B1A8              ACALL    ?L?COM041B
B3:00834F B410FB            CJNE     A,#010H,?C0158?ZW_SECURITY_SCHEME0
B3:008352         ?C0159?ZW_SECURITY_SCHEME0:
B3:008352 E4                CLR      A
B3:008353 903D5D            MOV      DPTR,#i
B3:008356 F0                MOVX     @DPTR,A
B3:008357         ?C0161?ZW_SECURITY_SCHEME0:
B3:008357 B1A8              ACALL    ?L?COM041B
B3:008359 B410FB            CJNE     A,#010H,?C0161?ZW_SECURITY_SCHEME0
B3:00835C         ?C0162?ZW_SECURITY_SCHEME0:
B3:00835C 7F00              MOV      R7,#00H
B3:00835E 22                RET      
B3:00835F         ?C0157?ZW_SECURITY_SCHEME0:
B3:00835F 12D0C1            LCALL    ?L?COM02CB
B3:008362 B14F              ACALL    ?L?COM053A
B3:008364 B186              ACALL    ?L?COM03C1
B3:008366 E9                MOV      A,R1
B3:008367 2403              ADD      A,#03H
B3:008369 1252DD            LCALL    ?L?COM0009
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 689


B3:00836C FD                MOV      R5,A
B3:00836D 903D55            MOV      DPTR,#enc_payload
B3:008370 122552            LCALL    ?C?PLDXDATA
B3:008373 12CBBD            LCALL    _aes_ofb
B3:008376 903D55            MOV      DPTR,#enc_payload
B3:008379 12A3E6            LCALL    ?L?COM0077
B3:00837C 903D5C            MOV      DPTR,#flags
B3:00837F F0                MOVX     @DPTR,A
B3:008380 20E402            JB       ACC.4,$ + 5H
B3:008383 813A              AJMP     ?C0164?ZW_SECURITY_SCHEME0
B3:008385 E0                MOVX     A,@DPTR
B3:008386 20E540            JB       ACC.5,?C0165?ZW_SECURITY_SCHEME0
B3:008389 540F              ANL      A,#0FH
B3:00838B FF                MOV      R7,A
B3:00838C 903D52            MOV      DPTR,#s
B3:00838F 1289B7            LCALL    ?L?COM004D
B3:008392 EF                MOV      A,R7
B3:008393 12203B            LCALL    ?C?CSTPTR
B3:008396 B19A              ACALL    ?L?COM04AD
B3:008398 B135              ACALL    ?L?COM01F9
B3:00839A E9                MOV      A,R1
B3:00839B 2484              ADD      A,#084H
B3:00839D 1289AC            LCALL    ?L?COM0144
B3:0083A0 B18C              ACALL    ?L?COM00A9
B3:0083A2 7401              MOV      A,#01H
B3:0083A4 12203B            LCALL    ?C?CSTPTR
B3:0083A7 B136              ACALL    ?L?COM01FA
B3:0083A9 E9                MOV      A,R1
B3:0083AA 2484              ADD      A,#084H
B3:0083AC 1252DD            LCALL    ?L?COM0009
B3:0083AF FF                MOV      R7,A
B3:0083B0 903D52            MOV      DPTR,#s
B3:0083B3 125D35            LCALL    ?L?COM00E4
B3:0083B6 C003              PUSH     AR3
B3:0083B8 C002              PUSH     AR2
B3:0083BA C001              PUSH     AR1
B3:0083BC B13C              ACALL    ?L?COM0016
B3:0083BE D001              POP      AR1
B3:0083C0 D002              POP      AR2
B3:0083C2 D003              POP      AR3
B3:0083C4 3195              ACALL    ___ZW_memcpy
B3:0083C6 7F00              MOV      R7,#00H
B3:0083C8 22                RET      
B3:0083C9         ?C0165?ZW_SECURITY_SCHEME0:
B3:0083C9 B136              ACALL    ?L?COM01FA
B3:0083CB E9                MOV      A,R1
B3:0083CC 2402              ADD      A,#02H
B3:0083CE 1252DD            LCALL    ?L?COM0009
B3:0083D1 6401              XRL      A,#01H
B3:0083D3 707B              JNZ      state_error?ZW_SECURITY_SCHEME0
B3:0083D5 B136              ACALL    ?L?COM01FA
B3:0083D7 E9                MOV      A,R1
B3:0083D8 2403              ADD      A,#03H
B3:0083DA 1252DD            LCALL    ?L?COM0009
B3:0083DD FF                MOV      R7,A
B3:0083DE 903D5C            MOV      DPTR,#flags
B3:0083E1 E0                MOVX     A,@DPTR
B3:0083E2 540F              ANL      A,#0FH
B3:0083E4 6F                XRL      A,R7
B3:0083E5 7069              JNZ      state_error?ZW_SECURITY_SCHEME0
B3:0083E7         ?C0167?ZW_SECURITY_SCHEME0:
B3:0083E7 B18C              ACALL    ?L?COM00A9
B3:0083E9 7402              MOV      A,#02H
B3:0083EB 12203B            LCALL    ?C?CSTPTR
B3:0083EE         ?C0170?ZW_SECURITY_SCHEME0:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 690


B3:0083EE B136              ACALL    ?L?COM01FA
B3:0083F0 E9                MOV      A,R1
B3:0083F1 2484              ADD      A,#084H
B3:0083F3 1252DD            LCALL    ?L?COM0009
B3:0083F6 B135              ACALL    ?L?COM01F9
B3:0083F8 E9                MOV      A,R1
B3:0083F9 2404              ADD      A,#04H
B3:0083FB B145              ACALL    ?L?COM0017
B3:0083FD B180              ACALL    ?L?COM03B8
B3:0083FF 3195              ACALL    ___ZW_memcpy
B3:008401 B19A              ACALL    ?L?COM04AD
B3:008403 B135              ACALL    ?L?COM01F9
B3:008405 E9                MOV      A,R1
B3:008406 2484              ADD      A,#084H
B3:008408 1252DD            LCALL    ?L?COM0009
B3:00840B FD                MOV      R5,A
B3:00840C 7C00              MOV      R4,#00H
B3:00840E B180              ACALL    ?L?COM03B8
B3:008410 E9                MOV      A,R1
B3:008411 2D                ADD      A,R5
B3:008412 F9                MOV      R1,A
B3:008413 EC                MOV      A,R4
B3:008414 3A                ADDC     A,R2
B3:008415 FA                MOV      R2,A
B3:008416 C003              PUSH     AR3
B3:008418 C002              PUSH     AR2
B3:00841A C001              PUSH     AR1
B3:00841C B13C              ACALL    ?L?COM0016
B3:00841E D001              POP      AR1
B3:008420 D002              POP      AR2
B3:008422 D003              POP      AR3
B3:008424 3195              ACALL    ___ZW_memcpy
B3:008426 B136              ACALL    ?L?COM01FA
B3:008428 B1A1              ACALL    _free_rx_session
B3:00842A B136              ACALL    ?L?COM01FA
B3:00842C E9                MOV      A,R1
B3:00842D 2484              ADD      A,#084H
B3:00842F 1252DD            LCALL    ?L?COM0009
B3:008432 FF                MOV      R7,A
B3:008433 903D2E            MOV      DPTR,#enc_data_length
B3:008436 E0                MOVX     A,@DPTR
B3:008437 2F                ADD      A,R7
B3:008438 8011              SJMP     ?C0182?ZW_SECURITY_SCHEME0
B3:00843A         ?C0164?ZW_SECURITY_SCHEME0:
B3:00843A B19A              ACALL    ?L?COM04AD
B3:00843C FF                MOV      R7,A
B3:00843D B13C              ACALL    ?L?COM0016
B3:00843F B180              ACALL    ?L?COM03B8
B3:008441 3195              ACALL    ___ZW_memcpy
B3:008443 B136              ACALL    ?L?COM01FA
B3:008445 B1A1              ACALL    _free_rx_session
B3:008447 903D2E            MOV      DPTR,#enc_data_length
B3:00844A E0                MOVX     A,@DPTR
B3:00844B         
B3:00844B C3                CLR      C
B3:00844C 9414              SUBB     A,#014H
B3:00844E FF                MOV      R7,A
B3:00844F 22                RET      
B3:008450         state_error:
B3:008450 7F00              MOV      R7,#00H
B3:008452 22                RET      
----- FUNCTION _sec0_decrypt_message (END) -------


----- FUNCTION ExploreStateTransmit (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 691


B3:008453 E553              MOV      A,bExploreEvent
B3:008455 6002              JZ       $ + 4H
B3:008457 A115              AJMP     ?C0029?ZW_EXPLORE
B3:008459         ?C0022?ZW_EXPLORE:
B3:008459 B12F              ACALL    ?L?COM0070
B3:00845B E9                MOV      A,R1
B3:00845C 2404              ADD      A,#04H
B3:00845E 1252DD            LCALL    ?L?COM0009
B3:008461 30E61B            JNB      ACC.6,?C0023?ZW_EXPLORE
B3:008464 B12F              ACALL    ?L?COM0070
B3:008466 E9                MOV      A,R1
B3:008467 2407              ADD      A,#07H
B3:008469 F9                MOV      R1,A
B3:00846A E4                CLR      A
B3:00846B 3A                ADDC     A,R2
B3:00846C FA                MOV      R2,A
B3:00846D E4                CLR      A
B3:00846E 75F064            MOV      B,#064H
B3:008471 1221E8            LCALL    ?C?ISTPTR
B3:008474 B12F              ACALL    ?L?COM0070
B3:008476 7406              MOV      A,#06H
B3:008478 12203B            LCALL    ?C?CSTPTR
B3:00847B C208              CLR      currentSeqNoUseTX
B3:00847D 8044              SJMP     ?C0024?ZW_EXPLORE
B3:00847F         ?C0023?ZW_EXPLORE:
B3:00847F B12F              ACALL    ?L?COM0070
B3:008481 E9                MOV      A,R1
B3:008482 2405              ADD      A,#05H
B3:008484 1252DD            LCALL    ?L?COM0009
B3:008487 4420              ORL      A,#020H
B3:008489 B12E              ACALL    ?L?COM006F
B3:00848B E9                MOV      A,R1
B3:00848C 2429              ADD      A,#029H
B3:00848E 1289AC            LCALL    ?L?COM0144
B3:008491 B12F              ACALL    ?L?COM0070
B3:008493 E9                MOV      A,R1
B3:008494 126F71            LCALL    ?L?COM0405
B3:008497 B12F              ACALL    ?L?COM0070
B3:008499 E9                MOV      A,R1
B3:00849A 126F0E            LCALL    ?L?COM0382
B3:00849D B12F              ACALL    ?L?COM0070
B3:00849F 7405              MOV      A,#05H
B3:0084A1 12203B            LCALL    ?C?CSTPTR
B3:0084A4 B12F              ACALL    ?L?COM0070
B3:0084A6 E9                MOV      A,R1
B3:0084A7 2404              ADD      A,#04H
B3:0084A9 1252DD            LCALL    ?L?COM0009
B3:0084AC 30E306            JNB      ACC.3,?C0025?ZW_EXPLORE
B3:0084AF 7E03              MOV      R6,#03H
B3:0084B1 7FE8              MOV      R7,#0E8H
B3:0084B3 8004              SJMP     ?C0026?ZW_EXPLORE
B3:0084B5         ?C0025?ZW_EXPLORE:
B3:0084B5 7E07              MOV      R6,#07H
B3:0084B7 7FD0              MOV      R7,#0D0H
B3:0084B9         ?C0026?ZW_EXPLORE:
B3:0084B9 B12F              ACALL    ?L?COM0070
B3:0084BB E9                MOV      A,R1
B3:0084BC 2407              ADD      A,#07H
B3:0084BE 12C706            LCALL    ?L?COM029B
B3:0084C1 D208              SETB     currentSeqNoUseTX
B3:0084C3         ?C0024?ZW_EXPLORE:
B3:0084C3 B12F              ACALL    ?L?COM0070
B3:0084C5 E9                MOV      A,R1
B3:0084C6 2402              ADD      A,#02H
B3:0084C8 1252DD            LCALL    ?L?COM0009
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 692


B3:0084CB B12E              ACALL    ?L?COM006F
B3:0084CD E9                MOV      A,R1
B3:0084CE 2403              ADD      A,#03H
B3:0084D0 1252DD            LCALL    ?L?COM0009
B3:0084D3 FD                MOV      R5,A
B3:0084D4 B12F              ACALL    ?L?COM0070
B3:0084D6 E9                MOV      A,R1
B3:0084D7 126F43            LCALL    ?L?COM03B6
B3:0084DA C003              PUSH     AR3
B3:0084DC C002              PUSH     AR2
B3:0084DE C001              PUSH     AR1
B3:0084E0 B12F              ACALL    ?L?COM0070
B3:0084E2 E9                MOV      A,R1
B3:0084E3 2406              ADD      A,#06H
B3:0084E5 1252DD            LCALL    ?L?COM0009
B3:0084E8 9009FF            MOV      DPTR,#?_TransportEnQueueExploreFrame?BYTE+05H
B3:0084EB F0                MOVX     @DPTR,A
B3:0084EC B12F              ACALL    ?L?COM0070
B3:0084EE E9                MOV      A,R1
B3:0084EF 2404              ADD      A,#04H
B3:0084F1 1252DD            LCALL    ?L?COM0009
B3:0084F4 54F7              ANL      A,#0F7H
B3:0084F6 900A00            MOV      DPTR,#?_TransportEnQueueExploreFrame?BYTE+06H
B3:0084F9 F0                MOVX     @DPTR,A
B3:0084FA A3                INC      DPTR
B3:0084FB 741B              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ExploreComplete
B3:0084FD F0                MOVX     @DPTR,A
B3:0084FE A3                INC      DPTR
B3:0084FF 74CE              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ExploreComplete
B3:008501 F0                MOVX     @DPTR,A
B3:008502 D001              POP      AR1
B3:008504 D002              POP      AR2
B3:008506 D003              POP      AR3
B3:008508 121967            LCALL    ?INTERBANK_TABLE?_TransportEnQueueExploreFrame
B3:00850B EF                MOV      A,R7
B3:00850C 7007              JNZ      ?C0029?ZW_EXPLORE
B3:00850E B12F              ACALL    ?L?COM0070
B3:008510 7407              MOV      A,#07H
B3:008512 12203B            LCALL    ?C?CSTPTR
B3:008515         ?C0029?ZW_EXPLORE:
B3:008515 22                RET      
----- FUNCTION ExploreStateTransmit (END) -------


----- FUNCTION ?L?COM0269 (BEGIN) -----
B3:008516 7B01              MOV      R3,#01H
B3:008518 7D10              MOV      R5,#010H
----- FUNCTION ___ZW_memset (BEGIN) -----
;---- Variable 'val' assigned to Register 'R7' ----
;---- Variable 'dst' assigned to Register 'R1/R2/R3' ----
;---- Variable 'length' assigned to Register 'R5' ----
B3:00851A         ?C0001?ZW_MEM:
B3:00851A AE05              MOV      R6,AR5
B3:00851C 1D                DEC      R5
B3:00851D EE                MOV      A,R6
B3:00851E 6009              JZ       ?C0003?ZW_MEM
B3:008520 EF                MOV      A,R7
B3:008521 12203B            LCALL    ?C?CSTPTR
B3:008524 12C44C            LCALL    ?L?COM0572
B3:008527 80F1              SJMP     ?C0001?ZW_MEM
B3:008529         ?C0003?ZW_MEM:
B3:008529 22                RET      
----- FUNCTION ___ZW_memset (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 693


----- FUNCTION ?L?COM006E (BEGIN) -----
B3:00852A 901222            MOV      DPTR,#rfRxCurrentCh
B3:00852D E0                MOVX     A,@DPTR
B3:00852E         ?L?COM006F:
B3:00852E FF                MOV      R7,A
B3:00852F         ?L?COM0070:
B3:00852F 900851            MOV      DPTR,#pCurrentExploreQueueElement
B3:008532 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM006E (END) -------


----- FUNCTION ?L?COM01F9 (BEGIN) -----
B3:008535 FF                MOV      R7,A
B3:008536         ?L?COM01FA:
B3:008536 903D52            MOV      DPTR,#s
B3:008539 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM01F9 (END) -------


----- FUNCTION ?L?COM0016 (BEGIN) -----
B3:00853C 903D55            MOV      DPTR,#enc_payload
B3:00853F 122552            LCALL    ?C?PLDXDATA
B3:008542 E9                MOV      A,R1
B3:008543 2401              ADD      A,#01H
B3:008545         ?L?COM0017:
B3:008545 F9                MOV      R1,A
B3:008546 E4                CLR      A
B3:008547 3A                ADDC     A,R2
B3:008548         ?L?COM0018:
B3:008548 FA                MOV      R2,A
B3:008549         ?L?COM0019:
B3:008549 904423            MOV      DPTR,#?___ZW_memcpy?BYTE+04H
B3:00854C 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0016 (END) -------


----- FUNCTION ?L?COM053A (BEGIN) -----
B3:00854F 7A2C              MOV      R2,#HIGH enckey
B3:008551 7954              MOV      R1,#LOW enckey
----- FUNCTION _aes_set_key (BEGIN) -----
B3:008553 9044C7            MOV      DPTR,#key
B3:008556 122572            LCALL    ?C?PSTXDATA
B3:008559 9044C7            MOV      DPTR,#key
B3:00855C 122552            LCALL    ?C?PLDXDATA
B3:00855F B149              ACALL    ?L?COM0019
B3:008561 7B01              MOV      R3,#01H
B3:008563 7A2C              MOV      R2,#HIGH aes_key
B3:008565 7974              MOV      R1,#LOW aes_key
B3:008567 7F10              MOV      R7,#010H
B3:008569 3195              ACALL    ___ZW_memcpy
B3:00856B 9044CA            MOV      DPTR,#iv
B3:00856E 122552            LCALL    ?C?PLDXDATA
B3:008571 B149              ACALL    ?L?COM0019
B3:008573 12CD0B            LCALL    ?L?COM0457
B3:008576 7F10              MOV      R7,#010H
B3:008578 2195              AJMP     ___ZW_memcpy
----- FUNCTION _aes_set_key (END) -------


----- FUNCTION ?L?COM03B0 (BEGIN) -----
B3:00857A 903D2B            MOV      DPTR,#enc_data
B3:00857D 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03B0 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 694


----- FUNCTION ?L?COM03B8 (BEGIN) -----
B3:008580 903D2F            MOV      DPTR,#dec_message
B3:008583 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03B8 (END) -------


----- FUNCTION ?L?COM03C1 (BEGIN) -----
B3:008586 903D59            MOV      DPTR,#auth
B3:008589 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03C1 (END) -------


----- FUNCTION ?L?COM00A9 (BEGIN) -----
B3:00858C 903D52            MOV      DPTR,#s
B3:00858F         ?L?COM00AA:
B3:00858F 122552            LCALL    ?C?PLDXDATA
B3:008592         ?L?COM00AB:
B3:008592 E9                MOV      A,R1
B3:008593         ?L?COM00AC:
B3:008593 2402              ADD      A,#02H
B3:008595 F9                MOV      R1,A
B3:008596 E4                CLR      A
B3:008597 3A                ADDC     A,R2
B3:008598 FA                MOV      R2,A
B3:008599 22                RET      
----- FUNCTION ?L?COM00A9 (END) -------


----- FUNCTION ?L?COM04AD (BEGIN) -----
B3:00859A 903D2E            MOV      DPTR,#enc_data_length
B3:00859D E0                MOVX     A,@DPTR
B3:00859E 24EC              ADD      A,#0ECH
B3:0085A0 22                RET      
----- FUNCTION ?L?COM04AD (END) -------


----- FUNCTION _free_rx_session (BEGIN) -----
;---- Variable 's' assigned to Register 'R1/R2/R3' ----
B3:0085A1 B192              ACALL    ?L?COM00AB
B3:0085A3 7403              MOV      A,#03H
B3:0085A5 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _free_rx_session (END) -------


----- FUNCTION ?L?COM041B (BEGIN) -----
B3:0085A8 903D5D            MOV      DPTR,#i
B3:0085AB E0                MOVX     A,@DPTR
B3:0085AC 04                INC      A
B3:0085AD F0                MOVX     @DPTR,A
B3:0085AE E0                MOVX     A,@DPTR
B3:0085AF 22                RET      
----- FUNCTION ?L?COM041B (END) -------


----- FUNCTION ZW_GetNVRRevision (BEGIN) -----
B3:0085B0 90123D            MOV      DPTR,#bNVRValid
B3:0085B3 E0                MOVX     A,@DPTR
B3:0085B4 6005              JZ       ?C0015?ZW_NVR
B3:0085B6 7F10              MOV      R7,#010H
B3:0085B8 02CB4F            LJMP     _ZW_FLASH_nvr0_get
B3:0085BB         ?C0015?ZW_NVR:
B3:0085BB 7FFF              MOV      R7,#0FFH
B3:0085BD 22                RET      
----- FUNCTION ZW_GetNVRRevision (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 695



----- FUNCTION ?L?COM053B (BEGIN) -----
B3:0085BE 7A2B              MOV      R2,#HIGH authkey
B3:0085C0 7990              MOV      R1,#LOW authkey
B3:0085C2 808F              SJMP     _aes_set_key
----- FUNCTION ?L?COM053B (END) -------


----- FUNCTION _ZCB_tx_timeout (BEGIN) -----
B3:0085C4 7F07              MOV      R7,#07H
B3:0085C6 01AE              AJMP     _?tx_session_state_set
----- FUNCTION _ZCB_tx_timeout (END) -------


----- FUNCTION _MemoryGetBuffer (BEGIN) -----
;---- Variable 'buffer' assigned to Register 'R1/R2/R3' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:0085C8 9044C0            MOV      DPTR,#length
B3:0085CB E0                MOVX     A,@DPTR
B3:0085CC 904478            MOV      DPTR,#?_NVM_ext_read_buffer?BYTE+05H
B3:0085CF F0                MOVX     @DPTR,A
B3:0085D0 02388D            LJMP     _NVM_ext_read_buffer
----- FUNCTION _MemoryGetBuffer (END) -------


----- FUNCTION _IsMyExploreFrame (BEGIN) -----
B3:0085D3 900A5B            MOV      DPTR,#pRxFrame
B3:0085D6 122572            LCALL    ?C?PSTXDATA
B3:0085D9 128987            LCALL    ?L?COM002A
B3:0085DC 2409              ADD      A,#09H
B3:0085DE 1252DD            LCALL    ?L?COM0009
B3:0085E1 541F              ANL      A,#01FH
B3:0085E3 F555              MOV      bCurrentCmd,A
B3:0085E5 900A5B            MOV      DPTR,#pRxFrame
B3:0085E8 12899B            LCALL    ?L?COM006B
B3:0085EB 1252DA            LCALL    ?L?COM0008
B3:0085EE FF                MOV      R7,A
;---- Variable 'bExploreFrameLength' assigned to Register 'R7' ----
B3:0085EF E550              MOV      A,bNetworkWideInclusion
B3:0085F1 6401              XRL      A,#01H
B3:0085F3 6022              JZ       ?C0110?ZW_EXPLORE
B3:0085F5 E550              MOV      A,bNetworkWideInclusion
B3:0085F7 6402              XRL      A,#02H
B3:0085F9 601C              JZ       ?C0110?ZW_EXPLORE
B3:0085FB 7412              MOV      A,#012H
B3:0085FD D3                SETB     C
B3:0085FE 9F                SUBB     A,R7
B3:0085FF 5016              JNC      ?C0110?ZW_EXPLORE
B3:008601 E555              MOV      A,bCurrentCmd
B3:008603 B40206            CJNE     A,#02H,?C0111?ZW_EXPLORE
B3:008606 7419              MOV      A,#019H
B3:008608 D3                SETB     C
B3:008609 9F                SUBB     A,R7
B3:00860A 500B              JNC      ?C0110?ZW_EXPLORE
B3:00860C         ?C0111?ZW_EXPLORE:
B3:00860C E555              MOV      A,bCurrentCmd
B3:00860E B40108            CJNE     A,#01H,?C0109?ZW_EXPLORE
B3:008611 741B              MOV      A,#01BH
B3:008613 D3                SETB     C
B3:008614 9F                SUBB     A,R7
B3:008615 4002              JC       ?C0109?ZW_EXPLORE
B3:008617         ?C0110?ZW_EXPLORE:
B3:008617 C3                CLR      C
B3:008618 22                RET      
B3:008619         ?C0109?ZW_EXPLORE:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 696


B3:008619 128987            LCALL    ?L?COM002A
B3:00861C 240A              ADD      A,#0AH
B3:00861E 1252DD            LCALL    ?L?COM0009
B3:008621 30E219            JNB      ACC.2,?C0113?ZW_EXPLORE
B3:008624 128987            LCALL    ?L?COM002A
B3:008627 2408              ADD      A,#08H
B3:008629 1252DD            LCALL    ?L?COM0009
B3:00862C 1289D1            LCALL    ?L?COM03C7
B3:00862F 600C              JZ       ?C0113?ZW_EXPLORE
B3:008631 128987            LCALL    ?L?COM002A
B3:008634 2404              ADD      A,#04H
B3:008636 1252DD            LCALL    ?L?COM0009
B3:008639 FF                MOV      R7,A
B3:00863A 12B37E            LCALL    _ExplorePurgeQueue
B3:00863D         ?C0113?ZW_EXPLORE:
B3:00863D E555              MOV      A,bCurrentCmd
B3:00863F 6402              XRL      A,#02H
B3:008641 6002              JZ       $ + 4H
B3:008643 E103              AJMP     ?C0114?ZW_EXPLORE
B3:008645 128992            LCALL    ?L?COM0356
B3:008648 1252DA            LCALL    ?L?COM0008
B3:00864B 30E702            JNB      ACC.7,$ + 5H
B3:00864E E101              AJMP     ?C0115?ZW_EXPLORE
B3:008650 128987            LCALL    ?L?COM002A
B3:008653 2408              ADD      A,#08H
B3:008655 1252DD            LCALL    ?L?COM0009
B3:008658 1289D1            LCALL    ?L?COM03C7
B3:00865B 702D              JNZ      ?C0116?ZW_EXPLORE
B3:00865D 201202            JB       searchResultNeeded,$ + 5H
B3:008660 E101              AJMP     ?C0115?ZW_EXPLORE
B3:008662 C212              CLR      searchResultNeeded
B3:008664 128987            LCALL    ?L?COM002A
B3:008667 2404              ADD      A,#04H
B3:008669 1252DD            LCALL    ?L?COM0009
B3:00866C FD                MOV      R5,A
B3:00866D 7F03              MOV      R7,#03H
B3:00866F 12C49A            LCALL    _EventPush
B3:008672         ?C0118?ZW_EXPLORE:
B3:008672         ?C0119?ZW_EXPLORE:
B3:008672 128987            LCALL    ?L?COM002A
B3:008675 2404              ADD      A,#04H
B3:008677 1252DD            LCALL    ?L?COM0009
B3:00867A FF                MOV      R7,A
B3:00867B D239              SETB     ?_StoreRouteExplore?BIT
B3:00867D 128987            LCALL    ?L?COM002A
B3:008680 2413              ADD      A,#013H
B3:008682 1289C2            LCALL    ?L?COM0371
B3:008685 121A11            LCALL    ?INTERBANK_TABLE?_UpdateResponseRouteLastReturnRoute
B3:008688 8077              SJMP     ?C0115?ZW_EXPLORE
B3:00868A         ?C0116?ZW_EXPLORE:
B3:00868A 128987            LCALL    ?L?COM002A
B3:00868D 240C              ADD      A,#0CH
B3:00868F 1252DD            LCALL    ?L?COM0009
B3:008692 FF                MOV      R7,A
B3:008693 540F              ANL      A,#0FH
B3:008695 FE                MOV      R6,A
;---- Variable 'bTemp7' assigned to Register 'R6' ----
B3:008696 6069              JZ       ?C0115?ZW_EXPLORE
B3:008698 128987            LCALL    ?L?COM002A
B3:00869B 240D              ADD      A,#0DH
B3:00869D F9                MOV      R1,A
B3:00869E E4                CLR      A
B3:00869F 3A                ADDC     A,R2
B3:0086A0 FA                MOV      R2,A
B3:0086A1 1E                DEC      R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 697


B3:0086A2 7C00              MOV      R4,#00H
B3:0086A4 E9                MOV      A,R1
B3:0086A5 2E                ADD      A,R6
B3:0086A6 12705E            LCALL    ?L?COM0533
B3:0086A9 FD                MOV      R5,A
B3:0086AA 901221            MOV      DPTR,#nodeID
B3:0086AD E0                MOVX     A,@DPTR
B3:0086AE 6D                XRL      A,R5
B3:0086AF 7050              JNZ      ?C0115?ZW_EXPLORE
B3:0086B1 900A5B            MOV      DPTR,#pRxFrame
B3:0086B4 12899B            LCALL    ?L?COM006B
B3:0086B7 1252DA            LCALL    ?L?COM0008
B3:0086BA 6419              XRL      A,#019H
B3:0086BC 7043              JNZ      ?C0115?ZW_EXPLORE
B3:0086BE 128987            LCALL    ?L?COM002A
B3:0086C1 126F9D            LCALL    ?L?COM0439
B3:0086C4 EF                MOV      A,R7
B3:0086C5 54F0              ANL      A,#0F0H
B3:0086C7 2410              ADD      A,#010H
B3:0086C9 2E                ADD      A,R6
B3:0086CA 128984            LCALL    ?L?COM0029
B3:0086CD 240B              ADD      A,#0BH
B3:0086CF F9                MOV      R1,A
B3:0086D0 E4                CLR      A
B3:0086D1 3A                ADDC     A,R2
B3:0086D2 FA                MOV      R2,A
B3:0086D3 E4                CLR      A
B3:0086D4 12203B            LCALL    ?C?CSTPTR
B3:0086D7 900A5B            MOV      DPTR,#pRxFrame
B3:0086DA 12899B            LCALL    ?L?COM006B
B3:0086DD B149              ACALL    ?L?COM0019
B3:0086DF 7F18              MOV      R7,#018H
B3:0086E1 12EF14            LCALL    ?L?COM04B2
B3:0086E4 C208              CLR      currentSeqNoUseTX
B3:0086E6 128987            LCALL    ?L?COM002A
B3:0086E9 2404              ADD      A,#04H
B3:0086EB 1252DD            LCALL    ?L?COM0009
B3:0086EE FF                MOV      R7,A
B3:0086EF 128987            LCALL    ?L?COM002A
B3:0086F2 2408              ADD      A,#08H
B3:0086F4 1252DD            LCALL    ?L?COM0009
B3:0086F7 FD                MOV      R5,A
B3:0086F8 12EE96            LCALL    ?L?COM0370
B3:0086FB 12B377            LCALL    ?L?COM0114
B3:0086FE 121967            LCALL    ?INTERBANK_TABLE?_TransportEnQueueExploreFrame
B3:008701         ?C0115?ZW_EXPLORE:
B3:008701 C3                CLR      C
B3:008702 22                RET      
B3:008703         ?C0114?ZW_EXPLORE:
;---- Variable 'bTemp3' assigned to Register 'R7' ----
B3:008703 E4                CLR      A
B3:008704 FF                MOV      R7,A
B3:008705         ?C0123?ZW_EXPLORE:
B3:008705 128987            LCALL    ?L?COM002A
B3:008708 240D              ADD      A,#0DH
B3:00870A 12BFBE            LCALL    ?L?COM0336
B3:00870D 121F7C            LCALL    ?C?CLDPTR
B3:008710 FE                MOV      R6,A
B3:008711 901221            MOV      DPTR,#nodeID
B3:008714 E0                MOVX     A,@DPTR
B3:008715 B50602            CJNE     A,AR6,?C0125?ZW_EXPLORE
B3:008718 C3                CLR      C
B3:008719 22                RET      
B3:00871A         ?C0125?ZW_EXPLORE:
B3:00871A 0F                INC      R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 698


B3:00871B EF                MOV      A,R7
B3:00871C B404E6            CJNE     A,#04H,?C0123?ZW_EXPLORE
B3:00871F         ?C0122?ZW_EXPLORE:
B3:00871F 128987            LCALL    ?L?COM002A
B3:008722 2404              ADD      A,#04H
B3:008724 1252DD            LCALL    ?L?COM0009
B3:008727 FF                MOV      R7,A
B3:008728 128987            LCALL    ?L?COM002A
B3:00872B 2406              ADD      A,#06H
B3:00872D 1252DD            LCALL    ?L?COM0009
B3:008730 540F              ANL      A,#0FH
B3:008732 FD                MOV      R5,A
B3:008733 12C97A            LCALL    _ExploreFrameIgnoreCheck
B3:008736 5002              JNC      ?C0127?ZW_EXPLORE
B3:008738 C3                CLR      C
B3:008739 22                RET      
B3:00873A         ?C0127?ZW_EXPLORE:
B3:00873A 128987            LCALL    ?L?COM002A
B3:00873D 2408              ADD      A,#08H
B3:00873F 1252DD            LCALL    ?L?COM0009
B3:008742 1289D1            LCALL    ?L?COM03C7
B3:008745 7003              JNZ      $ + 5H
B3:008747 0288A8            LJMP     ?C0128?ZW_EXPLORE
B3:00874A 90122A            MOV      DPTR,#bldeviceOptionsMask
B3:00874D E0                MOVX     A,@DPTR
B3:00874E FF                MOV      R7,A
B3:00874F 5430              ANL      A,#030H
B3:008751 6003              JZ       $ + 5H
B3:008753 0288A8            LJMP     ?C0128?ZW_EXPLORE
B3:008756 EF                MOV      A,R7
B3:008757 20E003            JB       ACC.0,$ + 6H
B3:00875A 0288A8            LJMP     ?C0128?ZW_EXPLORE
B3:00875D E555              MOV      A,bCurrentCmd
B3:00875F 6401              XRL      A,#01H
B3:008761 6009              JZ       ?C0130?ZW_EXPLORE
B3:008763 128992            LCALL    ?L?COM0356
B3:008766 1252DA            LCALL    ?L?COM0008
B3:008769 30E722            JNB      ACC.7,?C0129?ZW_EXPLORE
B3:00876C         ?C0130?ZW_EXPLORE:
B3:00876C 201103            JB       exploreInclusionModeRepeat,$ + 6H
B3:00876F 0288A8            LJMP     ?C0128?ZW_EXPLORE
B3:008772 E555              MOV      A,bCurrentCmd
B3:008774 6401              XRL      A,#01H
B3:008776 6003              JZ       $ + 5H
B3:008778 0288A8            LJMP     ?C0128?ZW_EXPLORE
B3:00877B 128987            LCALL    ?L?COM002A
B3:00877E 2411              ADD      A,#011H
B3:008780 F9                MOV      R1,A
B3:008781 E4                CLR      A
B3:008782 3A                ADDC     A,R2
B3:008783 FE                MOV      R6,A
B3:008784 AF01              MOV      R7,AR1
B3:008786 12C9BB            LCALL    _IsNetworkHomeIDValid
B3:008789 4003              JC       $ + 5H
B3:00878B 0288A8            LJMP     ?C0128?ZW_EXPLORE
B3:00878E         ?C0129?ZW_EXPLORE:
B3:00878E 12C906            LCALL    ExploreQueueIndex
B3:008791 8F52              MOV      bExploreQueueIndex,R7
B3:008793 BF0202            CJNE     R7,#02H,?C0131?ZW_EXPLORE
B3:008796 C3                CLR      C
B3:008797 22                RET      
B3:008798         ?C0131?ZW_EXPLORE:
B3:008798 900A5B            MOV      DPTR,#pRxFrame
B3:00879B 12899B            LCALL    ?L?COM006B
B3:00879E 1252DA            LCALL    ?L?COM0008
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 699


B3:0087A1 FF                MOV      R7,A
B3:0087A2 7440              MOV      A,#040H
B3:0087A4 C3                CLR      C
B3:0087A5 9F                SUBB     A,R7
B3:0087A6 5002              JNC      ?C0132?ZW_EXPLORE
B3:0087A8 C3                CLR      C
B3:0087A9 22                RET      
B3:0087AA         ?C0132?ZW_EXPLORE:
B3:0087AA E555              MOV      A,bCurrentCmd
B3:0087AC B4011A            CJNE     A,#01H,?C0133?ZW_EXPLORE
B3:0087AF 128987            LCALL    ?L?COM002A
B3:0087B2 126FEA            LCALL    ?L?COM0474
B3:0087B5 7B01              MOV      R3,#01H
B3:0087B7 C002              PUSH     AR2
B3:0087B9 C001              PUSH     AR1
B3:0087BB 7A12              MOV      R2,#HIGH homeID
B3:0087BD 7923              MOV      R1,#LOW homeID
B3:0087BF B149              ACALL    ?L?COM0019
B3:0087C1 D001              POP      AR1
B3:0087C3 D002              POP      AR2
B3:0087C5 7F04              MOV      R7,#04H
B3:0087C7 3195              ACALL    ___ZW_memcpy
B3:0087C9         ?C0133?ZW_EXPLORE:
B3:0087C9 E552              MOV      A,bExploreQueueIndex
B3:0087CB 12EDE4            LCALL    ?L?COM01B6
B3:0087CE 900A5B            MOV      DPTR,#pRxFrame
B3:0087D1 12899B            LCALL    ?L?COM006B
B3:0087D4 1252DA            LCALL    ?L?COM0008
B3:0087D7 126DF0            LCALL    ?L?COM0071
B3:0087DA 126F43            LCALL    ?L?COM03B6
B3:0087DD C003              PUSH     AR3
B3:0087DF C002              PUSH     AR2
B3:0087E1 C001              PUSH     AR1
B3:0087E3 900A5B            MOV      DPTR,#pRxFrame
B3:0087E6 12899B            LCALL    ?L?COM006B
B3:0087E9 B149              ACALL    ?L?COM0019
B3:0087EB D001              POP      AR1
B3:0087ED D002              POP      AR2
B3:0087EF D003              POP      AR3
B3:0087F1 3195              ACALL    ___ZW_memcpy
B3:0087F3 128987            LCALL    ?L?COM002A
B3:0087F6 2404              ADD      A,#04H
B3:0087F8 1252DD            LCALL    ?L?COM0009
B3:0087FB FF                MOV      R7,A
B3:0087FC 12C915            LCALL    _ExploreFrameIgnoreQueueIndex
;---- Variable 'bTemp1' assigned to Register 'R7' ----
B3:0087FF 128987            LCALL    ?L?COM002A
B3:008802 2406              ADD      A,#06H
B3:008804 1252DD            LCALL    ?L?COM0009
B3:008807 540F              ANL      A,#0FH
B3:008809 FE                MOV      R6,A
B3:00880A 12CB8A            LCALL    ?L?COM03E1
B3:00880D A606              MOV      @R0,AR6
B3:00880F 31A1              ACALL    ?L?COM0217
B3:008811 7607              MOV      @R0,#07H
B3:008813 08                INC      R0
B3:008814 76D0              MOV      @R0,#0D0H
B3:008816 3187              ACALL    ?L?COM002A
B3:008818 240C              ADD      A,#0CH
B3:00881A 1252DD            LCALL    ?L?COM0009
B3:00881D 54F0              ANL      A,#0F0H
B3:00881F 900A61            MOV      DPTR,#bTemp
B3:008822 F0                MOVX     @DPTR,A
B3:008823 7002              JNZ      $ + 4H
B3:008825 01A8              AJMP     ?C0128?ZW_EXPLORE
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 700


B3:008827 E0                MOVX     A,@DPTR
B3:008828 FF                MOV      R7,A
B3:008829 7440              MOV      A,#040H
B3:00882B C3                CLR      C
B3:00882C 9F                SUBB     A,R7
B3:00882D 4079              JC       ?C0128?ZW_EXPLORE
B3:00882F E0                MOVX     A,@DPTR
B3:008830 24F0              ADD      A,#0F0H
B3:008832 F0                MOVX     @DPTR,A
B3:008833 126DF1            LCALL    ?L?COM0072
B3:008836 242C              ADD      A,#02CH
B3:008838 1252DD            LCALL    ?L?COM0009
B3:00883B 540F              ANL      A,#0FH
B3:00883D FF                MOV      R7,A
;---- Variable 'bTemp2' assigned to Register 'R7' ----
B3:00883E 7404              MOV      A,#04H
B3:008840 D3                SETB     C
B3:008841 9F                SUBB     A,R7
B3:008842 4064              JC       ?C0128?ZW_EXPLORE
B3:008844 901221            MOV      DPTR,#nodeID
B3:008847 E0                MOVX     A,@DPTR
B3:008848 FE                MOV      R6,A
B3:008849 126DF1            LCALL    ?L?COM0072
B3:00884C 242D              ADD      A,#02DH
B3:00884E 12BFBE            LCALL    ?L?COM0336
B3:008851 EE                MOV      A,R6
B3:008852 12203B            LCALL    ?C?CSTPTR
B3:008855 900A61            MOV      DPTR,#bTemp
B3:008858 E0                MOVX     A,@DPTR
B3:008859 2F                ADD      A,R7
B3:00885A 04                INC      A
B3:00885B 126DF0            LCALL    ?L?COM0071
B3:00885E 242C              ADD      A,#02CH
B3:008860 F9                MOV      R1,A
B3:008861 E4                CLR      A
B3:008862 3A                ADDC     A,R2
B3:008863 FA                MOV      R2,A
B3:008864 EF                MOV      A,R7
B3:008865 3184              ACALL    ?L?COM0029
B3:008867 2404              ADD      A,#04H
B3:008869 1252DD            LCALL    ?L?COM0009
B3:00886C 126DF0            LCALL    ?L?COM0071
B3:00886F 128593            LCALL    ?L?COM00AC
B3:008872 EF                MOV      A,R7
B3:008873 3184              ACALL    ?L?COM0029
B3:008875 2408              ADD      A,#08H
B3:008877 1252DD            LCALL    ?L?COM0009
B3:00887A FF                MOV      R7,A
B3:00887B 900854            MOV      DPTR,#pExploreQueueElement
B3:00887E 31B7              ACALL    ?L?COM004D
B3:008880 EF                MOV      A,R7
B3:008881 126FF1            LCALL    ?L?COM0475
B3:008884 126F2D            LCALL    ?L?COM03A2
B3:008887 126DF1            LCALL    ?L?COM0072
B3:00888A 125D39            LCALL    ?L?COM00E6
B3:00888D 7440              MOV      A,#040H
B3:00888F 12203B            LCALL    ?C?CSTPTR
B3:008892 900A5B            MOV      DPTR,#pRxFrame
B3:008895 319B              ACALL    ?L?COM006B
B3:008897 1252DA            LCALL    ?L?COM0008
B3:00889A 126DF0            LCALL    ?L?COM0071
B3:00889D 31AA              ACALL    ?L?COM0143
B3:00889F 126DF1            LCALL    ?L?COM0072
B3:0088A2 12C710            LCALL    ?L?COM0383
B3:0088A5 1221E8            LCALL    ?C?ISTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 701


B3:0088A8         ?C0128?ZW_EXPLORE:
B3:0088A8 3187              ACALL    ?L?COM002A
B3:0088AA 2408              ADD      A,#08H
B3:0088AC 1252DD            LCALL    ?L?COM0009
B3:0088AF 31D1              ACALL    ?L?COM03C7
B3:0088B1 6006              JZ       ?C0137?ZW_EXPLORE
B3:0088B3 EF                MOV      A,R7
B3:0088B4 F4                CPL      A
B3:0088B5 6002              JZ       $ + 4H
B3:0088B7 2180              AJMP     ?C0136?ZW_EXPLORE
B3:0088B9         ?C0137?ZW_EXPLORE:
B3:0088B9 3192              ACALL    ?L?COM0356
B3:0088BB 1252DA            LCALL    ?L?COM0008
B3:0088BE 30E702            JNB      ACC.7,$ + 5H
B3:0088C1 2180              AJMP     ?C0136?ZW_EXPLORE
B3:0088C3 E555              MOV      A,bCurrentCmd
B3:0088C5 6002              JZ       $ + 4H
B3:0088C7 2180              AJMP     ?C0136?ZW_EXPLORE
B3:0088C9 3187              ACALL    ?L?COM002A
B3:0088CB 126FEA            LCALL    ?L?COM0474
B3:0088CE C003              PUSH     AR3
B3:0088D0 C002              PUSH     AR2
B3:0088D2 C001              PUSH     AR1
B3:0088D4 900A5B            MOV      DPTR,#pRxFrame
B3:0088D7 31B7              ACALL    ?L?COM004D
B3:0088D9 1225A7            LCALL    ?C?PSTPTR
B3:0088DC 900A5B            MOV      DPTR,#pRxFrame
B3:0088DF 319B              ACALL    ?L?COM006B
B3:0088E1 1252DA            LCALL    ?L?COM0008
B3:0088E4 24EE              ADD      A,#0EEH
B3:0088E6 FF                MOV      R7,A
B3:0088E7 3192              ACALL    ?L?COM0356
B3:0088E9 E9                MOV      A,R1
B3:0088EA 31AA              ACALL    ?L?COM0143
B3:0088EC 3192              ACALL    ?L?COM0356
B3:0088EE 1252DA            LCALL    ?L?COM0008
B3:0088F1 4401              ORL      A,#01H
B3:0088F3 3184              ACALL    ?L?COM0029
B3:0088F5 2405              ADD      A,#05H
B3:0088F7 1252DD            LCALL    ?L?COM0009
B3:0088FA 30E67C            JNB      ACC.6,?C0138?ZW_EXPLORE
B3:0088FD 3187              ACALL    ?L?COM002A
B3:0088FF 2404              ADD      A,#04H
B3:008901 1252DD            LCALL    ?L?COM0009
B3:008904 FF                MOV      R7,A
B3:008905 C239              CLR      ?_StoreRouteExplore?BIT
B3:008907 3187              ACALL    ?L?COM002A
B3:008909 240C              ADD      A,#0CH
B3:00890B 31C2              ACALL    ?L?COM0371
B3:00890D 121A11            LCALL    ?INTERBANK_TABLE?_UpdateResponseRouteLastReturnRoute
B3:008910 900A5B            MOV      DPTR,#pRxFrame
B3:008913 319B              ACALL    ?L?COM006B
B3:008915 128549            LCALL    ?L?COM0019
B3:008918 7F11              MOV      R7,#011H
B3:00891A 12EF14            LCALL    ?L?COM04B2
B3:00891D 90085C            MOV      DPTR,#exploreSearchResultBuffer+05H
B3:008920 E0                MOVX     A,@DPTR
B3:008921 54BF              ANL      A,#0BFH
B3:008923 F0                MOVX     @DPTR,A
B3:008924 3187              ACALL    ?L?COM002A
B3:008926 2404              ADD      A,#04H
B3:008928 1252DD            LCALL    ?L?COM0009
B3:00892B 900868            MOV      DPTR,#exploreSearchResultBuffer+011H
B3:00892E F0                MOVX     @DPTR,A
B3:00892F 3187              ACALL    ?L?COM002A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 702


B3:008931 2406              ADD      A,#06H
B3:008933 1252DD            LCALL    ?L?COM0009
B3:008936 540F              ANL      A,#0FH
B3:008938 900869            MOV      DPTR,#exploreSearchResultBuffer+012H
B3:00893B F0                MOVX     @DPTR,A
B3:00893C 3187              ACALL    ?L?COM002A
B3:00893E 240C              ADD      A,#0CH
B3:008940 128545            LCALL    ?L?COM0017
B3:008943 7B01              MOV      R3,#01H
B3:008945 7A08              MOV      R2,#HIGH exploreSearchResultBuffer+013H
B3:008947 796A              MOV      R1,#LOW exploreSearchResultBuffer+013H
B3:008949 7F05              MOV      R7,#05H
B3:00894B 127028            LCALL    ?L?COM04E3
B3:00894E 90085B            MOV      DPTR,#exploreSearchResultBuffer+04H
B3:008951 F0                MOVX     @DPTR,A
B3:008952 90085E            MOV      DPTR,#exploreSearchResultBuffer+07H
B3:008955 7419              MOV      A,#019H
B3:008957 F0                MOVX     @DPTR,A
B3:008958 3187              ACALL    ?L?COM002A
B3:00895A 2404              ADD      A,#04H
B3:00895C 1252DD            LCALL    ?L?COM0009
B3:00895F FD                MOV      R5,A
B3:008960 90085F            MOV      DPTR,#exploreSearchResultBuffer+08H
B3:008963 F0                MOVX     @DPTR,A
B3:008964 A3                INC      DPTR
B3:008965 7422              MOV      A,#022H
B3:008967 F0                MOVX     @DPTR,A
B3:008968 A3                INC      DPTR
B3:008969 7407              MOV      A,#07H
B3:00896B F0                MOVX     @DPTR,A
B3:00896C C208              CLR      currentSeqNoUseTX
B3:00896E 12EE96            LCALL    ?L?COM0370
B3:008971 12B377            LCALL    ?L?COM0114
B3:008974 121967            LCALL    ?INTERBANK_TABLE?_TransportEnQueueExploreFrame
B3:008977 8009              SJMP     ?C0142?ZW_EXPLORE
B3:008979         ?C0138?ZW_EXPLORE:
B3:008979 E555              MOV      A,bCurrentCmd
B3:00897B C3                CLR      C
B3:00897C 7001              JNZ      ?C0140?ZW_EXPLORE
B3:00897E D3                SETB     C
B3:00897F         ?C0140?ZW_EXPLORE:
B3:00897F 22                RET      
B3:008980         ?C0136?ZW_EXPLORE:
B3:008980 C3                CLR      C
B3:008981 22                RET      
B3:008982         ?C0142?ZW_EXPLORE:
B3:008982 D3                SETB     C
B3:008983 22                RET      
----- FUNCTION _IsMyExploreFrame (END) -------


----- FUNCTION ?L?COM0029 (BEGIN) -----
B3:008984 12203B            LCALL    ?C?CSTPTR
B3:008987         ?L?COM002A:
B3:008987 900A5B            MOV      DPTR,#pRxFrame
B3:00898A 122552            LCALL    ?C?PLDXDATA
B3:00898D 122587            LCALL    ?C?PLDPTR
B3:008990 E9                MOV      A,R1
B3:008991 22                RET      
----- FUNCTION ?L?COM0029 (END) -------


----- FUNCTION ?L?COM0356 (BEGIN) -----
B3:008992 900A5B            MOV      DPTR,#pRxFrame
B3:008995 022552            LJMP     ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 703


----- FUNCTION ?L?COM0356 (END) -------


----- FUNCTION ?L?COM006A (BEGIN) -----
B3:008998 904593            MOV      DPTR,#d
B3:00899B         ?L?COM006B:
B3:00899B 122552            LCALL    ?C?PLDXDATA
B3:00899E 022587            LJMP     ?C?PLDPTR
----- FUNCTION ?L?COM006A (END) -------


----- FUNCTION ?L?COM0217 (BEGIN) -----
B3:0089A1 EF                MOV      A,R7
B3:0089A2         ?L?COM0218:
B3:0089A2 25E0              ADD      A,ACC
B3:0089A4 25E0              ADD      A,ACC
B3:0089A6 2458              ADD      A,#LOW exploreFrameIgnoreQueue+02H
B3:0089A8 F8                MOV      R0,A
B3:0089A9 22                RET      
----- FUNCTION ?L?COM0217 (END) -------


----- FUNCTION ?L?COM0143 (BEGIN) -----
B3:0089AA 2406              ADD      A,#06H
B3:0089AC         ?L?COM0144:
B3:0089AC F9                MOV      R1,A
B3:0089AD E4                CLR      A
B3:0089AE 3A                ADDC     A,R2
B3:0089AF FA                MOV      R2,A
B3:0089B0 EF                MOV      A,R7
B3:0089B1 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM0143 (END) -------


----- FUNCTION ?L?COM004C (BEGIN) -----
B3:0089B4 9028DB            MOV      DPTR,#the_context+0D7H
B3:0089B7         ?L?COM004D:
B3:0089B7 122552            LCALL    ?C?PLDXDATA
B3:0089BA         ?L?COM004E:
B3:0089BA E9                MOV      A,R1
B3:0089BB 2403              ADD      A,#03H
B3:0089BD F9                MOV      R1,A
B3:0089BE E4                CLR      A
B3:0089BF 3A                ADDC     A,R2
B3:0089C0 FA                MOV      R2,A
B3:0089C1 22                RET      
----- FUNCTION ?L?COM004C (END) -------


----- FUNCTION ?L?COM0371 (BEGIN) -----
B3:0089C2 F9                MOV      R1,A
B3:0089C3 E4                CLR      A
B3:0089C4 3A                ADDC     A,R2
B3:0089C5 AD01              MOV      R5,AR1
B3:0089C7 9045D4            MOV      DPTR,#?_StoreRouteExplore?BYTE+01H
B3:0089CA F0                MOVX     @DPTR,A
B3:0089CB A3                INC      DPTR
B3:0089CC ED                MOV      A,R5
B3:0089CD F0                MOVX     @DPTR,A
B3:0089CE 0219B7            LJMP     ?INTERBANK_TABLE?_StoreRouteExplore
----- FUNCTION ?L?COM0371 (END) -------


----- FUNCTION ?L?COM03C7 (BEGIN) -----
B3:0089D1 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 704


B3:0089D2 901221            MOV      DPTR,#nodeID
B3:0089D5 E0                MOVX     A,@DPTR
B3:0089D6 6F                XRL      A,R7
B3:0089D7 22                RET      
----- FUNCTION ?L?COM03C7 (END) -------


----- FUNCTION _ZW_NodeMaskGetNextNode (BEGIN) -----
;---- Variable 'currentNodeId' assigned to Register 'R7' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:0089D8         ?C0018?ZW_NODEMASK:
B3:0089D8 EF                MOV      A,R7
B3:0089D9 C3                CLR      C
B3:0089DA 94E8              SUBB     A,#0E8H
B3:0089DC 5024              JNC      ?C0019?ZW_NODEMASK
B3:0089DE EF                MOV      A,R7
B3:0089DF 13                RRC      A
B3:0089E0 13                RRC      A
B3:0089E1 13                RRC      A
B3:0089E2 541F              ANL      A,#01FH
B3:0089E4 F582              MOV      DPL,A
B3:0089E6 12A72F            LCALL    ?L?COM00BD
B3:0089E9 FE                MOV      R6,A
B3:0089EA EF                MOV      A,R7
B3:0089EB 5407              ANL      A,#07H
B3:0089ED FD                MOV      R5,A
B3:0089EE EE                MOV      A,R6
B3:0089EF A805              MOV      R0,AR5
B3:0089F1 08                INC      R0
B3:0089F2 8002              SJMP     ?C0029?ZW_NODEMASK
B3:0089F4         ?C0028?ZW_NODEMASK:
B3:0089F4 C3                CLR      C
B3:0089F5 13                RRC      A
B3:0089F6         ?C0029?ZW_NODEMASK:
B3:0089F6 D8FC              DJNZ     R0,?C0028?ZW_NODEMASK
B3:0089F8 30E004            JNB      ACC.0,?C0020?ZW_NODEMASK
B3:0089FB EF                MOV      A,R7
B3:0089FC 04                INC      A
B3:0089FD FF                MOV      R7,A
B3:0089FE 22                RET      
B3:0089FF         ?C0020?ZW_NODEMASK:
B3:0089FF 0F                INC      R7
B3:008A00 80D6              SJMP     ?C0018?ZW_NODEMASK
B3:008A02         ?C0019?ZW_NODEMASK:
B3:008A02 7F00              MOV      R7,#00H
B3:008A04 22                RET      
----- FUNCTION _ZW_NodeMaskGetNextNode (END) -------


----- FUNCTION ?L?COM053F (BEGIN) -----
B3:008A05 7A28              MOV      R2,#HIGH the_context
B3:008A07 7904              MOV      R1,#LOW the_context
----- FUNCTION _s2_restore_keys (BEGIN) -----
B3:008A09 904596            MOV      DPTR,#p_context
B3:008A0C 122572            LCALL    ?C?PSTXDATA
B3:008A0F E4                CLR      A
B3:008A10 9028CA            MOV      DPTR,#the_context+0C6H
B3:008A13 F0                MOVX     @DPTR,A
B3:008A14 904599            MOV      DPTR,#i
B3:008A17 F0                MOVX     @DPTR,A
B3:008A18         ?C0029?S2_INCLUSION:
B3:008A18 904599            MOV      DPTR,#i
B3:008A1B E0                MOVX     A,@DPTR
B3:008A1C FF                MOV      R7,A
B3:008A1D C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 705


B3:008A1E 9403              SUBB     A,#03H
B3:008A20 5032              JNC      ?C0030?S2_INCLUSION
B3:008A22 EF                MOV      A,R7
B3:008A23 25E0              ADD      A,ACC
B3:008A25 2466              ADD      A,#LOW m_key_slot_pair
B3:008A27 F582              MOV      DPL,A
B3:008A29 E4                CLR      A
B3:008A2A 342F              ADDC     A,#HIGH m_key_slot_pair
B3:008A2C 515F              ACALL    ?L?COM02C7
B3:008A2E 121B01            LCALL    ?INTERBANK_TABLE?_keystore_network_key_read
;---- Variable 'ret_val' assigned to Register 'R7' ----
B3:008A31 EF                MOV      A,R7
B3:008A32 B40117            CJNE     A,#01H,?C0031?S2_INCLUSION
B3:008A35 904599            MOV      DPTR,#i
B3:008A38 E0                MOVX     A,@DPTR
B3:008A39 25E0              ADD      A,ACC
B3:008A3B 2467              ADD      A,#LOW m_key_slot_pair+01H
B3:008A3D F582              MOV      DPL,A
B3:008A3F E4                CLR      A
B3:008A40 342F              ADDC     A,#HIGH m_key_slot_pair+01H
B3:008A42 515F              ACALL    ?L?COM02C7
B3:008A44 E4                CLR      A
B3:008A45 904536            MOV      DPTR,#?___S2_network_key_update?BYTE+04H
B3:008A48 F0                MOVX     @DPTR,A
B3:008A49 12BD47            LCALL    ___S2_network_key_update
B3:008A4C         ?C0031?S2_INCLUSION:
B3:008A4C 904599            MOV      DPTR,#i
B3:008A4F E0                MOVX     A,@DPTR
B3:008A50 04                INC      A
B3:008A51 F0                MOVX     @DPTR,A
B3:008A52 80C4              SJMP     ?C0029?S2_INCLUSION
B3:008A54         ?C0030?S2_INCLUSION:
B3:008A54 7E00              MOV      R6,#00H
B3:008A56 7F02              MOV      R7,#02H
B3:008A58 7D00              MOV      R5,#00H
B3:008A5A 5163              ACALL    ?L?COM02C8
B3:008A5C 0228E0            LJMP     ?C?MEMSET
----- FUNCTION _s2_restore_keys (END) -------


----- FUNCTION ?L?COM02C7 (BEGIN) -----
B3:008A5F F583              MOV      DPH,A
B3:008A61 E0                MOVX     A,@DPTR
B3:008A62 FF                MOV      R7,A
B3:008A63         ?L?COM02C8:
B3:008A63 7B01              MOV      R3,#01H
B3:008A65 7A2F              MOV      R2,#HIGH shared_key_mem
B3:008A67 7926              MOV      R1,#LOW shared_key_mem
B3:008A69 22                RET      
----- FUNCTION ?L?COM02C7 (END) -------


----- FUNCTION s2_do_ecdh_calc_b (BEGIN) -----
B3:008A6A 5163              ACALL    ?L?COM02C8
B3:008A6C 121AF7            LCALL    ?INTERBANK_TABLE?_keystore_private_key_read
B3:008A6F 5163              ACALL    ?L?COM02C8
B3:008A71 9039B6            MOV      DPTR,#?_crypto_scalarmult_curve25519?BYTE+03H
B3:008A74 122572            LCALL    ?C?PSTXDATA
B3:008A77 9039B9            MOV      DPTR,#?_crypto_scalarmult_curve25519?BYTE+06H
B3:008A7A 712B              ACALL    ?L?COM0417
B3:008A7C 121B60            LCALL    ?INTERBANK_TABLE?_crypto_scalarmult_curve25519
B3:008A7F 7826              MOV      R0,#LOW shared_key_mem
B3:008A81 7C2F              MOV      R4,#HIGH shared_key_mem
B3:008A83 7D01              MOV      R5,#01H
B3:008A85 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 706


B3:008A87 7A2B              MOV      R2,#HIGH the_context+0318H
B3:008A89 791C              MOV      R1,#LOW the_context+0318H
B3:008A8B 12BE4D            LCALL    ?L?COM01E6
B3:008A8E 7B01              MOV      R3,#01H
B3:008A90 7A2F              MOV      R2,#HIGH shared_key_mem+020H
B3:008A92 7946              MOV      R1,#LOW shared_key_mem+020H
B3:008A94 121AF2            LCALL    ?INTERBANK_TABLE?_keystore_public_key_read
B3:008A97 5163              ACALL    ?L?COM02C8
B3:008A99 903863            MOV      DPTR,#?_tempkey_extract?BYTE+03H
B3:008A9C 122572            LCALL    ?C?PSTXDATA
B3:008A9F 903866            MOV      DPTR,#?_tempkey_extract?BYTE+06H
B3:008AA2 712B              ACALL    ?L?COM0417
B3:008AA4 121B4C            LCALL    ?INTERBANK_TABLE?_tempkey_extract
B3:008AA7 7B01              MOV      R3,#01H
B3:008AA9 7A2B              MOV      R2,#HIGH the_context+0318H
B3:008AAB 791C              MOV      R1,#LOW the_context+0318H
B3:008AAD 904536            MOV      DPTR,#?___S2_network_key_update?BYTE+04H
B3:008AB0 7401              MOV      A,#01H
B3:008AB2 F0                MOVX     @DPTR,A
B3:008AB3 E4                CLR      A
B3:008AB4 FF                MOV      R7,A
B3:008AB5 12BD47            LCALL    ___S2_network_key_update
B3:008AB8 903033            MOV      DPTR,#m_retry_counter
B3:008ABB 7418              MOV      A,#018H
B3:008ABD F0                MOVX     @DPTR,A
B3:;----                  JMP      s2_send_echo_kex_set
----- FUNCTION s2_do_ecdh_calc_b (END) -------


----- FUNCTION s2_send_echo_kex_set (BEGIN) -----
B3:008ABE 903033            MOV      DPTR,#m_retry_counter
B3:008AC1 E0                MOVX     A,@DPTR
B3:008AC2 14                DEC      A
B3:008AC3 12BA94            LCALL    ?L?COM01E8
B3:008AC6 7406              MOV      A,#06H
B3:008AC8 F0                MOVX     @DPTR,A
B3:008AC9 9028C5            MOV      DPTR,#the_context+0C1H
B3:008ACC E0                MOVX     A,@DPTR
B3:008ACD 4401              ORL      A,#01H
B3:008ACF 902AF5            MOV      DPTR,#the_context+02F1H
B3:008AD2 F0                MOVX     @DPTR,A
B3:008AD3 9028C6            MOV      DPTR,#the_context+0C2H
B3:008AD6 E0                MOVX     A,@DPTR
B3:008AD7 902AF6            MOV      DPTR,#the_context+02F2H
B3:008ADA F0                MOVX     @DPTR,A
B3:008ADB 9028C7            MOV      DPTR,#the_context+0C3H
B3:008ADE E0                MOVX     A,@DPTR
B3:008ADF 902AF7            MOV      DPTR,#the_context+02F3H
B3:008AE2 F0                MOVX     @DPTR,A
B3:008AE3 9028C8            MOV      DPTR,#the_context+0C4H
B3:008AE6 E0                MOVX     A,@DPTR
B3:008AE7 902AF8            MOV      DPTR,#the_context+02F4H
B3:008AEA F0                MOVX     @DPTR,A
B3:008AEB 902B1B            MOV      DPTR,#the_context+0317H
B3:008AEE 7406              MOV      A,#06H
B3:008AF0 12BAA9            LCALL    ?L?COM0237
B3:008AF3 04                INC      A
B3:008AF4 F0                MOVX     @DPTR,A
B3:008AF5 FB                MOV      R3,A
B3:008AF6 12C3CD            LCALL    ?L?COM0216
B3:008AF9 12B9D3            LCALL    ?L?COM022E
B3:;----                  JMP      _s2_inclusion_set_timeout
----- FUNCTION s2_send_echo_kex_set (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 707


----- FUNCTION _s2_inclusion_set_timeout (BEGIN) -----
B3:008AFC 904586            MOV      DPTR,#interval
B3:008AFF 1224BA            LCALL    ?C?LSTXDATA
B3:008B02 E4                CLR      A
B3:008B03 7F0A              MOV      R7,#0AH
B3:008B05 FE                MOV      R6,A
B3:008B06 FD                MOV      R5,A
B3:008B07 FC                MOV      R4,A
B3:008B08 904586            MOV      DPTR,#interval
B3:008B0B 12247E            LCALL    ?C?LLDXDATA0
B3:008B0E 12224F            LCALL    ?C?LMUL
B3:008B11 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:008B14 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_s2_inclusion_notify_timeout
B3:008B16 F0                MOVX     @DPTR,A
B3:008B17 A3                INC      DPTR
B3:008B18 7490              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_s2_inclusion_notify_timeout
B3:008B1A F0                MOVX     @DPTR,A
B3:008B1B 12D662            LCALL    ?L?COM023C
B3:008B1E 126F24            LCALL    ?L?COM0389
B3:008B21 7A3F              MOV      R2,#HIGH s2_itimer
B3:008B23 7926              MOV      R1,#LOW s2_itimer
B3:008B25 121B29            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:008B28 7F01              MOV      R7,#01H
B3:008B2A 22                RET      
----- FUNCTION _s2_inclusion_set_timeout (END) -------


----- FUNCTION ?L?COM0417 (BEGIN) -----
B3:008B2B 7A2B              MOV      R2,#HIGH the_context+0318H
B3:008B2D 791C              MOV      R1,#LOW the_context+0318H
B3:008B2F 122572            LCALL    ?C?PSTXDATA
B3:008B32 7A2F              MOV      R2,#HIGH shared_secret
B3:008B34 79EE              MOV      R1,#LOW shared_secret
B3:008B36 22                RET      
----- FUNCTION ?L?COM0417 (END) -------


----- FUNCTION ExploreFrameIgnoreTick (BEGIN) -----
;---- Variable 'i' assigned to Register 'R7' ----
B3:008B37 E4                CLR      A
B3:008B38 FF                MOV      R7,A
B3:008B39         ?C0047?ZW_EXPLORE:
B3:008B39 31A1              ACALL    ?L?COM0217
B3:008B3B E6                MOV      A,@R0
B3:008B3C FC                MOV      R4,A
B3:008B3D 08                INC      R0
B3:008B3E E6                MOV      A,@R0
B3:008B3F 4C                ORL      A,R4
B3:008B40 601A              JZ       ?C0049?ZW_EXPLORE
B3:008B42 31A1              ACALL    ?L?COM0217
B3:008B44 08                INC      R0
B3:008B45 E6                MOV      A,@R0
B3:008B46 16                DEC      @R0
B3:008B47 18                DEC      R0
B3:008B48 7001              JNZ      ?C0143?ZW_EXPLORE
B3:008B4A 16                DEC      @R0
B3:008B4B         ?C0143?ZW_EXPLORE:
B3:008B4B 14                DEC      A
B3:008B4C 8604              MOV      AR4,@R0
B3:008B4E 4C                ORL      A,R4
B3:008B4F 700B              JNZ      ?C0049?ZW_EXPLORE
B3:008B51 12CB8A            LCALL    ?L?COM03E1
B3:008B54 76FF              MOV      @R0,#0FFH
B3:008B56 EF                MOV      A,R7
B3:008B57 12C972            LCALL    ?L?COM02E9
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 708


B3:008B5A E4                CLR      A
B3:008B5B F6                MOV      @R0,A
B3:008B5C         ?C0049?ZW_EXPLORE:
B3:008B5C 0F                INC      R7
B3:008B5D EF                MOV      A,R7
B3:008B5E B402D8            CJNE     A,#02H,?C0047?ZW_EXPLORE
B3:008B61 22                RET      
----- FUNCTION ExploreFrameIgnoreTick (END) -------


----- FUNCTION _S2_init_ctx (BEGIN) -----
B3:008B62 904450            MOV      DPTR,#home
B3:008B65 1224BA            LCALL    ?C?LSTXDATA
B3:008B68 12C445            LCALL    ?L?COM02DF
B3:008B6B 904454            MOV      DPTR,#ctx
B3:008B6E 122572            LCALL    ?C?PSTXDATA
B3:008B71 7E03              MOV      R6,#03H
B3:008B73 7F38              MOV      R7,#038H
B3:008B75 7D00              MOV      R5,#00H
B3:008B77 719A              ACALL    ?L?COM04A1
B3:008B79 1228E0            LCALL    ?C?MEMSET
B3:008B7C 904450            MOV      DPTR,#home
B3:008B7F 122462            LCALL    ?C?LLDXDATA
B3:008B82 719A              ACALL    ?L?COM04A1
B3:008B84 9000C7            MOV      DPTR,#0C7H
B3:008B87 12243E            LCALL    ?C?LSTOPTR
B3:008B8A 9000C6            MOV      DPTR,#0C6H
B3:008B8D E4                CLR      A
B3:008B8E 12204D            LCALL    ?C?CSTOPTR
B3:008B91 90020D            MOV      DPTR,#020DH
B3:008B94 E4                CLR      A
B3:008B95 12204D            LCALL    ?C?CSTOPTR
B3:008B98 5109              ACALL    _s2_restore_keys
B3:;----                  JMP      ?L?COM04A1
----- FUNCTION _S2_init_ctx (END) -------


----- FUNCTION ?L?COM04A1 (BEGIN) -----
B3:008B9A 904454            MOV      DPTR,#ctx
B3:008B9D 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04A1 (END) -------


----- FUNCTION s2_send_net_key_verify (BEGIN) -----
B3:008BA0 12B98D            LCALL    ?L?COM00B4
B3:008BA3 FF                MOV      R7,A
;---- Variable 'received_key' assigned to Register 'R7' ----
B3:008BA4 9028C9            MOV      DPTR,#the_context+0C5H
B3:008BA7 E0                MOVX     A,@DPTR
B3:008BA8 6F                XRL      A,R7
B3:008BA9 7032              JNZ      error_handling?S2_INCLUSION
B3:008BAB         ?C0120?S2_INCLUSION:
B3:008BAB 31BA              ACALL    ?L?COM004E
B3:008BAD 121B06            LCALL    ?INTERBANK_TABLE?_keystore_network_key_write
B3:008BB0 9028C9            MOV      DPTR,#the_context+0C5H
B3:008BB3 E0                MOVX     A,@DPTR
B3:008BB4 25E0              ADD      A,ACC
B3:008BB6 F0                MOVX     @DPTR,A
B3:008BB7 31B4              ACALL    ?L?COM004C
B3:008BB9 E4                CLR      A
B3:008BBA 904536            MOV      DPTR,#?___S2_network_key_update?BYTE+04H
B3:008BBD F0                MOVX     @DPTR,A
B3:008BBE 7F01              MOV      R7,#01H
B3:008BC0 12BD47            LCALL    ___S2_network_key_update
B3:008BC3 12BA95            LCALL    ?L?COM01E9
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 709


B3:008BC6 740B              MOV      A,#0BH
B3:008BC8 F0                MOVX     @DPTR,A
B3:008BC9 902B1B            MOV      DPTR,#the_context+0317H
B3:008BCC 7402              MOV      A,#02H
B3:008BCE F0                MOVX     @DPTR,A
B3:008BCF 9028DA            MOV      DPTR,#the_context+0D6H
B3:008BD2 14                DEC      A
B3:008BD3 F0                MOVX     @DPTR,A
B3:008BD4 E4                CLR      A
B3:008BD5 9028D5            MOV      DPTR,#the_context+0D1H
B3:008BD8 12B9CA            LCALL    ?L?COM022D
B3:008BDB 41FC              AJMP     _s2_inclusion_set_timeout
B3:008BDD         error_handling:
B3:008BDD E4                CLR      A
B3:008BDE FD                MOV      R5,A
B3:008BDF 7F0A              MOV      R7,#0AH
B3:;----                  JMP      ?L?COM0443
----- FUNCTION s2_send_net_key_verify (END) -------


----- FUNCTION ?L?COM0443 (BEGIN) -----
B3:008BE1 12BA3D            LCALL    _inclusion_failed_frame_send
B3:008BE4 7F0B              MOV      R7,#0BH
B3:008BE6 7E02              MOV      R6,#02H
----- FUNCTION _process_event (BEGIN) -----
;---- Variable 'evt' assigned to Register 'R6/R7' ----
B3:008BE8 90464C            MOV      DPTR,#event
B3:008BEB 1263EA            LCALL    ?L?COM03AD
B3:008BEE 90464B            MOV      DPTR,#i
B3:008BF1 F0                MOVX     @DPTR,A
B3:008BF2         ?C0002?S2_INCLUSION:
B3:008BF2 90464B            MOV      DPTR,#i
B3:008BF5 E0                MOVX     A,@DPTR
B3:008BF6 FF                MOV      R7,A
B3:008BF7 C3                CLR      C
B3:008BF8 943B              SUBB     A,#03BH
B3:008BFA 4002              JC       $ + 4H
B3:008BFC 81D4              AJMP     ?C0028?S2_INCLUSION
B3:008BFE 75F005            MOV      B,#05H
B3:008C01 EF                MOV      A,R7
B3:008C02 902DFF            MOV      DPTR,#s2_transition_table
B3:008C05 122546            LCALL    ?C?OFFXADD
B3:008C08 E0                MOVX     A,@DPTR
B3:008C09 FF                MOV      R7,A
B3:008C0A 902A13            MOV      DPTR,#the_context+020FH
B3:008C0D E0                MOVX     A,@DPTR
B3:008C0E FE                MOV      R6,A
B3:008C0F 6F                XRL      A,R7
B3:008C10 6007              JZ       ?C0006?S2_INCLUSION
B3:008C12 EF                MOV      A,R7
B3:008C13 6414              XRL      A,#014H
B3:008C15 6002              JZ       $ + 4H
B3:008C17 81CC              AJMP     ?C0004?S2_INCLUSION
B3:008C19         ?C0006?S2_INCLUSION:
B3:008C19 90464B            MOV      DPTR,#i
B3:008C1C E0                MOVX     A,@DPTR
B3:008C1D 902E00            MOV      DPTR,#s2_transition_table+01H
B3:008C20 12EED5            LCALL    ?L?COM0418
B3:008C23 FC                MOV      R4,A
B3:008C24 A3                INC      DPTR
B3:008C25 E0                MOVX     A,@DPTR
B3:008C26 FD                MOV      R5,A
B3:008C27 90464C            MOV      DPTR,#event
B3:008C2A E0                MOVX     A,@DPTR
B3:008C2B 6C                XRL      A,R4
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 710


B3:008C2C 7003              JNZ      ?C0132?S2_INCLUSION
B3:008C2E A3                INC      DPTR
B3:008C2F E0                MOVX     A,@DPTR
B3:008C30 6D                XRL      A,R5
B3:008C31         ?C0132?S2_INCLUSION:
B3:008C31 600C              JZ       ?C0008?S2_INCLUSION
B3:008C33 ED                MOV      A,R5
B3:008C34 6410              XRL      A,#010H
B3:008C36 7003              JNZ      ?C0133?S2_INCLUSION
B3:008C38 EC                MOV      A,R4
B3:008C39 6402              XRL      A,#02H
B3:008C3B         ?C0133?S2_INCLUSION:
B3:008C3B 6002              JZ       $ + 4H
B3:008C3D 81CC              AJMP     ?C0004?S2_INCLUSION
B3:008C3F         ?C0008?S2_INCLUSION:
B3:008C3F 90464B            MOV      DPTR,#i
B3:008C42 E0                MOVX     A,@DPTR
B3:008C43 75F005            MOV      B,#05H
B3:008C46 902E03            MOV      DPTR,#s2_transition_table+04H
B3:008C49 122546            LCALL    ?C?OFFXADD
B3:008C4C E0                MOVX     A,@DPTR
B3:008C4D FF                MOV      R7,A
B3:008C4E 6414              XRL      A,#014H
B3:008C50 6009              JZ       ?C0009?S2_INCLUSION
B3:008C52 EE                MOV      A,R6
B3:008C53 6F                XRL      A,R7
B3:008C54 6005              JZ       ?C0009?S2_INCLUSION
B3:008C56 902A13            MOV      DPTR,#the_context+020FH
B3:008C59 EF                MOV      A,R7
B3:008C5A F0                MOVX     @DPTR,A
B3:008C5B         ?C0009?S2_INCLUSION:
B3:008C5B 90464B            MOV      DPTR,#i
B3:008C5E E0                MOVX     A,@DPTR
B3:008C5F 902E02            MOV      DPTR,#s2_transition_table+03H
B3:008C62 12EED5            LCALL    ?L?COM0418
B3:008C65 12267F            LCALL    ?C?CCASE
B3:008C68 8C9C              DW       ?C0012?S2_INCLUSION
B3:008C6A 01                DB       01H
B3:008C6B 8CC6              DW       ?C0024?S2_INCLUSION
B3:008C6D 03                DB       03H
B3:008C6E 8CC9              DW       ?C0025?S2_INCLUSION
B3:008C70 04                DB       04H
B3:008C71 8CA1              DW       ?C0013?S2_INCLUSION
B3:008C73 05                DB       05H
B3:008C74 8CA4              DW       ?C0014?S2_INCLUSION
B3:008C76 06                DB       06H
B3:008C77 8CAE              DW       ?C0015?S2_INCLUSION
B3:008C79 07                DB       07H
B3:008C7A 8CB1              DW       ?C0016?S2_INCLUSION
B3:008C7C 08                DB       08H
B3:008C7D 8CB4              DW       ?C0017?S2_INCLUSION
B3:008C7F 09                DB       09H
B3:008C80 8CB7              DW       ?C0018?S2_INCLUSION
B3:008C82 0A                DB       0AH
B3:008C83 8CB9              DW       ?C0019?S2_INCLUSION
B3:008C85 0B                DB       0BH
B3:008C86 8CBB              DW       ?C0020?S2_INCLUSION
B3:008C88 0C                DB       0CH
B3:008C89 8CBE              DW       ?C0021?S2_INCLUSION
B3:008C8B 0D                DB       0DH
B3:008C8C 8CC0              DW       ?C0022?S2_INCLUSION
B3:008C8E 0E                DB       0EH
B3:008C8F 8CC3              DW       ?C0023?S2_INCLUSION
B3:008C91 0F                DB       0FH
B3:008C92 8C99              DW       ?C0011?S2_INCLUSION
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 711


B3:008C94 10                DB       010H
B3:008C95 0000              DW       00H
B3:008C97 8CD4              DW       ?C0028?S2_INCLUSION
B3:008C99         ?C0011?S2_INCLUSION:
B3:008C99 02B999            LJMP     remote_inclusion_failed_evt_push
B3:008C9C         ?C0012?S2_INCLUSION:
B3:008C9C E4                CLR      A
B3:008C9D FF                MOV      R7,A
B3:008C9E 02B99C            LJMP     _inclusion_failed_evt_push
B3:008CA1         ?C0013?S2_INCLUSION:
B3:008CA1 02EA5D            LJMP     s2_joining_start
B3:008CA4         ?C0014?S2_INCLUSION:
B3:008CA4 7FB8              MOV      R7,#0B8H
B3:008CA6 7E0B              MOV      R6,#0BH
B3:008CA8 7D00              MOV      R5,#00H
B3:008CAA 7C00              MOV      R4,#00H
B3:008CAC 41FC              AJMP     _s2_inclusion_set_timeout
B3:008CAE         ?C0015?S2_INCLUSION:
B3:008CAE 02BC57            LJMP     s2_send_kex_report
B3:008CB1         ?C0016?S2_INCLUSION:
B3:008CB1 02B8BC            LJMP     s2_send_pub_key_b
B3:008CB4         ?C0017?S2_INCLUSION:
B3:008CB4 02BDC3            LJMP     s2_pub_key_a_recv
B3:008CB7         ?C0018?S2_INCLUSION:
B3:008CB7 416A              AJMP     s2_do_ecdh_calc_b
B3:008CB9         ?C0019?S2_INCLUSION:
B3:008CB9 41BE              AJMP     s2_send_echo_kex_set
B3:008CBB         ?C0020?S2_INCLUSION:
B3:008CBB 02B9DC            LJMP     s2_send_net_key_get
B3:008CBE         ?C0021?S2_INCLUSION:
B3:008CBE 61A0              AJMP     s2_send_net_key_verify
B3:008CC0         ?C0022?S2_INCLUSION:
B3:008CC0 02BAB3            LJMP     s2_send_final_transfer_end
B3:008CC3         ?C0023?S2_INCLUSION:
B3:008CC3 02BE7C            LJMP     s2_joining_complete
B3:008CC6         ?C0024?S2_INCLUSION:
B3:008CC6 02BAED            LJMP     s2_inclusion_send_frame
B3:008CC9         ?C0025?S2_INCLUSION:
B3:008CC9 02BA2A            LJMP     s2_inclusion_send_data
B3:008CCC         ?C0004?S2_INCLUSION:
B3:008CCC 90464B            MOV      DPTR,#i
B3:008CCF E0                MOVX     A,@DPTR
B3:008CD0 04                INC      A
B3:008CD1 F0                MOVX     @DPTR,A
B3:008CD2 61F2              AJMP     ?C0002?S2_INCLUSION
B3:008CD4         ?C0028?S2_INCLUSION:
B3:008CD4 22                RET      
----- FUNCTION _process_event (END) -------


----- FUNCTION ___S2_fsm_post_event (BEGIN) -----
B3:008CD5 904592            MOV      DPTR,#e
B3:008CD8 126E8B            LCALL    ?L?COM02DB
B3:008CDB 902A11            MOV      DPTR,#the_context+020DH
B3:008CDE E0                MOVX     A,@DPTR
B3:008CDF 14                DEC      A
B3:008CE0 7002              JNZ      $ + 4H
B3:008CE2 C16F              AJMP     ?C0222?S2
B3:008CE4 14                DEC      A
B3:008CE5 7002              JNZ      $ + 4H
B3:008CE7 C1D7              AJMP     ?C0232?S2
B3:008CE9 24FE              ADD      A,#0FEH
B3:008CEB 7002              JNZ      $ + 4H
B3:008CED C1E7              AJMP     ?C0235?S2
B3:008CEF 14                DEC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 712


B3:008CF0 6006              JZ       ?C0203?S2
B3:008CF2 2405              ADD      A,#05H
B3:008CF4 6002              JZ       $ + 4H
B3:008CF6 E1D6              AJMP     ?C0250?S2
B3:008CF8         ?C0203?S2:
B3:008CF8 904592            MOV      DPTR,#e
B3:008CFB E0                MOVX     A,@DPTR
B3:008CFC 7026              JNZ      ?C0204?S2
B3:008CFE A3                INC      DPTR
B3:008CFF 319B              ACALL    ?L?COM006B
B3:008D01 12E69C            LCALL    ___S2_span_ok
B3:008D04 EF                MOV      A,R7
B3:008D05 4E                ORL      A,R6
B3:008D06 601C              JZ       ?C0204?S2
B3:008D08 3198              ACALL    ?L?COM006A
B3:008D0A C003              PUSH     AR3
B3:008D0C C002              PUSH     AR2
B3:008D0E C001              PUSH     AR1
B3:008D10 12ABCC            LCALL    ?L?COM0066
B3:008D13 D001              POP      AR1
B3:008D15 D002              POP      AR2
B3:008D17 D003              POP      AR3
B3:008D19 12BDA5            LCALL    ___S2_set_peer
B3:008D1C 902A12            MOV      DPTR,#the_context+020EH
B3:008D1F 7402              MOV      A,#02H
B3:008D21 F0                MOVX     @DPTR,A
B3:008D22 E1B4              AJMP     send_msg_state_enter?S2
B3:008D24         ?C0204?S2:
B3:008D24 904592            MOV      DPTR,#e
B3:008D27 E0                MOVX     A,@DPTR
B3:008D28 7024              JNZ      ?C0207?S2
B3:008D2A 902A11            MOV      DPTR,#the_context+020DH
B3:008D2D 04                INC      A
B3:008D2E F0                MOVX     @DPTR,A
B3:008D2F A3                INC      DPTR
B3:008D30 04                INC      A
B3:008D31 F0                MOVX     @DPTR,A
B3:008D32 3198              ACALL    ?L?COM006A
B3:008D34 C003              PUSH     AR3
B3:008D36 C002              PUSH     AR2
B3:008D38 C001              PUSH     AR1
B3:008D3A 12ABCC            LCALL    ?L?COM0066
B3:008D3D D001              POP      AR1
B3:008D3F D002              POP      AR2
B3:008D41 D003              POP      AR3
B3:008D43 12BDA5            LCALL    ___S2_set_peer
B3:008D46 12E6E1            LCALL    __S2_send_nonce_get
B3:008D49 12EF26            LCALL    ?L?COM04FF
B3:008D4C C1FE              AJMP     ?C0281?S2
B3:008D4E         ?C0207?S2:
B3:008D4E 904592            MOV      DPTR,#e
B3:008D51 E0                MOVX     A,@DPTR
B3:008D52 6403              XRL      A,#03H
B3:008D54 7030              JNZ      ?C0209?S2
B3:008D56 A3                INC      DPTR
B3:008D57 12ED46            LCALL    ?L?COM01E0
B3:008D5A C3                CLR      C
B3:008D5B 9403              SUBB     A,#03H
B3:008D5D E5F0              MOV      A,B
B3:008D5F 9400              SUBB     A,#00H
B3:008D61 4023              JC       ?C0209?S2
B3:008D63 122587            LCALL    ?C?PLDPTR
B3:008D66 C003              PUSH     AR3
B3:008D68 C002              PUSH     AR2
B3:008D6A C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 713


B3:008D6C 12ED15            LCALL    ?L?COM01BE
B3:008D6F 12B993            LCALL    ?L?COM00B6
B3:008D72 FD                MOV      R5,A
B3:008D73 D001              POP      AR1
B3:008D75 D002              POP      AR2
B3:008D77 D003              POP      AR3
B3:008D79 12AC7A            LCALL    ___S2_verify_seq
B3:008D7C EF                MOV      A,R7
B3:008D7D 4E                ORL      A,R6
B3:008D7E 6006              JZ       ?C0209?S2
B3:008D80 3198              ACALL    ?L?COM006A
B3:008D82 7D01              MOV      R5,#01H
B3:008D84 C16C              AJMP     ?C0280?S2
B3:008D86         ?C0209?S2:
B3:008D86 12EF0D            LCALL    ?L?COM04A0
B3:008D89 702D              JNZ      ?C0211?S2
B3:008D8B A3                INC      DPTR
B3:008D8C 319B              ACALL    ?L?COM006B
B3:008D8E C003              PUSH     AR3
B3:008D90 C002              PUSH     AR2
B3:008D92 C001              PUSH     AR1
B3:008D94 12ABCC            LCALL    ?L?COM0066
B3:008D97 D001              POP      AR1
B3:008D99 D002              POP      AR2
B3:008D9B D003              POP      AR3
B3:008D9D 12BDA5            LCALL    ___S2_set_peer
B3:008DA0 12ED15            LCALL    ?L?COM01BE
B3:008DA3 C003              PUSH     AR3
B3:008DA5 C002              PUSH     AR2
B3:008DA7 C001              PUSH     AR1
B3:008DA9 12ED43            LCALL    ?L?COM01DF
B3:008DAC FD                MOV      R5,A
B3:008DAD ACF0              MOV      R4,B
B3:008DAF D001              POP      AR1
B3:008DB1 D002              POP      AR2
B3:008DB3 D003              POP      AR3
B3:008DB5 02D759            LJMP     ___S2_register_nonce
B3:008DB8         ?C0211?S2:
B3:008DB8 904592            MOV      DPTR,#e
B3:008DBB E0                MOVX     A,@DPTR
B3:008DBC 6401              XRL      A,#01H
B3:008DBE 7035              JNZ      ?C0213?S2
B3:008DC0 A3                INC      DPTR
B3:008DC1 319B              ACALL    ?L?COM006B
B3:008DC3 C003              PUSH     AR3
B3:008DC5 C002              PUSH     AR2
B3:008DC7 C001              PUSH     AR1
B3:008DC9 12ABCC            LCALL    ?L?COM0066
B3:008DCC D001              POP      AR1
B3:008DCE D002              POP      AR2
B3:008DD0 D003              POP      AR3
B3:008DD2 12BDA5            LCALL    ___S2_set_peer
B3:008DD5 3198              ACALL    ?L?COM006A
B3:008DD7 129CA5            LCALL    ?L?COM0065
B3:008DDA FD                MOV      R5,A
B3:008DDB 7B01              MOV      R3,#01H
B3:008DDD E4                CLR      A
B3:008DDE FF                MOV      R7,A
B3:008DDF 12D9ED            LCALL    ___find_mpan_by_group_id
B3:008DE2 AF01              MOV      R7,AR1
B3:008DE4 9028E2            MOV      DPTR,#the_context+0DEH
B3:008DE7 EA                MOV      A,R2
B3:008DE8 F0                MOVX     @DPTR,A
B3:008DE9 A3                INC      DPTR
B3:008DEA EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 714


B3:008DEB F0                MOVX     @DPTR,A
B3:008DEC 902A11            MOV      DPTR,#the_context+020DH
B3:008DEF 7402              MOV      A,#02H
B3:008DF1 F0                MOVX     @DPTR,A
B3:008DF2 02D423            LJMP     __S2_encrypt_and_send_multi
B3:008DF5         ?C0213?S2:
B3:008DF5 904592            MOV      DPTR,#e
B3:008DF8 E0                MOVX     A,@DPTR
B3:008DF9 B40210            CJNE     A,#02H,?C0215?S2
B3:008DFC A3                INC      DPTR
B3:008DFD 12A624            LCALL    ?L?COM005D
B3:008E00 7D00              MOV      R5,#00H
B3:008E02 7002              JNZ      ?C0216?S2
B3:008E04 7D01              MOV      R5,#01H
B3:008E06         ?C0216?S2:
B3:008E06         ?C0217?S2:
B3:008E06 12C445            LCALL    ?L?COM02DF
B3:008E09 02EA03            LJMP     _s2_inclusion_send_done
B3:008E0C         ?C0215?S2:
B3:008E0C 904592            MOV      DPTR,#e
B3:008E0F E0                MOVX     A,@DPTR
B3:008E10 B40733            CJNE     A,#07H,?C0219?S2
B3:008E13 7F0A              MOV      R7,#0AH
B3:008E15 7E00              MOV      R6,#00H
B3:008E17 7D00              MOV      R5,#00H
B3:008E19 7C00              MOV      R4,#00H
B3:008E1B 12979F            LCALL    ___S2_set_timeout
B3:008E1E 3198              ACALL    ?L?COM006A
B3:008E20 C003              PUSH     AR3
B3:008E22 C002              PUSH     AR2
B3:008E24 C001              PUSH     AR1
B3:008E26 12B327            LCALL    ?L?COM004B
B3:008E29 9043C5            MOV      DPTR,#?___S2_set_peer?BYTE+03H
B3:008E2C 122572            LCALL    ?C?PSTXDATA
B3:008E2F E4                CLR      A
B3:008E30 9043C8            MOV      DPTR,#?___S2_set_peer?BYTE+06H
B3:008E33 F0                MOVX     @DPTR,A
B3:008E34 A3                INC      DPTR
B3:008E35 F0                MOVX     @DPTR,A
B3:008E36 D001              POP      AR1
B3:008E38 D002              POP      AR2
B3:008E3A D003              POP      AR3
B3:008E3C 12BDA5            LCALL    ___S2_set_peer
B3:008E3F 902A11            MOV      DPTR,#the_context+020DH
B3:008E42 7405              MOV      A,#05H
B3:008E44 F0                MOVX     @DPTR,A
B3:008E45 22                RET      
B3:008E46         ?C0219?S2:
B3:008E46 904592            MOV      DPTR,#e
B3:008E49 E0                MOVX     A,@DPTR
B3:008E4A 6408              XRL      A,#08H
B3:008E4C 6002              JZ       $ + 4H
B3:008E4E E1D6              AJMP     ?C0250?S2
B3:008E50 902A11            MOV      DPTR,#the_context+020DH
B3:008E53 E0                MOVX     A,@DPTR
B3:008E54 6405              XRL      A,#05H
B3:008E56 6002              JZ       $ + 4H
B3:008E58 E1D6              AJMP     ?C0250?S2
B3:008E5A 9028E2            MOV      DPTR,#the_context+0DEH
B3:008E5D F0                MOVX     @DPTR,A
B3:008E5E A3                INC      DPTR
B3:008E5F F0                MOVX     @DPTR,A
B3:008E60 902A11            MOV      DPTR,#the_context+020DH
B3:008E63 F0                MOVX     @DPTR,A
B3:008E64 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 715


B3:008E66 7A28              MOV      R2,#HIGH the_context+0CFH
B3:008E68 79D3              MOV      R1,#LOW the_context+0CFH
B3:008E6A 7D02              MOV      R5,#02H
B3:008E6C         
B3:008E6C 02D668            LJMP     ___S2_send_nonce_report
B3:008E6F         ?C0222?S2:
B3:008E6F 904592            MOV      DPTR,#e
B3:008E72 E0                MOVX     A,@DPTR
B3:008E73 B40211            CJNE     A,#02H,?C0223?S2
B3:008E76 A3                INC      DPTR
B3:008E77 12A624            LCALL    ?L?COM005D
B3:008E7A 700B              JNZ      ?C0223?S2
B3:008E7C 900004            MOV      DPTR,#04H
B3:008E7F 122163            LCALL    ?C?ILDOPTR
B3:008E82 123C0A            LCALL    ?L?COM02BC
B3:008E85         
B3:008E85 8077              SJMP     ?C0281?S2
B3:008E87         ?C0223?S2:
B3:008E87 904592            MOV      DPTR,#e
B3:008E8A E0                MOVX     A,@DPTR
B3:008E8B FF                MOV      R7,A
B3:008E8C 6402              XRL      A,#02H
B3:008E8E 6004              JZ       ?C0226?S2
B3:008E90 EF                MOV      A,R7
B3:008E91 B40810            CJNE     A,#08H,?C0225?S2
B3:008E94         ?C0226?S2:
B3:008E94 E4                CLR      A
B3:008E95 902A11            MOV      DPTR,#the_context+020DH
B3:008E98 F0                MOVX     @DPTR,A
B3:008E99 904592            MOV      DPTR,#e
B3:008E9C E0                MOVX     A,@DPTR
B3:008E9D B40802            CJNE     A,#08H,?C0227?S2
B3:008EA0 E160              AJMP     ?C0282?S2
B3:008EA2         ?C0227?S2:
B3:008EA2 8062              SJMP     ?C0285?S2
B3:008EA4         ?C0225?S2:
B3:008EA4 12EF0D            LCALL    ?L?COM04A0
B3:008EA7 6002              JZ       $ + 4H
B3:008EA9 E1D6              AJMP     ?C0250?S2
B3:008EAB A3                INC      DPTR
B3:008EAC 319B              ACALL    ?L?COM006B
B3:008EAE 12E9A4            LCALL    ___S2_is_peernode
B3:008EB1 EF                MOV      A,R7
B3:008EB2 4E                ORL      A,R6
B3:008EB3 7002              JNZ      $ + 4H
B3:008EB5 E1D6              AJMP     ?C0250?S2
B3:008EB7 12ED15            LCALL    ?L?COM01BE
B3:008EBA C003              PUSH     AR3
B3:008EBC C002              PUSH     AR2
B3:008EBE C001              PUSH     AR1
B3:008EC0 12ED43            LCALL    ?L?COM01DF
B3:008EC3 FD                MOV      R5,A
B3:008EC4 ACF0              MOV      R4,B
B3:008EC6 D001              POP      AR1
B3:008EC8 D002              POP      AR2
B3:008ECA D003              POP      AR3
B3:008ECC 12D759            LCALL    ___S2_register_nonce
B3:008ECF EF                MOV      A,R7
B3:008ED0 20E002            JB       ACC.0,$ + 5H
B3:008ED3 E1D6              AJMP     ?C0250?S2
B3:008ED5 E1B4              AJMP     send_msg_state_enter?S2
B3:008ED7         ?C0232?S2:
B3:008ED7 904592            MOV      DPTR,#e
B3:008EDA E0                MOVX     A,@DPTR
B3:008EDB 6402              XRL      A,#02H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 716


B3:008EDD 6002              JZ       $ + 4H
B3:008EDF E1D6              AJMP     ?C0250?S2
B3:008EE1 902A11            MOV      DPTR,#the_context+020DH
B3:008EE4 F0                MOVX     @DPTR,A
B3:008EE5         
B3:008EE5 801F              SJMP     ?C0285?S2
B3:008EE7         ?C0235?S2:
B3:008EE7 904592            MOV      DPTR,#e
B3:008EEA E0                MOVX     A,@DPTR
B3:008EEB 6402              XRL      A,#02H
B3:008EED 701F              JNZ      ?C0236?S2
B3:008EEF A3                INC      DPTR
B3:008EF0 12A624            LCALL    ?L?COM005D
B3:008EF3 700C              JNZ      ?C0237?S2
B3:008EF5 900004            MOV      DPTR,#04H
B3:008EF8 122163            LCALL    ?C?ILDOPTR
B3:008EFB 123C0A            LCALL    ?L?COM02BC
B3:008EFE         
B3:008EFE 02979F            LJMP     ___S2_set_timeout
B3:008F01         ?C0237?S2:
B3:008F01 E4                CLR      A
B3:008F02 902A11            MOV      DPTR,#the_context+020DH
B3:008F05 F0                MOVX     @DPTR,A
B3:008F06         
B3:008F06 904593            MOV      DPTR,#d
B3:008F09 12A624            LCALL    ?L?COM005D
B3:008F0C 8062              SJMP     ?C0286?S2
B3:008F0E         ?C0236?S2:
B3:008F0E 904592            MOV      DPTR,#e
B3:008F11 E0                MOVX     A,@DPTR
B3:008F12 6405              XRL      A,#05H
B3:008F14 7034              JNZ      ?C0240?S2
B3:008F16 A3                INC      DPTR
B3:008F17 319B              ACALL    ?L?COM006B
B3:008F19 12E9A4            LCALL    ___S2_is_peernode
B3:008F1C EF                MOV      A,R7
B3:008F1D 4E                ORL      A,R6
B3:008F1E 602A              JZ       ?C0240?S2
B3:008F20 3198              ACALL    ?L?COM006A
B3:008F22 129CA5            LCALL    ?L?COM0065
B3:008F25 FF                MOV      R7,A
B3:008F26 12E6FC            LCALL    ___S2_is_node_mos
B3:008F29 EF                MOV      A,R7
B3:008F2A 6015              JZ       ?C0241?S2
B3:008F2C 902A12            MOV      DPTR,#the_context+020EH
B3:008F2F E0                MOVX     A,@DPTR
B3:008F30 D3                SETB     C
B3:008F31 9400              SUBB     A,#00H
B3:008F33 400C              JC       ?C0241?S2
B3:008F35 12EF5C            LCALL    ?L?COM0559
B3:008F38 9028D5            MOV      DPTR,#the_context+0D1H
B3:008F3B E0                MOVX     A,@DPTR
B3:008F3C 54FE              ANL      A,#0FEH
B3:008F3E F0                MOVX     @DPTR,A
B3:008F3F 8073              SJMP     send_msg_state_enter?S2
B3:008F41         ?C0241?S2:
B3:008F41 E4                CLR      A
B3:008F42 902A11            MOV      DPTR,#the_context+020DH
B3:008F45 F0                MOVX     @DPTR,A
B3:008F46 7F05              MOV      R7,#05H
B3:008F48 8067              SJMP     ?C0289?S2
B3:008F4A         ?C0240?S2:
B3:008F4A 904592            MOV      DPTR,#e
B3:008F4D E0                MOVX     A,@DPTR
B3:008F4E B40613            CJNE     A,#06H,?C0244?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 717


B3:008F51 A3                INC      DPTR
B3:008F52 319B              ACALL    ?L?COM006B
B3:008F54 12E9A4            LCALL    ___S2_is_peernode
B3:008F57 EF                MOV      A,R7
B3:008F58 4E                ORL      A,R6
B3:008F59 6009              JZ       ?C0244?S2
B3:008F5B E4                CLR      A
B3:008F5C 902A11            MOV      DPTR,#the_context+020DH
B3:008F5F F0                MOVX     @DPTR,A
B3:008F60         
B3:008F60 7F02              MOV      R7,#02H
B3:008F62         
B3:008F62 804D              SJMP     ?C0289?S2
B3:008F64         ?C0244?S2:
B3:008F64 904592            MOV      DPTR,#e
B3:008F67 E0                MOVX     A,@DPTR
B3:008F68 B40808            CJNE     A,#08H,?C0246?S2
B3:008F6B E4                CLR      A
B3:008F6C 902A11            MOV      DPTR,#the_context+020DH
B3:008F6F F0                MOVX     @DPTR,A
B3:008F70         
B3:008F70 FF                MOV      R7,A
B3:008F71         
B3:008F71 803E              SJMP     ?C0289?S2
B3:008F73         ?C0246?S2:
B3:008F73 12EF0D            LCALL    ?L?COM04A0
B3:008F76 705E              JNZ      ?C0250?S2
B3:008F78 A3                INC      DPTR
B3:008F79 319B              ACALL    ?L?COM006B
B3:008F7B 12E9A4            LCALL    ___S2_is_peernode
B3:008F7E EF                MOV      A,R7
B3:008F7F 4E                ORL      A,R6
B3:008F80 6054              JZ       ?C0250?S2
B3:008F82 12ED15            LCALL    ?L?COM01BE
B3:008F85 C003              PUSH     AR3
B3:008F87 C002              PUSH     AR2
B3:008F89 C001              PUSH     AR1
B3:008F8B 12ED43            LCALL    ?L?COM01DF
B3:008F8E FD                MOV      R5,A
B3:008F8F ACF0              MOV      R4,B
B3:008F91 D001              POP      AR1
B3:008F93 D002              POP      AR2
B3:008F95 D003              POP      AR3
B3:008F97 12D759            LCALL    ___S2_register_nonce
;---- Variable 'nr_flag' assigned to Register 'R7' ----
B3:008F9A EF                MOV      A,R7
B3:008F9B 7001              JNZ      ?C0249?S2
B3:008F9D 22                RET      
B3:008F9E         ?C0249?S2:
B3:008F9E EF                MOV      A,R7
B3:008F9F B40203            CJNE     A,#02H,?C0251?S2
B3:008FA2 12EF5C            LCALL    ?L?COM0559
B3:008FA5         ?C0251?S2:
B3:008FA5 902A12            MOV      DPTR,#the_context+020EH
B3:008FA8 E0                MOVX     A,@DPTR
B3:008FA9 7009              JNZ      send_msg_state_enter?S2
B3:008FAB 902A11            MOV      DPTR,#the_context+020DH
B3:008FAE F0                MOVX     @DPTR,A
B3:008FAF 7F02              MOV      R7,#02H
B3:008FB1         
B3:008FB1 02C351            LJMP     ___S2_post_send_done_event
B3:008FB4         send_msg_state_enter:
B3:008FB4 902A11            MOV      DPTR,#the_context+020DH
B3:008FB7 7402              MOV      A,#02H
B3:008FB9 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 718


B3:008FBA 9028D5            MOV      DPTR,#the_context+0D1H
B3:008FBD E0                MOVX     A,@DPTR
B3:008FBE 30E00C            JNB      ACC.0,?C0257?S2
B3:008FC1 902A11            MOV      DPTR,#the_context+020DH
B3:008FC4 7404              MOV      A,#04H
B3:008FC6 F0                MOVX     @DPTR,A
B3:008FC7 12EF26            LCALL    ?L?COM04FF
B3:008FCA 12979F            LCALL    ___S2_set_timeout
B3:008FCD         ?C0257?S2:
B3:008FCD 12ACD0            LCALL    __S2_encrypt_and_send
B3:008FD0 902A12            MOV      DPTR,#the_context+020EH
B3:008FD3 E0                MOVX     A,@DPTR
B3:008FD4 14                DEC      A
B3:008FD5 F0                MOVX     @DPTR,A
B3:008FD6         ?C0250?S2:
B3:008FD6 22                RET      
----- FUNCTION ___S2_fsm_post_event (END) -------


----- FUNCTION _ExploreQueueFrame (BEGIN) -----
B3:008FD7 900A4A            MOV      DPTR,#bSrcNodeID
B3:008FDA 126563            LCALL    ?L?COM00E9
B3:008FDD 122572            LCALL    ?C?PSTXDATA
B3:008FE0 900A4F            MOV      DPTR,#bDataLength
B3:008FE3 E0                MOVX     A,@DPTR
B3:008FE4 D3                SETB     C
B3:008FE5 942F              SUBB     A,#02FH
B3:008FE7 4003              JC       $ + 5H
B3:008FE9 0290B5            LJMP     ?C0001?ZW_EXPLORE
B3:008FEC 12C906            LCALL    ExploreQueueIndex
B3:008FEF 8F52              MOV      bExploreQueueIndex,R7
B3:008FF1 EF                MOV      A,R7
B3:008FF2 C3                CLR      C
B3:008FF3 9402              SUBB     A,#02H
B3:008FF5 4003              JC       $ + 5H
B3:008FF7 0290B5            LJMP     ?C0001?ZW_EXPLORE
B3:008FFA EF                MOV      A,R7
B3:008FFB 12EDE4            LCALL    ?L?COM01B6
B3:008FFE 7401              MOV      A,#01H
B3:009000 126FF1            LCALL    ?L?COM0475
B3:009003 12CD1E            LCALL    ?L?COM0054
B3:009006 E4                CLR      A
B3:009007 12203B            LCALL    ?C?CSTPTR
B3:00900A 900A4A            MOV      DPTR,#bSrcNodeID
B3:00900D E0                MOVX     A,@DPTR
B3:00900E 126DF0            LCALL    ?L?COM0071
B3:009011 2424              ADD      A,#024H
B3:009013 1289AC            LCALL    ?L?COM0144
B3:009016 126DF0            LCALL    ?L?COM0071
B3:009019 128593            LCALL    ?L?COM00AC
B3:00901C EF                MOV      A,R7
B3:00901D 12203B            LCALL    ?C?CSTPTR
B3:009020 900A4B            MOV      DPTR,#bDstNodeID
B3:009023 E0                MOVX     A,@DPTR
B3:009024 126DF0            LCALL    ?L?COM0071
B3:009027 2428              ADD      A,#028H
B3:009029 1289AC            LCALL    ?L?COM0144
B3:00902C FF                MOV      R7,A
B3:00902D 900854            MOV      DPTR,#pExploreQueueElement
B3:009030 1289B7            LCALL    ?L?COM004D
B3:009033 EF                MOV      A,R7
B3:009034 12203B            LCALL    ?C?CSTPTR
B3:009037 900A50            MOV      DPTR,#bExploreFlag
B3:00903A E0                MOVX     A,@DPTR
B3:00903B 12707C            LCALL    ?L?COM0571
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 719


B3:00903E 126DF1            LCALL    ?L?COM0072
B3:009041 2405              ADD      A,#05H
B3:009043 127020            LCALL    ?L?COM04E0
B3:009046 EF                MOV      A,R7
B3:009047 540F              ANL      A,#0FH
B3:009049 126DF0            LCALL    ?L?COM0071
B3:00904C 125D39            LCALL    ?L?COM00E6
B3:00904F EF                MOV      A,R7
B3:009050 12EF7B            LCALL    ?L?COM0570
B3:009053 FF                MOV      R7,A
B3:009054 6029              JZ       ?C0002?ZW_EXPLORE
B3:009056 900A4C            MOV      DPTR,#pData
B3:009059 12A1F7            LCALL    ?L?COM01C7
B3:00905C 6021              JZ       ?C0002?ZW_EXPLORE
B3:00905E 126DF1            LCALL    ?L?COM0072
B3:009061 2431              ADD      A,#031H
B3:009063 F9                MOV      R1,A
B3:009064 E4                CLR      A
B3:009065 3A                ADDC     A,R2
B3:009066 FA                MOV      R2,A
B3:009067 C003              PUSH     AR3
B3:009069 C002              PUSH     AR2
B3:00906B C001              PUSH     AR1
B3:00906D 900A4C            MOV      DPTR,#pData
B3:009070 122552            LCALL    ?C?PLDXDATA
B3:009073 128549            LCALL    ?L?COM0019
B3:009076 D001              POP      AR1
B3:009078 D002              POP      AR2
B3:00907A D003              POP      AR3
B3:00907C 128195            LCALL    ___ZW_memcpy
B3:00907F         ?C0002?ZW_EXPLORE:
B3:00907F 126DF1            LCALL    ?L?COM0072
B3:009082 242B              ADD      A,#02BH
B3:009084 F9                MOV      R1,A
B3:009085 E4                CLR      A
B3:009086 3A                ADDC     A,R2
B3:009087 FA                MOV      R2,A
B3:009088 74FA              MOV      A,#0FAH
B3:00908A 12EF7B            LCALL    ?L?COM0570
B3:00908D 2411              ADD      A,#011H
B3:00908F 126DF0            LCALL    ?L?COM0071
B3:009092 1289AA            LCALL    ?L?COM0143
B3:009095 900A51            MOV      DPTR,#completedFunc
B3:009098 E0                MOVX     A,@DPTR
B3:009099 FE                MOV      R6,A
B3:00909A A3                INC      DPTR
B3:00909B E0                MOVX     A,@DPTR
B3:00909C 126DF0            LCALL    ?L?COM0071
B3:00909F 241E              ADD      A,#01EH
B3:0090A1 12C706            LCALL    ?L?COM029B
B3:0090A4 12593A            LCALL    getTickTime
B3:0090A7 126DF1            LCALL    ?L?COM0072
B3:0090AA 126E30            LCALL    ?L?COM01DE
B3:0090AD 12C70A            LCALL    ?L?COM029C
B3:0090B0 E552              MOV      A,bExploreQueueIndex
B3:0090B2 04                INC      A
B3:0090B3 FF                MOV      R7,A
B3:0090B4 22                RET      
B3:0090B5         ?C0001?ZW_EXPLORE:
B3:0090B5 7F00              MOV      R7,#00H
B3:0090B7 22                RET      
----- FUNCTION _ExploreQueueFrame (END) -------


----- FUNCTION sec0_unpersist_netkey (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 720


B3:0090B8 90411D            MOV      DPTR,#retVal
B3:0090BB 7401              MOV      A,#01H
B3:0090BD F0                MOVX     @DPTR,A
B3:0090BE FB                MOV      R3,A
B3:0090BF 7A2C              MOV      R2,#HIGH aes_key
B3:0090C1 7974              MOV      R1,#LOW aes_key
B3:0090C3 7F80              MOV      R7,#080H
B3:0090C5 121B01            LCALL    ?INTERBANK_TABLE?_keystore_network_key_read
B3:0090C8 EF                MOV      A,R7
B3:0090C9 700D              JNZ      ?C0042?ZW_SECURITY_SCHEME0
B3:0090CB 7A2C              MOV      R2,#HIGH aes_key
B3:0090CD 7974              MOV      R1,#LOW aes_key
B3:0090CF FF                MOV      R7,A
B3:0090D0 128516            LCALL    ?L?COM0269
B3:0090D3 E4                CLR      A
B3:0090D4 90411D            MOV      DPTR,#retVal
B3:0090D7 F0                MOVX     @DPTR,A
B3:0090D8         ?C0042?ZW_SECURITY_SCHEME0:
B3:0090D8 7A41              MOV      R2,#HIGH p
B3:0090DA 790D              MOV      R1,#LOW p
B3:0090DC 7F55              MOV      R7,#055H
B3:0090DE 128516            LCALL    ?L?COM0269
B3:0090E1 7B01              MOV      R3,#01H
B3:0090E3 7A2B              MOV      R2,#HIGH authkey
B3:0090E5 7990              MOV      R1,#LOW authkey
B3:0090E7 12CC7C            LCALL    ?L?COM0279
B3:0090EA 12CB93            LCALL    ?L?COM0539
B3:0090ED 7B01              MOV      R3,#01H
B3:0090EF 7A41              MOV      R2,#HIGH p
B3:0090F1 790D              MOV      R1,#LOW p
B3:0090F3 7D10              MOV      R5,#010H
B3:0090F5 7FAA              MOV      R7,#0AAH
B3:0090F7 12851A            LCALL    ___ZW_memset
B3:0090FA 7B01              MOV      R3,#01H
B3:0090FC 7A2C              MOV      R2,#HIGH enckey
B3:0090FE 7954              MOV      R1,#LOW enckey
B3:009100 12CC7C            LCALL    ?L?COM0279
B3:009103 12CB93            LCALL    ?L?COM0539
B3:009106 90411D            MOV      DPTR,#retVal
B3:009109 E0                MOVX     A,@DPTR
B3:00910A FF                MOV      R7,A
B3:00910B 22                RET      
----- FUNCTION sec0_unpersist_netkey (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_EarlyStart (BEGIN) -----
B3:00910C 904633            MOV      DPTR,#handle
B3:00910F 122572            LCALL    ?C?PSTXDATA
B3:009112 904633            MOV      DPTR,#handle
B3:009115 12C487            LCALL    ?L?COM00D8
B3:009118 6054              JZ       ?C0145?SECURE_LEARN
B3:00911A 904633            MOV      DPTR,#handle
B3:00911D 712C              ACALL    ?L?COM00C5
B3:00911F 904633            MOV      DPTR,#handle
B3:009122 51B5              ACALL    ?L?COM001B
B3:009124 F17E              ACALL    ?L?COM00DC
B3:009126 91CA              ACALL    ?L?COM0151
B3:009128 C004              PUSH     AR4
B3:00912A C005              PUSH     AR5
B3:00912C C006              PUSH     AR6
B3:00912E C007              PUSH     AR7
B3:009130 904633            MOV      DPTR,#handle
B3:009133 12EE10            LCALL    ?L?COM01EB
B3:009136 1224C6            LCALL    ?C?LSTKXDATA
B3:009139 00                DB       00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 721


B3:00913A 00                DB       00H
B3:00913B 00                DB       00H
B3:00913C 00                DB       00H
B3:00913D D007              POP      AR7
B3:00913F D006              POP      AR6
B3:009141 D005              POP      AR5
B3:009143 D004              POP      AR4
B3:009145 121AC5            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_scheme_report
B3:009148 121ACA            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_set_inclusion_key
B3:00914B 91CA              ACALL    ?L?COM0151
B3:00914D C004              PUSH     AR4
B3:00914F C005              PUSH     AR5
B3:009151 C006              PUSH     AR6
B3:009153 C007              PUSH     AR7
B3:009155 904633            MOV      DPTR,#handle
B3:009158 D1A2              ACALL    ?L?COM0167
B3:00915A 12EF04            LCALL    ?L?COM0465
B3:00915D D007              POP      AR7
B3:00915F D006              POP      AR6
B3:009161 D005              POP      AR5
B3:009163 D004              POP      AR4
B3:009165 121AD9            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceI_register_scheme
B3:009168 7134              ACALL    ?L?COM0473
B3:00916A 7402              MOV      A,#02H
B3:00916C 8027              SJMP     ?C0196?SECURE_LEARN
B3:00916E         ?C0145?SECURE_LEARN:
B3:00916E 7134              ACALL    ?L?COM0473
B3:009170 900018            MOV      DPTR,#018H
B3:009173 121FB9            LCALL    ?C?CLDOPTR
B3:009176 6025              JZ       ?C0148?SECURE_LEARN
B3:009178 904633            MOV      DPTR,#handle
B3:00917B 712C              ACALL    ?L?COM00C5
B3:00917D 904633            MOV      DPTR,#handle
B3:009180 51B5              ACALL    ?L?COM001B
B3:009182 E9                MOV      A,R1
B3:009183 2440              ADD      A,#040H
B3:009185 F18D              ACALL    ?L?COM00DD
B3:009187 7134              ACALL    ?L?COM0473
B3:009189 900014            MOV      DPTR,#014H
B3:00918C 122511            LCALL    ?C?LSTKOPTR
B3:00918F 00                DB       00H
B3:009190 00                DB       00H
B3:009191 00                DB       00H
B3:009192 00                DB       00H
B3:009193 7401              MOV      A,#01H
B3:009195         
B3:009195 12203B            LCALL    ?C?CSTPTR
B3:009198 904633            MOV      DPTR,#handle
B3:00919B 51B5              ACALL    ?L?COM001B
B3:00919D         ?C0148?SECURE_LEARN:
B3:00919D 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_EarlyStart (END) -------


----- FUNCTION _secure_learn_runCycle (BEGIN) -----
B3:00919E 904624            MOV      DPTR,#handle
B3:0091A1 122572            LCALL    ?C?PSTXDATA
B3:0091A4 51A1              ACALL    ?L?COM017E
B3:0091A6 12B7E2            LCALL    _clearOutEvents
B3:0091A9 904624            MOV      DPTR,#handle
B3:0091AC 51B5              ACALL    ?L?COM001B
B3:0091AE         ?C0022?SECURE_LEARN:
B3:0091AE 51A1              ACALL    ?L?COM017E
B3:0091B0 900001            MOV      DPTR,#01H
B3:0091B3 122163            LCALL    ?C?ILDOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 722


B3:0091B6 FF                MOV      R7,A
B3:0091B7 AEF0              MOV      R6,B
B3:0091B9 C3                CLR      C
B3:0091BA 9401              SUBB     A,#01H
B3:0091BC EE                MOV      A,R6
B3:0091BD 9400              SUBB     A,#00H
B3:0091BF 4002              JC       $ + 4H
B3:0091C1 4141              AJMP     ?C0023?SECURE_LEARN
B3:0091C3 8F82              MOV      DPL,R7
B3:0091C5 8E83              MOV      DPH,R6
B3:0091C7 121FB9            LCALL    ?C?CLDOPTR
B3:0091CA 12267F            LCALL    ?C?CCASE
B3:0091CD 91F2              DW       ?C0026?SECURE_LEARN
B3:0091CF 01                DB       01H
B3:0091D0 91F6              DW       ?C0027?SECURE_LEARN
B3:0091D2 02                DB       02H
B3:0091D3 91FC              DW       ?C0028?SECURE_LEARN
B3:0091D5 03                DB       03H
B3:0091D6 9203              DW       ?C0029?SECURE_LEARN
B3:0091D8 04                DB       04H
B3:0091D9 9209              DW       ?C0030?SECURE_LEARN
B3:0091DB 05                DB       05H
B3:0091DC 920F              DW       ?C0031?SECURE_LEARN
B3:0091DE 06                DB       06H
B3:0091DF 9216              DW       ?C0032?SECURE_LEARN
B3:0091E1 07                DB       07H
B3:0091E2 921C              DW       ?C0033?SECURE_LEARN
B3:0091E4 08                DB       08H
B3:0091E5 9222              DW       ?C0034?SECURE_LEARN
B3:0091E7 09                DB       09H
B3:0091E8 9228              DW       ?C0035?SECURE_LEARN
B3:0091EA 0A                DB       0AH
B3:0091EB 922F              DW       ?C0036?SECURE_LEARN
B3:0091ED 0B                DB       0BH
B3:0091EE 0000              DW       00H
B3:0091F0 9233              DW       ?C0024?SECURE_LEARN
B3:0091F2         ?C0026?SECURE_LEARN:
B3:0091F2 91D6              ACALL    _secure_learn_react_main_region_LearnMode_r1_Start
B3:0091F4 803D              SJMP     ?C0024?SECURE_LEARN
B3:0091F6         ?C0027?SECURE_LEARN:
B3:0091F6 51A1              ACALL    ?L?COM017E
B3:0091F8 B196              ACALL    _secure_learn_react_main_region_LearnMode_r1_Scheme_report
B3:0091FA 8037              SJMP     ?C0024?SECURE_LEARN
B3:0091FC         ?C0028?SECURE_LEARN:
B3:0091FC 51A1              ACALL    ?L?COM017E
B3:0091FE 12E077            LCALL    _secure_learn_react_main_region_LearnMode_r1_Fail
B3:009201 8030              SJMP     ?C0024?SECURE_LEARN
B3:009203         ?C0029?SECURE_LEARN:
B3:009203 51A1              ACALL    ?L?COM017E
B3:009205 7181              ACALL    _secure_learn_react_main_region_LearnMode_r1_NewKey
B3:009207 802A              SJMP     ?C0024?SECURE_LEARN
B3:009209         ?C0030?SECURE_LEARN:
B3:009209 51A1              ACALL    ?L?COM017E
B3:00920B 7153              ACALL    _secure_learn_react_main_region_LearnMode_r1_Inherited
B3:00920D 8024              SJMP     ?C0024?SECURE_LEARN
B3:00920F         ?C0031?SECURE_LEARN:
B3:00920F 51A1              ACALL    ?L?COM017E
B3:009211 12E090            LCALL    _secure_learn_react_main_region_LearnMode_r1_InsecureNet
B3:009214 801D              SJMP     ?C0024?SECURE_LEARN
B3:009216         ?C0032?SECURE_LEARN:
B3:009216 51A1              ACALL    ?L?COM017E
B3:009218 D1A9              ACALL    _secure_learn_react_main_region_LearnMode_r1_end
B3:00921A 8017              SJMP     ?C0024?SECURE_LEARN
B3:00921C         ?C0033?SECURE_LEARN:
B3:00921C 51A1              ACALL    ?L?COM017E
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 723


B3:00921E 310C              ACALL    _secure_learn_react_main_region_LearnMode_r1_EarlyStart
B3:009220 8011              SJMP     ?C0024?SECURE_LEARN
B3:009222         ?C0034?SECURE_LEARN:
B3:009222 51A1              ACALL    ?L?COM017E
B3:009224 9132              ACALL    _secure_learn_react_main_region_Idle
B3:009226 800B              SJMP     ?C0024?SECURE_LEARN
B3:009228         ?C0035?SECURE_LEARN:
B3:009228 51A1              ACALL    ?L?COM017E
B3:00922A 12E09D            LCALL    _secure_learn_react_main_region_Complete
B3:00922D 8004              SJMP     ?C0024?SECURE_LEARN
B3:00922F         ?C0036?SECURE_LEARN:
B3:00922F 51A1              ACALL    ?L?COM017E
B3:009231 713A              ACALL    _secure_learn_react_main_region_SendReport
B3:009233         ?C0024?SECURE_LEARN:
B3:009233 51A1              ACALL    ?L?COM017E
B3:009235 900001            MOV      DPTR,#01H
B3:009238 E4                CLR      A
B3:009239 75F001            MOV      B,#01H
B3:00923C 12219B            LCALL    ?C?IILDOPTR
B3:00923F 21AE              AJMP     ?C0022?SECURE_LEARN
B3:009241         ?C0023?SECURE_LEARN:
B3:009241 51A1              ACALL    ?L?COM017E
B3:;----                  JMP      _clearInEvents
----- FUNCTION _secure_learn_runCycle (END) -------


----- FUNCTION _clearInEvents (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:009243 900018            MOV      DPTR,#018H
B3:009246 E4                CLR      A
B3:009247 12204D            LCALL    ?C?CSTOPTR
B3:00924A 900019            MOV      DPTR,#019H
B3:00924D E4                CLR      A
B3:00924E 12204D            LCALL    ?C?CSTOPTR
B3:009251 90001A            MOV      DPTR,#01AH
B3:009254 E4                CLR      A
B3:009255 12204D            LCALL    ?C?CSTOPTR
B3:009258 90001F            MOV      DPTR,#01FH
B3:00925B E4                CLR      A
B3:00925C 12204D            LCALL    ?C?CSTOPTR
B3:00925F 900023            MOV      DPTR,#023H
B3:009262 E4                CLR      A
B3:009263 12204D            LCALL    ?C?CSTOPTR
B3:009266 900024            MOV      DPTR,#024H
B3:009269 E4                CLR      A
B3:00926A 12204D            LCALL    ?C?CSTOPTR
B3:00926D 12ED21            LCALL    ?L?COM055A
B3:009270 90002A            MOV      DPTR,#02AH
B3:009273 E4                CLR      A
B3:009274 12204D            LCALL    ?C?CSTOPTR
B3:009277 90002F            MOV      DPTR,#02FH
B3:00927A E4                CLR      A
B3:00927B 12204D            LCALL    ?C?CSTOPTR
B3:00927E 900034            MOV      DPTR,#034H
B3:009281 E4                CLR      A
B3:009282 12204D            LCALL    ?C?CSTOPTR
B3:009285 900039            MOV      DPTR,#039H
B3:009288 E4                CLR      A
B3:009289 12204D            LCALL    ?C?CSTOPTR
B3:00928C 900040            MOV      DPTR,#040H
B3:00928F E4                CLR      A
B3:009290 12204D            LCALL    ?C?CSTOPTR
B3:009293 900041            MOV      DPTR,#041H
B3:009296 E4                CLR      A
B3:009297 12204D            LCALL    ?C?CSTOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 724


B3:00929A 900042            MOV      DPTR,#042H
B3:00929D E4                CLR      A
B3:00929E 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _clearInEvents (END) -------


----- FUNCTION ?L?COM017E (BEGIN) -----
B3:0092A1 904624            MOV      DPTR,#handle
B3:0092A4 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM017E (END) -------


----- FUNCTION ?L?COM001A (BEGIN) -----
B3:0092A7 904630            MOV      DPTR,#handle
B3:0092AA 122552            LCALL    ?C?PLDXDATA
B3:0092AD 740C              MOV      A,#0CH
B3:0092AF 12203B            LCALL    ?C?CSTPTR
B3:0092B2 904630            MOV      DPTR,#handle
B3:0092B5         ?L?COM001B:
B3:0092B5 122552            LCALL    ?C?PLDXDATA
B3:0092B8         ?L?COM001C:
B3:0092B8 900001            MOV      DPTR,#01H
B3:0092BB E4                CLR      A
B3:0092BC F5F0              MOV      B,A
B3:0092BE 022207            LJMP     ?C?ISTOPTR
----- FUNCTION ?L?COM001A (END) -------


----- FUNCTION _secure_learn_exit (BEGIN) -----
B3:0092C1 904621            MOV      DPTR,#handle
B3:0092C4 122572            LCALL    ?C?PSTXDATA
B3:0092C7 904621            MOV      DPTR,#handle
B3:0092CA 12A3E6            LCALL    ?L?COM0077
B3:0092CD 12267F            LCALL    ?C?CCASE
B3:0092D0 92F5              DW       ?C0007?SECURE_LEARN
B3:0092D2 01                DB       01H
B3:0092D3 9301              DW       ?C0008?SECURE_LEARN
B3:0092D5 02                DB       02H
B3:0092D6 931B              DW       ?C0016?SECURE_LEARN
B3:0092D8 03                DB       03H
B3:0092D9 930D              DW       ?C0010?SECURE_LEARN
B3:0092DB 04                DB       04H
B3:0092DC 931B              DW       ?C0016?SECURE_LEARN
B3:0092DE 05                DB       05H
B3:0092DF 931B              DW       ?C0016?SECURE_LEARN
B3:0092E1 06                DB       06H
B3:0092E2 931B              DW       ?C0016?SECURE_LEARN
B3:0092E4 07                DB       07H
B3:0092E5 931B              DW       ?C0016?SECURE_LEARN
B3:0092E7 08                DB       08H
B3:0092E8 931B              DW       ?C0016?SECURE_LEARN
B3:0092EA 09                DB       09H
B3:0092EB 931B              DW       ?C0016?SECURE_LEARN
B3:0092ED 0A                DB       0AH
B3:0092EE 931B              DW       ?C0016?SECURE_LEARN
B3:0092F0 0B                DB       0BH
B3:0092F1 0000              DW       00H
B3:0092F3 9322              DW       ?C0006?SECURE_LEARN
B3:0092F5         ?C0007?SECURE_LEARN:
B3:0092F5 7129              ACALL    ?L?COM00C4
B3:0092F7 904621            MOV      DPTR,#handle
B3:0092FA 51B5              ACALL    ?L?COM001B
B3:0092FC E9                MOV      A,R1
B3:0092FD 2440              ADD      A,#040H
B3:0092FF 8016              SJMP     ?C0164?SECURE_LEARN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 725


B3:009301         ?C0008?SECURE_LEARN:
B3:009301 7129              ACALL    ?L?COM00C4
B3:009303 904621            MOV      DPTR,#handle
B3:009306 51B5              ACALL    ?L?COM001B
B3:009308 E9                MOV      A,R1
B3:009309 2441              ADD      A,#041H
B3:00930B         
B3:00930B 800A              SJMP     ?C0164?SECURE_LEARN
B3:00930D         ?C0010?SECURE_LEARN:
B3:00930D 7129              ACALL    ?L?COM00C4
B3:00930F 904621            MOV      DPTR,#handle
B3:009312 51B5              ACALL    ?L?COM001B
B3:009314 E9                MOV      A,R1
B3:009315 2442              ADD      A,#042H
B3:009317         
B3:009317 B18F              ACALL    ?L?COM01AB
B3:009319 8007              SJMP     ?C0006?SECURE_LEARN
B3:00931B         ?C0016?SECURE_LEARN:
B3:00931B         
B3:00931B         
B3:00931B 7129              ACALL    ?L?COM00C4
B3:00931D 904621            MOV      DPTR,#handle
B3:009320 51B5              ACALL    ?L?COM001B
B3:009322         ?C0006?SECURE_LEARN:
B3:009322 904621            MOV      DPTR,#handle
B3:009325 122552            LCALL    ?C?PLDXDATA
B3:;----                  JMP      _secure_learn_exitaction
----- FUNCTION _secure_learn_exit (END) -------


----- FUNCTION _secure_learn_exitaction (BEGIN) -----
B3:009328 22                RET      
----- FUNCTION _secure_learn_exitaction (END) -------


----- FUNCTION ?L?COM00C4 (BEGIN) -----
B3:009329 904621            MOV      DPTR,#handle
B3:00932C         ?L?COM00C5:
B3:00932C 122552            LCALL    ?C?PLDXDATA
B3:00932F 740C              MOV      A,#0CH
B3:009331 02203B            LJMP     ?C?CSTPTR
----- FUNCTION ?L?COM00C4 (END) -------


----- FUNCTION ?L?COM0473 (BEGIN) -----
B3:009334 904633            MOV      DPTR,#handle
B3:009337 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0473 (END) -------


----- FUNCTION _secure_learn_react_main_region_SendReport (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00933A 12D732            LCALL    ?L?COM02E3
B3:00933D 7005              JNZ      ?C0158?SECURE_LEARN
B3:00933F 12EECF            LCALL    ?L?COM03DB
B3:009342 600E              JZ       ?C0159?SECURE_LEARN
B3:009344         ?C0158?SECURE_LEARN:
B3:009344 740C              MOV      A,#0CH
B3:009346 12203B            LCALL    ?C?CSTPTR
B3:009349 51B8              ACALL    ?L?COM001C
B3:00934B 7409              MOV      A,#09H
B3:00934D 12203B            LCALL    ?C?CSTPTR
B3:009350 51B8              ACALL    ?L?COM001C
B3:009352         ?C0159?SECURE_LEARN:
B3:009352 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 726


----- FUNCTION _secure_learn_react_main_region_SendReport (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Inherited (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:009353 12EECF            LCALL    ?L?COM03DB
B3:009356 600B              JZ       ?C0127?SECURE_LEARN
B3:009358 740C              MOV      A,#0CH
B3:00935A 12203B            LCALL    ?C?CSTPTR
B3:00935D 51B8              ACALL    ?L?COM001C
B3:00935F 7407              MOV      A,#07H
B3:009361 8018              SJMP     ?C0189?SECURE_LEARN
B3:009363         ?C0127?SECURE_LEARN:
B3:009363 12D732            LCALL    ?L?COM02E3
B3:009366 6018              JZ       ?C0130?SECURE_LEARN
B3:009368 740C              MOV      A,#0CH
B3:00936A 12203B            LCALL    ?C?CSTPTR
B3:00936D 51B8              ACALL    ?L?COM001C
B3:00936F 900010            MOV      DPTR,#010H
B3:009372 122511            LCALL    ?C?LSTKOPTR
B3:009375 00                DB       00H
B3:009376 00                DB       00H
B3:009377 00                DB       00H
B3:009378 00                DB       00H
B3:009379 7403              MOV      A,#03H
B3:00937B         
B3:00937B 12203B            LCALL    ?C?CSTPTR
B3:00937E 51B8              ACALL    ?L?COM001C
B3:009380         ?C0130?SECURE_LEARN:
B3:009380 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Inherited (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_NewKey (BEGIN) -----
B3:009381 90462D            MOV      DPTR,#handle
B3:009384 122572            LCALL    ?C?PSTXDATA
B3:009387 12E046            LCALL    ?L?COM027D
B3:00938A 701B              JNZ      ?C0120?SECURE_LEARN
B3:00938C 12EECF            LCALL    ?L?COM03DB
B3:00938F 6016              JZ       ?C0120?SECURE_LEARN
B3:009391 90462D            MOV      DPTR,#handle
B3:009394 712C              ACALL    ?L?COM00C5
B3:009396 90462D            MOV      DPTR,#handle
B3:009399 51B5              ACALL    ?L?COM001B
B3:00939B B18C              ACALL    ?L?COM01AA
B3:00939D 90462D            MOV      DPTR,#handle
B3:0093A0 122552            LCALL    ?C?PLDXDATA
B3:0093A3 7407              MOV      A,#07H
B3:0093A5 8129              AJMP     ?C0188?SECURE_LEARN
B3:0093A7         ?C0120?SECURE_LEARN:
B3:0093A7 90462D            MOV      DPTR,#handle
B3:0093AA 12D72F            LCALL    ?L?COM02E2
B3:0093AD 7008              JNZ      ?C0123?SECURE_LEARN
B3:0093AF 900042            MOV      DPTR,#042H
B3:0093B2 121FB9            LCALL    ?C?CLDOPTR
B3:0093B5 601C              JZ       ?C0122?SECURE_LEARN
B3:0093B7         ?C0123?SECURE_LEARN:
B3:0093B7 90462D            MOV      DPTR,#handle
B3:0093BA 712C              ACALL    ?L?COM00C5
B3:0093BC 90462D            MOV      DPTR,#handle
B3:0093BF 51B5              ACALL    ?L?COM001B
B3:0093C1 B18C              ACALL    ?L?COM01AA
B3:0093C3 90462D            MOV      DPTR,#handle
B3:0093C6 D1A2              ACALL    ?L?COM0167
B3:0093C8 122511            LCALL    ?C?LSTKOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 727


B3:0093CB 00                DB       00H
B3:0093CC 00                DB       00H
B3:0093CD 00                DB       00H
B3:0093CE 00                DB       00H
B3:0093CF 7403              MOV      A,#03H
B3:0093D1         
B3:0093D1 8056              SJMP     ?C0188?SECURE_LEARN
B3:0093D3         ?C0122?SECURE_LEARN:
B3:0093D3 12E046            LCALL    ?L?COM027D
B3:0093D6 6059              JZ       ?C0126?SECURE_LEARN
B3:0093D8 91D0              ACALL    ?L?COM0153
B3:0093DA 90002B            MOV      DPTR,#02BH
B3:0093DD 12EF6C            LCALL    ?L?COM0569
B3:0093E0 704F              JNZ      ?C0126?SECURE_LEARN
B3:0093E2 90462D            MOV      DPTR,#handle
B3:0093E5 122552            LCALL    ?C?PLDXDATA
B3:0093E8 90002A            MOV      DPTR,#02AH
B3:0093EB 121FB9            LCALL    ?C?CLDOPTR
B3:0093EE 6041              JZ       ?C0126?SECURE_LEARN
B3:0093F0 90462D            MOV      DPTR,#handle
B3:0093F3 712C              ACALL    ?L?COM00C5
B3:0093F5 90462D            MOV      DPTR,#handle
B3:0093F8 51B5              ACALL    ?L?COM001B
B3:0093FA B18C              ACALL    ?L?COM01AA
B3:0093FC 90462D            MOV      DPTR,#handle
B3:0093FF 91CD              ACALL    ?L?COM0152
B3:009401 C004              PUSH     AR4
B3:009403 C005              PUSH     AR5
B3:009405 C006              PUSH     AR6
B3:009407 C007              PUSH     AR7
B3:009409 90462D            MOV      DPTR,#handle
B3:00940C 12EE10            LCALL    ?L?COM01EB
B3:00940F 1224C6            LCALL    ?C?LSTKXDATA
B3:009412 00                DB       00H
B3:009413 00                DB       00H
B3:009414 00                DB       00H
B3:009415 01                DB       01H
B3:009416 D007              POP      AR7
B3:009418 D006              POP      AR6
B3:00941A D005              POP      AR5
B3:00941C D004              POP      AR4
B3:00941E 121AC5            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_scheme_report
B3:009421 90462D            MOV      DPTR,#handle
B3:009424 122552            LCALL    ?C?PLDXDATA
B3:009427 7405              MOV      A,#05H
B3:009429         
B3:009429 12203B            LCALL    ?C?CSTPTR
B3:00942C 90462D            MOV      DPTR,#handle
B3:00942F 51B5              ACALL    ?L?COM001B
B3:009431         ?C0126?SECURE_LEARN:
B3:009431 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_NewKey (END) -------


----- FUNCTION _secure_learn_react_main_region_Idle (BEGIN) -----
B3:009432 904636            MOV      DPTR,#handle
B3:009435 122572            LCALL    ?C?PSTXDATA
B3:009438 91C4              ACALL    ?L?COM024E
B3:00943A 900018            MOV      DPTR,#018H
B3:00943D 121FB9            LCALL    ?C?CLDOPTR
B3:009440 6021              JZ       ?C0149?SECURE_LEARN
B3:009442 904636            MOV      DPTR,#handle
B3:009445 712C              ACALL    ?L?COM00C5
B3:009447 904636            MOV      DPTR,#handle
B3:00944A 51B5              ACALL    ?L?COM001B
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 728


B3:00944C 91C1              ACALL    ?L?COM024D
B3:00944E E9                MOV      A,R1
B3:00944F 2440              ADD      A,#040H
B3:009451 F18D              ACALL    ?L?COM00DD
B3:009453 91C4              ACALL    ?L?COM024E
B3:009455 900014            MOV      DPTR,#014H
B3:009458 122511            LCALL    ?C?LSTKOPTR
B3:00945B 00                DB       00H
B3:00945C 00                DB       00H
B3:00945D 00                DB       00H
B3:00945E 00                DB       00H
B3:00945F 7401              MOV      A,#01H
B3:009461 8055              SJMP     ?C0198?SECURE_LEARN
B3:009463         ?C0149?SECURE_LEARN:
B3:009463 91C4              ACALL    ?L?COM024E
B3:009465 90001F            MOV      DPTR,#01FH
B3:009468 121FB9            LCALL    ?C?CLDOPTR
B3:00946B 6033              JZ       ?C0151?SECURE_LEARN
B3:00946D 904636            MOV      DPTR,#handle
B3:009470 712C              ACALL    ?L?COM00C5
B3:009472 904636            MOV      DPTR,#handle
B3:009475 51B5              ACALL    ?L?COM001B
B3:009477 91D0              ACALL    ?L?COM0153
B3:009479 C004              PUSH     AR4
B3:00947B C005              PUSH     AR5
B3:00947D C006              PUSH     AR6
B3:00947F C007              PUSH     AR7
B3:009481 91C4              ACALL    ?L?COM024E
B3:009483 900007            MOV      DPTR,#07H
B3:009486 1223F4            LCALL    ?C?LLDOPTR
B3:009489 9041A8            MOV      DPTR,#?_secure_learnIface_send_commands_supported?BYTE+04H
B3:00948C 1224BA            LCALL    ?C?LSTXDATA
B3:00948F D007              POP      AR7
B3:009491 D006              POP      AR6
B3:009493 D005              POP      AR5
B3:009495 D004              POP      AR4
B3:009497 121AA7            LCALL    ?INTERBANK_TABLE?_secure_learnIface_send_commands_supported
B3:00949A 91C4              ACALL    ?L?COM024E
B3:00949C 740B              MOV      A,#0BH
B3:00949E         
B3:00949E 8018              SJMP     ?C0198?SECURE_LEARN
B3:0094A0         ?C0151?SECURE_LEARN:
B3:0094A0 91C4              ACALL    ?L?COM024E
B3:0094A2 900019            MOV      DPTR,#019H
B3:0094A5 121FB9            LCALL    ?C?CLDOPTR
B3:0094A8 6016              JZ       ?C0154?SECURE_LEARN
B3:0094AA 740C              MOV      A,#0CH
B3:0094AC 12203B            LCALL    ?C?CSTPTR
B3:0094AF 904636            MOV      DPTR,#handle
B3:0094B2 51B5              ACALL    ?L?COM001B
B3:0094B4 91C1              ACALL    ?L?COM024D
B3:0094B6 7408              MOV      A,#08H
B3:0094B8         
B3:0094B8 12203B            LCALL    ?C?CSTPTR
B3:0094BB 904636            MOV      DPTR,#handle
B3:0094BE 51B5              ACALL    ?L?COM001B
B3:0094C0         ?C0154?SECURE_LEARN:
B3:0094C0 22                RET      
----- FUNCTION _secure_learn_react_main_region_Idle (END) -------


----- FUNCTION ?L?COM024D (BEGIN) -----
B3:0094C1 121AC0            LCALL    ?INTERBANK_TABLE?secure_learnIface_update_callback
B3:0094C4         ?L?COM024E:
B3:0094C4 904636            MOV      DPTR,#handle
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 729


B3:0094C7 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM024D (END) -------


----- FUNCTION ?L?COM0151 (BEGIN) -----
B3:0094CA 904633            MOV      DPTR,#handle
B3:0094CD         ?L?COM0152:
B3:0094CD 122552            LCALL    ?C?PLDXDATA
B3:0094D0         ?L?COM0153:
B3:0094D0 90000C            MOV      DPTR,#0CH
B3:0094D3 0223F4            LJMP     ?C?LLDOPTR
----- FUNCTION ?L?COM0151 (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Start (BEGIN) -----
B3:0094D6 904627            MOV      DPTR,#handle
B3:0094D9 122572            LCALL    ?C?PSTXDATA
B3:0094DC 904627            MOV      DPTR,#handle
B3:0094DF 12C487            LCALL    ?L?COM00D8
B3:0094E2 6061              JZ       ?C0104?SECURE_LEARN
B3:0094E4 904627            MOV      DPTR,#handle
B3:0094E7 712C              ACALL    ?L?COM00C5
B3:0094E9 904627            MOV      DPTR,#handle
B3:0094EC 51B5              ACALL    ?L?COM001B
B3:0094EE E9                MOV      A,R1
B3:0094EF 2440              ADD      A,#040H
B3:0094F1 B18F              ACALL    ?L?COM01AB
B3:0094F3 F178              ACALL    ?L?COM03B2
B3:0094F5 F17E              ACALL    ?L?COM00DC
B3:0094F7 904627            MOV      DPTR,#handle
B3:0094FA 91CD              ACALL    ?L?COM0152
B3:0094FC C004              PUSH     AR4
B3:0094FE C005              PUSH     AR5
B3:009500 C006              PUSH     AR6
B3:009502 C007              PUSH     AR7
B3:009504 904627            MOV      DPTR,#handle
B3:009507 12EE10            LCALL    ?L?COM01EB
B3:00950A 1224C6            LCALL    ?C?LSTKXDATA
B3:00950D 00                DB       00H
B3:00950E 00                DB       00H
B3:00950F 00                DB       00H
B3:009510 00                DB       00H
B3:009511 D007              POP      AR7
B3:009513 D006              POP      AR6
B3:009515 D005              POP      AR5
B3:009517 D004              POP      AR4
B3:009519 121AC5            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_scheme_report
B3:00951C 121ACA            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_set_inclusion_key
B3:00951F 904627            MOV      DPTR,#handle
B3:009522 91CD              ACALL    ?L?COM0152
B3:009524 C004              PUSH     AR4
B3:009526 C005              PUSH     AR5
B3:009528 C006              PUSH     AR6
B3:00952A C007              PUSH     AR7
B3:00952C 904627            MOV      DPTR,#handle
B3:00952F D1A2              ACALL    ?L?COM0167
B3:009531 12EF04            LCALL    ?L?COM0465
B3:009534 D007              POP      AR7
B3:009536 D006              POP      AR6
B3:009538 D005              POP      AR5
B3:00953A D004              POP      AR4
B3:00953C 121AD9            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceI_register_scheme
B3:00953F F178              ACALL    ?L?COM03B2
B3:009541 7402              MOV      A,#02H
B3:009543 803B              SJMP     ?C0184?SECURE_LEARN
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 730


B3:009545         ?C0104?SECURE_LEARN:
B3:009545 F178              ACALL    ?L?COM03B2
B3:009547 900040            MOV      DPTR,#040H
B3:00954A 121FB9            LCALL    ?C?CLDOPTR
B3:00954D 6039              JZ       ?C0110?SECURE_LEARN
B3:00954F 904627            MOV      DPTR,#handle
B3:009552 712C              ACALL    ?L?COM00C5
B3:009554 904627            MOV      DPTR,#handle
B3:009557 51B5              ACALL    ?L?COM001B
B3:009559 E9                MOV      A,R1
B3:00955A 2440              ADD      A,#040H
B3:00955C B18F              ACALL    ?L?COM01AB
B3:00955E 904627            MOV      DPTR,#handle
B3:009561 12E049            LCALL    ?L?COM027E
B3:009564 6013              JZ       ?C0107?SECURE_LEARN
B3:009566 121AB6            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_new_keys
B3:009569 904627            MOV      DPTR,#handle
B3:00956C D1A2              ACALL    ?L?COM0167
B3:00956E 122511            LCALL    ?C?LSTKOPTR
B3:009571 00                DB       00H
B3:009572 00                DB       00H
B3:009573 00                DB       00H
B3:009574 01                DB       01H
B3:009575 7406              MOV      A,#06H
B3:009577         
B3:009577 8007              SJMP     ?C0184?SECURE_LEARN
B3:009579         ?C0107?SECURE_LEARN:
B3:009579 121AB1            LCALL    ?INTERBANK_TABLE?secure_learnIface_state_start_timeout
B3:00957C F178              ACALL    ?L?COM03B2
B3:00957E 7407              MOV      A,#07H
B3:009580         
B3:009580 12203B            LCALL    ?C?CSTPTR
B3:009583 904627            MOV      DPTR,#handle
B3:009586 51B5              ACALL    ?L?COM001B
B3:009588         ?C0110?SECURE_LEARN:
B3:009588 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Start (END) -------


----- FUNCTION _MemoryGetByte (BEGIN) -----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:009589 0239F2            LJMP     _NVM_ext_read_byte
----- FUNCTION _MemoryGetByte (END) -------


----- FUNCTION ?L?COM01AA (BEGIN) -----
B3:00958C E9                MOV      A,R1
B3:00958D 2442              ADD      A,#042H
B3:00958F         ?L?COM01AB:
B3:00958F F9                MOV      R1,A
B3:009590 E4                CLR      A
B3:009591 3A                ADDC     A,R2
B3:009592 FA                MOV      R2,A
B3:009593 021AA2            LJMP     ?INTERBANK_TABLE?_secure_learn_unsetTimer
----- FUNCTION ?L?COM01AA (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Scheme_report (BEGIN) -----
B3:009596 90462A            MOV      DPTR,#handle
B3:009599 122572            LCALL    ?C?PSTXDATA
B3:00959C 90462A            MOV      DPTR,#handle
B3:00959F 91CD              ACALL    ?L?COM0152
B3:0095A1 900030            MOV      DPTR,#030H
B3:0095A4 12EF6C            LCALL    ?L?COM0569
B3:0095A7 6002              JZ       $ + 4H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 731


B3:0095A9 C12A              AJMP     ?C0111?SECURE_LEARN
B3:0095AB 90462A            MOV      DPTR,#handle
B3:0095AE 122552            LCALL    ?C?PLDXDATA
B3:0095B1 90002F            MOV      DPTR,#02FH
B3:0095B4 121FB9            LCALL    ?C?CLDOPTR
B3:0095B7 6071              JZ       ?C0111?SECURE_LEARN
B3:0095B9 90462A            MOV      DPTR,#handle
B3:0095BC 712C              ACALL    ?L?COM00C5
B3:0095BE 90462A            MOV      DPTR,#handle
B3:0095C1 51B5              ACALL    ?L?COM001B
B3:0095C3 E9                MOV      A,R1
B3:0095C4 2441              ADD      A,#041H
B3:0095C6 B18F              ACALL    ?L?COM01AB
B3:0095C8 12EF73            LCALL    ?L?COM056A
B3:0095CB 2442              ADD      A,#042H
B3:0095CD F18D              ACALL    ?L?COM00DD
B3:0095CF 90462A            MOV      DPTR,#handle
B3:0095D2 91CD              ACALL    ?L?COM0152
B3:0095D4 C004              PUSH     AR4
B3:0095D6 C005              PUSH     AR5
B3:0095D8 C006              PUSH     AR6
B3:0095DA C007              PUSH     AR7
B3:0095DC 90462A            MOV      DPTR,#handle
B3:0095DF 12E6DA            LCALL    ?L?COM03C2
B3:0095E2 1223F4            LCALL    ?C?LLDOPTR
B3:0095E5 904326            MOV      DPTR,#?_secure_learnIfaceL_send_key_verify?BYTE+04H
B3:0095E8 1224BA            LCALL    ?C?LSTXDATA
B3:0095EB D007              POP      AR7
B3:0095ED D006              POP      AR6
B3:0095EF D005              POP      AR5
B3:0095F1 D004              POP      AR4
B3:0095F3 121AD4            LCALL    ?INTERBANK_TABLE?_secure_learnIfaceL_send_key_verify
B3:0095F6 12EF73            LCALL    ?L?COM056A
B3:0095F9 2410              ADD      A,#010H
B3:0095FB F9                MOV      R1,A
B3:0095FC E4                CLR      A
B3:0095FD 3A                ADDC     A,R2
B3:0095FE FA                MOV      R2,A
B3:0095FF C003              PUSH     AR3
B3:009601 C002              PUSH     AR2
B3:009603 C001              PUSH     AR1
B3:009605 1223D4            LCALL    ?C?LLDPTR
B3:009608 90462A            MOV      DPTR,#handle
B3:00960B 122552            LCALL    ?C?PLDXDATA
B3:00960E 900003            MOV      DPTR,#03H
B3:009611 12248A            LCALL    ?C?LLDOPTR0
B3:009614 12236C            LCALL    ?C?LAND
B3:009617 D001              POP      AR1
B3:009619 D002              POP      AR2
B3:00961B D003              POP      AR3
B3:00961D 122424            LCALL    ?C?LSTPTR
B3:009620 90462A            MOV      DPTR,#handle
B3:009623 122552            LCALL    ?C?PLDXDATA
B3:009626 7404              MOV      A,#04H
B3:009628 805F              SJMP     ?C0186?SECURE_LEARN
B3:00962A         ?C0111?SECURE_LEARN:
B3:00962A 90462A            MOV      DPTR,#handle
B3:00962D 12D72F            LCALL    ?L?COM02E2
B3:009630 7008              JNZ      ?C0114?SECURE_LEARN
B3:009632 900041            MOV      DPTR,#041H
B3:009635 121FB9            LCALL    ?C?CLDOPTR
B3:009638 6017              JZ       ?C0113?SECURE_LEARN
B3:00963A         ?C0114?SECURE_LEARN:
B3:00963A 90462A            MOV      DPTR,#handle
B3:00963D 712C              ACALL    ?L?COM00C5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 732


B3:00963F 90462A            MOV      DPTR,#handle
B3:009642 51B5              ACALL    ?L?COM001B
B3:009644 D195              ACALL    ?L?COM0166
B3:009646 122511            LCALL    ?C?LSTKOPTR
B3:009649 00                DB       00H
B3:00964A 00                DB       00H
B3:00964B 00                DB       00H
B3:00964C 00                DB       00H
B3:00964D 7403              MOV      A,#03H
B3:00964F         
B3:00964F 8038              SJMP     ?C0186?SECURE_LEARN
B3:009651         ?C0113?SECURE_LEARN:
B3:009651 90462A            MOV      DPTR,#handle
B3:009654 122552            LCALL    ?C?PLDXDATA
B3:009657 12700C            LCALL    ?L?COM04A8
B3:00965A 900010            MOV      DPTR,#010H
B3:00965D 12248A            LCALL    ?C?LLDOPTR0
B3:009660 12236C            LCALL    ?C?LAND
B3:009663 EC                MOV      A,R4
B3:009664 4D                ORL      A,R5
B3:009665 4E                ORL      A,R6
B3:009666 4F                ORL      A,R7
B3:009667 7028              JNZ      ?C0117?SECURE_LEARN
B3:009669 90462A            MOV      DPTR,#handle
B3:00966C 122552            LCALL    ?C?PLDXDATA
B3:00966F 12EECF            LCALL    ?L?COM03DB
B3:009672 601D              JZ       ?C0117?SECURE_LEARN
B3:009674 90462A            MOV      DPTR,#handle
B3:009677 712C              ACALL    ?L?COM00C5
B3:009679 90462A            MOV      DPTR,#handle
B3:00967C 51B5              ACALL    ?L?COM001B
B3:00967E D195              ACALL    ?L?COM0166
B3:009680 122511            LCALL    ?C?LSTKOPTR
B3:009683 00                DB       00H
B3:009684 00                DB       00H
B3:009685 00                DB       00H
B3:009686 00                DB       00H
B3:009687 7403              MOV      A,#03H
B3:009689         
B3:009689 12203B            LCALL    ?C?CSTPTR
B3:00968C 90462A            MOV      DPTR,#handle
B3:00968F 51B5              ACALL    ?L?COM001B
B3:009691         ?C0117?SECURE_LEARN:
B3:009691 22                RET      
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Scheme_report (END) -------


----- FUNCTION _secure_learnIface_get_supported_schemes (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:009692 02700C            LJMP     ?L?COM04A8
----- FUNCTION _secure_learnIface_get_supported_schemes (END) -------


----- FUNCTION ?L?COM0166 (BEGIN) -----
B3:009695 E9                MOV      A,R1
B3:009696 2441              ADD      A,#041H
B3:009698 F9                MOV      R1,A
B3:009699 E4                CLR      A
B3:00969A 3A                ADDC     A,R2
B3:00969B FA                MOV      R2,A
B3:00969C 121AA2            LCALL    ?INTERBANK_TABLE?_secure_learn_unsetTimer
B3:00969F 90462A            MOV      DPTR,#handle
B3:0096A2         ?L?COM0167:
B3:0096A2 122552            LCALL    ?C?PLDXDATA
B3:0096A5 900010            MOV      DPTR,#010H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 733


B3:0096A8 22                RET      
----- FUNCTION ?L?COM0166 (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_end (BEGIN) -----
B3:0096A9 904630            MOV      DPTR,#handle
B3:0096AC 122572            LCALL    ?C?PSTXDATA
B3:0096AF 904630            MOV      DPTR,#handle
B3:0096B2 12A3E6            LCALL    ?L?COM0077
B3:0096B5 12267F            LCALL    ?C?CCASE
B3:0096B8 96D4              DW       ?C0135?SECURE_LEARN
B3:0096BA 01                DB       01H
B3:0096BB 96DB              DW       ?C0136?SECURE_LEARN
B3:0096BD 02                DB       02H
B3:0096BE 96EB              DW       ?C0141?SECURE_LEARN
B3:0096C0 03                DB       03H
B3:0096C1 96E2              DW       ?C0138?SECURE_LEARN
B3:0096C3 04                DB       04H
B3:0096C4 96EB              DW       ?C0141?SECURE_LEARN
B3:0096C6 05                DB       05H
B3:0096C7 96EB              DW       ?C0141?SECURE_LEARN
B3:0096C9 06                DB       06H
B3:0096CA 96EB              DW       ?C0141?SECURE_LEARN
B3:0096CC 07                DB       07H
B3:0096CD 96EB              DW       ?C0141?SECURE_LEARN
B3:0096CF 08                DB       08H
B3:0096D0 0000              DW       00H
B3:0096D2 96ED              DW       ?C0134?SECURE_LEARN
B3:0096D4         ?C0135?SECURE_LEARN:
B3:0096D4 51A7              ACALL    ?L?COM001A
B3:0096D6 E9                MOV      A,R1
B3:0096D7 2440              ADD      A,#040H
B3:0096D9 800C              SJMP     ?C0191?SECURE_LEARN
B3:0096DB         ?C0136?SECURE_LEARN:
B3:0096DB 51A7              ACALL    ?L?COM001A
B3:0096DD E9                MOV      A,R1
B3:0096DE 2441              ADD      A,#041H
B3:0096E0         
B3:0096E0 8005              SJMP     ?C0191?SECURE_LEARN
B3:0096E2         ?C0138?SECURE_LEARN:
B3:0096E2 51A7              ACALL    ?L?COM001A
B3:0096E4 E9                MOV      A,R1
B3:0096E5 2442              ADD      A,#042H
B3:0096E7         
B3:0096E7 B18F              ACALL    ?L?COM01AB
B3:0096E9 8002              SJMP     ?C0134?SECURE_LEARN
B3:0096EB         ?C0141?SECURE_LEARN:
B3:0096EB         
B3:0096EB         
B3:0096EB 51A7              ACALL    ?L?COM001A
B3:0096ED         ?C0134?SECURE_LEARN:
B3:0096ED 904630            MOV      DPTR,#handle
B3:0096F0 D1A2              ACALL    ?L?COM0167
B3:0096F2 1223F4            LCALL    ?C?LLDOPTR
B3:0096F5 900014            MOV      DPTR,#014H
B3:0096F8 12243E            LCALL    ?C?LSTOPTR
B3:0096FB 121AAC            LCALL    ?INTERBANK_TABLE?secure_learnIfaceL_save_state
B3:0096FE 904630            MOV      DPTR,#handle
B3:009701 D1A2              ACALL    ?L?COM0167
B3:009703 1223F4            LCALL    ?C?LLDOPTR
B3:009706 121ABB            LCALL    ?INTERBANK_TABLE?_secure_learnIface_complete
B3:009709 904630            MOV      DPTR,#handle
B3:00970C 122552            LCALL    ?C?PLDXDATA
B3:00970F 740A              MOV      A,#0AH
B3:009711 12203B            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 734


B3:009714 904630            MOV      DPTR,#handle
B3:009717 122552            LCALL    ?C?PLDXDATA
B3:00971A 12E089            LCALL    ?L?COM02A5
B3:00971D 022207            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_end (END) -------


----- FUNCTION ___ZW_memcmp (BEGIN) -----
B3:009720 904427            MOV      DPTR,#dst
B3:009723 122572            LCALL    ?C?PSTXDATA
;---- Variable 'length' assigned to Register 'R7' ----
B3:009726         ?C0023?ZW_MEM:
B3:009726 AE07              MOV      R6,AR7
B3:009728 1F                DEC      R7
B3:009729 EE                MOV      A,R6
B3:00972A 6029              JZ       ?C0024?ZW_MEM
B3:00972C 90442A            MOV      DPTR,#src
B3:00972F 12A3E6            LCALL    ?L?COM0077
B3:009732 FE                MOV      R6,A
B3:009733 904427            MOV      DPTR,#dst
B3:009736 12A3E6            LCALL    ?L?COM0077
B3:009739 6E                XRL      A,R6
B3:00973A 6003              JZ       ?C0025?ZW_MEM
B3:00973C 7F01              MOV      R7,#01H
B3:00973E 22                RET      
B3:00973F         ?C0025?ZW_MEM:
B3:00973F 904428            MOV      DPTR,#dst+01H
B3:009742 E4                CLR      A
B3:009743 75F001            MOV      B,#01H
B3:009746 12210C            LCALL    ?C?IILDX
B3:009749 90442B            MOV      DPTR,#src+01H
B3:00974C E4                CLR      A
B3:00974D 75F001            MOV      B,#01H
B3:009750 12210C            LCALL    ?C?IILDX
B3:009753 80D1              SJMP     ?C0023?ZW_MEM
B3:009755         ?C0024?ZW_MEM:
B3:009755 7F00              MOV      R7,#00H
B3:009757 22                RET      
----- FUNCTION ___ZW_memcmp (END) -------


----- FUNCTION _ZW_MemoryPutBuffer (BEGIN) -----
;---- Variable 'buffer' assigned to Register 'R1/R2/R3' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:009758 90441D            MOV      DPTR,#length
B3:00975B E0                MOVX     A,@DPTR
B3:00975C FD                MOV      R5,A
B3:00975D A3                INC      DPTR
B3:00975E E0                MOVX     A,@DPTR
B3:00975F 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B3:009762 CD                XCH      A,R5
B3:009763 F0                MOVX     @DPTR,A
B3:009764 A3                INC      DPTR
B3:009765 ED                MOV      A,R5
B3:009766 F0                MOVX     @DPTR,A
B3:009767 1239FB            LCALL    _NVM_ext_write_buffer
B3:00976A 5009              JNC      ?C0015?ZW_MEM
B3:00976C 90441E            MOV      DPTR,#length+01H
B3:00976F E0                MOVX     A,@DPTR
B3:009770 2401              ADD      A,#01H
B3:009772 FF                MOV      R7,A
B3:009773 8002              SJMP     ?C0016?ZW_MEM
B3:009775         ?C0015?ZW_MEM:
B3:009775 7F01              MOV      R7,#01H
B3:009777         ?C0016?ZW_MEM:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 735


B3:009777 22                RET      
----- FUNCTION _ZW_MemoryPutBuffer (END) -------


----- FUNCTION ?L?COM03B2 (BEGIN) -----
B3:009778 904627            MOV      DPTR,#handle
B3:00977B 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03B2 (END) -------


----- FUNCTION ?L?COM00DC (BEGIN) -----
B3:00977E 900026            MOV      DPTR,#026H
B3:009781 1223F4            LCALL    ?C?LLDOPTR
B3:009784 90000C            MOV      DPTR,#0CH
B3:009787 12243E            LCALL    ?C?LSTOPTR
B3:00978A E9                MOV      A,R1
B3:00978B 2441              ADD      A,#041H
B3:00978D         ?L?COM00DD:
B3:00978D F9                MOV      R1,A
B3:00978E E4                CLR      A
B3:00978F 3A                ADDC     A,R2
B3:009790 FA                MOV      R2,A
B3:009791 E4                CLR      A
B3:009792 904321            MOV      DPTR,#?_secure_learn_setTimer?BYTE+07H
B3:009795 F0                MOVX     @DPTR,A
B3:009796 7F10              MOV      R7,#010H
B3:009798 7E27              MOV      R6,#027H
B3:00979A FD                MOV      R5,A
B3:00979B FC                MOV      R4,A
B3:00979C 021A9D            LJMP     ?INTERBANK_TABLE?_secure_learn_setTimer
----- FUNCTION ?L?COM00DC (END) -------


----- FUNCTION ___S2_set_timeout (BEGIN) -----
;---- Variable 'interval' assigned to Register 'R4/R5/R6/R7' ----
B3:00979F 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:0097A2 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_timeout2
B3:0097A4 F0                MOVX     @DPTR,A
B3:0097A5 A3                INC      DPTR
B3:0097A6 74B9              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_timeout2
B3:0097A8 F0                MOVX     @DPTR,A
B3:0097A9 12D662            LCALL    ?L?COM023C
B3:0097AC 126F24            LCALL    ?L?COM0389
B3:0097AF 7A3C              MOV      R2,#HIGH s2_timer
B3:0097B1 79A0              MOV      R1,#LOW s2_timer
B3:0097B3 021B29            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION ___S2_set_timeout (END) -------


----- FUNCTION _ZW_NVRGetValue (BEGIN) -----
B3:0097B6 90451E            MOV      DPTR,#bOffset
B3:0097B9 126563            LCALL    ?L?COM00E9
B3:0097BC 122572            LCALL    ?C?PSTXDATA
B3:0097BF         ?C0001?ZW_NVR:
B3:0097BF 90451F            MOV      DPTR,#bLength
B3:0097C2 E0                MOVX     A,@DPTR
B3:0097C3 604B              JZ       ?C0007?ZW_NVR
B3:0097C5 90123D            MOV      DPTR,#bNVRValid
B3:0097C8 E0                MOVX     A,@DPTR
B3:0097C9 6013              JZ       ?C0003?ZW_NVR
B3:0097CB 90451E            MOV      DPTR,#bOffset
B3:0097CE E0                MOVX     A,@DPTR
B3:0097CF 2410              ADD      A,#010H
B3:0097D1 FF                MOV      R7,A
B3:0097D2 12CB4F            LCALL    _ZW_FLASH_nvr0_get
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 736


B3:0097D5 904520            MOV      DPTR,#bRetBuffer
B3:0097D8 122552            LCALL    ?C?PLDXDATA
B3:0097DB EF                MOV      A,R7
B3:0097DC 8017              SJMP     ?C0019?ZW_NVR
B3:0097DE         ?C0003?ZW_NVR:
B3:0097DE 90451E            MOV      DPTR,#bOffset
B3:0097E1 E0                MOVX     A,@DPTR
B3:0097E2 6401              XRL      A,#01H
B3:0097E4 904520            MOV      DPTR,#bRetBuffer
B3:0097E7 7007              JNZ      ?C0005?ZW_NVR
B3:0097E9 122552            LCALL    ?C?PLDXDATA
B3:0097EC 7480              MOV      A,#080H
B3:0097EE         
B3:0097EE 8005              SJMP     ?C0019?ZW_NVR
B3:0097F0         ?C0005?ZW_NVR:
B3:0097F0 122552            LCALL    ?C?PLDXDATA
B3:0097F3 74FF              MOV      A,#0FFH
B3:0097F5         
B3:0097F5 12203B            LCALL    ?C?CSTPTR
B3:0097F8         ?C0004?ZW_NVR:
B3:0097F8 904521            MOV      DPTR,#bRetBuffer+01H
B3:0097FB E4                CLR      A
B3:0097FC 75F001            MOV      B,#01H
B3:0097FF 12210C            LCALL    ?C?IILDX
B3:009802 90451F            MOV      DPTR,#bLength
B3:009805 E0                MOVX     A,@DPTR
B3:009806 14                DEC      A
B3:009807 F0                MOVX     @DPTR,A
B3:009808 90451E            MOV      DPTR,#bOffset
B3:00980B E0                MOVX     A,@DPTR
B3:00980C 04                INC      A
B3:00980D F0                MOVX     @DPTR,A
B3:00980E 80AF              SJMP     ?C0001?ZW_NVR
B3:009810         ?C0007?ZW_NVR:
B3:009810 22                RET      
----- FUNCTION _ZW_NVRGetValue (END) -------


----- FUNCTION sec0_init (BEGIN) -----
B3:009811 1290B8            LCALL    sec0_unpersist_netkey
B3:009814 90468E            MOV      DPTR,#sec0_isActivated
B3:009817 EF                MOV      A,R7
B3:009818 F0                MOVX     @DPTR,A
B3:009819 E4                CLR      A
B3:00981A 90468D            MOV      DPTR,#i
B3:00981D F0                MOVX     @DPTR,A
B3:00981E         ?C0111?ZW_SECURITY_SCHEME0:
B3:00981E 90468D            MOV      DPTR,#i
B3:009821 E0                MOVX     A,@DPTR
B3:009822 FF                MOV      R7,A
B3:009823 C3                CLR      C
B3:009824 9402              SUBB     A,#02H
B3:009826 500C              JNC      ?C0112?ZW_SECURITY_SCHEME0
B3:009828 12D34E            LCALL    ?L?COM0184
B3:00982B 7B01              MOV      R3,#01H
B3:00982D 1285A1            LCALL    _free_rx_session
B3:009830 1176              ACALL    ?L?COM04AF
B3:009832 80EA              SJMP     ?C0111?ZW_SECURITY_SCHEME0
B3:009834         ?C0112?ZW_SECURITY_SCHEME0:
B3:009834 E4                CLR      A
B3:009835 90468D            MOV      DPTR,#i
B3:009838 F0                MOVX     @DPTR,A
B3:009839         ?C0114?ZW_SECURITY_SCHEME0:
B3:009839 1281E2            LCALL    ?L?COM0351
B3:00983C 1281D0            LCALL    ?L?COM03DF
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 737


B3:00983F 7D5F              MOV      R5,#05FH
B3:009841 E4                CLR      A
B3:009842 FF                MOV      R7,A
B3:009843 12851A            LCALL    ___ZW_memset
B3:009846 1176              ACALL    ?L?COM04AF
B3:009848 E0                MOVX     A,@DPTR
B3:009849 C3                CLR      C
B3:00984A 9402              SUBB     A,#02H
B3:00984C 40EB              JC       ?C0114?ZW_SECURITY_SCHEME0
B3:00984E         ?C0115?ZW_SECURITY_SCHEME0:
B3:00984E E4                CLR      A
B3:00984F 90468D            MOV      DPTR,#i
B3:009852 F0                MOVX     @DPTR,A
B3:009853         ?C0117?ZW_SECURITY_SCHEME0:
B3:009853 90468D            MOV      DPTR,#i
B3:009856 E0                MOVX     A,@DPTR
B3:009857 FF                MOV      R7,A
B3:009858 C3                CLR      C
B3:009859 940F              SUBB     A,#0FH
B3:00985B 5009              JNC      ?C0118?ZW_SECURITY_SCHEME0
B3:00985D 12D19A            LCALL    ?L?COM00A1
B3:009860 E4                CLR      A
B3:009861 F0                MOVX     @DPTR,A
B3:009862 1176              ACALL    ?L?COM04AF
B3:009864 80ED              SJMP     ?C0117?ZW_SECURITY_SCHEME0
B3:009866         ?C0118?ZW_SECURITY_SCHEME0:
B3:009866 12B316            LCALL    ?L?COM0049
B3:009869 12D1BD            LCALL    ?L?COM0480
B3:00986C 121B29            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:00986F 90468E            MOV      DPTR,#sec0_isActivated
B3:009872 E0                MOVX     A,@DPTR
B3:009873 24FF              ADD      A,#0FFH
B3:009875 22                RET      
----- FUNCTION sec0_init (END) -------


----- FUNCTION ?L?COM04AF (BEGIN) -----
B3:009876 90468D            MOV      DPTR,#i
B3:009879 E0                MOVX     A,@DPTR
B3:00987A 04                INC      A
B3:00987B F0                MOVX     @DPTR,A
B3:00987C 22                RET      
----- FUNCTION ?L?COM04AF (END) -------


----- FUNCTION _ZCB_s2_evt_handler (BEGIN) -----
B3:00987D 904615            MOV      DPTR,#evt
B3:009880 122572            LCALL    ?C?PSTXDATA
B3:009883 904615            MOV      DPTR,#evt
B3:009886 122552            LCALL    ?C?PLDXDATA
B3:009889 1223D4            LCALL    ?C?LLDPTR
B3:00988C 1226A5            LCALL    ?C?LCASE
B3:00988F 992C              DW       ?C0012?ZW_S2_INCLUSION_GLUE
B3:009891 0000              DW       00H
B3:009893 0000              DW       00H
B3:009895 98AB              DW       ?C0005?ZW_S2_INCLUSION_GLUE
B3:009897 0000              DW       00H
B3:009899 0002              DW       02H
B3:00989B 98F2              DW       ?C0008?ZW_S2_INCLUSION_GLUE
B3:00989D 0000              DW       00H
B3:00989F 0004              DW       04H
B3:0098A1 9906              DW       ?C0010?ZW_S2_INCLUSION_GLUE
B3:0098A3 0000              DW       00H
B3:0098A5 0005              DW       05H
B3:0098A7 0000              DW       00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 738


B3:0098A9 992F              DW       ?C0014?ZW_S2_INCLUSION_GLUE
B3:0098AB         ?C0005?ZW_S2_INCLUSION_GLUE:
B3:0098AB E9                MOV      A,R1
B3:0098AC 2410              ADD      A,#010H
B3:0098AE 1252DD            LCALL    ?L?COM0009
B3:0098B1 D3                SETB     C
B3:0098B2 9400              SUBB     A,#00H
B3:0098B4 4010              JC       ?C0006?ZW_S2_INCLUSION_GLUE
B3:0098B6 E4                CLR      A
B3:0098B7 903F21            MOV      DPTR,#securityEventData
B3:0098BA F0                MOVX     @DPTR,A
B3:0098BB A3                INC      DPTR
B3:0098BC F0                MOVX     @DPTR,A
B3:0098BD 7B01              MOV      R3,#01H
B3:0098BF 7A3F              MOV      R2,#HIGH securityEventData
B3:0098C1 7921              MOV      R1,#LOW securityEventData
B3:0098C3 021E62            LJMP     ?INTERBANK_TABLE?_ApplicationSecurityEvent
B3:0098C6         ?C0006?ZW_S2_INCLUSION_GLUE:
B3:0098C6 3131              ACALL    ?L?COM0313
B3:0098C8 2413              ADD      A,#013H
B3:0098CA 1252DD            LCALL    ?L?COM0009
B3:0098CD 903F1D            MOV      DPTR,#challenge_response
B3:0098D0 3130              ACALL    ?L?COM0312
B3:0098D2 2414              ADD      A,#014H
B3:0098D4 1252DD            LCALL    ?L?COM0009
B3:0098D7 903F1E            MOV      DPTR,#challenge_response+01H
B3:0098DA 3130              ACALL    ?L?COM0312
B3:0098DC 2415              ADD      A,#015H
B3:0098DE 1252DD            LCALL    ?L?COM0009
B3:0098E1 903F1F            MOV      DPTR,#challenge_response+02H
B3:0098E4 3130              ACALL    ?L?COM0312
B3:0098E6 2416              ADD      A,#016H
B3:0098E8 1252DD            LCALL    ?L?COM0009
B3:0098EB 903F20            MOV      DPTR,#challenge_response+03H
B3:0098EE F0                MOVX     @DPTR,A
B3:0098EF 02B8A6            LJMP     s2_inclusion_set_txqueue_empty_event
B3:0098F2         ?C0008?ZW_S2_INCLUSION_GLUE:
B3:0098F2 1290B8            LCALL    sec0_unpersist_netkey
B3:0098F5 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B3:0098F8 12C0B2            LCALL    ?L?COM00C2
B3:0098FB 6032              JZ       ?C0014?ZW_S2_INCLUSION_GLUE
B3:0098FD 901221            MOV      DPTR,#nodeID
B3:009900 E0                MOVX     A,@DPTR
B3:009901 FD                MOV      R5,A
B3:009902 3139              ACALL    ?L?COM0385
B3:009904 801E              SJMP     ?C0019?ZW_S2_INCLUSION_GLUE
B3:009906         ?C0010?ZW_S2_INCLUSION_GLUE:
B3:009906 121A8E            LCALL    ?INTERBANK_TABLE?security_reset
B3:009909 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B3:00990C E0                MOVX     A,@DPTR
B3:00990D 7002              JNZ      ?C0018?ZW_S2_INCLUSION_GLUE
B3:00990F A3                INC      DPTR
B3:009910 E0                MOVX     A,@DPTR
B3:009911         ?C0018?ZW_S2_INCLUSION_GLUE:
B3:009911 6011              JZ       ?C0011?ZW_S2_INCLUSION_GLUE
B3:009913 7F02              MOV      R7,#02H
B3:009915 121A7A            LCALL    ?INTERBANK_TABLE?_secure_learn_set_errno
B3:009918 901221            MOV      DPTR,#nodeID
B3:00991B E0                MOVX     A,@DPTR
B3:00991C FD                MOV      R5,A
B3:00991D 126F84            LCALL    ?L?COM0408
B3:009920 F582              MOV      DPL,A
B3:009922 313B              ACALL    ?L?COM0386
B3:009924         ?C0011?ZW_S2_INCLUSION_GLUE:
B3:009924         
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 739


B3:009924 E4                CLR      A
B3:009925 9033A1            MOV      DPTR,#_secureLearnAppCbFunc
B3:009928 F0                MOVX     @DPTR,A
B3:009929 A3                INC      DPTR
B3:00992A F0                MOVX     @DPTR,A
B3:00992B 22                RET      
B3:00992C         ?C0012?ZW_S2_INCLUSION_GLUE:
B3:00992C 121A89            LCALL    ?INTERBANK_TABLE?security_learn_exit
B3:00992F         ?C0014?ZW_S2_INCLUSION_GLUE:
B3:00992F 22                RET      
----- FUNCTION _ZCB_s2_evt_handler (END) -------


----- FUNCTION ?L?COM0312 (BEGIN) -----
B3:009930 F0                MOVX     @DPTR,A
B3:009931         ?L?COM0313:
B3:009931 904615            MOV      DPTR,#evt
B3:009934 122552            LCALL    ?C?PLDXDATA
B3:009937 E9                MOV      A,R1
B3:009938 22                RET      
----- FUNCTION ?L?COM0312 (END) -------


----- FUNCTION ?L?COM0385 (BEGIN) -----
B3:009939 8F82              MOV      DPL,R7
B3:00993B         ?L?COM0386:
B3:00993B 8E83              MOV      DPH,R6
B3:00993D E4                CLR      A
B3:00993E FF                MOV      R7,A
B3:00993F 0226E3            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0385 (END) -------


----- FUNCTION receive (BEGIN) -----
B3:009942 903098            MOV      DPTR,#rcb+01EH
B3:009945 91A2              ACALL    ?L?COM0064
B3:009947 903F6B            MOV      DPTR,#byte1
B3:00994A F0                MOVX     @DPTR,A
B3:00994B 12B993            LCALL    ?L?COM00B6
B3:00994E 903F6C            MOV      DPTR,#byte2
B3:009951 F0                MOVX     @DPTR,A
B3:009952 12A627            LCALL    ?L?COM005E
B3:009955 903F6D            MOV      DPTR,#byte3
B3:009958 F0                MOVX     @DPTR,A
B3:009959 12BA9D            LCALL    ?L?COM049B
B3:00995C 903F6E            MOV      DPTR,#byte4
B3:00995F 12B377            LCALL    ?L?COM0114
B3:009962 A3                INC      DPTR
B3:009963 F0                MOVX     @DPTR,A
B3:009964 121F7C            LCALL    ?C?CLDPTR
B3:009967 6455              XRL      A,#055H
B3:009969 6002              JZ       $ + 4H
B3:00996B 8154              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:00996D         ?C0137?TRANSPORT_SERVICE2:
B3:00996D 903F6B            MOV      DPTR,#byte1
B3:009970 E0                MOVX     A,@DPTR
B3:009971 54F8              ANL      A,#0F8H
B3:009973 2438              ADD      A,#038H
B3:009975 7002              JNZ      $ + 4H
B3:009977 6152              AJMP     ?C0162?TRANSPORT_SERVICE2
B3:009979 24E8              ADD      A,#0E8H
B3:00997B 7002              JNZ      $ + 4H
B3:00997D 413B              AJMP     ?C0149?TRANSPORT_SERVICE2
B3:00997F 24F8              ADD      A,#0F8H
B3:009981 7002              JNZ      $ + 4H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 740


B3:009983 61AD              AJMP     ?C0168?TRANSPORT_SERVICE2
B3:009985 24F8              ADD      A,#0F8H
B3:009987 7002              JNZ      $ + 4H
B3:009989 8103              AJMP     ?C0175?TRANSPORT_SERVICE2
B3:00998B 2430              ADD      A,#030H
B3:00998D 6002              JZ       $ + 4H
B3:00998F 8154              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:009991         ?C0140?TRANSPORT_SERVICE2:
B3:009991 903073            MOV      DPTR,#flag_tie_broken
B3:009994 E0                MOVX     A,@DPTR
B3:009995 6003              JZ       ?C0141?TRANSPORT_SERVICE2
B3:009997 918D              ACALL    ?L?COM0364
B3:009999 F0                MOVX     @DPTR,A
B3:00999A         ?C0141?TRANSPORT_SERVICE2:
B3:00999A 90309B            MOV      DPTR,#rcb+021H
B3:00999D E0                MOVX     A,@DPTR
B3:00999E D3                SETB     C
B3:00999F 9406              SUBB     A,#06H
B3:0099A1 5002              JNC      ?C0142?TRANSPORT_SERVICE2
B3:0099A3 415E              AJMP     ?C0221?TRANSPORT_SERVICE2
B3:0099A5         ?C0142?TRANSPORT_SERVICE2:
B3:0099A5 9187              ACALL    ?L?COM0467
B3:0099A7 90309B            MOV      DPTR,#rcb+021H
B3:0099AA 12EBEA            LCALL    ?L?COM0135
B3:0099AD 12BED7            LCALL    ?L?COM0347
B3:0099B0 EF                MOV      A,R7
B3:0099B1 4E                ORL      A,R6
B3:0099B2 6002              JZ       ?C0143?TRANSPORT_SERVICE2
B3:0099B4         
B3:0099B4 415E              AJMP     ?C0221?TRANSPORT_SERVICE2
B3:0099B6         ?C0143?TRANSPORT_SERVICE2:
B3:0099B6 903F6D            MOV      DPTR,#byte3
B3:0099B9 917B              ACALL    ?L?COM0250
B3:0099BB 903096            MOV      DPTR,#rcb+01CH
B3:0099BE E0                MOVX     A,@DPTR
B3:0099BF FE                MOV      R6,A
B3:0099C0 6F                XRL      A,R7
B3:0099C1 6007              JZ       ?C0144?TRANSPORT_SERVICE2
B3:0099C3 EE                MOV      A,R6
B3:0099C4 6410              XRL      A,#010H
B3:0099C6 6002              JZ       ?C0144?TRANSPORT_SERVICE2
B3:0099C8 4191              AJMP     ?C0219?TRANSPORT_SERVICE2
B3:0099CA         ?C0144?TRANSPORT_SERVICE2:
B3:0099CA 12ED6A            LCALL    ?L?COM0117
B3:0099CD 12EE23            LCALL    ?L?COM0249
B3:0099D0 4002              JC       ?C0145?TRANSPORT_SERVICE2
B3:0099D2         
B3:0099D2 4191              AJMP     ?C0219?TRANSPORT_SERVICE2
B3:0099D4         ?C0145?TRANSPORT_SERVICE2:
B3:0099D4 12ED81            LCALL    ?L?COM0139
B3:0099D7 12B4DD            LCALL    ?L?COM0028
B3:0099DA 903F71            MOV      DPTR,#recvd_session_id
B3:0099DD E0                MOVX     A,@DPTR
B3:0099DE 903096            MOV      DPTR,#rcb+01CH
B3:0099E1 F0                MOVX     @DPTR,A
B3:0099E2 12ECED            LCALL    ?L?COM0333
B3:0099E5 E4                CLR      A
B3:0099E6 F0                MOVX     @DPTR,A
B3:0099E7 90309B            MOV      DPTR,#rcb+021H
B3:0099EA E0                MOVX     A,@DPTR
B3:0099EB 24FA              ADD      A,#0FAH
B3:0099ED 903196            MOV      DPTR,#rcb+011CH
B3:0099F0 F0                MOVX     @DPTR,A
B3:0099F1 12EEE8            LCALL    ?L?COM0442
B3:0099F4 CF                XCH      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 741


B3:0099F5 F0                MOVX     @DPTR,A
B3:0099F6 A3                INC      DPTR
B3:0099F7 EF                MOV      A,R7
B3:0099F8 F0                MOVX     @DPTR,A
B3:0099F9 90307A            MOV      DPTR,#rcb
B3:0099FC E0                MOVX     A,@DPTR
B3:0099FD 903198            MOV      DPTR,#rcb+011EH
B3:009A00 F0                MOVX     @DPTR,A
B3:009A01 903196            MOV      DPTR,#rcb+011CH
B3:009A04 E0                MOVX     A,@DPTR
B3:009A05 A3                INC      DPTR
B3:009A06 F0                MOVX     @DPTR,A
B3:009A07 FF                MOV      R7,A
B3:009A08 9187              ACALL    ?L?COM0467
B3:009A0A E9                MOV      A,R1
B3:009A0B 2404              ADD      A,#04H
B3:009A0D 128545            LCALL    ?L?COM0017
B3:009A10 12EABB            LCALL    ?L?COM03B1
B3:009A13 128195            LCALL    ___ZW_memcpy
B3:009A16 E4                CLR      A
B3:009A17 FF                MOV      R7,A
B3:009A18 FE                MOV      R6,A
B3:009A19 12D821            LCALL    _mark_frag_received
B3:009A1C EF                MOV      A,R7
B3:009A1D 6002              JZ       $ + 4H
B3:009A1F 8154              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:009A21         ?C0146?TRANSPORT_SERVICE2:
B3:009A21 903196            MOV      DPTR,#rcb+011CH
B3:009A24 E0                MOVX     A,@DPTR
B3:009A25 FF                MOV      R7,A
B3:009A26 9031A4            MOV      DPTR,#rcb+012AH
B3:009A29 E0                MOVX     A,@DPTR
B3:009A2A B4000C            CJNE     A,#00H,?C0147?TRANSPORT_SERVICE2
B3:009A2D A3                INC      DPTR
B3:009A2E E0                MOVX     A,@DPTR
B3:009A2F B50707            CJNE     A,AR7,?C0147?TRANSPORT_SERVICE2
B3:009A32 7F03              MOV      R7,#03H
B3:009A34 9155              ACALL    _t2_sm_post_event
B3:009A36 02B70D            LJMP     send_frag_complete_cmd
B3:009A39         ?C0147?TRANSPORT_SERVICE2:
B3:009A39         ?C0148?TRANSPORT_SERVICE2:
B3:009A39 614C              AJMP     ?C0220?TRANSPORT_SERVICE2
B3:009A3B         ?C0149?TRANSPORT_SERVICE2:
B3:009A3B 903073            MOV      DPTR,#flag_tie_broken
B3:009A3E E0                MOVX     A,@DPTR
B3:009A3F 6003              JZ       ?C0150?TRANSPORT_SERVICE2
B3:009A41 918D              ACALL    ?L?COM0364
B3:009A43 F0                MOVX     @DPTR,A
B3:009A44         ?C0150?TRANSPORT_SERVICE2:
B3:009A44 90309B            MOV      DPTR,#rcb+021H
B3:009A47 E0                MOVX     A,@DPTR
B3:009A48 D3                SETB     C
B3:009A49 9407              SUBB     A,#07H
B3:009A4B 5002              JNC      ?C0151?TRANSPORT_SERVICE2
B3:009A4D         
B3:009A4D 800F              SJMP     ?C0221?TRANSPORT_SERVICE2
B3:009A4F         ?C0151?TRANSPORT_SERVICE2:
B3:009A4F 9187              ACALL    ?L?COM0467
B3:009A51 90309B            MOV      DPTR,#rcb+021H
B3:009A54 12EBEA            LCALL    ?L?COM0135
B3:009A57 12BED7            LCALL    ?L?COM0347
B3:009A5A EF                MOV      A,R7
B3:009A5B 4E                ORL      A,R6
B3:009A5C 6004              JZ       ?C0152?TRANSPORT_SERVICE2
B3:009A5E         
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 742


B3:009A5E 7F01              MOV      R7,#01H
B3:009A60 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009A62         ?C0152?TRANSPORT_SERVICE2:
B3:009A62 903F6D            MOV      DPTR,#byte3
B3:009A65 E0                MOVX     A,@DPTR
B3:009A66 54F0              ANL      A,#0F0H
B3:009A68 C4                SWAP     A
B3:009A69 540F              ANL      A,#0FH
B3:009A6B 903F71            MOV      DPTR,#recvd_session_id
B3:009A6E F0                MOVX     @DPTR,A
B3:009A6F 12ECEC            LCALL    ?L?COM0332
B3:009A72 E0                MOVX     A,@DPTR
B3:009A73 B4010E            CJNE     A,#01H,?C0153?TRANSPORT_SERVICE2
B3:009A76 900AEB            MOV      DPTR,#current_state
B3:009A79 E0                MOVX     A,@DPTR
B3:009A7A 6401              XRL      A,#01H
B3:009A7C 6002              JZ       $ + 4H
B3:009A7E 8154              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:009A80 7F15              MOV      R7,#015H
B3:009A82         
B3:009A82 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009A84         ?C0153?TRANSPORT_SERVICE2:
B3:009A84 903096            MOV      DPTR,#rcb+01CH
B3:009A87 9198              ACALL    ?L?COM03D5
B3:009A89 6F                XRL      A,R7
B3:009A8A 6009              JZ       ?C0156?TRANSPORT_SERVICE2
B3:009A8C EF                MOV      A,R7
B3:009A8D 6410              XRL      A,#010H
B3:009A8F 6004              JZ       ?C0156?TRANSPORT_SERVICE2
B3:009A91         
B3:009A91 7F0D              MOV      R7,#0DH
B3:009A93         
B3:009A93 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009A95         ?C0156?TRANSPORT_SERVICE2:
B3:009A95 903F6D            MOV      DPTR,#byte3
B3:009A98 E0                MOVX     A,@DPTR
B3:009A99 5407              ANL      A,#07H
B3:009A9B FF                MOV      R7,A
B3:009A9C 903F6F            MOV      DPTR,#datagram_offset
B3:009A9F E4                CLR      A
B3:009AA0 F0                MOVX     @DPTR,A
B3:009AA1 A3                INC      DPTR
B3:009AA2 EF                MOV      A,R7
B3:009AA3 F0                MOVX     @DPTR,A
B3:009AA4 E0                MOVX     A,@DPTR
B3:009AA5 FE                MOV      R6,A
B3:009AA6 903F6E            MOV      DPTR,#byte4
B3:009AA9 E0                MOVX     A,@DPTR
B3:009AAA 7C00              MOV      R4,#00H
B3:009AAC 2400              ADD      A,#00H
B3:009AAE FF                MOV      R7,A
B3:009AAF EC                MOV      A,R4
B3:009AB0 3E                ADDC     A,R6
B3:009AB1 FE                MOV      R6,A
B3:009AB2 A3                INC      DPTR
B3:009AB3 F0                MOVX     @DPTR,A
B3:009AB4 A3                INC      DPTR
B3:009AB5 EF                MOV      A,R7
B3:009AB6 F0                MOVX     @DPTR,A
B3:009AB7 90309B            MOV      DPTR,#rcb+021H
B3:009ABA E0                MOVX     A,@DPTR
B3:009ABB 24F9              ADD      A,#0F9H
B3:009ABD 903196            MOV      DPTR,#rcb+011CH
B3:009AC0 F0                MOVX     @DPTR,A
B3:009AC1 2F                ADD      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 743


B3:009AC2 FF                MOV      R7,A
B3:009AC3 EC                MOV      A,R4
B3:009AC4 3E                ADDC     A,R6
B3:009AC5 FE                MOV      R6,A
B3:009AC6 12597C            LCALL    ?L?COM02D0
B3:009AC9 400E              JC       ?C0157?TRANSPORT_SERVICE2
B3:009ACB 900AEB            MOV      DPTR,#current_state
B3:009ACE E0                MOVX     A,@DPTR
B3:009ACF 6401              XRL      A,#01H
B3:009AD1 6002              JZ       $ + 4H
B3:009AD3 8154              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:009AD5 7F15              MOV      R7,#015H
B3:009AD7         
B3:009AD7 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009AD9         ?C0157?TRANSPORT_SERVICE2:
B3:009AD9 12ED6A            LCALL    ?L?COM0117
B3:009ADC 12EE23            LCALL    ?L?COM0249
B3:009ADF 4004              JC       ?C0159?TRANSPORT_SERVICE2
B3:009AE1 7F0D              MOV      R7,#0DH
B3:009AE3         
B3:009AE3 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009AE5         ?C0159?TRANSPORT_SERVICE2:
B3:009AE5 12ED81            LCALL    ?L?COM0139
B3:009AE8 12B4DD            LCALL    ?L?COM0028
B3:009AEB 12E059            LCALL    ?L?COM0540
B3:009AEE FF                MOV      R7,A
B3:009AEF 12D821            LCALL    _mark_frag_received
B3:009AF2 EF                MOV      A,R7
B3:009AF3 6002              JZ       $ + 4H
B3:009AF5 8154              AJMP     ?C0138?TRANSPORT_SERVICE2
B3:009AF7         ?C0160?TRANSPORT_SERVICE2:
B3:009AF7 12EEE8            LCALL    ?L?COM0442
B3:009AFA 12CB63            LCALL    ?L?COM0136
B3:009AFD 7A30              MOV      R2,#HIGH rcb+054H
B3:009AFF 79CE              MOV      R1,#LOW rcb+054H
;---- Variable 'curr_datagramData' assigned to Register 'R1/R2/R3' ----
B3:009B01 12E059            LCALL    ?L?COM0540
B3:009B04 29                ADD      A,R1
B3:009B05 F9                MOV      R1,A
B3:009B06 EE                MOV      A,R6
B3:009B07 3A                ADDC     A,R2
B3:009B08 FA                MOV      R2,A
B3:009B09 903196            MOV      DPTR,#rcb+011CH
B3:009B0C E0                MOVX     A,@DPTR
B3:009B0D FF                MOV      R7,A
B3:009B0E C003              PUSH     AR3
B3:009B10 C002              PUSH     AR2
B3:009B12 C001              PUSH     AR1
B3:009B14 903098            MOV      DPTR,#rcb+01EH
B3:009B17 125D40            LCALL    ?L?COM034F
B3:009B1A 128545            LCALL    ?L?COM0017
B3:009B1D D001              POP      AR1
B3:009B1F D002              POP      AR2
B3:009B21 D003              POP      AR3
B3:009B23 128195            LCALL    ___ZW_memcpy
B3:009B26 903196            MOV      DPTR,#rcb+011CH
B3:009B29 E0                MOVX     A,@DPTR
B3:009B2A FF                MOV      R7,A
B3:009B2B 903F70            MOV      DPTR,#datagram_offset+01H
B3:009B2E E0                MOVX     A,@DPTR
B3:009B2F 2F                ADD      A,R7
B3:009B30 FF                MOV      R7,A
B3:009B31 903F6F            MOV      DPTR,#datagram_offset
B3:009B34 E0                MOVX     A,@DPTR
B3:009B35 3400              ADDC     A,#00H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 744


B3:009B37 FE                MOV      R6,A
B3:009B38 D3                SETB     C
B3:009B39 9031A5            MOV      DPTR,#rcb+012BH
B3:009B3C E0                MOVX     A,@DPTR
B3:009B3D 9F                SUBB     A,R7
B3:009B3E 9031A4            MOV      DPTR,#rcb+012AH
B3:009B41 E0                MOVX     A,@DPTR
B3:009B42 9E                SUBB     A,R6
B3:009B43 5007              JNC      ?C0161?TRANSPORT_SERVICE2
B3:009B45 7F12              MOV      R7,#012H
B3:009B47 9155              ACALL    _t2_sm_post_event
B3:009B49 02B791            LJMP     find_missing
B3:009B4C         ?C0161?TRANSPORT_SERVICE2:
B3:009B4C         
B3:009B4C E4                CLR      A
B3:009B4D 9030BD            MOV      DPTR,#rcb+043H
B3:009B50 F0                MOVX     @DPTR,A
B3:009B51 22                RET      
B3:009B52         ?C0162?TRANSPORT_SERVICE2:
B3:009B52 9174              ACALL    ?L?COM024F
B3:009B54 9031D3            MOV      DPTR,#scb+02DH
B3:009B57 E0                MOVX     A,@DPTR
B3:009B58 B50704            CJNE     A,AR7,?C0163?TRANSPORT_SERVICE2
B3:009B5B 7F0F              MOV      R7,#0FH
B3:009B5D         
B3:009B5D 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009B5F         ?C0163?TRANSPORT_SERVICE2:
B3:009B5F 9195              ACALL    ?L?COM03D4
B3:009B61 6F                XRL      A,R7
B3:009B62 6004              JZ       ?C0164?TRANSPORT_SERVICE2
B3:009B64 7F0F              MOV      R7,#0FH
B3:009B66         
B3:009B66 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009B68         ?C0164?TRANSPORT_SERVICE2:
B3:009B68 12EEDD            LCALL    ?L?COM0441
B3:009B6B 600A              JZ       ?C0165?TRANSPORT_SERVICE2
B3:009B6D 903198            MOV      DPTR,#rcb+011EH
B3:009B70 E0                MOVX     A,@DPTR
B3:009B71 6004              JZ       ?C0165?TRANSPORT_SERVICE2
B3:009B73 7F10              MOV      R7,#010H
B3:009B75         
B3:009B75 810C              AJMP     ?C0233?TRANSPORT_SERVICE2
B3:009B77         ?C0165?TRANSPORT_SERVICE2:
B3:009B77 12ECD9            LCALL    ?L?COM02C6
B3:009B7A 903F6C            MOV      DPTR,#byte2
B3:009B7D E0                MOVX     A,@DPTR
B3:009B7E 5407              ANL      A,#07H
B3:009B80 7F00              MOV      R7,#00H
B3:009B82 FE                MOV      R6,A
B3:009B83 9031A8            MOV      DPTR,#scb+02H
B3:009B86 F0                MOVX     @DPTR,A
B3:009B87 A3                INC      DPTR
B3:009B88 EF                MOV      A,R7
B3:009B89 F0                MOVX     @DPTR,A
B3:009B8A 903F6D            MOV      DPTR,#byte3
B3:009B8D E0                MOVX     A,@DPTR
B3:009B8E FD                MOV      R5,A
B3:009B8F ED                MOV      A,R5
B3:009B90 FF                MOV      R7,A
B3:009B91 9031A8            MOV      DPTR,#scb+02H
B3:009B94 EE                MOV      A,R6
B3:009B95 F0                MOVX     @DPTR,A
B3:009B96 A3                INC      DPTR
B3:009B97 EF                MOV      A,R7
B3:009B98 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 745


B3:009B99 7F11              MOV      R7,#011H
B3:009B9B 12ECE4            LCALL    ?L?COM030E
B3:009B9E 6007              JZ       ?C0166?TRANSPORT_SERVICE2
B3:009BA0 903214            MOV      DPTR,#scb+06EH
B3:009BA3 7401              MOV      A,#01H
B3:009BA5 F0                MOVX     @DPTR,A
B3:009BA6 22                RET      
B3:009BA7         ?C0166?TRANSPORT_SERVICE2:
B3:009BA7 12B327            LCALL    ?L?COM004B
B3:009BAA 02B551            LJMP     _reply_frag_req
B3:009BAD         ?C0168?TRANSPORT_SERVICE2:
B3:009BAD 9174              ACALL    ?L?COM024F
B3:009BAF 9031D3            MOV      DPTR,#scb+02DH
B3:009BB2 E0                MOVX     A,@DPTR
B3:009BB3 B50704            CJNE     A,AR7,?C0169?TRANSPORT_SERVICE2
B3:009BB6 7F0F              MOV      R7,#0FH
B3:009BB8         
B3:009BB8 8052              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:009BBA         ?C0169?TRANSPORT_SERVICE2:
B3:009BBA 9195              ACALL    ?L?COM03D4
B3:009BBC 6F                XRL      A,R7
B3:009BBD 6004              JZ       ?C0170?TRANSPORT_SERVICE2
B3:009BBF 7F0F              MOV      R7,#0FH
B3:009BC1         
B3:009BC1 8049              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:009BC3         ?C0170?TRANSPORT_SERVICE2:
B3:009BC3 12EEDD            LCALL    ?L?COM0441
B3:009BC6 600A              JZ       ?C0171?TRANSPORT_SERVICE2
B3:009BC8 903198            MOV      DPTR,#rcb+011EH
B3:009BCB E0                MOVX     A,@DPTR
B3:009BCC 6004              JZ       ?C0171?TRANSPORT_SERVICE2
B3:009BCE 7F10              MOV      R7,#010H
B3:009BD0         
B3:009BD0 803A              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:009BD2         ?C0171?TRANSPORT_SERVICE2:
B3:009BD2 12ECD9            LCALL    ?L?COM02C6
B3:009BD5 903F71            MOV      DPTR,#recvd_session_id
B3:009BD8 E0                MOVX     A,@DPTR
B3:009BD9 FF                MOV      R7,A
B3:009BDA 9031CA            MOV      DPTR,#scb+024H
B3:009BDD E0                MOVX     A,@DPTR
B3:009BDE B5071E            CJNE     A,AR7,?C0174?TRANSPORT_SERVICE2
B3:009BE1 7404              MOV      A,#LOW scb+05EH
B3:009BE3 2F                ADD      A,R7
B3:009BE4 12DFB3            LCALL    ?L?COM01AF
B3:009BE7 7401              MOV      A,#01H
B3:009BE9 F0                MOVX     @DPTR,A
B3:009BEA E4                CLR      A
B3:009BEB 90321F            MOV      DPTR,#scb+079H
B3:009BEE F0                MOVX     @DPTR,A
B3:009BEF 9031B5            MOV      DPTR,#scb+0FH
B3:009BF2 12C0B2            LCALL    ?L?COM00C2
B3:009BF5 6008              JZ       ?C0174?TRANSPORT_SERVICE2
B3:009BF7 7B01              MOV      R3,#01H
B3:009BF9 7A31              MOV      R2,#HIGH scb+011H
B3:009BFB 79B7              MOV      R1,#LOW scb+011H
B3:009BFD 3139              ACALL    ?L?COM0385
B3:009BFF         ?C0174?TRANSPORT_SERVICE2:
B3:009BFF 7F22              MOV      R7,#022H
B3:009C01         
B3:009C01 8009              SJMP     ?C0233?TRANSPORT_SERVICE2
B3:009C03         ?C0175?TRANSPORT_SERVICE2:
B3:009C03 12DFAD            LCALL    ?L?COM01AE
B3:009C06 E0                MOVX     A,@DPTR
B3:009C07 B40104            CJNE     A,#01H,?C0176?TRANSPORT_SERVICE2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 746


B3:009C0A 7F15              MOV      R7,#015H
B3:009C0C         
B3:009C0C 8047              SJMP     _t2_sm_post_event
B3:009C0E         ?C0176?TRANSPORT_SERVICE2:
B3:009C0E 7F1B              MOV      R7,#01BH
B3:009C10 9155              ACALL    _t2_sm_post_event
B3:009C12 918D              ACALL    ?L?COM0364
B3:009C14 F0                MOVX     @DPTR,A
B3:009C15 7A3F              MOV      R2,#HIGH t
B3:009C17 7958              MOV      R1,#LOW t
B3:009C19 126EA7            LCALL    ?L?COM030B
B3:009C1C 7A3F              MOV      R2,#HIGH t
B3:009C1E 7958              MOV      R1,#LOW t
B3:009C20 7F02              MOV      R7,#02H
B3:009C22 12DB9B            LCALL    _ZCB_ts_senddata_cb
B3:009C25 903F6C            MOV      DPTR,#byte2
B3:009C28 E0                MOVX     A,@DPTR
B3:009C29 903097            MOV      DPTR,#rcb+01DH
B3:009C2C F0                MOVX     @DPTR,A
B3:009C2D E0                MOVX     A,@DPTR
B3:009C2E 75F064            MOV      B,#064H
B3:009C31 A4                MUL      AB
B3:009C32 2464              ADD      A,#064H
B3:009C34 FF                MOV      R7,A
B3:009C35 E4                CLR      A
B3:009C36 35F0              ADDC     A,B
B3:009C38 FE                MOV      R6,A
B3:009C39 E4                CLR      A
B3:009C3A FC                MOV      R4,A
B3:009C3B FD                MOV      R5,A
B3:009C3C 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:009C3F 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_wait_restart_from_first
B3:009C41 F0                MOVX     @DPTR,A
B3:009C42 A3                INC      DPTR
B3:009C43 74B8              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_wait_restart_from_first
B3:009C45 12B326            LCALL    ?L?COM004A
B3:009C48 A3                INC      DPTR
B3:009C49 122572            LCALL    ?C?PSTXDATA
B3:009C4C 0B                INC      R3
B3:009C4D 7A31              MOV      R2,#HIGH scb+03EH
B3:009C4F 79E4              MOV      R1,#LOW scb+03EH
B3:009C51 121B29            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:009C54         ?C0138?TRANSPORT_SERVICE2:
B3:009C54 22                RET      
----- FUNCTION receive (END) -------


----- FUNCTION _t2_sm_post_event (BEGIN) -----
;---- Variable 'ev' assigned to Register 'R6' ----
B3:009C55 AE07              MOV      R6,AR7
B3:009C57 900AEB            MOV      DPTR,#current_state
B3:009C5A E0                MOVX     A,@DPTR
B3:009C5B FF                MOV      R7,A
B3:009C5C AD06              MOV      R5,AR6
B3:009C5E 12EC6A            LCALL    _find_transition
;---- Variable 'i' assigned to Register 'R7' ----
B3:009C61 EF                MOV      A,R7
B3:009C62 600F              JZ       ?C0007?TRANSPORT2_FSM
B3:009C64 75F006            MOV      B,#06H
B3:009C67 902E44            MOV      DPTR,#trans-04H
B3:009C6A 122546            LCALL    ?C?OFFXADD
B3:009C6D E4                CLR      A
B3:009C6E 93                MOVC     A,@A+DPTR
B3:009C6F 900AEB            MOV      DPTR,#current_state
B3:009C72 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 747


B3:009C73         ?C0007?TRANSPORT2_FSM:
B3:009C73 22                RET      
----- FUNCTION _t2_sm_post_event (END) -------


----- FUNCTION ?L?COM024F (BEGIN) -----
B3:009C74 7F16              MOV      R7,#016H
B3:009C76 9155              ACALL    _t2_sm_post_event
B3:009C78 903F6C            MOV      DPTR,#byte2
B3:009C7B         ?L?COM0250:
B3:009C7B E0                MOVX     A,@DPTR
B3:009C7C 54F0              ANL      A,#0F0H
B3:009C7E C4                SWAP     A
B3:009C7F 540F              ANL      A,#0FH
B3:009C81 FF                MOV      R7,A
B3:009C82 903F71            MOV      DPTR,#recvd_session_id
B3:009C85 F0                MOVX     @DPTR,A
B3:009C86 22                RET      
----- FUNCTION ?L?COM024F (END) -------


----- FUNCTION ?L?COM0467 (BEGIN) -----
B3:009C87 903098            MOV      DPTR,#rcb+01EH
B3:009C8A 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0467 (END) -------


----- FUNCTION ?L?COM0364 (BEGIN) -----
B3:009C8D 9031CA            MOV      DPTR,#scb+024H
B3:009C90 E0                MOVX     A,@DPTR
B3:009C91 9031D3            MOV      DPTR,#scb+02DH
B3:009C94 22                RET      
----- FUNCTION ?L?COM0364 (END) -------


----- FUNCTION ?L?COM03D4 (BEGIN) -----
B3:009C95 9031CA            MOV      DPTR,#scb+024H
B3:009C98         ?L?COM03D5:
B3:009C98 E0                MOVX     A,@DPTR
B3:009C99 FF                MOV      R7,A
B3:009C9A 903F71            MOV      DPTR,#recvd_session_id
B3:009C9D E0                MOVX     A,@DPTR
B3:009C9E 22                RET      
----- FUNCTION ?L?COM03D4 (END) -------


----- FUNCTION ?L?COM0063 (BEGIN) -----
B3:009C9F 9028DB            MOV      DPTR,#the_context+0D7H
B3:009CA2         ?L?COM0064:
B3:009CA2 122552            LCALL    ?C?PLDXDATA
B3:009CA5         ?L?COM0065:
B3:009CA5 900001            MOV      DPTR,#01H
B3:009CA8 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM0063 (END) -------


----- FUNCTION ___S2_decrypt_msg (BEGIN) -----
B3:009CAB 9036B7            MOV      DPTR,#conn
B3:009CAE 122572            LCALL    ?C?PSTXDATA
B3:009CB1 903726            MOV      DPTR,#hdr_len
B3:009CB4 12BB12            LCALL    ?L?COM04A2
B3:009CB7 E4                CLR      A
B3:009CB8 903720            MOV      DPTR,#decrypt_len
B3:009CBB F0                MOVX     @DPTR,A
B3:009CBC A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 748


B3:009CBD F0                MOVX     @DPTR,A
B3:009CBE FB                MOV      R3,A
B3:009CBF FA                MOV      R2,A
B3:009CC0 F9                MOV      R1,A
B3:009CC1 C003              PUSH     AR3
B3:009CC3 C002              PUSH     AR2
B3:009CC5 C001              PUSH     AR1
B3:009CC7 9036BF            MOV      DPTR,#plain_text
B3:009CCA 122552            LCALL    ?C?PLDXDATA
B3:009CCD 1225A7            LCALL    ?C?PSTPTR
B3:009CD0 9036C2            MOV      DPTR,#plain_text_len
B3:009CD3 122552            LCALL    ?C?PLDXDATA
B3:009CD6 E4                CLR      A
B3:009CD7 F5F0              MOV      B,A
B3:009CD9 1221E8            LCALL    ?C?ISTPTR
B3:009CDC 9036BA            MOV      DPTR,#msg
B3:009CDF 12A624            LCALL    ?L?COM005D
B3:009CE2 90371A            MOV      DPTR,#flags
B3:009CE5 F0                MOVX     @DPTR,A
B3:009CE6 7404              MOV      A,#04H
B3:009CE8 2408              ADD      A,#08H
B3:009CEA FF                MOV      R7,A
B3:009CEB E4                CLR      A
B3:009CEC 33                RLC      A
B3:009CED 12EEC2            LCALL    ?L?COM03D9
B3:009CF0 5003              JNC      $ + 5H
B3:009CF2 02A1B8            LJMP     parse_fail?S2
B3:009CF5         ?C0092?S2:
B3:009CF5 12B327            LCALL    ?L?COM004B
B3:009CF8 12ECFA            LCALL    ?L?COM03D8
B3:009CFB 12A621            LCALL    ?L?COM005C
B3:009CFE 30E005            JNB      ACC.0,?C0094?S2
B3:009D01 12B327            LCALL    ?L?COM004B
B3:009D04 801D              SJMP     ?C0276?S2
B3:009D06         ?C0094?S2:
B3:009D06 9036BA            MOV      DPTR,#msg
B3:009D09 12B990            LCALL    ?L?COM00B5
B3:009D0C FD                MOV      R5,A
B3:009D0D 9036B7            MOV      DPTR,#conn
B3:009D10 122552            LCALL    ?C?PLDXDATA
B3:009D13 12AC7A            LCALL    ___S2_verify_seq
B3:009D16 EF                MOV      A,R7
B3:009D17 4E                ORL      A,R6
B3:009D18 7003              JNZ      ?C0096?S2
B3:009D1A 7F03              MOV      R7,#03H
B3:009D1C 22                RET      
B3:009D1D         ?C0096?S2:
B3:009D1D 9036B7            MOV      DPTR,#conn
B3:009D20 12EE7F            LCALL    ?L?COM0368
B3:009D23         
B3:009D23 903728            MOV      DPTR,#span
B3:009D26 122572            LCALL    ?C?PSTXDATA
B3:009D29         ?C0095?S2:
B3:009D29 90371A            MOV      DPTR,#flags
B3:009D2C E0                MOVX     A,@DPTR
B3:009D2D 20E002            JB       ACC.0,$ + 5H
B3:009D30 C134              AJMP     ?C0098?S2
B3:009D32 9036BA            MOV      DPTR,#msg
B3:009D35 125D35            LCALL    ?L?COM00E4
B3:009D38 903722            MOV      DPTR,#ext_data
B3:009D3B 122572            LCALL    ?C?PSTXDATA
B3:009D3E         ?C0101?S2:
B3:009D3E 903722            MOV      DPTR,#ext_data
B3:009D41 12A3E6            LCALL    ?L?COM0077
B3:009D44 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 749


B3:009D45 903725            MOV      DPTR,#ext_len
B3:009D48 F0                MOVX     @DPTR,A
B3:009D49 A3                INC      DPTR
B3:009D4A 12EBE4            LCALL    ?L?COM0208
B3:009D4D 903727            MOV      DPTR,#hdr_len+01H
B3:009D50 E0                MOVX     A,@DPTR
B3:009D51 2408              ADD      A,#08H
B3:009D53 FF                MOV      R7,A
B3:009D54 903726            MOV      DPTR,#hdr_len
B3:009D57 E0                MOVX     A,@DPTR
B3:009D58 3400              ADDC     A,#00H
B3:009D5A 12EEC2            LCALL    ?L?COM03D9
B3:009D5D 5003              JNC      $ + 5H
B3:009D5F 02A1B8            LJMP     parse_fail?S2
B3:009D62 903725            MOV      DPTR,#ext_len
B3:009D65 E0                MOVX     A,@DPTR
B3:009D66 FF                MOV      R7,A
B3:009D67 7003              JNZ      $ + 5H
B3:009D69 02A1B8            LJMP     parse_fail?S2
B3:009D6C         ?C0102?S2:
B3:009D6C 91A5              ACALL    ?L?COM0065
B3:009D6E 543F              ANL      A,#03FH
B3:009D70 24FD              ADD      A,#0FDH
B3:009D72 6068              JZ       ?C0107?S2
B3:009D74 14                DEC      A
B3:009D75 7002              JNZ      $ + 4H
B3:009D77 C103              AJMP     ?C0111?S2
B3:009D79 2403              ADD      A,#03H
B3:009D7B 6002              JZ       $ + 4H
B3:009D7D C11C              AJMP     ?C0113?S2
B3:009D7F         ?C0105?S2:
B3:009D7F 903728            MOV      DPTR,#span
B3:009D82 12A1F7            LCALL    ?L?COM01C7
B3:009D85 7002              JNZ      $ + 4H
B3:009D87 C127              AJMP     ?C0104?S2
B3:009D89 12A225            LCALL    ?L?COM017F
B3:009D8C 121FB9            LCALL    ?C?CLDOPTR
B3:009D8F 6403              XRL      A,#03H
B3:009D91 6002              JZ       $ + 4H
B3:009D93 C127              AJMP     ?C0104?S2
B3:009D95 EF                MOV      A,R7
B3:009D96 6412              XRL      A,#012H
B3:009D98 6002              JZ       $ + 4H
B3:009D9A C127              AJMP     ?C0104?S2
B3:009D9C 903722            MOV      DPTR,#ext_data
B3:009D9F 12858F            LCALL    ?L?COM00AA
B3:009DA2 783E              MOV      R0,#LOW s_nonce
B3:009DA4 7C37              MOV      R4,#HIGH s_nonce
B3:009DA6 7D01              MOV      R5,#01H
B3:009DA8 12D728            LCALL    ?L?COM0197
B3:009DAB 782E              MOV      R0,#LOW r_nonce
B3:009DAD 7C37              MOV      R4,#HIGH r_nonce
B3:009DAF 7D01              MOV      R5,#01H
B3:009DB1 903728            MOV      DPTR,#span
B3:009DB4 12D725            LCALL    ?L?COM0196
B3:009DB7 12A225            LCALL    ?L?COM017F
B3:009DBA 7405              MOV      A,#05H
B3:009DBC 12204D            LCALL    ?C?CSTOPTR
B3:009DBF C003              PUSH     AR3
B3:009DC1 C002              PUSH     AR2
B3:009DC3 C001              PUSH     AR1
B3:009DC5 12C46E            LCALL    ?L?COM00D6
B3:009DC8 75F040            MOV      B,#040H
B3:009DCB A4                MUL      AB
B3:009DCC 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 750


B3:009DCE 12ED5C            LCALL    ?L?COM0270
B3:009DD1 D001              POP      AR1
B3:009DD3 D002              POP      AR2
B3:009DD5 D003              POP      AR3
B3:009DD7 121B56            LCALL    ?INTERBANK_TABLE?_next_nonce_instantiate
B3:009DDA 804B              SJMP     ?C0104?S2
B3:009DDC         ?C0107?S2:
B3:009DDC 903725            MOV      DPTR,#ext_len
B3:009DDF E0                MOVX     A,@DPTR
B3:009DE0 6403              XRL      A,#03H
B3:009DE2 6003              JZ       $ + 5H
B3:009DE4 02A1B8            LJMP     parse_fail?S2
B3:009DE7         ?C0108?S2:
B3:009DE7 9036B7            MOV      DPTR,#conn
B3:009DEA 91A2              ACALL    ?L?COM0064
B3:009DEC FF                MOV      R7,A
B3:009DED 903722            MOV      DPTR,#ext_data
B3:009DF0 12B990            LCALL    ?L?COM00B5
B3:009DF3 FD                MOV      R5,A
B3:009DF4 12A621            LCALL    ?L?COM005C
B3:009DF7 7B00              MOV      R3,#00H
B3:009DF9 20E002            JB       ACC.0,?C0109?S2
B3:009DFC 7B01              MOV      R3,#01H
B3:009DFE         ?C0109?S2:
B3:009DFE         ?C0110?S2:
B3:009DFE 12ECF7            LCALL    ?L?COM03D7
B3:009E01 8024              SJMP     ?C0104?S2
B3:009E03         ?C0111?S2:
B3:009E03 903725            MOV      DPTR,#ext_len
B3:009E06 E0                MOVX     A,@DPTR
B3:009E07 6402              XRL      A,#02H
B3:009E09 6003              JZ       $ + 5H
B3:009E0B 02A1B8            LJMP     parse_fail?S2
B3:009E0E         ?C0112?S2:
B3:009E0E 9036B7            MOV      DPTR,#conn
B3:009E11 91A2              ACALL    ?L?COM0064
B3:009E13 FD                MOV      R5,A
B3:009E14 12C445            LCALL    ?L?COM02DF
B3:009E17 12E88D            LCALL    _S2_set_node_mos
B3:009E1A 800B              SJMP     ?C0104?S2
B3:009E1C         ?C0113?S2:
B3:009E1C 903722            MOV      DPTR,#ext_data
B3:009E1F 91A2              ACALL    ?L?COM0064
B3:009E21 30E603            JNB      ACC.6,$ + 6H
B3:009E24 02A1B8            LJMP     parse_fail?S2
B3:009E27         ?C0114?S2:
B3:009E27         ?C0104?S2:
B3:009E27 903722            MOV      DPTR,#ext_data
B3:009E2A 91A2              ACALL    ?L?COM0064
B3:009E2C 30E705            JNB      ACC.7,?C0098?S2
B3:009E2F 12EBDC            LCALL    ?L?COM0207
B3:009E32 A13E              AJMP     ?C0101?S2
B3:009E34         ?C0098?S2:
B3:009E34 12A621            LCALL    ?L?COM005C
B3:009E37 30E025            JNB      ACC.0,?C0117?S2
B3:009E3A 90372B            MOV      DPTR,#mpan
B3:009E3D 122552            LCALL    ?C?PLDXDATA
B3:009E40 E9                MOV      A,R1
B3:009E41 4A                ORL      A,R2
B3:009E42 7003              JNZ      $ + 5H
B3:009E44 02A1BB            LJMP     auth_fail?S2
B3:009E47 900013            MOV      DPTR,#013H
B3:009E4A 121FB9            LCALL    ?C?CLDOPTR
B3:009E4D 6401              XRL      A,#01H
B3:009E4F 6003              JZ       $ + 5H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 751


B3:009E51 02A1BB            LJMP     auth_fail?S2
B3:009E54         ?C0118?S2:
B3:009E54 91A5              ACALL    ?L?COM0065
B3:009E56 FF                MOV      R7,A
B3:009E57 9036B7            MOV      DPTR,#conn
B3:009E5A 1256DF            LCALL    ?L?COM0125
B3:009E5D 8013              SJMP     ?C0121?S2
B3:009E5F         ?C0117?S2:
B3:009E5F 12A225            LCALL    ?L?COM017F
B3:009E62 121FB9            LCALL    ?C?CLDOPTR
B3:009E65 FF                MOV      R7,A
B3:009E66 6406              XRL      A,#06H
B3:009E68 6008              JZ       ?C0121?S2
B3:009E6A EF                MOV      A,R7
B3:009E6B 6405              XRL      A,#05H
B3:009E6D 6003              JZ       $ + 5H
B3:009E6F 02A1BB            LJMP     auth_fail?S2
B3:009E72         ?C0122?S2:
B3:009E72         ?C0121?S2:
B3:009E72 9036BA            MOV      DPTR,#msg
B3:009E75 122552            LCALL    ?C?PLDXDATA
B3:009E78 903726            MOV      DPTR,#hdr_len
B3:009E7B E0                MOVX     A,@DPTR
B3:009E7C FE                MOV      R6,A
B3:009E7D A3                INC      DPTR
B3:009E7E E0                MOVX     A,@DPTR
B3:009E7F FF                MOV      R7,A
B3:009E80 29                ADD      A,R1
B3:009E81 F9                MOV      R1,A
B3:009E82 EA                MOV      A,R2
B3:009E83 3E                ADDC     A,R6
B3:009E84 FA                MOV      R2,A
B3:009E85 90371B            MOV      DPTR,#ciphertext
B3:009E88 122572            LCALL    ?C?PSTXDATA
B3:009E8B C3                CLR      C
B3:009E8C 9036BE            MOV      DPTR,#msg_len+01H
B3:009E8F E0                MOVX     A,@DPTR
B3:009E90 9F                SUBB     A,R7
B3:009E91 FF                MOV      R7,A
B3:009E92 9036BD            MOV      DPTR,#msg_len
B3:009E95 E0                MOVX     A,@DPTR
B3:009E96 9E                SUBB     A,R6
B3:009E97 90371E            MOV      DPTR,#ciphertext_len
B3:009E9A 12CB64            LCALL    ?L?COM0137
B3:009E9D 7A36              MOV      R2,#HIGH aad_buf
B3:009E9F 79C5              MOV      R1,#LOW aad_buf
B3:009EA1 903715            MOV      DPTR,#aad
B3:009EA4 122572            LCALL    ?C?PSTXDATA
B3:009EA7 9036B7            MOV      DPTR,#conn
B3:009EAA 91A2              ACALL    ?L?COM0064
B3:009EAC FF                MOV      R7,A
B3:009EAD 121F7C            LCALL    ?C?CLDPTR
B3:009EB0 903726            MOV      DPTR,#hdr_len
B3:009EB3 12EE02            LCALL    ?L?COM0311
B3:009EB6 9036BD            MOV      DPTR,#msg_len
B3:009EB9 E0                MOVX     A,@DPTR
B3:009EBA FB                MOV      R3,A
B3:009EBB A3                INC      DPTR
B3:009EBC E0                MOVX     A,@DPTR
B3:009EBD 904190            MOV      DPTR,#?___S2_make_aad?BYTE+07H
B3:009EC0 CB                XCH      A,R3
B3:009EC1 F0                MOVX     @DPTR,A
B3:009EC2 A3                INC      DPTR
B3:009EC3 EB                MOV      A,R3
B3:009EC4 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 752


B3:009EC5 903715            MOV      DPTR,#aad
B3:009EC8 122552            LCALL    ?C?PLDXDATA
B3:009ECB 904192            MOV      DPTR,#?___S2_make_aad?BYTE+09H
B3:009ECE 12D5C5            LCALL    ?L?COM0254
B3:009ED1 9036BA            MOV      DPTR,#msg
B3:009ED4 122552            LCALL    ?C?PLDXDATA
B3:009ED7 12E8E7            LCALL    ___S2_make_aad
B3:009EDA 903718            MOV      DPTR,#aad_len
B3:009EDD EE                MOV      A,R6
B3:009EDE F0                MOVX     @DPTR,A
B3:009EDF A3                INC      DPTR
B3:009EE0 EF                MOV      A,R7
B3:009EE1 F0                MOVX     @DPTR,A
B3:009EE2 903728            MOV      DPTR,#span
B3:009EE5 12A1F7            LCALL    ?L?COM01C7
B3:009EE8 7003              JNZ      $ + 5H
B3:009EEA 02A036            LJMP     ?C0123?S2
B3:009EED 902A11            MOV      DPTR,#the_context+020DH
B3:009EF0 E0                MOVX     A,@DPTR
B3:009EF1 7019              JNZ      ?C0124?S2
B3:009EF3 12A225            LCALL    ?L?COM017F
B3:009EF6 121FB9            LCALL    ?C?CLDOPTR
B3:009EF9 B40510            CJNE     A,#05H,?C0124?S2
B3:009EFC 12ED28            LCALL    ?L?COM053C
B3:009EFF FF                MOV      R7,A
B3:009F00 7815              MOV      R0,#LOW the_context+0211H
B3:009F02 7C2A              MOV      R4,#HIGH the_context+0211H
B3:009F04 7D01              MOV      R5,#01H
B3:009F06 90371B            MOV      DPTR,#ciphertext
B3:009F09 12D59E            LCALL    ?L?COM022A
B3:009F0C         ?C0124?S2:
B3:009F0C E4                CLR      A
B3:009F0D 90374E            MOV      DPTR,#i
B3:009F10 F0                MOVX     @DPTR,A
B3:009F11         ?C0125?S2:
B3:009F11 12C484            LCALL    ?L?COM00D7
B3:009F14 126D9E            LCALL    ?L?COM016A
B3:009F17 8005              SJMP     ?C0268?S2
B3:009F19         ?C0267?S2:
B3:009F19 C3                CLR      C
B3:009F1A 33                RLC      A
B3:009F1B CE                XCH      A,R6
B3:009F1C 33                RLC      A
B3:009F1D CE                XCH      A,R6
B3:009F1E         ?C0268?S2:
B3:009F1E D8F9              DJNZ     R0,?C0267?S2
B3:009F20 12EF2F            LCALL    ?L?COM0500
B3:009F23 7002              JNZ      $ + 4H
B3:009F25 E1CE              AJMP     ?C0128?S2
B3:009F27 C003              PUSH     AR3
B3:009F29 C002              PUSH     AR2
B3:009F2B C001              PUSH     AR1
B3:009F2D 9044AC            MOV      DPTR,#?_next_nonce_generate?BYTE+03H
B3:009F30 12ED30            LCALL    ?L?COM0186
B3:009F33 D001              POP      AR1
B3:009F35 D002              POP      AR2
B3:009F37 D003              POP      AR3
B3:009F39 121B5B            LCALL    ?INTERBANK_TABLE?_next_nonce_generate
B3:009F3C 12C484            LCALL    ?L?COM00D7
B3:009F3F 12D5B3            LCALL    ?L?COM01B1
B3:009F42 C003              PUSH     AR3
B3:009F44 C002              PUSH     AR2
B3:009F46 C001              PUSH     AR1
B3:009F48 12E3F2            LCALL    ?L?COM0095
B3:009F4B FD                MOV      R5,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 753


B3:009F4C 903BC8            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+010H
B3:009F4F 1224BA            LCALL    ?C?LSTXDATA
B3:009F52 D001              POP      AR1
B3:009F54 D002              POP      AR2
B3:009F56 D003              POP      AR3
B3:009F58 121B38            LCALL    ?INTERBANK_TABLE?_CCM_decrypt_and_auth
B3:009F5B 903720            MOV      DPTR,#decrypt_len
B3:009F5E 126F4A            LCALL    ?L?COM03D3
B3:009F61 606B              JZ       ?C0128?S2
B3:009F63 12A225            LCALL    ?L?COM017F
B3:009F66 7406              MOV      A,#06H
B3:009F68 12204D            LCALL    ?C?CSTOPTR
B3:009F6B 12C48A            LCALL    ?L?COM00D9
B3:009F6E FF                MOV      R7,A
B3:009F6F 9036B7            MOV      DPTR,#conn
B3:009F72 12E6DA            LCALL    ?L?COM03C2
B3:009F75 EF                MOV      A,R7
B3:009F76 12204D            LCALL    ?C?CSTOPTR
B3:009F79 12A1F4            LCALL    ?L?COM01C6
B3:009F7C 7003              JNZ      $ + 5H
B3:009F7E 02A09E            LJMP     ?C0136?S2
B3:009F81 9036B7            MOV      DPTR,#conn
B3:009F84 122552            LCALL    ?C?PLDXDATA
B3:009F87 E9                MOV      A,R1
B3:009F88 2403              ADD      A,#03H
B3:009F8A 1252DD            LCALL    ?L?COM0009
B3:009F8D 4402              ORL      A,#02H
B3:009F8F 12203B            LCALL    ?C?CSTPTR
B3:009F92 12ED00            LCALL    ?L?COM0367
B3:009F95 121FB9            LCALL    ?C?CLDOPTR
B3:009F98 B40227            CJNE     A,#02H,?C0131?S2
B3:009F9B 9036B7            MOV      DPTR,#conn
B3:009F9E 122552            LCALL    ?C?PLDXDATA
B3:009FA1 90374F            MOV      DPTR,#e
B3:009FA4 122572            LCALL    ?C?PSTXDATA
B3:009FA7 90372B            MOV      DPTR,#mpan
B3:009FAA 122552            LCALL    ?C?PLDXDATA
B3:009FAD AF01              MOV      R7,AR1
B3:009FAF 9028E2            MOV      DPTR,#the_context+0DEH
B3:009FB2 EA                MOV      A,R2
B3:009FB3 12CB64            LCALL    ?L?COM0137
B3:009FB6 7A37              MOV      R2,#HIGH e
B3:009FB8 794F              MOV      R1,#LOW e
B3:009FBA 7F07              MOV      R7,#07H
B3:009FBC 128CD5            LCALL    ___S2_fsm_post_event
B3:009FBF 02A09E            LJMP     ?C0136?S2
B3:009FC2         ?C0131?S2:
B3:009FC2 90372B            MOV      DPTR,#mpan
B3:009FC5 126EC6            LCALL    ?L?COM0353
B3:009FC8 12D5E8            LCALL    _next_mpan_state
B3:009FCB 02A09E            LJMP     ?C0136?S2
B3:009FCE         ?C0128?S2:
B3:009FCE 902A11            MOV      DPTR,#the_context+020DH
B3:009FD1 E0                MOVX     A,@DPTR
B3:009FD2 6003              JZ       $ + 5H
B3:009FD4 02A1BB            LJMP     auth_fail?S2
B3:009FD7 12A225            LCALL    ?L?COM017F
B3:009FDA 121FB9            LCALL    ?C?CLDOPTR
B3:009FDD 6406              XRL      A,#06H
B3:009FDF 7003              JNZ      $ + 5H
B3:009FE1 02A1BB            LJMP     auth_fail?S2
B3:009FE4         ?C0133?S2:
B3:009FE4 900025            MOV      DPTR,#025H
B3:009FE7 7401              MOV      A,#01H
B3:009FE9 122008            LCALL    ?C?CILDOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 754


B3:009FEC 12C48A            LCALL    ?L?COM00D9
B3:009FEF C3                CLR      C
B3:009FF0 9403              SUBB     A,#03H
B3:009FF2 4009              JC       ?C0135?S2
B3:009FF4 903728            MOV      DPTR,#span
B3:009FF7 122552            LCALL    ?C?PLDXDATA
B3:009FFA 12ED21            LCALL    ?L?COM055A
B3:009FFD         ?C0135?S2:
B3:009FFD 12ED28            LCALL    ?L?COM053C
B3:00A000 FF                MOV      R7,A
B3:00A001 90371B            MOV      DPTR,#ciphertext
B3:00A004 12ED39            LCALL    ?L?COM02D5
B3:00A007 7B01              MOV      R3,#01H
B3:00A009 7A2A              MOV      R2,#HIGH the_context+0211H
B3:00A00B 7915              MOV      R1,#LOW the_context+0211H
B3:00A00D 121F56            LCALL    ?C?COPY
B3:00A010 12C46E            LCALL    ?L?COM00D6
B3:00A013 75F040            MOV      B,#040H
B3:00A016 A4                MUL      AB
B3:00A017 7B01              MOV      R3,#01H
B3:00A019 12ED5C            LCALL    ?L?COM0270
B3:00A01C 903728            MOV      DPTR,#span
B3:00A01F 122552            LCALL    ?C?PLDXDATA
B3:00A022 121B56            LCALL    ?INTERBANK_TABLE?_next_nonce_instantiate
B3:00A025 90374E            MOV      DPTR,#i
B3:00A028 E0                MOVX     A,@DPTR
B3:00A029 04                INC      A
B3:00A02A F0                MOVX     @DPTR,A
B3:00A02B E0                MOVX     A,@DPTR
B3:00A02C C3                CLR      C
B3:00A02D 9403              SUBB     A,#03H
B3:00A02F 5003              JNC      $ + 5H
B3:00A031 029F11            LJMP     ?C0125?S2
B3:00A034 8068              SJMP     ?C0136?S2
B3:00A036         ?C0123?S2:
B3:00A036 71D9              ACALL    ?L?COM02E0
B3:00A038 121FB9            LCALL    ?C?CLDOPTR
B3:00A03B 12D5A4            LCALL    ?L?COM03A0
B3:00A03E FA                MOV      R2,A
B3:00A03F C003              PUSH     AR3
B3:00A041 C002              PUSH     AR2
B3:00A043 C001              PUSH     AR1
B3:00A045 90372B            MOV      DPTR,#mpan
B3:00A048 12858F            LCALL    ?L?COM00AA
B3:00A04B 12CBB7            LCALL    ?L?COM03C4
B3:00A04E 904307            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B3:00A051 12ED30            LCALL    ?L?COM0186
B3:00A054 D001              POP      AR1
B3:00A056 D002              POP      AR2
B3:00A058 D003              POP      AR3
B3:00A05A D1D7              ACALL    _ZW_AES_ecb
B3:00A05C 90372B            MOV      DPTR,#mpan
B3:00A05F 126EC6            LCALL    ?L?COM0353
B3:00A062 12D5E8            LCALL    _next_mpan_state
B3:00A065 71D9              ACALL    ?L?COM02E0
B3:00A067 121FB9            LCALL    ?C?CLDOPTR
B3:00A06A 12D5B3            LCALL    ?L?COM01B1
B3:00A06D C003              PUSH     AR3
B3:00A06F C002              PUSH     AR2
B3:00A071 C001              PUSH     AR1
B3:00A073 12E3F2            LCALL    ?L?COM0095
B3:00A076 FD                MOV      R5,A
B3:00A077 903BC8            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+010H
B3:00A07A 1224BA            LCALL    ?C?LSTXDATA
B3:00A07D D001              POP      AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 755


B3:00A07F D002              POP      AR2
B3:00A081 D003              POP      AR3
B3:00A083 121B38            LCALL    ?INTERBANK_TABLE?_CCM_decrypt_and_auth
B3:00A086 903720            MOV      DPTR,#decrypt_len
B3:00A089 EE                MOV      A,R6
B3:00A08A F0                MOVX     @DPTR,A
B3:00A08B A3                INC      DPTR
B3:00A08C EF                MOV      A,R7
B3:00A08D F0                MOVX     @DPTR,A
B3:00A08E 71D9              ACALL    ?L?COM02E0
B3:00A090 121FB9            LCALL    ?C?CLDOPTR
B3:00A093 FF                MOV      R7,A
B3:00A094 9036B7            MOV      DPTR,#conn
B3:00A097 12E6DA            LCALL    ?L?COM03C2
B3:00A09A EF                MOV      A,R7
B3:00A09B 12204D            LCALL    ?C?CSTOPTR
B3:00A09E         ?C0136?S2:
B3:00A09E 903720            MOV      DPTR,#decrypt_len
B3:00A0A1 E0                MOVX     A,@DPTR
B3:00A0A2 7002              JNZ      ?C0269?S2
B3:00A0A4 A3                INC      DPTR
B3:00A0A5 E0                MOVX     A,@DPTR
B3:00A0A6         ?C0269?S2:
B3:00A0A6 7002              JNZ      $ + 4H
B3:00A0A8 21BB              AJMP     auth_fail?S2
B3:00A0AA 903718            MOV      DPTR,#aad_len
B3:00A0AD E0                MOVX     A,@DPTR
B3:00A0AE 7002              JNZ      ?C0270?S2
B3:00A0B0 A3                INC      DPTR
B3:00A0B1 E0                MOVX     A,@DPTR
B3:00A0B2         ?C0270?S2:
B3:00A0B2 7002              JNZ      $ + 4H
B3:00A0B4 21BB              AJMP     auth_fail?S2
B3:00A0B6         ?C0137?S2:
B3:00A0B6 E4                CLR      A
B3:00A0B7 903726            MOV      DPTR,#hdr_len
B3:00A0BA F0                MOVX     @DPTR,A
B3:00A0BB A3                INC      DPTR
B3:00A0BC F0                MOVX     @DPTR,A
B3:00A0BD 90371A            MOV      DPTR,#flags
B3:00A0C0 E0                MOVX     A,@DPTR
B3:00A0C1 20E102            JB       ACC.1,$ + 5H
B3:00A0C4 217F              AJMP     ?C0139?S2
B3:00A0C6 A3                INC      DPTR
B3:00A0C7 122552            LCALL    ?C?PLDXDATA
B3:00A0CA 903722            MOV      DPTR,#ext_data
B3:00A0CD 122572            LCALL    ?C?PSTXDATA
B3:00A0D0         ?C0142?S2:
B3:00A0D0 903722            MOV      DPTR,#ext_data
B3:00A0D3 71E6              ACALL    ?L?COM0077
B3:00A0D5 FF                MOV      R7,A
B3:00A0D6 903725            MOV      DPTR,#ext_len
B3:00A0D9 F0                MOVX     @DPTR,A
B3:00A0DA A3                INC      DPTR
B3:00A0DB 12EBE4            LCALL    ?L?COM0208
B3:00A0DE 903720            MOV      DPTR,#decrypt_len
B3:00A0E1 E0                MOVX     A,@DPTR
B3:00A0E2 FE                MOV      R6,A
B3:00A0E3 A3                INC      DPTR
B3:00A0E4 E0                MOVX     A,@DPTR
B3:00A0E5 FF                MOV      R7,A
B3:00A0E6 D3                SETB     C
B3:00A0E7 903727            MOV      DPTR,#hdr_len+01H
B3:00A0EA E0                MOVX     A,@DPTR
B3:00A0EB 9F                SUBB     A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 756


B3:00A0EC 903726            MOV      DPTR,#hdr_len
B3:00A0EF E0                MOVX     A,@DPTR
B3:00A0F0 9E                SUBB     A,R6
B3:00A0F1 4002              JC       $ + 4H
B3:00A0F3 21B8              AJMP     parse_fail?S2
B3:00A0F5 903725            MOV      DPTR,#ext_len
B3:00A0F8 E0                MOVX     A,@DPTR
B3:00A0F9 FF                MOV      R7,A
B3:00A0FA 7002              JNZ      $ + 4H
B3:00A0FC 21B8              AJMP     parse_fail?S2
B3:00A0FE         ?C0143?S2:
B3:00A0FE 129CA5            LCALL    ?L?COM0065
B3:00A101 543F              ANL      A,#03FH
B3:00A103 24FE              ADD      A,#0FEH
B3:00A105 7061              JNZ      ?C0149?S2
B3:00A107         ?C0146?S2:
B3:00A107 EF                MOV      A,R7
B3:00A108 6413              XRL      A,#013H
B3:00A10A 6002              JZ       $ + 4H
B3:00A10C 21B8              AJMP     parse_fail?S2
B3:00A10E         ?C0147?S2:
B3:00A10E 9036B7            MOV      DPTR,#conn
B3:00A111 129CA2            LCALL    ?L?COM0064
B3:00A114 FF                MOV      R7,A
B3:00A115 903722            MOV      DPTR,#ext_data
B3:00A118 12B990            LCALL    ?L?COM00B5
B3:00A11B FD                MOV      R5,A
B3:00A11C 7B01              MOV      R3,#01H
B3:00A11E 12ECF7            LCALL    ?L?COM03D7
B3:00A121 903722            MOV      DPTR,#ext_data
B3:00A124 1289B7            LCALL    ?L?COM004D
B3:00A127 C003              PUSH     AR3
B3:00A129 C002              PUSH     AR2
B3:00A12B C001              PUSH     AR1
B3:00A12D 90372B            MOV      DPTR,#mpan
B3:00A130 122552            LCALL    ?C?PLDXDATA
B3:00A133 125D47            LCALL    ?L?COM03C9
B3:00A136 A801              MOV      R0,AR1
B3:00A138 FC                MOV      R4,A
B3:00A139 AD03              MOV      R5,AR3
B3:00A13B D001              POP      AR1
B3:00A13D D002              POP      AR2
B3:00A13F D003              POP      AR3
B3:00A141 12D728            LCALL    ?L?COM0197
B3:00A144 12ED00            LCALL    ?L?COM0367
B3:00A147 7401              MOV      A,#01H
B3:00A149 12204D            LCALL    ?C?CSTOPTR
B3:00A14C 12C484            LCALL    ?L?COM00D7
B3:00A14F FF                MOV      R7,A
B3:00A150 71D9              ACALL    ?L?COM02E0
B3:00A152 EF                MOV      A,R7
B3:00A153 12204D            LCALL    ?C?CSTOPTR
B3:00A156 D121              ACALL    ?L?COM005C
B3:00A158 20E016            JB       ACC.0,?C0145?S2
B3:00A15B E9                MOV      A,R1
B3:00A15C 2403              ADD      A,#03H
B3:00A15E 1252DD            LCALL    ?L?COM0009
B3:00A161 4402              ORL      A,#02H
B3:00A163 12203B            LCALL    ?C?CSTPTR
B3:00A166 8009              SJMP     ?C0145?S2
B3:00A168         ?C0149?S2:
B3:00A168 903722            MOV      DPTR,#ext_data
B3:00A16B 129CA2            LCALL    ?L?COM0064
B3:00A16E 20E647            JB       ACC.6,parse_fail?S2
B3:00A171         ?C0150?S2:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 757


B3:00A171         ?C0145?S2:
B3:00A171 903722            MOV      DPTR,#ext_data
B3:00A174 129CA2            LCALL    ?L?COM0064
B3:00A177 30E705            JNB      ACC.7,?C0139?S2
B3:00A17A 12EBDC            LCALL    ?L?COM0207
B3:00A17D 01D0              AJMP     ?C0142?S2
B3:00A17F         ?C0139?S2:
B3:00A17F 90371B            MOV      DPTR,#ciphertext
B3:00A182 122552            LCALL    ?C?PLDXDATA
B3:00A185 903726            MOV      DPTR,#hdr_len
B3:00A188 126E51            LCALL    ?L?COM0252
B3:00A18B C003              PUSH     AR3
B3:00A18D C002              PUSH     AR2
B3:00A18F C001              PUSH     AR1
B3:00A191 9036BF            MOV      DPTR,#plain_text
B3:00A194 122552            LCALL    ?C?PLDXDATA
B3:00A197 1225A7            LCALL    ?C?PSTPTR
B3:00A19A 903726            MOV      DPTR,#hdr_len
B3:00A19D 12DAD6            LCALL    ?L?COM014A
B3:00A1A0 903721            MOV      DPTR,#decrypt_len+01H
B3:00A1A3 E0                MOVX     A,@DPTR
B3:00A1A4 9F                SUBB     A,R7
B3:00A1A5 FF                MOV      R7,A
B3:00A1A6 903720            MOV      DPTR,#decrypt_len
B3:00A1A9 E0                MOVX     A,@DPTR
B3:00A1AA 9E                SUBB     A,R6
B3:00A1AB FE                MOV      R6,A
B3:00A1AC 9036C2            MOV      DPTR,#plain_text_len
B3:00A1AF 122552            LCALL    ?C?PLDXDATA
B3:00A1B2 12C70A            LCALL    ?L?COM029C
B3:00A1B5 7F00              MOV      R7,#00H
B3:00A1B7 22                RET      
B3:00A1B8         parse_fail:
B3:00A1B8 7F01              MOV      R7,#01H
B3:00A1BA 22                RET      
B3:00A1BB         auth_fail:
B3:00A1BB 31F4              ACALL    ?L?COM01C6
B3:00A1BD 6008              JZ       ?C0153?S2
B3:00A1BF 12ED00            LCALL    ?L?COM0367
B3:00A1C2 7402              MOV      A,#02H
B3:00A1C4 12204D            LCALL    ?C?CSTOPTR
B3:00A1C7         ?C0153?S2:
B3:00A1C7 903728            MOV      DPTR,#span
B3:00A1CA 31F7              ACALL    ?L?COM01C7
B3:00A1CC 6007              JZ       ?C0154?S2
B3:00A1CE 5125              ACALL    ?L?COM017F
B3:00A1D0 7402              MOV      A,#02H
B3:00A1D2 12204D            LCALL    ?C?CSTOPTR
B3:00A1D5         ?C0154?S2:
B3:00A1D5 D121              ACALL    ?L?COM005C
B3:00A1D7 20E017            JB       ACC.0,?C0155?S2
B3:00A1DA C003              PUSH     AR3
B3:00A1DC C002              PUSH     AR2
B3:00A1DE C001              PUSH     AR1
B3:00A1E0 31F4              ACALL    ?L?COM01C6
B3:00A1E2 7D01              MOV      R5,#01H
B3:00A1E4 6002              JZ       ?C0156?S2
B3:00A1E6 7D03              MOV      R5,#03H
B3:00A1E8         ?C0156?S2:
B3:00A1E8         ?C0157?S2:
B3:00A1E8 D001              POP      AR1
B3:00A1EA D002              POP      AR2
B3:00A1EC D003              POP      AR3
B3:00A1EE 12D668            LCALL    ___S2_send_nonce_report
B3:00A1F1         ?C0155?S2:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 758


B3:00A1F1 7F02              MOV      R7,#02H
B3:00A1F3 22                RET      
----- FUNCTION ___S2_decrypt_msg (END) -------


----- FUNCTION ?L?COM01C6 (BEGIN) -----
B3:00A1F4 90372B            MOV      DPTR,#mpan
B3:00A1F7         ?L?COM01C7:
B3:00A1F7 122552            LCALL    ?C?PLDXDATA
B3:00A1FA EA                MOV      A,R2
B3:00A1FB 49                ORL      A,R1
B3:00A1FC 4B                ORL      A,R3
B3:00A1FD 22                RET      
----- FUNCTION ?L?COM01C6 (END) -------


----- FUNCTION sec2_init (BEGIN) -----
B3:00A1FE 12BB2A            LCALL    S2_init_prng
B3:00A201 901223            MOV      DPTR,#homeID
B3:00A204 122462            LCALL    ?C?LLDXDATA
B3:00A207 128B62            LCALL    _S2_init_ctx
B3:00A20A 903CB4            MOV      DPTR,#s2_ctx
B3:00A20D 122572            LCALL    ?C?PSTXDATA
B3:00A210 12D60B            LCALL    s2_restore_spans_and_mpans
B3:00A213 7E1C              MOV      R6,#HIGH ?INTERBANK_TABLE?_ZCB_s2_evt_handler
B3:00A215 7FE1              MOV      R7,#LOW ?INTERBANK_TABLE?_ZCB_s2_evt_handler
B3:00A217 12E9D1            LCALL    _s2_inclusion_set_event_handler
B3:00A21A 121B15            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B3:00A21D EF                MOV      A,R7
B3:00A21E 5407              ANL      A,#07H
B3:00A220 C3                CLR      C
B3:00A221 6001              JZ       ?C0001?ZW_SECURITY_SCHEME2
B3:00A223 D3                SETB     C
B3:00A224         ?C0001?ZW_SECURITY_SCHEME2:
B3:00A224 22                RET      
----- FUNCTION sec2_init (END) -------


----- FUNCTION ?L?COM017F (BEGIN) -----
B3:00A225 903728            MOV      DPTR,#span
B3:00A228         ?L?COM0180:
B3:00A228 122552            LCALL    ?C?PLDXDATA
B3:00A22B 900026            MOV      DPTR,#026H
B3:00A22E 22                RET      
----- FUNCTION ?L?COM017F (END) -------


----- FUNCTION sec0_state (BEGIN) -----
B3:00A22F 121B15            LCALL    ?INTERBANK_TABLE?ZW_GetSecurityKeys
B3:00A232 EF                MOV      A,R7
B3:00A233 30E74E            JNB      ACC.7,?C0123?ZW_SECURITY_SCHEME0
B3:00A236 E4                CLR      A
B3:00A237 9046AF            MOV      DPTR,#i
B3:00A23A F0                MOVX     @DPTR,A
B3:00A23B         ?C0124?ZW_SECURITY_SCHEME0:
B3:00A23B 9046AF            MOV      DPTR,#i
B3:00A23E E0                MOVX     A,@DPTR
B3:00A23F FF                MOV      R7,A
B3:00A240 C3                CLR      C
B3:00A241 9402              SUBB     A,#02H
B3:00A243 5016              JNC      ?C0125?ZW_SECURITY_SCHEME0
B3:00A245 12D34E            LCALL    ?L?COM0184
B3:00A248 7B01              MOV      R3,#01H
;---- Variable 'e' assigned to Register 'R1/R2/R3' ----
B3:00A24A 12D2F0            LCALL    _is_free
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 759


B3:00A24D EF                MOV      A,R7
B3:00A24E 7003              JNZ      ?C0126?ZW_SECURITY_SCHEME0
B3:00A250 7F02              MOV      R7,#02H
B3:00A252 22                RET      
B3:00A253         ?C0126?ZW_SECURITY_SCHEME0:
B3:00A253 9046AF            MOV      DPTR,#i
B3:00A256 E0                MOVX     A,@DPTR
B3:00A257 04                INC      A
B3:00A258 F0                MOVX     @DPTR,A
B3:00A259 80E0              SJMP     ?C0124?ZW_SECURITY_SCHEME0
B3:00A25B         ?C0125?ZW_SECURITY_SCHEME0:
B3:00A25B 902D8E            MOV      DPTR,#the_tx_session
B3:00A25E E0                MOVX     A,@DPTR
B3:00A25F 6003              JZ       ?C0129?ZW_SECURITY_SCHEME0
B3:00A261 7F03              MOV      R7,#03H
B3:00A263 22                RET      
B3:00A264         ?C0129?ZW_SECURITY_SCHEME0:
B3:00A264 E4                CLR      A
B3:00A265 9046AF            MOV      DPTR,#i
B3:00A268 F0                MOVX     @DPTR,A
B3:00A269         ?C0130?ZW_SECURITY_SCHEME0:
B3:00A269 9046AF            MOV      DPTR,#i
B3:00A26C E0                MOVX     A,@DPTR
B3:00A26D FF                MOV      R7,A
B3:00A26E C3                CLR      C
B3:00A26F 940F              SUBB     A,#0FH
B3:00A271 5011              JNC      ?C0123?ZW_SECURITY_SCHEME0
B3:00A273 12D19A            LCALL    ?L?COM00A1
B3:00A276 E0                MOVX     A,@DPTR
B3:00A277 6003              JZ       ?C0132?ZW_SECURITY_SCHEME0
B3:00A279 7F01              MOV      R7,#01H
B3:00A27B 22                RET      
B3:00A27C         ?C0132?ZW_SECURITY_SCHEME0:
B3:00A27C 9046AF            MOV      DPTR,#i
B3:00A27F E0                MOVX     A,@DPTR
B3:00A280 04                INC      A
B3:00A281 F0                MOVX     @DPTR,A
B3:00A282 80E5              SJMP     ?C0130?ZW_SECURITY_SCHEME0
B3:00A284         ?C0123?ZW_SECURITY_SCHEME0:
B3:00A284 7F00              MOV      R7,#00H
B3:00A286 22                RET      
----- FUNCTION sec0_state (END) -------


----- FUNCTION _TransportService_ApplicationCommandHandler (BEGIN) -----
B3:00A287 90428A            MOV      DPTR,#pCmdHandlerStruct
B3:00A28A 126ECE            LCALL    ?L?COM035B
B3:00A28D 90428D            MOV      DPTR,#p
B3:00A290 122572            LCALL    ?C?PSTXDATA
B3:00A293 90428A            MOV      DPTR,#pCmdHandlerStruct
B3:00A296 12ED18            LCALL    ?L?COM01BF
B3:00A299 904290            MOV      DPTR,#pCmd
B3:00A29C 122572            LCALL    ?C?PSTXDATA
B3:00A29F 90428A            MOV      DPTR,#pCmdHandlerStruct
B3:00A2A2 12ED46            LCALL    ?L?COM01E0
B3:00A2A5 904293            MOV      DPTR,#cmdLength
B3:00A2A8 12B4BF            LCALL    ?L?COM0026
B3:00A2AB 12EAC2            LCALL    ZW_TransportService_Is_Sending
B3:00A2AE 5020              JNC      ?C0087?TRANSPORT_SERVICE2
B3:00A2B0 90428D            MOV      DPTR,#p
B3:00A2B3 71E6              ACALL    ?L?COM0077
B3:00A2B5 FF                MOV      R7,A
B3:00A2B6 9031AF            MOV      DPTR,#scb+09H
B3:00A2B9 E0                MOVX     A,@DPTR
B3:00A2BA B50713            CJNE     A,AR7,?C0087?TRANSPORT_SERVICE2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 760


B3:00A2BD 901221            MOV      DPTR,#nodeID
B3:00A2C0 E0                MOVX     A,@DPTR
B3:00A2C1 C3                CLR      C
B3:00A2C2 9F                SUBB     A,R7
B3:00A2C3 500B              JNC      ?C0087?TRANSPORT_SERVICE2
B3:00A2C5 7F14              MOV      R7,#014H
B3:00A2C7 129C55            LCALL    _t2_sm_post_event
B3:00A2CA 903073            MOV      DPTR,#flag_tie_broken
B3:00A2CD 7401              MOV      A,#01H
B3:00A2CF F0                MOVX     @DPTR,A
B3:00A2D0         ?C0087?TRANSPORT_SERVICE2:
B3:00A2D0 90428D            MOV      DPTR,#p
B3:00A2D3 129CA2            LCALL    ?L?COM0064
B3:00A2D6 FF                MOV      R7,A
B3:00A2D7 121F7C            LCALL    ?C?CLDPTR
B3:00A2DA 6F                XRL      A,R7
B3:00A2DB 7002              JNZ      $ + 4H
B3:00A2DD 61D8              AJMP     ?C0089?TRANSPORT_SERVICE2
B3:00A2DF         ?C0088?TRANSPORT_SERVICE2:
B3:00A2DF 904293            MOV      DPTR,#cmdLength
B3:00A2E2 E0                MOVX     A,@DPTR
B3:00A2E3 D3                SETB     C
B3:00A2E4 94C8              SUBB     A,#0C8H
B3:00A2E6 4002              JC       $ + 4H
B3:00A2E8 61D8              AJMP     ?C0089?TRANSPORT_SERVICE2
B3:00A2EA         ?C0090?TRANSPORT_SERVICE2:
B3:00A2EA 90428D            MOV      DPTR,#p
B3:00A2ED 122552            LCALL    ?C?PLDXDATA
B3:00A2F0 128549            LCALL    ?L?COM0019
B3:00A2F3 7A32              MOV      R2,#HIGH scb+06FH
B3:00A2F5 7915              MOV      R1,#LOW scb+06FH
B3:00A2F7 12EBA0            LCALL    ?L?COM053D
B3:00A2FA 90428D            MOV      DPTR,#p
B3:00A2FD 71E6              ACALL    ?L?COM0077
B3:00A2FF FF                MOV      R7,A
B3:00A300 903198            MOV      DPTR,#rcb+011EH
B3:00A303 E0                MOVX     A,@DPTR
B3:00A304 FE                MOV      R6,A
B3:00A305 6F                XRL      A,R7
B3:00A306 6003              JZ       ?C0093?TRANSPORT_SERVICE2
B3:00A308 EE                MOV      A,R6
B3:00A309 700B              JNZ      ?C0092?TRANSPORT_SERVICE2
B3:00A30B         ?C0093?TRANSPORT_SERVICE2:
B3:00A30B 90321F            MOV      DPTR,#scb+079H
B3:00A30E E0                MOVX     A,@DPTR
B3:00A30F FE                MOV      R6,A
B3:00A310 6F                XRL      A,R7
B3:00A311 6026              JZ       ?C0091?TRANSPORT_SERVICE2
B3:00A313 EE                MOV      A,R6
B3:00A314 6023              JZ       ?C0091?TRANSPORT_SERVICE2
B3:00A316         ?C0092?TRANSPORT_SERVICE2:
B3:00A316 71F2              ACALL    ?L?COM0290
B3:00A318 7013              JNZ      ?C0094?TRANSPORT_SERVICE2
B3:00A31A 900AEB            MOV      DPTR,#current_state
B3:00A31D E0                MOVX     A,@DPTR
B3:00A31E 6404              XRL      A,#04H
B3:00A320 7002              JNZ      $ + 4H
B3:00A322 61D8              AJMP     ?C0089?TRANSPORT_SERVICE2
B3:00A324         ?C0095?TRANSPORT_SERVICE2:
B3:00A324 7F0B              MOV      R7,#0BH
B3:00A326 12ECE4            LCALL    ?L?COM030E
B3:00A329 6041              JZ       ?C0213?TRANSPORT_SERVICE2
B3:00A32B 8038              SJMP     ?C0212?TRANSPORT_SERVICE2
B3:00A32D         ?C0094?TRANSPORT_SERVICE2:
B3:00A32D 90428D            MOV      DPTR,#p
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 761


B3:00A330 71EF              ACALL    ?L?COM028F
B3:00A332 B40404            CJNE     A,#04H,?C0091?TRANSPORT_SERVICE2
B3:00A335 7F0C              MOV      R7,#0CH
B3:00A337 8024              SJMP     ?C0214?TRANSPORT_SERVICE2
B3:00A339         ?C0091?TRANSPORT_SERVICE2:
B3:00A339 904290            MOV      DPTR,#pCmd
B3:00A33C 129CA2            LCALL    ?L?COM0064
B3:00A33F FF                MOV      R7,A
;---- Variable 'cmd_type' assigned to Register 'R6' ----
B3:00A340 54F8              ANL      A,#0F8H
B3:00A342 FE                MOV      R6,A
B3:00A343 903096            MOV      DPTR,#rcb+01CH
B3:00A346 E0                MOVX     A,@DPTR
B3:00A347 6410              XRL      A,#010H
B3:00A349 7024              JNZ      ?C0099?TRANSPORT_SERVICE2
B3:00A34B EE                MOV      A,R6
B3:00A34C 64E0              XRL      A,#0E0H
B3:00A34E 701F              JNZ      ?C0099?TRANSPORT_SERVICE2
;---- Variable 'datagram_size_tmp' assigned to Register 'R7' ----
B3:00A350 12B993            LCALL    ?L?COM00B6
B3:00A353 2400              ADD      A,#00H
B3:00A355 D3                SETB     C
B3:00A356 94C8              SUBB     A,#0C8H
B3:00A358 4006              JC       ?C0100?TRANSPORT_SERVICE2
B3:00A35A E4                CLR      A
B3:00A35B 7F0D              MOV      R7,#0DH
B3:00A35D         
B3:00A35D 029C55            LJMP     _t2_sm_post_event
B3:00A360         ?C0100?TRANSPORT_SERVICE2:
B3:00A360 12ECE2            LCALL    ?L?COM030D
B3:00A363 6007              JZ       ?C0101?TRANSPORT_SERVICE2
B3:00A365         
B3:00A365 903213            MOV      DPTR,#scb+06DH
B3:00A368 7401              MOV      A,#01H
B3:00A36A F0                MOVX     @DPTR,A
B3:00A36B 22                RET      
B3:00A36C         ?C0101?TRANSPORT_SERVICE2:
B3:00A36C         
B3:00A36C 02B66A            LJMP     send_frag_wait_cmd
B3:00A36F         ?C0099?TRANSPORT_SERVICE2:
B3:00A36F 900AEB            MOV      DPTR,#current_state
B3:00A372 E0                MOVX     A,@DPTR
B3:00A373 14                DEC      A
B3:00A374 6007              JZ       ?C0105?TRANSPORT_SERVICE2
B3:00A376 04                INC      A
B3:00A377 7009              JNZ      ?C0103?TRANSPORT_SERVICE2
B3:00A379         ?C0104?TRANSPORT_SERVICE2:
B3:00A379 E4                CLR      A
B3:00A37A FF                MOV      R7,A
B3:00A37B 8002              SJMP     ?C0215?TRANSPORT_SERVICE2
B3:00A37D         ?C0105?TRANSPORT_SERVICE2:
B3:00A37D 7F01              MOV      R7,#01H
B3:00A37F         
B3:00A37F 129C55            LCALL    _t2_sm_post_event
B3:00A382         ?C0103?TRANSPORT_SERVICE2:
B3:00A382 903221            MOV      DPTR,#flag_initialize_once
B3:00A385 E0                MOVX     A,@DPTR
B3:00A386 6029              JZ       ?C0108?TRANSPORT_SERVICE2
B3:00A388 E4                CLR      A
B3:00A389 F0                MOVX     @DPTR,A
B3:00A38A 7B01              MOV      R3,#01H
B3:00A38C 7A30              MOV      R2,#HIGH rcb
B3:00A38E 797A              MOV      R1,#LOW rcb
B3:00A390 7D1E              MOV      R5,#01EH
B3:00A392 12EADD            LCALL    ?L?COM039C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 762


B3:00A395 90309C            MOV      DPTR,#rcb+022H
B3:00A398 7401              MOV      A,#01H
B3:00A39A F0                MOVX     @DPTR,A
B3:00A39B E4                CLR      A
B3:00A39C 903196            MOV      DPTR,#rcb+011CH
B3:00A39F F0                MOVX     @DPTR,A
B3:00A3A0 A3                INC      DPTR
B3:00A3A1 F0                MOVX     @DPTR,A
B3:00A3A2 A3                INC      DPTR
B3:00A3A3 F0                MOVX     @DPTR,A
B3:00A3A4 9031A3            MOV      DPTR,#rcb+0129H
B3:00A3A7 F0                MOVX     @DPTR,A
B3:00A3A8 12EABB            LCALL    ?L?COM03B1
B3:00A3AB 7DC8              MOV      R5,#0C8H
B3:00A3AD FF                MOV      R7,A
B3:00A3AE 12851A            LCALL    ___ZW_memset
B3:00A3B1         ?C0108?TRANSPORT_SERVICE2:
B3:00A3B1 904290            MOV      DPTR,#pCmd
B3:00A3B4 122552            LCALL    ?C?PLDXDATA
B3:00A3B7 903098            MOV      DPTR,#rcb+01EH
B3:00A3BA 122572            LCALL    ?C?PSTXDATA
B3:00A3BD 90428D            MOV      DPTR,#p
B3:00A3C0 122552            LCALL    ?C?PLDXDATA
B3:00A3C3 128549            LCALL    ?L?COM0019
B3:00A3C6 7A30              MOV      R2,#HIGH rcb
B3:00A3C8 797A              MOV      R1,#LOW rcb
B3:00A3CA 126EDE            LCALL    ?L?COM0365
B3:00A3CD 904293            MOV      DPTR,#cmdLength
B3:00A3D0 E0                MOVX     A,@DPTR
B3:00A3D1 90309B            MOV      DPTR,#rcb+021H
B3:00A3D4 F0                MOVX     @DPTR,A
B3:00A3D5 129942            LCALL    receive
B3:00A3D8         ?C0089?TRANSPORT_SERVICE2:
B3:00A3D8 22                RET      
----- FUNCTION _TransportService_ApplicationCommandHandler (END) -------


----- FUNCTION ?L?COM02E0 (BEGIN) -----
B3:00A3D9 90372B            MOV      DPTR,#mpan
B3:00A3DC 122552            LCALL    ?C?PLDXDATA
B3:00A3DF 900012            MOV      DPTR,#012H
B3:00A3E2 22                RET      
----- FUNCTION ?L?COM02E0 (END) -------


----- FUNCTION ?L?COM0076 (BEGIN) -----
B3:00A3E3 904089            MOV      DPTR,#con
B3:00A3E6         ?L?COM0077:
B3:00A3E6 122552            LCALL    ?C?PLDXDATA
B3:00A3E9 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0076 (END) -------


----- FUNCTION ?L?COM028E (BEGIN) -----
B3:00A3EC 9028DB            MOV      DPTR,#the_context+0D7H
B3:00A3EF         ?L?COM028F:
B3:00A3EF 122552            LCALL    ?C?PLDXDATA
B3:00A3F2         ?L?COM0290:
B3:00A3F2 900005            MOV      DPTR,#05H
B3:00A3F5 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM028E (END) -------


----- FUNCTION _ZW_UART_tx_send_str (BEGIN) -----
B3:00A3F8 904639            MOV      DPTR,#str
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 763


B3:00A3FB F1EC              ACALL    ?L?COM0567
B3:00A3FD B40112            CJNE     A,#01H,?C0014?ZW_UART_SUPPORT
B3:00A400         ?C0011?ZW_UART_SUPPORT:
B3:00A400 904639            MOV      DPTR,#str
B3:00A403 71E6              ACALL    ?L?COM0077
B3:00A405 FF                MOV      R7,A
B3:00A406 601B              JZ       ?C0016?ZW_UART_SUPPORT
B3:00A408 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00A40B 9124              ACALL    ?L?COM0568
B3:00A40D 12210C            LCALL    ?C?IILDX
B3:00A410 80EE              SJMP     ?C0011?ZW_UART_SUPPORT
B3:00A412         ?C0014?ZW_UART_SUPPORT:
B3:00A412 904639            MOV      DPTR,#str
B3:00A415 71E6              ACALL    ?L?COM0077
B3:00A417 FF                MOV      R7,A
B3:00A418 6009              JZ       ?C0016?ZW_UART_SUPPORT
B3:00A41A F1C8              ACALL    _ZW_UART1_tx_send_byte
B3:00A41C 9124              ACALL    ?L?COM0568
B3:00A41E 12210C            LCALL    ?C?IILDX
B3:00A421 80EF              SJMP     ?C0014?ZW_UART_SUPPORT
B3:00A423         ?C0016?ZW_UART_SUPPORT:
B3:00A423 22                RET      
----- FUNCTION _ZW_UART_tx_send_str (END) -------


----- FUNCTION ?L?COM0568 (BEGIN) -----
B3:00A424 90463A            MOV      DPTR,#str+01H
B3:00A427 E4                CLR      A
B3:00A428 75F001            MOV      B,#01H
B3:00A42B 22                RET      
----- FUNCTION ?L?COM0568 (END) -------


----- FUNCTION _s2_inclusion_set_public_csa_dsk (BEGIN) -----
B3:00A42C 904618            MOV      DPTR,#response_dsk
B3:00A42F 122572            LCALL    ?C?PSTXDATA
B3:00A432 904618            MOV      DPTR,#response_dsk
B3:00A435 71E6              ACALL    ?L?COM0077
B3:00A437 903F1D            MOV      DPTR,#challenge_response
B3:00A43A F0                MOVX     @DPTR,A
B3:00A43B E9                MOV      A,R1
B3:00A43C 2401              ADD      A,#01H
B3:00A43E 1252DD            LCALL    ?L?COM0009
B3:00A441 903F1E            MOV      DPTR,#challenge_response+01H
B3:00A444 D1CE              ACALL    ?L?COM0503
B3:00A446 2402              ADD      A,#02H
B3:00A448 1252DD            LCALL    ?L?COM0009
B3:00A44B 903F1F            MOV      DPTR,#challenge_response+02H
B3:00A44E D1CE              ACALL    ?L?COM0503
B3:00A450 2403              ADD      A,#03H
B3:00A452 1252DD            LCALL    ?L?COM0009
B3:00A455 903F20            MOV      DPTR,#challenge_response+03H
B3:00A458 F0                MOVX     @DPTR,A
B3:00A459 12ED4F            LCALL    ?L?COM03DC
B3:00A45C 7F01              MOV      R7,#01H
B3:;----                  JMP      _s2_inclusion_challenge_response
----- FUNCTION _s2_inclusion_set_public_csa_dsk (END) -------


----- FUNCTION _s2_inclusion_challenge_response (BEGIN) -----
B3:00A45E 904538            MOV      DPTR,#p_response
B3:00A461 122572            LCALL    ?C?PSTXDATA
;---- Variable 'include' assigned to Register 'R7' ----
B3:00A464 EF                MOV      A,R7
B3:00A465 6401              XRL      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 764


B3:00A467 7032              JNZ      ?C0042?S2_INCLUSION
B3:00A469         ?C0043?S2_INCLUSION:
B3:00A469 90453B            MOV      DPTR,#responseLength
B3:00A46C E0                MOVX     A,@DPTR
B3:00A46D FF                MOV      R7,A
B3:00A46E 14                DEC      A
B3:00A46F F0                MOVX     @DPTR,A
B3:00A470 EF                MOV      A,R7
B3:00A471 6022              JZ       ?C0044?S2_INCLUSION
B3:00A473 904538            MOV      DPTR,#p_response
B3:00A476 122552            LCALL    ?C?PLDXDATA
B3:00A479 90453B            MOV      DPTR,#responseLength
B3:00A47C E0                MOVX     A,@DPTR
B3:00A47D FF                MOV      R7,A
B3:00A47E F582              MOV      DPL,A
B3:00A480 F12F              ACALL    ?L?COM00BD
B3:00A482 FE                MOV      R6,A
B3:00A483 EF                MOV      A,R7
B3:00A484 7C00              MOV      R4,#00H
B3:00A486 7B01              MOV      R3,#01H
B3:00A488 241C              ADD      A,#LOW the_context+0318H
B3:00A48A F9                MOV      R1,A
B3:00A48B EC                MOV      A,R4
B3:00A48C 342B              ADDC     A,#HIGH the_context+0318H
B3:00A48E FA                MOV      R2,A
B3:00A48F EE                MOV      A,R6
B3:00A490 12203B            LCALL    ?C?CSTPTR
B3:00A493 80D4              SJMP     ?C0043?S2_INCLUSION
B3:00A495         ?C0044?S2_INCLUSION:
B3:00A495 7402              MOV      A,#02H
B3:00A497 FF                MOV      R7,A
B3:00A498 FE                MOV      R6,A
B3:00A499 8004              SJMP     ?C0134?S2_INCLUSION
B3:00A49B         ?C0042?S2_INCLUSION:
B3:00A49B 7F03              MOV      R7,#03H
B3:00A49D 7E02              MOV      R6,#02H
B3:00A49F         
B3:00A49F 028BE8            LJMP     _process_event
----- FUNCTION _s2_inclusion_challenge_response (END) -------


----- FUNCTION ___S2_application_command_handler (BEGIN) -----
B3:00A4A2 903FF9            MOV      DPTR,#src
B3:00A4A5 122572            LCALL    ?C?PSTXDATA
B3:00A4A8 D1BD              ACALL    ?L?COM045C
B3:00A4AA 90400E            MOV      DPTR,#d+03H
B3:00A4AD D1C3              ACALL    ?L?COM030F
B3:00A4AF 904011            MOV      DPTR,#d+06H
B3:00A4B2 D12D              ACALL    ?L?COM0246
B3:00A4B4 90400B            MOV      DPTR,#d
B3:00A4B7 122572            LCALL    ?C?PSTXDATA
B3:00A4BA 903FFC            MOV      DPTR,#buf
B3:00A4BD 71E6              ACALL    ?L?COM0077
B3:00A4BF 649F              XRL      A,#09FH
B3:00A4C1 6002              JZ       $ + 4H
B3:00A4C3 C120              AJMP     ?C0177?S2
B3:00A4C5         ?C0176?S2:
B3:00A4C5 129CA5            LCALL    ?L?COM0065
B3:00A4C8 24FE              ADD      A,#0FEH
B3:00A4CA 6019              JZ       ?C0181?S2
B3:00A4CC 14                DEC      A
B3:00A4CD 601D              JZ       ?C0182?S2
B3:00A4CF 2402              ADD      A,#02H
B3:00A4D1 6002              JZ       $ + 4H
B3:00A4D3 C105              AJMP     ?C0194?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 765


B3:00A4D5         ?C0179?S2:
B3:00A4D5 903FF9            MOV      DPTR,#src
B3:00A4D8 D124              ACALL    ?L?COM005D
B3:00A4DA 30E002            JNB      ACC.0,$ + 5H
B3:00A4DD C120              AJMP     ?C0177?S2
B3:00A4DF D138              ACALL    ?L?COM03D6
B3:00A4E1 7F03              MOV      R7,#03H
B3:00A4E3 8004              SJMP     ?C0277?S2
B3:00A4E5         ?C0181?S2:
B3:00A4E5 D138              ACALL    ?L?COM03D6
B3:00A4E7 7F04              MOV      R7,#04H
B3:00A4E9         
B3:00A4E9 028CD5            LJMP     ___S2_fsm_post_event
B3:00A4EC         ?C0182?S2:
B3:00A4EC D1BD              ACALL    ?L?COM045C
B3:00A4EE 9036BA            MOV      DPTR,#?___S2_decrypt_msg?BYTE+03H
B3:00A4F1 D1C3              ACALL    ?L?COM030F
B3:00A4F3 9036BD            MOV      DPTR,#?___S2_decrypt_msg?BYTE+06H
B3:00A4F6 12CB63            LCALL    ?L?COM0136
B3:00A4F9 7A40              MOV      R2,#HIGH plain_text
B3:00A4FB 7901              MOV      R1,#LOW plain_text
B3:00A4FD A3                INC      DPTR
B3:00A4FE 122572            LCALL    ?C?PSTXDATA
B3:00A501 7A40              MOV      R2,#HIGH plain_text_len
B3:00A503 7904              MOV      R1,#LOW plain_text_len
B3:00A505 9036C2            MOV      DPTR,#?___S2_decrypt_msg?BYTE+0BH
B3:00A508 122572            LCALL    ?C?PSTXDATA
B3:00A50B D132              ACALL    ?L?COM0248
B3:00A50D 129CAB            LCALL    ___S2_decrypt_msg
B3:00A510 904006            MOV      DPTR,#rc
B3:00A513 EF                MOV      A,R7
B3:00A514 F0                MOVX     @DPTR,A
B3:00A515 6002              JZ       $ + 4H
B3:00A517 A1F0              AJMP     ?C0183?S2
B3:00A519 D138              ACALL    ?L?COM03D6
B3:00A51B 7F05              MOV      R7,#05H
B3:00A51D 128CD5            LCALL    ___S2_fsm_post_event
B3:00A520 904004            MOV      DPTR,#plain_text_len
B3:00A523 E0                MOVX     A,@DPTR
B3:00A524 7002              JNZ      ?C0273?S2
B3:00A526 A3                INC      DPTR
B3:00A527 E0                MOVX     A,@DPTR
B3:00A528         ?C0273?S2:
B3:00A528 7002              JNZ      $ + 4H
B3:00A52A C120              AJMP     ?C0177?S2
B3:00A52C 904001            MOV      DPTR,#plain_text
B3:00A52F 71E6              ACALL    ?L?COM0077
B3:00A531 649F              XRL      A,#09FH
B3:00A533 6002              JZ       $ + 4H
B3:00A535 A1DD              AJMP     ?C0185?S2
B3:00A537 129CA5            LCALL    ?L?COM0065
B3:00A53A FF                MOV      R7,A
B3:00A53B 640E              XRL      A,#0EH
B3:00A53D 7002              JNZ      $ + 4H
B3:00A53F A1DD              AJMP     ?C0185?S2
B3:00A541 EF                MOV      A,R7
B3:00A542 6410              XRL      A,#010H
B3:00A544 7002              JNZ      $ + 4H
B3:00A546 A1DD              AJMP     ?C0185?S2
B3:00A548 903FF9            MOV      DPTR,#src
B3:00A54B D124              ACALL    ?L?COM005D
B3:00A54D 30E002            JNB      ACC.0,$ + 5H
B3:00A550 C120              AJMP     ?C0177?S2
B3:00A552         ?C0186?S2:
B3:00A552 904001            MOV      DPTR,#plain_text
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 766


B3:00A555 129CA2            LCALL    ?L?COM0064
B3:00A558 640D              XRL      A,#0DH
B3:00A55A 7065              JNZ      ?C0187?S2
B3:00A55C 12BA95            LCALL    ?L?COM01E9
B3:00A55F 740E              MOV      A,#0EH
B3:00A561 F0                MOVX     @DPTR,A
B3:00A562 903FF9            MOV      DPTR,#src
B3:00A565 71E6              ACALL    ?L?COM0077
B3:00A567 FF                MOV      R7,A
B3:00A568 900007            MOV      DPTR,#07H
B3:00A56B 121FB9            LCALL    ?C?CLDOPTR
B3:00A56E FD                MOV      R5,A
B3:00A56F 7B01              MOV      R3,#01H
B3:00A571 7A40              MOV      R2,#HIGH n_commands_supported
B3:00A573 7907              MOV      R1,#LOW n_commands_supported
B3:00A575 90439F            MOV      DPTR,#?_S2_get_commands_supported?BYTE+05H
B3:00A578 122572            LCALL    ?C?PSTXDATA
B3:00A57B 7A40              MOV      R2,#HIGH classes
B3:00A57D 09                INC      R1
B3:00A57E 12D7F7            LCALL    _S2_get_commands_supported
B3:00A581 904007            MOV      DPTR,#n_commands_supported
B3:00A584 E0                MOVX     A,@DPTR
B3:00A585 FF                MOV      R7,A
B3:00A586 2402              ADD      A,#02H
B3:00A588 FD                MOV      R5,A
B3:00A589 E4                CLR      A
B3:00A58A 33                RLC      A
B3:00A58B FC                MOV      R4,A
B3:00A58C D3                SETB     C
B3:00A58D ED                MOV      A,R5
B3:00A58E 9428              SUBB     A,#028H
B3:00A590 EC                MOV      A,R4
B3:00A591 6480              XRL      A,#080H
B3:00A593 9480              SUBB     A,#080H
B3:00A595 4002              JC       $ + 4H
B3:00A597 C120              AJMP     ?C0177?S2
B3:00A599         ?C0188?S2:
B3:00A599 7E00              MOV      R6,#00H
B3:00A59B 78F5              MOV      R0,#LOW the_context+02F1H
B3:00A59D 7C2A              MOV      R4,#HIGH the_context+02F1H
B3:00A59F 7D01              MOV      R5,#01H
B3:00A5A1 904008            MOV      DPTR,#classes
B3:00A5A4 12D59E            LCALL    ?L?COM022A
B3:00A5A7 904121            MOV      DPTR,#?___S2_send_data?BYTE+03H
B3:00A5AA 12BD3E            LCALL    ?L?COM0350
B3:00A5AD 904007            MOV      DPTR,#n_commands_supported
B3:00A5B0 E0                MOVX     A,@DPTR
B3:00A5B1 2402              ADD      A,#02H
B3:00A5B3 FE                MOV      R6,A
B3:00A5B4 E4                CLR      A
B3:00A5B5 33                RLC      A
B3:00A5B6 904124            MOV      DPTR,#?___S2_send_data?BYTE+06H
B3:00A5B9 F0                MOVX     @DPTR,A
B3:00A5BA A3                INC      DPTR
B3:00A5BB CE                XCH      A,R6
B3:00A5BC D131              ACALL    ?L?COM0247
B3:00A5BE 02C3E8            LJMP     ___S2_send_data
B3:00A5C1         ?C0187?S2:
B3:00A5C1 904001            MOV      DPTR,#plain_text
B3:00A5C4 122552            LCALL    ?C?PLDXDATA
B3:00A5C7 9028DB            MOV      DPTR,#the_context+0D7H
B3:00A5CA 12ED0A            LCALL    ?L?COM0444
B3:00A5CD 9028DE            MOV      DPTR,#the_context+0DAH
B3:00A5D0 D12D              ACALL    ?L?COM0246
B3:00A5D2 900007            MOV      DPTR,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 767


B3:00A5D5 121FB9            LCALL    ?C?CLDOPTR
B3:00A5D8 9028DA            MOV      DPTR,#the_context+0D6H
B3:00A5DB 803F              SJMP     ?C0278?S2
B3:00A5DD         ?C0185?S2:
B3:00A5DD 904001            MOV      DPTR,#plain_text
B3:00A5E0 122552            LCALL    ?C?PLDXDATA
B3:00A5E3 9041C1            MOV      DPTR,#?___S2_msg_received_event?BYTE+03H
B3:00A5E6 12ED0A            LCALL    ?L?COM0444
B3:00A5E9 9041C4            MOV      DPTR,#?___S2_msg_received_event?BYTE+06H
B3:00A5EC D12D              ACALL    ?L?COM0246
B3:00A5EE 804F              SJMP     ___S2_msg_received_event
B3:00A5F0         ?C0183?S2:
B3:00A5F0 904006            MOV      DPTR,#rc
B3:00A5F3 E0                MOVX     A,@DPTR
B3:00A5F4 6402              XRL      A,#02H
B3:00A5F6 7028              JNZ      ?C0177?S2
B3:00A5F8 D138              ACALL    ?L?COM03D6
B3:00A5FA 7F06              MOV      R7,#06H
B3:00A5FC 128CD5            LCALL    ___S2_fsm_post_event
B3:00A5FF 12C445            LCALL    ?L?COM02DF
B3:00A602 02EA50            LJMP     _s2_inclusion_decryption_failure
B3:00A605         ?C0194?S2:
B3:00A605 903FF9            MOV      DPTR,#src
B3:00A608 D124              ACALL    ?L?COM005D
B3:00A60A 20E013            JB       ACC.0,?C0177?S2
B3:00A60D D1BD              ACALL    ?L?COM045C
B3:00A60F 9028DB            MOV      DPTR,#the_context+0D7H
B3:00A612 D1C3              ACALL    ?L?COM030F
B3:00A614 12BDBA            LCALL    ?L?COM04E1
B3:00A617 9028DA            MOV      DPTR,#the_context+0D6H
B3:00A61A 74FF              MOV      A,#0FFH
B3:00A61C         
B3:00A61C F0                MOVX     @DPTR,A
B3:00A61D 12BB51            LCALL    s2_inclusion_post_event
B3:00A620         ?C0177?S2:
B3:00A620 22                RET      
----- FUNCTION ___S2_application_command_handler (END) -------


----- FUNCTION ?L?COM005C (BEGIN) -----
B3:00A621 9036B7            MOV      DPTR,#conn
B3:00A624         ?L?COM005D:
B3:00A624 122552            LCALL    ?C?PLDXDATA
B3:00A627         ?L?COM005E:
B3:00A627 900003            MOV      DPTR,#03H
B3:00A62A 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM005C (END) -------


----- FUNCTION ?L?COM0246 (BEGIN) -----
B3:00A62D CF                XCH      A,R7
B3:00A62E F0                MOVX     @DPTR,A
B3:00A62F A3                INC      DPTR
B3:00A630 EF                MOV      A,R7
B3:00A631         ?L?COM0247:
B3:00A631 F0                MOVX     @DPTR,A
B3:00A632         ?L?COM0248:
B3:00A632 903FF9            MOV      DPTR,#src
B3:00A635 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0246 (END) -------


----- FUNCTION ?L?COM03D6 (BEGIN) -----
B3:00A638 7B01              MOV      R3,#01H
B3:00A63A 7A40              MOV      R2,#HIGH d
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 768


B3:00A63C 790B              MOV      R1,#LOW d
B3:00A63E 22                RET      
----- FUNCTION ?L?COM03D6 (END) -------


----- FUNCTION ___S2_msg_received_event (BEGIN) -----
B3:00A63F 9041BE            MOV      DPTR,#src
B3:00A642 122572            LCALL    ?C?PSTXDATA
B3:00A645 9041BE            MOV      DPTR,#src
B3:00A648 125D40            LCALL    ?L?COM034F
B3:00A64B 1252DD            LCALL    ?L?COM0009
B3:00A64E 9041C6            MOV      DPTR,#rxOpt
B3:00A651 F0                MOVX     @DPTR,A
B3:00A652 9041BE            MOV      DPTR,#src
B3:00A655 12CD6D            LCALL    ?L?COM02D3
B3:00A658 1252DD            LCALL    ?L?COM0009
B3:00A65B 9041C7            MOV      DPTR,#rxOpt+01H
B3:00A65E F0                MOVX     @DPTR,A
B3:00A65F 9041BE            MOV      DPTR,#src
B3:00A662 71E6              ACALL    ?L?COM0077
B3:00A664 9041C8            MOV      DPTR,#rxOpt+02H
B3:00A667 F0                MOVX     @DPTR,A
B3:00A668 E9                MOV      A,R1
B3:00A669 2406              ADD      A,#06H
B3:00A66B 1252DD            LCALL    ?L?COM0009
B3:00A66E 9041C9            MOV      DPTR,#rxOpt+03H
B3:00A671 F0                MOVX     @DPTR,A
B3:00A672 9041BE            MOV      DPTR,#src
B3:00A675 122552            LCALL    ?C?PLDXDATA
B3:00A678 1252DA            LCALL    ?L?COM0008
B3:00A67B 04                INC      A
B3:00A67C 9041CA            MOV      DPTR,#rxOpt+04H
B3:00A67F F0                MOVX     @DPTR,A
B3:00A680 C3                CLR      C
B3:00A681 9041C5            MOV      DPTR,#len+01H
B3:00A684 E0                MOVX     A,@DPTR
B3:00A685 9402              SUBB     A,#02H
B3:00A687 9041C4            MOV      DPTR,#len
B3:00A68A E0                MOVX     A,@DPTR
B3:00A68B 9400              SUBB     A,#00H
B3:00A68D 402D              JC       ?C0019?ZW_SECURITY_SCHEME2
B3:00A68F         ?C0018?ZW_SECURITY_SCHEME2:
B3:00A68F 9041BE            MOV      DPTR,#src
B3:00A692 122552            LCALL    ?C?PLDXDATA
B3:00A695 E9                MOV      A,R1
B3:00A696 2403              ADD      A,#03H
B3:00A698 1252DD            LCALL    ?L?COM0009
B3:00A69B 30E103            JNB      ACC.1,?C0020?ZW_SECURITY_SCHEME2
B3:00A69E 1219B2            LCALL    ?INTERBANK_TABLE?ZW_FollowUpReceived
B3:00A6A1         ?C0020?ZW_SECURITY_SCHEME2:
B3:00A6A1 9041C4            MOV      DPTR,#len
B3:00A6A4 A3                INC      DPTR
B3:00A6A5 E0                MOVX     A,@DPTR
B3:00A6A6 FD                MOV      R5,A
B3:00A6A7 7B01              MOV      R3,#01H
B3:00A6A9 7A41              MOV      R2,#HIGH rxOpt
B3:00A6AB 79C6              MOV      R1,#LOW rxOpt
B3:00A6AD 904470            MOV      DPTR,#?_ApplicationCommandHandler?BYTE+04H
B3:00A6B0 122572            LCALL    ?C?PSTXDATA
B3:00A6B3 9041C1            MOV      DPTR,#buf
B3:00A6B6 122552            LCALL    ?C?PLDXDATA
B3:00A6B9 121E80            LCALL    ?INTERBANK_TABLE?_ApplicationCommandHandler
B3:00A6BC         ?C0019?ZW_SECURITY_SCHEME2:
B3:00A6BC 22                RET      
----- FUNCTION ___S2_msg_received_event (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 769




----- FUNCTION ?L?COM045C (BEGIN) -----
B3:00A6BD 903FFC            MOV      DPTR,#buf
B3:00A6C0 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM045C (END) -------


----- FUNCTION ?L?COM030F (BEGIN) -----
B3:00A6C3 122572            LCALL    ?C?PSTXDATA
B3:00A6C6 903FFF            MOV      DPTR,#len
B3:00A6C9 E0                MOVX     A,@DPTR
B3:00A6CA FF                MOV      R7,A
B3:00A6CB A3                INC      DPTR
B3:00A6CC E0                MOVX     A,@DPTR
B3:00A6CD 22                RET      
----- FUNCTION ?L?COM030F (END) -------


----- FUNCTION ?L?COM0503 (BEGIN) -----
B3:00A6CE F0                MOVX     @DPTR,A
B3:00A6CF 904618            MOV      DPTR,#response_dsk
B3:00A6D2 122552            LCALL    ?C?PLDXDATA
B3:00A6D5 E9                MOV      A,R1
B3:00A6D6 22                RET      
----- FUNCTION ?L?COM0503 (END) -------


----- FUNCTION _ZW_AES_ecb (BEGIN) -----
B3:00A6D7 904301            MOV      DPTR,#bKey
B3:00A6DA 12E289            LCALL    ?L?COM04A4
B3:00A6DD         ?C0026?ZW_PHY_AES_050X:
B3:00A6DD E58F              MOV      A,AESCON1
B3:00A6DF 20E0FB            JB       ACC.0,?C0026?ZW_PHY_AES_050X
B3:00A6E2         ?C0027?ZW_PHY_AES_050X:
B3:00A6E2 12E297            LCALL    ?L?COM036E
;---- Variable 'i' assigned to Register 'R6' ----
B3:00A6E5 7E10              MOV      R6,#010H
B3:00A6E7         ?C0030?ZW_PHY_AES_050X:
B3:00A6E7 904304            MOV      DPTR,#bInput
B3:00A6EA 122552            LCALL    ?C?PLDXDATA
B3:00A6ED 1E                DEC      R6
B3:00A6EE F12D              ACALL    ?L?COM00BC
B3:00A6F0 F593              MOV      AESDATA,A
B3:00A6F2 EE                MOV      A,R6
B3:00A6F3 70F2              JNZ      ?C0030?ZW_PHY_AES_050X
B3:00A6F5 7E10              MOV      R6,#010H
B3:00A6F7         ?C0033?ZW_PHY_AES_050X:
B3:00A6F7 904301            MOV      DPTR,#bKey
B3:00A6FA 122552            LCALL    ?C?PLDXDATA
B3:00A6FD 1E                DEC      R6
B3:00A6FE F12D              ACALL    ?L?COM00BC
B3:00A700 F594              MOV      AESKEY,A
B3:00A702 EE                MOV      A,R6
B3:00A703 70F2              JNZ      ?C0033?ZW_PHY_AES_050X
B3:00A705 7F01              MOV      R7,#01H
B3:00A707 12E640            LCALL    _ZW_AES_enable
B3:00A70A         ?C0034?ZW_PHY_AES_050X:
B3:00A70A 12E681            LCALL    ZW_AES_active_get
B3:00A70D EF                MOV      A,R7
B3:00A70E 70FA              JNZ      ?C0034?ZW_PHY_AES_050X
B3:00A710         ?C0035?ZW_PHY_AES_050X:
B3:00A710 7E10              MOV      R6,#010H
B3:00A712         ?C0038?ZW_PHY_AES_050X:
B3:00A712 904307            MOV      DPTR,#bOutput
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 770


B3:00A715 122552            LCALL    ?C?PLDXDATA
B3:00A718 1E                DEC      R6
B3:00A719 8E82              MOV      DPL,R6
B3:00A71B 758300            MOV      DPH,#00H
B3:00A71E E593              MOV      A,AESDATA
B3:00A720 12204D            LCALL    ?C?CSTOPTR
B3:00A723 EE                MOV      A,R6
B3:00A724 70EC              JNZ      ?C0038?ZW_PHY_AES_050X
B3:00A726 22                RET      
----- FUNCTION _ZW_AES_ecb (END) -------


----- FUNCTION ?L?COM00BA (BEGIN) -----
B3:00A727 9043A5            MOV      DPTR,#b
B3:00A72A         ?L?COM00BB:
B3:00A72A 122552            LCALL    ?C?PLDXDATA
B3:00A72D         ?L?COM00BC:
B3:00A72D 8E82              MOV      DPL,R6
B3:00A72F         ?L?COM00BD:
B3:00A72F 758300            MOV      DPH,#00H
B3:00A732 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM00BA (END) -------


----- FUNCTION _ZW_UART_send_buf (BEGIN) -----
B3:00A735 9043A2            MOV      DPTR,#z
B3:00A738 F1EC              ACALL    ?L?COM0567
B3:00A73A 6401              XRL      A,#01H
B3:00A73C 7035              JNZ      ?C0020?ZW_UART_SUPPORT
B3:00A73E 9043A2            MOV      DPTR,#z
B3:00A741 122552            LCALL    ?C?PLDXDATA
B3:00A744 12E290            LCALL    ?L?COM0566
B3:00A747 9043A9            MOV      DPTR,#i
B3:00A74A F0                MOVX     @DPTR,A
B3:00A74B         ?C0021?ZW_UART_SUPPORT:
B3:00A74B 12CD12            LCALL    ?L?COM0239
B3:00A74E 501D              JNC      ?C0022?ZW_UART_SUPPORT
B3:00A750 F127              ACALL    ?L?COM00BA
B3:00A752 FF                MOV      R7,A
B3:00A753 12E14C            LCALL    _ZW_UART0_tx_send_hex
B3:00A756 F1A7              ACALL    ?L?COM03DA
B3:00A758 FF                MOV      R7,A
B3:00A759 BF0F04            CJNE     R7,#0FH,?C0024?ZW_UART_SUPPORT
B3:00A75C F1AE              ACALL    ZW_UART0_tx_send_nl
B3:00A75E 8005              SJMP     ?C0023?ZW_UART_SUPPORT
B3:00A760         ?C0024?ZW_UART_SUPPORT:
B3:00A760 7F20              MOV      R7,#020H
B3:00A762 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00A765         ?C0023?ZW_UART_SUPPORT:
B3:00A765 9043A9            MOV      DPTR,#i
B3:00A768 E0                MOVX     A,@DPTR
B3:00A769 04                INC      A
B3:00A76A F0                MOVX     @DPTR,A
B3:00A76B 80DE              SJMP     ?C0021?ZW_UART_SUPPORT
B3:00A76D         ?C0022?ZW_UART_SUPPORT:
B3:00A76D F1A7              ACALL    ?L?COM03DA
B3:00A76F 6035              JZ       ?C0034?ZW_UART_SUPPORT
B3:00A771 803B              SJMP     ZW_UART0_tx_send_nl
B3:00A773         ?C0020?ZW_UART_SUPPORT:
B3:00A773 9043A2            MOV      DPTR,#z
B3:00A776 122552            LCALL    ?C?PLDXDATA
B3:00A779 12E31E            LCALL    ?L?COM0565
B3:00A77C 9043A9            MOV      DPTR,#i
B3:00A77F F0                MOVX     @DPTR,A
B3:00A780         ?C0028?ZW_UART_SUPPORT:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 771


B3:00A780 12CD12            LCALL    ?L?COM0239
B3:00A783 501B              JNC      ?C0029?ZW_UART_SUPPORT
B3:00A785 F127              ACALL    ?L?COM00BA
B3:00A787 FF                MOV      R7,A
B3:00A788 F1D0              ACALL    _ZW_UART1_tx_send_hex
B3:00A78A F1A7              ACALL    ?L?COM03DA
B3:00A78C FF                MOV      R7,A
B3:00A78D BF0F04            CJNE     R7,#0FH,?C0031?ZW_UART_SUPPORT
B3:00A790 F1B8              ACALL    ZW_UART1_tx_send_nl
B3:00A792 8004              SJMP     ?C0030?ZW_UART_SUPPORT
B3:00A794         ?C0031?ZW_UART_SUPPORT:
B3:00A794 7F20              MOV      R7,#020H
B3:00A796 F1C8              ACALL    _ZW_UART1_tx_send_byte
B3:00A798         ?C0030?ZW_UART_SUPPORT:
B3:00A798 9043A9            MOV      DPTR,#i
B3:00A79B E0                MOVX     A,@DPTR
B3:00A79C 04                INC      A
B3:00A79D F0                MOVX     @DPTR,A
B3:00A79E 80E0              SJMP     ?C0028?ZW_UART_SUPPORT
B3:00A7A0         ?C0029?ZW_UART_SUPPORT:
B3:00A7A0 F1A7              ACALL    ?L?COM03DA
B3:00A7A2 6002              JZ       ?C0034?ZW_UART_SUPPORT
B3:00A7A4 F1B8              ACALL    ZW_UART1_tx_send_nl
B3:00A7A6         ?C0034?ZW_UART_SUPPORT:
B3:00A7A6 22                RET      
----- FUNCTION _ZW_UART_send_buf (END) -------


----- FUNCTION ?L?COM03DA (BEGIN) -----
B3:00A7A7 9043A9            MOV      DPTR,#i
B3:00A7AA E0                MOVX     A,@DPTR
B3:00A7AB 540F              ANL      A,#0FH
B3:00A7AD 22                RET      
----- FUNCTION ?L?COM03DA (END) -------


----- FUNCTION ZW_UART0_tx_send_nl (BEGIN) -----
B3:00A7AE 7F0D              MOV      R7,#0DH
B3:00A7B0 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00A7B3 7F0A              MOV      R7,#0AH
B3:00A7B5 026937            LJMP     _ZW_UART0_tx_send_byte
----- FUNCTION ZW_UART0_tx_send_nl (END) -------


----- FUNCTION ZW_UART1_tx_send_nl (BEGIN) -----
B3:00A7B8 7F0D              MOV      R7,#0DH
B3:00A7BA F1C8              ACALL    _ZW_UART1_tx_send_byte
B3:00A7BC 7F0A              MOV      R7,#0AH
B3:00A7BE 8008              SJMP     _ZW_UART1_tx_send_byte
----- FUNCTION ZW_UART1_tx_send_nl (END) -------


----- FUNCTION ?L?COM02C9 (BEGIN) -----
B3:00A7C0 E0                MOVX     A,@DPTR
B3:00A7C1 C4                SWAP     A
B3:00A7C2 540F              ANL      A,#0FH
B3:00A7C4         ?L?COM02CA:
B3:00A7C4 FF                MOV      R7,A
B3:00A7C5 12E0D9            LCALL    _nibble2hex
----- FUNCTION _ZW_UART1_tx_send_byte (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
B3:00A7C8         ?C0015?ZW_PHY_UART1_050X:
B3:00A7C8 E5ED              MOV      A,UARTSTAT
B3:00A7CA 20E4FB            JB       ACC.4,?C0015?ZW_PHY_UART1_050X
B3:00A7CD         ?C0016?ZW_PHY_UART1_050X:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 772


B3:00A7CD 8FEE              MOV      UART1BUF,R7
B3:00A7CF 22                RET      
----- FUNCTION _ZW_UART1_tx_send_byte (END) -------


----- FUNCTION _ZW_UART1_tx_send_hex (BEGIN) -----
B3:00A7D0 9046B6            MOV      DPTR,#bData
B3:00A7D3 EF                MOV      A,R7
B3:00A7D4 F0                MOVX     @DPTR,A
B3:00A7D5 F1C0              ACALL    ?L?COM02C9
B3:00A7D7 9046B6            MOV      DPTR,#bData
B3:00A7DA E0                MOVX     A,@DPTR
B3:00A7DB FF                MOV      R7,A
B3:00A7DC 12E0D9            LCALL    _nibble2hex
B3:00A7DF 80E7              SJMP     _ZW_UART1_tx_send_byte
----- FUNCTION _ZW_UART1_tx_send_hex (END) -------


----- FUNCTION _fe25519_cmov (BEGIN) -----
;---- Variable 'r' assigned to Register 'R6/R7' ----
;---- Variable 'b' assigned to Register 'R3' ----
;---- Variable 'x' assigned to Register 'R4/R5' ----
B3:00A7E1 904367            MOV      DPTR,#?_bigint_cmov?BYTE+05H
B3:00A7E4 7420              MOV      A,#020H
B3:00A7E6 F0                MOVX     @DPTR,A
B3:00A7E7 021B74            LJMP     ?INTERBANK_TABLE?_bigint_cmov
----- FUNCTION _fe25519_cmov (END) -------


----- FUNCTION _ZW_SetSecurityS2InclusionPublicDSK_CSA (BEGIN) -----
;---- Variable 'response' assigned to Register 'R1/R2/R3' ----
B3:00A7EA 812C              AJMP     _s2_inclusion_set_public_csa_dsk
----- FUNCTION _ZW_SetSecurityS2InclusionPublicDSK_CSA (END) -------


----- FUNCTION ?L?COM0567 (BEGIN) -----
B3:00A7EC 122572            LCALL    ?C?PSTXDATA
B3:00A7EF 901229            MOV      DPTR,#bNVRUartPinSwap
B3:00A7F2 E0                MOVX     A,@DPTR
B3:00A7F3 22                RET      
----- FUNCTION ?L?COM0567 (END) -------


----- FUNCTION _fe25519_setzero (BEGIN) -----
;---- Variable 'r' assigned to Register 'R6/R7' ----
;---- Variable 'i' assigned to Register 'R5' ----
B3:00A7F4 E4                CLR      A
B3:00A7F5 FD                MOV      R5,A
B3:00A7F6         ?C0023?FE25519:
B3:00A7F6 EF                MOV      A,R7
B3:00A7F7 12A8B6            LCALL    ?L?COM0093
B3:00A7FA E4                CLR      A
B3:00A7FB F0                MOVX     @DPTR,A
B3:00A7FC 0D                INC      R5
B3:00A7FD ED                MOV      A,R5
B3:00A7FE B420F5            CJNE     A,#020H,?C0023?FE25519
B3:00A801 22                RET      
----- FUNCTION _fe25519_setzero (END) -------


----- FUNCTION _sec0_persist_netkey (BEGIN) -----
;---- Variable 'netkey' assigned to Register 'R1/R2/R3' ----
B3:00A802 7F80              MOV      R7,#080H
B3:00A804 021B06            LJMP     ?INTERBANK_TABLE?_keystore_network_key_write
----- FUNCTION _sec0_persist_netkey (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 773




----- FUNCTION SampleNoiseLevel (BEGIN) -----
B3:00A807 126481            LCALL    RF_mode_get
B3:00A80A EF                MOV      A,R7
B3:00A80B 6401              XRL      A,#01H
B3:00A80D 7067              JNZ      ?C0004?ZW_NOISE_DETECT
B3:00A80F         ?C0003?ZW_NOISE_DETECT:
B3:00A80F 1267FD            LCALL    RF_channel_get
B3:00A812 904685            MOV      DPTR,#currentChannel
B3:00A815 EF                MOV      A,R7
B3:00A816 F0                MOVX     @DPTR,A
B3:00A817 D3                SETB     C
B3:00A818 9402              SUBB     A,#02H
B3:00A81A 505A              JNC      ?C0004?ZW_NOISE_DETECT
B3:00A81C         ?C0005?ZW_NOISE_DETECT:
B3:00A81C 904433            MOV      DPTR,#bNextChannelToSample
B3:00A81F E0                MOVX     A,@DPTR
B3:00A820 FF                MOV      R7,A
B3:00A821 904685            MOV      DPTR,#currentChannel
B3:00A824 E0                MOVX     A,@DPTR
B3:00A825 6F                XRL      A,R7
B3:00A826 704E              JNZ      ?C0004?ZW_NOISE_DETECT
B3:00A828         ?C0006?ZW_NOISE_DETECT:
B3:00A828 1261AA            LCALL    RF_instant_rssi_get
B3:00A82B 904686            MOV      DPTR,#rssi_value
B3:00A82E EF                MOV      A,R7
B3:00A82F F0                MOVX     @DPTR,A
B3:00A830 7B01              MOV      R3,#01H
B3:00A832 7A46              MOV      R2,#HIGH rssi_value
B3:00A834 7986              MOV      R1,#LOW rssi_value
B3:00A836 7D01              MOV      R5,#01H
B3:00A838 12198F            LCALL    ?INTERBANK_TABLE?_CalculateRssi
B3:00A83B 904685            MOV      DPTR,#currentChannel
B3:00A83E E0                MOVX     A,@DPTR
B3:00A83F 242F              ADD      A,#LOW sInternal_noise_levels
B3:00A841 F582              MOV      DPL,A
B3:00A843 E4                CLR      A
B3:00A844 3444              ADDC     A,#HIGH sInternal_noise_levels
B3:00A846 F583              MOV      DPH,A
B3:00A848 EF                MOV      A,R7
B3:00A849 F0                MOVX     @DPTR,A
B3:00A84A 904433            MOV      DPTR,#bNextChannelToSample
B3:00A84D E0                MOVX     A,@DPTR
B3:00A84E 04                INC      A
B3:00A84F 5401              ANL      A,#01H
B3:00A851 F0                MOVX     @DPTR,A
B3:00A852 7022              JNZ      ?C0004?ZW_NOISE_DETECT
B3:00A854 904431            MOV      DPTR,#_cbFuncNoiseDetect
B3:00A857 E0                MOVX     A,@DPTR
B3:00A858 7002              JNZ      ?C0011?ZW_NOISE_DETECT
B3:00A85A A3                INC      DPTR
B3:00A85B E0                MOVX     A,@DPTR
B3:00A85C         ?C0011?ZW_NOISE_DETECT:
B3:00A85C 6018              JZ       ?C0004?ZW_NOISE_DETECT
B3:00A85E 7B01              MOV      R3,#01H
B3:00A860 7A44              MOV      R2,#HIGH cb_shadow_noise_levels
B3:00A862 792D              MOV      R1,#LOW cb_shadow_noise_levels
B3:00A864 12CA5B            LCALL    _ZW_GetBackgroundRSSI
B3:00A867 7B01              MOV      R3,#01H
B3:00A869 7A44              MOV      R2,#HIGH cb_shadow_noise_levels
B3:00A86B 792D              MOV      R1,#LOW cb_shadow_noise_levels
B3:00A86D 904431            MOV      DPTR,#_cbFuncNoiseDetect
B3:00A870 12BE72            LCALL    ?L?COM00C0
B3:00A873 1226E3            LCALL    ?C?ICALL2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 774


B3:00A876         ?C0004?ZW_NOISE_DETECT:
B3:00A876 22                RET      
----- FUNCTION SampleNoiseLevel (END) -------


----- FUNCTION _secure_learnIface_raise_tx_fail (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00A877 900024            MOV      DPTR,#024H
B3:00A87A 7401              MOV      A,#01H
B3:00A87C 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_tx_fail (END) -------


----- FUNCTION NoiseDetectSetDefault (BEGIN) -----
B3:00A87F 22                RET      
----- FUNCTION NoiseDetectSetDefault (END) -------


----- FUNCTION _s2_inclusion_init (BEGIN) -----
;---- Variable 'schemes' assigned to Register 'R7' ----
;---- Variable 'keys' assigned to Register 'R3' ----
;---- Variable 'curves' assigned to Register 'R5' ----
B3:00A880 EF                MOV      A,R7
B3:00A881 6402              XRL      A,#02H
B3:00A883 6003              JZ       ?C0088?S2_INCLUSION
B3:00A885 7F02              MOV      R7,#02H
B3:00A887 22                RET      
B3:00A888         ?C0088?S2_INCLUSION:
B3:00A888 ED                MOV      A,R5
B3:00A889 6401              XRL      A,#01H
B3:00A88B 6003              JZ       ?C0090?S2_INCLUSION
B3:00A88D 7F03              MOV      R7,#03H
B3:00A88F 22                RET      
B3:00A890         ?C0090?S2_INCLUSION:
B3:00A890 EB                MOV      A,R3
B3:00A891 5478              ANL      A,#078H
B3:00A893 7005              JNZ      ?C0092?S2_INCLUSION
B3:00A895 EB                MOV      A,R3
B3:00A896 5487              ANL      A,#087H
B3:00A898 7003              JNZ      ?C0091?S2_INCLUSION
B3:00A89A         ?C0092?S2_INCLUSION:
B3:00A89A 7F01              MOV      R7,#01H
B3:00A89C 22                RET      
B3:00A89D         ?C0091?S2_INCLUSION:
B3:00A89D 902DFE            MOV      DPTR,#m_schemes
B3:00A8A0 EF                MOV      A,R7
B3:00A8A1 F0                MOVX     @DPTR,A
B3:00A8A2 90300E            MOV      DPTR,#m_curves
B3:00A8A5 ED                MOV      A,R5
B3:00A8A6 F0                MOVX     @DPTR,A
B3:00A8A7 902DFD            MOV      DPTR,#m_keys
B3:00A8AA EB                MOV      A,R3
B3:00A8AB F0                MOVX     @DPTR,A
B3:00A8AC 7F00              MOV      R7,#00H
B3:00A8AE 22                RET      
----- FUNCTION _s2_inclusion_init (END) -------


----- FUNCTION ?L?COM0091 (BEGIN) -----
B3:00A8AF 900AAA            MOV      DPTR,#r
B3:00A8B2         ?L?COM0092:
B3:00A8B2 E0                MOVX     A,@DPTR
B3:00A8B3 FE                MOV      R6,A
B3:00A8B4 A3                INC      DPTR
B3:00A8B5 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 775


B3:00A8B6         ?L?COM0093:
B3:00A8B6 2D                ADD      A,R5
B3:00A8B7         ?L?COM0094:
B3:00A8B7 F582              MOV      DPL,A
B3:00A8B9 E4                CLR      A
B3:00A8BA 3E                ADDC     A,R6
B3:00A8BB F583              MOV      DPH,A
B3:00A8BD 22                RET      
----- FUNCTION ?L?COM0091 (END) -------


----- FUNCTION ?L?COM0414 (BEGIN) -----
B3:00A8BE 7C06              MOV      R4,#HIGH t1
B3:00A8C0 7D45              MOV      R5,#LOW t1
B3:00A8C2 7A05              MOV      R2,#HIGH z2_50_0
B3:00A8C4 7BE5              MOV      R3,#LOW z2_50_0
----- FUNCTION _fe25519_mul (BEGIN) -----
B3:00A8C6 9008B0            MOV      DPTR,#r
B3:00A8C9 123C23            LCALL    ?L?COM0146
B3:00A8CC 126EBF            LCALL    ?L?COM0349
B3:00A8CF EA                MOV      A,R2
B3:00A8D0 F0                MOVX     @DPTR,A
B3:00A8D1 A3                INC      DPTR
B3:00A8D2 EB                MOV      A,R3
B3:00A8D3 F0                MOVX     @DPTR,A
B3:00A8D4 E4                CLR      A
B3:00A8D5 9008F6            MOV      DPTR,#UV
B3:00A8D8 F0                MOVX     @DPTR,A
B3:00A8D9 A3                INC      DPTR
B3:00A8DA F0                MOVX     @DPTR,A
B3:00A8DB 1237E6            LCALL    ZW_WatchDogKick
B3:00A8DE 7E08              MOV      R6,#HIGH t
B3:00A8E0 7FB6              MOV      R7,#LOW t
B3:00A8E2 9008B2            MOV      DPTR,#a
B3:00A8E5 E0                MOVX     A,@DPTR
B3:00A8E6 FC                MOV      R4,A
B3:00A8E7 A3                INC      DPTR
B3:00A8E8 E0                MOVX     A,@DPTR
B3:00A8E9 FD                MOV      R5,A
B3:00A8EA 124E64            LCALL    ?L?COM01AD
B3:00A8ED 121B6F            LCALL    ?INTERBANK_TABLE?_bigint_mul32
;---- Variable 'i' assigned to Register 'R5' ----
B3:00A8F0 E4                CLR      A
B3:00A8F1 FD                MOV      R5,A
B3:00A8F2         ?C0012?FE25519:
B3:00A8F2 12EDA6            LCALL    ?L?COM0415
B3:00A8F5 FC                MOV      R4,A
B3:00A8F6 75F004            MOV      B,#04H
B3:00A8F9 A4                MUL      AB
B3:00A8FA FB                MOV      R3,A
B3:00A8FB AAF0              MOV      R2,B
B3:00A8FD EC                MOV      A,R4
B3:00A8FE 75F020            MOV      B,#020H
B3:00A901 A4                MUL      AB
B3:00A902 2B                ADD      A,R3
B3:00A903 FB                MOV      R3,A
B3:00A904 E5F0              MOV      A,B
B3:00A906 3A                ADDC     A,R2
B3:00A907 FA                MOV      R2,A
B3:00A908 12EDA6            LCALL    ?L?COM0415
B3:00A90B 25E0              ADD      A,ACC
B3:00A90D FF                MOV      R7,A
B3:00A90E E4                CLR      A
B3:00A90F 33                RLC      A
B3:00A910 FE                MOV      R6,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 776


B3:00A911 EB                MOV      A,R3
B3:00A912 2F                ADD      A,R7
B3:00A913 FB                MOV      R3,A
B3:00A914 EA                MOV      A,R2
B3:00A915 3E                ADDC     A,R6
B3:00A916 FA                MOV      R2,A
B3:00A917 9008F6            MOV      DPTR,#UV
B3:00A91A E0                MOVX     A,@DPTR
B3:00A91B 7E00              MOV      R6,#00H
B3:00A91D 2B                ADD      A,R3
B3:00A91E FF                MOV      R7,A
B3:00A91F EE                MOV      A,R6
B3:00A920 3A                ADDC     A,R2
B3:00A921 FE                MOV      R6,A
B3:00A922 74B6              MOV      A,#LOW t
B3:00A924 2D                ADD      A,R5
B3:00A925 F582              MOV      DPL,A
B3:00A927 E4                CLR      A
B3:00A928 3408              ADDC     A,#HIGH t
B3:00A92A F583              MOV      DPH,A
B3:00A92C E0                MOVX     A,@DPTR
B3:00A92D 7A00              MOV      R2,#00H
B3:00A92F 2F                ADD      A,R7
B3:00A930 FF                MOV      R7,A
B3:00A931 EA                MOV      A,R2
B3:00A932 3E                ADDC     A,R6
B3:00A933 9008F6            MOV      DPTR,#UV
B3:00A936 F0                MOVX     @DPTR,A
B3:00A937 A3                INC      DPTR
B3:00A938 EF                MOV      A,R7
B3:00A939 F0                MOVX     @DPTR,A
B3:00A93A 9008B0            MOV      DPTR,#r
B3:00A93D 91C2              ACALL    ?L?COM0391
B3:00A93F 0D                INC      R5
B3:00A940 ED                MOV      A,R5
B3:00A941 B420AE            CJNE     A,#020H,?C0012?FE25519
B3:00A944         ?C0013?FE25519:
B3:00A944 9008F6            MOV      DPTR,#UV
B3:00A947 126FF8            LCALL    ?L?COM0498
B3:00A94A 75F026            MOV      B,#026H
B3:00A94D A4                MUL      AB
B3:00A94E FF                MOV      R7,A
B3:00A94F 9008F6            MOV      DPTR,#UV
B3:00A952 71EE              ACALL    ?L?COM0067
B3:00A954 E4                CLR      A
B3:00A955 FD                MOV      R5,A
B3:00A956         ?C0015?FE25519:
B3:00A956 91B9              ACALL    ?L?COM04F8
B3:00A958 11B6              ACALL    ?L?COM0093
B3:00A95A 12EDB2            LCALL    ?L?COM0308
B3:00A95D FC                MOV      R4,A
B3:00A95E EF                MOV      A,R7
B3:00A95F 11B6              ACALL    ?L?COM0093
B3:00A961 EC                MOV      A,R4
B3:00A962 F0                MOVX     @DPTR,A
B3:00A963 9008F6            MOV      DPTR,#UV
B3:00A966 E0                MOVX     A,@DPTR
B3:00A967 71C3              ACALL    ?L?COM00EF
B3:00A969 B420EA            CJNE     A,#020H,?C0015?FE25519
B3:00A96C         ?C0016?FE25519:
B3:00A96C 9008F6            MOV      DPTR,#UV
B3:00A96F 7168              ACALL    ?L?COM0556
B3:00A971 9008F6            MOV      DPTR,#UV
B3:00A974 71EE              ACALL    ?L?COM0067
B3:00A976 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 777


B3:00A977 FD                MOV      R5,A
B3:00A978         ?C0018?FE25519:
B3:00A978 91B9              ACALL    ?L?COM04F8
B3:00A97A 11B6              ACALL    ?L?COM0093
B3:00A97C 12EDB2            LCALL    ?L?COM0308
B3:00A97F FC                MOV      R4,A
B3:00A980 EF                MOV      A,R7
B3:00A981 11B6              ACALL    ?L?COM0093
B3:00A983 EC                MOV      A,R4
B3:00A984 F0                MOVX     @DPTR,A
B3:00A985 9008F6            MOV      DPTR,#UV
B3:00A988 E0                MOVX     A,@DPTR
B3:00A989 71C3              ACALL    ?L?COM00EF
B3:00A98B B403EA            CJNE     A,#03H,?C0018?FE25519
B3:00A98E 22                RET      
----- FUNCTION _fe25519_mul (END) -------


----- FUNCTION ?L?COM0035 (BEGIN) -----
B3:00A98F 31AD              ACALL    _fe25519_square
B3:00A991 7E06              MOV      R6,#HIGH t1
B3:00A993 7F45              MOV      R7,#LOW t1
B3:00A995 7C06              MOV      R4,#HIGH t0
B3:00A997 7D25              MOV      R5,#LOW t0
B3:00A999 31AD              ACALL    _fe25519_square
B3:00A99B         ?L?COM0036:
B3:00A99B 7E06              MOV      R6,#HIGH t0
B3:00A99D 7F25              MOV      R7,#LOW t0
B3:00A99F 7C06              MOV      R4,#HIGH t1
B3:00A9A1 7D45              MOV      R5,#LOW t1
B3:00A9A3         ?L?COM0037:
B3:00A9A3 31AD              ACALL    _fe25519_square
B3:00A9A5         ?L?COM0038:
B3:00A9A5 7E06              MOV      R6,#HIGH t1
B3:00A9A7 7F45              MOV      R7,#LOW t1
B3:00A9A9 7C06              MOV      R4,#HIGH t0
B3:00A9AB 7D25              MOV      R5,#LOW t0
----- FUNCTION _fe25519_square (BEGIN) -----
;---- Variable 'x' assigned to Register 'R2/R3' ----
B3:00A9AD AB05              MOV      R3,AR5
B3:00A9AF AA04              MOV      R2,AR4
;---- Variable 'r' assigned to Register 'R6/R7' ----
B3:00A9B1 01C6              AJMP     _fe25519_mul
----- FUNCTION _fe25519_square (END) -------


----- FUNCTION _fe25519_invert (BEGIN) -----
B3:00A9B3 900521            MOV      DPTR,#r
B3:00A9B6 123C23            LCALL    ?L?COM0146
B3:00A9B9 EC                MOV      A,R4
B3:00A9BA F0                MOVX     @DPTR,A
B3:00A9BB A3                INC      DPTR
B3:00A9BC ED                MOV      A,R5
B3:00A9BD F0                MOVX     @DPTR,A
B3:00A9BE 7E05              MOV      R6,#HIGH z2
B3:00A9C0 7F25              MOV      R7,#LOW z2
B3:00A9C2 31AD              ACALL    _fe25519_square
B3:00A9C4 7E06              MOV      R6,#HIGH t1
B3:00A9C6 7F45              MOV      R7,#LOW t1
B3:00A9C8 7C05              MOV      R4,#HIGH z2
B3:00A9CA 7D25              MOV      R5,#LOW z2
B3:00A9CC 31AD              ACALL    _fe25519_square
B3:00A9CE 7E06              MOV      R6,#HIGH t0
B3:00A9D0 7F25              MOV      R7,#LOW t0
B3:00A9D2 7C06              MOV      R4,#HIGH t1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 778


B3:00A9D4 7D45              MOV      R5,#LOW t1
B3:00A9D6 31AD              ACALL    _fe25519_square
B3:00A9D8 7E05              MOV      R6,#HIGH z9
B3:00A9DA 7F45              MOV      R7,#LOW z9
B3:00A9DC 7C06              MOV      R4,#HIGH t0
B3:00A9DE 7D25              MOV      R5,#LOW t0
B3:00A9E0 900523            MOV      DPTR,#x
B3:00A9E3 E0                MOVX     A,@DPTR
B3:00A9E4 FA                MOV      R2,A
B3:00A9E5 A3                INC      DPTR
B3:00A9E6 E0                MOVX     A,@DPTR
B3:00A9E7 FB                MOV      R3,A
B3:00A9E8 11C6              ACALL    _fe25519_mul
B3:00A9EA 7E05              MOV      R6,#HIGH z11
B3:00A9EC 7F65              MOV      R7,#LOW z11
B3:00A9EE 7C05              MOV      R4,#HIGH z9
B3:00A9F0 7D45              MOV      R5,#LOW z9
B3:00A9F2 7A05              MOV      R2,#HIGH z2
B3:00A9F4 7B25              MOV      R3,#LOW z2
B3:00A9F6 11C6              ACALL    _fe25519_mul
B3:00A9F8 7E06              MOV      R6,#HIGH t0
B3:00A9FA 7F25              MOV      R7,#LOW t0
B3:00A9FC 7C05              MOV      R4,#HIGH z11
B3:00A9FE 7D65              MOV      R5,#LOW z11
B3:00AA00 31AD              ACALL    _fe25519_square
B3:00AA02 7E05              MOV      R6,#HIGH z2_5_0
B3:00AA04 7F85              MOV      R7,#LOW z2_5_0
B3:00AA06 7C06              MOV      R4,#HIGH t0
B3:00AA08 7D25              MOV      R5,#LOW t0
B3:00AA0A 7A05              MOV      R2,#HIGH z9
B3:00AA0C 7B45              MOV      R3,#LOW z9
B3:00AA0E 11C6              ACALL    _fe25519_mul
B3:00AA10 7E06              MOV      R6,#HIGH t0
B3:00AA12 7F25              MOV      R7,#LOW t0
B3:00AA14 7C05              MOV      R4,#HIGH z2_5_0
B3:00AA16 7D85              MOV      R5,#LOW z2_5_0
B3:00AA18 318F              ACALL    ?L?COM0035
B3:00AA1A 7E06              MOV      R6,#HIGH t0
B3:00AA1C 7F25              MOV      R7,#LOW t0
B3:00AA1E 7C06              MOV      R4,#HIGH t1
B3:00AA20 7D45              MOV      R5,#LOW t1
B3:00AA22 31AD              ACALL    _fe25519_square
B3:00AA24 7E05              MOV      R6,#HIGH z2_10_0
B3:00AA26 7FA5              MOV      R7,#LOW z2_10_0
B3:00AA28 7C06              MOV      R4,#HIGH t0
B3:00AA2A 7D25              MOV      R5,#LOW t0
B3:00AA2C 7A05              MOV      R2,#HIGH z2_5_0
B3:00AA2E 7B85              MOV      R3,#LOW z2_5_0
B3:00AA30 11C6              ACALL    _fe25519_mul
B3:00AA32 7E06              MOV      R6,#HIGH t0
B3:00AA34 7F25              MOV      R7,#LOW t0
B3:00AA36 7C05              MOV      R4,#HIGH z2_10_0
B3:00AA38 7DA5              MOV      R5,#LOW z2_10_0
B3:00AA3A 31A3              ACALL    ?L?COM0037
B3:00AA3C 717A              ACALL    ?L?COM0224
B3:00AA3E         ?C0041?FE25519:
B3:00AA3E 91B1              ACALL    ?L?COM0555
B3:00AA40 5007              JNC      ?C0042?FE25519
B3:00AA42 319B              ACALL    ?L?COM0036
B3:00AA44 718B              ACALL    ?L?COM0226
B3:00AA46 F0                MOVX     @DPTR,A
B3:00AA47 80F5              SJMP     ?C0041?FE25519
B3:00AA49         ?C0042?FE25519:
B3:00AA49 7E05              MOV      R6,#HIGH z2_20_0
B3:00AA4B 7FC5              MOV      R7,#LOW z2_20_0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 779


B3:00AA4D 7C06              MOV      R4,#HIGH t1
B3:00AA4F 7D45              MOV      R5,#LOW t1
B3:00AA51 7A05              MOV      R2,#HIGH z2_10_0
B3:00AA53 7BA5              MOV      R3,#LOW z2_10_0
B3:00AA55 11C6              ACALL    _fe25519_mul
B3:00AA57 7E06              MOV      R6,#HIGH t0
B3:00AA59 7F25              MOV      R7,#LOW t0
B3:00AA5B 7C05              MOV      R4,#HIGH z2_20_0
B3:00AA5D 7DC5              MOV      R5,#LOW z2_20_0
B3:00AA5F 31A3              ACALL    ?L?COM0037
B3:00AA61 717A              ACALL    ?L?COM0224
B3:00AA63         ?C0044?FE25519:
B3:00AA63 900665            MOV      DPTR,#i
B3:00AA66 E0                MOVX     A,@DPTR
B3:00AA67 C3                CLR      C
B3:00AA68 9414              SUBB     A,#014H
B3:00AA6A 5007              JNC      ?C0045?FE25519
B3:00AA6C 319B              ACALL    ?L?COM0036
B3:00AA6E 718B              ACALL    ?L?COM0226
B3:00AA70 F0                MOVX     @DPTR,A
B3:00AA71 80F0              SJMP     ?C0044?FE25519
B3:00AA73         ?C0045?FE25519:
B3:00AA73 7E06              MOV      R6,#HIGH t0
B3:00AA75 7F25              MOV      R7,#LOW t0
B3:00AA77 7C06              MOV      R4,#HIGH t1
B3:00AA79 7D45              MOV      R5,#LOW t1
B3:00AA7B 7A05              MOV      R2,#HIGH z2_20_0
B3:00AA7D 7BC5              MOV      R3,#LOW z2_20_0
B3:00AA7F 11C6              ACALL    _fe25519_mul
B3:00AA81 31A5              ACALL    ?L?COM0038
B3:00AA83 7170              ACALL    ?L?COM0223
B3:00AA85         ?C0047?FE25519:
B3:00AA85 91B1              ACALL    ?L?COM0555
B3:00AA87 5007              JNC      ?C0048?FE25519
B3:00AA89 31A5              ACALL    ?L?COM0038
B3:00AA8B 7181              ACALL    ?L?COM0225
B3:00AA8D F0                MOVX     @DPTR,A
B3:00AA8E 80F5              SJMP     ?C0047?FE25519
B3:00AA90         ?C0048?FE25519:
B3:00AA90 7E05              MOV      R6,#HIGH z2_50_0
B3:00AA92 7FE5              MOV      R7,#LOW z2_50_0
B3:00AA94 7C06              MOV      R4,#HIGH t0
B3:00AA96 7D25              MOV      R5,#LOW t0
B3:00AA98 7A05              MOV      R2,#HIGH z2_10_0
B3:00AA9A 7BA5              MOV      R3,#LOW z2_10_0
B3:00AA9C 11C6              ACALL    _fe25519_mul
B3:00AA9E 7E06              MOV      R6,#HIGH t0
B3:00AAA0 7F25              MOV      R7,#LOW t0
B3:00AAA2 7C05              MOV      R4,#HIGH z2_50_0
B3:00AAA4 7DE5              MOV      R5,#LOW z2_50_0
B3:00AAA6 31A3              ACALL    ?L?COM0037
B3:00AAA8 717A              ACALL    ?L?COM0224
B3:00AAAA         ?C0050?FE25519:
B3:00AAAA 900665            MOV      DPTR,#i
B3:00AAAD E0                MOVX     A,@DPTR
B3:00AAAE C3                CLR      C
B3:00AAAF 9432              SUBB     A,#032H
B3:00AAB1 5007              JNC      ?C0051?FE25519
B3:00AAB3 319B              ACALL    ?L?COM0036
B3:00AAB5 718B              ACALL    ?L?COM0226
B3:00AAB7 F0                MOVX     @DPTR,A
B3:00AAB8 80F0              SJMP     ?C0050?FE25519
B3:00AABA         ?C0051?FE25519:
B3:00AABA 7E06              MOV      R6,#HIGH z2_100_0
B3:00AABC 7F05              MOV      R7,#LOW z2_100_0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 780


B3:00AABE 11BE              ACALL    ?L?COM0414
B3:00AAC0 7E06              MOV      R6,#HIGH t1
B3:00AAC2 7F45              MOV      R7,#LOW t1
B3:00AAC4 7C06              MOV      R4,#HIGH z2_100_0
B3:00AAC6 7D05              MOV      R5,#LOW z2_100_0
B3:00AAC8 31AD              ACALL    _fe25519_square
B3:00AACA 7170              ACALL    ?L?COM0223
B3:00AACC         ?C0053?FE25519:
B3:00AACC 900665            MOV      DPTR,#i
B3:00AACF E0                MOVX     A,@DPTR
B3:00AAD0 C3                CLR      C
B3:00AAD1 9464              SUBB     A,#064H
B3:00AAD3 5007              JNC      ?C0054?FE25519
B3:00AAD5 31A5              ACALL    ?L?COM0038
B3:00AAD7 7181              ACALL    ?L?COM0225
B3:00AAD9 F0                MOVX     @DPTR,A
B3:00AADA 80F0              SJMP     ?C0053?FE25519
B3:00AADC         ?C0054?FE25519:
B3:00AADC 7E06              MOV      R6,#HIGH t1
B3:00AADE 7F45              MOV      R7,#LOW t1
B3:00AAE0 7C06              MOV      R4,#HIGH t0
B3:00AAE2 7D25              MOV      R5,#LOW t0
B3:00AAE4 7A06              MOV      R2,#HIGH z2_100_0
B3:00AAE6 7B05              MOV      R3,#LOW z2_100_0
B3:00AAE8 11C6              ACALL    _fe25519_mul
B3:00AAEA 319B              ACALL    ?L?COM0036
B3:00AAEC 717A              ACALL    ?L?COM0224
B3:00AAEE         ?C0056?FE25519:
B3:00AAEE 900665            MOV      DPTR,#i
B3:00AAF1 E0                MOVX     A,@DPTR
B3:00AAF2 C3                CLR      C
B3:00AAF3 9432              SUBB     A,#032H
B3:00AAF5 5007              JNC      ?C0057?FE25519
B3:00AAF7 319B              ACALL    ?L?COM0036
B3:00AAF9 718B              ACALL    ?L?COM0226
B3:00AAFB F0                MOVX     @DPTR,A
B3:00AAFC 80F0              SJMP     ?C0056?FE25519
B3:00AAFE         ?C0057?FE25519:
B3:00AAFE 7E06              MOV      R6,#HIGH t0
B3:00AB00 7F25              MOV      R7,#LOW t0
B3:00AB02 11BE              ACALL    ?L?COM0414
B3:00AB04 31A5              ACALL    ?L?COM0038
B3:00AB06 7E06              MOV      R6,#HIGH t0
B3:00AB08 7F25              MOV      R7,#LOW t0
B3:00AB0A 7C06              MOV      R4,#HIGH t1
B3:00AB0C 7D45              MOV      R5,#LOW t1
B3:00AB0E 318F              ACALL    ?L?COM0035
B3:00AB10 900521            MOV      DPTR,#r
B3:00AB13 E0                MOVX     A,@DPTR
B3:00AB14 FE                MOV      R6,A
B3:00AB15 A3                INC      DPTR
B3:00AB16 E0                MOVX     A,@DPTR
B3:00AB17 FF                MOV      R7,A
B3:00AB18 7C06              MOV      R4,#HIGH t1
B3:00AB1A 7D45              MOV      R5,#LOW t1
B3:00AB1C 7A05              MOV      R2,#HIGH z11
B3:00AB1E 7B65              MOV      R3,#LOW z11
B3:00AB20 01C6              AJMP     _fe25519_mul
----- FUNCTION _fe25519_invert (END) -------


----- FUNCTION _fe25519_sub (BEGIN) -----
B3:00AB22 900AAA            MOV      DPTR,#r
B3:00AB25 EE                MOV      A,R6
B3:00AB26 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 781


B3:00AB27 A3                INC      DPTR
B3:00AB28 EF                MOV      A,R7
B3:00AB29 F0                MOVX     @DPTR,A
;---- Variable 'b' assigned to Register 'R2/R3' ----
;---- Variable 'a' assigned to Register 'R4/R5' ----
B3:00AB2A 900AAA            MOV      DPTR,#r
B3:00AB2D E0                MOVX     A,@DPTR
B3:00AB2E FE                MOV      R6,A
B3:00AB2F A3                INC      DPTR
B3:00AB30 E0                MOVX     A,@DPTR
B3:00AB31 FF                MOV      R7,A
B3:00AB32 9042F5            MOV      DPTR,#?_bigint_sub?BYTE+06H
B3:00AB35 7420              MOV      A,#020H
B3:00AB37 F0                MOVX     @DPTR,A
B3:00AB38 121B6A            LCALL    ?INTERBANK_TABLE?_bigint_sub
;---- Variable 'borrow' assigned to Register 'R7' ----
B3:00AB3B EF                MOV      A,R7
B3:00AB3C 75F026            MOV      B,#026H
B3:00AB3F A4                MUL      AB
B3:00AB40 FF                MOV      R7,A
B3:00AB41 900AAC            MOV      DPTR,#tmp
B3:00AB44 71EE              ACALL    ?L?COM0067
;---- Variable 'i' assigned to Register 'R5' ----
B3:00AB46 E4                CLR      A
B3:00AB47 FD                MOV      R5,A
B3:00AB48         ?C0005?FE25519:
B3:00AB48 11AF              ACALL    ?L?COM0091
B3:00AB4A 7192              ACALL    ?L?COM00EE
B3:00AB4C B420F9            CJNE     A,#020H,?C0005?FE25519
B3:00AB4F         ?C0006?FE25519:
B3:00AB4F 900AAC            MOV      DPTR,#tmp
B3:00AB52 7168              ACALL    ?L?COM0556
B3:00AB54 900AAC            MOV      DPTR,#tmp
B3:00AB57 71EE              ACALL    ?L?COM0067
B3:00AB59 E4                CLR      A
B3:00AB5A FD                MOV      R5,A
B3:00AB5B         ?C0008?FE25519:
B3:00AB5B 11AF              ACALL    ?L?COM0091
B3:00AB5D 7192              ACALL    ?L?COM00EE
B3:00AB5F B403F9            CJNE     A,#03H,?C0008?FE25519
B3:00AB62 22                RET      
----- FUNCTION _fe25519_sub (END) -------


----- FUNCTION sec0_clear_netkey (BEGIN) -----
B3:00AB63 7F80              MOV      R7,#080H
B3:00AB65 021AFC            LJMP     ?INTERBANK_TABLE?_keystore_network_key_clear
----- FUNCTION sec0_clear_netkey (END) -------


----- FUNCTION ?L?COM0556 (BEGIN) -----
B3:00AB68 A3                INC      DPTR
B3:00AB69 E0                MOVX     A,@DPTR
B3:00AB6A 75F026            MOV      B,#026H
B3:00AB6D A4                MUL      AB
B3:00AB6E FF                MOV      R7,A
B3:00AB6F 22                RET      
----- FUNCTION ?L?COM0556 (END) -------


----- FUNCTION ?L?COM0223 (BEGIN) -----
B3:00AB70 7E06              MOV      R6,#HIGH t0
B3:00AB72 7F25              MOV      R7,#LOW t0
B3:00AB74 7C06              MOV      R4,#HIGH t1
B3:00AB76 7D45              MOV      R5,#LOW t1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 782


B3:00AB78 31AD              ACALL    _fe25519_square
B3:00AB7A         ?L?COM0224:
B3:00AB7A 900665            MOV      DPTR,#i
B3:00AB7D 7402              MOV      A,#02H
B3:00AB7F F0                MOVX     @DPTR,A
B3:00AB80 22                RET      
----- FUNCTION ?L?COM0223 (END) -------


----- FUNCTION ?L?COM0225 (BEGIN) -----
B3:00AB81 7E06              MOV      R6,#HIGH t0
B3:00AB83 7F25              MOV      R7,#LOW t0
B3:00AB85 7C06              MOV      R4,#HIGH t1
B3:00AB87 7D45              MOV      R5,#LOW t1
B3:00AB89 31AD              ACALL    _fe25519_square
B3:00AB8B         ?L?COM0226:
B3:00AB8B 900665            MOV      DPTR,#i
B3:00AB8E E0                MOVX     A,@DPTR
B3:00AB8F 2402              ADD      A,#02H
B3:00AB91 22                RET      
----- FUNCTION ?L?COM0225 (END) -------


----- FUNCTION ?L?COM00EE (BEGIN) -----
B3:00AB92 E0                MOVX     A,@DPTR
B3:00AB93 FF                MOV      R7,A
B3:00AB94 900AAC            MOV      DPTR,#tmp
B3:00AB97 E0                MOVX     A,@DPTR
B3:00AB98 FA                MOV      R2,A
B3:00AB99 A3                INC      DPTR
B3:00AB9A E0                MOVX     A,@DPTR
B3:00AB9B FB                MOV      R3,A
B3:00AB9C C3                CLR      C
B3:00AB9D EF                MOV      A,R7
B3:00AB9E 9B                SUBB     A,R3
B3:00AB9F FF                MOV      R7,A
B3:00ABA0 E4                CLR      A
B3:00ABA1 9A                SUBB     A,R2
B3:00ABA2 900AAC            MOV      DPTR,#tmp
B3:00ABA5 F0                MOVX     @DPTR,A
B3:00ABA6 A3                INC      DPTR
B3:00ABA7 EF                MOV      A,R7
B3:00ABA8 F0                MOVX     @DPTR,A
B3:00ABA9 900AAA            MOV      DPTR,#r
B3:00ABAC E0                MOVX     A,@DPTR
B3:00ABAD FA                MOV      R2,A
B3:00ABAE A3                INC      DPTR
B3:00ABAF E0                MOVX     A,@DPTR
B3:00ABB0 2D                ADD      A,R5
B3:00ABB1 F582              MOV      DPL,A
B3:00ABB3 E4                CLR      A
B3:00ABB4 3A                ADDC     A,R2
B3:00ABB5 F583              MOV      DPH,A
B3:00ABB7 EF                MOV      A,R7
B3:00ABB8 F0                MOVX     @DPTR,A
B3:00ABB9 900AAC            MOV      DPTR,#tmp
B3:00ABBC E0                MOVX     A,@DPTR
B3:00ABBD C4                SWAP     A
B3:00ABBE 13                RRC      A
B3:00ABBF 13                RRC      A
B3:00ABC0 13                RRC      A
B3:00ABC1 5401              ANL      A,#01H
B3:00ABC3         ?L?COM00EF:
B3:00ABC3 F8                MOV      R0,A
B3:00ABC4 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 783


B3:00ABC5 F0                MOVX     @DPTR,A
B3:00ABC6 E8                MOV      A,R0
B3:00ABC7 A3                INC      DPTR
B3:00ABC8 F0                MOVX     @DPTR,A
B3:00ABC9 0D                INC      R5
B3:00ABCA ED                MOV      A,R5
B3:00ABCB 22                RET      
----- FUNCTION ?L?COM00EE (END) -------


----- FUNCTION ?L?COM0066 (BEGIN) -----
B3:00ABCC 904593            MOV      DPTR,#d
B3:00ABCF 122552            LCALL    ?C?PLDXDATA
B3:00ABD2 900003            MOV      DPTR,#03H
B3:00ABD5 1225F6            LCALL    ?C?PLDOPTR
B3:00ABD8 9043C5            MOV      DPTR,#?___S2_set_peer?BYTE+03H
B3:00ABDB 122572            LCALL    ?C?PSTXDATA
B3:00ABDE 904593            MOV      DPTR,#d
B3:00ABE1 122552            LCALL    ?C?PLDXDATA
B3:00ABE4 900006            MOV      DPTR,#06H
B3:00ABE7 122163            LCALL    ?C?ILDOPTR
B3:00ABEA FF                MOV      R7,A
B3:00ABEB 9043C8            MOV      DPTR,#?___S2_set_peer?BYTE+06H
B3:00ABEE         ?L?COM0067:
B3:00ABEE E5F0              MOV      A,B
B3:00ABF0 F0                MOVX     @DPTR,A
B3:00ABF1 A3                INC      DPTR
B3:00ABF2 EF                MOV      A,R7
B3:00ABF3 F0                MOVX     @DPTR,A
B3:00ABF4 22                RET      
----- FUNCTION ?L?COM0066 (END) -------


----- FUNCTION _fe25519_add (BEGIN) -----
B3:00ABF5 900A7C            MOV      DPTR,#a
B3:00ABF8 EC                MOV      A,R4
B3:00ABF9 F0                MOVX     @DPTR,A
B3:00ABFA A3                INC      DPTR
B3:00ABFB ED                MOV      A,R5
B3:00ABFC F0                MOVX     @DPTR,A
B3:00ABFD 900A7A            MOV      DPTR,#r
;---- Variable 'b' assigned to Register 'R2/R3' ----
;---- Variable 'carry' assigned to Register 'R5' ----
B3:00AC00 123C23            LCALL    ?L?COM0146
B3:00AC03 E0                MOVX     A,@DPTR
B3:00AC04 FC                MOV      R4,A
B3:00AC05 A3                INC      DPTR
B3:00AC06 E0                MOVX     A,@DPTR
B3:00AC07 FD                MOV      R5,A
B3:00AC08 9042EC            MOV      DPTR,#?_bigint_add?BYTE+06H
B3:00AC0B 7420              MOV      A,#020H
B3:00AC0D F0                MOVX     @DPTR,A
B3:00AC0E 121B65            LCALL    ?INTERBANK_TABLE?_bigint_add
B3:00AC11 AD07              MOV      R5,AR7
B3:00AC13 900A7A            MOV      DPTR,#r
B3:00AC16 E0                MOVX     A,@DPTR
B3:00AC17 FE                MOV      R6,A
B3:00AC18 A3                INC      DPTR
B3:00AC19 E0                MOVX     A,@DPTR
B3:00AC1A 241F              ADD      A,#01FH
B3:00AC1C 11B7              ACALL    ?L?COM0094
B3:00AC1E E0                MOVX     A,@DPTR
B3:00AC1F C4                SWAP     A
B3:00AC20 13                RRC      A
B3:00AC21 13                RRC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 784


B3:00AC22 13                RRC      A
B3:00AC23 5401              ANL      A,#01H
B3:00AC25 FF                MOV      R7,A
B3:00AC26 AE05              MOV      R6,AR5
B3:00AC28 EE                MOV      A,R6
B3:00AC29 25E0              ADD      A,ACC
B3:00AC2B 4F                ORL      A,R7
B3:00AC2C 75F013            MOV      B,#013H
B3:00AC2F A4                MUL      AB
B3:00AC30 FF                MOV      R7,A
B3:00AC31 900A7E            MOV      DPTR,#tmp
B3:00AC34 71EE              ACALL    ?L?COM0067
;---- Variable 'i' assigned to Register 'R5' ----
B3:00AC36 E4                CLR      A
B3:00AC37 FD                MOV      R5,A
B3:00AC38         ?C0001?FE25519:
B3:00AC38 900A7A            MOV      DPTR,#r
B3:00AC3B 11B2              ACALL    ?L?COM0092
B3:00AC3D E0                MOVX     A,@DPTR
B3:00AC3E FF                MOV      R7,A
B3:00AC3F 900A7F            MOV      DPTR,#tmp+01H
B3:00AC42 E0                MOVX     A,@DPTR
B3:00AC43 2F                ADD      A,R7
B3:00AC44 FF                MOV      R7,A
B3:00AC45 900A7E            MOV      DPTR,#tmp
B3:00AC48 E0                MOVX     A,@DPTR
B3:00AC49 3400              ADDC     A,#00H
B3:00AC4B F0                MOVX     @DPTR,A
B3:00AC4C A3                INC      DPTR
B3:00AC4D EF                MOV      A,R7
B3:00AC4E F0                MOVX     @DPTR,A
B3:00AC4F 900A7A            MOV      DPTR,#r
B3:00AC52 91C2              ACALL    ?L?COM0391
B3:00AC54 900A7E            MOV      DPTR,#tmp
B3:00AC57 E0                MOVX     A,@DPTR
B3:00AC58 71C3              ACALL    ?L?COM00EF
B3:00AC5A B41FDB            CJNE     A,#01FH,?C0001?FE25519
B3:00AC5D         ?C0002?FE25519:
B3:00AC5D 900A7A            MOV      DPTR,#r
B3:00AC60 11B2              ACALL    ?L?COM0092
B3:00AC62 E0                MOVX     A,@DPTR
B3:00AC63 547F              ANL      A,#07FH
B3:00AC65 FF                MOV      R7,A
B3:00AC66 900A7E            MOV      DPTR,#tmp
B3:00AC69 A3                INC      DPTR
B3:00AC6A E0                MOVX     A,@DPTR
B3:00AC6B 2F                ADD      A,R7
B3:00AC6C FF                MOV      R7,A
B3:00AC6D 900A7A            MOV      DPTR,#r
B3:00AC70 E0                MOVX     A,@DPTR
B3:00AC71 FC                MOV      R4,A
B3:00AC72 A3                INC      DPTR
B3:00AC73 E0                MOVX     A,@DPTR
B3:00AC74 2D                ADD      A,R5
B3:00AC75 F1CF              ACALL    ?L?COM0206
B3:00AC77 EF                MOV      A,R7
B3:00AC78 F0                MOVX     @DPTR,A
B3:00AC79 22                RET      
----- FUNCTION _fe25519_add (END) -------


----- FUNCTION ___S2_verify_seq (BEGIN) -----
B3:00AC7A 9046B8            MOV      DPTR,#seq
B3:00AC7D ED                MOV      A,R5
B3:00AC7E F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 785


;---- Variable 'peer' assigned to Register 'R1/R2/R3' ----
B3:00AC7F 12D897            LCALL    ___find_span_by_node
;---- Variable 'span' assigned to Register 'R6/R7' ----
B3:00AC82 EF                MOV      A,R7
B3:00AC83 2426              ADD      A,#026H
B3:00AC85 11B7              ACALL    ?L?COM0094
B3:00AC87 E0                MOVX     A,@DPTR
B3:00AC88 6401              XRL      A,#01H
B3:00AC8A 6010              JZ       ?C0032?S2
B3:00AC8C EF                MOV      A,R7
B3:00AC8D 2423              ADD      A,#023H
B3:00AC8F 11B7              ACALL    ?L?COM0094
B3:00AC91 E0                MOVX     A,@DPTR
B3:00AC92 FD                MOV      R5,A
B3:00AC93 9046B8            MOV      DPTR,#seq
B3:00AC96 E0                MOVX     A,@DPTR
B3:00AC97 FC                MOV      R4,A
B3:00AC98 ED                MOV      A,R5
B3:00AC99 6C                XRL      A,R4
B3:00AC9A 6011              JZ       ?C0031?S2
B3:00AC9C         ?C0032?S2:
B3:00AC9C 9046B8            MOV      DPTR,#seq
B3:00AC9F E0                MOVX     A,@DPTR
B3:00ACA0 FD                MOV      R5,A
B3:00ACA1 EF                MOV      A,R7
B3:00ACA2 2423              ADD      A,#023H
B3:00ACA4 11B7              ACALL    ?L?COM0094
B3:00ACA6 ED                MOV      A,R5
B3:00ACA7 F0                MOVX     @DPTR,A
B3:00ACA8 7E00              MOV      R6,#00H
B3:00ACAA 7F01              MOV      R7,#01H
B3:00ACAC 22                RET      
B3:00ACAD         ?C0031?S2:
B3:00ACAD E4                CLR      A
B3:00ACAE FE                MOV      R6,A
B3:00ACAF FF                MOV      R7,A
B3:00ACB0 22                RET      
----- FUNCTION ___S2_verify_seq (END) -------


----- FUNCTION ?L?COM0555 (BEGIN) -----
B3:00ACB1 900665            MOV      DPTR,#i
B3:00ACB4 E0                MOVX     A,@DPTR
B3:00ACB5 C3                CLR      C
B3:00ACB6 940A              SUBB     A,#0AH
B3:00ACB8 22                RET      
----- FUNCTION ?L?COM0555 (END) -------


----- FUNCTION ?L?COM04F8 (BEGIN) -----
B3:00ACB9 9008B0            MOV      DPTR,#r
B3:00ACBC E0                MOVX     A,@DPTR
B3:00ACBD FE                MOV      R6,A
B3:00ACBE A3                INC      DPTR
B3:00ACBF E0                MOVX     A,@DPTR
B3:00ACC0 FF                MOV      R7,A
B3:00ACC1 22                RET      
----- FUNCTION ?L?COM04F8 (END) -------


----- FUNCTION ?L?COM0391 (BEGIN) -----
B3:00ACC2 E0                MOVX     A,@DPTR
B3:00ACC3 FA                MOV      R2,A
B3:00ACC4 A3                INC      DPTR
B3:00ACC5 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 786


B3:00ACC6 2D                ADD      A,R5
B3:00ACC7 F582              MOV      DPL,A
B3:00ACC9 E4                CLR      A
B3:00ACCA 3A                ADDC     A,R2
B3:00ACCB F583              MOV      DPH,A
B3:00ACCD EF                MOV      A,R7
B3:00ACCE F0                MOVX     @DPTR,A
B3:00ACCF 22                RET      
----- FUNCTION ?L?COM0391 (END) -------


----- FUNCTION __S2_encrypt_and_send (BEGIN) -----
B3:00ACD0 12D891            LCALL    ?L?COM02E1
B3:00ACD3 90385E            MOV      DPTR,#span
B3:00ACD6 EE                MOV      A,R6
B3:00ACD7 12CB64            LCALL    ?L?COM0137
B3:00ACDA 7A2A              MOV      R2,#HIGH the_context+0211H
B3:00ACDC 7915              MOV      R1,#LOW the_context+0211H
B3:00ACDE 90385A            MOV      DPTR,#msg
B3:00ACE1 122572            LCALL    ?C?PSTXDATA
B3:00ACE4 F1B3              ACALL    ?L?COM0342
B3:00ACE6 749F              MOV      A,#09FH
B3:00ACE8 12203B            LCALL    ?C?CSTPTR
B3:00ACEB 90385A            MOV      DPTR,#msg
B3:00ACEE 12D58C            LCALL    ?L?COM02F2
B3:00ACF1 90385E            MOV      DPTR,#span
B3:00ACF4 E0                MOVX     A,@DPTR
B3:00ACF5 FE                MOV      R6,A
B3:00ACF6 A3                INC      DPTR
B3:00ACF7 E0                MOVX     A,@DPTR
B3:00ACF8 FF                MOV      R7,A
B3:00ACF9 2424              ADD      A,#024H
B3:00ACFB 11B7              ACALL    ?L?COM0094
B3:00ACFD E0                MOVX     A,@DPTR
B3:00ACFE 12B7B8            LCALL    ?L?COM036B
B3:00AD01 900003            MOV      DPTR,#03H
B3:00AD04 E4                CLR      A
B3:00AD05 12204D            LCALL    ?C?CSTOPTR
B3:00AD08 903856            MOV      DPTR,#hdr_len
B3:00AD0B 12BB12            LCALL    ?L?COM04A2
B3:00AD0E E4                CLR      A
B3:00AD0F 90385D            MOV      DPTR,#n_ext
B3:00AD12 F0                MOVX     @DPTR,A
B3:00AD13 125D38            LCALL    ?L?COM00E5
B3:00AD16 903853            MOV      DPTR,#ext_data
B3:00AD19 122572            LCALL    ?C?PSTXDATA
B3:00AD1C EF                MOV      A,R7
B3:00AD1D 2426              ADD      A,#026H
B3:00AD1F 11B7              ACALL    ?L?COM0094
B3:00AD21 E0                MOVX     A,@DPTR
B3:00AD22 6404              XRL      A,#04H
B3:00AD24 6002              JZ       $ + 4H
B3:00AD26 A1B0              AJMP     ?C0047?S2
B3:00AD28 7B01              MOV      R3,#01H
B3:00AD2A 7A38              MOV      R2,#HIGH ei_sender
B3:00AD2C 7920              MOV      R1,#LOW ei_sender
B3:00AD2E 12DAEA            LCALL    ?L?COM013A
B3:00AD31 F1D6              ACALL    ?L?COM02E5
B3:00AD33 7830              MOV      R0,#LOW ei_receiver
B3:00AD35 7C38              MOV      R4,#HIGH ei_receiver
B3:00AD37 7D01              MOV      R5,#01H
B3:00AD39 12D728            LCALL    ?L?COM0197
B3:00AD3C F1D6              ACALL    ?L?COM02E5
B3:00AD3E C002              PUSH     AR2
B3:00AD40 C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 787


B3:00AD42 7A38              MOV      R2,#HIGH ei_sender
B3:00AD44 7920              MOV      R1,#LOW ei_sender
B3:00AD46 90394A            MOV      DPTR,#?_next_nonce_instantiate?BYTE+03H
B3:00AD49 122572            LCALL    ?C?PSTXDATA
B3:00AD4C 7A38              MOV      R2,#HIGH ei_receiver
B3:00AD4E 7930              MOV      R1,#LOW ei_receiver
B3:00AD50 90394D            MOV      DPTR,#?_next_nonce_instantiate?BYTE+06H
B3:00AD53 122572            LCALL    ?C?PSTXDATA
B3:00AD56 9028DA            MOV      DPTR,#the_context+0D6H
B3:00AD59 E0                MOVX     A,@DPTR
B3:00AD5A 75F040            MOV      B,#040H
B3:00AD5D A4                MUL      AB
B3:00AD5E 12ED5C            LCALL    ?L?COM0270
B3:00AD61 D001              POP      AR1
B3:00AD63 D002              POP      AR2
B3:00AD65 121B56            LCALL    ?INTERBANK_TABLE?_next_nonce_instantiate
B3:00AD68 9028DA            MOV      DPTR,#the_context+0D6H
B3:00AD6B E0                MOVX     A,@DPTR
B3:00AD6C FF                MOV      R7,A
B3:00AD6D 90385E            MOV      DPTR,#span
B3:00AD70 E0                MOVX     A,@DPTR
B3:00AD71 FC                MOV      R4,A
B3:00AD72 A3                INC      DPTR
B3:00AD73 E0                MOVX     A,@DPTR
B3:00AD74 FD                MOV      R5,A
B3:00AD75 2425              ADD      A,#025H
B3:00AD77 F1CF              ACALL    ?L?COM0206
B3:00AD79 EF                MOV      A,R7
B3:00AD7A F0                MOVX     @DPTR,A
B3:00AD7B ED                MOV      A,R5
B3:00AD7C 2426              ADD      A,#026H
B3:00AD7E F1CF              ACALL    ?L?COM0206
B3:00AD80 7406              MOV      A,#06H
B3:00AD82 F0                MOVX     @DPTR,A
B3:00AD83 F1A9              ACALL    ?L?COM0119
B3:00AD85 7412              MOV      A,#012H
B3:00AD87 F1A6              ACALL    ?L?COM0118
B3:00AD89 7441              MOV      A,#041H
B3:00AD8B 12203B            LCALL    ?C?CSTPTR
B3:00AD8E 903853            MOV      DPTR,#ext_data
B3:00AD91 12ED39            LCALL    ?L?COM02D5
B3:00AD94 7B01              MOV      R3,#01H
B3:00AD96 7A38              MOV      R2,#HIGH ei_sender
B3:00AD98 7920              MOV      R1,#LOW ei_sender
B3:00AD9A 12D728            LCALL    ?L?COM0197
B3:00AD9D 903856            MOV      DPTR,#hdr_len
B3:00ADA0 E4                CLR      A
B3:00ADA1 75F012            MOV      B,#012H
B3:00ADA4 12210C            LCALL    ?C?IILDX
B3:00ADA7 903854            MOV      DPTR,#ext_data+01H
B3:00ADAA E4                CLR      A
B3:00ADAB 75F010            MOV      B,#010H
B3:00ADAE F1C0              ACALL    ?L?COM036A
B3:00ADB0         ?C0047?S2:
B3:00ADB0 9028D5            MOV      DPTR,#the_context+0D1H
B3:00ADB3 E0                MOVX     A,@DPTR
B3:00ADB4 5406              ANL      A,#06H
B3:00ADB6 6045              JZ       ?C0048?S2
B3:00ADB8 F1B9              ACALL    ?L?COM0243
B3:00ADBA E0                MOVX     A,@DPTR
B3:00ADBB 4E                ORL      A,R6
B3:00ADBC 603F              JZ       ?C0048?S2
B3:00ADBE 9028D4            MOV      DPTR,#the_context+0D0H
B3:00ADC1 E0                MOVX     A,@DPTR
B3:00ADC2 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 788


B3:00ADC3 12E6FC            LCALL    ___S2_is_node_mos
B3:00ADC6 EF                MOV      A,R7
B3:00ADC7 701F              JNZ      ?C0049?S2
B3:00ADC9 903853            MOV      DPTR,#ext_data
B3:00ADCC F1AD              ACALL    ?L?COM011B
B3:00ADCE 7403              MOV      A,#03H
B3:00ADD0 F1A6              ACALL    ?L?COM0118
B3:00ADD2 7443              MOV      A,#043H
B3:00ADD4 12203B            LCALL    ?C?CSTPTR
B3:00ADD7 F1B9              ACALL    ?L?COM0243
B3:00ADD9 12D569            LCALL    ?L?COM053E
B3:00ADDC FF                MOV      R7,A
B3:00ADDD F1A9              ACALL    ?L?COM0119
B3:00ADDF EF                MOV      A,R7
B3:00ADE0 12ED9E            LCALL    ?L?COM055C
B3:00ADE3 75F003            MOV      B,#03H
B3:00ADE6 F1C0              ACALL    ?L?COM036A
B3:00ADE8         ?C0049?S2:
B3:00ADE8 9028D5            MOV      DPTR,#the_context+0D1H
B3:00ADEB E0                MOVX     A,@DPTR
B3:00ADEC 30E20E            JNB      ACC.2,?C0048?S2
B3:00ADEF 902A12            MOV      DPTR,#the_context+020EH
B3:00ADF2 E0                MOVX     A,@DPTR
B3:00ADF3 B40207            CJNE     A,#02H,?C0048?S2
B3:00ADF6 F1B9              ACALL    ?L?COM0243
B3:00ADF8 E0                MOVX     A,@DPTR
B3:00ADF9 FF                MOV      R7,A
B3:00ADFA 12D5E8            LCALL    _next_mpan_state
B3:00ADFD         ?C0048?S2:
B3:00ADFD 9028E2            MOV      DPTR,#the_context+0DEH
B3:00AE00 12C0B2            LCALL    ?L?COM00C2
B3:00AE03 602D              JZ       ?C0051?S2
B3:00AE05 EF                MOV      A,R7
B3:00AE06 2413              ADD      A,#013H
B3:00AE08 11B7              ACALL    ?L?COM0094
B3:00AE0A E0                MOVX     A,@DPTR
B3:00AE0B B40224            CJNE     A,#02H,?C0051?S2
B3:00AE0E 9028E2            MOV      DPTR,#the_context+0DEH
B3:00AE11 A3                INC      DPTR
B3:00AE12 E0                MOVX     A,@DPTR
B3:00AE13 2413              ADD      A,#013H
B3:00AE15 11B7              ACALL    ?L?COM0094
B3:00AE17 E4                CLR      A
B3:00AE18 F0                MOVX     @DPTR,A
B3:00AE19 9028E2            MOV      DPTR,#the_context+0DEH
B3:00AE1C F0                MOVX     @DPTR,A
B3:00AE1D A3                INC      DPTR
B3:00AE1E F0                MOVX     @DPTR,A
B3:00AE1F 903853            MOV      DPTR,#ext_data
B3:00AE22 F1AD              ACALL    ?L?COM011B
B3:00AE24 7402              MOV      A,#02H
B3:00AE26 F1A6              ACALL    ?L?COM0118
B3:00AE28 7404              MOV      A,#04H
B3:00AE2A 12ED9E            LCALL    ?L?COM055C
B3:00AE2D 75F002            MOV      B,#02H
B3:00AE30 F1C0              ACALL    ?L?COM036A
B3:00AE32         ?C0051?S2:
B3:00AE32 90385D            MOV      DPTR,#n_ext
B3:00AE35 E0                MOVX     A,@DPTR
B3:00AE36 603E              JZ       ?C0052?S2
B3:00AE38 F1B3              ACALL    ?L?COM0342
B3:00AE3A E9                MOV      A,R1
B3:00AE3B 2403              ADD      A,#03H
B3:00AE3D 1252DD            LCALL    ?L?COM0009
B3:00AE40 4401              ORL      A,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 789


B3:00AE42 12203B            LCALL    ?C?CSTPTR
B3:00AE45 90385A            MOV      DPTR,#msg
B3:00AE48 125D35            LCALL    ?L?COM00E4
B3:00AE4B 903853            MOV      DPTR,#ext_data
B3:00AE4E 122572            LCALL    ?C?PSTXDATA
B3:00AE51         ?C0053?S2:
B3:00AE51 90385D            MOV      DPTR,#n_ext
B3:00AE54 E0                MOVX     A,@DPTR
B3:00AE55 14                DEC      A
B3:00AE56 F0                MOVX     @DPTR,A
B3:00AE57 6010              JZ       ?C0054?S2
B3:00AE59 903853            MOV      DPTR,#ext_data
B3:00AE5C 12CD6D            LCALL    ?L?COM02D3
B3:00AE5F 1252DD            LCALL    ?L?COM0009
B3:00AE62 4480              ORL      A,#080H
B3:00AE64 12203B            LCALL    ?C?CSTPTR
B3:00AE67 80E8              SJMP     ?C0053?S2
B3:00AE69         ?C0054?S2:
B3:00AE69 903853            MOV      DPTR,#ext_data
B3:00AE6C 12A3E6            LCALL    ?L?COM0077
B3:00AE6F FF                MOV      R7,A
B3:00AE70 903854            MOV      DPTR,#ext_data+01H
B3:00AE73 12EBE4            LCALL    ?L?COM0208
B3:00AE76         ?C0052?S2:
B3:00AE76 F1B3              ACALL    ?L?COM0342
B3:00AE78 903856            MOV      DPTR,#hdr_len
B3:00AE7B 126E51            LCALL    ?L?COM0252
B3:00AE7E 903850            MOV      DPTR,#ciphertext
B3:00AE81 122572            LCALL    ?C?PSTXDATA
B3:00AE84 12E72C            LCALL    ___S2_add_mpan_extensions
B3:00AE87 903858            MOV      DPTR,#shdr_len
B3:00AE8A 126F4A            LCALL    ?L?COM03D3
B3:00AE8D 600F              JZ       ?C0055?S2
B3:00AE8F A3                INC      DPTR
B3:00AE90 122552            LCALL    ?C?PLDXDATA
B3:00AE93 E9                MOV      A,R1
B3:00AE94 2403              ADD      A,#03H
B3:00AE96 1252DD            LCALL    ?L?COM0009
B3:00AE99 4402              ORL      A,#02H
B3:00AE9B 12203B            LCALL    ?C?CSTPTR
B3:00AE9E         ?C0055?S2:
B3:00AE9E 12D583            LCALL    ?L?COM0501
B3:00AEA1 903850            MOV      DPTR,#ciphertext
B3:00AEA4 122552            LCALL    ?C?PLDXDATA
B3:00AEA7 903858            MOV      DPTR,#shdr_len
B3:00AEAA 126E37            LCALL    ?L?COM01E7
B3:00AEAD FC                MOV      R4,A
B3:00AEAE 12D597            LCALL    ?L?COM0229
B3:00AEB1 9028D4            MOV      DPTR,#the_context+0D0H
B3:00AEB4 E0                MOVX     A,@DPTR
B3:00AEB5 903856            MOV      DPTR,#hdr_len
B3:00AEB8 12EE02            LCALL    ?L?COM0311
B3:00AEBB 903858            MOV      DPTR,#shdr_len
B3:00AEBE E0                MOVX     A,@DPTR
B3:00AEBF FA                MOV      R2,A
B3:00AEC0 A3                INC      DPTR
B3:00AEC1 E0                MOVX     A,@DPTR
B3:00AEC2 FB                MOV      R3,A
B3:00AEC3 9028DE            MOV      DPTR,#the_context+0DAH
B3:00AEC6 E0                MOVX     A,@DPTR
B3:00AEC7 F8                MOV      R0,A
B3:00AEC8 A3                INC      DPTR
B3:00AEC9 E0                MOVX     A,@DPTR
B3:00AECA 2B                ADD      A,R3
B3:00AECB FB                MOV      R3,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 790


B3:00AECC E8                MOV      A,R0
B3:00AECD 3A                ADDC     A,R2
B3:00AECE FA                MOV      R2,A
B3:00AECF 903856            MOV      DPTR,#hdr_len
B3:00AED2 12D5D2            LCALL    ?L?COM02E4
B3:00AED5 7A37              MOV      R2,#HIGH aad
B3:00AED7 79DE              MOV      R1,#LOW aad
B3:00AED9 12D5C2            LCALL    ?L?COM0253
B3:00AEDC F1B3              ACALL    ?L?COM0342
B3:00AEDE 12E8E2            LCALL    ?L?COM04DF
B3:00AEE1 90381E            MOV      DPTR,#aad_len
B3:00AEE4 EE                MOV      A,R6
B3:00AEE5 F0                MOVX     @DPTR,A
B3:00AEE6 A3                INC      DPTR
B3:00AEE7 EF                MOV      A,R7
B3:00AEE8 F0                MOVX     @DPTR,A
B3:00AEE9 F1D6              ACALL    ?L?COM02E5
B3:00AEEB C002              PUSH     AR2
B3:00AEED C001              PUSH     AR1
B3:00AEEF 9044AC            MOV      DPTR,#?_next_nonce_generate?BYTE+03H
B3:00AEF2 12ED7A            LCALL    ?L?COM052F
B3:00AEF5 D001              POP      AR1
B3:00AEF7 D002              POP      AR2
B3:00AEF9 121B5B            LCALL    ?INTERBANK_TABLE?_next_nonce_generate
B3:00AEFC 9028DA            MOV      DPTR,#the_context+0D6H
B3:00AEFF 12D5B2            LCALL    ?L?COM01B0
B3:00AF02 C003              PUSH     AR3
B3:00AF04 C002              PUSH     AR2
B3:00AF06 C001              PUSH     AR1
B3:00AF08 903CF6            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+03H
B3:00AF0B 12ED7A            LCALL    ?L?COM052F
B3:00AF0E 7A37              MOV      R2,#HIGH aad
B3:00AF10 79DE              MOV      R1,#LOW aad
B3:00AF12 903CF9            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+06H
B3:00AF15 122572            LCALL    ?C?PSTXDATA
B3:00AF18 90381E            MOV      DPTR,#aad_len
B3:00AF1B 12E428            LCALL    ?L?COM0096
B3:00AF1E FD                MOV      R5,A
B3:00AF1F 903CFC            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+09H
B3:00AF22 1224BA            LCALL    ?C?LSTXDATA
B3:00AF25 903850            MOV      DPTR,#ciphertext
B3:00AF28 12D57A            LCALL    ?L?COM04A3
B3:00AF2B 903858            MOV      DPTR,#shdr_len
B3:00AF2E E0                MOVX     A,@DPTR
B3:00AF2F FE                MOV      R6,A
B3:00AF30 A3                INC      DPTR
B3:00AF31 E0                MOVX     A,@DPTR
B3:00AF32 FF                MOV      R7,A
B3:00AF33 9028DF            MOV      DPTR,#the_context+0DBH
B3:00AF36 E0                MOVX     A,@DPTR
B3:00AF37 2F                ADD      A,R7
B3:00AF38 FF                MOV      R7,A
B3:00AF39 9028DE            MOV      DPTR,#the_context+0DAH
B3:00AF3C E0                MOVX     A,@DPTR
B3:00AF3D 3E                ADDC     A,R6
B3:00AF3E 903D03            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+010H
B3:00AF41 F0                MOVX     @DPTR,A
B3:00AF42 A3                INC      DPTR
B3:00AF43 EF                MOV      A,R7
B3:00AF44 F0                MOVX     @DPTR,A
B3:00AF45 D001              POP      AR1
B3:00AF47 D002              POP      AR2
B3:00AF49 D003              POP      AR3
B3:00AF4B 121B33            LCALL    ?INTERBANK_TABLE?_CCM_encrypt_and_auth
;---- Variable 'msg_len' assigned to Register 'R6/R7' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 791


B3:00AF4E F1B3              ACALL    ?L?COM0342
B3:00AF50 903857            MOV      DPTR,#hdr_len+01H
B3:00AF53 E0                MOVX     A,@DPTR
B3:00AF54 2F                ADD      A,R7
B3:00AF55 FD                MOV      R5,A
B3:00AF56 903856            MOV      DPTR,#hdr_len
B3:00AF59 E0                MOVX     A,@DPTR
B3:00AF5A 3E                ADDC     A,R6
B3:00AF5B FC                MOV      R4,A
B3:;----                  JMP      ___S2_send_raw
----- FUNCTION __S2_encrypt_and_send (END) -------


----- FUNCTION ___S2_send_raw (BEGIN) -----
B3:00AF5C 9041CB            MOV      DPTR,#buf
B3:00AF5F 122572            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R4/R5' ----
B3:00AF62 9041CB            MOV      DPTR,#buf
B3:00AF65 122552            LCALL    ?C?PLDXDATA
B3:00AF68 90438D            MOV      DPTR,#?___S2_send_frame?BYTE+03H
B3:00AF6B 122572            LCALL    ?C?PSTXDATA
B3:00AF6E AF05              MOV      R7,AR5
B3:00AF70 904390            MOV      DPTR,#?___S2_send_frame?BYTE+06H
B3:00AF73 EC                MOV      A,R4
B3:00AF74 12CB64            LCALL    ?L?COM0137
B3:00AF77 12BCC6            LCALL    ?L?COM04FB
B3:00AF7A 601A              JZ       ?C0066?S2
B3:00AF7C 12D891            LCALL    ?L?COM02E1
B3:00AF7F 9041D6            MOV      DPTR,#span
B3:00AF82 EE                MOV      A,R6
B3:00AF83 F0                MOVX     @DPTR,A
B3:00AF84 A3                INC      DPTR
B3:00AF85 EF                MOV      A,R7
B3:00AF86 F0                MOVX     @DPTR,A
B3:00AF87 8E83              MOV      DPH,R6
B3:00AF89 2424              ADD      A,#024H
B3:00AF8B F582              MOV      DPL,A
B3:00AF8D E4                CLR      A
B3:00AF8E 3583              ADDC     A,DPH
B3:00AF90 F583              MOV      DPH,A
B3:00AF92 E0                MOVX     A,@DPTR
B3:00AF93 04                INC      A
B3:00AF94 F0                MOVX     @DPTR,A
B3:00AF95 22                RET      
B3:00AF96         ?C0066?S2:
B3:00AF96 9041D1            MOV      DPTR,#e+03H
B3:00AF99 7402              MOV      A,#02H
B3:00AF9B F0                MOVX     @DPTR,A
B3:00AF9C 7B01              MOV      R3,#01H
B3:00AF9E 7A41              MOV      R2,#HIGH e
B3:00AFA0 79CE              MOV      R1,#LOW e
B3:00AFA2 FF                MOV      R7,A
B3:00AFA3 028CD5            LJMP     ___S2_fsm_post_event
----- FUNCTION ___S2_send_raw (END) -------


----- FUNCTION ?L?COM0118 (BEGIN) -----
B3:00AFA6 12203B            LCALL    ?C?CSTPTR
B3:00AFA9         ?L?COM0119:
B3:00AFA9 903853            MOV      DPTR,#ext_data
B3:00AFAC         ?L?COM011A:
B3:00AFAC E4                CLR      A
B3:00AFAD         ?L?COM011B:
B3:00AFAD 75F001            MOV      B,#01H
B3:00AFB0 02255B            LJMP     ?C?PLDIXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 792


----- FUNCTION ?L?COM0118 (END) -------


----- FUNCTION ?L?COM0342 (BEGIN) -----
B3:00AFB3 90385A            MOV      DPTR,#msg
B3:00AFB6 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0342 (END) -------


----- FUNCTION ?L?COM0243 (BEGIN) -----
B3:00AFB9 9028E2            MOV      DPTR,#the_context+0DEH
B3:00AFBC E0                MOVX     A,@DPTR
B3:00AFBD FE                MOV      R6,A
B3:00AFBE A3                INC      DPTR
B3:00AFBF 22                RET      
----- FUNCTION ?L?COM0243 (END) -------


----- FUNCTION ?L?COM036A (BEGIN) -----
B3:00AFC0 12210C            LCALL    ?C?IILDX
B3:00AFC3 90385D            MOV      DPTR,#n_ext
B3:00AFC6 E0                MOVX     A,@DPTR
B3:00AFC7 04                INC      A
B3:00AFC8 F0                MOVX     @DPTR,A
B3:00AFC9 22                RET      
----- FUNCTION ?L?COM036A (END) -------


----- FUNCTION ?L?COM0205 (BEGIN) -----
B3:00AFCA E0                MOVX     A,@DPTR
B3:00AFCB FC                MOV      R4,A
B3:00AFCC A3                INC      DPTR
B3:00AFCD E0                MOVX     A,@DPTR
B3:00AFCE 2F                ADD      A,R7
B3:00AFCF         ?L?COM0206:
B3:00AFCF F582              MOV      DPL,A
B3:00AFD1 E4                CLR      A
B3:00AFD2 3C                ADDC     A,R4
B3:00AFD3 F583              MOV      DPH,A
B3:00AFD5 22                RET      
----- FUNCTION ?L?COM0205 (END) -------


----- FUNCTION ?L?COM02E5 (BEGIN) -----
B3:00AFD6 90385E            MOV      DPTR,#span
B3:00AFD9 E0                MOVX     A,@DPTR
B3:00AFDA FE                MOV      R6,A
B3:00AFDB A3                INC      DPTR
B3:00AFDC E0                MOVX     A,@DPTR
B3:00AFDD AA06              MOV      R2,AR6
B3:00AFDF F9                MOV      R1,A
B3:00AFE0 7B01              MOV      R3,#01H
B3:00AFE2 22                RET      
----- FUNCTION ?L?COM02E5 (END) -------


----- FUNCTION _secure_learn_enter (BEGIN) -----
B3:00AFE3 90461E            MOV      DPTR,#handle
B3:00AFE6 122572            LCALL    ?C?PSTXDATA
B3:00AFE9 12B1DC            LCALL    ?L?COM04AA
B3:00AFEC 12E076            LCALL    _secure_learn_entryaction
B3:00AFEF 12B1DC            LCALL    ?L?COM04AA
B3:00AFF2 7409              MOV      A,#09H
B3:00AFF4 12203B            LCALL    ?C?CSTPTR
B3:00AFF7 12B1DC            LCALL    ?L?COM04AA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 793


B3:00AFFA 12E089            LCALL    ?L?COM02A5
B3:00AFFD 022207            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_enter (END) -------


----- FUNCTION _secure_learn_init (BEGIN) -----
B3:00B000 90461B            MOV      DPTR,#handle
;---- Variable 'i' assigned to Register 'R6/R7' ----
B3:00B003 127019            LCALL    ?L?COM04AB
B3:00B006         ?C0001?SECURE_LEARN:
B3:00B006 12B0A5            LCALL    ?L?COM045A
B3:00B009 8F82              MOV      DPL,R7
B3:00B00B 8E83              MOV      DPH,R6
B3:00B00D 740C              MOV      A,#0CH
B3:00B00F 12204D            LCALL    ?C?CSTOPTR
B3:00B012 0F                INC      R7
B3:00B013 BF0001            CJNE     R7,#00H,?C0160?SECURE_LEARN
B3:00B016 0E                INC      R6
B3:00B017         ?C0160?SECURE_LEARN:
B3:00B017 EF                MOV      A,R7
B3:00B018 6401              XRL      A,#01H
B3:00B01A 4E                ORL      A,R6
B3:00B01B 70E9              JNZ      ?C0001?SECURE_LEARN
B3:00B01D         ?C0002?SECURE_LEARN:
B3:00B01D 90461B            MOV      DPTR,#handle
B3:00B020 1292B5            LCALL    ?L?COM001B
B3:00B023 129243            LCALL    _clearInEvents
B3:00B026 11A5              ACALL    ?L?COM045A
B3:00B028 F1E2              ACALL    _clearOutEvents
B3:00B02A 11A5              ACALL    ?L?COM045A
B3:00B02C 900003            MOV      DPTR,#03H
B3:00B02F 122511            LCALL    ?C?LSTKOPTR
B3:00B032 00                DB       00H
B3:00B033 00                DB       00H
B3:00B034 00                DB       00H
B3:00B035 01                DB       01H
B3:00B036 900007            MOV      DPTR,#07H
B3:00B039 122511            LCALL    ?C?LSTKOPTR
B3:00B03C 00                DB       00H
B3:00B03D 00                DB       00H
B3:00B03E 00                DB       00H
B3:00B03F 00                DB       00H
B3:00B040 90000B            MOV      DPTR,#0BH
B3:00B043 E4                CLR      A
B3:00B044 12204D            LCALL    ?C?CSTOPTR
B3:00B047 90000C            MOV      DPTR,#0CH
B3:00B04A 122511            LCALL    ?C?LSTKOPTR
B3:00B04D 00                DB       00H
B3:00B04E 00                DB       00H
B3:00B04F 00                DB       00H
B3:00B050 00                DB       00H
B3:00B051 900010            MOV      DPTR,#010H
B3:00B054 122511            LCALL    ?C?LSTKOPTR
B3:00B057 00                DB       00H
B3:00B058 00                DB       00H
B3:00B059 00                DB       00H
B3:00B05A 00                DB       00H
B3:00B05B 900014            MOV      DPTR,#014H
B3:00B05E 122511            LCALL    ?C?LSTKOPTR
B3:00B061 00                DB       00H
B3:00B062 00                DB       00H
B3:00B063 00                DB       00H
B3:00B064 00                DB       00H
B3:00B065 22                RET      
----- FUNCTION _secure_learn_init (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 794




----- FUNCTION _fe25519_pack (BEGIN) -----
B3:00B066 90095D            MOV      DPTR,#r
B3:00B069 EE                MOV      A,R6
B3:00B06A F0                MOVX     @DPTR,A
B3:00B06B A3                INC      DPTR
B3:00B06C EF                MOV      A,R7
B3:00B06D F0                MOVX     @DPTR,A
;---- Variable 'x' assigned to Register 'R4/R5' ----
B3:00B06E AE04              MOV      R6,AR4
B3:00B070 AF05              MOV      R7,AR5
B3:00B072 12EE85            LCALL    ?L?COM0369
B3:00B075 785F              MOV      R0,#LOW y
B3:00B077 7C09              MOV      R4,#HIGH y
B3:00B079 12BE4B            LCALL    ?L?COM01E5
B3:00B07C 7E09              MOV      R6,#HIGH y
B3:00B07E 7F5F              MOV      R7,#LOW y
B3:00B080 12EC93            LCALL    _fe25519_freeze
;---- Variable 'i' assigned to Register 'R7' ----
B3:00B083 E4                CLR      A
B3:00B084 FF                MOV      R7,A
B3:00B085         ?C0036?FE25519:
B3:00B085 745F              MOV      A,#LOW y
B3:00B087 2F                ADD      A,R7
B3:00B088 F582              MOV      DPL,A
B3:00B08A E4                CLR      A
B3:00B08B 3409              ADDC     A,#HIGH y
B3:00B08D F583              MOV      DPH,A
B3:00B08F E0                MOVX     A,@DPTR
B3:00B090 FE                MOV      R6,A
B3:00B091 90095D            MOV      DPTR,#r
B3:00B094 12AFCA            LCALL    ?L?COM0205
B3:00B097 EE                MOV      A,R6
B3:00B098 F0                MOVX     @DPTR,A
B3:00B099 0F                INC      R7
B3:00B09A EF                MOV      A,R7
B3:00B09B B420E7            CJNE     A,#020H,?C0036?FE25519
B3:00B09E 22                RET      
----- FUNCTION _fe25519_pack (END) -------


----- FUNCTION _secure_learnIface_set_txOptions (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B09F 900007            MOV      DPTR,#07H
B3:00B0A2 02243E            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_txOptions (END) -------


----- FUNCTION ?L?COM045A (BEGIN) -----
B3:00B0A5 90461B            MOV      DPTR,#handle
B3:00B0A8 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM045A (END) -------


----- FUNCTION _MemoryGetID (BEGIN) -----
B3:00B0AB 9044B5            MOV      DPTR,#pHomeID
B3:00B0AE 122572            LCALL    ?C?PSTXDATA
B3:00B0B1 31E2              ACALL    ?L?COM056F
B3:00B0B3 9044B8            MOV      DPTR,#pNodeID
B3:00B0B6 1256DF            LCALL    ?L?COM0125
B3:00B0B9 9044B5            MOV      DPTR,#pHomeID
B3:00B0BC 122552            LCALL    ?C?PLDXDATA
B3:00B0BF E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 795


B3:00B0C0 4A                ORL      A,R2
B3:00B0C1 6009              JZ       ?C0005?ZW_MEM
B3:00B0C3 9044B5            MOV      DPTR,#pHomeID
B3:00B0C6 12BB0B            LCALL    ?L?COM0449
B3:00B0C9 126F1B            LCALL    ?L?COM0388
B3:00B0CC         ?C0005?ZW_MEM:
B3:00B0CC 22                RET      
----- FUNCTION _MemoryGetID (END) -------


----- FUNCTION sec2_inclusion_abort (BEGIN) -----
B3:;----                  JMP      s2_inclusion_abort
----- FUNCTION sec2_inclusion_abort (END) -------


----- FUNCTION s2_inclusion_abort (BEGIN) -----
B3:00B0CD 7F03              MOV      R7,#03H
B3:00B0CF 7E02              MOV      R6,#02H
B3:00B0D1 028BE8            LJMP     _process_event
----- FUNCTION s2_inclusion_abort (END) -------


----- FUNCTION _sec0_send_nonce (BEGIN) -----
B3:00B0D4 9040C5            MOV      DPTR,#snode
B3:00B0D7 126563            LCALL    ?L?COM00E9
B3:00B0DA EB                MOV      A,R3
B3:00B0DB F0                MOVX     @DPTR,A
B3:00B0DC 7B01              MOV      R3,#01H
B3:00B0DE 7A2B              MOV      R2,#HIGH txo
B3:00B0E0 798A              MOV      R1,#LOW txo
B3:00B0E2 7D06              MOV      R5,#06H
B3:00B0E4 E4                CLR      A
B3:00B0E5 FF                MOV      R7,A
B3:00B0E6 12851A            LCALL    ___ZW_memset
B3:00B0E9 9040C6            MOV      DPTR,#dnode
B3:00B0EC E0                MOVX     A,@DPTR
B3:00B0ED 902B8B            MOV      DPTR,#txo+01H
B3:00B0F0 F0                MOVX     @DPTR,A
B3:00B0F1 9040C5            MOV      DPTR,#snode
B3:00B0F4 E0                MOVX     A,@DPTR
B3:00B0F5 902B8A            MOV      DPTR,#txo
B3:00B0F8 F0                MOVX     @DPTR,A
B3:00B0F9 9040C7            MOV      DPTR,#txoptions
B3:00B0FC E0                MOVX     A,@DPTR
B3:00B0FD 902B8C            MOV      DPTR,#txo+02H
B3:00B100 F0                MOVX     @DPTR,A
B3:00B101         ?C0141?ZW_SECURITY_SCHEME0:
B3:00B101 7B01              MOV      R3,#01H
B3:00B103 7A40              MOV      R2,#HIGH nonce
B3:00B105 79C8              MOV      R1,#LOW nonce
B3:00B107 12CE0A            LCALL    _aes_random8
B3:00B10A 3165              ACALL    ?L?COM0507
B3:00B10C E0                MOVX     A,@DPTR
B3:00B10D FD                MOV      R5,A
B3:00B10E 7B01              MOV      R3,#01H
B3:00B110 7A40              MOV      R2,#HIGH tmpnonce
B3:00B112 79D0              MOV      R1,#LOW tmpnonce
B3:00B114 12EE43            LCALL    ?L?COM0257
B3:00B117 9040C8            MOV      DPTR,#nonce
B3:00B11A 12D1B7            LCALL    ?L?COM04AE
B3:00B11D 70E2              JNZ      ?C0141?ZW_SECURITY_SCHEME0
B3:00B11F 902B80            MOV      DPTR,#nonce_res
B3:00B122 7498              MOV      A,#098H
B3:00B124 F0                MOVX     @DPTR,A
B3:00B125 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 796


B3:00B126 7480              MOV      A,#080H
B3:00B128 F0                MOVX     @DPTR,A
B3:00B129 7B01              MOV      R3,#01H
B3:00B12B 7A40              MOV      R2,#HIGH nonce
B3:00B12D 79C8              MOV      R1,#LOW nonce
B3:00B12F 128549            LCALL    ?L?COM0019
B3:00B132 7A2B              MOV      R2,#HIGH nonce_res+02H
B3:00B134 7982              MOV      R1,#LOW nonce_res+02H
B3:00B136 7F08              MOV      R7,#08H
B3:00B138 128195            LCALL    ___ZW_memcpy
B3:00B13B 7B01              MOV      R3,#01H
B3:00B13D 7A2B              MOV      R2,#HIGH txo
B3:00B13F 798A              MOV      R1,#LOW txo
B3:00B141 1281DC            LCALL    ?L?COM00AE
B3:00B144 E4                CLR      A
B3:00B145 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00B148 F0                MOVX     @DPTR,A
B3:00B149 A3                INC      DPTR
B3:00B14A F0                MOVX     @DPTR,A
B3:00B14B 7A2B              MOV      R2,#HIGH nonce_res
B3:00B14D 7980              MOV      R1,#LOW nonce_res
B3:00B14F 7D0A              MOV      R5,#0AH
B3:00B151 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00B154 EF                MOV      A,R7
B3:00B155 600D              JZ       ?C0143?ZW_SECURITY_SCHEME0
B3:00B157 3165              ACALL    ?L?COM0507
B3:00B159 7A40              MOV      R2,#HIGH nonce
B3:00B15B 79C8              MOV      R1,#LOW nonce
B3:00B15D 12D2E6            LCALL    ?L?COM0189
B3:00B160 1B                DEC      R3
B3:00B161 12CE2D            LCALL    _register_nonce
B3:00B164         ?C0143?ZW_SECURITY_SCHEME0:
B3:00B164 22                RET      
----- FUNCTION _sec0_send_nonce (END) -------


----- FUNCTION ?L?COM0507 (BEGIN) -----
B3:00B165 9040C6            MOV      DPTR,#dnode
B3:00B168 E0                MOVX     A,@DPTR
B3:00B169 FF                MOV      R7,A
B3:00B16A 9040C5            MOV      DPTR,#snode
B3:00B16D 22                RET      
----- FUNCTION ?L?COM0507 (END) -------


----- FUNCTION _secure_learnIface_raise_tx_done (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B16E 900023            MOV      DPTR,#023H
B3:00B171 7401              MOV      A,#01H
B3:00B173 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_tx_done (END) -------


----- FUNCTION GenerateNIF (BEGIN) -----
B3:00B176 7B01              MOV      R3,#01H
B3:00B178 7A08              MOV      R2,#HIGH exploreRequestBuffer+04H
B3:00B17A 7973              MOV      R1,#LOW exploreRequestBuffer+04H
B3:00B17C 1219E4            LCALL    ?INTERBANK_TABLE?_GenerateNodeInformation
B3:00B17F E4                CLR      A
B3:00B180 90086F            MOV      DPTR,#exploreRequestBuffer
B3:00B183 026F69            LJMP     ?L?COM0404
----- FUNCTION GenerateNIF (END) -------


----- FUNCTION ZW_ExploreRequestExclusion (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 797


B3:00B186 300126            JNB      learnMode,?C0001?ZW_EXPLORE_EXCL_REQ
B3:00B189 200223            JB       findInProgress,?C0001?ZW_EXPLORE_EXCL_REQ
B3:00B18C E550              MOV      A,bNetworkWideInclusion
B3:00B18E 6402              XRL      A,#02H
B3:00B190 701D              JNZ      ?C0001?ZW_EXPLORE_EXCL_REQ
B3:00B192 31B7              ACALL    ?L?COM02FF
B3:00B194 1219E4            LCALL    ?INTERBANK_TABLE?_GenerateNodeInformation
B3:00B197 900870            MOV      DPTR,#exploreRequestBuffer+01H
B3:00B19A 7423              MOV      A,#023H
B3:00B19C F0                MOVX     @DPTR,A
B3:00B19D 31B2              ACALL    ?L?COM02FE
B3:00B19F 9033D6            MOV      DPTR,#blnodeInfoLength
B3:00B1A2 E0                MOVX     A,@DPTR
B3:00B1A3 900A4F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B3:00B1A6 7177              ACALL    ?L?COM0114
B3:00B1A8 A3                INC      DPTR
B3:00B1A9 F0                MOVX     @DPTR,A
B3:00B1AA 7DFF              MOV      R5,#0FFH
B3:00B1AC 028FD7            LJMP     _ExploreQueueFrame
B3:00B1AF         ?C0001?ZW_EXPLORE_EXCL_REQ:
B3:00B1AF 7F00              MOV      R7,#00H
B3:00B1B1 22                RET      
----- FUNCTION ZW_ExploreRequestExclusion (END) -------


----- FUNCTION ?L?COM02FE (BEGIN) -----
B3:00B1B2 901221            MOV      DPTR,#nodeID
B3:00B1B5 E0                MOVX     A,@DPTR
B3:00B1B6 FF                MOV      R7,A
B3:00B1B7         ?L?COM02FF:
B3:00B1B7 7B01              MOV      R3,#01H
B3:00B1B9 7A08              MOV      R2,#HIGH exploreRequestBuffer
B3:00B1BB 796F              MOV      R1,#LOW exploreRequestBuffer
B3:00B1BD 22                RET      
----- FUNCTION ?L?COM02FE (END) -------


----- FUNCTION _s2_inclusion_joining_start (BEGIN) -----
B3:00B1BE 9046BA            MOV      DPTR,#csa
B3:00B1C1 ED                MOV      A,R5
B3:00B1C2 F0                MOVX     @DPTR,A
;---- Variable 'p_connection' assigned to Register 'R1/R2/R3' ----
B3:00B1C3 12BD20            LCALL    ?L?COM0172
B3:00B1C6 9046BA            MOV      DPTR,#csa
B3:00B1C9 E0                MOVX     A,@DPTR
B3:00B1CA 7F01              MOV      R7,#01H
B3:00B1CC 6002              JZ       ?C0047?S2_INCLUSION
B3:00B1CE 7F00              MOV      R7,#00H
B3:00B1D0         ?C0047?S2_INCLUSION:
B3:00B1D0         ?C0048?S2_INCLUSION:
B3:00B1D0 902A14            MOV      DPTR,#the_context+0210H
B3:00B1D3 EF                MOV      A,R7
B3:00B1D4 F0                MOVX     @DPTR,A
B3:00B1D5 7F01              MOV      R7,#01H
B3:00B1D7 7E02              MOV      R6,#02H
B3:00B1D9 028BE8            LJMP     _process_event
----- FUNCTION _s2_inclusion_joining_start (END) -------


----- FUNCTION ?L?COM04AA (BEGIN) -----
B3:00B1DC 90461E            MOV      DPTR,#handle
B3:00B1DF 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM04AA (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 798


----- FUNCTION ?L?COM056F (BEGIN) -----
B3:00B1E2 7E00              MOV      R6,#HIGH NVM_NODEID_far
B3:00B1E4 7F08              MOV      R7,#LOW NVM_NODEID_far
B3:00B1E6 0239F2            LJMP     _NVM_ext_read_byte
----- FUNCTION ?L?COM056F (END) -------


----- FUNCTION _secure_learn_isActive (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'state' assigned to Register 'R5' ----
B3:00B1E9 ED                MOV      A,R5
B3:00B1EA 12267F            LCALL    ?C?CCASE
B3:00B1ED B215              DW       ?C0042?SECURE_LEARN
B3:00B1EF 00                DB       00H
B3:00B1F0 B22A              DW       ?C0046?SECURE_LEARN
B3:00B1F2 01                DB       01H
B3:00B1F3 B235              DW       ?C0049?SECURE_LEARN
B3:00B1F5 02                DB       02H
B3:00B1F6 B240              DW       ?C0052?SECURE_LEARN
B3:00B1F8 03                DB       03H
B3:00B1F9 B24B              DW       ?C0055?SECURE_LEARN
B3:00B1FB 04                DB       04H
B3:00B1FC B256              DW       ?C0058?SECURE_LEARN
B3:00B1FE 05                DB       05H
B3:00B1FF B261              DW       ?C0061?SECURE_LEARN
B3:00B201 06                DB       06H
B3:00B202 B26C              DW       ?C0064?SECURE_LEARN
B3:00B204 07                DB       07H
B3:00B205 B277              DW       ?C0067?SECURE_LEARN
B3:00B207 08                DB       08H
B3:00B208 B282              DW       ?C0070?SECURE_LEARN
B3:00B20A 09                DB       09H
B3:00B20B B28D              DW       ?C0073?SECURE_LEARN
B3:00B20D 0A                DB       0AH
B3:00B20E B298              DW       ?C0076?SECURE_LEARN
B3:00B210 0B                DB       0BH
B3:00B211 0000              DW       00H
B3:00B213 B2A3              DW       ?C0079?SECURE_LEARN
B3:00B215         ?C0042?SECURE_LEARN:
B3:00B215 121F7C            LCALL    ?C?CLDPTR
B3:00B218 FF                MOV      R7,A
B3:00B219 C3                CLR      C
B3:00B21A 9400              SUBB     A,#00H
B3:00B21C 4009              JC       ?C0043?SECURE_LEARN
B3:00B21E EF                MOV      A,R7
B3:00B21F D3                SETB     C
B3:00B220 9408              SUBB     A,#08H
B3:00B222 5003              JNC      ?C0043?SECURE_LEARN
B3:00B224 7F01              MOV      R7,#01H
B3:00B226 22                RET      
B3:00B227         ?C0043?SECURE_LEARN:
B3:00B227 7F00              MOV      R7,#00H
B3:00B229 22                RET      
B3:00B22A         ?C0046?SECURE_LEARN:
B3:00B22A 121F7C            LCALL    ?C?CLDPTR
B3:00B22D 7F00              MOV      R7,#00H
B3:00B22F B40102            CJNE     A,#01H,?C0047?SECURE_LEARN
B3:00B232 7F01              MOV      R7,#01H
B3:00B234         ?C0047?SECURE_LEARN:
B3:00B234 22                RET      
B3:00B235         ?C0049?SECURE_LEARN:
B3:00B235 121F7C            LCALL    ?C?CLDPTR
B3:00B238 7F00              MOV      R7,#00H
B3:00B23A B40202            CJNE     A,#02H,?C0050?SECURE_LEARN
B3:00B23D 7F01              MOV      R7,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 799


B3:00B23F         ?C0050?SECURE_LEARN:
B3:00B23F 22                RET      
B3:00B240         ?C0052?SECURE_LEARN:
B3:00B240 121F7C            LCALL    ?C?CLDPTR
B3:00B243 7F00              MOV      R7,#00H
B3:00B245 B40302            CJNE     A,#03H,?C0053?SECURE_LEARN
B3:00B248 7F01              MOV      R7,#01H
B3:00B24A         ?C0053?SECURE_LEARN:
B3:00B24A 22                RET      
B3:00B24B         ?C0055?SECURE_LEARN:
B3:00B24B 121F7C            LCALL    ?C?CLDPTR
B3:00B24E 7F00              MOV      R7,#00H
B3:00B250 B40402            CJNE     A,#04H,?C0056?SECURE_LEARN
B3:00B253 7F01              MOV      R7,#01H
B3:00B255         ?C0056?SECURE_LEARN:
B3:00B255 22                RET      
B3:00B256         ?C0058?SECURE_LEARN:
B3:00B256 121F7C            LCALL    ?C?CLDPTR
B3:00B259 7F00              MOV      R7,#00H
B3:00B25B B40502            CJNE     A,#05H,?C0059?SECURE_LEARN
B3:00B25E 7F01              MOV      R7,#01H
B3:00B260         ?C0059?SECURE_LEARN:
B3:00B260 22                RET      
B3:00B261         ?C0061?SECURE_LEARN:
B3:00B261 121F7C            LCALL    ?C?CLDPTR
B3:00B264 7F00              MOV      R7,#00H
B3:00B266 B40602            CJNE     A,#06H,?C0062?SECURE_LEARN
B3:00B269 7F01              MOV      R7,#01H
B3:00B26B         ?C0062?SECURE_LEARN:
B3:00B26B 22                RET      
B3:00B26C         ?C0064?SECURE_LEARN:
B3:00B26C 121F7C            LCALL    ?C?CLDPTR
B3:00B26F 7F00              MOV      R7,#00H
B3:00B271 B40702            CJNE     A,#07H,?C0065?SECURE_LEARN
B3:00B274 7F01              MOV      R7,#01H
B3:00B276         ?C0065?SECURE_LEARN:
B3:00B276 22                RET      
B3:00B277         ?C0067?SECURE_LEARN:
B3:00B277 121F7C            LCALL    ?C?CLDPTR
B3:00B27A 7F00              MOV      R7,#00H
B3:00B27C B40802            CJNE     A,#08H,?C0068?SECURE_LEARN
B3:00B27F 7F01              MOV      R7,#01H
B3:00B281         ?C0068?SECURE_LEARN:
B3:00B281 22                RET      
B3:00B282         ?C0070?SECURE_LEARN:
B3:00B282 121F7C            LCALL    ?C?CLDPTR
B3:00B285 7F00              MOV      R7,#00H
B3:00B287 B40902            CJNE     A,#09H,?C0071?SECURE_LEARN
B3:00B28A 7F01              MOV      R7,#01H
B3:00B28C         ?C0071?SECURE_LEARN:
B3:00B28C 22                RET      
B3:00B28D         ?C0073?SECURE_LEARN:
B3:00B28D 121F7C            LCALL    ?C?CLDPTR
B3:00B290 7F00              MOV      R7,#00H
B3:00B292 B40A02            CJNE     A,#0AH,?C0074?SECURE_LEARN
B3:00B295 7F01              MOV      R7,#01H
B3:00B297         ?C0074?SECURE_LEARN:
B3:00B297 22                RET      
B3:00B298         ?C0076?SECURE_LEARN:
B3:00B298 121F7C            LCALL    ?C?CLDPTR
B3:00B29B 7F00              MOV      R7,#00H
B3:00B29D B40B02            CJNE     A,#0BH,?C0077?SECURE_LEARN
B3:00B2A0 7F01              MOV      R7,#01H
B3:00B2A2         ?C0077?SECURE_LEARN:
B3:00B2A2 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 800


B3:00B2A3         ?C0079?SECURE_LEARN:
B3:00B2A3 7F00              MOV      R7,#00H
B3:00B2A5 22                RET      
----- FUNCTION _secure_learn_isActive (END) -------


----- FUNCTION ZW_ExploreRequestInclusion (BEGIN) -----
B3:00B2A6 9046AA            MOV      DPTR,#bExploreTransmitOptions
B3:00B2A9 7410              MOV      A,#010H
B3:00B2AB F0                MOVX     @DPTR,A
B3:00B2AC 300164            JNB      learnMode,?C0003?ZW_EXPLORE_INCL_REQ
B3:00B2AF 200261            JB       findInProgress,?C0003?ZW_EXPLORE_INCL_REQ
B3:00B2B2 31E2              ACALL    ?L?COM056F
B3:00B2B4 EF                MOV      A,R7
B3:00B2B5 705C              JNZ      ?C0003?ZW_EXPLORE_INCL_REQ
B3:00B2B7 E550              MOV      A,bNetworkWideInclusion
B3:00B2B9 6401              XRL      A,#01H
B3:00B2BB 7056              JNZ      ?C0003?ZW_EXPLORE_INCL_REQ
B3:00B2BD 3176              ACALL    GenerateNIF
B3:00B2BF 30031A            JNB      learnModeDsk,?C0004?ZW_EXPLORE_INCL_REQ
B3:00B2C2 125F32            LCALL    NetworkManagementSmartStartIsInclude
B3:00B2C5 EF                MOV      A,R7
B3:00B2C6 900874            MOV      DPTR,#exploreRequestBuffer+05H
B3:00B2C9 600C              JZ       ?C0005?ZW_EXPLORE_INCL_REQ
B3:00B2CB 7428              MOV      A,#028H
B3:00B2CD F0                MOVX     @DPTR,A
B3:00B2CE 9046AA            MOV      DPTR,#bExploreTransmitOptions
B3:00B2D1 E0                MOVX     A,@DPTR
B3:00B2D2 4408              ORL      A,#08H
B3:00B2D4 F0                MOVX     @DPTR,A
B3:00B2D5 800C              SJMP     ?C0007?ZW_EXPLORE_INCL_REQ
B3:00B2D7         ?C0005?ZW_EXPLORE_INCL_REQ:
B3:00B2D7 7427              MOV      A,#027H
B3:00B2D9 F0                MOVX     @DPTR,A
B3:00B2DA 8007              SJMP     ?C0007?ZW_EXPLORE_INCL_REQ
B3:00B2DC         ?C0004?ZW_EXPLORE_INCL_REQ:
B3:00B2DC 9046AA            MOV      DPTR,#bExploreTransmitOptions
B3:00B2DF E0                MOVX     A,@DPTR
B3:00B2E0 4401              ORL      A,#01H
B3:00B2E2 F0                MOVX     @DPTR,A
B3:00B2E3         ?C0007?ZW_EXPLORE_INCL_REQ:
B3:00B2E3 31B7              ACALL    ?L?COM02FF
B3:00B2E5 9033D6            MOV      DPTR,#blnodeInfoLength
B3:00B2E8 E0                MOVX     A,@DPTR
B3:00B2E9 2404              ADD      A,#04H
B3:00B2EB 900A4F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B3:00B2EE F0                MOVX     @DPTR,A
B3:00B2EF 9046AA            MOV      DPTR,#bExploreTransmitOptions
B3:00B2F2 E0                MOVX     A,@DPTR
B3:00B2F3 900A50            MOV      DPTR,#?_ExploreQueueFrame?BYTE+06H
B3:00B2F6 F0                MOVX     @DPTR,A
B3:00B2F7 300306            JNB      learnModeDsk,?C0008?ZW_EXPLORE_INCL_REQ
B3:00B2FA 7E40              MOV      R6,#HIGH _ZCB_NetworkManagementExploreRequestComplete
B3:00B2FC 7F61              MOV      R7,#LOW _ZCB_NetworkManagementExploreRequestComplete
B3:00B2FE 8004              SJMP     ?C0009?ZW_EXPLORE_INCL_REQ
B3:00B300         ?C0008?ZW_EXPLORE_INCL_REQ:
B3:00B300 7E00              MOV      R6,#00H
B3:00B302 7F00              MOV      R7,#00H
B3:00B304         ?C0009?ZW_EXPLORE_INCL_REQ:
B3:00B304 900A51            MOV      DPTR,#?_ExploreQueueFrame?BYTE+07H
B3:00B307 EE                MOV      A,R6
B3:00B308 F0                MOVX     @DPTR,A
B3:00B309 A3                INC      DPTR
B3:00B30A 126FCE            LCALL    ?L?COM0453
B3:00B30D FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 801


B3:00B30E 7DFF              MOV      R5,#0FFH
B3:00B310 028FD7            LJMP     _ExploreQueueFrame
B3:00B313         ?C0003?ZW_EXPLORE_INCL_REQ:
B3:00B313 7F00              MOV      R7,#00H
B3:00B315 22                RET      
----- FUNCTION ZW_ExploreRequestInclusion (END) -------


----- FUNCTION ?L?COM0049 (BEGIN) -----
B3:00B316 E4                CLR      A
B3:00B317 7FE8              MOV      R7,#0E8H
B3:00B319 7E03              MOV      R6,#03H
B3:00B31B FD                MOV      R5,A
B3:00B31C FC                MOV      R4,A
B3:00B31D 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00B320 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_nonce_timer_timeout
B3:00B322 F0                MOVX     @DPTR,A
B3:00B323 A3                INC      DPTR
B3:00B324 745F              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_nonce_timer_timeout
B3:00B326         ?L?COM004A:
B3:00B326 F0                MOVX     @DPTR,A
B3:00B327         ?L?COM004B:
B3:00B327 7B00              MOV      R3,#00H
B3:00B329 7A00              MOV      R2,#00H
B3:00B32B 7900              MOV      R1,#00H
B3:00B32D 22                RET      
----- FUNCTION ?L?COM0049 (END) -------


----- FUNCTION ExploreINIF (BEGIN) -----
B3:00B32E 31B7              ACALL    ?L?COM02FF
B3:00B330 7D0A              MOV      R5,#0AH
B3:00B332 E4                CLR      A
B3:00B333 FF                MOV      R7,A
B3:00B334 12851A            LCALL    ___ZW_memset
B3:00B337 900873            MOV      DPTR,#exploreRequestBuffer+04H
B3:00B33A 7401              MOV      A,#01H
B3:00B33C F0                MOVX     @DPTR,A
B3:00B33D A3                INC      DPTR
B3:00B33E 7426              MOV      A,#026H
B3:00B340 F0                MOVX     @DPTR,A
B3:00B341 125F73            LCALL    NetworkManagementGenerateDskpart
B3:00B344 7B01              MOV      R3,#01H
B3:00B346 7A33              MOV      R2,#HIGH Dsk+08H
B3:00B348 7934              MOV      R1,#LOW Dsk+08H
B3:00B34A 128549            LCALL    ?L?COM0019
B3:00B34D 7A08              MOV      R2,#HIGH exploreRequestBuffer+06H
B3:00B34F 7975              MOV      R1,#LOW exploreRequestBuffer+06H
B3:00B351 7F04              MOV      R7,#04H
B3:00B353 128195            LCALL    ___ZW_memcpy
B3:00B356 31B2              ACALL    ?L?COM02FE
B3:00B358 900A4F            MOV      DPTR,#?_ExploreQueueFrame?BYTE+05H
B3:00B35B 740A              MOV      A,#0AH
B3:00B35D F0                MOVX     @DPTR,A
B3:00B35E A3                INC      DPTR
B3:00B35F 7410              MOV      A,#010H
B3:00B361 7177              ACALL    ?L?COM0114
B3:00B363 7DFF              MOV      R5,#0FFH
B3:00B365 028FD7            LJMP     _ExploreQueueFrame
----- FUNCTION ExploreINIF (END) -------


----- FUNCTION ?L?COM0112 (BEGIN) -----
B3:00B368 7B01              MOV      R3,#01H
B3:00B36A 9043CE            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 802


B3:00B36D F0                MOVX     @DPTR,A
B3:00B36E 90307E            MOV      DPTR,#rcb+04H
B3:00B371         ?L?COM0113:
B3:00B371 E0                MOVX     A,@DPTR
B3:00B372 4401              ORL      A,#01H
B3:00B374 9043CF            MOV      DPTR,#?_TS_SendRaw?BYTE+05H
B3:00B377         ?L?COM0114:
B3:00B377 F0                MOVX     @DPTR,A
B3:00B378 E4                CLR      A
B3:00B379 A3                INC      DPTR
B3:00B37A F0                MOVX     @DPTR,A
B3:00B37B A3                INC      DPTR
B3:00B37C F0                MOVX     @DPTR,A
B3:00B37D 22                RET      
----- FUNCTION ?L?COM0112 (END) -------


----- FUNCTION _ExplorePurgeQueue (BEGIN) -----
B3:00B37E 900ADE            MOV      DPTR,#sourceID
B3:00B381 126FCE            LCALL    ?L?COM0453
B3:00B384 6F                XRL      A,R7
B3:00B385 7002              JNZ      $ + 4H
B3:00B387 8111              AJMP     ?C0104?ZW_EXPLORE
B3:00B389 E4                CLR      A
B3:00B38A 900ADF            MOV      DPTR,#j
B3:00B38D F0                MOVX     @DPTR,A
B3:00B38E         ?C0099?ZW_EXPLORE:
B3:00B38E 900ADF            MOV      DPTR,#j
B3:00B391 E0                MOVX     A,@DPTR
B3:00B392 FF                MOV      R7,A
B3:00B393 C3                CLR      C
B3:00B394 9402              SUBB     A,#02H
B3:00B396 5063              JNC      ?C0100?ZW_EXPLORE
B3:00B398 EF                MOV      A,R7
B3:00B399 9116              ACALL    ?L?COM02AF
B3:00B39B 12471D            LCALL    ?L?COM0211
B3:00B39E 4E                ORL      A,R6
B3:00B39F 6049              JZ       ?C0102?ZW_EXPLORE
B3:00B3A1 900ADF            MOV      DPTR,#j
B3:00B3A4 E0                MOVX     A,@DPTR
B3:00B3A5 75F060            MOV      B,#060H
B3:00B3A8 A4                MUL      AB
B3:00B3A9 249A              ADD      A,#LOW exploreQueue+09H
B3:00B3AB F582              MOV      DPL,A
B3:00B3AD E4                CLR      A
B3:00B3AE 3407              ADDC     A,#HIGH exploreQueue+09H
B3:00B3B0 12471D            LCALL    ?L?COM0211
B3:00B3B3 FF                MOV      R7,A
B3:00B3B4 125949            LCALL    _getTickTimePassed
B3:00B3B7 900ADF            MOV      DPTR,#j
B3:00B3BA E0                MOVX     A,@DPTR
B3:00B3BB FD                MOV      R5,A
B3:00B3BC 75F060            MOV      B,#060H
B3:00B3BF A4                MUL      AB
B3:00B3C0 249C              ADD      A,#LOW exploreQueue+0BH
B3:00B3C2 F582              MOV      DPL,A
B3:00B3C4 E4                CLR      A
B3:00B3C5 3407              ADDC     A,#HIGH exploreQueue+0BH
B3:00B3C7 126557            LCALL    ?L?COM050A
B3:00B3CA 75F060            MOV      B,#060H
B3:00B3CD A4                MUL      AB
B3:00B3CE 249C              ADD      A,#LOW exploreQueue+0BH
B3:00B3D0 F9                MOV      R1,A
B3:00B3D1 7407              MOV      A,#HIGH exploreQueue+0BH
B3:00B3D3 35F0              ADDC     A,B
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 803


B3:00B3D5 FA                MOV      R2,A
B3:00B3D6 7B01              MOV      R3,#01H
B3:00B3D8 9112              ACALL    ?L?COM02AE
B3:00B3DA 12471D            LCALL    ?L?COM0211
B3:00B3DD F582              MOV      DPL,A
B3:00B3DF 126EED            LCALL    ?L?COM0372
B3:00B3E2 9112              ACALL    ?L?COM02AE
B3:00B3E4 F583              MOV      DPH,A
B3:00B3E6 E4                CLR      A
B3:00B3E7 F0                MOVX     @DPTR,A
B3:00B3E8 A3                INC      DPTR
B3:00B3E9 F0                MOVX     @DPTR,A
B3:00B3EA         ?C0102?ZW_EXPLORE:
B3:00B3EA 900ADF            MOV      DPTR,#j
B3:00B3ED E0                MOVX     A,@DPTR
B3:00B3EE 12EEB4            LCALL    ?L?COM03A6
B3:00B3F1 E4                CLR      A
B3:00B3F2 F0                MOVX     @DPTR,A
B3:00B3F3 900ADF            MOV      DPTR,#j
B3:00B3F6 E0                MOVX     A,@DPTR
B3:00B3F7 04                INC      A
B3:00B3F8 F0                MOVX     @DPTR,A
B3:00B3F9 8093              SJMP     ?C0099?ZW_EXPLORE
B3:00B3FB         ?C0100?ZW_EXPLORE:
B3:00B3FB C213              CLR      bExploreSlotTaken
B3:00B3FD 900ADE            MOV      DPTR,#sourceID
B3:00B400 E0                MOVX     A,@DPTR
B3:00B401 B4FE0D            CJNE     A,#0FEH,?C0104?ZW_EXPLORE
B3:00B404 7FFE              MOV      R7,#0FEH
B3:00B406 12C915            LCALL    _ExploreFrameIgnoreQueueIndex
B3:00B409 1289A1            LCALL    ?L?COM0217
B3:00B40C 7607              MOV      @R0,#07H
B3:00B40E 08                INC      R0
B3:00B40F 76D0              MOV      @R0,#0D0H
B3:00B411         ?C0104?ZW_EXPLORE:
B3:00B411 22                RET      
----- FUNCTION _ExplorePurgeQueue (END) -------


----- FUNCTION ?L?COM02AE (BEGIN) -----
B3:00B412 900ADF            MOV      DPTR,#j
B3:00B415 E0                MOVX     A,@DPTR
B3:00B416         ?L?COM02AF:
B3:00B416 75F060            MOV      B,#060H
B3:00B419 A4                MUL      AB
B3:00B41A 24AF              ADD      A,#LOW exploreQueue+01EH
B3:00B41C F582              MOV      DPL,A
B3:00B41E E4                CLR      A
B3:00B41F 3407              ADDC     A,#HIGH exploreQueue+01EH
B3:00B421 22                RET      
----- FUNCTION ?L?COM02AE (END) -------


----- FUNCTION send_frag_req_cmd (BEGIN) -----
B3:00B422 7B01              MOV      R3,#01H
B3:00B424 7A30              MOV      R2,#HIGH t2_txBuf
B3:00B426 7934              MOV      R1,#LOW t2_txBuf
B3:00B428 9044E5            MOV      DPTR,#frag_req
B3:00B42B 122572            LCALL    ?C?PSTXDATA
B3:00B42E E4                CLR      A
B3:00B42F 9044EA            MOV      DPTR,#ret1
B3:00B432 F0                MOVX     @DPTR,A
B3:00B433 12DFCB            LCALL    get_next_missing_frag
B3:00B436 9044E8            MOV      DPTR,#offset_to_request
B3:00B439 126F4A            LCALL    ?L?COM03D3
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 804


B3:00B43C 7008              JNZ      ?C0193?TRANSPORT_SERVICE2
B3:00B43E 7F05              MOV      R7,#05H
B3:00B440 129C55            LCALL    _t2_sm_post_event
B3:00B443 7F00              MOV      R7,#00H
B3:00B445 22                RET      
B3:00B446         ?C0193?TRANSPORT_SERVICE2:
B3:00B446 903096            MOV      DPTR,#rcb+01CH
B3:00B449 E0                MOVX     A,@DPTR
B3:00B44A D3                SETB     C
B3:00B44B 940F              SUBB     A,#0FH
B3:00B44D 4003              JC       ?C0195?TRANSPORT_SERVICE2
B3:00B44F 7F00              MOV      R7,#00H
B3:00B451 22                RET      
B3:00B452         ?C0195?TRANSPORT_SERVICE2:
B3:00B452 91B9              ACALL    ?L?COM049A
B3:00B454 7455              MOV      A,#055H
B3:00B456 12203B            LCALL    ?C?CSTPTR
B3:00B459 91B9              ACALL    ?L?COM049A
B3:00B45B 74C8              MOV      A,#0C8H
B3:00B45D 126B68            LCALL    ?L?COM0469
B3:00B460 903096            MOV      DPTR,#rcb+01CH
B3:00B463 E0                MOVX     A,@DPTR
B3:00B464 C4                SWAP     A
B3:00B465 54F0              ANL      A,#0F0H
B3:00B467 F1B8              ACALL    ?L?COM036B
B3:00B469 E9                MOV      A,R1
B3:00B46A 2402              ADD      A,#02H
B3:00B46C 1252DD            LCALL    ?L?COM0009
B3:00B46F FD                MOV      R5,A
B3:00B470 9044E8            MOV      DPTR,#offset_to_request
B3:00B473 E0                MOVX     A,@DPTR
B3:00B474 5407              ANL      A,#07H
B3:00B476 4D                ORL      A,R5
B3:00B477 12203B            LCALL    ?C?CSTPTR
B3:00B47A 9044E8            MOV      DPTR,#offset_to_request
B3:00B47D A3                INC      DPTR
B3:00B47E E0                MOVX     A,@DPTR
B3:00B47F FF                MOV      R7,A
B3:00B480 91B9              ACALL    ?L?COM049A
B3:00B482 900003            MOV      DPTR,#03H
B3:00B485 EF                MOV      A,R7
B3:00B486 12204D            LCALL    ?C?CSTOPTR
B3:00B489 91C0              ACALL    ?L?COM0027
B3:00B48B 7A30              MOV      R2,#HIGH t2_txBuf
B3:00B48D 7934              MOV      R1,#LOW t2_txBuf
B3:00B48F 7404              MOV      A,#04H
B3:00B491 7168              ACALL    ?L?COM0112
B3:00B493 90307A            MOV      DPTR,#rcb
B3:00B496 D163              ACALL    ?L?COM0101
B3:00B498 9044EA            MOV      DPTR,#ret1
B3:00B49B F0                MOVX     @DPTR,A
B3:00B49C 7008              JNZ      ?C0196?TRANSPORT_SERVICE2
B3:00B49E 90309C            MOV      DPTR,#rcb+022H
B3:00B4A1 E0                MOVX     A,@DPTR
B3:00B4A2 6002              JZ       ?C0196?TRANSPORT_SERVICE2
B3:00B4A4 14                DEC      A
B3:00B4A5 F0                MOVX     @DPTR,A
B3:00B4A6         ?C0196?TRANSPORT_SERVICE2:
B3:00B4A6 9030BD            MOV      DPTR,#rcb+043H
B3:00B4A9 7401              MOV      A,#01H
B3:00B4AB F0                MOVX     @DPTR,A
B3:00B4AC 7F05              MOV      R7,#05H
B3:00B4AE 129C55            LCALL    _t2_sm_post_event
B3:00B4B1 12ED81            LCALL    ?L?COM0139
B3:00B4B4 91DD              ACALL    ?L?COM0028
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 805


B3:00B4B6 7F00              MOV      R7,#00H
B3:00B4B8 22                RET      
----- FUNCTION send_frag_req_cmd (END) -------


----- FUNCTION ?L?COM049A (BEGIN) -----
B3:00B4B9 9044E5            MOV      DPTR,#frag_req
B3:00B4BC 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM049A (END) -------


----- FUNCTION ?L?COM0026 (BEGIN) -----
B3:00B4BF F0                MOVX     @DPTR,A
B3:00B4C0         ?L?COM0027:
B3:00B4C0 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00B4C3 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_reset_transport_service
B3:00B4C5 F0                MOVX     @DPTR,A
B3:00B4C6 A3                INC      DPTR
B3:00B4C7 749A              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_reset_transport_service
B3:00B4C9 F0                MOVX     @DPTR,A
B3:00B4CA 7B00              MOV      R3,#00H
B3:00B4CC 7A00              MOV      R2,#00H
B3:00B4CE 7900              MOV      R1,#00H
B3:00B4D0 A3                INC      DPTR
B3:00B4D1 122572            LCALL    ?C?PSTXDATA
B3:00B4D4 0B                INC      R3
B3:00B4D5 7A31              MOV      R2,#HIGH scb+02EH
B3:00B4D7 79D4              MOV      R1,#LOW scb+02EH
B3:00B4D9 7F88              MOV      R7,#088H
B3:00B4DB 7E13              MOV      R6,#013H
B3:00B4DD         ?L?COM0028:
B3:00B4DD 7D00              MOV      R5,#00H
B3:00B4DF 7C00              MOV      R4,#00H
B3:00B4E1 021B29            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION ?L?COM0026 (END) -------


----- FUNCTION send_last_frag (BEGIN) -----
B3:00B4E4 E4                CLR      A
B3:00B4E5 9046BC            MOV      DPTR,#ret
B3:00B4E8 12ECD8            LCALL    ?L?COM02C5
B3:00B4EB 91C0              ACALL    ?L?COM0027
B3:00B4ED E4                CLR      A
B3:00B4EE 9031D1            MOV      DPTR,#scb+02BH
B3:00B4F1 F0                MOVX     @DPTR,A
B3:00B4F2 9031CB            MOV      DPTR,#scb+025H
B3:00B4F5 F0                MOVX     @DPTR,A
B3:00B4F6 903220            MOV      DPTR,#scb+07AH
B3:00B4F9 F1EB              ACALL    ?L?COM02C3
B3:00B4FB 6006              JZ       ?C0038?TRANSPORT_SERVICE2
B3:00B4FD A3                INC      DPTR
B3:00B4FE E0                MOVX     A,@DPTR
B3:00B4FF 2407              ADD      A,#07H
B3:00B501 8004              SJMP     ?C0207?TRANSPORT_SERVICE2
B3:00B503         ?C0038?TRANSPORT_SERVICE2:
B3:00B503 A3                INC      DPTR
B3:00B504 E0                MOVX     A,@DPTR
B3:00B505 2406              ADD      A,#06H
B3:00B507         
B3:00B507 D13A              ACALL    ?L?COM01BC
B3:00B509 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_temp_callback_last_frag
B3:00B50B F0                MOVX     @DPTR,A
B3:00B50C A3                INC      DPTR
B3:00B50D 74A9              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_temp_callback_last_frag
B3:00B50F D15F              ACALL    ?L?COM0100
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 806


B3:00B511 9046BC            MOV      DPTR,#ret
B3:00B514 F0                MOVX     @DPTR,A
B3:00B515         ?C0039?TRANSPORT_SERVICE2:
B3:00B515 9046BC            MOV      DPTR,#ret
B3:00B518 E0                MOVX     A,@DPTR
B3:00B519 7012              JNZ      ?C0040?TRANSPORT_SERVICE2
B3:00B51B 9031B5            MOV      DPTR,#scb+0FH
B3:00B51E 12C0B2            LCALL    ?L?COM00C2
B3:00B521 6006              JZ       ?C0041?TRANSPORT_SERVICE2
B3:00B523 12C26A            LCALL    ?L?COM0267
B3:00B526 1226E3            LCALL    ?C?ICALL2
B3:00B529         ?C0041?TRANSPORT_SERVICE2:
B3:00B529 7F21              MOV      R7,#021H
B3:00B52B 8021              SJMP     ?C0209?TRANSPORT_SERVICE2
B3:00B52D         ?C0040?TRANSPORT_SERVICE2:
B3:00B52D 9031B2            MOV      DPTR,#scb+0CH
B3:00B530 E0                MOVX     A,@DPTR
B3:00B531 6404              XRL      A,#04H
B3:00B533 6007              JZ       ?C0044?TRANSPORT_SERVICE2
B3:00B535 9031AF            MOV      DPTR,#scb+09H
B3:00B538 E0                MOVX     A,@DPTR
B3:00B539 B4FF04            CJNE     A,#0FFH,?C0043?TRANSPORT_SERVICE2
B3:00B53C         ?C0044?TRANSPORT_SERVICE2:
B3:00B53C 7F0A              MOV      R7,#0AH
B3:00B53E         
B3:00B53E 800E              SJMP     ?C0209?TRANSPORT_SERVICE2
B3:00B540         ?C0043?TRANSPORT_SERVICE2:
B3:00B540 F1D8              ACALL    ?L?COM049C
B3:00B542 7126              ACALL    ?L?COM004A
B3:00B544 F1CE              ACALL    ?L?COM0479
B3:00B546 7FE8              MOV      R7,#0E8H
B3:00B548 7E03              MOV      R6,#03H
B3:00B54A 91DD              ACALL    ?L?COM0028
B3:00B54C 7F05              MOV      R7,#05H
B3:00B54E         
B3:00B54E 029C55            LJMP     _t2_sm_post_event
----- FUNCTION send_last_frag (END) -------


----- FUNCTION _reply_frag_req (BEGIN) -----
B3:00B551 12DFAD            LCALL    ?L?COM01AE
B3:00B554 E0                MOVX     A,@DPTR
B3:00B555 6401              XRL      A,#01H
B3:00B557 7002              JNZ      $ + 4H
B3:00B559 C135              AJMP     ?C0080?TRANSPORT_SERVICE2
B3:00B55B         ?C0079?TRANSPORT_SERVICE2:
B3:00B55B 903079            MOV      DPTR,#FragmentMaxPayload
B3:00B55E E0                MOVX     A,@DPTR
B3:00B55F 9031A6            MOV      DPTR,#scb
B3:00B562 126E29            LCALL    ?L?COM01DA
B3:00B565 90306A            MOV      DPTR,#subseq_frag
B3:00B568 122552            LCALL    ?C?PLDXDATA
B3:00B56B 7455              MOV      A,#055H
B3:00B56D 12203B            LCALL    ?C?CSTPTR
B3:00B570 F1C5              ACALL    ?L?COM04F9
B3:00B572 A3                INC      DPTR
B3:00B573 E0                MOVX     A,@DPTR
B3:00B574 FC                MOV      R4,A
B3:00B575 A3                INC      DPTR
B3:00B576 E0                MOVX     A,@DPTR
B3:00B577 FD                MOV      R5,A
B3:00B578 2F                ADD      A,R7
B3:00B579 FF                MOV      R7,A
B3:00B57A EC                MOV      A,R4
B3:00B57B 3E                ADDC     A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 807


B3:00B57C FE                MOV      R6,A
B3:00B57D 9031CF            MOV      DPTR,#scb+029H
B3:00B580 E0                MOVX     A,@DPTR
B3:00B581 FA                MOV      R2,A
B3:00B582 A3                INC      DPTR
B3:00B583 E0                MOVX     A,@DPTR
B3:00B584 FB                MOV      R3,A
B3:00B585 C3                CLR      C
B3:00B586 9F                SUBB     A,R7
B3:00B587 EA                MOV      A,R2
B3:00B588 9E                SUBB     A,R6
B3:00B589 500D              JNC      ?C0081?TRANSPORT_SERVICE2
B3:00B58B C3                CLR      C
B3:00B58C EB                MOV      A,R3
B3:00B58D 9D                SUBB     A,R5
B3:00B58E FE                MOV      R6,A
B3:00B58F EA                MOV      A,R2
B3:00B590 9C                SUBB     A,R4
B3:00B591 9031A6            MOV      DPTR,#scb
B3:00B594 F0                MOVX     @DPTR,A
B3:00B595 A3                INC      DPTR
B3:00B596 CE                XCH      A,R6
B3:00B597 F0                MOVX     @DPTR,A
B3:00B598         ?C0081?TRANSPORT_SERVICE2:
B3:00B598 12DFA3            LCALL    ?L?COM0164
B3:00B59B 12EF1D            LCALL    ?L?COM04E7
B3:00B59E 126DFA            LCALL    ?L?COM0160
B3:00B5A1 ED                MOV      A,R5
B3:00B5A2 F1B8              ACALL    ?L?COM036B
B3:00B5A4 9031A8            MOV      DPTR,#scb+02H
B3:00B5A7 12DFA6            LCALL    ?L?COM0165
B3:00B5AA 12EDC4            LCALL    ?L?COM01A8
B3:00B5AD E9                MOV      A,R1
B3:00B5AE 2405              ADD      A,#05H
B3:00B5B0 F9                MOV      R1,A
B3:00B5B1 E4                CLR      A
B3:00B5B2 3A                ADDC     A,R2
B3:00B5B3 FA                MOV      R2,A
B3:00B5B4 C003              PUSH     AR3
B3:00B5B6 C002              PUSH     AR2
B3:00B5B8 C001              PUSH     AR1
B3:00B5BA 12DFBD            LCALL    ?L?COM049D
B3:00B5BD 9031A8            MOV      DPTR,#scb+02H
B3:00B5C0 126E37            LCALL    ?L?COM01E7
B3:00B5C3 128548            LCALL    ?L?COM0018
B3:00B5C6 D001              POP      AR1
B3:00B5C8 D002              POP      AR2
B3:00B5CA D003              POP      AR3
B3:00B5CC 12EE4F            LCALL    ?L?COM0276
B3:00B5CF 2405              ADD      A,#05H
B3:00B5D1 FD                MOV      R5,A
B3:00B5D2 12EBA7            LCALL    _add_crc
B3:00B5D5 F1C5              ACALL    ?L?COM04F9
B3:00B5D7 9031A9            MOV      DPTR,#scb+03H
B3:00B5DA E0                MOVX     A,@DPTR
B3:00B5DB 2F                ADD      A,R7
B3:00B5DC FF                MOV      R7,A
B3:00B5DD 9031A8            MOV      DPTR,#scb+02H
B3:00B5E0 E0                MOVX     A,@DPTR
B3:00B5E1 3E                ADDC     A,R6
B3:00B5E2 FE                MOV      R6,A
B3:00B5E3 9031CF            MOV      DPTR,#scb+029H
B3:00B5E6 E0                MOVX     A,@DPTR
B3:00B5E7 B50618            CJNE     A,AR6,?C0082?TRANSPORT_SERVICE2
B3:00B5EA A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 808


B3:00B5EB E0                MOVX     A,@DPTR
B3:00B5EC B50713            CJNE     A,AR7,?C0082?TRANSPORT_SERVICE2
B3:00B5EF 903220            MOV      DPTR,#scb+07AH
B3:00B5F2 7401              MOV      A,#01H
B3:00B5F4 F0                MOVX     @DPTR,A
B3:00B5F5 7F1D              MOV      R7,#01DH
B3:00B5F7 129C55            LCALL    _t2_sm_post_event
B3:00B5FA 9031D2            MOV      DPTR,#scb+02CH
B3:00B5FD 7401              MOV      A,#01H
B3:00B5FF F0                MOVX     @DPTR,A
B3:00B600 81E4              AJMP     send_last_frag
B3:00B602         ?C0082?TRANSPORT_SERVICE2:
B3:00B602 91C0              ACALL    ?L?COM0027
B3:00B604 9031D1            MOV      DPTR,#scb+02BH
B3:00B607 F1EB              ACALL    ?L?COM02C3
B3:00B609 600A              JZ       ?C0083?TRANSPORT_SERVICE2
B3:00B60B D136              ACALL    ?L?COM01BB
B3:00B60D 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00B60F F0                MOVX     @DPTR,A
B3:00B610 A3                INC      DPTR
B3:00B611 74AE              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00B613 8008              SJMP     ?C0211?TRANSPORT_SERVICE2
B3:00B615         ?C0083?TRANSPORT_SERVICE2:
B3:00B615 D136              ACALL    ?L?COM01BB
B3:00B617 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_temp_callback_reply_frag_req
B3:00B619 F0                MOVX     @DPTR,A
B3:00B61A A3                INC      DPTR
B3:00B61B 74BD              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_temp_callback_reply_frag_req
B3:00B61D         
B3:00B61D D15F              ACALL    ?L?COM0100
B3:00B61F 9046BF            MOV      DPTR,#ret
B3:00B622 F0                MOVX     @DPTR,A
B3:00B623         ?C0084?TRANSPORT_SERVICE2:
B3:00B623         ?C0085?TRANSPORT_SERVICE2:
B3:00B623 9031D2            MOV      DPTR,#scb+02CH
B3:00B626 7401              MOV      A,#01H
B3:00B628 F0                MOVX     @DPTR,A
B3:00B629 F1D8              ACALL    ?L?COM049C
B3:00B62B 7126              ACALL    ?L?COM004A
B3:00B62D F1CE              ACALL    ?L?COM0479
B3:00B62F 7FDC              MOV      R7,#0DCH
B3:00B631 7E05              MOV      R6,#05H
B3:00B633 91DD              ACALL    ?L?COM0028
B3:00B635         ?C0080?TRANSPORT_SERVICE2:
B3:00B635 22                RET      
----- FUNCTION _reply_frag_req (END) -------


----- FUNCTION ?L?COM01BB (BEGIN) -----
B3:00B636 A3                INC      DPTR
B3:00B637 E0                MOVX     A,@DPTR
B3:00B638 2407              ADD      A,#07H
B3:00B63A         ?L?COM01BC:
B3:00B63A 9043CE            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
B3:00B63D F0                MOVX     @DPTR,A
B3:00B63E 9031B2            MOV      DPTR,#scb+0CH
B3:00B641         ?L?COM01BD:
B3:00B641 E0                MOVX     A,@DPTR
B3:00B642 4401              ORL      A,#01H
B3:00B644 9043CF            MOV      DPTR,#?_TS_SendRaw?BYTE+05H
B3:00B647 F0                MOVX     @DPTR,A
B3:00B648 A3                INC      DPTR
B3:00B649 22                RET      
----- FUNCTION ?L?COM01BB (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 809



----- FUNCTION ?L?COM00FF (BEGIN) -----
B3:00B64A 9043CE            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
B3:00B64D F0                MOVX     @DPTR,A
B3:00B64E 9031B2            MOV      DPTR,#scb+0CH
B3:00B651 E0                MOVX     A,@DPTR
B3:00B652 4401              ORL      A,#01H
B3:00B654 9043CF            MOV      DPTR,#?_TS_SendRaw?BYTE+05H
B3:00B657 F0                MOVX     @DPTR,A
B3:00B658 A3                INC      DPTR
B3:00B659 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00B65B F0                MOVX     @DPTR,A
B3:00B65C A3                INC      DPTR
B3:00B65D 74AE              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00B65F         ?L?COM0100:
B3:00B65F F0                MOVX     @DPTR,A
B3:00B660 9031AF            MOV      DPTR,#scb+09H
B3:00B663         ?L?COM0101:
B3:00B663 E0                MOVX     A,@DPTR
B3:00B664 FF                MOV      R7,A
B3:00B665 D1C0              ACALL    _TS_SendRaw
B3:00B667 E4                CLR      A
B3:00B668 33                RLC      A
B3:00B669 22                RET      
----- FUNCTION ?L?COM00FF (END) -------


----- FUNCTION send_frag_wait_cmd (BEGIN) -----
B3:00B66A E4                CLR      A
B3:00B66B 9045B6            MOV      DPTR,#ret
B3:00B66E F0                MOVX     @DPTR,A
B3:00B66F A3                INC      DPTR
B3:00B670 7455              MOV      A,#055H
B3:00B672 F0                MOVX     @DPTR,A
B3:00B673 A3                INC      DPTR
B3:00B674 74F0              MOV      A,#0F0H
B3:00B676 91BF              ACALL    ?L?COM0026
B3:00B678 9031D1            MOV      DPTR,#scb+02BH
B3:00B67B E0                MOVX     A,@DPTR
B3:00B67C 601B              JZ       ?C0178?TRANSPORT_SERVICE2
B3:00B67E 9031CB            MOV      DPTR,#scb+025H
B3:00B681 F17C              ACALL    ?L?COM02FB
B3:00B683 D141              ACALL    ?L?COM01BD
B3:00B685 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00B687 F0                MOVX     @DPTR,A
B3:00B688 A3                INC      DPTR
B3:00B689 74AE              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_ts_senddata_cb
B3:00B68B F0                MOVX     @DPTR,A
B3:00B68C 903215            MOV      DPTR,#scb+06FH
B3:00B68F D163              ACALL    ?L?COM0101
B3:00B691 9045B6            MOV      DPTR,#ret
B3:00B694 F0                MOVX     @DPTR,A
B3:00B695 7F06              MOV      R7,#06H
B3:00B697 8021              SJMP     ?C0234?TRANSPORT_SERVICE2
B3:00B699         ?C0178?TRANSPORT_SERVICE2:
B3:00B699 903096            MOV      DPTR,#rcb+01CH
B3:00B69C E0                MOVX     A,@DPTR
B3:00B69D B41005            CJNE     A,#010H,?C0180?TRANSPORT_SERVICE2
B3:00B6A0 E4                CLR      A
B3:00B6A1 A3                INC      DPTR
B3:00B6A2 F0                MOVX     @DPTR,A
B3:00B6A3 8003              SJMP     ?C0181?TRANSPORT_SERVICE2
B3:00B6A5         ?C0180?TRANSPORT_SERVICE2:
B3:00B6A5 12DD1F            LCALL    calculate_pending_segments
B3:00B6A8         ?C0181?TRANSPORT_SERVICE2:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 810


B3:00B6A8 903097            MOV      DPTR,#rcb+01DH
B3:00B6AB F17C              ACALL    ?L?COM02FB
B3:00B6AD 7171              ACALL    ?L?COM0113
B3:00B6AF 903215            MOV      DPTR,#scb+06FH
B3:00B6B2 D163              ACALL    ?L?COM0101
B3:00B6B4 9045B6            MOV      DPTR,#ret
B3:00B6B7 F0                MOVX     @DPTR,A
B3:00B6B8 7F05              MOV      R7,#05H
B3:00B6BA         
B3:00B6BA 129C55            LCALL    _t2_sm_post_event
B3:00B6BD         ?C0179?TRANSPORT_SERVICE2:
B3:00B6BD         ?C0182?TRANSPORT_SERVICE2:
B3:00B6BD 7F00              MOV      R7,#00H
B3:00B6BF 22                RET      
----- FUNCTION send_frag_wait_cmd (END) -------


----- FUNCTION _TS_SendRaw (BEGIN) -----
B3:00B6C0 9043CA            MOV      DPTR,#dst
B3:00B6C3 126E8B            LCALL    ?L?COM02DB
B3:00B6C6 7B01              MOV      R3,#01H
B3:00B6C8 7A30              MOV      R2,#HIGH ts_txo
B3:00B6CA 796D              MOV      R1,#LOW ts_txo
B3:00B6CC 7D06              MOV      R5,#06H
B3:00B6CE E4                CLR      A
B3:00B6CF FF                MOV      R7,A
B3:00B6D0 12851A            LCALL    ___ZW_memset
B3:00B6D3 9043CA            MOV      DPTR,#dst
B3:00B6D6 E0                MOVX     A,@DPTR
B3:00B6D7 90306D            MOV      DPTR,#ts_txo
B3:00B6DA F0                MOVX     @DPTR,A
B3:00B6DB 9043CF            MOV      DPTR,#txopt
B3:00B6DE E0                MOVX     A,@DPTR
B3:00B6DF 90306F            MOV      DPTR,#ts_txo+02H
B3:00B6E2 F0                MOVX     @DPTR,A
B3:00B6E3 9043CE            MOV      DPTR,#buflen
B3:00B6E6 E0                MOVX     A,@DPTR
B3:00B6E7 FD                MOV      R5,A
B3:00B6E8 7B01              MOV      R3,#01H
B3:00B6EA 7A30              MOV      R2,#HIGH ts_txo
B3:00B6EC 796D              MOV      R1,#LOW ts_txo
B3:00B6EE 1281DC            LCALL    ?L?COM00AE
B3:00B6F1 9043D0            MOV      DPTR,#cb
B3:00B6F4 E0                MOVX     A,@DPTR
B3:00B6F5 FF                MOV      R7,A
B3:00B6F6 A3                INC      DPTR
B3:00B6F7 E0                MOVX     A,@DPTR
B3:00B6F8 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00B6FB CF                XCH      A,R7
B3:00B6FC F0                MOVX     @DPTR,A
B3:00B6FD A3                INC      DPTR
B3:00B6FE EF                MOV      A,R7
B3:00B6FF F0                MOVX     @DPTR,A
B3:00B700 9043CB            MOV      DPTR,#buf
B3:00B703 122552            LCALL    ?C?PLDXDATA
B3:00B706 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00B709 EF                MOV      A,R7
B3:00B70A 24FF              ADD      A,#0FFH
B3:00B70C 22                RET      
----- FUNCTION _TS_SendRaw (END) -------


----- FUNCTION send_frag_complete_cmd (BEGIN) -----
B3:00B70D E4                CLR      A
B3:00B70E 9045BA            MOV      DPTR,#ret
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 811


B3:00B711 F0                MOVX     @DPTR,A
B3:00B712 903096            MOV      DPTR,#rcb+01CH
B3:00B715 E0                MOVX     A,@DPTR
B3:00B716 FE                MOV      R6,A
B3:00B717 D3                SETB     C
B3:00B718 940F              SUBB     A,#0FH
B3:00B71A 4003              JC       ?C0184?TRANSPORT_SERVICE2
B3:00B71C 7F00              MOV      R7,#00H
B3:00B71E 22                RET      
B3:00B71F         ?C0184?TRANSPORT_SERVICE2:
B3:00B71F 9045BB            MOV      DPTR,#frag_compl
B3:00B722 7455              MOV      A,#055H
B3:00B724 F0                MOVX     @DPTR,A
B3:00B725 A3                INC      DPTR
B3:00B726 74E8              MOV      A,#0E8H
B3:00B728 F0                MOVX     @DPTR,A
B3:00B729 EE                MOV      A,R6
B3:00B72A C4                SWAP     A
B3:00B72B 54F0              ANL      A,#0F0H
B3:00B72D A3                INC      DPTR
B3:00B72E 91BF              ACALL    ?L?COM0026
B3:00B730 7A45              MOV      R2,#HIGH frag_compl
B3:00B732 79BB              MOV      R1,#LOW frag_compl
B3:00B734 7403              MOV      A,#03H
B3:00B736 7168              ACALL    ?L?COM0112
B3:00B738 90307A            MOV      DPTR,#rcb
B3:00B73B D163              ACALL    ?L?COM0101
B3:00B73D 9045BA            MOV      DPTR,#ret
B3:00B740 F0                MOVX     @DPTR,A
B3:00B741         ?C0186?TRANSPORT_SERVICE2:
B3:00B741 903096            MOV      DPTR,#rcb+01CH
B3:00B744 12ECEC            LCALL    ?L?COM0332
B3:00B747 7401              MOV      A,#01H
B3:00B749 F0                MOVX     @DPTR,A
B3:00B74A 12EAE1            LCALL    ?L?COM039D
B3:00B74D E4                CLR      A
B3:00B74E 903198            MOV      DPTR,#rcb+011EH
B3:00B751 F0                MOVX     @DPTR,A
B3:00B752 12EACA            LCALL    ?L?COM04DB
B3:00B755 FF                MOV      R7,A
B3:00B756 12851A            LCALL    ___ZW_memset
B3:00B759 E4                CLR      A
B3:00B75A 9031A3            MOV      DPTR,#rcb+0129H
B3:00B75D 12EC13            LCALL    ?L?COM0440
B3:00B760 7F05              MOV      R7,#05H
B3:00B762 129C55            LCALL    _t2_sm_post_event
B3:00B765 12EABB            LCALL    ?L?COM03B1
B3:00B768 9031A4            MOV      DPTR,#rcb+012AH
B3:00B76B A3                INC      DPTR
B3:00B76C E0                MOVX     A,@DPTR
B3:00B76D FD                MOV      R5,A
B3:00B76E 90307A            MOV      DPTR,#rcb
B3:00B771 E0                MOVX     A,@DPTR
B3:00B772 90450E            MOV      DPTR,#?_TransportService_msg_received_event?BYTE+04H
B3:00B775 F0                MOVX     @DPTR,A
B3:00B776 121A2A            LCALL    ?INTERBANK_TABLE?_TransportService_msg_received_event
B3:00B779 7F00              MOV      R7,#00H
B3:00B77B 22                RET      
----- FUNCTION send_frag_complete_cmd (END) -------


----- FUNCTION ?L?COM02FB (BEGIN) -----
B3:00B77C E0                MOVX     A,@DPTR
B3:00B77D 9045B9            MOV      DPTR,#frag_wait+02H
B3:00B780 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 812


B3:00B781 7B01              MOV      R3,#01H
B3:00B783 7A45              MOV      R2,#HIGH frag_wait
B3:00B785 79B7              MOV      R1,#LOW frag_wait
B3:00B787 9043CE            MOV      DPTR,#?_TS_SendRaw?BYTE+04H
B3:00B78A 7403              MOV      A,#03H
B3:00B78C F0                MOVX     @DPTR,A
B3:00B78D 903219            MOV      DPTR,#scb+073H
B3:00B790 22                RET      
----- FUNCTION ?L?COM02FB (END) -------


----- FUNCTION find_missing (BEGIN) -----
B3:00B791 12DCE5            LCALL    get_num_missing_frag
;---- Variable 'missing_frag' assigned to Register 'R7' ----
B3:00B794 EF                MOV      A,R7
B3:00B795 6011              JZ       ?C0126?TRANSPORT_SERVICE2
B3:00B797 90307F            MOV      DPTR,#rcb+05H
B3:00B79A E0                MOVX     A,@DPTR
B3:00B79B B40403            CJNE     A,#04H,?C0127?TRANSPORT_SERVICE2
B3:00B79E 02EA80            LJMP     discard_all_received_fragments
B3:00B7A1         ?C0127?TRANSPORT_SERVICE2:
B3:00B7A1 7F09              MOV      R7,#09H
B3:00B7A3 129C55            LCALL    _t2_sm_post_event
B3:00B7A6 8122              AJMP     send_frag_req_cmd
B3:00B7A8         ?C0126?TRANSPORT_SERVICE2:
B3:00B7A8 90307F            MOV      DPTR,#rcb+05H
B3:00B7AB E0                MOVX     A,@DPTR
B3:00B7AC 6404              XRL      A,#04H
B3:00B7AE 6007              JZ       ?C0128?TRANSPORT_SERVICE2
B3:00B7B0         ?C0130?TRANSPORT_SERVICE2:
B3:00B7B0 7F03              MOV      R7,#03H
B3:00B7B2 129C55            LCALL    _t2_sm_post_event
B3:00B7B5 F10D              ACALL    send_frag_complete_cmd
B3:00B7B7         ?C0128?TRANSPORT_SERVICE2:
B3:00B7B7 22                RET      
----- FUNCTION find_missing (END) -------


----- FUNCTION ?L?COM036B (BEGIN) -----
B3:00B7B8 900002            MOV      DPTR,#02H
B3:00B7BB 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM036B (END) -------


----- FUNCTION s2_inclusion_neighbor_discovery_complete (BEGIN) -----
B3:00B7BE 7F0E              MOV      R7,#0EH
B3:00B7C0 7E02              MOV      R6,#02H
B3:00B7C2 028BE8            LJMP     _process_event
----- FUNCTION s2_inclusion_neighbor_discovery_complete (END) -------


----- FUNCTION ?L?COM04F9 (BEGIN) -----
B3:00B7C5 9031A6            MOV      DPTR,#scb
B3:00B7C8 E0                MOVX     A,@DPTR
B3:00B7C9 FE                MOV      R6,A
B3:00B7CA A3                INC      DPTR
B3:00B7CB E0                MOVX     A,@DPTR
B3:00B7CC FF                MOV      R7,A
B3:00B7CD 22                RET      
----- FUNCTION ?L?COM04F9 (END) -------


----- FUNCTION ?L?COM0479 (BEGIN) -----
B3:00B7CE A3                INC      DPTR
B3:00B7CF 122572            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 813


B3:00B7D2 0B                INC      R3
B3:00B7D3 7A30              MOV      R2,#HIGH rcb+023H
B3:00B7D5 799D              MOV      R1,#LOW rcb+023H
B3:00B7D7 22                RET      
----- FUNCTION ?L?COM0479 (END) -------


----- FUNCTION ?L?COM049C (BEGIN) -----
B3:00B7D8 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00B7DB 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_fc_timer_expired
B3:00B7DD F0                MOVX     @DPTR,A
B3:00B7DE A3                INC      DPTR
B3:00B7DF 74A4              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_fc_timer_expired
B3:00B7E1 22                RET      
----- FUNCTION ?L?COM049C (END) -------


----- FUNCTION _clearOutEvents (BEGIN) -----
B3:00B7E2 22                RET      
----- FUNCTION _clearOutEvents (END) -------


----- FUNCTION _secure_learnIface_raise_assignIdDone (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B7E3 900019            MOV      DPTR,#019H
B3:00B7E6 7401              MOV      A,#01H
B3:00B7E8 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_assignIdDone (END) -------


----- FUNCTION ?L?COM02C3 (BEGIN) -----
B3:00B7EB E0                MOVX     A,@DPTR
B3:00B7EC         ?L?COM02C4:
B3:00B7EC 7B01              MOV      R3,#01H
B3:00B7EE 7A30              MOV      R2,#HIGH t2_txBuf
B3:00B7F0 7934              MOV      R1,#LOW t2_txBuf
B3:00B7F2 9031A6            MOV      DPTR,#scb
B3:00B7F5 22                RET      
----- FUNCTION ?L?COM02C3 (END) -------


----- FUNCTION _ZW_SendConst (BEGIN) -----
B3:00B7F6 904687            MOV      DPTR,#bChNo
B3:00B7F9 ED                MOV      A,R5
B3:00B7FA F0                MOVX     @DPTR,A
B3:00B7FB A3                INC      DPTR
B3:00B7FC EB                MOV      A,R3
B3:00B7FD F0                MOVX     @DPTR,A
;---- Variable 'bStart' assigned to Register 'R7' ----
B3:00B7FE EF                MOV      A,R7
B3:00B7FF 607B              JZ       ?C0005?ZW_TRANSPORT_SUPPORT
B3:00B801 A2EB              MOV      C,ERF
B3:00B803 921E              MOV      erf_store,C
B3:00B805 C2EB              CLR      ERF
B3:00B807 D21F              SETB     rfProdTestOn
B3:00B809 904687            MOV      DPTR,#bChNo
B3:00B80C E0                MOVX     A,@DPTR
B3:00B80D 90183A            MOV      DPTR,#rf_table+0CH
B3:00B810 93                MOVC     A,@A+DPTR
B3:00B811 5406              ANL      A,#06H
B3:00B813 90093A            MOV      DPTR,#rfTxCurrentSpeed
B3:00B816 F0                MOVX     @DPTR,A
B3:00B817 904688            MOV      DPTR,#bSignalType
B3:00B81A E0                MOVX     A,@DPTR
B3:00B81B 703C              JNZ      ?C0006?ZW_TRANSPORT_SUPPORT
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 814


B3:00B81D C21D              CLR      rfProdTestDataMod
B3:00B81F 11A0              ACALL    ?L?COM04B0
B3:00B821 75FF01            MOV      SFRPAGE,#01H
B3:00B824 904689            MOV      DPTR,#temp_store_rfhssep
B3:00B827 E5DE              MOV      A,RFHSSEP
B3:00B829 F0                MOVX     @DPTR,A
B3:00B82A 75FF01            MOV      SFRPAGE,#01H
B3:00B82D A3                INC      DPTR
B3:00B82E E5DF              MOV      A,RFLSSEP
B3:00B830 F0                MOVX     @DPTR,A
B3:00B831 75FF01            MOV      SFRPAGE,#01H
B3:00B834 E4                CLR      A
B3:00B835 F5DE              MOV      RFHSSEP,A
B3:00B837 75FF01            MOV      SFRPAGE,#01H
B3:00B83A F5DF              MOV      RFLSSEP,A
B3:00B83C F5FF              MOV      SFRPAGE,A
B3:00B83E 75CE11            MOV      DPLLGSCON,#011H
B3:00B841 F5FF              MOV      SFRPAGE,A
B3:00B843 F5CF              MOV      DPLLGSVLO,A
B3:00B845 F5FF              MOV      SFRPAGE,A
B3:00B847 75CE21            MOV      DPLLGSCON,#021H
B3:00B84A F5FF              MOV      SFRPAGE,A
B3:00B84C F5CF              MOV      DPLLGSVLO,A
B3:00B84E F5FF              MOV      SFRPAGE,A
B3:00B850 75CE31            MOV      DPLLGSCON,#031H
B3:00B853 F5FF              MOV      SFRPAGE,A
B3:00B855 F5CF              MOV      DPLLGSVLO,A
B3:00B857 800B              SJMP     ?C0009?ZW_TRANSPORT_SUPPORT
B3:00B859         ?C0006?ZW_TRANSPORT_SUPPORT:
B3:00B859 904688            MOV      DPTR,#bSignalType
B3:00B85C E0                MOVX     A,@DPTR
B3:00B85D B40104            CJNE     A,#01H,?C0009?ZW_TRANSPORT_SUPPORT
B3:00B860 D21D              SETB     rfProdTestDataMod
B3:00B862 11A0              ACALL    ?L?COM04B0
B3:00B864         ?C0009?ZW_TRANSPORT_SUPPORT:
B3:00B864 904687            MOV      DPTR,#bChNo
B3:00B867 E0                MOVX     A,@DPTR
B3:00B868 FF                MOV      R7,A
B3:00B869 90093A            MOV      DPTR,#rfTxCurrentSpeed
B3:00B86C E0                MOVX     A,@DPTR
B3:00B86D FD                MOV      R5,A
B3:00B86E E4                CLR      A
B3:00B86F 9043EA            MOV      DPTR,#?_RF_switch_to_TX?BYTE+03H
B3:00B872 F0                MOVX     @DPTR,A
B3:00B873 AB1B              MOV      R3,normal_PA_POW
B3:00B875 124EB2            LCALL    _RF_switch_to_TX
B3:00B878 4025              JC       ?C0012?ZW_TRANSPORT_SUPPORT
B3:00B87A 80E8              SJMP     ?C0009?ZW_TRANSPORT_SUPPORT
B3:00B87C         ?C0005?ZW_TRANSPORT_SUPPORT:
B3:00B87C A21E              MOV      C,erf_store
B3:00B87E 92EB              MOV      ERF,C
B3:00B880 C21F              CLR      rfProdTestOn
B3:00B882 C21D              CLR      rfProdTestDataMod
B3:00B884 E4                CLR      A
B3:00B885 F5FF              MOV      SFRPAGE,A
B3:00B887 53B1FD            ANL      DPLLCON,#0FDH
B3:00B88A 1256F5            LCALL    RF_shutdown
B3:00B88D 75FF01            MOV      SFRPAGE,#01H
B3:00B890 904689            MOV      DPTR,#temp_store_rfhssep
B3:00B893 E0                MOVX     A,@DPTR
B3:00B894 F5DE              MOV      RFHSSEP,A
B3:00B896 75FF01            MOV      SFRPAGE,#01H
B3:00B899 A3                INC      DPTR
B3:00B89A E0                MOVX     A,@DPTR
B3:00B89B F5DF              MOV      RFLSSEP,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 815


B3:00B89D 11A0              ACALL    ?L?COM04B0
B3:00B89F         ?C0012?ZW_TRANSPORT_SUPPORT:
B3:00B89F 22                RET      
----- FUNCTION _ZW_SendConst (END) -------


----- FUNCTION ?L?COM04B0 (BEGIN) -----
B3:00B8A0 121A3E            LCALL    ?INTERBANK_TABLE?RFDriverInitHW
B3:00B8A3 021A48            LJMP     ?INTERBANK_TABLE?RFDriverInitSW
----- FUNCTION ?L?COM04B0 (END) -------


----- FUNCTION s2_inclusion_set_txqueue_empty_event (BEGIN) -----
B3:00B8A6 7B01              MOV      R3,#01H
B3:00B8A8 7A3F              MOV      R2,#HIGH sTxQueueEmptyEvent_elem
B3:00B8AA 7936              MOV      R1,#LOW sTxQueueEmptyEvent_elem
B3:00B8AC 7C1C              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_s2_inclusion_txqueue_empty
B3:00B8AE 7DDC              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_s2_inclusion_txqueue_empty
B3:00B8B0 021A61            LJMP     ?INTERBANK_TABLE?_TxQueueEmptyEvent_Add
----- FUNCTION s2_inclusion_set_txqueue_empty_event (END) -------


----- FUNCTION _secure_learnIface_get_net_scheme (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00B8B3 900014            MOV      DPTR,#014H
B3:00B8B6 0223F4            LJMP     ?C?LLDOPTR
----- FUNCTION _secure_learnIface_get_net_scheme (END) -------


----- FUNCTION _ZW_GetSecurityS2PublicDSK (BEGIN) -----
;---- Variable 'buf' assigned to Register 'R1/R2/R3' ----
B3:00B8B9 021AED            LJMP     ?INTERBANK_TABLE?_keystore_public_dsk_read
----- FUNCTION _ZW_GetSecurityS2PublicDSK (END) -------


----- FUNCTION s2_send_pub_key_b (BEGIN) -----
B3:00B8BC 9028DB            MOV      DPTR,#the_context+0D7H
B3:00B8BF 12A624            LCALL    ?L?COM005D
B3:00B8C2 3182              ACALL    ?L?COM037F
B3:00B8C4 700E              JNZ      ?C0096?S2_INCLUSION
B3:00B8C6 902DFE            MOV      DPTR,#m_schemes
B3:00B8C9 3179              ACALL    ?L?COM04FD
B3:00B8CB 6007              JZ       ?C0096?S2_INCLUSION
B3:00B8CD 9028C6            MOV      DPTR,#the_context+0C2H
B3:00B8D0 EE                MOV      A,R6
B3:00B8D1 F0                MOVX     @DPTR,A
B3:00B8D2 8008              SJMP     ?C0097?S2_INCLUSION
B3:00B8D4         ?C0096?S2_INCLUSION:
B3:00B8D4 9046BB            MOV      DPTR,#support
B3:00B8D7 7402              MOV      A,#02H
B3:00B8D9 F0                MOVX     @DPTR,A
B3:00B8DA 216F              AJMP     error_handling?S2_INCLUSION
B3:00B8DC         ?C0097?S2_INCLUSION:
B3:00B8DC 9028DB            MOV      DPTR,#the_context+0D7H
B3:00B8DF 122552            LCALL    ?C?PLDXDATA
B3:00B8E2 519D              ACALL    ?L?COM049B
B3:00B8E4 3182              ACALL    ?L?COM037F
B3:00B8E6 700E              JNZ      ?C0099?S2_INCLUSION
B3:00B8E8 90300E            MOV      DPTR,#m_curves
B3:00B8EB 3179              ACALL    ?L?COM04FD
B3:00B8ED 6007              JZ       ?C0099?S2_INCLUSION
B3:00B8EF 9028C7            MOV      DPTR,#the_context+0C3H
B3:00B8F2 EE                MOV      A,R6
B3:00B8F3 F0                MOVX     @DPTR,A
B3:00B8F4 8008              SJMP     ?C0100?S2_INCLUSION
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 816


B3:00B8F6         ?C0099?S2_INCLUSION:
B3:00B8F6 9046BB            MOV      DPTR,#support
B3:00B8F9 7403              MOV      A,#03H
B3:00B8FB F0                MOVX     @DPTR,A
B3:00B8FC 8071              SJMP     error_handling?S2_INCLUSION
B3:00B8FE         ?C0100?S2_INCLUSION:
B3:00B8FE 12A3EC            LCALL    ?L?COM028E
B3:00B901 FF                MOV      R7,A
B3:00B902 9046BB            MOV      DPTR,#support
B3:00B905 F0                MOVX     @DPTR,A
B3:00B906 902DFD            MOV      DPTR,#m_keys
B3:00B909 E0                MOVX     A,@DPTR
B3:00B90A F4                CPL      A
B3:00B90B 5F                ANL      A,R7
B3:00B90C 7013              JNZ      ?C0143?S2_INCLUSION
B3:00B90E 9046BB            MOV      DPTR,#support
B3:00B911 E0                MOVX     A,@DPTR
B3:00B912 9028C8            MOV      DPTR,#the_context+0C4H
B3:00B915 F0                MOVX     @DPTR,A
B3:00B916         ?C0102?S2_INCLUSION:
B3:00B916 318D              ACALL    ?L?COM00B4
B3:00B918 30E10E            JNB      ACC.1,?C0103?S2_INCLUSION
B3:00B91B 902A14            MOV      DPTR,#the_context+0210H
B3:00B91E E0                MOVX     A,@DPTR
B3:00B91F 600E              JZ       ?C0105?S2_INCLUSION
B3:00B921         
B3:00B921 9046BB            MOV      DPTR,#support
B3:00B924 7401              MOV      A,#01H
B3:00B926 F0                MOVX     @DPTR,A
B3:00B927 8046              SJMP     error_handling?S2_INCLUSION
B3:00B929         ?C0103?S2_INCLUSION:
B3:00B929 902A14            MOV      DPTR,#the_context+0210H
B3:00B92C 7401              MOV      A,#01H
B3:00B92E F0                MOVX     @DPTR,A
B3:00B92F         ?C0105?S2_INCLUSION:
B3:00B92F 12A3EC            LCALL    ?L?COM028E
B3:00B932 9028C8            MOV      DPTR,#the_context+0C4H
B3:00B935 F0                MOVX     @DPTR,A
B3:00B936 A3                INC      DPTR
B3:00B937 7401              MOV      A,#01H
B3:00B939 F0                MOVX     @DPTR,A
B3:00B93A 318D              ACALL    ?L?COM00B4
B3:00B93C 9028C5            MOV      DPTR,#the_context+0C1H
B3:00B93F 5194              ACALL    ?L?COM01E8
B3:00B941 7408              MOV      A,#08H
B3:00B943 F0                MOVX     @DPTR,A
B3:00B944 E4                CLR      A
B3:00B945 A3                INC      DPTR
B3:00B946 F0                MOVX     @DPTR,A
B3:00B947 7B01              MOV      R3,#01H
B3:00B949 7A2A              MOV      R2,#HIGH the_context+02F2H
B3:00B94B 79F6              MOV      R1,#LOW the_context+02F2H
B3:00B94D 121AF2            LCALL    ?INTERBANK_TABLE?_keystore_public_key_read
B3:00B950 902A14            MOV      DPTR,#the_context+0210H
B3:00B953 E0                MOVX     A,@DPTR
B3:00B954 B4010F            CJNE     A,#01H,?C0106?S2_INCLUSION
B3:00B957 9028C8            MOV      DPTR,#the_context+0C4H
B3:00B95A E0                MOVX     A,@DPTR
B3:00B95B 547E              ANL      A,#07EH
B3:00B95D 6007              JZ       ?C0106?S2_INCLUSION
B3:00B95F E4                CLR      A
B3:00B960 902AF6            MOV      DPTR,#the_context+02F2H
B3:00B963 F0                MOVX     @DPTR,A
B3:00B964 A3                INC      DPTR
B3:00B965 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 817


B3:00B966         ?C0106?S2_INCLUSION:
B3:00B966 7423              MOV      A,#023H
B3:00B968 51E3              ACALL    ?L?COM039E
B3:00B96A 31D3              ACALL    ?L?COM022E
B3:00B96C 028AFC            LJMP     _s2_inclusion_set_timeout
B3:00B96F         error_handling:
B3:00B96F 9046BB            MOV      DPTR,#support
B3:00B972 E0                MOVX     A,@DPTR
B3:00B973 FF                MOV      R7,A
B3:00B974 7DFF              MOV      R5,#0FFH
B3:00B976 028BE1            LJMP     ?L?COM0443
----- FUNCTION s2_send_pub_key_b (END) -------


----- FUNCTION ?L?COM04FD (BEGIN) -----
B3:00B979 E0                MOVX     A,@DPTR
B3:00B97A FF                MOV      R7,A
B3:00B97B 9046BB            MOV      DPTR,#support
B3:00B97E E0                MOVX     A,@DPTR
B3:00B97F FE                MOV      R6,A
B3:00B980 5F                ANL      A,R7
B3:00B981 22                RET      
----- FUNCTION ?L?COM04FD (END) -------


----- FUNCTION ?L?COM037F (BEGIN) -----
B3:00B982 9046BB            MOV      DPTR,#support
B3:00B985 F0                MOVX     @DPTR,A
B3:00B986 E0                MOVX     A,@DPTR
B3:00B987 FF                MOV      R7,A
B3:00B988 14                DEC      A
B3:00B989 FE                MOV      R6,A
B3:00B98A EF                MOV      A,R7
B3:00B98B 5E                ANL      A,R6
B3:00B98C 22                RET      
----- FUNCTION ?L?COM037F (END) -------


----- FUNCTION ?L?COM00B4 (BEGIN) -----
B3:00B98D 9028DB            MOV      DPTR,#the_context+0D7H
B3:00B990         ?L?COM00B5:
B3:00B990 122552            LCALL    ?C?PLDXDATA
B3:00B993         ?L?COM00B6:
B3:00B993 900002            MOV      DPTR,#02H
B3:00B996 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM00B4 (END) -------


----- FUNCTION remote_inclusion_failed_evt_push (BEGIN) -----
B3:00B999 318D              ACALL    ?L?COM00B4
B3:00B99B FF                MOV      R7,A
B3:;----                  JMP      _inclusion_failed_evt_push
----- FUNCTION remote_inclusion_failed_evt_push (END) -------


----- FUNCTION _inclusion_failed_evt_push (BEGIN) -----
B3:00B99C 90459A            MOV      DPTR,#fail_type
B3:00B99F EF                MOV      A,R7
B3:00B9A0 F0                MOVX     @DPTR,A
B3:00B9A1 A3                INC      DPTR
B3:00B9A2 7121              ACALL    ?L?COM0214
B3:00B9A4 128A05            LCALL    ?L?COM053F
B3:00B9A7 90459B            MOV      DPTR,#p_s2_event
B3:00B9AA 122552            LCALL    ?C?PLDXDATA
B3:00B9AD 1224F7            LCALL    ?C?LSTKPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 818


B3:00B9B0 00                DB       00H
B3:00B9B1 00                DB       00H
B3:00B9B2 00                DB       00H
B3:00B9B3 05                DB       05H
B3:00B9B4 90459B            MOV      DPTR,#p_s2_event
B3:00B9B7 B12D              ACALL    ?L?COM00C3
B3:00B9B9 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00B9BB 79D3              MOV      R1,#LOW the_context+0CFH
B3:00B9BD B126              ACALL    ?L?COM0173
B3:00B9BF 90459A            MOV      DPTR,#fail_type
B3:00B9C2 E0                MOVX     A,@DPTR
B3:00B9C3 FF                MOV      R7,A
B3:00B9C4 A3                INC      DPTR
B3:00B9C5 D165              ACALL    ?L?COM00BE
B3:00B9C7 0226E3            LJMP     ?C?ICALL2
----- FUNCTION _inclusion_failed_evt_push (END) -------


----- FUNCTION ?L?COM022D (BEGIN) -----
B3:00B9CA F0                MOVX     @DPTR,A
B3:00B9CB 903033            MOV      DPTR,#m_retry_counter
B3:00B9CE 7403              MOV      A,#03H
B3:00B9D0 F0                MOVX     @DPTR,A
B3:00B9D1 512A              ACALL    s2_inclusion_send_data
B3:00B9D3         ?L?COM022E:
B3:00B9D3 7FE8              MOV      R7,#0E8H
B3:00B9D5 7E03              MOV      R6,#03H
B3:00B9D7 7D00              MOV      R5,#00H
B3:00B9D9 7C00              MOV      R4,#00H
B3:00B9DB 22                RET      
----- FUNCTION ?L?COM022D (END) -------


----- FUNCTION s2_send_net_key_get (BEGIN) -----
B3:00B9DC 129C9F            LCALL    ?L?COM0063
B3:00B9DF B40509            CJNE     A,#05H,?C0113?S2_INCLUSION
B3:00B9E2 5159              ACALL    validate_echo_kex_report
B3:00B9E4 EF                MOV      A,R7
B3:00B9E5 6004              JZ       ?C0113?S2_INCLUSION
B3:00B9E7 7F0B              MOV      R7,#0BH
B3:00B9E9 801A              SJMP     ?C0146?S2_INCLUSION
B3:00B9EB         ?C0113?S2_INCLUSION:
B3:00B9EB 129C9F            LCALL    ?L?COM0063
B3:00B9EE B40C0C            CJNE     A,#0CH,?C0115?S2_INCLUSION
B3:00B9F1 3193              ACALL    ?L?COM00B6
B3:00B9F3 5403              ANL      A,#03H
B3:00B9F5 6402              XRL      A,#02H
B3:00B9F7 6004              JZ       ?C0115?S2_INCLUSION
B3:00B9F9 7F0A              MOV      R7,#0AH
B3:00B9FB         
B3:00B9FB 8008              SJMP     ?C0146?S2_INCLUSION
B3:00B9FD         ?C0115?S2_INCLUSION:
B3:00B9FD 9028C8            MOV      DPTR,#the_context+0C4H
B3:00BA00 E0                MOVX     A,@DPTR
B3:00BA01 7007              JNZ      ?C0118?S2_INCLUSION
B3:00BA03 7F0F              MOV      R7,#0FH
B3:00BA05         
B3:00BA05 7E02              MOV      R6,#02H
B3:00BA07 028BE8            LJMP     _process_event
B3:00BA0A         ?C0118?S2_INCLUSION:
B3:00BA0A 7119              ACALL    ?L?COM0558
B3:00BA0C FE                MOV      R6,A
B3:00BA0D 5F                ANL      A,R7
B3:00BA0E 7006              JNZ      ?C0119?S2_INCLUSION
B3:00BA10 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 819


B3:00BA11 25E0              ADD      A,ACC
B3:00BA13 F0                MOVX     @DPTR,A
B3:00BA14 80F4              SJMP     ?C0118?S2_INCLUSION
B3:00BA16         ?C0119?S2_INCLUSION:
B3:00BA16 5195              ACALL    ?L?COM01E9
B3:00BA18 7409              MOV      A,#09H
B3:00BA1A F0                MOVX     @DPTR,A
B3:00BA1B 9028C9            MOV      DPTR,#the_context+0C5H
B3:00BA1E E0                MOVX     A,@DPTR
B3:00BA1F 902AF5            MOV      DPTR,#the_context+02F1H
B3:00BA22 51A3              ACALL    ?L?COM0236
B3:00BA24 04                INC      A
B3:00BA25 31CA              ACALL    ?L?COM022D
B3:00BA27 028AFC            LJMP     _s2_inclusion_set_timeout
----- FUNCTION s2_send_net_key_get (END) -------


----- FUNCTION s2_inclusion_send_data (BEGIN) -----
B3:00BA2A 7B01              MOV      R3,#01H
B3:00BA2C 12C3CD            LCALL    ?L?COM0216
B3:00BA2F EF                MOV      A,R7
B3:00BA30 903033            MOV      DPTR,#m_retry_counter
B3:00BA33 7004              JNZ      ?C0129?S2_INCLUSION
B3:00BA35 74FF              MOV      A,#0FFH
B3:00BA37 F0                MOVX     @DPTR,A
B3:00BA38 22                RET      
B3:00BA39         ?C0129?S2_INCLUSION:
B3:00BA39 E0                MOVX     A,@DPTR
B3:00BA3A 14                DEC      A
B3:00BA3B F0                MOVX     @DPTR,A
B3:00BA3C 22                RET      
----- FUNCTION s2_inclusion_send_data (END) -------


----- FUNCTION _inclusion_failed_frame_send (BEGIN) -----
;---- Variable 'secure' assigned to Register 'R5' ----
;---- Variable 'error' assigned to Register 'R7' ----
B3:00BA3D 5195              ACALL    ?L?COM01E9
B3:00BA3F 7407              MOV      A,#07H
B3:00BA41 F0                MOVX     @DPTR,A
B3:00BA42 A3                INC      DPTR
B3:00BA43 EF                MOV      A,R7
B3:00BA44 F0                MOVX     @DPTR,A
B3:00BA45 902B1B            MOV      DPTR,#the_context+0317H
B3:00BA48 7403              MOV      A,#03H
B3:00BA4A F0                MOVX     @DPTR,A
B3:00BA4B 903033            MOV      DPTR,#m_retry_counter
B3:00BA4E F0                MOVX     @DPTR,A
B3:00BA4F ED                MOV      A,R5
B3:00BA50 7005              JNZ      ?C0036?S2_INCLUSION
B3:00BA52 51AB              ACALL    ?L?COM0238
B3:00BA54 F0                MOVX     @DPTR,A
B3:00BA55 80D3              SJMP     s2_inclusion_send_data
B3:00BA57         ?C0036?S2_INCLUSION:
B3:00BA57 41ED              AJMP     s2_inclusion_send_frame
----- FUNCTION _inclusion_failed_frame_send (END) -------


----- FUNCTION validate_echo_kex_report (BEGIN) -----
B3:00BA59 9028DB            MOV      DPTR,#the_context+0D7H
B3:00BA5C 12A624            LCALL    ?L?COM005D
B3:00BA5F FF                MOV      R7,A
B3:00BA60 902DFE            MOV      DPTR,#m_schemes
B3:00BA63 E0                MOVX     A,@DPTR
B3:00BA64 6F                XRL      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 820


B3:00BA65 7024              JNZ      ?C0039?S2_INCLUSION
B3:00BA67 519D              ACALL    ?L?COM049B
B3:00BA69 FF                MOV      R7,A
B3:00BA6A 90300E            MOV      DPTR,#m_curves
B3:00BA6D E0                MOVX     A,@DPTR
B3:00BA6E 6F                XRL      A,R7
B3:00BA6F 701A              JNZ      ?C0039?S2_INCLUSION
B3:00BA71 12A3F2            LCALL    ?L?COM0290
B3:00BA74 FF                MOV      R7,A
B3:00BA75 902DFD            MOV      DPTR,#m_keys
B3:00BA78 E0                MOVX     A,@DPTR
B3:00BA79 B5070F            CJNE     A,AR7,?C0039?S2_INCLUSION
B3:00BA7C 3193              ACALL    ?L?COM00B6
B3:00BA7E FF                MOV      R7,A
B3:00BA7F 9028C4            MOV      DPTR,#the_context+0C0H
B3:00BA82 E0                MOVX     A,@DPTR
B3:00BA83 4401              ORL      A,#01H
B3:00BA85 B50703            CJNE     A,AR7,?C0039?S2_INCLUSION
B3:00BA88 7F00              MOV      R7,#00H
B3:00BA8A 22                RET      
B3:00BA8B         ?C0039?S2_INCLUSION:
B3:00BA8B E4                CLR      A
B3:00BA8C FD                MOV      R5,A
B3:00BA8D 7F07              MOV      R7,#07H
B3:00BA8F 513D              ACALL    _inclusion_failed_frame_send
B3:00BA91 7F07              MOV      R7,#07H
B3:00BA93 22                RET      
----- FUNCTION validate_echo_kex_report (END) -------


----- FUNCTION ?L?COM01E8 (BEGIN) -----
B3:00BA94 F0                MOVX     @DPTR,A
B3:00BA95         ?L?COM01E9:
B3:00BA95 902AF3            MOV      DPTR,#the_context+02EFH
B3:00BA98 749F              MOV      A,#09FH
B3:00BA9A F0                MOVX     @DPTR,A
B3:00BA9B A3                INC      DPTR
B3:00BA9C 22                RET      
----- FUNCTION ?L?COM01E8 (END) -------


----- FUNCTION ?L?COM049B (BEGIN) -----
B3:00BA9D 900004            MOV      DPTR,#04H
B3:00BAA0 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM049B (END) -------


----- FUNCTION ?L?COM0236 (BEGIN) -----
B3:00BAA3 F0                MOVX     @DPTR,A
B3:00BAA4 902B1B            MOV      DPTR,#the_context+0317H
B3:00BAA7 7403              MOV      A,#03H
B3:00BAA9         ?L?COM0237:
B3:00BAA9 F0                MOVX     @DPTR,A
B3:00BAAA E4                CLR      A
B3:00BAAB         ?L?COM0238:
B3:00BAAB 9028DA            MOV      DPTR,#the_context+0D6H
B3:00BAAE F0                MOVX     @DPTR,A
B3:00BAAF 9028D5            MOV      DPTR,#the_context+0D1H
B3:00BAB2 22                RET      
----- FUNCTION ?L?COM0236 (END) -------


----- FUNCTION s2_send_final_transfer_end (BEGIN) -----
B3:00BAB3 5195              ACALL    ?L?COM01E9
B3:00BAB5 740C              MOV      A,#0CH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 821


B3:00BAB7 F0                MOVX     @DPTR,A
B3:00BAB8 A3                INC      DPTR
B3:00BAB9 7401              MOV      A,#01H
B3:00BABB 51A3              ACALL    ?L?COM0236
B3:00BABD F0                MOVX     @DPTR,A
B3:00BABE 903033            MOV      DPTR,#m_retry_counter
B3:00BAC1 7403              MOV      A,#03H
B3:00BAC3 F0                MOVX     @DPTR,A
B3:00BAC4 412A              AJMP     s2_inclusion_send_data
----- FUNCTION s2_send_final_transfer_end (END) -------


----- FUNCTION _MemoryPutID (BEGIN) -----
B3:00BAC6 90460C            MOV      DPTR,#homeID
B3:00BAC9 122572            LCALL    ?C?PSTXDATA
;---- Variable 'bNodeID' assigned to Register 'R5' ----
B3:00BACC         ?C0009?ZW_MEM:
B3:00BACC         ?C0010?ZW_MEM:
B3:00BACC 7E00              MOV      R6,#HIGH NVM_NODEID_far
B3:00BACE 7F08              MOV      R7,#LOW NVM_NODEID_far
B3:00BAD0 12444A            LCALL    _NVM_ext_write_byte
B3:00BAD3 90460C            MOV      DPTR,#homeID
B3:00BAD6 710B              ACALL    ?L?COM0449
B3:00BAD8 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B3:00BADB 7112              ACALL    ?L?COM04A2
B3:00BADD 1239FB            LCALL    _NVM_ext_write_buffer
B3:00BAE0 7F01              MOV      R7,#01H
B3:00BAE2 22                RET      
----- FUNCTION _MemoryPutID (END) -------


----- FUNCTION ?L?COM039E (BEGIN) -----
B3:00BAE3 902B1B            MOV      DPTR,#the_context+0317H
B3:00BAE6 F0                MOVX     @DPTR,A
B3:00BAE7 903033            MOV      DPTR,#m_retry_counter
B3:00BAEA 7403              MOV      A,#03H
B3:00BAEC F0                MOVX     @DPTR,A
----- FUNCTION s2_inclusion_send_frame (BEGIN) -----
B3:00BAED 90438D            MOV      DPTR,#?___S2_send_frame?BYTE+03H
B3:00BAF0 B13E              ACALL    ?L?COM0350
B3:00BAF2 902B1B            MOV      DPTR,#the_context+0317H
B3:00BAF5 E0                MOVX     A,@DPTR
B3:00BAF6 904390            MOV      DPTR,#?___S2_send_frame?BYTE+06H
B3:00BAF9 126E84            LCALL    ?L?COM02D6
B3:00BAFC 91C6              ACALL    ?L?COM04FB
B3:00BAFE 903033            MOV      DPTR,#m_retry_counter
B3:00BB01 7004              JNZ      ?C0126?S2_INCLUSION
B3:00BB03 74FF              MOV      A,#0FFH
B3:00BB05 F0                MOVX     @DPTR,A
B3:00BB06 22                RET      
B3:00BB07         ?C0126?S2_INCLUSION:
B3:00BB07 E0                MOVX     A,@DPTR
B3:00BB08 14                DEC      A
B3:00BB09 F0                MOVX     @DPTR,A
B3:00BB0A 22                RET      
----- FUNCTION s2_inclusion_send_frame (END) -------


----- FUNCTION ?L?COM0449 (BEGIN) -----
B3:00BB0B 7E00              MOV      R6,#HIGH NVM_HOMEID_far
B3:00BB0D 7F04              MOV      R7,#LOW NVM_HOMEID_far
B3:00BB0F 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0449 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 822


----- FUNCTION ?L?COM04A2 (BEGIN) -----
B3:00BB12 E4                CLR      A
B3:00BB13 F0                MOVX     @DPTR,A
B3:00BB14 A3                INC      DPTR
B3:00BB15 7404              MOV      A,#04H
B3:00BB17 F0                MOVX     @DPTR,A
B3:00BB18 22                RET      
----- FUNCTION ?L?COM04A2 (END) -------


----- FUNCTION ?L?COM0558 (BEGIN) -----
B3:00BB19 9028C8            MOV      DPTR,#the_context+0C4H
B3:00BB1C E0                MOVX     A,@DPTR
B3:00BB1D FF                MOV      R7,A
B3:00BB1E A3                INC      DPTR
B3:00BB1F E0                MOVX     A,@DPTR
B3:00BB20 22                RET      
----- FUNCTION ?L?COM0558 (END) -------


----- FUNCTION ?L?COM0214 (BEGIN) -----
B3:00BB21 7B01              MOV      R3,#01H
B3:00BB23 7A2F              MOV      R2,#HIGH m_event_buffer
B3:00BB25 796C              MOV      R1,#LOW m_event_buffer
B3:00BB27 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0214 (END) -------


----- FUNCTION S2_init_prng (BEGIN) -----
B3:00BB2A 7B01              MOV      R3,#01H
B3:00BB2C 7A3E              MOV      R2,#HIGH entropy
B3:00BB2E 79FD              MOV      R1,#LOW entropy
B3:00BB30 7D20              MOV      R5,#020H
B3:00BB32 F16A              ACALL    _S2_get_hw_random
B3:00BB34 7B01              MOV      R3,#01H
B3:00BB36 7A3E              MOV      R2,#HIGH entropy
B3:00BB38 79FD              MOV      R1,#LOW entropy
B3:00BB3A 9042E0            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+03H
B3:00BB3D 122572            LCALL    ?C?PSTXDATA
B3:00BB40 7A2B              MOV      R2,#HIGH zeros
B3:00BB42 793C              MOV      R1,#LOW zeros
B3:00BB44 9042E3            MOV      DPTR,#?_AES_CTR_DRBG_Instantiate?BYTE+06H
B3:00BB47 122572            LCALL    ?C?PSTXDATA
B3:00BB4A 7A2B              MOV      R2,#HIGH s2_ctr_drbg
B3:00BB4C 795C              MOV      R1,#LOW s2_ctr_drbg
B3:00BB4E 021B3D            LJMP     ?INTERBANK_TABLE?_AES_CTR_DRBG_Instantiate
----- FUNCTION S2_init_prng (END) -------


----- FUNCTION s2_inclusion_post_event (BEGIN) -----
B3:00BB51 129C9F            LCALL    ?L?COM0063
B3:00BB54 FD                MOV      R5,A
B3:00BB55 90459F            MOV      DPTR,#event
B3:00BB58 E4                CLR      A
B3:00BB59 F0                MOVX     @DPTR,A
B3:00BB5A A3                INC      DPTR
B3:00BB5B ED                MOV      A,R5
B3:00BB5C F0                MOVX     @DPTR,A
B3:00BB5D 24FC              ADD      A,#0FCH
B3:00BB5F FF                MOV      R7,A
B3:00BB60 A3                INC      DPTR
B3:00BB61 F0                MOVX     @DPTR,A
B3:00BB62 7409              MOV      A,#09H
B3:00BB64 C3                CLR      C
B3:00BB65 9F                SUBB     A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 823


B3:00BB66 5002              JNC      $ + 4H
B3:00BB68 814D              AJMP     ?C0054?S2_INCLUSION
B3:00BB6A 902A13            MOV      DPTR,#the_context+020FH
B3:00BB6D E0                MOVX     A,@DPTR
B3:00BB6E 7002              JNZ      $ + 4H
B3:00BB70 814D              AJMP     ?C0054?S2_INCLUSION
B3:00BB72         ?C0052?S2_INCLUSION:
B3:00BB72 914E              ACALL    ?L?COM039F
B3:00BB74 240F              ADD      A,#LOW m_frame_rules
B3:00BB76 F582              MOV      DPL,A
B3:00BB78 E4                CLR      A
B3:00BB79 3430              ADDC     A,#HIGH m_frame_rules
B3:00BB7B F583              MOV      DPH,A
B3:00BB7D E0                MOVX     A,@DPTR
B3:00BB7E FF                MOV      R7,A
B3:00BB7F C3                CLR      C
B3:00BB80 9028DF            MOV      DPTR,#the_context+0DBH
B3:00BB83 E0                MOVX     A,@DPTR
B3:00BB84 9F                SUBB     A,R7
B3:00BB85 9028DE            MOV      DPTR,#the_context+0DAH
B3:00BB88 E0                MOVX     A,@DPTR
B3:00BB89 9400              SUBB     A,#00H
B3:00BB8B 5004              JNC      ?C0055?S2_INCLUSION
B3:00BB8D 7F0A              MOV      R7,#0AH
B3:00BB8F 8059              SJMP     ?C0135?S2_INCLUSION
B3:00BB91         ?C0055?S2_INCLUSION:
B3:00BB91 9045A1            MOV      DPTR,#event_rule_index
B3:00BB94 E0                MOVX     A,@DPTR
B3:00BB95 FF                MOV      R7,A
B3:00BB96 25E0              ADD      A,ACC
B3:00BB98 25E0              ADD      A,ACC
B3:00BB9A 2410              ADD      A,#LOW m_frame_rules+01H
B3:00BB9C F582              MOV      DPL,A
B3:00BB9E E4                CLR      A
B3:00BB9F 3430              ADDC     A,#HIGH m_frame_rules+01H
B3:00BBA1 F583              MOV      DPH,A
B3:00BBA3 E0                MOVX     A,@DPTR
B3:00BBA4 FE                MOV      R6,A
B3:00BBA5 B4020E            CJNE     A,#02H,?C0056?S2_INCLUSION
B3:00BBA8 318D              ACALL    ?L?COM00B4
B3:00BBAA 30E009            JNB      ACC.0,?C0056?S2_INCLUSION
B3:00BBAD EF                MOV      A,R7
B3:00BBAE 25E0              ADD      A,ACC
B3:00BBB0 25E0              ADD      A,ACC
B3:00BBB2 91B5              ACALL    ?L?COM0532
B3:00BBB4 8009              SJMP     ?C0136?S2_INCLUSION
B3:00BBB6         ?C0056?S2_INCLUSION:
B3:00BBB6 914E              ACALL    ?L?COM039F
B3:00BBB8 2411              ADD      A,#LOW m_frame_rules+02H
B3:00BBBA F582              MOV      DPL,A
B3:00BBBC E4                CLR      A
B3:00BBBD 3430              ADDC     A,#HIGH m_frame_rules+02H
B3:00BBBF         
B3:00BBBF F583              MOV      DPH,A
B3:00BBC1 E0                MOVX     A,@DPTR
B3:00BBC2 90459E            MOV      DPTR,#crypt_rule
B3:00BBC5 F0                MOVX     @DPTR,A
B3:00BBC6         ?C0057?S2_INCLUSION:
B3:00BBC6 9028DA            MOV      DPTR,#the_context+0D6H
B3:00BBC9 E0                MOVX     A,@DPTR
B3:00BBCA FF                MOV      R7,A
B3:00BBCB 90459E            MOV      DPTR,#crypt_rule
B3:00BBCE E0                MOVX     A,@DPTR
B3:00BBCF 6F                XRL      A,R7
B3:00BBD0 601C              JZ       ?C0058?S2_INCLUSION
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 824


B3:00BBD2 EE                MOV      A,R6
B3:00BBD3 B4010C            CJNE     A,#01H,?C0060?S2_INCLUSION
B3:00BBD6 914E              ACALL    ?L?COM039F
B3:00BBD8 91B5              ACALL    ?L?COM0532
B3:00BBDA F583              MOV      DPH,A
B3:00BBDC E0                MOVX     A,@DPTR
B3:00BBDD FE                MOV      R6,A
B3:00BBDE EF                MOV      A,R7
B3:00BBDF 6E                XRL      A,R6
B3:00BBE0 600C              JZ       ?C0058?S2_INCLUSION
B3:00BBE2         ?C0060?S2_INCLUSION:
B3:00BBE2 7DFF              MOV      R5,#0FFH
B3:00BBE4 7F07              MOV      R7,#07H
B3:00BBE6 513D              ACALL    _inclusion_failed_frame_send
B3:00BBE8 7F0B              MOV      R7,#0BH
B3:00BBEA         
B3:00BBEA 7E02              MOV      R6,#02H
B3:00BBEC 805C              SJMP     ?C0137?S2_INCLUSION
B3:00BBEE         ?C0058?S2_INCLUSION:
B3:00BBEE 91BD              ACALL    ?L?COM04FE
B3:00BBF0 EE                MOV      A,R6
B3:00BBF1 7055              JNZ      ?C0061?S2_INCLUSION
B3:00BBF3 EF                MOV      A,R7
B3:00BBF4 24FA              ADD      A,#0FAH
B3:00BBF6 600F              JZ       ?C0063?S2_INCLUSION
B3:00BBF8 24FE              ADD      A,#0FEH
B3:00BBFA 600B              JZ       ?C0063?S2_INCLUSION
B3:00BBFC 24FD              ADD      A,#0FDH
B3:00BBFE 6017              JZ       ?C0065?S2_INCLUSION
B3:00BC00 14                DEC      A
B3:00BC01 6025              JZ       ?C0068?S2_INCLUSION
B3:00BC03 2407              ADD      A,#07H
B3:00BC05 7041              JNZ      ?C0061?S2_INCLUSION
B3:00BC07         ?C0063?S2_INCLUSION:
B3:00BC07         
B3:00BC07 318D              ACALL    ?L?COM00B4
B3:00BC09 5401              ANL      A,#01H
B3:00BC0B FE                MOV      R6,A
B3:00BC0C 90459F            MOV      DPTR,#event
B3:00BC0F E0                MOVX     A,@DPTR
B3:00BC10 4E                ORL      A,R6
B3:00BC11 F0                MOVX     @DPTR,A
B3:00BC12 A3                INC      DPTR
B3:00BC13 E0                MOVX     A,@DPTR
B3:00BC14 F0                MOVX     @DPTR,A
B3:00BC15 8031              SJMP     ?C0061?S2_INCLUSION
B3:00BC17         ?C0065?S2_INCLUSION:
B3:00BC17 7119              ACALL    ?L?COM0558
B3:00BC19 B50706            CJNE     A,AR7,?C0066?S2_INCLUSION
B3:00BC1C 7E02              MOV      R6,#02H
B3:00BC1E 7F07              MOV      R7,#07H
B3:00BC20 801E              SJMP     ?C0139?S2_INCLUSION
B3:00BC22         ?C0066?S2_INCLUSION:
B3:00BC22 7E00              MOV      R6,#00H
B3:00BC24 7F0B              MOV      R7,#0BH
B3:00BC26         ?C0067?S2_INCLUSION:
B3:00BC26 8018              SJMP     ?C0139?S2_INCLUSION
B3:00BC28         ?C0068?S2_INCLUSION:
B3:00BC28 9028C9            MOV      DPTR,#the_context+0C5H
B3:00BC2B E0                MOVX     A,@DPTR
B3:00BC2C F4                CPL      A
B3:00BC2D 04                INC      A
B3:00BC2E FF                MOV      R7,A
B3:00BC2F 9028C8            MOV      DPTR,#the_context+0C4H
B3:00BC32 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 825


B3:00BC33 5F                ANL      A,R7
B3:00BC34 6006              JZ       ?C0069?S2_INCLUSION
B3:00BC36 7E00              MOV      R6,#00H
B3:00BC38 7F0C              MOV      R7,#0CH
B3:00BC3A 8004              SJMP     ?C0070?S2_INCLUSION
B3:00BC3C         ?C0069?S2_INCLUSION:
B3:00BC3C 7E02              MOV      R6,#02H
B3:00BC3E 7F05              MOV      R7,#05H
B3:00BC40         ?C0070?S2_INCLUSION:
B3:00BC40         
B3:00BC40 90459F            MOV      DPTR,#event
B3:00BC43 EE                MOV      A,R6
B3:00BC44 F0                MOVX     @DPTR,A
B3:00BC45 A3                INC      DPTR
B3:00BC46 EF                MOV      A,R7
B3:00BC47 F0                MOVX     @DPTR,A
B3:00BC48         ?C0061?S2_INCLUSION:
B3:00BC48 91BD              ACALL    ?L?COM04FE
B3:00BC4A         
B3:00BC4A 128BE8            LCALL    _process_event
B3:00BC4D         ?C0054?S2_INCLUSION:
B3:00BC4D 22                RET      
----- FUNCTION s2_inclusion_post_event (END) -------


----- FUNCTION ?L?COM039F (BEGIN) -----
B3:00BC4E 9045A1            MOV      DPTR,#event_rule_index
B3:00BC51 E0                MOVX     A,@DPTR
B3:00BC52 25E0              ADD      A,ACC
B3:00BC54 25E0              ADD      A,ACC
B3:00BC56 22                RET      
----- FUNCTION ?L?COM039F (END) -------


----- FUNCTION s2_send_kex_report (BEGIN) -----
B3:00BC57 904654            MOV      DPTR,#p_s2_event
B3:00BC5A 7121              ACALL    ?L?COM0214
B3:00BC5C 1224F7            LCALL    ?C?LSTKPTR
B3:00BC5F 00                DB       00H
B3:00BC60 00                DB       00H
B3:00BC61 00                DB       00H
B3:00BC62 00                DB       00H
B3:00BC63 904654            MOV      DPTR,#p_s2_event
B3:00BC66 B12D              ACALL    ?L?COM00C3
B3:00BC68 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00BC6A 79D3              MOV      R1,#LOW the_context+0CFH
B3:00BC6C B126              ACALL    ?L?COM0173
B3:00BC6E 904654            MOV      DPTR,#p_s2_event
B3:00BC71 122552            LCALL    ?C?PLDXDATA
B3:00BC74 D16F              ACALL    ?L?COM00BF
B3:00BC76 1226E3            LCALL    ?C?ICALL2
B3:00BC79 902A14            MOV      DPTR,#the_context+0210H
B3:00BC7C E0                MOVX     A,@DPTR
B3:00BC7D 7F00              MOV      R7,#00H
B3:00BC7F 7002              JNZ      ?C0093?S2_INCLUSION
B3:00BC81 7F02              MOV      R7,#02H
B3:00BC83         ?C0093?S2_INCLUSION:
B3:00BC83         ?C0094?S2_INCLUSION:
B3:00BC83 9028C4            MOV      DPTR,#the_context+0C0H
B3:00BC86 EF                MOV      A,R7
B3:00BC87 5194              ACALL    ?L?COM01E8
B3:00BC89 7405              MOV      A,#05H
B3:00BC8B F0                MOVX     @DPTR,A
B3:00BC8C 9028C4            MOV      DPTR,#the_context+0C0H
B3:00BC8F E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 826


B3:00BC90 902AF5            MOV      DPTR,#the_context+02F1H
B3:00BC93 F0                MOVX     @DPTR,A
B3:00BC94 902DFE            MOV      DPTR,#m_schemes
B3:00BC97 E0                MOVX     A,@DPTR
B3:00BC98 902AF6            MOV      DPTR,#the_context+02F2H
B3:00BC9B F0                MOVX     @DPTR,A
B3:00BC9C 90300E            MOV      DPTR,#m_curves
B3:00BC9F E0                MOVX     A,@DPTR
B3:00BCA0 902AF7            MOV      DPTR,#the_context+02F3H
B3:00BCA3 F0                MOVX     @DPTR,A
B3:00BCA4 902DFD            MOV      DPTR,#m_keys
B3:00BCA7 E0                MOVX     A,@DPTR
B3:00BCA8 902AF8            MOV      DPTR,#the_context+02F4H
B3:00BCAB F0                MOVX     @DPTR,A
B3:00BCAC 7406              MOV      A,#06H
B3:00BCAE 51E3              ACALL    ?L?COM039E
B3:00BCB0 D1CE              ACALL    ?L?COM04FC
B3:00BCB2 028AFC            LJMP     _s2_inclusion_set_timeout
----- FUNCTION s2_send_kex_report (END) -------


----- FUNCTION ?L?COM0532 (BEGIN) -----
B3:00BCB5 2412              ADD      A,#LOW m_frame_rules+03H
B3:00BCB7 F582              MOV      DPL,A
B3:00BCB9 E4                CLR      A
B3:00BCBA 3430              ADDC     A,#HIGH m_frame_rules+03H
B3:00BCBC 22                RET      
----- FUNCTION ?L?COM0532 (END) -------


----- FUNCTION ?L?COM04FE (BEGIN) -----
B3:00BCBD 90459F            MOV      DPTR,#event
B3:00BCC0 E0                MOVX     A,@DPTR
B3:00BCC1 FE                MOV      R6,A
B3:00BCC2 A3                INC      DPTR
B3:00BCC3 E0                MOVX     A,@DPTR
B3:00BCC4 FF                MOV      R7,A
B3:00BCC5 22                RET      
----- FUNCTION ?L?COM04FE (END) -------


----- FUNCTION ?L?COM04FB (BEGIN) -----
B3:00BCC6 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00BCC8 79D3              MOV      R1,#LOW the_context+0CFH
B3:00BCCA 91CE              ACALL    ___S2_send_frame
B3:00BCCC EF                MOV      A,R7
B3:00BCCD 22                RET      
----- FUNCTION ?L?COM04FB (END) -------


----- FUNCTION ___S2_send_frame (BEGIN) -----
B3:00BCCE 90438A            MOV      DPTR,#conn
B3:00BCD1 122572            LCALL    ?C?PSTXDATA
B3:00BCD4 7B01              MOV      R3,#01H
B3:00BCD6 7A3C              MOV      R2,#HIGH txo
B3:00BCD8 7981              MOV      R1,#LOW txo
B3:00BCDA 7D06              MOV      R5,#06H
B3:00BCDC E4                CLR      A
B3:00BCDD FF                MOV      R7,A
B3:00BCDE 12851A            LCALL    ___ZW_memset
B3:00BCE1 90438A            MOV      DPTR,#conn
B3:00BCE4 12A3E6            LCALL    ?L?COM0077
B3:00BCE7 903C82            MOV      DPTR,#txo+01H
B3:00BCEA F0                MOVX     @DPTR,A
B3:00BCEB E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 827


B3:00BCEC 2401              ADD      A,#01H
B3:00BCEE 1252DD            LCALL    ?L?COM0009
B3:00BCF1 903C81            MOV      DPTR,#txo
B3:00BCF4 F0                MOVX     @DPTR,A
B3:00BCF5 90438A            MOV      DPTR,#conn
B3:00BCF8 122552            LCALL    ?C?PLDXDATA
B3:00BCFB E9                MOV      A,R1
B3:00BCFC 2404              ADD      A,#04H
B3:00BCFE 1252DD            LCALL    ?L?COM0009
B3:00BD01 903C83            MOV      DPTR,#txo+02H
B3:00BD04 F0                MOVX     @DPTR,A
B3:00BD05 903C86            MOV      DPTR,#txo+05H
B3:00BD08 7401              MOV      A,#01H
B3:00BD0A F0                MOVX     @DPTR,A
B3:00BD0B 904390            MOV      DPTR,#len
B3:00BD0E 7A3C              MOV      R2,#HIGH txo
B3:00BD10 7981              MOV      R1,#LOW txo
B3:00BD12 1281D7            LCALL    ?L?COM00AD
B3:00BD15 F1B0              ACALL    ?L?COM0435
B3:00BD17 90438D            MOV      DPTR,#buf
B3:00BD1A 122552            LCALL    ?C?PLDXDATA
B3:00BD1D 021980            LJMP     ?INTERBANK_TABLE?_ZW_SendDataEx
----- FUNCTION ___S2_send_frame (END) -------


----- FUNCTION ?L?COM0172 (BEGIN) -----
B3:00BD20 78D3              MOV      R0,#LOW the_context+0CFH
B3:00BD22 7C28              MOV      R4,#HIGH the_context+0CFH
B3:00BD24 7D01              MOV      R5,#01H
B3:00BD26         ?L?COM0173:
B3:00BD26 7E00              MOV      R6,#00H
B3:00BD28 7F08              MOV      R7,#08H
B3:00BD2A 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM0172 (END) -------


----- FUNCTION ?L?COM00C3 (BEGIN) -----
B3:00BD2D 122552            LCALL    ?C?PLDXDATA
B3:00BD30 E9                MOV      A,R1
B3:00BD31 2404              ADD      A,#04H
B3:00BD33 F9                MOV      R1,A
B3:00BD34 E4                CLR      A
B3:00BD35 3A                ADDC     A,R2
B3:00BD36 A801              MOV      R0,AR1
B3:00BD38 FC                MOV      R4,A
B3:00BD39 AD03              MOV      R5,AR3
B3:00BD3B 7B01              MOV      R3,#01H
B3:00BD3D 22                RET      
----- FUNCTION ?L?COM00C3 (END) -------


----- FUNCTION ?L?COM0350 (BEGIN) -----
B3:00BD3E 7B01              MOV      R3,#01H
B3:00BD40 7A2A              MOV      R2,#HIGH the_context+02EFH
B3:00BD42 79F3              MOV      R1,#LOW the_context+02EFH
B3:00BD44 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0350 (END) -------


----- FUNCTION ___S2_network_key_update (BEGIN) -----
B3:00BD47 904533            MOV      DPTR,#net_key
B3:00BD4A 122572            LCALL    ?C?PSTXDATA
B3:00BD4D 904532            MOV      DPTR,#class_id
B3:00BD50 EF                MOV      A,R7
B3:00BD51 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 828


B3:00BD52 C3                CLR      C
B3:00BD53 9403              SUBB     A,#03H
B3:00BD55 4003              JC       ?C0170?S2
B3:00BD57 7F00              MOV      R7,#00H
B3:00BD59 22                RET      
B3:00BD5A         ?C0170?S2:
B3:00BD5A 904536            MOV      DPTR,#temp_key_expand
B3:00BD5D E0                MOVX     A,@DPTR
B3:00BD5E 904532            MOV      DPTR,#class_id
B3:00BD61 6016              JZ       ?C0172?S2
B3:00BD63 E0                MOVX     A,@DPTR
B3:00BD64 903FAD            MOV      DPTR,#?_tempkey_expand?BYTE+03H
B3:00BD67 D1A9              ACALL    ?L?COM0251
B3:00BD69 903FB0            MOV      DPTR,#?_tempkey_expand?BYTE+06H
B3:00BD6C 122572            LCALL    ?C?PSTXDATA
B3:00BD6F 903FB3            MOV      DPTR,#?_tempkey_expand?BYTE+09H
B3:00BD72 D154              ACALL    ?L?COM0310
B3:00BD74 121B51            LCALL    ?INTERBANK_TABLE?_tempkey_expand
B3:00BD77 8014              SJMP     ?C0173?S2
B3:00BD79         ?C0172?S2:
B3:00BD79 E0                MOVX     A,@DPTR
B3:00BD7A 903F92            MOV      DPTR,#?_networkkey_expand?BYTE+03H
B3:00BD7D D1A9              ACALL    ?L?COM0251
B3:00BD7F 903F95            MOV      DPTR,#?_networkkey_expand?BYTE+06H
B3:00BD82 122572            LCALL    ?C?PSTXDATA
B3:00BD85 903F98            MOV      DPTR,#?_networkkey_expand?BYTE+09H
B3:00BD88 D154              ACALL    ?L?COM0310
B3:00BD8A 121B47            LCALL    ?INTERBANK_TABLE?_networkkey_expand
B3:00BD8D         ?C0173?S2:
B3:00BD8D 9028CA            MOV      DPTR,#the_context+0C6H
B3:00BD90 E0                MOVX     A,@DPTR
B3:00BD91 904532            MOV      DPTR,#class_id
B3:00BD94 126E40            LCALL    ?L?COM01FC
B3:00BD97 8002              SJMP     ?C0272?S2
B3:00BD99         ?C0271?S2:
B3:00BD99 C3                CLR      C
B3:00BD9A 33                RLC      A
B3:00BD9B         ?C0272?S2:
B3:00BD9B D8FC              DJNZ     R0,?C0271?S2
B3:00BD9D 4F                ORL      A,R7
B3:00BD9E 9028CA            MOV      DPTR,#the_context+0C6H
B3:00BDA1 F0                MOVX     @DPTR,A
B3:00BDA2 7F01              MOV      R7,#01H
B3:00BDA4 22                RET      
----- FUNCTION ___S2_network_key_update (END) -------


----- FUNCTION ___S2_set_peer (BEGIN) -----
;---- Variable 'peer' assigned to Register 'R1/R2/R3' ----
B3:00BDA5 B120              ACALL    ?L?COM0172
B3:00BDA7 9043C5            MOV      DPTR,#buf
B3:00BDAA 122552            LCALL    ?C?PLDXDATA
B3:00BDAD 9028DB            MOV      DPTR,#the_context+0D7H
B3:00BDB0 122572            LCALL    ?C?PSTXDATA
B3:00BDB3 9043C8            MOV      DPTR,#len
B3:00BDB6 E0                MOVX     A,@DPTR
B3:00BDB7 FF                MOV      R7,A
B3:00BDB8 A3                INC      DPTR
B3:00BDB9 E0                MOVX     A,@DPTR
B3:;----                  JMP      ?L?COM04E1
----- FUNCTION ___S2_set_peer (END) -------


----- FUNCTION ?L?COM04E1 (BEGIN) -----
B3:00BDBA 9028DE            MOV      DPTR,#the_context+0DAH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 829


B3:00BDBD CF                XCH      A,R7
B3:00BDBE F0                MOVX     @DPTR,A
B3:00BDBF A3                INC      DPTR
B3:00BDC0 EF                MOV      A,R7
B3:00BDC1 F0                MOVX     @DPTR,A
B3:00BDC2 22                RET      
----- FUNCTION ?L?COM04E1 (END) -------


----- FUNCTION s2_pub_key_a_recv (BEGIN) -----
B3:00BDC3 904657            MOV      DPTR,#s2_event
B3:00BDC6 D1C5              ACALL    ?L?COM0471
B3:00BDC8 D1CE              ACALL    ?L?COM04FC
B3:00BDCA 128AFC            LCALL    _s2_inclusion_set_timeout
B3:00BDCD 1289B4            LCALL    ?L?COM004C
B3:00BDD0 781C              MOV      R0,#LOW the_context+0318H
B3:00BDD2 7C2B              MOV      R4,#HIGH the_context+0318H
B3:00BDD4 D14B              ACALL    ?L?COM01E5
B3:00BDD6 D145              ACALL    ?L?COM03B7
B3:00BDD8 1224F7            LCALL    ?C?LSTKPTR
B3:00BDDB 00                DB       00H
B3:00BDDC 00                DB       00H
B3:00BDDD 00                DB       00H
B3:00BDDE 02                DB       02H
B3:00BDDF 904657            MOV      DPTR,#s2_event
B3:00BDE2 B12D              ACALL    ?L?COM00C3
B3:00BDE4 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00BDE6 79D3              MOV      R1,#LOW the_context+0CFH
B3:00BDE8 B126              ACALL    ?L?COM0173
B3:00BDEA 1289B4            LCALL    ?L?COM004C
B3:00BDED C003              PUSH     AR3
B3:00BDEF C002              PUSH     AR2
B3:00BDF1 C001              PUSH     AR1
B3:00BDF3 D145              ACALL    ?L?COM03B7
B3:00BDF5 E9                MOV      A,R1
B3:00BDF6 2413              ADD      A,#013H
B3:00BDF8 F9                MOV      R1,A
B3:00BDF9 E4                CLR      A
B3:00BDFA 3A                ADDC     A,R2
B3:00BDFB A801              MOV      R0,AR1
B3:00BDFD FC                MOV      R4,A
B3:00BDFE AD03              MOV      R5,AR3
B3:00BE00 D001              POP      AR1
B3:00BE02 D002              POP      AR2
B3:00BE04 D003              POP      AR3
B3:00BE06 D14D              ACALL    ?L?COM01E6
B3:00BE08 D145              ACALL    ?L?COM03B7
B3:00BE0A 900011            MOV      DPTR,#011H
B3:00BE0D E4                CLR      A
B3:00BE0E 75F020            MOV      B,#020H
B3:00BE11 122207            LCALL    ?C?ISTOPTR
B3:00BE14 9028C8            MOV      DPTR,#the_context+0C4H
B3:00BE17 E0                MOVX     A,@DPTR
B3:00BE18 FF                MOV      R7,A
B3:00BE19 90000F            MOV      DPTR,#0FH
B3:00BE1C 12204D            LCALL    ?C?CSTOPTR
B3:00BE1F EF                MOV      A,R7
B3:00BE20 5406              ANL      A,#06H
B3:00BE22 6010              JZ       ?C0110?S2_INCLUSION
B3:00BE24 902A14            MOV      DPTR,#the_context+0210H
B3:00BE27 E0                MOVX     A,@DPTR
B3:00BE28 700A              JNZ      ?C0110?S2_INCLUSION
B3:00BE2A 904657            MOV      DPTR,#s2_event
B3:00BE2D 1296A2            LCALL    ?L?COM0167
B3:00BE30 7404              MOV      A,#04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 830


B3:00BE32 8007              SJMP     ?C0144?S2_INCLUSION
B3:00BE34         ?C0110?S2_INCLUSION:
B3:00BE34 904657            MOV      DPTR,#s2_event
B3:00BE37 1296A2            LCALL    ?L?COM0167
B3:00BE3A E4                CLR      A
B3:00BE3B         
B3:00BE3B 12204D            LCALL    ?C?CSTOPTR
B3:00BE3E         ?C0111?S2_INCLUSION:
B3:00BE3E D145              ACALL    ?L?COM03B7
B3:00BE40 D16F              ACALL    ?L?COM00BF
B3:00BE42 0226E3            LJMP     ?C?ICALL2
----- FUNCTION s2_pub_key_a_recv (END) -------


----- FUNCTION ?L?COM03B7 (BEGIN) -----
B3:00BE45 904657            MOV      DPTR,#s2_event
B3:00BE48 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM03B7 (END) -------


----- FUNCTION ?L?COM01E5 (BEGIN) -----
B3:00BE4B 7D01              MOV      R5,#01H
B3:00BE4D         ?L?COM01E6:
B3:00BE4D 7E00              MOV      R6,#00H
B3:00BE4F 7F20              MOV      R7,#020H
B3:00BE51 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM01E5 (END) -------


----- FUNCTION ?L?COM0310 (BEGIN) -----
B3:00BE54 7414              MOV      A,#LOW the_context+010H
B3:00BE56 2F                ADD      A,R7
B3:00BE57 F9                MOV      R1,A
B3:00BE58 7428              MOV      A,#HIGH the_context+010H
B3:00BE5A 3E                ADDC     A,R6
B3:00BE5B FA                MOV      R2,A
B3:00BE5C 122572            LCALL    ?C?PSTXDATA
B3:00BE5F 904533            MOV      DPTR,#net_key
B3:00BE62 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0310 (END) -------


----- FUNCTION ?L?COM00BE (BEGIN) -----
B3:00BE65 122552            LCALL    ?C?PLDXDATA
B3:00BE68 90000C            MOV      DPTR,#0CH
B3:00BE6B EF                MOV      A,R7
B3:00BE6C 12204D            LCALL    ?C?CSTOPTR
B3:00BE6F         ?L?COM00BF:
B3:00BE6F 902FEC            MOV      DPTR,#m_evt_handler
B3:00BE72         ?L?COM00C0:
B3:00BE72 E0                MOVX     A,@DPTR
B3:00BE73 FE                MOV      R6,A
B3:00BE74 A3                INC      DPTR
B3:00BE75 E0                MOVX     A,@DPTR
B3:00BE76 FF                MOV      R7,A
B3:00BE77 F582              MOV      DPL,A
B3:00BE79 8E83              MOV      DPH,R6
B3:00BE7B 22                RET      
----- FUNCTION ?L?COM00BE (END) -------


----- FUNCTION s2_joining_complete (BEGIN) -----
B3:00BE7C 90465A            MOV      DPTR,#s2_event
B3:00BE7F D1C5              ACALL    ?L?COM0471
B3:00BE81 128A05            LCALL    ?L?COM053F
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 831


B3:00BE84 90465A            MOV      DPTR,#s2_event
B3:00BE87 122552            LCALL    ?C?PLDXDATA
B3:00BE8A 1224F7            LCALL    ?C?LSTKPTR
B3:00BE8D 00                DB       00H
B3:00BE8E 00                DB       00H
B3:00BE8F 00                DB       00H
B3:00BE90 04                DB       04H
B3:00BE91 90465A            MOV      DPTR,#s2_event
B3:00BE94 B12D              ACALL    ?L?COM00C3
B3:00BE96 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00BE98 79D3              MOV      R1,#LOW the_context+0CFH
B3:00BE9A B126              ACALL    ?L?COM0173
B3:00BE9C 9028C8            MOV      DPTR,#the_context+0C4H
B3:00BE9F E0                MOVX     A,@DPTR
B3:00BEA0 FF                MOV      R7,A
B3:00BEA1 90465A            MOV      DPTR,#s2_event
B3:00BEA4 D165              ACALL    ?L?COM00BE
B3:00BEA6 0226E3            LJMP     ?C?ICALL2
----- FUNCTION s2_joining_complete (END) -------


----- FUNCTION ?L?COM0251 (BEGIN) -----
B3:00BEA9 75F040            MOV      B,#040H
B3:00BEAC A4                MUL      AB
B3:00BEAD FF                MOV      R7,A
B3:00BEAE AEF0              MOV      R6,B
B3:00BEB0 7B01              MOV      R3,#01H
B3:00BEB2 2404              ADD      A,#LOW the_context
B3:00BEB4 F9                MOV      R1,A
B3:00BEB5 7428              MOV      A,#HIGH the_context
B3:00BEB7 3E                ADDC     A,R6
B3:00BEB8 FA                MOV      R2,A
B3:00BEB9 122572            LCALL    ?C?PSTXDATA
B3:00BEBC 7424              MOV      A,#LOW the_context+020H
B3:00BEBE 2F                ADD      A,R7
B3:00BEBF F9                MOV      R1,A
B3:00BEC0 7428              MOV      A,#HIGH the_context+020H
B3:00BEC2 3E                ADDC     A,R6
B3:00BEC3 FA                MOV      R2,A
B3:00BEC4 22                RET      
----- FUNCTION ?L?COM0251 (END) -------


----- FUNCTION ?L?COM0471 (BEGIN) -----
B3:00BEC5 7B01              MOV      R3,#01H
B3:00BEC7 7A2F              MOV      R2,#HIGH m_event_buffer
B3:00BEC9 796C              MOV      R1,#LOW m_event_buffer
B3:00BECB 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0471 (END) -------


----- FUNCTION ?L?COM04FC (BEGIN) -----
B3:00BECE 7FC0              MOV      R7,#0C0H
B3:00BED0 7E5D              MOV      R6,#05DH
B3:00BED2 7D00              MOV      R5,#00H
B3:00BED4 7C00              MOV      R4,#00H
B3:00BED6 22                RET      
----- FUNCTION ?L?COM04FC (END) -------


----- FUNCTION ?L?COM0347 (BEGIN) -----
B3:00BED7 7F0F              MOV      R7,#0FH
B3:00BED9 7E1D              MOV      R6,#01DH
----- FUNCTION _ZW_CheckCrc16 (BEGIN) -----
;---- Variable 'bitMask' assigned to Register 'R5' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 832


B3:00BEDB 90436A            MOV      DPTR,#crc
B3:00BEDE 123C23            LCALL    ?L?COM0146
B3:00BEE1 122572            LCALL    ?C?PSTXDATA
B3:00BEE4         ?C0001?ZW_CRC:
B3:00BEE4 90436F            MOV      DPTR,#bDataLen
B3:00BEE7 126EF4            LCALL    ?L?COM0373
B3:00BEEA 6055              JZ       ?C0002?ZW_CRC
B3:00BEEC 90436C            MOV      DPTR,#pDataAddr
B3:00BEEF 12A3E6            LCALL    ?L?COM0077
B3:00BEF2 904371            MOV      DPTR,#WorkData
B3:00BEF5 F0                MOVX     @DPTR,A
B3:00BEF6 90436D            MOV      DPTR,#pDataAddr+01H
B3:00BEF9 E4                CLR      A
B3:00BEFA 75F001            MOV      B,#01H
B3:00BEFD 12210C            LCALL    ?C?IILDX
B3:00BF00 7D80              MOV      R5,#080H
B3:00BF02         ?C0003?ZW_CRC:
B3:00BF02 ED                MOV      A,R5
B3:00BF03 60DF              JZ       ?C0001?ZW_CRC
B3:00BF05 F141              ACALL    ?L?COM050B
B3:00BF07 EE                MOV      A,R6
B3:00BF08 7C00              MOV      R4,#00H
B3:00BF0A 30E702            JNB      ACC.7,?C0006?ZW_CRC
B3:00BF0D 7C01              MOV      R4,#01H
B3:00BF0F         ?C0006?ZW_CRC:
B3:00BF0F         ?C0007?ZW_CRC:
B3:00BF0F 904371            MOV      DPTR,#WorkData
B3:00BF12 E0                MOVX     A,@DPTR
B3:00BF13 5D                ANL      A,R5
B3:00BF14 7B00              MOV      R3,#00H
B3:00BF16 6002              JZ       ?C0008?ZW_CRC
B3:00BF18 7B01              MOV      R3,#01H
B3:00BF1A         ?C0008?ZW_CRC:
B3:00BF1A         ?C0009?ZW_CRC:
B3:00BF1A EB                MOV      A,R3
B3:00BF1B 6C                XRL      A,R4
B3:00BF1C FC                MOV      R4,A
;---- Variable 'NewBit' assigned to Register 'R4' ----
B3:00BF1D EF                MOV      A,R7
B3:00BF1E 25E0              ADD      A,ACC
B3:00BF20 FF                MOV      R7,A
B3:00BF21 EE                MOV      A,R6
B3:00BF22 33                RLC      A
B3:00BF23 90436A            MOV      DPTR,#crc
B3:00BF26 F0                MOVX     @DPTR,A
B3:00BF27 A3                INC      DPTR
B3:00BF28 EF                MOV      A,R7
B3:00BF29 F0                MOVX     @DPTR,A
B3:00BF2A AF04              MOV      R7,AR4
B3:00BF2C EF                MOV      A,R7
B3:00BF2D 600C              JZ       ?C0005?ZW_CRC
B3:00BF2F 90436A            MOV      DPTR,#crc
B3:00BF32 E0                MOVX     A,@DPTR
B3:00BF33 6410              XRL      A,#010H
B3:00BF35 F0                MOVX     @DPTR,A
B3:00BF36 A3                INC      DPTR
B3:00BF37 E0                MOVX     A,@DPTR
B3:00BF38 6421              XRL      A,#021H
B3:00BF3A F0                MOVX     @DPTR,A
B3:00BF3B         ?C0005?ZW_CRC:
B3:00BF3B ED                MOV      A,R5
B3:00BF3C C3                CLR      C
B3:00BF3D 13                RRC      A
B3:00BF3E FD                MOV      R5,A
B3:00BF3F 80C1              SJMP     ?C0003?ZW_CRC
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 833


B3:00BF41         ?C0002?ZW_CRC:
B3:;----                  JMP      ?L?COM050B
----- FUNCTION _ZW_CheckCrc16 (END) -------


----- FUNCTION ?L?COM050B (BEGIN) -----
B3:00BF41 90436A            MOV      DPTR,#crc
B3:00BF44 E0                MOVX     A,@DPTR
B3:00BF45 FE                MOV      R6,A
B3:00BF46 A3                INC      DPTR
B3:00BF47 E0                MOVX     A,@DPTR
B3:00BF48 FF                MOV      R7,A
B3:00BF49 22                RET      
----- FUNCTION ?L?COM050B (END) -------


----- FUNCTION _ZW_CreateCrc16 (BEGIN) -----
;---- Variable 'bHeaderLen' assigned to Register 'R5' ----
;---- Variable 'pHeaderAddr' assigned to Register 'R1/R2/R3' ----
;---- Variable 'crc' assigned to Register 'R6/R7' ----
B3:00BF4A 7F0F              MOV      R7,#0FH
B3:00BF4C 7E1D              MOV      R6,#01DH
B3:00BF4E F161              ACALL    ?L?COM0289
B3:00BF50 D1DB              ACALL    _ZW_CheckCrc16
B3:00BF52 904376            MOV      DPTR,#pPayloadAddr
B3:00BF55 122552            LCALL    ?C?PLDXDATA
B3:00BF58 904379            MOV      DPTR,#bPayloadLen
B3:00BF5B F15F              ACALL    ?L?COM0288
B3:00BF5D C1DB              AJMP     _ZW_CheckCrc16
----- FUNCTION _ZW_CreateCrc16 (END) -------


----- FUNCTION ?L?COM0288 (BEGIN) -----
B3:00BF5F E0                MOVX     A,@DPTR
B3:00BF60 FD                MOV      R5,A
B3:00BF61         ?L?COM0289:
B3:00BF61 90436F            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B3:00BF64 E4                CLR      A
B3:00BF65 F0                MOVX     @DPTR,A
B3:00BF66 A3                INC      DPTR
B3:00BF67 ED                MOV      A,R5
B3:00BF68 F0                MOVX     @DPTR,A
B3:00BF69 22                RET      
----- FUNCTION ?L?COM0288 (END) -------


----- FUNCTION _S2_get_hw_random (BEGIN) -----
B3:00BF6A 904528            MOV      DPTR,#buf
B3:00BF6D 122572            LCALL    ?C?PSTXDATA
B3:00BF70 90452B            MOV      DPTR,#len
B3:00BF73 ED                MOV      A,R5
B3:00BF74 F0                MOVX     @DPTR,A
B3:00BF75 A3                INC      DPTR
B3:00BF76 F0                MOVX     @DPTR,A
B3:00BF77 D3                SETB     C
B3:00BF78 9410              SUBB     A,#010H
B3:00BF7A 4003              JC       ?C0029?ZW_SECURITY_SCHEME2
B3:00BF7C 7410              MOV      A,#010H
B3:00BF7E F0                MOVX     @DPTR,A
B3:00BF7F         ?C0029?ZW_SECURITY_SCHEME2:
B3:00BF7F 90452C            MOV      DPTR,#tmpLen
B3:00BF82 E0                MOVX     A,@DPTR
B3:00BF83 FF                MOV      R7,A
B3:00BF84 7B01              MOV      R3,#01H
B3:00BF86 7A12              MOV      R2,#HIGH retentionRandom
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 834


B3:00BF88 792B              MOV      R1,#LOW retentionRandom
B3:00BF8A 128549            LCALL    ?L?COM0019
B3:00BF8D 904528            MOV      DPTR,#buf
B3:00BF90 122552            LCALL    ?C?PLDXDATA
B3:00BF93 128195            LCALL    ___ZW_memcpy
B3:00BF96 904528            MOV      DPTR,#buf
B3:00BF99 122552            LCALL    ?C?PLDXDATA
B3:00BF9C 90452C            MOV      DPTR,#tmpLen
B3:00BF9F E0                MOVX     A,@DPTR
B3:00BFA0 FF                MOV      R7,A
B3:00BFA1 F1C3              ACALL    ?L?COM0337
B3:00BFA3 90452B            MOV      DPTR,#len
B3:00BFA6 E0                MOVX     A,@DPTR
B3:00BFA7 C3                CLR      C
B3:00BFA8 9F                SUBB     A,R7
B3:00BFA9 FD                MOV      R5,A
B3:00BFAA 025E35            LJMP     _ZW_GetRandomArray
----- FUNCTION _S2_get_hw_random (END) -------


----- FUNCTION ExtMemoryWriteBusy (BEGIN) -----
B3:00BFAD 023592            LJMP     NVM_ext_busy
----- FUNCTION ExtMemoryWriteBusy (END) -------


----- FUNCTION ?L?COM0435 (BEGIN) -----
B3:00BFB0 900A33            MOV      DPTR,#?_ZW_SendDataEx?BYTE+07H
B3:00BFB3 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_S2_send_frame_callback
B3:00BFB5 F0                MOVX     @DPTR,A
B3:00BFB6 A3                INC      DPTR
B3:00BFB7 74AF              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_S2_send_frame_callback
B3:00BFB9 F0                MOVX     @DPTR,A
B3:00BFBA 22                RET      
----- FUNCTION ?L?COM0435 (END) -------


----- FUNCTION MemoryGetStatus (BEGIN) -----
B3:00BFBB 026B73            LJMP     NVM_ext_read_status
----- FUNCTION MemoryGetStatus (END) -------


----- FUNCTION ?L?COM0336 (BEGIN) -----
B3:00BFBE F9                MOV      R1,A
B3:00BFBF E4                CLR      A
B3:00BFC0 3A                ADDC     A,R2
B3:00BFC1 FA                MOV      R2,A
B3:00BFC2 EF                MOV      A,R7
B3:00BFC3         ?L?COM0337:
B3:00BFC3 7C00              MOV      R4,#00H
B3:00BFC5 29                ADD      A,R1
B3:00BFC6 F9                MOV      R1,A
B3:00BFC7 EC                MOV      A,R4
B3:00BFC8 3A                ADDC     A,R2
B3:00BFC9 FA                MOV      R2,A
B3:00BFCA 22                RET      
----- FUNCTION ?L?COM0336 (END) -------


----- FUNCTION MemoryClearStatus (BEGIN) -----
B3:00BFCB 026B79            LJMP     NVM_ext_clear_status
----- FUNCTION MemoryClearStatus (END) -------


----- FUNCTION _ZW_EepromInit (BEGIN) -----
B3:00BFCE E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 835


B3:00BFCF 904683            MOV      DPTR,#offes
B3:00BFD2 F0                MOVX     @DPTR,A
B3:00BFD3 A3                INC      DPTR
B3:00BFD4 F0                MOVX     @DPTR,A
B3:00BFD5 203A02            JB       productionTest,?C0003?ZW_MEM_SUPPORT
B3:00BFD8 C3                CLR      C
B3:00BFD9 22                RET      
B3:00BFDA         ?C0003?ZW_MEM_SUPPORT:
B3:00BFDA 904683            MOV      DPTR,#offes
B3:00BFDD 12DAD6            LCALL    ?L?COM014A
B3:00BFE0 EE                MOV      A,R6
B3:00BFE1 9440              SUBB     A,#040H
B3:00BFE3 501B              JNC      ?C0004?ZW_MEM_SUPPORT
B3:00BFE5 12B327            LCALL    ?L?COM004B
B3:00BFE8 9043F3            MOV      DPTR,#?_NVM_ext_write_buffer?BYTE+05H
B3:00BFEB E4                CLR      A
B3:00BFEC F0                MOVX     @DPTR,A
B3:00BFED A3                INC      DPTR
B3:00BFEE 7420              MOV      A,#020H
B3:00BFF0 F0                MOVX     @DPTR,A
B3:00BFF1 1239FB            LCALL    _NVM_ext_write_buffer
B3:00BFF4 904683            MOV      DPTR,#offes
B3:00BFF7 E4                CLR      A
B3:00BFF8 75F020            MOV      B,#020H
B3:00BFFB 12210C            LCALL    ?C?IILDX
B3:00BFFE 80DA              SJMP     ?C0003?ZW_MEM_SUPPORT
B3:00C000         ?C0004?ZW_MEM_SUPPORT:
B3:00C000 D3                SETB     C
B3:00C001 22                RET      
----- FUNCTION _ZW_EepromInit (END) -------


----- FUNCTION _MemoryPutBuffer (BEGIN) -----
;---- Variable 'buffer' assigned to Register 'R1/R2/R3' ----
;---- Variable 'offset' assigned to Register 'R6/R7' ----
B3:00C002 90427B            MOV      DPTR,#length
B3:00C005 E0                MOVX     A,@DPTR
B3:00C006 FD                MOV      R5,A
B3:00C007 A3                INC      DPTR
B3:00C008 E0                MOVX     A,@DPTR
B3:00C009 90441D            MOV      DPTR,#?_ZW_MemoryPutBuffer?BYTE+05H
B3:00C00C CD                XCH      A,R5
B3:00C00D F0                MOVX     @DPTR,A
B3:00C00E A3                INC      DPTR
B3:00C00F ED                MOV      A,R5
B3:00C010 F0                MOVX     @DPTR,A
B3:00C011 129758            LCALL    _ZW_MemoryPutBuffer
B3:00C014 90427F            MOV      DPTR,#retVal
B3:00C017 EF                MOV      A,R7
B3:00C018 F0                MOVX     @DPTR,A
B3:00C019 90427D            MOV      DPTR,#func
B3:00C01C 11B2              ACALL    ?L?COM00C2
B3:00C01E 6003              JZ       ?C0001?ZW_MEM_API
B3:00C020 1257A4            LCALL    ?L?COM02AD
B3:00C023         ?C0001?ZW_MEM_API:
B3:00C023 90427F            MOV      DPTR,#retVal
B3:00C026 E0                MOVX     A,@DPTR
B3:00C027 FF                MOV      R7,A
B3:00C028 22                RET      
----- FUNCTION _MemoryPutBuffer (END) -------


----- FUNCTION _ZW_NodeMaskSetBit (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 836


B3:00C029 1168              ACALL    ?L?COM041D
B3:00C02B 29                ADD      A,R1
B3:00C02C 1252DD            LCALL    ?L?COM0009
B3:00C02F FF                MOV      R7,A
B3:00C030 ED                MOV      A,R5
B3:00C031 5407              ANL      A,#07H
B3:00C033 126E42            LCALL    ?L?COM01FE
B3:00C036 8002              SJMP     ?C0023?ZW_NODEMASK
B3:00C038         ?C0022?ZW_NODEMASK:
B3:00C038 C3                CLR      C
B3:00C039 33                RLC      A
B3:00C03A         ?C0023?ZW_NODEMASK:
B3:00C03A D8FC              DJNZ     R0,?C0022?ZW_NODEMASK
B3:00C03C 4F                ORL      A,R7
B3:00C03D 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_NodeMaskSetBit (END) -------


----- FUNCTION _ZW_NodeMaskClearBit (BEGIN) -----
;---- Variable 'bNodeID' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00C040 1168              ACALL    ?L?COM041D
B3:00C042 29                ADD      A,R1
B3:00C043 1252DD            LCALL    ?L?COM0009
B3:00C046 FF                MOV      R7,A
B3:00C047 ED                MOV      A,R5
B3:00C048 5407              ANL      A,#07H
B3:00C04A 126E42            LCALL    ?L?COM01FE
B3:00C04D 8002              SJMP     ?C0025?ZW_NODEMASK
B3:00C04F         ?C0024?ZW_NODEMASK:
B3:00C04F C3                CLR      C
B3:00C050 33                RLC      A
B3:00C051         ?C0025?ZW_NODEMASK:
B3:00C051 D8FC              DJNZ     R0,?C0024?ZW_NODEMASK
B3:00C053 F4                CPL      A
B3:00C054 5F                ANL      A,R7
B3:00C055 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _ZW_NodeMaskClearBit (END) -------


----- FUNCTION _ZW_NodeMaskClear (BEGIN) -----
;---- Variable 'bLength' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00C058 ED                MOV      A,R5
B3:00C059 600C              JZ       ?C0007?ZW_NODEMASK
B3:00C05B         ?C0006?ZW_NODEMASK:
B3:00C05B E4                CLR      A
B3:00C05C 12203B            LCALL    ?C?CSTPTR
B3:00C05F 04                INC      A
B3:00C060 29                ADD      A,R1
B3:00C061 F9                MOV      R1,A
B3:00C062 E4                CLR      A
B3:00C063 3A                ADDC     A,R2
B3:00C064 FA                MOV      R2,A
B3:00C065 DDF4              DJNZ     R5,?C0006?ZW_NODEMASK
B3:00C067         ?C0007?ZW_NODEMASK:
B3:00C067 22                RET      
----- FUNCTION _ZW_NodeMaskClear (END) -------


----- FUNCTION ?L?COM041D (BEGIN) -----
B3:00C068 1D                DEC      R5
B3:00C069 ED                MOV      A,R5
B3:00C06A 13                RRC      A
B3:00C06B 13                RRC      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 837


B3:00C06C 13                RRC      A
B3:00C06D 541F              ANL      A,#01FH
B3:00C06F 22                RET      
----- FUNCTION ?L?COM041D (END) -------


----- FUNCTION _ZW_NodeMaskBitsIn (BEGIN) -----
;---- Variable 'bLength' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
;---- Variable 'count' assigned to Register 'R7' ----
B3:00C070 E4                CLR      A
B3:00C071 FF                MOV      R7,A
B3:00C072 ED                MOV      A,R5
B3:00C073 6015              JZ       ?C0008?ZW_NODEMASK
B3:00C075         ?C0011?ZW_NODEMASK:
;---- Variable 't' assigned to Register 'R6' ----
B3:00C075 7E01              MOV      R6,#01H
B3:00C077         ?C0012?ZW_NODEMASK:
B3:00C077 EE                MOV      A,R6
B3:00C078 600C              JZ       ?C0013?ZW_NODEMASK
B3:00C07A 121F7C            LCALL    ?C?CLDPTR
B3:00C07D 5E                ANL      A,R6
B3:00C07E 6001              JZ       ?C0014?ZW_NODEMASK
B3:00C080 0F                INC      R7
B3:00C081         ?C0014?ZW_NODEMASK:
B3:00C081 EE                MOV      A,R6
B3:00C082 2E                ADD      A,R6
B3:00C083 FE                MOV      R6,A
B3:00C084 80F1              SJMP     ?C0012?ZW_NODEMASK
B3:00C086         ?C0013?ZW_NODEMASK:
B3:00C086 914C              ACALL    ?L?COM0572
B3:00C088 DDEB              DJNZ     R5,?C0011?ZW_NODEMASK
B3:00C08A         ?C0008?ZW_NODEMASK:
B3:00C08A 22                RET      
----- FUNCTION _ZW_NodeMaskBitsIn (END) -------


----- FUNCTION _ExploreSetNWI (BEGIN) -----
;---- Variable 'mode' assigned to Register 'R7' ----
B3:00C08B E4                CLR      A
B3:00C08C F550              MOV      bNetworkWideInclusion,A
B3:00C08E EF                MOV      A,R7
B3:00C08F 24FF              ADD      A,#0FFH
B3:00C091 9211              MOV      exploreInclusionModeRepeat,C
B3:00C093 EF                MOV      A,R7
B3:00C094 6002              JZ       ?C0008?ZW_EXPLORE_SUPPORT
B3:00C096 616E              AJMP     NWIStartTimer
B3:00C098         ?C0008?ZW_EXPLORE_SUPPORT:
B3:;----                  JMP      NWIStopTimer
----- FUNCTION _ExploreSetNWI (END) -------


----- FUNCTION NWIStopTimer (BEGIN) -----
B3:00C098 7B01              MOV      R3,#01H
B3:00C09A 7A45              MOV      R2,#HIGH networkWideInclusionModeTimer
B3:00C09C 7981              MOV      R1,#LOW networkWideInclusionModeTimer
B3:00C09E 0253DD            LJMP     _SafeTimerStop
----- FUNCTION NWIStopTimer (END) -------


----- FUNCTION ?L?COM00C1 (BEGIN) -----
B3:00C0A1 E4                CLR      A
B3:00C0A2 902D8E            MOV      DPTR,#the_tx_session
B3:00C0A5 F0                MOVX     @DPTR,A
B3:00C0A6 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 838


B3:00C0A8 7A2D              MOV      R2,#HIGH the_tx_session+0BH
B3:00C0AA 7999              MOV      R1,#LOW the_tx_session+0BH
B3:00C0AC 121B2E            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00C0AF 902DD8            MOV      DPTR,#the_tx_session+04AH
B3:00C0B2         ?L?COM00C2:
B3:00C0B2 E0                MOVX     A,@DPTR
B3:00C0B3 FE                MOV      R6,A
B3:00C0B4 A3                INC      DPTR
B3:00C0B5 E0                MOVX     A,@DPTR
B3:00C0B6 FF                MOV      R7,A
B3:00C0B7 4E                ORL      A,R6
B3:00C0B8 22                RET      
----- FUNCTION ?L?COM00C1 (END) -------


----- FUNCTION _ZCB_fc_timer_expired (BEGIN) -----
B3:00C0B9 9031D2            MOV      DPTR,#scb+02CH
B3:00C0BC E0                MOVX     A,@DPTR
B3:00C0BD 601B              JZ       ?C0029?TRANSPORT_SERVICE2
B3:00C0BF 129C8D            LCALL    ?L?COM0364
B3:00C0C2 F0                MOVX     @DPTR,A
B3:00C0C3 E4                CLR      A
B3:00C0C4 9031D2            MOV      DPTR,#scb+02CH
B3:00C0C7 F0                MOVX     @DPTR,A
B3:00C0C8 90321F            MOV      DPTR,#scb+079H
B3:00C0CB F0                MOVX     @DPTR,A
B3:00C0CC 7F20              MOV      R7,#020H
B3:00C0CE 129C55            LCALL    _t2_sm_post_event
B3:00C0D1 9031B5            MOV      DPTR,#scb+0FH
B3:00C0D4 11B2              ACALL    ?L?COM00C2
B3:00C0D6 603C              JZ       ?C0031?TRANSPORT_SERVICE2
B3:00C0D8 800C              SJMP     ?C0206?TRANSPORT_SERVICE2
B3:00C0DA         ?C0029?TRANSPORT_SERVICE2:
B3:00C0DA 9190              ACALL    ?L?COM049E
B3:00C0DC B5070C            CJNE     A,AR7,?C0032?TRANSPORT_SERVICE2
B3:00C0DF 9031B5            MOV      DPTR,#scb+0FH
B3:00C0E2 11B2              ACALL    ?L?COM00C2
B3:00C0E4 602E              JZ       ?C0031?TRANSPORT_SERVICE2
B3:00C0E6         
B3:00C0E6 516A              ACALL    ?L?COM0267
B3:00C0E8 0226E3            LJMP     ?C?ICALL2
B3:00C0EB         ?C0032?TRANSPORT_SERVICE2:
B3:00C0EB 90321E            MOV      DPTR,#scb+078H
B3:00C0EE E0                MOVX     A,@DPTR
B3:00C0EF 6015              JZ       ?C0034?TRANSPORT_SERVICE2
B3:00C0F1 E4                CLR      A
B3:00C0F2 F0                MOVX     @DPTR,A
B3:00C0F3 A3                INC      DPTR
B3:00C0F4 F0                MOVX     @DPTR,A
B3:00C0F5 9031B5            MOV      DPTR,#scb+0FH
B3:00C0F8 11B2              ACALL    ?L?COM00C2
B3:00C0FA 6005              JZ       ?C0035?TRANSPORT_SERVICE2
B3:00C0FC 516A              ACALL    ?L?COM0267
B3:00C0FE 1226E3            LCALL    ?C?ICALL2
B3:00C101         ?C0035?TRANSPORT_SERVICE2:
B3:00C101 7F1F              MOV      R7,#01FH
B3:00C103 029C55            LJMP     _t2_sm_post_event
B3:00C106         ?C0034?TRANSPORT_SERVICE2:
B3:00C106 7F1E              MOV      R7,#01EH
B3:00C108 129C55            LCALL    _t2_sm_post_event
B3:00C10B 90321E            MOV      DPTR,#scb+078H
B3:00C10E E0                MOVX     A,@DPTR
B3:00C10F 04                INC      A
B3:00C110 F0                MOVX     @DPTR,A
B3:00C111 12B4E4            LCALL    send_last_frag
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 839


B3:00C114         ?C0031?TRANSPORT_SERVICE2:
B3:00C114 22                RET      
----- FUNCTION _ZCB_fc_timer_expired (END) -------


----- FUNCTION _ZW_firmwareUpdate_NVM_UpdateCRC16 (BEGIN) -----
B3:00C115 903AD3            MOV      DPTR,#crc
B3:00C118 123C23            LCALL    ?L?COM0146
B3:00C11B 122462            LCALL    ?C?LLDXDATA
B3:00C11E 903ADB            MOV      DPTR,#i
B3:00C121 1224BA            LCALL    ?C?LSTXDATA
B3:00C124 903AD9            MOV      DPTR,#blockSize
B3:00C127 E0                MOVX     A,@DPTR
B3:00C128 FF                MOV      R7,A
B3:00C129 A3                INC      DPTR
B3:00C12A E0                MOVX     A,@DPTR
B3:00C12B 903ADF            MOV      DPTR,#blockLength
B3:00C12E CF                XCH      A,R7
B3:00C12F 8066              SJMP     ?C0015?ZW_FIRMWARE_UPDATE_NVM
B3:00C131         ?C0007?ZW_FIRMWARE_UPDATE_NVM:
B3:00C131 903ADF            MOV      DPTR,#blockLength
B3:00C134 11B2              ACALL    ?L?COM00C2
B3:00C136 6065              JZ       ?C0008?ZW_FIRMWARE_UPDATE_NVM
B3:00C138 C3                CLR      C
B3:00C139 EF                MOV      A,R7
B3:00C13A 9440              SUBB     A,#040H
B3:00C13C EE                MOV      A,R6
B3:00C13D 9400              SUBB     A,#00H
B3:00C13F 4006              JC       ?C0009?ZW_FIRMWARE_UPDATE_NVM
B3:00C141 A3                INC      DPTR
B3:00C142 7440              MOV      A,#040H
B3:00C144 F0                MOVX     @DPTR,A
B3:00C145 8005              SJMP     ?C0010?ZW_FIRMWARE_UPDATE_NVM
B3:00C147         ?C0009?ZW_FIRMWARE_UPDATE_NVM:
B3:00C147 903AE1            MOV      DPTR,#bytesToRead
B3:00C14A EF                MOV      A,R7
B3:00C14B F0                MOVX     @DPTR,A
B3:00C14C         ?C0010?ZW_FIRMWARE_UPDATE_NVM:
B3:00C14C 7B01              MOV      R3,#01H
B3:00C14E 5162              ACALL    ?L?COM052E
B3:00C150 E0                MOVX     A,@DPTR
B3:00C151 9042AE            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00C154 126FE3            LCALL    ?L?COM046C
B3:00C157 903ADB            MOV      DPTR,#i
B3:00C15A 122462            LCALL    ?C?LLDXDATA
B3:00C15D 123817            LCALL    _NVM_ext_read_long_buffer
B3:00C160 903AE1            MOV      DPTR,#bytesToRead
B3:00C163 E0                MOVX     A,@DPTR
B3:00C164 FF                MOV      R7,A
B3:00C165 C3                CLR      C
B3:00C166 903AE0            MOV      DPTR,#blockLength+01H
B3:00C169 E0                MOVX     A,@DPTR
B3:00C16A 9F                SUBB     A,R7
B3:00C16B F0                MOVX     @DPTR,A
B3:00C16C 903ADF            MOV      DPTR,#blockLength
B3:00C16F E0                MOVX     A,@DPTR
B3:00C170 9400              SUBB     A,#00H
B3:00C172 F0                MOVX     @DPTR,A
B3:00C173 903ADB            MOV      DPTR,#i
B3:00C176 12247E            LCALL    ?C?LLDXDATA0
B3:00C179 903AE1            MOV      DPTR,#bytesToRead
B3:00C17C 127065            LCALL    ?L?COM0544
B3:00C17F 903ADB            MOV      DPTR,#i
B3:00C182 1224BA            LCALL    ?C?LSTXDATA
B3:00C185 903AD3            MOV      DPTR,#crc
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 840


B3:00C188 126F7C            LCALL    ?L?COM0406
B3:00C18B 5162              ACALL    ?L?COM052E
B3:00C18D 12BF5F            LCALL    ?L?COM0288
B3:00C190 12BEDB            LCALL    _ZW_CheckCrc16
B3:00C193 903AD3            MOV      DPTR,#crc
B3:00C196 EE                MOV      A,R6
B3:00C197         
B3:00C197 F0                MOVX     @DPTR,A
B3:00C198 A3                INC      DPTR
B3:00C199 EF                MOV      A,R7
B3:00C19A F0                MOVX     @DPTR,A
B3:00C19B 8094              SJMP     ?C0007?ZW_FIRMWARE_UPDATE_NVM
B3:00C19D         ?C0008?ZW_FIRMWARE_UPDATE_NVM:
B3:00C19D 903AD3            MOV      DPTR,#crc
B3:00C1A0 E0                MOVX     A,@DPTR
B3:00C1A1 FE                MOV      R6,A
B3:00C1A2 A3                INC      DPTR
B3:00C1A3 E0                MOVX     A,@DPTR
B3:00C1A4 FF                MOV      R7,A
B3:00C1A5 22                RET      
----- FUNCTION _ZW_firmwareUpdate_NVM_UpdateCRC16 (END) -------


----- FUNCTION check_compressed_crc (BEGIN) -----
B3:00C1A6 5156              ACALL    ?L?COM02D4
B3:00C1A8 515C              ACALL    ?L?COM034D
B3:00C1AA 903AD9            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00C1AD 126FDC            LCALL    ?L?COM0466
B3:00C1B0 7F0F              MOV      R7,#0FH
B3:00C1B2 7E1D              MOV      R6,#01DH
B3:00C1B4 514B              ACALL    ?L?COM0255
B3:00C1B6 C006              PUSH     AR6
B3:00C1B8 C007              PUSH     AR7
B3:00C1BA 5156              ACALL    ?L?COM02D4
B3:00C1BC EF                MOV      A,R7
B3:00C1BD 2407              ADD      A,#07H
B3:00C1BF 124DBF            LCALL    ?L?COM0044
B3:00C1C2 515C              ACALL    ?L?COM034D
B3:00C1C4 903AD9            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00C1C7 E4                CLR      A
B3:00C1C8 F0                MOVX     @DPTR,A
B3:00C1C9 A3                INC      DPTR
B3:00C1CA 7414              MOV      A,#014H
B3:00C1CC F0                MOVX     @DPTR,A
B3:00C1CD D007              POP      AR7
B3:00C1CF D006              POP      AR6
B3:00C1D1 514B              ACALL    ?L?COM0255
B3:00C1D3 C006              PUSH     AR6
B3:00C1D5 C007              PUSH     AR7
B3:00C1D7 5156              ACALL    ?L?COM02D4
B3:00C1D9 EF                MOV      A,R7
B3:00C1DA 241B              ADD      A,#01BH
B3:00C1DC 124DBF            LCALL    ?L?COM0044
B3:00C1DF 515C              ACALL    ?L?COM034D
B3:00C1E1 5177              ACALL    ?L?COM01EA
B3:00C1E3 4006              JC       ?C0001?OTZ_CHECK_COMPRESSED_CRC
B3:00C1E5 7EFF              MOV      R6,#0FFH
B3:00C1E7 7FFF              MOV      R7,#0FFH
B3:00C1E9 8006              SJMP     ?C0002?OTZ_CHECK_COMPRESSED_CRC
B3:00C1EB         ?C0001?OTZ_CHECK_COMPRESSED_CRC:
B3:00C1EB 903CD4            MOV      DPTR,#compressionHdr+01H
B3:00C1EE 122462            LCALL    ?C?LLDXDATA
B3:00C1F1         ?C0002?OTZ_CHECK_COMPRESSED_CRC:
B3:00C1F1 903AD9            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00C1F4 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 841


B3:00C1F5 F0                MOVX     @DPTR,A
B3:00C1F6 A3                INC      DPTR
B3:00C1F7 EF                MOV      A,R7
B3:00C1F8 F0                MOVX     @DPTR,A
B3:00C1F9 D007              POP      AR7
B3:00C1FB D006              POP      AR6
B3:00C1FD 514B              ACALL    ?L?COM0255
B3:00C1FF 5177              ACALL    ?L?COM01EA
B3:00C201 402F              JC       ?C0003?OTZ_CHECK_COMPRESSED_CRC
B3:00C203 5156              ACALL    ?L?COM02D4
B3:00C205 EF                MOV      A,R7
B3:00C206 241A              ADD      A,#01AH
B3:00C208 FF                MOV      R7,A
B3:00C209 E4                CLR      A
B3:00C20A 3E                ADDC     A,R6
B3:00C20B FE                MOV      R6,A
B3:00C20C ED                MOV      A,R5
B3:00C20D 3401              ADDC     A,#01H
B3:00C20F FD                MOV      R5,A
B3:00C210 E4                CLR      A
B3:00C211 3C                ADDC     A,R4
B3:00C212 FC                MOV      R4,A
B3:00C213 515C              ACALL    ?L?COM034D
B3:00C215 903CD4            MOV      DPTR,#compressionHdr+01H
B3:00C218 122462            LCALL    ?C?LLDXDATA
B3:00C21B EF                MOV      A,R7
B3:00C21C 2401              ADD      A,#01H
B3:00C21E FF                MOV      R7,A
B3:00C21F E4                CLR      A
B3:00C220 3E                ADDC     A,R6
B3:00C221 903AD9            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+06H
B3:00C224 F0                MOVX     @DPTR,A
B3:00C225 A3                INC      DPTR
B3:00C226 EF                MOV      A,R7
B3:00C227 F0                MOVX     @DPTR,A
B3:00C228 904697            MOV      DPTR,#tempCRC
B3:00C22B E0                MOVX     A,@DPTR
B3:00C22C FE                MOV      R6,A
B3:00C22D A3                INC      DPTR
B3:00C22E E0                MOVX     A,@DPTR
B3:00C22F FF                MOV      R7,A
B3:00C230 514B              ACALL    ?L?COM0255
B3:00C232         ?C0003?OTZ_CHECK_COMPRESSED_CRC:
B3:00C232 903CD8            MOV      DPTR,#compressionHdr+05H
B3:00C235 E0                MOVX     A,@DPTR
B3:00C236 FE                MOV      R6,A
B3:00C237 A3                INC      DPTR
B3:00C238 E0                MOVX     A,@DPTR
B3:00C239 FF                MOV      R7,A
B3:00C23A 904697            MOV      DPTR,#tempCRC
B3:00C23D E0                MOVX     A,@DPTR
B3:00C23E 6E                XRL      A,R6
B3:00C23F 7003              JNZ      ?C0006?OTZ_CHECK_COMPRESSED_CRC
B3:00C241 A3                INC      DPTR
B3:00C242 E0                MOVX     A,@DPTR
B3:00C243 6F                XRL      A,R7
B3:00C244         ?C0006?OTZ_CHECK_COMPRESSED_CRC:
B3:00C244 7F00              MOV      R7,#00H
B3:00C246 6002              JZ       ?C0004?OTZ_CHECK_COMPRESSED_CRC
B3:00C248 7FFF              MOV      R7,#0FFH
B3:00C24A         ?C0004?OTZ_CHECK_COMPRESSED_CRC:
B3:00C24A 22                RET      
----- FUNCTION check_compressed_crc (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 842


----- FUNCTION ?L?COM0255 (BEGIN) -----
B3:00C24B 3115              ACALL    _ZW_firmwareUpdate_NVM_UpdateCRC16
B3:00C24D 904697            MOV      DPTR,#tempCRC
B3:00C250 EE                MOV      A,R6
B3:00C251 F0                MOVX     @DPTR,A
B3:00C252 A3                INC      DPTR
B3:00C253 EF                MOV      A,R7
B3:00C254 F0                MOVX     @DPTR,A
B3:00C255 22                RET      
----- FUNCTION ?L?COM0255 (END) -------


----- FUNCTION ?L?COM02D4 (BEGIN) -----
B3:00C256 903CEE            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00C259 022462            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM02D4 (END) -------


----- FUNCTION ?L?COM034D (BEGIN) -----
B3:00C25C 903AD5            MOV      DPTR,#?_ZW_firmwareUpdate_NVM_UpdateCRC16?BYTE+02H
B3:00C25F 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM034D (END) -------


----- FUNCTION ?L?COM052E (BEGIN) -----
B3:00C262 7A3A              MOV      R2,#HIGH dataBuffer
B3:00C264 79E2              MOV      R1,#LOW dataBuffer
B3:00C266 903AE1            MOV      DPTR,#bytesToRead
B3:00C269 22                RET      
----- FUNCTION ?L?COM052E (END) -------


----- FUNCTION ?L?COM0267 (BEGIN) -----
B3:00C26A 7B01              MOV      R3,#01H
B3:00C26C 7A31              MOV      R2,#HIGH scb+011H
B3:00C26E 79B7              MOV      R1,#LOW scb+011H
B3:00C270         ?L?COM0268:
B3:00C270 8F82              MOV      DPL,R7
B3:00C272 8E83              MOV      DPH,R6
B3:00C274 7F02              MOV      R7,#02H
B3:00C276 22                RET      
----- FUNCTION ?L?COM0267 (END) -------


----- FUNCTION ?L?COM01EA (BEGIN) -----
B3:00C277 E4                CLR      A
B3:00C278 7FFF              MOV      R7,#0FFH
B3:00C27A 7EFF              MOV      R6,#0FFH
B3:00C27C FD                MOV      R5,A
B3:00C27D FC                MOV      R4,A
B3:00C27E 903CD4            MOV      DPTR,#compressionHdr+01H
B3:00C281 12247E            LCALL    ?C?LLDXDATA0
B3:00C284 D3                SETB     C
B3:00C285 02239D            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM01EA (END) -------


----- FUNCTION ___S2_send_done_event (BEGIN) -----
B3:00C288 9046B0            MOV      DPTR,#status
B3:00C28B EF                MOV      A,R7
B3:00C28C F0                MOVX     @DPTR,A
B3:00C28D 903CB2            MOV      DPTR,#s2_send_multi_callback
B3:00C290 11B2              ACALL    ?L?COM00C2
B3:00C292 6037              JZ       ?C0008?ZW_SECURITY_SCHEME2
B3:00C294 903CB7            MOV      DPTR,#cb_multi_save
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 843


B3:00C297 1263EA            LCALL    ?L?COM03AD
B3:00C29A 903CB2            MOV      DPTR,#s2_send_multi_callback
B3:00C29D F0                MOVX     @DPTR,A
B3:00C29E A3                INC      DPTR
B3:00C29F F0                MOVX     @DPTR,A
B3:00C2A0 9046B0            MOV      DPTR,#status
B3:00C2A3 E0                MOVX     A,@DPTR
B3:00C2A4 B4021A            CJNE     A,#02H,?C0009?ZW_SECURITY_SCHEME2
B3:00C2A7 903CB9            MOV      DPTR,#delayed_callback
B3:00C2AA 7401              MOV      A,#01H
B3:00C2AC F0                MOVX     @DPTR,A
B3:00C2AD 903CB7            MOV      DPTR,#cb_multi_save
B3:00C2B0 E0                MOVX     A,@DPTR
B3:00C2B1 FF                MOV      R7,A
B3:00C2B2 A3                INC      DPTR
B3:00C2B3 E0                MOVX     A,@DPTR
B3:00C2B4 903CBA            MOV      DPTR,#delayed_callback+01H
B3:00C2B7 CF                XCH      A,R7
B3:00C2B8 12579C            LCALL    ?L?COM02AC
B3:00C2BB EF                MOV      A,R7
B3:00C2BC F4                CPL      A
B3:00C2BD 703D              JNZ      ?C0012?ZW_SECURITY_SCHEME2
B3:00C2BF 8025              SJMP     ?C0052?ZW_SECURITY_SCHEME2
B3:00C2C1         ?C0009?ZW_SECURITY_SCHEME2:
B3:00C2C1 9046B0            MOV      DPTR,#status
B3:00C2C4 E0                MOVX     A,@DPTR
B3:00C2C5 FF                MOV      R7,A
B3:00C2C6 903CB7            MOV      DPTR,#cb_multi_save
B3:00C2C9 802B              SJMP     ?C0053?ZW_SECURITY_SCHEME2
B3:00C2CB         ?C0008?ZW_SECURITY_SCHEME2:
B3:00C2CB 903CB0            MOV      DPTR,#s2_send_callback
B3:00C2CE 11B2              ACALL    ?L?COM00C2
B3:00C2D0 602A              JZ       ?C0012?ZW_SECURITY_SCHEME2
B3:00C2D2 9046B0            MOV      DPTR,#status
B3:00C2D5 E0                MOVX     A,@DPTR
B3:00C2D6 B4020F            CJNE     A,#02H,?C0015?ZW_SECURITY_SCHEME2
B3:00C2D9 E4                CLR      A
B3:00C2DA 903CB9            MOV      DPTR,#delayed_callback
B3:00C2DD F0                MOVX     @DPTR,A
B3:00C2DE A3                INC      DPTR
B3:00C2DF EE                MOV      A,R6
B3:00C2E0 12579C            LCALL    ?L?COM02AC
B3:00C2E3 BFFF16            CJNE     R7,#0FFH,?C0012?ZW_SECURITY_SCHEME2
B3:00C2E6         
B3:00C2E6 8015              SJMP     ZCB_delayed_send_callback
B3:00C2E8         ?C0015?ZW_SECURITY_SCHEME2:
B3:00C2E8 9046B0            MOV      DPTR,#status
B3:00C2EB E0                MOVX     A,@DPTR
B3:00C2EC FF                MOV      R7,A
B3:00C2ED 7B01              MOV      R3,#01H
B3:00C2EF 7A3C              MOV      R2,#HIGH sExtendedTxStatusS2
B3:00C2F1 798D              MOV      R1,#LOW sExtendedTxStatusS2
B3:00C2F3 903CB0            MOV      DPTR,#s2_send_callback
B3:00C2F6         
B3:00C2F6 126E13            LCALL    ?L?COM01A3
B3:00C2F9 1226E3            LCALL    ?C?ICALL2
B3:00C2FC         ?C0012?ZW_SECURITY_SCHEME2:
B3:00C2FC 22                RET      
----- FUNCTION ___S2_send_done_event (END) -------


----- FUNCTION ZCB_delayed_send_callback (BEGIN) -----
B3:00C2FD 903CB9            MOV      DPTR,#delayed_callback
B3:00C300 E0                MOVX     A,@DPTR
B3:00C301 B40103            CJNE     A,#01H,?C0049?ZW_SECURITY_SCHEME2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 844


B3:00C304 A3                INC      DPTR
B3:00C305 8009              SJMP     ?C0054?ZW_SECURITY_SCHEME2
B3:00C307         ?C0049?ZW_SECURITY_SCHEME2:
B3:00C307 7B01              MOV      R3,#01H
B3:00C309 7A3C              MOV      R2,#HIGH sExtendedTxStatusS2
B3:00C30B 798D              MOV      R1,#LOW sExtendedTxStatusS2
B3:00C30D 903CBA            MOV      DPTR,#delayed_callback+01H
B3:00C310         
B3:;----                  JMP      ?L?COM0387
----- FUNCTION ZCB_delayed_send_callback (END) -------


----- FUNCTION ?L?COM0387 (BEGIN) -----
B3:00C310 E0                MOVX     A,@DPTR
B3:00C311 FE                MOV      R6,A
B3:00C312 A3                INC      DPTR
B3:00C313 E0                MOVX     A,@DPTR
B3:00C314 F582              MOV      DPL,A
B3:00C316 8E83              MOV      DPH,R6
B3:00C318 7F02              MOV      R7,#02H
B3:00C31A 0226E3            LJMP     ?C?ICALL2
----- FUNCTION ?L?COM0387 (END) -------


----- FUNCTION TransportTimerPoll (BEGIN) -----
B3:00C31D 302514            JNB      slow_timer_running,?C0015?ZW_TRANSPORT_TIMER
B3:00C320 E57E              MOV      A,slow_timer_count
B3:00C322 6010              JZ       ?C0015?ZW_TRANSPORT_TIMER
B3:00C324 157E              DEC      slow_timer_count
B3:00C326 90468B            MOV      DPTR,#Func
B3:00C329 11B2              ACALL    ?L?COM00C2
B3:00C32B 6007              JZ       ?C0015?ZW_TRANSPORT_TIMER
B3:00C32D AA06              MOV      R2,AR6
B3:00C32F A907              MOV      R1,AR7
B3:00C331 1226DF            LCALL    ?C?ICALL
B3:00C334         ?C0015?ZW_TRANSPORT_TIMER:
B3:00C334 22                RET      
----- FUNCTION TransportTimerPoll (END) -------


----- FUNCTION ZW_FirmwareUpdate_NVM_isValidCRC16 (BEGIN) -----
B3:00C335 5156              ACALL    ?L?COM02D4
B3:00C337 7B01              MOV      R3,#01H
B3:00C339 7A3C              MOV      R2,#HIGH compressionHdr
B3:00C33B 79D3              MOV      R1,#LOW compressionHdr
B3:00C33D 9042AE            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00C340 E4                CLR      A
B3:00C341 F0                MOVX     @DPTR,A
B3:00C342 A3                INC      DPTR
B3:00C343 741B              MOV      A,#01BH
B3:00C345 F0                MOVX     @DPTR,A
B3:00C346 123817            LCALL    _NVM_ext_read_long_buffer
B3:00C349 31A6              ACALL    check_compressed_crc
B3:00C34B EF                MOV      A,R7
B3:00C34C C3                CLR      C
B3:00C34D 7001              JNZ      ?C0012?ZW_FIRMWARE_UPDATE_NVM
B3:00C34F D3                SETB     C
B3:00C350         ?C0012?ZW_FIRMWARE_UPDATE_NVM:
B3:00C350 22                RET      
----- FUNCTION ZW_FirmwareUpdate_NVM_isValidCRC16 (END) -------


----- FUNCTION ___S2_post_send_done_event (BEGIN) -----
B3:00C351 9046B9            MOV      DPTR,#status
B3:00C354 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 845


B3:00C355 F0                MOVX     @DPTR,A
B3:00C356 9145              ACALL    ?L?COM02DF
B3:00C358 6004              JZ       ?C0199?S2
B3:00C35A E0                MOVX     A,@DPTR
B3:00C35B B40504            CJNE     A,#05H,?C0197?S2
B3:00C35E         ?C0199?S2:
B3:00C35E 7D01              MOV      R5,#01H
B3:00C360 8002              SJMP     ?C0198?S2
B3:00C362         ?C0197?S2:
B3:00C362 7D00              MOV      R5,#00H
B3:00C364         ?C0198?S2:
B3:00C364 12EA03            LCALL    _s2_inclusion_send_done
B3:00C367 9046B9            MOV      DPTR,#status
B3:00C36A E0                MOVX     A,@DPTR
B3:00C36B FF                MOV      R7,A
B3:00C36C 4188              AJMP     ___S2_send_done_event
----- FUNCTION ___S2_post_send_done_event (END) -------


----- FUNCTION NWIStartTimer (BEGIN) -----
B3:00C36E 904580            MOV      DPTR,#timeoutNWIInMin
B3:00C371 E0                MOVX     A,@DPTR
B3:00C372 75F018            MOV      B,#018H
B3:00C375 A4                MUL      AB
B3:00C376 FF                MOV      R7,A
B3:00C377 90457E            MOV      DPTR,#timeoutNWICount
B3:00C37A 12ABEE            LCALL    ?L?COM0067
B3:00C37D 7B01              MOV      R3,#01H
B3:00C37F 7A45              MOV      R2,#HIGH networkWideInclusionModeTimer
B3:00C381 7981              MOV      R1,#LOW networkWideInclusionModeTimer
B3:00C383 7C1B              MOV      R4,#HIGH ?INTERBANK_TABLE?ZCB_NWITimeout
B3:00C385 7DE2              MOV      R5,#LOW ?INTERBANK_TABLE?ZCB_NWITimeout
B3:00C387 9043DE            MOV      DPTR,#?_SafeTimerSysStart?BYTE+05H
B3:00C38A 74FA              MOV      A,#0FAH
B3:00C38C F0                MOVX     @DPTR,A
B3:00C38D A3                INC      DPTR
B3:00C38E 74FF              MOV      A,#0FFH
B3:00C390 F0                MOVX     @DPTR,A
B3:00C391 02541C            LJMP     _SafeTimerSysStart
----- FUNCTION NWIStartTimer (END) -------


----- FUNCTION _ZW_FirmwareUpdate_NVM_Set_NEWIMAGE (BEGIN) -----
B3:00C394 904695            MOV      DPTR,#bValue
B3:00C397 EF                MOV      A,R7
B3:00C398 F0                MOVX     @DPTR,A
B3:00C399 E4                CLR      A
B3:00C39A A3                INC      DPTR
B3:00C39B F0                MOVX     @DPTR,A
B3:00C39C 903CF2            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00C39F E0                MOVX     A,@DPTR
B3:00C3A0 6025              JZ       ?C0004?ZW_FIRMWARE_UPDATE_NVM
B3:00C3A2 904695            MOV      DPTR,#bValue
B3:00C3A5 E0                MOVX     A,@DPTR
B3:00C3A6 B4010B            CJNE     A,#01H,?C0005?ZW_FIRMWARE_UPDATE_NVM
B3:00C3A9 5156              ACALL    ?L?COM02D4
B3:00C3AB EF                MOV      A,R7
B3:00C3AC 2409              ADD      A,#09H
B3:00C3AE 124DBF            LCALL    ?L?COM0044
B3:00C3B1 121B10            LCALL    ?INTERBANK_TABLE?_ZW_KeystoreNvmUpdate
B3:00C3B4         ?C0005?ZW_FIRMWARE_UPDATE_NVM:
B3:00C3B4 B103              ACALL    ?L?COM01A0
B3:00C3B6 904695            MOV      DPTR,#bValue
B3:00C3B9 E0                MOVX     A,@DPTR
B3:00C3BA 9044FF            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 846


B3:00C3BD F0                MOVX     @DPTR,A
B3:00C3BE 1236CE            LCALL    _NVM_ext_write_long_byte
B3:00C3C1 E4                CLR      A
B3:00C3C2 33                RLC      A
B3:00C3C3 904696            MOV      DPTR,#retVal
B3:00C3C6 F0                MOVX     @DPTR,A
B3:00C3C7         ?C0004?ZW_FIRMWARE_UPDATE_NVM:
B3:00C3C7 904696            MOV      DPTR,#retVal
B3:00C3CA E0                MOVX     A,@DPTR
B3:00C3CB FF                MOV      R7,A
B3:00C3CC 22                RET      
----- FUNCTION _ZW_FirmwareUpdate_NVM_Set_NEWIMAGE (END) -------


----- FUNCTION ?L?COM0216 (BEGIN) -----
B3:00C3CD 7A2A              MOV      R2,#HIGH the_context+02EFH
B3:00C3CF 79F3              MOV      R1,#LOW the_context+02EFH
B3:00C3D1 904121            MOV      DPTR,#?___S2_send_data?BYTE+03H
B3:00C3D4 122572            LCALL    ?C?PSTXDATA
B3:00C3D7 902B1B            MOV      DPTR,#the_context+0317H
B3:00C3DA E0                MOVX     A,@DPTR
B3:00C3DB FF                MOV      R7,A
B3:00C3DC 904124            MOV      DPTR,#?___S2_send_data?BYTE+06H
B3:00C3DF E4                CLR      A
B3:00C3E0 F0                MOVX     @DPTR,A
B3:00C3E1 A3                INC      DPTR
B3:00C3E2 EF                MOV      A,R7
B3:00C3E3 F0                MOVX     @DPTR,A
B3:00C3E4 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00C3E6 79D3              MOV      R1,#LOW the_context+0CFH
----- FUNCTION ___S2_send_data (BEGIN) -----
B3:00C3E8 90411E            MOV      DPTR,#dst
B3:00C3EB 122572            LCALL    ?C?PSTXDATA
B3:00C3EE 904124            MOV      DPTR,#len
B3:00C3F1 11B2              ACALL    ?L?COM00C2
B3:00C3F3 6018              JZ       ?C0163?S2
B3:00C3F5 D3                SETB     C
B3:00C3F6 EF                MOV      A,R7
B3:00C3F7 9400              SUBB     A,#00H
B3:00C3F9 EE                MOV      A,R6
B3:00C3FA 9405              SUBB     A,#05H
B3:00C3FC 500F              JNC      ?C0163?S2
B3:00C3FE 904121            MOV      DPTR,#buf
B3:00C401 122552            LCALL    ?C?PLDXDATA
B3:00C404 E9                MOV      A,R1
B3:00C405 4A                ORL      A,R2
B3:00C406 6005              JZ       ?C0163?S2
B3:00C408 91F2              ACALL    __S2_is_send_data_busy
B3:00C40A EF                MOV      A,R7
B3:00C40B 6003              JZ       ?C0162?S2
B3:00C40D         ?C0163?S2:
B3:00C40D 7F00              MOV      R7,#00H
B3:00C40F 22                RET      
B3:00C410         ?C0162?S2:
B3:00C410 904121            MOV      DPTR,#buf
B3:00C413 122552            LCALL    ?C?PLDXDATA
B3:00C416 904129            MOV      DPTR,#d+03H
B3:00C419 122572            LCALL    ?C?PSTXDATA
B3:00C41C 904124            MOV      DPTR,#len
B3:00C41F E0                MOVX     A,@DPTR
B3:00C420 FF                MOV      R7,A
B3:00C421 A3                INC      DPTR
B3:00C422 E0                MOVX     A,@DPTR
B3:00C423 90412C            MOV      DPTR,#d+06H
B3:00C426 CF                XCH      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 847


B3:00C427 F0                MOVX     @DPTR,A
B3:00C428 A3                INC      DPTR
B3:00C429 EF                MOV      A,R7
B3:00C42A F0                MOVX     @DPTR,A
B3:00C42B 90411E            MOV      DPTR,#dst
B3:00C42E 122552            LCALL    ?C?PLDXDATA
B3:00C431 904126            MOV      DPTR,#d
B3:00C434 122572            LCALL    ?C?PSTXDATA
B3:00C437 7B01              MOV      R3,#01H
B3:00C439 7A41              MOV      R2,#HIGH d
B3:00C43B 7926              MOV      R1,#LOW d
B3:00C43D E4                CLR      A
B3:00C43E FF                MOV      R7,A
B3:00C43F 128CD5            LCALL    ___S2_fsm_post_event
B3:00C442 7F01              MOV      R7,#01H
B3:00C444 22                RET      
----- FUNCTION ___S2_send_data (END) -------


----- FUNCTION ?L?COM02DF (BEGIN) -----
B3:00C445 7B01              MOV      R3,#01H
B3:00C447 7A28              MOV      R2,#HIGH the_context
B3:00C449 7904              MOV      R1,#LOW the_context
B3:00C44B 22                RET      
----- FUNCTION ?L?COM02DF (END) -------


----- FUNCTION ?L?COM0572 (BEGIN) -----
B3:00C44C 7401              MOV      A,#01H
B3:00C44E 29                ADD      A,R1
B3:00C44F F9                MOV      R1,A
B3:00C450 E4                CLR      A
B3:00C451 3A                ADDC     A,R2
B3:00C452 FA                MOV      R2,A
B3:00C453 22                RET      
----- FUNCTION ?L?COM0572 (END) -------


----- FUNCTION _ZW_NodeMaskNodeIn (BEGIN) -----
;---- Variable 'bNode' assigned to Register 'R5' ----
;---- Variable 'pMask' assigned to Register 'R1/R2/R3' ----
B3:00C454 1168              ACALL    ?L?COM041D
B3:00C456 F582              MOV      DPL,A
B3:00C458 12A72F            LCALL    ?L?COM00BD
B3:00C45B FF                MOV      R7,A
B3:00C45C ED                MOV      A,R5
B3:00C45D 5407              ANL      A,#07H
B3:00C45F FE                MOV      R6,A
B3:00C460 EF                MOV      A,R7
B3:00C461 A806              MOV      R0,AR6
B3:00C463 08                INC      R0
B3:00C464 8002              SJMP     ?C0027?ZW_NODEMASK
B3:00C466         ?C0026?ZW_NODEMASK:
B3:00C466 C3                CLR      C
B3:00C467 13                RRC      A
B3:00C468         ?C0027?ZW_NODEMASK:
B3:00C468 D8FC              DJNZ     R0,?C0026?ZW_NODEMASK
B3:00C46A 5401              ANL      A,#01H
B3:00C46C FF                MOV      R7,A
B3:00C46D 22                RET      
----- FUNCTION _ZW_NodeMaskNodeIn (END) -------


----- FUNCTION ?L?COM00D6 (BEGIN) -----
B3:00C46E 7B01              MOV      R3,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 848


B3:00C470 7A37              MOV      R2,#HIGH s_nonce
B3:00C472 793E              MOV      R1,#LOW s_nonce
B3:00C474 90394A            MOV      DPTR,#?_next_nonce_instantiate?BYTE+03H
B3:00C477 122572            LCALL    ?C?PSTXDATA
B3:00C47A 7A37              MOV      R2,#HIGH r_nonce
B3:00C47C 792E              MOV      R1,#LOW r_nonce
B3:00C47E 90394D            MOV      DPTR,#?_next_nonce_instantiate?BYTE+06H
B3:00C481 122572            LCALL    ?C?PSTXDATA
B3:00C484         ?L?COM00D7:
B3:00C484 903728            MOV      DPTR,#span
B3:00C487         ?L?COM00D8:
B3:00C487 122552            LCALL    ?C?PLDXDATA
B3:00C48A         ?L?COM00D9:
B3:00C48A 900025            MOV      DPTR,#025H
B3:00C48D 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM00D6 (END) -------


----- FUNCTION ?L?COM049E (BEGIN) -----
B3:00C490 9031CA            MOV      DPTR,#scb+024H
B3:00C493 E0                MOVX     A,@DPTR
B3:00C494 FF                MOV      R7,A
B3:00C495 9031D3            MOV      DPTR,#scb+02DH
B3:00C498 E0                MOVX     A,@DPTR
B3:00C499 22                RET      
----- FUNCTION ?L?COM049E (END) -------


----- FUNCTION _EventPush (BEGIN) -----
;---- Variable 'bStatus' assigned to Register 'R5' ----
;---- Variable 'bEvent' assigned to Register 'R7' ----
B3:00C49A 904518            MOV      DPTR,#eventQueueCount
B3:00C49D E0                MOVX     A,@DPTR
B3:00C49E FE                MOV      R6,A
B3:00C49F C3                CLR      C
B3:00C4A0 9402              SUBB     A,#02H
B3:00C4A2 5027              JNC      ?C0001?ZW_EVENT
B3:00C4A4 EE                MOV      A,R6
B3:00C4A5 25E0              ADD      A,ACC
B3:00C4A7 2414              ADD      A,#LOW eventQueue
B3:00C4A9 F582              MOV      DPL,A
B3:00C4AB E4                CLR      A
B3:00C4AC 3445              ADDC     A,#HIGH eventQueue
B3:00C4AE F583              MOV      DPH,A
B3:00C4B0 EF                MOV      A,R7
B3:00C4B1 F0                MOVX     @DPTR,A
B3:00C4B2 AF05              MOV      R7,AR5
B3:00C4B4 904518            MOV      DPTR,#eventQueueCount
B3:00C4B7 E0                MOVX     A,@DPTR
B3:00C4B8 FE                MOV      R6,A
B3:00C4B9 04                INC      A
B3:00C4BA F0                MOVX     @DPTR,A
B3:00C4BB EE                MOV      A,R6
B3:00C4BC 25E0              ADD      A,ACC
B3:00C4BE 2415              ADD      A,#LOW eventQueue+01H
B3:00C4C0 F582              MOV      DPL,A
B3:00C4C2 E4                CLR      A
B3:00C4C3 3445              ADDC     A,#HIGH eventQueue+01H
B3:00C4C5 F583              MOV      DPH,A
B3:00C4C7 EF                MOV      A,R7
B3:00C4C8 F0                MOVX     @DPTR,A
B3:00C4C9 D3                SETB     C
B3:00C4CA 22                RET      
B3:00C4CB         ?C0001?ZW_EVENT:
B3:00C4CB C3                CLR      C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 849


B3:00C4CC 22                RET      
----- FUNCTION _EventPush (END) -------


----- FUNCTION __S2_destroy (BEGIN) -----
B3:00C4CD 7E03              MOV      R6,#03H
B3:00C4CF 7F38              MOV      R7,#038H
B3:00C4D1 7D00              MOV      R5,#00H
B3:00C4D3 9145              ACALL    ?L?COM02DF
B3:00C4D5 0228E0            LJMP     ?C?MEMSET
----- FUNCTION __S2_destroy (END) -------


----- FUNCTION _ExploreSetNWITimeout (BEGIN) -----
;---- Variable 'timeout' assigned to Register 'R7' ----
B3:00C4D8 EF                MOV      A,R7
B3:00C4D9 7004              JNZ      ?C0005?ZW_EXPLORE_SUPPORT
B3:00C4DB 7F05              MOV      R7,#05H
B3:00C4DD 8000              SJMP     ?C0006?ZW_EXPLORE_SUPPORT
B3:00C4DF         ?C0005?ZW_EXPLORE_SUPPORT:
B3:00C4DF         ?C0006?ZW_EXPLORE_SUPPORT:
B3:00C4DF 904580            MOV      DPTR,#timeoutNWIInMin
B3:00C4E2 EF                MOV      A,R7
B3:00C4E3 F0                MOVX     @DPTR,A
B3:00C4E4 22                RET      
----- FUNCTION _ExploreSetNWITimeout (END) -------


----- FUNCTION ZCB_NWITimeout (BEGIN) -----
B3:00C4E5 90457E            MOV      DPTR,#timeoutNWICount
B3:00C4E8 126ED4            LCALL    ?L?COM0363
B3:00C4EB 7004              JNZ      ?C0003?ZW_EXPLORE_SUPPORT
B3:00C4ED C211              CLR      exploreInclusionModeRepeat
B3:00C4EF 1198              ACALL    NWIStopTimer
B3:00C4F1         ?C0003?ZW_EXPLORE_SUPPORT:
B3:00C4F1 22                RET      
----- FUNCTION ZCB_NWITimeout (END) -------


----- FUNCTION __S2_is_send_data_busy (BEGIN) -----
B3:00C4F2 902A11            MOV      DPTR,#the_context+020DH
B3:00C4F5 E0                MOVX     A,@DPTR
B3:00C4F6 6008              JZ       ?C0165?S2
B3:00C4F8 6405              XRL      A,#05H
B3:00C4FA 6004              JZ       ?C0165?S2
B3:00C4FC 7F01              MOV      R7,#01H
B3:00C4FE 8002              SJMP     ?C0166?S2
B3:00C500         ?C0165?S2:
B3:00C500 7F00              MOV      R7,#00H
B3:00C502         ?C0166?S2:
B3:00C502 22                RET      
----- FUNCTION __S2_is_send_data_busy (END) -------


----- FUNCTION ?L?COM01A0 (BEGIN) -----
B3:00C503 903CEE            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00C506         ?L?COM01A1:
B3:00C506 122462            LCALL    ?C?LLDXDATA
B3:00C509 EF                MOV      A,R7
B3:00C50A 24FF              ADD      A,#0FFH
B3:00C50C FF                MOV      R7,A
B3:00C50D EE                MOV      A,R6
B3:00C50E 34FF              ADDC     A,#0FFH
B3:00C510 FE                MOV      R6,A
B3:00C511 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 850


B3:00C512 34FF              ADDC     A,#0FFH
B3:00C514 FD                MOV      R5,A
B3:00C515 EC                MOV      A,R4
B3:00C516 34FF              ADDC     A,#0FFH
B3:00C518 FC                MOV      R4,A
B3:00C519 22                RET      
----- FUNCTION ?L?COM01A0 (END) -------


----- FUNCTION _ZCB_ExploreComplete (BEGIN) -----
B3:00C51A 900AA6            MOV      DPTR,#bTxStatus
B3:00C51D 126E8B            LCALL    ?L?COM02DB
B3:00C520 900AA7            MOV      DPTR,#pTxStatusReport
B3:00C523 122552            LCALL    ?C?PLDXDATA
B3:00C526 128549            LCALL    ?L?COM0019
B3:00C529 7B01              MOV      R3,#01H
B3:00C52B 7A08              MOV      R2,#HIGH currentTxStatusReport
B3:00C52D 799D              MOV      R1,#LOW currentTxStatusReport
B3:00C52F 7F13              MOV      R7,#013H
B3:00C531 128195            LCALL    ___ZW_memcpy
B3:00C534 900AA6            MOV      DPTR,#bTxStatus
B3:00C537 E0                MOVX     A,@DPTR
B3:00C538 FD                MOV      R5,A
B3:00C539 7F04              MOV      R7,#04H
B3:00C53B 819A              AJMP     _EventPush
----- FUNCTION _ZCB_ExploreComplete (END) -------


----- FUNCTION _EventPop (BEGIN) -----
B3:00C53D 9046A9            MOV      DPTR,#pbEvent
B3:00C540 EF                MOV      A,R7
B3:00C541 F0                MOVX     @DPTR,A
;---- Variable 'pbStatus' assigned to Register 'R5' ----
B3:00C542 904518            MOV      DPTR,#eventQueueCount
B3:00C545 E0                MOVX     A,@DPTR
B3:00C546 602D              JZ       ?C0003?ZW_EVENT
B3:00C548 904514            MOV      DPTR,#eventQueue
B3:00C54B E0                MOVX     A,@DPTR
B3:00C54C FF                MOV      R7,A
B3:00C54D 9046A9            MOV      DPTR,#pbEvent
B3:00C550 E0                MOVX     A,@DPTR
B3:00C551 F8                MOV      R0,A
B3:00C552 A607              MOV      @R0,AR7
B3:00C554 904515            MOV      DPTR,#eventQueue+01H
B3:00C557 E0                MOVX     A,@DPTR
B3:00C558 A805              MOV      R0,AR5
B3:00C55A F6                MOV      @R0,A
B3:00C55B 7B01              MOV      R3,#01H
B3:00C55D 7A45              MOV      R2,#HIGH eventQueue+02H
B3:00C55F 7916              MOV      R1,#LOW eventQueue+02H
B3:00C561 128549            LCALL    ?L?COM0019
B3:00C564 7A45              MOV      R2,#HIGH eventQueue
B3:00C566 7914              MOV      R1,#LOW eventQueue
B3:00C568 7F02              MOV      R7,#02H
B3:00C56A 128195            LCALL    ___ZW_memcpy
B3:00C56D 904518            MOV      DPTR,#eventQueueCount
B3:00C570 E0                MOVX     A,@DPTR
B3:00C571 14                DEC      A
B3:00C572 F0                MOVX     @DPTR,A
B3:00C573 D3                SETB     C
B3:00C574 22                RET      
B3:00C575         ?C0003?ZW_EVENT:
B3:00C575 9046A9            MOV      DPTR,#pbEvent
B3:00C578 E0                MOVX     A,@DPTR
B3:00C579 F8                MOV      R0,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 851


B3:00C57A E4                CLR      A
B3:00C57B F6                MOV      @R0,A
B3:00C57C C3                CLR      C
B3:00C57D 22                RET      
----- FUNCTION _EventPop (END) -------


----- FUNCTION ExploreMachine (BEGIN) -----
B3:00C57E 7F53              MOV      R7,#LOW bExploreEvent
B3:00C580 7D54              MOV      R5,#LOW bExploreStatus
B3:00C582 B13D              ACALL    _EventPop
B3:00C584 E553              MOV      A,bExploreEvent
B3:00C586 14                DEC      A
B3:00C587 7003              JNZ      ?C0053?ZW_EXPLORE
B3:00C589         ?C0054?ZW_EXPLORE:
B3:00C589 128B37            LCALL    ExploreFrameIgnoreTick
B3:00C58C         ?C0053?ZW_EXPLORE:
B3:00C58C E4                CLR      A
B3:00C58D F552              MOV      bExploreQueueIndex,A
B3:00C58F         ?C0056?ZW_EXPLORE:
B3:00C58F E552              MOV      A,bExploreQueueIndex
B3:00C591 75F060            MOV      B,#060H
B3:00C594 A4                MUL      AB
B3:00C595 2491              ADD      A,#LOW exploreQueue
B3:00C597 F9                MOV      R1,A
B3:00C598 7407              MOV      A,#HIGH exploreQueue
B3:00C59A 35F0              ADDC     A,B
B3:00C59C FA                MOV      R2,A
B3:00C59D 7B01              MOV      R3,#01H
B3:00C59F 900851            MOV      DPTR,#pCurrentExploreQueueElement
B3:00C5A2 122572            LCALL    ?C?PSTXDATA
B3:00C5A5 121F7C            LCALL    ?C?CLDPTR
B3:00C5A8 24FE              ADD      A,#0FEH
B3:00C5AA 6015              JZ       ?C0061?ZW_EXPLORE
B3:00C5AC 24FE              ADD      A,#0FEH
B3:00C5AE 6015              JZ       ?C0062?ZW_EXPLORE
B3:00C5B0 14                DEC      A
B3:00C5B1 6017              JZ       ?C0063?ZW_EXPLORE
B3:00C5B3 14                DEC      A
B3:00C5B4 6019              JZ       ?C0064?ZW_EXPLORE
B3:00C5B6 14                DEC      A
B3:00C5B7 601B              JZ       ?C0065?ZW_EXPLORE
B3:00C5B9 2406              ADD      A,#06H
B3:00C5BB 707D              JNZ      ?C0058?ZW_EXPLORE
B3:00C5BD         ?C0060?ZW_EXPLORE:
B3:00C5BD F132              ACALL    ExploreStateNew
B3:00C5BF 8079              SJMP     ?C0058?ZW_EXPLORE
B3:00C5C1         ?C0061?ZW_EXPLORE:
B3:00C5C1 F11A              ACALL    ExploreStateDelayed
B3:00C5C3 8075              SJMP     ?C0058?ZW_EXPLORE
B3:00C5C5         ?C0062?ZW_EXPLORE:
B3:00C5C5 128453            LCALL    ExploreStateTransmit
B3:00C5C8 8070              SJMP     ?C0058?ZW_EXPLORE
B3:00C5CA         ?C0063?ZW_EXPLORE:
B3:00C5CA 12C857            LCALL    ExploreStateSearch
B3:00C5CD 806B              SJMP     ?C0058?ZW_EXPLORE
B3:00C5CF         ?C0064?ZW_EXPLORE:
B3:00C5CF 12C8D5            LCALL    ExploreStateRepeat
B3:00C5D2 8066              SJMP     ?C0058?ZW_EXPLORE
B3:00C5D4         ?C0065?ZW_EXPLORE:
B3:00C5D4 12852F            LCALL    ?L?COM0070
B3:00C5D7 E9                MOV      A,R1
B3:00C5D8 241E              ADD      A,#01EH
B3:00C5DA 1252F4            LCALL    ?L?COM0021
B3:00C5DD 45F0              ORL      A,B
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 852


B3:00C5DF 6050              JZ       ?C0066?ZW_EXPLORE
B3:00C5E1 E553              MOV      A,bExploreEvent
B3:00C5E3 6404              XRL      A,#04H
B3:00C5E5 600B              JZ       ?C0067?ZW_EXPLORE
B3:00C5E7 12852F            LCALL    ?L?COM0070
B3:00C5EA E9                MOV      A,R1
B3:00C5EB 2401              ADD      A,#01H
B3:00C5ED 1252DD            LCALL    ?L?COM0009
B3:00C5F0 F554              MOV      bExploreStatus,A
B3:00C5F2         ?C0067?ZW_EXPLORE:
B3:00C5F2 12852F            LCALL    ?L?COM0070
B3:00C5F5 E9                MOV      A,R1
B3:00C5F6 2409              ADD      A,#09H
B3:00C5F8 1252F4            LCALL    ?L?COM0021
B3:00C5FB FF                MOV      R7,A
B3:00C5FC AEF0              MOV      R6,B
B3:00C5FE 125949            LCALL    _getTickTimePassed
B3:00C601 12852F            LCALL    ?L?COM0070
B3:00C604 E9                MOV      A,R1
B3:00C605 240B              ADD      A,#0BH
B3:00C607 F106              ACALL    ?L?COM029B
B3:00C609 C003              PUSH     AR3
B3:00C60B C002              PUSH     AR2
B3:00C60D C001              PUSH     AR1
B3:00C60F 12852F            LCALL    ?L?COM0070
B3:00C612 E9                MOV      A,R1
B3:00C613 241E              ADD      A,#01EH
B3:00C615 1252F4            LCALL    ?L?COM0021
B3:00C618 F582              MOV      DPL,A
B3:00C61A 85F083            MOV      DPH,B
B3:00C61D D001              POP      AR1
B3:00C61F D002              POP      AR2
B3:00C621 D003              POP      AR3
B3:00C623 AF54              MOV      R7,bExploreStatus
B3:00C625 1226E3            LCALL    ?C?ICALL2
B3:00C628 12852F            LCALL    ?L?COM0070
B3:00C62B E9                MOV      A,R1
B3:00C62C F110              ACALL    ?L?COM0383
B3:00C62E 1221E8            LCALL    ?C?ISTPTR
B3:00C631         ?C0066?ZW_EXPLORE:
B3:00C631 12852F            LCALL    ?L?COM0070
B3:00C634 E4                CLR      A
B3:00C635 12203B            LCALL    ?C?CSTPTR
B3:00C638 C213              CLR      bExploreSlotTaken
B3:00C63A         ?C0058?ZW_EXPLORE:
B3:00C63A 0552              INC      bExploreQueueIndex
B3:00C63C E552              MOV      A,bExploreQueueIndex
B3:00C63E C3                CLR      C
B3:00C63F 9402              SUBB     A,#02H
B3:00C641 5002              JNC      $ + 4H
B3:00C643 A18F              AJMP     ?C0056?ZW_EXPLORE
B3:00C645         ?C0057?ZW_EXPLORE:
B3:00C645 E551              MOV      A,bCurrentExploreTimerTicks
B3:00C647 6008              JZ       ?C0070?ZW_EXPLORE
B3:00C649 FD                MOV      R5,A
B3:00C64A 7F01              MOV      R7,#01H
B3:00C64C 919A              ACALL    _EventPush
B3:00C64E E4                CLR      A
B3:00C64F F551              MOV      bCurrentExploreTimerTicks,A
B3:00C651         ?C0070?ZW_EXPLORE:
B3:00C651 22                RET      
----- FUNCTION ExploreMachine (END) -------


----- FUNCTION Power_Management_Check (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 853


B3:00C652 901217            MOV      DPTR,#eSystemTypeState
B3:00C655 E0                MOVX     A,@DPTR
B3:00C656 FF                MOV      R7,A
B3:00C657 20E203            JB       ACC.2,?C0011?ZW_POWER_MANAGEMENT
B3:00C65A 20E13F            JB       ACC.1,?C0010?ZW_POWER_MANAGEMENT
B3:00C65D         ?C0011?ZW_POWER_MANAGEMENT:
B3:00C65D D1D2              ACALL    ?L?COM024A
B3:00C65F 7007              JNZ      ?C0012?ZW_POWER_MANAGEMENT
B3:00C661 901228            MOV      DPTR,#wakeupCountRest
B3:00C664 E0                MOVX     A,@DPTR
B3:00C665 7001              JNZ      ?C0012?ZW_POWER_MANAGEMENT
B3:00C667 22                RET      
B3:00C668         ?C0012?ZW_POWER_MANAGEMENT:
B3:00C668 D1D2              ACALL    ?L?COM024A
B3:00C66A 6012              JZ       ?C0015?ZW_POWER_MANAGEMENT
B3:00C66C 7FFF              MOV      R7,#0FFH
B3:00C66E 1248DA            LCALL    _ZW_SetWutTimeout
B3:00C671 901218            MOV      DPTR,#wakeupCount
B3:00C674 B106              ACALL    ?L?COM01A1
B3:00C676 901218            MOV      DPTR,#wakeupCount
B3:00C679 1224BA            LCALL    ?C?LSTXDATA
B3:00C67C 800D              SJMP     ?C0014?ZW_POWER_MANAGEMENT
B3:00C67E         ?C0015?ZW_POWER_MANAGEMENT:
B3:00C67E 901228            MOV      DPTR,#wakeupCountRest
B3:00C681 E0                MOVX     A,@DPTR
B3:00C682 FF                MOV      R7,A
B3:00C683 1248DA            LCALL    _ZW_SetWutTimeout
B3:00C686 E4                CLR      A
B3:00C687 901228            MOV      DPTR,#wakeupCountRest
B3:00C68A F0                MOVX     @DPTR,A
B3:00C68B         ?C0014?ZW_POWER_MANAGEMENT:
B3:00C68B 125FB6            LCALL    ?L?COM0447
B3:00C68E 901240            MOV      DPTR,#extInt1Enabled
B3:00C691 1248B0            LCALL    ?L?COM04B1
B3:00C694 124883            LCALL    _ZW_power_down_mode_init
B3:00C697 7F01              MOV      R7,#01H
B3:00C699 0248BC            LJMP     _ZW_power_down_mode
B3:00C69C         ?C0010?ZW_POWER_MANAGEMENT:
B3:00C69C D1E1              ACALL    Power_Management_FLiRSSetup
B3:00C69E 7F05              MOV      R7,#05H
B3:;----                  JMP      _Power_Management_PowerDown
----- FUNCTION Power_Management_Check (END) -------


----- FUNCTION _Power_Management_PowerDown (BEGIN) -----
B3:00C6A0 9046AB            MOV      DPTR,#bSleepMode
B3:00C6A3 EF                MOV      A,R7
B3:00C6A4 F0                MOVX     @DPTR,A
B3:00C6A5 126EE5            LCALL    ?L?COM036F
B3:00C6A8 9046AB            MOV      DPTR,#bSleepMode
B3:00C6AB E0                MOVX     A,@DPTR
B3:00C6AC B40204            CJNE     A,#02H,?C0004?ZW_POWER_MANAGEMENT
B3:00C6AF E4                CLR      A
B3:00C6B0 FF                MOV      R7,A
B3:00C6B1 801B              SJMP     ?C0024?ZW_POWER_MANAGEMENT
B3:00C6B3         ?C0004?ZW_POWER_MANAGEMENT:
B3:00C6B3 9046AB            MOV      DPTR,#bSleepMode
B3:00C6B6 E0                MOVX     A,@DPTR
B3:00C6B7 B40304            CJNE     A,#03H,?C0006?ZW_POWER_MANAGEMENT
B3:00C6BA 7F01              MOV      R7,#01H
B3:00C6BC         
B3:00C6BC 8010              SJMP     ?C0024?ZW_POWER_MANAGEMENT
B3:00C6BE         ?C0006?ZW_POWER_MANAGEMENT:
B3:00C6BE 9046AB            MOV      DPTR,#bSleepMode
B3:00C6C1 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 854


B3:00C6C2 B4050C            CJNE     A,#05H,?C0009?ZW_POWER_MANAGEMENT
B3:00C6C5 901215            MOV      DPTR,#bFLiRSStatus
B3:00C6C8 E0                MOVX     A,@DPTR
B3:00C6C9 4401              ORL      A,#01H
B3:00C6CB F0                MOVX     @DPTR,A
B3:00C6CC 7F01              MOV      R7,#01H
B3:00C6CE         
B3:00C6CE 1248BC            LCALL    _ZW_power_down_mode
B3:00C6D1         ?C0009?ZW_POWER_MANAGEMENT:
B3:00C6D1 22                RET      
----- FUNCTION _Power_Management_PowerDown (END) -------


----- FUNCTION ?L?COM024A (BEGIN) -----
B3:00C6D2 E4                CLR      A
B3:00C6D3 FF                MOV      R7,A
B3:00C6D4 FE                MOV      R6,A
B3:00C6D5 FD                MOV      R5,A
B3:00C6D6 FC                MOV      R4,A
B3:00C6D7 901218            MOV      DPTR,#wakeupCount
B3:00C6DA         ?L?COM024B:
B3:00C6DA 12247E            LCALL    ?C?LLDXDATA0
B3:00C6DD C3                CLR      C
B3:00C6DE 02239D            LJMP     ?C?ULCMP
----- FUNCTION ?L?COM024A (END) -------


----- FUNCTION Power_Management_FLiRSSetup (BEGIN) -----
B3:00C6E1 125FB6            LCALL    ?L?COM0447
B3:00C6E4 90122A            MOV      DPTR,#bldeviceOptionsMask
B3:00C6E7 E0                MOVX     A,@DPTR
B3:00C6E8 901240            MOV      DPTR,#extInt1Enabled
B3:00C6EB 30E50D            JNB      ACC.5,?C0001?ZW_POWER_MANAGEMENT
B3:00C6EE E0                MOVX     A,@DPTR
B3:00C6EF FB                MOV      R3,A
B3:00C6F0 7D01              MOV      R5,#01H
B3:00C6F2 7F01              MOV      R7,#01H
B3:00C6F4 124883            LCALL    _ZW_power_down_mode_init
B3:00C6F7 7F1F              MOV      R7,#01FH
B3:00C6F9 8008              SJMP     ?C0022?ZW_POWER_MANAGEMENT
B3:00C6FB         ?C0001?ZW_POWER_MANAGEMENT:
B3:00C6FB 1248B0            LCALL    ?L?COM04B1
B3:00C6FE 124883            LCALL    _ZW_power_down_mode_init
B3:00C701 E4                CLR      A
B3:00C702 FF                MOV      R7,A
B3:00C703         
B3:00C703 0248DA            LJMP     _ZW_power_down_wut_timeout
----- FUNCTION Power_Management_FLiRSSetup (END) -------


----- FUNCTION ?L?COM029B (BEGIN) -----
B3:00C706 F9                MOV      R1,A
B3:00C707 E4                CLR      A
B3:00C708 3A                ADDC     A,R2
B3:00C709 FA                MOV      R2,A
B3:00C70A         ?L?COM029C:
B3:00C70A EE                MOV      A,R6
B3:00C70B 8FF0              MOV      B,R7
B3:00C70D 0221E8            LJMP     ?C?ISTPTR
----- FUNCTION ?L?COM029B (END) -------


----- FUNCTION ?L?COM0383 (BEGIN) -----
B3:00C710 241E              ADD      A,#01EH
B3:00C712         ?L?COM0384:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 855


B3:00C712 F9                MOV      R1,A
B3:00C713 E4                CLR      A
B3:00C714 3A                ADDC     A,R2
B3:00C715 FA                MOV      R2,A
B3:00C716 E4                CLR      A
B3:00C717 F5F0              MOV      B,A
B3:00C719 22                RET      
----- FUNCTION ?L?COM0383 (END) -------


----- FUNCTION ExploreStateDelayed (BEGIN) -----
B3:00C71A E553              MOV      A,bExploreEvent
B3:00C71C 14                DEC      A
B3:00C71D 7012              JNZ      ?C0020?ZW_EXPLORE
B3:00C71F         ?C0016?ZW_EXPLORE:
B3:00C71F 12C823            LCALL    ExploreCheckDelayCountTimeout
B3:00C722 500D              JNC      ?C0020?ZW_EXPLORE
B3:00C724 20130A            JB       bExploreSlotTaken,?C0020?ZW_EXPLORE
B3:00C727 D213              SETB     bExploreSlotTaken
B3:00C729 12852F            LCALL    ?L?COM0070
B3:00C72C 7404              MOV      A,#04H
B3:00C72E 12203B            LCALL    ?C?CSTPTR
B3:00C731         ?C0020?ZW_EXPLORE:
B3:00C731 22                RET      
----- FUNCTION ExploreStateDelayed (END) -------


----- FUNCTION ExploreStateNew (BEGIN) -----
B3:00C732 12852F            LCALL    ?L?COM0070
B3:00C735 E4                CLR      A
B3:00C736 12203B            LCALL    ?C?CSTPTR
B3:00C739 12852F            LCALL    ?L?COM0070
B3:00C73C E9                MOV      A,R1
B3:00C73D 2405              ADD      A,#05H
B3:00C73F 1252DD            LCALL    ?L?COM0009
B3:00C742 14                DEC      A
B3:00C743 6003              JZ       ?C0007?ZW_EXPLORE
B3:00C745 04                INC      A
B3:00C746 705B              JNZ      ?C0011?ZW_EXPLORE
B3:00C748         ?C0007?ZW_EXPLORE:
B3:00C748 12852F            LCALL    ?L?COM0070
B3:00C74B E9                MOV      A,R1
B3:00C74C 242C              ADD      A,#02CH
B3:00C74E 1252DD            LCALL    ?L?COM0009
B3:00C751 540F              ANL      A,#0FH
B3:00C753 900AE9            MOV      DPTR,#bHops
B3:00C756 F0                MOVX     @DPTR,A
B3:00C757 900851            MOV      DPTR,#pCurrentExploreQueueElement
B3:00C75A 6034              JZ       ?C0008?ZW_EXPLORE
B3:00C75C 122552            LCALL    ?C?PLDXDATA
B3:00C75F E9                MOV      A,R1
B3:00C760 242B              ADD      A,#02BH
B3:00C762 1252DD            LCALL    ?L?COM0009
B3:00C765 FF                MOV      R7,A
B3:00C766 124FF7            LCALL    _GetRandom
B3:00C769 EF                MOV      A,R7
B3:00C76A FD                MOV      R5,A
B3:00C76B 900AE9            MOV      DPTR,#bHops
B3:00C76E E0                MOVX     A,@DPTR
B3:00C76F 14                DEC      A
B3:00C770 F0                MOVX     @DPTR,A
B3:00C771 75F064            MOV      B,#064H
B3:00C774 A4                MUL      AB
B3:00C775 2419              ADD      A,#019H
B3:00C777 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 856


B3:00C778 E4                CLR      A
B3:00C779 35F0              ADDC     A,B
B3:00C77B CF                XCH      A,R7
B3:00C77C 2D                ADD      A,R5
B3:00C77D CF                XCH      A,R7
B3:00C77E 3400              ADDC     A,#00H
B3:00C780 FE                MOV      R6,A
B3:00C781 12852F            LCALL    ?L?COM0070
B3:00C784 E9                MOV      A,R1
B3:00C785 2407              ADD      A,#07H
B3:00C787 F9                MOV      R1,A
B3:00C788 E4                CLR      A
B3:00C789 3A                ADDC     A,R2
B3:00C78A FA                MOV      R2,A
B3:00C78B EE                MOV      A,R6
B3:00C78C 8FF0              MOV      B,R7
B3:00C78E 8008              SJMP     ?C0144?ZW_EXPLORE
B3:00C790         ?C0008?ZW_EXPLORE:
B3:00C790 122552            LCALL    ?C?PLDXDATA
B3:00C793 E9                MOV      A,R1
B3:00C794 2407              ADD      A,#07H
B3:00C796 F112              ACALL    ?L?COM0384
B3:00C798         
B3:00C798 1221E8            LCALL    ?C?ISTPTR
B3:00C79B         ?C0009?ZW_EXPLORE:
B3:00C79B 12852F            LCALL    ?L?COM0070
B3:00C79E 7402              MOV      A,#02H
B3:00C7A0 12203B            LCALL    ?C?CSTPTR
B3:00C7A3         ?C0011?ZW_EXPLORE:
B3:00C7A3 22                RET      
----- FUNCTION ExploreStateNew (END) -------


----- FUNCTION _sec2_send_data (BEGIN) -----
B3:00C7A4 90409E            MOV      DPTR,#vdata
B3:00C7A7 122572            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R4/R5' ----
B3:00C7AA 9040A3            MOV      DPTR,#txOptionsEx
B3:00C7AD 12CD6D            LCALL    ?L?COM02D3
B3:00C7B0 1252DD            LCALL    ?L?COM0009
B3:00C7B3 9040A8            MOV      DPTR,#s2_con
B3:00C7B6 F0                MOVX     @DPTR,A
B3:00C7B7 9040A3            MOV      DPTR,#txOptionsEx
B3:00C7BA 12A3E6            LCALL    ?L?COM0077
B3:00C7BD 9040A9            MOV      DPTR,#s2_con+01H
B3:00C7C0 F0                MOVX     @DPTR,A
B3:00C7C1 E9                MOV      A,R1
B3:00C7C2 2403              ADD      A,#03H
B3:00C7C4 1252DD            LCALL    ?L?COM0009
B3:00C7C7 9040AA            MOV      DPTR,#s2_con+02H
B3:00C7CA F0                MOVX     @DPTR,A
B3:00C7CB 12C8FE            LCALL    ?L?COM0535
B3:00C7CE 2402              ADD      A,#02H
B3:00C7D0 1252DD            LCALL    ?L?COM0009
B3:00C7D3 9040AC            MOV      DPTR,#s2_con+04H
B3:00C7D6 F0                MOVX     @DPTR,A
B3:00C7D7 903CB0            MOV      DPTR,#s2_send_callback
B3:00C7DA E0                MOVX     A,@DPTR
B3:00C7DB FF                MOV      R7,A
B3:00C7DC A3                INC      DPTR
B3:00C7DD E0                MOVX     A,@DPTR
B3:00C7DE 9040B0            MOV      DPTR,#cb_save
B3:00C7E1 CF                XCH      A,R7
B3:00C7E2 F0                MOVX     @DPTR,A
B3:00C7E3 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 857


B3:00C7E4 EF                MOV      A,R7
B3:00C7E5 F0                MOVX     @DPTR,A
B3:00C7E6 9040A6            MOV      DPTR,#callback
B3:00C7E9 12C8F1            LCALL    ?L?COM03DE
B3:00C7EC 12C8FE            LCALL    ?L?COM0535
B3:00C7EF 2404              ADD      A,#04H
B3:00C7F1 1252DD            LCALL    ?L?COM0009
B3:00C7F4 14                DEC      A
B3:00C7F5 9040AF            MOV      DPTR,#s2_con+07H
B3:00C7F8 F0                MOVX     @DPTR,A
B3:00C7F9 90409E            MOV      DPTR,#vdata
B3:00C7FC 122552            LCALL    ?C?PLDXDATA
B3:00C7FF 904121            MOV      DPTR,#?___S2_send_data?BYTE+03H
B3:00C802 122572            LCALL    ?C?PSTXDATA
B3:00C805 AF05              MOV      R7,AR5
B3:00C807 904124            MOV      DPTR,#?___S2_send_data?BYTE+06H
B3:00C80A EC                MOV      A,R4
B3:00C80B 12CB64            LCALL    ?L?COM0137
B3:00C80E 7A40              MOV      R2,#HIGH s2_con
B3:00C810 79A8              MOV      R1,#LOW s2_con
B3:00C812 12C3E8            LCALL    ___S2_send_data
B3:00C815 EF                MOV      A,R7
B3:00C816 6003              JZ       ?C0005?ZW_SECURITY_SCHEME2
B3:00C818 7F01              MOV      R7,#01H
B3:00C81A 22                RET      
B3:00C81B         ?C0005?ZW_SECURITY_SCHEME2:
B3:00C81B 9040B0            MOV      DPTR,#cb_save
B3:00C81E 11F1              ACALL    ?L?COM03DE
B3:00C820         ?C0007?ZW_SECURITY_SCHEME2:
B3:00C820 7F00              MOV      R7,#00H
B3:00C822 22                RET      
----- FUNCTION _sec2_send_data (END) -------


----- FUNCTION ExploreCheckDelayCountTimeout (BEGIN) -----
B3:00C823 12852F            LCALL    ?L?COM0070
B3:00C826 E9                MOV      A,R1
B3:00C827 2407              ADD      A,#07H
B3:00C829 1252F4            LCALL    ?L?COM0021
B3:00C82C FF                MOV      R7,A
B3:00C82D AEF0              MOV      R6,B
B3:00C82F AD54              MOV      R5,bExploreStatus
B3:00C831 7C00              MOV      R4,#00H
B3:00C833 D3                SETB     C
B3:00C834 9D                SUBB     A,R5
B3:00C835 EE                MOV      A,R6
B3:00C836 9C                SUBB     A,R4
B3:00C837 4009              JC       ?C0012?ZW_EXPLORE
B3:00C839 EF                MOV      A,R7
B3:00C83A 9D                SUBB     A,R5
B3:00C83B FF                MOV      R7,A
B3:00C83C EE                MOV      A,R6
B3:00C83D 9C                SUBB     A,R4
B3:00C83E 8FF0              MOV      B,R7
B3:00C840 8003              SJMP     ?C0145?ZW_EXPLORE
B3:00C842         ?C0012?ZW_EXPLORE:
B3:00C842 E4                CLR      A
B3:00C843 F5F0              MOV      B,A
B3:00C845         
B3:00C845 1221E8            LCALL    ?C?ISTPTR
B3:00C848         ?C0013?ZW_EXPLORE:
B3:00C848 12852F            LCALL    ?L?COM0070
B3:00C84B E9                MOV      A,R1
B3:00C84C 2407              ADD      A,#07H
B3:00C84E 1252F4            LCALL    ?L?COM0021
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 858


B3:00C851 45F0              ORL      A,B
B3:00C853 24FF              ADD      A,#0FFH
B3:00C855 B3                CPL      C
B3:00C856 22                RET      
----- FUNCTION ExploreCheckDelayCountTimeout (END) -------


----- FUNCTION ExploreStateSearch (BEGIN) -----
B3:00C857 E553              MOV      A,bExploreEvent
B3:00C859 24FD              ADD      A,#0FDH
B3:00C85B 6055              JZ       ?C0036?ZW_EXPLORE
B3:00C85D 14                DEC      A
B3:00C85E 6013              JZ       ?C0033?ZW_EXPLORE
B3:00C860 2403              ADD      A,#03H
B3:00C862 7070              JNZ      ?C0039?ZW_EXPLORE
B3:00C864         ?C0031?ZW_EXPLORE:
B3:00C864 1123              ACALL    ExploreCheckDelayCountTimeout
B3:00C866 506C              JNC      ?C0039?ZW_EXPLORE
B3:00C868 C212              CLR      searchResultNeeded
B3:00C86A 900851            MOV      DPTR,#pCurrentExploreQueueElement
B3:00C86D B11E              ACALL    ?L?COM0054
B3:00C86F 7401              MOV      A,#01H
B3:00C871 8056              SJMP     ?C0146?ZW_EXPLORE
B3:00C873         ?C0033?ZW_EXPLORE:
B3:00C873 12852F            LCALL    ?L?COM0070
B3:00C876 E9                MOV      A,R1
B3:00C877 240B              ADD      A,#0BH
B3:00C879 F9                MOV      R1,A
B3:00C87A E4                CLR      A
B3:00C87B 3A                ADDC     A,R2
B3:00C87C FA                MOV      R2,A
B3:00C87D C003              PUSH     AR3
B3:00C87F C002              PUSH     AR2
B3:00C881 C001              PUSH     AR1
B3:00C883 7B01              MOV      R3,#01H
B3:00C885 7A08              MOV      R2,#HIGH currentTxStatusReport
B3:00C887 799D              MOV      R1,#LOW currentTxStatusReport
B3:00C889 128549            LCALL    ?L?COM0019
B3:00C88C D001              POP      AR1
B3:00C88E D002              POP      AR2
B3:00C890 D003              POP      AR3
B3:00C892 7F13              MOV      R7,#013H
B3:00C894 128195            LCALL    ___ZW_memcpy
B3:00C897 12852F            LCALL    ?L?COM0070
B3:00C89A E9                MOV      A,R1
B3:00C89B 2404              ADD      A,#04H
B3:00C89D 1252DD            LCALL    ?L?COM0009
B3:00C8A0 5409              ANL      A,#09H
B3:00C8A2 7002              JNZ      ?C0034?ZW_EXPLORE
B3:00C8A4 8026              SJMP     ?C0147?ZW_EXPLORE
B3:00C8A6         ?C0034?ZW_EXPLORE:
B3:00C8A6 12852A            LCALL    ?L?COM006E
B3:00C8A9 E9                MOV      A,R1
B3:00C8AA 2413              ADD      A,#013H
B3:00C8AC 1289AC            LCALL    ?L?COM0144
B3:00C8AF D212              SETB     searchResultNeeded
B3:00C8B1 22                RET      
B3:00C8B2         ?C0036?ZW_EXPLORE:
B3:00C8B2 12852F            LCALL    ?L?COM0070
B3:00C8B5 E9                MOV      A,R1
B3:00C8B6 2403              ADD      A,#03H
B3:00C8B8 1252DD            LCALL    ?L?COM0009
B3:00C8BB B55416            CJNE     A,bExploreStatus,?C0039?ZW_EXPLORE
B3:00C8BE 12852A            LCALL    ?L?COM006E
B3:00C8C1 E9                MOV      A,R1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 859


B3:00C8C2 2413              ADD      A,#013H
B3:00C8C4 F9                MOV      R1,A
B3:00C8C5 E4                CLR      A
B3:00C8C6 3A                ADDC     A,R2
B3:00C8C7 FA                MOV      R2,A
B3:00C8C8 EF                MOV      A,R7
B3:00C8C9         
B3:00C8C9 12203B            LCALL    ?C?CSTPTR
B3:00C8CC         
B3:00C8CC 12852F            LCALL    ?L?COM0070
B3:00C8CF 7407              MOV      A,#07H
B3:00C8D1 12203B            LCALL    ?C?CSTPTR
B3:00C8D4         ?C0039?ZW_EXPLORE:
B3:00C8D4 22                RET      
----- FUNCTION ExploreStateSearch (END) -------


----- FUNCTION ExploreStateRepeat (BEGIN) -----
B3:00C8D5 E553              MOV      A,bExploreEvent
B3:00C8D7 24FD              ADD      A,#0FDH
B3:00C8D9 600D              JZ       ?C0044?ZW_EXPLORE
B3:00C8DB 14                DEC      A
B3:00C8DC 600A              JZ       ?C0044?ZW_EXPLORE
B3:00C8DE 2403              ADD      A,#03H
B3:00C8E0 700E              JNZ      ?C0046?ZW_EXPLORE
B3:00C8E2         ?C0041?ZW_EXPLORE:
B3:00C8E2 1123              ACALL    ExploreCheckDelayCountTimeout
B3:00C8E4 500A              JNC      ?C0046?ZW_EXPLORE
B3:00C8E6 8000              SJMP     ?C0148?ZW_EXPLORE
B3:00C8E8         ?C0044?ZW_EXPLORE:
B3:00C8E8         
B3:00C8E8 12852F            LCALL    ?L?COM0070
B3:00C8EB 7407              MOV      A,#07H
B3:00C8ED 12203B            LCALL    ?C?CSTPTR
B3:00C8F0         ?C0046?ZW_EXPLORE:
B3:00C8F0 22                RET      
----- FUNCTION ExploreStateRepeat (END) -------


----- FUNCTION ?L?COM03DE (BEGIN) -----
B3:00C8F1 E0                MOVX     A,@DPTR
B3:00C8F2 FF                MOV      R7,A
B3:00C8F3 A3                INC      DPTR
B3:00C8F4 E0                MOVX     A,@DPTR
B3:00C8F5 903CB0            MOV      DPTR,#s2_send_callback
B3:00C8F8 CF                XCH      A,R7
B3:00C8F9 F0                MOVX     @DPTR,A
B3:00C8FA A3                INC      DPTR
B3:00C8FB EF                MOV      A,R7
B3:00C8FC F0                MOVX     @DPTR,A
B3:00C8FD 22                RET      
----- FUNCTION ?L?COM03DE (END) -------


----- FUNCTION ?L?COM0535 (BEGIN) -----
B3:00C8FE 9040A3            MOV      DPTR,#txOptionsEx
B3:00C901 122552            LCALL    ?C?PLDXDATA
B3:00C904 E9                MOV      A,R1
B3:00C905 22                RET      
----- FUNCTION ?L?COM0535 (END) -------


----- FUNCTION ExploreQueueIndex (BEGIN) -----
;---- Variable 'i' assigned to Register 'R7' ----
B3:00C906 E4                CLR      A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 860


B3:00C907 FF                MOV      R7,A
B3:00C908         ?C0071?ZW_EXPLORE:
B3:00C908 EF                MOV      A,R7
B3:00C909 12EEB4            LCALL    ?L?COM03A6
B3:00C90C E0                MOVX     A,@DPTR
B3:00C90D 6005              JZ       ?C0072?ZW_EXPLORE
B3:00C90F         ?C0074?ZW_EXPLORE:
B3:00C90F         ?C0073?ZW_EXPLORE:
B3:00C90F 0F                INC      R7
B3:00C910 EF                MOV      A,R7
B3:00C911 B402F4            CJNE     A,#02H,?C0071?ZW_EXPLORE
B3:00C914         ?C0072?ZW_EXPLORE:
B3:00C914 22                RET      
----- FUNCTION ExploreQueueIndex (END) -------


----- FUNCTION _ExploreFrameIgnoreQueueIndex (BEGIN) -----
;---- Variable 'j' assigned to Register 'R1' ----
;---- Variable 'bSourceNode' assigned to Register 'R7' ----
B3:00C915 EF                MOV      A,R7
B3:00C916 7002              JNZ      ?C0076?ZW_EXPLORE
B3:00C918 7FEF              MOV      R7,#0EFH
B3:00C91A         ?C0076?ZW_EXPLORE:
B3:00C91A 900AEA            MOV      DPTR,#i
B3:00C91D 74FF              MOV      A,#0FFH
B3:00C91F F0                MOVX     @DPTR,A
;---- Variable 'n' assigned to Register 'R4/R5' ----
B3:00C920 FD                MOV      R5,A
B3:00C921 FC                MOV      R4,A
;---- Variable 'foundSlotIndex' assigned to Register 'R6' ----
B3:00C922 E4                CLR      A
B3:00C923 FE                MOV      R6,A
B3:00C924         ?C0077?ZW_EXPLORE:
B3:00C924 EE                MOV      A,R6
B3:00C925 1289A2            LCALL    ?L?COM0218
B3:00C928 E6                MOV      A,@R0
B3:00C929 FA                MOV      R2,A
B3:00C92A 08                INC      R0
B3:00C92B E6                MOV      A,@R0
B3:00C92C FB                MOV      R3,A
B3:00C92D D3                SETB     C
B3:00C92E 9D                SUBB     A,R5
B3:00C92F EA                MOV      A,R2
B3:00C930 9C                SUBB     A,R4
B3:00C931 5006              JNC      ?C0080?ZW_EXPLORE
B3:00C933 AC02              MOV      R4,AR2
B3:00C935 AD03              MOV      R5,AR3
B3:00C937 A906              MOV      R1,AR6
B3:00C939         ?C0080?ZW_EXPLORE:
B3:00C939 3171              ACALL    ?L?COM02E8
B3:00C93B E6                MOV      A,@R0
B3:00C93C B50704            CJNE     A,AR7,?C0081?ZW_EXPLORE
B3:00C93F A906              MOV      R1,AR6
B3:00C941 8015              SJMP     ?C0078?ZW_EXPLORE
B3:00C943         ?C0081?ZW_EXPLORE:
B3:00C943 EE                MOV      A,R6
B3:00C944 1289A2            LCALL    ?L?COM0218
B3:00C947 E6                MOV      A,@R0
B3:00C948 FA                MOV      R2,A
B3:00C949 08                INC      R0
B3:00C94A E6                MOV      A,@R0
B3:00C94B 4A                ORL      A,R2
B3:00C94C 7005              JNZ      ?C0079?ZW_EXPLORE
B3:00C94E 900AEA            MOV      DPTR,#i
B3:00C951 EE                MOV      A,R6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 861


B3:00C952 F0                MOVX     @DPTR,A
B3:00C953         ?C0079?ZW_EXPLORE:
B3:00C953 0E                INC      R6
B3:00C954 EE                MOV      A,R6
B3:00C955 B402CC            CJNE     A,#02H,?C0077?ZW_EXPLORE
B3:00C958         ?C0078?ZW_EXPLORE:
B3:00C958 EE                MOV      A,R6
B3:00C959 C3                CLR      C
B3:00C95A 9402              SUBB     A,#02H
B3:00C95C 4010              JC       ?C0084?ZW_EXPLORE
B3:00C95E 900AEA            MOV      DPTR,#i
B3:00C961 E0                MOVX     A,@DPTR
B3:00C962 FE                MOV      R6,A
B3:00C963 94FF              SUBB     A,#0FFH
B3:00C965 5002              JNC      ?C0085?ZW_EXPLORE
B3:00C967 A906              MOV      R1,AR6
B3:00C969         ?C0085?ZW_EXPLORE:
B3:00C969 E9                MOV      A,R1
B3:00C96A 3172              ACALL    ?L?COM02E9
B3:00C96C A607              MOV      @R0,AR7
B3:00C96E         ?C0084?ZW_EXPLORE:
B3:00C96E AF01              MOV      R7,AR1
B3:00C970 22                RET      
----- FUNCTION _ExploreFrameIgnoreQueueIndex (END) -------


----- FUNCTION ?L?COM02E8 (BEGIN) -----
B3:00C971 EE                MOV      A,R6
B3:00C972         ?L?COM02E9:
B3:00C972 25E0              ADD      A,ACC
B3:00C974 25E0              ADD      A,ACC
B3:00C976 2456              ADD      A,#LOW exploreFrameIgnoreQueue
B3:00C978 F8                MOV      R0,A
B3:00C979 22                RET      
----- FUNCTION ?L?COM02E8 (END) -------


----- FUNCTION _ExploreFrameIgnoreCheck (BEGIN) -----
;---- Variable 'sourceID' assigned to Register 'R7' ----
;---- Variable 'sequenceNo' assigned to Register 'R5' ----
B3:00C97A 901221            MOV      DPTR,#nodeID
B3:00C97D E0                MOVX     A,@DPTR
B3:00C97E B50702            CJNE     A,AR7,?C0087?ZW_EXPLORE
B3:00C981 D3                SETB     C
B3:00C982 22                RET      
B3:00C983         ?C0087?ZW_EXPLORE:
B3:00C983 EF                MOV      A,R7
B3:00C984 7002              JNZ      ?C0089?ZW_EXPLORE
B3:00C986 7FEF              MOV      R7,#0EFH
B3:00C988         ?C0089?ZW_EXPLORE:
;---- Variable 'i' assigned to Register 'R6' ----
B3:00C988 E4                CLR      A
B3:00C989 FE                MOV      R6,A
B3:00C98A         ?C0090?ZW_EXPLORE:
B3:00C98A EE                MOV      A,R6
B3:00C98B 1289A2            LCALL    ?L?COM0218
B3:00C98E E6                MOV      A,@R0
B3:00C98F FA                MOV      R2,A
B3:00C990 08                INC      R0
B3:00C991 E6                MOV      A,@R0
B3:00C992 4A                ORL      A,R2
B3:00C993 601F              JZ       ?C0092?ZW_EXPLORE
B3:00C995 EF                MOV      A,R7
B3:00C996 B4EF08            CJNE     A,#0EFH,?C0094?ZW_EXPLORE
B3:00C999 3171              ACALL    ?L?COM02E8
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 862


B3:00C99B E6                MOV      A,@R0
B3:00C99C B4FE02            CJNE     A,#0FEH,?C0094?ZW_EXPLORE
B3:00C99F D3                SETB     C
B3:00C9A0 22                RET      
B3:00C9A1         ?C0094?ZW_EXPLORE:
B3:00C9A1 3171              ACALL    ?L?COM02E8
B3:00C9A3 E6                MOV      A,@R0
B3:00C9A4 B5070D            CJNE     A,AR7,?C0092?ZW_EXPLORE
B3:00C9A7 EE                MOV      A,R6
B3:00C9A8 718B              ACALL    ?L?COM03E2
B3:00C9AA E6                MOV      A,@R0
B3:00C9AB 6D                XRL      A,R5
B3:00C9AC 6004              JZ       ?C0097?ZW_EXPLORE
B3:00C9AE EF                MOV      A,R7
B3:00C9AF B4EF02            CJNE     A,#0EFH,?C0092?ZW_EXPLORE
B3:00C9B2         ?C0097?ZW_EXPLORE:
B3:00C9B2 D3                SETB     C
B3:00C9B3 22                RET      
B3:00C9B4         ?C0092?ZW_EXPLORE:
B3:00C9B4 0E                INC      R6
B3:00C9B5 EE                MOV      A,R6
B3:00C9B6 B402D1            CJNE     A,#02H,?C0090?ZW_EXPLORE
B3:00C9B9         ?C0091?ZW_EXPLORE:
B3:00C9B9 C3                CLR      C
B3:00C9BA 22                RET      
----- FUNCTION _ExploreFrameIgnoreCheck (END) -------


----- FUNCTION _IsNetworkHomeIDValid (BEGIN) -----
B3:00C9BB 900AE0            MOV      DPTR,#pNetworkHomeID
B3:00C9BE 126FB8            LCALL    ?L?COM0448
B3:00C9C1 C002              PUSH     AR2
B3:00C9C3 C001              PUSH     AR1
B3:00C9C5 126E5B            LCALL    ?L?COM0280
B3:00C9C8 D001              POP      AR1
B3:00C9CA D002              POP      AR2
B3:00C9CC 7F04              MOV      R7,#04H
B3:00C9CE 129720            LCALL    ___ZW_memcmp
B3:00C9D1 EF                MOV      A,R7
B3:00C9D2 7002              JNZ      ?C0105?ZW_EXPLORE
B3:00C9D4 D3                SETB     C
B3:00C9D5 22                RET      
B3:00C9D6         ?C0105?ZW_EXPLORE:
B3:00C9D6 900AE0            MOV      DPTR,#pNetworkHomeID
B3:00C9D9 12BE72            LCALL    ?L?COM00C0
B3:00C9DC A3                INC      DPTR
B3:00C9DD E0                MOVX     A,@DPTR
B3:00C9DE FD                MOV      R5,A
B3:00C9DF 8F82              MOV      DPL,R7
B3:00C9E1 8E83              MOV      DPH,R6
B3:00C9E3 E0                MOVX     A,@DPTR
B3:00C9E4 4D                ORL      A,R5
B3:00C9E5 900AE0            MOV      DPTR,#pNetworkHomeID
B3:00C9E8 126E12            LCALL    ?L?COM01A2
B3:00C9EB A3                INC      DPTR
B3:00C9EC A3                INC      DPTR
B3:00C9ED E0                MOVX     A,@DPTR
B3:00C9EE 4F                ORL      A,R7
B3:00C9EF FF                MOV      R7,A
B3:00C9F0 8D82              MOV      DPL,R5
B3:00C9F2 8C83              MOV      DPH,R4
B3:00C9F4 A3                INC      DPTR
B3:00C9F5 A3                INC      DPTR
B3:00C9F6 A3                INC      DPTR
B3:00C9F7 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 863


B3:00C9F8 4F                ORL      A,R7
B3:00C9F9 C3                CLR      C
B3:00C9FA 7001              JNZ      ?C0107?ZW_EXPLORE
B3:00C9FC D3                SETB     C
B3:00C9FD         ?C0107?ZW_EXPLORE:
B3:00C9FD 22                RET      
----- FUNCTION _IsNetworkHomeIDValid (END) -------


----- FUNCTION _Power_Management_SetTimeout (BEGIN) -----
B3:00C9FE 904582            MOV      DPTR,#sleep
B3:00CA01 1224BA            LCALL    ?C?LSTXDATA
B3:00CA04 513D              ACALL    ?L?COM03A5
B3:00CA06 E4                CLR      A
B3:00CA07 7BFF              MOV      R3,#0FFH
B3:00CA09 124799            LCALL    ?L?COM041C
B3:00CA0C 501C              JNC      ?C0018?ZW_POWER_MANAGEMENT
B3:00CA0E E4                CLR      A
B3:00CA0F 513C              ACALL    ?L?COM03A4
B3:00CA11 1222DA            LCALL    ?C?ULDIV
B3:00CA14 901218            MOV      DPTR,#wakeupCount
B3:00CA17 1224BA            LCALL    ?C?LSTXDATA
B3:00CA1A E4                CLR      A
B3:00CA1B 7BFF              MOV      R3,#0FFH
B3:00CA1D FA                MOV      R2,A
B3:00CA1E F9                MOV      R1,A
B3:00CA1F 513C              ACALL    ?L?COM03A4
B3:00CA21 1222DA            LCALL    ?C?ULDIV
B3:00CA24 901228            MOV      DPTR,#wakeupCountRest
B3:00CA27 EB                MOV      A,R3
B3:00CA28 F0                MOVX     @DPTR,A
B3:00CA29 22                RET      
B3:00CA2A         ?C0018?ZW_POWER_MANAGEMENT:
B3:00CA2A 901218            MOV      DPTR,#wakeupCount
B3:00CA2D 1224C6            LCALL    ?C?LSTKXDATA
B3:00CA30 00                DB       00H
B3:00CA31 00                DB       00H
B3:00CA32 00                DB       00H
B3:00CA33 00                DB       00H
B3:00CA34 513D              ACALL    ?L?COM03A5
B3:00CA36 901228            MOV      DPTR,#wakeupCountRest
B3:00CA39 EF                MOV      A,R7
B3:00CA3A F0                MOVX     @DPTR,A
B3:00CA3B 22                RET      
----- FUNCTION _Power_Management_SetTimeout (END) -------


----- FUNCTION ?L?COM03A4 (BEGIN) -----
B3:00CA3C F8                MOV      R0,A
B3:00CA3D         ?L?COM03A5:
B3:00CA3D 904582            MOV      DPTR,#sleep
B3:00CA40 022462            LJMP     ?C?LLDXDATA
----- FUNCTION ?L?COM03A4 (END) -------


----- FUNCTION _ZW_Power_Management_Init (BEGIN) -----
B3:00CA43 904519            MOV      DPTR,#sleep
B3:00CA46 1224BA            LCALL    ?C?LSTXDATA
B3:00CA49 90451D            MOV      DPTR,#IntEnable
B3:00CA4C E0                MOVX     A,@DPTR
B3:00CA4D 5402              ANL      A,#02H
B3:00CA4F 901240            MOV      DPTR,#extInt1Enabled
B3:00CA52 F0                MOVX     @DPTR,A
B3:00CA53 904519            MOV      DPTR,#sleep
B3:00CA56 122462            LCALL    ?C?LLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 864


B3:00CA59 80A3              SJMP     _Power_Management_SetTimeout
----- FUNCTION _ZW_Power_Management_Init (END) -------


----- FUNCTION _ZW_GetBackgroundRSSI (BEGIN) -----
;---- Variable 'noise_levels' assigned to Register 'R1/R2/R3' ----
B3:00CA5B C003              PUSH     AR3
B3:00CA5D C002              PUSH     AR2
B3:00CA5F C001              PUSH     AR1
B3:00CA61 7B01              MOV      R3,#01H
B3:00CA63 7A44              MOV      R2,#HIGH sInternal_noise_levels
B3:00CA65 792F              MOV      R1,#LOW sInternal_noise_levels
B3:00CA67 128549            LCALL    ?L?COM0019
B3:00CA6A D001              POP      AR1
B3:00CA6C D002              POP      AR2
B3:00CA6E D003              POP      AR3
B3:00CA70 7F02              MOV      R7,#02H
B3:00CA72 028195            LJMP     ___ZW_memcpy
----- FUNCTION _ZW_GetBackgroundRSSI (END) -------


----- FUNCTION _ZW_RegisterBackgroundRSSICallback (BEGIN) -----
;---- Variable 'cbFun' assigned to Register 'R6/R7' ----
B3:00CA75 904431            MOV      DPTR,#_cbFuncNoiseDetect
B3:00CA78 EE                MOV      A,R6
B3:00CA79 F0                MOVX     @DPTR,A
B3:00CA7A A3                INC      DPTR
B3:00CA7B EF                MOV      A,R7
B3:00CA7C F0                MOVX     @DPTR,A
B3:00CA7D 22                RET      
----- FUNCTION _ZW_RegisterBackgroundRSSICallback (END) -------


----- FUNCTION NoiseDetectPowerOnInit (BEGIN) -----
B3:00CA7E E4                CLR      A
B3:00CA7F 904433            MOV      DPTR,#bNextChannelToSample
B3:00CA82 F0                MOVX     @DPTR,A
B3:00CA83 904431            MOV      DPTR,#_cbFuncNoiseDetect
B3:00CA86 F0                MOVX     @DPTR,A
B3:00CA87 A3                INC      DPTR
B3:00CA88 F0                MOVX     @DPTR,A
B3:00CA89 02A87F            LJMP     NoiseDetectSetDefault
----- FUNCTION NoiseDetectPowerOnInit (END) -------


----- FUNCTION gp_timeout (BEGIN) -----
B3:00CA8C 75FF01            MOV      SFRPAGE,#01H
B3:00CA8F E5A4              MOV      A,GPTCON
B3:00CA91 C3                CLR      C
B3:00CA92 30E401            JNB      ACC.4,?C0001?ZW_TRANSPORT_SUPPORT
B3:00CA95 D3                SETB     C
B3:00CA96         ?C0001?ZW_TRANSPORT_SUPPORT:
B3:00CA96 22                RET      
----- FUNCTION gp_timeout (END) -------


----- FUNCTION _start_gp_timer (BEGIN) -----
;---- Variable 'timeout' assigned to Register 'R6/R7' ----
B3:00CA97 75FF01            MOV      SFRPAGE,#01H
B3:00CA9A 7C0C              MOV      R4,#0CH
B3:00CA9C 7D35              MOV      R5,#035H
B3:00CA9E 122709            LCALL    ?C?LIMUL
B3:00CAA1 E4                CLR      A
B3:00CAA2 7B64              MOV      R3,#064H
B3:00CAA4 FA                MOV      R2,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 865


B3:00CAA5 F9                MOV      R1,A
B3:00CAA6 F8                MOV      R0,A
B3:00CAA7 1222DA            LCALL    ?C?ULDIV
;---- Variable 'gp_value' assigned to Register 'R4/R5' ----
B3:00CAAA AD07              MOV      R5,AR7
B3:00CAAC EE                MOV      A,R6
B3:00CAAD F5A9              MOV      GPTTHR,A
B3:00CAAF ED                MOV      A,R5
B3:00CAB0 F5A7              MOV      GPTTLR,A
B3:00CAB2 75FF01            MOV      SFRPAGE,#01H
B3:00CAB5 75A410            MOV      GPTCON,#010H
B3:00CAB8 75FF02            MOV      SFRPAGE,#02H
B3:00CABB 75F602            MOV      GPTCON2,#02H
B3:00CABE 75FF01            MOV      SFRPAGE,#01H
B3:00CAC1 75A415            MOV      GPTCON,#015H
B3:00CAC4 22                RET      
----- FUNCTION _start_gp_timer (END) -------


----- FUNCTION SendProdTestCarrier (BEGIN) -----
B3:00CAC5 301F35            JNB      rfProdTestOn,?C0013?ZW_TRANSPORT_SUPPORT
B3:00CAC8 43FA08            ORL      MODCTRL,#08H
B3:00CACB 301D05            JNB      rfProdTestDataMod,?C0014?ZW_TRANSPORT_SUPPORT
B3:00CACE 12418F            LCALL    ZW_Random
B3:00CAD1 8002              SJMP     ?C0022?ZW_TRANSPORT_SUPPORT
B3:00CAD3         ?C0014?ZW_TRANSPORT_SUPPORT:
B3:00CAD3 E4                CLR      A
B3:00CAD4 FF                MOV      R7,A
B3:00CAD5         
B3:00CAD5 125C26            LCALL    _RF_byte_set
B3:00CAD8         ?C0015?ZW_TRANSPORT_SUPPORT:
B3:00CAD8 E4                CLR      A
B3:00CAD9 F5FF              MOV      SFRPAGE,A
B3:00CADB 53B1FD            ANL      DPLLCON,#0FDH
B3:00CADE F5FF              MOV      SFRPAGE,A
B3:00CAE0 43B102            ORL      DPLLCON,#02H
B3:00CAE3         ?C0016?ZW_TRANSPORT_SUPPORT:
B3:00CAE3 E5B1              MOV      A,DPLLCON
B3:00CAE5 30E2FB            JNB      ACC.2,?C0016?ZW_TRANSPORT_SUPPORT
B3:00CAE8         ?C0017?ZW_TRANSPORT_SUPPORT:
B3:00CAE8 E4                CLR      A
B3:00CAE9 F5FF              MOV      SFRPAGE,A
B3:00CAEB E5B1              MOV      A,DPLLCON
B3:00CAED 20E30D            JB       ACC.3,?C0013?ZW_TRANSPORT_SUPPORT
B3:00CAF0 43FC04            ORL      SEQCON,#04H
B3:00CAF3 7F01              MOV      R7,#01H
B3:00CAF5 7E00              MOV      R6,#00H
B3:00CAF7 5197              ACALL    _start_gp_timer
B3:00CAF9         ?C0019?ZW_TRANSPORT_SUPPORT:
B3:00CAF9 518C              ACALL    gp_timeout
B3:00CAFB 50FC              JNC      ?C0019?ZW_TRANSPORT_SUPPORT
B3:00CAFD         ?C0020?ZW_TRANSPORT_SUPPORT:
B3:00CAFD         ?C0013?ZW_TRANSPORT_SUPPORT:
B3:00CAFD A21F              MOV      C,rfProdTestOn
B3:00CAFF 22                RET      
----- FUNCTION SendProdTestCarrier (END) -------


----- FUNCTION ZW_NVRCheck (BEGIN) -----
B3:00CB00 E4                CLR      A
B3:00CB01 9046AC            MOV      DPTR,#bIndex
B3:00CB04 F0                MOVX     @DPTR,A
B3:00CB05         ?C0008?ZW_NVR:
B3:00CB05 9046AC            MOV      DPTR,#bIndex
B3:00CB08 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 866


B3:00CB09 FF                MOV      R7,A
B3:00CB0A D3                SETB     C
B3:00CB0B 946F              SUBB     A,#06FH
B3:00CB0D 501E              JNC      ?C0009?ZW_NVR
B3:00CB0F EF                MOV      A,R7
B3:00CB10 2410              ADD      A,#010H
B3:00CB12 FF                MOV      R7,A
B3:00CB13 714F              ACALL    _ZW_FLASH_nvr0_get
B3:00CB15 9046AC            MOV      DPTR,#bIndex
B3:00CB18 E0                MOVX     A,@DPTR
B3:00CB19 FE                MOV      R6,A
B3:00CB1A E4                CLR      A
B3:00CB1B 2E                ADD      A,R6
B3:00CB1C F582              MOV      DPL,A
B3:00CB1E E4                CLR      A
B3:00CB1F 344F              ADDC     A,#04FH
B3:00CB21 F583              MOV      DPH,A
B3:00CB23 EF                MOV      A,R7
B3:00CB24 F0                MOVX     @DPTR,A
B3:00CB25 9046AC            MOV      DPTR,#bIndex
B3:00CB28 E0                MOVX     A,@DPTR
B3:00CB29 04                INC      A
B3:00CB2A F0                MOVX     @DPTR,A
B3:00CB2B 80D8              SJMP     ?C0008?ZW_NVR
B3:00CB2D         ?C0009?ZW_NVR:
B3:00CB2D 7B01              MOV      R3,#01H
B3:00CB2F 7A4F              MOV      R2,#04FH
B3:00CB31 7900              MOV      R1,#00H
B3:00CB33 90436F            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B3:00CB36 E4                CLR      A
B3:00CB37 F0                MOVX     @DPTR,A
B3:00CB38 A3                INC      DPTR
B3:00CB39 7470              MOV      A,#070H
B3:00CB3B F0                MOVX     @DPTR,A
B3:00CB3C 12BED7            LCALL    ?L?COM0347
;---- Variable 'wCRC16' assigned to Register 'R6/R7' ----
B3:00CB3F EF                MOV      A,R7
B3:00CB40 4E                ORL      A,R6
B3:00CB41 7F00              MOV      R7,#00H
B3:00CB43 7002              JNZ      ?C0011?ZW_NVR
B3:00CB45 7F01              MOV      R7,#01H
B3:00CB47         ?C0011?ZW_NVR:
B3:00CB47         ?C0012?ZW_NVR:
B3:00CB47 90123D            MOV      DPTR,#bNVRValid
B3:00CB4A EF                MOV      A,R7
B3:00CB4B F0                MOVX     @DPTR,A
B3:00CB4C 24FF              ADD      A,#0FFH
B3:00CB4E 22                RET      
----- FUNCTION ZW_NVRCheck (END) -------


----- FUNCTION _ZW_FLASH_nvr0_get (BEGIN) -----
;---- Variable 'bNvrAddress' assigned to Register 'R7' ----
B3:00CB4F 75FF03            MOV      SFRPAGE,#03H
B3:00CB52 E4                CLR      A
B3:00CB53 F597              MOV      NVRCON,A
B3:00CB55 12E511            LCALL    ?L?COM0502
B3:00CB58         ?C0001?ZW_PHY_FLASH_050X:
B3:00CB58 E597              MOV      A,NVRCON
B3:00CB5A 20E1FB            JB       ACC.1,?C0001?ZW_PHY_FLASH_050X
B3:00CB5D         ?C0002?ZW_PHY_FLASH_050X:
B3:00CB5D 75FF03            MOV      SFRPAGE,#03H
B3:00CB60 AF99              MOV      R7,NVRDATA
B3:00CB62 22                RET      
----- FUNCTION _ZW_FLASH_nvr0_get (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 867




----- FUNCTION ?L?COM0136 (BEGIN) -----
B3:00CB63 CF                XCH      A,R7
B3:00CB64         ?L?COM0137:
B3:00CB64 F0                MOVX     @DPTR,A
B3:00CB65 A3                INC      DPTR
B3:00CB66 EF                MOV      A,R7
B3:00CB67 F0                MOVX     @DPTR,A
B3:00CB68 7B01              MOV      R3,#01H
B3:00CB6A 22                RET      
----- FUNCTION ?L?COM0136 (END) -------


----- FUNCTION ZW_IsNVRValid (BEGIN) -----
B3:00CB6B 90123D            MOV      DPTR,#bNVRValid
B3:00CB6E E0                MOVX     A,@DPTR
B3:00CB6F 24FF              ADD      A,#0FFH
B3:00CB71 22                RET      
----- FUNCTION ZW_IsNVRValid (END) -------


----- FUNCTION TransportTimerRestart (BEGIN) -----
B3:00CB72 30240E            JNB      canRestart,?C0011?ZW_TRANSPORT_TIMER
B3:00CB75 1280A1            LCALL    ?L?COM0292
B3:00CB78 E4                CLR      A
B3:00CB79 F57E              MOV      slow_timer_count,A
B3:00CB7B D225              SETB     slow_timer_running
B3:00CB7D 75FF02            MOV      SFRPAGE,#02H
B3:00CB80 438580            ORL      SLTCON1,#080H
B3:00CB83         ?C0011?ZW_TRANSPORT_TIMER:
B3:00CB83 22                RET      
----- FUNCTION TransportTimerRestart (END) -------


----- FUNCTION TransportTimerInit (BEGIN) -----
B3:00CB84 E4                CLR      A
B3:00CB85 F57E              MOV      slow_timer_count,A
B3:00CB87 C225              CLR      slow_timer_running
B3:00CB89 22                RET      
----- FUNCTION TransportTimerInit (END) -------


----- FUNCTION ?L?COM03E1 (BEGIN) -----
B3:00CB8A EF                MOV      A,R7
B3:00CB8B         ?L?COM03E2:
B3:00CB8B 25E0              ADD      A,ACC
B3:00CB8D 25E0              ADD      A,ACC
B3:00CB8F 2457              ADD      A,#LOW exploreFrameIgnoreQueue+01H
B3:00CB91 F8                MOV      R0,A
B3:00CB92 22                RET      
----- FUNCTION ?L?COM03E1 (END) -------


----- FUNCTION ?L?COM0539 (BEGIN) -----
B3:00CB93 7A41              MOV      R2,#HIGH p
B3:00CB95 790D              MOV      R1,#LOW p
----- FUNCTION _aes_encrypt (BEGIN) -----
B3:00CB97 9044C1            MOV      DPTR,#in
B3:00CB9A 122572            LCALL    ?C?PSTXDATA
B3:00CB9D 9044C1            MOV      DPTR,#in
B3:00CBA0 122552            LCALL    ?C?PLDXDATA
B3:00CBA3 71B7              ACALL    ?L?COM03C4
B3:00CBA5 9044C4            MOV      DPTR,#out
B3:00CBA8 122552            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 868


B3:00CBAB 126E65            LCALL    ?L?COM0282
B3:00CBAE 7B01              MOV      R3,#01H
B3:00CBB0 7A2C              MOV      R2,#HIGH aes_key
B3:00CBB2 7974              MOV      R1,#LOW aes_key
B3:00CBB4 02A6D7            LJMP     _ZW_AES_ecb
----- FUNCTION _aes_encrypt (END) -------


----- FUNCTION ?L?COM03C4 (BEGIN) -----
B3:00CBB7 904304            MOV      DPTR,#?_ZW_AES_ecb?BYTE+03H
B3:00CBBA 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM03C4 (END) -------


----- FUNCTION _aes_ofb (BEGIN) -----
B3:00CBBD 904523            MOV      DPTR,#pData
B3:00CBC0 122572            LCALL    ?C?PSTXDATA
B3:00CBC3 904526            MOV      DPTR,#len
B3:00CBC6 ED                MOV      A,R5
B3:00CBC7 F0                MOVX     @DPTR,A
B3:00CBC8 E4                CLR      A
B3:00CBC9 A3                INC      DPTR
B3:00CBCA F0                MOVX     @DPTR,A
B3:00CBCB         ?C0003?ZW_SECURITY_SCHEME0:
B3:00CBCB 904526            MOV      DPTR,#len
B3:00CBCE B115              ACALL    ?L?COM023A
B3:00CBD0 5034              JNC      ?C0007?ZW_SECURITY_SCHEME0
B3:00CBD2 EE                MOV      A,R6
B3:00CBD3 540F              ANL      A,#0FH
B3:00CBD5 7006              JNZ      ?C0006?ZW_SECURITY_SCHEME0
B3:00CBD7 B10B              ACALL    ?L?COM0457
B3:00CBD9 917C              ACALL    ?L?COM0279
B3:00CBDB 7197              ACALL    _aes_encrypt
B3:00CBDD         ?C0006?ZW_SECURITY_SCHEME0:
B3:00CBDD 904523            MOV      DPTR,#pData
B3:00CBE0 122552            LCALL    ?C?PLDXDATA
B3:00CBE3 904527            MOV      DPTR,#i
B3:00CBE6 E0                MOVX     A,@DPTR
B3:00CBE7 FF                MOV      R7,A
B3:00CBE8 29                ADD      A,R1
B3:00CBE9 1252DD            LCALL    ?L?COM0009
B3:00CBEC FE                MOV      R6,A
B3:00CBED EF                MOV      A,R7
B3:00CBEE 540F              ANL      A,#0FH
B3:00CBF0 24ED              ADD      A,#LOW aes_iv
B3:00CBF2 F582              MOV      DPL,A
B3:00CBF4 E4                CLR      A
B3:00CBF5 342D              ADDC     A,#HIGH aes_iv
B3:00CBF7 F583              MOV      DPH,A
B3:00CBF9 E0                MOVX     A,@DPTR
B3:00CBFA 6E                XRL      A,R6
B3:00CBFB 12203B            LCALL    ?C?CSTPTR
B3:00CBFE 904527            MOV      DPTR,#i
B3:00CC01 E0                MOVX     A,@DPTR
B3:00CC02 04                INC      A
B3:00CC03 F0                MOVX     @DPTR,A
B3:00CC04 80C5              SJMP     ?C0003?ZW_SECURITY_SCHEME0
B3:00CC06         ?C0007?ZW_SECURITY_SCHEME0:
B3:00CC06 22                RET      
----- FUNCTION _aes_ofb (END) -------


----- FUNCTION _aes_cbc_mac (BEGIN) -----
B3:00CC07 90437A            MOV      DPTR,#pData
B3:00CC0A 122572            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 869


B3:00CC0D 90437D            MOV      DPTR,#len
B3:00CC10 ED                MOV      A,R5
B3:00CC11 F0                MOVX     @DPTR,A
B3:00CC12 9178              ACALL    ?L?COM0277
B3:00CC14 B10B              ACALL    ?L?COM0457
B3:00CC16 7197              ACALL    _aes_encrypt
B3:00CC18 E4                CLR      A
B3:00CC19 904381            MOV      DPTR,#i
B3:00CC1C F0                MOVX     @DPTR,A
B3:00CC1D         ?C0008?ZW_SECURITY_SCHEME0:
B3:00CC1D 90437D            MOV      DPTR,#len
B3:00CC20 E0                MOVX     A,@DPTR
B3:00CC21 FF                MOV      R7,A
B3:00CC22 904381            MOV      DPTR,#i
B3:00CC25 E0                MOVX     A,@DPTR
B3:00CC26 FE                MOV      R6,A
B3:00CC27 C3                CLR      C
B3:00CC28 9F                SUBB     A,R7
B3:00CC29 503E              JNC      ?C0009?ZW_SECURITY_SCHEME0
B3:00CC2B 9182              ACALL    ?L?COM0458
B3:00CC2D EE                MOV      A,R6
B3:00CC2E 540F              ANL      A,#0FH
B3:00CC30 FF                MOV      R7,A
B3:00CC31 29                ADD      A,R1
B3:00CC32 F9                MOV      R1,A
B3:00CC33 E4                CLR      A
B3:00CC34 3A                ADDC     A,R2
B3:00CC35 FA                MOV      R2,A
B3:00CC36 C003              PUSH     AR3
B3:00CC38 C002              PUSH     AR2
B3:00CC3A C001              PUSH     AR1
B3:00CC3C 121F7C            LCALL    ?C?CLDPTR
B3:00CC3F FD                MOV      R5,A
B3:00CC40 90437A            MOV      DPTR,#pData
B3:00CC43 122552            LCALL    ?C?PLDXDATA
B3:00CC46 E9                MOV      A,R1
B3:00CC47 2E                ADD      A,R6
B3:00CC48 1252DD            LCALL    ?L?COM0009
B3:00CC4B 6D                XRL      A,R5
B3:00CC4C D001              POP      AR1
B3:00CC4E D002              POP      AR2
B3:00CC50 D003              POP      AR3
B3:00CC52 12203B            LCALL    ?C?CSTPTR
B3:00CC55 BF0F09            CJNE     R7,#0FH,?C0010?ZW_SECURITY_SCHEME0
B3:00CC58 90437E            MOV      DPTR,#mac
B3:00CC5B 9179              ACALL    ?L?COM0278
B3:00CC5D 9182              ACALL    ?L?COM0458
B3:00CC5F 7197              ACALL    _aes_encrypt
B3:00CC61         ?C0010?ZW_SECURITY_SCHEME0:
B3:00CC61 904381            MOV      DPTR,#i
B3:00CC64 E0                MOVX     A,@DPTR
B3:00CC65 04                INC      A
B3:00CC66 F0                MOVX     @DPTR,A
B3:00CC67 80B4              SJMP     ?C0008?ZW_SECURITY_SCHEME0
B3:00CC69         ?C0009?ZW_SECURITY_SCHEME0:
B3:00CC69 90437D            MOV      DPTR,#len
B3:00CC6C E0                MOVX     A,@DPTR
B3:00CC6D 540F              ANL      A,#0FH
B3:00CC6F 6006              JZ       ?C0013?ZW_SECURITY_SCHEME0
B3:00CC71 9178              ACALL    ?L?COM0277
B3:00CC73 9182              ACALL    ?L?COM0458
B3:00CC75 7197              ACALL    _aes_encrypt
B3:00CC77         ?C0013?ZW_SECURITY_SCHEME0:
B3:00CC77 22                RET      
----- FUNCTION _aes_cbc_mac (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 870




----- FUNCTION ?L?COM0277 (BEGIN) -----
B3:00CC78 A3                INC      DPTR
B3:00CC79         ?L?COM0278:
B3:00CC79 122552            LCALL    ?C?PLDXDATA
B3:00CC7C         ?L?COM0279:
B3:00CC7C 9044C4            MOV      DPTR,#?_aes_encrypt?BYTE+03H
B3:00CC7F 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0277 (END) -------


----- FUNCTION ?L?COM0458 (BEGIN) -----
B3:00CC82 90437E            MOV      DPTR,#mac
B3:00CC85 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0458 (END) -------


----- FUNCTION _sec2_send_data_multi (BEGIN) -----
B3:00CC88 9040EA            MOV      DPTR,#vdata
B3:00CC8B 122572            LCALL    ?C?PSTXDATA
;---- Variable 'len' assigned to Register 'R4/R5' ----
B3:00CC8E 9040EF            MOV      DPTR,#txOptionsMultiEx
B3:00CC91 B16D              ACALL    ?L?COM02D3
B3:00CC93 1252DD            LCALL    ?L?COM0009
B3:00CC96 9040F4            MOV      DPTR,#s2_con
B3:00CC99 F0                MOVX     @DPTR,A
B3:00CC9A 9040EF            MOV      DPTR,#txOptionsMultiEx
B3:00CC9D 12A3E6            LCALL    ?L?COM0077
B3:00CCA0 9040F5            MOV      DPTR,#s2_con+01H
B3:00CCA3 F0                MOVX     @DPTR,A
B3:00CCA4 E4                CLR      A
B3:00CCA5 A3                INC      DPTR
B3:00CCA6 F0                MOVX     @DPTR,A
B3:00CCA7 E9                MOV      A,R1
B3:00CCA8 2402              ADD      A,#02H
B3:00CCAA 1252DD            LCALL    ?L?COM0009
B3:00CCAD 9040F8            MOV      DPTR,#s2_con+04H
B3:00CCB0 F0                MOVX     @DPTR,A
B3:00CCB1 9040EF            MOV      DPTR,#txOptionsMultiEx
B3:00CCB4 122552            LCALL    ?C?PLDXDATA
B3:00CCB7 E9                MOV      A,R1
B3:00CCB8 2403              ADD      A,#03H
B3:00CCBA 1252DD            LCALL    ?L?COM0009
B3:00CCBD 14                DEC      A
B3:00CCBE 9040FB            MOV      DPTR,#s2_con+07H
B3:00CCC1 F0                MOVX     @DPTR,A
B3:00CCC2 903CB2            MOV      DPTR,#s2_send_multi_callback
B3:00CCC5 E0                MOVX     A,@DPTR
B3:00CCC6 FF                MOV      R7,A
B3:00CCC7 A3                INC      DPTR
B3:00CCC8 E0                MOVX     A,@DPTR
B3:00CCC9 903CB7            MOV      DPTR,#cb_multi_save
B3:00CCCC CF                XCH      A,R7
B3:00CCCD F0                MOVX     @DPTR,A
B3:00CCCE A3                INC      DPTR
B3:00CCCF EF                MOV      A,R7
B3:00CCD0 F0                MOVX     @DPTR,A
B3:00CCD1 9040F2            MOV      DPTR,#callback
B3:00CCD4 91FE              ACALL    ?L?COM03DD
B3:00CCD6 9040EA            MOV      DPTR,#vdata
B3:00CCD9 122552            LCALL    ?C?PLDXDATA
B3:00CCDC 904131            MOV      DPTR,#?___S2_send_data_multicast?BYTE+03H
B3:00CCDF 122572            LCALL    ?C?PSTXDATA
B3:00CCE2 AF05              MOV      R7,AR5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 871


B3:00CCE4 904134            MOV      DPTR,#?___S2_send_data_multicast?BYTE+06H
B3:00CCE7 EC                MOV      A,R4
B3:00CCE8 7164              ACALL    ?L?COM0137
B3:00CCEA 7A40              MOV      R2,#HIGH s2_con
B3:00CCEC 79F4              MOV      R1,#LOW s2_con
B3:00CCEE B129              ACALL    ___S2_send_data_multicast
B3:00CCF0 EF                MOV      A,R7
B3:00CCF1 6003              JZ       ?C0023?ZW_SECURITY_SCHEME2
B3:00CCF3 7F01              MOV      R7,#01H
B3:00CCF5 22                RET      
B3:00CCF6         ?C0023?ZW_SECURITY_SCHEME2:
B3:00CCF6 903CB7            MOV      DPTR,#cb_multi_save
B3:00CCF9 91FE              ACALL    ?L?COM03DD
B3:00CCFB         ?C0025?ZW_SECURITY_SCHEME2:
B3:00CCFB 7F00              MOV      R7,#00H
B3:00CCFD 22                RET      
----- FUNCTION _sec2_send_data_multi (END) -------


----- FUNCTION ?L?COM03DD (BEGIN) -----
B3:00CCFE E0                MOVX     A,@DPTR
B3:00CCFF FF                MOV      R7,A
B3:00CD00 A3                INC      DPTR
B3:00CD01 E0                MOVX     A,@DPTR
B3:00CD02 903CB2            MOV      DPTR,#s2_send_multi_callback
B3:00CD05 CF                XCH      A,R7
B3:00CD06 F0                MOVX     @DPTR,A
B3:00CD07 A3                INC      DPTR
B3:00CD08 EF                MOV      A,R7
B3:00CD09 F0                MOVX     @DPTR,A
B3:00CD0A 22                RET      
----- FUNCTION ?L?COM03DD (END) -------


----- FUNCTION ?L?COM0457 (BEGIN) -----
B3:00CD0B 7B01              MOV      R3,#01H
B3:00CD0D 7A2D              MOV      R2,#HIGH aes_iv
B3:00CD0F 79ED              MOV      R1,#LOW aes_iv
B3:00CD11 22                RET      
----- FUNCTION ?L?COM0457 (END) -------


----- FUNCTION ?L?COM0239 (BEGIN) -----
B3:00CD12 9043A8            MOV      DPTR,#len
B3:00CD15         ?L?COM023A:
B3:00CD15 E0                MOVX     A,@DPTR
B3:00CD16 FF                MOV      R7,A
B3:00CD17 A3                INC      DPTR
B3:00CD18 E0                MOVX     A,@DPTR
B3:00CD19 FE                MOV      R6,A
B3:00CD1A C3                CLR      C
B3:00CD1B 9F                SUBB     A,R7
B3:00CD1C 22                RET      
----- FUNCTION ?L?COM0239 (END) -------


----- FUNCTION ?L?COM0053 (BEGIN) -----
B3:00CD1D FF                MOV      R7,A
B3:00CD1E         ?L?COM0054:
B3:00CD1E 122552            LCALL    ?C?PLDXDATA
B3:00CD21 E9                MOV      A,R1
B3:00CD22 2401              ADD      A,#01H
B3:00CD24 F9                MOV      R1,A
B3:00CD25 E4                CLR      A
B3:00CD26 3A                ADDC     A,R2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 872


B3:00CD27 FA                MOV      R2,A
B3:00CD28 22                RET      
----- FUNCTION ?L?COM0053 (END) -------


----- FUNCTION ___S2_send_data_multicast (BEGIN) -----
B3:00CD29 90412E            MOV      DPTR,#con
B3:00CD2C 122572            LCALL    ?C?PSTXDATA
B3:00CD2F 12E9C5            LCALL    __S2_is_send_data_multicast_busy
B3:00CD32 EF                MOV      A,R7
B3:00CD33 6003              JZ       ?C0258?S2
B3:00CD35 7F00              MOV      R7,#00H
B3:00CD37 22                RET      
B3:00CD38         ?C0258?S2:
B3:00CD38 904131            MOV      DPTR,#buf
B3:00CD3B 122552            LCALL    ?C?PLDXDATA
B3:00CD3E 904139            MOV      DPTR,#e+03H
B3:00CD41 122572            LCALL    ?C?PSTXDATA
B3:00CD44 904134            MOV      DPTR,#len
B3:00CD47 E0                MOVX     A,@DPTR
B3:00CD48 FF                MOV      R7,A
B3:00CD49 A3                INC      DPTR
B3:00CD4A E0                MOVX     A,@DPTR
B3:00CD4B 90413C            MOV      DPTR,#e+06H
B3:00CD4E CF                XCH      A,R7
B3:00CD4F F0                MOVX     @DPTR,A
B3:00CD50 A3                INC      DPTR
B3:00CD51 EF                MOV      A,R7
B3:00CD52 F0                MOVX     @DPTR,A
B3:00CD53 90412E            MOV      DPTR,#con
B3:00CD56 122552            LCALL    ?C?PLDXDATA
B3:00CD59 904136            MOV      DPTR,#e
B3:00CD5C 122572            LCALL    ?C?PSTXDATA
B3:00CD5F 7B01              MOV      R3,#01H
B3:00CD61 7A41              MOV      R2,#HIGH e
B3:00CD63 7936              MOV      R1,#LOW e
B3:00CD65 7F01              MOV      R7,#01H
B3:00CD67 128CD5            LCALL    ___S2_fsm_post_event
B3:00CD6A 7F01              MOV      R7,#01H
B3:00CD6C 22                RET      
----- FUNCTION ___S2_send_data_multicast (END) -------


----- FUNCTION ?L?COM02D3 (BEGIN) -----
B3:00CD6D 122552            LCALL    ?C?PLDXDATA
B3:00CD70 E9                MOV      A,R1
B3:00CD71 2401              ADD      A,#01H
B3:00CD73 22                RET      
----- FUNCTION ?L?COM02D3 (END) -------


----- FUNCTION _Security2CommandHandler (BEGIN) -----
B3:00CD74 90415D            MOV      DPTR,#pCmd
B3:00CD77 122572            LCALL    ?C?PSTXDATA
B3:00CD7A 904160            MOV      DPTR,#cmdLength
B3:00CD7D ED                MOV      A,R5
B3:00CD7E F0                MOVX     @DPTR,A
B3:00CD7F A3                INC      DPTR
B3:00CD80 B16D              ACALL    ?L?COM02D3
B3:00CD82 1252DD            LCALL    ?L?COM0009
B3:00CD85 FC                MOV      R4,A
B3:00CD86 904165            MOV      DPTR,#conn+01H
B3:00CD89 F0                MOVX     @DPTR,A
B3:00CD8A 901221            MOV      DPTR,#nodeID
B3:00CD8D E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 873


B3:00CD8E FD                MOV      R5,A
B3:00CD8F 904164            MOV      DPTR,#conn
B3:00CD92 F0                MOVX     @DPTR,A
B3:00CD93 904161            MOV      DPTR,#rxopt
B3:00CD96 12A3E6            LCALL    ?L?COM0077
B3:00CD99 540C              ANL      A,#0CH
B3:00CD9B 7E00              MOV      R6,#00H
B3:00CD9D 6002              JZ       ?C0031?ZW_SECURITY_SCHEME2
B3:00CD9F 7E01              MOV      R6,#01H
B3:00CDA1         ?C0031?ZW_SECURITY_SCHEME2:
B3:00CDA1         ?C0032?ZW_SECURITY_SCHEME2:
B3:00CDA1 904167            MOV      DPTR,#conn+03H
B3:00CDA4 EE                MOV      A,R6
B3:00CDA5 F0                MOVX     @DPTR,A
B3:00CDA6 121F7C            LCALL    ?C?CLDPTR
B3:00CDA9 904169            MOV      DPTR,#conn+05H
B3:00CDAC F0                MOVX     @DPTR,A
B3:00CDAD 7E00              MOV      R6,#00H
B3:00CDAF 30E102            JNB      ACC.1,?C0033?ZW_SECURITY_SCHEME2
B3:00CDB2 7E02              MOV      R6,#02H
B3:00CDB4         ?C0033?ZW_SECURITY_SCHEME2:
B3:00CDB4         ?C0034?ZW_SECURITY_SCHEME2:
B3:00CDB4 EE                MOV      A,R6
B3:00CDB5 4405              ORL      A,#05H
B3:00CDB7 904168            MOV      DPTR,#conn+04H
B3:00CDBA F0                MOVX     @DPTR,A
B3:00CDBB 904161            MOV      DPTR,#rxopt
B3:00CDBE 122552            LCALL    ?C?PLDXDATA
B3:00CDC1 E9                MOV      A,R1
B3:00CDC2 2403              ADD      A,#03H
B3:00CDC4 1252DD            LCALL    ?L?COM0009
B3:00CDC7 90416A            MOV      DPTR,#conn+06H
B3:00CDCA F0                MOVX     @DPTR,A
B3:00CDCB 90415D            MOV      DPTR,#pCmd
B3:00CDCE 12A3E6            LCALL    ?L?COM0077
B3:00CDD1 649F              XRL      A,#09FH
B3:00CDD3 702B              JNZ      ?C0036?ZW_SECURITY_SCHEME2
B3:00CDD5         ?C0035?ZW_SECURITY_SCHEME2:
B3:00CDD5 E9                MOV      A,R1
B3:00CDD6 2401              ADD      A,#01H
B3:00CDD8 1252DD            LCALL    ?L?COM0009
B3:00CDDB B40404            CJNE     A,#04H,?C0037?ZW_SECURITY_SCHEME2
B3:00CDDE AF04              MOV      R7,AR4
B3:00CDE0 D101              ACALL    ___S2_set_inclusion_peer
B3:00CDE2         ?C0037?ZW_SECURITY_SCHEME2:
B3:00CDE2 90415D            MOV      DPTR,#pCmd
B3:00CDE5 122552            LCALL    ?C?PLDXDATA
B3:00CDE8 903FFC            MOV      DPTR,#?___S2_application_command_handler?BYTE+03H
B3:00CDEB 122572            LCALL    ?C?PSTXDATA
B3:00CDEE 904160            MOV      DPTR,#cmdLength
B3:00CDF1 E0                MOVX     A,@DPTR
B3:00CDF2 FF                MOV      R7,A
B3:00CDF3 903FFF            MOV      DPTR,#?___S2_application_command_handler?BYTE+06H
B3:00CDF6 E4                CLR      A
B3:00CDF7 7164              ACALL    ?L?COM0137
B3:00CDF9 7A41              MOV      R2,#HIGH conn
B3:00CDFB 7964              MOV      R1,#LOW conn
B3:00CDFD 12A4A2            LCALL    ___S2_application_command_handler
B3:00CE00         ?C0036?ZW_SECURITY_SCHEME2:
B3:00CE00 22                RET      
----- FUNCTION _Security2CommandHandler (END) -------


----- FUNCTION ___S2_set_inclusion_peer (BEGIN) -----
;---- Variable 'my_nodeid' assigned to Register 'R5' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 874


;---- Variable 'inclusion_peer_nodeid' assigned to Register 'R7' ----
B3:00CE01 9028D3            MOV      DPTR,#the_context+0CFH
B3:00CE04 ED                MOV      A,R5
B3:00CE05 F0                MOVX     @DPTR,A
B3:00CE06 A3                INC      DPTR
B3:00CE07 EF                MOV      A,R7
B3:00CE08 F0                MOVX     @DPTR,A
B3:00CE09 22                RET      
----- FUNCTION ___S2_set_inclusion_peer (END) -------


----- FUNCTION _aes_random8 (BEGIN) -----
B3:00CE0A 9040B2            MOV      DPTR,#d
B3:00CE0D 122572            LCALL    ?C?PSTXDATA
B3:00CE10 7B01              MOV      R3,#01H
B3:00CE12 7A40              MOV      R2,#HIGH rtemp
B3:00CE14 79B5              MOV      R1,#LOW rtemp
B3:00CE16 12DAEA            LCALL    ?L?COM013A
B3:00CE19 7B01              MOV      R3,#01H
B3:00CE1B 7A40              MOV      R2,#HIGH rtemp
B3:00CE1D 79B5              MOV      R1,#LOW rtemp
B3:00CE1F 128549            LCALL    ?L?COM0019
B3:00CE22 9040B2            MOV      DPTR,#d
B3:00CE25 122552            LCALL    ?C?PLDXDATA
B3:00CE28 7F08              MOV      R7,#08H
B3:00CE2A 028195            LJMP     ___ZW_memcpy
----- FUNCTION _aes_random8 (END) -------


----- FUNCTION _register_nonce (BEGIN) -----
B3:00CE2D 904434            MOV      DPTR,#src
B3:00CE30 126563            LCALL    ?L?COM00E9
B3:00CE33 EB                MOV      A,R3
B3:00CE34 F0                MOVX     @DPTR,A
B3:00CE35 604B              JZ       ?C0015?ZW_SECURITY_SCHEME0
B3:00CE37 E4                CLR      A
B3:00CE38 90443A            MOV      DPTR,#i
B3:00CE3B F0                MOVX     @DPTR,A
B3:00CE3C         ?C0016?ZW_SECURITY_SCHEME0:
B3:00CE3C 12EF53            LCALL    ?L?COM0509
B3:00CE3F 5041              JNC      ?C0015?ZW_SECURITY_SCHEME0
B3:00CE41 EF                MOV      A,R7
B3:00CE42 12EEA6            LCALL    ?L?COM03A3
B3:00CE45 E0                MOVX     A,@DPTR
B3:00CE46 6032              JZ       ?C0018?ZW_SECURITY_SCHEME0
B3:00CE48 90443A            MOV      DPTR,#i
B3:00CE4B E0                MOVX     A,@DPTR
B3:00CE4C 12D19B            LCALL    ?L?COM00A2
B3:00CE4F E0                MOVX     A,@DPTR
B3:00CE50 D3                SETB     C
B3:00CE51 9400              SUBB     A,#00H
B3:00CE53 4025              JC       ?C0018?ZW_SECURITY_SCHEME0
B3:00CE55 EF                MOV      A,R7
B3:00CE56 12D14F            LCALL    ?L?COM01EC
B3:00CE59 E0                MOVX     A,@DPTR
B3:00CE5A FF                MOV      R7,A
B3:00CE5B 904434            MOV      DPTR,#src
B3:00CE5E E0                MOVX     A,@DPTR
B3:00CE5F FE                MOV      R6,A
B3:00CE60 EF                MOV      A,R7
B3:00CE61 6E                XRL      A,R6
B3:00CE62 7016              JNZ      ?C0018?ZW_SECURITY_SCHEME0
B3:00CE64 90443A            MOV      DPTR,#i
B3:00CE67 E0                MOVX     A,@DPTR
B3:00CE68 FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 875


B3:00CE69 12D1A9            LCALL    ?L?COM01ED
B3:00CE6C E0                MOVX     A,@DPTR
B3:00CE6D FE                MOV      R6,A
B3:00CE6E 904435            MOV      DPTR,#dst
B3:00CE71 E0                MOVX     A,@DPTR
B3:00CE72 FD                MOV      R5,A
B3:00CE73 EE                MOV      A,R6
B3:00CE74 6D                XRL      A,R5
B3:00CE75 7003              JNZ      ?C0018?ZW_SECURITY_SCHEME0
B3:00CE77 EF                MOV      A,R7
B3:00CE78 8041              SJMP     ?C0173?ZW_SECURITY_SCHEME0
B3:00CE7A         ?C0018?ZW_SECURITY_SCHEME0:
B3:00CE7A 90443A            MOV      DPTR,#i
B3:00CE7D E0                MOVX     A,@DPTR
B3:00CE7E 04                INC      A
B3:00CE7F F0                MOVX     @DPTR,A
B3:00CE80 80BA              SJMP     ?C0016?ZW_SECURITY_SCHEME0
B3:00CE82         ?C0015?ZW_SECURITY_SCHEME0:
B3:00CE82 E4                CLR      A
B3:00CE83 90443A            MOV      DPTR,#i
B3:00CE86 F0                MOVX     @DPTR,A
B3:00CE87         ?C0021?ZW_SECURITY_SCHEME0:
B3:00CE87 12EF53            LCALL    ?L?COM0509
B3:00CE8A 5063              JNC      ?C0022?ZW_SECURITY_SCHEME0
B3:00CE8C 12D19A            LCALL    ?L?COM00A1
B3:00CE8F E0                MOVX     A,@DPTR
B3:00CE90 7055              JNZ      ?C0023?ZW_SECURITY_SCHEME0
B3:00CE92 904434            MOV      DPTR,#src
B3:00CE95 E0                MOVX     A,@DPTR
B3:00CE96 FF                MOV      R7,A
B3:00CE97 90443A            MOV      DPTR,#i
B3:00CE9A E0                MOVX     A,@DPTR
B3:00CE9B FE                MOV      R6,A
B3:00CE9C 12D14F            LCALL    ?L?COM01EC
B3:00CE9F EF                MOV      A,R7
B3:00CEA0 F0                MOVX     @DPTR,A
B3:00CEA1 904435            MOV      DPTR,#dst
B3:00CEA4 E0                MOVX     A,@DPTR
B3:00CEA5 FF                MOV      R7,A
B3:00CEA6 EE                MOV      A,R6
B3:00CEA7 12D1A9            LCALL    ?L?COM01ED
B3:00CEAA EF                MOV      A,R7
B3:00CEAB F0                MOVX     @DPTR,A
B3:00CEAC 904436            MOV      DPTR,#reply_nonce
B3:00CEAF E0                MOVX     A,@DPTR
B3:00CEB0 FF                MOV      R7,A
B3:00CEB1 EE                MOV      A,R6
B3:00CEB2 12EEA6            LCALL    ?L?COM03A3
B3:00CEB5 EF                MOV      A,R7
B3:00CEB6 F0                MOVX     @DPTR,A
B3:00CEB7 90443A            MOV      DPTR,#i
B3:00CEBA E0                MOVX     A,@DPTR
B3:00CEBB         
B3:00CEBB 12D1C7            LCALL    ?L?COM03E0
B3:00CEBE 7B01              MOV      R3,#01H
B3:00CEC0 C003              PUSH     AR3
B3:00CEC2 C002              PUSH     AR2
B3:00CEC4 C001              PUSH     AR1
B3:00CEC6 904437            MOV      DPTR,#nonce
B3:00CEC9 122552            LCALL    ?C?PLDXDATA
B3:00CECC 128549            LCALL    ?L?COM0019
B3:00CECF D001              POP      AR1
B3:00CED1 D002              POP      AR2
B3:00CED3 D003              POP      AR3
B3:00CED5 7F08              MOV      R7,#08H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 876


B3:00CED7 128195            LCALL    ___ZW_memcpy
B3:00CEDA 90443A            MOV      DPTR,#i
B3:00CEDD E0                MOVX     A,@DPTR
B3:00CEDE 12D19B            LCALL    ?L?COM00A2
B3:00CEE1 740A              MOV      A,#0AH
B3:00CEE3 F0                MOVX     @DPTR,A
B3:00CEE4 7F01              MOV      R7,#01H
B3:00CEE6 22                RET      
B3:00CEE7         ?C0023?ZW_SECURITY_SCHEME0:
B3:00CEE7 90443A            MOV      DPTR,#i
B3:00CEEA E0                MOVX     A,@DPTR
B3:00CEEB 04                INC      A
B3:00CEEC F0                MOVX     @DPTR,A
B3:00CEED 8098              SJMP     ?C0021?ZW_SECURITY_SCHEME0
B3:00CEEF         ?C0022?ZW_SECURITY_SCHEME0:
B3:00CEEF 7F00              MOV      R7,#00H
B3:00CEF1 22                RET      
----- FUNCTION _register_nonce (END) -------


----- FUNCTION _encrypt_msg (BEGIN) -----
B3:00CEF2 903D5E            MOV      DPTR,#pass2
B3:00CEF5 EF                MOV      A,R7
B3:00CEF6 F0                MOVX     @DPTR,A
;---- Variable 'maxlen' assigned to Register 'R7' ----
B3:00CEF7 7F2E              MOV      R7,#02EH
B3:00CEF9 902D97            MOV      DPTR,#the_tx_session+09H
B3:00CEFC E0                MOVX     A,@DPTR
B3:00CEFD FE                MOV      R6,A
B3:00CEFE 903D87            MOV      DPTR,#len
B3:00CF01 F0                MOVX     @DPTR,A
B3:00CF02 E4                CLR      A
B3:00CF03 A3                INC      DPTR
B3:00CF04 F0                MOVX     @DPTR,A
B3:00CF05 EE                MOV      A,R6
B3:00CF06 2414              ADD      A,#014H
B3:00CF08 FD                MOV      R5,A
B3:00CF09 E4                CLR      A
B3:00CF0A 33                RLC      A
B3:00CF0B FC                MOV      R4,A
B3:00CF0C D3                SETB     C
B3:00CF0D ED                MOV      A,R5
B3:00CF0E 942E              SUBB     A,#02EH
B3:00CF10 7480              MOV      A,#080H
B3:00CF12 F8                MOV      R0,A
B3:00CF13 6C                XRL      A,R4
B3:00CF14 98                SUBB     A,R0
B3:00CF15 400B              JC       ?C0049?ZW_SECURITY_SCHEME0
B3:00CF17 EF                MOV      A,R7
B3:00CF18 24EC              ADD      A,#0ECH
B3:00CF1A 903D87            MOV      DPTR,#len
B3:00CF1D F0                MOVX     @DPTR,A
B3:00CF1E A3                INC      DPTR
B3:00CF1F 7401              MOV      A,#01H
B3:00CF21 F0                MOVX     @DPTR,A
B3:00CF22         ?C0049?ZW_SECURITY_SCHEME0:
B3:00CF22 12D0BA            LCALL    ?L?COM03AF
B3:00CF25 D10A              ACALL    _aes_random8
B3:00CF27 902D8F            MOV      DPTR,#the_tx_session+01H
B3:00CF2A E0                MOVX     A,@DPTR
B3:00CF2B FF                MOV      R7,A
B3:00CF2C 902D8E            MOV      DPTR,#the_tx_session
B3:00CF2F 7A3D              MOV      R2,#HIGH tmpnonce
B3:00CF31 797F              MOV      R1,#LOW tmpnonce
B3:00CF33 12EE3F            LCALL    ?L?COM0256
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 877


B3:00CF36 903D5F            MOV      DPTR,#iv
B3:00CF39 12D1B7            LCALL    ?L?COM04AE
B3:00CF3C 70E4              JNZ      ?C0049?ZW_SECURITY_SCHEME0
B3:00CF3E 12EF4A            LCALL    ?L?COM0508
B3:00CF41 7B01              MOV      R3,#01H
B3:00CF43 7A3D              MOV      R2,#HIGH iv+08H
B3:00CF45 7967              MOV      R1,#LOW iv+08H
B3:00CF47 904385            MOV      DPTR,#?_get_nonce?BYTE+03H
B3:00CF4A 122572            LCALL    ?C?PSTXDATA
B3:00CF4D 904388            MOV      DPTR,#?_get_nonce?BYTE+06H
B3:00CF50 7401              MOV      A,#01H
B3:00CF52 F0                MOVX     @DPTR,A
B3:00CF53 1B                DEC      R3
B3:00CF54 12D0CD            LCALL    _get_nonce
B3:00CF57 EF                MOV      A,R7
B3:00CF58 7002              JNZ      ?C0050?ZW_SECURITY_SCHEME0
B3:00CF5A FF                MOV      R7,A
B3:00CF5B 22                RET      
B3:00CF5C         ?C0050?ZW_SECURITY_SCHEME0:
B3:00CF5C 12EF4A            LCALL    ?L?COM0508
B3:00CF5F 12D15D            LCALL    _nonce_clear
B3:00CF62         ?C0052?ZW_SECURITY_SCHEME0:
B3:00CF62 902D8F            MOV      DPTR,#the_tx_session+01H
B3:00CF65 E0                MOVX     A,@DPTR
B3:00CF66 FF                MOV      R7,A
B3:00CF67 902D8E            MOV      DPTR,#the_tx_session
B3:00CF6A 7A3D              MOV      R2,#HIGH iv
B3:00CF6C 795F              MOV      R1,#LOW iv
B3:00CF6E 12D2E6            LCALL    ?L?COM0189
B3:00CF71 D12D              ACALL    _register_nonce
B3:00CF73 7B01              MOV      R3,#01H
B3:00CF75 7A2D              MOV      R2,#HIGH the_tx_session+025H
B3:00CF77 79B3              MOV      R1,#LOW the_tx_session+025H
B3:00CF79 903D89            MOV      DPTR,#enc_data
B3:00CF7C 122572            LCALL    ?C?PSTXDATA
B3:00CF7F 7A2D              MOV      R2,#HIGH the_tx_session+021H
B3:00CF81 79AF              MOV      R1,#LOW the_tx_session+021H
B3:00CF83 903D8C            MOV      DPTR,#auth
B3:00CF86 122572            LCALL    ?C?PSTXDATA
B3:00CF89 903D5E            MOV      DPTR,#pass2
B3:00CF8C E0                MOVX     A,@DPTR
B3:00CF8D 600A              JZ       ?C0053?ZW_SECURITY_SCHEME0
B3:00CF8F 902DD7            MOV      DPTR,#the_tx_session+049H
B3:00CF92 E0                MOVX     A,@DPTR
B3:00CF93 540F              ANL      A,#0FH
B3:00CF95 4430              ORL      A,#030H
B3:00CF97 800E              SJMP     ?C0174?ZW_SECURITY_SCHEME0
B3:00CF99         ?C0053?ZW_SECURITY_SCHEME0:
B3:00CF99 903D88            MOV      DPTR,#more_to_send
B3:00CF9C E0                MOVX     A,@DPTR
B3:00CF9D 600F              JZ       ?C0055?ZW_SECURITY_SCHEME0
B3:00CF9F 902DD7            MOV      DPTR,#the_tx_session+049H
B3:00CFA2 E0                MOVX     A,@DPTR
B3:00CFA3 540F              ANL      A,#0FH
B3:00CFA5 4410              ORL      A,#010H
B3:00CFA7         
B3:00CFA7 FF                MOV      R7,A
B3:00CFA8 12EEFE            LCALL    ?L?COM0459
B3:00CFAB EF                MOV      A,R7
B3:00CFAC 8004              SJMP     ?C0175?ZW_SECURITY_SCHEME0
B3:00CFAE         ?C0055?ZW_SECURITY_SCHEME0:
B3:00CFAE 12EEFE            LCALL    ?L?COM0459
B3:00CFB1 E4                CLR      A
B3:00CFB2         
B3:00CFB2 12203B            LCALL    ?C?CSTPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 878


B3:00CFB5         ?C0054?ZW_SECURITY_SCHEME0:
B3:00CFB5 903D87            MOV      DPTR,#len
B3:00CFB8 E0                MOVX     A,@DPTR
B3:00CFB9 903D89            MOV      DPTR,#enc_data
B3:00CFBC B11D              ACALL    ?L?COM0053
B3:00CFBE C003              PUSH     AR3
B3:00CFC0 C002              PUSH     AR2
B3:00CFC2 C001              PUSH     AR1
B3:00CFC4 902D94            MOV      DPTR,#the_tx_session+06H
B3:00CFC7 122552            LCALL    ?C?PLDXDATA
B3:00CFCA 128549            LCALL    ?L?COM0019
B3:00CFCD D001              POP      AR1
B3:00CFCF D002              POP      AR2
B3:00CFD1 D003              POP      AR3
B3:00CFD3 128195            LCALL    ___ZW_memcpy
B3:00CFD6 12D0BA            LCALL    ?L?COM03AF
B3:00CFD9 12D0C7            LCALL    ?L?COM02CC
B3:00CFDC 12854F            LCALL    ?L?COM053A
B3:00CFDF 12EEFE            LCALL    ?L?COM0459
B3:00CFE2 903D87            MOV      DPTR,#len
B3:00CFE5 E0                MOVX     A,@DPTR
B3:00CFE6 04                INC      A
B3:00CFE7 FD                MOV      R5,A
B3:00CFE8 71BD              ACALL    _aes_ofb
B3:00CFEA 903D88            MOV      DPTR,#more_to_send
B3:00CFED E0                MOVX     A,@DPTR
B3:00CFEE 7F81              MOV      R7,#081H
B3:00CFF0 6002              JZ       ?C0057?ZW_SECURITY_SCHEME0
B3:00CFF2 7FC1              MOV      R7,#0C1H
B3:00CFF4         ?C0057?ZW_SECURITY_SCHEME0:
B3:00CFF4         ?C0058?ZW_SECURITY_SCHEME0:
B3:00CFF4 903D8C            MOV      DPTR,#auth
B3:00CFF7 1256DF            LCALL    ?L?COM0125
B3:00CFFA 902D8F            MOV      DPTR,#the_tx_session+01H
B3:00CFFD E0                MOVX     A,@DPTR
B3:00CFFE FF                MOV      R7,A
B3:00CFFF 903D8C            MOV      DPTR,#auth
B3:00D002 12CD1E            LCALL    ?L?COM0054
B3:00D005 EF                MOV      A,R7
B3:00D006 12203B            LCALL    ?C?CSTPTR
B3:00D009 902D8E            MOV      DPTR,#the_tx_session
B3:00D00C E0                MOVX     A,@DPTR
B3:00D00D FF                MOV      R7,A
B3:00D00E 903D8C            MOV      DPTR,#auth
B3:00D011 12858F            LCALL    ?L?COM00AA
B3:00D014 EF                MOV      A,R7
B3:00D015 12203B            LCALL    ?C?CSTPTR
B3:00D018 903D87            MOV      DPTR,#len
B3:00D01B E0                MOVX     A,@DPTR
B3:00D01C 04                INC      A
B3:00D01D FF                MOV      R7,A
B3:00D01E 903D8C            MOV      DPTR,#auth
B3:00D021 1289B7            LCALL    ?L?COM004D
B3:00D024 EF                MOV      A,R7
B3:00D025 12203B            LCALL    ?C?CSTPTR
B3:00D028 11BA              ACALL    ?L?COM03AF
B3:00D02A 11C7              ACALL    ?L?COM02CC
B3:00D02C 1285BE            LCALL    ?L?COM053B
B3:00D02F 903D87            MOV      DPTR,#len
B3:00D032 E0                MOVX     A,@DPTR
B3:00D033 2405              ADD      A,#05H
B3:00D035 FD                MOV      R5,A
B3:00D036 7B01              MOV      R3,#01H
B3:00D038 7A3D              MOV      R2,#HIGH mac
B3:00D03A 796F              MOV      R1,#LOW mac
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 879


B3:00D03C 90437E            MOV      DPTR,#?_aes_cbc_mac?BYTE+04H
B3:00D03F 122572            LCALL    ?C?PSTXDATA
B3:00D042 903D8C            MOV      DPTR,#auth
B3:00D045 122552            LCALL    ?C?PLDXDATA
B3:00D048 12CC07            LCALL    _aes_cbc_mac
B3:00D04B 902DA9            MOV      DPTR,#the_tx_session+01BH
B3:00D04E 7498              MOV      A,#098H
B3:00D050 F0                MOVX     @DPTR,A
B3:00D051 903D8C            MOV      DPTR,#auth
B3:00D054 12A3E6            LCALL    ?L?COM0077
B3:00D057 902DAA            MOV      DPTR,#the_tx_session+01CH
B3:00D05A F0                MOVX     @DPTR,A
B3:00D05B 11BA              ACALL    ?L?COM03AF
B3:00D05D 128549            LCALL    ?L?COM0019
B3:00D060 7A2D              MOV      R2,#HIGH the_tx_session+01DH
B3:00D062 79AB              MOV      R1,#LOW the_tx_session+01DH
B3:00D064 7F08              MOV      R7,#08H
B3:00D066 128195            LCALL    ___ZW_memcpy
B3:00D069 903D67            MOV      DPTR,#iv+08H
B3:00D06C E0                MOVX     A,@DPTR
B3:00D06D FF                MOV      R7,A
B3:00D06E 903D87            MOV      DPTR,#len
B3:00D071 E0                MOVX     A,@DPTR
B3:00D072 FE                MOV      R6,A
B3:00D073 24B4              ADD      A,#LOW the_tx_session+026H
B3:00D075 F582              MOV      DPL,A
B3:00D077 E4                CLR      A
B3:00D078 342D              ADDC     A,#HIGH the_tx_session+026H
B3:00D07A F583              MOV      DPH,A
B3:00D07C EF                MOV      A,R7
B3:00D07D F0                MOVX     @DPTR,A
B3:00D07E 74B5              MOV      A,#LOW the_tx_session+027H
B3:00D080 2E                ADD      A,R6
B3:00D081 F9                MOV      R1,A
B3:00D082 E4                CLR      A
B3:00D083 342D              ADDC     A,#HIGH the_tx_session+027H
B3:00D085 FA                MOV      R2,A
B3:00D086 7B01              MOV      R3,#01H
B3:00D088 C002              PUSH     AR2
B3:00D08A C001              PUSH     AR1
B3:00D08C 7A3D              MOV      R2,#HIGH mac
B3:00D08E 796F              MOV      R1,#LOW mac
B3:00D090 128549            LCALL    ?L?COM0019
B3:00D093 D001              POP      AR1
B3:00D095 D002              POP      AR2
B3:00D097 7F08              MOV      R7,#08H
B3:00D099 128195            LCALL    ___ZW_memcpy
B3:00D09C 903D87            MOV      DPTR,#len
B3:00D09F E0                MOVX     A,@DPTR
B3:00D0A0 FF                MOV      R7,A
B3:00D0A1 FD                MOV      R5,A
B3:00D0A2 902D95            MOV      DPTR,#the_tx_session+07H
B3:00D0A5 E4                CLR      A
B3:00D0A6 8DF0              MOV      B,R5
B3:00D0A8 12210C            LCALL    ?C?IILDX
B3:00D0AB 902D97            MOV      DPTR,#the_tx_session+09H
B3:00D0AE E0                MOVX     A,@DPTR
B3:00D0AF C3                CLR      C
B3:00D0B0 9F                SUBB     A,R7
B3:00D0B1 F0                MOVX     @DPTR,A
B3:00D0B2 903D87            MOV      DPTR,#len
B3:00D0B5 E0                MOVX     A,@DPTR
B3:00D0B6 2414              ADD      A,#014H
B3:00D0B8 FF                MOV      R7,A
B3:00D0B9 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 880


----- FUNCTION _encrypt_msg (END) -------


----- FUNCTION ?L?COM03AF (BEGIN) -----
B3:00D0BA 7B01              MOV      R3,#01H
B3:00D0BC 7A3D              MOV      R2,#HIGH iv
B3:00D0BE 795F              MOV      R1,#LOW iv
B3:00D0C0 22                RET      
----- FUNCTION ?L?COM03AF (END) -------


----- FUNCTION ?L?COM02CB (BEGIN) -----
B3:00D0C1 7B01              MOV      R3,#01H
B3:00D0C3 7A3D              MOV      R2,#HIGH iv
B3:00D0C5 7932              MOV      R1,#LOW iv
B3:00D0C7         ?L?COM02CC:
B3:00D0C7 9044CA            MOV      DPTR,#?_aes_set_key?BYTE+03H
B3:00D0CA 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM02CB (END) -------


----- FUNCTION _get_nonce (BEGIN) -----
B3:00D0CD 904382            MOV      DPTR,#src
B3:00D0D0 126563            LCALL    ?L?COM00E9
B3:00D0D3 EB                MOV      A,R3
B3:00D0D4 F0                MOVX     @DPTR,A
B3:00D0D5 E4                CLR      A
B3:00D0D6 904389            MOV      DPTR,#i
B3:00D0D9 F0                MOVX     @DPTR,A
B3:00D0DA         ?C0025?ZW_SECURITY_SCHEME0:
B3:00D0DA 904389            MOV      DPTR,#i
B3:00D0DD E0                MOVX     A,@DPTR
B3:00D0DE FF                MOV      R7,A
B3:00D0DF C3                CLR      C
B3:00D0E0 940F              SUBB     A,#0FH
B3:00D0E2 5068              JNC      ?C0026?ZW_SECURITY_SCHEME0
B3:00D0E4 319A              ACALL    ?L?COM00A1
B3:00D0E6 E0                MOVX     A,@DPTR
B3:00D0E7 D3                SETB     C
B3:00D0E8 9400              SUBB     A,#00H
B3:00D0EA 4058              JC       ?C0027?ZW_SECURITY_SCHEME0
B3:00D0EC 904389            MOV      DPTR,#i
B3:00D0EF E0                MOVX     A,@DPTR
B3:00D0F0 314F              ACALL    ?L?COM01EC
B3:00D0F2 E0                MOVX     A,@DPTR
B3:00D0F3 FE                MOV      R6,A
B3:00D0F4 904382            MOV      DPTR,#src
B3:00D0F7 E0                MOVX     A,@DPTR
B3:00D0F8 FD                MOV      R5,A
B3:00D0F9 EE                MOV      A,R6
B3:00D0FA 6D                XRL      A,R5
B3:00D0FB 7047              JNZ      ?C0027?ZW_SECURITY_SCHEME0
B3:00D0FD EF                MOV      A,R7
B3:00D0FE 31A9              ACALL    ?L?COM01ED
B3:00D100 E0                MOVX     A,@DPTR
B3:00D101 FF                MOV      R7,A
B3:00D102 904383            MOV      DPTR,#dst
B3:00D105 E0                MOVX     A,@DPTR
B3:00D106 FE                MOV      R6,A
B3:00D107 EF                MOV      A,R7
B3:00D108 6E                XRL      A,R6
B3:00D109 7039              JNZ      ?C0027?ZW_SECURITY_SCHEME0
B3:00D10B 904388            MOV      DPTR,#any_nonce
B3:00D10E E0                MOVX     A,@DPTR
B3:00D10F 701A              JNZ      ?C0030?ZW_SECURITY_SCHEME0
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 881


B3:00D111 A3                INC      DPTR
B3:00D112 E0                MOVX     A,@DPTR
B3:00D113 75F00C            MOV      B,#0CH
B3:00D116 A4                MUL      AB
B3:00D117 24A4              ADD      A,#LOW nonce_table+04H
B3:00D119 F582              MOV      DPL,A
B3:00D11B E4                CLR      A
B3:00D11C 342B              ADDC     A,#HIGH nonce_table+04H
B3:00D11E F583              MOV      DPH,A
B3:00D120 E0                MOVX     A,@DPTR
B3:00D121 FF                MOV      R7,A
B3:00D122 904384            MOV      DPTR,#ri
B3:00D125 E0                MOVX     A,@DPTR
B3:00D126 FE                MOV      R6,A
B3:00D127 EF                MOV      A,R7
B3:00D128 B50619            CJNE     A,AR6,?C0027?ZW_SECURITY_SCHEME0
B3:00D12B         ?C0030?ZW_SECURITY_SCHEME0:
B3:00D12B 904389            MOV      DPTR,#i
B3:00D12E E0                MOVX     A,@DPTR
B3:00D12F 31C7              ACALL    ?L?COM03E0
B3:00D131 7B01              MOV      R3,#01H
B3:00D133 128549            LCALL    ?L?COM0019
B3:00D136 904385            MOV      DPTR,#nonce
B3:00D139 122552            LCALL    ?C?PLDXDATA
B3:00D13C 7F08              MOV      R7,#08H
B3:00D13E 128195            LCALL    ___ZW_memcpy
B3:00D141 7F01              MOV      R7,#01H
B3:00D143 22                RET      
B3:00D144         ?C0027?ZW_SECURITY_SCHEME0:
B3:00D144 904389            MOV      DPTR,#i
B3:00D147 E0                MOVX     A,@DPTR
B3:00D148 04                INC      A
B3:00D149 F0                MOVX     @DPTR,A
B3:00D14A 808E              SJMP     ?C0025?ZW_SECURITY_SCHEME0
B3:00D14C         ?C0026?ZW_SECURITY_SCHEME0:
B3:00D14C 7F00              MOV      R7,#00H
B3:00D14E 22                RET      
----- FUNCTION _get_nonce (END) -------


----- FUNCTION ?L?COM01EC (BEGIN) -----
B3:00D14F 75F00C            MOV      B,#0CH
B3:00D152 A4                MUL      AB
B3:00D153 24A0              ADD      A,#LOW nonce_table
B3:00D155 F582              MOV      DPL,A
B3:00D157 E4                CLR      A
B3:00D158 342B              ADDC     A,#HIGH nonce_table
B3:00D15A F583              MOV      DPH,A
B3:00D15C 22                RET      
----- FUNCTION ?L?COM01EC (END) -------


----- FUNCTION _nonce_clear (BEGIN) -----
;---- Variable 'dst' assigned to Register 'R5' ----
;---- Variable 'src' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
B3:00D15D E4                CLR      A
B3:00D15E FE                MOV      R6,A
B3:00D15F         ?C0032?ZW_SECURITY_SCHEME0:
B3:00D15F EE                MOV      A,R6
B3:00D160 319B              ACALL    ?L?COM00A2
B3:00D162 E0                MOVX     A,@DPTR
B3:00D163 6013              JZ       ?C0034?ZW_SECURITY_SCHEME0
B3:00D165 EE                MOV      A,R6
B3:00D166 314F              ACALL    ?L?COM01EC
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 882


B3:00D168 E0                MOVX     A,@DPTR
B3:00D169 B5070C            CJNE     A,AR7,?C0034?ZW_SECURITY_SCHEME0
B3:00D16C EE                MOV      A,R6
B3:00D16D 31A9              ACALL    ?L?COM01ED
B3:00D16F E0                MOVX     A,@DPTR
B3:00D170 B50505            CJNE     A,AR5,?C0034?ZW_SECURITY_SCHEME0
B3:00D173 EE                MOV      A,R6
B3:00D174 319B              ACALL    ?L?COM00A2
B3:00D176 E4                CLR      A
B3:00D177 F0                MOVX     @DPTR,A
B3:00D178         ?C0034?ZW_SECURITY_SCHEME0:
B3:00D178 0E                INC      R6
B3:00D179 EE                MOV      A,R6
B3:00D17A B40FE2            CJNE     A,#0FH,?C0032?ZW_SECURITY_SCHEME0
B3:00D17D 22                RET      
----- FUNCTION _nonce_clear (END) -------


----- FUNCTION _ZCB_nonce_timer_timeout (BEGIN) -----
;---- Variable 'i' assigned to Register 'R7' ----
B3:00D17E E4                CLR      A
B3:00D17F FF                MOV      R7,A
B3:00D180         ?C0037?ZW_SECURITY_SCHEME0:
B3:00D180 319A              ACALL    ?L?COM00A1
B3:00D182 E0                MOVX     A,@DPTR
B3:00D183 D3                SETB     C
B3:00D184 9400              SUBB     A,#00H
B3:00D186 4005              JC       ?C0039?ZW_SECURITY_SCHEME0
B3:00D188 319A              ACALL    ?L?COM00A1
B3:00D18A E0                MOVX     A,@DPTR
B3:00D18B 14                DEC      A
B3:00D18C F0                MOVX     @DPTR,A
B3:00D18D         ?C0039?ZW_SECURITY_SCHEME0:
B3:00D18D 0F                INC      R7
B3:00D18E EF                MOV      A,R7
B3:00D18F B40FEE            CJNE     A,#0FH,?C0037?ZW_SECURITY_SCHEME0
B3:00D192         ?C0038?ZW_SECURITY_SCHEME0:
B3:00D192 12B316            LCALL    ?L?COM0049
B3:00D195 31BD              ACALL    ?L?COM0480
B3:00D197 021B29            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION _ZCB_nonce_timer_timeout (END) -------


----- FUNCTION ?L?COM00A1 (BEGIN) -----
B3:00D19A EF                MOV      A,R7
B3:00D19B         ?L?COM00A2:
B3:00D19B 75F00C            MOV      B,#0CH
B3:00D19E A4                MUL      AB
B3:00D19F 24A2              ADD      A,#LOW nonce_table+02H
B3:00D1A1 F582              MOV      DPL,A
B3:00D1A3 E4                CLR      A
B3:00D1A4 342B              ADDC     A,#HIGH nonce_table+02H
B3:00D1A6 F583              MOV      DPH,A
B3:00D1A8 22                RET      
----- FUNCTION ?L?COM00A1 (END) -------


----- FUNCTION ?L?COM01ED (BEGIN) -----
B3:00D1A9 75F00C            MOV      B,#0CH
B3:00D1AC A4                MUL      AB
B3:00D1AD 24A1              ADD      A,#LOW nonce_table+01H
B3:00D1AF F582              MOV      DPL,A
B3:00D1B1 E4                CLR      A
B3:00D1B2 342B              ADDC     A,#HIGH nonce_table+01H
B3:00D1B4 F583              MOV      DPH,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 883


B3:00D1B6 22                RET      
----- FUNCTION ?L?COM01ED (END) -------


----- FUNCTION ?L?COM04AE (BEGIN) -----
B3:00D1B7 E0                MOVX     A,@DPTR
B3:00D1B8 FB                MOV      R3,A
B3:00D1B9 11CD              ACALL    _get_nonce
B3:00D1BB EF                MOV      A,R7
B3:00D1BC 22                RET      
----- FUNCTION ?L?COM04AE (END) -------


----- FUNCTION ?L?COM0480 (BEGIN) -----
B3:00D1BD A3                INC      DPTR
B3:00D1BE 122572            LCALL    ?C?PSTXDATA
B3:00D1C1 0B                INC      R3
B3:00D1C2 7A2C              MOV      R2,#HIGH nonce_timer
B3:00D1C4 7964              MOV      R1,#LOW nonce_timer
B3:00D1C6 22                RET      
----- FUNCTION ?L?COM0480 (END) -------


----- FUNCTION ?L?COM03E0 (BEGIN) -----
B3:00D1C7 75F00C            MOV      B,#0CH
B3:00D1CA A4                MUL      AB
B3:00D1CB 24A4              ADD      A,#LOW nonce_table+04H
B3:00D1CD F9                MOV      R1,A
B3:00D1CE 742B              MOV      A,#HIGH nonce_table+04H
B3:00D1D0 35F0              ADDC     A,B
B3:00D1D2 FA                MOV      R2,A
B3:00D1D3 22                RET      
----- FUNCTION ?L?COM03E0 (END) -------


----- FUNCTION _ZCB_noce_get_callback (BEGIN) -----
;---- Variable 'status' assigned to Register 'R7' ----
B3:00D1D4 902D98            MOV      DPTR,#the_tx_session+0AH
B3:00D1D7 E0                MOVX     A,@DPTR
B3:00D1D8 700A              JNZ      ?C0062?ZW_SECURITY_SCHEME0
B3:00D1DA EF                MOV      A,R7
B3:00D1DB 7F07              MOV      R7,#07H
B3:00D1DD 7002              JNZ      ?C0060?ZW_SECURITY_SCHEME0
B3:00D1DF 7F01              MOV      R7,#01H
B3:00D1E1         ?C0060?ZW_SECURITY_SCHEME0:
B3:00D1E1         ?C0061?ZW_SECURITY_SCHEME0:
B3:00D1E1 1280AE            LCALL    _?tx_session_state_set
B3:00D1E4         ?C0062?ZW_SECURITY_SCHEME0:
B3:00D1E4 22                RET      
----- FUNCTION _ZCB_noce_get_callback (END) -------


----- FUNCTION _ZCB_msg1_callback (BEGIN) -----
B3:00D1E5 9046AD            MOV      DPTR,#status
B3:00D1E8 EF                MOV      A,R7
B3:00D1E9 F0                MOVX     @DPTR,A
;---- Variable 'extendedTxStatus' assigned to Register 'R1/R2/R3' ----
B3:00D1EA 902D98            MOV      DPTR,#the_tx_session+0AH
B3:00D1ED E0                MOVX     A,@DPTR
B3:00D1EE 6402              XRL      A,#02H
B3:00D1F0 700F              JNZ      ?C0066?ZW_SECURITY_SCHEME0
B3:00D1F2 5122              ACALL    ?L?COM0335
B3:00D1F4 9046AD            MOV      DPTR,#status
B3:00D1F7 E0                MOVX     A,@DPTR
B3:00D1F8 7F07              MOV      R7,#07H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 884


B3:00D1FA 7002              JNZ      ?C0064?ZW_SECURITY_SCHEME0
B3:00D1FC 7F03              MOV      R7,#03H
B3:00D1FE         ?C0064?ZW_SECURITY_SCHEME0:
B3:00D1FE         ?C0065?ZW_SECURITY_SCHEME0:
B3:00D1FE 1280AE            LCALL    _?tx_session_state_set
B3:00D201         ?C0066?ZW_SECURITY_SCHEME0:
B3:00D201 22                RET      
----- FUNCTION _ZCB_msg1_callback (END) -------


----- FUNCTION ?L?COM01FF (BEGIN) -----
B3:00D202 12CEF2            LCALL    _encrypt_msg
B3:00D205 857A83            MOV      DPH,?C_XBP
B3:00D208 857B82            MOV      DPL,?C_XBP+01H
B3:00D20B EF                MOV      A,R7
B3:00D20C F0                MOVX     @DPTR,A
B3:00D20D 902D8F            MOV      DPTR,#the_tx_session+01H
B3:00D210 E0                MOVX     A,@DPTR
B3:00D211 FF                MOV      R7,A
B3:00D212 902D8E            MOV      DPTR,#the_tx_session
B3:00D215 E0                MOVX     A,@DPTR
B3:00D216 FD                MOV      R5,A
B3:00D217 315D              ACALL    _nonce_clear
B3:00D219 857A83            MOV      DPH,?C_XBP
B3:00D21C 857B82            MOV      DPL,?C_XBP+01H
B3:00D21F E0                MOVX     A,@DPTR
B3:00D220 FD                MOV      R5,A
B3:00D221 22                RET      
----- FUNCTION ?L?COM01FF (END) -------


----- FUNCTION ?L?COM0335 (BEGIN) -----
B3:00D222 78DA              MOV      R0,#LOW the_tx_session+04CH
B3:00D224 7C2D              MOV      R4,#HIGH the_tx_session+04CH
B3:00D226 7D01              MOV      R5,#01H
B3:00D228 FE                MOV      R6,A
B3:00D229 7F13              MOV      R7,#013H
B3:00D22B 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM0335 (END) -------


----- FUNCTION _ZCB_msg2_callback (BEGIN) -----
B3:00D22E 9046AE            MOV      DPTR,#status
B3:00D231 EF                MOV      A,R7
B3:00D232 F0                MOVX     @DPTR,A
;---- Variable 'extendedTxStatus' assigned to Register 'R1/R2/R3' ----
B3:00D233 902D98            MOV      DPTR,#the_tx_session+0AH
B3:00D236 E0                MOVX     A,@DPTR
B3:00D237 6404              XRL      A,#04H
B3:00D239 700F              JNZ      ?C0070?ZW_SECURITY_SCHEME0
B3:00D23B 5122              ACALL    ?L?COM0335
B3:00D23D 9046AE            MOV      DPTR,#status
B3:00D240 E0                MOVX     A,@DPTR
B3:00D241 7F07              MOV      R7,#07H
B3:00D243 7002              JNZ      ?C0068?ZW_SECURITY_SCHEME0
B3:00D245 7F05              MOV      R7,#05H
B3:00D247         ?C0068?ZW_SECURITY_SCHEME0:
B3:00D247         ?C0069?ZW_SECURITY_SCHEME0:
B3:00D247 1280AE            LCALL    _?tx_session_state_set
B3:00D24A         ?C0070?ZW_SECURITY_SCHEME0:
B3:00D24A 22                RET      
----- FUNCTION _ZCB_msg2_callback (END) -------


----- FUNCTION get_seq (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 885


B3:00D24B 902B7F            MOV      DPTR,#s
B3:00D24E E0                MOVX     A,@DPTR
B3:00D24F 04                INC      A
B3:00D250 F0                MOVX     @DPTR,A
B3:00D251 E0                MOVX     A,@DPTR
B3:00D252 FF                MOV      R7,A
B3:00D253 22                RET      
----- FUNCTION get_seq (END) -------


----- FUNCTION _sec0_send_data (BEGIN) -----
;---- Variable 'snode' assigned to Register 'R7' ----
;---- Variable 'pData' assigned to Register 'R1/R2/R3' ----
;---- Variable 'dnode' assigned to Register 'R5' ----
B3:00D254 902D8E            MOV      DPTR,#the_tx_session
B3:00D257 E0                MOVX     A,@DPTR
B3:00D258 6003              JZ       ?C0092?ZW_SECURITY_SCHEME0
B3:00D25A 7F00              MOV      R7,#00H
B3:00D25C 22                RET      
B3:00D25D         ?C0092?ZW_SECURITY_SCHEME0:
B3:00D25D 902D8F            MOV      DPTR,#the_tx_session+01H
B3:00D260 EF                MOV      A,R7
B3:00D261 F0                MOVX     @DPTR,A
B3:00D262 902D8E            MOV      DPTR,#the_tx_session
B3:00D265 ED                MOV      A,R5
B3:00D266 F0                MOVX     @DPTR,A
B3:00D267 902D94            MOV      DPTR,#the_tx_session+06H
B3:00D26A 122572            LCALL    ?C?PSTXDATA
B3:00D26D 9042FD            MOV      DPTR,#len
B3:00D270 E0                MOVX     A,@DPTR
B3:00D271 902D97            MOV      DPTR,#the_tx_session+09H
B3:00D274 F0                MOVX     @DPTR,A
B3:00D275 9042FE            MOV      DPTR,#txoptions
B3:00D278 E0                MOVX     A,@DPTR
B3:00D279 902D90            MOV      DPTR,#the_tx_session+02H
B3:00D27C F0                MOVX     @DPTR,A
B3:00D27D 9042FF            MOV      DPTR,#callback
B3:00D280 E0                MOVX     A,@DPTR
B3:00D281 FF                MOV      R7,A
B3:00D282 A3                INC      DPTR
B3:00D283 E0                MOVX     A,@DPTR
B3:00D284 902DD8            MOV      DPTR,#the_tx_session+04AH
B3:00D287 CF                XCH      A,R7
B3:00D288 F0                MOVX     @DPTR,A
B3:00D289 A3                INC      DPTR
B3:00D28A EF                MOV      A,R7
B3:00D28B F0                MOVX     @DPTR,A
B3:00D28C 514B              ACALL    get_seq
B3:00D28E 902DD7            MOV      DPTR,#the_tx_session+049H
B3:00D291 EF                MOV      A,R7
B3:00D292 F0                MOVX     @DPTR,A
B3:00D293 7F00              MOV      R7,#00H
B3:00D295 1280AE            LCALL    _?tx_session_state_set
B3:00D298 7F01              MOV      R7,#01H
B3:00D29A 22                RET      
----- FUNCTION _sec0_send_data (END) -------


----- FUNCTION _sec0_register_nonce (BEGIN) -----
B3:00D29B 90460F            MOV      DPTR,#nonce
B3:00D29E 122572            LCALL    ?C?PSTXDATA
;---- Variable 'dst' assigned to Register 'R5' ----
;---- Variable 'src' assigned to Register 'R7' ----
B3:00D2A1 902D8E            MOV      DPTR,#the_tx_session
B3:00D2A4 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 886


B3:00D2A5 6F                XRL      A,R7
B3:00D2A6 703D              JNZ      ?C0101?ZW_SECURITY_SCHEME0
B3:00D2A8 A3                INC      DPTR
B3:00D2A9 E0                MOVX     A,@DPTR
B3:00D2AA 6D                XRL      A,R5
B3:00D2AB 7038              JNZ      ?C0101?ZW_SECURITY_SCHEME0
B3:00D2AD 90460F            MOV      DPTR,#nonce
B3:00D2B0 122552            LCALL    ?C?PLDXDATA
B3:00D2B3 51EA              ACALL    ?L?COM018A
B3:00D2B5 E4                CLR      A
B3:00D2B6 FB                MOV      R3,A
B3:00D2B7 12CE2D            LCALL    _register_nonce
B3:00D2BA 902D98            MOV      DPTR,#the_tx_session+0AH
B3:00D2BD E0                MOVX     A,@DPTR
B3:00D2BE FF                MOV      R7,A
B3:00D2BF 6401              XRL      A,#01H
B3:00D2C1 6003              JZ       ?C0096?ZW_SECURITY_SCHEME0
B3:00D2C3 EF                MOV      A,R7
B3:00D2C4 7004              JNZ      ?C0095?ZW_SECURITY_SCHEME0
B3:00D2C6         ?C0096?ZW_SECURITY_SCHEME0:
B3:00D2C6 7F02              MOV      R7,#02H
B3:00D2C8 8018              SJMP     ?C0181?ZW_SECURITY_SCHEME0
B3:00D2CA         ?C0095?ZW_SECURITY_SCHEME0:
B3:00D2CA 902D98            MOV      DPTR,#the_tx_session+0AH
B3:00D2CD E0                MOVX     A,@DPTR
B3:00D2CE FF                MOV      R7,A
B3:00D2CF 6403              XRL      A,#03H
B3:00D2D1 600D              JZ       ?C0099?ZW_SECURITY_SCHEME0
B3:00D2D3 EF                MOV      A,R7
B3:00D2D4 B4020E            CJNE     A,#02H,?C0101?ZW_SECURITY_SCHEME0
B3:00D2D7 902D97            MOV      DPTR,#the_tx_session+09H
B3:00D2DA E0                MOVX     A,@DPTR
B3:00D2DB D3                SETB     C
B3:00D2DC 9400              SUBB     A,#00H
B3:00D2DE 4005              JC       ?C0101?ZW_SECURITY_SCHEME0
B3:00D2E0         ?C0099?ZW_SECURITY_SCHEME0:
B3:00D2E0 7F04              MOV      R7,#04H
B3:00D2E2         
B3:00D2E2 1280AE            LCALL    _?tx_session_state_set
B3:00D2E5         ?C0101?ZW_SECURITY_SCHEME0:
B3:00D2E5 22                RET      
----- FUNCTION _sec0_register_nonce (END) -------


----- FUNCTION ?L?COM0189 (BEGIN) -----
B3:00D2E6 E0                MOVX     A,@DPTR
B3:00D2E7 FD                MOV      R5,A
B3:00D2E8 7B01              MOV      R3,#01H
B3:00D2EA         ?L?COM018A:
B3:00D2EA 904437            MOV      DPTR,#?_register_nonce?BYTE+03H
B3:00D2ED 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0189 (END) -------


----- FUNCTION _is_free (BEGIN) -----
;---- Variable 'e' assigned to Register 'R1/R2/R3' ----
B3:00D2F0 E9                MOV      A,R1
B3:00D2F1 2402              ADD      A,#02H
B3:00D2F3 1252DD            LCALL    ?L?COM0009
B3:00D2F6 7F00              MOV      R7,#00H
B3:00D2F8 B40302            CJNE     A,#03H,?C0102?ZW_SECURITY_SCHEME0
B3:00D2FB 7F01              MOV      R7,#01H
B3:00D2FD         ?C0102?ZW_SECURITY_SCHEME0:
B3:00D2FD 22                RET      
----- FUNCTION _is_free (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 887




----- FUNCTION _new_rx_session (BEGIN) -----
B3:00D2FE 904612            MOV      DPTR,#snode
B3:00D301 126E7B            LCALL    ?L?COM02C1
B3:00D304         ?C0105?ZW_SECURITY_SCHEME0:
B3:00D304 904614            MOV      DPTR,#i
B3:00D307 E0                MOVX     A,@DPTR
B3:00D308 FF                MOV      R7,A
B3:00D309 C3                CLR      C
B3:00D30A 9402              SUBB     A,#02H
B3:00D30C 503D              JNC      ?C0106?ZW_SECURITY_SCHEME0
B3:00D30E 714E              ACALL    ?L?COM0184
B3:00D310 7B01              MOV      R3,#01H
B3:00D312 51F0              ACALL    _is_free
B3:00D314 EF                MOV      A,R7
B3:00D315 602C              JZ       ?C0107?ZW_SECURITY_SCHEME0
B3:00D317 904612            MOV      DPTR,#snode
B3:00D31A E0                MOVX     A,@DPTR
B3:00D31B FF                MOV      R7,A
B3:00D31C 904614            MOV      DPTR,#i
B3:00D31F E0                MOVX     A,@DPTR
B3:00D320 FE                MOV      R6,A
B3:00D321 75F085            MOV      B,#085H
B3:00D324 902C84            MOV      DPTR,#rxsessions
B3:00D327 122546            LCALL    ?C?OFFXADD
B3:00D32A EF                MOV      A,R7
B3:00D32B F0                MOVX     @DPTR,A
B3:00D32C 904613            MOV      DPTR,#dnode
B3:00D32F E0                MOVX     A,@DPTR
B3:00D330 FF                MOV      R7,A
B3:00D331 75F085            MOV      B,#085H
B3:00D334 EE                MOV      A,R6
B3:00D335 902C85            MOV      DPTR,#rxsessions+01H
B3:00D338 122546            LCALL    ?C?OFFXADD
B3:00D33B EF                MOV      A,R7
B3:00D33C F0                MOVX     @DPTR,A
B3:00D33D 904614            MOV      DPTR,#i
B3:00D340 E0                MOVX     A,@DPTR
B3:00D341 800C              SJMP     ?L?COM0185
B3:00D343         ?C0107?ZW_SECURITY_SCHEME0:
B3:00D343 904614            MOV      DPTR,#i
B3:00D346 E0                MOVX     A,@DPTR
B3:00D347 04                INC      A
B3:00D348 F0                MOVX     @DPTR,A
B3:00D349 80B9              SJMP     ?C0105?ZW_SECURITY_SCHEME0
B3:00D34B         ?C0106?ZW_SECURITY_SCHEME0:
B3:00D34B 02B327            LJMP     ?L?COM004B
----- FUNCTION _new_rx_session (END) -------


----- FUNCTION ?L?COM0184 (BEGIN) -----
B3:00D34E EF                MOV      A,R7
B3:00D34F         ?L?COM0185:
B3:00D34F 75F085            MOV      B,#085H
B3:00D352 A4                MUL      AB
B3:00D353 2484              ADD      A,#LOW rxsessions
B3:00D355 F9                MOV      R1,A
B3:00D356 742C              MOV      A,#HIGH rxsessions
B3:00D358 35F0              ADDC     A,B
B3:00D35A FA                MOV      R2,A
B3:00D35B 22                RET      
----- FUNCTION ?L?COM0184 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 888


----- FUNCTION sec0_abort_all_tx_sessions (BEGIN) -----
B3:00D35C 902D8E            MOV      DPTR,#the_tx_session
B3:00D35F E0                MOVX     A,@DPTR
B3:00D360 6005              JZ       ?C0122?ZW_SECURITY_SCHEME0
B3:00D362 7F07              MOV      R7,#07H
B3:00D364 1280AE            LCALL    _?tx_session_state_set
B3:00D367         ?C0122?ZW_SECURITY_SCHEME0:
B3:00D367 22                RET      
----- FUNCTION sec0_abort_all_tx_sessions (END) -------


----- FUNCTION _get_rx_session_by_nodes (BEGIN) -----
B3:00D368 9044CD            MOV      DPTR,#snode
B3:00D36B 126E7B            LCALL    ?L?COM02C1
B3:00D36E         ?C0134?ZW_SECURITY_SCHEME0:
B3:00D36E 9044CF            MOV      DPTR,#i
B3:00D371 E0                MOVX     A,@DPTR
B3:00D372 FF                MOV      R7,A
B3:00D373 C3                CLR      C
B3:00D374 9402              SUBB     A,#02H
B3:00D376 5035              JNC      ?C0135?ZW_SECURITY_SCHEME0
B3:00D378 714E              ACALL    ?L?COM0184
B3:00D37A 7B01              MOV      R3,#01H
B3:00D37C A3                INC      DPTR
B3:00D37D 122572            LCALL    ?C?PSTXDATA
B3:00D380 51F0              ACALL    _is_free
B3:00D382 EF                MOV      A,R7
B3:00D383 7020              JNZ      ?C0136?ZW_SECURITY_SCHEME0
B3:00D385 9044D0            MOV      DPTR,#e
B3:00D388 12CD6D            LCALL    ?L?COM02D3
B3:00D38B 1252DD            LCALL    ?L?COM0009
B3:00D38E FF                MOV      R7,A
B3:00D38F 9044CE            MOV      DPTR,#dnode
B3:00D392 E0                MOVX     A,@DPTR
B3:00D393 B5070F            CJNE     A,AR7,?C0136?ZW_SECURITY_SCHEME0
B3:00D396 9044D0            MOV      DPTR,#e
B3:00D399 12A3E6            LCALL    ?L?COM0077
B3:00D39C FF                MOV      R7,A
B3:00D39D 9044CD            MOV      DPTR,#snode
B3:00D3A0 E0                MOVX     A,@DPTR
B3:00D3A1 B50701            CJNE     A,AR7,?C0136?ZW_SECURITY_SCHEME0
B3:00D3A4 22                RET      
B3:00D3A5         ?C0136?ZW_SECURITY_SCHEME0:
B3:00D3A5 9044CF            MOV      DPTR,#i
B3:00D3A8 E0                MOVX     A,@DPTR
B3:00D3A9 04                INC      A
B3:00D3AA F0                MOVX     @DPTR,A
B3:00D3AB 80C1              SJMP     ?C0134?ZW_SECURITY_SCHEME0
B3:00D3AD         ?C0135?ZW_SECURITY_SCHEME0:
B3:00D3AD 02B327            LJMP     ?L?COM004B
----- FUNCTION _get_rx_session_by_nodes (END) -------


----- FUNCTION _ZCB_S2_send_frame_callback (BEGIN) -----
B3:00D3B0 9046B1            MOV      DPTR,#txStatus
B3:00D3B3 EF                MOV      A,R7
B3:00D3B4 F0                MOVX     @DPTR,A
;---- Variable 'extendedTxStatus' assigned to Register 'R1/R2/R3' ----
B3:00D3B5 788D              MOV      R0,#LOW sExtendedTxStatusS2
B3:00D3B7 7C3C              MOV      R4,#HIGH sExtendedTxStatusS2
B3:00D3B9 7D01              MOV      R5,#01H
B3:00D3BB 7E00              MOV      R6,#00H
B3:00D3BD 7F13              MOV      R7,#013H
B3:00D3BF 121F56            LCALL    ?C?COPY
B3:00D3C2 9046B1            MOV      DPTR,#txStatus
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 889


B3:00D3C5 E0                MOVX     A,@DPTR
B3:00D3C6 FF                MOV      R7,A
B3:00D3C7 7DF4              MOV      R5,#0F4H
B3:00D3C9 7C01              MOV      R4,#01H
B3:;----                  JMP      ___S2_send_frame_done_notify
----- FUNCTION _ZCB_S2_send_frame_callback (END) -------


----- FUNCTION ___S2_send_frame_done_notify (BEGIN) -----
;---- Variable 'tx_time' assigned to Register 'R4/R5' ----
;---- Variable 'status' assigned to Register 'R7' ----
B3:00D3CB 9043BD            MOV      DPTR,#e+03H
B3:00D3CE EF                MOV      A,R7
B3:00D3CF F0                MOVX     @DPTR,A
B3:00D3D0 AF05              MOV      R7,AR5
B3:00D3D2 A3                INC      DPTR
B3:00D3D3 EC                MOV      A,R4
B3:00D3D4 12CB64            LCALL    ?L?COM0137
B3:00D3D7 7A43              MOV      R2,#HIGH e
B3:00D3D9 79BA              MOV      R1,#LOW e
B3:00D3DB 7F02              MOV      R7,#02H
B3:00D3DD 028CD5            LJMP     ___S2_fsm_post_event
----- FUNCTION ___S2_send_frame_done_notify (END) -------


----- FUNCTION ___S2_send_frame_multi (BEGIN) -----
B3:00D3E0 904392            MOV      DPTR,#conn
B3:00D3E3 122572            LCALL    ?C?PSTXDATA
B3:00D3E6 7B01              MOV      R3,#01H
B3:00D3E8 7A3C              MOV      R2,#HIGH s2_sfm_txopt
B3:00D3EA 7987              MOV      R1,#LOW s2_sfm_txopt
B3:00D3EC 7D06              MOV      R5,#06H
B3:00D3EE E4                CLR      A
B3:00D3EF FF                MOV      R7,A
B3:00D3F0 12851A            LCALL    ___ZW_memset
B3:00D3F3 904392            MOV      DPTR,#conn
B3:00D3F6 12A3E6            LCALL    ?L?COM0077
B3:00D3F9 903C88            MOV      DPTR,#s2_sfm_txopt+01H
B3:00D3FC F0                MOVX     @DPTR,A
B3:00D3FD 903C87            MOV      DPTR,#s2_sfm_txopt
B3:00D400 74FF              MOV      A,#0FFH
B3:00D402 F0                MOVX     @DPTR,A
B3:00D403 E9                MOV      A,R1
B3:00D404 2404              ADD      A,#04H
B3:00D406 1252DD            LCALL    ?L?COM0009
B3:00D409 903C89            MOV      DPTR,#s2_sfm_txopt+02H
B3:00D40C F0                MOVX     @DPTR,A
B3:00D40D 904398            MOV      DPTR,#len
B3:00D410 7A3C              MOV      R2,#HIGH s2_sfm_txopt
B3:00D412 7987              MOV      R1,#LOW s2_sfm_txopt
B3:00D414 1281D7            LCALL    ?L?COM00AD
B3:00D417 12BFB0            LCALL    ?L?COM0435
B3:00D41A 904395            MOV      DPTR,#buf
B3:00D41D 122552            LCALL    ?C?PLDXDATA
B3:00D420 021980            LJMP     ?INTERBANK_TABLE?_ZW_SendDataEx
----- FUNCTION ___S2_send_frame_multi (END) -------


----- FUNCTION __S2_encrypt_and_send_multi (BEGIN) -----
B3:00D423 903A73            MOV      DPTR,#msg
B3:00D426 B171              ACALL    ?L?COM037B
B3:00D428 B15C              ACALL    ?L?COM045B
B3:00D42A 749F              MOV      A,#09FH
B3:00D42C 12203B            LCALL    ?C?CSTPTR
B3:00D42F 903A73            MOV      DPTR,#msg
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 890


B3:00D432 B18C              ACALL    ?L?COM02F2
B3:00D434 900002            MOV      DPTR,#02H
B3:00D437 74FF              MOV      A,#0FFH
B3:00D439 12204D            LCALL    ?C?CSTOPTR
B3:00D43C 900003            MOV      DPTR,#03H
B3:00D43F 7401              MOV      A,#01H
B3:00D441 12204D            LCALL    ?C?CSTOPTR
B3:00D444 900004            MOV      DPTR,#04H
B3:00D447 7403              MOV      A,#03H
B3:00D449 12204D            LCALL    ?C?CSTOPTR
B3:00D44C 900005            MOV      DPTR,#05H
B3:00D44F 7443              MOV      A,#043H
B3:00D451 12204D            LCALL    ?C?CSTOPTR
B3:00D454 12AFB9            LCALL    ?L?COM0243
B3:00D457 B169              ACALL    ?L?COM053E
B3:00D459 900006            MOV      DPTR,#06H
B3:00D45C 12204D            LCALL    ?C?CSTOPTR
B3:00D45F 903A71            MOV      DPTR,#hdr_len
B3:00D462 E4                CLR      A
B3:00D463 F0                MOVX     @DPTR,A
B3:00D464 A3                INC      DPTR
B3:00D465 7407              MOV      A,#07H
B3:00D467 F0                MOVX     @DPTR,A
B3:00D468 29                ADD      A,R1
B3:00D469 F9                MOV      R1,A
B3:00D46A E4                CLR      A
B3:00D46B 3A                ADDC     A,R2
B3:00D46C FA                MOV      R2,A
B3:00D46D 903A6E            MOV      DPTR,#ciphertext
B3:00D470 122572            LCALL    ?C?PSTXDATA
B3:00D473 B183              ACALL    ?L?COM0501
B3:00D475 903A6E            MOV      DPTR,#ciphertext
B3:00D478 122552            LCALL    ?C?PLDXDATA
B3:00D47B AC02              MOV      R4,AR2
B3:00D47D B197              ACALL    ?L?COM0229
B3:00D47F 9028D4            MOV      DPTR,#the_context+0D0H
B3:00D482 E0                MOVX     A,@DPTR
B3:00D483 FD                MOV      R5,A
B3:00D484 903A71            MOV      DPTR,#hdr_len
B3:00D487 E0                MOVX     A,@DPTR
B3:00D488 FA                MOV      R2,A
B3:00D489 A3                INC      DPTR
B3:00D48A E0                MOVX     A,@DPTR
B3:00D48B FB                MOV      R3,A
B3:00D48C 90418E            MOV      DPTR,#?___S2_make_aad?BYTE+05H
B3:00D48F EA                MOV      A,R2
B3:00D490 F0                MOVX     @DPTR,A
B3:00D491 A3                INC      DPTR
B3:00D492 EB                MOV      A,R3
B3:00D493 F0                MOVX     @DPTR,A
B3:00D494 9028DE            MOV      DPTR,#the_context+0DAH
B3:00D497 B1D2              ACALL    ?L?COM02E4
B3:00D499 7A3A              MOV      R2,#HIGH aad
B3:00D49B 791C              MOV      R1,#LOW aad
B3:00D49D B1C2              ACALL    ?L?COM0253
B3:00D49F B15C              ACALL    ?L?COM045B
B3:00D4A1 12E8E2            LCALL    ?L?COM04DF
B3:00D4A4 903A5C            MOV      DPTR,#aad_len
B3:00D4A7 EE                MOV      A,R6
B3:00D4A8 F0                MOVX     @DPTR,A
B3:00D4A9 A3                INC      DPTR
B3:00D4AA EF                MOV      A,R7
B3:00D4AB F0                MOVX     @DPTR,A
B3:00D4AC 12AFB9            LCALL    ?L?COM0243
B3:00D4AF E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 891


B3:00D4B0 2412              ADD      A,#012H
B3:00D4B2 12A8B7            LCALL    ?L?COM0094
B3:00D4B5 E0                MOVX     A,@DPTR
B3:00D4B6 B1A4              ACALL    ?L?COM03A0
B3:00D4B8 FA                MOV      R2,A
B3:00D4B9 C002              PUSH     AR2
B3:00D4BB C001              PUSH     AR1
B3:00D4BD 12AFB9            LCALL    ?L?COM0243
B3:00D4C0 E0                MOVX     A,@DPTR
B3:00D4C1 2402              ADD      A,#02H
B3:00D4C3 FF                MOV      R7,A
B3:00D4C4 E4                CLR      A
B3:00D4C5 3E                ADDC     A,R6
B3:00D4C6 FA                MOV      R2,A
B3:00D4C7 A907              MOV      R1,AR7
B3:00D4C9 12CBB7            LCALL    ?L?COM03C4
B3:00D4CC 904307            MOV      DPTR,#?_ZW_AES_ecb?BYTE+06H
B3:00D4CF B162              ACALL    ?L?COM0202
B3:00D4D1 D001              POP      AR1
B3:00D4D3 D002              POP      AR2
B3:00D4D5 12A6D7            LCALL    _ZW_AES_ecb
B3:00D4D8 12AFB9            LCALL    ?L?COM0243
B3:00D4DB E0                MOVX     A,@DPTR
B3:00D4DC FF                MOV      R7,A
B3:00D4DD B1E8              ACALL    _next_mpan_state
B3:00D4DF 12AFB9            LCALL    ?L?COM0243
B3:00D4E2 E0                MOVX     A,@DPTR
B3:00D4E3 2412              ADD      A,#012H
B3:00D4E5 12A8B7            LCALL    ?L?COM0094
B3:00D4E8 B1B2              ACALL    ?L?COM01B0
B3:00D4EA C003              PUSH     AR3
B3:00D4EC C002              PUSH     AR2
B3:00D4EE C001              PUSH     AR1
B3:00D4F0 903CF6            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+03H
B3:00D4F3 B162              ACALL    ?L?COM0202
B3:00D4F5 7A3A              MOV      R2,#HIGH aad
B3:00D4F7 791C              MOV      R1,#LOW aad
B3:00D4F9 903CF9            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+06H
B3:00D4FC 122572            LCALL    ?C?PSTXDATA
B3:00D4FF 903A5C            MOV      DPTR,#aad_len
B3:00D502 12E428            LCALL    ?L?COM0096
B3:00D505 FD                MOV      R5,A
B3:00D506 903CFC            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+09H
B3:00D509 1224BA            LCALL    ?C?LSTXDATA
B3:00D50C 903A6E            MOV      DPTR,#ciphertext
B3:00D50F B17A              ACALL    ?L?COM04A3
B3:00D511 9028DE            MOV      DPTR,#the_context+0DAH
B3:00D514 E0                MOVX     A,@DPTR
B3:00D515 FF                MOV      R7,A
B3:00D516 A3                INC      DPTR
B3:00D517 E0                MOVX     A,@DPTR
B3:00D518 903D03            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+010H
B3:00D51B CF                XCH      A,R7
B3:00D51C F0                MOVX     @DPTR,A
B3:00D51D A3                INC      DPTR
B3:00D51E EF                MOV      A,R7
B3:00D51F F0                MOVX     @DPTR,A
B3:00D520 D001              POP      AR1
B3:00D522 D002              POP      AR2
B3:00D524 D003              POP      AR3
B3:00D526 121B33            LCALL    ?INTERBANK_TABLE?_CCM_encrypt_and_auth
;---- Variable 'msg_len' assigned to Register 'R6/R7' ----
B3:00D529 B15C              ACALL    ?L?COM045B
B3:00D52B 904395            MOV      DPTR,#?___S2_send_frame_multi?BYTE+03H
B3:00D52E 122572            LCALL    ?C?PSTXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 892


B3:00D531 903A72            MOV      DPTR,#hdr_len+01H
B3:00D534 E0                MOVX     A,@DPTR
B3:00D535 2F                ADD      A,R7
B3:00D536 FF                MOV      R7,A
B3:00D537 903A71            MOV      DPTR,#hdr_len
B3:00D53A E0                MOVX     A,@DPTR
B3:00D53B 3E                ADDC     A,R6
B3:00D53C 904398            MOV      DPTR,#?___S2_send_frame_multi?BYTE+06H
B3:00D53F 12CB64            LCALL    ?L?COM0137
B3:00D542 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00D544 79D3              MOV      R1,#LOW the_context+0CFH
B3:00D546 71E0              ACALL    ___S2_send_frame_multi
B3:00D548 EF                MOV      A,R7
B3:00D549 7010              JNZ      ?C0060?S2
B3:00D54B         ?C0058?S2:
B3:00D54B 903A79            MOV      DPTR,#e+03H
B3:00D54E 7402              MOV      A,#02H
B3:00D550 F0                MOVX     @DPTR,A
B3:00D551 7B01              MOV      R3,#01H
B3:00D553 7A3A              MOV      R2,#HIGH e
B3:00D555 7976              MOV      R1,#LOW e
B3:00D557 FF                MOV      R7,A
B3:00D558 128CD5            LCALL    ___S2_fsm_post_event
B3:00D55B         ?C0060?S2:
B3:00D55B 22                RET      
----- FUNCTION __S2_encrypt_and_send_multi (END) -------


----- FUNCTION ?L?COM045B (BEGIN) -----
B3:00D55C 903A73            MOV      DPTR,#msg
B3:00D55F 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM045B (END) -------


----- FUNCTION ?L?COM0202 (BEGIN) -----
B3:00D562 7A3A              MOV      R2,#HIGH nonce
B3:00D564 795E              MOV      R1,#LOW nonce
B3:00D566 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0202 (END) -------


----- FUNCTION ?L?COM053E (BEGIN) -----
B3:00D569 E0                MOVX     A,@DPTR
B3:00D56A F582              MOV      DPL,A
B3:00D56C 8E83              MOV      DPH,R6
B3:00D56E A3                INC      DPTR
B3:00D56F E0                MOVX     A,@DPTR
B3:00D570 22                RET      
----- FUNCTION ?L?COM053E (END) -------


----- FUNCTION ?L?COM037B (BEGIN) -----
B3:00D571 7B01              MOV      R3,#01H
B3:00D573 7A2A              MOV      R2,#HIGH the_context+0211H
B3:00D575 7915              MOV      R1,#LOW the_context+0211H
B3:00D577 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM037B (END) -------


----- FUNCTION ?L?COM04A3 (BEGIN) -----
B3:00D57A 122552            LCALL    ?C?PLDXDATA
B3:00D57D 903D00            MOV      DPTR,#?_CCM_encrypt_and_auth?BYTE+0DH
B3:00D580 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM04A3 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 893



----- FUNCTION ?L?COM0501 (BEGIN) -----
B3:00D583 9028DE            MOV      DPTR,#the_context+0DAH
B3:00D586 E0                MOVX     A,@DPTR
B3:00D587 FE                MOV      R6,A
B3:00D588 A3                INC      DPTR
B3:00D589 E0                MOVX     A,@DPTR
B3:00D58A FF                MOV      R7,A
B3:00D58B 22                RET      
----- FUNCTION ?L?COM0501 (END) -------


----- FUNCTION ?L?COM02F2 (BEGIN) -----
B3:00D58C 122552            LCALL    ?C?PLDXDATA
B3:00D58F 900001            MOV      DPTR,#01H
B3:00D592 7403              MOV      A,#03H
B3:00D594 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM02F2 (END) -------


----- FUNCTION ?L?COM0229 (BEGIN) -----
B3:00D597 A801              MOV      R0,AR1
B3:00D599 AD03              MOV      R5,AR3
B3:00D59B 9028DB            MOV      DPTR,#the_context+0D7H
B3:00D59E         ?L?COM022A:
B3:00D59E 122552            LCALL    ?C?PLDXDATA
B3:00D5A1 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM0229 (END) -------


----- FUNCTION ?L?COM03A0 (BEGIN) -----
B3:00D5A4 75F040            MOV      B,#040H
B3:00D5A7 A4                MUL      AB
B3:00D5A8 7B01              MOV      R3,#01H
B3:00D5AA 2414              ADD      A,#LOW the_context+010H
B3:00D5AC F9                MOV      R1,A
B3:00D5AD 7428              MOV      A,#HIGH the_context+010H
B3:00D5AF 35F0              ADDC     A,B
B3:00D5B1 22                RET      
----- FUNCTION ?L?COM03A0 (END) -------


----- FUNCTION ?L?COM01B0 (BEGIN) -----
B3:00D5B2 E0                MOVX     A,@DPTR
B3:00D5B3         ?L?COM01B1:
B3:00D5B3 75F040            MOV      B,#040H
B3:00D5B6 A4                MUL      AB
B3:00D5B7 7B01              MOV      R3,#01H
B3:00D5B9 2404              ADD      A,#LOW the_context
B3:00D5BB F9                MOV      R1,A
B3:00D5BC 7428              MOV      A,#HIGH the_context
B3:00D5BE 35F0              ADDC     A,B
B3:00D5C0 FA                MOV      R2,A
B3:00D5C1 22                RET      
----- FUNCTION ?L?COM01B0 (END) -------


----- FUNCTION ?L?COM0253 (BEGIN) -----
B3:00D5C2 7B01              MOV      R3,#01H
B3:00D5C4 A3                INC      DPTR
B3:00D5C5         ?L?COM0254:
B3:00D5C5 122572            LCALL    ?C?PSTXDATA
B3:00D5C8 904195            MOV      DPTR,#?___S2_make_aad?BYTE+0CH
B3:00D5CB E4                CLR      A
B3:00D5CC F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 894


B3:00D5CD A3                INC      DPTR
B3:00D5CE 7440              MOV      A,#040H
B3:00D5D0 F0                MOVX     @DPTR,A
B3:00D5D1 22                RET      
----- FUNCTION ?L?COM0253 (END) -------


----- FUNCTION ?L?COM02E4 (BEGIN) -----
B3:00D5D2 E0                MOVX     A,@DPTR
B3:00D5D3 F8                MOV      R0,A
B3:00D5D4 A3                INC      DPTR
B3:00D5D5 E0                MOVX     A,@DPTR
B3:00D5D6 2B                ADD      A,R3
B3:00D5D7 FB                MOV      R3,A
B3:00D5D8 E8                MOV      A,R0
B3:00D5D9 3A                ADDC     A,R2
B3:00D5DA CB                XCH      A,R3
B3:00D5DB 2408              ADD      A,#08H
B3:00D5DD FE                MOV      R6,A
B3:00D5DE E4                CLR      A
B3:00D5DF 3B                ADDC     A,R3
B3:00D5E0 904190            MOV      DPTR,#?___S2_make_aad?BYTE+07H
B3:00D5E3 F0                MOVX     @DPTR,A
B3:00D5E4 A3                INC      DPTR
B3:00D5E5 CE                XCH      A,R6
B3:00D5E6 F0                MOVX     @DPTR,A
B3:00D5E7 22                RET      
----- FUNCTION ?L?COM02E4 (END) -------


----- FUNCTION _next_mpan_state (BEGIN) -----
;---- Variable 'mpan' assigned to Register 'R2/R3' ----
B3:00D5E8 AB07              MOV      R3,AR7
B3:00D5EA AA06              MOV      R2,AR6
B3:00D5EC EB                MOV      A,R3
B3:00D5ED 2402              ADD      A,#02H
B3:00D5EF FD                MOV      R5,A
B3:00D5F0 E4                CLR      A
B3:00D5F1 3A                ADDC     A,R2
B3:00D5F2 FC                MOV      R4,A
B3:00D5F3 AF05              MOV      R7,AR5
B3:00D5F5 FE                MOV      R6,A
B3:00D5F6 7A27              MOV      R2,#HIGH one
B3:00D5F8 7BF4              MOV      R3,#LOW one
B3:00D5FA 9042EC            MOV      DPTR,#?_bigint_add?BYTE+06H
B3:00D5FD 7410              MOV      A,#010H
B3:00D5FF F0                MOVX     @DPTR,A
B3:00D600 021B65            LJMP     ?INTERBANK_TABLE?_bigint_add
----- FUNCTION _next_mpan_state (END) -------


----- FUNCTION _ZCB_timeout2 (BEGIN) -----
B3:;----                  JMP      __S2_timeout_notify
----- FUNCTION _ZCB_timeout2 (END) -------


----- FUNCTION __S2_timeout_notify (BEGIN) -----
B3:00D603 12B327            LCALL    ?L?COM004B
B3:00D606 7F08              MOV      R7,#08H
B3:00D608 028CD5            LJMP     ___S2_fsm_post_event
----- FUNCTION __S2_timeout_notify (END) -------


----- FUNCTION s2_restore_spans_and_mpans (BEGIN) -----
B3:00D60B D123              ACALL    ?L?COM056D
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 895


B3:00D60D 12371B            LCALL    _NVM_ext_read_long_byte
B3:00D610 EF                MOV      A,R7
B3:00D611 600F              JZ       ?C0039?ZW_SECURITY_SCHEME2
B3:00D613 D15B              ACALL    ?L?COM023B
B3:00D615 E9                MOV      A,R1
B3:00D616 24E0              ADD      A,#0E0H
B3:00D618 F9                MOV      R1,A
B3:00D619 E4                CLR      A
B3:00D61A 9042AE            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00D61D D12B              ACALL    ?L?COM04AC
B3:00D61F 123817            LCALL    _NVM_ext_read_long_buffer
B3:00D622         ?C0039?ZW_SECURITY_SCHEME2:
B3:00D622 22                RET      
----- FUNCTION s2_restore_spans_and_mpans (END) -------


----- FUNCTION ?L?COM056D (BEGIN) -----
B3:00D623 7E12              MOV      R6,#HIGH span_mpan_table_valid
B3:00D625 7F94              MOV      R7,#LOW span_mpan_table_valid
B3:00D627 E4                CLR      A
B3:00D628 FC                MOV      R4,A
B3:00D629 FD                MOV      R5,A
B3:00D62A 22                RET      
----- FUNCTION ?L?COM056D (END) -------


----- FUNCTION ?L?COM04AC (BEGIN) -----
B3:00D62B 3A                ADDC     A,R2
B3:00D62C FA                MOV      R2,A
B3:00D62D 7401              MOV      A,#01H
B3:00D62F F0                MOVX     @DPTR,A
B3:00D630 A3                INC      DPTR
B3:00D631 7427              MOV      A,#027H
B3:00D633 F0                MOVX     @DPTR,A
B3:00D634 22                RET      
----- FUNCTION ?L?COM04AC (END) -------


----- FUNCTION s2_save_spans_and_mpans (BEGIN) -----
B3:00D635 D162              ACALL    ?L?COM023C
B3:00D637 E9                MOV      A,R1
B3:00D638 24DC              ADD      A,#0DCH
B3:00D63A 1252F4            LCALL    ?L?COM0021
B3:00D63D 45F0              ORL      A,B
B3:00D63F 6019              JZ       ?C0041?ZW_SECURITY_SCHEME2
B3:00D641 D15B              ACALL    ?L?COM023B
B3:00D643 E9                MOV      A,R1
B3:00D644 24E0              ADD      A,#0E0H
B3:00D646 F9                MOV      R1,A
B3:00D647 E4                CLR      A
B3:00D648 904182            MOV      DPTR,#?_NVM_ext_write_long_buffer?BYTE+07H
B3:00D64B D12B              ACALL    ?L?COM04AC
B3:00D64D 123A14            LCALL    _NVM_ext_write_long_buffer
B3:00D650 D123              ACALL    ?L?COM056D
B3:00D652 9044FF            MOV      DPTR,#?_NVM_ext_write_long_byte?BYTE+04H
B3:00D655 04                INC      A
B3:00D656 F0                MOVX     @DPTR,A
B3:00D657 1236CE            LCALL    _NVM_ext_write_long_byte
B3:00D65A         ?C0041?ZW_SECURITY_SCHEME2:
B3:00D65A 22                RET      
----- FUNCTION s2_save_spans_and_mpans (END) -------


----- FUNCTION ?L?COM023B (BEGIN) -----
B3:00D65B 7E12              MOV      R6,#HIGH span_mpan_table
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 896


B3:00D65D 7F95              MOV      R7,#LOW span_mpan_table
B3:00D65F E4                CLR      A
B3:00D660 FC                MOV      R4,A
B3:00D661 FD                MOV      R5,A
B3:00D662         ?L?COM023C:
B3:00D662 903CB4            MOV      DPTR,#s2_ctx
B3:00D665 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM023B (END) -------


----- FUNCTION ___S2_send_nonce_report (BEGIN) -----
B3:00D668 903FDF            MOV      DPTR,#conn
B3:00D66B 122572            LCALL    ?C?PSTXDATA
B3:00D66E 903FE2            MOV      DPTR,#flags
B3:00D671 ED                MOV      A,R5
B3:00D672 F0                MOVX     @DPTR,A
B3:00D673 903FF6            MOV      DPTR,#nonce_report
B3:00D676 B171              ACALL    ?L?COM037B
B3:00D678 903FDF            MOV      DPTR,#conn
B3:00D67B 12EE7F            LCALL    ?L?COM0368
B3:00D67E 903FE3            MOV      DPTR,#span
B3:00D681 122572            LCALL    ?C?PSTXDATA
B3:00D684 F11F              ACALL    ?L?COM0348
B3:00D686 749F              MOV      A,#09FH
B3:00D688 12203B            LCALL    ?C?CSTPTR
B3:00D68B F11F              ACALL    ?L?COM0348
B3:00D68D 900001            MOV      DPTR,#01H
B3:00D690 7402              MOV      A,#02H
B3:00D692 12204D            LCALL    ?C?CSTOPTR
B3:00D695 903FE2            MOV      DPTR,#flags
B3:00D698 E0                MOVX     A,@DPTR
B3:00D699 FF                MOV      R7,A
B3:00D69A 900003            MOV      DPTR,#03H
B3:00D69D 12204D            LCALL    ?C?CSTOPTR
B3:00D6A0 903FE3            MOV      DPTR,#span
B3:00D6A3 F12F              ACALL    ?L?COM02E2
B3:00D6A5 FE                MOV      R6,A
B3:00D6A6 F11F              ACALL    ?L?COM0348
B3:00D6A8 900002            MOV      DPTR,#02H
B3:00D6AB EE                MOV      A,R6
B3:00D6AC 12204D            LCALL    ?C?CSTOPTR
B3:00D6AF EF                MOV      A,R7
B3:00D6B0 30E034            JNB      ACC.0,?C0075?S2
B3:00D6B3 903FE3            MOV      DPTR,#span
B3:00D6B6 12A228            LCALL    ?L?COM0180
B3:00D6B9 7403              MOV      A,#03H
B3:00D6BB 12204D            LCALL    ?C?CSTOPTR
B3:00D6BE 7B01              MOV      R3,#01H
B3:00D6C0 7A3F              MOV      R2,#HIGH rnd
B3:00D6C2 79E6              MOV      R1,#LOW rnd
B3:00D6C4 12DAEA            LCALL    ?L?COM013A
B3:00D6C7 903FE3            MOV      DPTR,#span
B3:00D6CA 12ED39            LCALL    ?L?COM02D5
B3:00D6CD 7B01              MOV      R3,#01H
B3:00D6CF 7A3F              MOV      R2,#HIGH rnd
B3:00D6D1 79E6              MOV      R1,#LOW rnd
B3:00D6D3 F128              ACALL    ?L?COM0197
B3:00D6D5 F11F              ACALL    ?L?COM0348
B3:00D6D7 E9                MOV      A,R1
B3:00D6D8 2404              ADD      A,#04H
B3:00D6DA F9                MOV      R1,A
B3:00D6DB E4                CLR      A
B3:00D6DC 3A                ADDC     A,R2
B3:00D6DD A801              MOV      R0,AR1
B3:00D6DF FC                MOV      R4,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 897


B3:00D6E0 AD03              MOV      R5,AR3
B3:00D6E2 903FE3            MOV      DPTR,#span
B3:00D6E5 F125              ACALL    ?L?COM0196
B3:00D6E7         ?C0075?S2:
B3:00D6E7 903FE3            MOV      DPTR,#span
B3:00D6EA 122552            LCALL    ?C?PLDXDATA
B3:00D6ED 900024            MOV      DPTR,#024H
B3:00D6F0 7401              MOV      A,#01H
B3:00D6F2 122008            LCALL    ?C?CILDOPTR
B3:00D6F5 F11F              ACALL    ?L?COM0348
B3:00D6F7 90438D            MOV      DPTR,#?___S2_send_frame?BYTE+03H
B3:00D6FA 122572            LCALL    ?C?PSTXDATA
B3:00D6FD 903FF6            MOV      DPTR,#nonce_report
B3:00D700 12A624            LCALL    ?L?COM005D
B3:00D703 7E00              MOV      R6,#00H
B3:00D705 30E004            JNB      ACC.0,?C0076?S2
B3:00D708 7F14              MOV      R7,#014H
B3:00D70A 8002              SJMP     ?C0077?S2
B3:00D70C         ?C0076?S2:
B3:00D70C 7F04              MOV      R7,#04H
B3:00D70E         ?C0077?S2:
B3:00D70E 904390            MOV      DPTR,#?___S2_send_frame?BYTE+06H
B3:00D711 EE                MOV      A,R6
B3:00D712 F0                MOVX     @DPTR,A
B3:00D713 A3                INC      DPTR
B3:00D714 EF                MOV      A,R7
B3:00D715 F0                MOVX     @DPTR,A
B3:00D716 903FDF            MOV      DPTR,#conn
B3:00D719 122552            LCALL    ?C?PLDXDATA
B3:00D71C 02BCCE            LJMP     ___S2_send_frame
----- FUNCTION ___S2_send_nonce_report (END) -------


----- FUNCTION ?L?COM0348 (BEGIN) -----
B3:00D71F 903FF6            MOV      DPTR,#nonce_report
B3:00D722 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0348 (END) -------


----- FUNCTION ?L?COM0196 (BEGIN) -----
B3:00D725 122552            LCALL    ?C?PLDXDATA
B3:00D728         ?L?COM0197:
B3:00D728 7E00              MOV      R6,#00H
B3:00D72A 7F10              MOV      R7,#010H
B3:00D72C 021F56            LJMP     ?C?COPY
----- FUNCTION ?L?COM0196 (END) -------


----- FUNCTION ?L?COM02E2 (BEGIN) -----
B3:00D72F 122552            LCALL    ?C?PLDXDATA
B3:00D732         ?L?COM02E3:
B3:00D732 900024            MOV      DPTR,#024H
B3:00D735 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM02E2 (END) -------


----- FUNCTION s2_busy (BEGIN) -----
B3:00D738 D162              ACALL    ?L?COM023C
B3:00D73A E9                MOV      A,R1
B3:00D73B 240F              ADD      A,#0FH
B3:00D73D F151              ACALL    ?L?COM0504
B3:00D73F 7009              JNZ      ?C0044?ZW_SECURITY_SCHEME2
B3:00D741 D162              ACALL    ?L?COM023C
B3:00D743 E9                MOV      A,R1
B3:00D744 240D              ADD      A,#0DH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 898


B3:00D746 F151              ACALL    ?L?COM0504
B3:00D748 6004              JZ       ?C0042?ZW_SECURITY_SCHEME2
B3:00D74A         ?C0044?ZW_SECURITY_SCHEME2:
B3:00D74A 7F01              MOV      R7,#01H
B3:00D74C 8002              SJMP     ?C0043?ZW_SECURITY_SCHEME2
B3:00D74E         ?C0042?ZW_SECURITY_SCHEME2:
B3:00D74E 7F00              MOV      R7,#00H
B3:00D750         ?C0043?ZW_SECURITY_SCHEME2:
B3:00D750 22                RET      
----- FUNCTION s2_busy (END) -------


----- FUNCTION ?L?COM0504 (BEGIN) -----
B3:00D751 F9                MOV      R1,A
B3:00D752 EA                MOV      A,R2
B3:00D753 3402              ADDC     A,#02H
B3:00D755 FA                MOV      R2,A
B3:00D756 021F7C            LJMP     ?C?CLDPTR
----- FUNCTION ?L?COM0504 (END) -------


----- FUNCTION ___S2_register_nonce (BEGIN) -----
B3:00D759 904449            MOV      DPTR,#buf
B3:00D75C 122572            LCALL    ?C?PSTXDATA
B3:00D75F 90444C            MOV      DPTR,#len
B3:00D762 EC                MOV      A,R4
B3:00D763 F0                MOVX     @DPTR,A
B3:00D764 A3                INC      DPTR
B3:00D765 ED                MOV      A,R5
B3:00D766 F0                MOVX     @DPTR,A
B3:00D767 904449            MOV      DPTR,#buf
B3:00D76A 12B990            LCALL    ?L?COM00B5
B3:00D76D FD                MOV      R5,A
B3:00D76E 7B01              MOV      R3,#01H
B3:00D770 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00D772 79D3              MOV      R1,#LOW the_context+0CFH
B3:00D774 12AC7A            LCALL    ___S2_verify_seq
B3:00D777 EF                MOV      A,R7
B3:00D778 4E                ORL      A,R6
B3:00D779 7002              JNZ      ?C0086?S2
B3:00D77B FF                MOV      R7,A
B3:00D77C 22                RET      
B3:00D77D         ?C0086?S2:
B3:00D77D 12D891            LCALL    ?L?COM02E1
B3:00D780 90444E            MOV      DPTR,#span
B3:00D783 EE                MOV      A,R6
B3:00D784 F0                MOVX     @DPTR,A
B3:00D785 A3                INC      DPTR
B3:00D786 EF                MOV      A,R7
B3:00D787 F0                MOVX     @DPTR,A
B3:00D788 C3                CLR      C
B3:00D789 90444D            MOV      DPTR,#len+01H
B3:00D78C E0                MOVX     A,@DPTR
B3:00D78D 9414              SUBB     A,#014H
B3:00D78F 90444C            MOV      DPTR,#len
B3:00D792 E0                MOVX     A,@DPTR
B3:00D793 9400              SUBB     A,#00H
B3:00D795 4027              JC       ?C0088?S2
B3:00D797 904449            MOV      DPTR,#buf
B3:00D79A 12A624            LCALL    ?L?COM005D
B3:00D79D 30E01E            JNB      ACC.0,?C0088?S2
B3:00D7A0 125D38            LCALL    ?L?COM00E5
B3:00D7A3 C002              PUSH     AR2
B3:00D7A5 12EF64            LCALL    ?L?COM055B
B3:00D7A8 AA06              MOV      R2,AR6
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 899


B3:00D7AA F8                MOV      R0,A
B3:00D7AB AC02              MOV      R4,AR2
B3:00D7AD 7D01              MOV      R5,#01H
B3:00D7AF D002              POP      AR2
B3:00D7B1 F128              ACALL    ?L?COM0197
B3:00D7B3 12EF64            LCALL    ?L?COM055B
B3:00D7B6 2426              ADD      A,#026H
B3:00D7B8 12A8B7            LCALL    ?L?COM0094
B3:00D7BB 7404              MOV      A,#04H
B3:00D7BD F0                MOVX     @DPTR,A
B3:00D7BE         ?C0088?S2:
B3:00D7BE 904449            MOV      DPTR,#buf
B3:00D7C1 12A624            LCALL    ?L?COM005D
B3:00D7C4 30E11A            JNB      ACC.1,?C0089?S2
B3:00D7C7 C3                CLR      C
B3:00D7C8 90444D            MOV      DPTR,#len+01H
B3:00D7CB E0                MOVX     A,@DPTR
B3:00D7CC 9403              SUBB     A,#03H
B3:00D7CE 90444C            MOV      DPTR,#len
B3:00D7D1 E0                MOVX     A,@DPTR
B3:00D7D2 9400              SUBB     A,#00H
B3:00D7D4 400B              JC       ?C0089?S2
B3:00D7D6 12C445            LCALL    ?L?COM02DF
B3:00D7D9 9028D4            MOV      DPTR,#the_context+0D0H
B3:00D7DC E0                MOVX     A,@DPTR
B3:00D7DD FD                MOV      R5,A
B3:00D7DE 12E88D            LCALL    _S2_set_node_mos
B3:00D7E1         ?C0089?S2:
B3:00D7E1 904449            MOV      DPTR,#buf
B3:00D7E4 12A624            LCALL    ?L?COM005D
B3:00D7E7 FF                MOV      R7,A
B3:00D7E8 22                RET      
----- FUNCTION ___S2_register_nonce (END) -------


----- FUNCTION clock_time (BEGIN) -----
B3:00D7E9 12593A            LCALL    getTickTime
B3:00D7EC 0247D5            LJMP     ?L?COM056C
----- FUNCTION clock_time (END) -------


----- FUNCTION ZCB_s2_inclusion_txqueue_empty (BEGIN) -----
B3:00D7EF 12ED4F            LCALL    ?L?COM03DC
B3:00D7F2 7F01              MOV      R7,#01H
B3:00D7F4 02A45E            LJMP     _s2_inclusion_challenge_response
----- FUNCTION ZCB_s2_inclusion_txqueue_empty (END) -------


----- FUNCTION _S2_get_commands_supported (BEGIN) -----
;---- Variable 'ppCmdClasses' assigned to Register 'R1/R2/R3' ----
;---- Variable 'class_id' assigned to Register 'R5' ----
B3:00D7F7 ED                MOV      A,R5
B3:00D7F8 04                INC      A
B3:00D7F9 FF                MOV      R7,A
B3:00D7FA C003              PUSH     AR3
B3:00D7FC C002              PUSH     AR2
B3:00D7FE C001              PUSH     AR1
B3:00D800 90439F            MOV      DPTR,#pLength
B3:00D803 122552            LCALL    ?C?PLDXDATA
B3:00D806 904298            MOV      DPTR,#?_ApplicationSecureCommandsSupported?BYTE+04H
B3:00D809 122572            LCALL    ?C?PSTXDATA
B3:00D80C D001              POP      AR1
B3:00D80E D002              POP      AR2
B3:00D810 D003              POP      AR3
B3:00D812 021E7B            LJMP     ?INTERBANK_TABLE?_ApplicationSecureCommandsSupported
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 900


----- FUNCTION _S2_get_commands_supported (END) -------


----- FUNCTION ZW_s2_inclusion_init (BEGIN) -----
B3:00D815 121E6C            LCALL    ?INTERBANK_TABLE?ApplicationSecureKeysRequested
B3:00D818 AB07              MOV      R3,AR7
B3:00D81A 7D01              MOV      R5,#01H
B3:00D81C 7F02              MOV      R7,#02H
B3:00D81E 02A880            LJMP     _s2_inclusion_init
----- FUNCTION ZW_s2_inclusion_init (END) -------


----- FUNCTION _mark_frag_received (BEGIN) -----
;---- Variable 'offset' assigned to Register 'R2/R3' ----
B3:00D821 AB07              MOV      R3,AR7
B3:00D823 AA06              MOV      R2,AR6
B3:00D825 E4                CLR      A
B3:00D826 9046C0            MOV      DPTR,#frag_no
B3:00D829 F0                MOVX     @DPTR,A
B3:00D82A 903197            MOV      DPTR,#rcb+011DH
B3:00D82D E0                MOVX     A,@DPTR
B3:00D82E FE                MOV      R6,A
B3:00D82F 7003              JNZ      ?C0109?TRANSPORT_SERVICE2
B3:00D831 7F01              MOV      R7,#01H
B3:00D833 22                RET      
B3:00D834         ?C0109?TRANSPORT_SERVICE2:
B3:00D834 EB                MOV      A,R3
B3:00D835 4A                ORL      A,R2
B3:00D836 6010              JZ       ?C0111?TRANSPORT_SERVICE2
B3:00D838 EE                MOV      A,R6
B3:00D839 FD                MOV      R5,A
B3:00D83A 7C00              MOV      R4,#00H
B3:00D83C AF03              MOV      R7,AR3
B3:00D83E AE02              MOV      R6,AR2
B3:00D840 122081            LCALL    ?C?UIDIV
B3:00D843 9046C0            MOV      DPTR,#frag_no
B3:00D846 EF                MOV      A,R7
B3:00D847 F0                MOVX     @DPTR,A
B3:00D848         ?C0111?TRANSPORT_SERVICE2:
B3:00D848 EB                MOV      A,R3
B3:00D849 4A                ORL      A,R2
B3:00D84A 6019              JZ       ?C0112?TRANSPORT_SERVICE2
B3:00D84C 903199            MOV      DPTR,#rcb+011FH
B3:00D84F E0                MOVX     A,@DPTR
B3:00D850 7013              JNZ      ?C0112?TRANSPORT_SERVICE2
B3:00D852 12ECE2            LCALL    ?L?COM030D
B3:00D855 6008              JZ       ?C0113?TRANSPORT_SERVICE2
B3:00D857 903213            MOV      DPTR,#scb+06DH
B3:00D85A 7401              MOV      A,#01H
B3:00D85C F0                MOVX     @DPTR,A
B3:00D85D 8003              SJMP     ?C0114?TRANSPORT_SERVICE2
B3:00D85F         ?C0113?TRANSPORT_SERVICE2:
B3:00D85F 12B66A            LCALL    send_frag_wait_cmd
B3:00D862         ?C0114?TRANSPORT_SERVICE2:
B3:00D862 7F01              MOV      R7,#01H
B3:00D864 22                RET      
B3:00D865         ?C0112?TRANSPORT_SERVICE2:
B3:00D865 9046C0            MOV      DPTR,#frag_no
B3:00D868 E0                MOVX     A,@DPTR
B3:00D869 FE                MOV      R6,A
B3:00D86A 2499              ADD      A,#LOW rcb+011FH
B3:00D86C 1183              ACALL    ?L?COM0275
B3:00D86E E0                MOVX     A,@DPTR
B3:00D86F B40103            CJNE     A,#01H,?C0115?TRANSPORT_SERVICE2
B3:00D872 7F01              MOV      R7,#01H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 901


B3:00D874 22                RET      
B3:00D875         ?C0115?TRANSPORT_SERVICE2:
B3:00D875 7499              MOV      A,#LOW rcb+011FH
B3:00D877 2E                ADD      A,R6
B3:00D878 1183              ACALL    ?L?COM0275
B3:00D87A 7401              MOV      A,#01H
B3:00D87C F0                MOVX     @DPTR,A
B3:00D87D 7F00              MOV      R7,#00H
B3:00D87F 22                RET      
----- FUNCTION _mark_frag_received (END) -------


----- FUNCTION ?L?COM0274 (BEGIN) -----
B3:00D880 7499              MOV      A,#LOW rcb+011FH
B3:00D882 2A                ADD      A,R2
B3:00D883         ?L?COM0275:
B3:00D883 F582              MOV      DPL,A
B3:00D885 E4                CLR      A
B3:00D886 3431              ADDC     A,#HIGH rcb+011FH
B3:00D888 F583              MOV      DPH,A
B3:00D88A 22                RET      
----- FUNCTION ?L?COM0274 (END) -------


----- FUNCTION _secure_learnIface_get_scheme (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00D88B 900010            MOV      DPTR,#010H
B3:00D88E 0223F4            LJMP     ?C?LLDOPTR
----- FUNCTION _secure_learnIface_get_scheme (END) -------


----- FUNCTION ?L?COM02E1 (BEGIN) -----
B3:00D891 7B01              MOV      R3,#01H
B3:00D893 7A28              MOV      R2,#HIGH the_context+0CFH
B3:00D895 79D3              MOV      R1,#LOW the_context+0CFH
----- FUNCTION ___find_span_by_node (BEGIN) -----
B3:00D897 904089            MOV      DPTR,#con
B3:00D89A 122572            LCALL    ?C?PSTXDATA
B3:00D89D 51FF              ACALL    ?L?COM055E
B3:00D89F         ?C0014?S2:
B3:00D89F 90409C            MOV      DPTR,#i
B3:00D8A2 51D6              ACALL    ?L?COM014A
B3:00D8A4 51CB              ACALL    ?L?COM0355
B3:00D8A6 5040              JNC      ?C0015?S2
B3:00D8A8 31A1              ACALL    ?L?COM0303
B3:00D8AA 319B              ACALL    ?L?COM013E
B3:00D8AC 6033              JZ       ?C0016?S2
B3:00D8AE 7A29              MOV      R2,#HIGH the_context+0101H
B3:00D8B0 7905              MOV      R1,#LOW the_context+0101H
B3:00D8B2 90409C            MOV      DPTR,#i
B3:00D8B5 A3                INC      DPTR
B3:00D8B6 E0                MOVX     A,@DPTR
B3:00D8B7 F582              MOV      DPL,A
B3:00D8B9 8E83              MOV      DPH,R6
B3:00D8BB 7427              MOV      A,#027H
B3:00D8BD 319B              ACALL    ?L?COM013E
B3:00D8BF FD                MOV      R5,A
B3:00D8C0 12A3E3            LCALL    ?L?COM0076
B3:00D8C3 6D                XRL      A,R5
B3:00D8C4 701B              JNZ      ?C0016?S2
B3:00D8C6 7B01              MOV      R3,#01H
B3:00D8C8 7A29              MOV      R2,#HIGH the_context+0102H
B3:00D8CA 7906              MOV      R1,#LOW the_context+0102H
B3:00D8CC 31AE              ACALL    ?L?COM0212
B3:00D8CE 7427              MOV      A,#027H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 902


B3:00D8D0 319B              ACALL    ?L?COM013E
B3:00D8D2 FF                MOV      R7,A
B3:00D8D3 904089            MOV      DPTR,#con
B3:00D8D6 129CA2            LCALL    ?L?COM0064
B3:00D8D9 B50705            CJNE     A,AR7,?C0016?S2
B3:00D8DC 90409C            MOV      DPTR,#i
B3:00D8DF 2173              AJMP     ?C0275?S2
B3:00D8E1         ?C0016?S2:
B3:00D8E1 51F7              ACALL    ?L?COM055D
B3:00D8E3 12210C            LCALL    ?C?IILDX
B3:00D8E6 80B7              SJMP     ?C0014?S2
B3:00D8E8         ?C0015?S2:
B3:00D8E8 7B01              MOV      R3,#01H
B3:00D8EA 7A40              MOV      R2,#HIGH rnd
B3:00D8EC 798C              MOV      R1,#LOW rnd
B3:00D8EE 51EA              ACALL    ?L?COM013A
B3:00D8F0 51FF              ACALL    ?L?COM055E
B3:00D8F2         ?C0019?S2:
B3:00D8F2 90409C            MOV      DPTR,#i
B3:00D8F5 51D6              ACALL    ?L?COM014A
B3:00D8F7 51CB              ACALL    ?L?COM0355
B3:00D8F9 500D              JNC      ?C0020?S2
B3:00D8FB 31A1              ACALL    ?L?COM0303
B3:00D8FD 319B              ACALL    ?L?COM013E
B3:00D8FF 6007              JZ       ?C0020?S2
B3:00D901         ?C0022?S2:
B3:00D901         ?C0021?S2:
B3:00D901 51F7              ACALL    ?L?COM055D
B3:00D903 12210C            LCALL    ?C?IILDX
B3:00D906 80EA              SJMP     ?C0019?S2
B3:00D908         ?C0020?S2:
B3:00D908 90409C            MOV      DPTR,#i
B3:00D90B E0                MOVX     A,@DPTR
B3:00D90C 7004              JNZ      ?C0266?S2
B3:00D90E A3                INC      DPTR
B3:00D90F E0                MOVX     A,@DPTR
B3:00D910 6405              XRL      A,#05H
B3:00D912         ?C0266?S2:
B3:00D912 7009              JNZ      ?C0023?S2
B3:00D914 90408C            MOV      DPTR,#rnd
B3:00D917 E0                MOVX     A,@DPTR
B3:00D918 90409C            MOV      DPTR,#i
B3:00D91B 710F              ACALL    ?L?COM0419
B3:00D91D         ?C0023?S2:
B3:00D91D 7B01              MOV      R3,#01H
B3:00D91F 7A29              MOV      R2,#HIGH the_context+0106H
B3:00D921 790A              MOV      R1,#LOW the_context+0106H
B3:00D923 90409C            MOV      DPTR,#i
B3:00D926 12BE72            LCALL    ?L?COM00C0
B3:00D929 7427              MOV      A,#027H
B3:00D92B 122535            LCALL    ?C?OFFX256
B3:00D92E 7401              MOV      A,#01H
B3:00D930 12204D            LCALL    ?C?CSTOPTR
B3:00D933 12A3E3            LCALL    ?L?COM0076
B3:00D936 FD                MOV      R5,A
B3:00D937 7B01              MOV      R3,#01H
B3:00D939 7A29              MOV      R2,#HIGH the_context+0101H
B3:00D93B 7905              MOV      R1,#LOW the_context+0101H
B3:00D93D 31A7              ACALL    ?L?COM0304
B3:00D93F 122535            LCALL    ?C?OFFX256
B3:00D942 ED                MOV      A,R5
B3:00D943 12204D            LCALL    ?C?CSTOPTR
B3:00D946 904089            MOV      DPTR,#con
B3:00D949 129CA2            LCALL    ?L?COM0064
B3:00D94C FF                MOV      R7,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 903


B3:00D94D 7B01              MOV      R3,#01H
B3:00D94F 7A29              MOV      R2,#HIGH the_context+0102H
B3:00D951 7906              MOV      R1,#LOW the_context+0102H
B3:00D953 90409C            MOV      DPTR,#i
B3:00D956 126E13            LCALL    ?L?COM01A3
B3:00D959 7427              MOV      A,#027H
B3:00D95B 51E3              ACALL    ?L?COM02E7
B3:00D95D 90408D            MOV      DPTR,#rnd+01H
B3:00D960 E0                MOVX     A,@DPTR
B3:00D961 FF                MOV      R7,A
B3:00D962 7A29              MOV      R2,#HIGH the_context+0104H
B3:00D964 7908              MOV      R1,#LOW the_context+0104H
B3:00D966 8D82              MOV      DPL,R5
B3:00D968 8C83              MOV      DPH,R4
B3:00D96A 7427              MOV      A,#027H
B3:00D96C 51E3              ACALL    ?L?COM02E7
B3:00D96E 90409C            MOV      DPTR,#i
B3:00D971 E0                MOVX     A,@DPTR
B3:00D972 FE                MOV      R6,A
B3:00D973         
B3:00D973 A3                INC      DPTR
B3:00D974 E0                MOVX     A,@DPTR
B3:00D975 FF                MOV      R7,A
B3:00D976 7C00              MOV      R4,#00H
B3:00D978 7D27              MOV      R5,#027H
B3:00D97A 12206F            LCALL    ?C?IMUL
B3:00D97D 74E4              MOV      A,#LOW the_context+0E0H
B3:00D97F 2F                ADD      A,R7
B3:00D980 F9                MOV      R1,A
B3:00D981 7428              MOV      A,#HIGH the_context+0E0H
B3:00D983 3E                ADDC     A,R6
B3:00D984 FE                MOV      R6,A
B3:00D985 AF01              MOV      R7,AR1
B3:00D987 9028E0            MOV      DPTR,#the_context+0DCH
B3:00D98A F0                MOVX     @DPTR,A
B3:00D98B A3                INC      DPTR
B3:00D98C EF                MOV      A,R7
B3:00D98D F0                MOVX     @DPTR,A
B3:00D98E 22                RET      
----- FUNCTION ___find_span_by_node (END) -------


----- FUNCTION ?L?COM013B (BEGIN) -----
B3:00D98F 7B01              MOV      R3,#01H
B3:00D991 7A29              MOV      R2,#HIGH the_context+01B6H
B3:00D993 79BA              MOV      R1,#LOW the_context+01B6H
B3:00D995         ?L?COM013C:
B3:00D995 8F82              MOV      DPL,R7
B3:00D997         ?L?COM013D:
B3:00D997 8E83              MOV      DPH,R6
B3:00D999 7414              MOV      A,#014H
B3:00D99B         ?L?COM013E:
B3:00D99B 122535            LCALL    ?C?OFFX256
B3:00D99E 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM013B (END) -------


----- FUNCTION ?L?COM0303 (BEGIN) -----
B3:00D9A1 7B01              MOV      R3,#01H
B3:00D9A3 7A29              MOV      R2,#HIGH the_context+0106H
B3:00D9A5 790A              MOV      R1,#LOW the_context+0106H
B3:00D9A7         ?L?COM0304:
B3:00D9A7 8F82              MOV      DPL,R7
B3:00D9A9 8E83              MOV      DPH,R6
B3:00D9AB 7427              MOV      A,#027H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 904


B3:00D9AD 22                RET      
----- FUNCTION ?L?COM0303 (END) -------


----- FUNCTION ?L?COM0212 (BEGIN) -----
B3:00D9AE 8F82              MOV      DPL,R7
B3:00D9B0 8E83              MOV      DPH,R6
B3:00D9B2 22                RET      
----- FUNCTION ?L?COM0212 (END) -------


----- FUNCTION _secure_learn_raiseTimeEvent (BEGIN) -----
B3:00D9B3 9044D3            MOV      DPTR,#handle
B3:00D9B6 122572            LCALL    ?C?PSTXDATA
B3:00D9B9 713C              ACALL    ?L?COM032D
B3:00D9BB C003              PUSH     AR3
B3:00D9BD C002              PUSH     AR2
B3:00D9BF C001              PUSH     AR1
B3:00D9C1 712B              ACALL    ?L?COM056B
B3:00D9C3 D082              POP      DPL
B3:00D9C5 D083              POP      DPH
B3:00D9C7 D0E0              POP      ACC
B3:00D9C9 127012            LCALL    ?L?COM04A9
B3:00D9CC         ?C0161?SECURE_LEARN:
B3:00D9CC 401E              JC       ?C0040?SECURE_LEARN
B3:00D9CE 713C              ACALL    ?L?COM032D
B3:00D9D0 126F9C            LCALL    ?L?COM0438
B3:00D9D3 C003              PUSH     AR3
B3:00D9D5 C002              PUSH     AR2
B3:00D9D7 C001              PUSH     AR1
B3:00D9D9 712B              ACALL    ?L?COM056B
B3:00D9DB D082              POP      DPL
B3:00D9DD D083              POP      DPH
B3:00D9DF D0E0              POP      ACC
B3:00D9E1 127012            LCALL    ?L?COM04A9
B3:00D9E4         ?C0162?SECURE_LEARN:
B3:00D9E4 5006              JNC      ?C0040?SECURE_LEARN
B3:00D9E6 9044D6            MOV      DPTR,#evid
B3:00D9E9 126F2D            LCALL    ?L?COM03A2
B3:00D9EC         ?C0040?SECURE_LEARN:
B3:00D9EC 22                RET      
----- FUNCTION _secure_learn_raiseTimeEvent (END) -------


----- FUNCTION ___find_mpan_by_group_id (BEGIN) -----
B3:00D9ED 904074            MOV      DPTR,#owner_id
B3:00D9F0 126563            LCALL    ?L?COM00E9
B3:00D9F3 EB                MOV      A,R3
B3:00D9F4 F0                MOVX     @DPTR,A
B3:00D9F5 711B              ACALL    ?L?COM0560
B3:00D9F7         ?C0001?S2:
B3:00D9F7 51D3              ACALL    ?L?COM0149
B3:00D9F9 51CB              ACALL    ?L?COM0355
B3:00D9FB 5043              JNC      ?C0002?S2
B3:00D9FD 318F              ACALL    ?L?COM013B
B3:00D9FF 6038              JZ       ?C0003?S2
B3:00DA01 7A29              MOV      R2,#HIGH the_context+01A4H
B3:00DA03 79A8              MOV      R1,#LOW the_context+01A4H
B3:00DA05 7123              ACALL    ?L?COM0561
B3:00DA07 3197              ACALL    ?L?COM013D
B3:00DA09 FD                MOV      R5,A
B3:00DA0A 904075            MOV      DPTR,#group_id
B3:00DA0D E0                MOVX     A,@DPTR
B3:00DA0E 6D                XRL      A,R5
B3:00DA0F 7028              JNZ      ?C0003?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 905


B3:00DA11 7A29              MOV      R2,#HIGH the_context+01A3H
B3:00DA13 19                DEC      R1
B3:00DA14 3195              ACALL    ?L?COM013C
B3:00DA16 FF                MOV      R7,A
B3:00DA17 904074            MOV      DPTR,#owner_id
B3:00DA1A E0                MOVX     A,@DPTR
B3:00DA1B 6F                XRL      A,R7
B3:00DA1C 701B              JNZ      ?C0003?S2
B3:00DA1E 7A29              MOV      R2,#HIGH the_context+01B5H
B3:00DA20 79B9              MOV      R1,#LOW the_context+01B5H
B3:00DA22 7123              ACALL    ?L?COM0561
B3:00DA24 3197              ACALL    ?L?COM013D
B3:00DA26 126D9E            LCALL    ?L?COM016A
B3:00DA29 8005              SJMP     ?C0264?S2
B3:00DA2B         ?C0263?S2:
B3:00DA2B C3                CLR      C
B3:00DA2C 33                RLC      A
B3:00DA2D CE                XCH      A,R6
B3:00DA2E 33                RLC      A
B3:00DA2F CE                XCH      A,R6
B3:00DA30         ?C0264?S2:
B3:00DA30 D8F9              DJNZ     R0,?C0263?S2
B3:00DA32 12EF2F            LCALL    ?L?COM0500
B3:00DA35 6002              JZ       ?C0003?S2
B3:00DA37 41BE              AJMP     ?C0274?S2
B3:00DA39         ?C0003?S2:
B3:00DA39 7107              ACALL    ?L?COM055F
B3:00DA3B 12210C            LCALL    ?C?IILDX
B3:00DA3E 80B7              SJMP     ?C0001?S2
B3:00DA40         ?C0002?S2:
B3:00DA40 904076            MOV      DPTR,#create_new
B3:00DA43 E0                MOVX     A,@DPTR
B3:00DA44 7004              JNZ      ?C0006?S2
B3:00DA46 FB                MOV      R3,A
B3:00DA47 FA                MOV      R2,A
B3:00DA48 F9                MOV      R1,A
B3:00DA49 22                RET      
B3:00DA4A         ?C0006?S2:
B3:00DA4A 7B01              MOV      R3,#01H
B3:00DA4C 7A40              MOV      R2,#HIGH rnd
B3:00DA4E 7977              MOV      R1,#LOW rnd
B3:00DA50 51EA              ACALL    ?L?COM013A
B3:00DA52 711B              ACALL    ?L?COM0560
B3:00DA54         ?C0007?S2:
B3:00DA54 51D3              ACALL    ?L?COM0149
B3:00DA56 51CB              ACALL    ?L?COM0355
B3:00DA58 500B              JNC      ?C0008?S2
B3:00DA5A 318F              ACALL    ?L?COM013B
B3:00DA5C 6007              JZ       ?C0008?S2
B3:00DA5E         ?C0010?S2:
B3:00DA5E         ?C0009?S2:
B3:00DA5E 7107              ACALL    ?L?COM055F
B3:00DA60 12210C            LCALL    ?C?IILDX
B3:00DA63 80EF              SJMP     ?C0007?S2
B3:00DA65         ?C0008?S2:
B3:00DA65 904087            MOV      DPTR,#i
B3:00DA68 E0                MOVX     A,@DPTR
B3:00DA69 7004              JNZ      ?C0265?S2
B3:00DA6B A3                INC      DPTR
B3:00DA6C E0                MOVX     A,@DPTR
B3:00DA6D 6405              XRL      A,#05H
B3:00DA6F         ?C0265?S2:
B3:00DA6F 7009              JNZ      ?C0011?S2
B3:00DA71 904077            MOV      DPTR,#rnd
B3:00DA74 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 906


B3:00DA75 904087            MOV      DPTR,#i
B3:00DA78 710F              ACALL    ?L?COM0419
B3:00DA7A         ?C0011?S2:
B3:00DA7A 904074            MOV      DPTR,#owner_id
B3:00DA7D E0                MOVX     A,@DPTR
B3:00DA7E FF                MOV      R7,A
B3:00DA7F 7E01              MOV      R6,#01H
B3:00DA81 6002              JZ       ?C0012?S2
B3:00DA83 7E02              MOV      R6,#02H
B3:00DA85         ?C0012?S2:
B3:00DA85         ?C0013?S2:
B3:00DA85 7B01              MOV      R3,#01H
B3:00DA87 7A29              MOV      R2,#HIGH the_context+01B6H
B3:00DA89 79BA              MOV      R1,#LOW the_context+01B6H
B3:00DA8B 904087            MOV      DPTR,#i
B3:00DA8E 126E13            LCALL    ?L?COM01A3
B3:00DA91 7133              ACALL    ?L?COM0451
B3:00DA93 904075            MOV      DPTR,#group_id
B3:00DA96 E0                MOVX     A,@DPTR
B3:00DA97 FE                MOV      R6,A
B3:00DA98 7A29              MOV      R2,#HIGH the_context+01A4H
B3:00DA9A 79A8              MOV      R1,#LOW the_context+01A4H
B3:00DA9C 8D82              MOV      DPL,R5
B3:00DA9E 8C83              MOV      DPH,R4
B3:00DAA0 7133              ACALL    ?L?COM0451
B3:00DAA2 7A29              MOV      R2,#HIGH the_context+01A3H
B3:00DAA4 19                DEC      R1
B3:00DAA5 51DD              ACALL    ?L?COM02E6
B3:00DAA7 9028DA            MOV      DPTR,#the_context+0D6H
B3:00DAAA E0                MOVX     A,@DPTR
B3:00DAAB FF                MOV      R7,A
B3:00DAAC 7A29              MOV      R2,#HIGH the_context+01B5H
B3:00DAAE 79B9              MOV      R1,#LOW the_context+01B5H
B3:00DAB0 51DD              ACALL    ?L?COM02E6
B3:00DAB2 7160              ACALL    ?L?COM024C
B3:00DAB4 74A9              MOV      A,#LOW the_context+01A5H
B3:00DAB6 2F                ADD      A,R7
B3:00DAB7 F9                MOV      R1,A
B3:00DAB8 7429              MOV      A,#HIGH the_context+01A5H
B3:00DABA 3E                ADDC     A,R6
B3:00DABB FA                MOV      R2,A
B3:00DABC 51EA              ACALL    ?L?COM013A
B3:00DABE         
B3:00DABE 7160              ACALL    ?L?COM024C
B3:00DAC0 7B01              MOV      R3,#01H
B3:00DAC2 74A7              MOV      A,#LOW the_context+01A3H
B3:00DAC4 2F                ADD      A,R7
B3:00DAC5 F9                MOV      R1,A
B3:00DAC6 7429              MOV      A,#HIGH the_context+01A3H
B3:00DAC8 3E                ADDC     A,R6
B3:00DAC9 FA                MOV      R2,A
B3:00DACA 22                RET      
----- FUNCTION ___find_mpan_by_group_id (END) -------


----- FUNCTION ?L?COM0355 (BEGIN) -----
B3:00DACB 9405              SUBB     A,#05H
B3:00DACD EE                MOV      A,R6
B3:00DACE 6480              XRL      A,#080H
B3:00DAD0 9480              SUBB     A,#080H
B3:00DAD2 22                RET      
----- FUNCTION ?L?COM0355 (END) -------


----- FUNCTION ?L?COM0149 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 907


B3:00DAD3 904087            MOV      DPTR,#i
B3:00DAD6         ?L?COM014A:
B3:00DAD6 E0                MOVX     A,@DPTR
B3:00DAD7 FE                MOV      R6,A
B3:00DAD8 A3                INC      DPTR
B3:00DAD9 E0                MOVX     A,@DPTR
B3:00DADA FF                MOV      R7,A
B3:00DADB C3                CLR      C
B3:00DADC 22                RET      
----- FUNCTION ?L?COM0149 (END) -------


----- FUNCTION ?L?COM02E6 (BEGIN) -----
B3:00DADD 8D82              MOV      DPL,R5
B3:00DADF 8C83              MOV      DPH,R4
B3:00DAE1 7414              MOV      A,#014H
B3:00DAE3         ?L?COM02E7:
B3:00DAE3 122535            LCALL    ?C?OFFX256
B3:00DAE6 EF                MOV      A,R7
B3:00DAE7 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM02E6 (END) -------


----- FUNCTION ?L?COM013A (BEGIN) -----
B3:00DAEA 903E72            MOV      DPTR,#?_AES_CTR_DRBG_Generate?BYTE+03H
B3:00DAED 122572            LCALL    ?C?PSTXDATA
B3:00DAF0 7A2B              MOV      R2,#HIGH s2_ctr_drbg
B3:00DAF2 795C              MOV      R1,#LOW s2_ctr_drbg
B3:00DAF4 021B42            LJMP     ?INTERBANK_TABLE?_AES_CTR_DRBG_Generate
----- FUNCTION ?L?COM013A (END) -------


----- FUNCTION ?L?COM055D (BEGIN) -----
B3:00DAF7 90409C            MOV      DPTR,#i
B3:00DAFA E4                CLR      A
B3:00DAFB 75F001            MOV      B,#01H
B3:00DAFE 22                RET      
----- FUNCTION ?L?COM055D (END) -------


----- FUNCTION ?L?COM055E (BEGIN) -----
B3:00DAFF E4                CLR      A
B3:00DB00 90409C            MOV      DPTR,#i
B3:00DB03 F0                MOVX     @DPTR,A
B3:00DB04 A3                INC      DPTR
B3:00DB05 F0                MOVX     @DPTR,A
B3:00DB06 22                RET      
----- FUNCTION ?L?COM055E (END) -------


----- FUNCTION ?L?COM055F (BEGIN) -----
B3:00DB07 904087            MOV      DPTR,#i
B3:00DB0A E4                CLR      A
B3:00DB0B 75F001            MOV      B,#01H
B3:00DB0E 22                RET      
----- FUNCTION ?L?COM055F (END) -------


----- FUNCTION ?L?COM0419 (BEGIN) -----
B3:00DB0F 75F005            MOV      B,#05H
B3:00DB12 84                DIV      AB
B3:00DB13 AFF0              MOV      R7,B
B3:00DB15 E4                CLR      A
B3:00DB16 F0                MOVX     @DPTR,A
B3:00DB17 A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 908


B3:00DB18 EF                MOV      A,R7
B3:00DB19 F0                MOVX     @DPTR,A
B3:00DB1A 22                RET      
----- FUNCTION ?L?COM0419 (END) -------


----- FUNCTION ?L?COM0560 (BEGIN) -----
B3:00DB1B E4                CLR      A
B3:00DB1C 904087            MOV      DPTR,#i
B3:00DB1F F0                MOVX     @DPTR,A
B3:00DB20 A3                INC      DPTR
B3:00DB21 F0                MOVX     @DPTR,A
B3:00DB22 22                RET      
----- FUNCTION ?L?COM0560 (END) -------


----- FUNCTION ?L?COM0561 (BEGIN) -----
B3:00DB23 904087            MOV      DPTR,#i
B3:00DB26 A3                INC      DPTR
B3:00DB27 E0                MOVX     A,@DPTR
B3:00DB28 F582              MOV      DPL,A
B3:00DB2A 22                RET      
----- FUNCTION ?L?COM0561 (END) -------


----- FUNCTION ?L?COM056B (BEGIN) -----
B3:00DB2B 9044D6            MOV      DPTR,#evid
B3:00DB2E 122552            LCALL    ?C?PLDXDATA
B3:00DB31 C3                CLR      C
B3:00DB32 22                RET      
----- FUNCTION ?L?COM056B (END) -------


----- FUNCTION ?L?COM0451 (BEGIN) -----
B3:00DB33 7414              MOV      A,#014H
B3:00DB35 122535            LCALL    ?C?OFFX256
B3:00DB38 EE                MOV      A,R6
B3:00DB39 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM0451 (END) -------


----- FUNCTION ?L?COM032D (BEGIN) -----
B3:00DB3C 9044D3            MOV      DPTR,#handle
B3:00DB3F 122552            LCALL    ?C?PLDXDATA
B3:00DB42 E9                MOV      A,R1
B3:00DB43 2440              ADD      A,#040H
B3:00DB45 F9                MOV      R1,A
B3:00DB46 E4                CLR      A
B3:00DB47 3A                ADDC     A,R2
B3:00DB48 FA                MOV      R2,A
B3:00DB49 22                RET      
----- FUNCTION ?L?COM032D (END) -------


----- FUNCTION _secure_learnIface_raise_learnRequest (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00DB4A 900018            MOV      DPTR,#018H
B3:00DB4D 7401              MOV      A,#01H
B3:00DB4F 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_learnRequest (END) -------


----- FUNCTION _secure_learnIface_raise_inclusionRequest (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 909


B3:00DB52 90001B            MOV      DPTR,#01BH
B3:00DB55 12243E            LCALL    ?C?LSTOPTR
B3:00DB58 90001A            MOV      DPTR,#01AH
B3:00DB5B 7401              MOV      A,#01H
B3:00DB5D 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_inclusionRequest (END) -------


----- FUNCTION ?L?COM024C (BEGIN) -----
B3:00DB60 904087            MOV      DPTR,#i
B3:00DB63 E0                MOVX     A,@DPTR
B3:00DB64 FE                MOV      R6,A
B3:00DB65 A3                INC      DPTR
B3:00DB66 E0                MOVX     A,@DPTR
B3:00DB67 FF                MOV      R7,A
B3:00DB68 7C00              MOV      R4,#00H
B3:00DB6A 7D14              MOV      R5,#014H
B3:00DB6C 02206F            LJMP     ?C?IMUL
----- FUNCTION ?L?COM024C (END) -------


----- FUNCTION _secure_learnIface_raise_commandsSupportedRequest (BEGIN) -----
B3:00DB6F 9044D9            MOV      DPTR,#handle
B3:00DB72 122572            LCALL    ?C?PSTXDATA
B3:00DB75 9044DC            MOV      DPTR,#value
B3:00DB78 122552            LCALL    ?C?PLDXDATA
B3:00DB7B C003              PUSH     AR3
B3:00DB7D C002              PUSH     AR2
B3:00DB7F C001              PUSH     AR1
B3:00DB81 9044D9            MOV      DPTR,#handle
B3:00DB84 122552            LCALL    ?C?PLDXDATA
B3:00DB87 900020            MOV      DPTR,#020H
B3:00DB8A 122626            LCALL    ?C?PSTOPTR
B3:00DB8D 9044D9            MOV      DPTR,#handle
B3:00DB90 122552            LCALL    ?C?PLDXDATA
B3:00DB93 90001F            MOV      DPTR,#01FH
B3:00DB96 7401              MOV      A,#01H
B3:00DB98 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_commandsSupportedRequest (END) -------


----- FUNCTION _ZCB_ts_senddata_cb (BEGIN) -----
B3:00DB9B 9045AE            MOV      DPTR,#status_send
B3:00DB9E 126E8B            LCALL    ?L?COM02DB
B3:00DBA1 9045AF            MOV      DPTR,#txStatus
B3:00DBA4 122552            LCALL    ?C?PLDXDATA
B3:00DBA7 128549            LCALL    ?L?COM0019
B3:00DBAA 12818D            LCALL    ?L?COM029F
B3:00DBAD 90321C            MOV      DPTR,#scb+076H
B3:00DBB0 E0                MOVX     A,@DPTR
B3:00DBB1 7002              JNZ      ?C0199?TRANSPORT_SERVICE2
B3:00DBB3 A3                INC      DPTR
B3:00DBB4 E0                MOVX     A,@DPTR
B3:00DBB5         ?C0199?TRANSPORT_SERVICE2:
B3:00DBB5 6019              JZ       ?C0046?TRANSPORT_SERVICE2
B3:00DBB7 12D7E9            LCALL    clock_time
B3:00DBBA 90321C            MOV      DPTR,#scb+076H
B3:00DBBD 91D2              ACALL    ?L?COM0228
B3:00DBBF 90321C            MOV      DPTR,#scb+076H
B3:00DBC2 127002            LCALL    ?L?COM049F
B3:00DBC5 90321C            MOV      DPTR,#scb+076H
B3:00DBC8 7401              MOV      A,#01H
B3:00DBCA 75F02C            MOV      B,#02CH
B3:00DBCD 12210C            LCALL    ?C?IILDX
B3:00DBD0         ?C0046?TRANSPORT_SERVICE2:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 910


B3:00DBD0         ?C0047?TRANSPORT_SERVICE2:
B3:00DBD0 903214            MOV      DPTR,#scb+06EH
B3:00DBD3 E0                MOVX     A,@DPTR
B3:00DBD4 6008              JZ       ?C0048?TRANSPORT_SERVICE2
B3:00DBD6 E4                CLR      A
B3:00DBD7 F0                MOVX     @DPTR,A
B3:00DBD8 FB                MOV      R3,A
B3:00DBD9 FA                MOV      R2,A
B3:00DBDA F9                MOV      R1,A
B3:00DBDB 02B551            LJMP     _reply_frag_req
B3:00DBDE         ?C0048?TRANSPORT_SERVICE2:
B3:00DBDE 903213            MOV      DPTR,#scb+06DH
B3:00DBE1 E0                MOVX     A,@DPTR
B3:00DBE2 6005              JZ       ?C0050?TRANSPORT_SERVICE2
B3:00DBE4 E4                CLR      A
B3:00DBE5 F0                MOVX     @DPTR,A
B3:00DBE6 02B66A            LJMP     send_frag_wait_cmd
B3:00DBE9         ?C0050?TRANSPORT_SERVICE2:
B3:00DBE9 12C490            LCALL    ?L?COM049E
B3:00DBEC B5070B            CJNE     A,AR7,?C0051?TRANSPORT_SERVICE2
B3:00DBEF 7B01              MOV      R3,#01H
B3:00DBF1 7A31              MOV      R2,#HIGH scb+04EH
B3:00DBF3 79F4              MOV      R1,#LOW scb+04EH
B3:00DBF5 121B2E            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00DBF8 8024              SJMP     ?C0052?TRANSPORT_SERVICE2
B3:00DBFA         ?C0051?TRANSPORT_SERVICE2:
B3:00DBFA 90321D            MOV      DPTR,#scb+077H
B3:00DBFD E0                MOVX     A,@DPTR
B3:00DBFE 240F              ADD      A,#0FH
B3:00DC00 90321C            MOV      DPTR,#scb+076H
B3:00DC03 127043            LCALL    ?L?COM04FA
B3:00DC06 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00DC09 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_send_subseq_frag
B3:00DC0B F0                MOVX     @DPTR,A
B3:00DC0C A3                INC      DPTR
B3:00DC0D 74B3              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_send_subseq_frag
B3:00DC0F 12B326            LCALL    ?L?COM004A
B3:00DC12 A3                INC      DPTR
B3:00DC13 122572            LCALL    ?C?PSTXDATA
B3:00DC16 0B                INC      R3
B3:00DC17 7A31              MOV      R2,#HIGH scb+04EH
B3:00DC19 79F4              MOV      R1,#LOW scb+04EH
B3:00DC1B 121B29            LCALL    ?INTERBANK_TABLE?_ctimer_set
B3:00DC1E         ?C0052?TRANSPORT_SERVICE2:
B3:00DC1E E4                CLR      A
B3:00DC1F 90321C            MOV      DPTR,#scb+076H
B3:00DC22 F0                MOVX     @DPTR,A
B3:00DC23 A3                INC      DPTR
B3:00DC24 F0                MOVX     @DPTR,A
B3:00DC25 22                RET      
----- FUNCTION _ZCB_ts_senddata_cb (END) -------


----- FUNCTION ZW_FirmwareUpdate_NVM_Init (BEGIN) -----
B3:00DC26 E4                CLR      A
B3:00DC27 903CF2            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00DC2A F0                MOVX     @DPTR,A
B3:00DC2B 7B01              MOV      R3,#01H
B3:00DC2D 7A3C              MOV      R2,#HIGH systemNVM_type
B3:00DC2F 79C2              MOV      R1,#LOW systemNVM_type
B3:00DC31 126B51            LCALL    _NVM_get_id
B3:00DC34 903CC4            MOV      DPTR,#systemNVM_type+02H
B3:00DC37 E0                MOVX     A,@DPTR
B3:00DC38 FF                MOV      R7,A
B3:00DC39 7411              MOV      A,#011H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 911


B3:00DC3B D3                SETB     C
B3:00DC3C 9F                SUBB     A,R7
B3:00DC3D 5069              JNC      ?C0001?ZW_FIRMWARE_UPDATE_NVM
B3:00DC3F E4                CLR      A
B3:00DC40 FF                MOV      R7,A
B3:00DC41 FE                MOV      R6,A
B3:00DC42 FD                MOV      R5,A
B3:00DC43 FC                MOV      R4,A
B3:00DC44 7B01              MOV      R3,#01H
B3:00DC46 7A45              MOV      R2,#HIGH tempTotalEnd
B3:00DC48 798C              MOV      R1,#LOW tempTotalEnd
B3:00DC4A 9042AE            MOV      DPTR,#?_NVM_ext_read_long_buffer?BYTE+07H
B3:00DC4D F0                MOVX     @DPTR,A
B3:00DC4E A3                INC      DPTR
B3:00DC4F 7402              MOV      A,#02H
B3:00DC51 F0                MOVX     @DPTR,A
B3:00DC52 123817            LCALL    _NVM_ext_read_long_buffer
B3:00DC55 90458C            MOV      DPTR,#tempTotalEnd
B3:00DC58 12E428            LCALL    ?L?COM0096
B3:00DC5B FD                MOV      R5,A
B3:00DC5C 91C9              ACALL    ?L?COM04A6
B3:00DC5E 12C256            LCALL    ?L?COM02D4
B3:00DC61 EF                MOV      A,R7
B3:00DC62 2402              ADD      A,#02H
B3:00DC64 124DBF            LCALL    ?L?COM0044
B3:00DC67 91C9              ACALL    ?L?COM04A6
B3:00DC69 904158            MOV      DPTR,#NVRbNVMPageSize+01H
B3:00DC6C E0                MOVX     A,@DPTR
B3:00DC6D 24FF              ADD      A,#0FFH
B3:00DC6F FF                MOV      R7,A
B3:00DC70 904157            MOV      DPTR,#NVRbNVMPageSize
B3:00DC73 E0                MOVX     A,@DPTR
B3:00DC74 34FF              ADDC     A,#0FFH
B3:00DC76 FE                MOV      R6,A
B3:00DC77 E4                CLR      A
B3:00DC78 FC                MOV      R4,A
B3:00DC79 FD                MOV      R5,A
B3:00DC7A 903CEE            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00DC7D 12247E            LCALL    ?C?LLDXDATA0
B3:00DC80 12236C            LCALL    ?C?LAND
B3:00DC83 90458A            MOV      DPTR,#misalignment
B3:00DC86 EE                MOV      A,R6
B3:00DC87 F0                MOVX     @DPTR,A
B3:00DC88 A3                INC      DPTR
B3:00DC89 EF                MOV      A,R7
B3:00DC8A F0                MOVX     @DPTR,A
B3:00DC8B 903CEE            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00DC8E 12247E            LCALL    ?C?LLDXDATA0
B3:00DC91 90458A            MOV      DPTR,#misalignment
B3:00DC94 51D6              ACALL    ?L?COM014A
B3:00DC96 126F5D            LCALL    ?L?COM0400
B3:00DC99 FE                MOV      R6,A
B3:00DC9A E4                CLR      A
B3:00DC9B FC                MOV      R4,A
B3:00DC9C FD                MOV      R5,A
B3:00DC9D 122234            LCALL    ?C?LADD
B3:00DCA0 91C9              ACALL    ?L?COM04A6
B3:00DCA2 903CF2            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00DCA5 7401              MOV      A,#01H
B3:00DCA7 F0                MOVX     @DPTR,A
B3:00DCA8         ?C0001?ZW_FIRMWARE_UPDATE_NVM:
B3:00DCA8 903CF2            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00DCAB E0                MOVX     A,@DPTR
B3:00DCAC FB                MOV      R3,A
B3:00DCAD 6017              JZ       ?C0002?ZW_FIRMWARE_UPDATE_NVM
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 912


B3:00DCAF E4                CLR      A
B3:00DCB0 FF                MOV      R7,A
B3:00DCB1 FE                MOV      R6,A
B3:00DCB2 7D02              MOV      R5,#02H
B3:00DCB4 FC                MOV      R4,A
B3:00DCB5 903CC4            MOV      DPTR,#systemNVM_type+02H
B3:00DCB8 E0                MOVX     A,@DPTR
B3:00DCB9 24EF              ADD      A,#0EFH
B3:00DCBB F9                MOV      R1,A
B3:00DCBC F8                MOV      R0,A
B3:00DCBD 1223C1            LCALL    ?C?LSHL
B3:00DCC0 903CBC            MOV      DPTR,#systemNVM_Size
B3:00DCC3 1224BA            LCALL    ?C?LSTXDATA
B3:00DCC6         ?C0002?ZW_FIRMWARE_UPDATE_NVM:
B3:00DCC6 AF03              MOV      R7,AR3
B3:00DCC8 22                RET      
----- FUNCTION ZW_FirmwareUpdate_NVM_Init (END) -------


----- FUNCTION ?L?COM04A6 (BEGIN) -----
B3:00DCC9 903CEE            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00DCCC 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM04A6 (END) -------


----- FUNCTION ?L?COM0227 (BEGIN) -----
B3:00DCCF 9031AC            MOV      DPTR,#scb+06H
B3:00DCD2         ?L?COM0228:
B3:00DCD2 E0                MOVX     A,@DPTR
B3:00DCD3 FC                MOV      R4,A
B3:00DCD4 A3                INC      DPTR
B3:00DCD5 E0                MOVX     A,@DPTR
B3:00DCD6 FD                MOV      R5,A
B3:00DCD7 C3                CLR      C
B3:00DCD8 22                RET      
----- FUNCTION ?L?COM0227 (END) -------


----- FUNCTION ?L?COM03C5 (BEGIN) -----
B3:00DCD9 A3                INC      DPTR
B3:00DCDA 122572            LCALL    ?C?PSTXDATA
B3:00DCDD 0B                INC      R3
B3:00DCDE 7A2D              MOV      R2,#HIGH the_tx_session+0BH
B3:00DCE0 7999              MOV      R1,#LOW the_tx_session+0BH
B3:00DCE2 021B29            LJMP     ?INTERBANK_TABLE?_ctimer_set
----- FUNCTION ?L?COM03C5 (END) -------


----- FUNCTION get_num_missing_frag (BEGIN) -----
;---- Variable 'missing_frag' assigned to Register 'R3' ----
B3:00DCE5 E4                CLR      A
B3:00DCE6 FB                MOV      R3,A
B3:00DCE7 903197            MOV      DPTR,#rcb+011DH
B3:00DCEA E0                MOVX     A,@DPTR
B3:00DCEB FE                MOV      R6,A
B3:00DCEC 7002              JNZ      ?C0117?TRANSPORT_SERVICE2
B3:00DCEE FF                MOV      R7,A
B3:00DCEF 22                RET      
B3:00DCF0         ?C0117?TRANSPORT_SERVICE2:
B3:00DCF0 EE                MOV      A,R6
B3:00DCF1 B111              ACALL    ?L?COM00C7
;---- Variable 'max_frag_no' assigned to Register 'R2' ----
B3:00DCF3 AA07              MOV      R2,AR7
B3:00DCF5 B10D              ACALL    ?L?COM00C6
B3:00DCF7 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 913


B3:00DCF8 4C                ORL      A,R4
B3:00DCF9 6001              JZ       ?C0120?TRANSPORT_SERVICE2
B3:00DCFB 0A                INC      R2
B3:00DCFC         ?C0120?TRANSPORT_SERVICE2:
B3:00DCFC AF02              MOV      R7,AR2
B3:00DCFE 1A                DEC      R2
B3:00DCFF EF                MOV      A,R7
B3:00DD00 6008              JZ       ?C0121?TRANSPORT_SERVICE2
B3:00DD02 1180              ACALL    ?L?COM0274
B3:00DD04 E0                MOVX     A,@DPTR
B3:00DD05 70F5              JNZ      ?C0120?TRANSPORT_SERVICE2
B3:00DD07 0B                INC      R3
B3:00DD08 80F2              SJMP     ?C0120?TRANSPORT_SERVICE2
B3:00DD0A         ?C0121?TRANSPORT_SERVICE2:
B3:00DD0A AF03              MOV      R7,AR3
B3:00DD0C 22                RET      
----- FUNCTION get_num_missing_frag (END) -------


----- FUNCTION ?L?COM00C6 (BEGIN) -----
B3:00DD0D 903197            MOV      DPTR,#rcb+011DH
B3:00DD10 E0                MOVX     A,@DPTR
B3:00DD11         ?L?COM00C7:
B3:00DD11 FD                MOV      R5,A
B3:00DD12 7C00              MOV      R4,#00H
B3:00DD14 9031A4            MOV      DPTR,#rcb+012AH
B3:00DD17         ?L?COM00C8:
B3:00DD17 E0                MOVX     A,@DPTR
B3:00DD18 FE                MOV      R6,A
B3:00DD19 A3                INC      DPTR
B3:00DD1A E0                MOVX     A,@DPTR
B3:00DD1B FF                MOV      R7,A
B3:00DD1C 022081            LJMP     ?C?UIDIV
----- FUNCTION ?L?COM00C6 (END) -------


----- FUNCTION calculate_pending_segments (BEGIN) -----
B3:00DD1F E4                CLR      A
B3:00DD20 903097            MOV      DPTR,#rcb+01DH
B3:00DD23 F0                MOVX     @DPTR,A
B3:00DD24 903197            MOV      DPTR,#rcb+011DH
B3:00DD27 E0                MOVX     A,@DPTR
B3:00DD28 6024              JZ       ?C0132?TRANSPORT_SERVICE2
B3:00DD2A         ?C0131?TRANSPORT_SERVICE2:
B3:00DD2A 903197            MOV      DPTR,#rcb+011DH
B3:00DD2D E0                MOVX     A,@DPTR
B3:00DD2E FB                MOV      R3,A
B3:00DD2F B111              ACALL    ?L?COM00C7
;---- Variable 'max_frag_no' assigned to Register 'R2' ----
B3:00DD31 AA07              MOV      R2,AR7
B3:00DD33 EB                MOV      A,R3
B3:00DD34 B111              ACALL    ?L?COM00C7
B3:00DD36 ED                MOV      A,R5
B3:00DD37 4C                ORL      A,R4
B3:00DD38 6001              JZ       ?C0134?TRANSPORT_SERVICE2
B3:00DD3A 0A                INC      R2
B3:00DD3B         ?C0134?TRANSPORT_SERVICE2:
B3:00DD3B AF02              MOV      R7,AR2
B3:00DD3D 1A                DEC      R2
B3:00DD3E EF                MOV      A,R7
B3:00DD3F 600D              JZ       ?C0132?TRANSPORT_SERVICE2
B3:00DD41 1180              ACALL    ?L?COM0274
B3:00DD43 E0                MOVX     A,@DPTR
B3:00DD44 70F5              JNZ      ?C0134?TRANSPORT_SERVICE2
B3:00DD46 903097            MOV      DPTR,#rcb+01DH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 914


B3:00DD49 E0                MOVX     A,@DPTR
B3:00DD4A 04                INC      A
B3:00DD4B F0                MOVX     @DPTR,A
B3:00DD4C 80ED              SJMP     ?C0134?TRANSPORT_SERVICE2
B3:00DD4E         ?C0132?TRANSPORT_SERVICE2:
B3:00DD4E 22                RET      
----- FUNCTION calculate_pending_segments (END) -------


----- FUNCTION _secure_learnIface_raise_scheme_get (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00DD4F 900026            MOV      DPTR,#026H
B3:00DD52 12243E            LCALL    ?C?LSTOPTR
B3:00DD55 900025            MOV      DPTR,#025H
B3:00DD58 7401              MOV      A,#01H
B3:00DD5A 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_scheme_get (END) -------


----- FUNCTION _secure_learnIface_raise_scheme_inherit (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00DD5D 90002B            MOV      DPTR,#02BH
B3:00DD60 12243E            LCALL    ?C?LSTOPTR
B3:00DD63 90002A            MOV      DPTR,#02AH
B3:00DD66 7401              MOV      A,#01H
B3:00DD68 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_scheme_inherit (END) -------


----- FUNCTION _ZCB_send_subseq_frag (BEGIN) -----
B3:00DD6B E4                CLR      A
B3:00DD6C 9046BD            MOV      DPTR,#ret
B3:00DD6F 12ECD8            LCALL    ?L?COM02C5
B3:00DD72 9031AC            MOV      DPTR,#scb+06H
B3:00DD75 E0                MOVX     A,@DPTR
B3:00DD76 7002              JNZ      ?C0200?TRANSPORT_SERVICE2
B3:00DD78 A3                INC      DPTR
B3:00DD79 E0                MOVX     A,@DPTR
B3:00DD7A         ?C0200?TRANSPORT_SERVICE2:
B3:00DD7A 7003              JNZ      ?C0053?TRANSPORT_SERVICE2
B3:00DD7C 12EE6F            LCALL    ?L?COM0366
B3:00DD7F         ?C0053?TRANSPORT_SERVICE2:
B3:00DD7F 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DD82 E0                MOVX     A,@DPTR
B3:00DD83 FF                MOV      R7,A
B3:00DD84 7E00              MOV      R6,#00H
B3:00DD86 91CF              ACALL    ?L?COM0227
B3:00DD88 9F                SUBB     A,R7
B3:00DD89 EC                MOV      A,R4
B3:00DD8A 9E                SUBB     A,R6
B3:00DD8B 9031A6            MOV      DPTR,#scb
B3:00DD8E 4007              JC       ?C0054?TRANSPORT_SERVICE2
B3:00DD90 EE                MOV      A,R6
B3:00DD91 F0                MOVX     @DPTR,A
B3:00DD92 A3                INC      DPTR
B3:00DD93 EF                MOV      A,R7
B3:00DD94 F0                MOVX     @DPTR,A
B3:00DD95 8005              SJMP     ?C0055?TRANSPORT_SERVICE2
B3:00DD97         ?C0054?TRANSPORT_SERVICE2:
B3:00DD97 EC                MOV      A,R4
B3:00DD98 F0                MOVX     @DPTR,A
B3:00DD99 A3                INC      DPTR
B3:00DD9A ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 915


B3:00DD9B F0                MOVX     @DPTR,A
B3:00DD9C         ?C0055?TRANSPORT_SERVICE2:
B3:00DD9C F1AD              ACALL    ?L?COM01AE
B3:00DD9E E0                MOVX     A,@DPTR
B3:00DD9F 6401              XRL      A,#01H
B3:00DDA1 7002              JNZ      $ + 4H
B3:00DDA3 C159              AJMP     ?C0057?TRANSPORT_SERVICE2
B3:00DDA5         ?C0056?TRANSPORT_SERVICE2:
B3:00DDA5 9031AC            MOV      DPTR,#scb+06H
B3:00DDA8 51D6              ACALL    ?L?COM014A
B3:00DDAA 9031D0            MOV      DPTR,#scb+02AH
B3:00DDAD E0                MOVX     A,@DPTR
B3:00DDAE 9F                SUBB     A,R7
B3:00DDAF FF                MOV      R7,A
B3:00DDB0 9031CF            MOV      DPTR,#scb+029H
B3:00DDB3 E0                MOVX     A,@DPTR
B3:00DDB4 9E                SUBB     A,R6
B3:00DDB5 9031AA            MOV      DPTR,#scb+04H
B3:00DDB8 F0                MOVX     @DPTR,A
B3:00DDB9 A3                INC      DPTR
B3:00DDBA EF                MOV      A,R7
B3:00DDBB F0                MOVX     @DPTR,A
B3:00DDBC 90306A            MOV      DPTR,#subseq_frag
B3:00DDBF F19B              ACALL    ?L?COM0163
B3:00DDC1 12EF1D            LCALL    ?L?COM04E7
B3:00DDC4 126DFA            LCALL    ?L?COM0160
B3:00DDC7 ED                MOV      A,R5
B3:00DDC8 12B7B8            LCALL    ?L?COM036B
B3:00DDCB 9031AA            MOV      DPTR,#scb+04H
B3:00DDCE F1A6              ACALL    ?L?COM0165
B3:00DDD0 12EDC4            LCALL    ?L?COM01A8
B3:00DDD3 E9                MOV      A,R1
B3:00DDD4 2405              ADD      A,#05H
B3:00DDD6 F9                MOV      R1,A
B3:00DDD7 E4                CLR      A
B3:00DDD8 3A                ADDC     A,R2
B3:00DDD9 FA                MOV      R2,A
B3:00DDDA C003              PUSH     AR3
B3:00DDDC C002              PUSH     AR2
B3:00DDDE C001              PUSH     AR1
B3:00DDE0 F1BD              ACALL    ?L?COM049D
B3:00DDE2 9031AA            MOV      DPTR,#scb+04H
B3:00DDE5 126E37            LCALL    ?L?COM01E7
B3:00DDE8 128548            LCALL    ?L?COM0018
B3:00DDEB D001              POP      AR1
B3:00DDED D002              POP      AR2
B3:00DDEF D003              POP      AR3
B3:00DDF1 12EE4F            LCALL    ?L?COM0276
B3:00DDF4 2405              ADD      A,#05H
B3:00DDF6 FD                MOV      R5,A
B3:00DDF7 12EBA7            LCALL    _add_crc
B3:00DDFA 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DDFD E0                MOVX     A,@DPTR
B3:00DDFE FF                MOV      R7,A
B3:00DDFF D3                SETB     C
B3:00DE00 9031AD            MOV      DPTR,#scb+07H
B3:00DE03 E0                MOVX     A,@DPTR
B3:00DE04 9F                SUBB     A,R7
B3:00DE05 9031AC            MOV      DPTR,#scb+06H
B3:00DE08 E0                MOVX     A,@DPTR
B3:00DE09 9400              SUBB     A,#00H
B3:00DE0B 500E              JNC      ?C0058?TRANSPORT_SERVICE2
B3:00DE0D 903220            MOV      DPTR,#scb+07AH
B3:00DE10 7401              MOV      A,#01H
B3:00DE12 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 916


B3:00DE13 7F1C              MOV      R7,#01CH
B3:00DE15 129C55            LCALL    _t2_sm_post_event
B3:00DE18 02B4E4            LJMP     send_last_frag
B3:00DE1B         ?C0058?TRANSPORT_SERVICE2:
B3:00DE1B 12B4C0            LCALL    ?L?COM0027
B3:00DE1E 12B7EC            LCALL    ?L?COM02C4
B3:00DE21 A3                INC      DPTR
B3:00DE22 E0                MOVX     A,@DPTR
B3:00DE23 2407              ADD      A,#07H
B3:00DE25 12B64A            LCALL    ?L?COM00FF
B3:00DE28 9046BD            MOV      DPTR,#ret
B3:00DE2B F0                MOVX     @DPTR,A
B3:00DE2C         ?C0059?TRANSPORT_SERVICE2:
B3:00DE2C 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DE2F E0                MOVX     A,@DPTR
B3:00DE30 F9                MOV      R1,A
B3:00DE31 FF                MOV      R7,A
B3:00DE32 91CF              ACALL    ?L?COM0227
B3:00DE34 9F                SUBB     A,R7
B3:00DE35 EC                MOV      A,R4
B3:00DE36 9400              SUBB     A,#00H
B3:00DE38 4008              JC       ?C0060?TRANSPORT_SERVICE2
B3:00DE3A ED                MOV      A,R5
B3:00DE3B 9F                SUBB     A,R7
B3:00DE3C FE                MOV      R6,A
B3:00DE3D EC                MOV      A,R4
B3:00DE3E 9400              SUBB     A,#00H
B3:00DE40 F1C3              ACALL    ?L?COM0557
B3:00DE42         ?C0060?TRANSPORT_SERVICE2:
B3:00DE42 F18F              ACALL    ?L?COM01F8
B3:00DE44 B117              ACALL    ?L?COM00C8
B3:00DE46 F18A              ACALL    ?L?COM01F7
B3:00DE48 B117              ACALL    ?L?COM00C8
B3:00DE4A ED                MOV      A,R5
B3:00DE4B 4C                ORL      A,R4
B3:00DE4C 6006              JZ       ?C0061?TRANSPORT_SERVICE2
B3:00DE4E 9031CB            MOV      DPTR,#scb+025H
B3:00DE51 E0                MOVX     A,@DPTR
B3:00DE52 04                INC      A
B3:00DE53 F0                MOVX     @DPTR,A
B3:00DE54         ?C0061?TRANSPORT_SERVICE2:
B3:00DE54 7F18              MOV      R7,#018H
B3:00DE56 129C55            LCALL    _t2_sm_post_event
B3:00DE59         ?C0057?TRANSPORT_SERVICE2:
B3:00DE59 22                RET      
----- FUNCTION _ZCB_send_subseq_frag (END) -------


----- FUNCTION send_first_frag (BEGIN) -----
B3:00DE5A E4                CLR      A
B3:00DE5B 9046BE            MOV      DPTR,#ret
B3:00DE5E F0                MOVX     @DPTR,A
B3:00DE5F 9031CA            MOV      DPTR,#scb+024H
B3:00DE62 E0                MOVX     A,@DPTR
B3:00DE63 7010              JNZ      ?C0063?TRANSPORT_SERVICE2
B3:00DE65 12418F            LCALL    ZW_Random
B3:00DE68 EF                MOV      A,R7
B3:00DE69 75F00F            MOV      B,#0FH
B3:00DE6C 84                DIV      AB
B3:00DE6D 9031CA            MOV      DPTR,#scb+024H
B3:00DE70 E5F0              MOV      A,B
B3:00DE72 F0                MOVX     @DPTR,A
B3:00DE73 8006              SJMP     ?C0064?TRANSPORT_SERVICE2
B3:00DE75         ?C0063?TRANSPORT_SERVICE2:
B3:00DE75 9031CA            MOV      DPTR,#scb+024H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 917


B3:00DE78 E0                MOVX     A,@DPTR
B3:00DE79 04                INC      A
B3:00DE7A F0                MOVX     @DPTR,A
B3:00DE7B         ?C0064?TRANSPORT_SERVICE2:
B3:00DE7B 9031CA            MOV      DPTR,#scb+024H
B3:00DE7E E0                MOVX     A,@DPTR
B3:00DE7F D3                SETB     C
B3:00DE80 940F              SUBB     A,#0FH
B3:00DE82 4002              JC       ?C0065?TRANSPORT_SERVICE2
B3:00DE84 E4                CLR      A
B3:00DE85 F0                MOVX     @DPTR,A
B3:00DE86         ?C0065?TRANSPORT_SERVICE2:
B3:00DE86 F1AD              ACALL    ?L?COM01AE
B3:00DE88 E4                CLR      A
B3:00DE89 F0                MOVX     @DPTR,A
B3:00DE8A 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DE8D 742F              MOV      A,#02FH
B3:00DE8F F0                MOVX     @DPTR,A
B3:00DE90 9031B2            MOV      DPTR,#scb+0CH
B3:00DE93 E0                MOVX     A,@DPTR
B3:00DE94 FF                MOV      R7,A
B3:00DE95 30E502            JNB      ACC.5,?C0066?TRANSPORT_SERVICE2
B3:00DE98 8004              SJMP     ?C0210?TRANSPORT_SERVICE2
B3:00DE9A         ?C0066?TRANSPORT_SERVICE2:
B3:00DE9A EF                MOV      A,R7
B3:00DE9B 20E407            JB       ACC.4,?C0067?TRANSPORT_SERVICE2
B3:00DE9E         
B3:00DE9E 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DEA1 E0                MOVX     A,@DPTR
B3:00DEA2 24F8              ADD      A,#0F8H
B3:00DEA4 F0                MOVX     @DPTR,A
B3:00DEA5         ?C0067?TRANSPORT_SERVICE2:
B3:00DEA5 9031AC            MOV      DPTR,#scb+06H
B3:00DEA8 E0                MOVX     A,@DPTR
B3:00DEA9 7002              JNZ      ?C0201?TRANSPORT_SERVICE2
B3:00DEAB A3                INC      DPTR
B3:00DEAC E0                MOVX     A,@DPTR
B3:00DEAD         ?C0201?TRANSPORT_SERVICE2:
B3:00DEAD 7003              JNZ      ?C0069?TRANSPORT_SERVICE2
B3:00DEAF 12EE6F            LCALL    ?L?COM0366
B3:00DEB2         ?C0069?TRANSPORT_SERVICE2:
B3:00DEB2 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DEB5 E0                MOVX     A,@DPTR
B3:00DEB6 F9                MOV      R1,A
B3:00DEB7 FF                MOV      R7,A
B3:00DEB8 9031CF            MOV      DPTR,#scb+029H
B3:00DEBB 123CE6            LCALL    ?L?COM0452
B3:00DEBE 9F                SUBB     A,R7
B3:00DEBF EC                MOV      A,R4
B3:00DEC0 9400              SUBB     A,#00H
B3:00DEC2 4015              JC       ?C0070?TRANSPORT_SERVICE2
B3:00DEC4 E9                MOV      A,R1
B3:00DEC5 FB                MOV      R3,A
B3:00DEC6 7A00              MOV      R2,#00H
B3:00DEC8 ED                MOV      A,R5
B3:00DEC9 9B                SUBB     A,R3
B3:00DECA FE                MOV      R6,A
B3:00DECB EC                MOV      A,R4
B3:00DECC 9A                SUBB     A,R2
B3:00DECD F1C3              ACALL    ?L?COM0557
B3:00DECF 9031A6            MOV      DPTR,#scb
B3:00DED2 EA                MOV      A,R2
B3:00DED3 F0                MOVX     @DPTR,A
B3:00DED4 A3                INC      DPTR
B3:00DED5 EB                MOV      A,R3
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 918


B3:00DED6 F0                MOVX     @DPTR,A
B3:00DED7 8017              SJMP     ?C0071?TRANSPORT_SERVICE2
B3:00DED9         ?C0070?TRANSPORT_SERVICE2:
B3:00DED9 9031AC            MOV      DPTR,#scb+06H
B3:00DEDC EC                MOV      A,R4
B3:00DEDD F0                MOVX     @DPTR,A
B3:00DEDE A3                INC      DPTR
B3:00DEDF ED                MOV      A,R5
B3:00DEE0 F0                MOVX     @DPTR,A
B3:00DEE1 9031CF            MOV      DPTR,#scb+029H
B3:00DEE4 E0                MOVX     A,@DPTR
B3:00DEE5 FF                MOV      R7,A
B3:00DEE6 A3                INC      DPTR
B3:00DEE7 E0                MOVX     A,@DPTR
B3:00DEE8 9031A6            MOV      DPTR,#scb
B3:00DEEB CF                XCH      A,R7
B3:00DEEC F0                MOVX     @DPTR,A
B3:00DEED A3                INC      DPTR
B3:00DEEE EF                MOV      A,R7
B3:00DEEF F0                MOVX     @DPTR,A
B3:00DEF0         ?C0071?TRANSPORT_SERVICE2:
B3:00DEF0 903076            MOV      DPTR,#first_frag
B3:00DEF3 F19B              ACALL    ?L?COM0163
B3:00DEF5 5407              ANL      A,#07H
B3:00DEF7 44C0              ORL      A,#0C0H
B3:00DEF9 FF                MOV      R7,A
B3:00DEFA 903076            MOV      DPTR,#first_frag
B3:00DEFD 126DFA            LCALL    ?L?COM0160
B3:00DF00 ED                MOV      A,R5
B3:00DF01 12B7B8            LCALL    ?L?COM036B
B3:00DF04 9031CA            MOV      DPTR,#scb+024H
B3:00DF07 E0                MOVX     A,@DPTR
B3:00DF08 C4                SWAP     A
B3:00DF09 54F0              ANL      A,#0F0H
B3:00DF0B 900003            MOV      DPTR,#03H
B3:00DF0E 12EDDA            LCALL    ?L?COM01A9
B3:00DF11 125D38            LCALL    ?L?COM00E5
B3:00DF14 C003              PUSH     AR3
B3:00DF16 C002              PUSH     AR2
B3:00DF18 C001              PUSH     AR1
B3:00DF1A F1BD              ACALL    ?L?COM049D
B3:00DF1C 128549            LCALL    ?L?COM0019
B3:00DF1F D001              POP      AR1
B3:00DF21 D002              POP      AR2
B3:00DF23 D003              POP      AR3
B3:00DF25 12EE4F            LCALL    ?L?COM0276
B3:00DF28 2404              ADD      A,#04H
B3:00DF2A FD                MOV      R5,A
B3:00DF2B 12EBA7            LCALL    _add_crc
B3:00DF2E F18F              ACALL    ?L?COM01F8
B3:00DF30 B117              ACALL    ?L?COM00C8
B3:00DF32 F18A              ACALL    ?L?COM01F7
B3:00DF34 B117              ACALL    ?L?COM00C8
B3:00DF36 ED                MOV      A,R5
B3:00DF37 4C                ORL      A,R4
B3:00DF38 6006              JZ       ?C0072?TRANSPORT_SERVICE2
B3:00DF3A 9031CB            MOV      DPTR,#scb+025H
B3:00DF3D E0                MOVX     A,@DPTR
B3:00DF3E 04                INC      A
B3:00DF3F F0                MOVX     @DPTR,A
B3:00DF40         ?C0072?TRANSPORT_SERVICE2:
B3:00DF40 903079            MOV      DPTR,#FragmentMaxPayload
B3:00DF43 E0                MOVX     A,@DPTR
B3:00DF44 FF                MOV      R7,A
B3:00DF45 D3                SETB     C
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 919


B3:00DF46 9031D0            MOV      DPTR,#scb+02AH
B3:00DF49 E0                MOVX     A,@DPTR
B3:00DF4A 9F                SUBB     A,R7
B3:00DF4B 9031CF            MOV      DPTR,#scb+029H
B3:00DF4E E0                MOVX     A,@DPTR
B3:00DF4F 9400              SUBB     A,#00H
B3:00DF51 500D              JNC      ?C0073?TRANSPORT_SERVICE2
B3:00DF53 E4                CLR      A
B3:00DF54 903220            MOV      DPTR,#scb+07AH
B3:00DF57 F0                MOVX     @DPTR,A
B3:00DF58 7F1C              MOV      R7,#01CH
B3:00DF5A 129C55            LCALL    _t2_sm_post_event
B3:00DF5D 02B4E4            LJMP     send_last_frag
B3:00DF60         ?C0073?TRANSPORT_SERVICE2:
B3:00DF60 12B4C0            LCALL    ?L?COM0027
B3:00DF63 12B7EC            LCALL    ?L?COM02C4
B3:00DF66 A3                INC      DPTR
B3:00DF67 E0                MOVX     A,@DPTR
B3:00DF68 2406              ADD      A,#06H
B3:00DF6A 12B64A            LCALL    ?L?COM00FF
B3:00DF6D 9046BE            MOV      DPTR,#ret
B3:00DF70 F0                MOVX     @DPTR,A
B3:00DF71 6016              JZ       ?C0074?TRANSPORT_SERVICE2
B3:00DF73         ?C0075?TRANSPORT_SERVICE2:
B3:00DF73 12D7E9            LCALL    clock_time
B3:00DF76 90321C            MOV      DPTR,#scb+076H
B3:00DF79 EE                MOV      A,R6
B3:00DF7A F0                MOVX     @DPTR,A
B3:00DF7B A3                INC      DPTR
B3:00DF7C EF                MOV      A,R7
B3:00DF7D F0                MOVX     @DPTR,A
B3:00DF7E 9031D1            MOV      DPTR,#scb+02BH
B3:00DF81 7401              MOV      A,#01H
B3:00DF83 F0                MOVX     @DPTR,A
B3:00DF84 7F18              MOV      R7,#018H
B3:00DF86 129C55            LCALL    _t2_sm_post_event
B3:00DF89         ?C0074?TRANSPORT_SERVICE2:
B3:00DF89 22                RET      
----- FUNCTION send_first_frag (END) -------


----- FUNCTION ?L?COM01F7 (BEGIN) -----
B3:00DF8A 9031CB            MOV      DPTR,#scb+025H
B3:00DF8D EF                MOV      A,R7
B3:00DF8E F0                MOVX     @DPTR,A
B3:00DF8F         ?L?COM01F8:
B3:00DF8F 9031A6            MOV      DPTR,#scb
B3:00DF92 E0                MOVX     A,@DPTR
B3:00DF93 FC                MOV      R4,A
B3:00DF94 A3                INC      DPTR
B3:00DF95 E0                MOVX     A,@DPTR
B3:00DF96 FD                MOV      R5,A
B3:00DF97 9031AC            MOV      DPTR,#scb+06H
B3:00DF9A 22                RET      
----- FUNCTION ?L?COM01F7 (END) -------


----- FUNCTION ?L?COM0163 (BEGIN) -----
B3:00DF9B 122552            LCALL    ?C?PLDXDATA
B3:00DF9E 7455              MOV      A,#055H
B3:00DFA0 12203B            LCALL    ?C?CSTPTR
B3:00DFA3         ?L?COM0164:
B3:00DFA3 9031CF            MOV      DPTR,#scb+029H
B3:00DFA6         ?L?COM0165:
B3:00DFA6 E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 920


B3:00DFA7 FC                MOV      R4,A
B3:00DFA8 A3                INC      DPTR
B3:00DFA9 E0                MOVX     A,@DPTR
B3:00DFAA FD                MOV      R5,A
B3:00DFAB EC                MOV      A,R4
B3:00DFAC 22                RET      
----- FUNCTION ?L?COM0163 (END) -------


----- FUNCTION ?L?COM01AE (BEGIN) -----
B3:00DFAD 9031CA            MOV      DPTR,#scb+024H
B3:00DFB0 E0                MOVX     A,@DPTR
B3:00DFB1 2404              ADD      A,#LOW scb+05EH
B3:00DFB3         ?L?COM01AF:
B3:00DFB3 F582              MOV      DPL,A
B3:00DFB5 E4                CLR      A
B3:00DFB6 3432              ADDC     A,#HIGH scb+05EH
B3:00DFB8 F583              MOV      DPH,A
B3:00DFBA 22                RET      
----- FUNCTION ?L?COM01AE (END) -------


----- FUNCTION _ZCB_wait_restart_from_first (BEGIN) -----
B3:00DFBB C15A              AJMP     send_first_frag
----- FUNCTION _ZCB_wait_restart_from_first (END) -------


----- FUNCTION ?L?COM049D (BEGIN) -----
B3:00DFBD 9031CC            MOV      DPTR,#scb+026H
B3:00DFC0 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM049D (END) -------


----- FUNCTION ?L?COM0557 (BEGIN) -----
B3:00DFC3 9031AC            MOV      DPTR,#scb+06H
B3:00DFC6 F0                MOVX     @DPTR,A
B3:00DFC7 A3                INC      DPTR
B3:00DFC8 CE                XCH      A,R6
B3:00DFC9 F0                MOVX     @DPTR,A
B3:00DFCA 22                RET      
----- FUNCTION ?L?COM0557 (END) -------


----- FUNCTION get_next_missing_frag (BEGIN) -----
B3:00DFCB B10D              ACALL    ?L?COM00C6
;---- Variable 'max_offset' assigned to Register 'R3' ----
B3:00DFCD AB07              MOV      R3,AR7
;---- Variable 'i' assigned to Register 'R2' ----
B3:00DFCF B10D              ACALL    ?L?COM00C6
B3:00DFD1 ED                MOV      A,R5
B3:00DFD2 4C                ORL      A,R4
B3:00DFD3 6001              JZ       ?C0187?TRANSPORT_SERVICE2
B3:00DFD5 0B                INC      R3
B3:00DFD6         ?C0187?TRANSPORT_SERVICE2:
B3:00DFD6 9031A3            MOV      DPTR,#rcb+0129H
B3:00DFD9 E0                MOVX     A,@DPTR
B3:00DFDA FA                MOV      R2,A
B3:00DFDB         ?C0188?TRANSPORT_SERVICE2:
B3:00DFDB EA                MOV      A,R2
B3:00DFDC C3                CLR      C
B3:00DFDD 9B                SUBB     A,R3
B3:00DFDE 501A              JNC      ?C0189?TRANSPORT_SERVICE2
B3:00DFE0 1180              ACALL    ?L?COM0274
B3:00DFE2 E0                MOVX     A,@DPTR
B3:00DFE3 7012              JNZ      ?C0190?TRANSPORT_SERVICE2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 921


B3:00DFE5 9031A3            MOV      DPTR,#rcb+0129H
B3:00DFE8 EA                MOV      A,R2
B3:00DFE9 F0                MOVX     @DPTR,A
B3:00DFEA 903197            MOV      DPTR,#rcb+011DH
B3:00DFED E0                MOVX     A,@DPTR
B3:00DFEE FF                MOV      R7,A
B3:00DFEF EA                MOV      A,R2
B3:00DFF0 8FF0              MOV      B,R7
B3:00DFF2 A4                MUL      AB
B3:00DFF3 FF                MOV      R7,A
B3:00DFF4 AEF0              MOV      R6,B
B3:00DFF6 22                RET      
B3:00DFF7         ?C0190?TRANSPORT_SERVICE2:
B3:00DFF7 0A                INC      R2
B3:00DFF8 80E1              SJMP     ?C0188?TRANSPORT_SERVICE2
B3:00DFFA         ?C0189?TRANSPORT_SERVICE2:
B3:00DFFA E4                CLR      A
B3:00DFFB FE                MOV      R6,A
B3:00DFFC FF                MOV      R7,A
B3:00DFFD 22                RET      
----- FUNCTION get_next_missing_frag (END) -------


----- FUNCTION _fe25519_setone (BEGIN) -----
;---- Variable 'r' assigned to Register 'R6/R7' ----
B3:00DFFE 8F82              MOV      DPL,R7
B3:00E000 8E83              MOV      DPH,R6
B3:00E002 7401              MOV      A,#01H
B3:00E004 F0                MOVX     @DPTR,A
;---- Variable 'i' assigned to Register 'R5' ----
B3:00E005 FD                MOV      R5,A
B3:00E006         ?C0027?FE25519:
B3:00E006 EF                MOV      A,R7
B3:00E007 12A8B6            LCALL    ?L?COM0093
B3:00E00A E4                CLR      A
B3:00E00B F0                MOVX     @DPTR,A
B3:00E00C 0D                INC      R5
B3:00E00D ED                MOV      A,R5
B3:00E00E B420F5            CJNE     A,#020H,?C0027?FE25519
B3:00E011 22                RET      
----- FUNCTION _fe25519_setone (END) -------


----- FUNCTION _secure_learnIface_raise_key_set (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E012 900030            MOV      DPTR,#030H
B3:00E015 12243E            LCALL    ?C?LSTOPTR
B3:00E018 90002F            MOV      DPTR,#02FH
B3:00E01B 7401              MOV      A,#01H
B3:00E01D 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_key_set (END) -------


----- FUNCTION _secure_learnIface_raise_scheme_report (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E020 900035            MOV      DPTR,#035H
B3:00E023 12243E            LCALL    ?C?LSTOPTR
B3:00E026 900034            MOV      DPTR,#034H
B3:00E029 7401              MOV      A,#01H
B3:00E02B 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_scheme_report (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 922


----- FUNCTION _secure_learnIface_raise_key_verify (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
B3:00E02E 90003A            MOV      DPTR,#03AH
B3:00E031 12243E            LCALL    ?C?LSTOPTR
B3:00E034 900039            MOV      DPTR,#039H
B3:00E037 7401              MOV      A,#01H
B3:00E039 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_raise_key_verify (END) -------


----- FUNCTION _secure_learnIface_get_txOptions (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E03C 900007            MOV      DPTR,#07H
B3:00E03F 0223F4            LJMP     ?C?LLDOPTR
----- FUNCTION _secure_learnIface_get_txOptions (END) -------


----- FUNCTION _secure_learnIface_get_isController (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E042 114C              ACALL    ?L?COM027F
B3:00E044 FF                MOV      R7,A
B3:00E045 22                RET      
----- FUNCTION _secure_learnIface_get_isController (END) -------


----- FUNCTION ?L?COM027D (BEGIN) -----
B3:00E046 90462D            MOV      DPTR,#handle
B3:00E049         ?L?COM027E:
B3:00E049 122552            LCALL    ?C?PLDXDATA
B3:00E04C         ?L?COM027F:
B3:00E04C 90000B            MOV      DPTR,#0BH
B3:00E04F 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM027D (END) -------


----- FUNCTION _secure_learnIface_set_isController (BEGIN) -----
;---- Variable 'value' assigned to Register 'R5' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E052 90000B            MOV      DPTR,#0BH
B3:00E055 ED                MOV      A,R5
B3:00E056 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _secure_learnIface_set_isController (END) -------


----- FUNCTION ?L?COM0540 (BEGIN) -----
B3:00E059 903F6F            MOV      DPTR,#datagram_offset
B3:00E05C E0                MOVX     A,@DPTR
B3:00E05D FE                MOV      R6,A
B3:00E05E A3                INC      DPTR
B3:00E05F E0                MOVX     A,@DPTR
B3:00E060 22                RET      
----- FUNCTION ?L?COM0540 (END) -------


----- FUNCTION _secure_learnIface_get_node (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E061 0294D0            LJMP     ?L?COM0153
----- FUNCTION _secure_learnIface_get_node (END) -------


----- FUNCTION _secure_learnIface_set_node (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E064 90000C            MOV      DPTR,#0CH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 923


B3:00E067 02243E            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_node (END) -------


----- FUNCTION _secure_learnIface_set_scheme (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E06A 900010            MOV      DPTR,#010H
B3:00E06D 02243E            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_scheme (END) -------


----- FUNCTION _secure_learnIface_set_net_scheme (BEGIN) -----
;---- Variable 'value' assigned to Register 'R4/R5/R6/R7' ----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E070 900014            MOV      DPTR,#014H
B3:00E073 02243E            LJMP     ?C?LSTOPTR
----- FUNCTION _secure_learnIface_set_net_scheme (END) -------


----- FUNCTION _secure_learn_entryaction (BEGIN) -----
B3:00E076 22                RET      
----- FUNCTION _secure_learn_entryaction (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Fail (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E077 740C              MOV      A,#0CH
B3:00E079 12203B            LCALL    ?C?CSTPTR
B3:00E07C 1292B8            LCALL    ?L?COM001C
B3:00E07F 1184              ACALL    ?L?COM02A3
B3:00E081 022207            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_Fail (END) -------


----- FUNCTION ?L?COM02A3 (BEGIN) -----
B3:00E084 7407              MOV      A,#07H
B3:00E086         ?L?COM02A4:
B3:00E086 12203B            LCALL    ?C?CSTPTR
B3:00E089         ?L?COM02A5:
B3:00E089 900001            MOV      DPTR,#01H
B3:00E08C E4                CLR      A
B3:00E08D F5F0              MOV      B,A
B3:00E08F 22                RET      
----- FUNCTION ?L?COM02A3 (END) -------


----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_InsecureNet (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E090 740C              MOV      A,#0CH
B3:00E092 12203B            LCALL    ?C?CSTPTR
B3:00E095 1292B8            LCALL    ?L?COM001C
B3:00E098 1184              ACALL    ?L?COM02A3
B3:00E09A 022207            LJMP     ?C?ISTOPTR
----- FUNCTION _secure_learn_react_main_region_LearnMode_r1_InsecureNet (END) -------


----- FUNCTION _secure_learn_react_main_region_Complete (BEGIN) -----
;---- Variable 'handle' assigned to Register 'R1/R2/R3' ----
B3:00E09D 740C              MOV      A,#0CH
B3:00E09F 12203B            LCALL    ?C?CSTPTR
B3:00E0A2 1292B8            LCALL    ?L?COM001C
B3:00E0A5 7409              MOV      A,#09H
B3:00E0A7 1186              ACALL    ?L?COM02A4
B3:00E0A9 022207            LJMP     ?C?ISTOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 924


----- FUNCTION _secure_learn_react_main_region_Complete (END) -------


----- FUNCTION _ZW_UART_tx_send_dec (BEGIN) -----
B3:00E0AC 9046B2            MOV      DPTR,#bData
B3:00E0AF 310F              ACALL    ?L?COM04A7
B3:00E0B1 9046B2            MOV      DPTR,#bData
B3:00E0B4 B4010B            CJNE     A,#01H,?C0001?ZW_UART_SUPPORT
B3:00E0B7 E0                MOVX     A,@DPTR
B3:00E0B8 3116              ACALL    ?L?COM04E4
B3:00E0BA 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00E0BD 11CF              ACALL    ?L?COM02FC
B3:00E0BF 026937            LJMP     _ZW_UART0_tx_send_byte
B3:00E0C2         ?C0001?ZW_UART_SUPPORT:
B3:00E0C2 E0                MOVX     A,@DPTR
B3:00E0C3 75F00A            MOV      B,#0AH
B3:00E0C6 84                DIV      AB
B3:00E0C7 12A7C4            LCALL    ?L?COM02CA
B3:00E0CA 11CF              ACALL    ?L?COM02FC
B3:00E0CC 02A7C8            LJMP     _ZW_UART1_tx_send_byte
----- FUNCTION _ZW_UART_tx_send_dec (END) -------


----- FUNCTION ?L?COM02FC (BEGIN) -----
B3:00E0CF 9046B2            MOV      DPTR,#bData
B3:00E0D2         ?L?COM02FD:
B3:00E0D2 E0                MOVX     A,@DPTR
B3:00E0D3 75F00A            MOV      B,#0AH
B3:00E0D6 84                DIV      AB
B3:00E0D7 AFF0              MOV      R7,B
----- FUNCTION _nibble2hex (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
B3:00E0D9 EF                MOV      A,R7
B3:00E0DA 540F              ANL      A,#0FH
B3:00E0DC FF                MOV      R7,A
;---- Variable 'nibData' assigned to Register 'R7' ----
B3:00E0DD D3                SETB     C
B3:00E0DE 9409              SUBB     A,#09H
B3:00E0E0 EF                MOV      A,R7
B3:00E0E1 5004              JNC      ?C0001?ZW_CONVERT
B3:00E0E3 2430              ADD      A,#030H
B3:00E0E5 FF                MOV      R7,A
B3:00E0E6 22                RET      
B3:00E0E7         ?C0001?ZW_CONVERT:
B3:00E0E7 2437              ADD      A,#037H
B3:00E0E9 FF                MOV      R7,A
B3:00E0EA 22                RET      
----- FUNCTION _nibble2hex (END) -------


----- FUNCTION _ZW_UART_tx_send_hex (BEGIN) -----
B3:00E0EB 9046B3            MOV      DPTR,#bData
B3:00E0EE 310F              ACALL    ?L?COM04A7
B3:00E0F0 9046B3            MOV      DPTR,#bData
B3:00E0F3 B4010F            CJNE     A,#01H,?C0004?ZW_UART_SUPPORT
B3:00E0F6 311D              ACALL    ?L?COM04E8
B3:00E0F8 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00E0FB 9046B3            MOV      DPTR,#bData
B3:00E0FE E0                MOVX     A,@DPTR
B3:00E0FF FF                MOV      R7,A
B3:00E100 11D9              ACALL    _nibble2hex
B3:00E102 026937            LJMP     _ZW_UART0_tx_send_byte
B3:00E105         ?C0004?ZW_UART_SUPPORT:
B3:00E105 12A7C0            LCALL    ?L?COM02C9
B3:00E108 9046B3            MOV      DPTR,#bData
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 925


B3:00E10B E0                MOVX     A,@DPTR
B3:00E10C 02A7C4            LJMP     ?L?COM02CA
----- FUNCTION _ZW_UART_tx_send_hex (END) -------


----- FUNCTION ?L?COM04A7 (BEGIN) -----
B3:00E10F EF                MOV      A,R7
B3:00E110 F0                MOVX     @DPTR,A
B3:00E111 901229            MOV      DPTR,#bNVRUartPinSwap
B3:00E114 E0                MOVX     A,@DPTR
B3:00E115 22                RET      
----- FUNCTION ?L?COM04A7 (END) -------


----- FUNCTION ?L?COM04E4 (BEGIN) -----
B3:00E116 75F00A            MOV      B,#0AH
B3:00E119 84                DIV      AB
B3:00E11A FF                MOV      R7,A
B3:00E11B 80BC              SJMP     _nibble2hex
----- FUNCTION ?L?COM04E4 (END) -------


----- FUNCTION ?L?COM04E8 (BEGIN) -----
B3:00E11D E0                MOVX     A,@DPTR
B3:00E11E C4                SWAP     A
B3:00E11F 540F              ANL      A,#0FH
B3:00E121 FF                MOV      R7,A
B3:00E122 80B5              SJMP     _nibble2hex
----- FUNCTION ?L?COM04E8 (END) -------


----- FUNCTION _ZW_UART_tx_send_w_num (BEGIN) -----
B3:00E124 90468F            MOV      DPTR,#bData
B3:00E127 EE                MOV      A,R6
B3:00E128 F0                MOVX     @DPTR,A
B3:00E129 A3                INC      DPTR
B3:00E12A 310F              ACALL    ?L?COM04A7
B3:00E12C 90468F            MOV      DPTR,#bData
B3:00E12F B4010C            CJNE     A,#01H,?C0007?ZW_UART_SUPPORT
B3:00E132 E0                MOVX     A,@DPTR
B3:00E133 FF                MOV      R7,A
B3:00E134 314C              ACALL    _ZW_UART0_tx_send_hex
B3:00E136 90468F            MOV      DPTR,#bData
B3:00E139 A3                INC      DPTR
B3:00E13A E0                MOVX     A,@DPTR
B3:00E13B FF                MOV      R7,A
B3:00E13C 800E              SJMP     _ZW_UART0_tx_send_hex
B3:00E13E         ?C0007?ZW_UART_SUPPORT:
B3:00E13E E0                MOVX     A,@DPTR
B3:00E13F FF                MOV      R7,A
B3:00E140 12A7D0            LCALL    _ZW_UART1_tx_send_hex
B3:00E143 90468F            MOV      DPTR,#bData
B3:00E146 A3                INC      DPTR
B3:00E147 E0                MOVX     A,@DPTR
B3:00E148 FF                MOV      R7,A
B3:00E149 02A7D0            LJMP     _ZW_UART1_tx_send_hex
----- FUNCTION _ZW_UART_tx_send_w_num (END) -------


----- FUNCTION _ZW_UART0_tx_send_hex (BEGIN) -----
B3:00E14C 9046B5            MOV      DPTR,#bData
B3:00E14F EF                MOV      A,R7
B3:00E150 F0                MOVX     @DPTR,A
B3:00E151 311D              ACALL    ?L?COM04E8
B3:00E153 126937            LCALL    _ZW_UART0_tx_send_byte
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 926


B3:00E156 9046B5            MOV      DPTR,#bData
B3:00E159 E0                MOVX     A,@DPTR
B3:00E15A FF                MOV      R7,A
B3:00E15B 11D9              ACALL    _nibble2hex
B3:00E15D 026937            LJMP     _ZW_UART0_tx_send_byte
----- FUNCTION _ZW_UART0_tx_send_hex (END) -------


----- FUNCTION _ZW_UART0_tx_send_dec (BEGIN) -----
B3:00E160 9046B4            MOV      DPTR,#bData
B3:00E163 EF                MOV      A,R7
B3:00E164 F0                MOVX     @DPTR,A
B3:00E165 3116              ACALL    ?L?COM04E4
B3:00E167 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00E16A 9046B4            MOV      DPTR,#bData
B3:00E16D 11D2              ACALL    ?L?COM02FD
B3:00E16F 026937            LJMP     _ZW_UART0_tx_send_byte
----- FUNCTION _ZW_UART0_tx_send_dec (END) -------


----- FUNCTION _num2UniAsciiHex (BEGIN) -----
B3:00E172 90443B            MOV      DPTR,#outBuf
B3:00E175 122572            LCALL    ?C?PSTXDATA
B3:00E178 904441            MOV      DPTR,#bData
B3:00E17B E0                MOVX     A,@DPTR
B3:00E17C C4                SWAP     A
B3:00E17D 540F              ANL      A,#0FH
B3:00E17F 318F              ACALL    ?L?COM008A
B3:00E181 E4                CLR      A
B3:00E182 12204D            LCALL    ?C?CSTOPTR
B3:00E185 904441            MOV      DPTR,#bData
B3:00E188 E0                MOVX     A,@DPTR
B3:00E189 318F              ACALL    ?L?COM008A
B3:00E18B E4                CLR      A
B3:00E18C 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _num2UniAsciiHex (END) -------


----- FUNCTION ?L?COM008A (BEGIN) -----
B3:00E18F FF                MOV      R7,A
B3:00E190 11D9              ACALL    _nibble2hex
B3:00E192 90443E            MOV      DPTR,#pPos
B3:00E195 122552            LCALL    ?C?PLDXDATA
B3:00E198 7401              MOV      A,#01H
B3:00E19A 121F95            LCALL    ?C?CLDIPTR
B3:00E19D FE                MOV      R6,A
B3:00E19E 90443B            MOV      DPTR,#outBuf
B3:00E1A1 122552            LCALL    ?C?PLDXDATA
B3:00E1A4 8E82              MOV      DPL,R6
B3:00E1A6 758300            MOV      DPH,#00H
B3:00E1A9 EF                MOV      A,R7
B3:00E1AA 12204D            LCALL    ?C?CSTOPTR
B3:00E1AD 90443E            MOV      DPTR,#pPos
B3:00E1B0 122552            LCALL    ?C?PLDXDATA
B3:00E1B3 7401              MOV      A,#01H
B3:00E1B5 121F95            LCALL    ?C?CLDIPTR
B3:00E1B8 FF                MOV      R7,A
B3:00E1B9 90443B            MOV      DPTR,#outBuf
B3:00E1BC         ?L?COM008B:
B3:00E1BC 122552            LCALL    ?C?PLDXDATA
B3:00E1BF 8F82              MOV      DPL,R7
B3:00E1C1 758300            MOV      DPH,#00H
B3:00E1C4 22                RET      
----- FUNCTION ?L?COM008A (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 927



----- FUNCTION _ZW_UART0_tx_send_w_num (BEGIN) -----
B3:00E1C5 904691            MOV      DPTR,#bData
B3:00E1C8 EE                MOV      A,R6
B3:00E1C9 F0                MOVX     @DPTR,A
B3:00E1CA A3                INC      DPTR
B3:00E1CB EF                MOV      A,R7
B3:00E1CC F0                MOVX     @DPTR,A
B3:00E1CD 904691            MOV      DPTR,#bData
B3:00E1D0 E0                MOVX     A,@DPTR
B3:00E1D1 FF                MOV      R7,A
B3:00E1D2 314C              ACALL    _ZW_UART0_tx_send_hex
B3:00E1D4 904691            MOV      DPTR,#bData
B3:00E1D7 A3                INC      DPTR
B3:00E1D8 E0                MOVX     A,@DPTR
B3:00E1D9 FF                MOV      R7,A
B3:00E1DA 214C              AJMP     _ZW_UART0_tx_send_hex
----- FUNCTION _ZW_UART0_tx_send_w_num (END) -------


----- FUNCTION ZW_UART_tx_send_nl (BEGIN) -----
B3:00E1DC 901229            MOV      DPTR,#bNVRUartPinSwap
B3:00E1DF E0                MOVX     A,@DPTR
B3:00E1E0 7F0D              MOV      R7,#0DH
B3:00E1E2 B40108            CJNE     A,#01H,?C0017?ZW_UART_SUPPORT
B3:00E1E5 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00E1E8 7F0A              MOV      R7,#0AH
B3:00E1EA 026937            LJMP     _ZW_UART0_tx_send_byte
B3:00E1ED         ?C0017?ZW_UART_SUPPORT:
B3:00E1ED 12A7C8            LCALL    _ZW_UART1_tx_send_byte
B3:00E1F0 7F0A              MOV      R7,#0AH
B3:00E1F2 02A7C8            LJMP     _ZW_UART1_tx_send_byte
----- FUNCTION ZW_UART_tx_send_nl (END) -------


----- FUNCTION _byte2UniAsciiHex (BEGIN) -----
B3:00E1F5 904442            MOV      DPTR,#outBuf
B3:00E1F8 122572            LCALL    ?C?PSTXDATA
B3:00E1FB 904448            MOV      DPTR,#bData
B3:00E1FE E0                MOVX     A,@DPTR
B3:00E1FF FF                MOV      R7,A
B3:00E200 5119              ACALL    ?L?COM040C
B3:00E202 FE                MOV      R6,A
B3:00E203 904442            MOV      DPTR,#outBuf
B3:00E206 127031            LCALL    ?L?COM04E5
B3:00E209 EF                MOV      A,R7
B3:00E20A 12204D            LCALL    ?C?CSTOPTR
B3:00E20D 5119              ACALL    ?L?COM040C
B3:00E20F FF                MOV      R7,A
B3:00E210 904442            MOV      DPTR,#outBuf
B3:00E213 31BC              ACALL    ?L?COM008B
B3:00E215 E4                CLR      A
B3:00E216 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION _byte2UniAsciiHex (END) -------


----- FUNCTION ?L?COM040C (BEGIN) -----
B3:00E219 904445            MOV      DPTR,#pPos
B3:00E21C 122552            LCALL    ?C?PLDXDATA
B3:00E21F 7401              MOV      A,#01H
B3:00E221 021F95            LJMP     ?C?CLDIPTR
----- FUNCTION ?L?COM040C (END) -------


----- FUNCTION _ZW_AES_ecb_get (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 928


B3:00E224 904642            MOV      DPTR,#bData
B3:00E227 5189              ACALL    ?L?COM04A4
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E229 E4                CLR      A
B3:00E22A FF                MOV      R7,A
B3:00E22B         ?C0010?ZW_PHY_AES_050X:
B3:00E22B 904642            MOV      DPTR,#bData
B3:00E22E 31BC              ACALL    ?L?COM008B
B3:00E230 E593              MOV      A,AESDATA
B3:00E232 12204D            LCALL    ?C?CSTOPTR
B3:00E235 0F                INC      R7
B3:00E236 EF                MOV      A,R7
B3:00E237 B410F1            CJNE     A,#010H,?C0010?ZW_PHY_AES_050X
B3:00E23A 22                RET      
----- FUNCTION _ZW_AES_ecb_get (END) -------


----- FUNCTION _ZW_UART0_tx_send_str (BEGIN) -----
B3:00E23B 90463C            MOV      DPTR,#str
B3:00E23E 122572            LCALL    ?C?PSTXDATA
B3:00E241         ?C0004?ZW_UART0_SUPPORT:
B3:00E241 90463C            MOV      DPTR,#str
B3:00E244 12A3E6            LCALL    ?L?COM0077
B3:00E247 FF                MOV      R7,A
B3:00E248 600F              JZ       ?C0006?ZW_UART0_SUPPORT
B3:00E24A 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00E24D 90463D            MOV      DPTR,#str+01H
B3:00E250 E4                CLR      A
B3:00E251 75F001            MOV      B,#01H
B3:00E254 12210C            LCALL    ?C?IILDX
B3:00E257 80E8              SJMP     ?C0004?ZW_UART0_SUPPORT
B3:00E259         ?C0006?ZW_UART0_SUPPORT:
B3:00E259 22                RET      
----- FUNCTION _ZW_UART0_tx_send_str (END) -------


----- FUNCTION _ZW_AES_ecb_set (BEGIN) -----
B3:00E25A 9044DF            MOV      DPTR,#bData
B3:00E25D 5189              ACALL    ?L?COM04A4
B3:00E25F         ?C0001?ZW_PHY_AES_050X:
B3:00E25F E58F              MOV      A,AESCON1
B3:00E261 20E0FB            JB       ACC.0,?C0001?ZW_PHY_AES_050X
B3:00E264         ?C0002?ZW_PHY_AES_050X:
B3:00E264 5197              ACALL    ?L?COM036E
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E266 E4                CLR      A
B3:00E267 FF                MOV      R7,A
B3:00E268         ?C0003?ZW_PHY_AES_050X:
B3:00E268 9044DF            MOV      DPTR,#bData
B3:00E26B 31BC              ACALL    ?L?COM008B
B3:00E26D 121FB9            LCALL    ?C?CLDOPTR
B3:00E270 F593              MOV      AESDATA,A
B3:00E272 0F                INC      R7
B3:00E273 EF                MOV      A,R7
B3:00E274 B410F1            CJNE     A,#010H,?C0003?ZW_PHY_AES_050X
B3:00E277         ?C0004?ZW_PHY_AES_050X:
B3:00E277 E4                CLR      A
B3:00E278 FF                MOV      R7,A
B3:00E279         ?C0006?ZW_PHY_AES_050X:
B3:00E279 9044E2            MOV      DPTR,#bKey
B3:00E27C 31BC              ACALL    ?L?COM008B
B3:00E27E 121FB9            LCALL    ?C?CLDOPTR
B3:00E281 F594              MOV      AESKEY,A
B3:00E283 0F                INC      R7
B3:00E284 EF                MOV      A,R7
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 929


B3:00E285 B410F1            CJNE     A,#010H,?C0006?ZW_PHY_AES_050X
B3:00E288 22                RET      
----- FUNCTION _ZW_AES_ecb_set (END) -------


----- FUNCTION ?L?COM04A4 (BEGIN) -----
B3:00E289 122572            LCALL    ?C?PSTXDATA
B3:00E28C 75FF01            MOV      SFRPAGE,#01H
B3:00E28F 22                RET      
----- FUNCTION ?L?COM04A4 (END) -------


----- FUNCTION ?L?COM0566 (BEGIN) -----
B3:00E290 513B              ACALL    _ZW_UART0_tx_send_str
B3:00E292 12A7AE            LCALL    ZW_UART0_tx_send_nl
B3:00E295 E4                CLR      A
B3:00E296 22                RET      
----- FUNCTION ?L?COM0566 (END) -------


----- FUNCTION ?L?COM036E (BEGIN) -----
B3:00E297 75FF01            MOV      SFRPAGE,#01H
B3:00E29A 538F06            ANL      AESCON1,#06H
B3:00E29D 75FF01            MOV      SFRPAGE,#01H
B3:00E2A0 538FF0            ANL      AESCON1,#0F0H
B3:00E2A3 75FF01            MOV      SFRPAGE,#01H
B3:00E2A6 22                RET      
----- FUNCTION ?L?COM036E (END) -------


----- FUNCTION _ZW_UART0_send_buf (BEGIN) -----
;---- Variable 'z' assigned to Register 'R1/R2/R3' ----
B3:00E2A7 5190              ACALL    ?L?COM0566
B3:00E2A9 9043B1            MOV      DPTR,#i
B3:00E2AC F0                MOVX     @DPTR,A
B3:00E2AD         ?C0008?ZW_UART0_SUPPORT:
B3:00E2AD 9043B0            MOV      DPTR,#len
B3:00E2B0 12CD15            LCALL    ?L?COM023A
B3:00E2B3 5025              JNC      ?C0009?ZW_UART0_SUPPORT
B3:00E2B5 9043AD            MOV      DPTR,#b
B3:00E2B8 12A72A            LCALL    ?L?COM00BB
B3:00E2BB FF                MOV      R7,A
B3:00E2BC 314C              ACALL    _ZW_UART0_tx_send_hex
B3:00E2BE 9043B1            MOV      DPTR,#i
B3:00E2C1 E0                MOVX     A,@DPTR
B3:00E2C2 540F              ANL      A,#0FH
B3:00E2C4 FF                MOV      R7,A
B3:00E2C5 BF0F05            CJNE     R7,#0FH,?C0011?ZW_UART0_SUPPORT
B3:00E2C8 12A7AE            LCALL    ZW_UART0_tx_send_nl
B3:00E2CB 8005              SJMP     ?C0010?ZW_UART0_SUPPORT
B3:00E2CD         ?C0011?ZW_UART0_SUPPORT:
B3:00E2CD 7F20              MOV      R7,#020H
B3:00E2CF 126937            LCALL    _ZW_UART0_tx_send_byte
B3:00E2D2         ?C0010?ZW_UART0_SUPPORT:
B3:00E2D2 9043B1            MOV      DPTR,#i
B3:00E2D5 E0                MOVX     A,@DPTR
B3:00E2D6 04                INC      A
B3:00E2D7 F0                MOVX     @DPTR,A
B3:00E2D8 80D3              SJMP     ?C0008?ZW_UART0_SUPPORT
B3:00E2DA         ?C0009?ZW_UART0_SUPPORT:
B3:00E2DA 9043B1            MOV      DPTR,#i
B3:00E2DD E0                MOVX     A,@DPTR
B3:00E2DE 540F              ANL      A,#0FH
B3:00E2E0 6003              JZ       ?C0014?ZW_UART0_SUPPORT
B3:00E2E2 12A7AE            LCALL    ZW_UART0_tx_send_nl
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 930


B3:00E2E5         ?C0014?ZW_UART0_SUPPORT:
B3:00E2E5 22                RET      
----- FUNCTION _ZW_UART0_send_buf (END) -------


----- FUNCTION _ZW_UART1_tx_send_w_num (BEGIN) -----
B3:00E2E6 904693            MOV      DPTR,#bData
B3:00E2E9 EE                MOV      A,R6
B3:00E2EA F0                MOVX     @DPTR,A
B3:00E2EB A3                INC      DPTR
B3:00E2EC EF                MOV      A,R7
B3:00E2ED F0                MOVX     @DPTR,A
B3:00E2EE 904693            MOV      DPTR,#bData
B3:00E2F1 E0                MOVX     A,@DPTR
B3:00E2F2 FF                MOV      R7,A
B3:00E2F3 12A7D0            LCALL    _ZW_UART1_tx_send_hex
B3:00E2F6 904693            MOV      DPTR,#bData
B3:00E2F9 A3                INC      DPTR
B3:00E2FA E0                MOVX     A,@DPTR
B3:00E2FB FF                MOV      R7,A
B3:00E2FC 02A7D0            LJMP     _ZW_UART1_tx_send_hex
----- FUNCTION _ZW_UART1_tx_send_w_num (END) -------


----- FUNCTION _ZW_UART1_tx_send_str (BEGIN) -----
B3:00E2FF 90463F            MOV      DPTR,#str
B3:00E302 122572            LCALL    ?C?PSTXDATA
B3:00E305         ?C0003?ZW_UART1_SUPPORT:
B3:00E305 90463F            MOV      DPTR,#str
B3:00E308 12A3E6            LCALL    ?L?COM0077
B3:00E30B FF                MOV      R7,A
B3:00E30C 600F              JZ       ?C0005?ZW_UART1_SUPPORT
B3:00E30E 12A7C8            LCALL    _ZW_UART1_tx_send_byte
B3:00E311 904640            MOV      DPTR,#str+01H
B3:00E314 E4                CLR      A
B3:00E315 75F001            MOV      B,#01H
B3:00E318 12210C            LCALL    ?C?IILDX
B3:00E31B 80E8              SJMP     ?C0003?ZW_UART1_SUPPORT
B3:00E31D         ?C0005?ZW_UART1_SUPPORT:
B3:00E31D 22                RET      
----- FUNCTION _ZW_UART1_tx_send_str (END) -------


----- FUNCTION ?L?COM0565 (BEGIN) -----
B3:00E31E 51FF              ACALL    _ZW_UART1_tx_send_str
B3:00E320 12A7B8            LCALL    ZW_UART1_tx_send_nl
B3:00E323 E4                CLR      A
B3:00E324 22                RET      
----- FUNCTION ?L?COM0565 (END) -------


----- FUNCTION _ZW_UART1_send_buf (BEGIN) -----
;---- Variable 'z' assigned to Register 'R1/R2/R3' ----
B3:00E325 711E              ACALL    ?L?COM0565
B3:00E327 9043B9            MOV      DPTR,#i
B3:00E32A F0                MOVX     @DPTR,A
B3:00E32B         ?C0007?ZW_UART1_SUPPORT:
B3:00E32B 9043B8            MOV      DPTR,#len
B3:00E32E 12CD15            LCALL    ?L?COM023A
B3:00E331 5026              JNC      ?C0008?ZW_UART1_SUPPORT
B3:00E333 9043B5            MOV      DPTR,#b
B3:00E336 12A72A            LCALL    ?L?COM00BB
B3:00E339 FF                MOV      R7,A
B3:00E33A 12A7D0            LCALL    _ZW_UART1_tx_send_hex
B3:00E33D 9043B9            MOV      DPTR,#i
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 931


B3:00E340 E0                MOVX     A,@DPTR
B3:00E341 540F              ANL      A,#0FH
B3:00E343 FF                MOV      R7,A
B3:00E344 BF0F05            CJNE     R7,#0FH,?C0010?ZW_UART1_SUPPORT
B3:00E347 12A7B8            LCALL    ZW_UART1_tx_send_nl
B3:00E34A 8005              SJMP     ?C0009?ZW_UART1_SUPPORT
B3:00E34C         ?C0010?ZW_UART1_SUPPORT:
B3:00E34C 7F20              MOV      R7,#020H
B3:00E34E 12A7C8            LCALL    _ZW_UART1_tx_send_byte
B3:00E351         ?C0009?ZW_UART1_SUPPORT:
B3:00E351 9043B9            MOV      DPTR,#i
B3:00E354 E0                MOVX     A,@DPTR
B3:00E355 04                INC      A
B3:00E356 F0                MOVX     @DPTR,A
B3:00E357 80D2              SJMP     ?C0007?ZW_UART1_SUPPORT
B3:00E359         ?C0008?ZW_UART1_SUPPORT:
B3:00E359 9043B9            MOV      DPTR,#i
B3:00E35C E0                MOVX     A,@DPTR
B3:00E35D 540F              ANL      A,#0FH
B3:00E35F 6003              JZ       ?C0013?ZW_UART1_SUPPORT
B3:00E361 12A7B8            LCALL    ZW_UART1_tx_send_nl
B3:00E364         ?C0013?ZW_UART1_SUPPORT:
B3:00E364 22                RET      
----- FUNCTION _ZW_UART1_send_buf (END) -------


----- FUNCTION ZW_FirmwareUpdate_NVM_Get_NEWIMAGE (BEGIN) -----
B3:00E365 E4                CLR      A
B3:00E366 9046B7            MOV      DPTR,#retVal
B3:00E369 F0                MOVX     @DPTR,A
B3:00E36A 903CF2            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00E36D E0                MOVX     A,@DPTR
B3:00E36E 601D              JZ       ?C0001?ZW_FIRMWARE_UPDATE_NVM_FLASH
B3:00E370 903CBC            MOV      DPTR,#systemNVM_Size
B3:00E373 122462            LCALL    ?C?LLDXDATA
B3:00E376 E4                CLR      A
B3:00E377 FB                MOV      R3,A
B3:00E378 FA                MOV      R2,A
B3:00E379 7902              MOV      R1,#02H
B3:00E37B F8                MOV      R0,A
B3:00E37C D3                SETB     C
B3:00E37D 12239D            LCALL    ?C?ULCMP
B3:00E380 500B              JNC      ?C0001?ZW_FIRMWARE_UPDATE_NVM_FLASH
B3:00E382 12C503            LCALL    ?L?COM01A0
B3:00E385 12371B            LCALL    _NVM_ext_read_long_byte
B3:00E388 9046B7            MOV      DPTR,#retVal
B3:00E38B EF                MOV      A,R7
B3:00E38C F0                MOVX     @DPTR,A
B3:00E38D         ?C0001?ZW_FIRMWARE_UPDATE_NVM_FLASH:
B3:00E38D 9046B7            MOV      DPTR,#retVal
B3:00E390 E0                MOVX     A,@DPTR
B3:00E391 FF                MOV      R7,A
B3:00E392 22                RET      
----- FUNCTION ZW_FirmwareUpdate_NVM_Get_NEWIMAGE (END) -------


----- FUNCTION _ZW_FirmwareUpdate_NVM_Write (BEGIN) -----
B3:00E393 904280            MOV      DPTR,#sourceBuffer
B3:00E396 122572            LCALL    ?C?PSTXDATA
B3:00E399 904283            MOV      DPTR,#fw_bufSize
B3:00E39C EC                MOV      A,R4
B3:00E39D F0                MOVX     @DPTR,A
B3:00E39E A3                INC      DPTR
B3:00E39F ED                MOV      A,R5
B3:00E3A0 F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 932


B3:00E3A1 E4                CLR      A
B3:00E3A2 904289            MOV      DPTR,#retVal
B3:00E3A5 F0                MOVX     @DPTR,A
B3:00E3A6 903CF2            MOV      DPTR,#firmwareUpdateCapableNVM
B3:00E3A9 E0                MOVX     A,@DPTR
B3:00E3AA 6031              JZ       ?C0001?ZW_FIRMWARE_UPDATE_NVM_WRITE
B3:00E3AC 71E3              ACALL    ?L?COM0291
B3:00E3AE 12703A            LCALL    ?L?COM04ED
B3:00E3B1 904283            MOV      DPTR,#fw_bufSize
B3:00E3B4 9128              ACALL    ?L?COM0096
B3:00E3B6 FD                MOV      R5,A
B3:00E3B7 122234            LCALL    ?C?LADD
B3:00E3BA 903CBC            MOV      DPTR,#systemNVM_Size
B3:00E3BD 12C6DA            LCALL    ?L?COM024B
B3:00E3C0 401B              JC       ?C0001?ZW_FIRMWARE_UPDATE_NVM_WRITE
B3:00E3C2 71E3              ACALL    ?L?COM0291
B3:00E3C4 C007              PUSH     AR7
B3:00E3C6 904280            MOV      DPTR,#sourceBuffer
B3:00E3C9 122552            LCALL    ?C?PLDXDATA
B3:00E3CC 904283            MOV      DPTR,#fw_bufSize
B3:00E3CF 126E91            LCALL    ?L?COM02DE
B3:00E3D2 D007              POP      AR7
B3:00E3D4 123A14            LCALL    _NVM_ext_write_long_buffer
B3:00E3D7 E4                CLR      A
B3:00E3D8 33                RLC      A
B3:00E3D9 904289            MOV      DPTR,#retVal
B3:00E3DC F0                MOVX     @DPTR,A
B3:00E3DD         ?C0001?ZW_FIRMWARE_UPDATE_NVM_WRITE:
B3:00E3DD 904289            MOV      DPTR,#retVal
B3:00E3E0 E0                MOVX     A,@DPTR
B3:00E3E1 FF                MOV      R7,A
B3:00E3E2 22                RET      
----- FUNCTION _ZW_FirmwareUpdate_NVM_Write (END) -------


----- FUNCTION ?L?COM0291 (BEGIN) -----
B3:00E3E3 904285            MOV      DPTR,#firmwareOffset
B3:00E3E6 122462            LCALL    ?C?LLDXDATA
B3:00E3E9 903CEE            MOV      DPTR,#firmwareUpdate_NVM_Offset
B3:00E3EC 12247E            LCALL    ?C?LLDXDATA0
B3:00E3EF 022234            LJMP     ?C?LADD
----- FUNCTION ?L?COM0291 (END) -------


----- FUNCTION ?L?COM0095 (BEGIN) -----
B3:00E3F2 7A37              MOV      R2,#HIGH nonce
B3:00E3F4 7905              MOV      R1,#LOW nonce
B3:00E3F6 903BBB            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+03H
B3:00E3F9 122572            LCALL    ?C?PSTXDATA
B3:00E3FC 903715            MOV      DPTR,#aad
B3:00E3FF 122552            LCALL    ?C?PLDXDATA
B3:00E402 903BBE            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+06H
B3:00E405 122572            LCALL    ?C?PSTXDATA
B3:00E408 903718            MOV      DPTR,#aad_len
B3:00E40B E0                MOVX     A,@DPTR
B3:00E40C FE                MOV      R6,A
B3:00E40D A3                INC      DPTR
B3:00E40E E0                MOVX     A,@DPTR
B3:00E40F FF                MOV      R7,A
B3:00E410 E4                CLR      A
B3:00E411 FC                MOV      R4,A
B3:00E412 FD                MOV      R5,A
B3:00E413 903BC1            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+09H
B3:00E416 1224BA            LCALL    ?C?LSTXDATA
B3:00E419 90371B            MOV      DPTR,#ciphertext
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 933


B3:00E41C 122552            LCALL    ?C?PLDXDATA
B3:00E41F 903BC5            MOV      DPTR,#?_CCM_decrypt_and_auth?BYTE+0DH
B3:00E422 122572            LCALL    ?C?PSTXDATA
B3:00E425 90371E            MOV      DPTR,#ciphertext_len
B3:00E428         ?L?COM0096:
B3:00E428 E0                MOVX     A,@DPTR
B3:00E429 FE                MOV      R6,A
B3:00E42A A3                INC      DPTR
B3:00E42B E0                MOVX     A,@DPTR
B3:00E42C FF                MOV      R7,A
B3:00E42D E4                CLR      A
B3:00E42E FC                MOV      R4,A
B3:00E42F 22                RET      
----- FUNCTION ?L?COM0095 (END) -------


----- FUNCTION _ZW_UART1_init (BEGIN) -----
B3:00E430 90458E            MOV      DPTR,#bBaudRate
B3:00E433 126560            LCALL    ?L?COM00E8
B3:00E436 EB                MOV      A,R3
B3:00E437 F0                MOVX     @DPTR,A
B3:00E438 91A6              ACALL    ?L?COM0126
B3:00E43A 12654E            LCALL    ?L?COM04EC
B3:00E43D C006              PUSH     AR6
B3:00E43F C007              PUSH     AR7
B3:00E441 90458E            MOV      DPTR,#bBaudRate
B3:00E444 1264AD            LCALL    ?L?COM041A
B3:00E447 12652E            LCALL    ?L?COM01DD
B3:00E44A D007              POP      AR7
B3:00E44C D006              POP      AR6
B3:00E44E D3                SETB     C
B3:00E44F 122387            LCALL    ?C?SLCMP
B3:00E452 7E00              MOV      R6,#00H
B3:00E454 5004              JNC      ?C0001?ZW_PHY_UART1_050X
B3:00E456 7F01              MOV      R7,#01H
B3:00E458 8002              SJMP     ?C0027?ZW_PHY_UART1_050X
B3:00E45A         ?C0001?ZW_PHY_UART1_050X:
B3:00E45A 7F00              MOV      R7,#00H
B3:00E45C         
B3:00E45C C006              PUSH     AR6
B3:00E45E C007              PUSH     AR7
B3:00E460         ?C0002?ZW_PHY_UART1_050X:
B3:00E460 91A6              ACALL    ?L?COM0126
B3:00E462 D0E0              POP      ACC
B3:00E464 2F                ADD      A,R7
B3:00E465 FF                MOV      R7,A
B3:00E466 D0E0              POP      ACC
B3:00E468 3E                ADDC     A,R6
B3:00E469 90458E            MOV      DPTR,#bBaudRate
B3:00E46C F0                MOVX     @DPTR,A
B3:00E46D A3                INC      DPTR
B3:00E46E EF                MOV      A,R7
B3:00E46F F0                MOVX     @DPTR,A
B3:00E470 53ECCF            ANL      UARTCON,#0CFH
B3:00E473 90458E            MOV      DPTR,#bBaudRate
B3:00E476 12DFA6            LCALL    ?L?COM0165
B3:00E479 5403              ANL      A,#03H
B3:00E47B 126BBD            LCALL    ?L?COM0445
B3:00E47E 42EC              ORL      UARTCON,A
B3:00E480 75FF02            MOV      SFRPAGE,#02H
B3:00E483 ED                MOV      A,R5
B3:00E484 F5AE              MOV      UART1BRL,A
B3:00E486 75ED20            MOV      UARTSTAT,#020H
B3:00E489 75ED40            MOV      UARTSTAT,#040H
B3:00E48C A3                INC      DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 934


B3:00E48D E0                MOVX     A,@DPTR
B3:00E48E 6005              JZ       ?C0003?ZW_PHY_UART1_050X
B3:00E490 43EC80            ORL      UARTCON,#080H
B3:00E493 8003              SJMP     ?C0004?ZW_PHY_UART1_050X
B3:00E495         ?C0003?ZW_PHY_UART1_050X:
B3:00E495 53EC7F            ANL      UARTCON,#07FH
B3:00E498         ?C0004?ZW_PHY_UART1_050X:
B3:00E498 904591            MOV      DPTR,#bEnableRx
B3:00E49B E0                MOVX     A,@DPTR
B3:00E49C 6004              JZ       ?C0005?ZW_PHY_UART1_050X
B3:00E49E 43EC40            ORL      UARTCON,#040H
B3:00E4A1 22                RET      
B3:00E4A2         ?C0005?ZW_PHY_UART1_050X:
B3:00E4A2 53ECBF            ANL      UARTCON,#0BFH
B3:00E4A5 22                RET      
----- FUNCTION _ZW_UART1_init (END) -------


----- FUNCTION ?L?COM0126 (BEGIN) -----
B3:00E4A6 90458E            MOV      DPTR,#bBaudRate
B3:00E4A9 E0                MOVX     A,@DPTR
B3:00E4AA FE                MOV      R6,A
B3:00E4AB A3                INC      DPTR
B3:00E4AC E0                MOVX     A,@DPTR
B3:00E4AD FB                MOV      R3,A
B3:00E4AE AA06              MOV      R2,AR6
B3:00E4B0 E4                CLR      A
B3:00E4B1 F9                MOV      R1,A
B3:00E4B2 F8                MOV      R0,A
B3:00E4B3 7F80              MOV      R7,#080H
B3:00E4B5 7E38              MOV      R6,#038H
B3:00E4B7 7D01              MOV      R5,#01H
B3:00E4B9 FC                MOV      R4,A
B3:00E4BA 022DCC            LJMP     ?C?SLDIV
----- FUNCTION ?L?COM0126 (END) -------


----- FUNCTION ZW_UART1_rx_int_clear (BEGIN) -----
B3:00E4BD 75ED40            MOV      UARTSTAT,#040H
B3:00E4C0 22                RET      
----- FUNCTION ZW_UART1_rx_int_clear (END) -------


----- FUNCTION ZW_UART1_tx_int_clear (BEGIN) -----
B3:00E4C1 75ED20            MOV      UARTSTAT,#020H
B3:00E4C4 22                RET      
----- FUNCTION ZW_UART1_tx_int_clear (END) -------


----- FUNCTION ZW_UART1_rx_data_wait_get (BEGIN) -----
B3:00E4C5         ?C0010?ZW_PHY_UART1_050X:
B3:00E4C5 E5ED              MOV      A,UARTSTAT
B3:00E4C7 30E6FB            JNB      ACC.6,?C0010?ZW_PHY_UART1_050X
B3:00E4CA         ?C0011?ZW_PHY_UART1_050X:
B3:00E4CA 75ED40            MOV      UARTSTAT,#040H
;---- Variable 'tmp' assigned to Register 'R7' ----
B3:00E4CD AFEE              MOV      R7,UART1BUF
B3:00E4CF 22                RET      
----- FUNCTION ZW_UART1_rx_data_wait_get (END) -------


----- FUNCTION ZW_UART1_rx_data_get (BEGIN) -----
;---- Variable 'tmp' assigned to Register 'R7' ----
B3:00E4D0 AFEE              MOV      R7,UART1BUF
B3:00E4D2 22                RET      
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 935


----- FUNCTION ZW_UART1_rx_data_get (END) -------


----- FUNCTION _ZW_UART1_tx_data_set (BEGIN) -----
;---- Variable 'bData' assigned to Register 'R7' ----
B3:00E4D3 8FEE              MOV      UART1BUF,R7
B3:00E4D5 22                RET      
----- FUNCTION _ZW_UART1_tx_data_set (END) -------


----- FUNCTION _ZW_UART1_rx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E4D6 EF                MOV      A,R7
B3:00E4D7 6004              JZ       ?C0018?ZW_PHY_UART1_050X
B3:00E4D9 43EC40            ORL      UARTCON,#040H
B3:00E4DC 22                RET      
B3:00E4DD         ?C0018?ZW_PHY_UART1_050X:
B3:00E4DD 53ECBF            ANL      UARTCON,#0BFH
B3:00E4E0 22                RET      
----- FUNCTION _ZW_UART1_rx_enable (END) -------


----- FUNCTION _ZW_UART1_tx_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E4E1 EF                MOV      A,R7
B3:00E4E2 6004              JZ       ?C0021?ZW_PHY_UART1_050X
B3:00E4E4 43EC80            ORL      UARTCON,#080H
B3:00E4E7 22                RET      
B3:00E4E8         ?C0021?ZW_PHY_UART1_050X:
B3:00E4E8 53EC7F            ANL      UARTCON,#07FH
B3:00E4EB 22                RET      
----- FUNCTION _ZW_UART1_tx_enable (END) -------


----- FUNCTION ZW_UART1_tx_int_get (BEGIN) -----
B3:00E4EC E5ED              MOV      A,UARTSTAT
B3:00E4EE 5420              ANL      A,#020H
B3:00E4F0 FF                MOV      R7,A
B3:00E4F1 22                RET      
----- FUNCTION ZW_UART1_tx_int_get (END) -------


----- FUNCTION ZW_UART1_rx_int_get (BEGIN) -----
B3:00E4F2 E5ED              MOV      A,UARTSTAT
B3:00E4F4 5440              ANL      A,#040H
B3:00E4F6 FF                MOV      R7,A
B3:00E4F7 22                RET      
----- FUNCTION ZW_UART1_rx_int_get (END) -------


----- FUNCTION ZW_UART1_tx_active_get (BEGIN) -----
B3:00E4F8 E5ED              MOV      A,UARTSTAT
B3:00E4FA 5410              ANL      A,#010H
B3:00E4FC FF                MOV      R7,A
B3:00E4FD 22                RET      
----- FUNCTION ZW_UART1_tx_active_get (END) -------


----- FUNCTION _ZW_FLASH_nvr1_get (BEGIN) -----
;---- Variable 'bNvrAddress' assigned to Register 'R7' ----
B3:00E4FE 75FF03            MOV      SFRPAGE,#03H
B3:00E501 759701            MOV      NVRCON,#01H
B3:00E504 B111              ACALL    ?L?COM0502
B3:00E506         ?C0004?ZW_PHY_FLASH_050X:
B3:00E506 E597              MOV      A,NVRCON
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 936


B3:00E508 20E1FB            JB       ACC.1,?C0004?ZW_PHY_FLASH_050X
B3:00E50B         ?C0005?ZW_PHY_FLASH_050X:
B3:00E50B 75FF03            MOV      SFRPAGE,#03H
B3:00E50E AF99              MOV      R7,NVRDATA
B3:00E510 22                RET      
----- FUNCTION _ZW_FLASH_nvr1_get (END) -------


----- FUNCTION ?L?COM0502 (BEGIN) -----
B3:00E511 75FF03            MOV      SFRPAGE,#03H
B3:00E514 8F98              MOV      NVRADDR,R7
B3:00E516 75FF03            MOV      SFRPAGE,#03H
B3:00E519 22                RET      
----- FUNCTION ?L?COM0502 (END) -------


----- FUNCTION _ZW_FLASH_code_prog_unlock (BEGIN) -----
;---- Variable 'pbUnlockString' assigned to Register 'R1/R2/R3' ----
B3:00E51A B14B              ACALL    ?L?COM04A5
B3:00E51C 75FF03            MOV      SFRPAGE,#03H
B3:00E51F 121F7C            LCALL    ?C?CLDPTR
B3:00E522 F5D3              MOV      FLCON3,A
B3:00E524 75FF03            MOV      SFRPAGE,#03H
B3:00E527 129CA5            LCALL    ?L?COM0065
B3:00E52A F5D3              MOV      FLCON3,A
B3:00E52C 75FF03            MOV      SFRPAGE,#03H
B3:00E52F 12B993            LCALL    ?L?COM00B6
B3:00E532 F5D3              MOV      FLCON3,A
B3:00E534 75FF03            MOV      SFRPAGE,#03H
B3:00E537 12A627            LCALL    ?L?COM005E
B3:00E53A F5D3              MOV      FLCON3,A
B3:00E53C 75FF03            MOV      SFRPAGE,#03H
B3:00E53F 75D401            MOV      FLCON4,#01H
B3:00E542 75FF03            MOV      SFRPAGE,#03H
B3:00E545 E5D5              MOV      A,FLSTAT
B3:00E547 5402              ANL      A,#02H
B3:00E549 FF                MOV      R7,A
B3:00E54A 22                RET      
----- FUNCTION _ZW_FLASH_code_prog_unlock (END) -------


----- FUNCTION ?L?COM04A5 (BEGIN) -----
B3:00E54B 75FF03            MOV      SFRPAGE,#03H
B3:00E54E 75D402            MOV      FLCON4,#02H
B3:00E551 22                RET      
----- FUNCTION ?L?COM04A5 (END) -------


----- FUNCTION ZW_FLASH_code_prog_lock (BEGIN) -----
B3:00E552 B14B              ACALL    ?L?COM04A5
B3:00E554 75FF03            MOV      SFRPAGE,#03H
B3:00E557 E5D5              MOV      A,FLSTAT
B3:00E559 F4                CPL      A
B3:00E55A 5402              ANL      A,#02H
B3:00E55C FF                MOV      R7,A
B3:00E55D 22                RET      
----- FUNCTION ZW_FLASH_code_prog_lock (END) -------


----- FUNCTION _ZW_FLASH_code_sector_erase (BEGIN) -----
;---- Variable 'bSector' assigned to Register 'R7' ----
B3:00E55E 75FF03            MOV      SFRPAGE,#03H
B3:00E561 EF                MOV      A,R7
B3:00E562 543F              ANL      A,#03FH
B3:00E564 4480              ORL      A,#080H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 937


B3:00E566 F5D1              MOV      FLCON1,A
B3:00E568         ?C0009?ZW_PHY_FLASH_050X:
B3:00E568 E5D5              MOV      A,FLSTAT
B3:00E56A 20E20A            JB       ACC.2,?C0010?ZW_PHY_FLASH_050X
B3:00E56D E5D5              MOV      A,FLSTAT
B3:00E56F 20E005            JB       ACC.0,?C0010?ZW_PHY_FLASH_050X
B3:00E572 E5D5              MOV      A,FLSTAT
B3:00E574 30E1F1            JNB      ACC.1,?C0009?ZW_PHY_FLASH_050X
B3:00E577         ?C0010?ZW_PHY_FLASH_050X:
B3:00E577 E5D5              MOV      A,FLSTAT
B3:00E579 5403              ANL      A,#03H
B3:00E57B FF                MOV      R7,A
;---- Variable 's' assigned to Register 'R7' ----
B3:00E57C 75FF03            MOV      SFRPAGE,#03H
B3:00E57F 75D505            MOV      FLSTAT,#05H
B3:00E582 80C7              SJMP     ?L?COM04A5
----- FUNCTION _ZW_FLASH_code_sector_erase (END) -------


----- FUNCTION _ZW_FLASH_code_page_prog (BEGIN) -----
;---- Variable 'pbRamAddress' assigned to Register 'R1/R2/R3' ----
;---- Variable 'bSector' assigned to Register 'R5' ----
B3:00E584 75FF03            MOV      SFRPAGE,#03H
;---- Variable 's' assigned to Register 'R4' ----
B3:00E587 ACD5              MOV      R4,FLSTAT
B3:00E589 EC                MOV      A,R4
B3:00E58A 20E13C            JB       ACC.1,?C0012?ZW_PHY_FLASH_050X
B3:00E58D 75FF03            MOV      SFRPAGE,#03H
B3:00E590 ED                MOV      A,R5
B3:00E591 543F              ANL      A,#03FH
B3:00E593 F5D1              MOV      FLCON1,A
B3:00E595 75FF03            MOV      SFRPAGE,#03H
B3:00E598 E9                MOV      A,R1
B3:00E599 F5D3              MOV      FLCON3,A
B3:00E59B 75FF03            MOV      SFRPAGE,#03H
B3:00E59E EA                MOV      A,R2
B3:00E59F 540F              ANL      A,#0FH
B3:00E5A1 FF                MOV      R7,A
B3:00E5A2 904531            MOV      DPTR,#bPage
B3:00E5A5 E0                MOVX     A,@DPTR
B3:00E5A6 C4                SWAP     A
B3:00E5A7 5470              ANL      A,#070H
B3:00E5A9 4480              ORL      A,#080H
B3:00E5AB 4F                ORL      A,R7
B3:00E5AC F5D2              MOV      FLCON2,A
B3:00E5AE         ?C0013?ZW_PHY_FLASH_050X:
B3:00E5AE E5D5              MOV      A,FLSTAT
B3:00E5B0 20E205            JB       ACC.2,?C0014?ZW_PHY_FLASH_050X
B3:00E5B3 E5D5              MOV      A,FLSTAT
B3:00E5B5 30E0F6            JNB      ACC.0,?C0013?ZW_PHY_FLASH_050X
B3:00E5B8         ?C0014?ZW_PHY_FLASH_050X:
B3:00E5B8 E5D5              MOV      A,FLSTAT
B3:00E5BA 5401              ANL      A,#01H
B3:00E5BC FC                MOV      R4,A
B3:00E5BD 75FF03            MOV      SFRPAGE,#03H
B3:00E5C0 43D402            ORL      FLCON4,#02H
B3:00E5C3 75FF03            MOV      SFRPAGE,#03H
B3:00E5C6 75D505            MOV      FLSTAT,#05H
B3:00E5C9         ?C0012?ZW_PHY_FLASH_050X:
B3:00E5C9 AF04              MOV      R7,AR4
B3:00E5CB 22                RET      
----- FUNCTION _ZW_FLASH_code_page_prog (END) -------


----- FUNCTION ZW_FLASH_auto_prog_set (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 938


B3:00E5CC C2AF              CLR      EA
B3:00E5CE 75FF03            MOV      SFRPAGE,#03H
B3:00E5D1 75D404            MOV      FLCON4,#04H
B3:00E5D4 12403E            LCALL    ZW_WatchDogEnable
B3:00E5D7 12575D            LCALL    stop_phy_timer
B3:00E5DA 7FE8              MOV      R7,#0E8H
B3:00E5DC 7E03              MOV      R6,#03H
B3:00E5DE 1260A7            LCALL    _set_phy_timer_timeout
B3:00E5E1 D132              ACALL    ?L?COM0564
B3:00E5E3         ?C0016?ZW_PHY_FLASH_050X:
B3:00E5E3 123F41            LCALL    start_phy_timer
B3:00E5E6 126232            LCALL    wait_phy_timer_timeout
B3:00E5E9 D12A              ACALL    ?L?COM0563
B3:00E5EB 12210C            LCALL    ?C?IILDX
B3:00E5EE C3                CLR      C
B3:00E5EF 90469A            MOV      DPTR,#delay_loop+01H
B3:00E5F2 E0                MOVX     A,@DPTR
B3:00E5F3 94D7              SUBB     A,#0D7H
B3:00E5F5 904699            MOV      DPTR,#delay_loop
B3:00E5F8 E0                MOVX     A,@DPTR
B3:00E5F9 9403              SUBB     A,#03H
B3:00E5FB 40E6              JC       ?C0016?ZW_PHY_FLASH_050X
B3:00E5FD         ?C0017?ZW_PHY_FLASH_050X:
B3:00E5FD 75FF01            MOV      SFRPAGE,#01H
B3:00E600 75D301            MOV      RES1,#01H
B3:00E603 75FF02            MOV      SFRPAGE,#02H
B3:00E606 75D280            MOV      USBCON,#080H
B3:00E609 75FF02            MOV      SFRPAGE,#02H
B3:00E60C 43E704            ORL      USBCON2,#04H
B3:00E60F D132              ACALL    ?L?COM0564
B3:00E611         ?C0019?ZW_PHY_FLASH_050X:
B3:00E611 D12A              ACALL    ?L?COM0563
B3:00E613 12210C            LCALL    ?C?IILDX
B3:00E616 904699            MOV      DPTR,#delay_loop
B3:00E619 E0                MOVX     A,@DPTR
B3:00E61A B403F4            CJNE     A,#03H,?C0019?ZW_PHY_FLASH_050X
B3:00E61D A3                INC      DPTR
B3:00E61E E0                MOVX     A,@DPTR
B3:00E61F B4E8EF            CJNE     A,#0E8H,?C0019?ZW_PHY_FLASH_050X
B3:00E622         ?C0020?ZW_PHY_FLASH_050X:
B3:00E622 75FF02            MOV      SFRPAGE,#02H
B3:00E625 53E7FB            ANL      USBCON2,#0FBH
B3:00E628         ?C0022?ZW_PHY_FLASH_050X:
B3:00E628 80FE              SJMP     ?C0022?ZW_PHY_FLASH_050X
----- FUNCTION ZW_FLASH_auto_prog_set (END) -------


----- FUNCTION ?L?COM0563 (BEGIN) -----
B3:00E62A 904699            MOV      DPTR,#delay_loop
B3:00E62D E4                CLR      A
B3:00E62E 75F001            MOV      B,#01H
B3:00E631 22                RET      
----- FUNCTION ?L?COM0563 (END) -------


----- FUNCTION ?L?COM0564 (BEGIN) -----
B3:00E632 E4                CLR      A
B3:00E633 904699            MOV      DPTR,#delay_loop
B3:00E636 F0                MOVX     @DPTR,A
B3:00E637 A3                INC      DPTR
B3:00E638 F0                MOVX     @DPTR,A
B3:00E639 22                RET      
----- FUNCTION ?L?COM0564 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 939


----- FUNCTION ZW_FLASH_prog_state (BEGIN) -----
B3:00E63A 75FF03            MOV      SFRPAGE,#03H
B3:00E63D AFD5              MOV      R7,FLSTAT
B3:00E63F 22                RET      
----- FUNCTION ZW_FLASH_prog_state (END) -------


----- FUNCTION _ZW_AES_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E640 EF                MOV      A,R7
B3:00E641 B40107            CJNE     A,#01H,?C0014?ZW_PHY_AES_050X
B3:00E644 D157              ACALL    ?L?COM0562
B3:00E646 4401              ORL      A,#01H
B3:00E648 F58F              MOV      AESCON1,A
B3:00E64A 22                RET      
B3:00E64B         ?C0014?ZW_PHY_AES_050X:
B3:00E64B 75FF01            MOV      SFRPAGE,#01H
B3:00E64E E58F              MOV      A,AESCON1
B3:00E650 54F0              ANL      A,#0F0H
B3:00E652 4406              ORL      A,#06H
B3:00E654 F58F              MOV      AESCON1,A
B3:00E656 22                RET      
----- FUNCTION _ZW_AES_enable (END) -------


----- FUNCTION ?L?COM0562 (BEGIN) -----
B3:00E657 75FF01            MOV      SFRPAGE,#01H
B3:00E65A E58F              MOV      A,AESCON1
B3:00E65C 54F6              ANL      A,#0F6H
B3:00E65E 22                RET      
----- FUNCTION ?L?COM0562 (END) -------


----- FUNCTION ZW_AES_int_clear (BEGIN) -----
B3:00E65F D157              ACALL    ?L?COM0562
B3:00E661 4408              ORL      A,#08H
B3:00E663 F58F              MOV      AESCON1,A
B3:00E665 22                RET      
----- FUNCTION ZW_AES_int_clear (END) -------


----- FUNCTION ZW_AES_int_get (BEGIN) -----
B3:00E666 75FF01            MOV      SFRPAGE,#01H
B3:00E669 E58F              MOV      A,AESCON1
B3:00E66B 5408              ANL      A,#08H
B3:00E66D FF                MOV      R7,A
B3:00E66E 22                RET      
----- FUNCTION ZW_AES_int_get (END) -------


----- FUNCTION _ZW_AES_int_enable (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E66F EF                MOV      A,R7
B3:00E670 B40107            CJNE     A,#01H,?C0019?ZW_PHY_AES_050X
B3:00E673 75FF01            MOV      SFRPAGE,#01H
B3:00E676 43AE20            ORL      INTCON,#020H
B3:00E679 22                RET      
B3:00E67A         ?C0019?ZW_PHY_AES_050X:
B3:00E67A 75FF01            MOV      SFRPAGE,#01H
B3:00E67D 53AEDF            ANL      INTCON,#0DFH
B3:00E680 22                RET      
----- FUNCTION _ZW_AES_int_enable (END) -------


----- FUNCTION ZW_AES_active_get (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 940


B3:00E681 75FF01            MOV      SFRPAGE,#01H
B3:00E684 E58F              MOV      A,AESCON1
B3:00E686 5401              ANL      A,#01H
B3:00E688 FF                MOV      R7,A
B3:00E689 22                RET      
----- FUNCTION ZW_AES_active_get (END) -------


----- FUNCTION _ZW_AES_swap_data (BEGIN) -----
;---- Variable 'bState' assigned to Register 'R7' ----
B3:00E68A EF                MOV      A,R7
B3:00E68B B40107            CJNE     A,#01H,?C0023?ZW_PHY_AES_050X
B3:00E68E 75FF01            MOV      SFRPAGE,#01H
B3:00E691 439120            ORL      AESCON2,#020H
B3:00E694 22                RET      
B3:00E695         ?C0023?ZW_PHY_AES_050X:
B3:00E695 75FF01            MOV      SFRPAGE,#01H
B3:00E698 5391DF            ANL      AESCON2,#0DFH
B3:00E69B 22                RET      
----- FUNCTION _ZW_AES_swap_data (END) -------


----- FUNCTION ___S2_span_ok (BEGIN) -----
B3:00E69C 904645            MOV      DPTR,#con
B3:00E69F 122572            LCALL    ?C?PSTXDATA
B3:00E6A2 12D897            LCALL    ___find_span_by_node
;---- Variable 'span' assigned to Register 'R6/R7' ----
B3:00E6A5 EF                MOV      A,R7
B3:00E6A6 4E                ORL      A,R6
B3:00E6A7 602D              JZ       ?C0024?S2
B3:00E6A9 EF                MOV      A,R7
B3:00E6AA 2426              ADD      A,#026H
B3:00E6AC 12A8B7            LCALL    ?L?COM0094
B3:00E6AF E0                MOVX     A,@DPTR
B3:00E6B0 FD                MOV      R5,A
B3:00E6B1 6406              XRL      A,#06H
B3:00E6B3 6004              JZ       ?C0027?S2
B3:00E6B5 ED                MOV      A,R5
B3:00E6B6 B40418            CJNE     A,#04H,?C0025?S2
B3:00E6B9         ?C0027?S2:
B3:00E6B9 904645            MOV      DPTR,#con
B3:00E6BC D1DA              ACALL    ?L?COM03C2
B3:00E6BE 121FB9            LCALL    ?C?CLDOPTR
B3:00E6C1 FD                MOV      R5,A
B3:00E6C2 EF                MOV      A,R7
B3:00E6C3 2425              ADD      A,#025H
B3:00E6C5 12A8B7            LCALL    ?L?COM0094
B3:00E6C8 E0                MOVX     A,@DPTR
B3:00E6C9 B50505            CJNE     A,AR5,?C0025?S2
B3:00E6CC 7E00              MOV      R6,#00H
B3:00E6CE 7F01              MOV      R7,#01H
B3:00E6D0 22                RET      
B3:00E6D1         ?C0025?S2:
B3:00E6D1 7E00              MOV      R6,#00H
B3:00E6D3 7F00              MOV      R7,#00H
B3:00E6D5 22                RET      
B3:00E6D6         ?C0024?S2:
B3:00E6D6 E4                CLR      A
B3:00E6D7 FE                MOV      R6,A
B3:00E6D8 FF                MOV      R7,A
B3:00E6D9 22                RET      
----- FUNCTION ___S2_span_ok (END) -------


----- FUNCTION ?L?COM03C2 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 941


B3:00E6DA 122552            LCALL    ?C?PLDXDATA
B3:00E6DD 900007            MOV      DPTR,#07H
B3:00E6E0 22                RET      
----- FUNCTION ?L?COM03C2 (END) -------


----- FUNCTION __S2_send_nonce_get (BEGIN) -----
B3:00E6E1 12D891            LCALL    ?L?COM02E1
;---- Variable 'span' assigned to Register 'DPTR' ----
B3:00E6E4 EF                MOV      A,R7
B3:00E6E5 2424              ADD      A,#024H
B3:00E6E7 12A8B7            LCALL    ?L?COM0094
B3:00E6EA E0                MOVX     A,@DPTR
B3:00E6EB 9027F3            MOV      DPTR,#nonce_get+02H
B3:00E6EE F0                MOVX     @DPTR,A
B3:00E6EF 7B01              MOV      R3,#01H
B3:00E6F1 7A27              MOV      R2,#HIGH nonce_get
B3:00E6F3 79F1              MOV      R1,#LOW nonce_get
B3:00E6F5 7D03              MOV      R5,#03H
B3:00E6F7 7C00              MOV      R4,#00H
B3:00E6F9 02AF5C            LJMP     ___S2_send_raw
----- FUNCTION __S2_send_nonce_get (END) -------


----- FUNCTION ___S2_is_node_mos (BEGIN) -----
;---- Variable 'nodeid' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
B3:00E6FC E4                CLR      A
B3:00E6FD FE                MOV      R6,A
B3:00E6FE         ?C0035?S2:
B3:00E6FE 7B01              MOV      R3,#01H
B3:00E700 7A2A              MOV      R2,#HIGH the_context+0207H
B3:00E702 790B              MOV      R1,#LOW the_context+0207H
B3:00E704 75F002            MOV      B,#02H
B3:00E707 EE                MOV      A,R6
B3:00E708 F125              ACALL    ?L?COM0108
B3:00E70A 121FB9            LCALL    ?C?CLDOPTR
B3:00E70D B50703            CJNE     A,AR7,?C0037?S2
B3:00E710 7F01              MOV      R7,#01H
B3:00E712 22                RET      
B3:00E713         ?C0037?S2:
B3:00E713 0E                INC      R6
B3:00E714 EE                MOV      A,R6
B3:00E715 B403E6            CJNE     A,#03H,?C0035?S2
B3:00E718         ?C0036?S2:
B3:00E718 7F00              MOV      R7,#00H
B3:00E71A 22                RET      
----- FUNCTION ___S2_is_node_mos (END) -------


----- FUNCTION ?L?COM0106 (BEGIN) -----
B3:00E71B 7B01              MOV      R3,#01H
B3:00E71D 7A2A              MOV      R2,#HIGH the_context+0207H
B3:00E71F 790B              MOV      R1,#LOW the_context+0207H
B3:00E721         ?L?COM0107:
B3:00E721 75F002            MOV      B,#02H
B3:00E724 EF                MOV      A,R7
B3:00E725         ?L?COM0108:
B3:00E725 A4                MUL      AB
B3:00E726 F582              MOV      DPL,A
B3:00E728 85F083            MOV      DPH,B
B3:00E72B 22                RET      
----- FUNCTION ?L?COM0106 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 942


----- FUNCTION ___S2_add_mpan_extensions (BEGIN) -----
B3:00E72C 904242            MOV      DPTR,#ext_data
B3:00E72F 122572            LCALL    ?C?PSTXDATA
B3:00E732 904247            MOV      DPTR,#p
B3:00E735 122572            LCALL    ?C?PSTXDATA
B3:00E738 E4                CLR      A
B3:00E739 904246            MOV      DPTR,#k
B3:00E73C F0                MOVX     @DPTR,A
B3:00E73D 904245            MOV      DPTR,#i
B3:00E740 F0                MOVX     @DPTR,A
B3:00E741         ?C0040?S2:
B3:00E741 904245            MOV      DPTR,#i
B3:00E744 E0                MOVX     A,@DPTR
B3:00E745 FF                MOV      R7,A
B3:00E746 C3                CLR      C
B3:00E747 9403              SUBB     A,#03H
B3:00E749 4002              JC       $ + 4H
B3:00E74B E1D5              AJMP     ?C0041?S2
B3:00E74D F11B              ACALL    ?L?COM0106
B3:00E74F 121FB9            LCALL    ?C?CLDOPTR
B3:00E752 FF                MOV      R7,A
B3:00E753 9028D4            MOV      DPTR,#the_context+0D0H
B3:00E756 E0                MOVX     A,@DPTR
B3:00E757 6F                XRL      A,R7
B3:00E758 7073              JNZ      ?C0042?S2
B3:00E75A 09                INC      R1
B3:00E75B 12EE8C            LCALL    ?L?COM036C
B3:00E75E F125              ACALL    ?L?COM0108
B3:00E760 121FB9            LCALL    ?C?CLDOPTR
B3:00E763 FD                MOV      R5,A
B3:00E764 E4                CLR      A
B3:00E765 1B                DEC      R3
B3:00E766 FF                MOV      R7,A
B3:00E767 12D9ED            LCALL    ___find_mpan_by_group_id
B3:00E76A 90424A            MOV      DPTR,#mpan
B3:00E76D 12EDFB            LCALL    ?L?COM01C9
B3:00E770 605B              JZ       ?C0042?S2
B3:00E772         ?C0044?S2:
B3:00E772 904246            MOV      DPTR,#k
B3:00E775 E0                MOVX     A,@DPTR
B3:00E776 04                INC      A
B3:00E777 F0                MOVX     @DPTR,A
B3:00E778 A3                INC      DPTR
B3:00E779 12AFAC            LCALL    ?L?COM011A
B3:00E77C 7413              MOV      A,#013H
B3:00E77E 12203B            LCALL    ?C?CSTPTR
B3:00E781 904247            MOV      DPTR,#p
B3:00E784 12AFAC            LCALL    ?L?COM011A
B3:00E787 74C2              MOV      A,#0C2H
B3:00E789 12203B            LCALL    ?C?CSTPTR
B3:00E78C 7B01              MOV      R3,#01H
B3:00E78E 790C              MOV      R1,#LOW the_context+0208H
B3:00E790 12EE8C            LCALL    ?L?COM036C
B3:00E793 F125              ACALL    ?L?COM0108
B3:00E795 121FB9            LCALL    ?C?CLDOPTR
B3:00E798 FF                MOV      R7,A
B3:00E799 904247            MOV      DPTR,#p
B3:00E79C 12AFAC            LCALL    ?L?COM011A
B3:00E79F EF                MOV      A,R7
B3:00E7A0 12203B            LCALL    ?C?CSTPTR
B3:00E7A3 90424A            MOV      DPTR,#mpan
B3:00E7A6 12858F            LCALL    ?L?COM00AA
B3:00E7A9 C003              PUSH     AR3
B3:00E7AB C002              PUSH     AR2
B3:00E7AD C001              PUSH     AR1
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 943


B3:00E7AF 904247            MOV      DPTR,#p
B3:00E7B2 12ED39            LCALL    ?L?COM02D5
B3:00E7B5 D001              POP      AR1
B3:00E7B7 D002              POP      AR2
B3:00E7B9 D003              POP      AR3
B3:00E7BB 12D728            LCALL    ?L?COM0197
B3:00E7BE 7B01              MOV      R3,#01H
B3:00E7C0 7A2A              MOV      R2,#HIGH the_context+0207H
B3:00E7C2 790B              MOV      R1,#LOW the_context+0207H
B3:00E7C4 12EE8E            LCALL    ?L?COM036D
B3:00E7C7 F125              ACALL    ?L?COM0108
B3:00E7C9 E4                CLR      A
B3:00E7CA 12204D            LCALL    ?C?CSTOPTR
B3:00E7CD         ?C0042?S2:
B3:00E7CD 904245            MOV      DPTR,#i
B3:00E7D0 E0                MOVX     A,@DPTR
B3:00E7D1 04                INC      A
B3:00E7D2 F0                MOVX     @DPTR,A
B3:00E7D3 E141              AJMP     ?C0040?S2
B3:00E7D5         ?C0041?S2:
B3:00E7D5 904246            MOV      DPTR,#k
B3:00E7D8 E0                MOVX     A,@DPTR
B3:00E7D9 FF                MOV      R7,A
B3:00E7DA 6020              JZ       ?C0045?S2
B3:00E7DC 904242            MOV      DPTR,#ext_data
B3:00E7DF 122552            LCALL    ?C?PLDXDATA
B3:00E7E2 75F013            MOV      B,#013H
B3:00E7E5 EF                MOV      A,R7
B3:00E7E6 90FFEE            MOV      DPTR,#0FFEEH
B3:00E7E9 122546            LCALL    ?C?OFFXADD
B3:00E7EC E9                MOV      A,R1
B3:00E7ED 2582              ADD      A,DPL
B3:00E7EF F9                MOV      R1,A
B3:00E7F0 EA                MOV      A,R2
B3:00E7F1 3583              ADDC     A,DPH
B3:00E7F3 FA                MOV      R2,A
B3:00E7F4 121F7C            LCALL    ?C?CLDPTR
B3:00E7F7 547F              ANL      A,#07FH
B3:00E7F9 12203B            LCALL    ?C?CSTPTR
B3:00E7FC         ?C0045?S2:
B3:00E7FC 904246            MOV      DPTR,#k
B3:00E7FF E0                MOVX     A,@DPTR
B3:00E800 75F013            MOV      B,#013H
B3:00E803 A4                MUL      AB
B3:00E804 FF                MOV      R7,A
B3:00E805 AEF0              MOV      R6,B
B3:00E807 22                RET      
----- FUNCTION ___S2_add_mpan_extensions (END) -------


----- FUNCTION _fe25519_unpack (BEGIN) -----
B3:00E808 900AAE            MOV      DPTR,#r
B3:00E80B 123C23            LCALL    ?L?COM0146
B3:00E80E EC                MOV      A,R4
B3:00E80F F0                MOVX     @DPTR,A
B3:00E810 A3                INC      DPTR
B3:00E811 ED                MOV      A,R5
B3:00E812 F0                MOVX     @DPTR,A
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E813 E4                CLR      A
B3:00E814 FF                MOV      R7,A
B3:00E815         ?C0032?FE25519:
B3:00E815 900AB0            MOV      DPTR,#x
B3:00E818 12AFCA            LCALL    ?L?COM0205
B3:00E81B E0                MOVX     A,@DPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 944


B3:00E81C FE                MOV      R6,A
B3:00E81D 900AAE            MOV      DPTR,#r
B3:00E820 12AFCA            LCALL    ?L?COM0205
B3:00E823 EE                MOV      A,R6
B3:00E824 F0                MOVX     @DPTR,A
B3:00E825 0F                INC      R7
B3:00E826 EF                MOV      A,R7
B3:00E827 B420EB            CJNE     A,#020H,?C0032?FE25519
B3:00E82A         ?C0033?FE25519:
B3:00E82A 900AAE            MOV      DPTR,#r
B3:00E82D E0                MOVX     A,@DPTR
B3:00E82E FE                MOV      R6,A
B3:00E82F A3                INC      DPTR
B3:00E830 E0                MOVX     A,@DPTR
B3:00E831 241F              ADD      A,#01FH
B3:00E833 12A8B7            LCALL    ?L?COM0094
B3:00E836 E0                MOVX     A,@DPTR
B3:00E837 547F              ANL      A,#07FH
B3:00E839 F0                MOVX     @DPTR,A
B3:00E83A 22                RET      
----- FUNCTION _fe25519_unpack (END) -------


----- FUNCTION __S2_is_busy (BEGIN) -----
B3:00E83B 902A13            MOV      DPTR,#the_context+020FH
B3:00E83E E0                MOVX     A,@DPTR
B3:00E83F 7006              JNZ      ?C0064?S2
B3:00E841 902A11            MOV      DPTR,#the_context+020DH
B3:00E844 E0                MOVX     A,@DPTR
B3:00E845 6004              JZ       ?C0062?S2
B3:00E847         ?C0064?S2:
B3:00E847 7F01              MOV      R7,#01H
B3:00E849 8002              SJMP     ?C0063?S2
B3:00E84B         ?C0062?S2:
B3:00E84B 7F00              MOV      R7,#00H
B3:00E84D         ?C0063?S2:
B3:00E84D 22                RET      
----- FUNCTION __S2_is_busy (END) -------


----- FUNCTION ___S2_is_mos (BEGIN) -----
;---- Variable 'clear' assigned to Register 'R5' ----
;---- Variable 'node_id' assigned to Register 'R7' ----
;---- Variable 'i' assigned to Register 'R6' ----
B3:00E84E E4                CLR      A
B3:00E84F FE                MOV      R6,A
B3:00E850         ?C0069?S2:
B3:00E850 7B01              MOV      R3,#01H
B3:00E852 7A29              MOV      R2,#HIGH the_context+01A3H
B3:00E854 79A7              MOV      R1,#LOW the_context+01A3H
B3:00E856 75F014            MOV      B,#014H
B3:00E859 EE                MOV      A,R6
B3:00E85A 12E725            LCALL    ?L?COM0108
B3:00E85D 121FB9            LCALL    ?C?CLDOPTR
B3:00E860 6F                XRL      A,R7
B3:00E861 7022              JNZ      ?C0071?S2
B3:00E863 7A29              MOV      R2,#HIGH the_context+01B6H
B3:00E865 79BA              MOV      R1,#LOW the_context+01B6H
B3:00E867 75F014            MOV      B,#014H
B3:00E86A EE                MOV      A,R6
B3:00E86B 12E725            LCALL    ?L?COM0108
B3:00E86E 121FB9            LCALL    ?C?CLDOPTR
B3:00E871 B40211            CJNE     A,#02H,?C0071?S2
B3:00E874 ED                MOV      A,R5
B3:00E875 600B              JZ       ?C0073?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 945


B3:00E877 75F014            MOV      B,#014H
B3:00E87A EE                MOV      A,R6
B3:00E87B 12E725            LCALL    ?L?COM0108
B3:00E87E E4                CLR      A
B3:00E87F 12204D            LCALL    ?C?CSTOPTR
B3:00E882         ?C0073?S2:
B3:00E882 7F01              MOV      R7,#01H
B3:00E884 22                RET      
B3:00E885         ?C0071?S2:
B3:00E885 0E                INC      R6
B3:00E886 EE                MOV      A,R6
B3:00E887 B405C6            CJNE     A,#05H,?C0069?S2
B3:00E88A         ?C0070?S2:
B3:00E88A 7F00              MOV      R7,#00H
B3:00E88C 22                RET      
----- FUNCTION ___S2_is_mos (END) -------


----- FUNCTION _S2_set_node_mos (BEGIN) -----
B3:00E88D 904648            MOV      DPTR,#p_context
B3:00E890 122572            LCALL    ?C?PSTXDATA
;---- Variable 'node' assigned to Register 'R5' ----
B3:00E893 902A11            MOV      DPTR,#the_context+020DH
B3:00E896 E0                MOVX     A,@DPTR
B3:00E897 FF                MOV      R7,A
B3:00E898 6404              XRL      A,#04H
B3:00E89A 6005              JZ       ?C0080?S2
B3:00E89C EF                MOV      A,R7
B3:00E89D 6402              XRL      A,#02H
B3:00E89F 7040              JNZ      ?C0085?S2
B3:00E8A1         ?C0080?S2:
B3:00E8A1 9028D5            MOV      DPTR,#the_context+0D1H
B3:00E8A4 E0                MOVX     A,@DPTR
B3:00E8A5 5406              ANL      A,#06H
B3:00E8A7 6038              JZ       ?C0085?S2
B3:00E8A9 12AFB9            LCALL    ?L?COM0243
B3:00E8AC E0                MOVX     A,@DPTR
B3:00E8AD 4E                ORL      A,R6
B3:00E8AE 6031              JZ       ?C0085?S2
;---- Variable 'i' assigned to Register 'R7' ----
B3:00E8B0 E4                CLR      A
B3:00E8B1 FF                MOV      R7,A
B3:00E8B2         ?C0081?S2:
B3:00E8B2 12E71B            LCALL    ?L?COM0106
B3:00E8B5 121FB9            LCALL    ?C?CLDOPTR
B3:00E8B8 7022              JNZ      ?C0083?S2
B3:00E8BA 9028E2            MOV      DPTR,#the_context+0DEH
B3:00E8BD E0                MOVX     A,@DPTR
B3:00E8BE FA                MOV      R2,A
B3:00E8BF A3                INC      DPTR
B3:00E8C0 E0                MOVX     A,@DPTR
B3:00E8C1 F582              MOV      DPL,A
B3:00E8C3 8A83              MOV      DPH,R2
B3:00E8C5 A3                INC      DPTR
B3:00E8C6 E0                MOVX     A,@DPTR
B3:00E8C7 FE                MOV      R6,A
B3:00E8C8 7A2A              MOV      R2,#HIGH the_context+0208H
B3:00E8CA 09                INC      R1
B3:00E8CB 12E721            LCALL    ?L?COM0107
B3:00E8CE EE                MOV      A,R6
B3:00E8CF 12204D            LCALL    ?C?CSTOPTR
B3:00E8D2 7A2A              MOV      R2,#HIGH the_context+0207H
B3:00E8D4 19                DEC      R1
B3:00E8D5 12E721            LCALL    ?L?COM0107
B3:00E8D8 ED                MOV      A,R5
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 946


B3:00E8D9 02204D            LJMP     ?C?CSTOPTR
B3:00E8DC         ?C0083?S2:
B3:00E8DC 0F                INC      R7
B3:00E8DD EF                MOV      A,R7
B3:00E8DE B403D1            CJNE     A,#03H,?C0081?S2
B3:00E8E1         ?C0085?S2:
B3:00E8E1 22                RET      
----- FUNCTION _S2_set_node_mos (END) -------


----- FUNCTION ?L?COM04DF (BEGIN) -----
B3:00E8E2 9028D3            MOV      DPTR,#the_context+0CFH
B3:00E8E5 E0                MOVX     A,@DPTR
B3:00E8E6 FF                MOV      R7,A
----- FUNCTION ___S2_make_aad (BEGIN) -----
B3:00E8E7 904189            MOV      DPTR,#sender
B3:00E8EA 126563            LCALL    ?L?COM00E9
B3:00E8ED 122572            LCALL    ?C?PSTXDATA
B3:00E8F0 3196              ACALL    ?L?COM03A1
B3:00E8F2 FE                MOV      R6,A
B3:00E8F3 C3                CLR      C
B3:00E8F4 904196            MOV      DPTR,#max_size+01H
B3:00E8F7 E0                MOVX     A,@DPTR
B3:00E8F8 9F                SUBB     A,R7
B3:00E8F9 904195            MOV      DPTR,#max_size
B3:00E8FC E0                MOVX     A,@DPTR
B3:00E8FD 9E                SUBB     A,R6
B3:00E8FE 5004              JNC      ?C0090?S2
B3:00E900 E4                CLR      A
B3:00E901 FE                MOV      R6,A
B3:00E902 FF                MOV      R7,A
B3:00E903 22                RET      
B3:00E904         ?C0090?S2:
B3:00E904 904189            MOV      DPTR,#sender
B3:00E907 E0                MOVX     A,@DPTR
B3:00E908 FF                MOV      R7,A
B3:00E909 904192            MOV      DPTR,#aad
B3:00E90C 1256DF            LCALL    ?L?COM0125
B3:00E90F 90418A            MOV      DPTR,#receiver
B3:00E912 E0                MOVX     A,@DPTR
B3:00E913 904192            MOV      DPTR,#aad
B3:00E916 126DF9            LCALL    ?L?COM015F
B3:00E919 9028CB            MOV      DPTR,#the_context+0C7H
B3:00E91C 122462            LCALL    ?C?LLDXDATA
B3:00E91F 7818              MOV      R0,#018H
B3:00E921 1223AE            LCALL    ?C?ULSHR
B3:00E924 900002            MOV      DPTR,#02H
B3:00E927 318E              ACALL    ?L?COM03FE
B3:00E929 126E73            LCALL    ?L?COM02AB
B3:00E92C 900003            MOV      DPTR,#03H
B3:00E92F 318E              ACALL    ?L?COM03FE
B3:00E931 126E6B            LCALL    ?L?COM02AA
B3:00E934 900004            MOV      DPTR,#04H
B3:00E937 318E              ACALL    ?L?COM03FE
B3:00E939 122462            LCALL    ?C?LLDXDATA
B3:00E93C 900005            MOV      DPTR,#05H
B3:00E93F EF                MOV      A,R7
B3:00E940 12204D            LCALL    ?C?CSTOPTR
B3:00E943 904190            MOV      DPTR,#msg_len
B3:00E946 12DFA6            LCALL    ?L?COM0165
B3:00E949 900006            MOV      DPTR,#06H
B3:00E94C 12204D            LCALL    ?C?CSTOPTR
B3:00E94F ED                MOV      A,R5
B3:00E950 900007            MOV      DPTR,#07H
B3:00E953 12204D            LCALL    ?C?CSTOPTR
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 947


B3:00E956 90418F            MOV      DPTR,#hdr_len+01H
B3:00E959 E0                MOVX     A,@DPTR
B3:00E95A 24FE              ADD      A,#0FEH
B3:00E95C FF                MOV      R7,A
B3:00E95D 90418E            MOV      DPTR,#hdr_len
B3:00E960 E0                MOVX     A,@DPTR
B3:00E961 34FF              ADDC     A,#0FFH
B3:00E963 FE                MOV      R6,A
B3:00E964 90418B            MOV      DPTR,#msg
B3:00E967 12858F            LCALL    ?L?COM00AA
B3:00E96A C003              PUSH     AR3
B3:00E96C C002              PUSH     AR2
B3:00E96E C001              PUSH     AR1
B3:00E970 904192            MOV      DPTR,#aad
B3:00E973 122552            LCALL    ?C?PLDXDATA
B3:00E976 E9                MOV      A,R1
B3:00E977 2408              ADD      A,#08H
B3:00E979 F9                MOV      R1,A
B3:00E97A E4                CLR      A
B3:00E97B 3A                ADDC     A,R2
B3:00E97C A801              MOV      R0,AR1
B3:00E97E FC                MOV      R4,A
B3:00E97F AD03              MOV      R5,AR3
B3:00E981 D001              POP      AR1
B3:00E983 D002              POP      AR2
B3:00E985 D003              POP      AR3
B3:00E987 121F56            LCALL    ?C?COPY
B3:00E98A 3196              ACALL    ?L?COM03A1
B3:00E98C FE                MOV      R6,A
B3:00E98D 22                RET      
----- FUNCTION ___S2_make_aad (END) -------


----- FUNCTION ?L?COM03FE (BEGIN) -----
B3:00E98E EF                MOV      A,R7
B3:00E98F 12204D            LCALL    ?C?CSTOPTR
B3:00E992 9028CB            MOV      DPTR,#the_context+0C7H
B3:00E995 22                RET      
----- FUNCTION ?L?COM03FE (END) -------


----- FUNCTION ?L?COM03A1 (BEGIN) -----
B3:00E996 90418F            MOV      DPTR,#hdr_len+01H
B3:00E999 E0                MOVX     A,@DPTR
B3:00E99A 2406              ADD      A,#06H
B3:00E99C FF                MOV      R7,A
B3:00E99D 90418E            MOV      DPTR,#hdr_len
B3:00E9A0 E0                MOVX     A,@DPTR
B3:00E9A1 3400              ADDC     A,#00H
B3:00E9A3 22                RET      
----- FUNCTION ?L?COM03A1 (END) -------


----- FUNCTION ___S2_is_peernode (BEGIN) -----
;---- Variable 'peer' assigned to Register 'R1/R2/R3' ----
B3:00E9A4 121F7C            LCALL    ?C?CLDPTR
B3:00E9A7 FF                MOV      R7,A
B3:00E9A8 9028D3            MOV      DPTR,#the_context+0CFH
B3:00E9AB E0                MOVX     A,@DPTR
B3:00E9AC B50711            CJNE     A,AR7,?C0158?S2
B3:00E9AF 129CA5            LCALL    ?L?COM0065
B3:00E9B2 FF                MOV      R7,A
B3:00E9B3 9028D4            MOV      DPTR,#the_context+0D0H
B3:00E9B6 E0                MOVX     A,@DPTR
B3:00E9B7 B50706            CJNE     A,AR7,?C0158?S2
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 948


B3:00E9BA 7E00              MOV      R6,#00H
B3:00E9BC 7F01              MOV      R7,#01H
B3:00E9BE 8004              SJMP     ?C0159?S2
B3:00E9C0         ?C0158?S2:
B3:00E9C0 7E00              MOV      R6,#00H
B3:00E9C2 7F00              MOV      R7,#00H
B3:00E9C4         ?C0159?S2:
B3:00E9C4 22                RET      
----- FUNCTION ___S2_is_peernode (END) -------


----- FUNCTION __S2_is_send_data_multicast_busy (BEGIN) -----
B3:00E9C5 902A11            MOV      DPTR,#the_context+020DH
B3:00E9C8 E0                MOVX     A,@DPTR
B3:00E9C9 7F00              MOV      R7,#00H
B3:00E9CB 6002              JZ       ?C0260?S2
B3:00E9CD 7F01              MOV      R7,#01H
B3:00E9CF         ?C0260?S2:
B3:00E9CF 22                RET      
----- FUNCTION __S2_is_send_data_multicast_busy (END) -------


----- FUNCTION _s2_default_evt_handler (BEGIN) -----
B3:00E9D0 22                RET      
----- FUNCTION _s2_default_evt_handler (END) -------


----- FUNCTION _s2_inclusion_set_event_handler (BEGIN) -----
;---- Variable 'evt_handler' assigned to Register 'R6/R7' ----
B3:00E9D1 902FEC            MOV      DPTR,#m_evt_handler
B3:00E9D4 EE                MOV      A,R6
B3:00E9D5 F0                MOVX     @DPTR,A
B3:00E9D6 A3                INC      DPTR
B3:00E9D7 EF                MOV      A,R7
B3:00E9D8 F0                MOVX     @DPTR,A
B3:00E9D9 22                RET      
----- FUNCTION _s2_inclusion_set_event_handler (END) -------


----- FUNCTION _ZCB_s2_inclusion_notify_timeout (BEGIN) -----
B3:00E9DA 90464E            MOV      DPTR,#p_context
B3:00E9DD 122572            LCALL    ?C?PSTXDATA
B3:00E9E0 902A13            MOV      DPTR,#the_context+020FH
B3:00E9E3 E0                MOVX     A,@DPTR
B3:00E9E4 B40A15            CJNE     A,#0AH,?C0072?S2_INCLUSION
B3:00E9E7 903033            MOV      DPTR,#m_retry_counter
B3:00E9EA E0                MOVX     A,@DPTR
B3:00E9EB 6003              JZ       ?C0075?S2_INCLUSION
B3:00E9ED B4FF06            CJNE     A,#0FFH,?C0073?S2_INCLUSION
B3:00E9F0         ?C0075?S2_INCLUSION:
B3:00E9F0 7E02              MOV      R6,#02H
B3:00E9F2 7F09              MOV      R7,#09H
B3:00E9F4 800A              SJMP     ?C0140?S2_INCLUSION
B3:00E9F6         ?C0073?S2_INCLUSION:
B3:00E9F6 7E02              MOV      R6,#02H
B3:00E9F8 7F08              MOV      R7,#08H
B3:00E9FA         ?C0074?S2_INCLUSION:
B3:00E9FA 8004              SJMP     ?C0140?S2_INCLUSION
B3:00E9FC         ?C0072?S2_INCLUSION:
B3:00E9FC 7F09              MOV      R7,#09H
B3:00E9FE 7E02              MOV      R6,#02H
B3:00EA00         
B3:00EA00 028BE8            LJMP     _process_event
----- FUNCTION _ZCB_s2_inclusion_notify_timeout (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 949



----- FUNCTION _s2_inclusion_send_done (BEGIN) -----
B3:00EA03 9045A2            MOV      DPTR,#p_context
B3:00EA06 122572            LCALL    ?C?PSTXDATA
B3:00EA09 9045A5            MOV      DPTR,#status
B3:00EA0C ED                MOV      A,R5
B3:00EA0D F0                MOVX     @DPTR,A
B3:00EA0E 903033            MOV      DPTR,#m_retry_counter
B3:00EA11 E0                MOVX     A,@DPTR
B3:00EA12 B4FF09            CJNE     A,#0FFH,?C0078?S2_INCLUSION
B3:00EA15 7403              MOV      A,#03H
B3:00EA17 F0                MOVX     @DPTR,A
B3:00EA18 7F08              MOV      R7,#08H
B3:00EA1A 7E02              MOV      R6,#02H
B3:00EA1C 802F              SJMP     ?C0142?S2_INCLUSION
B3:00EA1E         ?C0078?S2_INCLUSION:
B3:00EA1E 903033            MOV      DPTR,#m_retry_counter
B3:00EA21 E0                MOVX     A,@DPTR
B3:00EA22 D3                SETB     C
B3:00EA23 9400              SUBB     A,#00H
B3:00EA25 4018              JC       ?C0080?S2_INCLUSION
B3:00EA27 902A13            MOV      DPTR,#the_context+020FH
B3:00EA2A E0                MOVX     A,@DPTR
B3:00EA2B 640A              XRL      A,#0AH
B3:00EA2D 6010              JZ       ?C0080?S2_INCLUSION
B3:00EA2F 9045A5            MOV      DPTR,#status
B3:00EA32 E0                MOVX     A,@DPTR
B3:00EA33 7E02              MOV      R6,#02H
B3:00EA35 6004              JZ       ?C0081?S2_INCLUSION
B3:00EA37 7F0C              MOV      R7,#0CH
B3:00EA39 8002              SJMP     ?C0082?S2_INCLUSION
B3:00EA3B         ?C0081?S2_INCLUSION:
B3:00EA3B 7F08              MOV      R7,#08H
B3:00EA3D         ?C0082?S2_INCLUSION:
B3:00EA3D         
B3:00EA3D 800E              SJMP     ?C0142?S2_INCLUSION
B3:00EA3F         ?C0080?S2_INCLUSION:
B3:00EA3F 9045A5            MOV      DPTR,#status
B3:00EA42 E0                MOVX     A,@DPTR
B3:00EA43 7E02              MOV      R6,#02H
B3:00EA45 6004              JZ       ?C0084?S2_INCLUSION
B3:00EA47 7F0C              MOV      R7,#0CH
B3:00EA49 8002              SJMP     ?C0085?S2_INCLUSION
B3:00EA4B         ?C0084?S2_INCLUSION:
B3:00EA4B 7F0D              MOV      R7,#0DH
B3:00EA4D         ?C0085?S2_INCLUSION:
B3:00EA4D         
B3:00EA4D 028BE8            LJMP     _process_event
----- FUNCTION _s2_inclusion_send_done (END) -------


----- FUNCTION _s2_inclusion_decryption_failure (BEGIN) -----
B3:00EA50 904651            MOV      DPTR,#p_context
B3:00EA53 122572            LCALL    ?C?PSTXDATA
B3:00EA56 7F04              MOV      R7,#04H
B3:00EA58 7E02              MOV      R6,#02H
B3:00EA5A 028BE8            LJMP     _process_event
----- FUNCTION _s2_inclusion_decryption_failure (END) -------


----- FUNCTION s2_joining_start (BEGIN) -----
B3:00EA5D E4                CLR      A
B3:00EA5E 9028D5            MOV      DPTR,#the_context+0D1H
B3:00EA61 F0                MOVX     @DPTR,A
B3:00EA62 7FFF              MOV      R7,#0FFH
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 950


B3:00EA64 121AFC            LCALL    ?INTERBANK_TABLE?_keystore_network_key_clear
B3:00EA67 7F70              MOV      R7,#070H
B3:00EA69 7E17              MOV      R6,#017H
B3:00EA6B 7D00              MOV      R5,#00H
B3:00EA6D 7C00              MOV      R4,#00H
B3:00EA6F 028AFC            LJMP     _s2_inclusion_set_timeout
----- FUNCTION s2_joining_start (END) -------


----- FUNCTION _ZCB_reset_transport_service (BEGIN) -----
B3:00EA72 7B01              MOV      R3,#01H
B3:00EA74 7A31              MOV      R2,#HIGH scb+02EH
B3:00EA76 79D4              MOV      R1,#LOW scb+02EH
B3:00EA78 121B2E            LCALL    ?INTERBANK_TABLE?_ctimer_stop
B3:00EA7B E4                CLR      A
B3:00EA7C 900AEB            MOV      DPTR,#current_state
B3:00EA7F F0                MOVX     @DPTR,A
B3:;----                  JMP      discard_all_received_fragments
----- FUNCTION _ZCB_reset_transport_service (END) -------


----- FUNCTION discard_all_received_fragments (BEGIN) -----
B3:00EA80 51BB              ACALL    ?L?COM03B1
B3:00EA82 7DC8              MOV      R5,#0C8H
B3:00EA84 126EAB            LCALL    ?L?COM030C
B3:00EA87 7A30              MOV      R2,#HIGH rcb
B3:00EA89 797A              MOV      R1,#LOW rcb
B3:00EA8B 7D1E              MOV      R5,#01EH
B3:00EA8D E4                CLR      A
B3:00EA8E 51DD              ACALL    ?L?COM039C
B3:00EA90 51CA              ACALL    ?L?COM04DB
B3:00EA92 E4                CLR      A
B3:00EA93 FF                MOV      R7,A
B3:00EA94 12851A            LCALL    ___ZW_memset
B3:00EA97 E4                CLR      A
B3:00EA98 903198            MOV      DPTR,#rcb+011EH
B3:00EA9B F0                MOVX     @DPTR,A
B3:00EA9C FF                MOV      R7,A
B3:00EA9D 22                RET      
----- FUNCTION discard_all_received_fragments (END) -------


----- FUNCTION recv_or_send (BEGIN) -----
B3:00EA9E 900AEB            MOV      DPTR,#current_state
B3:00EAA1 E0                MOVX     A,@DPTR
B3:00EAA2 14                DEC      A
B3:00EAA3 24FB              ADD      A,#0FBH
B3:00EAA5 500B              JNC      ?C0009?TRANSPORT_SERVICE2
B3:00EAA7 24FD              ADD      A,#0FDH
B3:00EAA9 500A              JNC      ?C0012?TRANSPORT_SERVICE2
B3:00EAAB 2409              ADD      A,#09H
B3:00EAAD 7009              JNZ      ?C0002?TRANSPORT_SERVICE2
B3:00EAAF         ?C0003?TRANSPORT_SERVICE2:
B3:00EAAF 7F02              MOV      R7,#02H
B3:00EAB1 22                RET      
B3:00EAB2         ?C0009?TRANSPORT_SERVICE2:
B3:00EAB2 7F01              MOV      R7,#01H
B3:00EAB4 22                RET      
B3:00EAB5         ?C0012?TRANSPORT_SERVICE2:
B3:00EAB5 7F00              MOV      R7,#00H
B3:00EAB7 22                RET      
B3:00EAB8         ?C0002?TRANSPORT_SERVICE2:
B3:00EAB8 7FFF              MOV      R7,#0FFH
B3:00EABA 22                RET      
----- FUNCTION recv_or_send (END) -------
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 951




----- FUNCTION ?L?COM03B1 (BEGIN) -----
B3:00EABB 7B01              MOV      R3,#01H
B3:00EABD 7A30              MOV      R2,#HIGH rcb+054H
B3:00EABF 79CE              MOV      R1,#LOW rcb+054H
B3:00EAC1 22                RET      
----- FUNCTION ?L?COM03B1 (END) -------


----- FUNCTION ZW_TransportService_Is_Sending (BEGIN) -----
B3:00EAC2 519E              ACALL    recv_or_send
B3:00EAC4 EF                MOV      A,R7
B3:00EAC5 C3                CLR      C
B3:00EAC6 7001              JNZ      ?C0017?TRANSPORT_SERVICE2
B3:00EAC8 D3                SETB     C
B3:00EAC9         ?C0017?TRANSPORT_SERVICE2:
B3:00EAC9 22                RET      
----- FUNCTION ZW_TransportService_Is_Sending (END) -------


----- FUNCTION ?L?COM04DB (BEGIN) -----
B3:00EACA 7B01              MOV      R3,#01H
B3:00EACC 7A31              MOV      R2,#HIGH rcb+011FH
B3:00EACE 7999              MOV      R1,#LOW rcb+011FH
B3:00EAD0 7D0A              MOV      R5,#0AH
B3:00EAD2 22                RET      
----- FUNCTION ?L?COM04DB (END) -------


----- FUNCTION ZW_TransportService_Is_Receving (BEGIN) -----
B3:00EAD3 519E              ACALL    recv_or_send
B3:00EAD5 BF0103            CJNE     R7,#01H,?C0014?TRANSPORT_SERVICE2
B3:00EAD8 D3                SETB     C
B3:00EAD9 8001              SJMP     ?C0015?TRANSPORT_SERVICE2
B3:00EADB         ?C0014?TRANSPORT_SERVICE2:
B3:00EADB C3                CLR      C
B3:00EADC         ?C0015?TRANSPORT_SERVICE2:
B3:00EADC 22                RET      
----- FUNCTION ZW_TransportService_Is_Receving (END) -------


----- FUNCTION ?L?COM039C (BEGIN) -----
B3:00EADD FF                MOV      R7,A
B3:00EADE 12851A            LCALL    ___ZW_memset
B3:00EAE1         ?L?COM039D:
B3:00EAE1 903096            MOV      DPTR,#rcb+01CH
B3:00EAE4 7410              MOV      A,#010H
B3:00EAE6 F0                MOVX     @DPTR,A
B3:00EAE7 22                RET      
----- FUNCTION ?L?COM039C (END) -------


----- FUNCTION _ZW_TransportService_SendData (BEGIN) -----
B3:00EAE8 903F3B            MOV      DPTR,#p
B3:00EAEB 122572            LCALL    ?C?PSTXDATA
B3:00EAEE 7B01              MOV      R3,#01H
B3:00EAF0 7A3F              MOV      R2,#HIGH t
B3:00EAF2 7945              MOV      R1,#LOW t
B3:00EAF4 7D13              MOV      R5,#013H
B3:00EAF6 E4                CLR      A
B3:00EAF7 FF                MOV      R7,A
B3:00EAF8 12851A            LCALL    ___ZW_memset
B3:00EAFB 12B4C0            LCALL    ?L?COM0027
B3:00EAFE 51C2              ACALL    ZW_TransportService_Is_Sending
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 952


B3:00EB00 5002              JNC      ?C0021?TRANSPORT_SERVICE2
B3:00EB02 8004              SJMP     ?C0204?TRANSPORT_SERVICE2
B3:00EB04         ?C0021?TRANSPORT_SERVICE2:
B3:00EB04 51D3              ACALL    ZW_TransportService_Is_Receving
B3:00EB06 500E              JNC      ?C0023?TRANSPORT_SERVICE2
B3:00EB08         
B3:00EB08 7B01              MOV      R3,#01H
B3:00EB0A 7A3F              MOV      R2,#HIGH t
B3:00EB0C 7945              MOV      R1,#LOW t
B3:00EB0E 903F43            MOV      DPTR,#completedFunc
B3:00EB11 12C310            LCALL    ?L?COM0387
B3:00EB14 C3                CLR      C
B3:00EB15 22                RET      
B3:00EB16         ?C0023?TRANSPORT_SERVICE2:
B3:00EB16 903F3E            MOV      DPTR,#pData
B3:00EB19 122552            LCALL    ?C?PLDXDATA
B3:00EB1C 9031CC            MOV      DPTR,#scb+026H
B3:00EB1F 122572            LCALL    ?C?PSTXDATA
B3:00EB22 903F3B            MOV      DPTR,#p
B3:00EB25 122552            LCALL    ?C?PLDXDATA
B3:00EB28 128549            LCALL    ?L?COM0019
B3:00EB2B 7A31              MOV      R2,#HIGH scb+08H
B3:00EB2D 79AE              MOV      R1,#LOW scb+08H
B3:00EB2F 71A0              ACALL    ?L?COM053D
B3:00EB31 903F41            MOV      DPTR,#dataLength
B3:00EB34 E0                MOVX     A,@DPTR
B3:00EB35 FF                MOV      R7,A
B3:00EB36 A3                INC      DPTR
B3:00EB37 E0                MOVX     A,@DPTR
B3:00EB38 9031CF            MOV      DPTR,#scb+029H
B3:00EB3B CF                XCH      A,R7
B3:00EB3C F0                MOVX     @DPTR,A
B3:00EB3D A3                INC      DPTR
B3:00EB3E EF                MOV      A,R7
B3:00EB3F F0                MOVX     @DPTR,A
B3:00EB40 903F43            MOV      DPTR,#completedFunc
B3:00EB43 E0                MOVX     A,@DPTR
B3:00EB44 FF                MOV      R7,A
B3:00EB45 A3                INC      DPTR
B3:00EB46 E0                MOVX     A,@DPTR
B3:00EB47 9031B5            MOV      DPTR,#scb+0FH
B3:00EB4A 12CB63            LCALL    ?L?COM0136
B3:00EB4D 7A31              MOV      R2,#HIGH scb+011H
B3:00EB4F 79B7              MOV      R1,#LOW scb+011H
B3:00EB51 7D13              MOV      R5,#013H
B3:00EB53 E4                CLR      A
B3:00EB54 FF                MOV      R7,A
B3:00EB55 12851A            LCALL    ___ZW_memset
B3:00EB58 E4                CLR      A
B3:00EB59 9031D1            MOV      DPTR,#scb+02BH
B3:00EB5C F0                MOVX     @DPTR,A
B3:00EB5D A3                INC      DPTR
B3:00EB5E F0                MOVX     @DPTR,A
B3:00EB5F A3                INC      DPTR
B3:00EB60 7411              MOV      A,#011H
B3:00EB62 F0                MOVX     @DPTR,A
B3:00EB63 E4                CLR      A
B3:00EB64 903213            MOV      DPTR,#scb+06DH
B3:00EB67 F0                MOVX     @DPTR,A
B3:00EB68 A3                INC      DPTR
B3:00EB69 F0                MOVX     @DPTR,A
B3:00EB6A 90321C            MOV      DPTR,#scb+076H
B3:00EB6D F0                MOVX     @DPTR,A
B3:00EB6E A3                INC      DPTR
B3:00EB6F F0                MOVX     @DPTR,A
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 953


B3:00EB70 A3                INC      DPTR
B3:00EB71 F0                MOVX     @DPTR,A
B3:00EB72 9031AC            MOV      DPTR,#scb+06H
B3:00EB75 F0                MOVX     @DPTR,A
B3:00EB76 A3                INC      DPTR
B3:00EB77 F0                MOVX     @DPTR,A
B3:00EB78 90321F            MOV      DPTR,#scb+079H
B3:00EB7B F0                MOVX     @DPTR,A
B3:00EB7C 903F3B            MOV      DPTR,#p
B3:00EB7F 129CA2            LCALL    ?L?COM0064
B3:00EB82 90321F            MOV      DPTR,#scb+079H
B3:00EB85 F0                MOVX     @DPTR,A
B3:00EB86 900AEB            MOV      DPTR,#current_state
B3:00EB89 E0                MOVX     A,@DPTR
B3:00EB8A 24FA              ADD      A,#0FAH
B3:00EB8C 6008              JZ       ?C0026?TRANSPORT_SERVICE2
B3:00EB8E 2406              ADD      A,#06H
B3:00EB90 7009              JNZ      ?C0024?TRANSPORT_SERVICE2
B3:00EB92         ?C0025?TRANSPORT_SERVICE2:
B3:00EB92 7F17              MOV      R7,#017H
B3:00EB94 8002              SJMP     ?C0205?TRANSPORT_SERVICE2
B3:00EB96         ?C0026?TRANSPORT_SERVICE2:
B3:00EB96 7F18              MOV      R7,#018H
B3:00EB98         
B3:00EB98 129C55            LCALL    _t2_sm_post_event
B3:00EB9B         ?C0024?TRANSPORT_SERVICE2:
B3:00EB9B 12DE5A            LCALL    send_first_frag
B3:00EB9E D3                SETB     C
B3:00EB9F 22                RET      
----- FUNCTION _ZW_TransportService_SendData (END) -------


----- FUNCTION ?L?COM053D (BEGIN) -----
B3:00EBA0 7B01              MOV      R3,#01H
B3:00EBA2 7F07              MOV      R7,#07H
B3:00EBA4 028195            LJMP     ___ZW_memcpy
----- FUNCTION ?L?COM053D (END) -------


----- FUNCTION _add_crc (BEGIN) -----
B3:00EBA7 9045A6            MOV      DPTR,#len
B3:00EBAA ED                MOV      A,R5
B3:00EBAB F0                MOVX     @DPTR,A
;---- Variable 'buf' assigned to Register 'R1/R2/R3' ----
B3:00EBAC A3                INC      DPTR
B3:00EBAD 122572            LCALL    ?C?PSTXDATA
B3:00EBB0 9045A6            MOV      DPTR,#len
B3:00EBB3 71EA              ACALL    ?L?COM0135
B3:00EBB5 12BED7            LCALL    ?L?COM0347
;---- Variable 'crc' assigned to Register 'R4/R5' ----
B3:00EBB8 AD07              MOV      R5,AR7
B3:00EBBA AC06              MOV      R4,AR6
B3:00EBBC 9045A6            MOV      DPTR,#len
B3:00EBBF E0                MOVX     A,@DPTR
B3:00EBC0 FF                MOV      R7,A
B3:00EBC1 9045A8            MOV      DPTR,#tmp_buf+01H
B3:00EBC4 71E4              ACALL    ?L?COM0208
B3:00EBC6 EC                MOV      A,R4
B3:00EBC7 FF                MOV      R7,A
B3:00EBC8 9045A7            MOV      DPTR,#tmp_buf
B3:00EBCB 12AFAC            LCALL    ?L?COM011A
B3:00EBCE EF                MOV      A,R7
B3:00EBCF 12203B            LCALL    ?C?CSTPTR
B3:00EBD2 9045A7            MOV      DPTR,#tmp_buf
B3:00EBD5 122552            LCALL    ?C?PLDXDATA
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 954


B3:00EBD8 ED                MOV      A,R5
B3:00EBD9 02203B            LJMP     ?C?CSTPTR
----- FUNCTION _add_crc (END) -------


----- FUNCTION ?L?COM0207 (BEGIN) -----
B3:00EBDC 903725            MOV      DPTR,#ext_len
B3:00EBDF E0                MOVX     A,@DPTR
B3:00EBE0 FF                MOV      R7,A
B3:00EBE1 903723            MOV      DPTR,#ext_data+01H
B3:00EBE4         ?L?COM0208:
B3:00EBE4 E4                CLR      A
B3:00EBE5 8FF0              MOV      B,R7
B3:00EBE7 02210C            LJMP     ?C?IILDX
----- FUNCTION ?L?COM0207 (END) -------


----- FUNCTION ?L?COM0135 (BEGIN) -----
B3:00EBEA E0                MOVX     A,@DPTR
B3:00EBEB FF                MOV      R7,A
B3:00EBEC 90436F            MOV      DPTR,#?_ZW_CheckCrc16?BYTE+05H
B3:00EBEF E4                CLR      A
B3:00EBF0 F0                MOVX     @DPTR,A
B3:00EBF1 A3                INC      DPTR
B3:00EBF2 EF                MOV      A,R7
B3:00EBF3 F0                MOVX     @DPTR,A
B3:00EBF4 22                RET      
----- FUNCTION ?L?COM0135 (END) -------


----- FUNCTION _ZCB_rx_timer_expired (BEGIN) -----
;---- Variable 'puser' assigned to Register 'R1/R2/R3' ----
;---- Variable 'rdata' assigned to Register 'R1/R2/R3' ----
B3:00EBF5 121F7C            LCALL    ?C?CLDPTR
B3:00EBF8 9046C1            MOV      DPTR,#state
B3:00EBFB 9113              ACALL    ?L?COM0440
B3:00EBFD 7F08              MOV      R7,#08H
B3:00EBFF 129C55            LCALL    _t2_sm_post_event
B3:00EC02 9046C1            MOV      DPTR,#state
B3:00EC05 E0                MOVX     A,@DPTR
B3:00EC06 6008              JZ       ?C0123?TRANSPORT_SERVICE2
B3:00EC08 12DCE5            LCALL    get_num_missing_frag
B3:00EC0B EF                MOV      A,R7
B3:00EC0C 6002              JZ       ?C0123?TRANSPORT_SERVICE2
B3:00EC0E 4180              AJMP     discard_all_received_fragments
B3:00EC10         ?C0123?TRANSPORT_SERVICE2:
B3:00EC10 02B791            LJMP     find_missing
----- FUNCTION _ZCB_rx_timer_expired (END) -------


----- FUNCTION ?L?COM0440 (BEGIN) -----
B3:00EC13 F0                MOVX     @DPTR,A
B3:00EC14 7B01              MOV      R3,#01H
B3:00EC16 7A30              MOV      R2,#HIGH rcb+033H
B3:00EC18 79AD              MOV      R1,#LOW rcb+033H
B3:00EC1A 021B2E            LJMP     ?INTERBANK_TABLE?_ctimer_stop
----- FUNCTION ?L?COM0440 (END) -------


----- FUNCTION _ZCB_temp_callback_last_frag (BEGIN) -----
B3:00EC1D 9045AA            MOV      DPTR,#status
B3:00EC20 126E8B            LCALL    ?L?COM02DB
B3:00EC23 9045AB            MOV      DPTR,#user
B3:00EC26 122552            LCALL    ?C?PLDXDATA
B3:00EC29 128549            LCALL    ?L?COM0019
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 955


B3:00EC2C 02818D            LJMP     ?L?COM029F
----- FUNCTION _ZCB_temp_callback_last_frag (END) -------


----- FUNCTION _ZCB_temp_callback_reply_frag_req (BEGIN) -----
B3:00EC2F 9045B2            MOV      DPTR,#status
B3:00EC32 126E8B            LCALL    ?L?COM02DB
B3:00EC35 9045B3            MOV      DPTR,#user
B3:00EC38 122552            LCALL    ?C?PLDXDATA
B3:00EC3B 128549            LCALL    ?L?COM0019
B3:00EC3E 12818D            LCALL    ?L?COM029F
B3:00EC41 9045B2            MOV      DPTR,#status
B3:00EC44 E0                MOVX     A,@DPTR
B3:00EC45 FF                MOV      R7,A
B3:00EC46 6014              JZ       ?C0076?TRANSPORT_SERVICE2
B3:00EC48 9031B5            MOV      DPTR,#scb+0FH
B3:00EC4B E0                MOVX     A,@DPTR
B3:00EC4C FC                MOV      R4,A
B3:00EC4D A3                INC      DPTR
B3:00EC4E E0                MOVX     A,@DPTR
B3:00EC4F FD                MOV      R5,A
B3:00EC50 4C                ORL      A,R4
B3:00EC51 6009              JZ       ?C0076?TRANSPORT_SERVICE2
B3:00EC53 9045B3            MOV      DPTR,#user
B3:00EC56 126F8C            LCALL    ?L?COM0416
B3:00EC59 1226E3            LCALL    ?C?ICALL2
B3:00EC5C         ?C0076?TRANSPORT_SERVICE2:
B3:00EC5C 7F1A              MOV      R7,#01AH
B3:00EC5E 029C55            LJMP     _t2_sm_post_event
----- FUNCTION _ZCB_temp_callback_reply_frag_req (END) -------


----- FUNCTION _ZW_TransportService_Init (BEGIN) -----
;---- Variable 'commandHandler' assigned to Register 'R6/R7' ----
B3:00EC61 903074            MOV      DPTR,#TSApplicationCommandHandler
B3:00EC64 EE                MOV      A,R6
B3:00EC65 F0                MOVX     @DPTR,A
B3:00EC66 A3                INC      DPTR
B3:00EC67 EF                MOV      A,R7
B3:00EC68 F0                MOVX     @DPTR,A
B3:00EC69 22                RET      
----- FUNCTION _ZW_TransportService_Init (END) -------


----- FUNCTION _find_transition (BEGIN) -----
;---- Variable 'event' assigned to Register 'R5' ----
;---- Variable 'cstate' assigned to Register 'R7' ----
;---- Variable 'num_trans' assigned to Register 'R6' ----
B3:00EC6A 7E38              MOV      R6,#038H
B3:00EC6C         ?C0001?TRANSPORT2_FSM:
B3:00EC6C AC06              MOV      R4,AR6
B3:00EC6E 1E                DEC      R6
B3:00EC6F EC                MOV      A,R4
B3:00EC70 6014              JZ       ?C0002?TRANSPORT2_FSM
B3:00EC72 902E48            MOV      DPTR,#trans
B3:00EC75 9189              ACALL    ?L?COM0499
B3:00EC77 B507F2            CJNE     A,AR7,?C0001?TRANSPORT2_FSM
B3:00EC7A 902E49            MOV      DPTR,#trans+01H
B3:00EC7D 9189              ACALL    ?L?COM0499
B3:00EC7F B505EA            CJNE     A,AR5,?C0001?TRANSPORT2_FSM
B3:00EC82 EE                MOV      A,R6
B3:00EC83 04                INC      A
B3:00EC84 FF                MOV      R7,A
B3:00EC85 22                RET      
B3:00EC86         ?C0002?TRANSPORT2_FSM:
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 956


B3:00EC86 7F00              MOV      R7,#00H
B3:00EC88 22                RET      
----- FUNCTION _find_transition (END) -------


----- FUNCTION ?L?COM0499 (BEGIN) -----
B3:00EC89 75F006            MOV      B,#06H
B3:00EC8C EE                MOV      A,R6
B3:00EC8D 122546            LCALL    ?C?OFFXADD
B3:00EC90 E4                CLR      A
B3:00EC91 93                MOVC     A,@A+DPTR
B3:00EC92 22                RET      
----- FUNCTION ?L?COM0499 (END) -------


----- FUNCTION _fe25519_freeze (BEGIN) -----
B3:00EC93 90097F            MOV      DPTR,#r
B3:00EC96 EE                MOV      A,R6
B3:00EC97 F0                MOVX     @DPTR,A
B3:00EC98 FC                MOV      R4,A
B3:00EC99 A3                INC      DPTR
B3:00EC9A EF                MOV      A,R7
B3:00EC9B F0                MOVX     @DPTR,A
B3:00EC9C FD                MOV      R5,A
B3:00EC9D 7E09              MOV      R6,#HIGH rt
B3:00EC9F 7F81              MOV      R7,#LOW rt
;---- Variable 'c' assigned to Register 'R3' ----
B3:00ECA1 91B7              ACALL    ?L?COM01FB
B3:00ECA3 12A7E1            LCALL    _fe25519_cmov
B3:00ECA6 7E09              MOV      R6,#HIGH rt
B3:00ECA8 7F81              MOV      R7,#LOW rt
B3:00ECAA 90097F            MOV      DPTR,#r
B3:00ECAD E0                MOVX     A,@DPTR
B3:00ECAE FC                MOV      R4,A
B3:00ECAF A3                INC      DPTR
B3:00ECB0 E0                MOVX     A,@DPTR
B3:00ECB1 FD                MOV      R5,A
B3:00ECB2 91B7              ACALL    ?L?COM01FB
B3:00ECB4 02A7E1            LJMP     _fe25519_cmov
----- FUNCTION _fe25519_freeze (END) -------


----- FUNCTION ?L?COM01FB (BEGIN) -----
B3:00ECB7 7A09              MOV      R2,#HIGH ECCParam_p
B3:00ECB9 7BA1              MOV      R3,#LOW ECCParam_p
B3:00ECBB 9042F5            MOV      DPTR,#?_bigint_sub?BYTE+06H
B3:00ECBE 7420              MOV      A,#020H
B3:00ECC0 F0                MOVX     @DPTR,A
B3:00ECC1 121B6A            LCALL    ?INTERBANK_TABLE?_bigint_sub
B3:00ECC4 AB07              MOV      R3,AR7
B3:00ECC6 90097F            MOV      DPTR,#r
B3:00ECC9 E0                MOVX     A,@DPTR
B3:00ECCA FE                MOV      R6,A
B3:00ECCB A3                INC      DPTR
B3:00ECCC E0                MOVX     A,@DPTR
B3:00ECCD FF                MOV      R7,A
B3:00ECCE 7C09              MOV      R4,#HIGH rt
B3:00ECD0 7D81              MOV      R5,#LOW rt
B3:00ECD2 C3                CLR      C
B3:00ECD3 7401              MOV      A,#01H
B3:00ECD5 9B                SUBB     A,R3
B3:00ECD6 FB                MOV      R3,A
B3:00ECD7 22                RET      
----- FUNCTION ?L?COM01FB (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 957



----- FUNCTION ?L?COM02C5 (BEGIN) -----
B3:00ECD8 F0                MOVX     @DPTR,A
B3:00ECD9         ?L?COM02C6:
B3:00ECD9 7B01              MOV      R3,#01H
B3:00ECDB 7A30              MOV      R2,#HIGH rcb+023H
B3:00ECDD 799D              MOV      R1,#LOW rcb+023H
B3:00ECDF 021B2E            LJMP     ?INTERBANK_TABLE?_ctimer_stop
----- FUNCTION ?L?COM02C5 (END) -------


----- FUNCTION ?L?COM030D (BEGIN) -----
B3:00ECE2 7F0E              MOV      R7,#0EH
B3:00ECE4         ?L?COM030E:
B3:00ECE4 129C55            LCALL    _t2_sm_post_event
B3:00ECE7 9031D1            MOV      DPTR,#scb+02BH
B3:00ECEA E0                MOVX     A,@DPTR
B3:00ECEB 22                RET      
----- FUNCTION ?L?COM030D (END) -------


----- FUNCTION ?L?COM0332 (BEGIN) -----
B3:00ECEC E0                MOVX     A,@DPTR
B3:00ECED         ?L?COM0333:
B3:00ECED 24BE              ADD      A,#LOW rcb+044H
B3:00ECEF F582              MOV      DPL,A
B3:00ECF1 E4                CLR      A
B3:00ECF2 3430              ADDC     A,#HIGH rcb+044H
B3:00ECF4 F583              MOV      DPH,A
B3:00ECF6 22                RET      
----- FUNCTION ?L?COM0332 (END) -------


----- FUNCTION ?L?COM03D7 (BEGIN) -----
B3:00ECF7 12D9ED            LCALL    ___find_mpan_by_group_id
B3:00ECFA         ?L?COM03D8:
B3:00ECFA 90372B            MOV      DPTR,#mpan
B3:00ECFD 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM03D7 (END) -------


----- FUNCTION ?L?COM0367 (BEGIN) -----
B3:00ED00 90372B            MOV      DPTR,#mpan
B3:00ED03 122552            LCALL    ?C?PLDXDATA
B3:00ED06 900013            MOV      DPTR,#013H
B3:00ED09 22                RET      
----- FUNCTION ?L?COM0367 (END) -------


----- FUNCTION ?L?COM0444 (BEGIN) -----
B3:00ED0A 122572            LCALL    ?C?PSTXDATA
B3:00ED0D 904004            MOV      DPTR,#plain_text_len
B3:00ED10 E0                MOVX     A,@DPTR
B3:00ED11 FF                MOV      R7,A
B3:00ED12 A3                INC      DPTR
B3:00ED13 E0                MOVX     A,@DPTR
B3:00ED14 22                RET      
----- FUNCTION ?L?COM0444 (END) -------


----- FUNCTION ?L?COM01BE (BEGIN) -----
B3:00ED15 904593            MOV      DPTR,#d
B3:00ED18         ?L?COM01BF:
B3:00ED18 122552            LCALL    ?C?PLDXDATA
B3:00ED1B 900003            MOV      DPTR,#03H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 958


B3:00ED1E 0225F6            LJMP     ?C?PLDOPTR
----- FUNCTION ?L?COM01BE (END) -------


----- FUNCTION ?L?COM055A (BEGIN) -----
B3:00ED21 900025            MOV      DPTR,#025H
B3:00ED24 E4                CLR      A
B3:00ED25 02204D            LJMP     ?C?CSTOPTR
----- FUNCTION ?L?COM055A (END) -------


----- FUNCTION ?L?COM053C (BEGIN) -----
B3:00ED28 90371E            MOV      DPTR,#ciphertext_len
B3:00ED2B E0                MOVX     A,@DPTR
B3:00ED2C FE                MOV      R6,A
B3:00ED2D A3                INC      DPTR
B3:00ED2E E0                MOVX     A,@DPTR
B3:00ED2F 22                RET      
----- FUNCTION ?L?COM053C (END) -------


----- FUNCTION ?L?COM0186 (BEGIN) -----
B3:00ED30 7B01              MOV      R3,#01H
B3:00ED32 7A37              MOV      R2,#HIGH nonce
B3:00ED34 7905              MOV      R1,#LOW nonce
B3:00ED36 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0186 (END) -------


----- FUNCTION ?L?COM02D5 (BEGIN) -----
B3:00ED39 122552            LCALL    ?C?PLDXDATA
B3:00ED3C A801              MOV      R0,AR1
B3:00ED3E AC02              MOV      R4,AR2
B3:00ED40 AD03              MOV      R5,AR3
B3:00ED42 22                RET      
----- FUNCTION ?L?COM02D5 (END) -------


----- FUNCTION ?L?COM01DF (BEGIN) -----
B3:00ED43 904593            MOV      DPTR,#d
B3:00ED46         ?L?COM01E0:
B3:00ED46 122552            LCALL    ?C?PLDXDATA
B3:00ED49 900006            MOV      DPTR,#06H
B3:00ED4C 022163            LJMP     ?C?ILDOPTR
----- FUNCTION ?L?COM01DF (END) -------


----- FUNCTION ?L?COM03DC (BEGIN) -----
B3:00ED4F 7B01              MOV      R3,#01H
B3:00ED51 7A3F              MOV      R2,#HIGH challenge_response
B3:00ED53 791D              MOV      R1,#LOW challenge_response
B3:00ED55 90453B            MOV      DPTR,#?_s2_inclusion_challenge_response?BYTE+04H
B3:00ED58 7404              MOV      A,#04H
B3:00ED5A F0                MOVX     @DPTR,A
B3:00ED5B 22                RET      
----- FUNCTION ?L?COM03DC (END) -------


----- FUNCTION ?L?COM0270 (BEGIN) -----
B3:00ED5C 2424              ADD      A,#LOW the_context+020H
B3:00ED5E F9                MOV      R1,A
B3:00ED5F 7428              MOV      A,#HIGH the_context+020H
B3:00ED61 35F0              ADDC     A,B
B3:00ED63 FA                MOV      R2,A
B3:00ED64 903950            MOV      DPTR,#?_next_nonce_instantiate?BYTE+09H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 959


B3:00ED67 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM0270 (END) -------


----- FUNCTION ?L?COM0117 (BEGIN) -----
B3:00ED6A 903F6B            MOV      DPTR,#byte1
B3:00ED6D E0                MOVX     A,@DPTR
B3:00ED6E 5407              ANL      A,#07H
B3:00ED70 FF                MOV      R7,A
B3:00ED71 903F72            MOV      DPTR,#datagram_size_tmp
B3:00ED74 E4                CLR      A
B3:00ED75 F0                MOVX     @DPTR,A
B3:00ED76 A3                INC      DPTR
B3:00ED77 EF                MOV      A,R7
B3:00ED78 F0                MOVX     @DPTR,A
B3:00ED79 22                RET      
----- FUNCTION ?L?COM0117 (END) -------


----- FUNCTION ?L?COM052F (BEGIN) -----
B3:00ED7A 7A38              MOV      R2,#HIGH nonce
B3:00ED7C 7940              MOV      R1,#LOW nonce
B3:00ED7E 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM052F (END) -------


----- FUNCTION ?L?COM0139 (BEGIN) -----
B3:00ED81 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00ED84 741D              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_rx_timer_expired
B3:00ED86 F0                MOVX     @DPTR,A
B3:00ED87 A3                INC      DPTR
B3:00ED88 74C7              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_rx_timer_expired
B3:00ED8A F0                MOVX     @DPTR,A
B3:00ED8B 7B01              MOV      R3,#01H
B3:00ED8D 7A30              MOV      R2,#HIGH rcb+043H
B3:00ED8F 79BD              MOV      R1,#LOW rcb+043H
B3:00ED91 A3                INC      DPTR
B3:00ED92 122572            LCALL    ?C?PSTXDATA
B3:00ED95 7A30              MOV      R2,#HIGH rcb+033H
B3:00ED97 79AD              MOV      R1,#LOW rcb+033H
B3:00ED99 7F20              MOV      R7,#020H
B3:00ED9B 7E03              MOV      R6,#03H
B3:00ED9D 22                RET      
----- FUNCTION ?L?COM0139 (END) -------


----- FUNCTION ?L?COM055C (BEGIN) -----
B3:00ED9E 12203B            LCALL    ?C?CSTPTR
B3:00EDA1 903856            MOV      DPTR,#hdr_len
B3:00EDA4 E4                CLR      A
B3:00EDA5 22                RET      
----- FUNCTION ?L?COM055C (END) -------


----- FUNCTION ?L?COM0415 (BEGIN) -----
B3:00EDA6 74D6              MOV      A,#LOW t+020H
B3:00EDA8 2D                ADD      A,R5
B3:00EDA9 F582              MOV      DPL,A
B3:00EDAB E4                CLR      A
B3:00EDAC 3408              ADDC     A,#HIGH t+020H
B3:00EDAE F583              MOV      DPH,A
B3:00EDB0 E0                MOVX     A,@DPTR
B3:00EDB1 22                RET      
----- FUNCTION ?L?COM0415 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 960



----- FUNCTION ?L?COM0308 (BEGIN) -----
B3:00EDB2 E0                MOVX     A,@DPTR
B3:00EDB3 FB                MOV      R3,A
B3:00EDB4 9008F7            MOV      DPTR,#UV+01H
B3:00EDB7 E0                MOVX     A,@DPTR
B3:00EDB8 2B                ADD      A,R3
B3:00EDB9 F0                MOVX     @DPTR,A
B3:00EDBA 9008F6            MOV      DPTR,#UV
B3:00EDBD E0                MOVX     A,@DPTR
B3:00EDBE 3400              ADDC     A,#00H
B3:00EDC0 F0                MOVX     @DPTR,A
B3:00EDC1 A3                INC      DPTR
B3:00EDC2 E0                MOVX     A,@DPTR
B3:00EDC3 22                RET      
----- FUNCTION ?L?COM0308 (END) -------


----- FUNCTION ?L?COM01A8 (BEGIN) -----
B3:00EDC4 5407              ANL      A,#07H
B3:00EDC6 FF                MOV      R7,A
B3:00EDC7 9031CA            MOV      DPTR,#scb+024H
B3:00EDCA E0                MOVX     A,@DPTR
B3:00EDCB FE                MOV      R6,A
B3:00EDCC C4                SWAP     A
B3:00EDCD 54F0              ANL      A,#0F0H
B3:00EDCF 4F                ORL      A,R7
B3:00EDD0 900003            MOV      DPTR,#03H
B3:00EDD3 12204D            LCALL    ?C?CSTOPTR
B3:00EDD6 ED                MOV      A,R5
B3:00EDD7 900004            MOV      DPTR,#04H
B3:00EDDA         ?L?COM01A9:
B3:00EDDA 12204D            LCALL    ?C?CSTOPTR
B3:00EDDD 9031A6            MOV      DPTR,#scb
B3:00EDE0 A3                INC      DPTR
B3:00EDE1 E0                MOVX     A,@DPTR
B3:00EDE2 FF                MOV      R7,A
B3:00EDE3 22                RET      
----- FUNCTION ?L?COM01A8 (END) -------


----- FUNCTION ?L?COM01B6 (BEGIN) -----
B3:00EDE4 75F060            MOV      B,#060H
B3:00EDE7 A4                MUL      AB
B3:00EDE8 2491              ADD      A,#LOW exploreQueue
B3:00EDEA F9                MOV      R1,A
B3:00EDEB 7407              MOV      A,#HIGH exploreQueue
B3:00EDED 35F0              ADDC     A,B
B3:00EDEF FA                MOV      R2,A
B3:00EDF0 7B01              MOV      R3,#01H
B3:00EDF2 900854            MOV      DPTR,#pExploreQueueElement
B3:00EDF5 022572            LJMP     ?C?PSTXDATA
----- FUNCTION ?L?COM01B6 (END) -------


----- FUNCTION ?L?COM01C8 (BEGIN) -----
B3:00EDF8 903D52            MOV      DPTR,#s
B3:00EDFB         ?L?COM01C9:
B3:00EDFB 122572            LCALL    ?C?PSTXDATA
B3:00EDFE EA                MOV      A,R2
B3:00EDFF 49                ORL      A,R1
B3:00EE00 4B                ORL      A,R3
B3:00EE01 22                RET      
----- FUNCTION ?L?COM01C8 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 961



----- FUNCTION ?L?COM0311 (BEGIN) -----
B3:00EE02 FD                MOV      R5,A
B3:00EE03 E0                MOVX     A,@DPTR
B3:00EE04 FB                MOV      R3,A
B3:00EE05 A3                INC      DPTR
B3:00EE06 E0                MOVX     A,@DPTR
B3:00EE07 90418E            MOV      DPTR,#?___S2_make_aad?BYTE+05H
B3:00EE0A CB                XCH      A,R3
B3:00EE0B F0                MOVX     @DPTR,A
B3:00EE0C A3                INC      DPTR
B3:00EE0D EB                MOV      A,R3
B3:00EE0E F0                MOVX     @DPTR,A
B3:00EE0F 22                RET      
----- FUNCTION ?L?COM0311 (END) -------


----- FUNCTION ?L?COM01EB (BEGIN) -----
B3:00EE10 122552            LCALL    ?C?PLDXDATA
B3:00EE13 900007            MOV      DPTR,#07H
B3:00EE16 1223F4            LCALL    ?C?LLDOPTR
B3:00EE19 9041B5            MOV      DPTR,#?_secure_learnIfaceL_send_scheme_report?BYTE+04H
B3:00EE1C 1224BA            LCALL    ?C?LSTXDATA
B3:00EE1F 9041B9            MOV      DPTR,#?_secure_learnIfaceL_send_scheme_report?BYTE+08H
B3:00EE22 22                RET      
----- FUNCTION ?L?COM01EB (END) -------


----- FUNCTION ?L?COM0249 (BEGIN) -----
B3:00EE23 E0                MOVX     A,@DPTR
B3:00EE24 FE                MOV      R6,A
B3:00EE25 903F6C            MOV      DPTR,#byte2
B3:00EE28 E0                MOVX     A,@DPTR
B3:00EE29 7C00              MOV      R4,#00H
B3:00EE2B 2400              ADD      A,#00H
B3:00EE2D FF                MOV      R7,A
B3:00EE2E EC                MOV      A,R4
B3:00EE2F 3E                ADDC     A,R6
B3:00EE30 FE                MOV      R6,A
B3:00EE31 903F72            MOV      DPTR,#datagram_size_tmp
B3:00EE34 F0                MOVX     @DPTR,A
B3:00EE35 A3                INC      DPTR
B3:00EE36 EF                MOV      A,R7
B3:00EE37 F0                MOVX     @DPTR,A
B3:00EE38 D3                SETB     C
B3:00EE39 94C8              SUBB     A,#0C8H
B3:00EE3B EE                MOV      A,R6
B3:00EE3C 9400              SUBB     A,#00H
B3:00EE3E 22                RET      
----- FUNCTION ?L?COM0249 (END) -------


----- FUNCTION ?L?COM0256 (BEGIN) -----
B3:00EE3F E0                MOVX     A,@DPTR
B3:00EE40 FD                MOV      R5,A
B3:00EE41 7B01              MOV      R3,#01H
B3:00EE43         ?L?COM0257:
B3:00EE43 904385            MOV      DPTR,#?_get_nonce?BYTE+03H
B3:00EE46 122572            LCALL    ?C?PSTXDATA
B3:00EE49 E4                CLR      A
B3:00EE4A 904388            MOV      DPTR,#?_get_nonce?BYTE+06H
B3:00EE4D F0                MOVX     @DPTR,A
B3:00EE4E 22                RET      
----- FUNCTION ?L?COM0256 (END) -------

LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 962



----- FUNCTION ?L?COM0276 (BEGIN) -----
B3:00EE4F 128195            LCALL    ___ZW_memcpy
B3:00EE52 90306A            MOV      DPTR,#subseq_frag
B3:00EE55 122552            LCALL    ?C?PLDXDATA
B3:00EE58 9031A6            MOV      DPTR,#scb
B3:00EE5B A3                INC      DPTR
B3:00EE5C E0                MOVX     A,@DPTR
B3:00EE5D 22                RET      
----- FUNCTION ?L?COM0276 (END) -------


----- FUNCTION ?L?COM0334 (BEGIN) -----
B3:00EE5E E4                CLR      A
B3:00EE5F 7F10              MOV      R7,#010H
B3:00EE61 7E27              MOV      R6,#027H
B3:00EE63 FD                MOV      R5,A
B3:00EE64 FC                MOV      R4,A
B3:00EE65 904227            MOV      DPTR,#?_ctimer_set?BYTE+07H
B3:00EE68 741C              MOV      A,#HIGH ?INTERBANK_TABLE?_ZCB_tx_timeout
B3:00EE6A F0                MOVX     @DPTR,A
B3:00EE6B A3                INC      DPTR
B3:00EE6C 746E              MOV      A,#LOW ?INTERBANK_TABLE?_ZCB_tx_timeout
B3:00EE6E 22                RET      
----- FUNCTION ?L?COM0334 (END) -------


----- FUNCTION ?L?COM0366 (BEGIN) -----
B3:00EE6F 9031CF            MOV      DPTR,#scb+029H
B3:00EE72 E0                MOVX     A,@DPTR
B3:00EE73 FF                MOV      R7,A
B3:00EE74 A3                INC      DPTR
B3:00EE75 E0                MOVX     A,@DPTR
B3:00EE76 9031AC            MOV      DPTR,#scb+06H
B3:00EE79 CF                XCH      A,R7
B3:00EE7A F0                MOVX     @DPTR,A
B3:00EE7B A3                INC      DPTR
B3:00EE7C EF                MOV      A,R7
B3:00EE7D F0                MOVX     @DPTR,A
B3:00EE7E 22                RET      
----- FUNCTION ?L?COM0366 (END) -------


----- FUNCTION ?L?COM0368 (BEGIN) -----
B3:00EE7F 122552            LCALL    ?C?PLDXDATA
B3:00EE82 12D897            LCALL    ___find_span_by_node
B3:00EE85         ?L?COM0369:
B3:00EE85 AA06              MOV      R2,AR6
B3:00EE87 A907              MOV      R1,AR7
B3:00EE89 7B01              MOV      R3,#01H
B3:00EE8B 22                RET      
----- FUNCTION ?L?COM0368 (END) -------


----- FUNCTION ?L?COM036C (BEGIN) -----
B3:00EE8C 7A2A              MOV      R2,#HIGH the_context+0208H
B3:00EE8E         ?L?COM036D:
B3:00EE8E 904245            MOV      DPTR,#i
B3:00EE91 E0                MOVX     A,@DPTR
B3:00EE92 75F002            MOV      B,#02H
B3:00EE95 22                RET      
----- FUNCTION ?L?COM036C (END) -------


----- FUNCTION ?L?COM0370 (BEGIN) -----
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 963


B3:00EE96 7B01              MOV      R3,#01H
B3:00EE98 7A08              MOV      R2,#HIGH exploreSearchResultBuffer
B3:00EE9A 7957              MOV      R1,#LOW exploreSearchResultBuffer
B3:00EE9C 9009FF            MOV      DPTR,#?_TransportEnQueueExploreFrame?BYTE+05H
B3:00EE9F 7419              MOV      A,#019H
B3:00EEA1 F0                MOVX     @DPTR,A
B3:00EEA2 A3                INC      DPTR
B3:00EEA3 7440              MOV      A,#040H
B3:00EEA5 22                RET      
----- FUNCTION ?L?COM0370 (END) -------


----- FUNCTION ?L?COM03A3 (BEGIN) -----
B3:00EEA6 75F00C            MOV      B,#0CH
B3:00EEA9 A4                MUL      AB
B3:00EEAA 24A3              ADD      A,#LOW nonce_table+03H
B3:00EEAC F582              MOV      DPL,A
B3:00EEAE E4                CLR      A
B3:00EEAF 342B              ADDC     A,#HIGH nonce_table+03H
B3:00EEB1 F583              MOV      DPH,A
B3:00EEB3 22                RET      
----- FUNCTION ?L?COM03A3 (END) -------


----- FUNCTION ?L?COM03A6 (BEGIN) -----
B3:00EEB4 75F060            MOV      B,#060H
B3:00EEB7 A4                MUL      AB
B3:00EEB8 2491              ADD      A,#LOW exploreQueue
B3:00EEBA F582              MOV      DPL,A
B3:00EEBC E4                CLR      A
B3:00EEBD 3407              ADDC     A,#HIGH exploreQueue
B3:00EEBF F583              MOV      DPH,A
B3:00EEC1 22                RET      
----- FUNCTION ?L?COM03A6 (END) -------


----- FUNCTION ?L?COM03D9 (BEGIN) -----
B3:00EEC2 FE                MOV      R6,A
B3:00EEC3 C3                CLR      C
B3:00EEC4 9036BE            MOV      DPTR,#msg_len+01H
B3:00EEC7 E0                MOVX     A,@DPTR
B3:00EEC8 9F                SUBB     A,R7
B3:00EEC9 9036BD            MOV      DPTR,#msg_len
B3:00EECC E0                MOVX     A,@DPTR
B3:00EECD 9E                SUBB     A,R6
B3:00EECE 22                RET      
----- FUNCTION ?L?COM03D9 (END) -------


----- FUNCTION ?L?COM03DB (BEGIN) -----
B3:00EECF 900023            MOV      DPTR,#023H
B3:00EED2 021FB9            LJMP     ?C?CLDOPTR
----- FUNCTION ?L?COM03DB (END) -------


----- FUNCTION ?L?COM0418 (BEGIN) -----
B3:00EED5 75F005            MOV      B,#05H
B3:00EED8 122546            LCALL    ?C?OFFXADD
B3:00EEDB E0                MOVX     A,@DPTR
B3:00EEDC 22                RET      
----- FUNCTION ?L?COM0418 (END) -------


----- FUNCTION ?L?COM0441 (BEGIN) -----
B3:00EEDD 90321F            MOV      DPTR,#scb+079H
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 964


B3:00EEE0 E0                MOVX     A,@DPTR
B3:00EEE1 FF                MOV      R7,A
B3:00EEE2 90307A            MOV      DPTR,#rcb
B3:00EEE5 E0                MOVX     A,@DPTR
B3:00EEE6 6F                XRL      A,R7
B3:00EEE7 22                RET      
----- FUNCTION ?L?COM0441 (END) -------


----- FUNCTION ?L?COM0442 (BEGIN) -----
B3:00EEE8 903F72            MOV      DPTR,#datagram_size_tmp
B3:00EEEB E0                MOVX     A,@DPTR
B3:00EEEC FF                MOV      R7,A
B3:00EEED A3                INC      DPTR
B3:00EEEE E0                MOVX     A,@DPTR
B3:00EEEF 9031A4            MOV      DPTR,#rcb+012AH
B3:00EEF2 22                RET      
----- FUNCTION ?L?COM0442 (END) -------


----- FUNCTION ?L?COM0446 (BEGIN) -----
B3:00EEF3 A3                INC      DPTR
B3:00EEF4 F0                MOVX     @DPTR,A
B3:00EEF5 7A2D              MOV      R2,#HIGH the_tx_session+01BH
B3:00EEF7 79A9              MOV      R1,#LOW the_tx_session+01BH
B3:00EEF9 121980            LCALL    ?INTERBANK_TABLE?_ZW_SendDataEx
B3:00EEFC EF                MOV      A,R7
B3:00EEFD 22                RET      
----- FUNCTION ?L?COM0446 (END) -------


----- FUNCTION ?L?COM0459 (BEGIN) -----
B3:00EEFE 903D89            MOV      DPTR,#enc_data
B3:00EF01 022552            LJMP     ?C?PLDXDATA
----- FUNCTION ?L?COM0459 (END) -------


----- FUNCTION ?L?COM0465 (BEGIN) -----
B3:00EF04 1223F4            LCALL    ?C?LLDOPTR
B3:00EF07 904346            MOV      DPTR,#?_secure_learnIfaceI_register_scheme?BYTE+04H
B3:00EF0A 0224BA            LJMP     ?C?LSTXDATA
----- FUNCTION ?L?COM0465 (END) -------


----- FUNCTION ?L?COM04A0 (BEGIN) -----
B3:00EF0D 904592            MOV      DPTR,#e
B3:00EF10 E0                MOVX     A,@DPTR
B3:00EF11 6404              XRL      A,#04H
B3:00EF13 22                RET      
----- FUNCTION ?L?COM04A0 (END) -------


----- FUNCTION ?L?COM04B2 (BEGIN) -----
B3:00EF14 7B01              MOV      R3,#01H
B3:00EF16 7A08              MOV      R2,#HIGH exploreSearchResultBuffer
B3:00EF18 7957              MOV      R1,#LOW exploreSearchResultBuffer
B3:00EF1A 028195            LJMP     ___ZW_memcpy
----- FUNCTION ?L?COM04B2 (END) -------


----- FUNCTION ?L?COM04E7 (BEGIN) -----
B3:00EF1D 5407              ANL      A,#07H
B3:00EF1F 44E0              ORL      A,#0E0H
B3:00EF21 FF                MOV      R7,A
B3:00EF22 90306A            MOV      DPTR,#subseq_frag
LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 965


B3:00EF25 22                RET      
----- FUNCTION ?L?COM04E7 (END) -------


----- FUNCTION ?L?COM04FF (BEGIN) -----
B3:00EF26 7F10              MOV      R7,#010H
B3:00EF28 7E27              MOV      R6,#027H
B3:00EF2A 7D00              MOV      R5,#00H
B3:00EF2C 7C00              MOV      R4,#00H
B3:00EF2E 22                RET      
----- FUNCTION ?L?COM04FF (END) -------


----- FUNCTION ?L?COM0500 (BEGIN) -----
B3:00EF2F FF                MOV      R7,A
B3:00EF30 9028CA            MOV      DPTR,#the_context+0C6H
B3:00EF33 E0                MOVX     A,@DPTR
B3:00EF34 FD                MOV      R5,A
B3:00EF35 EF                MOV      A,R7
B3:00EF36 5D                ANL      A,R5
B3:00EF37 22                RET      
----- FUNCTION ?L?COM0500 (END) -------


----- FUNCTION ?L?COM0505 (BEGIN) -----
B3:00EF38 903D29            MOV      DPTR,#snode
B3:00EF3B E0                MOVX     A,@DPTR
B3:00EF3C FF                MOV      R7,A
B3:00EF3D A3                INC      DPTR
B3:00EF3E E0                MOVX     A,@DPTR
B3:00EF3F FD                MOV      R5,A
B3:00EF40 22                RET      
----- FUNCTION ?L?COM0505 (END) -------


----- FUNCTION ?L?COM0506 (BEGIN) -----
B3:00EF41 903D2A            MOV      DPTR,#dnode
B3:00EF44 E0                MOVX     A,@DPTR
B3:00EF45 FF                MOV      R7,A
B3:00EF46 903D29            MOV      DPTR,#snode
B3:00EF49 22                RET      
----- FUNCTION ?L?COM0506 (END) -------


----- FUNCTION ?L?COM0508 (BEGIN) -----
B3:00EF4A 902D8E            MOV      DPTR,#the_tx_session
B3:00EF4D E0                MOVX     A,@DPTR
B3:00EF4E FF                MOV      R7,A
B3:00EF4F A3                INC      DPTR
B3:00EF50 E0                MOVX     A,@DPTR
B3:00EF51 FD                MOV      R5,A
B3:00EF52 22                RET      
----- FUNCTION ?L?COM0508 (END) -------


----- FUNCTION ?L?COM0509 (BEGIN) -----
B3:00EF53 90443A            MOV      DPTR,#i
B3:00EF56 E0                MOVX     A,@DPTR
B3:00EF57 FF                MOV      R7,A
B3:00EF58 C3                CLR      C
B3:00EF59 940F              SUBB     A,#0FH
B3:00EF5B 22                RET      
----- FUNCTION ?L?COM0509 (END) -------


LX51 LINKER/LOCATER V4.66.41.0                                                        12/14/2021  16:17:53  PAGE 966


----- FUNCTION ?L?COM0559 (BEGIN) -----
B3:00EF5C E4                CLR      A
B3:00EF5D 9028DE            MOV      DPTR,#the_context+0DAH
B3:00EF60 F0                MOVX     @DPTR,A
B3:00EF61 A3                INC      DPTR
B3:00EF62 F0                MOVX     @DPTR,A
B3:00EF63 22                RET      
----- FUNCTION ?L?COM0559 (END) -------


----- FUNCTION ?L?COM055B (BEGIN) -----
B3:00EF64 90444E            MOV      DPTR,#span
B3:00EF67 E0                MOVX     A,@DPTR
B3:00EF68 FE                MOV      R6,A
B3:00EF69 A3                INC      DPTR
B3:00EF6A E0                MOVX     A,@DPTR
B3:00EF6B 22                RET      
----- FUNCTION ?L?COM055B (END) -------


----- FUNCTION ?L?COM0569 (BEGIN) -----
B3:00EF6C 12248A            LCALL    ?C?LLDOPTR0
B3:00EF6F C3                CLR      C
B3:00EF70 022387            LJMP     ?C?SLCMP
----- FUNCTION ?L?COM0569 (END) -------


----- FUNCTION ?L?COM056A (BEGIN) -----
B3:00EF73 90462A            MOV      DPTR,#handle
B3:00EF76 122552            LCALL    ?C?PLDXDATA
B3:00EF79 E9                MOV      A,R1
B3:00EF7A 22                RET      
----- FUNCTION ?L?COM056A (END) -------


----- FUNCTION ?L?COM0570 (BEGIN) -----
B3:00EF7B 12203B            LCALL    ?C?CSTPTR
B3:00EF7E 900A4F            MOV      DPTR,#bDataLength
B3:00EF81 E0                MOVX     A,@DPTR
B3:00EF82 22                RET      
----- FUNCTION ?L?COM0570 (END) -------


